
load model: /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
train_data_files nums: 124
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509861469268799, gen p mean: -0.11561450362205505, mean p set: 0.45156213641166687
loss_pred:0.01559656672179699, decouple_loss:0.0007182406261563301
The modified gen p mean: 0.4488060772418976, gen p mean: -0.11828996241092682, mean p set: 0.449381947517395
loss_pred:0.015554810874164104, decouple_loss:0.0004705518949776888
The modified gen p mean: 0.4500606060028076, gen p mean: -0.11516346782445908, mean p set: 0.4506358802318573
loss_pred:0.015868090093135834, decouple_loss:0.0005038103554397821
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45207029581069946, gen p mean: -0.13412651419639587, mean p set: 0.4526459276676178
The modified gen p mean: 0.45127537846565247, gen p mean: -0.13523763418197632, mean p set: 0.4518527686595917loss_pred:0.017587581649422646, decouple_loss:0.0016260073753073812
loss_pred:0.017237860709428787, decouple_loss:0.0014395868638530374
The modified gen p mean: 0.4520662724971771, gen p mean: -0.1314859539270401, mean p set: 0.45264333486557007
loss_pred:0.017252590507268906, decouple_loss:0.0015334481140598655
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45130789279937744, gen p mean: -0.12158191949129105, mean p set: 0.4518826901912689
loss_pred:0.016395127400755882, decouple_loss:0.0013400529278442264
The modified gen p mean: 0.44968727231025696, gen p mean: -0.12942487001419067, mean p set: 0.45026248693466187
loss_pred:0.0165861863642931, decouple_loss:0.0011590279173105955
The modified gen p mean: 0.44883784651756287, gen p mean: -0.13278904557228088, mean p set: 0.44941338896751404
loss_pred:0.015961065888404846, decouple_loss:0.0015072847018018365
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44843095541000366, gen p mean: -0.12119545787572861, mean p set: 0.44900739192962646
loss_pred:0.016783038154244423, decouple_loss:0.0009973387932404876
The modified gen p mean: 0.45043501257896423, gen p mean: -0.11640477180480957, mean p set: 0.4510088264942169
loss_pred:0.0162113718688488, decouple_loss:0.000851841235999018
The modified gen p mean: 0.44936278462409973, gen p mean: -0.12254393100738525, mean p set: 0.44993945956230164
loss_pred:0.01607993245124817, decouple_loss:0.0007898105541244149
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521801769733429, gen p mean: -0.0990673080086708, mean p set: 0.45275649428367615
loss_pred:0.0156231839209795, decouple_loss:0.0010504040401428938
The modified gen p mean: 0.4490642249584198, gen p mean: -0.09650822728872299, mean p set: 0.44963955879211426
loss_pred:0.016506679356098175, decouple_loss:0.0010579150402918458
The modified gen p mean: 0.44848570227622986, gen p mean: -0.10398462414741516, mean p set: 0.4490615427494049
loss_pred:0.017187029123306274, decouple_loss:0.0008802530355751514
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492020606994629, gen p mean: -0.10611024498939514, mean p set: 0.4497814178466797
loss_pred:0.016391204670071602, decouple_loss:0.0006904234178364277
The modified gen p mean: 0.4508303105831146, gen p mean: -0.10825272649526596, mean p set: 0.45140528678894043
loss_pred:0.01551059726625681, decouple_loss:0.0009369461331516504
The modified gen p mean: 0.4513417184352875, gen p mean: -0.11986372619867325, mean p set: 0.4519214332103729
loss_pred:0.014971061609685421, decouple_loss:0.001108491444028914
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891390204429626, gen p mean: -0.11000599712133408, mean p set: 0.4494905471801758
loss_pred:0.01530138123780489, decouple_loss:0.0008015010971575975
The modified gen p mean: 0.4489457905292511, gen p mean: -0.10907580703496933, mean p set: 0.44952380657196045
loss_pred:0.015333962626755238, decouple_loss:0.0011087014572694898
The modified gen p mean: 0.4491868019104004, gen p mean: -0.10455123335123062, mean p set: 0.44976404309272766
loss_pred:0.015694303438067436, decouple_loss:0.0009407746256329119
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45020514726638794, gen p mean: -0.1045285239815712, mean p set: 0.4507831633090973
loss_pred:0.016427308320999146, decouple_loss:0.0007179923704825342
The modified gen p mean: 0.4516757130622864, gen p mean: -0.1073007583618164, mean p set: 0.4522479474544525
loss_pred:0.01551300659775734, decouple_loss:0.000994798494502902
The modified gen p mean: 0.44849005341529846, gen p mean: -0.11195456236600876, mean p set: 0.4490666687488556
loss_pred:0.015743717551231384, decouple_loss:0.0007003049249760807
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489325284957886, gen p mean: -0.11291279643774033, mean p set: 0.4495079815387726
loss_pred:0.01622527651488781, decouple_loss:0.000782941875513643
The modified gen p mean: 0.4513063132762909, gen p mean: -0.10887379944324493, mean p set: 0.451885849237442
loss_pred:0.016096247360110283, decouple_loss:0.0010915780439972878
The modified gen p mean: 0.44962653517723083, gen p mean: -0.11203595995903015, mean p set: 0.4502033293247223
loss_pred:0.016153963282704353, decouple_loss:0.0006496995920315385
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475226402282715, gen p mean: -0.1207943856716156, mean p set: 0.44809824228286743
loss_pred:0.016345370560884476, decouple_loss:0.0007641024421900511
The modified gen p mean: 0.4509517252445221, gen p mean: -0.11553377658128738, mean p set: 0.45152729749679565
loss_pred:0.016134057193994522, decouple_loss:0.0006640023784711957
The modified gen p mean: 0.4499504864215851, gen p mean: -0.11414804309606552, mean p set: 0.4505264163017273
loss_pred:0.016053885221481323, decouple_loss:0.0007037046016193926
2023-05-02 02:48:02 testing...
The modified gen p mean: 0.4497423470020294, gen p mean: -0.12030994892120361, mean p set: 0.4502691626548767
loss_pred:0.01886594668030739, decouple_loss:0.000691611785441637
The modified gen p mean: 0.44948822259902954, gen p mean: -0.11523258686065674, mean p set: 0.4500633478164673
loss_pred:0.01829104870557785, decouple_loss:0.0006983331986702979
The modified gen p mean: 0.44978171586990356, gen p mean: -0.11553117632865906, mean p set: 0.45035696029663086
loss_pred:0.01852264441549778, decouple_loss:0.0006757554947398603
WV_1_PC_1_EH_0_PS_40, loss: 0.01859430968761444, avg_mse: 0.029139697551727295
current test mse: 0.02914
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517173171043396, gen p mean: -0.11137796938419342, mean p set: 0.4522995054721832
loss_pred:0.016697870567440987, decouple_loss:0.0007168517331592739
The modified gen p mean: 0.4489039182662964, gen p mean: -0.11503667384386063, mean p set: 0.4494827091693878The modified gen p mean: 0.4492744505405426, gen p mean: -0.1135382279753685, mean p set: 0.4498515725135803
loss_pred:0.017119383439421654, decouple_loss:0.0007725806208327413
loss_pred:0.016890214756131172, decouple_loss:0.0006962360348552465
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512272775173187, gen p mean: -0.11508554965257645, mean p set: 0.4518038034439087
loss_pred:0.015969814732670784, decouple_loss:0.0006357334204949439
The modified gen p mean: 0.4503493010997772, gen p mean: -0.11159200221300125, mean p set: 0.4509258568286896The modified gen p mean: 0.4513174891471863, gen p mean: -0.10804656893014908, mean p set: 0.4518917500972748
loss_pred:0.016650931909680367, decouple_loss:0.0007931485306471586
loss_pred:0.016575871035456657, decouple_loss:0.0006207472179085016
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498840272426605, gen p mean: -0.11303628236055374, mean p set: 0.45045995712280273
loss_pred:0.017359822988510132, decouple_loss:0.0007723644375801086
The modified gen p mean: 0.44991612434387207, gen p mean: -0.12032673507928848, mean p set: 0.4504929184913635
loss_pred:0.01711808703839779, decouple_loss:0.0006466516642831266
The modified gen p mean: 0.44999635219573975, gen p mean: -0.12331664562225342, mean p set: 0.4505738615989685
loss_pred:0.01634465716779232, decouple_loss:0.0006877162959426641
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044660568237305, gen p mean: -0.12049730122089386, mean p set: 0.4510234594345093
loss_pred:0.017739437520503998, decouple_loss:0.0005741659551858902
The modified gen p mean: 0.4499288499355316, gen p mean: -0.11744312196969986, mean p set: 0.4505072236061096
loss_pred:0.016930434852838516, decouple_loss:0.0006489976076409221
The modified gen p mean: 0.44854265451431274, gen p mean: -0.12355560809373856, mean p set: 0.44911783933639526
loss_pred:0.016854221001267433, decouple_loss:0.0006997848395258188
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494016468524933, gen p mean: -0.11901704221963882, mean p set: 0.4499800503253937
loss_pred:0.01771351881325245, decouple_loss:0.0006145823281258345
The modified gen p mean: 0.44768956303596497, gen p mean: -0.1245117038488388, mean p set: 0.4482645094394684
loss_pred:0.0175260528922081, decouple_loss:0.0007381032919511199
The modified gen p mean: 0.45189717411994934, gen p mean: -0.12580277025699615, mean p set: 0.45247551798820496
loss_pred:0.01651861146092415, decouple_loss:0.0007613893831148744
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500292241573334, gen p mean: -0.12513035535812378, mean p set: 0.45060494542121887
loss_pred:0.017246752977371216, decouple_loss:0.0006610476411879063
The modified gen p mean: 0.4501942992210388, gen p mean: -0.12390140444040298, mean p set: 0.4507688283920288
loss_pred:0.017468925565481186, decouple_loss:0.0007345486083067954
The modified gen p mean: 0.4496680498123169, gen p mean: -0.12627176940441132, mean p set: 0.45024624466896057
loss_pred:0.016730451956391335, decouple_loss:0.0006508164224214852
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45239314436912537, gen p mean: -0.12832844257354736, mean p set: 0.45297008752822876
loss_pred:0.016289107501506805, decouple_loss:0.0007416754961013794
The modified gen p mean: 0.4527396559715271, gen p mean: -0.12357620149850845, mean p set: 0.4533156752586365
loss_pred:0.01685635931789875, decouple_loss:0.000644123530946672
The modified gen p mean: 0.4500861167907715, gen p mean: -0.1299576759338379, mean p set: 0.45065850019454956
loss_pred:0.016412068158388138, decouple_loss:0.0006254471954889596
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44959548115730286, gen p mean: -0.12999500334262848, mean p set: 0.45017367601394653
loss_pred:0.016549941152334213, decouple_loss:0.0005900729447603226
The modified gen p mean: 0.4513622224330902, gen p mean: -0.13311603665351868, mean p set: 0.45193883776664734
loss_pred:0.016158128157258034, decouple_loss:0.0005768953124061227
The modified gen p mean: 0.44778767228126526, gen p mean: -0.12850478291511536, mean p set: 0.4483596682548523
loss_pred:0.017620017752051353, decouple_loss:0.0005661313189193606
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44965821504592896, gen p mean: -0.13939420878887177, mean p set: 0.45023781061172485
loss_pred:0.016583960503339767, decouple_loss:0.0006968180532567203
The modified gen p mean: 0.45036619901657104, gen p mean: -0.1306641846895218, mean p set: 0.4509424567222595
loss_pred:0.01640671119093895, decouple_loss:0.0006254313630051911
The modified gen p mean: 0.44850799441337585, gen p mean: -0.13924819231033325, mean p set: 0.44908812642097473
loss_pred:0.01700652576982975, decouple_loss:0.0006143724895082414
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982337951660156, gen p mean: -0.12828947603702545, mean p set: 0.4504006803035736
loss_pred:0.016245637089014053, decouple_loss:0.000653687457088381
The modified gen p mean: 0.449729859828949, gen p mean: -0.1329732984304428, mean p set: 0.45030689239501953
loss_pred:0.016388405114412308, decouple_loss:0.0006973535637371242
The modified gen p mean: 0.4490128457546234, gen p mean: -0.13248170912265778, mean p set: 0.44958722591400146
loss_pred:0.01671532914042473, decouple_loss:0.0005922903656028211
2023-05-02 02:50:13 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.14506521821022034, mean p set: 0.4502691626548767
loss_pred:0.018336402252316475, decouple_loss:0.0006273362087085843
The modified gen p mean: 0.4497820734977722, gen p mean: -0.13851496577262878, mean p set: 0.45035696029663086
The modified gen p mean: 0.44948384165763855, gen p mean: -0.13862577080726624, mean p set: 0.4500633478164673
loss_pred:0.01777207851409912, decouple_loss:0.0005956413806416094
loss_pred:0.01759299635887146, decouple_loss:0.0006772767519578338
WV_1_PC_1_EH_0_PS_40, loss: 0.017932165414094925, avg_mse: 0.027968673035502434
current test mse: 0.027969
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494716227054596, gen p mean: -0.1318153440952301, mean p set: 0.4500472843647003
loss_pred:0.017612425610423088, decouple_loss:0.0006465672631748021
The modified gen p mean: 0.44865143299102783, gen p mean: -0.1361536681652069, mean p set: 0.44922736287117004
loss_pred:0.01724151521921158, decouple_loss:0.0006412396905943751
The modified gen p mean: 0.449307382106781, gen p mean: -0.13648752868175507, mean p set: 0.44988515973091125
loss_pred:0.017107069492340088, decouple_loss:0.0007019813056103885
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892632961273193, gen p mean: -0.13549086451530457, mean p set: 0.4495026767253876
loss_pred:0.015802975744009018, decouple_loss:0.00066572759533301
The modified gen p mean: 0.4496541917324066, gen p mean: -0.136871799826622, mean p set: 0.45023199915885925The modified gen p mean: 0.4513689875602722, gen p mean: -0.13373005390167236, mean p set: 0.45194414258003235
loss_pred:0.01630154252052307, decouple_loss:0.0006483204779215157loss_pred:0.016005437821149826, decouple_loss:0.0005905113066546619
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049604773521423, gen p mean: -0.1295696347951889, mean p set: 0.45107173919677734
loss_pred:0.01642233319580555, decouple_loss:0.0006964067579247057
The modified gen p mean: 0.45169270038604736, gen p mean: -0.1301421970129013, mean p set: 0.45227181911468506The modified gen p mean: 0.4495370090007782, gen p mean: -0.12968012690544128, mean p set: 0.45011085271835327
loss_pred:0.016710400581359863, decouple_loss:0.000604065484367311
loss_pred:0.017381684854626656, decouple_loss:0.0006752545014023781
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517051875591278, gen p mean: -0.12374812364578247, mean p set: 0.45227932929992676
loss_pred:0.017188673838973045, decouple_loss:0.0005808467394672334
The modified gen p mean: 0.45031389594078064, gen p mean: -0.11922086030244827, mean p set: 0.45089030265808105
loss_pred:0.016537947580218315, decouple_loss:0.000560316548217088
The modified gen p mean: 0.45041266083717346, gen p mean: -0.1306145340204239, mean p set: 0.4509873688220978
loss_pred:0.01571483537554741, decouple_loss:0.0005882233963347971
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491313099861145, gen p mean: -0.12440811842679977, mean p set: 0.4497041702270508
loss_pred:0.015407535247504711, decouple_loss:0.0005492549971677363
The modified gen p mean: 0.45214220881462097, gen p mean: -0.1189846470952034, mean p set: 0.4527186155319214
loss_pred:0.015649328008294106, decouple_loss:0.0005541989230550826
The modified gen p mean: 0.449424684047699, gen p mean: -0.12554682791233063, mean p set: 0.4500034749507904
loss_pred:0.017067745327949524, decouple_loss:0.0005609160289168358
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492724537849426, gen p mean: -0.1181381344795227, mean p set: 0.4498482048511505
loss_pred:0.01625801995396614, decouple_loss:0.000658633594866842
The modified gen p mean: 0.4489315450191498, gen p mean: -0.12136244773864746, mean p set: 0.4495048522949219
loss_pred:0.016048267483711243, decouple_loss:0.0007735156686976552
The modified gen p mean: 0.45229339599609375, gen p mean: -0.11045781522989273, mean p set: 0.45286887884140015
loss_pred:0.01558213122189045, decouple_loss:0.000628699897788465
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44993242621421814, gen p mean: -0.12168288230895996, mean p set: 0.4505097270011902
loss_pred:0.01573624089360237, decouple_loss:0.0005978523404337466
The modified gen p mean: 0.452012300491333, gen p mean: -0.10619189590215683, mean p set: 0.4525914490222931
loss_pred:0.01609870046377182, decouple_loss:0.0005896117654629052
The modified gen p mean: 0.45138052105903625, gen p mean: -0.1133594810962677, mean p set: 0.4519574046134949
loss_pred:0.015942029654979706, decouple_loss:0.0006807514582760632
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45224857330322266, gen p mean: -0.10941381007432938, mean p set: 0.45282456278800964
loss_pred:0.01583462581038475, decouple_loss:0.0005921529373154044
The modified gen p mean: 0.4504091143608093, gen p mean: -0.12063883990049362, mean p set: 0.450985848903656
loss_pred:0.015616508200764656, decouple_loss:0.0005255844444036484
The modified gen p mean: 0.44949260354042053, gen p mean: -0.11913050711154938, mean p set: 0.45006799697875977
loss_pred:0.014955502934753895, decouple_loss:0.0005268978420644999
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45259809494018555, gen p mean: -0.11472757160663605, mean p set: 0.4531742036342621
loss_pred:0.01613033376634121, decouple_loss:0.0006482685566879809
The modified gen p mean: 0.44951194524765015, gen p mean: -0.11216627061367035, mean p set: 0.4500887989997864
loss_pred:0.015485690906643867, decouple_loss:0.0005436408100649714
The modified gen p mean: 0.45094671845436096, gen p mean: -0.1092691719532013, mean p set: 0.4515224099159241
loss_pred:0.016472788527607918, decouple_loss:0.0006314005004242063
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44984710216522217, gen p mean: -0.11015777289867401, mean p set: 0.4504234194755554
loss_pred:0.0168257188051939, decouple_loss:0.0005676292930729687
The modified gen p mean: 0.45113468170166016, gen p mean: -0.10705968737602234, mean p set: 0.45171138644218445
loss_pred:0.015880053862929344, decouple_loss:0.0005956515669822693
The modified gen p mean: 0.4519176185131073, gen p mean: -0.11527015268802643, mean p set: 0.4524949789047241
loss_pred:0.015322535298764706, decouple_loss:0.0005047091981396079
2023-05-02 02:52:59 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12448320537805557, mean p set: 0.4502691626548767
loss_pred:0.017589233815670013, decouple_loss:0.0005895369104109704
The modified gen p mean: 0.4495331645011902, gen p mean: -0.11728085577487946, mean p set: 0.4500633478164673
loss_pred:0.016924824565649033, decouple_loss:0.0005975859821774065
The modified gen p mean: 0.4497833251953125, gen p mean: -0.1178535595536232, mean p set: 0.45035696029663086
loss_pred:0.0172441229224205, decouple_loss:0.0006292953039519489
WV_1_PC_1_EH_0_PS_40, loss: 0.01728300005197525, avg_mse: 0.02676432579755783
current test mse: 0.026764
At step 30, Best test: 0.026764
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519580900669098, gen p mean: -0.10834577679634094, mean p set: 0.45253291726112366
loss_pred:0.015484025701880455, decouple_loss:0.0005226363427937031
The modified gen p mean: 0.451744943857193, gen p mean: -0.1106768548488617, mean p set: 0.45232194662094116
loss_pred:0.015399935655295849, decouple_loss:0.0006115786964073777
The modified gen p mean: 0.4502715468406677, gen p mean: -0.11577307432889938, mean p set: 0.45084765553474426
loss_pred:0.014999520033597946, decouple_loss:0.00046395539538934827
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485045075416565, gen p mean: -0.11416596919298172, mean p set: 0.44908010959625244
loss_pred:0.015882691368460655, decouple_loss:0.0005412553437054157
The modified gen p mean: 0.448471337556839, gen p mean: -0.11394608020782471, mean p set: 0.44904735684394836The modified gen p mean: 0.44877493381500244, gen p mean: -0.11370514333248138, mean p set: 0.44935014843940735
loss_pred:0.014710023067891598, decouple_loss:0.0007449835538864136
loss_pred:0.014644565992057323, decouple_loss:0.0007922787917777896
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852879643440247, gen p mean: -0.11444160342216492, mean p set: 0.44910362362861633
loss_pred:0.01552212331444025, decouple_loss:0.0004764916084241122
The modified gen p mean: 0.451712965965271, gen p mean: -0.1135006695985794, mean p set: 0.45228907465934753
loss_pred:0.015611449256539345, decouple_loss:0.0007379495655186474
The modified gen p mean: 0.4498060941696167, gen p mean: -0.12092622369527817, mean p set: 0.4503830373287201
loss_pred:0.014863134361803532, decouple_loss:0.000558994070161134
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45290637016296387, gen p mean: -0.10793798416852951, mean p set: 0.45348381996154785
loss_pred:0.01584652252495289, decouple_loss:0.0007659420371055603
The modified gen p mean: 0.4495069980621338, gen p mean: -0.11201473325490952, mean p set: 0.45008331537246704
loss_pred:0.015180956572294235, decouple_loss:0.0007053845911286771
The modified gen p mean: 0.4509863555431366, gen p mean: -0.10622473806142807, mean p set: 0.45156344771385193
loss_pred:0.015431801788508892, decouple_loss:0.0007604303536936641
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487701952457428, gen p mean: -0.10745204240083694, mean p set: 0.4493463933467865
loss_pred:0.016176754608750343, decouple_loss:0.000677355274092406
The modified gen p mean: 0.44887176156044006, gen p mean: -0.11245618760585785, mean p set: 0.4494488537311554
loss_pred:0.014890545979142189, decouple_loss:0.0006731420289725065
The modified gen p mean: 0.4513225853443146, gen p mean: -0.10849513858556747, mean p set: 0.45189690589904785
loss_pred:0.015099674463272095, decouple_loss:0.0006833822699263692
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969597458839417, gen p mean: -0.11132460832595825, mean p set: 0.45027193427085876
loss_pred:0.015693796798586845, decouple_loss:0.0007920724456198514
The modified gen p mean: 0.45031559467315674, gen p mean: -0.11682965606451035, mean p set: 0.4508911669254303
The modified gen p mean: 0.4500691294670105, gen p mean: -0.11665457487106323, mean p set: 0.450647234916687
loss_pred:0.015105889178812504, decouple_loss:0.0005943300202488899
loss_pred:0.015459681861102581, decouple_loss:0.0005790668074041605
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493109881877899, gen p mean: -0.12353749573230743, mean p set: 0.44988757371902466
loss_pred:0.01469709724187851, decouple_loss:0.0005354664172045887
The modified gen p mean: 0.4514259696006775, gen p mean: -0.11626603454351425, mean p set: 0.45200514793395996
The modified gen p mean: 0.4498765468597412, gen p mean: -0.12284249812364578, mean p set: 0.4504542350769043
loss_pred:0.015535595826804638, decouple_loss:0.0006515187560580671
loss_pred:0.015313283540308475, decouple_loss:0.00048191091627813876
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45088982582092285, gen p mean: -0.11012116819620132, mean p set: 0.4514676034450531
loss_pred:0.015392616391181946, decouple_loss:0.0008066284935921431
The modified gen p mean: 0.45180758833885193, gen p mean: -0.11765410006046295, mean p set: 0.4523826837539673
loss_pred:0.015502740629017353, decouple_loss:0.0008474719943478703
The modified gen p mean: 0.4503033757209778, gen p mean: -0.1102241650223732, mean p set: 0.4508790671825409
loss_pred:0.015438047237694263, decouple_loss:0.0007332523819059134
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495583474636078, gen p mean: -0.10770580172538757, mean p set: 0.45013532042503357
loss_pred:0.016011202707886696, decouple_loss:0.0007672747015021741
The modified gen p mean: 0.4503649175167084, gen p mean: -0.11883823573589325, mean p set: 0.45094096660614014
loss_pred:0.01509037520736456, decouple_loss:0.0005157412379048765
The modified gen p mean: 0.44896697998046875, gen p mean: -0.11234931647777557, mean p set: 0.44954198598861694
loss_pred:0.015391805209219456, decouple_loss:0.0005951460334472358
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501100778579712, gen p mean: -0.10708924382925034, mean p set: 0.45068594813346863
loss_pred:0.014987458474934101, decouple_loss:0.0005200129235163331
The modified gen p mean: 0.44930553436279297, gen p mean: -0.11317792534828186, mean p set: 0.44988009333610535
loss_pred:0.014248374849557877, decouple_loss:0.00047532800817862153
The modified gen p mean: 0.44915199279785156, gen p mean: -0.11376629769802094, mean p set: 0.4497282803058624
loss_pred:0.015028039924800396, decouple_loss:0.0005086527671664953
2023-05-02 02:55:14 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12093054503202438, mean p set: 0.4502691626548767
loss_pred:0.017413897439837456, decouple_loss:0.0006755407666787505
The modified gen p mean: 0.4495384097099304, gen p mean: -0.1153540089726448, mean p set: 0.4500633478164673
loss_pred:0.01664409600198269, decouple_loss:0.0006895919796079397
The modified gen p mean: 0.44977959990501404, gen p mean: -0.11515458673238754, mean p set: 0.45035696029663086
loss_pred:0.017009111121296883, decouple_loss:0.0005838573561049998
WV_1_PC_1_EH_0_PS_40, loss: 0.017054852098226547, avg_mse: 0.02650758996605873
current test mse: 0.026508
At step 40, Best test: 0.026508
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45101624727249146, gen p mean: -0.11205334961414337, mean p set: 0.4515925347805023
loss_pred:0.014920976012945175, decouple_loss:0.0009382021380588412
The modified gen p mean: 0.44853824377059937, gen p mean: -0.1079636737704277, mean p set: 0.4491138160228729
loss_pred:0.015422658994793892, decouple_loss:0.0008963824948295951
The modified gen p mean: 0.45033538341522217, gen p mean: -0.11333183199167252, mean p set: 0.45091089606285095
loss_pred:0.01526451762765646, decouple_loss:0.0008303058566525578
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772008061408997, gen p mean: -0.11713135987520218, mean p set: 0.44829609990119934
loss_pred:0.015694309026002884, decouple_loss:0.0005082391435280442
The modified gen p mean: 0.44837087392807007, gen p mean: -0.11144663393497467, mean p set: 0.4489456117153168The modified gen p mean: 0.45069265365600586, gen p mean: -0.11567379534244537, mean p set: 0.45127037167549133
loss_pred:0.015026457607746124, decouple_loss:0.0005807355046272278
loss_pred:0.015308375470340252, decouple_loss:0.0005514645017683506
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509701430797577, gen p mean: -0.11289340257644653, mean p set: 0.45154598355293274
loss_pred:0.015005990862846375, decouple_loss:0.0005172555684112012
The modified gen p mean: 0.4488128423690796, gen p mean: -0.10743875056505203, mean p set: 0.44938766956329346
loss_pred:0.014930925332009792, decouple_loss:0.00044338550651445985
The modified gen p mean: 0.4501439929008484, gen p mean: -0.10614274442195892, mean p set: 0.45072001218795776
loss_pred:0.01570930704474449, decouple_loss:0.0005876726936548948
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44944512844085693, gen p mean: -0.10705737769603729, mean p set: 0.4500221312046051
loss_pred:0.014717391692101955, decouple_loss:0.000609143462497741
The modified gen p mean: 0.447748601436615, gen p mean: -0.10913659632205963, mean p set: 0.4483225345611572
loss_pred:0.015590541996061802, decouple_loss:0.000806537747848779
The modified gen p mean: 0.451328843832016, gen p mean: -0.11293062567710876, mean p set: 0.4519057869911194
loss_pred:0.017596635967493057, decouple_loss:0.0007311729132197797
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493827223777771, gen p mean: -0.11211520433425903, mean p set: 0.4499594569206238
loss_pred:0.015033813193440437, decouple_loss:0.0005368443089537323
The modified gen p mean: 0.4488668143749237, gen p mean: -0.10738638043403625, mean p set: 0.4494428038597107
loss_pred:0.01543374639004469, decouple_loss:0.0005640409071929753
The modified gen p mean: 0.4520735442638397, gen p mean: -0.10901163518428802, mean p set: 0.4526497423648834
loss_pred:0.015207309275865555, decouple_loss:0.0005340547650121152
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909706711769104, gen p mean: -0.10370177030563354, mean p set: 0.44967135787010193
loss_pred:0.01578577421605587, decouple_loss:0.0005618803552351892
The modified gen p mean: 0.44940727949142456, gen p mean: -0.10757388174533844, mean p set: 0.4499855935573578
loss_pred:0.015221323817968369, decouple_loss:0.0004742503515444696
The modified gen p mean: 0.45031383633613586, gen p mean: -0.11522405594587326, mean p set: 0.450888991355896
loss_pred:0.015008961781859398, decouple_loss:0.00042375808698125184
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725918769836426, gen p mean: -0.1148080825805664, mean p set: 0.4478350281715393
loss_pred:0.015561388805508614, decouple_loss:0.0006009325734339654
The modified gen p mean: 0.44869768619537354, gen p mean: -0.10192586481571198, mean p set: 0.4492756426334381
loss_pred:0.016426632180809975, decouple_loss:0.0008018637890927494
The modified gen p mean: 0.4496779143810272, gen p mean: -0.10870818793773651, mean p set: 0.4502522349357605
loss_pred:0.014848902821540833, decouple_loss:0.0008126460597850382
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45053398609161377, gen p mean: -0.11170658469200134, mean p set: 0.451111376285553
loss_pred:0.014690373092889786, decouple_loss:0.0004805331991519779
The modified gen p mean: 0.44885799288749695, gen p mean: -0.11186594516038895, mean p set: 0.44943416118621826
loss_pred:0.01457996666431427, decouple_loss:0.00048151714145205915
The modified gen p mean: 0.4507547914981842, gen p mean: -0.10940662771463394, mean p set: 0.4513324499130249
loss_pred:0.014842238277196884, decouple_loss:0.0005113320075906813
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487951695919037, gen p mean: -0.10427279025316238, mean p set: 0.44937264919281006
loss_pred:0.015848102048039436, decouple_loss:0.0005925071891397238
The modified gen p mean: 0.44974422454833984, gen p mean: -0.11228282004594803, mean p set: 0.45031946897506714
loss_pred:0.015830060467123985, decouple_loss:0.0005781163345091045
The modified gen p mean: 0.4491371810436249, gen p mean: -0.10374774038791656, mean p set: 0.44971367716789246
loss_pred:0.01610497571527958, decouple_loss:0.0005292336572892964
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507385492324829, gen p mean: -0.106918565928936, mean p set: 0.45131269097328186
loss_pred:0.014563017524778843, decouple_loss:0.0005563251907005906
The modified gen p mean: 0.4496295750141144, gen p mean: -0.10416015237569809, mean p set: 0.45020708441734314
loss_pred:0.0159051064401865, decouple_loss:0.0006599152111448348
The modified gen p mean: 0.44984930753707886, gen p mean: -0.1046491414308548, mean p set: 0.4504237771034241
loss_pred:0.015445983968675137, decouple_loss:0.0008590197539888322
2023-05-02 02:58:07 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11926586925983429, mean p set: 0.4502691626548767
loss_pred:0.017243370413780212, decouple_loss:0.0008081811829470098
The modified gen p mean: 0.44953685998916626, gen p mean: -0.11340945214033127, mean p set: 0.4500633478164673
loss_pred:0.016463028267025948, decouple_loss:0.0007436570012941957
The modified gen p mean: 0.4497806429862976, gen p mean: -0.1128658726811409, mean p set: 0.45035696029663086
loss_pred:0.016865599900484085, decouple_loss:0.0009037083946168423
WV_1_PC_1_EH_0_PS_40, loss: 0.0168982595205307, avg_mse: 0.026254400610923767
current test mse: 0.026254
At step 50, Best test: 0.026254
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510328471660614, gen p mean: -0.11023584753274918, mean p set: 0.45161086320877075
loss_pred:0.015362883917987347, decouple_loss:0.0005602301680482924
The modified gen p mean: 0.45100027322769165, gen p mean: -0.10731961578130722, mean p set: 0.4515767991542816
loss_pred:0.0147956982254982, decouple_loss:0.0005574306123889983
The modified gen p mean: 0.45023125410079956, gen p mean: -0.11287695914506912, mean p set: 0.45080891251564026
loss_pred:0.015961041674017906, decouple_loss:0.0005916559603065252
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779321551322937, gen p mean: -0.10140698403120041, mean p set: 0.4483667314052582
loss_pred:0.015384156256914139, decouple_loss:0.0006948357331566513
The modified gen p mean: 0.4481455385684967, gen p mean: -0.10552345216274261, mean p set: 0.4487208127975464The modified gen p mean: 0.44938600063323975, gen p mean: -0.10708688199520111, mean p set: 0.4499596655368805
loss_pred:0.015058397315442562, decouple_loss:0.0006561956251971424
loss_pred:0.014767400920391083, decouple_loss:0.0005371001898311079
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477177858352661, gen p mean: -0.10753317922353745, mean p set: 0.44829264283180237
loss_pred:0.015103568322956562, decouple_loss:0.0005715720471926033
The modified gen p mean: 0.44954437017440796, gen p mean: -0.10711662471294403, mean p set: 0.45011985301971436
loss_pred:0.01473364606499672, decouple_loss:0.0005453876801766455
The modified gen p mean: 0.44914504885673523, gen p mean: -0.10642235726118088, mean p set: 0.4497230052947998
loss_pred:0.014833523891866207, decouple_loss:0.0006069487426429987
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501763880252838, gen p mean: -0.09820417314767838, mean p set: 0.45075252652168274
loss_pred:0.015377622097730637, decouple_loss:0.0005947636091150343
The modified gen p mean: 0.4475450813770294, gen p mean: -0.10652605444192886, mean p set: 0.44812071323394775
loss_pred:0.015100724995136261, decouple_loss:0.000544461072422564
The modified gen p mean: 0.45021966099739075, gen p mean: -0.1009434312582016, mean p set: 0.45079630613327026
loss_pred:0.015047887340188026, decouple_loss:0.0006467531784437597
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45014604926109314, gen p mean: -0.10201641172170639, mean p set: 0.4507228434085846
loss_pred:0.014878585934638977, decouple_loss:0.0005806793342344463
The modified gen p mean: 0.4484681189060211, gen p mean: -0.1024419292807579, mean p set: 0.44904619455337524
loss_pred:0.016147015616297722, decouple_loss:0.0007415806758217514
The modified gen p mean: 0.45038607716560364, gen p mean: -0.1021823137998581, mean p set: 0.4509623348712921
loss_pred:0.015589539892971516, decouple_loss:0.0008798922062851489
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476979076862335, gen p mean: -0.10570818185806274, mean p set: 0.4482741951942444
loss_pred:0.015323332510888577, decouple_loss:0.0007197107770480216
The modified gen p mean: 0.44984138011932373, gen p mean: -0.1085967868566513, mean p set: 0.45041805505752563
loss_pred:0.014629007317125797, decouple_loss:0.0006586696836166084
The modified gen p mean: 0.4514496922492981, gen p mean: -0.10365983098745346, mean p set: 0.45202508568763733
loss_pred:0.016835955902934074, decouple_loss:0.0005531150964088738
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45164743065834045, gen p mean: -0.1024000495672226, mean p set: 0.45222434401512146
loss_pred:0.01521345879882574, decouple_loss:0.0005381655064411461
The modified gen p mean: 0.4502291679382324, gen p mean: -0.0999729335308075, mean p set: 0.4508056342601776
The modified gen p mean: 0.44903919100761414, gen p mean: -0.09366961568593979, mean p set: 0.4496145248413086
loss_pred:0.014486823230981827, decouple_loss:0.0005833317991346121
loss_pred:0.01603255234658718, decouple_loss:0.0006036584381945431
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806715846061707, gen p mean: -0.10593146830797195, mean p set: 0.4486435651779175
loss_pred:0.014567905105650425, decouple_loss:0.0005892445333302021
The modified gen p mean: 0.44844457507133484, gen p mean: -0.10456027090549469, mean p set: 0.44901934266090393
The modified gen p mean: 0.4493594169616699, gen p mean: -0.10603027045726776, mean p set: 0.44993579387664795
loss_pred:0.01512809656560421, decouple_loss:0.0006487042992375791
loss_pred:0.014855355024337769, decouple_loss:0.0005509229958988726
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503606855869293, gen p mean: -0.10966432839632034, mean p set: 0.4509376883506775
The modified gen p mean: 0.4472840130329132, gen p mean: -0.11238279193639755, mean p set: 0.4478597342967987
loss_pred:0.014611253514885902, decouple_loss:0.0006578969187103212
loss_pred:0.015281627885997295, decouple_loss:0.0006634163437411189
The modified gen p mean: 0.4488256275653839, gen p mean: -0.09939031302928925, mean p set: 0.44940370321273804
loss_pred:0.015660768374800682, decouple_loss:0.0005419920780695975
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44946736097335815, gen p mean: -0.10888423770666122, mean p set: 0.4500446021556854
loss_pred:0.015463534742593765, decouple_loss:0.0005429648444987833
The modified gen p mean: 0.4472629129886627, gen p mean: -0.11152660101652145, mean p set: 0.44784078001976013
The modified gen p mean: 0.44890499114990234, gen p mean: -0.10917732119560242, mean p set: 0.44948288798332214
loss_pred:0.01494609098881483, decouple_loss:0.00043903375626541674
loss_pred:0.014751151204109192, decouple_loss:0.0004397029406391084
2023-05-02 03:00:21 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11876565217971802, mean p set: 0.4502691626548767
loss_pred:0.017169015482068062, decouple_loss:0.0005005658022128046
The modified gen p mean: 0.4495333433151245, gen p mean: -0.11302346736192703, mean p set: 0.4500633478164673
loss_pred:0.01648254506289959, decouple_loss:0.000747788930311799
The modified gen p mean: 0.44978219270706177, gen p mean: -0.11248373985290527, mean p set: 0.45035696029663086
loss_pred:0.016858482733368874, decouple_loss:0.0005084840231575072
WV_1_PC_1_EH_0_PS_40, loss: 0.016865961253643036, avg_mse: 0.02618018165230751
current test mse: 0.02618
At step 60, Best test: 0.02618
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
NaN value num: 0
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474847912788391, gen p mean: -0.11992567032575607, mean p set: 0.4480586349964142
loss_pred:0.016613205894827843, decouple_loss:0.000833757920190692
The modified gen p mean: 0.4468677043914795, gen p mean: -0.11598146706819534, mean p set: 0.44744521379470825
loss_pred:0.01640569604933262, decouple_loss:0.0005380277871154249
The modified gen p mean: 0.44750452041625977, gen p mean: -0.11614244431257248, mean p set: 0.4480820298194885
loss_pred:0.01617378368973732, decouple_loss:0.000587291200645268
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475290775299072, gen p mean: -0.10954847186803818, mean p set: 0.4481058716773987
loss_pred:0.016061026602983475, decouple_loss:0.0006010367069393396
The modified gen p mean: 0.4476630389690399, gen p mean: -0.11590489745140076, mean p set: 0.44823703169822693The modified gen p mean: 0.44759872555732727, gen p mean: -0.1170208752155304, mean p set: 0.44817492365837097
loss_pred:0.017454635351896286, decouple_loss:0.000544789363630116
loss_pred:0.015372458845376968, decouple_loss:0.0005253172130323946
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470113217830658, gen p mean: -0.11704212427139282, mean p set: 0.44758832454681396
loss_pred:0.01718168705701828, decouple_loss:0.0005986526375636458
The modified gen p mean: 0.4489250183105469, gen p mean: -0.11561528593301773, mean p set: 0.4494989514350891
loss_pred:0.016161205247044563, decouple_loss:0.0005352448206394911
The modified gen p mean: 0.44749024510383606, gen p mean: -0.11744196712970734, mean p set: 0.4480629861354828
loss_pred:0.01613379456102848, decouple_loss:0.0006563703645952046
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487236738204956, gen p mean: -0.11785121262073517, mean p set: 0.4492984712123871
loss_pred:0.015080153942108154, decouple_loss:0.0005211184616200626
The modified gen p mean: 0.4470028281211853, gen p mean: -0.11494030803442001, mean p set: 0.4475806653499603
loss_pred:0.01585840806365013, decouple_loss:0.0006279066437855363
The modified gen p mean: 0.44792988896369934, gen p mean: -0.11493496596813202, mean p set: 0.4485074579715729
loss_pred:0.015550117939710617, decouple_loss:0.0005235503194853663
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473729431629181, gen p mean: -0.12150349467992783, mean p set: 0.44795146584510803
loss_pred:0.015866711735725403, decouple_loss:0.0005687021766789258
The modified gen p mean: 0.4483703672885895, gen p mean: -0.11357670277357101, mean p set: 0.44894686341285706
loss_pred:0.01618027873337269, decouple_loss:0.0005940881092101336
The modified gen p mean: 0.44833654165267944, gen p mean: -0.11923438310623169, mean p set: 0.44891470670700073
loss_pred:0.015442712232470512, decouple_loss:0.0005830473965033889
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44633713364601135, gen p mean: -0.11607059836387634, mean p set: 0.4469138979911804
loss_pred:0.01720980554819107, decouple_loss:0.0005081570707261562
The modified gen p mean: 0.4469112157821655, gen p mean: -0.11863336712121964, mean p set: 0.44748660922050476
loss_pred:0.015679385513067245, decouple_loss:0.0005541791906580329
The modified gen p mean: 0.4471506178379059, gen p mean: -0.12046349048614502, mean p set: 0.4477272629737854
loss_pred:0.01609443500638008, decouple_loss:0.0006206453545019031
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474378824234009, gen p mean: -0.1277341991662979, mean p set: 0.4480130672454834
loss_pred:0.016102762892842293, decouple_loss:0.0006140589830465615
The modified gen p mean: 0.44753605127334595, gen p mean: -0.1249345913529396, mean p set: 0.44811269640922546
loss_pred:0.016235683113336563, decouple_loss:0.0005989876808598638
The modified gen p mean: 0.4454329311847687, gen p mean: -0.12026306241750717, mean p set: 0.4460088610649109
loss_pred:0.01620449312031269, decouple_loss:0.0004958952777087688
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478291869163513, gen p mean: -0.11887545138597488, mean p set: 0.4484068751335144
loss_pred:0.01572554185986519, decouple_loss:0.0006071581738069654
The modified gen p mean: 0.4469044804573059, gen p mean: -0.12658876180648804, mean p set: 0.44747960567474365
loss_pred:0.015250402502715588, decouple_loss:0.0005755893653258681
The modified gen p mean: 0.4473671317100525, gen p mean: -0.12643568217754364, mean p set: 0.4479452073574066
loss_pred:0.015439750626683235, decouple_loss:0.0004956646007485688
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464191794395447, gen p mean: -0.12230724841356277, mean p set: 0.4469919800758362
loss_pred:0.016867995262145996, decouple_loss:0.000526166579220444
The modified gen p mean: 0.4457065761089325, gen p mean: -0.12823227047920227, mean p set: 0.44628140330314636
loss_pred:0.0160926952958107, decouple_loss:0.0005880212411284447
The modified gen p mean: 0.4489533305168152, gen p mean: -0.1257537603378296, mean p set: 0.4495314955711365
loss_pred:0.016381563618779182, decouple_loss:0.0005666872602887452
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743722677230835, gen p mean: -0.1282605528831482, mean p set: 0.448015421628952
loss_pred:0.015181695111095905, decouple_loss:0.0004849670804105699
The modified gen p mean: 0.4483162760734558, gen p mean: -0.12956225872039795, mean p set: 0.4488913118839264
loss_pred:0.01569324918091297, decouple_loss:0.0006025275797583163
The modified gen p mean: 0.446786493062973, gen p mean: -0.12869416177272797, mean p set: 0.4473629891872406
loss_pred:0.015914810821413994, decouple_loss:0.0005403180839493871
2023-05-02 03:03:11 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1283334493637085, mean p set: 0.4502691626548767
loss_pred:0.017114581540226936, decouple_loss:0.0005928385071456432
The modified gen p mean: 0.44953569769859314, gen p mean: -0.12158165127038956, mean p set: 0.4500633478164673
loss_pred:0.01645323447883129, decouple_loss:0.0006022839806973934
The modified gen p mean: 0.44977983832359314, gen p mean: -0.12130627036094666, mean p set: 0.45035696029663086
loss_pred:0.016803404316306114, decouple_loss:0.0005162598099559546
WV_1_PC_1_EH_0_PS_40, loss: 0.016818929463624954, avg_mse: 0.02617410197854042
current test mse: 0.026174
At step 70, Best test: 0.026174
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806623458862305, gen p mean: -0.1235257163643837, mean p set: 0.4486440122127533
loss_pred:0.016429180279374123, decouple_loss:0.0004991153837181628
The modified gen p mean: 0.44950559735298157, gen p mean: -0.12485861033201218, mean p set: 0.45008379220962524
loss_pred:0.015185411088168621, decouple_loss:0.00045441740076057613
The modified gen p mean: 0.4478900730609894, gen p mean: -0.1276056319475174, mean p set: 0.44846805930137634
loss_pred:0.016372961923480034, decouple_loss:0.00041335602873004973
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817277789115906, gen p mean: -0.12751516699790955, mean p set: 0.4487498700618744
loss_pred:0.015152956359088421, decouple_loss:0.000535609433427453
The modified gen p mean: 0.44745582342147827, gen p mean: -0.12584351003170013, mean p set: 0.4480300843715668The modified gen p mean: 0.44778913259506226, gen p mean: -0.12733161449432373, mean p set: 0.4483628571033478
loss_pred:0.01692521572113037, decouple_loss:0.0005828154389746487loss_pred:0.015400352887809277, decouple_loss:0.0006584282382391393
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474291205406189, gen p mean: -0.13094885647296906, mean p set: 0.44800424575805664
loss_pred:0.015299777500331402, decouple_loss:0.0005068957689218223
The modified gen p mean: 0.4478687047958374, gen p mean: -0.12527652084827423, mean p set: 0.44844383001327515The modified gen p mean: 0.4469245970249176, gen p mean: -0.12729674577713013, mean p set: 0.4474983811378479
loss_pred:0.015088829211890697, decouple_loss:0.0005611021188087761
loss_pred:0.015908215194940567, decouple_loss:0.0005349773564375937
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806838035583496, gen p mean: -0.12247297167778015, mean p set: 0.4486467242240906
loss_pred:0.016130004078149796, decouple_loss:0.0004926127730868757
The modified gen p mean: 0.44838747382164, gen p mean: -0.12765194475650787, mean p set: 0.4489644169807434
loss_pred:0.015110134147107601, decouple_loss:0.0005407992284744978
The modified gen p mean: 0.44781941175460815, gen p mean: -0.1265181303024292, mean p set: 0.44839391112327576
loss_pred:0.015483016148209572, decouple_loss:0.0005683982744812965
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780051708221436, gen p mean: -0.11347148567438126, mean p set: 0.4483754336833954
loss_pred:0.01599131152033806, decouple_loss:0.000531631987541914
The modified gen p mean: 0.44674572348594666, gen p mean: -0.1201169490814209, mean p set: 0.4473235011100769
loss_pred:0.01700509525835514, decouple_loss:0.0005492841592058539
The modified gen p mean: 0.44746431708335876, gen p mean: -0.1187073215842247, mean p set: 0.4480408728122711
loss_pred:0.016397545114159584, decouple_loss:0.0006024208851158619
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830068945884705, gen p mean: -0.11922947317361832, mean p set: 0.448879599571228
loss_pred:0.01569305546581745, decouple_loss:0.0004992880276404321
The modified gen p mean: 0.44718965888023376, gen p mean: -0.11491109430789948, mean p set: 0.44776758551597595
loss_pred:0.016088606789708138, decouple_loss:0.0005106261814944446
The modified gen p mean: 0.44765958189964294, gen p mean: -0.11218249052762985, mean p set: 0.4482339918613434
loss_pred:0.01596236228942871, decouple_loss:0.0005416609928943217
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777336716651917, gen p mean: -0.12392900139093399, mean p set: 0.44834744930267334
loss_pred:0.016228439286351204, decouple_loss:0.0006462048040702939
The modified gen p mean: 0.4482579827308655, gen p mean: -0.12468328326940536, mean p set: 0.44883236289024353
loss_pred:0.01599503494799137, decouple_loss:0.0005371232982724905
The modified gen p mean: 0.4493738114833832, gen p mean: -0.1244332566857338, mean p set: 0.44994887709617615
loss_pred:0.015622414648532867, decouple_loss:0.0006067289505153894
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473976492881775, gen p mean: -0.1288730800151825, mean p set: 0.44797322154045105
loss_pred:0.016074884682893753, decouple_loss:0.0006640356150455773
The modified gen p mean: 0.4477722942829132, gen p mean: -0.1281423568725586, mean p set: 0.44834810495376587
loss_pred:0.0159989632666111, decouple_loss:0.0007024022052064538
The modified gen p mean: 0.4467829167842865, gen p mean: -0.12576550245285034, mean p set: 0.44735774397850037
loss_pred:0.015873976051807404, decouple_loss:0.0006025298498570919
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779014587402344, gen p mean: -0.1211196780204773, mean p set: 0.44836878776550293
loss_pred:0.015643512830138206, decouple_loss:0.0005990804056636989
The modified gen p mean: 0.4468146860599518, gen p mean: -0.12107988446950912, mean p set: 0.4473893940448761
loss_pred:0.016216441988945007, decouple_loss:0.0005023856647312641
The modified gen p mean: 0.4460160732269287, gen p mean: -0.12554381787776947, mean p set: 0.4465877413749695
loss_pred:0.01597895286977291, decouple_loss:0.0004106444539502263
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818904995918274, gen p mean: -0.12286607921123505, mean p set: 0.44876575469970703
loss_pred:0.015676582232117653, decouple_loss:0.0007405398064292967
The modified gen p mean: 0.44831040501594543, gen p mean: -0.12586361169815063, mean p set: 0.4488873779773712
loss_pred:0.016205506399273872, decouple_loss:0.0007233402575366199
The modified gen p mean: 0.4474634528160095, gen p mean: -0.12367402017116547, mean p set: 0.44804099202156067
loss_pred:0.015712589025497437, decouple_loss:0.0007058912888169289
2023-05-02 03:05:23 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1283433884382248, mean p set: 0.4502691626548767
loss_pred:0.017090128734707832, decouple_loss:0.0005376902990974486
The modified gen p mean: 0.4495336711406708, gen p mean: -0.12181321531534195, mean p set: 0.4500633478164673
loss_pred:0.016444582492113113, decouple_loss:0.000598667364101857
The modified gen p mean: 0.4497789442539215, gen p mean: -0.1217661052942276, mean p set: 0.45035696029663086
loss_pred:0.016725851222872734, decouple_loss:0.0005851692403666675
WV_1_PC_1_EH_0_PS_40, loss: 0.016782213002443314, avg_mse: 0.026138560846447945
current test mse: 0.026139
At step 80, Best test: 0.026139
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960227608680725, gen p mean: -0.1224750354886055, mean p set: 0.45017993450164795
loss_pred:0.01625159941613674, decouple_loss:0.00046940939500927925
The modified gen p mean: 0.4494623839855194, gen p mean: -0.12387242168188095, mean p set: 0.4500381648540497
loss_pred:0.0159597285091877, decouple_loss:0.00042022878187708557
The modified gen p mean: 0.44949084520339966, gen p mean: -0.12304046005010605, mean p set: 0.45006564259529114
loss_pred:0.016180245205760002, decouple_loss:0.00046317436499521136
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500112235546112, gen p mean: -0.12395491451025009, mean p set: 0.45058757066726685
loss_pred:0.01638469472527504, decouple_loss:0.0004787593788933009
The modified gen p mean: 0.44880273938179016, gen p mean: -0.12172562628984451, mean p set: 0.4493815302848816The modified gen p mean: 0.45009884238243103, gen p mean: -0.11445396393537521, mean p set: 0.45067691802978516
loss_pred:0.016501938924193382, decouple_loss:0.0004946752451360226
loss_pred:0.016675464808940887, decouple_loss:0.0006098258309066296
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931089878082275, gen p mean: -0.11939145624637604, mean p set: 0.44988352060317993
loss_pred:0.015245022252202034, decouple_loss:0.0005910975160077214
The modified gen p mean: 0.44937583804130554, gen p mean: -0.11530801653862, mean p set: 0.44995349645614624
loss_pred:0.01624215394258499, decouple_loss:0.00047530586016364396
The modified gen p mean: 0.4503507614135742, gen p mean: -0.11513671278953552, mean p set: 0.45092761516571045
loss_pred:0.016466282308101654, decouple_loss:0.0005338836344890296
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851410388946533, gen p mean: -0.1190066784620285, mean p set: 0.4490925073623657
loss_pred:0.016549639403820038, decouple_loss:0.0006495548295788467
The modified gen p mean: 0.4496307075023651, gen p mean: -0.12201207131147385, mean p set: 0.4502067267894745
loss_pred:0.01587582938373089, decouple_loss:0.000608096132054925
The modified gen p mean: 0.4502466917037964, gen p mean: -0.12155815213918686, mean p set: 0.4508230984210968
loss_pred:0.016212327405810356, decouple_loss:0.0005308149848133326
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45007237792015076, gen p mean: -0.11587882041931152, mean p set: 0.4506498873233795
loss_pred:0.016537146642804146, decouple_loss:0.0004555915656965226
The modified gen p mean: 0.4507349729537964, gen p mean: -0.12506884336471558, mean p set: 0.4513084292411804
loss_pred:0.01644405908882618, decouple_loss:0.0004840700712520629
The modified gen p mean: 0.4505002498626709, gen p mean: -0.11729839444160461, mean p set: 0.4510757029056549
loss_pred:0.016880564391613007, decouple_loss:0.000535229395609349
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803541898727417, gen p mean: -0.11822252720594406, mean p set: 0.448609322309494
loss_pred:0.016535628587007523, decouple_loss:0.00047574195195920765
The modified gen p mean: 0.4492550790309906, gen p mean: -0.11829213798046112, mean p set: 0.4498307406902313
loss_pred:0.015607769601047039, decouple_loss:0.00042513912194408476
The modified gen p mean: 0.44923800230026245, gen p mean: -0.11716033518314362, mean p set: 0.4498143792152405
loss_pred:0.016126595437526703, decouple_loss:0.00046477050636895
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501418173313141, gen p mean: -0.11864130944013596, mean p set: 0.4507182538509369
loss_pred:0.015716450288891792, decouple_loss:0.0005431185127235949
The modified gen p mean: 0.4497060179710388, gen p mean: -0.11926362663507462, mean p set: 0.4502823054790497
loss_pred:0.01617601327598095, decouple_loss:0.0004479449416976422
The modified gen p mean: 0.4492543339729309, gen p mean: -0.11478762328624725, mean p set: 0.4498307704925537
loss_pred:0.01626867800951004, decouple_loss:0.0005390188307501376
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44912251830101013, gen p mean: -0.1137988492846489, mean p set: 0.4496990144252777
loss_pred:0.01653268374502659, decouple_loss:0.0004798051668331027
The modified gen p mean: 0.4501621425151825, gen p mean: -0.1167299896478653, mean p set: 0.45073747634887695
loss_pred:0.016828184947371483, decouple_loss:0.0004971310845576227
The modified gen p mean: 0.44858822226524353, gen p mean: -0.11697658896446228, mean p set: 0.4491656422615051
loss_pred:0.016448959708213806, decouple_loss:0.0004795677086804062
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503714442253113, gen p mean: -0.11433577537536621, mean p set: 0.4509483277797699
loss_pred:0.017028599977493286, decouple_loss:0.0004947920679114759
The modified gen p mean: 0.44983822107315063, gen p mean: -0.10745393484830856, mean p set: 0.4504148066043854
loss_pred:0.01659366488456726, decouple_loss:0.0004751325468532741
The modified gen p mean: 0.44915884733200073, gen p mean: -0.11536215245723724, mean p set: 0.44973650574684143
loss_pred:0.015788402408361435, decouple_loss:0.0005191616946831346
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505266845226288, gen p mean: -0.11040954291820526, mean p set: 0.451102077960968
loss_pred:0.015867559239268303, decouple_loss:0.00044337750296108425
The modified gen p mean: 0.4495638906955719, gen p mean: -0.12118276953697205, mean p set: 0.4501415491104126
The modified gen p mean: 0.45042628049850464, gen p mean: -0.11860755831003189, mean p set: 0.4510018229484558
loss_pred:0.01579928956925869, decouple_loss:0.00045918227988295257
loss_pred:0.017204860225319862, decouple_loss:0.00041958410292863846
2023-05-02 03:08:16 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11997286230325699, mean p set: 0.4502691626548767
loss_pred:0.016945376992225647, decouple_loss:0.0004719305725302547
The modified gen p mean: 0.4495338797569275, gen p mean: -0.1133364588022232, mean p set: 0.4500633478164673
loss_pred:0.01626013033092022, decouple_loss:0.0004598850791808218
The modified gen p mean: 0.44978055357933044, gen p mean: -0.11347103863954544, mean p set: 0.45035696029663086
loss_pred:0.016574226319789886, decouple_loss:0.0004557906067930162
WV_1_PC_1_EH_0_PS_40, loss: 0.016616372391581535, avg_mse: 0.02582002803683281
current test mse: 0.02582
At step 90, Best test: 0.02582
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481174647808075, gen p mean: -0.11320161819458008, mean p set: 0.4486955404281616
loss_pred:0.0162690170109272, decouple_loss:0.0005556736141443253
The modified gen p mean: 0.44887396693229675, gen p mean: -0.11678851395845413, mean p set: 0.44944941997528076
loss_pred:0.016052840277552605, decouple_loss:0.00044332011020742357
The modified gen p mean: 0.45005032420158386, gen p mean: -0.11547403037548065, mean p set: 0.45062586665153503
loss_pred:0.01633346453309059, decouple_loss:0.0004677571705542505
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500580430030823, gen p mean: -0.11055458337068558, mean p set: 0.4506319463253021
loss_pred:0.016050688922405243, decouple_loss:0.0004741052398458123
The modified gen p mean: 0.4505925178527832, gen p mean: -0.11128445714712143, mean p set: 0.45116761326789856The modified gen p mean: 0.4501853585243225, gen p mean: -0.10762541741132736, mean p set: 0.4507621228694916
loss_pred:0.01653113402426243, decouple_loss:0.0005780906649306417
loss_pred:0.01653062365949154, decouple_loss:0.0005417765351012349
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493456184864044, gen p mean: -0.11348661035299301, mean p set: 0.4499199688434601
loss_pred:0.01579354889690876, decouple_loss:0.0004026917740702629
The modified gen p mean: 0.4496804475784302, gen p mean: -0.11032433062791824, mean p set: 0.4502556622028351The modified gen p mean: 0.4492575526237488, gen p mean: -0.1150013878941536, mean p set: 0.4498342275619507
loss_pred:0.016330324113368988, decouple_loss:0.0004430481931194663
loss_pred:0.015988409519195557, decouple_loss:0.00039455725345760584
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861704111099243, gen p mean: -0.11656507849693298, mean p set: 0.4491916298866272
loss_pred:0.01618109829723835, decouple_loss:0.0004802322946488857
The modified gen p mean: 0.44861507415771484, gen p mean: -0.12541529536247253, mean p set: 0.4491928219795227
loss_pred:0.015681728720664978, decouple_loss:0.0004947172128595412
The modified gen p mean: 0.4506816267967224, gen p mean: -0.11957082152366638, mean p set: 0.4512575566768646
loss_pred:0.016135621815919876, decouple_loss:0.0004568933800328523
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901198148727417, gen p mean: -0.11511333286762238, mean p set: 0.4495888352394104
loss_pred:0.015930375084280968, decouple_loss:0.00046704636770300567
The modified gen p mean: 0.44862693548202515, gen p mean: -0.12073881924152374, mean p set: 0.4492048919200897
loss_pred:0.015729302540421486, decouple_loss:0.0004739559080917388
The modified gen p mean: 0.45004189014434814, gen p mean: -0.12580549716949463, mean p set: 0.4506154954433441
loss_pred:0.01629558578133583, decouple_loss:0.0005096004460938275
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502851366996765, gen p mean: -0.11633747071027756, mean p set: 0.4508611261844635
loss_pred:0.01638158969581127, decouple_loss:0.0005741673521697521
The modified gen p mean: 0.4492295980453491, gen p mean: -0.11942826211452484, mean p set: 0.4498046338558197
loss_pred:0.016412122175097466, decouple_loss:0.0006957109435461462
The modified gen p mean: 0.4506945312023163, gen p mean: -0.12435271590948105, mean p set: 0.45127072930336
loss_pred:0.01618644781410694, decouple_loss:0.00042449490865692496
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45061853528022766, gen p mean: -0.12033902108669281, mean p set: 0.4511975646018982
loss_pred:0.015487137250602245, decouple_loss:0.0005248876987025142
The modified gen p mean: 0.4495704472064972, gen p mean: -0.12237019091844559, mean p set: 0.45014673471450806
loss_pred:0.01579766534268856, decouple_loss:0.0004592078039422631
The modified gen p mean: 0.44903749227523804, gen p mean: -0.1237194761633873, mean p set: 0.4496159553527832
loss_pred:0.016003403812646866, decouple_loss:0.00039617883157916367
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491519331932068, gen p mean: -0.1173485741019249, mean p set: 0.44972866773605347
loss_pred:0.016535809263586998, decouple_loss:0.00044931398588232696
The modified gen p mean: 0.4498058259487152, gen p mean: -0.1184254065155983, mean p set: 0.45038241147994995
loss_pred:0.015824727714061737, decouple_loss:0.0004602031549438834
The modified gen p mean: 0.4497676193714142, gen p mean: -0.1229904294013977, mean p set: 0.4503425657749176
loss_pred:0.015477007254958153, decouple_loss:0.0004092159797437489
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44998612999916077, gen p mean: -0.1256762593984604, mean p set: 0.45056453347206116
loss_pred:0.016661617904901505, decouple_loss:0.0005597195122390985
The modified gen p mean: 0.44979146122932434, gen p mean: -0.12284111976623535, mean p set: 0.45036831498146057
loss_pred:0.01597958616912365, decouple_loss:0.000475004460895434
The modified gen p mean: 0.45000967383384705, gen p mean: -0.1331978291273117, mean p set: 0.450583815574646
loss_pred:0.016390027478337288, decouple_loss:0.0005601332522928715
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511418342590332, gen p mean: -0.12134743481874466, mean p set: 0.4517151713371277
loss_pred:0.01634874939918518, decouple_loss:0.00044426004751585424
The modified gen p mean: 0.4495605230331421, gen p mean: -0.12182456254959106, mean p set: 0.450135201215744
loss_pred:0.015449684113264084, decouple_loss:0.00048311310820281506
The modified gen p mean: 0.4489559531211853, gen p mean: -0.12332911789417267, mean p set: 0.44952836632728577
loss_pred:0.015642451122403145, decouple_loss:0.00047246975009329617
2023-05-02 03:10:28 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12671007215976715, mean p set: 0.4502691626548767
loss_pred:0.01699385792016983, decouple_loss:0.0004284231981728226
The modified gen p mean: 0.4495347738265991, gen p mean: -0.12167782336473465, mean p set: 0.4500633478164673
loss_pred:0.01622578501701355, decouple_loss:0.0005511688650585711
The modified gen p mean: 0.44977837800979614, gen p mean: -0.12097711116075516, mean p set: 0.45035696029663086
loss_pred:0.01658247783780098, decouple_loss:0.0004683762963395566
WV_1_PC_1_EH_0_PS_40, loss: 0.01662484183907509, avg_mse: 0.02586330473423004
current test mse: 0.025863
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
NaN value num: 0
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511394500732422, gen p mean: -0.11340069770812988, mean p set: 0.4517159163951874
loss_pred:0.015996187925338745, decouple_loss:0.0007964092656038702
The modified gen p mean: 0.45132845640182495, gen p mean: -0.11038105934858322, mean p set: 0.4519054889678955
loss_pred:0.014839285053312778, decouple_loss:0.0006679365178570151
The modified gen p mean: 0.45077523589134216, gen p mean: -0.1137922927737236, mean p set: 0.4513528347015381
loss_pred:0.01608526147902012, decouple_loss:0.0007784947520121932
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45275670289993286, gen p mean: -0.10414913296699524, mean p set: 0.4533340632915497
loss_pred:0.015314176678657532, decouple_loss:0.0005150832002982497
The modified gen p mean: 0.4527040421962738, gen p mean: -0.10463498532772064, mean p set: 0.45328083634376526The modified gen p mean: 0.45195627212524414, gen p mean: -0.10588324069976807, mean p set: 0.4525352716445923
loss_pred:0.015438556671142578, decouple_loss:0.0005606109043583274
loss_pred:0.015630727633833885, decouple_loss:0.0005456294748000801
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45091259479522705, gen p mean: -0.10111141204833984, mean p set: 0.45148876309394836
loss_pred:0.015493998304009438, decouple_loss:0.0007665312150493264
The modified gen p mean: 0.45349451899528503, gen p mean: -0.10733891278505325, mean p set: 0.4540724456310272
loss_pred:0.015069243498146534, decouple_loss:0.0007374120759777725
The modified gen p mean: 0.4525165259838104, gen p mean: -0.10200425237417221, mean p set: 0.4530937969684601
loss_pred:0.015274842269718647, decouple_loss:0.0006094696000218391
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45188748836517334, gen p mean: -0.10719658434391022, mean p set: 0.45246621966362
loss_pred:0.015357055701315403, decouple_loss:0.0006246452685445547
The modified gen p mean: 0.45185649394989014, gen p mean: -0.09958390891551971, mean p set: 0.4524320662021637
loss_pred:0.01509386021643877, decouple_loss:0.0004766519123222679
The modified gen p mean: 0.4521578848361969, gen p mean: -0.11081564426422119, mean p set: 0.4527343511581421
loss_pred:0.015513314865529537, decouple_loss:0.0006542658666148782
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104753971099854, gen p mean: -0.10334394127130508, mean p set: 0.4516242742538452
loss_pred:0.015462450683116913, decouple_loss:0.0004753540561068803
The modified gen p mean: 0.45236489176750183, gen p mean: -0.10549988597631454, mean p set: 0.45294511318206787
loss_pred:0.014774509705603123, decouple_loss:0.0004367887740954757
The modified gen p mean: 0.4531773030757904, gen p mean: -0.10769841820001602, mean p set: 0.45375576615333557
loss_pred:0.014445541426539421, decouple_loss:0.00047568249283358455
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104193687438965, gen p mean: -0.11251141130924225, mean p set: 0.4516180753707886
loss_pred:0.015102031640708447, decouple_loss:0.000624236767180264
The modified gen p mean: 0.45258259773254395, gen p mean: -0.10380983352661133, mean p set: 0.45316070318222046
loss_pred:0.014888529665768147, decouple_loss:0.0005219682934693992
The modified gen p mean: 0.45248860120773315, gen p mean: -0.10863322764635086, mean p set: 0.45306602120399475
loss_pred:0.01511040236800909, decouple_loss:0.0005738547770306468
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524959623813629, gen p mean: -0.10485490411520004, mean p set: 0.4530712962150574
loss_pred:0.014671326614916325, decouple_loss:0.0007311457302421331
The modified gen p mean: 0.45316556096076965, gen p mean: -0.11088471114635468, mean p set: 0.45374393463134766
loss_pred:0.014582567848265171, decouple_loss:0.0006284282426349819
The modified gen p mean: 0.45107677578926086, gen p mean: -0.10714170336723328, mean p set: 0.4516550898551941
loss_pred:0.015135182067751884, decouple_loss:0.0005054491921328008
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523744285106659, gen p mean: -0.11264713108539581, mean p set: 0.45295095443725586
loss_pred:0.014975043013691902, decouple_loss:0.0005754027515649796
The modified gen p mean: 0.45121490955352783, gen p mean: -0.10405196994543076, mean p set: 0.4517918825149536
loss_pred:0.014938374981284142, decouple_loss:0.0006255295593291521
The modified gen p mean: 0.45159462094306946, gen p mean: -0.1097087413072586, mean p set: 0.4521713852882385
loss_pred:0.014464128762483597, decouple_loss:0.0005195355042815208
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108452439308167, gen p mean: -0.10592188686132431, mean p set: 0.45166051387786865
loss_pred:0.015012743882834911, decouple_loss:0.000509407022036612
The modified gen p mean: 0.4519962668418884, gen p mean: -0.10545080155134201, mean p set: 0.45257216691970825
loss_pred:0.014577739872038364, decouple_loss:0.0005067256279289722
The modified gen p mean: 0.4524535536766052, gen p mean: -0.11045533418655396, mean p set: 0.4530309736728668
loss_pred:0.01503477431833744, decouple_loss:0.0007253708899952471
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490162134170532, gen p mean: -0.1093207597732544, mean p set: 0.44959282875061035
loss_pred:0.015674015507102013, decouple_loss:0.0007571942405775189
The modified gen p mean: 0.4505080282688141, gen p mean: -0.11442912369966507, mean p set: 0.45108485221862793
loss_pred:0.01505033578723669, decouple_loss:0.0005817236960865557
The modified gen p mean: 0.4502240717411041, gen p mean: -0.10863221436738968, mean p set: 0.45080041885375977
loss_pred:0.015524561516940594, decouple_loss:0.0006726285791955888
2023-05-02 03:13:11 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11960726231336594, mean p set: 0.4502691626548767
loss_pred:0.016970021650195122, decouple_loss:0.0006428598426282406
The modified gen p mean: 0.44953402876853943, gen p mean: -0.11430549621582031, mean p set: 0.4500633478164673
loss_pred:0.016293244436383247, decouple_loss:0.0005980244604870677
The modified gen p mean: 0.44978007674217224, gen p mean: -0.11401336640119553, mean p set: 0.45035696029663086
loss_pred:0.01672150008380413, decouple_loss:0.000554719939827919
WV_1_PC_1_EH_0_PS_40, loss: 0.01669151708483696, avg_mse: 0.026025068014860153
current test mse: 0.026025
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495508074760437, gen p mean: -0.10431105643510818, mean p set: 0.4501282274723053
loss_pred:0.015623372048139572, decouple_loss:0.00047174704377539456
The modified gen p mean: 0.4496646523475647, gen p mean: -0.10429782420396805, mean p set: 0.45023927092552185The modified gen p mean: 0.4508766829967499, gen p mean: -0.1047208234667778, mean p set: 0.4514535665512085
loss_pred:0.01627989672124386, decouple_loss:0.000654187286272645loss_pred:0.015252355486154556, decouple_loss:0.0005607833154499531
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452595978975296, gen p mean: -0.11190072447061539, mean p set: 0.45317476987838745
loss_pred:0.014734838157892227, decouple_loss:0.000605954322963953
The modified gen p mean: 0.4526677429676056, gen p mean: -0.11074956506490707, mean p set: 0.45324212312698364The modified gen p mean: 0.4515756368637085, gen p mean: -0.10733787715435028, mean p set: 0.4521520435810089
loss_pred:0.014428073540329933, decouple_loss:0.0006613569566980004loss_pred:0.015026715584099293, decouple_loss:0.0005278910393826663
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507189095020294, gen p mean: -0.1157321184873581, mean p set: 0.4512959122657776
loss_pred:0.01458832435309887, decouple_loss:0.0004557686042971909
The modified gen p mean: 0.4494021534919739, gen p mean: -0.10901129245758057, mean p set: 0.44997847080230713
loss_pred:0.015402079559862614, decouple_loss:0.0004895316087640822
The modified gen p mean: 0.4516587555408478, gen p mean: -0.10393643379211426, mean p set: 0.4522334337234497
loss_pred:0.015321115963160992, decouple_loss:0.0006550287362188101
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522263705730438, gen p mean: -0.11177238821983337, mean p set: 0.45280560851097107
loss_pred:0.014540813863277435, decouple_loss:0.0005303219659253955
The modified gen p mean: 0.45253658294677734, gen p mean: -0.11397858709096909, mean p set: 0.45311427116394043
loss_pred:0.014883308671414852, decouple_loss:0.0006817269022576511
The modified gen p mean: 0.4519731402397156, gen p mean: -0.10515138506889343, mean p set: 0.45254871249198914
loss_pred:0.015719201415777206, decouple_loss:0.0005023358971811831
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451193243265152, gen p mean: -0.1098140999674797, mean p set: 0.45177099108695984
loss_pred:0.015293264761567116, decouple_loss:0.0005886257858946919
The modified gen p mean: 0.45195430517196655, gen p mean: -0.10225626081228256, mean p set: 0.45252999663352966
loss_pred:0.014802142046391964, decouple_loss:0.0005156318657100201
The modified gen p mean: 0.44916409254074097, gen p mean: -0.11102449148893356, mean p set: 0.44974127411842346
loss_pred:0.01558059174567461, decouple_loss:0.0005776838515885174
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503309726715088, gen p mean: -0.10708904266357422, mean p set: 0.4509062170982361
loss_pred:0.0157413799315691, decouple_loss:0.0008290010155178607
The modified gen p mean: 0.45108404755592346, gen p mean: -0.1020958423614502, mean p set: 0.45165982842445374
loss_pred:0.015085379593074322, decouple_loss:0.0006312813493423164
The modified gen p mean: 0.4520309865474701, gen p mean: -0.11191646754741669, mean p set: 0.45260855555534363
loss_pred:0.014406900852918625, decouple_loss:0.0010249605402350426
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499324858188629, gen p mean: -0.10628212988376617, mean p set: 0.4505091905593872
loss_pred:0.01607329770922661, decouple_loss:0.0004741387674584985
The modified gen p mean: 0.45063725113868713, gen p mean: -0.10560066998004913, mean p set: 0.4512145519256592
loss_pred:0.015375287272036076, decouple_loss:0.0006140440818853676
The modified gen p mean: 0.45384934544563293, gen p mean: -0.10613784939050674, mean p set: 0.4544260501861572
loss_pred:0.015124989673495293, decouple_loss:0.0007108910940587521
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990843534469604, gen p mean: -0.10211779177188873, mean p set: 0.4504847228527069
loss_pred:0.016235463321208954, decouple_loss:0.000669457484036684
The modified gen p mean: 0.45158565044403076, gen p mean: -0.10090013593435287, mean p set: 0.4521639347076416
The modified gen p mean: 0.45006564259529114, gen p mean: -0.10245955735445023, mean p set: 0.4506414532661438
loss_pred:0.015051953494548798, decouple_loss:0.0005415584892034531
loss_pred:0.015521877445280552, decouple_loss:0.0006288397125899792
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44944676756858826, gen p mean: -0.09969224035739899, mean p set: 0.4500231444835663
loss_pred:0.01592838577926159, decouple_loss:0.0009948533261194825
The modified gen p mean: 0.45080748200416565, gen p mean: -0.10311023890972137, mean p set: 0.4513835310935974
loss_pred:0.015503683127462864, decouple_loss:0.00096986343851313
The modified gen p mean: 0.4549793004989624, gen p mean: -0.10284274071455002, mean p set: 0.4555578827857971
loss_pred:0.015195165760815144, decouple_loss:0.000672299531288445
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
NaN value num: 0
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114755630493164, gen p mean: -0.10011512041091919, mean p set: 0.4517255127429962
loss_pred:0.014921923168003559, decouple_loss:0.000872042786795646
The modified gen p mean: 0.45204025506973267, gen p mean: -0.10210855305194855, mean p set: 0.45261847972869873
The modified gen p mean: 0.45312029123306274, gen p mean: -0.09738771617412567, mean p set: 0.4536963999271393
loss_pred:0.015042897313833237, decouple_loss:0.0007253064541146159
loss_pred:0.01525487657636404, decouple_loss:0.0008626980124972761
2023-05-02 03:15:55 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12020539492368698, mean p set: 0.4502691626548767
loss_pred:0.016944175586104393, decouple_loss:0.0006032637902535498
The modified gen p mean: 0.4495331645011902, gen p mean: -0.11462821066379547, mean p set: 0.4500633478164673
loss_pred:0.01625244691967964, decouple_loss:0.0007669285987503827
The modified gen p mean: 0.44978073239326477, gen p mean: -0.11407741904258728, mean p set: 0.45035696029663086
loss_pred:0.016590163111686707, decouple_loss:0.0006657821941189468
WV_1_PC_1_EH_0_PS_40, loss: 0.016629528254270554, avg_mse: 0.025935577228665352
current test mse: 0.025936
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512507915496826, gen p mean: -0.10143821686506271, mean p set: 0.45182791352272034
loss_pred:0.015729157254099846, decouple_loss:0.0004349597729742527
The modified gen p mean: 0.4492948055267334, gen p mean: -0.10688424110412598, mean p set: 0.4498707354068756The modified gen p mean: 0.4487885534763336, gen p mean: -0.10690881311893463, mean p set: 0.4493648409843445
loss_pred:0.015222907066345215, decouple_loss:0.0005877564544789493
loss_pred:0.015017105266451836, decouple_loss:0.0005122749716974795
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45042356848716736, gen p mean: -0.1107746958732605, mean p set: 0.45099982619285583
loss_pred:0.0155063197016716, decouple_loss:0.0009918813593685627
The modified gen p mean: 0.44958779215812683, gen p mean: -0.11754558980464935, mean p set: 0.4501636028289795The modified gen p mean: 0.45144930481910706, gen p mean: -0.11479651182889938, mean p set: 0.4520263373851776
loss_pred:0.014906128868460655, decouple_loss:0.0006929499213583767
loss_pred:0.014550234191119671, decouple_loss:0.0007685408345423639
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901975989341736, gen p mean: -0.11320628225803375, mean p set: 0.44959568977355957
loss_pred:0.015197809785604477, decouple_loss:0.0008307987591251731
The modified gen p mean: 0.4513944089412689, gen p mean: -0.11109659075737, mean p set: 0.4519725739955902
loss_pred:0.015563600696623325, decouple_loss:0.0006458303541876376
The modified gen p mean: 0.44969990849494934, gen p mean: -0.11995993554592133, mean p set: 0.4502776563167572
loss_pred:0.014812137000262737, decouple_loss:0.0007962523959577084
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450752317905426, gen p mean: -0.1196141391992569, mean p set: 0.45132896304130554
loss_pred:0.015290853567421436, decouple_loss:0.0006782735581509769
The modified gen p mean: 0.4514675736427307, gen p mean: -0.11986023932695389, mean p set: 0.4520416855812073
loss_pred:0.015228263102471828, decouple_loss:0.0006379639962688088
The modified gen p mean: 0.45067015290260315, gen p mean: -0.11417527496814728, mean p set: 0.45124614238739014
loss_pred:0.01540749054402113, decouple_loss:0.0005955566884949803
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503610134124756, gen p mean: -0.11252155154943466, mean p set: 0.4509369134902954
loss_pred:0.015439302660524845, decouple_loss:0.0005576687399297953
The modified gen p mean: 0.4515147805213928, gen p mean: -0.11825201660394669, mean p set: 0.452089786529541
loss_pred:0.014201714657247066, decouple_loss:0.0007777114515192807
The modified gen p mean: 0.4496833384037018, gen p mean: -0.12218058854341507, mean p set: 0.4502570331096649
loss_pred:0.015344848856329918, decouple_loss:0.0005390167352743447
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516356587409973, gen p mean: -0.123868927359581, mean p set: 0.45221275091171265
loss_pred:0.014914306811988354, decouple_loss:0.0006766596343368292
The modified gen p mean: 0.4522687792778015, gen p mean: -0.12341411411762238, mean p set: 0.45284390449523926
The modified gen p mean: 0.4504437744617462, gen p mean: -0.11884503066539764, mean p set: 0.4510199725627899
loss_pred:0.014859804883599281, decouple_loss:0.0008758215699344873
loss_pred:0.015081669203937054, decouple_loss:0.0008384897955693305
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45116397738456726, gen p mean: -0.11809827387332916, mean p set: 0.451738178730011
loss_pred:0.014898515306413174, decouple_loss:0.0008535556262359023
The modified gen p mean: 0.44959086179733276, gen p mean: -0.11347690224647522, mean p set: 0.4501683712005615
The modified gen p mean: 0.4517267644405365, gen p mean: -0.11550983786582947, mean p set: 0.4523043632507324
loss_pred:0.015275740064680576, decouple_loss:0.0008296677842736244
loss_pred:0.014666647650301456, decouple_loss:0.0006981092155911028
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45050132274627686, gen p mean: -0.11662724614143372, mean p set: 0.45107904076576233
loss_pred:0.01482388935983181, decouple_loss:0.0004330463707447052
The modified gen p mean: 0.45124542713165283, gen p mean: -0.11896101385354996, mean p set: 0.4518203139305115
The modified gen p mean: 0.44995102286338806, gen p mean: -0.12497927993535995, mean p set: 0.45052674412727356
loss_pred:0.014727490022778511, decouple_loss:0.00046011051745153964
loss_pred:0.014602305367588997, decouple_loss:0.0006996630108915269
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525618553161621, gen p mean: -0.1180177703499794, mean p set: 0.45314162969589233
loss_pred:0.015052990056574345, decouple_loss:0.0006541811162605882
The modified gen p mean: 0.45260941982269287, gen p mean: -0.11858941614627838, mean p set: 0.45318490266799927
loss_pred:0.015160352922976017, decouple_loss:0.0005706297233700752
The modified gen p mean: 0.44901424646377563, gen p mean: -0.11925391852855682, mean p set: 0.4495902955532074
loss_pred:0.01459889393299818, decouple_loss:0.00045885302824899554
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45306596159935, gen p mean: -0.11670389026403427, mean p set: 0.4536430835723877
loss_pred:0.015154032036662102, decouple_loss:0.0009203383233398199
The modified gen p mean: 0.4514879882335663, gen p mean: -0.1183459535241127, mean p set: 0.45206621289253235
loss_pred:0.01461181789636612, decouple_loss:0.0006025344482623041
The modified gen p mean: 0.4508815407752991, gen p mean: -0.12013290822505951, mean p set: 0.4514558017253876
loss_pred:0.014977642334997654, decouple_loss:0.0007250721682794392
2023-05-02 03:18:04 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12980960309505463, mean p set: 0.4502691626548767
loss_pred:0.017076410353183746, decouple_loss:0.0005479753017425537
The modified gen p mean: 0.44953280687332153, gen p mean: -0.12412986904382706, mean p set: 0.4500633478164673
loss_pred:0.016609912738204002, decouple_loss:0.0008422687533311546
The modified gen p mean: 0.4497833549976349, gen p mean: -0.12354810535907745, mean p set: 0.45035696029663086
loss_pred:0.016793644055724144, decouple_loss:0.0007544467225670815
WV_1_PC_1_EH_0_PS_40, loss: 0.016862399876117706, avg_mse: 0.02617521584033966
current test mse: 0.026175
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504161477088928, gen p mean: -0.12300125509500504, mean p set: 0.45099470019340515
loss_pred:0.015102595090866089, decouple_loss:0.00045799207873642445
The modified gen p mean: 0.45132553577423096, gen p mean: -0.1157999113202095, mean p set: 0.4519027769565582
loss_pred:0.014300258830189705, decouple_loss:0.0007191385957412422
The modified gen p mean: 0.4521167576313019, gen p mean: -0.11787211149930954, mean p set: 0.45269572734832764
loss_pred:0.014485453255474567, decouple_loss:0.0006017967825755477
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121118426322937, gen p mean: -0.11704233288764954, mean p set: 0.45178547501564026
loss_pred:0.014526478946208954, decouple_loss:0.0006703617400489748
The modified gen p mean: 0.4504343271255493, gen p mean: -0.12100739032030106, mean p set: 0.45100730657577515The modified gen p mean: 0.44885408878326416, gen p mean: -0.11698754876852036, mean p set: 0.4494280517101288
loss_pred:0.015121798031032085, decouple_loss:0.0009287359425798059
loss_pred:0.014345413073897362, decouple_loss:0.0006510000093840063
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496500790119171, gen p mean: -0.11643687635660172, mean p set: 0.45022767782211304
loss_pred:0.01507492084056139, decouple_loss:0.0006441554869525135
The modified gen p mean: 0.45033615827560425, gen p mean: -0.11614331603050232, mean p set: 0.45091211795806885
loss_pred:0.015073401853442192, decouple_loss:0.0005054945941083133
The modified gen p mean: 0.4521554708480835, gen p mean: -0.10823079943656921, mean p set: 0.45273545384407043
loss_pred:0.015099122188985348, decouple_loss:0.0005683750496245921
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45119747519493103, gen p mean: -0.11240310221910477, mean p set: 0.45177412033081055
loss_pred:0.014622043818235397, decouple_loss:0.00048573940875940025
The modified gen p mean: 0.45067739486694336, gen p mean: -0.10951337218284607, mean p set: 0.45125362277030945
loss_pred:0.01494517270475626, decouple_loss:0.0005372651503421366
The modified gen p mean: 0.4491398334503174, gen p mean: -0.11090168356895447, mean p set: 0.44971778988838196
loss_pred:0.015024907886981964, decouple_loss:0.0005854687769897282
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536167085170746, gen p mean: -0.11063645035028458, mean p set: 0.4541929364204407
loss_pred:0.01521617267280817, decouple_loss:0.0008825974073261023
The modified gen p mean: 0.4498406946659088, gen p mean: -0.11907942593097687, mean p set: 0.4504190683364868
loss_pred:0.015285477042198181, decouple_loss:0.0005690858815796673
The modified gen p mean: 0.4519759714603424, gen p mean: -0.11069761961698532, mean p set: 0.4525558054447174
loss_pred:0.014672777615487576, decouple_loss:0.0006548621458932757
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495050311088562, gen p mean: -0.11291202902793884, mean p set: 0.450082391500473
loss_pred:0.014725841581821442, decouple_loss:0.0005908036837354302
The modified gen p mean: 0.449308842420578, gen p mean: -0.11185841262340546, mean p set: 0.4498874545097351
loss_pred:0.014544538222253323, decouple_loss:0.0006150630651973188
The modified gen p mean: 0.45139750838279724, gen p mean: -0.10716716945171356, mean p set: 0.451975017786026
loss_pred:0.014933740720152855, decouple_loss:0.0006905194604769349
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846034049987793, gen p mean: -0.11084049195051193, mean p set: 0.4490357041358948
loss_pred:0.014740471728146076, decouple_loss:0.0006445432081818581
The modified gen p mean: 0.45207029581069946, gen p mean: -0.10890448093414307, mean p set: 0.4526461362838745
loss_pred:0.014420381747186184, decouple_loss:0.0007065094541758299
The modified gen p mean: 0.4526257812976837, gen p mean: -0.10360178351402283, mean p set: 0.45320096611976624
loss_pred:0.014985057525336742, decouple_loss:0.0006928310613147914
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486038088798523, gen p mean: -0.10158542543649673, mean p set: 0.44918093085289
loss_pred:0.014809828251600266, decouple_loss:0.0005074383807368577
The modified gen p mean: 0.4507085680961609, gen p mean: -0.09561768919229507, mean p set: 0.45128580927848816
loss_pred:0.014696575701236725, decouple_loss:0.0006586494273506105
The modified gen p mean: 0.4484472870826721, gen p mean: -0.10272259265184402, mean p set: 0.44902369379997253
loss_pred:0.015018541365861893, decouple_loss:0.0005764145171269774
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45076045393943787, gen p mean: -0.09605902433395386, mean p set: 0.45133697986602783
loss_pred:0.014987085945904255, decouple_loss:0.0005811608280055225
The modified gen p mean: 0.4511586129665375, gen p mean: -0.09969134628772736, mean p set: 0.4517350196838379
loss_pred:0.014500383287668228, decouple_loss:0.0005175336264073849
The modified gen p mean: 0.44915831089019775, gen p mean: -0.09566453099250793, mean p set: 0.4497344493865967
loss_pred:0.015395639464259148, decouple_loss:0.00047842529602348804
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
NaN value num: 0
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751495122909546, gen p mean: -0.12004648149013519, mean p set: 0.44808903336524963
loss_pred:0.01685863360762596, decouple_loss:0.001049674698151648
The modified gen p mean: 0.44724324345588684, gen p mean: -0.11457028985023499, mean p set: 0.4478190541267395
loss_pred:0.01689504086971283, decouple_loss:0.0006189237465150654
The modified gen p mean: 0.44758346676826477, gen p mean: -0.11638504266738892, mean p set: 0.44815748929977417
loss_pred:0.017031962051987648, decouple_loss:0.0008579136920161545
2023-05-02 03:20:50 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1158280223608017, mean p set: 0.4502691626548767
loss_pred:0.01711498200893402, decouple_loss:0.0005919872201047838
The modified gen p mean: 0.4495369493961334, gen p mean: -0.10985355079174042, mean p set: 0.4500633478164673
loss_pred:0.016464443877339363, decouple_loss:0.0005679538589902222
The modified gen p mean: 0.44977954030036926, gen p mean: -0.10980110615491867, mean p set: 0.45035696029663086
loss_pred:0.016788776963949203, decouple_loss:0.0005564571474678814
WV_1_PC_1_EH_0_PS_40, loss: 0.016818007454276085, avg_mse: 0.026165537536144257
current test mse: 0.026166
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690337777137756, gen p mean: -0.11150961369276047, mean p set: 0.4474784731864929
loss_pred:0.016700930893421173, decouple_loss:0.0004884820664301515
The modified gen p mean: 0.44769641757011414, gen p mean: -0.1087375357747078, mean p set: 0.4482739567756653The modified gen p mean: 0.4469175338745117, gen p mean: -0.10872737318277359, mean p set: 0.4474940896034241
loss_pred:0.016622193157672882, decouple_loss:0.0005198909784667194
loss_pred:0.01672360673546791, decouple_loss:0.00074328004848212
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719916582107544, gen p mean: -0.11038551479578018, mean p set: 0.44777801632881165
loss_pred:0.016580713912844658, decouple_loss:0.00045886225416325033
The modified gen p mean: 0.44787293672561646, gen p mean: -0.11207844316959381, mean p set: 0.4484483003616333The modified gen p mean: 0.4485599398612976, gen p mean: -0.10977882891893387, mean p set: 0.4491376578807831
loss_pred:0.01665852963924408, decouple_loss:0.0006249973084777594
loss_pred:0.017003564164042473, decouple_loss:0.0005044995341449976
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475594758987427, gen p mean: -0.11550720036029816, mean p set: 0.4481372833251953
loss_pred:0.016897251829504967, decouple_loss:0.000625554530415684
The modified gen p mean: 0.4481372535228729, gen p mean: -0.11313671618700027, mean p set: 0.44871240854263306
loss_pred:0.01733766682446003, decouple_loss:0.0005685636424459517
The modified gen p mean: 0.44829145073890686, gen p mean: -0.1115010529756546, mean p set: 0.44886863231658936
loss_pred:0.01666303165256977, decouple_loss:0.0006190142594277859
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756248593330383, gen p mean: -0.1253460794687271, mean p set: 0.4481373429298401
loss_pred:0.015213200822472572, decouple_loss:0.0005758163169957697
The modified gen p mean: 0.4474073350429535, gen p mean: -0.1176714226603508, mean p set: 0.4479822516441345
loss_pred:0.01717599481344223, decouple_loss:0.000594662909861654
The modified gen p mean: 0.4482647180557251, gen p mean: -0.12295041978359222, mean p set: 0.4488413631916046
loss_pred:0.01672518067061901, decouple_loss:0.0006380514241755009
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837430119514465, gen p mean: -0.12689347565174103, mean p set: 0.44894954562187195
loss_pred:0.01603148877620697, decouple_loss:0.0006090071983635426
The modified gen p mean: 0.44716599583625793, gen p mean: -0.12476540356874466, mean p set: 0.44774329662323
loss_pred:0.016256747767329216, decouple_loss:0.0005592165980488062
The modified gen p mean: 0.44787272810935974, gen p mean: -0.12805314362049103, mean p set: 0.44845062494277954
loss_pred:0.016205498948693275, decouple_loss:0.0005778298946097493
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447672039270401, gen p mean: -0.12874384224414825, mean p set: 0.4482477605342865
loss_pred:0.01632152870297432, decouple_loss:0.0005433391197584569
The modified gen p mean: 0.4484099745750427, gen p mean: -0.12818358838558197, mean p set: 0.44898611307144165
loss_pred:0.016386553645133972, decouple_loss:0.0004774819826707244
The modified gen p mean: 0.44792717695236206, gen p mean: -0.12954311072826385, mean p set: 0.4485030770301819
loss_pred:0.016086921095848083, decouple_loss:0.0005488265305757523
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765129685401917, gen p mean: -0.1214200109243393, mean p set: 0.4482278525829315
loss_pred:0.015912378206849098, decouple_loss:0.0004489516722969711
The modified gen p mean: 0.4482966959476471, gen p mean: -0.11990854144096375, mean p set: 0.44887417554855347
loss_pred:0.015779748558998108, decouple_loss:0.0004873634607065469
The modified gen p mean: 0.44744017720222473, gen p mean: -0.11612062156200409, mean p set: 0.4480125904083252
loss_pred:0.016496241092681885, decouple_loss:0.0004516508197411895
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734832644462585, gen p mean: -0.11722499132156372, mean p set: 0.44792336225509644
loss_pred:0.016319258138537407, decouple_loss:0.0005285875522531569
The modified gen p mean: 0.44746991991996765, gen p mean: -0.11838524788618088, mean p set: 0.44804492592811584
The modified gen p mean: 0.44825389981269836, gen p mean: -0.12092182785272598, mean p set: 0.44883155822753906
loss_pred:0.016303766518831253, decouple_loss:0.000567708455491811
loss_pred:0.016422729939222336, decouple_loss:0.0004429275286383927
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877415895462036, gen p mean: -0.12288989126682281, mean p set: 0.449349969625473
loss_pred:0.01555212214589119, decouple_loss:0.0005753957666456699
The modified gen p mean: 0.4481557607650757, gen p mean: -0.1175478845834732, mean p set: 0.4487318992614746
loss_pred:0.016353782266378403, decouple_loss:0.0004762216121889651
The modified gen p mean: 0.4488176107406616, gen p mean: -0.12071089446544647, mean p set: 0.4493922293186188
loss_pred:0.016307059675455093, decouple_loss:0.0005347400438040495
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723373651504517, gen p mean: -0.11856817454099655, mean p set: 0.4478082060813904
loss_pred:0.016665682196617126, decouple_loss:0.000477989116916433
The modified gen p mean: 0.44715631008148193, gen p mean: -0.1138579323887825, mean p set: 0.4477321207523346
The modified gen p mean: 0.44813889265060425, gen p mean: -0.1150750070810318, mean p set: 0.4487142562866211
loss_pred:0.017290281131863594, decouple_loss:0.000535556289833039
loss_pred:0.01676250621676445, decouple_loss:0.0005448439624160528
2023-05-02 03:22:58 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12527193129062653, mean p set: 0.4502691626548767
loss_pred:0.017032485455274582, decouple_loss:0.0006009978242218494
The modified gen p mean: 0.4495355784893036, gen p mean: -0.11938782781362534, mean p set: 0.4500633478164673
loss_pred:0.016350924968719482, decouple_loss:0.0005174631951376796
The modified gen p mean: 0.44978028535842896, gen p mean: -0.1187652051448822, mean p set: 0.45035696029663086
loss_pred:0.016653046011924744, decouple_loss:0.0005355730536393821
WV_1_PC_1_EH_0_PS_40, loss: 0.01670638844370842, avg_mse: 0.0260064247995615
current test mse: 0.026006
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827231764793396, gen p mean: -0.1164974644780159, mean p set: 0.4488488733768463
loss_pred:0.01641027256846428, decouple_loss:0.0005310370470397174
The modified gen p mean: 0.4473310112953186, gen p mean: -0.11514227092266083, mean p set: 0.4479075074195862The modified gen p mean: 0.44733357429504395, gen p mean: -0.11367661505937576, mean p set: 0.4479096829891205
loss_pred:0.016286227852106094, decouple_loss:0.0004825643263757229
loss_pred:0.01674300990998745, decouple_loss:0.0005133968079462647
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891583919525146, gen p mean: -0.1236150860786438, mean p set: 0.44949179887771606
loss_pred:0.01602293737232685, decouple_loss:0.0005959258996881545
The modified gen p mean: 0.4479626417160034, gen p mean: -0.12126743793487549, mean p set: 0.44853898882865906The modified gen p mean: 0.44791242480278015, gen p mean: -0.12232869118452072, mean p set: 0.44848933815956116
loss_pred:0.015891436487436295, decouple_loss:0.000574353791307658
loss_pred:0.01593939960002899, decouple_loss:0.0004587090224958956
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448063462972641, gen p mean: -0.12353189289569855, mean p set: 0.44863903522491455
loss_pred:0.016489315778017044, decouple_loss:0.0004964576219208539
The modified gen p mean: 0.4475768506526947, gen p mean: -0.12762412428855896, mean p set: 0.4481523036956787
loss_pred:0.016265392303466797, decouple_loss:0.0005634885164909065
The modified gen p mean: 0.4484049379825592, gen p mean: -0.1217469647526741, mean p set: 0.44897785782814026
loss_pred:0.01617487147450447, decouple_loss:0.0005742253852076828
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484187066555023, gen p mean: -0.12924322485923767, mean p set: 0.4489932656288147
loss_pred:0.016427677124738693, decouple_loss:0.0007035594317130744
The modified gen p mean: 0.44784310460090637, gen p mean: -0.1261577606201172, mean p set: 0.44842007756233215
loss_pred:0.015708686783909798, decouple_loss:0.000538908876478672
The modified gen p mean: 0.44836798310279846, gen p mean: -0.12459921836853027, mean p set: 0.44894295930862427
loss_pred:0.016302695497870445, decouple_loss:0.0008112331270240247
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479767680168152, gen p mean: -0.12759867310523987, mean p set: 0.44855156540870667
loss_pred:0.015196840278804302, decouple_loss:0.0005366516415961087
The modified gen p mean: 0.44836512207984924, gen p mean: -0.12244163453578949, mean p set: 0.44894248247146606
loss_pred:0.01665559597313404, decouple_loss:0.0004537935310509056
The modified gen p mean: 0.4478395879268646, gen p mean: -0.12758029997348785, mean p set: 0.44841820001602173
loss_pred:0.015295072458684444, decouple_loss:0.0006051299278624356
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447581946849823, gen p mean: -0.12676994502544403, mean p set: 0.44815871119499207
loss_pred:0.015933629125356674, decouple_loss:0.0006557104643434286
The modified gen p mean: 0.44837266206741333, gen p mean: -0.12295480072498322, mean p set: 0.44895002245903015
loss_pred:0.016430595889687538, decouple_loss:0.0005763935623690486
The modified gen p mean: 0.447417676448822, gen p mean: -0.12467677891254425, mean p set: 0.447996586561203
loss_pred:0.016642678529024124, decouple_loss:0.0005168708739802241
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746002554893494, gen p mean: -0.12505677342414856, mean p set: 0.44803571701049805
loss_pred:0.015705585479736328, decouple_loss:0.0005141210276633501
The modified gen p mean: 0.44769808650016785, gen p mean: -0.12320306897163391, mean p set: 0.4482729434967041
The modified gen p mean: 0.4477405250072479, gen p mean: -0.12039996683597565, mean p set: 0.4483153223991394
loss_pred:0.016099633648991585, decouple_loss:0.0005775233148597181
loss_pred:0.016219649463891983, decouple_loss:0.0007931461441330612
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488651752471924, gen p mean: -0.11667336523532867, mean p set: 0.4494416415691376
loss_pred:0.016104653477668762, decouple_loss:0.0005325182573869824
The modified gen p mean: 0.4480953812599182, gen p mean: -0.11522620171308517, mean p set: 0.44867268204689026
The modified gen p mean: 0.4472823143005371, gen p mean: -0.12337250262498856, mean p set: 0.44785749912261963
loss_pred:0.016692277044057846, decouple_loss:0.0006219313363544643
loss_pred:0.01664232276380062, decouple_loss:0.00044213360524736345
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478602409362793, gen p mean: -0.12261661887168884, mean p set: 0.44843775033950806
loss_pred:0.016563458368182182, decouple_loss:0.0005818332429043949
The modified gen p mean: 0.4487718939781189, gen p mean: -0.11906344443559647, mean p set: 0.4493470788002014
loss_pred:0.016388941556215286, decouple_loss:0.0005248480010777712
The modified gen p mean: 0.4478001892566681, gen p mean: -0.12510883808135986, mean p set: 0.4483753740787506
loss_pred:0.014889612793922424, decouple_loss:0.0004771927196998149
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680315256118774, gen p mean: -0.12703059613704681, mean p set: 0.44737890362739563
loss_pred:0.01491086557507515, decouple_loss:0.0005689839599654078
The modified gen p mean: 0.4469027519226074, gen p mean: -0.12003684043884277, mean p set: 0.4474763870239258
The modified gen p mean: 0.447867214679718, gen p mean: -0.12520752847194672, mean p set: 0.448443204164505
loss_pred:0.014971056953072548, decouple_loss:0.0004386217624414712
loss_pred:0.01460727583616972, decouple_loss:0.0005549099878408015
2023-05-02 03:25:48 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1306622326374054, mean p set: 0.4502691626548767
loss_pred:0.016961650922894478, decouple_loss:0.00044732753303833306
The modified gen p mean: 0.44953271746635437, gen p mean: -0.12445046007633209, mean p set: 0.4500633478164673
loss_pred:0.016278626397252083, decouple_loss:0.0006105623906478286
The modified gen p mean: 0.4497806429862976, gen p mean: -0.12404611706733704, mean p set: 0.45035696029663086
loss_pred:0.016604136675596237, decouple_loss:0.0006378875696100295
WV_1_PC_1_EH_0_PS_40, loss: 0.016643067821860313, avg_mse: 0.02594723179936409
current test mse: 0.025947
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483362138271332, gen p mean: -0.1275501549243927, mean p set: 0.448910653591156
loss_pred:0.013974880799651146, decouple_loss:0.0005499261314980686
The modified gen p mean: 0.4474281072616577, gen p mean: -0.1294805109500885, mean p set: 0.44800394773483276The modified gen p mean: 0.4483116865158081, gen p mean: -0.12244858592748642, mean p set: 0.44888588786125183
loss_pred:0.014803342521190643, decouple_loss:0.0004003914073109627
loss_pred:0.014330687001347542, decouple_loss:0.0004441338242031634
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742459058761597, gen p mean: -0.1294986754655838, mean p set: 0.4479982852935791
loss_pred:0.014191919937729836, decouple_loss:0.0004245012241881341
The modified gen p mean: 0.448748379945755, gen p mean: -0.1273915320634842, mean p set: 0.449325829744339The modified gen p mean: 0.4465726912021637, gen p mean: -0.12644505500793457, mean p set: 0.4471501410007477
loss_pred:0.013451872393488884, decouple_loss:0.0004093759343959391
loss_pred:0.014985844492912292, decouple_loss:0.0006365798762999475
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772854447364807, gen p mean: -0.1269216388463974, mean p set: 0.44830334186553955
loss_pred:0.015093659982085228, decouple_loss:0.0005708345561288297
The modified gen p mean: 0.44808486104011536, gen p mean: -0.1256532371044159, mean p set: 0.44866064190864563
loss_pred:0.014575794339179993, decouple_loss:0.000498815905302763
The modified gen p mean: 0.44712725281715393, gen p mean: -0.13687346875667572, mean p set: 0.4477013349533081
loss_pred:0.0150851896032691, decouple_loss:0.0005147753981873393
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470473825931549, gen p mean: -0.12568672001361847, mean p set: 0.44762441515922546
loss_pred:0.01427540648728609, decouple_loss:0.0005641161114908755
The modified gen p mean: 0.4464719295501709, gen p mean: -0.12456084787845612, mean p set: 0.4470519721508026
loss_pred:0.014717929996550083, decouple_loss:0.0004855601582676172
The modified gen p mean: 0.4480319321155548, gen p mean: -0.12734636664390564, mean p set: 0.44860947132110596
loss_pred:0.014463759027421474, decouple_loss:0.0005514671211130917
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480309784412384, gen p mean: -0.12510941922664642, mean p set: 0.4486064314842224
loss_pred:0.014166034758090973, decouple_loss:0.0008499230607412755
The modified gen p mean: 0.4476628005504608, gen p mean: -0.12753522396087646, mean p set: 0.4482389986515045
loss_pred:0.014423913322389126, decouple_loss:0.0004700667050201446
The modified gen p mean: 0.4483933448791504, gen p mean: -0.12641583383083344, mean p set: 0.44896969199180603
loss_pred:0.014532445929944515, decouple_loss:0.0008729458204470575
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470789432525635, gen p mean: -0.12860620021820068, mean p set: 0.4476523995399475
loss_pred:0.014843798242509365, decouple_loss:0.0006935998681001365
The modified gen p mean: 0.4468018710613251, gen p mean: -0.12063994258642197, mean p set: 0.4473787844181061
loss_pred:0.014478792436420918, decouple_loss:0.00047632629866711795
The modified gen p mean: 0.44857165217399597, gen p mean: -0.12474862486124039, mean p set: 0.4491487443447113
loss_pred:0.014002278447151184, decouple_loss:0.0006524635828100145
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754108786582947, gen p mean: -0.12330906093120575, mean p set: 0.4481172263622284
The modified gen p mean: 0.4470170736312866, gen p mean: -0.12120208144187927, mean p set: 0.44759440422058105
loss_pred:0.014843064360320568, decouple_loss:0.0005187471979297698
loss_pred:0.014267103746533394, decouple_loss:0.0005474970093928277
The modified gen p mean: 0.44794344902038574, gen p mean: -0.11954978853464127, mean p set: 0.4485197067260742
loss_pred:0.0141898849979043, decouple_loss:0.0005091768107376993
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772976636886597, gen p mean: -0.11354060471057892, mean p set: 0.44830429553985596
loss_pred:0.014121051877737045, decouple_loss:0.0005016064969822764
The modified gen p mean: 0.4473167955875397, gen p mean: -0.11832471191883087, mean p set: 0.44789108633995056
loss_pred:0.015084810554981232, decouple_loss:0.0005356580368243158
The modified gen p mean: 0.4477292001247406, gen p mean: -0.11795670539140701, mean p set: 0.448304146528244
loss_pred:0.014262150041759014, decouple_loss:0.0004988802247680724
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822990894317627, gen p mean: -0.11902596801519394, mean p set: 0.44880568981170654
loss_pred:0.014446423389017582, decouple_loss:0.0006155764567665756
The modified gen p mean: 0.44816654920578003, gen p mean: -0.11861232668161392, mean p set: 0.4487426280975342
loss_pred:0.014712348580360413, decouple_loss:0.0008378257043659687
The modified gen p mean: 0.44908401370048523, gen p mean: -0.10804794728755951, mean p set: 0.44966015219688416
loss_pred:0.013801610097289085, decouple_loss:0.00045006570871919394
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676169753074646, gen p mean: -0.11678394675254822, mean p set: 0.4473388195037842
loss_pred:0.014281542040407658, decouple_loss:0.000731219130102545
The modified gen p mean: 0.4475049376487732, gen p mean: -0.11346004903316498, mean p set: 0.448081910610199
loss_pred:0.014910857193171978, decouple_loss:0.0005263556959107518
The modified gen p mean: 0.44684767723083496, gen p mean: -0.11178650707006454, mean p set: 0.447422593832016
loss_pred:0.014542965218424797, decouple_loss:0.00045035500079393387
2023-05-02 03:27:55 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11888650059700012, mean p set: 0.4502691626548767
loss_pred:0.01694752834737301, decouple_loss:0.0005833824397996068
The modified gen p mean: 0.44953787326812744, gen p mean: -0.11334310472011566, mean p set: 0.4500633478164673
loss_pred:0.016223788261413574, decouple_loss:0.0005632297252304852
The modified gen p mean: 0.44978195428848267, gen p mean: -0.1127920150756836, mean p set: 0.45035696029663086
loss_pred:0.016615550965070724, decouple_loss:0.0006116245640441775
WV_1_PC_1_EH_0_PS_40, loss: 0.016624927520751953, avg_mse: 0.02591491863131523
current test mse: 0.025915
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781333208084106, gen p mean: -0.12084095180034637, mean p set: 0.4483886957168579
loss_pred:0.014337798580527306, decouple_loss:0.0005020847893320024
The modified gen p mean: 0.44798973202705383, gen p mean: -0.11760600656270981, mean p set: 0.4485662877559662The modified gen p mean: 0.44712764024734497, gen p mean: -0.11452065408229828, mean p set: 0.44770386815071106
loss_pred:0.01425966713577509, decouple_loss:0.0006673873285762966
loss_pred:0.014402900822460651, decouple_loss:0.00038673976087011397
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472522735595703, gen p mean: -0.12144363671541214, mean p set: 0.44783034920692444
loss_pred:0.014366956427693367, decouple_loss:0.0006101223989389837
The modified gen p mean: 0.44761911034584045, gen p mean: -0.11443164199590683, mean p set: 0.4481918513774872The modified gen p mean: 0.44839605689048767, gen p mean: -0.11589791625738144, mean p set: 0.44897186756134033
loss_pred:0.014247894287109375, decouple_loss:0.0006892203236930072
loss_pred:0.014049478806555271, decouple_loss:0.000663836719468236
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471237361431122, gen p mean: -0.12405214458703995, mean p set: 0.4477039873600006
loss_pred:0.013689867220818996, decouple_loss:0.0004503385571297258
The modified gen p mean: 0.4476810395717621, gen p mean: -0.11812460422515869, mean p set: 0.4482576549053192The modified gen p mean: 0.4471101760864258, gen p mean: -0.11982104927301407, mean p set: 0.44768473505973816
loss_pred:0.014454387128353119, decouple_loss:0.0005123068112879992
loss_pred:0.014417298138141632, decouple_loss:0.0006536970613524318
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480220079421997, gen p mean: -0.1242789700627327, mean p set: 0.4486024081707001
loss_pred:0.014299793168902397, decouple_loss:0.0004614516219589859
The modified gen p mean: 0.4486686587333679, gen p mean: -0.12430469691753387, mean p set: 0.44924864172935486
loss_pred:0.01352714840322733, decouple_loss:0.0005882030818611383
The modified gen p mean: 0.44883599877357483, gen p mean: -0.12337156385183334, mean p set: 0.44941452145576477
loss_pred:0.014227757230401039, decouple_loss:0.0005443624104373157
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708678126335144, gen p mean: -0.11976579576730728, mean p set: 0.4476620554924011
loss_pred:0.0143813481554389, decouple_loss:0.0004550576559267938
The modified gen p mean: 0.4470100402832031, gen p mean: -0.1333734542131424, mean p set: 0.44758692383766174
loss_pred:0.015164845623075962, decouple_loss:0.0007278615375980735
The modified gen p mean: 0.4466359317302704, gen p mean: -0.12305667996406555, mean p set: 0.4472118318080902
loss_pred:0.014165974222123623, decouple_loss:0.0004900036728940904
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465513825416565, gen p mean: -0.1312583088874817, mean p set: 0.4471273422241211
loss_pred:0.014825638383626938, decouple_loss:0.0007612642948515713
The modified gen p mean: 0.4463559091091156, gen p mean: -0.12687784433364868, mean p set: 0.4469318985939026
loss_pred:0.015231314115226269, decouple_loss:0.0006517851143144071
The modified gen p mean: 0.44795453548431396, gen p mean: -0.12956546247005463, mean p set: 0.44853144884109497
loss_pred:0.014139676466584206, decouple_loss:0.0005612853565253317
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470633268356323, gen p mean: -0.12466184049844742, mean p set: 0.4476398825645447
loss_pred:0.014586171135306358, decouple_loss:0.0004553993640001863
The modified gen p mean: 0.44726288318634033, gen p mean: -0.12244128435850143, mean p set: 0.4478378891944885
loss_pred:0.013908851891756058, decouple_loss:0.00046151550486683846
The modified gen p mean: 0.4481152892112732, gen p mean: -0.1191781684756279, mean p set: 0.44869139790534973
loss_pred:0.014012853614985943, decouple_loss:0.00047116581117734313
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471834897994995, gen p mean: -0.11659441888332367, mean p set: 0.4477570950984955
loss_pred:0.014391321688890457, decouple_loss:0.0006730101304128766
The modified gen p mean: 0.4484819769859314, gen p mean: -0.12183436751365662, mean p set: 0.4490576982498169
loss_pred:0.013604751788079739, decouple_loss:0.00045525882160291076
The modified gen p mean: 0.44742539525032043, gen p mean: -0.1205890104174614, mean p set: 0.44800183176994324
loss_pred:0.014387465082108974, decouple_loss:0.000483830866869539
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737187027931213, gen p mean: -0.11782757192850113, mean p set: 0.44794946908950806
loss_pred:0.014012448489665985, decouple_loss:0.0008944828878156841
The modified gen p mean: 0.4479117691516876, gen p mean: -0.116763174533844, mean p set: 0.448486864566803
loss_pred:0.013988365419209003, decouple_loss:0.0005145788309164345
The modified gen p mean: 0.44713252782821655, gen p mean: -0.11518386751413345, mean p set: 0.4477090537548065
loss_pred:0.0140910679474473, decouple_loss:0.0004363176703918725
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476890563964844, gen p mean: -0.1166829913854599, mean p set: 0.4482649564743042
loss_pred:0.0148848295211792, decouple_loss:0.00055337866069749
The modified gen p mean: 0.4478972256183624, gen p mean: -0.11567012220621109, mean p set: 0.448472261428833
The modified gen p mean: 0.44697654247283936, gen p mean: -0.11746668070554733, mean p set: 0.44755110144615173
loss_pred:0.014326480217278004, decouple_loss:0.000593262433540076
loss_pred:0.015333719551563263, decouple_loss:0.0005198855069465935
2023-05-02 03:30:39 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11830118298530579, mean p set: 0.4502691626548767
loss_pred:0.016972124576568604, decouple_loss:0.000802499707788229
The modified gen p mean: 0.4495365023612976, gen p mean: -0.11292923986911774, mean p set: 0.4500633478164673
loss_pred:0.01627171039581299, decouple_loss:0.0005704317009076476
The modified gen p mean: 0.44982805848121643, gen p mean: -0.11245287209749222, mean p set: 0.45035696029663086
loss_pred:0.01662048138678074, decouple_loss:0.0005669039092026651
WV_1_PC_1_EH_0_PS_40, loss: 0.016653768718242645, avg_mse: 0.025950873270630836
current test mse: 0.025951
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488218426704407, gen p mean: -0.11605145782232285, mean p set: 0.44939976930618286
loss_pred:0.0147958192974329, decouple_loss:0.0006566641386598349
The modified gen p mean: 0.4469619393348694, gen p mean: -0.11775040626525879, mean p set: 0.4475356340408325The modified gen p mean: 0.44707152247428894, gen p mean: -0.11587883532047272, mean p set: 0.4476448595523834
loss_pred:0.01461621094495058, decouple_loss:0.0005850753514096141
loss_pred:0.015230759978294373, decouple_loss:0.00048196481657214463
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44675981998443604, gen p mean: -0.1167856752872467, mean p set: 0.4473358392715454
loss_pred:0.014489205554127693, decouple_loss:0.0006842839065939188
The modified gen p mean: 0.4473075270652771, gen p mean: -0.11475744098424911, mean p set: 0.4478845000267029The modified gen p mean: 0.44774070382118225, gen p mean: -0.11729266494512558, mean p set: 0.4483180344104767
loss_pred:0.014291368424892426, decouple_loss:0.000597206992097199
loss_pred:0.015355496667325497, decouple_loss:0.0005866331048309803
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460483193397522, gen p mean: -0.11663727462291718, mean p set: 0.4466237425804138
loss_pred:0.014574273489415646, decouple_loss:0.00048773171147331595
The modified gen p mean: 0.44794130325317383, gen p mean: -0.11355501413345337, mean p set: 0.4485156238079071
loss_pred:0.014097985811531544, decouple_loss:0.0005741695640608668
The modified gen p mean: 0.4496067762374878, gen p mean: -0.11812262237071991, mean p set: 0.45018208026885986
loss_pred:0.013457183726131916, decouple_loss:0.00038616458186879754
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477461576461792, gen p mean: -0.11306485533714294, mean p set: 0.44832107424736023
loss_pred:0.015142836607992649, decouple_loss:0.0006932676187716424
The modified gen p mean: 0.4491477608680725, gen p mean: -0.11535079777240753, mean p set: 0.4497232735157013
loss_pred:0.014456202276051044, decouple_loss:0.0006480150041170418
The modified gen p mean: 0.4481201767921448, gen p mean: -0.11354271322488785, mean p set: 0.44869574904441833
loss_pred:0.014851521700620651, decouple_loss:0.0006679997895844281
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447908878326416, gen p mean: -0.11191900074481964, mean p set: 0.4484834671020508
loss_pred:0.014469385147094727, decouple_loss:0.0004177188384346664
The modified gen p mean: 0.45006945729255676, gen p mean: -0.11884916573762894, mean p set: 0.4506426155567169
loss_pred:0.014217711053788662, decouple_loss:0.0007121142698451877
The modified gen p mean: 0.4467889070510864, gen p mean: -0.11728715896606445, mean p set: 0.447368323802948
loss_pred:0.014809831976890564, decouple_loss:0.0008055266225710511
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815120100975037, gen p mean: -0.11856959015130997, mean p set: 0.4487282633781433
loss_pred:0.014673694968223572, decouple_loss:0.0005007325671613216
The modified gen p mean: 0.4474796652793884, gen p mean: -0.12294328212738037, mean p set: 0.4480571746826172
loss_pred:0.014707542955875397, decouple_loss:0.0005056646186858416
The modified gen p mean: 0.4484265446662903, gen p mean: -0.11462973058223724, mean p set: 0.44900330901145935
loss_pred:0.014232354238629341, decouple_loss:0.0004506680998019874
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844406843185425, gen p mean: -0.12227895110845566, mean p set: 0.4490198791027069
loss_pred:0.014605100266635418, decouple_loss:0.0005077245295979083
The modified gen p mean: 0.44829922914505005, gen p mean: -0.11702050268650055, mean p set: 0.4488748610019684
loss_pred:0.015181586146354675, decouple_loss:0.0006573139107786119
The modified gen p mean: 0.4482659697532654, gen p mean: -0.11911256611347198, mean p set: 0.4488431215286255
loss_pred:0.014308868907392025, decouple_loss:0.000711748085450381
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469090700149536, gen p mean: -0.126307874917984, mean p set: 0.4474853575229645
loss_pred:0.014183863997459412, decouple_loss:0.0005817965138703585
The modified gen p mean: 0.4474388659000397, gen p mean: -0.11867751181125641, mean p set: 0.4480155408382416
The modified gen p mean: 0.44749385118484497, gen p mean: -0.124252550303936, mean p set: 0.4480707347393036
loss_pred:0.01572798378765583, decouple_loss:0.000560617190785706
loss_pred:0.015353274531662464, decouple_loss:0.0005838750512339175
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465489983558655, gen p mean: -0.124874547123909, mean p set: 0.4471263289451599
loss_pred:0.013922286219894886, decouple_loss:0.0003942373441532254
The modified gen p mean: 0.4482348561286926, gen p mean: -0.12171242386102676, mean p set: 0.4488097131252289
loss_pred:0.014836193062365055, decouple_loss:0.00047168773016892374
The modified gen p mean: 0.44999024271965027, gen p mean: -0.1241764947772026, mean p set: 0.4505683481693268
loss_pred:0.014214140363037586, decouple_loss:0.0004935027682222426
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479808211326599, gen p mean: -0.12037712335586548, mean p set: 0.4485537111759186
loss_pred:0.015712883323431015, decouple_loss:0.001104501192457974
The modified gen p mean: 0.4489439129829407, gen p mean: -0.12580057978630066, mean p set: 0.44952166080474854
The modified gen p mean: 0.4487173557281494, gen p mean: -0.12418512254953384, mean p set: 0.44929543137550354
loss_pred:0.014629311859607697, decouple_loss:0.0006112168193794787
loss_pred:0.014734189957380295, decouple_loss:0.00092360470443964
2023-05-02 03:32:46 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12586745619773865, mean p set: 0.4502691626548767
loss_pred:0.016958335414528847, decouple_loss:0.0004686883476097137
The modified gen p mean: 0.4495331645011902, gen p mean: -0.12048592418432236, mean p set: 0.4500633478164673
loss_pred:0.016239682212471962, decouple_loss:0.0004658150137402117
The modified gen p mean: 0.4498283863067627, gen p mean: -0.1199837476015091, mean p set: 0.45035696029663086
loss_pred:0.0166404377669096, decouple_loss:0.0005805104156024754
WV_1_PC_1_EH_0_PS_40, loss: 0.016638068482279778, avg_mse: 0.02596777305006981
current test mse: 0.025968
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753482937812805, gen p mean: -0.11990898102521896, mean p set: 0.4481089115142822
loss_pred:0.014973022043704987, decouple_loss:0.000636260665487498
The modified gen p mean: 0.44653233885765076, gen p mean: -0.12091562896966934, mean p set: 0.447110116481781
loss_pred:0.015218591317534447, decouple_loss:0.000510019832290709
The modified gen p mean: 0.4484685957431793, gen p mean: -0.12658372521400452, mean p set: 0.44904476404190063
loss_pred:0.015002015046775341, decouple_loss:0.0005057976813986897
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44833412766456604, gen p mean: -0.1208534836769104, mean p set: 0.4489106833934784
loss_pred:0.014506508596241474, decouple_loss:0.0008589549106545746
The modified gen p mean: 0.44783517718315125, gen p mean: -0.12065234780311584, mean p set: 0.44841471314430237The modified gen p mean: 0.44715896248817444, gen p mean: -0.12224394083023071, mean p set: 0.4477330446243286
loss_pred:0.014870218001306057, decouple_loss:0.000665176659822464
loss_pred:0.014723445288836956, decouple_loss:0.0005602161982096732
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799137115478516, gen p mean: -0.12328440696001053, mean p set: 0.4485693573951721
loss_pred:0.014109651558101177, decouple_loss:0.0008483202545903623
The modified gen p mean: 0.44703638553619385, gen p mean: -0.12354504317045212, mean p set: 0.4476125240325928The modified gen p mean: 0.4480289816856384, gen p mean: -0.12114327400922775, mean p set: 0.44860541820526123
loss_pred:0.014645103365182877, decouple_loss:0.0007169201853685081
loss_pred:0.014679430052638054, decouple_loss:0.00095466518541798
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447323203086853, gen p mean: -0.12688125669956207, mean p set: 0.4479025602340698
loss_pred:0.014347079209983349, decouple_loss:0.0004758668947033584
The modified gen p mean: 0.44631946086883545, gen p mean: -0.12551437318325043, mean p set: 0.4468948543071747
loss_pred:0.01459933165460825, decouple_loss:0.0006479603471234441
The modified gen p mean: 0.4481234550476074, gen p mean: -0.11991508305072784, mean p set: 0.4486992359161377
loss_pred:0.014998259954154491, decouple_loss:0.0006651550065726042
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909387826919556, gen p mean: -0.12456962466239929, mean p set: 0.449665904045105
loss_pred:0.013742788694798946, decouple_loss:0.00047922131489031017
The modified gen p mean: 0.4481425881385803, gen p mean: -0.12465132772922516, mean p set: 0.4487214982509613
loss_pred:0.014800135977566242, decouple_loss:0.00048066163435578346
The modified gen p mean: 0.4475806951522827, gen p mean: -0.12100110948085785, mean p set: 0.4481564164161682
loss_pred:0.014341352507472038, decouple_loss:0.0004477036709431559
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785335659980774, gen p mean: -0.12233010679483414, mean p set: 0.44843170046806335
loss_pred:0.014273575507104397, decouple_loss:0.0006470444495789707
The modified gen p mean: 0.4457862973213196, gen p mean: -0.1206379234790802, mean p set: 0.44636374711990356
loss_pred:0.014642308466136456, decouple_loss:0.0008125093881972134
The modified gen p mean: 0.4476236402988434, gen p mean: -0.12228375673294067, mean p set: 0.44819900393486023
loss_pred:0.014430191367864609, decouple_loss:0.0006500805611722171
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682133197784424, gen p mean: -0.12389351427555084, mean p set: 0.4473958909511566
loss_pred:0.01440334226936102, decouple_loss:0.0006748881423845887
The modified gen p mean: 0.44946029782295227, gen p mean: -0.12300869077444077, mean p set: 0.4500364065170288
loss_pred:0.014193089678883553, decouple_loss:0.0005773011362180114
The modified gen p mean: 0.4476129114627838, gen p mean: -0.11971782892942429, mean p set: 0.4481905400753021
loss_pred:0.014482135884463787, decouple_loss:0.0006118416786193848
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44608041644096375, gen p mean: -0.1217440739274025, mean p set: 0.44665804505348206
loss_pred:0.014100244268774986, decouple_loss:0.0004190384061075747
The modified gen p mean: 0.44668617844581604, gen p mean: -0.11843317747116089, mean p set: 0.44726231694221497
loss_pred:0.015295002609491348, decouple_loss:0.000658102217130363
The modified gen p mean: 0.44935014843940735, gen p mean: -0.12444579601287842, mean p set: 0.4499242305755615
loss_pred:0.014423198066651821, decouple_loss:0.0008447201689705253
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467332065105438, gen p mean: -0.12952490150928497, mean p set: 0.447309285402298
loss_pred:0.014224936254322529, decouple_loss:0.0005665533826686442
The modified gen p mean: 0.44693297147750854, gen p mean: -0.1279645413160324, mean p set: 0.44750893115997314
loss_pred:0.014239606447517872, decouple_loss:0.0005513079231604934
The modified gen p mean: 0.4481388032436371, gen p mean: -0.12408482283353806, mean p set: 0.44871997833251953
loss_pred:0.014381857588887215, decouple_loss:0.0006119186291471124
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476671516895294, gen p mean: -0.12665186822414398, mean p set: 0.4482428729534149
loss_pred:0.015197327360510826, decouple_loss:0.0007356607238762081
The modified gen p mean: 0.4470890462398529, gen p mean: -0.12282866984605789, mean p set: 0.4476645588874817
loss_pred:0.015451018698513508, decouple_loss:0.0005156397819519043
The modified gen p mean: 0.4468897581100464, gen p mean: -0.11769381910562515, mean p set: 0.4474641680717468
loss_pred:0.016171082854270935, decouple_loss:0.00048195719136856496
2023-05-02 03:35:33 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12755826115608215, mean p set: 0.4502691626548767
loss_pred:0.016956420615315437, decouple_loss:0.0005577764241024852
The modified gen p mean: 0.44953665137290955, gen p mean: -0.12188956886529922, mean p set: 0.4500633478164673
loss_pred:0.01630249246954918, decouple_loss:0.0004591994802467525
The modified gen p mean: 0.44982796907424927, gen p mean: -0.12138042598962784, mean p set: 0.45035696029663086
loss_pred:0.01663374900817871, decouple_loss:0.0005833928589709103
WV_1_PC_1_EH_0_PS_40, loss: 0.01665756106376648, avg_mse: 0.026009706780314445
current test mse: 0.02601
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766706228256226, gen p mean: -0.1270429939031601, mean p set: 0.44824355840682983
loss_pred:0.015650808811187744, decouple_loss:0.0004438295145519078
The modified gen p mean: 0.4462122619152069, gen p mean: -0.1251169592142105, mean p set: 0.44678664207458496
loss_pred:0.01503093633800745, decouple_loss:0.000530387507751584
The modified gen p mean: 0.447347491979599, gen p mean: -0.12545250356197357, mean p set: 0.44792598485946655
loss_pred:0.015327989123761654, decouple_loss:0.0006896647391840816
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44748374819755554, gen p mean: -0.1291414350271225, mean p set: 0.4480603337287903
loss_pred:0.015295315533876419, decouple_loss:0.0005845599225722253
The modified gen p mean: 0.4482326805591583, gen p mean: -0.12652498483657837, mean p set: 0.4488099217414856The modified gen p mean: 0.4461827874183655, gen p mean: -0.12413904815912247, mean p set: 0.4467572569847107
loss_pred:0.01568574644625187, decouple_loss:0.0005510104820132256
loss_pred:0.014485795982182026, decouple_loss:0.0005163092282600701
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750285148620605, gen p mean: -0.12433480471372604, mean p set: 0.44807714223861694
loss_pred:0.015456197783350945, decouple_loss:0.0006336091319099069
The modified gen p mean: 0.44705837965011597, gen p mean: -0.12411089986562729, mean p set: 0.44763314723968506
loss_pred:0.01580268144607544, decouple_loss:0.0006308358279056847
The modified gen p mean: 0.447199285030365, gen p mean: -0.12251871079206467, mean p set: 0.44777771830558777
loss_pred:0.015568185597658157, decouple_loss:0.0004364897031337023
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467187225818634, gen p mean: -0.12316278368234634, mean p set: 0.44729599356651306
loss_pred:0.01459161750972271, decouple_loss:0.0006342889973893762
The modified gen p mean: 0.4472585916519165, gen p mean: -0.12141251564025879, mean p set: 0.44783589243888855
loss_pred:0.015050294809043407, decouple_loss:0.0004898888873867691
The modified gen p mean: 0.4475681781768799, gen p mean: -0.11945345997810364, mean p set: 0.4481445848941803
loss_pred:0.014973180368542671, decouple_loss:0.0007323833415284753
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476950466632843, gen p mean: -0.12308349460363388, mean p set: 0.4482708275318146
loss_pred:0.01604466699063778, decouple_loss:0.0005396845517680049
The modified gen p mean: 0.4474276900291443, gen p mean: -0.12320157140493393, mean p set: 0.4480043649673462
loss_pred:0.015881430357694626, decouple_loss:0.0004767570935655385
The modified gen p mean: 0.44710448384284973, gen p mean: -0.12351036816835403, mean p set: 0.44768041372299194
loss_pred:0.014528568834066391, decouple_loss:0.0005432884208858013
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743162393569946, gen p mean: -0.12234663218259811, mean p set: 0.4480067491531372
loss_pred:0.015354311093688011, decouple_loss:0.0004459009796846658
The modified gen p mean: 0.4478119909763336, gen p mean: -0.1171063631772995, mean p set: 0.4483889639377594
loss_pred:0.015046012587845325, decouple_loss:0.00045309579581953585
The modified gen p mean: 0.4465580880641937, gen p mean: -0.12065552920103073, mean p set: 0.44713303446769714
loss_pred:0.014674096368253231, decouple_loss:0.00038250439683906734
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447523832321167, gen p mean: -0.11918414384126663, mean p set: 0.4481000304222107
loss_pred:0.015407281927764416, decouple_loss:0.0006126267253421247
The modified gen p mean: 0.4476971924304962, gen p mean: -0.11740774661302567, mean p set: 0.4482730031013489
loss_pred:0.014952387660741806, decouple_loss:0.0004871210840065032
The modified gen p mean: 0.44713515043258667, gen p mean: -0.12054694443941116, mean p set: 0.44771143794059753
loss_pred:0.015658609569072723, decouple_loss:0.0005973335355520248
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466751217842102, gen p mean: -0.11888264864683151, mean p set: 0.44725102186203003
loss_pred:0.014566565863788128, decouple_loss:0.0004133182519581169
The modified gen p mean: 0.4472029507160187, gen p mean: -0.12034573405981064, mean p set: 0.4477778375148773
loss_pred:0.014707041904330254, decouple_loss:0.0005084541626274586
The modified gen p mean: 0.4472449719905853, gen p mean: -0.11841698735952377, mean p set: 0.44781771302223206
loss_pred:0.015672439709305763, decouple_loss:0.0006757681840099394
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470234513282776, gen p mean: -0.11994051933288574, mean p set: 0.4475988745689392
loss_pred:0.014866255223751068, decouple_loss:0.0005689902463927865
The modified gen p mean: 0.44776031374931335, gen p mean: -0.12339045852422714, mean p set: 0.44833505153656006
loss_pred:0.015308933332562447, decouple_loss:0.0005823809769935906
The modified gen p mean: 0.44849520921707153, gen p mean: -0.1272450089454651, mean p set: 0.4490697383880615
loss_pred:0.0148214902728796, decouple_loss:0.0004661435668822378
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736337661743164, gen p mean: -0.12250463664531708, mean p set: 0.44793930649757385
loss_pred:0.01575288735330105, decouple_loss:0.0006091555114835501
The modified gen p mean: 0.44644635915756226, gen p mean: -0.12251944094896317, mean p set: 0.44702383875846863
loss_pred:0.014919474720954895, decouple_loss:0.0005730133270844817
The modified gen p mean: 0.4480370581150055, gen p mean: -0.1219651848077774, mean p set: 0.4486115872859955
loss_pred:0.015269863419234753, decouple_loss:0.000488337769638747
2023-05-02 03:37:39 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12521009147167206, mean p set: 0.4502691626548767
loss_pred:0.01689491607248783, decouple_loss:0.0005969731137156487
The modified gen p mean: 0.4495336711406708, gen p mean: -0.11984455585479736, mean p set: 0.4500633478164673
loss_pred:0.016307668760418892, decouple_loss:0.0004184478893876076
The modified gen p mean: 0.4498291611671448, gen p mean: -0.11958734691143036, mean p set: 0.45035696029663086
loss_pred:0.016660219058394432, decouple_loss:0.0004493065061978996
WV_1_PC_1_EH_0_PS_40, loss: 0.016645347699522972, avg_mse: 0.026012586429715157
current test mse: 0.026013
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804447889328003, gen p mean: -0.12609395384788513, mean p set: 0.4486217796802521
loss_pred:0.014828638173639774, decouple_loss:0.000532749923877418
The modified gen p mean: 0.4474899172782898, gen p mean: -0.12291844189167023, mean p set: 0.44806763529777527The modified gen p mean: 0.4471721351146698, gen p mean: -0.12401632964611053, mean p set: 0.44774720072746277
loss_pred:0.014605442062020302, decouple_loss:0.00043639534851536155
loss_pred:0.014889486134052277, decouple_loss:0.0005859542288817465
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44709286093711853, gen p mean: -0.12094731628894806, mean p set: 0.44767072796821594
loss_pred:0.015516488812863827, decouple_loss:0.0004542956012301147
The modified gen p mean: 0.4474394619464874, gen p mean: -0.11932991445064545, mean p set: 0.4480176270008087The modified gen p mean: 0.44722938537597656, gen p mean: -0.12098197638988495, mean p set: 0.4478038251399994
loss_pred:0.015364957973361015, decouple_loss:0.00047064380487427115
loss_pred:0.015175322070717812, decouple_loss:0.0005260400357656181
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756796956062317, gen p mean: -0.12326309084892273, mean p set: 0.4481448233127594
loss_pred:0.015173069201409817, decouple_loss:0.000535082770511508
The modified gen p mean: 0.44698476791381836, gen p mean: -0.11584428697824478, mean p set: 0.44755926728248596
loss_pred:0.01591608300805092, decouple_loss:0.0005082989810034633
The modified gen p mean: 0.4473956525325775, gen p mean: -0.12066826224327087, mean p set: 0.4479702413082123
loss_pred:0.014979179948568344, decouple_loss:0.0005750947748310864
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743332266807556, gen p mean: -0.12467766553163528, mean p set: 0.44800713658332825
loss_pred:0.01482298132032156, decouple_loss:0.0004701433645095676
The modified gen p mean: 0.44849127531051636, gen p mean: -0.12658752501010895, mean p set: 0.4490669369697571
loss_pred:0.014819114468991756, decouple_loss:0.00041092312312684953
The modified gen p mean: 0.4475148022174835, gen p mean: -0.11840063333511353, mean p set: 0.4480897784233093
loss_pred:0.015140483155846596, decouple_loss:0.00046341834240593016
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762319326400757, gen p mean: -0.12166060507297516, mean p set: 0.44820162653923035
loss_pred:0.015475590713322163, decouple_loss:0.0004902777727693319
The modified gen p mean: 0.4459165930747986, gen p mean: -0.12177369743585587, mean p set: 0.44649389386177063
loss_pred:0.014470988884568214, decouple_loss:0.0004934748285450041
The modified gen p mean: 0.4470937252044678, gen p mean: -0.12526991963386536, mean p set: 0.44767072796821594
loss_pred:0.015445706434547901, decouple_loss:0.0005450393655337393
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791191816329956, gen p mean: -0.12647376954555511, mean p set: 0.44848695397377014
loss_pred:0.014830931089818478, decouple_loss:0.00043063965858891606
The modified gen p mean: 0.447644978761673, gen p mean: -0.12259955704212189, mean p set: 0.4482216238975525
The modified gen p mean: 0.4475361406803131, gen p mean: -0.12180966138839722, mean p set: 0.4481123387813568
loss_pred:0.01572474092245102, decouple_loss:0.00046115374425426126
loss_pred:0.014526075683534145, decouple_loss:0.0004458478360902518
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447002649307251, gen p mean: -0.12929414212703705, mean p set: 0.44758090376853943
loss_pred:0.014783513732254505, decouple_loss:0.0005346136167645454
The modified gen p mean: 0.4477197229862213, gen p mean: -0.12954853475093842, mean p set: 0.4482952058315277
loss_pred:0.014840487390756607, decouple_loss:0.0004500265058595687
The modified gen p mean: 0.44692349433898926, gen p mean: -0.122332364320755, mean p set: 0.44749921560287476
loss_pred:0.015203846618533134, decouple_loss:0.0005967678152956069
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468691945075989, gen p mean: -0.1257733702659607, mean p set: 0.447443425655365
loss_pred:0.014931759797036648, decouple_loss:0.0004813117266166955
The modified gen p mean: 0.44729599356651306, gen p mean: -0.12022749334573746, mean p set: 0.4478713572025299
The modified gen p mean: 0.4473893642425537, gen p mean: -0.12370935082435608, mean p set: 0.4479668438434601
loss_pred:0.01558608841150999, decouple_loss:0.0004486162506509572
loss_pred:0.015820926055312157, decouple_loss:0.0005610088119283319
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479438066482544, gen p mean: -0.13068440556526184, mean p set: 0.4485156238079071
loss_pred:0.014327339828014374, decouple_loss:0.0006914827972650528
The modified gen p mean: 0.44708678126335144, gen p mean: -0.12838901579380035, mean p set: 0.4476606547832489
The modified gen p mean: 0.4474630653858185, gen p mean: -0.1264803111553192, mean p set: 0.4480361342430115
loss_pred:0.01543770544230938, decouple_loss:0.0005808219430036843
loss_pred:0.015193269588053226, decouple_loss:0.0005312226712703705
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
NaN value num: 0
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45129650831222534, gen p mean: -0.12199839949607849, mean p set: 0.45187288522720337
The modified gen p mean: 0.4513079524040222, gen p mean: -0.12052790075540543, mean p set: 0.4518847167491913
loss_pred:0.014486103318631649, decouple_loss:0.0005178151186555624
loss_pred:0.014830836094915867, decouple_loss:0.0005791027215309441
The modified gen p mean: 0.450920432806015, gen p mean: -0.12066870927810669, mean p set: 0.45149585604667664
loss_pred:0.014692687429487705, decouple_loss:0.000676480121910572
2023-05-02 03:40:24 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1332302838563919, mean p set: 0.4502691626548767
loss_pred:0.0170146357268095, decouple_loss:0.000748629099689424
The modified gen p mean: 0.44953733682632446, gen p mean: -0.1279405653476715, mean p set: 0.4500633478164673
loss_pred:0.0162783395498991, decouple_loss:0.0005416097701527178
The modified gen p mean: 0.4498300552368164, gen p mean: -0.12728910148143768, mean p set: 0.45035696029663086
loss_pred:0.016747744753956795, decouple_loss:0.0004687611071858555
WV_1_PC_1_EH_0_PS_40, loss: 0.01670955866575241, avg_mse: 0.026068368926644325
current test mse: 0.026068
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513098895549774, gen p mean: -0.12347861379384995, mean p set: 0.4518887996673584
loss_pred:0.014152188785374165, decouple_loss:0.0005681662587448955
The modified gen p mean: 0.44937947392463684, gen p mean: -0.1193511113524437, mean p set: 0.4499543607234955The modified gen p mean: 0.4530426859855652, gen p mean: -0.1233585774898529, mean p set: 0.45362117886543274
loss_pred:0.014637595973908901, decouple_loss:0.0005537051474675536
loss_pred:0.015299377031624317, decouple_loss:0.0006831850623711944
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45042160153388977, gen p mean: -0.11930812150239944, mean p set: 0.45099693536758423
loss_pred:0.014205992221832275, decouple_loss:0.0005330450367182493
The modified gen p mean: 0.45044779777526855, gen p mean: -0.1197955533862114, mean p set: 0.4510255753993988The modified gen p mean: 0.4504660665988922, gen p mean: -0.11780538409948349, mean p set: 0.45104217529296875
loss_pred:0.014392847195267677, decouple_loss:0.000570544449146837
loss_pred:0.01493530347943306, decouple_loss:0.0004768483922816813
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962555170059204, gen p mean: -0.1156761422753334, mean p set: 0.4502032399177551
loss_pred:0.015394994989037514, decouple_loss:0.0006588198593817651
The modified gen p mean: 0.4520549476146698, gen p mean: -0.12276381254196167, mean p set: 0.4526314437389374
loss_pred:0.014384141191840172, decouple_loss:0.0006889127544127405
The modified gen p mean: 0.4511628746986389, gen p mean: -0.11395565420389175, mean p set: 0.45174074172973633
loss_pred:0.014252010732889175, decouple_loss:0.0006424178718589246
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45057785511016846, gen p mean: -0.11518513411283493, mean p set: 0.4511524438858032
loss_pred:0.014456969685852528, decouple_loss:0.0008110402268357575
The modified gen p mean: 0.4519060552120209, gen p mean: -0.11556009203195572, mean p set: 0.45248204469680786
loss_pred:0.01420698780566454, decouple_loss:0.0005526127060875297
The modified gen p mean: 0.4502233564853668, gen p mean: -0.11337604373693466, mean p set: 0.4507984220981598
loss_pred:0.014674298465251923, decouple_loss:0.0007984628318808973
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45148298144340515, gen p mean: -0.11921762675046921, mean p set: 0.45205995440483093
loss_pred:0.014751832000911236, decouple_loss:0.000834605423733592
The modified gen p mean: 0.4507797062397003, gen p mean: -0.11672396957874298, mean p set: 0.4513586759567261
loss_pred:0.01457477267831564, decouple_loss:0.0004078152705915272
The modified gen p mean: 0.4495964050292969, gen p mean: -0.11695744842290878, mean p set: 0.4501703083515167
loss_pred:0.014147493056952953, decouple_loss:0.0003988367097917944
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482438266277313, gen p mean: -0.12024958431720734, mean p set: 0.4488172233104706
loss_pred:0.014820807613432407, decouple_loss:0.000455524364951998
The modified gen p mean: 0.4489804804325104, gen p mean: -0.11878642439842224, mean p set: 0.449554443359375
loss_pred:0.01542252954095602, decouple_loss:0.0007033146684989333
The modified gen p mean: 0.45085644721984863, gen p mean: -0.1222907081246376, mean p set: 0.4514361619949341
loss_pred:0.014197858050465584, decouple_loss:0.0007712276419624686
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128560066223145, gen p mean: -0.11735614389181137, mean p set: 0.4518622159957886
loss_pred:0.014907724224030972, decouple_loss:0.0005255054566077888
The modified gen p mean: 0.45001861453056335, gen p mean: -0.11868525296449661, mean p set: 0.4505949914455414
loss_pred:0.01486116647720337, decouple_loss:0.0005254791467450559
The modified gen p mean: 0.45071834325790405, gen p mean: -0.12130417674779892, mean p set: 0.45129311084747314
loss_pred:0.01415883656591177, decouple_loss:0.0005436730571091175
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499991238117218, gen p mean: -0.12147348374128342, mean p set: 0.45057356357574463
loss_pred:0.01511557400226593, decouple_loss:0.0006217400077730417
The modified gen p mean: 0.4507373869419098, gen p mean: -0.11758005619049072, mean p set: 0.4513106644153595
loss_pred:0.014277520589530468, decouple_loss:0.0004577163781505078
The modified gen p mean: 0.4504455327987671, gen p mean: -0.12042352557182312, mean p set: 0.4510226845741272
loss_pred:0.014275810681283474, decouple_loss:0.0005307031096890569
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45186758041381836, gen p mean: -0.12317746132612228, mean p set: 0.45244479179382324
loss_pred:0.014546734280884266, decouple_loss:0.0006595712620764971
The modified gen p mean: 0.45109373331069946, gen p mean: -0.12535804510116577, mean p set: 0.45167064666748047
loss_pred:0.01426111999899149, decouple_loss:0.0006497818976640701
The modified gen p mean: 0.4502134323120117, gen p mean: -0.12140946090221405, mean p set: 0.4507897198200226
loss_pred:0.014218629337847233, decouple_loss:0.0005380770890042186
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506798982620239, gen p mean: -0.11867640167474747, mean p set: 0.45125675201416016
loss_pred:0.014546751044690609, decouple_loss:0.0005559605779126287
The modified gen p mean: 0.4508551359176636, gen p mean: -0.12599360942840576, mean p set: 0.4514320194721222
loss_pred:0.014647424221038818, decouple_loss:0.0005759169580414891
The modified gen p mean: 0.4515964090824127, gen p mean: -0.12095295637845993, mean p set: 0.45217567682266235
loss_pred:0.014191499911248684, decouple_loss:0.0004750448861159384
2023-05-02 03:42:32 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13315200805664062, mean p set: 0.4502691626548767
loss_pred:0.017042189836502075, decouple_loss:0.0007684208103455603
The modified gen p mean: 0.449534147977829, gen p mean: -0.12769715487957, mean p set: 0.4500633478164673
loss_pred:0.016364257782697678, decouple_loss:0.0006039962754584849
The modified gen p mean: 0.4498292803764343, gen p mean: -0.12725137174129486, mean p set: 0.45035696029663086
loss_pred:0.016698749735951424, decouple_loss:0.000547913194168359
WV_1_PC_1_EH_0_PS_40, loss: 0.016733739525079727, avg_mse: 0.02609105408191681
current test mse: 0.026091
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493318498134613, gen p mean: -0.12107650935649872, mean p set: 0.4499072730541229
loss_pred:0.013937857002019882, decouple_loss:0.0003883719618897885
The modified gen p mean: 0.4503842294216156, gen p mean: -0.11707885563373566, mean p set: 0.45096179842948914The modified gen p mean: 0.45258018374443054, gen p mean: -0.12097115069627762, mean p set: 0.4531586468219757
loss_pred:0.014864866621792316, decouple_loss:0.0006188512197695673
loss_pred:0.014386644586920738, decouple_loss:0.0008029702585190535
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089203119277954, gen p mean: -0.12213769555091858, mean p set: 0.45147067308425903
loss_pred:0.01424858532845974, decouple_loss:0.0005572504014708102
The modified gen p mean: 0.4503594636917114, gen p mean: -0.12257961928844452, mean p set: 0.4509369432926178The modified gen p mean: 0.45089972019195557, gen p mean: -0.11861033737659454, mean p set: 0.4514783024787903
loss_pred:0.013992116786539555, decouple_loss:0.0004613552300725132
loss_pred:0.014996098354458809, decouple_loss:0.0005902302218601108
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45227181911468506, gen p mean: -0.1213405430316925, mean p set: 0.45284903049468994
loss_pred:0.0148507384583354, decouple_loss:0.0008909687167033553
The modified gen p mean: 0.44931739568710327, gen p mean: -0.11932852864265442, mean p set: 0.4498947560787201
The modified gen p mean: 0.45159509778022766, gen p mean: -0.12019388377666473, mean p set: 0.45217224955558777
loss_pred:0.014657177031040192, decouple_loss:0.0005446977447718382
loss_pred:0.01451644767075777, decouple_loss:0.0006749628228135407
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517885744571686, gen p mean: -0.11666909605264664, mean p set: 0.4523625671863556
loss_pred:0.015206261537969112, decouple_loss:0.0006018997519277036
The modified gen p mean: 0.4508786201477051, gen p mean: -0.12101846933364868, mean p set: 0.4514505863189697
loss_pred:0.014007024466991425, decouple_loss:0.0004950162256136537
The modified gen p mean: 0.45024603605270386, gen p mean: -0.11753705888986588, mean p set: 0.4508242905139923
loss_pred:0.01422511413693428, decouple_loss:0.0006138038588687778
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499610364437103, gen p mean: -0.11738040298223495, mean p set: 0.45053830742836
loss_pred:0.01416462380439043, decouple_loss:0.000441254407633096
The modified gen p mean: 0.4511892795562744, gen p mean: -0.1177164614200592, mean p set: 0.4517684876918793
loss_pred:0.014329658821225166, decouple_loss:0.0006748418090865016
The modified gen p mean: 0.4490258991718292, gen p mean: -0.11758003383874893, mean p set: 0.44960182905197144
loss_pred:0.015130157582461834, decouple_loss:0.0007758415886200964
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507817029953003, gen p mean: -0.11886508017778397, mean p set: 0.45135921239852905
loss_pred:0.014597989618778229, decouple_loss:0.0005634467815980315
The modified gen p mean: 0.4519524574279785, gen p mean: -0.11665628850460052, mean p set: 0.45253023505210876
loss_pred:0.014344573952257633, decouple_loss:0.0006463986937887967
The modified gen p mean: 0.45013323426246643, gen p mean: -0.11289654672145844, mean p set: 0.45071083307266235
loss_pred:0.014140519313514233, decouple_loss:0.0005677010049112141
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451665461063385, gen p mean: -0.1227336898446083, mean p set: 0.45224204659461975
loss_pred:0.013888304121792316, decouple_loss:0.0005255975411273539
The modified gen p mean: 0.4508713483810425, gen p mean: -0.11703039705753326, mean p set: 0.45144835114479065
loss_pred:0.01456659846007824, decouple_loss:0.0004973300383426249
The modified gen p mean: 0.45050734281539917, gen p mean: -0.11614400148391724, mean p set: 0.4510842561721802
loss_pred:0.013877315446734428, decouple_loss:0.000463318545371294
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531821310520172, gen p mean: -0.11806826293468475, mean p set: 0.45375457406044006
loss_pred:0.015059787780046463, decouple_loss:0.0007583146798424423
The modified gen p mean: 0.4498502016067505, gen p mean: -0.11817492544651031, mean p set: 0.4504260718822479
loss_pred:0.014895370230078697, decouple_loss:0.0006308373995125294
The modified gen p mean: 0.44911399483680725, gen p mean: -0.11919695138931274, mean p set: 0.4496879279613495
loss_pred:0.015237050130963326, decouple_loss:0.0005350540741346776
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517064094543457, gen p mean: -0.12023144960403442, mean p set: 0.45228278636932373
loss_pred:0.014011617749929428, decouple_loss:0.00083157978951931
The modified gen p mean: 0.45176297426223755, gen p mean: -0.12026967853307724, mean p set: 0.4523402452468872
loss_pred:0.014680118300020695, decouple_loss:0.0006457958370447159
The modified gen p mean: 0.4516201317310333, gen p mean: -0.12006611377000809, mean p set: 0.45220106840133667
loss_pred:0.01443945150822401, decouple_loss:0.0007805340574122965
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
NaN value num: 0
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479672312736511, gen p mean: -0.13161908090114594, mean p set: 0.44854092597961426
loss_pred:0.016542667523026466, decouple_loss:0.000505089876241982
The modified gen p mean: 0.44641345739364624, gen p mean: -0.1192946806550026, mean p set: 0.4469884932041168
The modified gen p mean: 0.44776585698127747, gen p mean: -0.12422167509794235, mean p set: 0.4483422338962555
loss_pred:0.01654086634516716, decouple_loss:0.0007237460231408477
loss_pred:0.015953704714775085, decouple_loss:0.0006465472397394478
2023-05-02 03:45:18 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.12965291738510132, mean p set: 0.4502691626548767
loss_pred:0.017002850770950317, decouple_loss:0.0007345374906435609
The modified gen p mean: 0.449538916349411, gen p mean: -0.1239321157336235, mean p set: 0.4500633478164673
loss_pred:0.016361497342586517, decouple_loss:0.000512869970407337
The modified gen p mean: 0.44982728362083435, gen p mean: -0.12373397499322891, mean p set: 0.45035696029663086
loss_pred:0.016624487936496735, decouple_loss:0.0005722796195186675
WV_1_PC_1_EH_0_PS_40, loss: 0.016693275421857834, avg_mse: 0.02601250633597374
current test mse: 0.026013
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450288325548172, gen p mean: -0.12419267743825912, mean p set: 0.4508633017539978
loss_pred:0.015107361599802971, decouple_loss:0.00040473201079294086
The modified gen p mean: 0.44803401827812195, gen p mean: -0.12275991588830948, mean p set: 0.4486088454723358The modified gen p mean: 0.4501655697822571, gen p mean: -0.12476829439401627, mean p set: 0.4507392346858978
loss_pred:0.015531082637608051, decouple_loss:0.0006771174375899136
loss_pred:0.015359826385974884, decouple_loss:0.0004903922090306878
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491254687309265, gen p mean: -0.11947209388017654, mean p set: 0.4497016966342926
loss_pred:0.015900304540991783, decouple_loss:0.0005967592587694526
The modified gen p mean: 0.44743993878364563, gen p mean: -0.12304510921239853, mean p set: 0.44801533222198486The modified gen p mean: 0.44791433215141296, gen p mean: -0.12455784529447556, mean p set: 0.44849130511283875
loss_pred:0.015819597989320755, decouple_loss:0.0007084705284796655loss_pred:0.015557351522147655, decouple_loss:0.0005568679771386087
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492819607257843, gen p mean: -0.12679938971996307, mean p set: 0.44986119866371155
loss_pred:0.016484683379530907, decouple_loss:0.0006393034709617496
The modified gen p mean: 0.44788119196891785, gen p mean: -0.12436576187610626, mean p set: 0.44845619797706604
loss_pred:0.015136166475713253, decouple_loss:0.0004844228969886899
The modified gen p mean: 0.4475254714488983, gen p mean: -0.12225665897130966, mean p set: 0.4481014907360077
loss_pred:0.016130521893501282, decouple_loss:0.0007267887121997774
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475595951080322, gen p mean: -0.12335492670536041, mean p set: 0.4481366276741028
loss_pred:0.015820538625121117, decouple_loss:0.0005295887240208685
The modified gen p mean: 0.4482067823410034, gen p mean: -0.12592414021492004, mean p set: 0.4487842321395874
loss_pred:0.01598403975367546, decouple_loss:0.0005888397572562099
The modified gen p mean: 0.4490949511528015, gen p mean: -0.12411202490329742, mean p set: 0.44967013597488403
loss_pred:0.015678944066166878, decouple_loss:0.0006089760572649539
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44663211703300476, gen p mean: -0.12228074669837952, mean p set: 0.44720733165740967
loss_pred:0.015734100714325905, decouple_loss:0.000602338055614382
The modified gen p mean: 0.4460386335849762, gen p mean: -0.12419518828392029, mean p set: 0.4466167390346527
loss_pred:0.01712363213300705, decouple_loss:0.0006608008989132941
The modified gen p mean: 0.4488031566143036, gen p mean: -0.1265258491039276, mean p set: 0.4493786096572876
loss_pred:0.015595097094774246, decouple_loss:0.0005209902883507311
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473865032196045, gen p mean: -0.12553955614566803, mean p set: 0.4479617476463318
loss_pred:0.01549464650452137, decouple_loss:0.0007061102078296244
The modified gen p mean: 0.44713225960731506, gen p mean: -0.12554442882537842, mean p set: 0.44770923256874084
loss_pred:0.01622861996293068, decouple_loss:0.0009679372305981815
The modified gen p mean: 0.4484039545059204, gen p mean: -0.12809833884239197, mean p set: 0.44898083806037903
loss_pred:0.016022708266973495, decouple_loss:0.0007294676033779979
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475066661834717, gen p mean: -0.12465063482522964, mean p set: 0.44808417558670044
loss_pred:0.015981534495949745, decouple_loss:0.0005016527138650417
The modified gen p mean: 0.4457392692565918, gen p mean: -0.12733007967472076, mean p set: 0.44631341099739075
loss_pred:0.016773849725723267, decouple_loss:0.0006191884749568999
The modified gen p mean: 0.4474174380302429, gen p mean: -0.12729616463184357, mean p set: 0.4479931592941284
loss_pred:0.015818284824490547, decouple_loss:0.0006666601984761655
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945406913757324, gen p mean: -0.12991315126419067, mean p set: 0.4500318169593811
loss_pred:0.015086430124938488, decouple_loss:0.0005108168697915971
The modified gen p mean: 0.4481532871723175, gen p mean: -0.1312357783317566, mean p set: 0.44873231649398804
loss_pred:0.015795964747667313, decouple_loss:0.0004963085521012545
The modified gen p mean: 0.44879549741744995, gen p mean: -0.12495536357164383, mean p set: 0.44937095046043396
loss_pred:0.01592588610947132, decouple_loss:0.0006627006223425269
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793257117271423, gen p mean: -0.13016515970230103, mean p set: 0.4485064744949341
loss_pred:0.015502125024795532, decouple_loss:0.0006229906575754285
The modified gen p mean: 0.44890066981315613, gen p mean: -0.12645086646080017, mean p set: 0.44947269558906555
loss_pred:0.015857161954045296, decouple_loss:0.000721470161806792
The modified gen p mean: 0.4481101632118225, gen p mean: -0.13046365976333618, mean p set: 0.44868648052215576
loss_pred:0.01549797784537077, decouple_loss:0.0005473167984746397
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803354144096375, gen p mean: -0.1271362453699112, mean p set: 0.44860756397247314
loss_pred:0.015142892487347126, decouple_loss:0.0004894716548733413
The modified gen p mean: 0.4478752315044403, gen p mean: -0.13391612470149994, mean p set: 0.4484488368034363
loss_pred:0.015609457157552242, decouple_loss:0.0005996005493216217
The modified gen p mean: 0.446955144405365, gen p mean: -0.13039153814315796, mean p set: 0.4475279748439789
loss_pred:0.016352176666259766, decouple_loss:0.0004645352892111987
2023-05-02 03:47:24 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1344669759273529, mean p set: 0.4502691626548767
loss_pred:0.017000846564769745, decouple_loss:0.0006333761848509312
The modified gen p mean: 0.44953322410583496, gen p mean: -0.1289055496454239, mean p set: 0.4500633478164673
loss_pred:0.016287952661514282, decouple_loss:0.0005998273263685405
The modified gen p mean: 0.44982650876045227, gen p mean: -0.12860582768917084, mean p set: 0.45035696029663086
loss_pred:0.016543680801987648, decouple_loss:0.0006026768824085593
WV_1_PC_1_EH_0_PS_40, loss: 0.016641423106193542, avg_mse: 0.025948651134967804
current test mse: 0.025949
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44712555408477783, gen p mean: -0.12633176147937775, mean p set: 0.44770026206970215
loss_pred:0.01673027314245701, decouple_loss:0.0006603829097002745
The modified gen p mean: 0.4487767815589905, gen p mean: -0.12497805804014206, mean p set: 0.44935378432273865
loss_pred:0.01560488622635603, decouple_loss:0.000710381951648742
The modified gen p mean: 0.44726115465164185, gen p mean: -0.1275164932012558, mean p set: 0.4478370249271393
loss_pred:0.01620105654001236, decouple_loss:0.000501964648719877
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479740560054779, gen p mean: -0.13488095998764038, mean p set: 0.4485483467578888
The modified gen p mean: 0.44701316952705383, gen p mean: -0.1288137584924698, mean p set: 0.44758954644203186
loss_pred:0.016282645985484123, decouple_loss:0.0005766916438005865
loss_pred:0.016376806423068047, decouple_loss:0.0005957467365078628
The modified gen p mean: 0.4476828873157501, gen p mean: -0.12706111371517181, mean p set: 0.44825637340545654
loss_pred:0.01580965891480446, decouple_loss:0.00067046721233055
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44748228788375854, gen p mean: -0.12767070531845093, mean p set: 0.44805729389190674
loss_pred:0.016433516517281532, decouple_loss:0.00047286637709476054
The modified gen p mean: 0.44821178913116455, gen p mean: -0.12460187077522278, mean p set: 0.44878700375556946The modified gen p mean: 0.44714030623435974, gen p mean: -0.12174741923809052, mean p set: 0.4477182924747467
loss_pred:0.015759699046611786, decouple_loss:0.00045283525832928717
loss_pred:0.016143254935741425, decouple_loss:0.000609101727604866
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460669755935669, gen p mean: -0.11854851245880127, mean p set: 0.4466431736946106
loss_pred:0.01604122295975685, decouple_loss:0.0007263061124831438
The modified gen p mean: 0.4476297199726105, gen p mean: -0.1265200972557068, mean p set: 0.44820740818977356
loss_pred:0.016217736527323723, decouple_loss:0.0004896313766948879
The modified gen p mean: 0.4476045072078705, gen p mean: -0.12202727049589157, mean p set: 0.4481804668903351
loss_pred:0.015276149846613407, decouple_loss:0.0006317248335108161
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480019807815552, gen p mean: -0.12274588644504547, mean p set: 0.4485757648944855
loss_pred:0.015599112957715988, decouple_loss:0.00078236946137622
The modified gen p mean: 0.44660282135009766, gen p mean: -0.12629126012325287, mean p set: 0.4471806287765503
loss_pred:0.015915101394057274, decouple_loss:0.0005667300429195166
The modified gen p mean: 0.448172390460968, gen p mean: -0.12405045330524445, mean p set: 0.44874924421310425
loss_pred:0.015362022444605827, decouple_loss:0.0007838534656912088
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481842517852783, gen p mean: -0.1309264898300171, mean p set: 0.4487628936767578
loss_pred:0.01627223566174507, decouple_loss:0.0008969504851847887
The modified gen p mean: 0.4466656446456909, gen p mean: -0.12837368249893188, mean p set: 0.44724079966545105
loss_pred:0.01654575578868389, decouple_loss:0.0005889980820938945
The modified gen p mean: 0.4489729702472687, gen p mean: -0.126962810754776, mean p set: 0.4495477080345154
loss_pred:0.01584741473197937, decouple_loss:0.0006086601642891765
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461528956890106, gen p mean: -0.12510652840137482, mean p set: 0.44672608375549316
loss_pred:0.01670168526470661, decouple_loss:0.0009558199089951813
The modified gen p mean: 0.4466959834098816, gen p mean: -0.12553490698337555, mean p set: 0.4472734034061432
loss_pred:0.01653488725423813, decouple_loss:0.0006320269894786179
The modified gen p mean: 0.44642555713653564, gen p mean: -0.12257116287946701, mean p set: 0.44700080156326294
loss_pred:0.016242394223809242, decouple_loss:0.0007091127336025238
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478799104690552, gen p mean: -0.12841001152992249, mean p set: 0.4484530985355377
loss_pred:0.01563759706914425, decouple_loss:0.0007541658123955131
The modified gen p mean: 0.44848453998565674, gen p mean: -0.12842997908592224, mean p set: 0.4490620791912079
loss_pred:0.016435934230685234, decouple_loss:0.0005123593145981431
The modified gen p mean: 0.4489959478378296, gen p mean: -0.1251506507396698, mean p set: 0.449575275182724
loss_pred:0.015687042847275734, decouple_loss:0.0006884413887746632
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482562243938446, gen p mean: -0.1303492933511734, mean p set: 0.4488303065299988
loss_pred:0.015464256517589092, decouple_loss:0.0006828187615610659
The modified gen p mean: 0.4472137689590454, gen p mean: -0.12820817530155182, mean p set: 0.447790265083313
loss_pred:0.015602276660501957, decouple_loss:0.0006543215713463724
The modified gen p mean: 0.4480091631412506, gen p mean: -0.12896032631397247, mean p set: 0.4485867917537689
loss_pred:0.015927616506814957, decouple_loss:0.0008101437706500292
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
NaN value num: 0
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44647082686424255, gen p mean: -0.1304052174091339, mean p set: 0.44704464077949524
loss_pred:0.01565404422581196, decouple_loss:0.0006685045664198697
The modified gen p mean: 0.4472265839576721, gen p mean: -0.12831538915634155, mean p set: 0.44780290126800537
loss_pred:0.016204161569476128, decouple_loss:0.0008752144640311599
The modified gen p mean: 0.44654905796051025, gen p mean: -0.1267806440591812, mean p set: 0.44712138175964355
loss_pred:0.016634037718176842, decouple_loss:0.0006425697356462479
2023-05-02 03:50:09 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13956263661384583, mean p set: 0.4502691626548767
loss_pred:0.017082909122109413, decouple_loss:0.0008298895554617047
The modified gen p mean: 0.44953954219818115, gen p mean: -0.13394273817539215, mean p set: 0.4500633478164673
loss_pred:0.016354182735085487, decouple_loss:0.00061177893076092
The modified gen p mean: 0.44983038306236267, gen p mean: -0.1337609887123108, mean p set: 0.45035696029663086
loss_pred:0.01658259704709053, decouple_loss:0.0006537124281749129
WV_1_PC_1_EH_0_PS_40, loss: 0.01670815423130989, avg_mse: 0.02604200690984726
current test mse: 0.026042
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820401072502136, gen p mean: -0.13327732682228088, mean p set: 0.4487774670124054
loss_pred:0.015156017616391182, decouple_loss:0.0005621560849249363
The modified gen p mean: 0.44910749793052673, gen p mean: -0.13467954099178314, mean p set: 0.4496842920780182The modified gen p mean: 0.44677168130874634, gen p mean: -0.13076633214950562, mean p set: 0.44734886288642883
loss_pred:0.015187817625701427, decouple_loss:0.0004919809871353209
loss_pred:0.015760380774736404, decouple_loss:0.000546858471352607
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484858214855194, gen p mean: -0.13954156637191772, mean p set: 0.449065238237381
loss_pred:0.016713013872504234, decouple_loss:0.001031541614793241
The modified gen p mean: 0.44802477955818176, gen p mean: -0.143098384141922, mean p set: 0.4485994875431061The modified gen p mean: 0.4462055563926697, gen p mean: -0.13310213387012482, mean p set: 0.4467800557613373
loss_pred:0.01697378419339657, decouple_loss:0.0007713265367783606
loss_pred:0.01606047712266445, decouple_loss:0.0011618342250585556
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493831694126129, gen p mean: -0.13327938318252563, mean p set: 0.449957937002182
loss_pred:0.014859616756439209, decouple_loss:0.0005284490762278438
The modified gen p mean: 0.44818076491355896, gen p mean: -0.1297111213207245, mean p set: 0.44875475764274597
loss_pred:0.015498860739171505, decouple_loss:0.0007023912039585412
The modified gen p mean: 0.44732311367988586, gen p mean: -0.13395808637142181, mean p set: 0.44789931178092957
loss_pred:0.015504163689911366, decouple_loss:0.0006091638351790607
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679099321365356, gen p mean: -0.13308081030845642, mean p set: 0.44736701250076294
loss_pred:0.01659502647817135, decouple_loss:0.000459416420198977
The modified gen p mean: 0.44747695326805115, gen p mean: -0.13277573883533478, mean p set: 0.4480498135089874
loss_pred:0.016256684437394142, decouple_loss:0.00041864431113936007
The modified gen p mean: 0.4470842778682709, gen p mean: -0.12693576514720917, mean p set: 0.4476620852947235
loss_pred:0.015973716974258423, decouple_loss:0.00037224162952043116
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699743390083313, gen p mean: -0.1324017494916916, mean p set: 0.4475730061531067
loss_pred:0.015760190784931183, decouple_loss:0.0004971044836565852
The modified gen p mean: 0.44682884216308594, gen p mean: -0.13270553946495056, mean p set: 0.44740378856658936
loss_pred:0.016055826097726822, decouple_loss:0.0005948215839453042
The modified gen p mean: 0.4479561150074005, gen p mean: -0.12789857387542725, mean p set: 0.4485313296318054
loss_pred:0.015601934865117073, decouple_loss:0.00038961536483839154
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677266478538513, gen p mean: -0.12757301330566406, mean p set: 0.4473509192466736
loss_pred:0.01640181802213192, decouple_loss:0.00046664479305036366
The modified gen p mean: 0.44907984137535095, gen p mean: -0.13589830696582794, mean p set: 0.4496566355228424
loss_pred:0.016059283167123795, decouple_loss:0.0004404277424328029
The modified gen p mean: 0.445620059967041, gen p mean: -0.12848764657974243, mean p set: 0.4461957514286041
loss_pred:0.015475974418222904, decouple_loss:0.00044780943426303566
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470449686050415, gen p mean: -0.13367685675621033, mean p set: 0.4476177394390106
loss_pred:0.015825098380446434, decouple_loss:0.0005037524388171732
The modified gen p mean: 0.4463074207305908, gen p mean: -0.12863558530807495, mean p set: 0.44688549637794495
loss_pred:0.017295876517891884, decouple_loss:0.00047815460129640996
The modified gen p mean: 0.44666728377342224, gen p mean: -0.13443619012832642, mean p set: 0.44724392890930176
loss_pred:0.016141897067427635, decouple_loss:0.0004294126993045211
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746825098991394, gen p mean: -0.1340937316417694, mean p set: 0.4480447769165039
loss_pred:0.015498390421271324, decouple_loss:0.0005795105826109648
The modified gen p mean: 0.4476987421512604, gen p mean: -0.1327388435602188, mean p set: 0.44827520847320557
loss_pred:0.016074830666184425, decouple_loss:0.0007097661145962775
The modified gen p mean: 0.4466884434223175, gen p mean: -0.13332153856754303, mean p set: 0.44726279377937317
loss_pred:0.017037726938724518, decouple_loss:0.00044837119639851153
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853726029396057, gen p mean: -0.13866059482097626, mean p set: 0.4491124749183655
loss_pred:0.01563672535121441, decouple_loss:0.0005136820836924016
The modified gen p mean: 0.4481763541698456, gen p mean: -0.1309928297996521, mean p set: 0.44875606894493103
loss_pred:0.015251590870320797, decouple_loss:0.0004617941740434617
The modified gen p mean: 0.44651466608047485, gen p mean: -0.1325342208147049, mean p set: 0.4470905661582947
loss_pred:0.01606442593038082, decouple_loss:0.00038596242666244507
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732943177223206, gen p mean: -0.1346765160560608, mean p set: 0.4478999078273773
loss_pred:0.016702864319086075, decouple_loss:0.0005080882692709565
The modified gen p mean: 0.44641852378845215, gen p mean: -0.13233080506324768, mean p set: 0.4469945430755615
loss_pred:0.016011280938982964, decouple_loss:0.0005695858271792531
The modified gen p mean: 0.4484778046607971, gen p mean: -0.13072748482227325, mean p set: 0.44905006885528564
loss_pred:0.01567758247256279, decouple_loss:0.00041434061131440103
2023-05-02 03:52:16 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1407785564661026, mean p set: 0.4502691626548767
loss_pred:0.017068825662136078, decouple_loss:0.0004290214565116912
The modified gen p mean: 0.4495316743850708, gen p mean: -0.13496141135692596, mean p set: 0.4500633478164673
loss_pred:0.0163564532995224, decouple_loss:0.00043043840560130775
The modified gen p mean: 0.4498283863067627, gen p mean: -0.13459311425685883, mean p set: 0.45035696029663086
loss_pred:0.01664401777088642, decouple_loss:0.0005204568733461201
WV_1_PC_1_EH_0_PS_40, loss: 0.016712764278054237, avg_mse: 0.02607032284140587
current test mse: 0.02607
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472672641277313, gen p mean: -0.12985850870609283, mean p set: 0.4478435218334198
loss_pred:0.01604396291077137, decouple_loss:0.00043909531086683273
The modified gen p mean: 0.4475729167461395, gen p mean: -0.13029015064239502, mean p set: 0.4481465220451355
loss_pred:0.0155060775578022, decouple_loss:0.00044105437700636685
The modified gen p mean: 0.4476611614227295, gen p mean: -0.13761736452579498, mean p set: 0.4482364058494568
loss_pred:0.016481710597872734, decouple_loss:0.0005454663187265396
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44570812582969666, gen p mean: -0.1267639547586441, mean p set: 0.44628363847732544
The modified gen p mean: 0.4466289281845093, gen p mean: -0.12880992889404297, mean p set: 0.44720491766929626
loss_pred:0.015712540596723557, decouple_loss:0.0003809548798017204
loss_pred:0.016636274755001068, decouple_loss:0.0004022888606414199
The modified gen p mean: 0.44759401679039, gen p mean: -0.13198363780975342, mean p set: 0.44817039370536804
loss_pred:0.015242925845086575, decouple_loss:0.0004420025506988168
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471704959869385, gen p mean: -0.13584406673908234, mean p set: 0.447747141122818
The modified gen p mean: 0.44681090116500854, gen p mean: -0.12759388983249664, mean p set: 0.4473875164985657
loss_pred:0.016175763681530952, decouple_loss:0.0006378788384608924
loss_pred:0.017000775784254074, decouple_loss:0.0004810114623978734
The modified gen p mean: 0.44640639424324036, gen p mean: -0.1274987906217575, mean p set: 0.44698062539100647
loss_pred:0.01659926027059555, decouple_loss:0.0005244553904049098
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460006058216095, gen p mean: -0.1263868659734726, mean p set: 0.446577250957489
loss_pred:0.015562830492854118, decouple_loss:0.0004884105292148888
The modified gen p mean: 0.4477679431438446, gen p mean: -0.1272098422050476, mean p set: 0.44834578037261963
loss_pred:0.015422486700117588, decouple_loss:0.00037503245403058827
The modified gen p mean: 0.44804638624191284, gen p mean: -0.12601087987422943, mean p set: 0.4486234486103058
loss_pred:0.015598894096910954, decouple_loss:0.00042385011329315603
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44833260774612427, gen p mean: -0.13160039484500885, mean p set: 0.44890812039375305
loss_pred:0.01489910390228033, decouple_loss:0.0005016403738409281
The modified gen p mean: 0.4469904601573944, gen p mean: -0.13384617865085602, mean p set: 0.44756510853767395
loss_pred:0.015425901859998703, decouple_loss:0.000578025879804045
The modified gen p mean: 0.4500137269496918, gen p mean: -0.1301272213459015, mean p set: 0.45058512687683105
loss_pred:0.015303421765565872, decouple_loss:0.0004370861570350826
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446413516998291, gen p mean: -0.1343023031949997, mean p set: 0.4469883143901825
loss_pred:0.015627926215529442, decouple_loss:0.0004327036440372467
The modified gen p mean: 0.44715964794158936, gen p mean: -0.1323813498020172, mean p set: 0.4477372169494629
The modified gen p mean: 0.44731366634368896, gen p mean: -0.1293400377035141, mean p set: 0.4478892683982849
loss_pred:0.0160960890352726, decouple_loss:0.0005567455082200468
loss_pred:0.015470054000616074, decouple_loss:0.00042499331175349653
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469950497150421, gen p mean: -0.13174396753311157, mean p set: 0.44756776094436646
loss_pred:0.015913842245936394, decouple_loss:0.0004486604011617601
The modified gen p mean: 0.4478704631328583, gen p mean: -0.1298302263021469, mean p set: 0.44844627380371094
loss_pred:0.01549509447067976, decouple_loss:0.0004329357179813087
The modified gen p mean: 0.4483095705509186, gen p mean: -0.1339847892522812, mean p set: 0.4488883912563324
loss_pred:0.016451243311166763, decouple_loss:0.0005284175276756287
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44693025946617126, gen p mean: -0.1341678351163864, mean p set: 0.4475059509277344
loss_pred:0.0163717120885849, decouple_loss:0.0005781817017123103
The modified gen p mean: 0.4474724233150482, gen p mean: -0.13393054902553558, mean p set: 0.4480472505092621
The modified gen p mean: 0.4479093849658966, gen p mean: -0.12880636751651764, mean p set: 0.44848722219467163
loss_pred:0.015567938797175884, decouple_loss:0.0006521741161122918
loss_pred:0.015158550813794136, decouple_loss:0.00041858485201373696
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464336335659027, gen p mean: -0.1338232457637787, mean p set: 0.44700849056243896
loss_pred:0.016132405027747154, decouple_loss:0.0004523501847870648
The modified gen p mean: 0.4487535357475281, gen p mean: -0.13846194744110107, mean p set: 0.4493309259414673
loss_pred:0.016252225264906883, decouple_loss:0.0005474458448588848
The modified gen p mean: 0.4475286602973938, gen p mean: -0.13288305699825287, mean p set: 0.44810381531715393
loss_pred:0.01590854302048683, decouple_loss:0.0005776534671895206
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681450724601746, gen p mean: -0.13888324797153473, mean p set: 0.4473881721496582
loss_pred:0.014821282587945461, decouple_loss:0.00047690284554846585
The modified gen p mean: 0.4475134015083313, gen p mean: -0.13078851997852325, mean p set: 0.4480895698070526
The modified gen p mean: 0.44713908433914185, gen p mean: -0.13337084650993347, mean p set: 0.4477144777774811
loss_pred:0.014463822357356548, decouple_loss:0.0003942662733606994
loss_pred:0.014563554897904396, decouple_loss:0.0005329114501364529
2023-05-02 03:55:01 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.14023485779762268, mean p set: 0.4502691626548767
loss_pred:0.016914265230298042, decouple_loss:0.0005408103461377323
The modified gen p mean: 0.44953402876853943, gen p mean: -0.13435593247413635, mean p set: 0.4500633478164673
loss_pred:0.016338374465703964, decouple_loss:0.000493267085403204
The modified gen p mean: 0.4498269259929657, gen p mean: -0.1344573199748993, mean p set: 0.45035696029663086
loss_pred:0.016569707542657852, decouple_loss:0.0005226806970313191
WV_1_PC_1_EH_0_PS_40, loss: 0.016633396968245506, avg_mse: 0.025966191664338112
current test mse: 0.025966
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473801553249359, gen p mean: -0.13606907427310944, mean p set: 0.4479547441005707
loss_pred:0.014344988390803337, decouple_loss:0.00061639747582376
The modified gen p mean: 0.4475979506969452, gen p mean: -0.13831418752670288, mean p set: 0.44817450642585754The modified gen p mean: 0.4476046860218048, gen p mean: -0.13641691207885742, mean p set: 0.4481835961341858
loss_pred:0.014999544247984886, decouple_loss:0.0004520735237747431
loss_pred:0.014820026233792305, decouple_loss:0.00042787889833562076
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480765461921692, gen p mean: -0.13145887851715088, mean p set: 0.4486541748046875
loss_pred:0.01494437362998724, decouple_loss:0.00043961373739875853
The modified gen p mean: 0.44694074988365173, gen p mean: -0.1369253247976303, mean p set: 0.4475173056125641
The modified gen p mean: 0.44802454113960266, gen p mean: -0.13347017765045166, mean p set: 0.44860121607780457
loss_pred:0.014841769821941853, decouple_loss:0.0004409377870615572
loss_pred:0.014108712784945965, decouple_loss:0.00046998943435028195
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478008449077606, gen p mean: -0.13471072912216187, mean p set: 0.4483788311481476
loss_pred:0.014956134371459484, decouple_loss:0.0004704223829321563
The modified gen p mean: 0.4458852708339691, gen p mean: -0.13403384387493134, mean p set: 0.44645851850509644The modified gen p mean: 0.4476385712623596, gen p mean: -0.1333279311656952, mean p set: 0.4482133686542511
loss_pred:0.014444318599998951, decouple_loss:0.00041232621879316866loss_pred:0.014859815128147602, decouple_loss:0.0004493983287829906
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840148091316223, gen p mean: -0.13371029496192932, mean p set: 0.44897761940956116
loss_pred:0.014387530274689198, decouple_loss:0.00045636837603524327
The modified gen p mean: 0.44859543442726135, gen p mean: -0.13114836812019348, mean p set: 0.44917070865631104
loss_pred:0.014735512435436249, decouple_loss:0.0005403179093264043
The modified gen p mean: 0.44760778546333313, gen p mean: -0.1350204199552536, mean p set: 0.4481825828552246
loss_pred:0.014211063273251057, decouple_loss:0.00042590987868607044
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466981589794159, gen p mean: -0.13382689654827118, mean p set: 0.44727250933647156
loss_pred:0.014608779922127724, decouple_loss:0.00037624427932314575
The modified gen p mean: 0.4480459690093994, gen p mean: -0.13137954473495483, mean p set: 0.44862261414527893
loss_pred:0.014413970522582531, decouple_loss:0.00039429208845831454
The modified gen p mean: 0.44752779603004456, gen p mean: -0.13355843722820282, mean p set: 0.4481063485145569
loss_pred:0.015203599818050861, decouple_loss:0.0004038521437905729
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742491841316223, gen p mean: -0.13142774999141693, mean p set: 0.44800058007240295
loss_pred:0.014044009149074554, decouple_loss:0.00042390829185023904
The modified gen p mean: 0.44856005907058716, gen p mean: -0.12729793787002563, mean p set: 0.44913291931152344
The modified gen p mean: 0.44668325781822205, gen p mean: -0.13050290942192078, mean p set: 0.4472596049308777
loss_pred:0.014831813983619213, decouple_loss:0.00033787841675803065
loss_pred:0.014843517914414406, decouple_loss:0.0003773501666728407
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474550783634186, gen p mean: -0.12860839068889618, mean p set: 0.4480327069759369
loss_pred:0.014159362763166428, decouple_loss:0.00042838757508434355
The modified gen p mean: 0.4463835656642914, gen p mean: -0.13129590451717377, mean p set: 0.44695839285850525
loss_pred:0.014453505165874958, decouple_loss:0.00045205160859040916
The modified gen p mean: 0.4479197561740875, gen p mean: -0.1233169212937355, mean p set: 0.4484962224960327
loss_pred:0.014380031265318394, decouple_loss:0.0004058985796291381
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44628793001174927, gen p mean: -0.13112151622772217, mean p set: 0.4468632936477661
loss_pred:0.014434204436838627, decouple_loss:0.00046262366231530905
The modified gen p mean: 0.4477265775203705, gen p mean: -0.1303243637084961, mean p set: 0.4483039677143097
The modified gen p mean: 0.448363721370697, gen p mean: -0.13366232812404633, mean p set: 0.448940247297287
loss_pred:0.014266014099121094, decouple_loss:0.0004210071638226509
loss_pred:0.014536329545080662, decouple_loss:0.000394408474676311
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475582540035248, gen p mean: -0.13373510539531708, mean p set: 0.44813501834869385
loss_pred:0.014945625327527523, decouple_loss:0.0005575156537815928
The modified gen p mean: 0.4473932087421417, gen p mean: -0.13132911920547485, mean p set: 0.4479711353778839
The modified gen p mean: 0.4478108584880829, gen p mean: -0.12947581708431244, mean p set: 0.44838836789131165
loss_pred:0.014716507866978645, decouple_loss:0.0004840121837332845
loss_pred:0.014058385975658894, decouple_loss:0.0005541726714000106
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471047818660736, gen p mean: -0.12994502484798431, mean p set: 0.4476828873157501
loss_pred:0.01422160118818283, decouple_loss:0.0004794362757820636
The modified gen p mean: 0.44734224677085876, gen p mean: -0.12572266161441803, mean p set: 0.44791606068611145
loss_pred:0.014868923462927341, decouple_loss:0.0005441519315354526
The modified gen p mean: 0.4485718905925751, gen p mean: -0.12758496403694153, mean p set: 0.4491502642631531
loss_pred:0.014666684903204441, decouple_loss:0.0004034929152112454
2023-05-02 03:57:07 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12928485870361328, mean p set: 0.4502691626548767
loss_pred:0.01689860410988331, decouple_loss:0.0005081681883893907
The modified gen p mean: 0.4495331048965454, gen p mean: -0.1235450729727745, mean p set: 0.4500633478164673
loss_pred:0.016295233741402626, decouple_loss:0.000500751193612814
The modified gen p mean: 0.4498281180858612, gen p mean: -0.12346413731575012, mean p set: 0.45035696029663086
loss_pred:0.016569605097174644, decouple_loss:0.00046263268450275064
WV_1_PC_1_EH_0_PS_40, loss: 0.0166123416274786, avg_mse: 0.025927430018782616
current test mse: 0.025927
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44867393374443054, gen p mean: -0.12298781424760818, mean p set: 0.44924822449684143
loss_pred:0.014098535291850567, decouple_loss:0.0004032564756926149
The modified gen p mean: 0.4473303556442261, gen p mean: -0.11947333067655563, mean p set: 0.4479072690010071
loss_pred:0.014645392075181007, decouple_loss:0.0005322156939655542
The modified gen p mean: 0.4469231963157654, gen p mean: -0.12613773345947266, mean p set: 0.4475003480911255
loss_pred:0.014476225711405277, decouple_loss:0.00043173437006771564
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719064235687256, gen p mean: -0.12829695641994476, mean p set: 0.4477669298648834
loss_pred:0.014648772776126862, decouple_loss:0.00041625776793807745
The modified gen p mean: 0.44732171297073364, gen p mean: -0.12333066761493683, mean p set: 0.44789940118789673The modified gen p mean: 0.4485451579093933, gen p mean: -0.11747930943965912, mean p set: 0.4491216838359833
loss_pred:0.015094326809048653, decouple_loss:0.0005315685411915183
loss_pred:0.014144932851195335, decouple_loss:0.0004498610505834222
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471905529499054, gen p mean: -0.12699075043201447, mean p set: 0.4477671980857849
loss_pred:0.014530233107507229, decouple_loss:0.0004258448607288301
The modified gen p mean: 0.44686561822891235, gen p mean: -0.12864916026592255, mean p set: 0.4474402070045471The modified gen p mean: 0.4487956166267395, gen p mean: -0.12160465121269226, mean p set: 0.44937047362327576
loss_pred:0.014831208623945713, decouple_loss:0.00043074897257611156
loss_pred:0.014728457666933537, decouple_loss:0.00039894189103506505
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44684669375419617, gen p mean: -0.1275092214345932, mean p set: 0.4474206268787384
loss_pred:0.014609623700380325, decouple_loss:0.00045734288869425654
The modified gen p mean: 0.44829168915748596, gen p mean: -0.1288350373506546, mean p set: 0.44886934757232666
loss_pred:0.014217821881175041, decouple_loss:0.0005098803667351604
The modified gen p mean: 0.44764435291290283, gen p mean: -0.12435754388570786, mean p set: 0.44821637868881226
loss_pred:0.014749521389603615, decouple_loss:0.0004696334945037961
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802725315093994, gen p mean: -0.12267069518566132, mean p set: 0.44860079884529114
loss_pred:0.014310047030448914, decouple_loss:0.00044666111352853477
The modified gen p mean: 0.44780150055885315, gen p mean: -0.1264561414718628, mean p set: 0.44837847352027893
loss_pred:0.014390493743121624, decouple_loss:0.0006249830476008356
The modified gen p mean: 0.4464554190635681, gen p mean: -0.12937846779823303, mean p set: 0.4470282196998596
loss_pred:0.01426679827272892, decouple_loss:0.00041528441943228245
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473465085029602, gen p mean: -0.12900744378566742, mean p set: 0.4479212760925293
loss_pred:0.014124567620456219, decouple_loss:0.0005654984270222485
The modified gen p mean: 0.4477234482765198, gen p mean: -0.12829014658927917, mean p set: 0.4483005702495575
loss_pred:0.015036800876259804, decouple_loss:0.0004333970427978784
The modified gen p mean: 0.4461863040924072, gen p mean: -0.1271274983882904, mean p set: 0.44676437973976135
loss_pred:0.014248544350266457, decouple_loss:0.000392142595956102
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44675901532173157, gen p mean: -0.13198894262313843, mean p set: 0.4473342299461365
loss_pred:0.014532986097037792, decouple_loss:0.00041665040771476924
The modified gen p mean: 0.44722723960876465, gen p mean: -0.12906666100025177, mean p set: 0.44780340790748596
loss_pred:0.014627027325332165, decouple_loss:0.00046928765368647873
The modified gen p mean: 0.44769036769866943, gen p mean: -0.12313587963581085, mean p set: 0.4482652246952057
loss_pred:0.014195606112480164, decouple_loss:0.00036923939478583634
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470861852169037, gen p mean: -0.13202668726444244, mean p set: 0.4476650059223175
loss_pred:0.014608549885451794, decouple_loss:0.00042044027941301465
The modified gen p mean: 0.44677814841270447, gen p mean: -0.12483125925064087, mean p set: 0.4473542869091034
loss_pred:0.014350187964737415, decouple_loss:0.0004368869704194367
The modified gen p mean: 0.44720885157585144, gen p mean: -0.12950986623764038, mean p set: 0.44778600335121155
loss_pred:0.014614411629736423, decouple_loss:0.0005258689634501934
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476225674152374, gen p mean: -0.12543489038944244, mean p set: 0.4481982886791229
loss_pred:0.014223298989236355, decouple_loss:0.0006324410205706954
The modified gen p mean: 0.447946161031723, gen p mean: -0.1299484521150589, mean p set: 0.44852009415626526
loss_pred:0.014054335653781891, decouple_loss:0.0004942144150845706
The modified gen p mean: 0.44553419947624207, gen p mean: -0.1266881376504898, mean p set: 0.4461096227169037
loss_pred:0.01443746779114008, decouple_loss:0.0005734252627007663
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
NaN value num: 0
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45350900292396545, gen p mean: -0.11664894223213196, mean p set: 0.45408543944358826
loss_pred:0.015595168806612492, decouple_loss:0.0005874081398360431
The modified gen p mean: 0.45070570707321167, gen p mean: -0.11046827584505081, mean p set: 0.4512827396392822
loss_pred:0.015336363576352596, decouple_loss:0.0006113803246989846
The modified gen p mean: 0.4533131420612335, gen p mean: -0.11925362050533295, mean p set: 0.45388877391815186
loss_pred:0.015907498076558113, decouple_loss:0.000633779913187027
2023-05-02 03:59:48 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12883152067661285, mean p set: 0.4502691626548767
loss_pred:0.01691628433763981, decouple_loss:0.000647533917799592
The modified gen p mean: 0.4495355188846588, gen p mean: -0.1238616332411766, mean p set: 0.4500633478164673
loss_pred:0.016226034611463547, decouple_loss:0.0006048728828318417
The modified gen p mean: 0.44982850551605225, gen p mean: -0.12388592958450317, mean p set: 0.45035696029663086
loss_pred:0.016582066193223, decouple_loss:0.0005239546881057322
WV_1_PC_1_EH_0_PS_40, loss: 0.016604401171207428, avg_mse: 0.02588922157883644
current test mse: 0.025889
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452329158782959, gen p mean: -0.11960718780755997, mean p set: 0.452907919883728
loss_pred:0.01579148694872856, decouple_loss:0.0006856166874058545
The modified gen p mean: 0.4493275582790375, gen p mean: -0.11636628210544586, mean p set: 0.44990551471710205The modified gen p mean: 0.450600802898407, gen p mean: -0.1196201741695404, mean p set: 0.45117560029029846
loss_pred:0.014716864563524723, decouple_loss:0.00045996461994946003loss_pred:0.014738447964191437, decouple_loss:0.0005236398428678513
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45152878761291504, gen p mean: -0.11269377171993256, mean p set: 0.452106237411499
loss_pred:0.015258854255080223, decouple_loss:0.0005674195708706975
The modified gen p mean: 0.4490277171134949, gen p mean: -0.114557184278965, mean p set: 0.44960349798202515The modified gen p mean: 0.45080527663230896, gen p mean: -0.10815862566232681, mean p set: 0.45138245820999146
loss_pred:0.015010669827461243, decouple_loss:0.00044965746928937733loss_pred:0.015388350933790207, decouple_loss:0.00056001654593274
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829079508781433, gen p mean: -0.11002814024686813, mean p set: 0.4488649070262909
loss_pred:0.01490696333348751, decouple_loss:0.0005537843680940568
The modified gen p mean: 0.45235493779182434, gen p mean: -0.10460729151964188, mean p set: 0.45293283462524414
loss_pred:0.015584433451294899, decouple_loss:0.0005894538480788469
The modified gen p mean: 0.4522102475166321, gen p mean: -0.10514619946479797, mean p set: 0.45278817415237427
loss_pred:0.016403520479798317, decouple_loss:0.000578473205678165
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517630636692047, gen p mean: -0.10657098144292831, mean p set: 0.45234063267707825
loss_pred:0.016389060765504837, decouple_loss:0.00047563808038830757
The modified gen p mean: 0.45190688967704773, gen p mean: -0.10776808857917786, mean p set: 0.4524848163127899
loss_pred:0.014998489059507847, decouple_loss:0.0006822808063589036
The modified gen p mean: 0.45060884952545166, gen p mean: -0.10068948566913605, mean p set: 0.4511864483356476
loss_pred:0.01558156218379736, decouple_loss:0.0005132694495841861
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059990882873535, gen p mean: -0.10161326825618744, mean p set: 0.45117807388305664
loss_pred:0.015156281180679798, decouple_loss:0.0006198695045895875
The modified gen p mean: 0.45183756947517395, gen p mean: -0.1087769940495491, mean p set: 0.4524140954017639
loss_pred:0.015232011675834656, decouple_loss:0.000555685895960778
The modified gen p mean: 0.4502149820327759, gen p mean: -0.11534292995929718, mean p set: 0.450794517993927
loss_pred:0.014914412051439285, decouple_loss:0.0006658777710981667
Iteration: 306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45120707154273987, gen p mean: -0.10455349087715149, mean p set: 0.4517843425273895
loss_pred:0.016691815108060837, decouple_loss:0.0005554975941777229
The modified gen p mean: 0.4509755074977875, gen p mean: -0.11179282516241074, mean p set: 0.4515541195869446
loss_pred:0.01488345954567194, decouple_loss:0.0004980493686161935
The modified gen p mean: 0.45141977071762085, gen p mean: -0.10686148703098297, mean p set: 0.45199936628341675
loss_pred:0.016076793894171715, decouple_loss:0.0005801260704174638
Iteration: 307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513702690601349, gen p mean: -0.11192847788333893, mean p set: 0.4519501030445099
loss_pred:0.014929383061826229, decouple_loss:0.0005726356175728142
The modified gen p mean: 0.4501877427101135, gen p mean: -0.11597314476966858, mean p set: 0.4507656991481781
loss_pred:0.016178764402866364, decouple_loss:0.0008818716742098331
The modified gen p mean: 0.45083653926849365, gen p mean: -0.10909044742584229, mean p set: 0.45141345262527466
loss_pred:0.01606302335858345, decouple_loss:0.0005021440447308123
Iteration: 308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517941176891327, gen p mean: -0.11126020550727844, mean p set: 0.45236828923225403
loss_pred:0.016167018562555313, decouple_loss:0.0006670985021628439
The modified gen p mean: 0.4524703025817871, gen p mean: -0.11590774357318878, mean p set: 0.45304831862449646
loss_pred:0.015801671892404556, decouple_loss:0.0006090254173614085
The modified gen p mean: 0.45098233222961426, gen p mean: -0.10857754945755005, mean p set: 0.4515576958656311
loss_pred:0.015015579760074615, decouple_loss:0.0005646002828143537
Iteration: 309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45105448365211487, gen p mean: -0.11903513222932816, mean p set: 0.4516323506832123
loss_pred:0.01528228260576725, decouple_loss:0.00048751270514912903
The modified gen p mean: 0.4515032470226288, gen p mean: -0.11591538786888123, mean p set: 0.4520801901817322
loss_pred:0.014810940250754356, decouple_loss:0.0004483247175812721
The modified gen p mean: 0.4512973725795746, gen p mean: -0.11980275809764862, mean p set: 0.45187628269195557
loss_pred:0.015396729111671448, decouple_loss:0.0006777590024285018
Iteration: 310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45022666454315186, gen p mean: -0.12103594094514847, mean p set: 0.45080307126045227
loss_pred:0.015385397709906101, decouple_loss:0.0006798478425480425
The modified gen p mean: 0.44980907440185547, gen p mean: -0.12239710241556168, mean p set: 0.4503856897354126
The modified gen p mean: 0.4513866603374481, gen p mean: -0.11722437292337418, mean p set: 0.4519629180431366
loss_pred:0.01575806550681591, decouple_loss:0.0006398918922059238
loss_pred:0.01441743690520525, decouple_loss:0.000490560894832015
2023-05-02 04:01:54 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13150623440742493, mean p set: 0.4502691626548767
loss_pred:0.01709596998989582, decouple_loss:0.0006535034044645727
The modified gen p mean: 0.4495336711406708, gen p mean: -0.12647925317287445, mean p set: 0.4500633478164673
loss_pred:0.01636687107384205, decouple_loss:0.0006441338919103146
The modified gen p mean: 0.44982650876045227, gen p mean: -0.1264382153749466, mean p set: 0.45035696029663086
loss_pred:0.016689272597432137, decouple_loss:0.0006172542925924063
WV_1_PC_1_EH_0_PS_40, loss: 0.01674928516149521, avg_mse: 0.026054080575704575
current test mse: 0.026054
Iteration: 311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506208300590515, gen p mean: -0.12222329527139664, mean p set: 0.4511964023113251
loss_pred:0.015455025248229504, decouple_loss:0.0007536843768320978
The modified gen p mean: 0.4509718120098114, gen p mean: -0.11981738358736038, mean p set: 0.4515494108200073
loss_pred:0.014925097115337849, decouple_loss:0.0005280885379761457
The modified gen p mean: 0.4510435163974762, gen p mean: -0.11593847721815109, mean p set: 0.4516221284866333
loss_pred:0.014931035228073597, decouple_loss:0.0005614359979517758
Iteration: 312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45105937123298645, gen p mean: -0.12226492911577225, mean p set: 0.45163723826408386
loss_pred:0.015623821876943111, decouple_loss:0.0006652727606706321
The modified gen p mean: 0.45088088512420654, gen p mean: -0.11866245418787003, mean p set: 0.45146021246910095The modified gen p mean: 0.4512050449848175, gen p mean: -0.1201096773147583, mean p set: 0.4517787992954254
loss_pred:0.015150702558457851, decouple_loss:0.0005813621683046222
loss_pred:0.014736087992787361, decouple_loss:0.0005173106328584254
Iteration: 313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45057424902915955, gen p mean: -0.13571414351463318, mean p set: 0.4511508643627167
loss_pred:0.015026555396616459, decouple_loss:0.0005146633484400809
The modified gen p mean: 0.45110562443733215, gen p mean: -0.12233123183250427, mean p set: 0.4516826570034027
loss_pred:0.015552200376987457, decouple_loss:0.0005365288234315813
The modified gen p mean: 0.44954732060432434, gen p mean: -0.13033591210842133, mean p set: 0.4501255452632904
loss_pred:0.014744210988283157, decouple_loss:0.0004405246872920543
Iteration: 314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519158899784088, gen p mean: -0.11836894601583481, mean p set: 0.45249274373054504
loss_pred:0.016545558348298073, decouple_loss:0.0005568044725805521
The modified gen p mean: 0.4497240483760834, gen p mean: -0.116445392370224, mean p set: 0.4503021836280823
loss_pred:0.015389714390039444, decouple_loss:0.000543442671187222
The modified gen p mean: 0.45187264680862427, gen p mean: -0.1163410022854805, mean p set: 0.4524483382701874
loss_pred:0.016239911317825317, decouple_loss:0.0007043867371976376
Iteration: 315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513475298881531, gen p mean: -0.1316651701927185, mean p set: 0.4519265294075012
loss_pred:0.01702028512954712, decouple_loss:0.0008453236077912152
The modified gen p mean: 0.4506870210170746, gen p mean: -0.13214941322803497, mean p set: 0.45126447081565857
loss_pred:0.015847861766815186, decouple_loss:0.0005552792572416365
The modified gen p mean: 0.4529837369918823, gen p mean: -0.13047271966934204, mean p set: 0.45355916023254395
loss_pred:0.016564931720495224, decouple_loss:0.0007627898594364524
Iteration: 316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492425322532654, gen p mean: -0.13137082755565643, mean p set: 0.44981685280799866
loss_pred:0.016620617359876633, decouple_loss:0.0005117940600030124
The modified gen p mean: 0.450497567653656, gen p mean: -0.1276198923587799, mean p set: 0.4510754346847534
loss_pred:0.01579376496374607, decouple_loss:0.0005009275046177208
The modified gen p mean: 0.4502488076686859, gen p mean: -0.1345662921667099, mean p set: 0.45082327723503113
loss_pred:0.016827668994665146, decouple_loss:0.0005639701848849654
Iteration: 317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45153287053108215, gen p mean: -0.11749204993247986, mean p set: 0.45210859179496765
loss_pred:0.016873901709914207, decouple_loss:0.0006888126372359693
The modified gen p mean: 0.4494648873806, gen p mean: -0.11336638033390045, mean p set: 0.45004045963287354
The modified gen p mean: 0.4493219554424286, gen p mean: -0.11671033501625061, mean p set: 0.4498981535434723
loss_pred:0.01622895896434784, decouple_loss:0.0004898704355582595
loss_pred:0.016196416690945625, decouple_loss:0.0006180083728395402
Iteration: 318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500114917755127, gen p mean: -0.12265531718730927, mean p set: 0.4505898058414459
The modified gen p mean: 0.45115405321121216, gen p mean: -0.11686519533395767, mean p set: 0.451731413602829
loss_pred:0.01668471284210682, decouple_loss:0.0006841684225946665
loss_pred:0.017435139045119286, decouple_loss:0.0006731825997121632
The modified gen p mean: 0.45043161511421204, gen p mean: -0.12104801833629608, mean p set: 0.4510097801685333
loss_pred:0.01559989620000124, decouple_loss:0.0007066333200782537
Iteration: 319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514063000679016, gen p mean: -0.12186182290315628, mean p set: 0.4519835412502289
loss_pred:0.015240853652358055, decouple_loss:0.0005308981635607779
The modified gen p mean: 0.4498187005519867, gen p mean: -0.1197332963347435, mean p set: 0.45039525628089905
loss_pred:0.01607956737279892, decouple_loss:0.0005407426506280899
The modified gen p mean: 0.4484160840511322, gen p mean: -0.12186826020479202, mean p set: 0.44899213314056396
loss_pred:0.015607909299433231, decouple_loss:0.0006244214600883424
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
NaN value num: 0
Iteration: 320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478362500667572, gen p mean: -0.12863938510417938, mean p set: 0.44841188192367554
The modified gen p mean: 0.44866743683815, gen p mean: -0.12719736993312836, mean p set: 0.4492454528808594
loss_pred:0.016332536935806274, decouple_loss:0.0006421890575438738
loss_pred:0.01660846918821335, decouple_loss:0.0006888801581226289
The modified gen p mean: 0.44698628783226013, gen p mean: -0.12886187434196472, mean p set: 0.4475610554218292
loss_pred:0.016249937936663628, decouple_loss:0.0006957168225198984
2023-05-02 04:04:38 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13390669226646423, mean p set: 0.4502691626548767
loss_pred:0.01780654303729534, decouple_loss:0.0006760379183106124
The modified gen p mean: 0.44953879714012146, gen p mean: -0.12906290590763092, mean p set: 0.4500633478164673
loss_pred:0.017016001045703888, decouple_loss:0.0006877331179566681
The modified gen p mean: 0.449828565120697, gen p mean: -0.1288277804851532, mean p set: 0.45035696029663086
loss_pred:0.017276449128985405, decouple_loss:0.0007692290819250047
WV_1_PC_1_EH_0_PS_40, loss: 0.017401881515979767, avg_mse: 0.027278373017907143
current test mse: 0.027278
Iteration: 321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468119740486145, gen p mean: -0.12912815809249878, mean p set: 0.44739121198654175
loss_pred:0.016618818044662476, decouple_loss:0.000606419809628278
The modified gen p mean: 0.4494408965110779, gen p mean: -0.12622793018817902, mean p set: 0.45001867413520813The modified gen p mean: 0.44742342829704285, gen p mean: -0.1327798217535019, mean p set: 0.4479977488517761
loss_pred:0.016389453783631325, decouple_loss:0.0006110086105763912loss_pred:0.0170136746019125, decouple_loss:0.0005315947928465903
Iteration: 322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456598162651062, gen p mean: -0.1354483664035797, mean p set: 0.4462357461452484
loss_pred:0.017070667818188667, decouple_loss:0.0006989944376982749
The modified gen p mean: 0.4465078115463257, gen p mean: -0.1307658553123474, mean p set: 0.44708189368247986The modified gen p mean: 0.4463663697242737, gen p mean: -0.1348353773355484, mean p set: 0.446946382522583
loss_pred:0.01723111979663372, decouple_loss:0.0007903382065705955loss_pred:0.017147716134786606, decouple_loss:0.0007690875791013241
Iteration: 323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461004137992859, gen p mean: -0.1290835291147232, mean p set: 0.446674108505249
The modified gen p mean: 0.4456315338611603, gen p mean: -0.13172917068004608, mean p set: 0.44620731472969055
loss_pred:0.016365831717848778, decouple_loss:0.0005882550030946732
loss_pred:0.017481282353401184, decouple_loss:0.0005408736178651452
The modified gen p mean: 0.446453332901001, gen p mean: -0.13331547379493713, mean p set: 0.44702741503715515
loss_pred:0.016173068434000015, decouple_loss:0.0005420678644441068
Iteration: 324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686049222946167, gen p mean: -0.12466854602098465, mean p set: 0.44743549823760986
loss_pred:0.016919156536459923, decouple_loss:0.0006136252195574343
The modified gen p mean: 0.44577786326408386, gen p mean: -0.12788252532482147, mean p set: 0.44635435938835144
loss_pred:0.015600336715579033, decouple_loss:0.000631575530860573
The modified gen p mean: 0.445538729429245, gen p mean: -0.12615938484668732, mean p set: 0.44611674547195435
loss_pred:0.016644733026623726, decouple_loss:0.0006572044221684337
Iteration: 325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44551315903663635, gen p mean: -0.1268327832221985, mean p set: 0.44608867168426514
loss_pred:0.016819637268781662, decouple_loss:0.0007204466965049505
The modified gen p mean: 0.44684898853302, gen p mean: -0.12988145649433136, mean p set: 0.4474274814128876
loss_pred:0.015797056257724762, decouple_loss:0.0008082808926701546
The modified gen p mean: 0.4459713399410248, gen p mean: -0.12288755923509598, mean p set: 0.44654545187950134
loss_pred:0.01674845814704895, decouple_loss:0.0006666143890470266
Iteration: 326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44621050357818604, gen p mean: -0.13593530654907227, mean p set: 0.44678524136543274
loss_pred:0.01629495993256569, decouple_loss:0.0005968219484202564
The modified gen p mean: 0.44621968269348145, gen p mean: -0.12545381486415863, mean p set: 0.44679397344589233
The modified gen p mean: 0.4471127390861511, gen p mean: -0.1254298835992813, mean p set: 0.4476877748966217
loss_pred:0.01687176525592804, decouple_loss:0.0005998385022394359
loss_pred:0.01653011329472065, decouple_loss:0.0005251389229670167
Iteration: 327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669365882873535, gen p mean: -0.13304288685321808, mean p set: 0.44727015495300293
loss_pred:0.016585160046815872, decouple_loss:0.0006380972918123007
The modified gen p mean: 0.44612425565719604, gen p mean: -0.1305207908153534, mean p set: 0.4466998875141144
loss_pred:0.01618148572742939, decouple_loss:0.00065772351808846
The modified gen p mean: 0.4466363191604614, gen p mean: -0.13762472569942474, mean p set: 0.4472094774246216
loss_pred:0.015526301227509975, decouple_loss:0.0006235563196241856
Iteration: 328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446069598197937, gen p mean: -0.13621383905410767, mean p set: 0.446643590927124
loss_pred:0.01646147295832634, decouple_loss:0.0005829918081872165
The modified gen p mean: 0.4468544125556946, gen p mean: -0.13169658184051514, mean p set: 0.44742733240127563
The modified gen p mean: 0.44755855202674866, gen p mean: -0.13505767285823822, mean p set: 0.4481349289417267
loss_pred:0.016433799639344215, decouple_loss:0.0007556668715551496
loss_pred:0.016746636480093002, decouple_loss:0.0006500086165033281
Iteration: 329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468064308166504, gen p mean: -0.1353350579738617, mean p set: 0.44738173484802246
loss_pred:0.016973629593849182, decouple_loss:0.0006078020087443292
The modified gen p mean: 0.4465395212173462, gen p mean: -0.13456763327121735, mean p set: 0.44711199402809143
The modified gen p mean: 0.4472511410713196, gen p mean: -0.1324382871389389, mean p set: 0.4478275179862976
loss_pred:0.016817955300211906, decouple_loss:0.0005631846725009382
loss_pred:0.0158994197845459, decouple_loss:0.0005547660985030234
Iteration: 330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489668905735016, gen p mean: -0.1308000683784485, mean p set: 0.44954198598861694
loss_pred:0.01637047901749611, decouple_loss:0.0007960060611367226
The modified gen p mean: 0.4456247389316559, gen p mean: -0.13122771680355072, mean p set: 0.44620129466056824
loss_pred:0.01607329398393631, decouple_loss:0.0006972625851631165
The modified gen p mean: 0.4462800621986389, gen p mean: -0.12933789193630219, mean p set: 0.4468569755554199
loss_pred:0.01636924035847187, decouple_loss:0.000753482396248728
2023-05-02 04:06:43 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13373836874961853, mean p set: 0.4502691626548767
loss_pred:0.01731511950492859, decouple_loss:0.0006083276821300387
The modified gen p mean: 0.4495375454425812, gen p mean: -0.1272004097700119, mean p set: 0.4500633478164673
loss_pred:0.016672275960445404, decouple_loss:0.0005649718805216253
The modified gen p mean: 0.4498288333415985, gen p mean: -0.1272437870502472, mean p set: 0.45035696029663086
loss_pred:0.01690291427075863, decouple_loss:0.0006370987975969911
WV_1_PC_1_EH_0_PS_40, loss: 0.016993612051010132, avg_mse: 0.026410002261400223
current test mse: 0.02641
Iteration: 331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671761989593506, gen p mean: -0.12676098942756653, mean p set: 0.44729360938072205
loss_pred:0.016286445781588554, decouple_loss:0.0006624028319492936
The modified gen p mean: 0.4456102252006531, gen p mean: -0.12815794348716736, mean p set: 0.4461832046508789The modified gen p mean: 0.4477993845939636, gen p mean: -0.1307467818260193, mean p set: 0.4483734667301178
loss_pred:0.01656806468963623, decouple_loss:0.000609635200817138
loss_pred:0.015907607972621918, decouple_loss:0.0006547271623276174
Iteration: 332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770145416259766, gen p mean: -0.13070207834243774, mean p set: 0.4482783079147339
loss_pred:0.015880074352025986, decouple_loss:0.0006804893491789699
The modified gen p mean: 0.4475749433040619, gen p mean: -0.13397112488746643, mean p set: 0.44815075397491455The modified gen p mean: 0.4466126561164856, gen p mean: -0.13060849905014038, mean p set: 0.4471885859966278
loss_pred:0.015916164964437485, decouple_loss:0.000575885409489274loss_pred:0.016058217734098434, decouple_loss:0.0005283431382849813
Iteration: 333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44709694385528564, gen p mean: -0.12463025748729706, mean p set: 0.447676420211792
loss_pred:0.016346938908100128, decouple_loss:0.0006857592379674315
The modified gen p mean: 0.44599127769470215, gen p mean: -0.12230838090181351, mean p set: 0.446562796831131
loss_pred:0.016042634844779968, decouple_loss:0.0005822364473715425
The modified gen p mean: 0.4487335979938507, gen p mean: -0.12392275780439377, mean p set: 0.4493103623390198
loss_pred:0.01578987017273903, decouple_loss:0.000657878175843507
Iteration: 334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958120584487915, gen p mean: -0.12315159291028976, mean p set: 0.4501565396785736
loss_pred:0.015741705894470215, decouple_loss:0.0005483231507241726
The modified gen p mean: 0.44570422172546387, gen p mean: -0.1279611587524414, mean p set: 0.44628050923347473
loss_pred:0.016050605103373528, decouple_loss:0.0006557668675668538
The modified gen p mean: 0.44711625576019287, gen p mean: -0.1273132562637329, mean p set: 0.44769448041915894
loss_pred:0.015778129920363426, decouple_loss:0.0005691259284503758
Iteration: 335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677555561065674, gen p mean: -0.12684011459350586, mean p set: 0.44735464453697205
loss_pred:0.015643330290913582, decouple_loss:0.0005272793350741267
The modified gen p mean: 0.445765882730484, gen p mean: -0.12564992904663086, mean p set: 0.44634005427360535
loss_pred:0.016403015702962875, decouple_loss:0.0006177781033329666
The modified gen p mean: 0.448673278093338, gen p mean: -0.12420840561389923, mean p set: 0.44925111532211304
loss_pred:0.015644047409296036, decouple_loss:0.0005725576193071902
Iteration: 336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44649410247802734, gen p mean: -0.12229516357183456, mean p set: 0.4470725357532501
loss_pred:0.01656530797481537, decouple_loss:0.0006714260089211166
The modified gen p mean: 0.44820019602775574, gen p mean: -0.12748321890830994, mean p set: 0.448774129152298
The modified gen p mean: 0.447710782289505, gen p mean: -0.12891550362110138, mean p set: 0.4482870399951935
loss_pred:0.016208307817578316, decouple_loss:0.0006351955235004425
loss_pred:0.01610075682401657, decouple_loss:0.0008830453152768314
Iteration: 337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464017152786255, gen p mean: -0.12414988875389099, mean p set: 0.44697561860084534
loss_pred:0.015945589169859886, decouple_loss:0.0005061874981038272
The modified gen p mean: 0.4462662935256958, gen p mean: -0.12561652064323425, mean p set: 0.4468423128128052
The modified gen p mean: 0.4470249116420746, gen p mean: -0.12747406959533691, mean p set: 0.44760003685951233
loss_pred:0.016352862119674683, decouple_loss:0.0006041962769813836
loss_pred:0.01618839241564274, decouple_loss:0.00048649910604581237
Iteration: 338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483913481235504, gen p mean: -0.12776631116867065, mean p set: 0.44896358251571655
loss_pred:0.015748711302876472, decouple_loss:0.0006587582174688578
The modified gen p mean: 0.4458434581756592, gen p mean: -0.12904046475887299, mean p set: 0.4464176893234253
loss_pred:0.015594650991261005, decouple_loss:0.0007470049895346165
The modified gen p mean: 0.4459455907344818, gen p mean: -0.1270587146282196, mean p set: 0.44652286171913147
loss_pred:0.01589297503232956, decouple_loss:0.0010398331796750426
Iteration: 339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485185444355011, gen p mean: -0.13237212598323822, mean p set: 0.44909629225730896
loss_pred:0.0162728913128376, decouple_loss:0.0008690293761901557
The modified gen p mean: 0.44712480902671814, gen p mean: -0.12984268367290497, mean p set: 0.4476989805698395
loss_pred:0.015762263908982277, decouple_loss:0.0007729684584774077
The modified gen p mean: 0.4462190270423889, gen p mean: -0.12846750020980835, mean p set: 0.44679519534111023
loss_pred:0.015695763751864433, decouple_loss:0.000652562826871872
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
NaN value num: 0
Iteration: 340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781923294067383, gen p mean: -0.12743446230888367, mean p set: 0.44839444756507874
The modified gen p mean: 0.44717127084732056, gen p mean: -0.128580242395401, mean p set: 0.44774648547172546loss_pred:0.015514882281422615, decouple_loss:0.0006669313297607005
loss_pred:0.015433820895850658, decouple_loss:0.000838282227050513
The modified gen p mean: 0.4502420127391815, gen p mean: -0.11874464154243469, mean p set: 0.45081809163093567
loss_pred:0.01610255427658558, decouple_loss:0.000714701134711504
2023-05-02 04:09:22 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1350027620792389, mean p set: 0.4502691626548767
loss_pred:0.017168676480650902, decouple_loss:0.000586635316722095
The modified gen p mean: 0.44953271746635437, gen p mean: -0.12790066003799438, mean p set: 0.4500633478164673
loss_pred:0.016489071771502495, decouple_loss:0.0007458776235580444
The modified gen p mean: 0.44982773065567017, gen p mean: -0.12793131172657013, mean p set: 0.45035696029663086
loss_pred:0.016716821119189262, decouple_loss:0.000666811887640506
WV_1_PC_1_EH_0_PS_40, loss: 0.016824845224618912, avg_mse: 0.026232847943902016
current test mse: 0.026233
Iteration: 341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729068875312805, gen p mean: -0.11907962709665298, mean p set: 0.4478653073310852
loss_pred:0.016987012699246407, decouple_loss:0.0006096334545873106
The modified gen p mean: 0.4472438395023346, gen p mean: -0.12148652970790863, mean p set: 0.44782212376594543The modified gen p mean: 0.44979944825172424, gen p mean: -0.1220262199640274, mean p set: 0.4503746032714844
loss_pred:0.01600164733827114, decouple_loss:0.0007482430664822459loss_pred:0.016096267849206924, decouple_loss:0.0004936264595016837
Iteration: 342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483860731124878, gen p mean: -0.11098674684762955, mean p set: 0.44896015524864197
loss_pred:0.01645667850971222, decouple_loss:0.0007396040600724518
The modified gen p mean: 0.4477415382862091, gen p mean: -0.11341682821512222, mean p set: 0.4483151137828827The modified gen p mean: 0.4502168893814087, gen p mean: -0.11511296778917313, mean p set: 0.4507937431335449
loss_pred:0.016077736392617226, decouple_loss:0.000683508871588856
loss_pred:0.015433084219694138, decouple_loss:0.0006940579623915255
Iteration: 343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824346899986267, gen p mean: -0.11204499751329422, mean p set: 0.44881829619407654
loss_pred:0.016191476956009865, decouple_loss:0.0007830892573110759
The modified gen p mean: 0.44955945014953613, gen p mean: -0.11127660423517227, mean p set: 0.45013487339019775The modified gen p mean: 0.4488653540611267, gen p mean: -0.11966414749622345, mean p set: 0.449439138174057
loss_pred:0.01586761139333248, decouple_loss:0.0005878164665773511
loss_pred:0.016287781298160553, decouple_loss:0.0007500197389163077
Iteration: 344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768643379211426, gen p mean: -0.10558447241783142, mean p set: 0.44826221466064453
loss_pred:0.016443809494376183, decouple_loss:0.0007004279759712517
The modified gen p mean: 0.45019134879112244, gen p mean: -0.10190033912658691, mean p set: 0.4507671892642975
loss_pred:0.016290955245494843, decouple_loss:0.0007061707437969744
The modified gen p mean: 0.4503074288368225, gen p mean: -0.10622528195381165, mean p set: 0.45088252425193787
loss_pred:0.015580889768898487, decouple_loss:0.0006332487100735307
Iteration: 345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890934228897095, gen p mean: -0.10431361198425293, mean p set: 0.44948336482048035
loss_pred:0.01664416678249836, decouple_loss:0.0006041630986146629
The modified gen p mean: 0.44802436232566833, gen p mean: -0.09895473718643188, mean p set: 0.4485982656478882
loss_pred:0.016737135127186775, decouple_loss:0.000735822191927582
The modified gen p mean: 0.4483281075954437, gen p mean: -0.10080621391534805, mean p set: 0.4489021897315979
loss_pred:0.01666530966758728, decouple_loss:0.0007536296034231782
Iteration: 346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738468527793884, gen p mean: -0.1079387292265892, mean p set: 0.4479601979255676
loss_pred:0.015036188066005707, decouple_loss:0.0008375002653338015
The modified gen p mean: 0.4474286139011383, gen p mean: -0.10060499608516693, mean p set: 0.44800323247909546
loss_pred:0.015832018107175827, decouple_loss:0.0008637622813694179
The modified gen p mean: 0.4484975039958954, gen p mean: -0.10008411854505539, mean p set: 0.44907310605049133
loss_pred:0.016142889857292175, decouple_loss:0.0007537869387306273
Iteration: 347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480847120285034, gen p mean: -0.10604473203420639, mean p set: 0.4486616849899292
loss_pred:0.01649455726146698, decouple_loss:0.0007265484309755266
The modified gen p mean: 0.4480806887149811, gen p mean: -0.10671848803758621, mean p set: 0.44865772128105164
loss_pred:0.01644805818796158, decouple_loss:0.0006916681304574013
The modified gen p mean: 0.4476938247680664, gen p mean: -0.11272527277469635, mean p set: 0.4482679069042206
loss_pred:0.0156650859862566, decouple_loss:0.0007212918135337532
Iteration: 348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829073548316956, gen p mean: -0.11292514204978943, mean p set: 0.4488682746887207
loss_pred:0.01564224623143673, decouple_loss:0.0006766231963410974
The modified gen p mean: 0.448089063167572, gen p mean: -0.1140626072883606, mean p set: 0.44866451621055603
loss_pred:0.015285374596714973, decouple_loss:0.000756993074901402
The modified gen p mean: 0.4495924711227417, gen p mean: -0.10666973888874054, mean p set: 0.45016783475875854
loss_pred:0.01523164939135313, decouple_loss:0.0005284792277961969
Iteration: 349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018404722213745, gen p mean: -0.1097031757235527, mean p set: 0.4507611393928528
loss_pred:0.016337934881448746, decouple_loss:0.0010005439398810267
The modified gen p mean: 0.4506550431251526, gen p mean: -0.11741839349269867, mean p set: 0.4512310028076172
The modified gen p mean: 0.44705134630203247, gen p mean: -0.12172074615955353, mean p set: 0.4476262331008911
loss_pred:0.015058781020343304, decouple_loss:0.0006179290940053761
loss_pred:0.015098459087312222, decouple_loss:0.0008979252306744456
Iteration: 350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476439952850342, gen p mean: -0.11102110147476196, mean p set: 0.44822174310684204
loss_pred:0.01680777408182621, decouple_loss:0.0007446319214068353
The modified gen p mean: 0.44734683632850647, gen p mean: -0.11703171581029892, mean p set: 0.4479213356971741
loss_pred:0.015281910076737404, decouple_loss:0.0005510103655979037
The modified gen p mean: 0.4484998285770416, gen p mean: -0.12092552334070206, mean p set: 0.4490744471549988
loss_pred:0.01622094213962555, decouple_loss:0.0007328566280193627
2023-05-02 04:11:27 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.1272030919790268, mean p set: 0.4502691626548767
loss_pred:0.017170462757349014, decouple_loss:0.0006111645488999784
The modified gen p mean: 0.44953668117523193, gen p mean: -0.12137489765882492, mean p set: 0.4500633478164673
loss_pred:0.016553804278373718, decouple_loss:0.0007432071142829955
The modified gen p mean: 0.44982972741127014, gen p mean: -0.12077366560697556, mean p set: 0.45035696029663086
loss_pred:0.016883760690689087, decouple_loss:0.0005761183565482497
WV_1_PC_1_EH_0_PS_40, loss: 0.016901517286896706, avg_mse: 0.026272112503647804
current test mse: 0.026272
Iteration: 351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44932517409324646, gen p mean: -0.11643032729625702, mean p set: 0.44990259408950806
loss_pred:0.015473899431526661, decouple_loss:0.0005668719531968236
The modified gen p mean: 0.44841280579566956, gen p mean: -0.12121996283531189, mean p set: 0.44899022579193115The modified gen p mean: 0.4501441419124603, gen p mean: -0.10898291319608688, mean p set: 0.45071908831596375
loss_pred:0.016241518780589104, decouple_loss:0.0005269916146062315
loss_pred:0.016317101195454597, decouple_loss:0.0006467106286436319
Iteration: 352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504522681236267, gen p mean: -0.11417888849973679, mean p set: 0.4510261118412018
loss_pred:0.015374461188912392, decouple_loss:0.0007202987908385694
The modified gen p mean: 0.4497442841529846, gen p mean: -0.11295454204082489, mean p set: 0.4503222107887268The modified gen p mean: 0.44902706146240234, gen p mean: -0.11440277099609375, mean p set: 0.4496016502380371
loss_pred:0.016328437253832817, decouple_loss:0.0006765834987163544loss_pred:0.01559575367718935, decouple_loss:0.0007648302125744522
Iteration: 353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852012395858765, gen p mean: -0.11735805124044418, mean p set: 0.4490925371646881
loss_pred:0.01723736710846424, decouple_loss:0.0006723185069859028
The modified gen p mean: 0.45007991790771484, gen p mean: -0.11174646764993668, mean p set: 0.4506576955318451
loss_pred:0.015740472823381424, decouple_loss:0.0008070115000009537
The modified gen p mean: 0.4500264525413513, gen p mean: -0.11564859747886658, mean p set: 0.45060229301452637
loss_pred:0.015286045148968697, decouple_loss:0.0007338534924201667
Iteration: 354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774121046066284, gen p mean: -0.11317062377929688, mean p set: 0.4483179748058319
loss_pred:0.01603114977478981, decouple_loss:0.0005348940612748265
The modified gen p mean: 0.4497585594654083, gen p mean: -0.10667143017053604, mean p set: 0.45033523440361023
loss_pred:0.015797413885593414, decouple_loss:0.0007052200962789357
The modified gen p mean: 0.4499160945415497, gen p mean: -0.11442273110151291, mean p set: 0.45049184560775757
loss_pred:0.016143079847097397, decouple_loss:0.00042134689283557236
Iteration: 355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482998251914978, gen p mean: -0.11028492450714111, mean p set: 0.44887787103652954
loss_pred:0.016063861548900604, decouple_loss:0.0007943700766190886
The modified gen p mean: 0.447376549243927, gen p mean: -0.11019427329301834, mean p set: 0.447950154542923
loss_pred:0.015929600223898888, decouple_loss:0.0006478157010860741
The modified gen p mean: 0.4505753219127655, gen p mean: -0.11211231350898743, mean p set: 0.45115435123443604
loss_pred:0.015787458047270775, decouple_loss:0.0005614885594695807
Iteration: 356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44993114471435547, gen p mean: -0.10558447241783142, mean p set: 0.4505079984664917
loss_pred:0.015861008316278458, decouple_loss:0.0008783930097706616
The modified gen p mean: 0.4499760866165161, gen p mean: -0.10764220356941223, mean p set: 0.45055249333381653
loss_pred:0.015371239744126797, decouple_loss:0.0009349511237815022
The modified gen p mean: 0.45001181960105896, gen p mean: -0.11182883381843567, mean p set: 0.45058971643447876
loss_pred:0.015208073891699314, decouple_loss:0.0007133613689802587
Iteration: 357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500422179698944, gen p mean: -0.1070828065276146, mean p set: 0.4506188929080963
loss_pred:0.014860250055789948, decouple_loss:0.0008501356933265924
The modified gen p mean: 0.4499134123325348, gen p mean: -0.104560486972332, mean p set: 0.4504888951778412
loss_pred:0.015254512429237366, decouple_loss:0.0009596811723895371
The modified gen p mean: 0.4482947289943695, gen p mean: -0.10910690575838089, mean p set: 0.44886893033981323
loss_pred:0.016800783574581146, decouple_loss:0.0011376595357432961
Iteration: 358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44967150688171387, gen p mean: -0.10564260929822922, mean p set: 0.4502470791339874
loss_pred:0.016076307743787766, decouple_loss:0.0005986001342535019
The modified gen p mean: 0.44960445165634155, gen p mean: -0.10075249522924423, mean p set: 0.4501826763153076
loss_pred:0.01490119006484747, decouple_loss:0.0007530142902396619
The modified gen p mean: 0.4497872591018677, gen p mean: -0.10305111855268478, mean p set: 0.4503651261329651
loss_pred:0.015652116388082504, decouple_loss:0.0007416233420372009
Iteration: 359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731366634368896, gen p mean: -0.10505730658769608, mean p set: 0.44788995385169983
loss_pred:0.015626057982444763, decouple_loss:0.0006170740816742182
The modified gen p mean: 0.45053520798683167, gen p mean: -0.09271720051765442, mean p set: 0.45111238956451416
loss_pred:0.016610227525234222, decouple_loss:0.0007066979305818677
The modified gen p mean: 0.45052358508110046, gen p mean: -0.09338157624006271, mean p set: 0.4511011838912964
loss_pred:0.015958700329065323, decouple_loss:0.0006007432821206748
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
NaN value num: 0
Iteration: 360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44902828335762024, gen p mean: -0.10725479573011398, mean p set: 0.4496051073074341
loss_pred:0.016202757135033607, decouple_loss:0.0008117043762467802
The modified gen p mean: 0.44806647300720215, gen p mean: -0.10590607672929764, mean p set: 0.448641300201416
The modified gen p mean: 0.4478490352630615, gen p mean: -0.10507321357727051, mean p set: 0.44842690229415894
loss_pred:0.016307735815644264, decouple_loss:0.0010641500120982528
loss_pred:0.01592862419784069, decouple_loss:0.0007346050115302205
2023-05-02 04:14:08 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10903936624526978, mean p set: 0.4502691626548767
loss_pred:0.017128655686974525, decouple_loss:0.0008428892469964921
The modified gen p mean: 0.4495340585708618, gen p mean: -0.10336904227733612, mean p set: 0.4500633478164673
loss_pred:0.01633393205702305, decouple_loss:0.0007740099099464715
The modified gen p mean: 0.4498293399810791, gen p mean: -0.10280057042837143, mean p set: 0.45035696029663086
loss_pred:0.016634231433272362, decouple_loss:0.00068038294557482
WV_1_PC_1_EH_0_PS_40, loss: 0.016737228259444237, avg_mse: 0.026096951216459274
current test mse: 0.026097
Iteration: 361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827961921691895, gen p mean: -0.10194762796163559, mean p set: 0.4488562047481537
loss_pred:0.016903821378946304, decouple_loss:0.0008609732030890882
The modified gen p mean: 0.4496428966522217, gen p mean: -0.10743540525436401, mean p set: 0.4502195119857788
loss_pred:0.015306966379284859, decouple_loss:0.0007771217497065663
The modified gen p mean: 0.44835296273231506, gen p mean: -0.10622906684875488, mean p set: 0.44892963767051697
loss_pred:0.016850804910063744, decouple_loss:0.0008728927932679653
Iteration: 362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479313790798187, gen p mean: -0.1052665039896965, mean p set: 0.4485076069831848
loss_pred:0.016642054542899132, decouple_loss:0.0006667418056167662
The modified gen p mean: 0.44852250814437866, gen p mean: -0.10285069048404694, mean p set: 0.44909751415252686The modified gen p mean: 0.4477371573448181, gen p mean: -0.10608865320682526, mean p set: 0.44831374287605286
loss_pred:0.01710587553679943, decouple_loss:0.0004571842437144369loss_pred:0.015947703272104263, decouple_loss:0.0005606272607110441
Iteration: 363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487108588218689, gen p mean: -0.11455979943275452, mean p set: 0.4492875933647156
loss_pred:0.016515735536813736, decouple_loss:0.0006703244871459901
The modified gen p mean: 0.44864124059677124, gen p mean: -0.11112869530916214, mean p set: 0.4492185115814209
loss_pred:0.016242045909166336, decouple_loss:0.0007459407788701355
The modified gen p mean: 0.4498315751552582, gen p mean: -0.11056073755025864, mean p set: 0.4504074156284332
loss_pred:0.01604207046329975, decouple_loss:0.0006779731484130025
Iteration: 364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484958052635193, gen p mean: -0.1096402183175087, mean p set: 0.4490722715854645
loss_pred:0.016488486900925636, decouple_loss:0.0008270364487543702
The modified gen p mean: 0.4479629695415497, gen p mean: -0.1097520962357521, mean p set: 0.44853708148002625
loss_pred:0.016576161608099937, decouple_loss:0.0008074013167060912
The modified gen p mean: 0.44770359992980957, gen p mean: -0.10885462164878845, mean p set: 0.4482775628566742
loss_pred:0.016157660633325577, decouple_loss:0.0009681672672741115
Iteration: 365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765573740005493, gen p mean: -0.11332967132329941, mean p set: 0.4482342600822449
The modified gen p mean: 0.4493017792701721, gen p mean: -0.111676424741745, mean p set: 0.4498783349990845
loss_pred:0.015866301953792572, decouple_loss:0.0005754312733188272
loss_pred:0.015460790134966373, decouple_loss:0.0005602698656730354
The modified gen p mean: 0.4485170245170593, gen p mean: -0.1198381558060646, mean p set: 0.4490949809551239
loss_pred:0.015952646732330322, decouple_loss:0.0006673294701613486
Iteration: 366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791552424430847, gen p mean: -0.11666643619537354, mean p set: 0.44849133491516113
The modified gen p mean: 0.4475821852684021, gen p mean: -0.11650998890399933, mean p set: 0.44815659523010254
loss_pred:0.01620340906083584, decouple_loss:0.0009467176860198379
loss_pred:0.01659451052546501, decouple_loss:0.0006032497622072697
The modified gen p mean: 0.44811227917671204, gen p mean: -0.11519613116979599, mean p set: 0.4486878216266632
loss_pred:0.016114234924316406, decouple_loss:0.0007463902584277093
Iteration: 367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475170075893402, gen p mean: -0.11723855137825012, mean p set: 0.4480896592140198
The modified gen p mean: 0.4474899172782898, gen p mean: -0.11871714890003204, mean p set: 0.44806647300720215
loss_pred:0.016622351482510567, decouple_loss:0.0005947794415988028
loss_pred:0.015514988452196121, decouple_loss:0.0005696845473721623
The modified gen p mean: 0.44744792580604553, gen p mean: -0.11547429859638214, mean p set: 0.44802385568618774
loss_pred:0.016517968848347664, decouple_loss:0.0005323941586539149
Iteration: 368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481540024280548, gen p mean: -0.12180518358945847, mean p set: 0.4487301707267761
The modified gen p mean: 0.4482977092266083, gen p mean: -0.11714979261159897, mean p set: 0.4488738775253296
loss_pred:0.016470588743686676, decouple_loss:0.0006276759086176753
loss_pred:0.015157467685639858, decouple_loss:0.0005372503073886037
The modified gen p mean: 0.44779565930366516, gen p mean: -0.11591155081987381, mean p set: 0.4483693838119507
loss_pred:0.01595083624124527, decouple_loss:0.0005529023474082351
Iteration: 369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493360221385956, gen p mean: -0.12274488806724548, mean p set: 0.4499121904373169
loss_pred:0.01564386859536171, decouple_loss:0.0006086956709623337
The modified gen p mean: 0.44825881719589233, gen p mean: -0.1236099824309349, mean p set: 0.44883406162261963
The modified gen p mean: 0.45001399517059326, gen p mean: -0.1257544606924057, mean p set: 0.4505901634693146
loss_pred:0.016196677461266518, decouple_loss:0.0005255069700069726
loss_pred:0.015199516899883747, decouple_loss:0.0008234460838139057
Iteration: 370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810885190963745, gen p mean: -0.12461407482624054, mean p set: 0.44868478178977966
The modified gen p mean: 0.44841256737709045, gen p mean: -0.12595362961292267, mean p set: 0.4489891827106476
loss_pred:0.01611461490392685, decouple_loss:0.0005612702225334942
loss_pred:0.01638783887028694, decouple_loss:0.000549878051970154
The modified gen p mean: 0.447943776845932, gen p mean: -0.12205800414085388, mean p set: 0.44851937890052795
loss_pred:0.01666596345603466, decouple_loss:0.0005263540078885853
2023-05-02 04:16:13 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13436554372310638, mean p set: 0.4502691626548767
loss_pred:0.017041947692632675, decouple_loss:0.0005919454270042479
The modified gen p mean: 0.44953474402427673, gen p mean: -0.12892389297485352, mean p set: 0.4500633478164673
loss_pred:0.01624566875398159, decouple_loss:0.0005795432953163981
The modified gen p mean: 0.44982975721359253, gen p mean: -0.12814436852931976, mean p set: 0.45035696029663086
loss_pred:0.016591262072324753, decouple_loss:0.0005327809485606849
WV_1_PC_1_EH_0_PS_40, loss: 0.01665469817817211, avg_mse: 0.0260317400097847
current test mse: 0.026032
Iteration: 371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494142532348633, gen p mean: -0.1308126598596573, mean p set: 0.4499904215335846
loss_pred:0.015233051963150501, decouple_loss:0.0005610581138171256
The modified gen p mean: 0.44782137870788574, gen p mean: -0.125008687376976, mean p set: 0.44839733839035034
loss_pred:0.0164791289716959, decouple_loss:0.0005478216917254031
The modified gen p mean: 0.44821104407310486, gen p mean: -0.13009195029735565, mean p set: 0.4487864673137665
loss_pred:0.015856487676501274, decouple_loss:0.0005124522722326219
Iteration: 372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478166103363037, gen p mean: -0.13236261904239655, mean p set: 0.44839203357696533
The modified gen p mean: 0.44897282123565674, gen p mean: -0.13306118547916412, mean p set: 0.4495508372783661
loss_pred:0.01565708965063095, decouple_loss:0.0006063671316951513
loss_pred:0.015878718346357346, decouple_loss:0.0005863526021130383
The modified gen p mean: 0.4487430453300476, gen p mean: -0.1278276890516281, mean p set: 0.44931817054748535
loss_pred:0.016152357682585716, decouple_loss:0.0006714873015880585
Iteration: 373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467874765396118, gen p mean: -0.12827801704406738, mean p set: 0.44736447930336
loss_pred:0.016488172113895416, decouple_loss:0.0004767520586028695
The modified gen p mean: 0.447663277387619, gen p mean: -0.13139519095420837, mean p set: 0.448240727186203The modified gen p mean: 0.44793227314949036, gen p mean: -0.1323464959859848, mean p set: 0.44850850105285645
loss_pred:0.015447493642568588, decouple_loss:0.000607750378549099
loss_pred:0.016695618629455566, decouple_loss:0.0005448083975352347
Iteration: 374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796356558799744, gen p mean: -0.12876121699810028, mean p set: 0.4485383629798889
loss_pred:0.015882274135947227, decouple_loss:0.0004731047956738621
The modified gen p mean: 0.447726845741272, gen p mean: -0.1307201385498047, mean p set: 0.44830331206321716
loss_pred:0.016486886888742447, decouple_loss:0.0005123760784044862
The modified gen p mean: 0.44783705472946167, gen p mean: -0.13231141865253448, mean p set: 0.44840967655181885
loss_pred:0.015484909527003765, decouple_loss:0.0006523062475025654
Iteration: 375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479229152202606, gen p mean: -0.12788544595241547, mean p set: 0.44850072264671326
loss_pred:0.01643257401883602, decouple_loss:0.0004403083003126085
The modified gen p mean: 0.4493998885154724, gen p mean: -0.13049723207950592, mean p set: 0.4499753415584564
loss_pred:0.015882007777690887, decouple_loss:0.0005141688161529601
The modified gen p mean: 0.44808298349380493, gen p mean: -0.12481570243835449, mean p set: 0.4486587643623352
loss_pred:0.016091106459498405, decouple_loss:0.0005023983540013433
Iteration: 376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776231050491333, gen p mean: -0.12290500849485397, mean p set: 0.44834303855895996
loss_pred:0.015789726749062538, decouple_loss:0.0004559381050057709
The modified gen p mean: 0.44926387071609497, gen p mean: -0.1267431676387787, mean p set: 0.44984182715415955
The modified gen p mean: 0.4479576349258423, gen p mean: -0.12049882858991623, mean p set: 0.4485318660736084
loss_pred:0.015396228060126305, decouple_loss:0.000653792405501008
loss_pred:0.01571042835712433, decouple_loss:0.0005789504502899945
Iteration: 377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495207965373993, gen p mean: -0.12090754508972168, mean p set: 0.4500986337661743
loss_pred:0.01546463556587696, decouple_loss:0.0005252790288068354
The modified gen p mean: 0.4481337070465088, gen p mean: -0.11875169724225998, mean p set: 0.44871172308921814
loss_pred:0.017087772488594055, decouple_loss:0.0004696533433161676
The modified gen p mean: 0.44725868105888367, gen p mean: -0.11534739285707474, mean p set: 0.4478336274623871
loss_pred:0.016957126557826996, decouple_loss:0.0005186870694160461
Iteration: 378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773954153060913, gen p mean: -0.12127534300088882, mean p set: 0.44831764698028564
loss_pred:0.015972482040524483, decouple_loss:0.0004991000168956816
The modified gen p mean: 0.44853752851486206, gen p mean: -0.12633703649044037, mean p set: 0.4491157829761505
loss_pred:0.015722813084721565, decouple_loss:0.0005100779235363007
The modified gen p mean: 0.449168860912323, gen p mean: -0.12314429134130478, mean p set: 0.44974657893180847
loss_pred:0.016469042748212814, decouple_loss:0.000551639765035361
Iteration: 379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466696083545685, gen p mean: -0.11667679250240326, mean p set: 0.4472479820251465
loss_pred:0.015826674178242683, decouple_loss:0.0004809277888853103
The modified gen p mean: 0.4470193684101105, gen p mean: -0.11814764142036438, mean p set: 0.44759565591812134
loss_pred:0.0156724713742733, decouple_loss:0.00046433095121756196
The modified gen p mean: 0.4472179710865021, gen p mean: -0.11851424723863602, mean p set: 0.44779375195503235
loss_pred:0.016260802745819092, decouple_loss:0.0006055406993255019
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487020671367645, gen p mean: -0.12700693309307098, mean p set: 0.44927704334259033
The modified gen p mean: 0.4469509422779083, gen p mean: -0.1261756420135498, mean p set: 0.44752782583236694
loss_pred:0.015403696335852146, decouple_loss:0.0005980686983093619
loss_pred:0.015757236629724503, decouple_loss:0.00047754874685779214
The modified gen p mean: 0.44716745615005493, gen p mean: -0.12749622762203217, mean p set: 0.4477439522743225
loss_pred:0.014911949634552002, decouple_loss:0.0005135302199050784
2023-05-02 04:18:59 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12872442603111267, mean p set: 0.4502691626548767
loss_pred:0.01699122227728367, decouple_loss:0.000540826644282788
The modified gen p mean: 0.4495335817337036, gen p mean: -0.12292753905057907, mean p set: 0.4500633478164673
loss_pred:0.01622718758881092, decouple_loss:0.0005819138023070991
The modified gen p mean: 0.44982877373695374, gen p mean: -0.12197031825780869, mean p set: 0.45035696029663086
loss_pred:0.016605015844106674, decouple_loss:0.0005156989791430533
WV_1_PC_1_EH_0_PS_40, loss: 0.016635116189718246, avg_mse: 0.026021519675850868
current test mse: 0.026022
Iteration: 381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478708505630493, gen p mean: -0.1284404695034027, mean p set: 0.4484470784664154
loss_pred:0.01547010987997055, decouple_loss:0.0005541426944546402
The modified gen p mean: 0.4462312161922455, gen p mean: -0.12465530633926392, mean p set: 0.44680535793304443
The modified gen p mean: 0.4473486542701721, gen p mean: -0.12633194029331207, mean p set: 0.4479255974292755
loss_pred:0.014972173608839512, decouple_loss:0.0005449979216791689
loss_pred:0.015659699216485023, decouple_loss:0.0005120558780618012
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466719329357147, gen p mean: -0.12098173797130585, mean p set: 0.447246253490448
loss_pred:0.014783510006964207, decouple_loss:0.000561326218303293
The modified gen p mean: 0.44725292921066284, gen p mean: -0.1269083321094513, mean p set: 0.4478280544281006The modified gen p mean: 0.44654470682144165, gen p mean: -0.1258888840675354, mean p set: 0.44712045788764954
loss_pred:0.015256735496222973, decouple_loss:0.0004879124171566218
loss_pred:0.015152604319155216, decouple_loss:0.00048733429866842926
Iteration: 383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471192955970764, gen p mean: -0.12474844604730606, mean p set: 0.4476941227912903
loss_pred:0.015338081866502762, decouple_loss:0.0005204568151384592
The modified gen p mean: 0.4463154375553131, gen p mean: -0.12570597231388092, mean p set: 0.44689324498176575
loss_pred:0.015736626461148262, decouple_loss:0.00049826770555228
The modified gen p mean: 0.44700732827186584, gen p mean: -0.12386499345302582, mean p set: 0.44758522510528564
loss_pred:0.01520045567303896, decouple_loss:0.0005051098996773362
Iteration: 384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480783939361572, gen p mean: -0.12799371778964996, mean p set: 0.44865259528160095
loss_pred:0.014940929599106312, decouple_loss:0.0006227267440408468
The modified gen p mean: 0.4455850422382355, gen p mean: -0.13249105215072632, mean p set: 0.4461599588394165
loss_pred:0.015580268576741219, decouple_loss:0.0005548221524804831
The modified gen p mean: 0.4463784694671631, gen p mean: -0.12342488020658493, mean p set: 0.44695523381233215
loss_pred:0.01493473257869482, decouple_loss:0.0005389935104176402
Iteration: 385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44652625918388367, gen p mean: -0.13039226830005646, mean p set: 0.4471011161804199
loss_pred:0.015627726912498474, decouple_loss:0.0005762669024989009
The modified gen p mean: 0.4455883204936981, gen p mean: -0.1318400651216507, mean p set: 0.4461652636528015
loss_pred:0.01522349938750267, decouple_loss:0.000507745542563498
The modified gen p mean: 0.4480786621570587, gen p mean: -0.12847831845283508, mean p set: 0.4486584961414337
loss_pred:0.015024236403405666, decouple_loss:0.0005665095522999763
Iteration: 386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682490825653076, gen p mean: -0.1250438243150711, mean p set: 0.4473998546600342
loss_pred:0.014818324707448483, decouple_loss:0.00047655068919993937
The modified gen p mean: 0.4479106068611145, gen p mean: -0.12670151889324188, mean p set: 0.448486864566803
The modified gen p mean: 0.44616687297821045, gen p mean: -0.12039519101381302, mean p set: 0.4467402696609497
loss_pred:0.015320517122745514, decouple_loss:0.0006239990470930934
loss_pred:0.01569526642560959, decouple_loss:0.0006392427603714168
Iteration: 387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459366798400879, gen p mean: -0.11767154932022095, mean p set: 0.44651132822036743
loss_pred:0.01582731120288372, decouple_loss:0.0005378996138460934
The modified gen p mean: 0.4461093246936798, gen p mean: -0.11995397508144379, mean p set: 0.44668781757354736
The modified gen p mean: 0.44678303599357605, gen p mean: -0.12148033827543259, mean p set: 0.4473566710948944
loss_pred:0.015733694657683372, decouple_loss:0.0004180875839665532
loss_pred:0.014795467257499695, decouple_loss:0.0004582204855978489
Iteration: 388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467255473136902, gen p mean: -0.12454362958669662, mean p set: 0.4473038911819458
loss_pred:0.014967807568609715, decouple_loss:0.0006029310170561075
The modified gen p mean: 0.44659650325775146, gen p mean: -0.12392689287662506, mean p set: 0.4471711814403534
loss_pred:0.015241561457514763, decouple_loss:0.0004186516744084656
The modified gen p mean: 0.44736310839653015, gen p mean: -0.12638838589191437, mean p set: 0.44794052839279175
loss_pred:0.014829924330115318, decouple_loss:0.000545695424079895
Iteration: 389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730144739151, gen p mean: -0.11608293652534485, mean p set: 0.44787678122520447
loss_pred:0.015358814038336277, decouple_loss:0.0005402392707765102
The modified gen p mean: 0.4481068253517151, gen p mean: -0.12401540577411652, mean p set: 0.44868341088294983
The modified gen p mean: 0.4482051730155945, gen p mean: -0.1256331354379654, mean p set: 0.4487825632095337
loss_pred:0.015125786885619164, decouple_loss:0.00084255839465186
loss_pred:0.015161833725869656, decouple_loss:0.0007840906619094312
Iteration: 390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44637531042099, gen p mean: -0.12634721398353577, mean p set: 0.44694921374320984
loss_pred:0.015123949386179447, decouple_loss:0.0006742578698322177
The modified gen p mean: 0.4487617015838623, gen p mean: -0.12933705747127533, mean p set: 0.44933852553367615
The modified gen p mean: 0.44667932391166687, gen p mean: -0.12683981657028198, mean p set: 0.44725558161735535
loss_pred:0.015373921021819115, decouple_loss:0.0005838737706653774
loss_pred:0.015155033208429813, decouple_loss:0.0006186352693475783
2023-05-02 04:21:04 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13155126571655273, mean p set: 0.4502691626548767
loss_pred:0.016961466521024704, decouple_loss:0.0005421717069111764
The modified gen p mean: 0.44953569769859314, gen p mean: -0.12545286118984222, mean p set: 0.4500633478164673
loss_pred:0.016310060396790504, decouple_loss:0.0005418198416009545
The modified gen p mean: 0.4498313069343567, gen p mean: -0.1248684674501419, mean p set: 0.45035696029663086
loss_pred:0.016673322767019272, decouple_loss:0.0006730831228196621
WV_1_PC_1_EH_0_PS_40, loss: 0.01667756959795952, avg_mse: 0.026051068678498268
current test mse: 0.026051
Iteration: 391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447418749332428, gen p mean: -0.13331615924835205, mean p set: 0.44799599051475525
loss_pred:0.014363152906298637, decouple_loss:0.0005790122086182237
The modified gen p mean: 0.4462079107761383, gen p mean: -0.1285344809293747, mean p set: 0.4467838406562805
loss_pred:0.014690542593598366, decouple_loss:0.0007008602260611951
The modified gen p mean: 0.4473736882209778, gen p mean: -0.1296418309211731, mean p set: 0.447951078414917
loss_pred:0.014658900909125805, decouple_loss:0.0006075950805097818
Iteration: 392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451916813850403, gen p mean: -0.1327524334192276, mean p set: 0.4457697868347168
loss_pred:0.015126679092645645, decouple_loss:0.0005316288443282247
The modified gen p mean: 0.4467907249927521, gen p mean: -0.13087984919548035, mean p set: 0.4473665952682495The modified gen p mean: 0.4461747705936432, gen p mean: -0.12777495384216309, mean p set: 0.44675159454345703
loss_pred:0.01520406175404787, decouple_loss:0.0005030098254792392
loss_pred:0.015069015324115753, decouple_loss:0.00044394363067112863
Iteration: 393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451613128185272, gen p mean: -0.13069218397140503, mean p set: 0.44573795795440674
loss_pred:0.014816990122199059, decouple_loss:0.0006170733249746263
The modified gen p mean: 0.44750306010246277, gen p mean: -0.12752090394496918, mean p set: 0.44808098673820496
loss_pred:0.015294612385332584, decouple_loss:0.000439658499090001
The modified gen p mean: 0.44661566615104675, gen p mean: -0.1254444420337677, mean p set: 0.4471926689147949
loss_pred:0.015061568468809128, decouple_loss:0.000571246724575758
Iteration: 394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44895079731941223, gen p mean: -0.1291927546262741, mean p set: 0.44952791929244995
loss_pred:0.014723283238708973, decouple_loss:0.0006922922329977155
The modified gen p mean: 0.44723379611968994, gen p mean: -0.131931334733963, mean p set: 0.4478095471858978
loss_pred:0.014853376895189285, decouple_loss:0.0005104952142573893
The modified gen p mean: 0.4463559091091156, gen p mean: -0.12506607174873352, mean p set: 0.4469289183616638
loss_pred:0.014867625199258327, decouple_loss:0.0006512238178402185
Iteration: 395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472532570362091, gen p mean: -0.12143310159444809, mean p set: 0.44782623648643494
loss_pred:0.014788348227739334, decouple_loss:0.00048699750914238393
The modified gen p mean: 0.4460534155368805, gen p mean: -0.11935523897409439, mean p set: 0.4466271698474884
loss_pred:0.014789741486310959, decouple_loss:0.0004721360746771097
The modified gen p mean: 0.4480123519897461, gen p mean: -0.12866023182868958, mean p set: 0.44858697056770325
loss_pred:0.014991740696132183, decouple_loss:0.0005403686664067209
Iteration: 396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484991729259491, gen p mean: -0.12716001272201538, mean p set: 0.44907623529434204
loss_pred:0.015547187998890877, decouple_loss:0.0006843135925009847
The modified gen p mean: 0.4456813335418701, gen p mean: -0.12388107180595398, mean p set: 0.44625577330589294
loss_pred:0.015039866790175438, decouple_loss:0.00043446291238069534
The modified gen p mean: 0.44658541679382324, gen p mean: -0.12793809175491333, mean p set: 0.44715940952301025
loss_pred:0.0152544304728508, decouple_loss:0.0006646282854489982
Iteration: 397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44599902629852295, gen p mean: -0.12552718818187714, mean p set: 0.4465752840042114
loss_pred:0.01512280572205782, decouple_loss:0.0005237015429884195
The modified gen p mean: 0.4474959075450897, gen p mean: -0.12753619253635406, mean p set: 0.448073148727417
The modified gen p mean: 0.4458352327346802, gen p mean: -0.12583500146865845, mean p set: 0.4464118480682373
loss_pred:0.01509806513786316, decouple_loss:0.00045972989755682647
loss_pred:0.015530751086771488, decouple_loss:0.00048011247417889535
Iteration: 398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873863458633423, gen p mean: -0.1333678662776947, mean p set: 0.44931700825691223
loss_pred:0.014830063097178936, decouple_loss:0.0007111422019079328
The modified gen p mean: 0.4484778642654419, gen p mean: -0.13092464208602905, mean p set: 0.4490543007850647
The modified gen p mean: 0.44573214650154114, gen p mean: -0.12651318311691284, mean p set: 0.44630685448646545
loss_pred:0.01521073654294014, decouple_loss:0.0007024694932624698
loss_pred:0.015366577543318272, decouple_loss:0.0006359454710036516
Iteration: 399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457310140132904, gen p mean: -0.12913699448108673, mean p set: 0.44630563259124756
loss_pred:0.01442488469183445, decouple_loss:0.00046901562018319964
The modified gen p mean: 0.4458984434604645, gen p mean: -0.12494632601737976, mean p set: 0.44647401571273804
loss_pred:0.015350118279457092, decouple_loss:0.0006003467715345323
The modified gen p mean: 0.44615888595581055, gen p mean: -0.1305188536643982, mean p set: 0.44673389196395874
loss_pred:0.014585418626666069, decouple_loss:0.00048759454512037337
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
NaN value num: 0
Iteration: 400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515042006969452, gen p mean: -0.12768754363059998, mean p set: 0.4520774185657501The modified gen p mean: 0.4502691626548767, gen p mean: -0.11547134071588516, mean p set: 0.45084527134895325
loss_pred:0.01565432921051979, decouple_loss:0.0009077052236534655
loss_pred:0.016430756077170372, decouple_loss:0.0005047247395850718
The modified gen p mean: 0.4525453746318817, gen p mean: -0.12543295323848724, mean p set: 0.4531228840351105
loss_pred:0.015574842691421509, decouple_loss:0.0006183842779137194
2023-05-02 04:23:46 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1304890513420105, mean p set: 0.4502691626548767
loss_pred:0.016883619129657745, decouple_loss:0.0005981448921374977
The modified gen p mean: 0.44953882694244385, gen p mean: -0.12402269244194031, mean p set: 0.4500633478164673
loss_pred:0.01620756834745407, decouple_loss:0.0006448726053349674
The modified gen p mean: 0.44982942938804626, gen p mean: -0.12350060790777206, mean p set: 0.45035696029663086
loss_pred:0.016636107116937637, decouple_loss:0.0007531428127549589
WV_1_PC_1_EH_0_PS_40, loss: 0.016609035432338715, avg_mse: 0.025938663631677628
current test mse: 0.025939
Iteration: 401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450497031211853, gen p mean: -0.11683577299118042, mean p set: 0.45107436180114746
loss_pred:0.014991133473813534, decouple_loss:0.0005464911228045821
The modified gen p mean: 0.4510604739189148, gen p mean: -0.11514800041913986, mean p set: 0.45163676142692566
The modified gen p mean: 0.45070013403892517, gen p mean: -0.11181540787220001, mean p set: 0.4512788653373718
loss_pred:0.01566791720688343, decouple_loss:0.000547001080121845
loss_pred:0.015614344738423824, decouple_loss:0.0005694516585208476
Iteration: 402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507680833339691, gen p mean: -0.11118677258491516, mean p set: 0.45134520530700684
loss_pred:0.01586786098778248, decouple_loss:0.000684538739733398
The modified gen p mean: 0.45097774267196655, gen p mean: -0.11539371311664581, mean p set: 0.45155712962150574The modified gen p mean: 0.45342984795570374, gen p mean: -0.11295448243618011, mean p set: 0.45400553941726685
loss_pred:0.015222247689962387, decouple_loss:0.00047089895815588534
loss_pred:0.014846835285425186, decouple_loss:0.0007611787295900285
Iteration: 403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516628086566925, gen p mean: -0.10976971685886383, mean p set: 0.45223915576934814
loss_pred:0.015638897195458412, decouple_loss:0.0009631725843064487
The modified gen p mean: 0.4505869150161743, gen p mean: -0.1073075532913208, mean p set: 0.45116302371025085
loss_pred:0.01621093787252903, decouple_loss:0.0006332040065899491
The modified gen p mean: 0.45205768942832947, gen p mean: -0.11466308683156967, mean p set: 0.4526367783546448
loss_pred:0.015531692653894424, decouple_loss:0.0005933314096182585
Iteration: 404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505870044231415, gen p mean: -0.10620378702878952, mean p set: 0.45116350054740906
loss_pred:0.015629613772034645, decouple_loss:0.0005157600971870124
The modified gen p mean: 0.4512442648410797, gen p mean: -0.10864906758069992, mean p set: 0.45181941986083984
loss_pred:0.01581183820962906, decouple_loss:0.0006036320701241493
The modified gen p mean: 0.452251136302948, gen p mean: -0.10709687322378159, mean p set: 0.45282885432243347
loss_pred:0.015042807906866074, decouple_loss:0.0005800573853775859
Iteration: 405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504050314426422, gen p mean: -0.1096472218632698, mean p set: 0.4509810209274292
loss_pred:0.015898391604423523, decouple_loss:0.0007029551779851317
The modified gen p mean: 0.4516070485115051, gen p mean: -0.10617868602275848, mean p set: 0.45218291878700256
loss_pred:0.01548361498862505, decouple_loss:0.000599429477006197
The modified gen p mean: 0.4515834152698517, gen p mean: -0.10920572280883789, mean p set: 0.4521616995334625
loss_pred:0.01550288125872612, decouple_loss:0.0006209632847458124
Iteration: 406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451946884393692, gen p mean: -0.11961629241704941, mean p set: 0.45252230763435364
The modified gen p mean: 0.45277562737464905, gen p mean: -0.11130835860967636, mean p set: 0.4533538818359375
loss_pred:0.01576567068696022, decouple_loss:0.0005546435713768005
loss_pred:0.015412282198667526, decouple_loss:0.0006758100353181362
The modified gen p mean: 0.4507172703742981, gen p mean: -0.1132485568523407, mean p set: 0.45129284262657166
loss_pred:0.015124225057661533, decouple_loss:0.000633393821772188
Iteration: 407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45138996839523315, gen p mean: -0.11751110851764679, mean p set: 0.4519648849964142
loss_pred:0.016277769580483437, decouple_loss:0.0006751595647074282
The modified gen p mean: 0.4504561126232147, gen p mean: -0.11852158606052399, mean p set: 0.45103341341018677
loss_pred:0.015272179618477821, decouple_loss:0.0004690131754614413
The modified gen p mean: 0.4515509307384491, gen p mean: -0.1129269227385521, mean p set: 0.4521290957927704
loss_pred:0.014773019589483738, decouple_loss:0.00046006529009900987
Iteration: 408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45142924785614014, gen p mean: -0.11819800734519958, mean p set: 0.45200681686401367
loss_pred:0.014836492948234081, decouple_loss:0.0005745663656853139
The modified gen p mean: 0.45151662826538086, gen p mean: -0.11586624383926392, mean p set: 0.4520907402038574
loss_pred:0.01502894889563322, decouple_loss:0.0005065603763796389
The modified gen p mean: 0.45134907960891724, gen p mean: -0.12274574488401413, mean p set: 0.45192527770996094
loss_pred:0.016278568655252457, decouple_loss:0.000713091401848942
Iteration: 409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511421024799347, gen p mean: -0.11839812248945236, mean p set: 0.45171838998794556
loss_pred:0.015277501195669174, decouple_loss:0.0005779407219961286
The modified gen p mean: 0.45144394040107727, gen p mean: -0.11960409581661224, mean p set: 0.4520235061645508
The modified gen p mean: 0.45120903849601746, gen p mean: -0.12149610370397568, mean p set: 0.45178526639938354
loss_pred:0.014650298282504082, decouple_loss:0.0005905925645492971
loss_pred:0.015356771647930145, decouple_loss:0.0005252545815892518
Iteration: 410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45022132992744446, gen p mean: -0.11722598969936371, mean p set: 0.45079749822616577
loss_pred:0.015432536602020264, decouple_loss:0.0005454721977002919
The modified gen p mean: 0.4512304663658142, gen p mean: -0.11975255608558655, mean p set: 0.4518086314201355
loss_pred:0.015767686069011688, decouple_loss:0.0006179301417432725
The modified gen p mean: 0.4507375955581665, gen p mean: -0.11767363548278809, mean p set: 0.4513179063796997
loss_pred:0.016132092103362083, decouple_loss:0.0005772649310529232
2023-05-02 04:25:54 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13255555927753448, mean p set: 0.4502691626548767
loss_pred:0.0170495193451643, decouple_loss:0.0006113225244916975
The modified gen p mean: 0.44953426718711853, gen p mean: -0.12669795751571655, mean p set: 0.4500633478164673
loss_pred:0.016353478655219078, decouple_loss:0.0006286089774221182
The modified gen p mean: 0.4498288035392761, gen p mean: -0.1262100636959076, mean p set: 0.45035696029663086
loss_pred:0.016721639782190323, decouple_loss:0.0006918390281498432
WV_1_PC_1_EH_0_PS_40, loss: 0.016740409657359123, avg_mse: 0.02607337012887001
current test mse: 0.026073
Iteration: 411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531717896461487, gen p mean: -0.11739860475063324, mean p set: 0.45374795794487
loss_pred:0.015218471176922321, decouple_loss:0.0006375937955453992
The modified gen p mean: 0.45335012674331665, gen p mean: -0.11724354326725006, mean p set: 0.4539281725883484
loss_pred:0.015132996253669262, decouple_loss:0.0005878267111256719
The modified gen p mean: 0.4511863887310028, gen p mean: -0.11855824291706085, mean p set: 0.4517635107040405
loss_pred:0.015605282969772816, decouple_loss:0.0007036386523395777
Iteration: 412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114079117774963, gen p mean: -0.1138835921883583, mean p set: 0.45171689987182617
loss_pred:0.015823977068066597, decouple_loss:0.0005822890088893473
The modified gen p mean: 0.4517131447792053, gen p mean: -0.11746836453676224, mean p set: 0.452288955450058The modified gen p mean: 0.4513618052005768, gen p mean: -0.11454381048679352, mean p set: 0.45193883776664734
loss_pred:0.015226732939481735, decouple_loss:0.0004734949325211346
loss_pred:0.01570991240441799, decouple_loss:0.0004721536533907056
Iteration: 413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511030316352844, gen p mean: -0.11653666198253632, mean p set: 0.4516795575618744
loss_pred:0.01573079824447632, decouple_loss:0.0005517688114196062
The modified gen p mean: 0.45205748081207275, gen p mean: -0.12413300573825836, mean p set: 0.4526348412036896The modified gen p mean: 0.45388898253440857, gen p mean: -0.1191076785326004, mean p set: 0.45446687936782837
loss_pred:0.015360900200903416, decouple_loss:0.0006673589232377708
loss_pred:0.01479716319590807, decouple_loss:0.000540558947250247
Iteration: 414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507432281970978, gen p mean: -0.11814886331558228, mean p set: 0.45131972432136536
loss_pred:0.0155751658603549, decouple_loss:0.0005993342492729425
The modified gen p mean: 0.4526519477367401, gen p mean: -0.11900709569454193, mean p set: 0.4532293677330017
loss_pred:0.01494924072176218, decouple_loss:0.0007824250496923923
The modified gen p mean: 0.4508150517940521, gen p mean: -0.1216072291135788, mean p set: 0.4513914883136749
loss_pred:0.015214691869914532, decouple_loss:0.0005679914611391723
Iteration: 415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45155274868011475, gen p mean: -0.12106124311685562, mean p set: 0.45212632417678833
loss_pred:0.01545705460011959, decouple_loss:0.0005966428434476256
The modified gen p mean: 0.45187732577323914, gen p mean: -0.12224695086479187, mean p set: 0.4524551033973694
The modified gen p mean: 0.453281968832016, gen p mean: -0.12072228640317917, mean p set: 0.453857421875
loss_pred:0.015427002683281898, decouple_loss:0.0007496559992432594
loss_pred:0.014939953573048115, decouple_loss:0.0005398685461841524
Iteration: 416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45251789689064026, gen p mean: -0.11882498860359192, mean p set: 0.45309484004974365
loss_pred:0.014965097419917583, decouple_loss:0.00046965701039880514
The modified gen p mean: 0.4519277811050415, gen p mean: -0.12269391119480133, mean p set: 0.45250189304351807
loss_pred:0.015420396812260151, decouple_loss:0.0005881103570573032
The modified gen p mean: 0.4512384533882141, gen p mean: -0.11775394529104233, mean p set: 0.4518158733844757
loss_pred:0.015614496544003487, decouple_loss:0.0005075802910141647
Iteration: 417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45066341757774353, gen p mean: -0.11901107430458069, mean p set: 0.45124444365501404
loss_pred:0.015932660549879074, decouple_loss:0.0005726439994759858
The modified gen p mean: 0.4535524249076843, gen p mean: -0.12177697569131851, mean p set: 0.45412924885749817
The modified gen p mean: 0.4510282278060913, gen p mean: -0.12065863609313965, mean p set: 0.45160529017448425
loss_pred:0.014887126162648201, decouple_loss:0.0004958765930496156
loss_pred:0.015327220782637596, decouple_loss:0.0006158354808576405
Iteration: 418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45202895998954773, gen p mean: -0.12234445661306381, mean p set: 0.4526068866252899
loss_pred:0.015599021688103676, decouple_loss:0.0005477170343510807
The modified gen p mean: 0.4528840482234955, gen p mean: -0.1204543486237526, mean p set: 0.4534603953361511
The modified gen p mean: 0.44999590516090393, gen p mean: -0.11425771564245224, mean p set: 0.4505713880062103
loss_pred:0.014661511406302452, decouple_loss:0.0006246797274798155
loss_pred:0.015033991076052189, decouple_loss:0.0007497250917367637
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
NaN value num: 0
Iteration: 419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677773118019104, gen p mean: -0.13118906319141388, mean p set: 0.4473547637462616
loss_pred:0.01602727547287941, decouple_loss:0.0008514815126545727
The modified gen p mean: 0.446852445602417, gen p mean: -0.13096456229686737, mean p set: 0.44742879271507263
The modified gen p mean: 0.44732168316841125, gen p mean: -0.13158179819583893, mean p set: 0.44789600372314453
loss_pred:0.01740533858537674, decouple_loss:0.0010618828237056732
loss_pred:0.016918249428272247, decouple_loss:0.0009437604458071291
Iteration: 420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477914869785309, gen p mean: -0.13102228939533234, mean p set: 0.44836893677711487
loss_pred:0.016230430454015732, decouple_loss:0.000551447388716042
The modified gen p mean: 0.44770896434783936, gen p mean: -0.13178472220897675, mean p set: 0.448288232088089
The modified gen p mean: 0.4470152258872986, gen p mean: -0.13527551293373108, mean p set: 0.4475935399532318
loss_pred:0.015906762331724167, decouple_loss:0.0006598944892175496
loss_pred:0.016222167760133743, decouple_loss:0.0006281493697315454
2023-05-02 04:28:38 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13642540574073792, mean p set: 0.4502691626548767
loss_pred:0.01708773896098137, decouple_loss:0.0006570766563527286
The modified gen p mean: 0.44953200221061707, gen p mean: -0.13043561577796936, mean p set: 0.4500633478164673
loss_pred:0.016323484480381012, decouple_loss:0.0007304194732569158
The modified gen p mean: 0.4498277008533478, gen p mean: -0.1303967535495758, mean p set: 0.45035696029663086
loss_pred:0.016754088923335075, decouple_loss:0.0005729429540224373
WV_1_PC_1_EH_0_PS_40, loss: 0.016754446551203728, avg_mse: 0.02596498839557171
current test mse: 0.025965
Iteration: 421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718992710113525, gen p mean: -0.13273173570632935, mean p set: 0.4477632939815521
loss_pred:0.01740552857518196, decouple_loss:0.0006807034369558096
The modified gen p mean: 0.44653862714767456, gen p mean: -0.12885011732578278, mean p set: 0.4471152722835541
loss_pred:0.01653921976685524, decouple_loss:0.0005483140703290701
The modified gen p mean: 0.4465520977973938, gen p mean: -0.13485059142112732, mean p set: 0.4471314251422882
loss_pred:0.016216758638620377, decouple_loss:0.0006090162787586451
Iteration: 422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489309787750244, gen p mean: -0.13197237253189087, mean p set: 0.4495074450969696
loss_pred:0.016048962250351906, decouple_loss:0.0007836712175048888
The modified gen p mean: 0.44696301221847534, gen p mean: -0.13073770701885223, mean p set: 0.44753962755203247
loss_pred:0.016264252364635468, decouple_loss:0.0006701506790705025
The modified gen p mean: 0.44695398211479187, gen p mean: -0.13766492903232574, mean p set: 0.4475308060646057
loss_pred:0.016471346840262413, decouple_loss:0.0005712744314223528
Iteration: 423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488317668437958, gen p mean: -0.13937842845916748, mean p set: 0.44940972328186035
loss_pred:0.015351429581642151, decouple_loss:0.0008405086118727922
The modified gen p mean: 0.4475247263908386, gen p mean: -0.1340153068304062, mean p set: 0.4481023848056793
loss_pred:0.016989657655358315, decouple_loss:0.0005583710735663772
The modified gen p mean: 0.4467512369155884, gen p mean: -0.13847191631793976, mean p set: 0.4473278820514679
loss_pred:0.016558613628149033, decouple_loss:0.0006533460691571236
Iteration: 424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881337881088257, gen p mean: -0.13944576680660248, mean p set: 0.44939130544662476
loss_pred:0.01573425531387329, decouple_loss:0.0005708655808120966
The modified gen p mean: 0.44762107729911804, gen p mean: -0.13735587894916534, mean p set: 0.4481962025165558
loss_pred:0.016753671690821648, decouple_loss:0.0004655736847780645
The modified gen p mean: 0.4472467005252838, gen p mean: -0.14182664453983307, mean p set: 0.4478229880332947
loss_pred:0.015682043507695198, decouple_loss:0.0005826133419759572
Iteration: 425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470636546611786, gen p mean: -0.13935650885105133, mean p set: 0.44764068722724915
loss_pred:0.016192372888326645, decouple_loss:0.000655895855743438
The modified gen p mean: 0.44768035411834717, gen p mean: -0.1352744698524475, mean p set: 0.4482572078704834
loss_pred:0.01641700230538845, decouple_loss:0.0005260771722532809
The modified gen p mean: 0.44627463817596436, gen p mean: -0.13477137684822083, mean p set: 0.44684910774230957
loss_pred:0.01670079492032528, decouple_loss:0.0006276718340814114
Iteration: 426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480542540550232, gen p mean: -0.13256120681762695, mean p set: 0.44863173365592957
loss_pred:0.015778668224811554, decouple_loss:0.0005359216593205929
The modified gen p mean: 0.44677847623825073, gen p mean: -0.13173192739486694, mean p set: 0.447354793548584
loss_pred:0.016993854194879532, decouple_loss:0.0006169044645503163
The modified gen p mean: 0.44800513982772827, gen p mean: -0.13490460813045502, mean p set: 0.44858479499816895
loss_pred:0.015855301171541214, decouple_loss:0.0005957604735158384
Iteration: 427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467427730560303, gen p mean: -0.13288259506225586, mean p set: 0.4473206102848053
loss_pred:0.016385797411203384, decouple_loss:0.0006664009997621179
The modified gen p mean: 0.448140949010849, gen p mean: -0.13317155838012695, mean p set: 0.448716402053833
The modified gen p mean: 0.4477721154689789, gen p mean: -0.128109410405159, mean p set: 0.44834673404693604
loss_pred:0.015188582241535187, decouple_loss:0.0003807640459854156
loss_pred:0.01611318811774254, decouple_loss:0.0004393337294459343
Iteration: 428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44700053334236145, gen p mean: -0.13244213163852692, mean p set: 0.4475752115249634
loss_pred:0.015571339055895805, decouple_loss:0.0004408234963193536
The modified gen p mean: 0.448329359292984, gen p mean: -0.12845316529273987, mean p set: 0.4489063620567322
The modified gen p mean: 0.4477582573890686, gen p mean: -0.1272432506084442, mean p set: 0.4483358860015869
loss_pred:0.015900304540991783, decouple_loss:0.0006273814360611141
loss_pred:0.016132066026329994, decouple_loss:0.0004180514661129564
Iteration: 429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44562771916389465, gen p mean: -0.1261528730392456, mean p set: 0.44620317220687866
loss_pred:0.016385085880756378, decouple_loss:0.0005254170391708612
The modified gen p mean: 0.4463607966899872, gen p mean: -0.12372955679893494, mean p set: 0.44693848490715027
The modified gen p mean: 0.4483543634414673, gen p mean: -0.1279315948486328, mean p set: 0.4489297568798065
loss_pred:0.0170711912214756, decouple_loss:0.000793900340795517
loss_pred:0.015468088909983635, decouple_loss:0.0006104102940298617
Iteration: 430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478742480278015, gen p mean: -0.12794409692287445, mean p set: 0.4484526515007019
loss_pred:0.016277242451906204, decouple_loss:0.00045725979725830257
The modified gen p mean: 0.4470747411251068, gen p mean: -0.12509028613567352, mean p set: 0.4476478397846222
loss_pred:0.01611022651195526, decouple_loss:0.0005883609410375357
The modified gen p mean: 0.4474668502807617, gen p mean: -0.1345432996749878, mean p set: 0.4480431377887726
loss_pred:0.016162903979420662, decouple_loss:0.0006510936073027551
2023-05-02 04:30:45 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13576242327690125, mean p set: 0.4502691626548767
loss_pred:0.01700727455317974, decouple_loss:0.0005195629200898111
The modified gen p mean: 0.4495370090007782, gen p mean: -0.12973652780056, mean p set: 0.4500633478164673
loss_pred:0.016268786042928696, decouple_loss:0.0006185114616528153
The modified gen p mean: 0.4498274624347687, gen p mean: -0.12965726852416992, mean p set: 0.45035696029663086
loss_pred:0.016675535589456558, decouple_loss:0.0006385724991559982
WV_1_PC_1_EH_0_PS_40, loss: 0.016680143773555756, avg_mse: 0.025940677151083946
current test mse: 0.025941
Iteration: 431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466024935245514, gen p mean: -0.12615427374839783, mean p set: 0.44717973470687866
loss_pred:0.017153911292552948, decouple_loss:0.0005030359025113285
The modified gen p mean: 0.44775184988975525, gen p mean: -0.1372694969177246, mean p set: 0.4483281373977661
The modified gen p mean: 0.44619375467300415, gen p mean: -0.12663984298706055, mean p set: 0.4467698633670807
loss_pred:0.01653134822845459, decouple_loss:0.0005620589945465326
loss_pred:0.016816962510347366, decouple_loss:0.0005144571186974645
Iteration: 432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469242990016937, gen p mean: -0.13221924006938934, mean p set: 0.44750040769577026
loss_pred:0.016456056386232376, decouple_loss:0.0004947003326378763
The modified gen p mean: 0.44692888855934143, gen p mean: -0.13821960985660553, mean p set: 0.44750818610191345The modified gen p mean: 0.44788435101509094, gen p mean: -0.13163675367832184, mean p set: 0.4484597444534302
loss_pred:0.016026046127080917, decouple_loss:0.0006706559215672314
loss_pred:0.016016582027077675, decouple_loss:0.0005255795549601316
Iteration: 433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745934009552, gen p mean: -0.1381026655435562, mean p set: 0.4480331242084503
loss_pred:0.01570197567343712, decouple_loss:0.00047356245340779424
The modified gen p mean: 0.44857534766197205, gen p mean: -0.14074306190013885, mean p set: 0.4491514265537262
loss_pred:0.015126853249967098, decouple_loss:0.000604177126660943
The modified gen p mean: 0.4479207992553711, gen p mean: -0.13747330009937286, mean p set: 0.44849663972854614
loss_pred:0.016428207978606224, decouple_loss:0.00048412111937068403
Iteration: 434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801682233810425, gen p mean: -0.14129136502742767, mean p set: 0.44859179854393005
loss_pred:0.015309497714042664, decouple_loss:0.0006320978864096105
The modified gen p mean: 0.44767117500305176, gen p mean: -0.1348501592874527, mean p set: 0.44824421405792236
loss_pred:0.016519004479050636, decouple_loss:0.000611012103036046
The modified gen p mean: 0.44714558124542236, gen p mean: -0.13644975423812866, mean p set: 0.44771823287010193
loss_pred:0.01683172397315502, decouple_loss:0.0005754800513386726
Iteration: 435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762831926345825, gen p mean: -0.13766199350357056, mean p set: 0.44820523262023926
loss_pred:0.016422664746642113, decouple_loss:0.0006932767573744059
The modified gen p mean: 0.44625160098075867, gen p mean: -0.14215075969696045, mean p set: 0.44682762026786804
loss_pred:0.015490243211388588, decouple_loss:0.0008798834169283509
The modified gen p mean: 0.4477137625217438, gen p mean: -0.1429595798254013, mean p set: 0.44829070568084717
loss_pred:0.01718256250023842, decouple_loss:0.0006489228690043092
Iteration: 436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457584023475647, gen p mean: -0.13725966215133667, mean p set: 0.4463379681110382
loss_pred:0.01634085923433304, decouple_loss:0.0004063552478328347
The modified gen p mean: 0.4460325837135315, gen p mean: -0.13885000348091125, mean p set: 0.44660601019859314
loss_pred:0.015756217762827873, decouple_loss:0.000339643593179062
The modified gen p mean: 0.44707760214805603, gen p mean: -0.1385572850704193, mean p set: 0.447655588388443
loss_pred:0.016493093222379684, decouple_loss:0.00041092082392424345
Iteration: 437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44670921564102173, gen p mean: -0.1417270004749298, mean p set: 0.44728490710258484
loss_pred:0.015623150393366814, decouple_loss:0.0004753429093398154
The modified gen p mean: 0.44643452763557434, gen p mean: -0.14121928811073303, mean p set: 0.44701069593429565
loss_pred:0.016274122521281242, decouple_loss:0.0005204367334954441
The modified gen p mean: 0.4467797875404358, gen p mean: -0.136534184217453, mean p set: 0.4473547041416168
loss_pred:0.01616825722157955, decouple_loss:0.0005700680194422603
Iteration: 438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811978936195374, gen p mean: -0.13124175369739532, mean p set: 0.4486939311027527
loss_pred:0.015908366069197655, decouple_loss:0.000508401426486671
The modified gen p mean: 0.4464782476425171, gen p mean: -0.13453494012355804, mean p set: 0.4470527172088623
loss_pred:0.017523441463708878, decouple_loss:0.0005531656206585467
The modified gen p mean: 0.44764235615730286, gen p mean: -0.13847650587558746, mean p set: 0.4482213854789734
loss_pred:0.015102234669029713, decouple_loss:0.0005072142230346799
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
NaN value num: 0
Iteration: 439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511309862136841, gen p mean: -0.13271839916706085, mean p set: 0.4517081081867218
loss_pred:0.016009973362088203, decouple_loss:0.0006237634806893766
The modified gen p mean: 0.45083245635032654, gen p mean: -0.13369661569595337, mean p set: 0.45141419768333435
The modified gen p mean: 0.4523465931415558, gen p mean: -0.12697741389274597, mean p set: 0.45292070508003235
loss_pred:0.016097990795969963, decouple_loss:0.0005228151567280293
loss_pred:0.016602592542767525, decouple_loss:0.0005390331498347223
Iteration: 440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518558084964752, gen p mean: -0.12764814496040344, mean p set: 0.45243194699287415
loss_pred:0.01649845577776432, decouple_loss:0.0005729174590669572
The modified gen p mean: 0.44959062337875366, gen p mean: -0.12861189246177673, mean p set: 0.45016559958457947
loss_pred:0.014603057876229286, decouple_loss:0.000489594298414886
The modified gen p mean: 0.4489632844924927, gen p mean: -0.13294443488121033, mean p set: 0.4495377540588379
loss_pred:0.015324987471103668, decouple_loss:0.0006644083769060671
2023-05-02 04:33:27 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13760554790496826, mean p set: 0.4502691626548767
loss_pred:0.017008192837238312, decouple_loss:0.0005016859504394233
The modified gen p mean: 0.4495357871055603, gen p mean: -0.1315208077430725, mean p set: 0.4500633478164673
loss_pred:0.016290204599499702, decouple_loss:0.0004866260278504342
The modified gen p mean: 0.4498288929462433, gen p mean: -0.13110552728176117, mean p set: 0.45035696029663086
loss_pred:0.016636265441775322, decouple_loss:0.0005302270292304456
WV_1_PC_1_EH_0_PS_40, loss: 0.016670197248458862, avg_mse: 0.02594299614429474
current test mse: 0.025943
Iteration: 441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505557715892792, gen p mean: -0.12340997904539108, mean p set: 0.4511326253414154
loss_pred:0.016687870025634766, decouple_loss:0.0006004769238643348
The modified gen p mean: 0.4516693949699402, gen p mean: -0.12363703548908234, mean p set: 0.4522458016872406The modified gen p mean: 0.4507735073566437, gen p mean: -0.12137570232152939, mean p set: 0.4513501822948456
loss_pred:0.016706503927707672, decouple_loss:0.0006367343594320118
loss_pred:0.01651899889111519, decouple_loss:0.000640739337541163
Iteration: 442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498056471347809, gen p mean: -0.13278144598007202, mean p set: 0.4503801465034485
The modified gen p mean: 0.4494718611240387, gen p mean: -0.1325857788324356, mean p set: 0.4500464200973511
loss_pred:0.015790758654475212, decouple_loss:0.0005083036958239973
loss_pred:0.015670303255319595, decouple_loss:0.0005237502045929432
The modified gen p mean: 0.4513223171234131, gen p mean: -0.13038229942321777, mean p set: 0.4518985152244568
loss_pred:0.015590074472129345, decouple_loss:0.0005302145145833492
Iteration: 443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451339989900589, gen p mean: -0.13076883554458618, mean p set: 0.45191308856010437
loss_pred:0.01492905430495739, decouple_loss:0.00044970129965804517
The modified gen p mean: 0.45139366388320923, gen p mean: -0.1268136352300644, mean p set: 0.45197030901908875
loss_pred:0.01592073403298855, decouple_loss:0.00043585110688582063
The modified gen p mean: 0.45025578141212463, gen p mean: -0.12850919365882874, mean p set: 0.45083242654800415
loss_pred:0.015488514676690102, decouple_loss:0.00044740005978383124
Iteration: 444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080938935279846, gen p mean: -0.13261134922504425, mean p set: 0.45138633251190186
loss_pred:0.015092373825609684, decouple_loss:0.00043684503179974854
The modified gen p mean: 0.45060351490974426, gen p mean: -0.12594710290431976, mean p set: 0.45118266344070435
loss_pred:0.015873562544584274, decouple_loss:0.0006251445156522095
The modified gen p mean: 0.45064470171928406, gen p mean: -0.128162682056427, mean p set: 0.4512195587158203
loss_pred:0.016567744314670563, decouple_loss:0.0005598879070021212
Iteration: 445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969412684440613, gen p mean: -0.133585587143898, mean p set: 0.45026880502700806
loss_pred:0.015448564663529396, decouple_loss:0.000593729957472533
The modified gen p mean: 0.45237216353416443, gen p mean: -0.12962481379508972, mean p set: 0.4529488980770111
loss_pred:0.0151457404717803, decouple_loss:0.0005094258231110871
The modified gen p mean: 0.44863131642341614, gen p mean: -0.12574508786201477, mean p set: 0.4492046535015106
loss_pred:0.01612894982099533, decouple_loss:0.0005054892390035093
Iteration: 446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527575969696045, gen p mean: -0.13267427682876587, mean p set: 0.45333564281463623
loss_pred:0.014404499903321266, decouple_loss:0.0004842278140131384
The modified gen p mean: 0.44824132323265076, gen p mean: -0.13022169470787048, mean p set: 0.44881677627563477
loss_pred:0.015700865536928177, decouple_loss:0.000434157089330256
The modified gen p mean: 0.4517338275909424, gen p mean: -0.13531331717967987, mean p set: 0.4523109793663025
loss_pred:0.01623436063528061, decouple_loss:0.0006457942072302103
Iteration: 447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450651615858078, gen p mean: -0.1280832588672638, mean p set: 0.45122823119163513
loss_pred:0.01658378541469574, decouple_loss:0.0004938816418871284
The modified gen p mean: 0.4510887861251831, gen p mean: -0.1301621049642563, mean p set: 0.4516648054122925
loss_pred:0.01453764084726572, decouple_loss:0.0005418969667516649
The modified gen p mean: 0.4507980942726135, gen p mean: -0.12989895045757294, mean p set: 0.45137470960617065
loss_pred:0.016917407512664795, decouple_loss:0.0005200294544920325
Iteration: 448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128002762794495, gen p mean: -0.12483543902635574, mean p set: 0.4518575668334961
loss_pred:0.01604754664003849, decouple_loss:0.00047815198195166886
The modified gen p mean: 0.4486030042171478, gen p mean: -0.12766890227794647, mean p set: 0.4491777718067169
The modified gen p mean: 0.4526825249195099, gen p mean: -0.12779156863689423, mean p set: 0.45325756072998047
loss_pred:0.015938054770231247, decouple_loss:0.0004673351941164583
loss_pred:0.01499987579882145, decouple_loss:0.0004501139046624303
Iteration: 449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514232873916626, gen p mean: -0.1215907409787178, mean p set: 0.4519991874694824
loss_pred:0.01672985963523388, decouple_loss:0.0005584184546023607
The modified gen p mean: 0.44918006658554077, gen p mean: -0.12296338379383087, mean p set: 0.4497554302215576
loss_pred:0.01527242548763752, decouple_loss:0.0004772707761730999
The modified gen p mean: 0.4512597322463989, gen p mean: -0.12322583794593811, mean p set: 0.4518345892429352
loss_pred:0.015504967421293259, decouple_loss:0.0004985100240446627
Iteration: 450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45020899176597595, gen p mean: -0.12633439898490906, mean p set: 0.4507836401462555
loss_pred:0.015931066125631332, decouple_loss:0.0005800025537610054
The modified gen p mean: 0.45314714312553406, gen p mean: -0.1283189207315445, mean p set: 0.45372650027275085
The modified gen p mean: 0.45007628202438354, gen p mean: -0.1296008676290512, mean p set: 0.4506514370441437
loss_pred:0.014091219753026962, decouple_loss:0.00044328623334877193
loss_pred:0.0158163383603096, decouple_loss:0.0005092605715617537
2023-05-02 04:35:34 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1374305933713913, mean p set: 0.4502691626548767
loss_pred:0.017015263438224792, decouple_loss:0.0005156329716555774
The modified gen p mean: 0.44953468441963196, gen p mean: -0.13108274340629578, mean p set: 0.4500633478164673
loss_pred:0.016277141869068146, decouple_loss:0.000554831582121551
The modified gen p mean: 0.4498283863067627, gen p mean: -0.13049761950969696, mean p set: 0.45035696029663086
loss_pred:0.01678270287811756, decouple_loss:0.00046162749640643597
WV_1_PC_1_EH_0_PS_40, loss: 0.01671723835170269, avg_mse: 0.0261100884526968
current test mse: 0.02611
Iteration: 451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524015188217163, gen p mean: -0.12419676780700684, mean p set: 0.45297905802726746
loss_pred:0.0163571797311306, decouple_loss:0.0005331154097802937
The modified gen p mean: 0.4481331408023834, gen p mean: -0.12485330551862717, mean p set: 0.4487107992172241The modified gen p mean: 0.4502624273300171, gen p mean: -0.12844397127628326, mean p set: 0.450838565826416
loss_pred:0.01588844321668148, decouple_loss:0.0004819876339752227
loss_pred:0.016389518976211548, decouple_loss:0.0004673743387684226
Iteration: 452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506785273551941, gen p mean: -0.1297949105501175, mean p set: 0.4512555003166199
loss_pred:0.016502590849995613, decouple_loss:0.0005174006219021976
The modified gen p mean: 0.4506664574146271, gen p mean: -0.13323596119880676, mean p set: 0.4512436091899872The modified gen p mean: 0.4525876045227051, gen p mean: -0.1327187418937683, mean p set: 0.4531644284725189
loss_pred:0.015740113332867622, decouple_loss:0.0005495301447808743
loss_pred:0.014868682250380516, decouple_loss:0.0005971742793917656
Iteration: 453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495980441570282, gen p mean: -0.13655544817447662, mean p set: 0.4501744508743286
loss_pred:0.01573026180267334, decouple_loss:0.0004786135395988822
The modified gen p mean: 0.4479469358921051, gen p mean: -0.12826110422611237, mean p set: 0.44852298498153687The modified gen p mean: 0.45005854964256287, gen p mean: -0.1346307247877121, mean p set: 0.4506361782550812
loss_pred:0.01565546728670597, decouple_loss:0.0004982773680239916
loss_pred:0.015752678737044334, decouple_loss:0.00048620474990457296
Iteration: 454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483099579811096, gen p mean: -0.12664860486984253, mean p set: 0.4488857686519623
loss_pred:0.016228077933192253, decouple_loss:0.0004258757981006056
The modified gen p mean: 0.4511224627494812, gen p mean: -0.12918710708618164, mean p set: 0.451697438955307
loss_pred:0.016266312450170517, decouple_loss:0.00046585965901613235
The modified gen p mean: 0.4495818614959717, gen p mean: -0.12056870013475418, mean p set: 0.4501582682132721
loss_pred:0.015116343274712563, decouple_loss:0.0005903392448090017
Iteration: 455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501357078552246, gen p mean: -0.12627901136875153, mean p set: 0.4507121443748474
loss_pred:0.014920657500624657, decouple_loss:0.0006331555778160691
The modified gen p mean: 0.44998273253440857, gen p mean: -0.12672090530395508, mean p set: 0.45056024193763733
loss_pred:0.01586548425257206, decouple_loss:0.0005734385922551155
The modified gen p mean: 0.4507572054862976, gen p mean: -0.12813186645507812, mean p set: 0.451333224773407
loss_pred:0.015277489088475704, decouple_loss:0.0005711432895623147
Iteration: 456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496663808822632, gen p mean: -0.13143229484558105, mean p set: 0.4502442479133606
loss_pred:0.015740178525447845, decouple_loss:0.0005929376929998398
The modified gen p mean: 0.45007577538490295, gen p mean: -0.12217579036951065, mean p set: 0.4506521224975586
loss_pred:0.01528641115874052, decouple_loss:0.0004344733024481684
The modified gen p mean: 0.44999200105667114, gen p mean: -0.12098222970962524, mean p set: 0.45056816935539246
loss_pred:0.01564965583384037, decouple_loss:0.0004387078806757927
Iteration: 457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516501724720001, gen p mean: -0.12438355386257172, mean p set: 0.45222997665405273
loss_pred:0.015516581013798714, decouple_loss:0.0006267260177992284
The modified gen p mean: 0.44988998770713806, gen p mean: -0.13016775250434875, mean p set: 0.4504671096801758
loss_pred:0.016046741977334023, decouple_loss:0.00048109484487213194
The modified gen p mean: 0.4485672116279602, gen p mean: -0.12374356389045715, mean p set: 0.44914230704307556
loss_pred:0.015040092170238495, decouple_loss:0.00047835588338784873
Iteration: 458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925573468208313, gen p mean: -0.1251416802406311, mean p set: 0.44983211159706116
loss_pred:0.014968867413699627, decouple_loss:0.0004094181058462709
The modified gen p mean: 0.45083674788475037, gen p mean: -0.13204167783260345, mean p set: 0.4514155387878418
The modified gen p mean: 0.44939345121383667, gen p mean: -0.1183343231678009, mean p set: 0.4499705135822296
loss_pred:0.015562517568469048, decouple_loss:0.0004528287681750953
loss_pred:0.014841482974588871, decouple_loss:0.0005653925472870469
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775769114494324, gen p mean: -0.13035720586776733, mean p set: 0.4483359158039093
loss_pred:0.01569395139813423, decouple_loss:0.0006351175834424794
The modified gen p mean: 0.4475245475769043, gen p mean: -0.13355115056037903, mean p set: 0.4481017291545868
The modified gen p mean: 0.44869065284729004, gen p mean: -0.1346205770969391, mean p set: 0.4492678940296173
loss_pred:0.015117851085960865, decouple_loss:0.0005276637966744602
loss_pred:0.015158704482018948, decouple_loss:0.000443651428213343
Iteration: 460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487839937210083, gen p mean: -0.13561584055423737, mean p set: 0.44936102628707886
loss_pred:0.01498381793498993, decouple_loss:0.0005358957569114864
The modified gen p mean: 0.44666755199432373, gen p mean: -0.13093137741088867, mean p set: 0.44724538922309875
The modified gen p mean: 0.44806793332099915, gen p mean: -0.13101080060005188, mean p set: 0.44864311814308167
loss_pred:0.01624847576022148, decouple_loss:0.0004793479747604579
loss_pred:0.015720998868346214, decouple_loss:0.00042752944864332676
2023-05-02 04:38:17 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13710717856884003, mean p set: 0.4502691626548767
loss_pred:0.0169825479388237, decouple_loss:0.0005131789366714656
The modified gen p mean: 0.44953426718711853, gen p mean: -0.13085635006427765, mean p set: 0.4500633478164673
loss_pred:0.016223620623350143, decouple_loss:0.0006776268128305674
The modified gen p mean: 0.4498271942138672, gen p mean: -0.13017427921295166, mean p set: 0.45035696029663086
loss_pred:0.016651079058647156, decouple_loss:0.0006877427804283798
WV_1_PC_1_EH_0_PS_40, loss: 0.01665039174258709, avg_mse: 0.02591565065085888
current test mse: 0.025916
Iteration: 461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799450039863586, gen p mean: -0.12944753468036652, mean p set: 0.44857192039489746
The modified gen p mean: 0.44792768359184265, gen p mean: -0.13315381109714508, mean p set: 0.4485013484954834
loss_pred:0.01609155349433422, decouple_loss:0.0005973661318421364
loss_pred:0.015758007764816284, decouple_loss:0.000564892659895122
The modified gen p mean: 0.44835156202316284, gen p mean: -0.13062237203121185, mean p set: 0.4489271342754364
loss_pred:0.015240395441651344, decouple_loss:0.0006608319818042219
Iteration: 462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480682909488678, gen p mean: -0.12841114401817322, mean p set: 0.44864511489868164
loss_pred:0.01515237521380186, decouple_loss:0.0005296370363794267
The modified gen p mean: 0.44731202721595764, gen p mean: -0.12754009664058685, mean p set: 0.4478871822357178
The modified gen p mean: 0.4477604329586029, gen p mean: -0.131871297955513, mean p set: 0.4483374059200287
loss_pred:0.016108542680740356, decouple_loss:0.0005457007791846991
loss_pred:0.015414048917591572, decouple_loss:0.0004926101537421346
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723767042160034, gen p mean: -0.12389885634183884, mean p set: 0.44781461358070374
loss_pred:0.015891464427113533, decouple_loss:0.0004528911376837641
The modified gen p mean: 0.44814324378967285, gen p mean: -0.12977170944213867, mean p set: 0.44871973991394043
loss_pred:0.015715831890702248, decouple_loss:0.00038698402931913733
The modified gen p mean: 0.4470558762550354, gen p mean: -0.12230893969535828, mean p set: 0.4476318955421448
loss_pred:0.01622556708753109, decouple_loss:0.00042303800000809133
Iteration: 464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796618819236755, gen p mean: -0.12218683212995529, mean p set: 0.4485422670841217
loss_pred:0.0158282071352005, decouple_loss:0.0004992297617718577
The modified gen p mean: 0.4475298225879669, gen p mean: -0.1291564255952835, mean p set: 0.44810402393341064
loss_pred:0.015104527585208416, decouple_loss:0.00042158650467172265
The modified gen p mean: 0.44736695289611816, gen p mean: -0.12065934389829636, mean p set: 0.4479440450668335
loss_pred:0.015528131276369095, decouple_loss:0.0004593876365106553
Iteration: 465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791191816329956, gen p mean: -0.12467614561319351, mean p set: 0.44848933815956116
The modified gen p mean: 0.44607067108154297, gen p mean: -0.1260419487953186, mean p set: 0.44664737582206726
loss_pred:0.015000315383076668, decouple_loss:0.0005364824319258332
loss_pred:0.01575896143913269, decouple_loss:0.000542124267667532
The modified gen p mean: 0.44801265001296997, gen p mean: -0.12862089276313782, mean p set: 0.44858577847480774
loss_pred:0.015316512435674667, decouple_loss:0.0005034809582866728
Iteration: 466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772714376449585, gen p mean: -0.12297162413597107, mean p set: 0.4483031630516052
loss_pred:0.015779834240674973, decouple_loss:0.0004047313123010099
The modified gen p mean: 0.44774502515792847, gen p mean: -0.1291707158088684, mean p set: 0.44831880927085876
loss_pred:0.015965662896633148, decouple_loss:0.00040335181984119117
The modified gen p mean: 0.4481246769428253, gen p mean: -0.1232529729604721, mean p set: 0.44870471954345703
loss_pred:0.015758484601974487, decouple_loss:0.0005435799830593169
Iteration: 467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785642623901367, gen p mean: -0.12818709015846252, mean p set: 0.4484356641769409
loss_pred:0.015559807419776917, decouple_loss:0.00048610824160277843
The modified gen p mean: 0.44713661074638367, gen p mean: -0.13266050815582275, mean p set: 0.447712779045105
loss_pred:0.015432841144502163, decouple_loss:0.00045612818212248385
The modified gen p mean: 0.4481504559516907, gen p mean: -0.12500092387199402, mean p set: 0.44872552156448364
loss_pred:0.015905920416116714, decouple_loss:0.00045833774493075907
Iteration: 468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869691133499146, gen p mean: -0.13059744238853455, mean p set: 0.44927188754081726
loss_pred:0.015094125643372536, decouple_loss:0.0007841124897822738
The modified gen p mean: 0.44765350222587585, gen p mean: -0.12583599984645844, mean p set: 0.44823122024536133
loss_pred:0.015716025605797768, decouple_loss:0.00043543672654777765
The modified gen p mean: 0.4478834867477417, gen p mean: -0.12696772813796997, mean p set: 0.44845762848854065
loss_pred:0.014759311452507973, decouple_loss:0.0005948019679635763
Iteration: 469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469089210033417, gen p mean: -0.13254521787166595, mean p set: 0.44748347997665405
loss_pred:0.015266850590705872, decouple_loss:0.0003596172318793833
The modified gen p mean: 0.4477163851261139, gen p mean: -0.13140936195850372, mean p set: 0.4482938349246979
loss_pred:0.01516543049365282, decouple_loss:0.0004027302493341267
The modified gen p mean: 0.44771313667297363, gen p mean: -0.13097144663333893, mean p set: 0.44829073548316956
loss_pred:0.015959864482283592, decouple_loss:0.0004141350509598851
Iteration: 470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801804423332214, gen p mean: -0.13204661011695862, mean p set: 0.4485968351364136
The modified gen p mean: 0.44862791895866394, gen p mean: -0.12975910305976868, mean p set: 0.44920313358306885
loss_pred:0.01496936846524477, decouple_loss:0.00041673218947835267
loss_pred:0.015190633945167065, decouple_loss:0.0004887871327809989
The modified gen p mean: 0.4462766945362091, gen p mean: -0.13153046369552612, mean p set: 0.44685330986976624
loss_pred:0.015423808246850967, decouple_loss:0.00039106328040361404
2023-05-02 04:40:22 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1318490356206894, mean p set: 0.4502691626548767
loss_pred:0.016910070553421974, decouple_loss:0.0005949493497610092
The modified gen p mean: 0.4495352506637573, gen p mean: -0.1258259266614914, mean p set: 0.4500633478164673
loss_pred:0.016189467161893845, decouple_loss:0.00048703342326916754
The modified gen p mean: 0.44982850551605225, gen p mean: -0.12514758110046387, mean p set: 0.45035696029663086
loss_pred:0.016664674505591393, decouple_loss:0.0004869374679401517
WV_1_PC_1_EH_0_PS_40, loss: 0.016614221036434174, avg_mse: 0.025910714641213417
current test mse: 0.025911
Iteration: 471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821301102638245, gen p mean: -0.1277896612882614, mean p set: 0.44878846406936646
loss_pred:0.014712408185005188, decouple_loss:0.0005928803002461791
The modified gen p mean: 0.4478246569633484, gen p mean: -0.126419797539711, mean p set: 0.44839873909950256The modified gen p mean: 0.4473585784435272, gen p mean: -0.1320069432258606, mean p set: 0.4479339122772217
loss_pred:0.015687763690948486, decouple_loss:0.0004831862752325833
loss_pred:0.015685852617025375, decouple_loss:0.0006113967392593622
Iteration: 472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474288523197174, gen p mean: -0.12753728032112122, mean p set: 0.44800689816474915
The modified gen p mean: 0.4482283294200897, gen p mean: -0.1288299411535263, mean p set: 0.4488029479980469
loss_pred:0.015306391753256321, decouple_loss:0.0005255885189399123
loss_pred:0.015006358735263348, decouple_loss:0.00046201134682632983
The modified gen p mean: 0.4464726746082306, gen p mean: -0.13071636855602264, mean p set: 0.4470512866973877
loss_pred:0.015373055823147297, decouple_loss:0.00045793646131642163
Iteration: 473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468279480934143, gen p mean: -0.13244929909706116, mean p set: 0.44740280508995056
loss_pred:0.01524368580430746, decouple_loss:0.0004513907479122281
The modified gen p mean: 0.4488108456134796, gen p mean: -0.12527437508106232, mean p set: 0.44938814640045166
loss_pred:0.015552492812275887, decouple_loss:0.00042479817057028413
The modified gen p mean: 0.44802701473236084, gen p mean: -0.1309458315372467, mean p set: 0.448603093624115
loss_pred:0.015317225828766823, decouple_loss:0.0005426168208941817
Iteration: 474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866299629211426, gen p mean: -0.12714418768882751, mean p set: 0.4492388963699341
loss_pred:0.015186610631644726, decouple_loss:0.0004153049667365849
The modified gen p mean: 0.4485395550727844, gen p mean: -0.1284419596195221, mean p set: 0.44911372661590576
loss_pred:0.015376325696706772, decouple_loss:0.00047370995162054896
The modified gen p mean: 0.4478723406791687, gen p mean: -0.12274320423603058, mean p set: 0.4484493136405945
loss_pred:0.014976290985941887, decouple_loss:0.0003789765469264239
Iteration: 475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781485199928284, gen p mean: -0.12711945176124573, mean p set: 0.4483935534954071
loss_pred:0.014829088002443314, decouple_loss:0.000456053065136075
The modified gen p mean: 0.4477360248565674, gen p mean: -0.12182831764221191, mean p set: 0.44831034541130066
loss_pred:0.015787024050951004, decouple_loss:0.0004754458204843104
The modified gen p mean: 0.44792866706848145, gen p mean: -0.12477385252714157, mean p set: 0.44850432872772217
loss_pred:0.014967476017773151, decouple_loss:0.00041058589704334736
Iteration: 476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476889371871948, gen p mean: -0.12164878100156784, mean p set: 0.4482678174972534
loss_pred:0.01524515263736248, decouple_loss:0.0004153006593696773
The modified gen p mean: 0.4472062289714813, gen p mean: -0.12632589042186737, mean p set: 0.4477825164794922
The modified gen p mean: 0.4481833875179291, gen p mean: -0.11737460643053055, mean p set: 0.4487583637237549
loss_pred:0.015471933409571648, decouple_loss:0.0005104161682538688
loss_pred:0.015368941240012646, decouple_loss:0.00047393530257977545
Iteration: 477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484359920024872, gen p mean: -0.11964649707078934, mean p set: 0.4490111172199249
The modified gen p mean: 0.4481182098388672, gen p mean: -0.11964064836502075, mean p set: 0.44869464635849
loss_pred:0.014709755778312683, decouple_loss:0.0004224094736855477
loss_pred:0.01531518530100584, decouple_loss:0.0004190421896055341
The modified gen p mean: 0.44731566309928894, gen p mean: -0.11872348189353943, mean p set: 0.447892427444458
loss_pred:0.01556679978966713, decouple_loss:0.0003906175261363387
Iteration: 478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775858521461487, gen p mean: -0.12049417197704315, mean p set: 0.448335200548172
loss_pred:0.014883657917380333, decouple_loss:0.0004610010946635157
The modified gen p mean: 0.44693490862846375, gen p mean: -0.12463144212961197, mean p set: 0.4475124180316925
The modified gen p mean: 0.44810950756073, gen p mean: -0.12073150277137756, mean p set: 0.4486865699291229
loss_pred:0.015313172712922096, decouple_loss:0.00040536606684327126
loss_pred:0.015189563855528831, decouple_loss:0.0004153113695792854
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
NaN value num: 0
Iteration: 479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45067712664604187, gen p mean: -0.11217645555734634, mean p set: 0.4512523412704468
The modified gen p mean: 0.45150768756866455, gen p mean: -0.11585405468940735, mean p set: 0.4520816504955292
loss_pred:0.016514623537659645, decouple_loss:0.0010924735106527805
loss_pred:0.01651954837143421, decouple_loss:0.0009537964942865074
The modified gen p mean: 0.4515674114227295, gen p mean: -0.11326301842927933, mean p set: 0.4521442651748657
loss_pred:0.016049301251769066, decouple_loss:0.0007331856759265065
Iteration: 480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45007947087287903, gen p mean: -0.10963920503854752, mean p set: 0.4506586492061615
loss_pred:0.015861855819821358, decouple_loss:0.0005639332230202854
The modified gen p mean: 0.45071572065353394, gen p mean: -0.1176222637295723, mean p set: 0.4512908160686493
loss_pred:0.01567976176738739, decouple_loss:0.0006397567922249436
The modified gen p mean: 0.4533006250858307, gen p mean: -0.11327753216028214, mean p set: 0.4538784623146057
loss_pred:0.015500286594033241, decouple_loss:0.0006734358612447977
2023-05-02 04:43:07 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12511958181858063, mean p set: 0.4502691626548767
loss_pred:0.01691354811191559, decouple_loss:0.0007569360313937068
The modified gen p mean: 0.44953539967536926, gen p mean: -0.11995190382003784, mean p set: 0.4500633478164673
loss_pred:0.01618390716612339, decouple_loss:0.0006968645029701293
The modified gen p mean: 0.44982850551605225, gen p mean: -0.11940105259418488, mean p set: 0.45035696029663086
loss_pred:0.016605094075202942, decouple_loss:0.0006049885414540768
WV_1_PC_1_EH_0_PS_40, loss: 0.01660183072090149, avg_mse: 0.02587146684527397
current test mse: 0.025871
Iteration: 481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45112934708595276, gen p mean: -0.11881234496831894, mean p set: 0.45170560479164124
loss_pred:0.015328011475503445, decouple_loss:0.0006548035889863968
The modified gen p mean: 0.4495214521884918, gen p mean: -0.11180176585912704, mean p set: 0.4500984251499176The modified gen p mean: 0.45173609256744385, gen p mean: -0.11692856252193451, mean p set: 0.4523128271102905
loss_pred:0.015876401215791702, decouple_loss:0.0007369389641098678loss_pred:0.016855526715517044, decouple_loss:0.0006351637421175838
Iteration: 482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513370990753174, gen p mean: -0.11863396316766739, mean p set: 0.4519124925136566
loss_pred:0.016788208857178688, decouple_loss:0.0008305590017698705
The modified gen p mean: 0.45150333642959595, gen p mean: -0.12056951969861984, mean p set: 0.4520820379257202The modified gen p mean: 0.4488803744316101, gen p mean: -0.11286613345146179, mean p set: 0.44945603609085083
loss_pred:0.01659071259200573, decouple_loss:0.0007274277159012854
loss_pred:0.01585131697356701, decouple_loss:0.0007136181811802089
Iteration: 483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45366328954696655, gen p mean: -0.11600317806005478, mean p set: 0.4542403817176819
loss_pred:0.016036372631788254, decouple_loss:0.0008691726834513247
The modified gen p mean: 0.44989317655563354, gen p mean: -0.1187710091471672, mean p set: 0.45046815276145935The modified gen p mean: 0.4517005383968353, gen p mean: -0.12328115850687027, mean p set: 0.45227286219596863
loss_pred:0.015561878681182861, decouple_loss:0.0006554083083756268
loss_pred:0.01593485288321972, decouple_loss:0.0009905061451718211
Iteration: 484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45292210578918457, gen p mean: -0.11853808164596558, mean p set: 0.45350101590156555
loss_pred:0.01619342342019081, decouple_loss:0.0005699836765415967
The modified gen p mean: 0.45006468892097473, gen p mean: -0.11580922454595566, mean p set: 0.4506395757198334
loss_pred:0.016170376911759377, decouple_loss:0.0006742683472111821
The modified gen p mean: 0.4495755434036255, gen p mean: -0.11248642206192017, mean p set: 0.4501498341560364
loss_pred:0.0155216408893466, decouple_loss:0.0005704147624783218
Iteration: 485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516383707523346, gen p mean: -0.11718153953552246, mean p set: 0.4522160291671753
loss_pred:0.016136813908815384, decouple_loss:0.0006438023410737514
The modified gen p mean: 0.44883981347084045, gen p mean: -0.11052054166793823, mean p set: 0.4494180977344513
loss_pred:0.015590041875839233, decouple_loss:0.0007688305922783911
The modified gen p mean: 0.4515905976295471, gen p mean: -0.12006861716508865, mean p set: 0.4521671235561371
loss_pred:0.015888793393969536, decouple_loss:0.0005624165059998631
Iteration: 486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511503279209137, gen p mean: -0.1143483892083168, mean p set: 0.45172688364982605
loss_pred:0.016844185069203377, decouple_loss:0.0006738862139172852
The modified gen p mean: 0.4531923234462738, gen p mean: -0.11584333330392838, mean p set: 0.45377078652381897
The modified gen p mean: 0.4508565664291382, gen p mean: -0.11392826586961746, mean p set: 0.45143604278564453
loss_pred:0.015263587236404419, decouple_loss:0.0006689727306365967
loss_pred:0.015644988045096397, decouple_loss:0.0006101038306951523
Iteration: 487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45031481981277466, gen p mean: -0.12008027732372284, mean p set: 0.45088884234428406
loss_pred:0.017059611156582832, decouple_loss:0.0006315773935057223
The modified gen p mean: 0.4512096345424652, gen p mean: -0.11521594971418381, mean p set: 0.4517892897129059
loss_pred:0.015562037006020546, decouple_loss:0.0005985379102639854
The modified gen p mean: 0.4517526924610138, gen p mean: -0.11371869593858719, mean p set: 0.4523266553878784
loss_pred:0.016137929633259773, decouple_loss:0.0005923060816712677
Iteration: 488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507344365119934, gen p mean: -0.12631911039352417, mean p set: 0.45130833983421326
loss_pred:0.01596655510365963, decouple_loss:0.0006780888070352376
The modified gen p mean: 0.4510873258113861, gen p mean: -0.12505820393562317, mean p set: 0.4516604542732239
loss_pred:0.01578676514327526, decouple_loss:0.0005310270935297012
The modified gen p mean: 0.4524334967136383, gen p mean: -0.11965911835432053, mean p set: 0.45301321148872375
loss_pred:0.016401270404458046, decouple_loss:0.0007307825144380331
Iteration: 489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048046112060547, gen p mean: -0.1344395875930786, mean p set: 0.4510558545589447
loss_pred:0.01675901561975479, decouple_loss:0.0005630049272440374
The modified gen p mean: 0.4518612325191498, gen p mean: -0.13151563704013824, mean p set: 0.4524403214454651
loss_pred:0.016062896698713303, decouple_loss:0.00047755890409462154
The modified gen p mean: 0.4526873230934143, gen p mean: -0.127301886677742, mean p set: 0.4532662332057953
loss_pred:0.015925591811537743, decouple_loss:0.0005308148683980107
Iteration: 490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516471326351166, gen p mean: -0.13315549492835999, mean p set: 0.4522245526313782
loss_pred:0.01595374010503292, decouple_loss:0.0006480721640400589
The modified gen p mean: 0.45244866609573364, gen p mean: -0.1314970850944519, mean p set: 0.4530283212661743
The modified gen p mean: 0.4514208734035492, gen p mean: -0.12743689119815826, mean p set: 0.4519975483417511
loss_pred:0.01569446176290512, decouple_loss:0.0007483350345864892
loss_pred:0.015632670372724533, decouple_loss:0.0009387909667566419
2023-05-02 04:45:13 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.14113394916057587, mean p set: 0.4502691626548767
loss_pred:0.017073873430490494, decouple_loss:0.0006526120123453438
The modified gen p mean: 0.4495335519313812, gen p mean: -0.13613224029541016, mean p set: 0.4500633478164673
loss_pred:0.016385823488235474, decouple_loss:0.0006892501842230558
The modified gen p mean: 0.44982805848121643, gen p mean: -0.13517363369464874, mean p set: 0.45035696029663086
loss_pred:0.016785109415650368, decouple_loss:0.0008039525127969682
WV_1_PC_1_EH_0_PS_40, loss: 0.016784032806754112, avg_mse: 0.0261667612940073
current test mse: 0.026167
Iteration: 491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114269852638245, gen p mean: -0.13450022041797638, mean p set: 0.4517205059528351
loss_pred:0.016424203291535378, decouple_loss:0.0005486338050104678
The modified gen p mean: 0.45137715339660645, gen p mean: -0.1298711597919464, mean p set: 0.45195385813713074
loss_pred:0.016468258574604988, decouple_loss:0.000565009715501219
The modified gen p mean: 0.4517836570739746, gen p mean: -0.1313033550977707, mean p set: 0.4523616135120392
loss_pred:0.016170570626854897, decouple_loss:0.0006893457029946148
Iteration: 492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45181000232696533, gen p mean: -0.12980718910694122, mean p set: 0.452386736869812
loss_pred:0.01664469949901104, decouple_loss:0.0007371905376203358
The modified gen p mean: 0.4516009986400604, gen p mean: -0.13675649464130402, mean p set: 0.45217666029930115The modified gen p mean: 0.45088765025138855, gen p mean: -0.1321447640657425, mean p set: 0.4514661431312561
loss_pred:0.015721943229436874, decouple_loss:0.0010708740446716547
loss_pred:0.01592068187892437, decouple_loss:0.0006385858869180083
Iteration: 493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517723619937897, gen p mean: -0.13257430493831635, mean p set: 0.452349454164505
loss_pred:0.015485848300158978, decouple_loss:0.0007105819531716406
The modified gen p mean: 0.4519333839416504, gen p mean: -0.13139031827449799, mean p set: 0.4525096118450165
loss_pred:0.015706181526184082, decouple_loss:0.0007973375031724572
The modified gen p mean: 0.4512464702129364, gen p mean: -0.13051728904247284, mean p set: 0.4518203139305115
loss_pred:0.016157448291778564, decouple_loss:0.0006361104897223413
Iteration: 494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45275142788887024, gen p mean: -0.13388969004154205, mean p set: 0.4533267617225647
loss_pred:0.015429075807332993, decouple_loss:0.0004671938659157604
The modified gen p mean: 0.45104002952575684, gen p mean: -0.1341732144355774, mean p set: 0.4516153931617737
loss_pred:0.01630556769669056, decouple_loss:0.0005322072538547218
The modified gen p mean: 0.4538663327693939, gen p mean: -0.1284780204296112, mean p set: 0.4544433653354645
loss_pred:0.016446586698293686, decouple_loss:0.0005171439843252301
Iteration: 495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45260459184646606, gen p mean: -0.12974843382835388, mean p set: 0.45318397879600525
loss_pred:0.015888020396232605, decouple_loss:0.0004904481465928257
The modified gen p mean: 0.45140203833580017, gen p mean: -0.13083970546722412, mean p set: 0.4519789516925812
loss_pred:0.016392847523093224, decouple_loss:0.0006109632668085396
The modified gen p mean: 0.4509936571121216, gen p mean: -0.1294645220041275, mean p set: 0.4515700936317444
loss_pred:0.015453023836016655, decouple_loss:0.0005391204031184316
Iteration: 496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45127415657043457, gen p mean: -0.13484716415405273, mean p set: 0.4518510699272156
loss_pred:0.01642567478120327, decouple_loss:0.0005200491286814213
The modified gen p mean: 0.44989457726478577, gen p mean: -0.1312495917081833, mean p set: 0.45047152042388916
loss_pred:0.015015942044556141, decouple_loss:0.0006353018688969314
The modified gen p mean: 0.45194077491760254, gen p mean: -0.1300254464149475, mean p set: 0.4525170624256134
loss_pred:0.016073880717158318, decouple_loss:0.0005144381430000067
Iteration: 497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504410922527313, gen p mean: -0.12225093692541122, mean p set: 0.451017826795578
loss_pred:0.015538880601525307, decouple_loss:0.0006608468247577548
The modified gen p mean: 0.45244771242141724, gen p mean: -0.1268290877342224, mean p set: 0.4530230164527893
loss_pred:0.015523551031947136, decouple_loss:0.0005654101842083037
The modified gen p mean: 0.45198795199394226, gen p mean: -0.12260821461677551, mean p set: 0.4525661766529083
loss_pred:0.016175055876374245, decouple_loss:0.0008097525569610298
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
NaN value num: 0
Iteration: 498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492396116256714, gen p mean: -0.12533524632453918, mean p set: 0.4498175084590912The modified gen p mean: 0.448655366897583, gen p mean: -0.12744252383708954, mean p set: 0.4492338001728058
loss_pred:0.015489820390939713, decouple_loss:0.00048742775106802583loss_pred:0.015208089724183083, decouple_loss:0.000448932551080361
The modified gen p mean: 0.44769635796546936, gen p mean: -0.1189473420381546, mean p set: 0.44827306270599365
loss_pred:0.014997732825577259, decouple_loss:0.0005165153997950256
Iteration: 499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488864541053772, gen p mean: -0.11756961792707443, mean p set: 0.4494599997997284
loss_pred:0.015011800453066826, decouple_loss:0.0005518218968063593
The modified gen p mean: 0.4497727155685425, gen p mean: -0.12015463411808014, mean p set: 0.45034751296043396
loss_pred:0.015514591708779335, decouple_loss:0.0005116747925058007
The modified gen p mean: 0.4504055082798004, gen p mean: -0.1201641783118248, mean p set: 0.45098215341567993
loss_pred:0.01561095379292965, decouple_loss:0.0005057535599917173
Iteration: 500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484720826148987, gen p mean: -0.11587225645780563, mean p set: 0.44904738664627075
loss_pred:0.01526925154030323, decouple_loss:0.0005446747527457774
The modified gen p mean: 0.4489801824092865, gen p mean: -0.1150389090180397, mean p set: 0.44955530762672424
loss_pred:0.0151097746565938, decouple_loss:0.0006445483886636794
The modified gen p mean: 0.449414998292923, gen p mean: -0.11744822561740875, mean p set: 0.44999101758003235
loss_pred:0.01537321973592043, decouple_loss:0.0005494304932653904
2023-05-02 04:47:59 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12797600030899048, mean p set: 0.4502691626548767
loss_pred:0.017043156549334526, decouple_loss:0.0005488820024766028
The modified gen p mean: 0.44953474402427673, gen p mean: -0.1222255676984787, mean p set: 0.4500633478164673
loss_pred:0.016399122774600983, decouple_loss:0.0006654465105384588
The modified gen p mean: 0.44982805848121643, gen p mean: -0.12125656008720398, mean p set: 0.45035696029663086
loss_pred:0.01672864891588688, decouple_loss:0.0006408591871149838
WV_1_PC_1_EH_0_PS_40, loss: 0.01675456389784813, avg_mse: 0.026065684854984283
current test mse: 0.026066
Iteration: 501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722461700439453, gen p mean: -0.11282122135162354, mean p set: 0.44780394434928894
loss_pred:0.014745360240340233, decouple_loss:0.0006150639383122325
The modified gen p mean: 0.4510965943336487, gen p mean: -0.1142868623137474, mean p set: 0.45167189836502075The modified gen p mean: 0.45037350058555603, gen p mean: -0.11583932489156723, mean p set: 0.4509481191635132
loss_pred:0.014624996110796928, decouple_loss:0.0005986896576359868loss_pred:0.015070836991071701, decouple_loss:0.00042384606786072254
Iteration: 502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502839744091034, gen p mean: -0.11985313892364502, mean p set: 0.45086273550987244
loss_pred:0.015049445442855358, decouple_loss:0.000465771765448153
The modified gen p mean: 0.44845327734947205, gen p mean: -0.11998514086008072, mean p set: 0.44903048872947693
The modified gen p mean: 0.45000576972961426, gen p mean: -0.1145094782114029, mean p set: 0.4505808651447296
loss_pred:0.01582982949912548, decouple_loss:0.00047555819037370384
loss_pred:0.014987049624323845, decouple_loss:0.0004707953194156289
Iteration: 503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493716359138489, gen p mean: -0.11548641324043274, mean p set: 0.44994959235191345
loss_pred:0.014987464994192123, decouple_loss:0.0005172794335521758
The modified gen p mean: 0.4483247697353363, gen p mean: -0.11428405344486237, mean p set: 0.44889989495277405
loss_pred:0.01512719877064228, decouple_loss:0.0004949052818119526
The modified gen p mean: 0.4485660493373871, gen p mean: -0.11466331034898758, mean p set: 0.4491414725780487
loss_pred:0.01526680774986744, decouple_loss:0.00047925187391228974
Iteration: 504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996345043182373, gen p mean: -0.11718621850013733, mean p set: 0.4505395293235779
loss_pred:0.015999216586351395, decouple_loss:0.0005367929697968066
The modified gen p mean: 0.44827136397361755, gen p mean: -0.1150071769952774, mean p set: 0.4488454759120941
loss_pred:0.015188571996986866, decouple_loss:0.0004361481696832925
The modified gen p mean: 0.4487893283367157, gen p mean: -0.11901858448982239, mean p set: 0.44936615228652954
loss_pred:0.01489227544516325, decouple_loss:0.00045324451639316976
Iteration: 505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803473353385925, gen p mean: -0.11807272583246231, mean p set: 0.44861045479774475
loss_pred:0.015226769261062145, decouple_loss:0.00046024727635085583
The modified gen p mean: 0.45013660192489624, gen p mean: -0.1109817624092102, mean p set: 0.4507155418395996
loss_pred:0.014912141487002373, decouple_loss:0.0004170795145910233
The modified gen p mean: 0.4486863613128662, gen p mean: -0.11552530527114868, mean p set: 0.4492644667625427
loss_pred:0.01462318655103445, decouple_loss:0.0004724461759906262
Iteration: 506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45006871223449707, gen p mean: -0.1142236590385437, mean p set: 0.45064541697502136
loss_pred:0.015607261098921299, decouple_loss:0.0005350152496248484
The modified gen p mean: 0.44824519753456116, gen p mean: -0.1164223924279213, mean p set: 0.4488237500190735
The modified gen p mean: 0.44756388664245605, gen p mean: -0.1168370246887207, mean p set: 0.4481392800807953
loss_pred:0.015525027178227901, decouple_loss:0.00045573394163511693
loss_pred:0.014998170547187328, decouple_loss:0.0005422527901828289
Iteration: 507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992518424987793, gen p mean: -0.11720003932714462, mean p set: 0.4505022168159485
loss_pred:0.014974627643823624, decouple_loss:0.00039017945528030396
The modified gen p mean: 0.449211061000824, gen p mean: -0.12092945724725723, mean p set: 0.44978684186935425
loss_pred:0.014815598726272583, decouple_loss:0.000681991979945451
The modified gen p mean: 0.4480333924293518, gen p mean: -0.11635318398475647, mean p set: 0.44860953092575073
loss_pred:0.015036508440971375, decouple_loss:0.0005718396278098226
Iteration: 508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498952031135559, gen p mean: -0.11714141815900803, mean p set: 0.4504702091217041
loss_pred:0.01523117907345295, decouple_loss:0.000455979403341189
The modified gen p mean: 0.44873449206352234, gen p mean: -0.1203598752617836, mean p set: 0.4493105113506317
loss_pred:0.015368356369435787, decouple_loss:0.00043859556899406016
The modified gen p mean: 0.44939541816711426, gen p mean: -0.11826752871274948, mean p set: 0.4499700367450714
loss_pred:0.015312561765313148, decouple_loss:0.00044862806680612266
Iteration: 509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491578936576843, gen p mean: -0.1217576265335083, mean p set: 0.4497326612472534
loss_pred:0.015831245109438896, decouple_loss:0.0005426545394584537
The modified gen p mean: 0.4499080777168274, gen p mean: -0.12070395052433014, mean p set: 0.45048466324806213
loss_pred:0.014452419243752956, decouple_loss:0.000537614687345922
The modified gen p mean: 0.4490003287792206, gen p mean: -0.1183781549334526, mean p set: 0.4495784640312195
loss_pred:0.01539627742022276, decouple_loss:0.0004650344781111926
Iteration: 510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449171781539917, gen p mean: -0.12090010195970535, mean p set: 0.4497472941875458
loss_pred:0.014935036189854145, decouple_loss:0.00044336082646623254
The modified gen p mean: 0.450860857963562, gen p mean: -0.11919558793306351, mean p set: 0.4514385461807251
loss_pred:0.015133482404053211, decouple_loss:0.0005296364543028176
The modified gen p mean: 0.4503327012062073, gen p mean: -0.11551126092672348, mean p set: 0.4509085714817047
loss_pred:0.01478563528507948, decouple_loss:0.00042287385440431535
2023-05-02 04:50:06 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1273990422487259, mean p set: 0.4502691626548767
loss_pred:0.016992580145597458, decouple_loss:0.0005037965020164847
The modified gen p mean: 0.4495353698730469, gen p mean: -0.12209789454936981, mean p set: 0.4500633478164673
loss_pred:0.016384441405534744, decouple_loss:0.0005486037116497755
The modified gen p mean: 0.4498305022716522, gen p mean: -0.1215912401676178, mean p set: 0.45035696029663086
loss_pred:0.016698937863111496, decouple_loss:0.0005584758473560214
WV_1_PC_1_EH_0_PS_40, loss: 0.01671883463859558, avg_mse: 0.026043327525258064
current test mse: 0.026043
Iteration: 511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493599832057953, gen p mean: -0.11221173405647278, mean p set: 0.4499356150627136
loss_pred:0.01508205384016037, decouple_loss:0.0005355116445571184
The modified gen p mean: 0.44864585995674133, gen p mean: -0.11641573905944824, mean p set: 0.4492228329181671
loss_pred:0.015032786875963211, decouple_loss:0.0005276237498037517
The modified gen p mean: 0.45063650608062744, gen p mean: -0.11568976193666458, mean p set: 0.45121368765830994
loss_pred:0.01401613187044859, decouple_loss:0.0006030492368154228
Iteration: 512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500998258590698, gen p mean: -0.11797261238098145, mean p set: 0.4506763517856598
loss_pred:0.014990759082138538, decouple_loss:0.0006195391761139035
The modified gen p mean: 0.4492703974246979, gen p mean: -0.11918438225984573, mean p set: 0.44984734058380127The modified gen p mean: 0.4485093057155609, gen p mean: -0.11905091255903244, mean p set: 0.4490853548049927
loss_pred:0.01538628339767456, decouple_loss:0.0008178268908523023
loss_pred:0.014800788834691048, decouple_loss:0.00047283811727538705
Iteration: 513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829702377319336, gen p mean: -0.11179506033658981, mean p set: 0.4488722085952759
loss_pred:0.015246565453708172, decouple_loss:0.0005727151874452829
The modified gen p mean: 0.44819003343582153, gen p mean: -0.11825133115053177, mean p set: 0.44876495003700256
loss_pred:0.014671893790364265, decouple_loss:0.00042321888031437993
The modified gen p mean: 0.45020630955696106, gen p mean: -0.11901990324258804, mean p set: 0.45078325271606445
loss_pred:0.014486262574791908, decouple_loss:0.0006215741741470993
Iteration: 514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492584466934204, gen p mean: -0.11311575025320053, mean p set: 0.44983452558517456
loss_pred:0.015161332674324512, decouple_loss:0.00045902319834567606
The modified gen p mean: 0.44964873790740967, gen p mean: -0.11907942593097687, mean p set: 0.450225830078125
loss_pred:0.015867751091718674, decouple_loss:0.0006089565576985478
The modified gen p mean: 0.4478704631328583, gen p mean: -0.11728295683860779, mean p set: 0.4484439492225647
loss_pred:0.015084372833371162, decouple_loss:0.0005764031084254384
Iteration: 515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45009031891822815, gen p mean: -0.11121660470962524, mean p set: 0.4506658911705017
loss_pred:0.014624278992414474, decouple_loss:0.0004681456775870174
The modified gen p mean: 0.44908466935157776, gen p mean: -0.11562439054250717, mean p set: 0.4496622681617737
loss_pred:0.014592793770134449, decouple_loss:0.0004666227614507079
The modified gen p mean: 0.4483003616333008, gen p mean: -0.11418073624372482, mean p set: 0.44887450337409973
loss_pred:0.014418743550777435, decouple_loss:0.0005300110206007957
Iteration: 516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45035800337791443, gen p mean: -0.11567703634500504, mean p set: 0.45093539357185364
loss_pred:0.01545707043260336, decouple_loss:0.0004903620574623346
The modified gen p mean: 0.44941794872283936, gen p mean: -0.11225692182779312, mean p set: 0.44999319314956665
The modified gen p mean: 0.44864141941070557, gen p mean: -0.11233334243297577, mean p set: 0.44921573996543884
loss_pred:0.015172034502029419, decouple_loss:0.00037461292231455445
loss_pred:0.014101720415055752, decouple_loss:0.0005010277382098138
Iteration: 517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45079323649406433, gen p mean: -0.11831329762935638, mean p set: 0.45137009024620056
loss_pred:0.013618189841508865, decouple_loss:0.0004878312174696475
The modified gen p mean: 0.44996196031570435, gen p mean: -0.11633370071649551, mean p set: 0.4505380690097809
loss_pred:0.01481402013450861, decouple_loss:0.0005770784919150174
The modified gen p mean: 0.4484173655509949, gen p mean: -0.11813872307538986, mean p set: 0.44899222254753113
loss_pred:0.013842561282217503, decouple_loss:0.0003882401797454804
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
NaN value num: 0
Iteration: 518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478018283843994, gen p mean: -0.1273449957370758, mean p set: 0.44837686419487
The modified gen p mean: 0.4462227523326874, gen p mean: -0.1319727748632431, mean p set: 0.4467964172363281
loss_pred:0.01684320531785488, decouple_loss:0.0006116483709774911
loss_pred:0.01621966063976288, decouple_loss:0.0004966080305166543
The modified gen p mean: 0.4472081959247589, gen p mean: -0.12784789502620697, mean p set: 0.44778236746788025
loss_pred:0.01654786802828312, decouple_loss:0.0005918454844504595
Iteration: 519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476160705089569, gen p mean: -0.13628807663917542, mean p set: 0.44819125533103943
loss_pred:0.01543239876627922, decouple_loss:0.0005385092808865011
The modified gen p mean: 0.4485304653644562, gen p mean: -0.13205194473266602, mean p set: 0.44910722970962524
loss_pred:0.016347479075193405, decouple_loss:0.0005499149556271732
The modified gen p mean: 0.4468822479248047, gen p mean: -0.13460424542427063, mean p set: 0.4474595785140991
loss_pred:0.01565430499613285, decouple_loss:0.0005048230523243546
Iteration: 520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44650426506996155, gen p mean: -0.13250812888145447, mean p set: 0.4470786452293396
loss_pred:0.01642114296555519, decouple_loss:0.0003970462712459266
The modified gen p mean: 0.44850456714630127, gen p mean: -0.12774839997291565, mean p set: 0.44908249378204346
loss_pred:0.016156118363142014, decouple_loss:0.0005548706976696849
The modified gen p mean: 0.4494406282901764, gen p mean: -0.13098281621932983, mean p set: 0.4500185549259186
loss_pred:0.016128068789839745, decouple_loss:0.0005570743232965469
2023-05-02 04:52:54 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13431377708911896, mean p set: 0.4502691626548767
loss_pred:0.016856398433446884, decouple_loss:0.0004967677523382008
The modified gen p mean: 0.44953569769859314, gen p mean: -0.12878039479255676, mean p set: 0.4500633478164673
loss_pred:0.01630828157067299, decouple_loss:0.0006602135254070163
The modified gen p mean: 0.449828177690506, gen p mean: -0.12788453698158264, mean p set: 0.45035696029663086
loss_pred:0.016589906066656113, decouple_loss:0.0006410895148292184
WV_1_PC_1_EH_0_PS_40, loss: 0.016614830121397972, avg_mse: 0.025890210643410683
current test mse: 0.02589
Iteration: 521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478153586387634, gen p mean: -0.1291997730731964, mean p set: 0.448391854763031
loss_pred:0.016673797741532326, decouple_loss:0.000448021077318117
The modified gen p mean: 0.44677963852882385, gen p mean: -0.1326158195734024, mean p set: 0.4473554790019989
loss_pred:0.01589580439031124, decouple_loss:0.0004898129845969379
The modified gen p mean: 0.4477149248123169, gen p mean: -0.12725186347961426, mean p set: 0.4482884109020233
loss_pred:0.01586919091641903, decouple_loss:0.0005807949346490204
Iteration: 522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474971294403076, gen p mean: -0.12733148038387299, mean p set: 0.4480714499950409
loss_pred:0.016158677637577057, decouple_loss:0.00040544543298892677
The modified gen p mean: 0.44625207781791687, gen p mean: -0.13133248686790466, mean p set: 0.44682982563972473The modified gen p mean: 0.44645774364471436, gen p mean: -0.1283528059720993, mean p set: 0.4470323920249939
loss_pred:0.015105731785297394, decouple_loss:0.0004498446360230446loss_pred:0.01672917790710926, decouple_loss:0.0004779337323270738
Iteration: 523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467545449733734, gen p mean: -0.12773805856704712, mean p set: 0.4473304748535156
loss_pred:0.01626516878604889, decouple_loss:0.0005297652678564191
The modified gen p mean: 0.44780388474464417, gen p mean: -0.13002626597881317, mean p set: 0.4483780562877655The modified gen p mean: 0.4468064606189728, gen p mean: -0.13214822113513947, mean p set: 0.447386234998703
loss_pred:0.015884527936577797, decouple_loss:0.0004412712878547609
loss_pred:0.015751315280795097, decouple_loss:0.000447905040346086
Iteration: 524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472852647304535, gen p mean: -0.13075175881385803, mean p set: 0.44786348938941956
loss_pred:0.016011083498597145, decouple_loss:0.0004222489951644093
The modified gen p mean: 0.4474003314971924, gen p mean: -0.12990427017211914, mean p set: 0.4479750096797943
loss_pred:0.016872648149728775, decouple_loss:0.0004098671197425574
The modified gen p mean: 0.4478790760040283, gen p mean: -0.13093768060207367, mean p set: 0.4484540522098541
loss_pred:0.01577870547771454, decouple_loss:0.0005255553987808526
Iteration: 525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478643238544464, gen p mean: -0.12846967577934265, mean p set: 0.44843971729278564
loss_pred:0.015878869220614433, decouple_loss:0.0004043245280627161
The modified gen p mean: 0.4478389024734497, gen p mean: -0.1282467544078827, mean p set: 0.44841399788856506
loss_pred:0.01656283438205719, decouple_loss:0.000560175918508321
The modified gen p mean: 0.4479723274707794, gen p mean: -0.1347113400697708, mean p set: 0.4485495090484619
loss_pred:0.016719410195946693, decouple_loss:0.0005104673909954727
Iteration: 526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759097695350647, gen p mean: -0.13157829642295837, mean p set: 0.44816598296165466
loss_pred:0.01713467948138714, decouple_loss:0.0006598274339921772
The modified gen p mean: 0.4462297260761261, gen p mean: -0.13610447943210602, mean p set: 0.4468069076538086
loss_pred:0.015525260008871555, decouple_loss:0.0005314864683896303
The modified gen p mean: 0.44741562008857727, gen p mean: -0.13607493042945862, mean p set: 0.447992742061615
loss_pred:0.016805877909064293, decouple_loss:0.0004951352020725608
Iteration: 527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469663202762604, gen p mean: -0.12884996831417084, mean p set: 0.44754326343536377
loss_pred:0.016540754586458206, decouple_loss:0.0004900064086541533
The modified gen p mean: 0.44768625497817993, gen p mean: -0.12808039784431458, mean p set: 0.4482615292072296
loss_pred:0.016323568299412727, decouple_loss:0.0006274411571212113
The modified gen p mean: 0.4468550384044647, gen p mean: -0.12901823222637177, mean p set: 0.44743403792381287
loss_pred:0.016835486516356468, decouple_loss:0.00045950483763590455
Iteration: 528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766584038734436, gen p mean: -0.12567682564258575, mean p set: 0.4482417702674866
loss_pred:0.016135696321725845, decouple_loss:0.0005038590752519667
The modified gen p mean: 0.4465295672416687, gen p mean: -0.1330323964357376, mean p set: 0.447104811668396
loss_pred:0.015450681559741497, decouple_loss:0.0005390089936554432
The modified gen p mean: 0.4466024935245514, gen p mean: -0.1270216405391693, mean p set: 0.44717806577682495
loss_pred:0.01646903157234192, decouple_loss:0.0003933112311642617
Iteration: 529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468747675418854, gen p mean: -0.12258408218622208, mean p set: 0.44745010137557983
loss_pred:0.016966070979833603, decouple_loss:0.0005270589608699083
The modified gen p mean: 0.4474796652793884, gen p mean: -0.12875095009803772, mean p set: 0.44805458188056946
loss_pred:0.015229612588882446, decouple_loss:0.00045634061098098755
The modified gen p mean: 0.44717422127723694, gen p mean: -0.12458789348602295, mean p set: 0.4477509558200836
loss_pred:0.017160844057798386, decouple_loss:0.0007029692060314119
Iteration: 530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490019381046295, gen p mean: -0.12532678246498108, mean p set: 0.4495777189731598
loss_pred:0.016270704567432404, decouple_loss:0.0005861231475137174
The modified gen p mean: 0.44668108224868774, gen p mean: -0.12616053223609924, mean p set: 0.4472576081752777
loss_pred:0.015839187428355217, decouple_loss:0.0004473789012990892
The modified gen p mean: 0.4468933045864105, gen p mean: -0.11835236102342606, mean p set: 0.4474692642688751
loss_pred:0.016775120049715042, decouple_loss:0.00048012982006184757
2023-05-02 04:55:00 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1304284930229187, mean p set: 0.4502691626548767
loss_pred:0.01692073978483677, decouple_loss:0.0005419218796305358
The modified gen p mean: 0.44953399896621704, gen p mean: -0.1248212605714798, mean p set: 0.4500633478164673
loss_pred:0.016293291002511978, decouple_loss:0.0005278945318423212
The modified gen p mean: 0.4498256742954254, gen p mean: -0.12441018223762512, mean p set: 0.45035696029663086
loss_pred:0.01665165089070797, decouple_loss:0.0005402491660788655
WV_1_PC_1_EH_0_PS_40, loss: 0.016648728400468826, avg_mse: 0.025960542261600494
current test mse: 0.025961
Iteration: 531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678354263305664, gen p mean: -0.1325402557849884, mean p set: 0.4473590552806854
loss_pred:0.015649180859327316, decouple_loss:0.00047291224473156035
The modified gen p mean: 0.4478533864021301, gen p mean: -0.13073371350765228, mean p set: 0.4484272003173828
loss_pred:0.01650361716747284, decouple_loss:0.00048451439943164587
The modified gen p mean: 0.44651293754577637, gen p mean: -0.12473674863576889, mean p set: 0.44709256291389465
loss_pred:0.016287630423903465, decouple_loss:0.00046756980009377003
Iteration: 532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464111626148224, gen p mean: -0.12956587970256805, mean p set: 0.4469875395298004
loss_pred:0.016321539878845215, decouple_loss:0.0005834117764607072
The modified gen p mean: 0.4491676688194275, gen p mean: -0.12795330584049225, mean p set: 0.44974398612976074The modified gen p mean: 0.44793322682380676, gen p mean: -0.12970589101314545, mean p set: 0.4485093653202057
loss_pred:0.015476517379283905, decouple_loss:0.0004894636804237962
loss_pred:0.01676391065120697, decouple_loss:0.0004874313890468329
Iteration: 533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753754138946533, gen p mean: -0.12674331665039062, mean p set: 0.44811463356018066
loss_pred:0.01689235121011734, decouple_loss:0.0005558269913308322
The modified gen p mean: 0.44753989577293396, gen p mean: -0.1286526322364807, mean p set: 0.448116660118103The modified gen p mean: 0.4473693072795868, gen p mean: -0.1335788071155548, mean p set: 0.4479442238807678
loss_pred:0.01726660318672657, decouple_loss:0.0005460398970171809
loss_pred:0.016090191900730133, decouple_loss:0.0004245715099386871
Iteration: 534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468538463115692, gen p mean: -0.13274160027503967, mean p set: 0.4474305510520935
loss_pred:0.016484778374433517, decouple_loss:0.0005398307694122195
The modified gen p mean: 0.44782814383506775, gen p mean: -0.12833309173583984, mean p set: 0.4484054148197174
loss_pred:0.016611890867352486, decouple_loss:0.0005402597598731518
The modified gen p mean: 0.4487736225128174, gen p mean: -0.13436605036258698, mean p set: 0.44934606552124023
loss_pred:0.016343623399734497, decouple_loss:0.0005619997973553836
Iteration: 535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849440455436707, gen p mean: -0.13223053514957428, mean p set: 0.44907209277153015
loss_pred:0.01643574982881546, decouple_loss:0.0004420263576321304
The modified gen p mean: 0.44731664657592773, gen p mean: -0.13020002841949463, mean p set: 0.4478928744792938
loss_pred:0.016820140182971954, decouple_loss:0.0004180102259851992
The modified gen p mean: 0.4484059810638428, gen p mean: -0.13243848085403442, mean p set: 0.4489823877811432
loss_pred:0.015905117616057396, decouple_loss:0.00044731254456564784
Iteration: 536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982871413230896, gen p mean: -0.13320131599903107, mean p set: 0.45040658116340637
loss_pred:0.01562182605266571, decouple_loss:0.0006494796252809465
The modified gen p mean: 0.44619855284690857, gen p mean: -0.13214898109436035, mean p set: 0.446774959564209
The modified gen p mean: 0.4475465416908264, gen p mean: -0.13671639561653137, mean p set: 0.4481232166290283
loss_pred:0.016315896064043045, decouple_loss:0.0005432577454484999
loss_pred:0.015477310866117477, decouple_loss:0.0007495135650970042
Iteration: 537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448562353849411, gen p mean: -0.1332390308380127, mean p set: 0.44914042949676514
The modified gen p mean: 0.4467495083808899, gen p mean: -0.1357608139514923, mean p set: 0.44732505083084106
loss_pred:0.016491828486323357, decouple_loss:0.0004092525050509721
loss_pred:0.01599077135324478, decouple_loss:0.00044840664486400783
The modified gen p mean: 0.44713374972343445, gen p mean: -0.13573239743709564, mean p set: 0.44770732522010803
loss_pred:0.015361012890934944, decouple_loss:0.0004954205360263586
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482981264591217, gen p mean: -0.13310903310775757, mean p set: 0.4488733410835266
loss_pred:0.01552528329193592, decouple_loss:0.0006289865705184639
The modified gen p mean: 0.44787925481796265, gen p mean: -0.12785059213638306, mean p set: 0.4484536051750183
The modified gen p mean: 0.44806739687919617, gen p mean: -0.12348416447639465, mean p set: 0.4486406445503235
loss_pred:0.015804367139935493, decouple_loss:0.0005130232311785221
loss_pred:0.015822481364011765, decouple_loss:0.0006286717252805829
Iteration: 539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810017943382263, gen p mean: -0.13362371921539307, mean p set: 0.4486761689186096
loss_pred:0.015479558147490025, decouple_loss:0.0004580882377922535
The modified gen p mean: 0.44745585322380066, gen p mean: -0.12202595174312592, mean p set: 0.4480302929878235
loss_pred:0.015490077435970306, decouple_loss:0.0005698243039660156
The modified gen p mean: 0.4486713409423828, gen p mean: -0.13153959810733795, mean p set: 0.44925159215927124
loss_pred:0.015141562558710575, decouple_loss:0.0005229224916547537
Iteration: 540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889697432518005, gen p mean: -0.13177961111068726, mean p set: 0.4494735598564148
loss_pred:0.015337605029344559, decouple_loss:0.0006571151898242533
The modified gen p mean: 0.4476950466632843, gen p mean: -0.1269521564245224, mean p set: 0.4482733905315399
The modified gen p mean: 0.4489600658416748, gen p mean: -0.1316937506198883, mean p set: 0.4495360851287842
loss_pred:0.015598324127495289, decouple_loss:0.0004823329800274223
loss_pred:0.015542439185082912, decouple_loss:0.00046658123028464615
2023-05-02 04:57:48 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13117533922195435, mean p set: 0.4502691626548767
loss_pred:0.01686784066259861, decouple_loss:0.0005801828228868544
The modified gen p mean: 0.44953858852386475, gen p mean: -0.12539435923099518, mean p set: 0.4500633478164673
loss_pred:0.016291113570332527, decouple_loss:0.0005741521017625928
The modified gen p mean: 0.44982823729515076, gen p mean: -0.12493149191141129, mean p set: 0.45035696029663086
loss_pred:0.01656094193458557, decouple_loss:0.0005939374677836895
WV_1_PC_1_EH_0_PS_40, loss: 0.01660243794322014, avg_mse: 0.025942686945199966
current test mse: 0.025943
Iteration: 541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886016845703125, gen p mean: -0.12385106086730957, mean p set: 0.4494384229183197
loss_pred:0.014722024090588093, decouple_loss:0.0004950236761942506
The modified gen p mean: 0.44791656732559204, gen p mean: -0.12031875550746918, mean p set: 0.448492169380188The modified gen p mean: 0.4483630657196045, gen p mean: -0.1265273094177246, mean p set: 0.4489397704601288
loss_pred:0.01558285765349865, decouple_loss:0.0005778000922873616
loss_pred:0.014780464582145214, decouple_loss:0.0005225873901508749
Iteration: 542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943273067474365, gen p mean: -0.1337423473596573, mean p set: 0.4500062167644501
loss_pred:0.015225931070744991, decouple_loss:0.00048100424464792013
The modified gen p mean: 0.44906193017959595, gen p mean: -0.12600627541542053, mean p set: 0.4496358335018158The modified gen p mean: 0.44938740134239197, gen p mean: -0.12742400169372559, mean p set: 0.4499637186527252
loss_pred:0.015412906184792519, decouple_loss:0.0005998583510518074
loss_pred:0.015088606625795364, decouple_loss:0.0006310921162366867
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784751534461975, gen p mean: -0.12030650675296783, mean p set: 0.4484219551086426
loss_pred:0.01513600442558527, decouple_loss:0.000367215572623536
The modified gen p mean: 0.4493761658668518, gen p mean: -0.12376794964075089, mean p set: 0.4499538242816925
loss_pred:0.015225106850266457, decouple_loss:0.0004188734164927155
The modified gen p mean: 0.4477255940437317, gen p mean: -0.1266086995601654, mean p set: 0.4483001232147217
loss_pred:0.015518981963396072, decouple_loss:0.0003916736750397831
Iteration: 544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447793185710907, gen p mean: -0.1273094266653061, mean p set: 0.44836896657943726
loss_pred:0.015888985246419907, decouple_loss:0.000488382822368294
The modified gen p mean: 0.44894111156463623, gen p mean: -0.1309693604707718, mean p set: 0.44951972365379333
loss_pred:0.01491796225309372, decouple_loss:0.0005792897427454591
The modified gen p mean: 0.44906285405158997, gen p mean: -0.13321413099765778, mean p set: 0.4496367573738098
loss_pred:0.01502307690680027, decouple_loss:0.0005924711585976183
Iteration: 545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868797063827515, gen p mean: -0.1305590718984604, mean p set: 0.4492647647857666
loss_pred:0.01491513755172491, decouple_loss:0.0005400216323323548
The modified gen p mean: 0.44742444157600403, gen p mean: -0.1330704241991043, mean p set: 0.4480001628398895
loss_pred:0.015603812411427498, decouple_loss:0.0005561218713410199
The modified gen p mean: 0.4492833614349365, gen p mean: -0.13463538885116577, mean p set: 0.4498598277568817
loss_pred:0.014969314448535442, decouple_loss:0.0005245542852208018
Iteration: 546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477306008338928, gen p mean: -0.12131890654563904, mean p set: 0.44830653071403503
loss_pred:0.014811829663813114, decouple_loss:0.000679893302731216
The modified gen p mean: 0.44883406162261963, gen p mean: -0.13313531875610352, mean p set: 0.4494089186191559
loss_pred:0.015116462484002113, decouple_loss:0.0006208439008332789
The modified gen p mean: 0.4493238627910614, gen p mean: -0.13455218076705933, mean p set: 0.4498986005783081
loss_pred:0.015508281998336315, decouple_loss:0.0006534515414386988
Iteration: 547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490612745285034, gen p mean: -0.12965570390224457, mean p set: 0.4496401250362396
loss_pred:0.015459488146007061, decouple_loss:0.000519988127052784
The modified gen p mean: 0.4484306573867798, gen p mean: -0.1265062540769577, mean p set: 0.4490050673484802
The modified gen p mean: 0.4487685561180115, gen p mean: -0.13030165433883667, mean p set: 0.44934189319610596
loss_pred:0.015584763139486313, decouple_loss:0.0004932578303851187
loss_pred:0.015148373320698738, decouple_loss:0.00047602245467714965
Iteration: 548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44878917932510376, gen p mean: -0.1293821930885315, mean p set: 0.4493670165538788
loss_pred:0.014676172286272049, decouple_loss:0.000509550969582051
The modified gen p mean: 0.4484660029411316, gen p mean: -0.13488009572029114, mean p set: 0.4490435719490051
loss_pred:0.014969932846724987, decouple_loss:0.000491048616822809
The modified gen p mean: 0.44803717732429504, gen p mean: -0.1272493451833725, mean p set: 0.4486114978790283
loss_pred:0.01566513441503048, decouple_loss:0.0004903812659904361
Iteration: 549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745010137557983, gen p mean: -0.13444726169109344, mean p set: 0.4480241537094116
loss_pred:0.01569230668246746, decouple_loss:0.0005449149757623672
The modified gen p mean: 0.4485420882701874, gen p mean: -0.12761050462722778, mean p set: 0.44911903142929077
The modified gen p mean: 0.4488983452320099, gen p mean: -0.12856841087341309, mean p set: 0.44947290420532227
loss_pred:0.014994774013757706, decouple_loss:0.000548868381883949
loss_pred:0.014856708236038685, decouple_loss:0.000517470296472311
Iteration: 550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485907554626465, gen p mean: -0.12597599625587463, mean p set: 0.4491669833660126
loss_pred:0.014909650199115276, decouple_loss:0.00047472488950006664
The modified gen p mean: 0.4483174979686737, gen p mean: -0.13303709030151367, mean p set: 0.4488937258720398
The modified gen p mean: 0.4491477608680725, gen p mean: -0.1293836236000061, mean p set: 0.44972550868988037
loss_pred:0.015743400901556015, decouple_loss:0.00039271521382033825
loss_pred:0.014902357943356037, decouple_loss:0.00041345792124047875
2023-05-02 04:59:55 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13359734416007996, mean p set: 0.4502691626548767
loss_pred:0.016924740746617317, decouple_loss:0.00040549549157731235
The modified gen p mean: 0.44953855872154236, gen p mean: -0.12785206735134125, mean p set: 0.4500633478164673
loss_pred:0.016171719878911972, decouple_loss:0.00044933732715435326
The modified gen p mean: 0.4498293101787567, gen p mean: -0.1270735114812851, mean p set: 0.45035696029663086
loss_pred:0.016533147543668747, decouple_loss:0.0004673536750487983
WV_1_PC_1_EH_0_PS_40, loss: 0.016565239056944847, avg_mse: 0.025871600955724716
current test mse: 0.025872
Iteration: 551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44885191321372986, gen p mean: -0.13449563086032867, mean p set: 0.44942986965179443
loss_pred:0.0151191595941782, decouple_loss:0.00039820585516281426
The modified gen p mean: 0.44894132018089294, gen p mean: -0.12662434577941895, mean p set: 0.44951876997947693The modified gen p mean: 0.4486016035079956, gen p mean: -0.13018177449703217, mean p set: 0.44917774200439453
loss_pred:0.015079233795404434, decouple_loss:0.0005137145635671914loss_pred:0.015684286132454872, decouple_loss:0.0003724292619153857
Iteration: 552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487225115299225, gen p mean: -0.1316310167312622, mean p set: 0.4493010640144348
loss_pred:0.015080485492944717, decouple_loss:0.00044200560660101473
The modified gen p mean: 0.4488738775253296, gen p mean: -0.1287650167942047, mean p set: 0.4494534134864807
The modified gen p mean: 0.44928669929504395, gen p mean: -0.13446703553199768, mean p set: 0.4498666524887085
loss_pred:0.014708123169839382, decouple_loss:0.00043858206481672823
loss_pred:0.01529124565422535, decouple_loss:0.0004959414363838732
Iteration: 553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480013847351074, gen p mean: -0.13029910624027252, mean p set: 0.448577344417572
loss_pred:0.015129567123949528, decouple_loss:0.0005362308002077043
The modified gen p mean: 0.44723692536354065, gen p mean: -0.12483120709657669, mean p set: 0.4478098452091217
loss_pred:0.015871675685048103, decouple_loss:0.00047576407087035477
The modified gen p mean: 0.4481039047241211, gen p mean: -0.12384781241416931, mean p set: 0.4486786425113678
loss_pred:0.01587834767997265, decouple_loss:0.00041620281990617514
Iteration: 554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481847584247589, gen p mean: -0.12041575461626053, mean p set: 0.4487597644329071
loss_pred:0.015103267505764961, decouple_loss:0.0004147179424762726
The modified gen p mean: 0.448526531457901, gen p mean: -0.1257503181695938, mean p set: 0.4491029977798462
loss_pred:0.015163364820182323, decouple_loss:0.0004249281482771039
The modified gen p mean: 0.44886255264282227, gen p mean: -0.12878306210041046, mean p set: 0.4494372606277466
loss_pred:0.014793743379414082, decouple_loss:0.0005720034241676331
Iteration: 555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490175247192383, gen p mean: -0.1256345808506012, mean p set: 0.4495936930179596
loss_pred:0.014710700139403343, decouple_loss:0.0004991200985386968
The modified gen p mean: 0.4478845000267029, gen p mean: -0.12579910457134247, mean p set: 0.44845834374427795
loss_pred:0.014669486321508884, decouple_loss:0.0003711217432282865
The modified gen p mean: 0.44844046235084534, gen p mean: -0.12244794517755508, mean p set: 0.44901883602142334
loss_pred:0.014401561580598354, decouple_loss:0.0005275124567560852
Iteration: 556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947877526283264, gen p mean: -0.1254882514476776, mean p set: 0.45005539059638977
loss_pred:0.014675057493150234, decouple_loss:0.0004841577319893986
The modified gen p mean: 0.44828909635543823, gen p mean: -0.12697432935237885, mean p set: 0.4488653242588043
The modified gen p mean: 0.4492015540599823, gen p mean: -0.12442081421613693, mean p set: 0.4497752785682678
loss_pred:0.01521448977291584, decouple_loss:0.0005472949706017971
loss_pred:0.014680280350148678, decouple_loss:0.0004896158934570849
Iteration: 557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935375452041626, gen p mean: -0.1263238936662674, mean p set: 0.449928879737854
loss_pred:0.015043114311993122, decouple_loss:0.0003784382715821266
The modified gen p mean: 0.44898733496665955, gen p mean: -0.12430533766746521, mean p set: 0.44956550002098083
The modified gen p mean: 0.44930166006088257, gen p mean: -0.12750793993473053, mean p set: 0.4498789310455322
loss_pred:0.01508553046733141, decouple_loss:0.00041234231321141124
loss_pred:0.015130605548620224, decouple_loss:0.0005261792684905231
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721633195877075, gen p mean: -0.12342150509357452, mean p set: 0.4477921724319458
The modified gen p mean: 0.4478071928024292, gen p mean: -0.11432699114084244, mean p set: 0.44838523864746094loss_pred:0.014386764727532864, decouple_loss:0.0004916726029478014
loss_pred:0.014990244060754776, decouple_loss:0.0004713930538855493
The modified gen p mean: 0.4469601809978485, gen p mean: -0.12079977989196777, mean p set: 0.44753846526145935
loss_pred:0.014639499597251415, decouple_loss:0.0005164402537047863
Iteration: 559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480895400047302, gen p mean: -0.11930865794420242, mean p set: 0.44866541028022766
loss_pred:0.01438304502516985, decouple_loss:0.0005575474933721125
The modified gen p mean: 0.44793447852134705, gen p mean: -0.12025654315948486, mean p set: 0.4485096037387848
loss_pred:0.014249123632907867, decouple_loss:0.0005711134290322661
The modified gen p mean: 0.4486742615699768, gen p mean: -0.12032093852758408, mean p set: 0.44924888014793396
loss_pred:0.014177168719470501, decouple_loss:0.00047650645137764513
Iteration: 560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962507486343384, gen p mean: -0.11823520809412003, mean p set: 0.45020049810409546
loss_pred:0.014098403044044971, decouple_loss:0.00043045214260928333
The modified gen p mean: 0.45009472966194153, gen p mean: -0.11439170688390732, mean p set: 0.4506722390651703
The modified gen p mean: 0.4487559199333191, gen p mean: -0.11946674436330795, mean p set: 0.4493320882320404
loss_pred:0.014156912453472614, decouple_loss:0.00048715819139033556
loss_pred:0.014305027201771736, decouple_loss:0.0005441671819426119
2023-05-02 05:02:38 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12345917522907257, mean p set: 0.4502691626548767
loss_pred:0.01689498871564865, decouple_loss:0.0005811726441606879
The modified gen p mean: 0.4495365023612976, gen p mean: -0.11747521907091141, mean p set: 0.4500633478164673
loss_pred:0.01614527218043804, decouple_loss:0.0004623655113391578
The modified gen p mean: 0.4498303234577179, gen p mean: -0.11699710786342621, mean p set: 0.45035696029663086
loss_pred:0.01652807928621769, decouple_loss:0.00046992592979222536
WV_1_PC_1_EH_0_PS_40, loss: 0.016548005864024162, avg_mse: 0.02590898424386978
current test mse: 0.025909
Iteration: 561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463064968585968, gen p mean: -0.11690796166658401, mean p set: 0.4468816816806793
loss_pred:0.014869586564600468, decouple_loss:0.0006799126276746392
The modified gen p mean: 0.44923558831214905, gen p mean: -0.11522465199232101, mean p set: 0.4498105049133301The modified gen p mean: 0.4471621513366699, gen p mean: -0.1203773021697998, mean p set: 0.4477404057979584
loss_pred:0.014497107826173306, decouple_loss:0.00042641640175133944loss_pred:0.01440685335546732, decouple_loss:0.0005841433885507286
Iteration: 562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780004024505615, gen p mean: -0.12056169658899307, mean p set: 0.4483746588230133
loss_pred:0.014376276172697544, decouple_loss:0.00043879408622160554
The modified gen p mean: 0.4472740590572357, gen p mean: -0.11207205802202225, mean p set: 0.44784975051879883The modified gen p mean: 0.4481399655342102, gen p mean: -0.12140697985887527, mean p set: 0.4487130343914032
loss_pred:0.013815071433782578, decouple_loss:0.0006268542492762208
loss_pred:0.014212466776371002, decouple_loss:0.0005999597487971187
Iteration: 563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472910761833191, gen p mean: -0.12171149253845215, mean p set: 0.44786572456359863
loss_pred:0.013951168395578861, decouple_loss:0.00046555467997677624
The modified gen p mean: 0.4475620687007904, gen p mean: -0.11982840299606323, mean p set: 0.4481406807899475
loss_pred:0.014185243286192417, decouple_loss:0.0005542188882827759
The modified gen p mean: 0.4490020275115967, gen p mean: -0.11614181101322174, mean p set: 0.4495809078216553
loss_pred:0.01406861748546362, decouple_loss:0.00048277140012942255
Iteration: 564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491923749446869, gen p mean: -0.11856731027364731, mean p set: 0.44976967573165894
loss_pred:0.013830729760229588, decouple_loss:0.0005520039703696966
The modified gen p mean: 0.44756361842155457, gen p mean: -0.12030299752950668, mean p set: 0.4481384754180908
loss_pred:0.013699897564947605, decouple_loss:0.000557118037249893
The modified gen p mean: 0.44741350412368774, gen p mean: -0.12362472712993622, mean p set: 0.44798991084098816
loss_pred:0.013636848889291286, decouple_loss:0.0005554237868636847
Iteration: 565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487335979938507, gen p mean: -0.12538951635360718, mean p set: 0.4493098258972168
loss_pred:0.01378034520894289, decouple_loss:0.00044182027340866625
The modified gen p mean: 0.44820767641067505, gen p mean: -0.1247975155711174, mean p set: 0.44878509640693665
loss_pred:0.014222018420696259, decouple_loss:0.0004938553902320564
The modified gen p mean: 0.4459250867366791, gen p mean: -0.119601771235466, mean p set: 0.4464992880821228
loss_pred:0.014568996615707874, decouple_loss:0.00043937182636000216
Iteration: 566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481426179409027, gen p mean: -0.1259734183549881, mean p set: 0.4487197697162628
loss_pred:0.01426872331649065, decouple_loss:0.00048558355774730444
The modified gen p mean: 0.44831985235214233, gen p mean: -0.1226462572813034, mean p set: 0.4488963484764099
loss_pred:0.014021804556250572, decouple_loss:0.00040651645394973457
The modified gen p mean: 0.4468337595462799, gen p mean: -0.12951084971427917, mean p set: 0.44741183519363403
loss_pred:0.014277213253080845, decouple_loss:0.00039214800926856697
Iteration: 567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472486674785614, gen p mean: -0.11987696588039398, mean p set: 0.44782590866088867
loss_pred:0.014468992128968239, decouple_loss:0.0006717946380376816
The modified gen p mean: 0.4480612277984619, gen p mean: -0.12946118414402008, mean p set: 0.44863414764404297
The modified gen p mean: 0.4484822452068329, gen p mean: -0.12097939848899841, mean p set: 0.44906049966812134
loss_pred:0.013830453157424927, decouple_loss:0.0006589631084352732
loss_pred:0.013893512077629566, decouple_loss:0.0007464691298082471
Iteration: 568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448225200176239, gen p mean: -0.1286545693874359, mean p set: 0.44880014657974243
loss_pred:0.013419638387858868, decouple_loss:0.0005799242062494159
The modified gen p mean: 0.44862043857574463, gen p mean: -0.13031134009361267, mean p set: 0.4491964280605316
loss_pred:0.013887902721762657, decouple_loss:0.0006817630492150784
The modified gen p mean: 0.447660356760025, gen p mean: -0.12142151594161987, mean p set: 0.44823670387268066
loss_pred:0.014184433035552502, decouple_loss:0.0006790218758396804
Iteration: 569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488019049167633, gen p mean: -0.12277542799711227, mean p set: 0.4493766129016876
loss_pred:0.013954058289527893, decouple_loss:0.000470518774818629
The modified gen p mean: 0.4473930299282074, gen p mean: -0.12920910120010376, mean p set: 0.4479677379131317
loss_pred:0.013770130462944508, decouple_loss:0.0004833993734791875
The modified gen p mean: 0.44866740703582764, gen p mean: -0.12221147119998932, mean p set: 0.44924619793891907
loss_pred:0.014033110812306404, decouple_loss:0.00047808283125050366
Iteration: 570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910141825675964, gen p mean: -0.12487825006246567, mean p set: 0.4496791362762451
loss_pred:0.014156591147184372, decouple_loss:0.0006784229772165418
The modified gen p mean: 0.44709739089012146, gen p mean: -0.1277061402797699, mean p set: 0.4476757347583771
loss_pred:0.014162609353661537, decouple_loss:0.0007105682161636651
The modified gen p mean: 0.449123740196228, gen p mean: -0.12206641584634781, mean p set: 0.44969815015792847
loss_pred:0.014158559031784534, decouple_loss:0.0006059914594516158
2023-05-02 05:04:45 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12914890050888062, mean p set: 0.4502691626548767
loss_pred:0.016950875520706177, decouple_loss:0.0006954744458198547
The modified gen p mean: 0.4495343267917633, gen p mean: -0.12339228391647339, mean p set: 0.4500633478164673
loss_pred:0.01617414690554142, decouple_loss:0.0006888568750582635
The modified gen p mean: 0.44982704520225525, gen p mean: -0.12312951683998108, mean p set: 0.45035696029663086
loss_pred:0.0166018083691597, decouple_loss:0.0007762268069200218
WV_1_PC_1_EH_0_PS_40, loss: 0.016611620783805847, avg_mse: 0.025972211733460426
current test mse: 0.025972
Iteration: 571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487798810005188, gen p mean: -0.12923161685466766, mean p set: 0.4493577182292938
loss_pred:0.013524915091693401, decouple_loss:0.0006258921348489821
The modified gen p mean: 0.449280321598053, gen p mean: -0.12095670402050018, mean p set: 0.44985491037368774
loss_pred:0.014083081856369972, decouple_loss:0.0005166414193809032
The modified gen p mean: 0.4478473961353302, gen p mean: -0.12349705398082733, mean p set: 0.44842419028282166
loss_pred:0.013965708203613758, decouple_loss:0.0007326129707507789
Iteration: 572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892820715904236, gen p mean: -0.1230340451002121, mean p set: 0.44950512051582336
loss_pred:0.01376217883080244, decouple_loss:0.0005603600875474513
The modified gen p mean: 0.44913092255592346, gen p mean: -0.12824244797229767, mean p set: 0.4497106075286865The modified gen p mean: 0.44651663303375244, gen p mean: -0.12753045558929443, mean p set: 0.44709157943725586
loss_pred:0.014071132056415081, decouple_loss:0.0004503714444581419
loss_pred:0.014153500087559223, decouple_loss:0.0004670649068430066
Iteration: 573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677412509918213, gen p mean: -0.12806247174739838, mean p set: 0.4473493695259094
The modified gen p mean: 0.44818350672721863, gen p mean: -0.12838615477085114, mean p set: 0.4487580358982086
loss_pred:0.014344039373099804, decouple_loss:0.00044500676449388266
loss_pred:0.01329218503087759, decouple_loss:0.0005251042312011123
The modified gen p mean: 0.4477348327636719, gen p mean: -0.11811865866184235, mean p set: 0.4483111500740051
loss_pred:0.014496983028948307, decouple_loss:0.0005674719577655196
Iteration: 574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469507932662964, gen p mean: -0.1258370727300644, mean p set: 0.44752633571624756
loss_pred:0.013422949239611626, decouple_loss:0.00039913938962854445
The modified gen p mean: 0.4463619291782379, gen p mean: -0.12363044172525406, mean p set: 0.4469376802444458
loss_pred:0.014285316690802574, decouple_loss:0.0004785166238434613
The modified gen p mean: 0.4468334913253784, gen p mean: -0.12598292529582977, mean p set: 0.44741132855415344
loss_pred:0.014530793763697147, decouple_loss:0.0005552315269596875
Iteration: 575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478401243686676, gen p mean: -0.1200847178697586, mean p set: 0.44841745495796204
loss_pred:0.0136503204703331, decouple_loss:0.0005450834869407117
The modified gen p mean: 0.4489077031612396, gen p mean: -0.12229236960411072, mean p set: 0.44948315620422363
loss_pred:0.014025983400642872, decouple_loss:0.0005349644925445318
The modified gen p mean: 0.44692113995552063, gen p mean: -0.1263517290353775, mean p set: 0.44749414920806885
loss_pred:0.014367607422173023, decouple_loss:0.0006176516762934625
Iteration: 576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471854269504547, gen p mean: -0.12472686916589737, mean p set: 0.447760671377182
loss_pred:0.014107683673501015, decouple_loss:0.0004781555908266455
The modified gen p mean: 0.44608771800994873, gen p mean: -0.12572164833545685, mean p set: 0.4466628134250641
The modified gen p mean: 0.44850054383277893, gen p mean: -0.12572085857391357, mean p set: 0.449078768491745
loss_pred:0.014542348682880402, decouple_loss:0.000595578458160162
loss_pred:0.013810302130877972, decouple_loss:0.0006628093542531133
Iteration: 577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473112225532532, gen p mean: -0.1226613000035286, mean p set: 0.4478890001773834
loss_pred:0.014101567678153515, decouple_loss:0.0003940430178772658
The modified gen p mean: 0.44994136691093445, gen p mean: -0.12267743051052094, mean p set: 0.4505167305469513
loss_pred:0.014258691109716892, decouple_loss:0.00039354583714157343
The modified gen p mean: 0.4470667243003845, gen p mean: -0.12703584134578705, mean p set: 0.4476434886455536
loss_pred:0.013859974220395088, decouple_loss:0.0003839695709757507
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
NaN value num: 0
Iteration: 578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4441063106060028, gen p mean: -0.12570226192474365, mean p set: 0.44467902183532715
loss_pred:0.016556190326809883, decouple_loss:0.0004443968937266618
The modified gen p mean: 0.4469259977340698, gen p mean: -0.12715832889080048, mean p set: 0.44750338792800903
The modified gen p mean: 0.4479239881038666, gen p mean: -0.12182149291038513, mean p set: 0.4485023021697998
loss_pred:0.015735603868961334, decouple_loss:0.0004585225833579898
loss_pred:0.017128268256783485, decouple_loss:0.0006279554800130427
Iteration: 579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475775957107544, gen p mean: -0.12040817737579346, mean p set: 0.44815483689308167
loss_pred:0.0164269357919693, decouple_loss:0.0004960406804457307
The modified gen p mean: 0.4458502233028412, gen p mean: -0.12710173428058624, mean p set: 0.44642698764801025
loss_pred:0.015728389844298363, decouple_loss:0.00046801441931165755
The modified gen p mean: 0.4443957805633545, gen p mean: -0.12188747525215149, mean p set: 0.4449720084667206
loss_pred:0.016049735248088837, decouple_loss:0.0004809439124073833
Iteration: 580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44662153720855713, gen p mean: -0.11786922812461853, mean p set: 0.4471952021121979
loss_pred:0.015261833555996418, decouple_loss:0.000531430181581527
The modified gen p mean: 0.4489990472793579, gen p mean: -0.12362360209226608, mean p set: 0.44957417249679565
loss_pred:0.014358130283653736, decouple_loss:0.000431801745435223
The modified gen p mean: 0.4485272765159607, gen p mean: -0.11805456131696701, mean p set: 0.4491027295589447
loss_pred:0.015713991597294807, decouple_loss:0.0005181862507015467
2023-05-02 05:07:30 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1226215735077858, mean p set: 0.4502691626548767
loss_pred:0.0168384350836277, decouple_loss:0.0005117070395499468
The modified gen p mean: 0.44953498244285583, gen p mean: -0.11707942932844162, mean p set: 0.4500633478164673
loss_pred:0.01609296351671219, decouple_loss:0.0005250107496976852
The modified gen p mean: 0.4498269259929657, gen p mean: -0.11681942641735077, mean p set: 0.45035696029663086
loss_pred:0.01654191128909588, decouple_loss:0.0005639324663206935
WV_1_PC_1_EH_0_PS_40, loss: 0.01651778072118759, avg_mse: 0.025769304484128952
current test mse: 0.025769
At step 580, Best test: 0.025769
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44639626145362854, gen p mean: -0.12260124087333679, mean p set: 0.4469718039035797
loss_pred:0.015619377605617046, decouple_loss:0.0004249974444974214
The modified gen p mean: 0.4491766095161438, gen p mean: -0.1229148656129837, mean p set: 0.449752539396286
loss_pred:0.014636739157140255, decouple_loss:0.0005209713126532733
The modified gen p mean: 0.4460223913192749, gen p mean: -0.12187687307596207, mean p set: 0.44659915566444397
loss_pred:0.015658443793654442, decouple_loss:0.0004809187084902078
Iteration: 582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475743770599365, gen p mean: -0.1196480393409729, mean p set: 0.4481523334980011
loss_pred:0.015411107800900936, decouple_loss:0.00045827857684344053
The modified gen p mean: 0.4465426504611969, gen p mean: -0.12546665966510773, mean p set: 0.44711804389953613The modified gen p mean: 0.44686996936798096, gen p mean: -0.12297824770212173, mean p set: 0.4474453032016754
loss_pred:0.015909772366285324, decouple_loss:0.0005767362890765071
loss_pred:0.015903128311038017, decouple_loss:0.00047960845404304564
Iteration: 583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475398361682892, gen p mean: -0.11610519886016846, mean p set: 0.44811511039733887
loss_pred:0.01594318263232708, decouple_loss:0.0005434367922134697
The modified gen p mean: 0.44748395681381226, gen p mean: -0.11834985017776489, mean p set: 0.4480600357055664
loss_pred:0.016416030004620552, decouple_loss:0.0004989576991647482
The modified gen p mean: 0.44661447405815125, gen p mean: -0.1295240968465805, mean p set: 0.44718730449676514
loss_pred:0.015677286311984062, decouple_loss:0.0004095694166608155
Iteration: 584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457013010978699, gen p mean: -0.12228108942508698, mean p set: 0.4462781846523285
loss_pred:0.01662398688495159, decouple_loss:0.0006463704048655927
The modified gen p mean: 0.4496643543243408, gen p mean: -0.11895924061536789, mean p set: 0.4502406716346741
loss_pred:0.01454466488212347, decouple_loss:0.0008396252524107695
The modified gen p mean: 0.44781404733657837, gen p mean: -0.114169180393219, mean p set: 0.4483906924724579
loss_pred:0.015702111646533012, decouple_loss:0.0005465677240863442
Iteration: 585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484397768974304, gen p mean: -0.11912895739078522, mean p set: 0.4490150213241577
loss_pred:0.01663941890001297, decouple_loss:0.0006369614275172353
The modified gen p mean: 0.44519996643066406, gen p mean: -0.12607891857624054, mean p set: 0.44577544927597046
loss_pred:0.015301873907446861, decouple_loss:0.0008270701509900391
The modified gen p mean: 0.44820743799209595, gen p mean: -0.1291581690311432, mean p set: 0.4487829804420471
loss_pred:0.015373622067272663, decouple_loss:0.0006904302863404155
Iteration: 586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485469460487366, gen p mean: -0.12557069957256317, mean p set: 0.44912174344062805
loss_pred:0.01559348776936531, decouple_loss:0.00054074393119663
The modified gen p mean: 0.4462926685810089, gen p mean: -0.12648166716098785, mean p set: 0.4468673765659332
loss_pred:0.01572525128722191, decouple_loss:0.00041900898213498294
The modified gen p mean: 0.44720619916915894, gen p mean: -0.12150412052869797, mean p set: 0.4477825164794922
loss_pred:0.015281574800610542, decouple_loss:0.00037153990706428885
Iteration: 587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480709135532379, gen p mean: -0.12714993953704834, mean p set: 0.4486467242240906
loss_pred:0.01538097858428955, decouple_loss:0.0005630998639389873
The modified gen p mean: 0.4502960443496704, gen p mean: -0.12837333977222443, mean p set: 0.450869619846344
loss_pred:0.014224558137357235, decouple_loss:0.0003601247153710574
The modified gen p mean: 0.4478335976600647, gen p mean: -0.12192469090223312, mean p set: 0.44841283559799194
loss_pred:0.01570257544517517, decouple_loss:0.00052589678671211
Iteration: 588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445706844329834, gen p mean: -0.12711894512176514, mean p set: 0.44628193974494934
loss_pred:0.015422801487147808, decouple_loss:0.0008626331691630185
The modified gen p mean: 0.4471243917942047, gen p mean: -0.12565329670906067, mean p set: 0.44770243763923645
loss_pred:0.01571931317448616, decouple_loss:0.0005706204101443291
The modified gen p mean: 0.44645774364471436, gen p mean: -0.1289866417646408, mean p set: 0.4470330774784088
loss_pred:0.01508656982332468, decouple_loss:0.0006105458014644682
Iteration: 589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473913311958313, gen p mean: -0.12219865620136261, mean p set: 0.4479677379131317
loss_pred:0.016003817319869995, decouple_loss:0.0005529113695956767
The modified gen p mean: 0.446972519159317, gen p mean: -0.1272600293159485, mean p set: 0.4475480318069458
loss_pred:0.01588130183517933, decouple_loss:0.0005436356877908111
The modified gen p mean: 0.4491482079029083, gen p mean: -0.12826740741729736, mean p set: 0.4497237801551819
loss_pred:0.015542629174888134, decouple_loss:0.0005443607806228101
Iteration: 590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821885228157043, gen p mean: -0.1258091926574707, mean p set: 0.4487939476966858
loss_pred:0.015617383643984795, decouple_loss:0.0005936221568845212
The modified gen p mean: 0.4494796693325043, gen p mean: -0.1288689523935318, mean p set: 0.4500530958175659
loss_pred:0.01390748005360365, decouple_loss:0.000714124646037817
The modified gen p mean: 0.4451715052127838, gen p mean: -0.12828102707862854, mean p set: 0.4457470774650574
loss_pred:0.015323287807404995, decouple_loss:0.00047029549023136497
2023-05-02 05:09:42 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.127527117729187, mean p set: 0.4502691626548767
loss_pred:0.01690027117729187, decouple_loss:0.0006661067600362003
The modified gen p mean: 0.4495360255241394, gen p mean: -0.12201100587844849, mean p set: 0.4500633478164673
loss_pred:0.016180038452148438, decouple_loss:0.0009044969920068979
The modified gen p mean: 0.4498273730278015, gen p mean: -0.12146059423685074, mean p set: 0.45035696029663086
loss_pred:0.016607297584414482, decouple_loss:0.0009278743527829647
WV_1_PC_1_EH_0_PS_40, loss: 0.01660417765378952, avg_mse: 0.025903021916747093
current test mse: 0.025903
Iteration: 591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708651304244995, gen p mean: -0.12765802443027496, mean p set: 0.4476630687713623
loss_pred:0.015278667211532593, decouple_loss:0.0008734004804864526
The modified gen p mean: 0.44601377844810486, gen p mean: -0.12481318414211273, mean p set: 0.44658976793289185
loss_pred:0.015603774227201939, decouple_loss:0.0007637279340997338
The modified gen p mean: 0.4453878700733185, gen p mean: -0.12696336209774017, mean p set: 0.4459638297557831
loss_pred:0.01552934292703867, decouple_loss:0.0005764294182881713
Iteration: 592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719940423965454, gen p mean: -0.12202563136816025, mean p set: 0.4477749764919281
loss_pred:0.016607550904154778, decouple_loss:0.0005599923315458
The modified gen p mean: 0.4480389356613159, gen p mean: -0.11823208630084991, mean p set: 0.4486178159713745The modified gen p mean: 0.4475444257259369, gen p mean: -0.1278841197490692, mean p set: 0.4481199383735657
loss_pred:0.01596023142337799, decouple_loss:0.0006057958235032856
loss_pred:0.015631403774023056, decouple_loss:0.0006717449869029224
Iteration: 593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479126036167145, gen p mean: -0.12051688134670258, mean p set: 0.4484868049621582
loss_pred:0.01637027971446514, decouple_loss:0.0005301896599121392
The modified gen p mean: 0.4464655816555023, gen p mean: -0.12281020730733871, mean p set: 0.4470408260822296The modified gen p mean: 0.4498974084854126, gen p mean: -0.12459318339824677, mean p set: 0.4504740536212921
loss_pred:0.015132647007703781, decouple_loss:0.0004883446963503957
loss_pred:0.014321843162178993, decouple_loss:0.00044434162555262446
Iteration: 594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4450508654117584, gen p mean: -0.12820249795913696, mean p set: 0.4456256330013275
The modified gen p mean: 0.44826579093933105, gen p mean: -0.12782694399356842, mean p set: 0.4488413631916046
loss_pred:0.015972629189491272, decouple_loss:0.0006797423120588064
loss_pred:0.015440523624420166, decouple_loss:0.000600733095780015
The modified gen p mean: 0.4467572271823883, gen p mean: -0.1244257390499115, mean p set: 0.4473304748535156
loss_pred:0.016038209199905396, decouple_loss:0.0008304778020828962
Iteration: 595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44573426246643066, gen p mean: -0.12898826599121094, mean p set: 0.4463125169277191
loss_pred:0.01599363051354885, decouple_loss:0.0005159314605407417
The modified gen p mean: 0.44807133078575134, gen p mean: -0.12320148944854736, mean p set: 0.4486483037471771
loss_pred:0.015905465930700302, decouple_loss:0.0006211493164300919
The modified gen p mean: 0.4457816481590271, gen p mean: -0.12566611170768738, mean p set: 0.44635626673698425
loss_pred:0.015343652106821537, decouple_loss:0.0005774356541223824
Iteration: 596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44670569896698, gen p mean: -0.12692587077617645, mean p set: 0.44727998971939087
loss_pred:0.0156269334256649, decouple_loss:0.00043463471229188144
The modified gen p mean: 0.44617417454719543, gen p mean: -0.13012371957302094, mean p set: 0.44674885272979736
loss_pred:0.015563856810331345, decouple_loss:0.0005194189725443721
The modified gen p mean: 0.4453063905239105, gen p mean: -0.13115444779396057, mean p set: 0.44588083028793335
loss_pred:0.01540780533105135, decouple_loss:0.0004232723731547594
Iteration: 597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44670286774635315, gen p mean: -0.12461408972740173, mean p set: 0.447277694940567
loss_pred:0.016345517709851265, decouple_loss:0.0005889043095521629
The modified gen p mean: 0.44465935230255127, gen p mean: -0.12889009714126587, mean p set: 0.4452323615550995
The modified gen p mean: 0.4474351108074188, gen p mean: -0.12567302584648132, mean p set: 0.4480111598968506
loss_pred:0.015296613797545433, decouple_loss:0.0005578949931077659
loss_pred:0.015675654634833336, decouple_loss:0.0006504262564703822
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447260320186615, gen p mean: -0.12578439712524414, mean p set: 0.4478357136249542
loss_pred:0.014996364712715149, decouple_loss:0.0006522415787912905
The modified gen p mean: 0.4475666582584381, gen p mean: -0.11986079066991806, mean p set: 0.4481441080570221
The modified gen p mean: 0.44734299182891846, gen p mean: -0.12031783163547516, mean p set: 0.4479181170463562
loss_pred:0.01486918330192566, decouple_loss:0.0007049227715469897
loss_pred:0.015095287933945656, decouple_loss:0.0006113926065154374
Iteration: 599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44684508442878723, gen p mean: -0.125064417719841, mean p set: 0.44742023944854736
loss_pred:0.015079698525369167, decouple_loss:0.0005256650620140135
The modified gen p mean: 0.44751405715942383, gen p mean: -0.11953278630971909, mean p set: 0.4480918347835541
loss_pred:0.015830224379897118, decouple_loss:0.0005047530285082757
The modified gen p mean: 0.4480174779891968, gen p mean: -0.1255692094564438, mean p set: 0.4485948383808136
loss_pred:0.015326864086091518, decouple_loss:0.0005672212573699653
Iteration: 600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764474034309387, gen p mean: -0.12275192886590958, mean p set: 0.44822028279304504
loss_pred:0.014879702590405941, decouple_loss:0.0007595738279633224
The modified gen p mean: 0.44737499952316284, gen p mean: -0.11784043908119202, mean p set: 0.4479510188102722
loss_pred:0.015488721430301666, decouple_loss:0.0005436708452180028
The modified gen p mean: 0.4481430649757385, gen p mean: -0.12314256280660629, mean p set: 0.44871804118156433
loss_pred:0.015064803883433342, decouple_loss:0.0005034692003391683
2023-05-02 05:12:25 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.130147323012352, mean p set: 0.4502691626548767
loss_pred:0.016870301216840744, decouple_loss:0.0006359121762216091
The modified gen p mean: 0.4495314359664917, gen p mean: -0.12478454411029816, mean p set: 0.4500633478164673
loss_pred:0.016215285286307335, decouple_loss:0.0006669082795269787
The modified gen p mean: 0.44982725381851196, gen p mean: -0.12418876588344574, mean p set: 0.45035696029663086
loss_pred:0.016648251563310623, decouple_loss:0.0005611670203506947
WV_1_PC_1_EH_0_PS_40, loss: 0.016609013080596924, avg_mse: 0.025907857343554497
current test mse: 0.025908
Iteration: 601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465121030807495, gen p mean: -0.12985321879386902, mean p set: 0.44708749651908875
loss_pred:0.015541956759989262, decouple_loss:0.0004690434143412858
The modified gen p mean: 0.44806814193725586, gen p mean: -0.12308741360902786, mean p set: 0.4486437737941742
loss_pred:0.01475805975496769, decouple_loss:0.000571943586692214
The modified gen p mean: 0.44643479585647583, gen p mean: -0.13061386346817017, mean p set: 0.44701075553894043
loss_pred:0.015152898617088795, decouple_loss:0.0004818686284124851
Iteration: 602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476644694805145, gen p mean: -0.12989260256290436, mean p set: 0.4482421875
loss_pred:0.014863661490380764, decouple_loss:0.0005329278646968305
The modified gen p mean: 0.4467204809188843, gen p mean: -0.13234439492225647, mean p set: 0.4472969174385071The modified gen p mean: 0.44678795337677, gen p mean: -0.1253172606229782, mean p set: 0.44736430048942566
loss_pred:0.014581958763301373, decouple_loss:0.00047857797471806407
loss_pred:0.014966893009841442, decouple_loss:0.000518744986038655
Iteration: 603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673293828964233, gen p mean: -0.1256602257490158, mean p set: 0.4473079442977905
loss_pred:0.015009571798145771, decouple_loss:0.0005130792851559818
The modified gen p mean: 0.44715607166290283, gen p mean: -0.1302981674671173, mean p set: 0.4477294087409973
loss_pred:0.015579856932163239, decouple_loss:0.0004490719293244183
The modified gen p mean: 0.44712406396865845, gen p mean: -0.1277688443660736, mean p set: 0.4476999342441559
loss_pred:0.01480917725712061, decouple_loss:0.0007233938085846603
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480474293231964, gen p mean: -0.12780295312404633, mean p set: 0.44862401485443115
loss_pred:0.01537565141916275, decouple_loss:0.0006523097399622202
The modified gen p mean: 0.4468989074230194, gen p mean: -0.1275036484003067, mean p set: 0.44747352600097656
loss_pred:0.01491425558924675, decouple_loss:0.000600395433139056
The modified gen p mean: 0.44817328453063965, gen p mean: -0.13396865129470825, mean p set: 0.4487501382827759
loss_pred:0.014650056138634682, decouple_loss:0.0005156213883310556
Iteration: 605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667506217956543, gen p mean: -0.13314928114414215, mean p set: 0.4472491443157196
loss_pred:0.014902971684932709, decouple_loss:0.0005878842202946544
The modified gen p mean: 0.44713953137397766, gen p mean: -0.12754130363464355, mean p set: 0.44771599769592285
loss_pred:0.01479751244187355, decouple_loss:0.0005234330892562866
The modified gen p mean: 0.4466590881347656, gen p mean: -0.13389939069747925, mean p set: 0.44723477959632874
loss_pred:0.01565794087946415, decouple_loss:0.0006664343527518213
Iteration: 606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806429743766785, gen p mean: -0.1315540075302124, mean p set: 0.44864028692245483
loss_pred:0.015349335968494415, decouple_loss:0.00040890052332542837
The modified gen p mean: 0.44719818234443665, gen p mean: -0.12951861321926117, mean p set: 0.4477764964103699
loss_pred:0.014820598997175694, decouple_loss:0.0004984501865692437
The modified gen p mean: 0.4467962086200714, gen p mean: -0.1311999410390854, mean p set: 0.44737330079078674
loss_pred:0.014746748842298985, decouple_loss:0.0006805580342188478
Iteration: 607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756630063056946, gen p mean: -0.12313913553953171, mean p set: 0.4481446444988251
loss_pred:0.015676647424697876, decouple_loss:0.0006161314668133855
The modified gen p mean: 0.4470894932746887, gen p mean: -0.1298539787530899, mean p set: 0.4476657211780548
The modified gen p mean: 0.44727057218551636, gen p mean: -0.13207149505615234, mean p set: 0.4478473961353302
loss_pred:0.014593293890357018, decouple_loss:0.0005895024514757097
loss_pred:0.015342473983764648, decouple_loss:0.0006652646115981042
Iteration: 608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467868506908417, gen p mean: -0.13032251596450806, mean p set: 0.44736161828041077
loss_pred:0.01448759250342846, decouple_loss:0.0004424481885507703
The modified gen p mean: 0.44830888509750366, gen p mean: -0.1282648891210556, mean p set: 0.4488847255706787
loss_pred:0.014707066118717194, decouple_loss:0.0005366165423765779
The modified gen p mean: 0.4475998282432556, gen p mean: -0.12931783497333527, mean p set: 0.44817429780960083
loss_pred:0.01496849674731493, decouple_loss:0.000591596239246428
Iteration: 609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484560191631317, gen p mean: -0.13290485739707947, mean p set: 0.4490325152873993
loss_pred:0.014397336170077324, decouple_loss:0.000572650576941669
The modified gen p mean: 0.44921132922172546, gen p mean: -0.13203980028629303, mean p set: 0.4497888684272766
loss_pred:0.014529259875416756, decouple_loss:0.000573953555431217
The modified gen p mean: 0.44872891902923584, gen p mean: -0.1265752613544464, mean p set: 0.44930416345596313
loss_pred:0.014764975756406784, decouple_loss:0.0007696828106418252
Iteration: 610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473607540130615, gen p mean: -0.12327352911233902, mean p set: 0.44793686270713806
loss_pred:0.014921632595360279, decouple_loss:0.0006347369635477662
The modified gen p mean: 0.44724276661872864, gen p mean: -0.12196384370326996, mean p set: 0.4478200376033783
The modified gen p mean: 0.4467158615589142, gen p mean: -0.1292058378458023, mean p set: 0.4472888708114624
loss_pred:0.015387710183858871, decouple_loss:0.00044096255442127585
loss_pred:0.014711246825754642, decouple_loss:0.00052236596820876
2023-05-02 05:14:32 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13021421432495117, mean p set: 0.4502691626548767
loss_pred:0.016818057745695114, decouple_loss:0.00060451147146523
The modified gen p mean: 0.44953492283821106, gen p mean: -0.12468821555376053, mean p set: 0.4500633478164673
loss_pred:0.016213184222579002, decouple_loss:0.0005307423416525126
The modified gen p mean: 0.44982489943504333, gen p mean: -0.12389139086008072, mean p set: 0.45035696029663086
loss_pred:0.016578180715441704, decouple_loss:0.0005136895924806595
WV_1_PC_1_EH_0_PS_40, loss: 0.016563955694437027, avg_mse: 0.02591070905327797
current test mse: 0.025911
Iteration: 611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853144884109497, gen p mean: -0.1238456442952156, mean p set: 0.44910916686058044
loss_pred:0.015060771256685257, decouple_loss:0.00045962416334077716
The modified gen p mean: 0.44724375009536743, gen p mean: -0.12352688610553741, mean p set: 0.44782111048698425The modified gen p mean: 0.4482271373271942, gen p mean: -0.12646497786045074, mean p set: 0.44880321621894836
loss_pred:0.015048380009829998, decouple_loss:0.0004390330577734858
loss_pred:0.014868805184960365, decouple_loss:0.0006795672234147787
Iteration: 612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773706793785095, gen p mean: -0.13077402114868164, mean p set: 0.4483122229576111
The modified gen p mean: 0.4478519856929779, gen p mean: -0.12757830321788788, mean p set: 0.4484269320964813
loss_pred:0.014533222652971745, decouple_loss:0.0008569113560952246
loss_pred:0.0146048404276371, decouple_loss:0.00065331015503034
The modified gen p mean: 0.44655537605285645, gen p mean: -0.13387544453144073, mean p set: 0.4471310079097748
loss_pred:0.01429383922368288, decouple_loss:0.0006509922095574439
Iteration: 613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733476638793945, gen p mean: -0.13264873623847961, mean p set: 0.4479072690010071
loss_pred:0.014409825205802917, decouple_loss:0.0005819909856654704
The modified gen p mean: 0.4470263123512268, gen p mean: -0.12851829826831818, mean p set: 0.4476010799407959
loss_pred:0.014980655163526535, decouple_loss:0.0005859216907992959
The modified gen p mean: 0.44770580530166626, gen p mean: -0.1311962753534317, mean p set: 0.4482831358909607
loss_pred:0.014817941002547741, decouple_loss:0.0007698970730416477
Iteration: 614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479084610939026, gen p mean: -0.13064925372600555, mean p set: 0.4484843611717224The modified gen p mean: 0.4467102289199829, gen p mean: -0.13521960377693176, mean p set: 0.44728556275367737
loss_pred:0.014722136780619621, decouple_loss:0.0004412553971633315
loss_pred:0.015553463250398636, decouple_loss:0.0004984175320714712
The modified gen p mean: 0.44785717129707336, gen p mean: -0.13347646594047546, mean p set: 0.44843074679374695
loss_pred:0.014800277538597584, decouple_loss:0.00041931672603823245
Iteration: 615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699394702911377, gen p mean: -0.1295240968465805, mean p set: 0.4475705623626709
loss_pred:0.014396489597856998, decouple_loss:0.0005013406043872237
The modified gen p mean: 0.44718194007873535, gen p mean: -0.13098469376564026, mean p set: 0.4477572739124298
loss_pred:0.015405332669615746, decouple_loss:0.0006757446681149304
The modified gen p mean: 0.44745033979415894, gen p mean: -0.13097210228443146, mean p set: 0.44802361726760864
loss_pred:0.014547749422490597, decouple_loss:0.0006199964554980397
Iteration: 616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721484184265137, gen p mean: -0.1297716349363327, mean p set: 0.4477914571762085
loss_pred:0.014466666616499424, decouple_loss:0.0008507665479555726
The modified gen p mean: 0.447231262922287, gen p mean: -0.13149505853652954, mean p set: 0.44780635833740234
loss_pred:0.015391766093671322, decouple_loss:0.0005471737240441144
The modified gen p mean: 0.44719335436820984, gen p mean: -0.1316985785961151, mean p set: 0.4477703869342804
loss_pred:0.01497640274465084, decouple_loss:0.00042561019654385746
Iteration: 617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810792803764343, gen p mean: -0.1244373768568039, mean p set: 0.44868743419647217
loss_pred:0.014526779763400555, decouple_loss:0.000542929396033287
The modified gen p mean: 0.4461280405521393, gen p mean: -0.12728135287761688, mean p set: 0.44670602679252625
The modified gen p mean: 0.4478481709957123, gen p mean: -0.12746231257915497, mean p set: 0.44842514395713806
loss_pred:0.015362681820988655, decouple_loss:0.0004535180050879717
loss_pred:0.014887997880578041, decouple_loss:0.00047726984485052526
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
NaN value num: 0
Iteration: 618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45297181606292725, gen p mean: -0.11615312844514847, mean p set: 0.4535493850708008
loss_pred:0.015835458412766457, decouple_loss:0.0006744671263732016
The modified gen p mean: 0.45316705107688904, gen p mean: -0.11908134818077087, mean p set: 0.45374566316604614
The modified gen p mean: 0.4532143175601959, gen p mean: -0.11660326272249222, mean p set: 0.4537944197654724
loss_pred:0.01598227769136429, decouple_loss:0.0005938356625847518
loss_pred:0.01608939655125141, decouple_loss:0.0007139892550185323
Iteration: 619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4541476368904114, gen p mean: -0.11716959625482559, mean p set: 0.45472750067710876
loss_pred:0.015537853352725506, decouple_loss:0.0004746261110994965
The modified gen p mean: 0.4520719349384308, gen p mean: -0.11444087326526642, mean p set: 0.45264583826065063
loss_pred:0.015600364655256271, decouple_loss:0.0006131682312116027
The modified gen p mean: 0.45284363627433777, gen p mean: -0.12109166383743286, mean p set: 0.45342111587524414
loss_pred:0.015570485033094883, decouple_loss:0.0006567853270098567
Iteration: 620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532047212123871, gen p mean: -0.1162356287240982, mean p set: 0.45378226041793823
The modified gen p mean: 0.4526016414165497, gen p mean: -0.11852866411209106, mean p set: 0.45317837595939636loss_pred:0.015385792590677738, decouple_loss:0.00047722141607664526
loss_pred:0.016549309715628624, decouple_loss:0.00041607519960962236
The modified gen p mean: 0.4520237445831299, gen p mean: -0.11469187587499619, mean p set: 0.4526006579399109
loss_pred:0.015892120078206062, decouple_loss:0.0006457360577769578
2023-05-02 05:17:23 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.1334092617034912, mean p set: 0.4502691626548767
loss_pred:0.016923246905207634, decouple_loss:0.0005260624457150698
The modified gen p mean: 0.44953733682632446, gen p mean: -0.12769709527492523, mean p set: 0.4500633478164673
loss_pred:0.016185075044631958, decouple_loss:0.0005006709834560752
The modified gen p mean: 0.4498283863067627, gen p mean: -0.12702803313732147, mean p set: 0.45035696029663086
loss_pred:0.01647188328206539, decouple_loss:0.0004678737313952297
WV_1_PC_1_EH_0_PS_40, loss: 0.01655164547264576, avg_mse: 0.025907963514328003
current test mse: 0.025908
Iteration: 621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531760811805725, gen p mean: -0.11909271776676178, mean p set: 0.45375412702560425
loss_pred:0.015169767662882805, decouple_loss:0.000604810775257647
The modified gen p mean: 0.4525095224380493, gen p mean: -0.11948326230049133, mean p set: 0.453086256980896
loss_pred:0.01610608398914337, decouple_loss:0.0005148092750459909
The modified gen p mean: 0.4517119526863098, gen p mean: -0.11845189332962036, mean p set: 0.45228859782218933
loss_pred:0.016103200614452362, decouple_loss:0.0006190026761032641
Iteration: 622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527233839035034, gen p mean: -0.112958163022995, mean p set: 0.4532998204231262
loss_pred:0.01551333162933588, decouple_loss:0.0008765207603573799
The modified gen p mean: 0.45443615317344666, gen p mean: -0.11685053259134293, mean p set: 0.45501336455345154
The modified gen p mean: 0.4534201920032501, gen p mean: -0.11413820087909698, mean p set: 0.4539981782436371
loss_pred:0.015854207798838615, decouple_loss:0.0011139611015096307
loss_pred:0.015323739498853683, decouple_loss:0.0009517045691609383
Iteration: 623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4541891813278198, gen p mean: -0.11923138052225113, mean p set: 0.4547651410102844
loss_pred:0.015432820655405521, decouple_loss:0.0011957322712987661
The modified gen p mean: 0.4515248239040375, gen p mean: -0.11642271280288696, mean p set: 0.45210132002830505
loss_pred:0.01547752134501934, decouple_loss:0.0007575975032523274
The modified gen p mean: 0.4536803364753723, gen p mean: -0.11661592125892639, mean p set: 0.45425722002983093
loss_pred:0.015417556278407574, decouple_loss:0.0008620458538644016
Iteration: 624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45362183451652527, gen p mean: -0.11143335700035095, mean p set: 0.45420005917549133
loss_pred:0.014845604076981544, decouple_loss:0.0005751776043325663
The modified gen p mean: 0.45348724722862244, gen p mean: -0.11215687543153763, mean p set: 0.45406532287597656
loss_pred:0.015262838453054428, decouple_loss:0.00047733174869790673
The modified gen p mean: 0.4521607458591461, gen p mean: -0.11088643968105316, mean p set: 0.4527394771575928
loss_pred:0.016277676448225975, decouple_loss:0.0005338576738722622
Iteration: 625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538920223712921, gen p mean: -0.10714268684387207, mean p set: 0.4544689953327179
loss_pred:0.015589225105941296, decouple_loss:0.00062679493566975
The modified gen p mean: 0.4519117474555969, gen p mean: -0.10582596063613892, mean p set: 0.4524872601032257
loss_pred:0.015723735094070435, decouple_loss:0.0006257393979467452
The modified gen p mean: 0.45081108808517456, gen p mean: -0.10513816773891449, mean p set: 0.4513874351978302
loss_pred:0.01570032723248005, decouple_loss:0.0006442549056373537
Iteration: 626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45105308294296265, gen p mean: -0.10360152274370193, mean p set: 0.4516305923461914
loss_pred:0.016502277925610542, decouple_loss:0.0007119788788259029
The modified gen p mean: 0.45202893018722534, gen p mean: -0.10539471358060837, mean p set: 0.45260608196258545
The modified gen p mean: 0.45162448287010193, gen p mean: -0.10402861982584, mean p set: 0.4522015452384949
loss_pred:0.016382945701479912, decouple_loss:0.000636882905382663
loss_pred:0.016336478292942047, decouple_loss:0.0005740757333114743
Iteration: 627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523768424987793, gen p mean: -0.10423070192337036, mean p set: 0.452952116727829
loss_pred:0.01631641387939453, decouple_loss:0.0005360845825634897
The modified gen p mean: 0.45204058289527893, gen p mean: -0.10692565888166428, mean p set: 0.45261943340301514
The modified gen p mean: 0.45447736978530884, gen p mean: -0.10625263303518295, mean p set: 0.4550575017929077
loss_pred:0.015947159379720688, decouple_loss:0.0006335278158076108
loss_pred:0.015536898747086525, decouple_loss:0.0005082416464574635
Iteration: 628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538309872150421, gen p mean: -0.10892022401094437, mean p set: 0.45440778136253357
loss_pred:0.015598009340465069, decouple_loss:0.0006385187152773142
The modified gen p mean: 0.4524877965450287, gen p mean: -0.10733835399150848, mean p set: 0.45306307077407837
loss_pred:0.016066811978816986, decouple_loss:0.000787654600571841
The modified gen p mean: 0.4536866545677185, gen p mean: -0.11198341101408005, mean p set: 0.4542624056339264
loss_pred:0.016566084697842598, decouple_loss:0.0005511929630301893
Iteration: 629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521021544933319, gen p mean: -0.11571607738733292, mean p set: 0.4526795446872711
loss_pred:0.01584157906472683, decouple_loss:0.0005770524148829281
The modified gen p mean: 0.4532618522644043, gen p mean: -0.11442473530769348, mean p set: 0.45383843779563904
The modified gen p mean: 0.45285704731941223, gen p mean: -0.11055105179548264, mean p set: 0.4534352123737335
loss_pred:0.0158036220818758, decouple_loss:0.0006051682285033166
loss_pred:0.01643344573676586, decouple_loss:0.0005427330615930259
Iteration: 630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532823860645294, gen p mean: -0.11952359229326248, mean p set: 0.4538586437702179
loss_pred:0.015542794950306416, decouple_loss:0.0005987650365568697
The modified gen p mean: 0.45251816511154175, gen p mean: -0.12114617973566055, mean p set: 0.4530949294567108
loss_pred:0.015729088336229324, decouple_loss:0.0005640570307150483
The modified gen p mean: 0.45256009697914124, gen p mean: -0.1110883429646492, mean p set: 0.4531364440917969
loss_pred:0.01600748859345913, decouple_loss:0.0007219821563921869
2023-05-02 05:19:30 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13594216108322144, mean p set: 0.4502691626548767
loss_pred:0.017013145610690117, decouple_loss:0.000929063418880105
The modified gen p mean: 0.44953715801239014, gen p mean: -0.13048984110355377, mean p set: 0.4500633478164673
loss_pred:0.016259677708148956, decouple_loss:0.0010598000371828675
The modified gen p mean: 0.44982972741127014, gen p mean: -0.12989380955696106, mean p set: 0.45035696029663086
loss_pred:0.016588425263762474, decouple_loss:0.001024706056341529
WV_1_PC_1_EH_0_PS_40, loss: 0.01667064242064953, avg_mse: 0.025972317904233932
current test mse: 0.025972
Iteration: 631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45213478803634644, gen p mean: -0.123292937874794, mean p set: 0.4527115225791931
loss_pred:0.01552727073431015, decouple_loss:0.000666754029225558
The modified gen p mean: 0.4530220925807953, gen p mean: -0.12289771437644958, mean p set: 0.4535987377166748The modified gen p mean: 0.45224666595458984, gen p mean: -0.12178327143192291, mean p set: 0.4528234302997589
loss_pred:0.01515605766326189, decouple_loss:0.0006694152834825218
loss_pred:0.015494484454393387, decouple_loss:0.0008558870176784694
Iteration: 632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530022442340851, gen p mean: -0.11955811083316803, mean p set: 0.4535783529281616
loss_pred:0.015535448677837849, decouple_loss:0.0006961181643418968
The modified gen p mean: 0.4531070291996002, gen p mean: -0.12133680284023285, mean p set: 0.45368504524230957The modified gen p mean: 0.45382094383239746, gen p mean: -0.12419172376394272, mean p set: 0.45439663529396057
loss_pred:0.016403740271925926, decouple_loss:0.0006567278760485351loss_pred:0.015145540237426758, decouple_loss:0.0009122371557168663
Iteration: 633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45406392216682434, gen p mean: -0.1211879774928093, mean p set: 0.45464229583740234
The modified gen p mean: 0.45289427042007446, gen p mean: -0.12050386518239975, mean p set: 0.4534760117530823
loss_pred:0.015226170420646667, decouple_loss:0.0004923843662254512
loss_pred:0.016207654029130936, decouple_loss:0.0006069372175261378
The modified gen p mean: 0.45199042558670044, gen p mean: -0.12275425344705582, mean p set: 0.45256906747817993
loss_pred:0.01617848314344883, decouple_loss:0.0004847652744501829
Iteration: 634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45232295989990234, gen p mean: -0.11180078983306885, mean p set: 0.45290088653564453
loss_pred:0.01631338521838188, decouple_loss:0.0005234526470303535
The modified gen p mean: 0.4525385797023773, gen p mean: -0.11969158053398132, mean p set: 0.4531163275241852
loss_pred:0.01576179265975952, decouple_loss:0.0005720171611756086
The modified gen p mean: 0.4534319341182709, gen p mean: -0.11642639338970184, mean p set: 0.45401036739349365
loss_pred:0.01555376686155796, decouple_loss:0.000583379587624222
Iteration: 635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45131945610046387, gen p mean: -0.11090219765901566, mean p set: 0.4518945813179016
loss_pred:0.016107290983200073, decouple_loss:0.0005565905012190342
The modified gen p mean: 0.4526388347148895, gen p mean: -0.11392288655042648, mean p set: 0.4532153010368347
loss_pred:0.01615893840789795, decouple_loss:0.0006769477040506899
The modified gen p mean: 0.45142945647239685, gen p mean: -0.11162344366312027, mean p set: 0.45200714468955994
loss_pred:0.016408665105700493, decouple_loss:0.0007716376567259431
Iteration: 636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45205482840538025, gen p mean: -0.10443654656410217, mean p set: 0.45263317227363586
The modified gen p mean: 0.4536927044391632, gen p mean: -0.11173254996538162, mean p set: 0.45427173376083374
loss_pred:0.015915902331471443, decouple_loss:0.0005625763442367315
loss_pred:0.0152090759947896, decouple_loss:0.0005062437267042696
The modified gen p mean: 0.4536495506763458, gen p mean: -0.11304530501365662, mean p set: 0.4542265832424164
loss_pred:0.015432092361152172, decouple_loss:0.0005877912044525146
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
NaN value num: 0
Iteration: 637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044639706611633, gen p mean: -0.11083550751209259, mean p set: 0.4510236978530884
loss_pred:0.014856129884719849, decouple_loss:0.0005614662659354508
The modified gen p mean: 0.4495071768760681, gen p mean: -0.10846651345491409, mean p set: 0.45008277893066406
The modified gen p mean: 0.4512981176376343, gen p mean: -0.1080707386136055, mean p set: 0.45187634229660034
loss_pred:0.015671921893954277, decouple_loss:0.0005951480125077069
loss_pred:0.01542250532656908, decouple_loss:0.0006536763394251466
Iteration: 638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45204633474349976, gen p mean: -0.11416132748126984, mean p set: 0.45262065529823303
The modified gen p mean: 0.4516702890396118, gen p mean: -0.10537942498922348, mean p set: 0.4522497057914734
loss_pred:0.015999101102352142, decouple_loss:0.000883445143699646
loss_pred:0.015285908244550228, decouple_loss:0.0006628679693676531
The modified gen p mean: 0.45149990916252136, gen p mean: -0.10843928158283234, mean p set: 0.45207569003105164
loss_pred:0.014905648306012154, decouple_loss:0.0006350459880195558
Iteration: 639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45133358240127563, gen p mean: -0.10876002162694931, mean p set: 0.45191025733947754
loss_pred:0.01519541535526514, decouple_loss:0.0006875457474961877
The modified gen p mean: 0.44998425245285034, gen p mean: -0.11022552102804184, mean p set: 0.45055902004241943
loss_pred:0.015646688640117645, decouple_loss:0.0006168679101392627
The modified gen p mean: 0.44911083579063416, gen p mean: -0.11013045907020569, mean p set: 0.44968703389167786
loss_pred:0.015435938723385334, decouple_loss:0.0007418274763040245
Iteration: 640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45067593455314636, gen p mean: -0.10574939101934433, mean p set: 0.4512505531311035
loss_pred:0.015709538012742996, decouple_loss:0.0004687318578362465
The modified gen p mean: 0.4503611922264099, gen p mean: -0.11327115446329117, mean p set: 0.450937420129776
loss_pred:0.015428776852786541, decouple_loss:0.0005328375846147537
The modified gen p mean: 0.44905734062194824, gen p mean: -0.11258959025144577, mean p set: 0.44963446259498596
loss_pred:0.01521527674049139, decouple_loss:0.0005302572390064597
2023-05-02 05:22:12 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13042517006397247, mean p set: 0.4502691626548767
loss_pred:0.017100276425480843, decouple_loss:0.0007842027698643506
The modified gen p mean: 0.4495319128036499, gen p mean: -0.12430926412343979, mean p set: 0.4500633478164673
loss_pred:0.016384391114115715, decouple_loss:0.0008404893451370299
The modified gen p mean: 0.44982773065567017, gen p mean: -0.12385126203298569, mean p set: 0.45035696029663086
loss_pred:0.01667172461748123, decouple_loss:0.0008939505787566304
WV_1_PC_1_EH_0_PS_40, loss: 0.016760773956775665, avg_mse: 0.026102585718035698
current test mse: 0.026103
Iteration: 641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496944546699524, gen p mean: -0.11575441807508469, mean p set: 0.4502705931663513
loss_pred:0.014896733686327934, decouple_loss:0.0007076546899043024
The modified gen p mean: 0.4501461982727051, gen p mean: -0.11526069790124893, mean p set: 0.45072323083877563The modified gen p mean: 0.44990861415863037, gen p mean: -0.1168043315410614, mean p set: 0.4504829943180084
loss_pred:0.014944770373404026, decouple_loss:0.0010102471569553018
loss_pred:0.01426813006401062, decouple_loss:0.0008054689969867468
Iteration: 642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450104296207428, gen p mean: -0.10985268652439117, mean p set: 0.45068085193634033
loss_pred:0.014712618663907051, decouple_loss:0.000898502126801759
The modified gen p mean: 0.450483500957489, gen p mean: -0.10836880654096603, mean p set: 0.4510606527328491The modified gen p mean: 0.45197054743766785, gen p mean: -0.11170867830514908, mean p set: 0.4525485932826996
loss_pred:0.015369761735200882, decouple_loss:0.0007016528397798538loss_pred:0.015083047561347485, decouple_loss:0.0009415967506356537
Iteration: 643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45315825939178467, gen p mean: -0.1112288385629654, mean p set: 0.4537335932254791
loss_pred:0.015343155711889267, decouple_loss:0.000699504860676825
The modified gen p mean: 0.45134004950523376, gen p mean: -0.11318106949329376, mean p set: 0.4519140422344208The modified gen p mean: 0.45249131321907043, gen p mean: -0.11690109968185425, mean p set: 0.4530709385871887
loss_pred:0.015660952776670456, decouple_loss:0.0006491667008958757loss_pred:0.015121345408260822, decouple_loss:0.0006646440597251058
Iteration: 644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493083953857422, gen p mean: -0.10752308368682861, mean p set: 0.4498852789402008
loss_pred:0.016032880172133446, decouple_loss:0.0005878049414604902
The modified gen p mean: 0.44936037063598633, gen p mean: -0.10708587616682053, mean p set: 0.449937105178833
loss_pred:0.014480545185506344, decouple_loss:0.0005151237710379064
The modified gen p mean: 0.4502750039100647, gen p mean: -0.10818301886320114, mean p set: 0.4508511424064636
loss_pred:0.014984787441790104, decouple_loss:0.00041318085277453065
Iteration: 645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925689697265625, gen p mean: -0.10437800735235214, mean p set: 0.44983193278312683
The modified gen p mean: 0.4528977870941162, gen p mean: -0.10897073894739151, mean p set: 0.45347464084625244loss_pred:0.016067860648036003, decouple_loss:0.0007460004417225718
loss_pred:0.01551115419715643, decouple_loss:0.0006297033396549523
The modified gen p mean: 0.4531587064266205, gen p mean: -0.10281944274902344, mean p set: 0.4537356197834015
loss_pred:0.015198681503534317, decouple_loss:0.000688541098497808
Iteration: 646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499305784702301, gen p mean: -0.10232562571763992, mean p set: 0.4505070447921753
loss_pred:0.01590096578001976, decouple_loss:0.0008046526345424354
The modified gen p mean: 0.45254385471343994, gen p mean: -0.10776472091674805, mean p set: 0.45311927795410156
loss_pred:0.014976727776229382, decouple_loss:0.0005976399988867342
The modified gen p mean: 0.44912317395210266, gen p mean: -0.11041456460952759, mean p set: 0.4496982991695404
loss_pred:0.014599733985960484, decouple_loss:0.0008382454398088157
Iteration: 647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512265920639038, gen p mean: -0.11521191149950027, mean p set: 0.4518035352230072
loss_pred:0.014832128770649433, decouple_loss:0.0005416738567873836
The modified gen p mean: 0.4517880380153656, gen p mean: -0.1162438839673996, mean p set: 0.4523652195930481
loss_pred:0.015940001234412193, decouple_loss:0.0005675175925716758
The modified gen p mean: 0.4501264989376068, gen p mean: -0.10912927985191345, mean p set: 0.4507034122943878
loss_pred:0.014902777038514614, decouple_loss:0.0004911707364954054
Iteration: 648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44955626130104065, gen p mean: -0.11907067894935608, mean p set: 0.4501340985298157
loss_pred:0.015356016345322132, decouple_loss:0.0005471575423143804
The modified gen p mean: 0.45009884238243103, gen p mean: -0.11403065919876099, mean p set: 0.45067504048347473
loss_pred:0.015138822607696056, decouple_loss:0.0005711232661269605
The modified gen p mean: 0.4494200348854065, gen p mean: -0.1156991645693779, mean p set: 0.44999685883522034
loss_pred:0.014786618761718273, decouple_loss:0.0005609409417957067
Iteration: 649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45252349972724915, gen p mean: -0.11202039569616318, mean p set: 0.45309871435165405
loss_pred:0.01553697232156992, decouple_loss:0.0007161549874581397
The modified gen p mean: 0.4503328800201416, gen p mean: -0.11339906603097916, mean p set: 0.4509105384349823
loss_pred:0.015164876356720924, decouple_loss:0.0007864180952310562
The modified gen p mean: 0.4508100748062134, gen p mean: -0.11010411381721497, mean p set: 0.4513859152793884
loss_pred:0.015492357313632965, decouple_loss:0.000643497915007174
Iteration: 650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512866139411926, gen p mean: -0.11645177006721497, mean p set: 0.45186319947242737
loss_pred:0.015288218855857849, decouple_loss:0.0007826079963706434
The modified gen p mean: 0.4499790072441101, gen p mean: -0.11205088347196579, mean p set: 0.4505563974380493
loss_pred:0.01572374999523163, decouple_loss:0.000819263921584934
The modified gen p mean: 0.4503442943096161, gen p mean: -0.11305120587348938, mean p set: 0.4509201943874359
loss_pred:0.015234704129397869, decouple_loss:0.0007119901129044592
2023-05-02 05:24:18 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12397453933954239, mean p set: 0.4502691626548767
loss_pred:0.0169733427464962, decouple_loss:0.0006329058087430894
The modified gen p mean: 0.44953495264053345, gen p mean: -0.11832264065742493, mean p set: 0.4500633478164673
loss_pred:0.0162808857858181, decouple_loss:0.000804110080935061
The modified gen p mean: 0.44983041286468506, gen p mean: -0.11809106171131134, mean p set: 0.45035696029663086
loss_pred:0.01662442646920681, decouple_loss:0.0008468230371363461
WV_1_PC_1_EH_0_PS_40, loss: 0.016664281487464905, avg_mse: 0.02601695992052555
current test mse: 0.026017
Iteration: 651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45007872581481934, gen p mean: -0.11079902201890945, mean p set: 0.4506555497646332
loss_pred:0.014558677561581135, decouple_loss:0.0004902642103843391
The modified gen p mean: 0.45182666182518005, gen p mean: -0.11050698906183243, mean p set: 0.4524039626121521The modified gen p mean: 0.4526031017303467, gen p mean: -0.1061345711350441, mean p set: 0.45318400859832764
loss_pred:0.015073532238602638, decouple_loss:0.000615275464951992
loss_pred:0.015792177990078926, decouple_loss:0.0006671068840660155
Iteration: 652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504035413265228, gen p mean: -0.10883455723524094, mean p set: 0.45097947120666504
loss_pred:0.015799913555383682, decouple_loss:0.0007150275050662458
The modified gen p mean: 0.44987350702285767, gen p mean: -0.11109493672847748, mean p set: 0.4504503011703491The modified gen p mean: 0.450987845659256, gen p mean: -0.11315079778432846, mean p set: 0.45156341791152954
loss_pred:0.015136556699872017, decouple_loss:0.0005926422891207039loss_pred:0.014812584035098553, decouple_loss:0.0004967009299434721
Iteration: 653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45067253708839417, gen p mean: -0.11395867168903351, mean p set: 0.45125120878219604
loss_pred:0.014857612550258636, decouple_loss:0.0005752594443038106
The modified gen p mean: 0.45052745938301086, gen p mean: -0.11130468547344208, mean p set: 0.45110225677490234The modified gen p mean: 0.44996553659439087, gen p mean: -0.11151797324419022, mean p set: 0.45054012537002563
loss_pred:0.015601941384375095, decouple_loss:0.0012524736812338233
loss_pred:0.015344965271651745, decouple_loss:0.0005518362740986049
Iteration: 654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525274336338043, gen p mean: -0.11145538836717606, mean p set: 0.4531055688858032
The modified gen p mean: 0.44986510276794434, gen p mean: -0.10723000019788742, mean p set: 0.450441837310791
loss_pred:0.015389076434075832, decouple_loss:0.00046914807171560824
loss_pred:0.014860140159726143, decouple_loss:0.0006331261247396469
The modified gen p mean: 0.45034125447273254, gen p mean: -0.11532324552536011, mean p set: 0.4509181082248688
loss_pred:0.014764917083084583, decouple_loss:0.00038947552093304694
Iteration: 655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45032161474227905, gen p mean: -0.1123860776424408, mean p set: 0.4508971571922302
loss_pred:0.015478470362722874, decouple_loss:0.0006008860073052347
The modified gen p mean: 0.4528226852416992, gen p mean: -0.11135130375623703, mean p set: 0.45340150594711304
loss_pred:0.01483724545687437, decouple_loss:0.0007180909742601216
The modified gen p mean: 0.4502184987068176, gen p mean: -0.11315686255693436, mean p set: 0.4507932960987091
loss_pred:0.01473128143697977, decouple_loss:0.00041710774530656636
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
NaN value num: 0
Iteration: 656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515141248703003, gen p mean: -0.1150166466832161, mean p set: 0.45209240913391113
loss_pred:0.015597035177052021, decouple_loss:0.0008104409789666533
The modified gen p mean: 0.4513416290283203, gen p mean: -0.12229828536510468, mean p set: 0.451918363571167
The modified gen p mean: 0.45234376192092896, gen p mean: -0.11063344776630402, mean p set: 0.45292118191719055
loss_pred:0.0152888223528862, decouple_loss:0.0008494263747707009
loss_pred:0.015964215621352196, decouple_loss:0.0008089776965789497
Iteration: 657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513719975948334, gen p mean: -0.11764749884605408, mean p set: 0.45195040106773376
loss_pred:0.015154569409787655, decouple_loss:0.000637129764072597
The modified gen p mean: 0.4510457515716553, gen p mean: -0.11740075051784515, mean p set: 0.45162433385849
The modified gen p mean: 0.4524597227573395, gen p mean: -0.12170509994029999, mean p set: 0.4530346095561981
loss_pred:0.01631282828748226, decouple_loss:0.0009799848776310682
loss_pred:0.01548090297728777, decouple_loss:0.0007198926177807152
Iteration: 658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45046883821487427, gen p mean: -0.1157606765627861, mean p set: 0.4510461390018463
loss_pred:0.01662910357117653, decouple_loss:0.0007424909272231162
The modified gen p mean: 0.4538741707801819, gen p mean: -0.11797353625297546, mean p set: 0.45445236563682556
loss_pred:0.015690678730607033, decouple_loss:0.0006599129410460591
The modified gen p mean: 0.45216846466064453, gen p mean: -0.11609777063131332, mean p set: 0.45274466276168823
loss_pred:0.01595739834010601, decouple_loss:0.0007101302035152912
Iteration: 659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510754942893982, gen p mean: -0.11538451164960861, mean p set: 0.45165136456489563
loss_pred:0.015223639085888863, decouple_loss:0.00045899554970674217
The modified gen p mean: 0.4515070915222168, gen p mean: -0.11265084892511368, mean p set: 0.4520838260650635
The modified gen p mean: 0.45319175720214844, gen p mean: -0.11292539536952972, mean p set: 0.4537709653377533
loss_pred:0.01590556651353836, decouple_loss:0.0004658690304495394
loss_pred:0.015448585152626038, decouple_loss:0.00047787633957341313
Iteration: 660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45006388425827026, gen p mean: -0.10973340272903442, mean p set: 0.45064112544059753
loss_pred:0.016568969935178757, decouple_loss:0.0007408388773910701
The modified gen p mean: 0.45069724321365356, gen p mean: -0.1157807856798172, mean p set: 0.45127442479133606
loss_pred:0.015659000724554062, decouple_loss:0.0007461443892680109
The modified gen p mean: 0.451467365026474, gen p mean: -0.11513006687164307, mean p set: 0.45204612612724304
loss_pred:0.015043370425701141, decouple_loss:0.0007308008498512208
2023-05-02 05:27:03 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1196141317486763, mean p set: 0.4502691626548767
loss_pred:0.017047837376594543, decouple_loss:0.0005728403921239078
The modified gen p mean: 0.44953420758247375, gen p mean: -0.11388569325208664, mean p set: 0.4500633478164673
loss_pred:0.016333946958184242, decouple_loss:0.0009913629619404674
The modified gen p mean: 0.449828565120697, gen p mean: -0.11387228965759277, mean p set: 0.45035696029663086
loss_pred:0.016664452850818634, decouple_loss:0.0009471991797909141
WV_1_PC_1_EH_0_PS_40, loss: 0.016723936423659325, avg_mse: 0.026129895821213722
current test mse: 0.02613
Iteration: 661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108142495155334, gen p mean: -0.11013691872358322, mean p set: 0.4516591429710388
loss_pred:0.015213272534310818, decouple_loss:0.0007823957712389529
The modified gen p mean: 0.45114707946777344, gen p mean: -0.1093890443444252, mean p set: 0.4517228305339813The modified gen p mean: 0.45229610800743103, gen p mean: -0.1089569628238678, mean p set: 0.45287254452705383
loss_pred:0.01593799702823162, decouple_loss:0.0007244289736263454loss_pred:0.01599694788455963, decouple_loss:0.0006693057948723435
Iteration: 662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519469141960144, gen p mean: -0.10377906262874603, mean p set: 0.4525245428085327
The modified gen p mean: 0.45216768980026245, gen p mean: -0.10277857631444931, mean p set: 0.45274418592453003
loss_pred:0.014747120440006256, decouple_loss:0.0007763862959109247
loss_pred:0.015039950609207153, decouple_loss:0.0005991087527945638
The modified gen p mean: 0.45102813839912415, gen p mean: -0.10341194272041321, mean p set: 0.45160651206970215
loss_pred:0.01600763574242592, decouple_loss:0.0006181204225867987
Iteration: 663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531780481338501, gen p mean: -0.10591781884431839, mean p set: 0.4537568688392639
loss_pred:0.01502386387437582, decouple_loss:0.0007027909159660339
The modified gen p mean: 0.4521509110927582, gen p mean: -0.1013874039053917, mean p set: 0.4527277946472168
loss_pred:0.015544441528618336, decouple_loss:0.0006557760061696172
The modified gen p mean: 0.4519709646701813, gen p mean: -0.10212455689907074, mean p set: 0.45254722237586975
loss_pred:0.015108983032405376, decouple_loss:0.0006971887196414173
Iteration: 664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45061081647872925, gen p mean: -0.1071879044175148, mean p set: 0.45118778944015503
loss_pred:0.015462580136954784, decouple_loss:0.000943202874623239
The modified gen p mean: 0.45334041118621826, gen p mean: -0.1068347916007042, mean p set: 0.4539199471473694
loss_pred:0.015048988163471222, decouple_loss:0.000742351112421602
The modified gen p mean: 0.4510186016559601, gen p mean: -0.1032475084066391, mean p set: 0.45159485936164856
loss_pred:0.015046666376292706, decouple_loss:0.0008702745544724166
Iteration: 665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518756568431854, gen p mean: -0.10668067634105682, mean p set: 0.4524519443511963
loss_pred:0.015419010072946548, decouple_loss:0.000535091501660645
The modified gen p mean: 0.45150551199913025, gen p mean: -0.10795872658491135, mean p set: 0.45208099484443665
loss_pred:0.01577451266348362, decouple_loss:0.0005451430915854871
The modified gen p mean: 0.45132315158843994, gen p mean: -0.1029682531952858, mean p set: 0.4518997073173523
loss_pred:0.016144171357154846, decouple_loss:0.0007782202446833253
Iteration: 666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516631066799164, gen p mean: -0.11831250041723251, mean p set: 0.45223820209503174
loss_pred:0.015481516718864441, decouple_loss:0.0006042311433702707
The modified gen p mean: 0.4509824216365814, gen p mean: -0.11325576901435852, mean p set: 0.4515587389469147
loss_pred:0.015905313193798065, decouple_loss:0.0008958092657849193
The modified gen p mean: 0.4516906142234802, gen p mean: -0.11475580930709839, mean p set: 0.45226770639419556
loss_pred:0.014787627384066582, decouple_loss:0.0007498748600482941
Iteration: 667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519196152687073, gen p mean: -0.11114906519651413, mean p set: 0.4524966776371002
loss_pred:0.016277704387903214, decouple_loss:0.000673713511787355
The modified gen p mean: 0.45169147849082947, gen p mean: -0.11764979362487793, mean p set: 0.45226994156837463
The modified gen p mean: 0.45260733366012573, gen p mean: -0.11733976006507874, mean p set: 0.45318475365638733
loss_pred:0.01495195273309946, decouple_loss:0.00045730959391221404
loss_pred:0.014947359450161457, decouple_loss:0.0004969064029864967
Iteration: 668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451507568359375, gen p mean: -0.11435967683792114, mean p set: 0.4520830810070038
loss_pred:0.015631116926670074, decouple_loss:0.0006791299092583358
The modified gen p mean: 0.452170729637146, gen p mean: -0.11757780611515045, mean p set: 0.4527485966682434
The modified gen p mean: 0.45012083649635315, gen p mean: -0.11865350604057312, mean p set: 0.45069798827171326
loss_pred:0.01517545897513628, decouple_loss:0.00045194922131486237
loss_pred:0.014764438383281231, decouple_loss:0.0006958927842788398
Iteration: 669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513450264930725, gen p mean: -0.11562149226665497, mean p set: 0.4519197940826416
loss_pred:0.015503413043916225, decouple_loss:0.0008103455184027553
The modified gen p mean: 0.4511260986328125, gen p mean: -0.1158490926027298, mean p set: 0.4517037868499756
loss_pred:0.01583883725106716, decouple_loss:0.0006638457416556776
The modified gen p mean: 0.4505496621131897, gen p mean: -0.11139368265867233, mean p set: 0.4511275291442871
loss_pred:0.01608334481716156, decouple_loss:0.0007498926715925336
Iteration: 670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45311829447746277, gen p mean: -0.11242944002151489, mean p set: 0.453695684671402
loss_pred:0.015320702455937862, decouple_loss:0.0004276018007658422
The modified gen p mean: 0.45106184482574463, gen p mean: -0.11001650243997574, mean p set: 0.4516381621360779
The modified gen p mean: 0.4512166976928711, gen p mean: -0.1109442487359047, mean p set: 0.4517951011657715
loss_pred:0.015601172111928463, decouple_loss:0.000497797504067421
loss_pred:0.015603880397975445, decouple_loss:0.0004699331184383482
2023-05-02 05:29:10 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12208785116672516, mean p set: 0.4502691626548767
loss_pred:0.017083749175071716, decouple_loss:0.0005405082483775914
The modified gen p mean: 0.44953635334968567, gen p mean: -0.11670508980751038, mean p set: 0.4500633478164673
loss_pred:0.016334477812051773, decouple_loss:0.0006888819043524563
The modified gen p mean: 0.44982749223709106, gen p mean: -0.11656516045331955, mean p set: 0.45035696029663086
loss_pred:0.01659744791686535, decouple_loss:0.0005683039780706167
WV_1_PC_1_EH_0_PS_40, loss: 0.01670185476541519, avg_mse: 0.026084883138537407
current test mse: 0.026085
Iteration: 671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45057928562164307, gen p mean: -0.1079467236995697, mean p set: 0.4511549472808838
loss_pred:0.015816185623407364, decouple_loss:0.00042426559957675636
The modified gen p mean: 0.450633704662323, gen p mean: -0.102860227227211, mean p set: 0.45121118426322937The modified gen p mean: 0.4524402618408203, gen p mean: -0.109578937292099, mean p set: 0.45301714539527893
loss_pred:0.01622174307703972, decouple_loss:0.0005737616447731853loss_pred:0.015836035832762718, decouple_loss:0.0004900668282061815
Iteration: 672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45040982961654663, gen p mean: -0.10641628503799438, mean p set: 0.45098650455474854
loss_pred:0.01473549846559763, decouple_loss:0.0004757179704029113
The modified gen p mean: 0.4513619840145111, gen p mean: -0.10705853253602982, mean p set: 0.45193958282470703The modified gen p mean: 0.45055246353149414, gen p mean: -0.10610862076282501, mean p set: 0.4511306881904602
loss_pred:0.015142301097512245, decouple_loss:0.0006170315900817513
loss_pred:0.015086829662322998, decouple_loss:0.00040442898171022534
Iteration: 673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501187205314636, gen p mean: -0.10404042899608612, mean p set: 0.4506949186325073
loss_pred:0.01636165753006935, decouple_loss:0.0005754128214903176
The modified gen p mean: 0.4506217837333679, gen p mean: -0.09671396762132645, mean p set: 0.45119786262512207The modified gen p mean: 0.45144423842430115, gen p mean: -0.10432219505310059, mean p set: 0.45202142000198364
loss_pred:0.015779461711645126, decouple_loss:0.000613389303907752
loss_pred:0.0158193651586771, decouple_loss:0.0005272114067338407
Iteration: 674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45164844393730164, gen p mean: -0.10646023601293564, mean p set: 0.45222529768943787
loss_pred:0.015633217990398407, decouple_loss:0.0006404576706700027
The modified gen p mean: 0.4506974220275879, gen p mean: -0.10229386389255524, mean p set: 0.45127376914024353
loss_pred:0.01634455844759941, decouple_loss:0.0006189551204442978
The modified gen p mean: 0.4537631571292877, gen p mean: -0.10666540265083313, mean p set: 0.4543396830558777
loss_pred:0.015062532387673855, decouple_loss:0.0006375830853357911
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449083149433136, gen p mean: -0.11661042273044586, mean p set: 0.4496593773365021
The modified gen p mean: 0.44766175746917725, gen p mean: -0.11812417954206467, mean p set: 0.4482366442680359loss_pred:0.014219230972230434, decouple_loss:0.0005084452568553388
loss_pred:0.014622986316680908, decouple_loss:0.0006425511091947556
The modified gen p mean: 0.44968077540397644, gen p mean: -0.11664602905511856, mean p set: 0.45025789737701416
loss_pred:0.014199567027390003, decouple_loss:0.0005174556863494217
Iteration: 676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758009910583496, gen p mean: -0.11977261304855347, mean p set: 0.44815701246261597
loss_pred:0.015143955126404762, decouple_loss:0.00047872672439552844
The modified gen p mean: 0.4492540657520294, gen p mean: -0.11413496732711792, mean p set: 0.4498293101787567
loss_pred:0.0151614248752594, decouple_loss:0.0004889604169875383
The modified gen p mean: 0.4472697079181671, gen p mean: -0.1158958226442337, mean p set: 0.4478446841239929
loss_pred:0.015206476673483849, decouple_loss:0.0005871997564099729
Iteration: 677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447885662317276, gen p mean: -0.1114412471652031, mean p set: 0.44846025109291077
loss_pred:0.014672447927296162, decouple_loss:0.00042199870222248137
The modified gen p mean: 0.44768619537353516, gen p mean: -0.1172165647149086, mean p set: 0.44826218485832214
The modified gen p mean: 0.4471711814403534, gen p mean: -0.11484725028276443, mean p set: 0.447747141122818
loss_pred:0.014482354745268822, decouple_loss:0.0006975678261369467
loss_pred:0.015157712623476982, decouple_loss:0.000577819999307394
Iteration: 678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44703567028045654, gen p mean: -0.11663179099559784, mean p set: 0.44761136174201965
loss_pred:0.015099395997822285, decouple_loss:0.0004898309707641602
The modified gen p mean: 0.44789284467697144, gen p mean: -0.12015996873378754, mean p set: 0.44846752285957336
The modified gen p mean: 0.4481661021709442, gen p mean: -0.1100069060921669, mean p set: 0.44874149560928345
loss_pred:0.014513783156871796, decouple_loss:0.00065286282915622
loss_pred:0.014384903945028782, decouple_loss:0.0005297306342981756
Iteration: 679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753357768058777, gen p mean: -0.112137570977211, mean p set: 0.44810861349105835
loss_pred:0.014611545950174332, decouple_loss:0.0007797366706654429
The modified gen p mean: 0.44819265604019165, gen p mean: -0.11388981342315674, mean p set: 0.44876906275749207
loss_pred:0.013904568739235401, decouple_loss:0.0006893209065310657
The modified gen p mean: 0.4474790096282959, gen p mean: -0.11146481335163116, mean p set: 0.4480552673339844
loss_pred:0.01454541739076376, decouple_loss:0.0007104109390638769
Iteration: 680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472911059856415, gen p mean: -0.11099381744861603, mean p set: 0.4478660821914673
loss_pred:0.014698616228997707, decouple_loss:0.0005530630587600172
The modified gen p mean: 0.4478381276130676, gen p mean: -0.11218006908893585, mean p set: 0.44841110706329346
loss_pred:0.015428547747433186, decouple_loss:0.0004899837076663971
The modified gen p mean: 0.4473395347595215, gen p mean: -0.11403840035200119, mean p set: 0.44791606068611145
loss_pred:0.014772736467421055, decouple_loss:0.00048949068877846
2023-05-02 05:32:04 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11490429937839508, mean p set: 0.4502691626548767
loss_pred:0.01697700470685959, decouple_loss:0.0005059262621216476
The modified gen p mean: 0.44953399896621704, gen p mean: -0.10945125669240952, mean p set: 0.4500633478164673
loss_pred:0.01625773310661316, decouple_loss:0.0005097514949738979
The modified gen p mean: 0.4498251974582672, gen p mean: -0.10928668081760406, mean p set: 0.45035696029663086
loss_pred:0.01663822866976261, decouple_loss:0.0004532950115390122
WV_1_PC_1_EH_0_PS_40, loss: 0.016648806631565094, avg_mse: 0.025994930416345596
current test mse: 0.025995
Iteration: 681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44636034965515137, gen p mean: -0.11049968004226685, mean p set: 0.44693389534950256
loss_pred:0.015003564767539501, decouple_loss:0.00048178265569731593
The modified gen p mean: 0.4468189477920532, gen p mean: -0.1145171970129013, mean p set: 0.4473954439163208The modified gen p mean: 0.44833987951278687, gen p mean: -0.10964206606149673, mean p set: 0.4489155113697052
loss_pred:0.01527759525924921, decouple_loss:0.0004389698151499033
loss_pred:0.014702568762004375, decouple_loss:0.00046400431892834604
Iteration: 682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482988715171814, gen p mean: -0.11069803684949875, mean p set: 0.448875367641449
loss_pred:0.01486162468791008, decouple_loss:0.0004345472261775285
The modified gen p mean: 0.4474184215068817, gen p mean: -0.11138667166233063, mean p set: 0.4479939937591553The modified gen p mean: 0.4465104639530182, gen p mean: -0.10583589226007462, mean p set: 0.4470857083797455
loss_pred:0.014760129153728485, decouple_loss:0.0005625888588838279
loss_pred:0.01569921337068081, decouple_loss:0.0005486514419317245
Iteration: 683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806477427482605, gen p mean: -0.11236469447612762, mean p set: 0.4486396908760071
loss_pred:0.014939130283892155, decouple_loss:0.0006725499406456947
The modified gen p mean: 0.4468080401420593, gen p mean: -0.10907205194234848, mean p set: 0.44738268852233887The modified gen p mean: 0.44781994819641113, gen p mean: -0.11493625491857529, mean p set: 0.4483965039253235
loss_pred:0.0154633279889822, decouple_loss:0.0004798558948095888
loss_pred:0.014701037667691708, decouple_loss:0.0006932499236427248
Iteration: 684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795045256614685, gen p mean: -0.11064370721578598, mean p set: 0.4485248327255249
loss_pred:0.014627188444137573, decouple_loss:0.0005702636553905904
The modified gen p mean: 0.4484778940677643, gen p mean: -0.12426309287548065, mean p set: 0.44905540347099304
loss_pred:0.01477010641247034, decouple_loss:0.0005610520020127296
The modified gen p mean: 0.4478774964809418, gen p mean: -0.11373640596866608, mean p set: 0.4484524726867676
loss_pred:0.01493647787719965, decouple_loss:0.0004460182972252369
Iteration: 685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471049904823303, gen p mean: -0.11789315193891525, mean p set: 0.4476827085018158
loss_pred:0.014712978154420853, decouple_loss:0.0005001846584491432
The modified gen p mean: 0.4478544294834137, gen p mean: -0.12241711467504501, mean p set: 0.4484281837940216
loss_pred:0.015604168176651001, decouple_loss:0.0004441861528903246
The modified gen p mean: 0.44889140129089355, gen p mean: -0.11762280017137527, mean p set: 0.4494676887989044
loss_pred:0.014693964272737503, decouple_loss:0.0007168151787482202
Iteration: 686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677379727363586, gen p mean: -0.12410075217485428, mean p set: 0.4473487436771393
loss_pred:0.01510506309568882, decouple_loss:0.0004922338994219899
The modified gen p mean: 0.44890883564949036, gen p mean: -0.11240331828594208, mean p set: 0.449484258890152
The modified gen p mean: 0.448417067527771, gen p mean: -0.11492715775966644, mean p set: 0.4489942789077759
loss_pred:0.014621215872466564, decouple_loss:0.000643680861685425
loss_pred:0.0142609728500247, decouple_loss:0.0006111072725616395
Iteration: 687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476567208766937, gen p mean: -0.10661064088344574, mean p set: 0.4482302665710449
loss_pred:0.014289949089288712, decouple_loss:0.000532604637555778
The modified gen p mean: 0.4465877115726471, gen p mean: -0.11351195722818375, mean p set: 0.44716405868530273
The modified gen p mean: 0.44752612709999084, gen p mean: -0.12104038149118423, mean p set: 0.4481002688407898
loss_pred:0.014655334874987602, decouple_loss:0.0004988572327420115
loss_pred:0.014983568340539932, decouple_loss:0.0004370509705040604
Iteration: 688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447808176279068, gen p mean: -0.1105276420712471, mean p set: 0.4483831226825714
loss_pred:0.014311323873698711, decouple_loss:0.00038806640077382326
The modified gen p mean: 0.44811439514160156, gen p mean: -0.11062392592430115, mean p set: 0.4486897885799408
The modified gen p mean: 0.44769972562789917, gen p mean: -0.10717523843050003, mean p set: 0.44827526807785034
loss_pred:0.014447355642914772, decouple_loss:0.000347900262568146
loss_pred:0.014925966039299965, decouple_loss:0.00043730976176448166
Iteration: 689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44938477873802185, gen p mean: -0.11354277282953262, mean p set: 0.4499613046646118
loss_pred:0.014251317828893661, decouple_loss:0.0005125171155668795
The modified gen p mean: 0.4467778205871582, gen p mean: -0.11808912456035614, mean p set: 0.44735386967658997
loss_pred:0.015190524980425835, decouple_loss:0.00049439916620031
The modified gen p mean: 0.44756412506103516, gen p mean: -0.10792072117328644, mean p set: 0.44813862442970276
loss_pred:0.01510070264339447, decouple_loss:0.0004214652581140399
Iteration: 690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683122634887695, gen p mean: -0.11491597443819046, mean p set: 0.44740498065948486
loss_pred:0.014702796004712582, decouple_loss:0.0005971211940050125
The modified gen p mean: 0.4480067789554596, gen p mean: -0.11483653634786606, mean p set: 0.4485850930213928
The modified gen p mean: 0.4483789801597595, gen p mean: -0.11605221778154373, mean p set: 0.44895458221435547
loss_pred:0.014190524816513062, decouple_loss:0.0005708765820600092
loss_pred:0.014137670397758484, decouple_loss:0.0005500030820257962
2023-05-02 05:34:11 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12276515364646912, mean p set: 0.4502691626548767
loss_pred:0.016986101865768433, decouple_loss:0.0004316703707445413
The modified gen p mean: 0.4495376944541931, gen p mean: -0.11718336492776871, mean p set: 0.4500633478164673
loss_pred:0.01626325584948063, decouple_loss:0.00051183404866606
The modified gen p mean: 0.44982877373695374, gen p mean: -0.11687762290239334, mean p set: 0.45035696029663086
loss_pred:0.01656089723110199, decouple_loss:0.0004397782322485
WV_1_PC_1_EH_0_PS_40, loss: 0.016626473516225815, avg_mse: 0.025941459462046623
current test mse: 0.025941
Iteration: 691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470611810684204, gen p mean: -0.1229369267821312, mean p set: 0.4476391673088074
loss_pred:0.014523991383612156, decouple_loss:0.0004882621287833899
The modified gen p mean: 0.44607844948768616, gen p mean: -0.11594675481319427, mean p set: 0.44665467739105225The modified gen p mean: 0.44822773337364197, gen p mean: -0.11410051584243774, mean p set: 0.4488039016723633
loss_pred:0.015430498868227005, decouple_loss:0.00047560190432704985loss_pred:0.013633737340569496, decouple_loss:0.00044508505379781127
Iteration: 692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480186402797699, gen p mean: -0.1184113547205925, mean p set: 0.44859424233436584
loss_pred:0.014940712600946426, decouple_loss:0.00045961933210492134
The modified gen p mean: 0.44772475957870483, gen p mean: -0.12095581740140915, mean p set: 0.44829997420310974The modified gen p mean: 0.4463447332382202, gen p mean: -0.12799738347530365, mean p set: 0.44691917300224304
loss_pred:0.014921808615326881, decouple_loss:0.0006466434570029378
loss_pred:0.015105345286428928, decouple_loss:0.0005183981847949326
Iteration: 693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468843638896942, gen p mean: -0.11834349483251572, mean p set: 0.4474572539329529
loss_pred:0.014626418240368366, decouple_loss:0.0005421627429313958
The modified gen p mean: 0.4485282599925995, gen p mean: -0.12016124278306961, mean p set: 0.4491024613380432The modified gen p mean: 0.4466925263404846, gen p mean: -0.12439322471618652, mean p set: 0.4472673535346985
loss_pred:0.014180909842252731, decouple_loss:0.0004248924378771335
loss_pred:0.015143493190407753, decouple_loss:0.00047221945715136826
Iteration: 694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471760094165802, gen p mean: -0.12108027189970016, mean p set: 0.4477500915527344
loss_pred:0.014568667858839035, decouple_loss:0.0004637915699277073
The modified gen p mean: 0.447928249835968, gen p mean: -0.11928997933864594, mean p set: 0.44850608706474304
loss_pred:0.01373317837715149, decouple_loss:0.0004342844185885042
The modified gen p mean: 0.448259562253952, gen p mean: -0.12143658101558685, mean p set: 0.4488346576690674
loss_pred:0.014522272162139416, decouple_loss:0.0004132605972699821
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859951734542847, gen p mean: -0.12729880213737488, mean p set: 0.44917547702789307
The modified gen p mean: 0.4493156969547272, gen p mean: -0.1281326860189438, mean p set: 0.449893057346344
loss_pred:0.015296781435608864, decouple_loss:0.0006102689658291638
loss_pred:0.014601625502109528, decouple_loss:0.0004923325031995773
The modified gen p mean: 0.44773343205451965, gen p mean: -0.12436607480049133, mean p set: 0.4483092129230499
loss_pred:0.015061691403388977, decouple_loss:0.0005513577489182353
Iteration: 696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479108452796936, gen p mean: -0.1219777837395668, mean p set: 0.4484889805316925
loss_pred:0.015315013006329536, decouple_loss:0.0003889703075401485
The modified gen p mean: 0.447726845741272, gen p mean: -0.12285419553518295, mean p set: 0.44830194115638733
The modified gen p mean: 0.44862836599349976, gen p mean: -0.1265423446893692, mean p set: 0.4492034912109375
loss_pred:0.0152696892619133, decouple_loss:0.0004127497086301446
loss_pred:0.015480821952223778, decouple_loss:0.00046633166493847966
Iteration: 697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474344253540039, gen p mean: -0.12315458804368973, mean p set: 0.4480117857456207
loss_pred:0.015076041221618652, decouple_loss:0.00042716387542895973
The modified gen p mean: 0.44874295592308044, gen p mean: -0.12649723887443542, mean p set: 0.449317067861557
loss_pred:0.014668911695480347, decouple_loss:0.0004428727552294731
The modified gen p mean: 0.44890403747558594, gen p mean: -0.11822406947612762, mean p set: 0.449482798576355
loss_pred:0.015001996420323849, decouple_loss:0.0004897299222648144
Iteration: 698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492223262786865, gen p mean: -0.12564997375011444, mean p set: 0.4497983753681183
loss_pred:0.015383925288915634, decouple_loss:0.0006063061882741749
The modified gen p mean: 0.44935208559036255, gen p mean: -0.12036418169736862, mean p set: 0.4499293565750122
The modified gen p mean: 0.4477381408214569, gen p mean: -0.12194450199604034, mean p set: 0.4483141601085663
loss_pred:0.015154605731368065, decouple_loss:0.0005777365295216441
loss_pred:0.015004180371761322, decouple_loss:0.0005945652956143022
Iteration: 699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485206604003906, gen p mean: -0.1186886802315712, mean p set: 0.44909700751304626
loss_pred:0.014421964064240456, decouple_loss:0.0007143978727981448
The modified gen p mean: 0.44950443506240845, gen p mean: -0.11403945833444595, mean p set: 0.45008060336112976
loss_pred:0.014787925407290459, decouple_loss:0.0004715915129054338
The modified gen p mean: 0.44843703508377075, gen p mean: -0.12494225054979324, mean p set: 0.44901350140571594
loss_pred:0.015111261047422886, decouple_loss:0.0005348789854906499
Iteration: 700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477841854095459, gen p mean: -0.11955658346414566, mean p set: 0.44836267828941345
loss_pred:0.015789033845067024, decouple_loss:0.0005511103081516922
The modified gen p mean: 0.44750240445137024, gen p mean: -0.12218070030212402, mean p set: 0.4480784237384796
loss_pred:0.015819769352674484, decouple_loss:0.000449362734798342
The modified gen p mean: 0.44857972860336304, gen p mean: -0.11416991055011749, mean p set: 0.4491572082042694
loss_pred:0.014346485957503319, decouple_loss:0.0004745810874737799
2023-05-02 05:36:59 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12386713922023773, mean p set: 0.4502691626548767
loss_pred:0.016898304224014282, decouple_loss:0.0007544974214397371
The modified gen p mean: 0.449535071849823, gen p mean: -0.11825750023126602, mean p set: 0.4500633478164673
loss_pred:0.01612064801156521, decouple_loss:0.0005719054606743157
The modified gen p mean: 0.4498283863067627, gen p mean: -0.1179431900382042, mean p set: 0.45035696029663086
loss_pred:0.01650122180581093, decouple_loss:0.0006759178941138089
WV_1_PC_1_EH_0_PS_40, loss: 0.016540098935365677, avg_mse: 0.025771016255021095
current test mse: 0.025771
Iteration: 701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467307925224304, gen p mean: -0.11951375007629395, mean p set: 0.44730639457702637
loss_pred:0.015086222440004349, decouple_loss:0.0006077744765207171
The modified gen p mean: 0.44798561930656433, gen p mean: -0.11066931486129761, mean p set: 0.4485621154308319
loss_pred:0.01465405523777008, decouple_loss:0.0007219527033157647
The modified gen p mean: 0.44911694526672363, gen p mean: -0.12097550928592682, mean p set: 0.4496924579143524
loss_pred:0.014639046043157578, decouple_loss:0.0008526323945261538
Iteration: 702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876137375831604, gen p mean: -0.1255897879600525, mean p set: 0.44933804869651794
loss_pred:0.014178034849464893, decouple_loss:0.0007083381060510874
The modified gen p mean: 0.4488443434238434, gen p mean: -0.12327288836240768, mean p set: 0.44941920042037964The modified gen p mean: 0.4491924047470093, gen p mean: -0.12522386014461517, mean p set: 0.4497707486152649
loss_pred:0.015404514968395233, decouple_loss:0.0006794895743951201
loss_pred:0.014739922247827053, decouple_loss:0.0006287984433583915
Iteration: 703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482843279838562, gen p mean: -0.1200270727276802, mean p set: 0.4488602578639984
loss_pred:0.014865759760141373, decouple_loss:0.0005690170801244676
The modified gen p mean: 0.4484425187110901, gen p mean: -0.11963044106960297, mean p set: 0.44901934266090393The modified gen p mean: 0.4478653371334076, gen p mean: -0.12312520295381546, mean p set: 0.4484424889087677
loss_pred:0.014299827627837658, decouple_loss:0.0004934318130835891
loss_pred:0.015461424365639687, decouple_loss:0.00043194511090405285
Iteration: 704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876524806022644, gen p mean: -0.11695495992898941, mean p set: 0.44933751225471497
loss_pred:0.014807923696935177, decouple_loss:0.00047454616287723184
The modified gen p mean: 0.4486788511276245, gen p mean: -0.12436329573392868, mean p set: 0.4492538273334503
loss_pred:0.015397375449538231, decouple_loss:0.000655219191685319
The modified gen p mean: 0.4482843279838562, gen p mean: -0.11706690490245819, mean p set: 0.4488604962825775
loss_pred:0.014267101883888245, decouple_loss:0.0005171567318029702
Iteration: 705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480407238006592, gen p mean: -0.1219823881983757, mean p set: 0.4486178159713745
loss_pred:0.015166021883487701, decouple_loss:0.0007612016052007675
The modified gen p mean: 0.44855359196662903, gen p mean: -0.12497339397668839, mean p set: 0.4491303265094757
loss_pred:0.014456077478826046, decouple_loss:0.0006816028035245836
The modified gen p mean: 0.4487900733947754, gen p mean: -0.12221435457468033, mean p set: 0.4493674635887146
loss_pred:0.01495094783604145, decouple_loss:0.0005184434703551233
Iteration: 706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44826436042785645, gen p mean: -0.1200043186545372, mean p set: 0.44884148240089417
loss_pred:0.014163382351398468, decouple_loss:0.0006670360453426838
The modified gen p mean: 0.4481332302093506, gen p mean: -0.11128392815589905, mean p set: 0.44870755076408386
loss_pred:0.014088073745369911, decouple_loss:0.0007311080116778612
The modified gen p mean: 0.4481322765350342, gen p mean: -0.11616772413253784, mean p set: 0.4487088918685913
loss_pred:0.014376269653439522, decouple_loss:0.0006111266557127237
Iteration: 707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447435587644577, gen p mean: -0.12252172827720642, mean p set: 0.44801095128059387
loss_pred:0.015592479147017002, decouple_loss:0.0004991590976715088
The modified gen p mean: 0.4486585557460785, gen p mean: -0.11893158406019211, mean p set: 0.4492361843585968
The modified gen p mean: 0.4494064450263977, gen p mean: -0.1286524385213852, mean p set: 0.4499812126159668
loss_pred:0.01424859743565321, decouple_loss:0.0004971292219124734
loss_pred:0.01504205260425806, decouple_loss:0.0007231063209474087
Iteration: 708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475552439689636, gen p mean: -0.11976432055234909, mean p set: 0.4481314718723297
loss_pred:0.015811262652277946, decouple_loss:0.0004295301914680749
The modified gen p mean: 0.44970187544822693, gen p mean: -0.12188959866762161, mean p set: 0.4502778649330139
loss_pred:0.015477663837373257, decouple_loss:0.0006393246003426611
The modified gen p mean: 0.44931820034980774, gen p mean: -0.12437193840742111, mean p set: 0.449893593788147
loss_pred:0.01471475325524807, decouple_loss:0.0004570409655570984
Iteration: 709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746696949005127, gen p mean: -0.11074592173099518, mean p set: 0.44804272055625916
loss_pred:0.01450805738568306, decouple_loss:0.000640300044324249
The modified gen p mean: 0.44717851281166077, gen p mean: -0.12422831356525421, mean p set: 0.4477550983428955
The modified gen p mean: 0.44790107011795044, gen p mean: -0.12392658740282059, mean p set: 0.44847777485847473
loss_pred:0.015345769003033638, decouple_loss:0.0005016987561248243
loss_pred:0.015824712812900543, decouple_loss:0.0005207709036767483
Iteration: 710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489069879055023, gen p mean: -0.1290258914232254, mean p set: 0.44948384165763855
loss_pred:0.015403085388243198, decouple_loss:0.0005020956159569323
The modified gen p mean: 0.44760507345199585, gen p mean: -0.12377925962209702, mean p set: 0.4481810927391052
The modified gen p mean: 0.44731810688972473, gen p mean: -0.12411797046661377, mean p set: 0.44789305329322815
loss_pred:0.015593726187944412, decouple_loss:0.0004687608452513814
loss_pred:0.015396800823509693, decouple_loss:0.0005248142988421023
2023-05-02 05:39:06 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12744605541229248, mean p set: 0.4502691626548767
loss_pred:0.016947774216532707, decouple_loss:0.000648650573566556
The modified gen p mean: 0.44953545928001404, gen p mean: -0.12154275178909302, mean p set: 0.4500633478164673
The modified gen p mean: 0.4498288333415985, gen p mean: -0.1211141049861908, mean p set: 0.45035696029663086
loss_pred:0.016142912209033966, decouple_loss:0.000553307356312871
loss_pred:0.01648835465312004, decouple_loss:0.0005388471181504428
WV_1_PC_1_EH_0_PS_40, loss: 0.016555361449718475, avg_mse: 0.025834212079644203
current test mse: 0.025834
Iteration: 711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829797744750977, gen p mean: -0.12718984484672546, mean p set: 0.44887539744377136
loss_pred:0.015224839560687542, decouple_loss:0.0005575053510256112
The modified gen p mean: 0.4480203688144684, gen p mean: -0.1242009624838829, mean p set: 0.4485989212989807The modified gen p mean: 0.44974973797798157, gen p mean: -0.1219068318605423, mean p set: 0.45032650232315063
loss_pred:0.015576990321278572, decouple_loss:0.00047718529822304845
loss_pred:0.014584043063223362, decouple_loss:0.00042680674232542515
Iteration: 712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44704607129096985, gen p mean: -0.1210065558552742, mean p set: 0.44762104749679565
loss_pred:0.015293675474822521, decouple_loss:0.0006369493785314262
The modified gen p mean: 0.44710445404052734, gen p mean: -0.12241704761981964, mean p set: 0.44768157601356506The modified gen p mean: 0.44752657413482666, gen p mean: -0.1254008263349533, mean p set: 0.44810163974761963
loss_pred:0.015310677699744701, decouple_loss:0.0005206512869335711
loss_pred:0.014624694362282753, decouple_loss:0.000492239254526794
Iteration: 713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477892816066742, gen p mean: -0.12622076272964478, mean p set: 0.44836223125457764
loss_pred:0.015723222866654396, decouple_loss:0.00047173979692161083
The modified gen p mean: 0.4488382637500763, gen p mean: -0.12235184758901596, mean p set: 0.4494136571884155
loss_pred:0.014108262956142426, decouple_loss:0.0005093304789625108
The modified gen p mean: 0.44837093353271484, gen p mean: -0.12236586958169937, mean p set: 0.448948472738266
loss_pred:0.015610598027706146, decouple_loss:0.0004119368677493185
Iteration: 714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854775071144104, gen p mean: -0.12358007580041885, mean p set: 0.44912344217300415
loss_pred:0.013563272543251514, decouple_loss:0.00040327291935682297
The modified gen p mean: 0.44716066122055054, gen p mean: -0.12340841442346573, mean p set: 0.44773876667022705
loss_pred:0.015384301543235779, decouple_loss:0.0005574976676143706
The modified gen p mean: 0.44709262251853943, gen p mean: -0.12364991754293442, mean p set: 0.44766971468925476
loss_pred:0.015380802564322948, decouple_loss:0.00041701749432832
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
NaN value num: 0
Iteration: 715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502207338809967, gen p mean: -0.11499873548746109, mean p set: 0.4507977068424225
The modified gen p mean: 0.45323434472084045, gen p mean: -0.10822538286447525, mean p set: 0.45381149649620056
loss_pred:0.015351280570030212, decouple_loss:0.0006395725067704916
loss_pred:0.015391917899250984, decouple_loss:0.0005495931836776435
The modified gen p mean: 0.4512915015220642, gen p mean: -0.11238700151443481, mean p set: 0.4518677592277527
loss_pred:0.014984607696533203, decouple_loss:0.0005817302735522389
Iteration: 716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510563015937805, gen p mean: -0.10407084971666336, mean p set: 0.4516338109970093
loss_pred:0.015336578711867332, decouple_loss:0.0004203651915304363
The modified gen p mean: 0.45269522070884705, gen p mean: -0.10294283926486969, mean p set: 0.4532724618911743
The modified gen p mean: 0.4513159990310669, gen p mean: -0.11158417165279388, mean p set: 0.45189008116722107
loss_pred:0.015376213006675243, decouple_loss:0.0005840908852405846
loss_pred:0.015396973118185997, decouple_loss:0.0004775610286742449
Iteration: 717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45085716247558594, gen p mean: -0.10640481859445572, mean p set: 0.45143428444862366
The modified gen p mean: 0.4523197412490845, gen p mean: -0.10668516904115677, mean p set: 0.4528955817222595
loss_pred:0.014424285851418972, decouple_loss:0.0004112176538910717
loss_pred:0.015392250381410122, decouple_loss:0.0005831071175634861
The modified gen p mean: 0.45241984724998474, gen p mean: -0.10342516750097275, mean p set: 0.45299410820007324
loss_pred:0.015134313143789768, decouple_loss:0.0006576603627763689
Iteration: 718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45031389594078064, gen p mean: -0.09848811477422714, mean p set: 0.45089107751846313
loss_pred:0.015078652650117874, decouple_loss:0.0005452778423205018
The modified gen p mean: 0.4517059028148651, gen p mean: -0.1015079990029335, mean p set: 0.45228198170661926
loss_pred:0.015401192009449005, decouple_loss:0.0007490391726605594
The modified gen p mean: 0.45227375626564026, gen p mean: -0.10296457260847092, mean p set: 0.45285117626190186
loss_pred:0.015187760815024376, decouple_loss:0.0004461760981939733
Iteration: 719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524242579936981, gen p mean: -0.09761117398738861, mean p set: 0.45300236344337463
loss_pred:0.015172342769801617, decouple_loss:0.0005803757230751216
The modified gen p mean: 0.4512125849723816, gen p mean: -0.10217619687318802, mean p set: 0.4517892897129059
loss_pred:0.014885508455336094, decouple_loss:0.0003359663242008537
The modified gen p mean: 0.45332857966423035, gen p mean: -0.09822838008403778, mean p set: 0.45390620827674866
loss_pred:0.015485687181353569, decouple_loss:0.0004693463852163404
Iteration: 720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524638056755066, gen p mean: -0.10255763679742813, mean p set: 0.4530409872531891
loss_pred:0.01493029948323965, decouple_loss:0.0005425221752375364
The modified gen p mean: 0.4532577395439148, gen p mean: -0.10563882440328598, mean p set: 0.45383426547050476
The modified gen p mean: 0.45092102885246277, gen p mean: -0.10574472695589066, mean p set: 0.4514986276626587
loss_pred:0.015687229111790657, decouple_loss:0.0008050140459090471
loss_pred:0.015486044809222221, decouple_loss:0.0005255145370028913
2023-05-02 05:41:57 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1177440658211708, mean p set: 0.4502691626548767
loss_pred:0.01697678677737713, decouple_loss:0.0007965671247802675
The modified gen p mean: 0.449535071849823, gen p mean: -0.11216782033443451, mean p set: 0.4500633478164673
loss_pred:0.01625640131533146, decouple_loss:0.0005961860297247767
The modified gen p mean: 0.44982975721359253, gen p mean: -0.11171530187129974, mean p set: 0.45035696029663086
loss_pred:0.016560299322009087, decouple_loss:0.0005969764897599816
WV_1_PC_1_EH_0_PS_40, loss: 0.01663099229335785, avg_mse: 0.02598302811384201
current test mse: 0.025983
Iteration: 721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514768123626709, gen p mean: -0.10274554789066315, mean p set: 0.4520549178123474
loss_pred:0.016019271686673164, decouple_loss:0.0005474307690747082
The modified gen p mean: 0.4519655406475067, gen p mean: -0.1033480167388916, mean p set: 0.45254209637641907
loss_pred:0.014990235678851604, decouple_loss:0.00043409454519860446
The modified gen p mean: 0.45165616273880005, gen p mean: -0.10805618017911911, mean p set: 0.4522334337234497
loss_pred:0.014949483796954155, decouple_loss:0.0005708844983018935
Iteration: 722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526398777961731, gen p mean: -0.11124488711357117, mean p set: 0.45321789383888245
loss_pred:0.014940674416720867, decouple_loss:0.0005198511062189937
The modified gen p mean: 0.4509847164154053, gen p mean: -0.09902454912662506, mean p set: 0.4515622556209564The modified gen p mean: 0.45200231671333313, gen p mean: -0.10418864339590073, mean p set: 0.4525795578956604
loss_pred:0.01546961534768343, decouple_loss:0.0005165499751456082
loss_pred:0.015023336745798588, decouple_loss:0.000585111090913415
Iteration: 723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45115014910697937, gen p mean: -0.10066647827625275, mean p set: 0.45172739028930664
loss_pred:0.014969754964113235, decouple_loss:0.0005661077448166907
The modified gen p mean: 0.45124298334121704, gen p mean: -0.10955843329429626, mean p set: 0.45181846618652344
loss_pred:0.014841441996395588, decouple_loss:0.0006568723474629223
The modified gen p mean: 0.45200806856155396, gen p mean: -0.10676310956478119, mean p set: 0.45258164405822754
loss_pred:0.0150243965908885, decouple_loss:0.0008266238146461546
Iteration: 724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452177494764328, gen p mean: -0.11407151818275452, mean p set: 0.4527551829814911
loss_pred:0.015189738012850285, decouple_loss:0.0006483819452114403
The modified gen p mean: 0.45067277550697327, gen p mean: -0.10888401418924332, mean p set: 0.45124828815460205
loss_pred:0.01465562079101801, decouple_loss:0.0005495547084137797
The modified gen p mean: 0.4505138695240021, gen p mean: -0.111810103058815, mean p set: 0.4510918855667114
loss_pred:0.014576326124370098, decouple_loss:0.0006244596443139017
Iteration: 725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45093846321105957, gen p mean: -0.10972270369529724, mean p set: 0.45151615142822266
loss_pred:0.014917254447937012, decouple_loss:0.0006944133783690631
The modified gen p mean: 0.4530295431613922, gen p mean: -0.1073257103562355, mean p set: 0.45360562205314636
loss_pred:0.015116770751774311, decouple_loss:0.0006692447350360453
The modified gen p mean: 0.45202597975730896, gen p mean: -0.11300281435251236, mean p set: 0.4526018798351288
loss_pred:0.015094919130206108, decouple_loss:0.0005656401044689119
Iteration: 726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452877938747406, gen p mean: -0.1099366620182991, mean p set: 0.4534555673599243
loss_pred:0.01466986071318388, decouple_loss:0.0005961215938441455
The modified gen p mean: 0.4531136155128479, gen p mean: -0.11261510848999023, mean p set: 0.4536888301372528
The modified gen p mean: 0.4522855281829834, gen p mean: -0.11593413352966309, mean p set: 0.452862411737442
loss_pred:0.01617477834224701, decouple_loss:0.000675602292176336
loss_pred:0.015034128911793232, decouple_loss:0.0005857609212398529
Iteration: 727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45179831981658936, gen p mean: -0.11402513086795807, mean p set: 0.4523775279521942
loss_pred:0.014701424166560173, decouple_loss:0.0006196872564032674
The modified gen p mean: 0.45199573040008545, gen p mean: -0.11256908625364304, mean p set: 0.4525703489780426
The modified gen p mean: 0.45134109258651733, gen p mean: -0.11801248788833618, mean p set: 0.45191919803619385
loss_pred:0.014704436995089054, decouple_loss:0.0005285295192152262
loss_pred:0.01457785815000534, decouple_loss:0.0004082466766703874
Iteration: 728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530893564224243, gen p mean: -0.1102488785982132, mean p set: 0.4536671042442322
loss_pred:0.014584342949092388, decouple_loss:0.0006358125829137862
The modified gen p mean: 0.45286399126052856, gen p mean: -0.11114615201950073, mean p set: 0.45344221591949463
loss_pred:0.015071921050548553, decouple_loss:0.0007209921604953706
The modified gen p mean: 0.450850248336792, gen p mean: -0.11218307912349701, mean p set: 0.45142796635627747
loss_pred:0.01404283381998539, decouple_loss:0.000504603493027389
Iteration: 729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45079973340034485, gen p mean: -0.10939448326826096, mean p set: 0.451375812292099
loss_pred:0.015697667375206947, decouple_loss:0.0005227042711339891
The modified gen p mean: 0.4529834985733032, gen p mean: -0.10981642454862595, mean p set: 0.4535618722438812
The modified gen p mean: 0.45129433274269104, gen p mean: -0.11196403950452805, mean p set: 0.4518711566925049
loss_pred:0.01432147715240717, decouple_loss:0.0006454539252445102
loss_pred:0.015111011452972889, decouple_loss:0.00044504308607429266
Iteration: 730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511295258998871, gen p mean: -0.11559344083070755, mean p set: 0.45170727372169495
The modified gen p mean: 0.4535432755947113, gen p mean: -0.1102772131562233, mean p set: 0.45412078499794006
loss_pred:0.014920569024980068, decouple_loss:0.0004602818808052689
loss_pred:0.014428889378905296, decouple_loss:0.0005146409384906292
The modified gen p mean: 0.45072704553604126, gen p mean: -0.11283144354820251, mean p set: 0.4513013958930969
loss_pred:0.014752501621842384, decouple_loss:0.0004941945662721992
2023-05-02 05:44:04 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12455000728368759, mean p set: 0.4502691626548767
loss_pred:0.016961580142378807, decouple_loss:0.0005500671686604619
The modified gen p mean: 0.44953447580337524, gen p mean: -0.11902221292257309, mean p set: 0.4500633478164673
loss_pred:0.016270054504275322, decouple_loss:0.0004986909916624427
The modified gen p mean: 0.44982731342315674, gen p mean: -0.11848516017198563, mean p set: 0.45035696029663086
loss_pred:0.016564814373850822, decouple_loss:0.0005011069588363171
WV_1_PC_1_EH_0_PS_40, loss: 0.01662464812397957, avg_mse: 0.025982597842812538
current test mse: 0.025983
Iteration: 731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45252060890197754, gen p mean: -0.10605156421661377, mean p set: 0.45309609174728394
loss_pred:0.01522603165358305, decouple_loss:0.0005821349332109094
The modified gen p mean: 0.45066407322883606, gen p mean: -0.11320484429597855, mean p set: 0.45124077796936035
loss_pred:0.014070209115743637, decouple_loss:0.0004610571195371449
The modified gen p mean: 0.4523557424545288, gen p mean: -0.11346813291311264, mean p set: 0.4529340863227844
loss_pred:0.015223254449665546, decouple_loss:0.000514786341227591
Iteration: 732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520719647407532, gen p mean: -0.111361563205719, mean p set: 0.4526480436325073
loss_pred:0.01464861910790205, decouple_loss:0.0005532861687242985
The modified gen p mean: 0.451382577419281, gen p mean: -0.1155053898692131, mean p set: 0.4519580900669098The modified gen p mean: 0.4501415193080902, gen p mean: -0.11286374926567078, mean p set: 0.4507158100605011
loss_pred:0.015077518299221992, decouple_loss:0.0005257401498965919
loss_pred:0.01439590286463499, decouple_loss:0.0006199133931659162
Iteration: 733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45311418175697327, gen p mean: -0.11685232073068619, mean p set: 0.45368802547454834
loss_pred:0.01558909472078085, decouple_loss:0.0006107799708843231
The modified gen p mean: 0.4525274634361267, gen p mean: -0.10816297680139542, mean p set: 0.4531055986881256
loss_pred:0.014806349761784077, decouple_loss:0.0005167982308194041
The modified gen p mean: 0.45179879665374756, gen p mean: -0.1128230169415474, mean p set: 0.45237478613853455
loss_pred:0.015428665094077587, decouple_loss:0.0005514131626114249
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
NaN value num: 0
Iteration: 734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503452777862549, gen p mean: -0.11271727085113525, mean p set: 0.45092108845710754
loss_pred:0.0172941442579031, decouple_loss:0.000585978792514652
The modified gen p mean: 0.44933056831359863, gen p mean: -0.12084861844778061, mean p set: 0.44990405440330505
loss_pred:0.016315927729010582, decouple_loss:0.0005238133016973734
The modified gen p mean: 0.45197802782058716, gen p mean: -0.11323539912700653, mean p set: 0.45255526900291443
loss_pred:0.016834761947393417, decouple_loss:0.0005466268630698323
Iteration: 735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44913449883461, gen p mean: -0.12465479969978333, mean p set: 0.4497132897377014
loss_pred:0.016194259747862816, decouple_loss:0.0006756402435712516
The modified gen p mean: 0.4492841064929962, gen p mean: -0.1221623346209526, mean p set: 0.44986429810523987
loss_pred:0.01629890315234661, decouple_loss:0.0005258484743535519
The modified gen p mean: 0.4497565031051636, gen p mean: -0.12285107374191284, mean p set: 0.45033276081085205
loss_pred:0.01594381220638752, decouple_loss:0.0008429403533227742
Iteration: 736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45008882880210876, gen p mean: -0.12292271107435226, mean p set: 0.4506663978099823
loss_pred:0.01624743826687336, decouple_loss:0.000590692856349051
The modified gen p mean: 0.4486718773841858, gen p mean: -0.12682370841503143, mean p set: 0.4492502808570862
loss_pred:0.01607389561831951, decouple_loss:0.0005202306783758104
The modified gen p mean: 0.4504607617855072, gen p mean: -0.11982590705156326, mean p set: 0.4510369300842285
loss_pred:0.016526000574231148, decouple_loss:0.0005916355294175446
Iteration: 737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501788020133972, gen p mean: -0.12254273146390915, mean p set: 0.450754314661026
loss_pred:0.01661871001124382, decouple_loss:0.0005332393920980394
The modified gen p mean: 0.44955021142959595, gen p mean: -0.13056491315364838, mean p set: 0.45012786984443665
The modified gen p mean: 0.44794270396232605, gen p mean: -0.12661127746105194, mean p set: 0.4485178589820862
loss_pred:0.015344317071139812, decouple_loss:0.0004664612642955035
loss_pred:0.01584472320973873, decouple_loss:0.0005090313497930765
Iteration: 738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480098485946655, gen p mean: -0.12477314472198486, mean p set: 0.44858694076538086
loss_pred:0.017020797356963158, decouple_loss:0.0005279633332975209
The modified gen p mean: 0.4492861032485962, gen p mean: -0.12389442324638367, mean p set: 0.44986405968666077
The modified gen p mean: 0.44852590560913086, gen p mean: -0.12515157461166382, mean p set: 0.4491018056869507
loss_pred:0.016464419662952423, decouple_loss:0.0006734314956702292
loss_pred:0.016540929675102234, decouple_loss:0.000773871666751802
Iteration: 739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853347539901733, gen p mean: -0.12634947896003723, mean p set: 0.44910579919815063
loss_pred:0.016256852075457573, decouple_loss:0.0005675095017068088
The modified gen p mean: 0.44887858629226685, gen p mean: -0.1200343444943428, mean p set: 0.449457585811615
The modified gen p mean: 0.4494686424732208, gen p mean: -0.12997028231620789, mean p set: 0.4500441253185272
loss_pred:0.016981396824121475, decouple_loss:0.0005160421133041382
loss_pred:0.01650603860616684, decouple_loss:0.0005129004712216556
Iteration: 740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499354064464569, gen p mean: -0.11862774938344955, mean p set: 0.45051151514053345
loss_pred:0.01667586714029312, decouple_loss:0.0005963843432255089
The modified gen p mean: 0.44983017444610596, gen p mean: -0.1185142919421196, mean p set: 0.45040687918663025
The modified gen p mean: 0.45013487339019775, gen p mean: -0.12059437483549118, mean p set: 0.4507102370262146
loss_pred:0.016283532604575157, decouple_loss:0.00043470997479744256
loss_pred:0.016267826780676842, decouple_loss:0.00041177618550136685
2023-05-02 05:46:53 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1290750801563263, mean p set: 0.4502691626548767
loss_pred:0.01712772808969021, decouple_loss:0.00047261943109333515
The modified gen p mean: 0.4495347738265991, gen p mean: -0.12328577786684036, mean p set: 0.4500633478164673
loss_pred:0.016382450237870216, decouple_loss:0.0005184182082302868
The modified gen p mean: 0.44982823729515076, gen p mean: -0.12259414792060852, mean p set: 0.45035696029663086
loss_pred:0.016675233840942383, decouple_loss:0.0004851208068430424
WV_1_PC_1_EH_0_PS_40, loss: 0.016753073781728745, avg_mse: 0.02611151896417141
current test mse: 0.026112
Iteration: 741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948846101760864, gen p mean: -0.11994857341051102, mean p set: 0.4500654339790344
The modified gen p mean: 0.4493102431297302, gen p mean: -0.11273510754108429, mean p set: 0.44988563656806946
loss_pred:0.015899091958999634, decouple_loss:0.0005554384551942348
loss_pred:0.01573050208389759, decouple_loss:0.0005927650490775704
The modified gen p mean: 0.44951751828193665, gen p mean: -0.11572191119194031, mean p set: 0.4500959813594818
loss_pred:0.016703970730304718, decouple_loss:0.0005391359445638955
Iteration: 742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889816641807556, gen p mean: -0.11766207218170166, mean p set: 0.4494756758213043
loss_pred:0.015619661659002304, decouple_loss:0.0005034793866798282
The modified gen p mean: 0.44950708746910095, gen p mean: -0.11088217794895172, mean p set: 0.45008236169815063The modified gen p mean: 0.4486450254917145, gen p mean: -0.11417575180530548, mean p set: 0.4492204785346985
loss_pred:0.016840176656842232, decouple_loss:0.0006815707893110812
loss_pred:0.01612808369100094, decouple_loss:0.0005385401309467852
Iteration: 743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489399492740631, gen p mean: -0.11500507593154907, mean p set: 0.4495159983634949
loss_pred:0.01607455313205719, decouple_loss:0.0005404451512731612
The modified gen p mean: 0.44967323541641235, gen p mean: -0.11224514245986938, mean p set: 0.4502537250518799
loss_pred:0.01570923440158367, decouple_loss:0.0006741592660546303
The modified gen p mean: 0.45022329688072205, gen p mean: -0.10821915417909622, mean p set: 0.4508011043071747
loss_pred:0.01653205044567585, decouple_loss:0.0005543530569411814
Iteration: 744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958359003067017, gen p mean: -0.11316297203302383, mean p set: 0.45016080141067505
loss_pred:0.015810057520866394, decouple_loss:0.00045643860357813537
The modified gen p mean: 0.4491018056869507, gen p mean: -0.10664817690849304, mean p set: 0.44967761635780334
loss_pred:0.01650288514792919, decouple_loss:0.00044888225966133177
The modified gen p mean: 0.4491678774356842, gen p mean: -0.11028451472520828, mean p set: 0.4497425854206085
loss_pred:0.015863938257098198, decouple_loss:0.000490853504743427
Iteration: 745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44941121339797974, gen p mean: -0.11466774344444275, mean p set: 0.4499862790107727
loss_pred:0.015621915459632874, decouple_loss:0.0005318009061738849
The modified gen p mean: 0.44974401593208313, gen p mean: -0.10800565034151077, mean p set: 0.45032259821891785
loss_pred:0.01716586947441101, decouple_loss:0.0005713191931135952
The modified gen p mean: 0.4496857821941376, gen p mean: -0.10706447809934616, mean p set: 0.45026183128356934
loss_pred:0.016335170716047287, decouple_loss:0.0006659373175352812
Iteration: 746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45035767555236816, gen p mean: -0.11002606898546219, mean p set: 0.45093461871147156
loss_pred:0.016712481155991554, decouple_loss:0.0005330924759618938
The modified gen p mean: 0.4497111141681671, gen p mean: -0.11451058089733124, mean p set: 0.450285404920578
The modified gen p mean: 0.4502774178981781, gen p mean: -0.11282148212194443, mean p set: 0.4508536458015442
loss_pred:0.01596350409090519, decouple_loss:0.0006492322427220643
loss_pred:0.0156842190772295, decouple_loss:0.0004525178810581565
Iteration: 747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44949719309806824, gen p mean: -0.11030837148427963, mean p set: 0.45007210969924927
loss_pred:0.015775274485349655, decouple_loss:0.0004702272417489439
The modified gen p mean: 0.44854629039764404, gen p mean: -0.11519307643175125, mean p set: 0.44912293553352356
The modified gen p mean: 0.45053791999816895, gen p mean: -0.1132545918226242, mean p set: 0.4511137008666992
loss_pred:0.01686389558017254, decouple_loss:0.0007446766248904169
loss_pred:0.015712225809693336, decouple_loss:0.00047322281170636415
Iteration: 748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496506452560425, gen p mean: -0.11292213946580887, mean p set: 0.4502260982990265
loss_pred:0.015893831849098206, decouple_loss:0.0006209448911249638
The modified gen p mean: 0.44884273409843445, gen p mean: -0.11260749399662018, mean p set: 0.4494173526763916
The modified gen p mean: 0.44989243149757385, gen p mean: -0.10880126804113388, mean p set: 0.45046865940093994
loss_pred:0.016131646931171417, decouple_loss:0.0006647956324741244
loss_pred:0.015942633152008057, decouple_loss:0.0006490657106041908
Iteration: 749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500133991241455, gen p mean: -0.11223282665014267, mean p set: 0.4505922794342041
loss_pred:0.01585942693054676, decouple_loss:0.0005355107132345438
The modified gen p mean: 0.44934704899787903, gen p mean: -0.11857087910175323, mean p set: 0.44992440938949585
The modified gen p mean: 0.4489307999610901, gen p mean: -0.11855535209178925, mean p set: 0.4495038390159607
loss_pred:0.015806738287210464, decouple_loss:0.0006356841768138111
loss_pred:0.01562797650694847, decouple_loss:0.0006359534454531968
Iteration: 750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013347268104553, gen p mean: -0.11614491045475006, mean p set: 0.45070680975914
loss_pred:0.016514264047145844, decouple_loss:0.0005332423024810851
The modified gen p mean: 0.45163023471832275, gen p mean: -0.11617061495780945, mean p set: 0.45220738649368286
loss_pred:0.016254764050245285, decouple_loss:0.000553125748410821
The modified gen p mean: 0.4491191506385803, gen p mean: -0.10911460220813751, mean p set: 0.4496959447860718
loss_pred:0.01655159704387188, decouple_loss:0.0006068623042665422
2023-05-02 05:48:58 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13077421486377716, mean p set: 0.4502691626548767
loss_pred:0.016989169642329216, decouple_loss:0.0005024442216381431
The modified gen p mean: 0.4495343863964081, gen p mean: -0.1250334531068802, mean p set: 0.4500633478164673
loss_pred:0.01634031906723976, decouple_loss:0.0005950112827122211
The modified gen p mean: 0.4498274028301239, gen p mean: -0.1244695633649826, mean p set: 0.45035696029663086
loss_pred:0.016641270369291306, decouple_loss:0.0006222532247193158
WV_1_PC_1_EH_0_PS_40, loss: 0.01668558269739151, avg_mse: 0.026064524427056313
current test mse: 0.026065
Iteration: 751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892460107803345, gen p mean: -0.12351799756288528, mean p set: 0.44950413703918457
loss_pred:0.016861820593476295, decouple_loss:0.0005618475843220949
The modified gen p mean: 0.4505128860473633, gen p mean: -0.1175711452960968, mean p set: 0.45108816027641296The modified gen p mean: 0.4497148394584656, gen p mean: -0.11686867475509644, mean p set: 0.4502915143966675
loss_pred:0.01577453687787056, decouple_loss:0.0004920676583424211
loss_pred:0.01603640243411064, decouple_loss:0.000474781496450305
Iteration: 752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018884539604187, gen p mean: -0.1177029088139534, mean p set: 0.4507644772529602
loss_pred:0.016436327248811722, decouple_loss:0.00043602086952887475
The modified gen p mean: 0.4496793746948242, gen p mean: -0.11941678822040558, mean p set: 0.45025599002838135The modified gen p mean: 0.45132535696029663, gen p mean: -0.11837617307901382, mean p set: 0.45190247893333435
loss_pred:0.01596689037978649, decouple_loss:0.0006729088490828872loss_pred:0.01673148013651371, decouple_loss:0.0005908325547352433
Iteration: 753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44924280047416687, gen p mean: -0.11927340179681778, mean p set: 0.44981908798217773
loss_pred:0.01565784215927124, decouple_loss:0.0005690636462531984
The modified gen p mean: 0.4495377838611603, gen p mean: -0.11854450404644012, mean p set: 0.4501130282878876
loss_pred:0.01579216495156288, decouple_loss:0.0005042750854045153
The modified gen p mean: 0.4494825601577759, gen p mean: -0.11855491250753403, mean p set: 0.4500577449798584
loss_pred:0.015251809731125832, decouple_loss:0.0005144841270521283
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
NaN value num: 0
Iteration: 754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44959890842437744, gen p mean: -0.1190110445022583, mean p set: 0.45017653703689575
loss_pred:0.01618487946689129, decouple_loss:0.00045809164294041693
The modified gen p mean: 0.4493335485458374, gen p mean: -0.11633915454149246, mean p set: 0.4499092102050781
loss_pred:0.015059486962854862, decouple_loss:0.0003831392095889896
The modified gen p mean: 0.4483473002910614, gen p mean: -0.11872771382331848, mean p set: 0.4489240050315857
loss_pred:0.015483936294913292, decouple_loss:0.0005504326545633376
Iteration: 755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489035904407501, gen p mean: -0.11713209003210068, mean p set: 0.44948065280914307
loss_pred:0.015341216698288918, decouple_loss:0.0004776143468916416
The modified gen p mean: 0.4497138559818268, gen p mean: -0.1201791912317276, mean p set: 0.4502924084663391
loss_pred:0.015155326575040817, decouple_loss:0.0006775786750949919
The modified gen p mean: 0.4486561119556427, gen p mean: -0.11801555752754211, mean p set: 0.4492347836494446
loss_pred:0.01561446487903595, decouple_loss:0.0005505754961632192
Iteration: 756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45166465640068054, gen p mean: -0.11733734607696533, mean p set: 0.45223987102508545
loss_pred:0.015049885958433151, decouple_loss:0.0007297244155779481
The modified gen p mean: 0.45120471715927124, gen p mean: -0.11601018905639648, mean p set: 0.4517812132835388
loss_pred:0.015267599374055862, decouple_loss:0.0005929048638790846
The modified gen p mean: 0.44881001114845276, gen p mean: -0.11692138016223907, mean p set: 0.4493871033191681
loss_pred:0.014782620593905449, decouple_loss:0.0005427018040791154
Iteration: 757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475211799144745, gen p mean: -0.12206721305847168, mean p set: 0.44809725880622864
loss_pred:0.015244465321302414, decouple_loss:0.0006469482323154807
The modified gen p mean: 0.4498051702976227, gen p mean: -0.11908788233995438, mean p set: 0.45038262009620667
loss_pred:0.015614681877195835, decouple_loss:0.0004939803620800376
The modified gen p mean: 0.4494563639163971, gen p mean: -0.11641018092632294, mean p set: 0.4500344693660736
loss_pred:0.016223540529608727, decouple_loss:0.0005222641048021615
Iteration: 758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892793893814087, gen p mean: -0.11723265051841736, mean p set: 0.4495048522949219
loss_pred:0.01573568396270275, decouple_loss:0.000533609592821449
The modified gen p mean: 0.45092183351516724, gen p mean: -0.11444587260484695, mean p set: 0.45149844884872437
loss_pred:0.015219722874462605, decouple_loss:0.0006201432552188635
The modified gen p mean: 0.4517713487148285, gen p mean: -0.11958114802837372, mean p set: 0.45234742760658264
loss_pred:0.015243852511048317, decouple_loss:0.0006061069434508681
Iteration: 759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44865745306015015, gen p mean: -0.11814045906066895, mean p set: 0.4492340683937073
loss_pred:0.01603112556040287, decouple_loss:0.00047607996384613216
The modified gen p mean: 0.45080509781837463, gen p mean: -0.11948345601558685, mean p set: 0.4513806104660034
loss_pred:0.015062987804412842, decouple_loss:0.0007365274359472096
The modified gen p mean: 0.448393851518631, gen p mean: -0.12089048326015472, mean p set: 0.4489700198173523
loss_pred:0.0154946967959404, decouple_loss:0.0007576798088848591
Iteration: 760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513958692550659, gen p mean: -0.11741673201322556, mean p set: 0.45197123289108276
loss_pred:0.01610255427658558, decouple_loss:0.000521965092048049
The modified gen p mean: 0.4486592411994934, gen p mean: -0.11486972123384476, mean p set: 0.44923514127731323
loss_pred:0.015783878043293953, decouple_loss:0.0006162389181554317
The modified gen p mean: 0.44817501306533813, gen p mean: -0.1159086525440216, mean p set: 0.4487510621547699
loss_pred:0.015771890059113503, decouple_loss:0.0005418594228103757
2023-05-02 05:51:41 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12842832505702972, mean p set: 0.4502691626548767
loss_pred:0.016919558867812157, decouple_loss:0.00046316158841364086
The modified gen p mean: 0.449535071849823, gen p mean: -0.12253294885158539, mean p set: 0.4500633478164673
loss_pred:0.016244949772953987, decouple_loss:0.0005140646826475859
The modified gen p mean: 0.44982773065567017, gen p mean: -0.12206964194774628, mean p set: 0.45035696029663086
loss_pred:0.01663759909570217, decouple_loss:0.0006221662042662501
WV_1_PC_1_EH_0_PS_40, loss: 0.01662736013531685, avg_mse: 0.025980962440371513
current test mse: 0.025981
Iteration: 761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013728737831116, gen p mean: -0.11838774383068085, mean p set: 0.45071372389793396
loss_pred:0.014941495843231678, decouple_loss:0.0005935024819336832
The modified gen p mean: 0.45175138115882874, gen p mean: -0.11573141068220139, mean p set: 0.4523291289806366
loss_pred:0.015221352688968182, decouple_loss:0.00043035310227423906
The modified gen p mean: 0.45077309012413025, gen p mean: -0.11077301949262619, mean p set: 0.4513488709926605
loss_pred:0.01538836769759655, decouple_loss:0.0005025292048230767
Iteration: 762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44888144731521606, gen p mean: -0.11538052558898926, mean p set: 0.4494549334049225
loss_pred:0.01565401442348957, decouple_loss:0.0005106378230266273
The modified gen p mean: 0.44891369342803955, gen p mean: -0.11561298370361328, mean p set: 0.4494934380054474The modified gen p mean: 0.44923728704452515, gen p mean: -0.11517412960529327, mean p set: 0.44981491565704346
loss_pred:0.015041508711874485, decouple_loss:0.0005575906252488494
loss_pred:0.01627061516046524, decouple_loss:0.0005134056555107236
Iteration: 763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496811032295227, gen p mean: -0.11892927438020706, mean p set: 0.4502566158771515
loss_pred:0.016286656260490417, decouple_loss:0.0006416683900170028
The modified gen p mean: 0.44930851459503174, gen p mean: -0.11669854819774628, mean p set: 0.4498836100101471The modified gen p mean: 0.44937050342559814, gen p mean: -0.11719989776611328, mean p set: 0.4499458968639374
loss_pred:0.0157130416482687, decouple_loss:0.0004958054632879794
loss_pred:0.015549905598163605, decouple_loss:0.0004536487103905529
Iteration: 764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824421405792236, gen p mean: -0.11440232396125793, mean p set: 0.4488198161125183
loss_pred:0.016083020716905594, decouple_loss:0.00043726133299060166
The modified gen p mean: 0.44963589310646057, gen p mean: -0.120798259973526, mean p set: 0.4502134323120117
loss_pred:0.015047818422317505, decouple_loss:0.0005066022276878357
The modified gen p mean: 0.4504188895225525, gen p mean: -0.11827662587165833, mean p set: 0.45099538564682007
loss_pred:0.01490026619285345, decouple_loss:0.0005297999596223235
Iteration: 765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488760828971863, gen p mean: -0.1152854710817337, mean p set: 0.4494513273239136
loss_pred:0.015410218387842178, decouple_loss:0.0005613555549643934
The modified gen p mean: 0.4480274021625519, gen p mean: -0.12434984743595123, mean p set: 0.44860586524009705
loss_pred:0.015788327902555466, decouple_loss:0.0004578156513161957
The modified gen p mean: 0.4489879012107849, gen p mean: -0.11646049469709396, mean p set: 0.449567049741745
loss_pred:0.015607697889208794, decouple_loss:0.00044102821266278625
Iteration: 766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449540376663208, gen p mean: -0.11871723085641861, mean p set: 0.45011773705482483
loss_pred:0.01581348292529583, decouple_loss:0.0004733529349323362
The modified gen p mean: 0.4485979974269867, gen p mean: -0.11526529490947723, mean p set: 0.4491738975048065
loss_pred:0.01611463725566864, decouple_loss:0.0004144305130466819
The modified gen p mean: 0.4500955641269684, gen p mean: -0.11853870749473572, mean p set: 0.45067182183265686
loss_pred:0.014743038453161716, decouple_loss:0.0005302421632222831
Iteration: 767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45237621665000916, gen p mean: -0.11869269609451294, mean p set: 0.4529503583908081
loss_pred:0.01538825687021017, decouple_loss:0.0004780175513587892
The modified gen p mean: 0.4505317211151123, gen p mean: -0.12051990628242493, mean p set: 0.4511091411113739
loss_pred:0.015127353370189667, decouple_loss:0.0004816056462004781
The modified gen p mean: 0.44888779520988464, gen p mean: -0.1206970140337944, mean p set: 0.4494612514972687
loss_pred:0.01567458175122738, decouple_loss:0.0005602604360319674
Iteration: 768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493522346019745, gen p mean: -0.12268645316362381, mean p set: 0.4499289393424988
loss_pred:0.014998454600572586, decouple_loss:0.0005132252117618918
The modified gen p mean: 0.44804835319519043, gen p mean: -0.12106367200613022, mean p set: 0.44862303137779236
loss_pred:0.014824530109763145, decouple_loss:0.0005536474054679275
The modified gen p mean: 0.4500238299369812, gen p mean: -0.1203634962439537, mean p set: 0.45059719681739807
loss_pred:0.014880846254527569, decouple_loss:0.0004995231283828616
Iteration: 769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499335289001465, gen p mean: -0.11953793466091156, mean p set: 0.450508713722229
loss_pred:0.014226485043764114, decouple_loss:0.0005364276585169137
The modified gen p mean: 0.4492235779762268, gen p mean: -0.12073851376771927, mean p set: 0.4498039484024048
loss_pred:0.015475641936063766, decouple_loss:0.0005104310694150627
The modified gen p mean: 0.4482864737510681, gen p mean: -0.11894910782575607, mean p set: 0.44886186718940735
loss_pred:0.0161330197006464, decouple_loss:0.0006181160570122302
Iteration: 770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44896531105041504, gen p mean: -0.11734236031770706, mean p set: 0.44954103231430054
loss_pred:0.016019217669963837, decouple_loss:0.00042741300421766937
The modified gen p mean: 0.4477970004081726, gen p mean: -0.1246696412563324, mean p set: 0.44837433099746704
loss_pred:0.015287789516150951, decouple_loss:0.00044913310557603836
The modified gen p mean: 0.4500836730003357, gen p mean: -0.11835550516843796, mean p set: 0.450663685798645
loss_pred:0.014685006812214851, decouple_loss:0.00047442069626413286
2023-05-02 05:53:45 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1296081244945526, mean p set: 0.4502691626548767
loss_pred:0.016946861520409584, decouple_loss:0.00047917000483721495
The modified gen p mean: 0.4495358467102051, gen p mean: -0.12345211952924728, mean p set: 0.4500633478164673
loss_pred:0.016268346458673477, decouple_loss:0.0005724823568016291
The modified gen p mean: 0.44983163475990295, gen p mean: -0.1228143572807312, mean p set: 0.45035696029663086
loss_pred:0.016672566533088684, decouple_loss:0.0006450489163398743
WV_1_PC_1_EH_0_PS_40, loss: 0.01665753684937954, avg_mse: 0.02603554166853428
current test mse: 0.026036
Iteration: 771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521484971046448, gen p mean: -0.12053990364074707, mean p set: 0.4527266025543213
loss_pred:0.015617079101502895, decouple_loss:0.0005387967103160918
The modified gen p mean: 0.4489977955818176, gen p mean: -0.11851993948221207, mean p set: 0.4495765268802643The modified gen p mean: 0.44815531373023987, gen p mean: -0.11900622397661209, mean p set: 0.44873207807540894
loss_pred:0.015264795161783695, decouple_loss:0.00043806072790175676loss_pred:0.01537442859262228, decouple_loss:0.0005139551940374076
Iteration: 772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071694254875183, gen p mean: -0.11222591251134872, mean p set: 0.45129647850990295
loss_pred:0.015352562069892883, decouple_loss:0.0007020895718596876
The modified gen p mean: 0.44893455505371094, gen p mean: -0.11798233538866043, mean p set: 0.4495103359222412The modified gen p mean: 0.44956648349761963, gen p mean: -0.11755857616662979, mean p set: 0.45014408230781555
loss_pred:0.015467314049601555, decouple_loss:0.0006153256981633604loss_pred:0.015559238381683826, decouple_loss:0.0006411935901269317
Iteration: 773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501759111881256, gen p mean: -0.11997680366039276, mean p set: 0.4507533609867096
loss_pred:0.015014225617051125, decouple_loss:0.0004913269076496363
The modified gen p mean: 0.4522539973258972, gen p mean: -0.11686143279075623, mean p set: 0.4528312385082245
loss_pred:0.014984317123889923, decouple_loss:0.0006248097051866353
The modified gen p mean: 0.450602263212204, gen p mean: -0.11594293266534805, mean p set: 0.45117899775505066
loss_pred:0.014862011186778545, decouple_loss:0.0005771434516645968
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474446773529053, gen p mean: -0.126580148935318, mean p set: 0.4480225145816803
loss_pred:0.01516298484057188, decouple_loss:0.0004749339132104069
The modified gen p mean: 0.44739198684692383, gen p mean: -0.12516842782497406, mean p set: 0.44796544313430786
loss_pred:0.01480010338127613, decouple_loss:0.000551548961084336
The modified gen p mean: 0.4485405683517456, gen p mean: -0.12533524632453918, mean p set: 0.4491168260574341
loss_pred:0.014989563263952732, decouple_loss:0.00046334945363923907
Iteration: 775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931262731552124, gen p mean: -0.12075600028038025, mean p set: 0.44988885521888733
loss_pred:0.014747939072549343, decouple_loss:0.0005142476293258369
The modified gen p mean: 0.4487427771091461, gen p mean: -0.12024185806512833, mean p set: 0.449319064617157
loss_pred:0.01447794958949089, decouple_loss:0.00047582885599695146
The modified gen p mean: 0.44751644134521484, gen p mean: -0.12297769635915756, mean p set: 0.44809263944625854
loss_pred:0.014383061788976192, decouple_loss:0.0005421536625362933
Iteration: 776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492594301700592, gen p mean: -0.11902444809675217, mean p set: 0.44983553886413574
loss_pred:0.014325928874313831, decouple_loss:0.0005151255172677338
The modified gen p mean: 0.44865304231643677, gen p mean: -0.12078310549259186, mean p set: 0.4492274820804596
loss_pred:0.014197367243468761, decouple_loss:0.00046235808986239135
The modified gen p mean: 0.4483779966831207, gen p mean: -0.13023504614830017, mean p set: 0.44895556569099426
loss_pred:0.01471854280680418, decouple_loss:0.0005888613522984087
Iteration: 777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489903151988983, gen p mean: -0.12547925114631653, mean p set: 0.4495646357536316
loss_pred:0.01440335065126419, decouple_loss:0.00045206467621028423
The modified gen p mean: 0.4482363760471344, gen p mean: -0.1181742250919342, mean p set: 0.4488143026828766
The modified gen p mean: 0.446058988571167, gen p mean: -0.12363403290510178, mean p set: 0.44663533568382263
loss_pred:0.014332393184304237, decouple_loss:0.00044432716094888747
loss_pred:0.014306707307696342, decouple_loss:0.0004749406944029033
Iteration: 778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765523076057434, gen p mean: -0.1209326684474945, mean p set: 0.4482307732105255
loss_pred:0.014170701615512371, decouple_loss:0.0004833171551581472
The modified gen p mean: 0.44856396317481995, gen p mean: -0.11186028271913528, mean p set: 0.44913890957832336
The modified gen p mean: 0.44913941621780396, gen p mean: -0.12553177773952484, mean p set: 0.44971415400505066
loss_pred:0.014261716976761818, decouple_loss:0.000439320458099246
loss_pred:0.01474353764206171, decouple_loss:0.0004986354615539312
Iteration: 779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464662969112396, gen p mean: -0.1213451400399208, mean p set: 0.44704070687294006
loss_pred:0.013920743949711323, decouple_loss:0.00044669542694464326
The modified gen p mean: 0.44826027750968933, gen p mean: -0.1147254928946495, mean p set: 0.44883567094802856
loss_pred:0.014634115621447563, decouple_loss:0.0004092800081707537
The modified gen p mean: 0.44831281900405884, gen p mean: -0.11647756397724152, mean p set: 0.4488862454891205
loss_pred:0.01451807375997305, decouple_loss:0.00047668928164057434
Iteration: 780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462985396385193, gen p mean: -0.12525609135627747, mean p set: 0.4468747675418854
loss_pred:0.014680967666208744, decouple_loss:0.0005598113057203591
The modified gen p mean: 0.4507858157157898, gen p mean: -0.11668150126934052, mean p set: 0.4513660967350006
loss_pred:0.014339610002934933, decouple_loss:0.0006393286748789251
The modified gen p mean: 0.44819167256355286, gen p mean: -0.1174350380897522, mean p set: 0.44876742362976074
loss_pred:0.014499411918222904, decouple_loss:0.000560739659704268
2023-05-02 05:56:35 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12327102571725845, mean p set: 0.4502691626548767
loss_pred:0.017031004652380943, decouple_loss:0.0004939404898323119
The modified gen p mean: 0.44953396916389465, gen p mean: -0.11721737682819366, mean p set: 0.4500633478164673
loss_pred:0.016231706365942955, decouple_loss:0.00047867398825474083
The modified gen p mean: 0.4498286843299866, gen p mean: -0.11644809693098068, mean p set: 0.45035696029663086
loss_pred:0.016659632325172424, decouple_loss:0.0004854352737311274
WV_1_PC_1_EH_0_PS_40, loss: 0.016665082424879074, avg_mse: 0.025959668681025505
current test mse: 0.02596
Iteration: 781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464125335216522, gen p mean: -0.12549522519111633, mean p set: 0.446990966796875
loss_pred:0.014322183094918728, decouple_loss:0.00045390892773866653
The modified gen p mean: 0.4472273588180542, gen p mean: -0.11783970147371292, mean p set: 0.44780102372169495The modified gen p mean: 0.4482789635658264, gen p mean: -0.1142343133687973, mean p set: 0.44885557889938354
loss_pred:0.015102921985089779, decouple_loss:0.0005091683124192059
loss_pred:0.013966169208288193, decouple_loss:0.0003733331977855414
Iteration: 782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749853014945984, gen p mean: -0.11873509734869003, mean p set: 0.4480714499950409
loss_pred:0.013825491070747375, decouple_loss:0.0004796056018676609
The modified gen p mean: 0.4486662447452545, gen p mean: -0.10865559428930283, mean p set: 0.4492424428462982The modified gen p mean: 0.4474693834781647, gen p mean: -0.12235269695520401, mean p set: 0.44804564118385315
loss_pred:0.01393035613000393, decouple_loss:0.00047302560415118933
loss_pred:0.014377866871654987, decouple_loss:0.0004708787309937179
Iteration: 783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481554627418518, gen p mean: -0.1165105476975441, mean p set: 0.4487343728542328
loss_pred:0.01512648444622755, decouple_loss:0.0005608747596852481
The modified gen p mean: 0.447681188583374, gen p mean: -0.11110593378543854, mean p set: 0.4482579529285431The modified gen p mean: 0.44821974635124207, gen p mean: -0.11511571705341339, mean p set: 0.44879457354545593
loss_pred:0.014189187437295914, decouple_loss:0.0005392562597990036
loss_pred:0.014104054309427738, decouple_loss:0.00046086698421277106
Iteration: 784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852152466773987, gen p mean: -0.11684147268533707, mean p set: 0.4490965008735657
loss_pred:0.014383831061422825, decouple_loss:0.00046400443534366786
The modified gen p mean: 0.4479672312736511, gen p mean: -0.10819287598133087, mean p set: 0.44854292273521423
loss_pred:0.014011434279382229, decouple_loss:0.00040256051579490304
The modified gen p mean: 0.44786956906318665, gen p mean: -0.11394749581813812, mean p set: 0.44844454526901245
loss_pred:0.013842512853443623, decouple_loss:0.0005222723120823503
Iteration: 785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482519328594208, gen p mean: -0.11996088176965714, mean p set: 0.4488264322280884
loss_pred:0.014090628363192081, decouple_loss:0.0005308902473188937
The modified gen p mean: 0.4495258033275604, gen p mean: -0.11640815436840057, mean p set: 0.4501021206378937
loss_pred:0.014182831160724163, decouple_loss:0.0004719547287095338
The modified gen p mean: 0.44772887229919434, gen p mean: -0.1117529422044754, mean p set: 0.44830387830734253
loss_pred:0.015073626302182674, decouple_loss:0.00047173278289847076
Iteration: 786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777271151542664, gen p mean: -0.11820825189352036, mean p set: 0.4483499228954315
The modified gen p mean: 0.44840919971466064, gen p mean: -0.11098772287368774, mean p set: 0.44898515939712524
loss_pred:0.01407487504184246, decouple_loss:0.00044048766721971333
loss_pred:0.014066138304769993, decouple_loss:0.0004916507168672979
The modified gen p mean: 0.4480915367603302, gen p mean: -0.11455733329057693, mean p set: 0.44866693019866943
loss_pred:0.014204169623553753, decouple_loss:0.0004241904243826866
Iteration: 787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45008769631385803, gen p mean: -0.11599884182214737, mean p set: 0.45066288113594055
The modified gen p mean: 0.44639289379119873, gen p mean: -0.12046772986650467, mean p set: 0.44696733355522156
loss_pred:0.013981332071125507, decouple_loss:0.0004913502489216626
loss_pred:0.014071029610931873, decouple_loss:0.0006162729114294052
The modified gen p mean: 0.44816622138023376, gen p mean: -0.12160944938659668, mean p set: 0.4487411379814148
loss_pred:0.013592706993222237, decouple_loss:0.00044588581658899784
Iteration: 788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808152318000793, gen p mean: -0.12169168144464493, mean p set: 0.4486563205718994
loss_pred:0.013738653622567654, decouple_loss:0.0004213506181258708
The modified gen p mean: 0.4471783936023712, gen p mean: -0.12181300669908524, mean p set: 0.44775673747062683
The modified gen p mean: 0.4486636519432068, gen p mean: -0.11633898317813873, mean p set: 0.4492388665676117
loss_pred:0.013791809789836407, decouple_loss:0.0005081240087747574
loss_pred:0.013712569139897823, decouple_loss:0.000517645908985287
Iteration: 789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480076730251312, gen p mean: -0.11620909720659256, mean p set: 0.4485855996608734
loss_pred:0.014242562465369701, decouple_loss:0.0005028933519497514
The modified gen p mean: 0.44800737500190735, gen p mean: -0.1126682385802269, mean p set: 0.4485826790332794
loss_pred:0.014017843641340733, decouple_loss:0.0005987501936033368
The modified gen p mean: 0.44779282808303833, gen p mean: -0.12207697331905365, mean p set: 0.44836726784706116
loss_pred:0.013474442064762115, decouple_loss:0.00040226205601356924
Iteration: 790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486238360404968, gen p mean: -0.10948774963617325, mean p set: 0.44919851422309875
The modified gen p mean: 0.44669923186302185, gen p mean: -0.11850534379482269, mean p set: 0.4472724497318268
loss_pred:0.014083419926464558, decouple_loss:0.0005008877487853169
loss_pred:0.014230655506253242, decouple_loss:0.00041733463876880705
The modified gen p mean: 0.4486936926841736, gen p mean: -0.11876491457223892, mean p set: 0.4492718279361725
loss_pred:0.014511854387819767, decouple_loss:0.0005145648028701544
2023-05-02 05:58:41 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1196463406085968, mean p set: 0.4502691626548767
loss_pred:0.01703009009361267, decouple_loss:0.000518675078637898
The modified gen p mean: 0.4495345950126648, gen p mean: -0.11393160372972488, mean p set: 0.4500633478164673
loss_pred:0.016310274600982666, decouple_loss:0.0005284514045342803
The modified gen p mean: 0.4498269259929657, gen p mean: -0.11348679661750793, mean p set: 0.45035696029663086
loss_pred:0.016620853915810585, decouple_loss:0.00057887815637514
WV_1_PC_1_EH_0_PS_40, loss: 0.016680840402841568, avg_mse: 0.026043405756354332
current test mse: 0.026043
Iteration: 791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472895562648773, gen p mean: -0.11903015524148941, mean p set: 0.4478631317615509
loss_pred:0.014304389245808125, decouple_loss:0.00044208866893313825
The modified gen p mean: 0.4486245810985565, gen p mean: -0.11159218847751617, mean p set: 0.44920095801353455The modified gen p mean: 0.4476987421512604, gen p mean: -0.11669103801250458, mean p set: 0.4482734203338623
loss_pred:0.013975482434034348, decouple_loss:0.0005270483670756221
loss_pred:0.014098433777689934, decouple_loss:0.000494428735692054
Iteration: 792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501090347766876, gen p mean: -0.11512938886880875, mean p set: 0.450685054063797
loss_pred:0.014261390082538128, decouple_loss:0.0004331283853389323
The modified gen p mean: 0.44819176197052, gen p mean: -0.12187504023313522, mean p set: 0.4487667679786682The modified gen p mean: 0.44757264852523804, gen p mean: -0.11575952172279358, mean p set: 0.4481477439403534
loss_pred:0.01423600222915411, decouple_loss:0.0003780898987315595loss_pred:0.014213570393621922, decouple_loss:0.00037086859811097383
Iteration: 793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697582721710205, gen p mean: -0.12493254989385605, mean p set: 0.44755133986473083
loss_pred:0.013325726613402367, decouple_loss:0.00048799478099681437
The modified gen p mean: 0.44783273339271545, gen p mean: -0.11600767821073532, mean p set: 0.448408842086792
loss_pred:0.014419483952224255, decouple_loss:0.0005252511473372579
The modified gen p mean: 0.44794872403144836, gen p mean: -0.11862768977880478, mean p set: 0.4485265016555786
loss_pred:0.013577260076999664, decouple_loss:0.0005757534527219832
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467839002609253, gen p mean: -0.11960561573505402, mean p set: 0.4473569989204407
loss_pred:0.01445129606872797, decouple_loss:0.0004257174441590905
The modified gen p mean: 0.44822171330451965, gen p mean: -0.12157547473907471, mean p set: 0.448797345161438
loss_pred:0.015069219283759594, decouple_loss:0.0005511835915967822
The modified gen p mean: 0.4479201138019562, gen p mean: -0.12126461416482925, mean p set: 0.4484971761703491
loss_pred:0.01441489439457655, decouple_loss:0.00045730744022876024
Iteration: 795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44637277722358704, gen p mean: -0.12245157361030579, mean p set: 0.4469473958015442
loss_pred:0.015275809913873672, decouple_loss:0.0005126279429532588
The modified gen p mean: 0.4468657374382019, gen p mean: -0.11973870545625687, mean p set: 0.44744372367858887
loss_pred:0.015103856101632118, decouple_loss:0.00051972916116938
The modified gen p mean: 0.44670385122299194, gen p mean: -0.12105726450681686, mean p set: 0.44728177785873413
loss_pred:0.015731431543827057, decouple_loss:0.0006417797412723303
Iteration: 796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491540491580963, gen p mean: -0.11756142973899841, mean p set: 0.4497283697128296
loss_pred:0.01451293658465147, decouple_loss:0.0006182914366945624
The modified gen p mean: 0.44791361689567566, gen p mean: -0.11651655286550522, mean p set: 0.4484897553920746
loss_pred:0.014988665468990803, decouple_loss:0.0005221528699621558
The modified gen p mean: 0.44842225313186646, gen p mean: -0.1186242401599884, mean p set: 0.44899824261665344
loss_pred:0.014646727591753006, decouple_loss:0.0005582081503234804
Iteration: 797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471415579319, gen p mean: -0.11738960444927216, mean p set: 0.4477183520793915
The modified gen p mean: 0.44695281982421875, gen p mean: -0.11355098336935043, mean p set: 0.44752857089042664
loss_pred:0.016114097088575363, decouple_loss:0.0004399278841447085
loss_pred:0.014769705943763256, decouple_loss:0.0007317832205444574
The modified gen p mean: 0.4464235305786133, gen p mean: -0.12271873652935028, mean p set: 0.44699788093566895
loss_pred:0.015206298790872097, decouple_loss:0.0005532483919523656
Iteration: 798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481523633003235, gen p mean: -0.12082678824663162, mean p set: 0.4487267732620239
The modified gen p mean: 0.4475312829017639, gen p mean: -0.12013334780931473, mean p set: 0.4481104910373688
loss_pred:0.014891521073877811, decouple_loss:0.0004961855011060834
loss_pred:0.014505780301988125, decouple_loss:0.00048435208736918867
The modified gen p mean: 0.4470657706260681, gen p mean: -0.1132739931344986, mean p set: 0.4476413428783417
loss_pred:0.014769773930311203, decouple_loss:0.0004738635034300387
Iteration: 799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478866457939148, gen p mean: -0.11800495535135269, mean p set: 0.44846174120903015
loss_pred:0.014833630062639713, decouple_loss:0.0005207607173360884
The modified gen p mean: 0.44695645570755005, gen p mean: -0.118280328810215, mean p set: 0.44753316044807434
loss_pred:0.015779094770550728, decouple_loss:0.0005684368661604822
The modified gen p mean: 0.4468231499195099, gen p mean: -0.1182132214307785, mean p set: 0.4473989009857178
loss_pred:0.01577221415936947, decouple_loss:0.0005587537889368832
Iteration: 800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472573697566986, gen p mean: -0.11418621242046356, mean p set: 0.4478318989276886
loss_pred:0.015550459735095501, decouple_loss:0.0005935683730058372
The modified gen p mean: 0.4468323290348053, gen p mean: -0.12024232000112534, mean p set: 0.4474082589149475
loss_pred:0.015915624797344208, decouple_loss:0.0007495929021388292
The modified gen p mean: 0.4468023180961609, gen p mean: -0.11290014535188675, mean p set: 0.44737815856933594
loss_pred:0.014866745099425316, decouple_loss:0.0006873407401144505
2023-05-02 06:01:28 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12317720055580139, mean p set: 0.4502691626548767
loss_pred:0.01699138805270195, decouple_loss:0.0005201539024710655
The modified gen p mean: 0.44953736662864685, gen p mean: -0.11797695606946945, mean p set: 0.4500633478164673
loss_pred:0.016325077041983604, decouple_loss:0.0006184539524838328
The modified gen p mean: 0.4498273730278015, gen p mean: -0.11779388785362244, mean p set: 0.45035696029663086
loss_pred:0.016598297283053398, decouple_loss:0.0005579714779742062
WV_1_PC_1_EH_0_PS_40, loss: 0.016666531562805176, avg_mse: 0.026027461513876915
current test mse: 0.026027
Iteration: 801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493166208267212, gen p mean: -0.11822070926427841, mean p set: 0.44989389181137085
loss_pred:0.014102273620665073, decouple_loss:0.0006019304855726659
The modified gen p mean: 0.4475378692150116, gen p mean: -0.12151528894901276, mean p set: 0.4481140077114105The modified gen p mean: 0.44650596380233765, gen p mean: -0.12141665816307068, mean p set: 0.4470820426940918
loss_pred:0.014533141627907753, decouple_loss:0.0004566911666188389
loss_pred:0.014909323304891586, decouple_loss:0.0005085365264676511
Iteration: 802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728559255599976, gen p mean: -0.11751949787139893, mean p set: 0.4478605389595032
The modified gen p mean: 0.44638365507125854, gen p mean: -0.11679919809103012, mean p set: 0.4469609558582306
loss_pred:0.0154701117426157, decouple_loss:0.0004757650604005903
loss_pred:0.014056365936994553, decouple_loss:0.00048119795974344015
The modified gen p mean: 0.44821178913116455, gen p mean: -0.12296614050865173, mean p set: 0.4487859904766083
loss_pred:0.01489060465246439, decouple_loss:0.0006068670772947371
Iteration: 803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464663863182068, gen p mean: -0.12658315896987915, mean p set: 0.44703981280326843
loss_pred:0.015054727904498577, decouple_loss:0.0005110548227094114
The modified gen p mean: 0.4465685784816742, gen p mean: -0.11541429907083511, mean p set: 0.44714486598968506The modified gen p mean: 0.4483269453048706, gen p mean: -0.1252622902393341, mean p set: 0.44890403747558594
loss_pred:0.013905413448810577, decouple_loss:0.0004493853193707764
loss_pred:0.014614813961088657, decouple_loss:0.0005009811138734221
Iteration: 804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468148946762085, gen p mean: -0.1157088652253151, mean p set: 0.44738900661468506
loss_pred:0.014182718470692635, decouple_loss:0.000421096570789814
The modified gen p mean: 0.4483545124530792, gen p mean: -0.11746872216463089, mean p set: 0.4489316940307617
loss_pred:0.01429629698395729, decouple_loss:0.0003695206542033702
The modified gen p mean: 0.4495139718055725, gen p mean: -0.1194751039147377, mean p set: 0.4500883221626282
loss_pred:0.014182551763951778, decouple_loss:0.0005319245392456651
Iteration: 805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44658491015434265, gen p mean: -0.11854983121156693, mean p set: 0.4471592903137207
loss_pred:0.01446839701384306, decouple_loss:0.0006241246010176837
The modified gen p mean: 0.4468546509742737, gen p mean: -0.11582055687904358, mean p set: 0.4474294185638428
loss_pred:0.014056636020541191, decouple_loss:0.0004514461907092482
The modified gen p mean: 0.4476691484451294, gen p mean: -0.12228476256132126, mean p set: 0.4482457637786865
loss_pred:0.014419972896575928, decouple_loss:0.00040193225140683353
Iteration: 806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471844732761383, gen p mean: -0.1127857118844986, mean p set: 0.4477604627609253
loss_pred:0.014999493025243282, decouple_loss:0.0007191132754087448
The modified gen p mean: 0.4480390250682831, gen p mean: -0.1106046661734581, mean p set: 0.44861525297164917
The modified gen p mean: 0.44745543599128723, gen p mean: -0.11166921257972717, mean p set: 0.44803139567375183
loss_pred:0.015306060202419758, decouple_loss:0.0006230052094906569loss_pred:0.015101494267582893, decouple_loss:0.0006260577356442809
Iteration: 807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476834833621979, gen p mean: -0.11608703434467316, mean p set: 0.4482575058937073
loss_pred:0.015015996992588043, decouple_loss:0.00042997466516681015
The modified gen p mean: 0.4473898410797119, gen p mean: -0.10977393388748169, mean p set: 0.4479648470878601
The modified gen p mean: 0.44755932688713074, gen p mean: -0.11635690927505493, mean p set: 0.44813334941864014
loss_pred:0.014699380844831467, decouple_loss:0.0005845513078384101
loss_pred:0.014533128589391708, decouple_loss:0.00044690482900477946
Iteration: 808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467635750770569, gen p mean: -0.11296369135379791, mean p set: 0.44733917713165283
The modified gen p mean: 0.44852176308631897, gen p mean: -0.10900256782770157, mean p set: 0.449098140001297
loss_pred:0.014667659997940063, decouple_loss:0.00046013639075681567
loss_pred:0.01471199281513691, decouple_loss:0.00041065411642193794
The modified gen p mean: 0.44753071665763855, gen p mean: -0.10942909121513367, mean p set: 0.4481060206890106
loss_pred:0.015323585830628872, decouple_loss:0.000430725805927068
Iteration: 809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44657233357429504, gen p mean: -0.10665398091077805, mean p set: 0.4471484422683716
loss_pred:0.014131823554635048, decouple_loss:0.0006631622673012316
The modified gen p mean: 0.4474998414516449, gen p mean: -0.11439000070095062, mean p set: 0.44807443022727966
loss_pred:0.014300516806542873, decouple_loss:0.0005190873635001481
The modified gen p mean: 0.4462641179561615, gen p mean: -0.11638958752155304, mean p set: 0.4468388855457306
loss_pred:0.015009984374046326, decouple_loss:0.0005602269666269422
Iteration: 810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461967349052429, gen p mean: -0.11798069626092911, mean p set: 0.44677209854125977
loss_pred:0.014847912825644016, decouple_loss:0.0005255740834400058
The modified gen p mean: 0.4474865794181824, gen p mean: -0.11359672248363495, mean p set: 0.4480628967285156
loss_pred:0.014710109680891037, decouple_loss:0.0005631907260976732
The modified gen p mean: 0.4462454915046692, gen p mean: -0.11825736612081528, mean p set: 0.4468221068382263
loss_pred:0.014928818680346012, decouple_loss:0.00044070606236346066
2023-05-02 06:03:34 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11965221911668777, mean p set: 0.4502691626548767
loss_pred:0.01706562750041485, decouple_loss:0.0005931560881435871
The modified gen p mean: 0.4495350122451782, gen p mean: -0.11494553089141846, mean p set: 0.4500633478164673
loss_pred:0.01632891595363617, decouple_loss:0.0006476669223047793
The modified gen p mean: 0.4498271942138672, gen p mean: -0.11500230431556702, mean p set: 0.45035696029663086
loss_pred:0.016546787694096565, decouple_loss:0.0006231105071492493
WV_1_PC_1_EH_0_PS_40, loss: 0.016678176820278168, avg_mse: 0.026068560779094696
current test mse: 0.026069
Iteration: 811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476255178451538, gen p mean: -0.11157014966011047, mean p set: 0.44820234179496765
loss_pred:0.01517298724502325, decouple_loss:0.0005979361012578011
The modified gen p mean: 0.44677412509918213, gen p mean: -0.12296226620674133, mean p set: 0.4473494589328766
loss_pred:0.015692366287112236, decouple_loss:0.00047273183008655906
The modified gen p mean: 0.44839605689048767, gen p mean: -0.11972406506538391, mean p set: 0.44897395372390747
loss_pred:0.014582827687263489, decouple_loss:0.0005459137610159814
Iteration: 812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489192068576813, gen p mean: -0.11893893033266068, mean p set: 0.4494958221912384
loss_pred:0.014645363204181194, decouple_loss:0.0004867617099080235
The modified gen p mean: 0.44740840792655945, gen p mean: -0.1170378178358078, mean p set: 0.44798544049263The modified gen p mean: 0.4465242326259613, gen p mean: -0.12147624045610428, mean p set: 0.4471015930175781
loss_pred:0.015229064039885998, decouple_loss:0.00038416279130615294
loss_pred:0.015632476657629013, decouple_loss:0.0005595188704319298
Iteration: 813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469403028488159, gen p mean: -0.11682747304439545, mean p set: 0.44751542806625366
loss_pred:0.01426087785512209, decouple_loss:0.0005417365464381874
The modified gen p mean: 0.4474469721317291, gen p mean: -0.11756294965744019, mean p set: 0.44802284240722656The modified gen p mean: 0.44678953289985657, gen p mean: -0.12362068891525269, mean p set: 0.44736534357070923
loss_pred:0.014338289387524128, decouple_loss:0.0005686231306754053
loss_pred:0.015258212573826313, decouple_loss:0.0005473610362969339
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
NaN value num: 0
Iteration: 814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784075021743774, gen p mean: -0.12324978411197662, mean p set: 0.4484156668186188
The modified gen p mean: 0.4464759826660156, gen p mean: -0.11632504314184189, mean p set: 0.4470517337322235
loss_pred:0.016104865819215775, decouple_loss:0.0004457284230738878
loss_pred:0.016569580882787704, decouple_loss:0.0005064716096967459
The modified gen p mean: 0.4481387138366699, gen p mean: -0.11315464228391647, mean p set: 0.44871607422828674
loss_pred:0.016288714483380318, decouple_loss:0.0004940622602589428
Iteration: 815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44623738527297974, gen p mean: -0.11877568811178207, mean p set: 0.44681212306022644
loss_pred:0.016395801678299904, decouple_loss:0.0005269038956612349
The modified gen p mean: 0.4459522068500519, gen p mean: -0.11303257942199707, mean p set: 0.4465305209159851
loss_pred:0.016465293243527412, decouple_loss:0.00043684805859811604
The modified gen p mean: 0.44528570771217346, gen p mean: -0.11773213744163513, mean p set: 0.44586169719696045
loss_pred:0.015879414975643158, decouple_loss:0.0005181283922865987
Iteration: 816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44551706314086914, gen p mean: -0.11298079788684845, mean p set: 0.44609320163726807
loss_pred:0.015469294041395187, decouple_loss:0.00046917019062675536
The modified gen p mean: 0.44557687640190125, gen p mean: -0.1081920936703682, mean p set: 0.4461515247821808
loss_pred:0.016118044033646584, decouple_loss:0.00044959105434827507
The modified gen p mean: 0.445913165807724, gen p mean: -0.11533859372138977, mean p set: 0.4464896619319916
loss_pred:0.016062742099165916, decouple_loss:0.00045133064850233495
Iteration: 817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487859606742859, gen p mean: -0.10497787594795227, mean p set: 0.4493609070777893
loss_pred:0.016034023836255074, decouple_loss:0.0004559260851237923
The modified gen p mean: 0.44765007495880127, gen p mean: -0.11406857520341873, mean p set: 0.4482261538505554
The modified gen p mean: 0.4457881450653076, gen p mean: -0.11067143827676773, mean p set: 0.44636404514312744
loss_pred:0.015950525179505348, decouple_loss:0.00039927076431922615
loss_pred:0.01615690253674984, decouple_loss:0.0004975381307303905
Iteration: 818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490615427494049, gen p mean: -0.11320614814758301, mean p set: 0.44963929057121277
loss_pred:0.0164363831281662, decouple_loss:0.0005577871925197542
The modified gen p mean: 0.4470478892326355, gen p mean: -0.10865265876054764, mean p set: 0.4476267099380493
loss_pred:0.016895340755581856, decouple_loss:0.0004765226331073791
The modified gen p mean: 0.4452887773513794, gen p mean: -0.11174189299345016, mean p set: 0.4458634853363037
loss_pred:0.01570633426308632, decouple_loss:0.0005675486172549427
Iteration: 819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44584327936172485, gen p mean: -0.11023090779781342, mean p set: 0.446418434381485
loss_pred:0.015985427424311638, decouple_loss:0.0005219134036451578
The modified gen p mean: 0.445304811000824, gen p mean: -0.11450912058353424, mean p set: 0.44588136672973633
loss_pred:0.01614406146109104, decouple_loss:0.0004560677334666252
The modified gen p mean: 0.4482002854347229, gen p mean: -0.1094360500574112, mean p set: 0.4487777352333069
loss_pred:0.016168728470802307, decouple_loss:0.0004683641018345952
Iteration: 820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460030496120453, gen p mean: -0.11578226089477539, mean p set: 0.44657647609710693
loss_pred:0.0158761627972126, decouple_loss:0.0005000184173695743
The modified gen p mean: 0.44715672731399536, gen p mean: -0.11375854909420013, mean p set: 0.4477316439151764
loss_pred:0.01602330058813095, decouple_loss:0.0004223200667183846
The modified gen p mean: 0.4474286735057831, gen p mean: -0.11864043027162552, mean p set: 0.4480063021183014
loss_pred:0.015896830707788467, decouple_loss:0.0004395891446620226
2023-05-02 06:06:21 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.12100543826818466, mean p set: 0.4502691626548767
loss_pred:0.017027610912919044, decouple_loss:0.0004477339971344918
The modified gen p mean: 0.4495338797569275, gen p mean: -0.11604759842157364, mean p set: 0.4500633478164673
loss_pred:0.016343489289283752, decouple_loss:0.0005004691192880273
The modified gen p mean: 0.4498295485973358, gen p mean: -0.11591900140047073, mean p set: 0.45035696029663086
loss_pred:0.016598165035247803, decouple_loss:0.0005684962379746139
WV_1_PC_1_EH_0_PS_40, loss: 0.016681700944900513, avg_mse: 0.02602686546742916
current test mse: 0.026027
Iteration: 821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462262988090515, gen p mean: -0.11338409781455994, mean p set: 0.44680410623550415
loss_pred:0.015822822228074074, decouple_loss:0.0004884172230958939
The modified gen p mean: 0.44632068276405334, gen p mean: -0.12191871553659439, mean p set: 0.4468950033187866
loss_pred:0.015895286574959755, decouple_loss:0.000414074253058061
The modified gen p mean: 0.44607046246528625, gen p mean: -0.11921845376491547, mean p set: 0.44664642214775085
loss_pred:0.01601472869515419, decouple_loss:0.00041300151497125626
Iteration: 822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486871361732483, gen p mean: -0.12010270357131958, mean p set: 0.44926485419273376
loss_pred:0.016217755153775215, decouple_loss:0.000496513384860009
The modified gen p mean: 0.4458369314670563, gen p mean: -0.11742359399795532, mean p set: 0.44641271233558655The modified gen p mean: 0.44724756479263306, gen p mean: -0.11614123731851578, mean p set: 0.4478236734867096
loss_pred:0.015950845554471016, decouple_loss:0.0005166936898604035
loss_pred:0.01674414612352848, decouple_loss:0.0005294706206768751
Iteration: 823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486061930656433, gen p mean: -0.11670628935098648, mean p set: 0.44918572902679443
loss_pred:0.016094928607344627, decouple_loss:0.00047862360952422023
The modified gen p mean: 0.44709429144859314, gen p mean: -0.1191549077630043, mean p set: 0.4476713538169861The modified gen p mean: 0.44724300503730774, gen p mean: -0.11906639486551285, mean p set: 0.44781720638275146
loss_pred:0.016316179186105728, decouple_loss:0.0004418007447384298loss_pred:0.015607261098921299, decouple_loss:0.00043985198135487735
Iteration: 824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697532057762146, gen p mean: -0.11750952154397964, mean p set: 0.4475530982017517
loss_pred:0.016709335148334503, decouple_loss:0.00043115869630128145
The modified gen p mean: 0.4466935694217682, gen p mean: -0.11724992096424103, mean p set: 0.44727084040641785
loss_pred:0.015832915902137756, decouple_loss:0.0004805033968295902
The modified gen p mean: 0.44640251994132996, gen p mean: -0.11438395828008652, mean p set: 0.4469790756702423
loss_pred:0.015671303495764732, decouple_loss:0.0005834472831338644
Iteration: 825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489476680755615, gen p mean: -0.113962322473526, mean p set: 0.44952526688575745
loss_pred:0.015401662327349186, decouple_loss:0.000454352586530149
The modified gen p mean: 0.44801053404808044, gen p mean: -0.11519812047481537, mean p set: 0.44858571887016296
loss_pred:0.01612483337521553, decouple_loss:0.0004945691907778382
The modified gen p mean: 0.4493035078048706, gen p mean: -0.11904745548963547, mean p set: 0.44987761974334717
loss_pred:0.01526504848152399, decouple_loss:0.00048251685802824795
Iteration: 826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44748455286026, gen p mean: -0.11975806206464767, mean p set: 0.4480586051940918
loss_pred:0.01585480570793152, decouple_loss:0.0005762705695815384
The modified gen p mean: 0.4469795823097229, gen p mean: -0.11971036344766617, mean p set: 0.4475557208061218
loss_pred:0.01656966656446457, decouple_loss:0.000665765895973891
The modified gen p mean: 0.4462122917175293, gen p mean: -0.1204778179526329, mean p set: 0.44678995013237
loss_pred:0.015946611762046814, decouple_loss:0.0003843780141323805
Iteration: 827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461427330970764, gen p mean: -0.12159287184476852, mean p set: 0.4467185139656067
loss_pred:0.01610354520380497, decouple_loss:0.0004997687065042555
The modified gen p mean: 0.4467114210128784, gen p mean: -0.12712250649929047, mean p set: 0.44728726148605347
loss_pred:0.015692951157689095, decouple_loss:0.00044492227607406676
The modified gen p mean: 0.44719523191452026, gen p mean: -0.12136667221784592, mean p set: 0.44777223467826843
loss_pred:0.016417618840932846, decouple_loss:0.00045385051635093987
Iteration: 828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470228850841522, gen p mean: -0.12329445779323578, mean p set: 0.4475998878479004
loss_pred:0.016779763624072075, decouple_loss:0.0004626789886970073
The modified gen p mean: 0.44559431076049805, gen p mean: -0.12926225364208221, mean p set: 0.4461691081523895
loss_pred:0.016179844737052917, decouple_loss:0.0004944369429722428
The modified gen p mean: 0.4482105076313019, gen p mean: -0.1192665547132492, mean p set: 0.4487886130809784
loss_pred:0.015723178163170815, decouple_loss:0.0003875451802741736
Iteration: 829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656693935394287, gen p mean: -0.12640100717544556, mean p set: 0.44714057445526123
loss_pred:0.01644779182970524, decouple_loss:0.000528819567989558
The modified gen p mean: 0.4467061758041382, gen p mean: -0.12381815910339355, mean p set: 0.44728389382362366
loss_pred:0.01638377271592617, decouple_loss:0.0005552155780605972
The modified gen p mean: 0.4464004635810852, gen p mean: -0.1208019107580185, mean p set: 0.4469743072986603
loss_pred:0.015936704352498055, decouple_loss:0.0004940450307913125
Iteration: 830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465465545654297, gen p mean: -0.12484052777290344, mean p set: 0.4471185803413391
loss_pred:0.015912843868136406, decouple_loss:0.000588142778724432
The modified gen p mean: 0.44703051447868347, gen p mean: -0.1223633885383606, mean p set: 0.44760608673095703
loss_pred:0.01700911857187748, decouple_loss:0.0005107025499455631
The modified gen p mean: 0.44797635078430176, gen p mean: -0.12074741721153259, mean p set: 0.4485533535480499
loss_pred:0.015982646495103836, decouple_loss:0.000553195655811578
2023-05-02 06:08:27 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1254819631576538, mean p set: 0.4502691626548767
loss_pred:0.01700630411505699, decouple_loss:0.0004723113088402897
The modified gen p mean: 0.44953417778015137, gen p mean: -0.12028507888317108, mean p set: 0.4500633478164673
loss_pred:0.016315966844558716, decouple_loss:0.00048137427074834704
The modified gen p mean: 0.44982558488845825, gen p mean: -0.12016874551773071, mean p set: 0.45035696029663086
loss_pred:0.01657821610569954, decouple_loss:0.0005480258259922266
WV_1_PC_1_EH_0_PS_40, loss: 0.01665852591395378, avg_mse: 0.02601979300379753
current test mse: 0.02602
Iteration: 831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471307098865509, gen p mean: -0.12054946273565292, mean p set: 0.44770559668540955
loss_pred:0.015408848412334919, decouple_loss:0.0004261671856511384
The modified gen p mean: 0.4457927942276001, gen p mean: -0.12490080296993256, mean p set: 0.446366548538208
loss_pred:0.016025546938180923, decouple_loss:0.00048633923870511353
The modified gen p mean: 0.4481933116912842, gen p mean: -0.1237940713763237, mean p set: 0.4487701654434204
loss_pred:0.01549996342509985, decouple_loss:0.0004898392944596708
Iteration: 832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463939964771271, gen p mean: -0.11766640096902847, mean p set: 0.446968138217926
The modified gen p mean: 0.4455881118774414, gen p mean: -0.12243979424238205, mean p set: 0.4461638331413269loss_pred:0.015829596668481827, decouple_loss:0.00039173700497485697
loss_pred:0.01578827202320099, decouple_loss:0.000478462316095829
The modified gen p mean: 0.44627246260643005, gen p mean: -0.11702319979667664, mean p set: 0.44684743881225586
loss_pred:0.015798047184944153, decouple_loss:0.000362659600796178
Iteration: 833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474858045578003, gen p mean: -0.12070553004741669, mean p set: 0.4480617940425873
The modified gen p mean: 0.44723910093307495, gen p mean: -0.12350599467754364, mean p set: 0.447811096906662
loss_pred:0.016015471890568733, decouple_loss:0.0004936391487717628
loss_pred:0.015608557499945164, decouple_loss:0.000632799172308296
The modified gen p mean: 0.4458248019218445, gen p mean: -0.126625195145607, mean p set: 0.44640052318573
loss_pred:0.015714086592197418, decouple_loss:0.0006198481423780322
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477967917919159, gen p mean: -0.12457173317670822, mean p set: 0.44837021827697754
The modified gen p mean: 0.44715961813926697, gen p mean: -0.12302638590335846, mean p set: 0.4477352201938629
loss_pred:0.015423138625919819, decouple_loss:0.0004677422111853957
loss_pred:0.01582016609609127, decouple_loss:0.000417041388573125
The modified gen p mean: 0.44595372676849365, gen p mean: -0.12713006138801575, mean p set: 0.4465283155441284
loss_pred:0.015973025932908058, decouple_loss:0.0005069166654720902
Iteration: 835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698816537857056, gen p mean: -0.1331404447555542, mean p set: 0.44756636023521423
loss_pred:0.01531217247247696, decouple_loss:0.0004838066815864295
The modified gen p mean: 0.44751617312431335, gen p mean: -0.12723900377750397, mean p set: 0.44809025526046753
loss_pred:0.015037711709737778, decouple_loss:0.0005806509288959205
The modified gen p mean: 0.4478098750114441, gen p mean: -0.12768793106079102, mean p set: 0.44838324189186096
loss_pred:0.015431160107254982, decouple_loss:0.0004808734229300171
Iteration: 836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446431428194046, gen p mean: -0.13214312493801117, mean p set: 0.4470071494579315
loss_pred:0.015152162872254848, decouple_loss:0.0005124384188093245
The modified gen p mean: 0.4483768045902252, gen p mean: -0.12618093192577362, mean p set: 0.448952317237854
The modified gen p mean: 0.44769904017448425, gen p mean: -0.1308959722518921, mean p set: 0.44827502965927124
loss_pred:0.014973826706409454, decouple_loss:0.0004436360904946923
loss_pred:0.015348488464951515, decouple_loss:0.00044244423042982817
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474570155143738, gen p mean: -0.12304577231407166, mean p set: 0.44803258776664734
loss_pred:0.015149354934692383, decouple_loss:0.0003820702841039747
The modified gen p mean: 0.44831204414367676, gen p mean: -0.1304742991924286, mean p set: 0.44888749718666077
The modified gen p mean: 0.4470832645893097, gen p mean: -0.1286720335483551, mean p set: 0.44765913486480713
loss_pred:0.014815321192145348, decouple_loss:0.00039363137329928577
loss_pred:0.015245068818330765, decouple_loss:0.0003895797417499125
Iteration: 838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484902024269104, gen p mean: -0.13079284131526947, mean p set: 0.4490656852722168
loss_pred:0.014992225915193558, decouple_loss:0.0004663449071813375
The modified gen p mean: 0.44813621044158936, gen p mean: -0.12801602482795715, mean p set: 0.4487118422985077
The modified gen p mean: 0.44585469365119934, gen p mean: -0.13460761308670044, mean p set: 0.44642776250839233
loss_pred:0.014822401106357574, decouple_loss:0.0004413435235619545
loss_pred:0.015094044618308544, decouple_loss:0.0004843367787543684
Iteration: 839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668030738830566, gen p mean: -0.13535915315151215, mean p set: 0.44725507497787476
loss_pred:0.015020128339529037, decouple_loss:0.00038336668512783945
The modified gen p mean: 0.4470185935497284, gen p mean: -0.1326877772808075, mean p set: 0.44759562611579895
loss_pred:0.014773313887417316, decouple_loss:0.00041632240754552186
The modified gen p mean: 0.4480963945388794, gen p mean: -0.13370931148529053, mean p set: 0.4486749470233917
loss_pred:0.015389440581202507, decouple_loss:0.00044561014510691166
Iteration: 840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688794016838074, gen p mean: -0.1334526389837265, mean p set: 0.44746458530426025
loss_pred:0.015204006806015968, decouple_loss:0.00038330533425323665
The modified gen p mean: 0.44797438383102417, gen p mean: -0.13469813764095306, mean p set: 0.4485515058040619
The modified gen p mean: 0.44723084568977356, gen p mean: -0.13625989854335785, mean p set: 0.4478060305118561
loss_pred:0.015688974410295486, decouple_loss:0.0004230740596540272
loss_pred:0.015104943886399269, decouple_loss:0.0004363552143331617
2023-05-02 06:11:19 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13224536180496216, mean p set: 0.4502691626548767
loss_pred:0.016901705414056778, decouple_loss:0.0004436401359271258
The modified gen p mean: 0.44953492283821106, gen p mean: -0.12753929197788239, mean p set: 0.4500633478164673
loss_pred:0.01630956120789051, decouple_loss:0.00047165885916911066
The modified gen p mean: 0.4498283565044403, gen p mean: -0.12737521529197693, mean p set: 0.45035696029663086
loss_pred:0.016640018671751022, decouple_loss:0.0005199710140004754
WV_1_PC_1_EH_0_PS_40, loss: 0.01664101704955101, avg_mse: 0.025977259501814842
current test mse: 0.025977
Iteration: 841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479975402355194, gen p mean: -0.13062353432178497, mean p set: 0.4485739767551422
The modified gen p mean: 0.4465225040912628, gen p mean: -0.1308383196592331, mean p set: 0.44709837436676025
loss_pred:0.014767853543162346, decouple_loss:0.0004098125209566206
loss_pred:0.015689218416810036, decouple_loss:0.0004913458251394331
The modified gen p mean: 0.4460456967353821, gen p mean: -0.13376332819461823, mean p set: 0.44661951065063477
loss_pred:0.015259431675076485, decouple_loss:0.000454385532066226
Iteration: 842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474293887615204, gen p mean: -0.12986606359481812, mean p set: 0.4480046033859253
loss_pred:0.014807160943746567, decouple_loss:0.00038961597601883113
The modified gen p mean: 0.44726794958114624, gen p mean: -0.12378008663654327, mean p set: 0.44784313440322876The modified gen p mean: 0.44744783639907837, gen p mean: -0.1275840848684311, mean p set: 0.44802215695381165
loss_pred:0.015783503651618958, decouple_loss:0.00044518811046145856
loss_pred:0.01463389303535223, decouple_loss:0.0004200852708891034
Iteration: 843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720613956451416, gen p mean: -0.12598378956317902, mean p set: 0.4477818012237549
loss_pred:0.014845378696918488, decouple_loss:0.0003574611619114876
The modified gen p mean: 0.4478446841239929, gen p mean: -0.12153015285730362, mean p set: 0.44841933250427246
loss_pred:0.015949150547385216, decouple_loss:0.0003905150224454701
The modified gen p mean: 0.4474024474620819, gen p mean: -0.12157716602087021, mean p set: 0.44797828793525696
loss_pred:0.015457455068826675, decouple_loss:0.0004214614164084196
Iteration: 844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789132475852966, gen p mean: -0.11961729824542999, mean p set: 0.4484681785106659
loss_pred:0.01528695784509182, decouple_loss:0.00042815678170882165
The modified gen p mean: 0.4466634690761566, gen p mean: -0.12154745310544968, mean p set: 0.44724181294441223
loss_pred:0.014699050225317478, decouple_loss:0.0004559355729725212
The modified gen p mean: 0.44736912846565247, gen p mean: -0.11896635591983795, mean p set: 0.4479471743106842
loss_pred:0.0153740169480443, decouple_loss:0.0003535222786013037
Iteration: 845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44604143500328064, gen p mean: -0.11976734548807144, mean p set: 0.4466179311275482
loss_pred:0.01509375125169754, decouple_loss:0.00043834440293721855
The modified gen p mean: 0.44715216755867004, gen p mean: -0.1161799281835556, mean p set: 0.4477280378341675
loss_pred:0.015023425221443176, decouple_loss:0.0003925334312953055
The modified gen p mean: 0.4473978877067566, gen p mean: -0.12020053714513779, mean p set: 0.44797375798225403
loss_pred:0.016258880496025085, decouple_loss:0.0003775342192966491
Iteration: 846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472130537033081, gen p mean: -0.11935964226722717, mean p set: 0.44779056310653687
loss_pred:0.014567901380360126, decouple_loss:0.000436916365288198
The modified gen p mean: 0.44752320647239685, gen p mean: -0.11198759078979492, mean p set: 0.44809815287590027
The modified gen p mean: 0.4475497901439667, gen p mean: -0.12041810154914856, mean p set: 0.44812464714050293
loss_pred:0.014366142451763153, decouple_loss:0.00038208928890526295
loss_pred:0.01518196053802967, decouple_loss:0.0003914991393685341
Iteration: 847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715359807014465, gen p mean: -0.12030409276485443, mean p set: 0.447729229927063
loss_pred:0.01496834121644497, decouple_loss:0.00043431235826574266
The modified gen p mean: 0.4477056860923767, gen p mean: -0.11536256968975067, mean p set: 0.4482816159725189
loss_pred:0.015074522234499454, decouple_loss:0.00045504115405492485
The modified gen p mean: 0.4458068609237671, gen p mean: -0.12013467401266098, mean p set: 0.44638389348983765
loss_pred:0.014249287545681, decouple_loss:0.00044243092997930944
Iteration: 848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447843462228775, gen p mean: -0.12154864519834518, mean p set: 0.4484192430973053
loss_pred:0.01546905841678381, decouple_loss:0.0005278356256894767
The modified gen p mean: 0.446177214384079, gen p mean: -0.12238579243421555, mean p set: 0.4467509686946869
loss_pred:0.01520530879497528, decouple_loss:0.0004105204716324806
The modified gen p mean: 0.4472866654396057, gen p mean: -0.11654280126094818, mean p set: 0.4478640854358673
loss_pred:0.014385315589606762, decouple_loss:0.0004237538087181747
Iteration: 849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448066771030426, gen p mean: -0.13180746138095856, mean p set: 0.4486413896083832
loss_pred:0.014536877162754536, decouple_loss:0.0004751498927362263
The modified gen p mean: 0.4482879638671875, gen p mean: -0.1324813812971115, mean p set: 0.4488631784915924
loss_pred:0.01505773700773716, decouple_loss:0.0003781841660384089
The modified gen p mean: 0.4465087056159973, gen p mean: -0.13300645351409912, mean p set: 0.4470813572406769
loss_pred:0.014842403121292591, decouple_loss:0.00039786091656424105
Iteration: 850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661813974380493, gen p mean: -0.11801476031541824, mean p set: 0.44719401001930237
loss_pred:0.016593312844634056, decouple_loss:0.0004081175138708204
The modified gen p mean: 0.4475901126861572, gen p mean: -0.11743707209825516, mean p set: 0.44816744327545166
loss_pred:0.016163310036063194, decouple_loss:0.0005075685330666602
The modified gen p mean: 0.44625601172447205, gen p mean: -0.12043733149766922, mean p set: 0.4468306601047516
loss_pred:0.014873486012220383, decouple_loss:0.0003945833013858646
2023-05-02 06:13:25 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11950547248125076, mean p set: 0.4502691626548767
loss_pred:0.01967777870595455, decouple_loss:0.0004886084934696555
The modified gen p mean: 0.44953566789627075, gen p mean: -0.11505278944969177, mean p set: 0.4500633478164673
loss_pred:0.019250791519880295, decouple_loss:0.0004935221513733268
The modified gen p mean: 0.4498295485973358, gen p mean: -0.11517979949712753, mean p set: 0.45035696029663086
loss_pred:0.01966109126806259, decouple_loss:0.0005692770355381072
WV_1_PC_1_EH_0_PS_40, loss: 0.019555743783712387, avg_mse: 0.03168531507253647
current test mse: 0.031685
Iteration: 851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467359483242035, gen p mean: -0.12088749557733536, mean p set: 0.4473138451576233
loss_pred:0.018065184354782104, decouple_loss:0.0005447430885396898
The modified gen p mean: 0.44758906960487366, gen p mean: -0.11878255754709244, mean p set: 0.4481656849384308
loss_pred:0.018277619034051895, decouple_loss:0.00048286363016813993
The modified gen p mean: 0.448269784450531, gen p mean: -0.11717643588781357, mean p set: 0.44884711503982544
loss_pred:0.018416976556181908, decouple_loss:0.0004900161875411868
Iteration: 852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799932837486267, gen p mean: -0.13785988092422485, mean p set: 0.4485728442668915
The modified gen p mean: 0.44712692499160767, gen p mean: -0.14026132225990295, mean p set: 0.4477040469646454
loss_pred:0.023364584892988205, decouple_loss:0.0005461541586555541
loss_pred:0.023185180500149727, decouple_loss:0.0006425208412110806
The modified gen p mean: 0.4476371109485626, gen p mean: -0.1390416920185089, mean p set: 0.4482135772705078
loss_pred:0.023563310503959656, decouple_loss:0.0007403552299365401
Iteration: 853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447238028049469, gen p mean: -0.15818573534488678, mean p set: 0.4478125274181366
loss_pred:0.02044413797557354, decouple_loss:0.0006024027243256569
The modified gen p mean: 0.44762206077575684, gen p mean: -0.1556747406721115, mean p set: 0.4481956660747528
loss_pred:0.021008983254432678, decouple_loss:0.0006205598474480212
The modified gen p mean: 0.4463373124599457, gen p mean: -0.16312728822231293, mean p set: 0.44691428542137146
loss_pred:0.021170949563384056, decouple_loss:0.0006877334089949727
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44914352893829346, gen p mean: -0.14306367933750153, mean p set: 0.4497183561325073
loss_pred:0.021436749026179314, decouple_loss:0.000790077552665025
The modified gen p mean: 0.44851088523864746, gen p mean: -0.14000755548477173, mean p set: 0.44908788800239563
loss_pred:0.021470464766025543, decouple_loss:0.0007008133106864989
The modified gen p mean: 0.4493902325630188, gen p mean: -0.1456732302904129, mean p set: 0.44996631145477295
loss_pred:0.02084946073591709, decouple_loss:0.0007185108261182904
Iteration: 855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787701964378357, gen p mean: -0.13058751821517944, mean p set: 0.44845327734947205
loss_pred:0.019640842452645302, decouple_loss:0.0008164038299582899
The modified gen p mean: 0.44876396656036377, gen p mean: -0.1319088339805603, mean p set: 0.44934147596359253
loss_pred:0.02011907286942005, decouple_loss:0.0007197625818662345
The modified gen p mean: 0.4491793215274811, gen p mean: -0.1254137009382248, mean p set: 0.4497552812099457
loss_pred:0.019441528245806694, decouple_loss:0.0007889430853538215
Iteration: 856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968175888061523, gen p mean: -0.14630497992038727, mean p set: 0.45026013255119324
loss_pred:0.02083095721900463, decouple_loss:0.0007278315024450421
The modified gen p mean: 0.4489341378211975, gen p mean: -0.14199447631835938, mean p set: 0.4495089054107666
loss_pred:0.02048559859395027, decouple_loss:0.000731437758076936
The modified gen p mean: 0.4489384889602661, gen p mean: -0.14918367564678192, mean p set: 0.4495182931423187
loss_pred:0.020612889900803566, decouple_loss:0.0007503219530917704
Iteration: 857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013323426246643, gen p mean: -0.13472343981266022, mean p set: 0.45070981979370117
loss_pred:0.019256995990872383, decouple_loss:0.0007632942870259285
The modified gen p mean: 0.44827544689178467, gen p mean: -0.14136597514152527, mean p set: 0.44884949922561646
loss_pred:0.02034519985318184, decouple_loss:0.0007927903207018971
The modified gen p mean: 0.4490892291069031, gen p mean: -0.1402822583913803, mean p set: 0.4496645927429199
loss_pred:0.020015573129057884, decouple_loss:0.0007191531476564705
Iteration: 858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019978284835815, gen p mean: -0.10996559262275696, mean p set: 0.4507763385772705
loss_pred:0.018055351451039314, decouple_loss:0.0008759626653045416
The modified gen p mean: 0.4500156044960022, gen p mean: -0.11067728698253632, mean p set: 0.4505905210971832
loss_pred:0.018836364150047302, decouple_loss:0.0007997520151548088
The modified gen p mean: 0.45080602169036865, gen p mean: -0.11081970483064651, mean p set: 0.45138660073280334
loss_pred:0.018228158354759216, decouple_loss:0.0008416963974013925
Iteration: 859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491724371910095, gen p mean: -0.09209262579679489, mean p set: 0.4497471749782562
loss_pred:0.01790820248425007, decouple_loss:0.0008095155353657901
The modified gen p mean: 0.4481299817562103, gen p mean: -0.09703802317380905, mean p set: 0.44870686531066895
loss_pred:0.02010241150856018, decouple_loss:0.0009637063485570252
The modified gen p mean: 0.44849085807800293, gen p mean: -0.0948038250207901, mean p set: 0.44906798005104065
loss_pred:0.01886708289384842, decouple_loss:0.0007461908389814198
Iteration: 860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891348481178284, gen p mean: -0.0828956887125969, mean p set: 0.44949063658714294
loss_pred:0.0181881133466959, decouple_loss:0.0007938743801787496
The modified gen p mean: 0.44919082522392273, gen p mean: -0.08131562918424606, mean p set: 0.4497673809528351
loss_pred:0.018361365422606468, decouple_loss:0.0008076400845311582
The modified gen p mean: 0.44841811060905457, gen p mean: -0.08243268728256226, mean p set: 0.448993444442749
loss_pred:0.018394391983747482, decouple_loss:0.000850057927891612
2023-05-02 06:16:21 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.0907185822725296, mean p set: 0.4502691626548767
loss_pred:0.01970875822007656, decouple_loss:0.0008470057509839535
The modified gen p mean: 0.44953468441963196, gen p mean: -0.08454572409391403, mean p set: 0.4500633478164673
loss_pred:0.01895245537161827, decouple_loss:0.000918158853892237
The modified gen p mean: 0.4498291611671448, gen p mean: -0.08436409384012222, mean p set: 0.45035696029663086
loss_pred:0.019351955503225327, decouple_loss:0.0008962022257037461
WV_1_PC_1_EH_0_PS_40, loss: 0.01938208006322384, avg_mse: 0.029378995299339294
current test mse: 0.029379
Iteration: 861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487616717815399, gen p mean: -0.08208800852298737, mean p set: 0.4493391215801239
loss_pred:0.017687566578388214, decouple_loss:0.0009324702550657094
The modified gen p mean: 0.44902145862579346, gen p mean: -0.08323068916797638, mean p set: 0.44959837198257446
loss_pred:0.018610892817378044, decouple_loss:0.0008812143933027983
The modified gen p mean: 0.44937777519226074, gen p mean: -0.07889014482498169, mean p set: 0.44995465874671936
loss_pred:0.017698468640446663, decouple_loss:0.0008703743224032223
Iteration: 862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910138845443726, gen p mean: -0.09702318906784058, mean p set: 0.44967731833457947
The modified gen p mean: 0.449740469455719, gen p mean: -0.09918899089097977, mean p set: 0.4503171145915985loss_pred:0.017629874870181084, decouple_loss:0.0009080726886168122
loss_pred:0.01781652867794037, decouple_loss:0.0008536862442269921
The modified gen p mean: 0.449175089597702, gen p mean: -0.0948546752333641, mean p set: 0.4497511684894562
loss_pred:0.018286654725670815, decouple_loss:0.001003021257929504
Iteration: 863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910889863967896, gen p mean: -0.1001589298248291, mean p set: 0.4496835172176361
The modified gen p mean: 0.44933798909187317, gen p mean: -0.09776581078767776, mean p set: 0.44991418719291687
loss_pred:0.017656249925494194, decouple_loss:0.0008392786839976907
loss_pred:0.017478615045547485, decouple_loss:0.0008646977366879582
The modified gen p mean: 0.4488433003425598, gen p mean: -0.09686139225959778, mean p set: 0.4494198262691498
loss_pred:0.018296103924512863, decouple_loss:0.0008019968518055975
Iteration: 864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507140815258026, gen p mean: -0.09264545887708664, mean p set: 0.45129016041755676
loss_pred:0.017288049682974815, decouple_loss:0.0007306289626285434
The modified gen p mean: 0.4495609402656555, gen p mean: -0.10015348345041275, mean p set: 0.45013657212257385
loss_pred:0.01670207269489765, decouple_loss:0.0007767318747937679
The modified gen p mean: 0.44793540239334106, gen p mean: -0.09278454631567001, mean p set: 0.44851261377334595
loss_pred:0.01654789410531521, decouple_loss:0.0007728204946033657
Iteration: 865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44959762692451477, gen p mean: -0.09972918033599854, mean p set: 0.45017269253730774
loss_pred:0.01700262725353241, decouple_loss:0.0007659464608877897
The modified gen p mean: 0.45028969645500183, gen p mean: -0.0874100923538208, mean p set: 0.4508661925792694
loss_pred:0.016568662598729134, decouple_loss:0.0009128112578764558
The modified gen p mean: 0.4479317367076874, gen p mean: -0.09548661857843399, mean p set: 0.44850999116897583
loss_pred:0.01708298735320568, decouple_loss:0.0008072284399531782
Iteration: 866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45072802901268005, gen p mean: -0.09468482434749603, mean p set: 0.45130491256713867
loss_pred:0.01665983349084854, decouple_loss:0.0009160187328234315
The modified gen p mean: 0.4482768774032593, gen p mean: -0.09497483819723129, mean p set: 0.44885316491127014
loss_pred:0.01707180216908455, decouple_loss:0.000770281592849642
The modified gen p mean: 0.44864460825920105, gen p mean: -0.10198532044887543, mean p set: 0.449221134185791
loss_pred:0.0169353224337101, decouple_loss:0.0008389453287236392
Iteration: 867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44882264733314514, gen p mean: -0.09869489073753357, mean p set: 0.4493984878063202
loss_pred:0.01704810932278633, decouple_loss:0.0007983006653375924
The modified gen p mean: 0.44969072937965393, gen p mean: -0.1008722186088562, mean p set: 0.4502677023410797
loss_pred:0.016599740833044052, decouple_loss:0.0007613950874656439
The modified gen p mean: 0.4495953321456909, gen p mean: -0.09992297738790512, mean p set: 0.4501734673976898
loss_pred:0.016595927998423576, decouple_loss:0.0007411531405523419
Iteration: 868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919097423553467, gen p mean: -0.08910727500915527, mean p set: 0.4497663974761963
loss_pred:0.016330057755112648, decouple_loss:0.0006754756323061883
The modified gen p mean: 0.45002928376197815, gen p mean: -0.08475727587938309, mean p set: 0.4506046175956726
loss_pred:0.016687260940670967, decouple_loss:0.0007435412844642997
The modified gen p mean: 0.4483698606491089, gen p mean: -0.09341877698898315, mean p set: 0.4489458501338959
loss_pred:0.01632355898618698, decouple_loss:0.0007269280613400042
Iteration: 869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756150245666504, gen p mean: -0.08419381082057953, mean p set: 0.44813892245292664
loss_pred:0.01718602143228054, decouple_loss:0.0008633652469143271
The modified gen p mean: 0.44926583766937256, gen p mean: -0.08762230724096298, mean p set: 0.4498424530029297
The modified gen p mean: 0.45009273290634155, gen p mean: -0.08250723779201508, mean p set: 0.45066767930984497
loss_pred:0.01658792607486248, decouple_loss:0.0006686605629511178
loss_pred:0.016866130754351616, decouple_loss:0.0007427488453686237
Iteration: 870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853511452674866, gen p mean: -0.08930274099111557, mean p set: 0.4491119980812073
loss_pred:0.017106615006923676, decouple_loss:0.0008206951897591352
The modified gen p mean: 0.4499759078025818, gen p mean: -0.08479753881692886, mean p set: 0.4505513906478882
loss_pred:0.015870753675699234, decouple_loss:0.0007832726696506143
The modified gen p mean: 0.4495559334754944, gen p mean: -0.08543213456869125, mean p set: 0.45013123750686646
loss_pred:0.016314897686243057, decouple_loss:0.0006378478137776256
2023-05-02 06:18:28 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.09806354343891144, mean p set: 0.4502691626548767
loss_pred:0.018165644258260727, decouple_loss:0.000617557147052139
The modified gen p mean: 0.4495358467102051, gen p mean: -0.09155235439538956, mean p set: 0.4500633478164673
loss_pred:0.017482593655586243, decouple_loss:0.0006867283373139799
The modified gen p mean: 0.44982731342315674, gen p mean: -0.09037058055400848, mean p set: 0.45035696029663086
loss_pred:0.017757076770067215, decouple_loss:0.0007116163615137339
WV_1_PC_1_EH_0_PS_40, loss: 0.01783537119626999, avg_mse: 0.027303092181682587
current test mse: 0.027303
Iteration: 871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796043634414673, gen p mean: -0.08954853564500809, mean p set: 0.4485381245613098
loss_pred:0.017172105610370636, decouple_loss:0.0006686535198241472
The modified gen p mean: 0.44909995794296265, gen p mean: -0.08846261352300644, mean p set: 0.4496765732765198The modified gen p mean: 0.44873183965682983, gen p mean: -0.08892467617988586, mean p set: 0.4493071436882019
loss_pred:0.0166439488530159, decouple_loss:0.0006941086612641811loss_pred:0.01706039346754551, decouple_loss:0.0006792028434574604
Iteration: 872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990667700767517, gen p mean: -0.09179191291332245, mean p set: 0.4504837691783905
The modified gen p mean: 0.4505671560764313, gen p mean: -0.09145348519086838, mean p set: 0.451143354177475loss_pred:0.015936080366373062, decouple_loss:0.0007182469125837088
loss_pred:0.01610386185348034, decouple_loss:0.0007103526149876416The modified gen p mean: 0.4482981264591217, gen p mean: -0.08964961022138596, mean p set: 0.4488740861415863
loss_pred:0.016273684799671173, decouple_loss:0.0007363941404037178
Iteration: 873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44957637786865234, gen p mean: -0.09102579951286316, mean p set: 0.4501534700393677
loss_pred:0.015899937599897385, decouple_loss:0.0005849453154951334
The modified gen p mean: 0.4500434100627899, gen p mean: -0.08909863233566284, mean p set: 0.4506189823150635
loss_pred:0.015996182337403297, decouple_loss:0.0006636775797232985
The modified gen p mean: 0.4504883289337158, gen p mean: -0.0876634418964386, mean p set: 0.45106619596481323
loss_pred:0.015206173993647099, decouple_loss:0.0006950866663828492
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
NaN value num: 0
Iteration: 874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453400194644928, gen p mean: -0.091956228017807, mean p set: 0.4539780914783478
The modified gen p mean: 0.4524146020412445, gen p mean: -0.08952759206295013, mean p set: 0.45299163460731506
loss_pred:0.017142334952950478, decouple_loss:0.0007241752464324236
loss_pred:0.016088703647255898, decouple_loss:0.0007742401212453842
The modified gen p mean: 0.4526684880256653, gen p mean: -0.09414014220237732, mean p set: 0.45324504375457764
loss_pred:0.017245996743440628, decouple_loss:0.0007223805296234787
Iteration: 875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534917175769806, gen p mean: -0.0887032151222229, mean p set: 0.45406821370124817
loss_pred:0.016306191682815552, decouple_loss:0.0008055542130023241
The modified gen p mean: 0.4528920650482178, gen p mean: -0.09114035964012146, mean p set: 0.4534684121608734
loss_pred:0.01624685525894165, decouple_loss:0.0009603992803022265
The modified gen p mean: 0.45355620980262756, gen p mean: -0.09693047404289246, mean p set: 0.4541327655315399
loss_pred:0.01671934314072132, decouple_loss:0.0007408235687762499
Iteration: 876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527139365673065, gen p mean: -0.08622796088457108, mean p set: 0.4532904326915741
loss_pred:0.016730932518839836, decouple_loss:0.0006691220914945006
The modified gen p mean: 0.45244917273521423, gen p mean: -0.09492000192403793, mean p set: 0.45302614569664
loss_pred:0.01635512337088585, decouple_loss:0.0006935385172255337
The modified gen p mean: 0.44979164004325867, gen p mean: -0.08780183643102646, mean p set: 0.4503670632839203
loss_pred:0.016065547242760658, decouple_loss:0.0006656844052486122
Iteration: 877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533933401107788, gen p mean: -0.07950415462255478, mean p set: 0.45397165417671204
loss_pred:0.01564764603972435, decouple_loss:0.0007794026751071215
The modified gen p mean: 0.4512113928794861, gen p mean: -0.08293629437685013, mean p set: 0.45178741216659546
The modified gen p mean: 0.4505966901779175, gen p mean: -0.0750102773308754, mean p set: 0.45117396116256714
loss_pred:0.016093390062451363, decouple_loss:0.0009833789663389325
loss_pred:0.016349846497178078, decouple_loss:0.0006615555612370372
Iteration: 878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45100367069244385, gen p mean: -0.0731535404920578, mean p set: 0.4515807330608368
loss_pred:0.016854748129844666, decouple_loss:0.000663716928102076
The modified gen p mean: 0.45094817876815796, gen p mean: -0.0794982835650444, mean p set: 0.4515247046947479
The modified gen p mean: 0.45172232389450073, gen p mean: -0.07772791385650635, mean p set: 0.4522990584373474
loss_pred:0.01642218604683876, decouple_loss:0.0007443794165737927
loss_pred:0.016548192128539085, decouple_loss:0.0006266083801165223
Iteration: 879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45226094126701355, gen p mean: -0.07162056863307953, mean p set: 0.4528374671936035
loss_pred:0.01690305769443512, decouple_loss:0.000526598421856761
The modified gen p mean: 0.4536345303058624, gen p mean: -0.08211963623762131, mean p set: 0.4542112350463867
loss_pred:0.016203932464122772, decouple_loss:0.0006603621295653284
The modified gen p mean: 0.45217642188072205, gen p mean: -0.07525449246168137, mean p set: 0.4527541399002075
loss_pred:0.016514180228114128, decouple_loss:0.0006767087033949792
Iteration: 880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535481631755829, gen p mean: -0.0837773010134697, mean p set: 0.4541240334510803
loss_pred:0.016909223049879074, decouple_loss:0.0007118650828488171
The modified gen p mean: 0.4520493745803833, gen p mean: -0.07793289422988892, mean p set: 0.4526262879371643
loss_pred:0.01617095246911049, decouple_loss:0.0007443727226927876
The modified gen p mean: 0.45342421531677246, gen p mean: -0.0758075937628746, mean p set: 0.45400142669677734
loss_pred:0.016175709664821625, decouple_loss:0.00062614306807518
2023-05-02 06:21:11 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.09184116870164871, mean p set: 0.4502691626548767
loss_pred:0.017794184386730194, decouple_loss:0.0011432251194491982
The modified gen p mean: 0.44953474402427673, gen p mean: -0.08574393391609192, mean p set: 0.4500633478164673
loss_pred:0.017099346965551376, decouple_loss:0.0010518028866499662
The modified gen p mean: 0.4498290717601776, gen p mean: -0.08433999121189117, mean p set: 0.45035696029663086
loss_pred:0.01739162765443325, decouple_loss:0.0007752923993393779
WV_1_PC_1_EH_0_PS_40, loss: 0.017477892339229584, avg_mse: 0.02696545049548149
current test mse: 0.026965
Iteration: 881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510825276374817, gen p mean: -0.08008036762475967, mean p set: 0.4516587555408478
The modified gen p mean: 0.4506306052207947, gen p mean: -0.08319738507270813, mean p set: 0.45120686292648315
loss_pred:0.015491235069930553, decouple_loss:0.0010538992937654257
loss_pred:0.015909843146800995, decouple_loss:0.0009759663953445852
The modified gen p mean: 0.4517768919467926, gen p mean: -0.08161536604166031, mean p set: 0.4523538649082184
loss_pred:0.016280263662338257, decouple_loss:0.0007344444748014212
Iteration: 882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524659514427185, gen p mean: -0.08380147814750671, mean p set: 0.453043133020401The modified gen p mean: 0.4528466761112213, gen p mean: -0.08371120691299438, mean p set: 0.4534248113632202
loss_pred:0.01604054868221283, decouple_loss:0.0009656383190304041
loss_pred:0.015817765146493912, decouple_loss:0.0008827878627926111The modified gen p mean: 0.45267724990844727, gen p mean: -0.08755168318748474, mean p set: 0.4532560408115387
loss_pred:0.015887193381786346, decouple_loss:0.0008985294261947274
Iteration: 883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018264651298523, gen p mean: -0.07991406321525574, mean p set: 0.4507599174976349
loss_pred:0.016059521585702896, decouple_loss:0.0006555715808644891
The modified gen p mean: 0.4519525170326233, gen p mean: -0.08132584393024445, mean p set: 0.4525293707847595The modified gen p mean: 0.45321226119995117, gen p mean: -0.07918581366539001, mean p set: 0.45378997921943665
loss_pred:0.016634516417980194, decouple_loss:0.0006734099006280303
loss_pred:0.015603466890752316, decouple_loss:0.0008497580420225859
Iteration: 884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518077075481415, gen p mean: -0.07825419306755066, mean p set: 0.4523839056491852
loss_pred:0.016340825706720352, decouple_loss:0.0005792172159999609
The modified gen p mean: 0.4502488076686859, gen p mean: -0.08581369370222092, mean p set: 0.4508254826068878
loss_pred:0.016561828553676605, decouple_loss:0.0008218107395805418
The modified gen p mean: 0.4515661597251892, gen p mean: -0.08464166522026062, mean p set: 0.4521428048610687
loss_pred:0.015490884892642498, decouple_loss:0.0007482785731554031
Iteration: 885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45347321033477783, gen p mean: -0.08098965883255005, mean p set: 0.4540506899356842
loss_pred:0.01598033495247364, decouple_loss:0.0007121109520085156
The modified gen p mean: 0.45263150334358215, gen p mean: -0.08628992736339569, mean p set: 0.4532091021537781
loss_pred:0.016568461433053017, decouple_loss:0.0006999608012847602
The modified gen p mean: 0.45038557052612305, gen p mean: -0.0795428603887558, mean p set: 0.450962096452713
loss_pred:0.016315888613462448, decouple_loss:0.0008866754942573607
Iteration: 886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45279136300086975, gen p mean: -0.08752705901861191, mean p set: 0.4533679187297821
loss_pred:0.015502987429499626, decouple_loss:0.0005585189792327583
The modified gen p mean: 0.4529303014278412, gen p mean: -0.08255273103713989, mean p set: 0.4535069465637207
loss_pred:0.015231792815029621, decouple_loss:0.0006190739804878831
The modified gen p mean: 0.45205941796302795, gen p mean: -0.08156128972768784, mean p set: 0.45263591408729553
loss_pred:0.01612941361963749, decouple_loss:0.0006807523313909769
Iteration: 887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45372381806373596, gen p mean: -0.08334669470787048, mean p set: 0.4543021321296692
loss_pred:0.01569952443242073, decouple_loss:0.0007199926185421646
The modified gen p mean: 0.4518507122993469, gen p mean: -0.08548812568187714, mean p set: 0.452427476644516
The modified gen p mean: 0.4526004493236542, gen p mean: -0.084842249751091, mean p set: 0.45317909121513367
loss_pred:0.016395477578043938, decouple_loss:0.0007942040683701634
loss_pred:0.016347583383321762, decouple_loss:0.0006827222532592714
Iteration: 888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523971676826477, gen p mean: -0.0849316418170929, mean p set: 0.45297572016716003
loss_pred:0.016731077805161476, decouple_loss:0.0006332522607408464
The modified gen p mean: 0.45299097895622253, gen p mean: -0.08198289573192596, mean p set: 0.45356857776641846
loss_pred:0.014962631277740002, decouple_loss:0.0006111125112511218
The modified gen p mean: 0.451421320438385, gen p mean: -0.08603016287088394, mean p set: 0.45199844241142273
loss_pred:0.015878764912486076, decouple_loss:0.000724727928172797
Iteration: 889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45406970381736755, gen p mean: -0.09037580341100693, mean p set: 0.45464667677879333
loss_pred:0.015604273416101933, decouple_loss:0.0007365506025962532
The modified gen p mean: 0.45117130875587463, gen p mean: -0.08879793435335159, mean p set: 0.45174646377563477
loss_pred:0.01614980399608612, decouple_loss:0.0005795598262920976
The modified gen p mean: 0.4523889422416687, gen p mean: -0.0871899351477623, mean p set: 0.4529651403427124
loss_pred:0.015649056062102318, decouple_loss:0.0006323934067040682
Iteration: 890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992852210998535, gen p mean: -0.09024620056152344, mean p set: 0.4505046308040619
loss_pred:0.01573159173130989, decouple_loss:0.0006264057010412216
The modified gen p mean: 0.45061179995536804, gen p mean: -0.09634075313806534, mean p set: 0.4511880576610565
loss_pred:0.016198530793190002, decouple_loss:0.0005956590757705271
The modified gen p mean: 0.45216864347457886, gen p mean: -0.08895204961299896, mean p set: 0.4527439475059509
loss_pred:0.01587207429111004, decouple_loss:0.0006801679264754057
2023-05-02 06:23:18 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10484037548303604, mean p set: 0.4502691626548767
loss_pred:0.017510222271084785, decouple_loss:0.0007812497788108885
The modified gen p mean: 0.4495336413383484, gen p mean: -0.09928961843252182, mean p set: 0.4500633478164673
loss_pred:0.016972746700048447, decouple_loss:0.0007364189368672669
The modified gen p mean: 0.4498264193534851, gen p mean: -0.0978635922074318, mean p set: 0.45035696029663086
loss_pred:0.017232147976756096, decouple_loss:0.00056218053214252
WV_1_PC_1_EH_0_PS_40, loss: 0.017273038625717163, avg_mse: 0.026752574369311333
current test mse: 0.026753
Iteration: 891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511764943599701, gen p mean: -0.09778901189565659, mean p set: 0.4517534077167511
The modified gen p mean: 0.4512019157409668, gen p mean: -0.09461212903261185, mean p set: 0.4517782926559448
loss_pred:0.01558924000710249, decouple_loss:0.0008197915740311146
loss_pred:0.016296718269586563, decouple_loss:0.0005517607787624002
The modified gen p mean: 0.4505254924297333, gen p mean: -0.08544700592756271, mean p set: 0.4511021673679352
loss_pred:0.015846867114305496, decouple_loss:0.000522780348546803
Iteration: 892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531339704990387, gen p mean: -0.08580946177244186, mean p set: 0.45371225476264954
The modified gen p mean: 0.452879399061203, gen p mean: -0.09172042459249496, mean p set: 0.4534578025341034
loss_pred:0.01584506779909134, decouple_loss:0.0006740362732671201
loss_pred:0.015666665509343147, decouple_loss:0.0005215067067183554
The modified gen p mean: 0.4520072042942047, gen p mean: -0.08976976573467255, mean p set: 0.45258408784866333
loss_pred:0.01606401801109314, decouple_loss:0.0005599036812782288
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
NaN value num: 0
Iteration: 893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45209574699401855, gen p mean: -0.08906441926956177, mean p set: 0.4526708424091339
loss_pred:0.01577043905854225, decouple_loss:0.0007999924127943814
The modified gen p mean: 0.45205724239349365, gen p mean: -0.08231629431247711, mean p set: 0.4526340067386627
loss_pred:0.016046172007918358, decouple_loss:0.0010153953917324543
The modified gen p mean: 0.45203515887260437, gen p mean: -0.08083991706371307, mean p set: 0.45261338353157043
loss_pred:0.016118023544549942, decouple_loss:0.0008516546222381294
Iteration: 894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519107937812805, gen p mean: -0.09052064269781113, mean p set: 0.4524872899055481
loss_pred:0.0158184003084898, decouple_loss:0.0006179033662192523
The modified gen p mean: 0.4519217312335968, gen p mean: -0.08557315170764923, mean p set: 0.45249855518341064
loss_pred:0.016684124246239662, decouple_loss:0.0006262533133849502
The modified gen p mean: 0.4520028233528137, gen p mean: -0.08160439133644104, mean p set: 0.452579140663147
loss_pred:0.01600300706923008, decouple_loss:0.000644297047983855
Iteration: 895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512678384780884, gen p mean: -0.08922423422336578, mean p set: 0.4518454968929291
loss_pred:0.016038551926612854, decouple_loss:0.0008366867550648749
The modified gen p mean: 0.45147719979286194, gen p mean: -0.08779938519001007, mean p set: 0.45205479860305786
loss_pred:0.01534371729940176, decouple_loss:0.0006092629046179354
The modified gen p mean: 0.4515804350376129, gen p mean: -0.08418156206607819, mean p set: 0.4521573483943939
loss_pred:0.016286401078104973, decouple_loss:0.0006379649275913835
Iteration: 896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45193180441856384, gen p mean: -0.091595858335495, mean p set: 0.4525078237056732
loss_pred:0.01615288108587265, decouple_loss:0.0007333497633226216
The modified gen p mean: 0.4520514905452728, gen p mean: -0.08396218717098236, mean p set: 0.45262742042541504
loss_pred:0.015577562153339386, decouple_loss:0.0007209379109553993
The modified gen p mean: 0.4510990083217621, gen p mean: -0.0891251266002655, mean p set: 0.4516755938529968
loss_pred:0.01590845361351967, decouple_loss:0.0010522976517677307
Iteration: 897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510035514831543, gen p mean: -0.08589955419301987, mean p set: 0.4515799880027771
loss_pred:0.016176113858819008, decouple_loss:0.0006905472837388515
The modified gen p mean: 0.4515034258365631, gen p mean: -0.08720025420188904, mean p set: 0.45208021998405457
The modified gen p mean: 0.4524109959602356, gen p mean: -0.0852452889084816, mean p set: 0.4529881477355957
loss_pred:0.015001132152974606, decouple_loss:0.0005679979803971946
loss_pred:0.01627238281071186, decouple_loss:0.0008029573946259916
Iteration: 898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45251089334487915, gen p mean: -0.08548367023468018, mean p set: 0.4530870020389557
loss_pred:0.015681952238082886, decouple_loss:0.0006622414221055806
The modified gen p mean: 0.4507705867290497, gen p mean: -0.09191999584436417, mean p set: 0.45134681463241577
The modified gen p mean: 0.4516224265098572, gen p mean: -0.09136530756950378, mean p set: 0.45219916105270386
loss_pred:0.015796244144439697, decouple_loss:0.0006659886566922069
loss_pred:0.015916751697659492, decouple_loss:0.0006684119580313563
Iteration: 899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107170939445496, gen p mean: -0.09237909317016602, mean p set: 0.45164716243743896
The modified gen p mean: 0.4518691897392273, gen p mean: -0.09647784382104874, mean p set: 0.45244550704956055loss_pred:0.01593775302171707, decouple_loss:0.0010434769792482257
loss_pred:0.01570231281220913, decouple_loss:0.0006474741967394948
The modified gen p mean: 0.4512858986854553, gen p mean: -0.09140216559171677, mean p set: 0.4518626928329468
loss_pred:0.015873905271291733, decouple_loss:0.0007817356381565332
Iteration: 900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451750248670578, gen p mean: -0.09764839708805084, mean p set: 0.4523274898529053The modified gen p mean: 0.4514681100845337, gen p mean: -0.09145922213792801, mean p set: 0.45204487442970276
loss_pred:0.015858648344874382, decouple_loss:0.0006410682108253241
loss_pred:0.015070205554366112, decouple_loss:0.0006389684858731925
The modified gen p mean: 0.4514864981174469, gen p mean: -0.09085769206285477, mean p set: 0.4520612061023712
loss_pred:0.016168221831321716, decouple_loss:0.0007561930106021464
2023-05-02 06:26:02 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10568070411682129, mean p set: 0.4502691626548767
loss_pred:0.0173955000936985, decouple_loss:0.0007050295826047659
The modified gen p mean: 0.449532687664032, gen p mean: -0.10005875676870346, mean p set: 0.4500633478164673
loss_pred:0.016757717356085777, decouple_loss:0.0007037505274638534
The modified gen p mean: 0.4498291611671448, gen p mean: -0.09901471436023712, mean p set: 0.45035696029663086
loss_pred:0.01707899384200573, decouple_loss:0.0007137343054637313
WV_1_PC_1_EH_0_PS_40, loss: 0.01711277849972248, avg_mse: 0.026515353471040726
current test mse: 0.026515
Iteration: 901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45205143094062805, gen p mean: -0.08902410417795181, mean p set: 0.452627569437027
loss_pred:0.01638510636985302, decouple_loss:0.0009690752485767007
The modified gen p mean: 0.4529065787792206, gen p mean: -0.09315501898527145, mean p set: 0.4534855782985687The modified gen p mean: 0.4504566192626953, gen p mean: -0.09575149416923523, mean p set: 0.4510330855846405
loss_pred:0.01572737656533718, decouple_loss:0.0009275863412767649
loss_pred:0.015988454222679138, decouple_loss:0.0008076656376942992
Iteration: 902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996005296707153, gen p mean: -0.08732939511537552, mean p set: 0.45053553581237793
loss_pred:0.016049493104219437, decouple_loss:0.0006797310197725892
The modified gen p mean: 0.4514222741127014, gen p mean: -0.08691096305847168, mean p set: 0.45199981331825256The modified gen p mean: 0.4519493281841278, gen p mean: -0.09855567663908005, mean p set: 0.4525282084941864
loss_pred:0.015249347314238548, decouple_loss:0.0006556388107128441
loss_pred:0.015426360070705414, decouple_loss:0.0007572682807222009
Iteration: 903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45129454135894775, gen p mean: -0.08713722974061966, mean p set: 0.4518716335296631
loss_pred:0.01538723986595869, decouple_loss:0.0006343080312944949
The modified gen p mean: 0.4522096812725067, gen p mean: -0.08290746808052063, mean p set: 0.4527874290943146
loss_pred:0.015793567523360252, decouple_loss:0.0006413115188479424
The modified gen p mean: 0.4495294988155365, gen p mean: -0.0843229666352272, mean p set: 0.4501059055328369
loss_pred:0.01578911766409874, decouple_loss:0.0005838844808749855
Iteration: 904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45099857449531555, gen p mean: -0.08883717656135559, mean p set: 0.45157474279403687
loss_pred:0.015700824558734894, decouple_loss:0.0005907914601266384
The modified gen p mean: 0.4493309259414673, gen p mean: -0.08138502389192581, mean p set: 0.4499078094959259
loss_pred:0.016150102019309998, decouple_loss:0.0005243961932137609
The modified gen p mean: 0.45204606652259827, gen p mean: -0.08959823846817017, mean p set: 0.4526216387748718
loss_pred:0.015476668253540993, decouple_loss:0.0005683909985236824
Iteration: 905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512680768966675, gen p mean: -0.09503304213285446, mean p set: 0.45184382796287537
loss_pred:0.015032390132546425, decouple_loss:0.0007274243398569524
The modified gen p mean: 0.451854407787323, gen p mean: -0.08753145486116409, mean p set: 0.45243212580680847
loss_pred:0.015513550490140915, decouple_loss:0.0007123370887711644
The modified gen p mean: 0.45144471526145935, gen p mean: -0.09396947175264359, mean p set: 0.4520227611064911
loss_pred:0.015606638975441456, decouple_loss:0.0007392974803224206
Iteration: 906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45115336775779724, gen p mean: -0.09232372790575027, mean p set: 0.451729416847229
loss_pred:0.015757979825139046, decouple_loss:0.0009966747602447867
The modified gen p mean: 0.4521405100822449, gen p mean: -0.08945437520742416, mean p set: 0.4527184069156647
loss_pred:0.01558991614729166, decouple_loss:0.0008892789483070374
The modified gen p mean: 0.4514710009098053, gen p mean: -0.09158200770616531, mean p set: 0.4520479440689087
loss_pred:0.015430431813001633, decouple_loss:0.0006967126973904669
Iteration: 907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511473774909973, gen p mean: -0.09012498706579208, mean p set: 0.45172441005706787
loss_pred:0.015887882560491562, decouple_loss:0.0005658138543367386
The modified gen p mean: 0.4499080777168274, gen p mean: -0.09570309519767761, mean p set: 0.4504854083061218
loss_pred:0.016644231975078583, decouple_loss:0.0006747522274963558
The modified gen p mean: 0.4514133632183075, gen p mean: -0.08995391428470612, mean p set: 0.4519910514354706
loss_pred:0.016042761504650116, decouple_loss:0.000777639274019748
Iteration: 908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504525661468506, gen p mean: -0.09123001247644424, mean p set: 0.4510296881198883
loss_pred:0.01630682684481144, decouple_loss:0.0006012796075083315
The modified gen p mean: 0.45260903239250183, gen p mean: -0.08659049868583679, mean p set: 0.4531855285167694
loss_pred:0.01549131702631712, decouple_loss:0.0006079025333747268
The modified gen p mean: 0.4504487216472626, gen p mean: -0.08396211266517639, mean p set: 0.4510248601436615
loss_pred:0.015567523427307606, decouple_loss:0.0006059054285287857
Iteration: 909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45101016759872437, gen p mean: -0.09188955277204514, mean p set: 0.4515860676765442
loss_pred:0.015701450407505035, decouple_loss:0.0007360795862041414
The modified gen p mean: 0.4512850344181061, gen p mean: -0.08892756700515747, mean p set: 0.45186206698417664
The modified gen p mean: 0.4496344327926636, gen p mean: -0.08504849672317505, mean p set: 0.45021140575408936
loss_pred:0.015828009694814682, decouple_loss:0.0006080155726522207
loss_pred:0.016074562445282936, decouple_loss:0.0006061767344363034
Iteration: 910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515112042427063, gen p mean: -0.09182718396186829, mean p set: 0.45208823680877686
loss_pred:0.015387150458991528, decouple_loss:0.0005987313925288618
The modified gen p mean: 0.4515189528465271, gen p mean: -0.09356600046157837, mean p set: 0.45209604501724243
The modified gen p mean: 0.4515414535999298, gen p mean: -0.08754849433898926, mean p set: 0.45211732387542725
loss_pred:0.015513711608946323, decouple_loss:0.0007651024498045444
loss_pred:0.015744054690003395, decouple_loss:0.0007371394312940538
2023-05-02 06:28:10 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10188949853181839, mean p set: 0.4502691626548767
loss_pred:0.017260825261473656, decouple_loss:0.0006990959518589079
The modified gen p mean: 0.44953370094299316, gen p mean: -0.09604024887084961, mean p set: 0.4500633478164673
loss_pred:0.016709936782717705, decouple_loss:0.0007417364977300167
The modified gen p mean: 0.4498261511325836, gen p mean: -0.09550246596336365, mean p set: 0.45035696029663086
loss_pred:0.016960222274065018, decouple_loss:0.0005364590906538069
WV_1_PC_1_EH_0_PS_40, loss: 0.017009951174259186, avg_mse: 0.02638397179543972
current test mse: 0.026384
Iteration: 911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500376880168915, gen p mean: -0.0849916934967041, mean p set: 0.45061367750167847
loss_pred:0.015873614698648453, decouple_loss:0.0005650503444485366
The modified gen p mean: 0.4517514705657959, gen p mean: -0.09051110595464706, mean p set: 0.4523273706436157The modified gen p mean: 0.4519365727901459, gen p mean: -0.0863863155245781, mean p set: 0.4525144100189209
loss_pred:0.015682637691497803, decouple_loss:0.0005501558189280331
loss_pred:0.015500202775001526, decouple_loss:0.000977850635536015
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
NaN value num: 0
Iteration: 912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45272231101989746, gen p mean: -0.08832098543643951, mean p set: 0.4533001780509949
loss_pred:0.016812099143862724, decouple_loss:0.0006485439371317625
The modified gen p mean: 0.4526352882385254, gen p mean: -0.0864362046122551, mean p set: 0.453212171792984The modified gen p mean: 0.45121774077415466, gen p mean: -0.08456086367368698, mean p set: 0.4517933130264282
loss_pred:0.016833694651722908, decouple_loss:0.0005634502740576863
loss_pred:0.016899757087230682, decouple_loss:0.0006259591900743544
Iteration: 913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128506422042847, gen p mean: -0.08044075965881348, mean p set: 0.4518618583679199
loss_pred:0.016913888975977898, decouple_loss:0.0006852566730231047
The modified gen p mean: 0.4524994492530823, gen p mean: -0.09171842038631439, mean p set: 0.45307838916778564
loss_pred:0.01627141796052456, decouple_loss:0.0008319198386743665
The modified gen p mean: 0.4500912129878998, gen p mean: -0.08568093925714493, mean p set: 0.45066869258880615
loss_pred:0.017249759286642075, decouple_loss:0.0007216635276563466
Iteration: 914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506029188632965, gen p mean: -0.08982615172863007, mean p set: 0.4511813521385193
loss_pred:0.016423523426055908, decouple_loss:0.0007224854198284447
The modified gen p mean: 0.4508788287639618, gen p mean: -0.08374129980802536, mean p set: 0.4514564573764801
loss_pred:0.0166112519800663, decouple_loss:0.0005486636655405164
The modified gen p mean: 0.45203402638435364, gen p mean: -0.082438625395298, mean p set: 0.45261165499687195
loss_pred:0.015804726630449295, decouple_loss:0.0007827812223695219
Iteration: 915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526350498199463, gen p mean: -0.09872463345527649, mean p set: 0.45321333408355713
loss_pred:0.016343537718057632, decouple_loss:0.0006299252854660153
The modified gen p mean: 0.45052775740623474, gen p mean: -0.09696252644062042, mean p set: 0.4511050879955292
loss_pred:0.017098207026720047, decouple_loss:0.0006745841819792986
The modified gen p mean: 0.45195209980010986, gen p mean: -0.09646958857774734, mean p set: 0.4525289833545685
loss_pred:0.01661449857056141, decouple_loss:0.0007922775694169104
Iteration: 916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45184779167175293, gen p mean: -0.0955771878361702, mean p set: 0.4524257183074951
loss_pred:0.017339879646897316, decouple_loss:0.0006192937726154923
The modified gen p mean: 0.4512476325035095, gen p mean: -0.09791619330644608, mean p set: 0.45182281732559204
The modified gen p mean: 0.4497411549091339, gen p mean: -0.1029861718416214, mean p set: 0.4503157436847687
loss_pred:0.016614533960819244, decouple_loss:0.0005846128915436566
loss_pred:0.01677137240767479, decouple_loss:0.0005208083894103765
Iteration: 917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45027533173561096, gen p mean: -0.1042562797665596, mean p set: 0.4508522152900696
loss_pred:0.016429781913757324, decouple_loss:0.0006996731972321868
The modified gen p mean: 0.4518306851387024, gen p mean: -0.10650034993886948, mean p set: 0.45240524411201477
The modified gen p mean: 0.44962579011917114, gen p mean: -0.1067080944776535, mean p set: 0.4502023756504059
loss_pred:0.01631370559334755, decouple_loss:0.0006439212011173368
loss_pred:0.01623809151351452, decouple_loss:0.0005762167274951935
Iteration: 918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529578983783722, gen p mean: -0.09835708886384964, mean p set: 0.4535359740257263
loss_pred:0.016725745052099228, decouple_loss:0.0007211430929601192
The modified gen p mean: 0.45211657881736755, gen p mean: -0.09395907819271088, mean p set: 0.45269373059272766
loss_pred:0.016481837257742882, decouple_loss:0.0005878418451175094
The modified gen p mean: 0.45296964049339294, gen p mean: -0.10277090221643448, mean p set: 0.4535471498966217
loss_pred:0.016034649685025215, decouple_loss:0.0006074162665754557
Iteration: 919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520314633846283, gen p mean: -0.09605912864208221, mean p set: 0.45260950922966003
loss_pred:0.01667395979166031, decouple_loss:0.0006402218132279813
The modified gen p mean: 0.4490257501602173, gen p mean: -0.09467364102602005, mean p set: 0.4496026933193207
loss_pred:0.017159737646579742, decouple_loss:0.0006800272967666388
The modified gen p mean: 0.45214131474494934, gen p mean: -0.09826629608869553, mean p set: 0.45271924138069153
loss_pred:0.015814149752259254, decouple_loss:0.0005552908405661583
Iteration: 920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501918852329254, gen p mean: -0.09831774234771729, mean p set: 0.450769305229187
loss_pred:0.016064554452896118, decouple_loss:0.0005434893537312746
The modified gen p mean: 0.4502483308315277, gen p mean: -0.09525606036186218, mean p set: 0.4508230984210968
The modified gen p mean: 0.4517122805118561, gen p mean: -0.09966001659631729, mean p set: 0.4522883892059326
loss_pred:0.0170598067343235, decouple_loss:0.00066795275779441
loss_pred:0.01592177152633667, decouple_loss:0.0005365993711166084
2023-05-02 06:30:58 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10337197035551071, mean p set: 0.4502691626548767
loss_pred:0.017303260043263435, decouple_loss:0.0006081282044760883
The modified gen p mean: 0.44953569769859314, gen p mean: -0.09643770754337311, mean p set: 0.4500633478164673
loss_pred:0.016628319397568703, decouple_loss:0.0006034706020727754
The modified gen p mean: 0.44982844591140747, gen p mean: -0.09631889313459396, mean p set: 0.45035696029663086
loss_pred:0.01699351891875267, decouple_loss:0.0005527175962924957
WV_1_PC_1_EH_0_PS_40, loss: 0.017004437744617462, avg_mse: 0.02640351839363575
current test mse: 0.026404
Iteration: 921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45054182410240173, gen p mean: -0.09290993958711624, mean p set: 0.45111966133117676
loss_pred:0.016918804496526718, decouple_loss:0.0006355782388709486
The modified gen p mean: 0.4497356712818146, gen p mean: -0.09754230082035065, mean p set: 0.4503115713596344
loss_pred:0.016121400520205498, decouple_loss:0.0005127175245434046
The modified gen p mean: 0.4522079527378082, gen p mean: -0.08695496618747711, mean p set: 0.45278608798980713
loss_pred:0.017296385020017624, decouple_loss:0.0005176776321604848
Iteration: 922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509984254837036, gen p mean: -0.09659262746572495, mean p set: 0.45157456398010254
loss_pred:0.016201363876461983, decouple_loss:0.0004377128789201379
The modified gen p mean: 0.4500679075717926, gen p mean: -0.09367066621780396, mean p set: 0.45064473152160645The modified gen p mean: 0.45226845145225525, gen p mean: -0.09530606865882874, mean p set: 0.45284631848335266
loss_pred:0.01692843809723854, decouple_loss:0.0006644014501944184
loss_pred:0.01611640863120556, decouple_loss:0.0006472199456766248
Iteration: 923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45159247517585754, gen p mean: -0.08928748220205307, mean p set: 0.4521689713001251
loss_pred:0.016239266842603683, decouple_loss:0.0005407747230492532
The modified gen p mean: 0.45144402980804443, gen p mean: -0.08638311922550201, mean p set: 0.4520201086997986The modified gen p mean: 0.4510100483894348, gen p mean: -0.0947515144944191, mean p set: 0.45158782601356506
loss_pred:0.01590621843934059, decouple_loss:0.0005126058822497725
loss_pred:0.01685944013297558, decouple_loss:0.0006963149062357843
Iteration: 924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451772004365921, gen p mean: -0.0887162983417511, mean p set: 0.45234790444374084
loss_pred:0.01635904423892498, decouple_loss:0.0005490967887453735
The modified gen p mean: 0.4498237073421478, gen p mean: -0.08612488210201263, mean p set: 0.45039960741996765
loss_pred:0.01643647439777851, decouple_loss:0.0005924785509705544
The modified gen p mean: 0.4521629214286804, gen p mean: -0.08789700269699097, mean p set: 0.45274025201797485
loss_pred:0.016192957758903503, decouple_loss:0.0005753391305916011
Iteration: 925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524058699607849, gen p mean: -0.0868934616446495, mean p set: 0.4529826045036316
loss_pred:0.016506724059581757, decouple_loss:0.0004925815155729651
The modified gen p mean: 0.45185714960098267, gen p mean: -0.0858314260840416, mean p set: 0.45243576169013977
loss_pred:0.016283851116895676, decouple_loss:0.0005202983156777918
The modified gen p mean: 0.45227184891700745, gen p mean: -0.08834777772426605, mean p set: 0.45284944772720337
loss_pred:0.016374750062823296, decouple_loss:0.0007159158121794462
Iteration: 926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45113956928253174, gen p mean: -0.08428133279085159, mean p set: 0.45171743631362915
loss_pred:0.016174282878637314, decouple_loss:0.0004701431898865849
The modified gen p mean: 0.44975194334983826, gen p mean: -0.08978191763162613, mean p set: 0.45032763481140137
The modified gen p mean: 0.4519748389720917, gen p mean: -0.08180853724479675, mean p set: 0.45255225896835327
loss_pred:0.016446653753519058, decouple_loss:0.0005867842701263726
loss_pred:0.015499135479331017, decouple_loss:0.000587846094276756
Iteration: 927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525461494922638, gen p mean: -0.08806837350130081, mean p set: 0.4531249403953552
loss_pred:0.016469448804855347, decouple_loss:0.0006576271262019873
The modified gen p mean: 0.45169398188591003, gen p mean: -0.09011294692754745, mean p set: 0.45227110385894775
loss_pred:0.016132529824972153, decouple_loss:0.0004931745352223516
The modified gen p mean: 0.45293548703193665, gen p mean: -0.09083215892314911, mean p set: 0.4535127878189087
loss_pred:0.0165904201567173, decouple_loss:0.0006263285176828504
Iteration: 928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45149990916252136, gen p mean: -0.08928771317005157, mean p set: 0.4520774781703949
loss_pred:0.01615936867892742, decouple_loss:0.0005196676356717944
The modified gen p mean: 0.4514521062374115, gen p mean: -0.08697086572647095, mean p set: 0.45202744007110596
The modified gen p mean: 0.45232829451560974, gen p mean: -0.0856490433216095, mean p set: 0.4529035687446594
loss_pred:0.016445839777588844, decouple_loss:0.0009043210884556174
loss_pred:0.01639447547495365, decouple_loss:0.000763458723668009
Iteration: 929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975852966308594, gen p mean: -0.09314306080341339, mean p set: 0.450334757566452
loss_pred:0.016782766208052635, decouple_loss:0.0006157263414934278
The modified gen p mean: 0.4515327215194702, gen p mean: -0.09044671058654785, mean p set: 0.45210960507392883
The modified gen p mean: 0.4510333836078644, gen p mean: -0.10031124204397202, mean p set: 0.4516104459762573
loss_pred:0.015752241015434265, decouple_loss:0.000587349000852555
loss_pred:0.016562728211283684, decouple_loss:0.000506470212712884
Iteration: 930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523085951805115, gen p mean: -0.09053279459476471, mean p set: 0.45288509130477905
loss_pred:0.015853585675358772, decouple_loss:0.0007416278240270913
The modified gen p mean: 0.4509759247303009, gen p mean: -0.09881973266601562, mean p set: 0.45155251026153564
loss_pred:0.016536245122551918, decouple_loss:0.0005532687064260244
The modified gen p mean: 0.4524245858192444, gen p mean: -0.09834963083267212, mean p set: 0.4530024528503418
loss_pred:0.01576416939496994, decouple_loss:0.0006350204348564148
2023-05-02 06:33:06 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10473289340734482, mean p set: 0.4502691626548767
loss_pred:0.017202259972691536, decouple_loss:0.0006935134879313409
The modified gen p mean: 0.44953593611717224, gen p mean: -0.09702946990728378, mean p set: 0.4500633478164673
The modified gen p mean: 0.4498281180858612, gen p mean: -0.09636756032705307, mean p set: 0.45035696029663086
loss_pred:0.016482973471283913, decouple_loss:0.0006424202001653612
loss_pred:0.016869505867362022, decouple_loss:0.0006378879770636559
WV_1_PC_1_EH_0_PS_40, loss: 0.01688447780907154, avg_mse: 0.02624420076608658
current test mse: 0.026244
Iteration: 931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530162513256073, gen p mean: -0.08532775193452835, mean p set: 0.4535941779613495
loss_pred:0.016465332359075546, decouple_loss:0.0005958378314971924
The modified gen p mean: 0.451568067073822, gen p mean: -0.0874621793627739, mean p set: 0.4521452486515045The modified gen p mean: 0.45328080654144287, gen p mean: -0.09255366027355194, mean p set: 0.45385733246803284
loss_pred:0.016350921243429184, decouple_loss:0.0006641958607360721loss_pred:0.017319101840257645, decouple_loss:0.0005910908221267164
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
NaN value num: 0
Iteration: 932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508945047855377, gen p mean: -0.09186756610870361, mean p set: 0.45147234201431274
loss_pred:0.014820905402302742, decouple_loss:0.00064934539841488
The modified gen p mean: 0.45108234882354736, gen p mean: -0.09187701344490051, mean p set: 0.45165911316871643The modified gen p mean: 0.45168137550354004, gen p mean: -0.09106678515672684, mean p set: 0.4522576630115509
loss_pred:0.015461571514606476, decouple_loss:0.0008117340039461851loss_pred:0.015131084248423576, decouple_loss:0.0007925716345198452
Iteration: 933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500060975551605, gen p mean: -0.1013152226805687, mean p set: 0.4505823850631714
loss_pred:0.015616093762218952, decouple_loss:0.0008334816666319966
The modified gen p mean: 0.4497074484825134, gen p mean: -0.1062598004937172, mean p set: 0.45028162002563477
loss_pred:0.01607152633368969, decouple_loss:0.00046914283302612603
The modified gen p mean: 0.4494180977344513, gen p mean: -0.11089623719453812, mean p set: 0.4499944746494293
loss_pred:0.015197895467281342, decouple_loss:0.0006471313536167145
Iteration: 934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451458603143692, gen p mean: -0.10561065375804901, mean p set: 0.45203638076782227
loss_pred:0.014479950070381165, decouple_loss:0.0007849831599742174
The modified gen p mean: 0.4514324367046356, gen p mean: -0.10552968084812164, mean p set: 0.4520106315612793
loss_pred:0.01510779932141304, decouple_loss:0.0007624557474628091
The modified gen p mean: 0.4481782019138336, gen p mean: -0.11283137649297714, mean p set: 0.4487546980381012
loss_pred:0.015736820176243782, decouple_loss:0.0006530286045745015
Iteration: 935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502078890800476, gen p mean: -0.0979546383023262, mean p set: 0.45078280568122864
loss_pred:0.015810588374733925, decouple_loss:0.0006175109301693738
The modified gen p mean: 0.44926416873931885, gen p mean: -0.10140186548233032, mean p set: 0.44983968138694763
loss_pred:0.01483188197016716, decouple_loss:0.0005212911055423319
The modified gen p mean: 0.45153650641441345, gen p mean: -0.09768948704004288, mean p set: 0.452114462852478
loss_pred:0.015496916137635708, decouple_loss:0.0005053269560448825
Iteration: 936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491422474384308, gen p mean: -0.10154654830694199, mean p set: 0.4497178792953491
loss_pred:0.015147075988352299, decouple_loss:0.0006628860719501972
The modified gen p mean: 0.4516139030456543, gen p mean: -0.09423977881669998, mean p set: 0.4521912932395935
loss_pred:0.015280351974070072, decouple_loss:0.0007328192587010562
The modified gen p mean: 0.45119139552116394, gen p mean: -0.08930325508117676, mean p set: 0.4517684876918793
loss_pred:0.015587757341563702, decouple_loss:0.0008524921722710133
Iteration: 937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451614111661911, gen p mean: -0.08473639190196991, mean p set: 0.4521903395652771
loss_pred:0.015220863744616508, decouple_loss:0.000709169136825949
The modified gen p mean: 0.45155417919158936, gen p mean: -0.0852411538362503, mean p set: 0.4521304666996002
loss_pred:0.015337817370891571, decouple_loss:0.0006283188704401255
The modified gen p mean: 0.44980451464653015, gen p mean: -0.08888164162635803, mean p set: 0.45038190484046936
loss_pred:0.015172858722507954, decouple_loss:0.0005849662120454013
Iteration: 938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45053496956825256, gen p mean: -0.08848444372415543, mean p set: 0.45111262798309326
loss_pred:0.014907965436577797, decouple_loss:0.0006324570276774466
The modified gen p mean: 0.4503912329673767, gen p mean: -0.08557291328907013, mean p set: 0.4509679973125458
loss_pred:0.015752114355564117, decouple_loss:0.0007772733806632459
The modified gen p mean: 0.44987425208091736, gen p mean: -0.09039624035358429, mean p set: 0.45044994354248047
loss_pred:0.014495369046926498, decouple_loss:0.0007244190783239901
Iteration: 939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489515721797943, gen p mean: -0.09713439643383026, mean p set: 0.4495277404785156
loss_pred:0.015048476867377758, decouple_loss:0.0006643599481321871
The modified gen p mean: 0.4498848617076874, gen p mean: -0.09976398944854736, mean p set: 0.4504610598087311
loss_pred:0.015143130905926228, decouple_loss:0.000575862533878535
The modified gen p mean: 0.4510214030742645, gen p mean: -0.09286104142665863, mean p set: 0.4515971541404724
loss_pred:0.01478599663823843, decouple_loss:0.0005266754305921495
Iteration: 940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45135489106178284, gen p mean: -0.09061803668737411, mean p set: 0.4519319236278534
loss_pred:0.014977891929447651, decouple_loss:0.0005352721200324595
The modified gen p mean: 0.4507613480091095, gen p mean: -0.08513002097606659, mean p set: 0.4513375163078308
loss_pred:0.015439928509294987, decouple_loss:0.00053379125893116
The modified gen p mean: 0.4512627422809601, gen p mean: -0.09108799695968628, mean p set: 0.4518391489982605
loss_pred:0.015249494463205338, decouple_loss:0.0006209336570464075
2023-05-02 06:35:51 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10855720192193985, mean p set: 0.4502691626548767
loss_pred:0.017305949702858925, decouple_loss:0.0006122420309111476
The modified gen p mean: 0.44953417778015137, gen p mean: -0.10076026618480682, mean p set: 0.4500633478164673
loss_pred:0.016652250662446022, decouple_loss:0.0005721847992390394
The modified gen p mean: 0.4498278498649597, gen p mean: -0.10053850710391998, mean p set: 0.45035696029663086
loss_pred:0.01691405475139618, decouple_loss:0.0005686103249900043
WV_1_PC_1_EH_0_PS_40, loss: 0.016986636444926262, avg_mse: 0.026365794241428375
current test mse: 0.026366
Iteration: 941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509110450744629, gen p mean: -0.09267622977495193, mean p set: 0.45148730278015137
loss_pred:0.014867831021547318, decouple_loss:0.0005788411945104599
The modified gen p mean: 0.45150333642959595, gen p mean: -0.09093198925256729, mean p set: 0.45207884907722473
The modified gen p mean: 0.44855767488479614, gen p mean: -0.10062266141176224, mean p set: 0.4491320550441742
loss_pred:0.015150179155170918, decouple_loss:0.0006301893736235797
loss_pred:0.015383764170110226, decouple_loss:0.00047268057824112475
Iteration: 942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499209523200989, gen p mean: -0.10145999491214752, mean p set: 0.4504970610141754
loss_pred:0.0151502201333642, decouple_loss:0.0006201202631928027
The modified gen p mean: 0.45096132159233093, gen p mean: -0.09470713883638382, mean p set: 0.4515382945537567The modified gen p mean: 0.4507630467414856, gen p mean: -0.09424300491809845, mean p set: 0.4513408839702606
loss_pred:0.0146667854860425, decouple_loss:0.0006363664870150387loss_pred:0.014537528157234192, decouple_loss:0.0004475091118365526
Iteration: 943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797810912132263, gen p mean: -0.09692628681659698, mean p set: 0.44855502247810364
loss_pred:0.014524524100124836, decouple_loss:0.0006576981977559626
The modified gen p mean: 0.450616717338562, gen p mean: -0.0854554995894432, mean p set: 0.45119374990463257The modified gen p mean: 0.45140311121940613, gen p mean: -0.0876799076795578, mean p set: 0.45198163390159607
loss_pred:0.015603127889335155, decouple_loss:0.0007345319609157741
loss_pred:0.015548743307590485, decouple_loss:0.0005852961330674589
Iteration: 944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516095221042633, gen p mean: -0.08335612714290619, mean p set: 0.45218491554260254
loss_pred:0.01501650270074606, decouple_loss:0.0005249048117548227
The modified gen p mean: 0.44941872358322144, gen p mean: -0.09249737858772278, mean p set: 0.44999441504478455
loss_pred:0.015602076426148415, decouple_loss:0.0005046442965976894
The modified gen p mean: 0.4517967104911804, gen p mean: -0.08415617048740387, mean p set: 0.4523736536502838
loss_pred:0.015081675723195076, decouple_loss:0.0006557047017849982
Iteration: 945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448869913816452, gen p mean: -0.09439485520124435, mean p set: 0.44944530725479126
loss_pred:0.01457969844341278, decouple_loss:0.0005715092993341386
The modified gen p mean: 0.45177438855171204, gen p mean: -0.08969725668430328, mean p set: 0.45235124230384827
loss_pred:0.014945430681109428, decouple_loss:0.000606376794166863
The modified gen p mean: 0.45160922408103943, gen p mean: -0.0822383239865303, mean p set: 0.45218411087989807
loss_pred:0.01491693127900362, decouple_loss:0.0004666572785936296
Iteration: 946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45127198100090027, gen p mean: -0.08590421080589294, mean p set: 0.45184803009033203
loss_pred:0.014653126709163189, decouple_loss:0.0006314960774034262
The modified gen p mean: 0.44790780544281006, gen p mean: -0.09428656846284866, mean p set: 0.44848471879959106
loss_pred:0.014916649088263512, decouple_loss:0.00044048449490219355
The modified gen p mean: 0.4493739604949951, gen p mean: -0.0894547700881958, mean p set: 0.449951171875
loss_pred:0.015626488253474236, decouple_loss:0.00047846644883975387
Iteration: 947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515396058559418, gen p mean: -0.07995752990245819, mean p set: 0.4521169364452362
loss_pred:0.014535055495798588, decouple_loss:0.0007050384301692247
The modified gen p mean: 0.45089027285575867, gen p mean: -0.0756407231092453, mean p set: 0.4514666199684143
The modified gen p mean: 0.45087891817092896, gen p mean: -0.07455792278051376, mean p set: 0.451455295085907
loss_pred:0.015348423272371292, decouple_loss:0.0009007369517348707
loss_pred:0.015034190379083157, decouple_loss:0.0006550621474161744
Iteration: 948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45088014006614685, gen p mean: -0.07940956205129623, mean p set: 0.45145851373672485
loss_pred:0.014843015000224113, decouple_loss:0.0006393404328264296
The modified gen p mean: 0.45188888907432556, gen p mean: -0.08256570249795914, mean p set: 0.45246466994285583
loss_pred:0.01423906534910202, decouple_loss:0.0005094479420222342
The modified gen p mean: 0.44923272728919983, gen p mean: -0.0829075276851654, mean p set: 0.4498084783554077
loss_pred:0.015478472225368023, decouple_loss:0.0005537198157981038
Iteration: 949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45132553577423096, gen p mean: -0.08778337389230728, mean p set: 0.4519042372703552
loss_pred:0.01516431663185358, decouple_loss:0.0006432905793190002
The modified gen p mean: 0.449162095785141, gen p mean: -0.0879143625497818, mean p set: 0.4497377276420593
loss_pred:0.015339421108365059, decouple_loss:0.000533946615178138
The modified gen p mean: 0.45033660531044006, gen p mean: -0.08797940611839294, mean p set: 0.45091530680656433
loss_pred:0.014838076196610928, decouple_loss:0.0005608164938166738
Iteration: 950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44870108366012573, gen p mean: -0.09469681978225708, mean p set: 0.44927680492401123
loss_pred:0.016275323927402496, decouple_loss:0.000459959584986791
The modified gen p mean: 0.45215874910354614, gen p mean: -0.09076237678527832, mean p set: 0.4527328312397003
The modified gen p mean: 0.44790324568748474, gen p mean: -0.0959741473197937, mean p set: 0.44847941398620605
loss_pred:0.014810756780207157, decouple_loss:0.0005397963104769588
loss_pred:0.014654727652668953, decouple_loss:0.00043549982365220785
2023-05-02 06:37:58 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10076288878917694, mean p set: 0.4502691626548767
loss_pred:0.017209433019161224, decouple_loss:0.0005775584140792489
The modified gen p mean: 0.44953516125679016, gen p mean: -0.09470003843307495, mean p set: 0.4500633478164673
loss_pred:0.01650901325047016, decouple_loss:0.0006608343101106584
The modified gen p mean: 0.44982728362083435, gen p mean: -0.09386419504880905, mean p set: 0.45035696029663086
loss_pred:0.01669210009276867, decouple_loss:0.0007010899134911597
WV_1_PC_1_EH_0_PS_40, loss: 0.01683584228157997, avg_mse: 0.02616281434893608
current test mse: 0.026163
Iteration: 951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492524266242981, gen p mean: -0.09304849803447723, mean p set: 0.4498288631439209
loss_pred:0.015134194865822792, decouple_loss:0.0006476702401414514
The modified gen p mean: 0.4510429799556732, gen p mean: -0.08257658034563065, mean p set: 0.45161959528923035
loss_pred:0.015404530800879002, decouple_loss:0.0007210223702713847
The modified gen p mean: 0.4489929974079132, gen p mean: -0.094148188829422, mean p set: 0.4495699107646942
loss_pred:0.01567014493048191, decouple_loss:0.0005635353736579418
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
NaN value num: 0
Iteration: 952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515767991542816, gen p mean: -0.08446747064590454, mean p set: 0.4521554708480835
loss_pred:0.016246197745203972, decouple_loss:0.0008090802584774792
The modified gen p mean: 0.45130279660224915, gen p mean: -0.08661937713623047, mean p set: 0.45187854766845703The modified gen p mean: 0.4516979455947876, gen p mean: -0.08775372803211212, mean p set: 0.4522736966609955
loss_pred:0.01633293926715851, decouple_loss:0.0005960167618468404
loss_pred:0.015675364062190056, decouple_loss:0.0006951666437089443
Iteration: 953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511391520500183, gen p mean: -0.0864676982164383, mean p set: 0.4517157971858978
loss_pred:0.016144659370183945, decouple_loss:0.000649188703391701
The modified gen p mean: 0.4504331946372986, gen p mean: -0.0884225070476532, mean p set: 0.4510093629360199
loss_pred:0.01570245623588562, decouple_loss:0.0007177085499279201
The modified gen p mean: 0.4513683021068573, gen p mean: -0.08507383614778519, mean p set: 0.4519473612308502
loss_pred:0.01635022833943367, decouple_loss:0.0006035632104612887
Iteration: 954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528122544288635, gen p mean: -0.08570358157157898, mean p set: 0.4533900320529938
loss_pred:0.016134705394506454, decouple_loss:0.0006811456987634301
The modified gen p mean: 0.45117104053497314, gen p mean: -0.08802210539579391, mean p set: 0.4517492651939392
loss_pred:0.01502958219498396, decouple_loss:0.0007006846135482192
The modified gen p mean: 0.45100656151771545, gen p mean: -0.0835614800453186, mean p set: 0.45158323645591736
loss_pred:0.016968589276075363, decouple_loss:0.0007258984842337668
Iteration: 955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504193365573883, gen p mean: -0.08721994608640671, mean p set: 0.45099735260009766
loss_pred:0.015291661024093628, decouple_loss:0.0007906347163952887
The modified gen p mean: 0.4522746503353119, gen p mean: -0.09141438454389572, mean p set: 0.45285114645957947
The modified gen p mean: 0.45089155435562134, gen p mean: -0.09250765293836594, mean p set: 0.45146840810775757
loss_pred:0.015740977600216866, decouple_loss:0.0007771521341055632
loss_pred:0.01614573784172535, decouple_loss:0.000680032535456121
Iteration: 956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450982004404068, gen p mean: -0.08519694954156876, mean p set: 0.4515584707260132
loss_pred:0.01655496284365654, decouple_loss:0.0004329850780777633
The modified gen p mean: 0.4501330256462097, gen p mean: -0.08289787173271179, mean p set: 0.4507089853286743
The modified gen p mean: 0.4509805738925934, gen p mean: -0.08381187915802002, mean p set: 0.4515573978424072
loss_pred:0.015549776144325733, decouple_loss:0.00043863541213795543
loss_pred:0.01554346177726984, decouple_loss:0.0005493629141710699
Iteration: 957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107877254486084, gen p mean: -0.0865948423743248, mean p set: 0.4516545534133911
loss_pred:0.01651446335017681, decouple_loss:0.0008257427252829075
The modified gen p mean: 0.45167943835258484, gen p mean: -0.08418672531843185, mean p set: 0.45225754380226135
The modified gen p mean: 0.4498302936553955, gen p mean: -0.08095961064100266, mean p set: 0.45040586590766907
loss_pred:0.016780927777290344, decouple_loss:0.0008699868340045214
loss_pred:0.01590249501168728, decouple_loss:0.0008775716996751726
Iteration: 958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512569010257721, gen p mean: -0.07839144021272659, mean p set: 0.4518337547779083
loss_pred:0.01606667973101139, decouple_loss:0.0008203710895031691
The modified gen p mean: 0.4506984353065491, gen p mean: -0.07585939764976501, mean p set: 0.4512738585472107
loss_pred:0.016731945797801018, decouple_loss:0.0007143972907215357
The modified gen p mean: 0.4509465992450714, gen p mean: -0.07697214186191559, mean p set: 0.4515230059623718
loss_pred:0.01550923753529787, decouple_loss:0.000795266474597156
Iteration: 959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45094597339630127, gen p mean: -0.07718581706285477, mean p set: 0.45152246952056885
loss_pred:0.016913846135139465, decouple_loss:0.0006355828954838216
The modified gen p mean: 0.45093169808387756, gen p mean: -0.0814492255449295, mean p set: 0.45150890946388245
loss_pred:0.015146119520068169, decouple_loss:0.000468379381345585
The modified gen p mean: 0.45204928517341614, gen p mean: -0.0858176201581955, mean p set: 0.4526248872280121
loss_pred:0.01577492617070675, decouple_loss:0.0006467015482485294
Iteration: 960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45075371861457825, gen p mean: -0.08139119297266006, mean p set: 0.4513293206691742
loss_pred:0.015411837957799435, decouple_loss:0.0007358522270806134
The modified gen p mean: 0.4513998329639435, gen p mean: -0.07971227169036865, mean p set: 0.451976478099823
loss_pred:0.016300993040204048, decouple_loss:0.0009502297616563737
The modified gen p mean: 0.45043787360191345, gen p mean: -0.08310054242610931, mean p set: 0.4510124921798706
loss_pred:0.015582366846501827, decouple_loss:0.0007786275236867368
2023-05-02 06:40:43 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.09669095277786255, mean p set: 0.4502691626548767
loss_pred:0.017231980338692665, decouple_loss:0.0008007643045857549
The modified gen p mean: 0.4495357275009155, gen p mean: -0.09046025574207306, mean p set: 0.4500633478164673
loss_pred:0.01654702238738537, decouple_loss:0.0007564668776467443
The modified gen p mean: 0.4498296082019806, gen p mean: -0.08981985598802567, mean p set: 0.45035696029663086
loss_pred:0.016806041821837425, decouple_loss:0.0009740604436956346
WV_1_PC_1_EH_0_PS_40, loss: 0.016903869807720184, avg_mse: 0.026218231767416
current test mse: 0.026218
Iteration: 961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514296054840088, gen p mean: -0.0856086015701294, mean p set: 0.45200711488723755
loss_pred:0.016040058806538582, decouple_loss:0.000777949346229434
The modified gen p mean: 0.4500449597835541, gen p mean: -0.08175669610500336, mean p set: 0.4506221413612366The modified gen p mean: 0.45232006907463074, gen p mean: -0.08053688704967499, mean p set: 0.452898770570755
loss_pred:0.016131924465298653, decouple_loss:0.00064835324883461
loss_pred:0.016044847667217255, decouple_loss:0.0010039821499958634
Iteration: 962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518072009086609, gen p mean: -0.08291905373334885, mean p set: 0.4523850381374359
loss_pred:0.016551367938518524, decouple_loss:0.0006821691058576107
The modified gen p mean: 0.4506378173828125, gen p mean: -0.08455543965101242, mean p set: 0.45121413469314575The modified gen p mean: 0.4508320391178131, gen p mean: -0.08697386831045151, mean p set: 0.4514085352420807
loss_pred:0.015873076394200325, decouple_loss:0.0007364591001532972
loss_pred:0.015060190111398697, decouple_loss:0.0008665036293677986
Iteration: 963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515855014324188, gen p mean: -0.08418045938014984, mean p set: 0.4521616995334625
loss_pred:0.01631951332092285, decouple_loss:0.0004565852868836373
The modified gen p mean: 0.4506949484348297, gen p mean: -0.090099036693573, mean p set: 0.4512709379196167
loss_pred:0.015467938035726547, decouple_loss:0.00045180058805271983
The modified gen p mean: 0.45053553581237793, gen p mean: -0.0935816541314125, mean p set: 0.45111268758773804
loss_pred:0.014593341387808323, decouple_loss:0.0005334938759915531
Iteration: 964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450106143951416, gen p mean: -0.0904526486992836, mean p set: 0.450682133436203
The modified gen p mean: 0.44958892464637756, gen p mean: -0.09328694641590118, mean p set: 0.45016512274742126
loss_pred:0.01620030589401722, decouple_loss:0.0005276259034872055
loss_pred:0.016402728855609894, decouple_loss:0.001349567319266498
The modified gen p mean: 0.4505198895931244, gen p mean: -0.0931965708732605, mean p set: 0.4510968327522278
loss_pred:0.015542562119662762, decouple_loss:0.0010162319522351027
Iteration: 965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501768946647644, gen p mean: -0.09828091412782669, mean p set: 0.45075303316116333
loss_pred:0.01653245836496353, decouple_loss:0.0007232768111862242
The modified gen p mean: 0.4507167935371399, gen p mean: -0.09523729234933853, mean p set: 0.45129165053367615
loss_pred:0.015888700261712074, decouple_loss:0.0008437756914645433
The modified gen p mean: 0.4510374963283539, gen p mean: -0.09329982101917267, mean p set: 0.4516139328479767
loss_pred:0.016087986528873444, decouple_loss:0.0007156039937399328
Iteration: 966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510151147842407, gen p mean: -0.10416273027658463, mean p set: 0.45159196853637695
loss_pred:0.01606459729373455, decouple_loss:0.0006812180508859456
The modified gen p mean: 0.45000526309013367, gen p mean: -0.09617789834737778, mean p set: 0.45058155059814453
loss_pred:0.015869198366999626, decouple_loss:0.0004980069934390485
The modified gen p mean: 0.45178255438804626, gen p mean: -0.10611772537231445, mean p set: 0.4523589313030243
loss_pred:0.01544554065912962, decouple_loss:0.0010896846652030945
Iteration: 967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508967101573944, gen p mean: -0.10379909723997116, mean p set: 0.45147183537483215
loss_pred:0.01511436328291893, decouple_loss:0.0005130906356498599
The modified gen p mean: 0.45231902599334717, gen p mean: -0.10154940187931061, mean p set: 0.4528968930244446
The modified gen p mean: 0.45184126496315, gen p mean: -0.09948426485061646, mean p set: 0.4524179995059967
loss_pred:0.015499681234359741, decouple_loss:0.000629471498541534
loss_pred:0.01620991714298725, decouple_loss:0.000807936186902225
Iteration: 968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45009222626686096, gen p mean: -0.10748281329870224, mean p set: 0.45066869258880615
loss_pred:0.016290893778204918, decouple_loss:0.0004914125893265009
The modified gen p mean: 0.45149683952331543, gen p mean: -0.10323755443096161, mean p set: 0.452073335647583
The modified gen p mean: 0.4506984353065491, gen p mean: -0.10371606796979904, mean p set: 0.4512766897678375
loss_pred:0.015610148198902607, decouple_loss:0.0005791292642243207
loss_pred:0.015715112909674644, decouple_loss:0.0005141902365721762
Iteration: 969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45030611753463745, gen p mean: -0.10945980995893478, mean p set: 0.450882226228714
loss_pred:0.015079233795404434, decouple_loss:0.0009355697548016906
The modified gen p mean: 0.4508318603038788, gen p mean: -0.09884470701217651, mean p set: 0.4514089822769165
The modified gen p mean: 0.4503622055053711, gen p mean: -0.10248138010501862, mean p set: 0.4509367048740387
loss_pred:0.01563558727502823, decouple_loss:0.0009955313289538026
loss_pred:0.015451256185770035, decouple_loss:0.0012938122963532805
Iteration: 970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500613808631897, gen p mean: -0.1027979701757431, mean p set: 0.45063820481300354
loss_pred:0.015509110875427723, decouple_loss:0.0008231811807490885
The modified gen p mean: 0.4516262114048004, gen p mean: -0.09865978360176086, mean p set: 0.4522019624710083
The modified gen p mean: 0.44963112473487854, gen p mean: -0.09958160668611526, mean p set: 0.4502072036266327
loss_pred:0.015993565320968628, decouple_loss:0.0011705964570865035
loss_pred:0.015461415983736515, decouple_loss:0.0010290336795151234
2023-05-02 06:42:50 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11043623089790344, mean p set: 0.4502691626548767
loss_pred:0.017118975520133972, decouple_loss:0.0007405037758871913
The modified gen p mean: 0.44953304529190063, gen p mean: -0.1039634719491005, mean p set: 0.4500633478164673
loss_pred:0.016469065099954605, decouple_loss:0.0008534627268090844
The modified gen p mean: 0.4498281180858612, gen p mean: -0.10318674892187119, mean p set: 0.45035696029663086
loss_pred:0.016762426123023033, decouple_loss:0.0010854846332222223
WV_1_PC_1_EH_0_PS_40, loss: 0.016828147694468498, avg_mse: 0.02610061876475811
current test mse: 0.026101
Iteration: 971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514903724193573, gen p mean: -0.10200436413288116, mean p set: 0.45206722617149353
The modified gen p mean: 0.4529784023761749, gen p mean: -0.09615372121334076, mean p set: 0.4535543620586395
loss_pred:0.01583009399473667, decouple_loss:0.0006186675163917243
loss_pred:0.015332392416894436, decouple_loss:0.0008189291111193597
The modified gen p mean: 0.450480580329895, gen p mean: -0.09415049850940704, mean p set: 0.4510560631752014
loss_pred:0.01519270334392786, decouple_loss:0.0007693740190006793
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719794392585754, gen p mean: -0.1061871200799942, mean p set: 0.44777190685272217
loss_pred:0.014585317112505436, decouple_loss:0.0010989477159455419
The modified gen p mean: 0.44513922929763794, gen p mean: -0.11484713107347488, mean p set: 0.44571492075920105The modified gen p mean: 0.4477323293685913, gen p mean: -0.10347264260053635, mean p set: 0.4483067989349365
loss_pred:0.015059695579111576, decouple_loss:0.0012341985711827874
loss_pred:0.01591317169368267, decouple_loss:0.0009338665404357016
Iteration: 973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468989074230194, gen p mean: -0.1092112809419632, mean p set: 0.44747447967529297
The modified gen p mean: 0.44699063897132874, gen p mean: -0.10883691161870956, mean p set: 0.4475656747817993
loss_pred:0.015172946266829967, decouple_loss:0.0006901065935380757
loss_pred:0.015552152879536152, decouple_loss:0.0009161144844256341
The modified gen p mean: 0.44714778661727905, gen p mean: -0.11057522892951965, mean p set: 0.44772249460220337
loss_pred:0.01571732945740223, decouple_loss:0.000781517184805125
Iteration: 974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480755925178528, gen p mean: -0.10530537366867065, mean p set: 0.4486530125141144
loss_pred:0.015890303999185562, decouple_loss:0.0007305325125344098
The modified gen p mean: 0.44871971011161804, gen p mean: -0.11177194863557816, mean p set: 0.44929662346839905
loss_pred:0.015116165392100811, decouple_loss:0.0011360369389876723
The modified gen p mean: 0.4469710886478424, gen p mean: -0.1095072403550148, mean p set: 0.44754740595817566
loss_pred:0.015819143503904343, decouple_loss:0.001266392064280808
Iteration: 975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478115141391754, gen p mean: -0.11003651469945908, mean p set: 0.4483872950077057
The modified gen p mean: 0.44785836338996887, gen p mean: -0.10983236134052277, mean p set: 0.44843539595603943loss_pred:0.014944931492209435, decouple_loss:0.0009690348524600267
loss_pred:0.014635208062827587, decouple_loss:0.0008659037412144244
The modified gen p mean: 0.4487013816833496, gen p mean: -0.11345069855451584, mean p set: 0.44927650690078735
loss_pred:0.014835764653980732, decouple_loss:0.0009898063726723194
Iteration: 976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480575919151306, gen p mean: -0.10919272154569626, mean p set: 0.4486336410045624
The modified gen p mean: 0.4469287693500519, gen p mean: -0.10734129697084427, mean p set: 0.4475022256374359
loss_pred:0.015371391549706459, decouple_loss:0.0007807978545315564
loss_pred:0.015088639222085476, decouple_loss:0.0007415033760480583
The modified gen p mean: 0.4479374587535858, gen p mean: -0.1038626879453659, mean p set: 0.4485151767730713
loss_pred:0.014886165037751198, decouple_loss:0.0006649527349509299
Iteration: 977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777145981788635, gen p mean: -0.10585921257734299, mean p set: 0.4483468234539032
The modified gen p mean: 0.4463503956794739, gen p mean: -0.10543377697467804, mean p set: 0.4469250440597534
loss_pred:0.014607521705329418, decouple_loss:0.0004932393785566092
loss_pred:0.016213364899158478, decouple_loss:0.0006890525110065937
The modified gen p mean: 0.4471050202846527, gen p mean: -0.10473857820034027, mean p set: 0.44768208265304565
loss_pred:0.01455390639603138, decouple_loss:0.0005604489706456661
Iteration: 978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454815685749054, gen p mean: -0.11830735206604004, mean p set: 0.4460570514202118
loss_pred:0.014582297764718533, decouple_loss:0.0012449267087504268
The modified gen p mean: 0.44643762707710266, gen p mean: -0.11057528853416443, mean p set: 0.44701406359672546
The modified gen p mean: 0.44713276624679565, gen p mean: -0.1063217893242836, mean p set: 0.4477066397666931
loss_pred:0.015812350437045097, decouple_loss:0.0007651116466149688
loss_pred:0.015060032717883587, decouple_loss:0.0009763670968823135
Iteration: 979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465675950050354, gen p mean: -0.11230048537254333, mean p set: 0.44714486598968506
loss_pred:0.015391518361866474, decouple_loss:0.0009921466698870063
The modified gen p mean: 0.4474588930606842, gen p mean: -0.11120699346065521, mean p set: 0.44803762435913086
The modified gen p mean: 0.4462985396385193, gen p mean: -0.11498285830020905, mean p set: 0.44687342643737793
loss_pred:0.015144112519919872, decouple_loss:0.0008521880372427404
loss_pred:0.015966542065143585, decouple_loss:0.0011187463533133268
Iteration: 980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471947252750397, gen p mean: -0.10292297601699829, mean p set: 0.4477720260620117
loss_pred:0.014936424791812897, decouple_loss:0.0006884104222990572
The modified gen p mean: 0.44659289717674255, gen p mean: -0.11088790744543076, mean p set: 0.44717034697532654
The modified gen p mean: 0.4474053680896759, gen p mean: -0.10856505483388901, mean p set: 0.4479806125164032
loss_pred:0.015786321833729744, decouple_loss:0.0005043679266236722
loss_pred:0.01474000420421362, decouple_loss:0.0007139811641536653
2023-05-02 06:45:36 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10860350728034973, mean p set: 0.4502691626548767
loss_pred:0.01709767058491707, decouple_loss:0.0006106123328208923
The modified gen p mean: 0.44953420758247375, gen p mean: -0.10234139859676361, mean p set: 0.4500633478164673
loss_pred:0.01651155762374401, decouple_loss:0.0005534633528441191
The modified gen p mean: 0.4498293399810791, gen p mean: -0.10187646746635437, mean p set: 0.45035696029663086
loss_pred:0.016727721318602562, decouple_loss:0.0006427025073207915
WV_1_PC_1_EH_0_PS_40, loss: 0.016809096559882164, avg_mse: 0.026130488142371178
current test mse: 0.02613
Iteration: 981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44594019651412964, gen p mean: -0.11223619431257248, mean p set: 0.44651445746421814
loss_pred:0.014418533071875572, decouple_loss:0.0006716006901115179
The modified gen p mean: 0.4481552243232727, gen p mean: -0.10901814699172974, mean p set: 0.44873204827308655The modified gen p mean: 0.44816771149635315, gen p mean: -0.1073647141456604, mean p set: 0.4487445652484894
loss_pred:0.014422900974750519, decouple_loss:0.0005712172714993358
loss_pred:0.015064745210111141, decouple_loss:0.0005324145313352346
Iteration: 982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720783829689026, gen p mean: -0.10755032300949097, mean p set: 0.44778627157211304
The modified gen p mean: 0.4467763900756836, gen p mean: -0.10710588097572327, mean p set: 0.4473552703857422
loss_pred:0.014967730268836021, decouple_loss:0.0006675345357507467
loss_pred:0.014993023127317429, decouple_loss:0.0008350100251846015
The modified gen p mean: 0.4487113058567047, gen p mean: -0.11048545688390732, mean p set: 0.44928810000419617
loss_pred:0.015073908492922783, decouple_loss:0.000756610301323235
Iteration: 983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489143192768097, gen p mean: -0.11010187119245529, mean p set: 0.44949212670326233
loss_pred:0.014523605816066265, decouple_loss:0.0006485116318799555
The modified gen p mean: 0.4476107358932495, gen p mean: -0.11238862574100494, mean p set: 0.44818755984306335The modified gen p mean: 0.44790372252464294, gen p mean: -0.10797077417373657, mean p set: 0.44847849011421204
loss_pred:0.015160140581429005, decouple_loss:0.000743843091186136
loss_pred:0.014706010930240154, decouple_loss:0.0008557264227420092
Iteration: 984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44825831055641174, gen p mean: -0.10440701246261597, mean p set: 0.4488321542739868
loss_pred:0.014693552628159523, decouple_loss:0.0005934698856435716
The modified gen p mean: 0.44564709067344666, gen p mean: -0.11035209894180298, mean p set: 0.4462227523326874
loss_pred:0.014358140528202057, decouple_loss:0.0004988709697499871
The modified gen p mean: 0.44756805896759033, gen p mean: -0.10667171329259872, mean p set: 0.4481431543827057
loss_pred:0.014589114114642143, decouple_loss:0.0006282794056460261
Iteration: 985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44605952501296997, gen p mean: -0.10414198040962219, mean p set: 0.4466347098350525
loss_pred:0.014476463198661804, decouple_loss:0.0005198713624849916
The modified gen p mean: 0.44856366515159607, gen p mean: -0.10997366905212402, mean p set: 0.44913914799690247
loss_pred:0.015181071124970913, decouple_loss:0.0006109082023613155
The modified gen p mean: 0.4473395347595215, gen p mean: -0.10219577699899673, mean p set: 0.4479168951511383
loss_pred:0.014308221638202667, decouple_loss:0.0004557715728878975
Iteration: 986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465358257293701, gen p mean: -0.10142442584037781, mean p set: 0.4471120834350586
loss_pred:0.015122318640351295, decouple_loss:0.0007590522873215377
The modified gen p mean: 0.44765499234199524, gen p mean: -0.10933908820152283, mean p set: 0.44823282957077026
loss_pred:0.015319778583943844, decouple_loss:0.0009110790560953319
The modified gen p mean: 0.4480181336402893, gen p mean: -0.1011599749326706, mean p set: 0.44859448075294495
loss_pred:0.015332541428506374, decouple_loss:0.0008069354807958007
Iteration: 987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713884592056274, gen p mean: -0.10330546647310257, mean p set: 0.4477138817310333
The modified gen p mean: 0.4475794732570648, gen p mean: -0.10616275668144226, mean p set: 0.44815605878829956
loss_pred:0.014697200618684292, decouple_loss:0.0007567758439108729
loss_pred:0.014594191685318947, decouple_loss:0.0006535689462907612
The modified gen p mean: 0.44629597663879395, gen p mean: -0.1049468144774437, mean p set: 0.44687098264694214
loss_pred:0.014267375692725182, decouple_loss:0.0005634992849081755
Iteration: 988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44649529457092285, gen p mean: -0.10736163705587387, mean p set: 0.4470709264278412
loss_pred:0.015847845003008842, decouple_loss:0.0005908749881200492
The modified gen p mean: 0.4479474723339081, gen p mean: -0.109371118247509, mean p set: 0.4485243558883667
loss_pred:0.014326916076242924, decouple_loss:0.0005118998815305531
The modified gen p mean: 0.4463847577571869, gen p mean: -0.1035827100276947, mean p set: 0.44696107506752014
loss_pred:0.015076709911227226, decouple_loss:0.0005478098173625767
Iteration: 989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458746314048767, gen p mean: -0.10833802819252014, mean p set: 0.4464513063430786
loss_pred:0.015495901927351952, decouple_loss:0.0007248232723213732
The modified gen p mean: 0.44652602076530457, gen p mean: -0.10913174599409103, mean p set: 0.44710099697113037
The modified gen p mean: 0.4469943642616272, gen p mean: -0.10529300570487976, mean p set: 0.44757208228111267
loss_pred:0.014808056876063347, decouple_loss:0.0006769901956431568
loss_pred:0.014498816803097725, decouple_loss:0.0006668602582067251
Iteration: 990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851261377334595, gen p mean: -0.11637952923774719, mean p set: 0.449090838432312
The modified gen p mean: 0.4466615915298462, gen p mean: -0.10303840786218643, mean p set: 0.4472406804561615
loss_pred:0.01464313454926014, decouple_loss:0.0005878958618268371
loss_pred:0.014807017520070076, decouple_loss:0.0005540760466828942
The modified gen p mean: 0.4468502104282379, gen p mean: -0.11167702078819275, mean p set: 0.44742488861083984
loss_pred:0.015618882142007351, decouple_loss:0.0008183945901691914
2023-05-02 06:47:42 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11303355544805527, mean p set: 0.4502691626548767
loss_pred:0.01702488586306572, decouple_loss:0.0006472181994467974
The modified gen p mean: 0.4495358169078827, gen p mean: -0.10563516616821289, mean p set: 0.4500633478164673
loss_pred:0.01647782512009144, decouple_loss:0.0006783356075175107
The modified gen p mean: 0.4498288929462433, gen p mean: -0.10544252395629883, mean p set: 0.45035696029663086
loss_pred:0.016729868948459625, decouple_loss:0.0004361599567346275
WV_1_PC_1_EH_0_PS_40, loss: 0.016773555427789688, avg_mse: 0.026140594854950905
current test mse: 0.026141
Iteration: 991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44833818078041077, gen p mean: -0.11362133175134659, mean p set: 0.4489142596721649
loss_pred:0.014561017043888569, decouple_loss:0.0005539397825486958
The modified gen p mean: 0.4461343586444855, gen p mean: -0.11240188777446747, mean p set: 0.4467092752456665
loss_pred:0.015530974604189396, decouple_loss:0.0005112409708090127
The modified gen p mean: 0.44591596722602844, gen p mean: -0.10442940145730972, mean p set: 0.44649171829223633
loss_pred:0.015165491960942745, decouple_loss:0.0007443107315339148
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
NaN value num: 0
Iteration: 992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45207029581069946, gen p mean: -0.10079178959131241, mean p set: 0.4526466727256775
loss_pred:0.01612645760178566, decouple_loss:0.0005635743727907538
The modified gen p mean: 0.4508725702762604, gen p mean: -0.09963174909353256, mean p set: 0.45145025849342346The modified gen p mean: 0.45171019434928894, gen p mean: -0.10338703542947769, mean p set: 0.45228806138038635
loss_pred:0.01669253222644329, decouple_loss:0.0005842807586304843loss_pred:0.015541375614702702, decouple_loss:0.0004985871491953731
Iteration: 993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517682194709778, gen p mean: -0.10408052802085876, mean p set: 0.4523479640483856
loss_pred:0.015243682079017162, decouple_loss:0.0005655041895806789
The modified gen p mean: 0.45140334963798523, gen p mean: -0.10150665789842606, mean p set: 0.45198309421539307
loss_pred:0.016123950481414795, decouple_loss:0.0005744104855693877
The modified gen p mean: 0.45056238770484924, gen p mean: -0.09609043598175049, mean p set: 0.45114362239837646
loss_pred:0.014963041059672832, decouple_loss:0.0005584551836363971
Iteration: 994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45314496755599976, gen p mean: -0.10337169468402863, mean p set: 0.4537212550640106
loss_pred:0.01555650308728218, decouple_loss:0.0007331895758397877
The modified gen p mean: 0.4521084725856781, gen p mean: -0.0976831391453743, mean p set: 0.4526858329772949
loss_pred:0.015635896474123, decouple_loss:0.0009164600051008165
The modified gen p mean: 0.4518207609653473, gen p mean: -0.09899266809225082, mean p set: 0.4523969888687134
loss_pred:0.015626126900315285, decouple_loss:0.000656779739074409
Iteration: 995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45226943492889404, gen p mean: -0.09459470957517624, mean p set: 0.4528461992740631
loss_pred:0.01509873941540718, decouple_loss:0.0006465141195803881
The modified gen p mean: 0.4525814354419708, gen p mean: -0.10295484215021133, mean p set: 0.4531596302986145
loss_pred:0.015286648645997047, decouple_loss:0.0005023665726184845
The modified gen p mean: 0.4511069357395172, gen p mean: -0.10196097940206528, mean p set: 0.4516848623752594
loss_pred:0.015594558790326118, decouple_loss:0.0012238131603226066
Iteration: 996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45183831453323364, gen p mean: -0.09899237751960754, mean p set: 0.45241400599479675
loss_pred:0.01539765577763319, decouple_loss:0.0006919861771166325
The modified gen p mean: 0.4523169696331024, gen p mean: -0.09866587072610855, mean p set: 0.4528920352458954
loss_pred:0.015859702602028847, decouple_loss:0.0005948193720541894
The modified gen p mean: 0.45319855213165283, gen p mean: -0.10930730402469635, mean p set: 0.453777015209198
loss_pred:0.014996997080743313, decouple_loss:0.0007396736182272434
Iteration: 997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516364634037018, gen p mean: -0.10582762211561203, mean p set: 0.45221495628356934
loss_pred:0.015602538362145424, decouple_loss:0.000699759169947356
The modified gen p mean: 0.4519871473312378, gen p mean: -0.1015426516532898, mean p set: 0.45256444811820984
loss_pred:0.015110723674297333, decouple_loss:0.0008288046228699386
The modified gen p mean: 0.453286349773407, gen p mean: -0.10412392020225525, mean p set: 0.45386558771133423
loss_pred:0.015034220181405544, decouple_loss:0.0008421600214205682
Iteration: 998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45130059123039246, gen p mean: -0.10310496389865875, mean p set: 0.4518786072731018
loss_pred:0.01565285585820675, decouple_loss:0.0008632070966996253
The modified gen p mean: 0.4534566402435303, gen p mean: -0.09859348833560944, mean p set: 0.45403215289115906
loss_pred:0.015198498964309692, decouple_loss:0.0005885784630663693
The modified gen p mean: 0.45344579219818115, gen p mean: -0.09756231307983398, mean p set: 0.4540221691131592
loss_pred:0.01481586042791605, decouple_loss:0.0006168946856632829
Iteration: 999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45064637064933777, gen p mean: -0.09488026052713394, mean p set: 0.4512217342853546
loss_pred:0.015010017901659012, decouple_loss:0.0006505618803203106
The modified gen p mean: 0.4525217115879059, gen p mean: -0.10069194436073303, mean p set: 0.4530986547470093
loss_pred:0.015083027072250843, decouple_loss:0.0009953153785318136
The modified gen p mean: 0.45232105255126953, gen p mean: -0.09726733714342117, mean p set: 0.45289722084999084
loss_pred:0.014912955462932587, decouple_loss:0.0007422403432428837
Iteration: 1000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45194876194000244, gen p mean: -0.10211273282766342, mean p set: 0.4525260329246521
loss_pred:0.015642963349819183, decouple_loss:0.0009892522357404232
The modified gen p mean: 0.45163992047309875, gen p mean: -0.09488756954669952, mean p set: 0.4522169232368469
The modified gen p mean: 0.4517786502838135, gen p mean: -0.0955708846449852, mean p set: 0.452355295419693
loss_pred:0.01527304109185934, decouple_loss:0.000882015738170594
loss_pred:0.01517906691879034, decouple_loss:0.0011606605257838964
2023-05-02 06:50:27 itr: 1000
training loss: [0.0152371  0.01531714 0.01569243]
2023-05-02 06:50:27 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1128293052315712, mean p set: 0.4502691626548767
loss_pred:0.01716846600174904, decouple_loss:0.0011867207940667868
The modified gen p mean: 0.44953545928001404, gen p mean: -0.10569743812084198, mean p set: 0.4500633478164673
loss_pred:0.01651052199304104, decouple_loss:0.0008627089555375278
The modified gen p mean: 0.44982802867889404, gen p mean: -0.10558589547872543, mean p set: 0.45035696029663086
loss_pred:0.016738254576921463, decouple_loss:0.0010456338059157133
WV_1_PC_1_EH_0_PS_40, loss: 0.01685733161866665, avg_mse: 0.026193739846348763
current test mse: 0.026194
Iteration: 1001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511537253856659, gen p mean: -0.09593888372182846, mean p set: 0.45172953605651855
loss_pred:0.015013226307928562, decouple_loss:0.0007863985956646502
The modified gen p mean: 0.45248687267303467, gen p mean: -0.09459474682807922, mean p set: 0.45306316018104553
loss_pred:0.015382319688796997, decouple_loss:0.0009027479682117701
The modified gen p mean: 0.4531632661819458, gen p mean: -0.09915156662464142, mean p set: 0.453741192817688
loss_pred:0.015088011510670185, decouple_loss:0.0008878954104147851
Iteration: 1002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520703852176666, gen p mean: -0.10098139196634293, mean p set: 0.4526461064815521
loss_pred:0.01528988964855671, decouple_loss:0.0008573316154070199
The modified gen p mean: 0.4514194428920746, gen p mean: -0.09838909655809402, mean p set: 0.4519937038421631The modified gen p mean: 0.4511795938014984, gen p mean: -0.10440336167812347, mean p set: 0.4517561197280884
loss_pred:0.015146957710385323, decouple_loss:0.0008896552608348429
loss_pred:0.015359172597527504, decouple_loss:0.0008134717354550958
Iteration: 1003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525532126426697, gen p mean: -0.09673895686864853, mean p set: 0.4531313478946686
loss_pred:0.015273047611117363, decouple_loss:0.0007838541641831398
The modified gen p mean: 0.4520512819290161, gen p mean: -0.09921499341726303, mean p set: 0.4526279866695404
loss_pred:0.01572730951011181, decouple_loss:0.0008117592660710216
The modified gen p mean: 0.4523268938064575, gen p mean: -0.09873452037572861, mean p set: 0.4529043138027191
loss_pred:0.01496457401663065, decouple_loss:0.0008430233574472368
Iteration: 1004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509245455265045, gen p mean: -0.09595616161823273, mean p set: 0.45150119066238403
loss_pred:0.015747586265206337, decouple_loss:0.0012849074555560946
The modified gen p mean: 0.453046053647995, gen p mean: -0.09930979460477829, mean p set: 0.45362168550491333
loss_pred:0.014753075316548347, decouple_loss:0.001365272211842239
The modified gen p mean: 0.4526134133338928, gen p mean: -0.09848418086767197, mean p set: 0.4531908929347992
loss_pred:0.01488614734262228, decouple_loss:0.0011410819133743644
Iteration: 1005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526066482067108, gen p mean: -0.10647182911634445, mean p set: 0.4531821608543396
loss_pred:0.015236268751323223, decouple_loss:0.0006899433792568743
The modified gen p mean: 0.4514550566673279, gen p mean: -0.09590107947587967, mean p set: 0.45203232765197754
loss_pred:0.01564044877886772, decouple_loss:0.0011357666226103902
The modified gen p mean: 0.45170941948890686, gen p mean: -0.09904749691486359, mean p set: 0.45228642225265503
loss_pred:0.015344002284109592, decouple_loss:0.000592957076150924
Iteration: 1006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505388140678406, gen p mean: -0.0977080836892128, mean p set: 0.451114296913147
loss_pred:0.015296951867640018, decouple_loss:0.000753402360714972
The modified gen p mean: 0.451998233795166, gen p mean: -0.09859741479158401, mean p set: 0.452574759721756
loss_pred:0.015491091646254063, decouple_loss:0.0005835277261212468
The modified gen p mean: 0.4513760209083557, gen p mean: -0.10301190614700317, mean p set: 0.45195239782333374
loss_pred:0.016183342784643173, decouple_loss:0.0006413208902813494
Iteration: 1007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522978365421295, gen p mean: -0.102923184633255, mean p set: 0.45287367701530457
loss_pred:0.015277329832315445, decouple_loss:0.0008758289623074234
The modified gen p mean: 0.4502602517604828, gen p mean: -0.09524338692426682, mean p set: 0.4508371949195862
loss_pred:0.01538583729416132, decouple_loss:0.00046105904038995504
The modified gen p mean: 0.451395183801651, gen p mean: -0.10141065716743469, mean p set: 0.4519711136817932
loss_pred:0.01584465429186821, decouple_loss:0.0007939696661196649
Iteration: 1008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519393742084503, gen p mean: -0.09663484245538712, mean p set: 0.4525179862976074
loss_pred:0.014406680129468441, decouple_loss:0.0009155014995485544
The modified gen p mean: 0.45082053542137146, gen p mean: -0.10214304178953171, mean p set: 0.4513972997665405
loss_pred:0.01570081152021885, decouple_loss:0.0005142044392414391
The modified gen p mean: 0.4533543586730957, gen p mean: -0.10230856388807297, mean p set: 0.45393162965774536
loss_pred:0.015382583253085613, decouple_loss:0.000818308035377413
Iteration: 1009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45328375697135925, gen p mean: -0.10148531943559647, mean p set: 0.4538623094558716
The modified gen p mean: 0.45300522446632385, gen p mean: -0.09944005310535431, mean p set: 0.45358291268348694
loss_pred:0.015347130596637726, decouple_loss:0.0005884904530830681
loss_pred:0.014308766461908817, decouple_loss:0.000885814253706485
The modified gen p mean: 0.4505964517593384, gen p mean: -0.09965086728334427, mean p set: 0.4511723518371582
loss_pred:0.015120607800781727, decouple_loss:0.0005770694697275758
Iteration: 1010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511432349681854, gen p mean: -0.100651815533638, mean p set: 0.45171958208084106
loss_pred:0.015267979353666306, decouple_loss:0.000519556924700737
The modified gen p mean: 0.45183002948760986, gen p mean: -0.10327737778425217, mean p set: 0.45240697264671326
The modified gen p mean: 0.45077332854270935, gen p mean: -0.10539346933364868, mean p set: 0.4513482451438904
loss_pred:0.014575626701116562, decouple_loss:0.0005305780214257538
loss_pred:0.015363957732915878, decouple_loss:0.0005419596564024687
2023-05-02 06:52:34 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11736525595188141, mean p set: 0.4502691626548767
loss_pred:0.017046060413122177, decouple_loss:0.001533507602289319
The modified gen p mean: 0.44953426718711853, gen p mean: -0.11085352301597595, mean p set: 0.4500633478164673
loss_pred:0.016477815806865692, decouple_loss:0.0014897414948791265
The modified gen p mean: 0.44982993602752686, gen p mean: -0.11041095852851868, mean p set: 0.45035696029663086
loss_pred:0.016657229512929916, decouple_loss:0.0012641452485695481
WV_1_PC_1_EH_0_PS_40, loss: 0.016798492521047592, avg_mse: 0.026066726073622704
current test mse: 0.026067
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
NaN value num: 0
Iteration: 1011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512167274951935, gen p mean: -0.11131928116083145, mean p set: 0.4517945945262909
loss_pred:0.014934547245502472, decouple_loss:0.0008327226969413459
The modified gen p mean: 0.45171698927879333, gen p mean: -0.10920590907335281, mean p set: 0.4522937834262848
loss_pred:0.015080584213137627, decouple_loss:0.0011239126324653625
The modified gen p mean: 0.4520062804222107, gen p mean: -0.10356289893388748, mean p set: 0.45258012413978577
loss_pred:0.016189901158213615, decouple_loss:0.0006590313278138638
Iteration: 1012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45047634840011597, gen p mean: -0.10162874311208725, mean p set: 0.45105281472206116
loss_pred:0.015035584568977356, decouple_loss:0.0005334976012818515
The modified gen p mean: 0.4511726200580597, gen p mean: -0.10284204035997391, mean p set: 0.45174819231033325The modified gen p mean: 0.451101690530777, gen p mean: -0.10146243870258331, mean p set: 0.4516793489456177
loss_pred:0.01620609499514103, decouple_loss:0.0006244779215194285
loss_pred:0.016705475747585297, decouple_loss:0.0009288587607443333
Iteration: 1013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509110748767853, gen p mean: -0.09701329469680786, mean p set: 0.45148617029190063
The modified gen p mean: 0.45070749521255493, gen p mean: -0.09950362890958786, mean p set: 0.4512825310230255
loss_pred:0.015898583456873894, decouple_loss:0.0007966632838360965
loss_pred:0.015709828585386276, decouple_loss:0.0007466262904927135
The modified gen p mean: 0.4508756101131439, gen p mean: -0.10114200413227081, mean p set: 0.45145145058631897
loss_pred:0.016292747110128403, decouple_loss:0.0008091571507975459
Iteration: 1014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45051005482673645, gen p mean: -0.10969776660203934, mean p set: 0.45108652114868164
loss_pred:0.017366599291563034, decouple_loss:0.0009507880313321948
The modified gen p mean: 0.45181772112846375, gen p mean: -0.11493664234876633, mean p set: 0.45239561796188354
loss_pred:0.01582770235836506, decouple_loss:0.0005868376465514302
The modified gen p mean: 0.45026901364326477, gen p mean: -0.11235000193119049, mean p set: 0.4508439898490906
loss_pred:0.015446702018380165, decouple_loss:0.0007264501182362437
Iteration: 1015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019495487213135, gen p mean: -0.11485176533460617, mean p set: 0.4507710039615631
loss_pred:0.016277428716421127, decouple_loss:0.0004401947953738272
The modified gen p mean: 0.44994693994522095, gen p mean: -0.1119854748249054, mean p set: 0.45052260160446167
loss_pred:0.015725085511803627, decouple_loss:0.000811973528470844
The modified gen p mean: 0.4528089165687561, gen p mean: -0.11124526709318161, mean p set: 0.45338475704193115
loss_pred:0.015939023345708847, decouple_loss:0.0010105549590662122
Iteration: 1016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523461163043976, gen p mean: -0.10981716960668564, mean p set: 0.4529227614402771
The modified gen p mean: 0.45164674520492554, gen p mean: -0.11355947703123093, mean p set: 0.45222604274749756
loss_pred:0.016111060976982117, decouple_loss:0.001097767730243504
loss_pred:0.01686529815196991, decouple_loss:0.0009882132289931178
The modified gen p mean: 0.4513009786605835, gen p mean: -0.10788825154304504, mean p set: 0.45187801122665405
loss_pred:0.016393912956118584, decouple_loss:0.0009037232957780361
Iteration: 1017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45139431953430176, gen p mean: -0.11236805468797684, mean p set: 0.45197105407714844
loss_pred:0.016081081703305244, decouple_loss:0.0008238370064646006
The modified gen p mean: 0.45092150568962097, gen p mean: -0.11566480994224548, mean p set: 0.4514998197555542
loss_pred:0.01652602292597294, decouple_loss:0.0008166913175955415
The modified gen p mean: 0.45083293318748474, gen p mean: -0.11349768936634064, mean p set: 0.4514080286026001
loss_pred:0.016656935214996338, decouple_loss:0.0008855011546984315
Iteration: 1018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505310654640198, gen p mean: -0.114358089864254, mean p set: 0.4511098861694336
loss_pred:0.016890933737158775, decouple_loss:0.0005289599066600204
The modified gen p mean: 0.4509302079677582, gen p mean: -0.11786545813083649, mean p set: 0.451505571603775
loss_pred:0.01589466817677021, decouple_loss:0.00048410097952000797
The modified gen p mean: 0.45228683948516846, gen p mean: -0.11199763417243958, mean p set: 0.4528633952140808
loss_pred:0.01619548909366131, decouple_loss:0.0006041483138687909
Iteration: 1019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503024220466614, gen p mean: -0.11010925471782684, mean p set: 0.45088016986846924
loss_pred:0.016146739944815636, decouple_loss:0.0004908294067718089
The modified gen p mean: 0.45153820514678955, gen p mean: -0.12119875103235245, mean p set: 0.45211273431777954
loss_pred:0.016513889655470848, decouple_loss:0.0006372491479851305
The modified gen p mean: 0.451084703207016, gen p mean: -0.12273525446653366, mean p set: 0.45166081190109253
loss_pred:0.015966027975082397, decouple_loss:0.0007291381480172276
Iteration: 1020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514572024345398, gen p mean: -0.11765865981578827, mean p set: 0.4520331025123596
loss_pred:0.016344202682375908, decouple_loss:0.0008187923231162131
The modified gen p mean: 0.45266222953796387, gen p mean: -0.12263048440217972, mean p set: 0.4532400667667389
loss_pred:0.016961248591542244, decouple_loss:0.0006079667946323752
The modified gen p mean: 0.45044001936912537, gen p mean: -0.12417297810316086, mean p set: 0.4510160982608795
loss_pred:0.016296757385134697, decouple_loss:0.0008356037433259189
2023-05-02 06:55:21 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.12747697532176971, mean p set: 0.4502691626548767
loss_pred:0.017153441905975342, decouple_loss:0.0010451031848788261
The modified gen p mean: 0.44953542947769165, gen p mean: -0.12060120701789856, mean p set: 0.4500633478164673
loss_pred:0.016505902633070946, decouple_loss:0.000891753239557147
The modified gen p mean: 0.4498286843299866, gen p mean: -0.12030967324972153, mean p set: 0.45035696029663086
loss_pred:0.016803700476884842, decouple_loss:0.0006679272628389299
WV_1_PC_1_EH_0_PS_40, loss: 0.016864430159330368, avg_mse: 0.026205353438854218
current test mse: 0.026205
Iteration: 1021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45101043581962585, gen p mean: -0.11692486703395844, mean p set: 0.45158541202545166
loss_pred:0.016216792166233063, decouple_loss:0.0007853353745304048
The modified gen p mean: 0.4508405327796936, gen p mean: -0.11689276248216629, mean p set: 0.45141565799713135
loss_pred:0.016161950305104256, decouple_loss:0.0007245691958814859
The modified gen p mean: 0.4514491558074951, gen p mean: -0.1206875815987587, mean p set: 0.4520242512226105
loss_pred:0.015344230458140373, decouple_loss:0.0005733057041652501
Iteration: 1022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082855224609375, gen p mean: -0.10810398310422897, mean p set: 0.4514060616493225
The modified gen p mean: 0.45134222507476807, gen p mean: -0.11255505681037903, mean p set: 0.4519181549549103
loss_pred:0.016453128308057785, decouple_loss:0.0005628779763355851
loss_pred:0.01497663650661707, decouple_loss:0.0007385533535853028
The modified gen p mean: 0.4505080282688141, gen p mean: -0.10464030504226685, mean p set: 0.45108845829963684
loss_pred:0.015740225091576576, decouple_loss:0.0004456604947336018
Iteration: 1023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522055387496948, gen p mean: -0.10759533196687698, mean p set: 0.45278200507164
loss_pred:0.01586121879518032, decouple_loss:0.0007660496630705893
The modified gen p mean: 0.45212212204933167, gen p mean: -0.10985597223043442, mean p set: 0.45269879698753357
loss_pred:0.01538949366658926, decouple_loss:0.0005434654885903001
The modified gen p mean: 0.4511512517929077, gen p mean: -0.11241340637207031, mean p set: 0.45172742009162903
loss_pred:0.016073577105998993, decouple_loss:0.0007414974388666451
Iteration: 1024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45123565196990967, gen p mean: -0.11147353798151016, mean p set: 0.45181164145469666
loss_pred:0.016394928097724915, decouple_loss:0.0008686240762472153
The modified gen p mean: 0.45096057653427124, gen p mean: -0.10941944271326065, mean p set: 0.4515374004840851
loss_pred:0.01651899516582489, decouple_loss:0.000713594548869878
The modified gen p mean: 0.4505480229854584, gen p mean: -0.10776492953300476, mean p set: 0.4511229395866394
loss_pred:0.015926020219922066, decouple_loss:0.0009563269559293985
Iteration: 1025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513980448246002, gen p mean: -0.11108724772930145, mean p set: 0.45197397470474243
loss_pred:0.014795778319239616, decouple_loss:0.0009790848707780242
The modified gen p mean: 0.45081865787506104, gen p mean: -0.10225962102413177, mean p set: 0.4513946771621704
loss_pred:0.015659058466553688, decouple_loss:0.0008491030312143266
The modified gen p mean: 0.45080459117889404, gen p mean: -0.11652114242315292, mean p set: 0.4513830542564392
loss_pred:0.016483958810567856, decouple_loss:0.0006274874904192984
Iteration: 1026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501859247684479, gen p mean: -0.11068439483642578, mean p set: 0.45076268911361694
loss_pred:0.01623350940644741, decouple_loss:0.0006295761559158564
The modified gen p mean: 0.4510694146156311, gen p mean: -0.10595996677875519, mean p set: 0.45164790749549866
The modified gen p mean: 0.45096439123153687, gen p mean: -0.1148725152015686, mean p set: 0.45154067873954773
loss_pred:0.01596602238714695, decouple_loss:0.0008718266617506742
loss_pred:0.016112959012389183, decouple_loss:0.0005344623932614923
Iteration: 1027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128530263900757, gen p mean: -0.10801736265420914, mean p set: 0.4518622159957886
loss_pred:0.015873927623033524, decouple_loss:0.0005442125257104635
The modified gen p mean: 0.4527953565120697, gen p mean: -0.11243695765733719, mean p set: 0.45337486267089844
The modified gen p mean: 0.45124128460884094, gen p mean: -0.10504903644323349, mean p set: 0.45181748270988464
loss_pred:0.01541149616241455, decouple_loss:0.0006091695395298302
loss_pred:0.0162422526627779, decouple_loss:0.0006444594473578036
Iteration: 1028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097485184669495, gen p mean: -0.10859349370002747, mean p set: 0.4515528082847595
loss_pred:0.01647927239537239, decouple_loss:0.0004452403518371284
The modified gen p mean: 0.4523020088672638, gen p mean: -0.11137576401233673, mean p set: 0.4528789222240448
The modified gen p mean: 0.45181959867477417, gen p mean: -0.11403881013393402, mean p set: 0.45239734649658203
loss_pred:0.015711162239313126, decouple_loss:0.00046554519212804735
loss_pred:0.015569459646940231, decouple_loss:0.0004080103535670787
Iteration: 1029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45146024227142334, gen p mean: -0.11266345530748367, mean p set: 0.45203498005867004
loss_pred:0.01611574925482273, decouple_loss:0.0005268873064778745
The modified gen p mean: 0.4509284794330597, gen p mean: -0.11338041722774506, mean p set: 0.4515029489994049
The modified gen p mean: 0.44931432604789734, gen p mean: -0.11748461425304413, mean p set: 0.4498913586139679
loss_pred:0.015002170577645302, decouple_loss:0.0005495221121236682
loss_pred:0.015261296182870865, decouple_loss:0.0006244863034226
Iteration: 1030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506382346153259, gen p mean: -0.11425834894180298, mean p set: 0.4512137174606323
loss_pred:0.01505790650844574, decouple_loss:0.0005148871568962932
The modified gen p mean: 0.45231038331985474, gen p mean: -0.12076690793037415, mean p set: 0.45288771390914917
The modified gen p mean: 0.4511118531227112, gen p mean: -0.12384160608053207, mean p set: 0.4516860842704773
loss_pred:0.0165098886936903, decouple_loss:0.0007410151301883161
loss_pred:0.016170870512723923, decouple_loss:0.0006785665173083544
2023-05-02 06:57:28 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13288630545139313, mean p set: 0.4502691626548767
loss_pred:0.017205702140927315, decouple_loss:0.001030928804539144
The modified gen p mean: 0.4495360553264618, gen p mean: -0.12542246282100677, mean p set: 0.4500633478164673
loss_pred:0.016391338780522346, decouple_loss:0.0008956258534453809
The modified gen p mean: 0.44982805848121643, gen p mean: -0.12521453201770782, mean p set: 0.45035696029663086
loss_pred:0.01677161082625389, decouple_loss:0.0007719204877503216
WV_1_PC_1_EH_0_PS_40, loss: 0.016834525391459465, avg_mse: 0.026141945272684097
current test mse: 0.026142
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 1031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483400881290436, gen p mean: -0.1333799958229065, mean p set: 0.44891637563705444
loss_pred:0.014611550606787205, decouple_loss:0.0007855123258195817
The modified gen p mean: 0.4471605122089386, gen p mean: -0.1290864497423172, mean p set: 0.4477364122867584
loss_pred:0.014669157564640045, decouple_loss:0.0005345888785086572
The modified gen p mean: 0.4475676417350769, gen p mean: -0.13012072443962097, mean p set: 0.4481446146965027
loss_pred:0.015619085170328617, decouple_loss:0.0006324640708044171
Iteration: 1032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837167859077454, gen p mean: -0.1141413077712059, mean p set: 0.44894805550575256
loss_pred:0.015025293454527855, decouple_loss:0.0005241450271569192
The modified gen p mean: 0.4480631351470947, gen p mean: -0.11596353352069855, mean p set: 0.44864022731781006
The modified gen p mean: 0.44754675030708313, gen p mean: -0.11994200944900513, mean p set: 0.4481230676174164
loss_pred:0.01500740833580494, decouple_loss:0.000531783327460289
loss_pred:0.014803588390350342, decouple_loss:0.0005358366179279983
Iteration: 1033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480661153793335, gen p mean: -0.1247190460562706, mean p set: 0.4486437141895294
loss_pred:0.014744861051440239, decouple_loss:0.0005126199685037136
The modified gen p mean: 0.4480612874031067, gen p mean: -0.12203297019004822, mean p set: 0.44863688945770264
loss_pred:0.014476336538791656, decouple_loss:0.0004905688110738993
The modified gen p mean: 0.44765377044677734, gen p mean: -0.11700903624296188, mean p set: 0.448231041431427
loss_pred:0.01486421748995781, decouple_loss:0.000649728812277317
Iteration: 1034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496448338031769, gen p mean: -0.11660820990800858, mean p set: 0.4502216577529907
loss_pred:0.015029510483145714, decouple_loss:0.0007874019211158156
The modified gen p mean: 0.4469318687915802, gen p mean: -0.12125863879919052, mean p set: 0.4475100636482239
loss_pred:0.01449569407850504, decouple_loss:0.00039158586878329515
The modified gen p mean: 0.4487744867801666, gen p mean: -0.12188572436571121, mean p set: 0.44935348629951477
loss_pred:0.014942123554646969, decouple_loss:0.0005248998641036451
Iteration: 1035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44929301738739014, gen p mean: -0.12373938411474228, mean p set: 0.4498688280582428
loss_pred:0.014355545863509178, decouple_loss:0.0005099537665955722
The modified gen p mean: 0.44732072949409485, gen p mean: -0.12164268642663956, mean p set: 0.4478953182697296
loss_pred:0.01441576611250639, decouple_loss:0.0003965493815485388
The modified gen p mean: 0.44827932119369507, gen p mean: -0.1254422515630722, mean p set: 0.4488562345504761
loss_pred:0.014731192030012608, decouple_loss:0.00046855947584845126
Iteration: 1036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44926944375038147, gen p mean: -0.12399617582559586, mean p set: 0.44984567165374756
loss_pred:0.014709115959703922, decouple_loss:0.0005067033343948424
The modified gen p mean: 0.45040127635002136, gen p mean: -0.1313910037279129, mean p set: 0.45098060369491577
The modified gen p mean: 0.44831520318984985, gen p mean: -0.1315283179283142, mean p set: 0.44889357686042786
loss_pred:0.014372650533914566, decouple_loss:0.00047197265666909516
loss_pred:0.014379261992871761, decouple_loss:0.0005598349962383509
Iteration: 1037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733232259750366, gen p mean: -0.1174030750989914, mean p set: 0.4479077458381653
loss_pred:0.014256926253437996, decouple_loss:0.0006160112679935992
The modified gen p mean: 0.44824111461639404, gen p mean: -0.11766847968101501, mean p set: 0.44881969690322876
loss_pred:0.015208245255053043, decouple_loss:0.0005467728478834033
The modified gen p mean: 0.44812124967575073, gen p mean: -0.12919044494628906, mean p set: 0.4486970603466034
loss_pred:0.014688625931739807, decouple_loss:0.0004938988131470978
Iteration: 1038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483591318130493, gen p mean: -0.12944558262825012, mean p set: 0.4489334523677826
loss_pred:0.014231954701244831, decouple_loss:0.0004437681345734745
The modified gen p mean: 0.44777438044548035, gen p mean: -0.1254737228155136, mean p set: 0.4483504593372345
The modified gen p mean: 0.44844356179237366, gen p mean: -0.11639904975891113, mean p set: 0.44901901483535767
loss_pred:0.014210215769708157, decouple_loss:0.0005145588074810803
loss_pred:0.014988170005381107, decouple_loss:0.0005153212696313858
Iteration: 1039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467012882232666, gen p mean: -0.12482066452503204, mean p set: 0.44727620482444763
loss_pred:0.014779279008507729, decouple_loss:0.0006545131327584386
The modified gen p mean: 0.4490695595741272, gen p mean: -0.12434691190719604, mean p set: 0.4496456980705261
The modified gen p mean: 0.44870954751968384, gen p mean: -0.1302550733089447, mean p set: 0.4492855668067932
loss_pred:0.013905677944421768, decouple_loss:0.000923743296880275
loss_pred:0.014022991992533207, decouple_loss:0.00047236838145181537
Iteration: 1040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851964712142944, gen p mean: -0.1182321161031723, mean p set: 0.44909510016441345
loss_pred:0.014695736579596996, decouple_loss:0.0007230342598631978
The modified gen p mean: 0.4492645263671875, gen p mean: -0.12084215879440308, mean p set: 0.44984006881713867
The modified gen p mean: 0.4487493634223938, gen p mean: -0.13181711733341217, mean p set: 0.44932815432548523
loss_pred:0.014853829517960548, decouple_loss:0.00044748210348188877
loss_pred:0.014363177120685577, decouple_loss:0.0009678227943368256
2023-05-02 07:00:15 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1291913390159607, mean p set: 0.4502691626548767
loss_pred:0.01717398874461651, decouple_loss:0.0008588783093728125
The modified gen p mean: 0.44953668117523193, gen p mean: -0.1218864694237709, mean p set: 0.4500633478164673
loss_pred:0.016351385042071342, decouple_loss:0.0008666511857882142
The modified gen p mean: 0.44982653856277466, gen p mean: -0.12197083979845047, mean p set: 0.45035696029663086
loss_pred:0.01675812341272831, decouple_loss:0.0007839979371055961
WV_1_PC_1_EH_0_PS_40, loss: 0.016802992671728134, avg_mse: 0.026125973090529442
current test mse: 0.026126
Iteration: 1041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481433928012848, gen p mean: -0.1228451207280159, mean p set: 0.44872117042541504
loss_pred:0.014813737943768501, decouple_loss:0.0007759372238069773
The modified gen p mean: 0.44793006777763367, gen p mean: -0.12668022513389587, mean p set: 0.448505699634552
loss_pred:0.014256969094276428, decouple_loss:0.0007539736689068377
The modified gen p mean: 0.44811615347862244, gen p mean: -0.12755709886550903, mean p set: 0.44869375228881836
loss_pred:0.014521513134241104, decouple_loss:0.0008424313855357468
Iteration: 1042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823193550109863, gen p mean: -0.11690084636211395, mean p set: 0.44880932569503784
The modified gen p mean: 0.44752201437950134, gen p mean: -0.11523588001728058, mean p set: 0.4480955898761749
loss_pred:0.01462464313954115, decouple_loss:0.0006133652059361339
loss_pred:0.014729863032698631, decouple_loss:0.00040896402788348496
The modified gen p mean: 0.4488922953605652, gen p mean: -0.11548668146133423, mean p set: 0.4494667053222656
loss_pred:0.013770374469459057, decouple_loss:0.00044597810483537614
Iteration: 1043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680869579315186, gen p mean: -0.11394694447517395, mean p set: 0.44738414883613586
The modified gen p mean: 0.4478648006916046, gen p mean: -0.11350038647651672, mean p set: 0.44843941926956177
loss_pred:0.015202953480184078, decouple_loss:0.0006381931598298252
loss_pred:0.014131770469248295, decouple_loss:0.0005902870325371623
The modified gen p mean: 0.4476401209831238, gen p mean: -0.10996066778898239, mean p set: 0.4482152760028839
loss_pred:0.014545420184731483, decouple_loss:0.0006370084010995924
Iteration: 1044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484449028968811, gen p mean: -0.10806454718112946, mean p set: 0.44902175664901733
loss_pred:0.014678717590868473, decouple_loss:0.0006533488631248474
The modified gen p mean: 0.44883570075035095, gen p mean: -0.12017475068569183, mean p set: 0.4494134187698364
loss_pred:0.013897784985601902, decouple_loss:0.0007343286997638643
The modified gen p mean: 0.4483715295791626, gen p mean: -0.11915165930986404, mean p set: 0.4489465653896332
loss_pred:0.01428998913615942, decouple_loss:0.00045671360567212105
Iteration: 1045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892698526382446, gen p mean: -0.11667889356613159, mean p set: 0.4495035707950592
The modified gen p mean: 0.44853872060775757, gen p mean: -0.12645484507083893, mean p set: 0.4491152763366699
loss_pred:0.01390351913869381, decouple_loss:0.00048097295803017914
loss_pred:0.01409937720745802, decouple_loss:0.00040867971256375313
The modified gen p mean: 0.44715631008148193, gen p mean: -0.11770007759332657, mean p set: 0.4477311074733734
loss_pred:0.014487841166555882, decouple_loss:0.00045802054228261113
Iteration: 1046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481429159641266, gen p mean: -0.12310390919446945, mean p set: 0.44871968030929565
loss_pred:0.013956715352833271, decouple_loss:0.000471171282697469
The modified gen p mean: 0.4476550817489624, gen p mean: -0.11489684134721756, mean p set: 0.44823071360588074
The modified gen p mean: 0.4488476812839508, gen p mean: -0.11845404654741287, mean p set: 0.4494239091873169
loss_pred:0.0140385115519166, decouple_loss:0.00047272504889406264
loss_pred:0.013488936237990856, decouple_loss:0.0004782219184562564
Iteration: 1047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44672471284866333, gen p mean: -0.1179523840546608, mean p set: 0.44730088114738464
loss_pred:0.01435921248048544, decouple_loss:0.0005022916593588889
The modified gen p mean: 0.4475097954273224, gen p mean: -0.12007127702236176, mean p set: 0.4480842351913452
The modified gen p mean: 0.44796741008758545, gen p mean: -0.11086823046207428, mean p set: 0.4485420286655426
loss_pred:0.014170205220580101, decouple_loss:0.0009343496058136225
loss_pred:0.014662791043519974, decouple_loss:0.0007833567215129733
Iteration: 1048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45047619938850403, gen p mean: -0.12158554792404175, mean p set: 0.4510541558265686
loss_pred:0.01429513655602932, decouple_loss:0.0009853964438661933
The modified gen p mean: 0.4480714201927185, gen p mean: -0.11529669165611267, mean p set: 0.448650062084198
The modified gen p mean: 0.4489574432373047, gen p mean: -0.11527872830629349, mean p set: 0.449531614780426
loss_pred:0.014403858222067356, decouple_loss:0.0005862052203156054
loss_pred:0.014477450400590897, decouple_loss:0.000721482269000262
Iteration: 1049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862762093544006, gen p mean: -0.12175858020782471, mean p set: 0.4492042660713196
loss_pred:0.013647925108671188, decouple_loss:0.0007455577724613249
The modified gen p mean: 0.44879549741744995, gen p mean: -0.1250038594007492, mean p set: 0.44937342405319214
The modified gen p mean: 0.4480441212654114, gen p mean: -0.11555836349725723, mean p set: 0.448621928691864
loss_pred:0.013937503099441528, decouple_loss:0.0007064485689625144
loss_pred:0.014577958732843399, decouple_loss:0.0005251173279248178
Iteration: 1050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835251569747925, gen p mean: -0.11637680977582932, mean p set: 0.44892609119415283
loss_pred:0.014002552255988121, decouple_loss:0.0006163730286061764
The modified gen p mean: 0.44735413789749146, gen p mean: -0.11914525926113129, mean p set: 0.4479316174983978
The modified gen p mean: 0.4479210376739502, gen p mean: -0.12101267278194427, mean p set: 0.4484964609146118
loss_pred:0.01489054225385189, decouple_loss:0.0005580156575888395
loss_pred:0.013840943574905396, decouple_loss:0.0004215094377286732
2023-05-02 07:02:22 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12351536750793457, mean p set: 0.4502691626548767
loss_pred:0.01711169444024563, decouple_loss:0.0004985591513104737
The modified gen p mean: 0.4495347738265991, gen p mean: -0.1169620230793953, mean p set: 0.4500633478164673
loss_pred:0.016315558925271034, decouple_loss:0.0006119635654613376
The modified gen p mean: 0.44982850551605225, gen p mean: -0.11662790179252625, mean p set: 0.45035696029663086
loss_pred:0.016723621636629105, decouple_loss:0.0006414473173208535
WV_1_PC_1_EH_0_PS_40, loss: 0.0167461596429348, avg_mse: 0.026146739721298218
current test mse: 0.026147
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 1051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44650545716285706, gen p mean: -0.12200092524290085, mean p set: 0.4470827281475067
loss_pred:0.015215043909847736, decouple_loss:0.0005373909953050315
The modified gen p mean: 0.4465637505054474, gen p mean: -0.1262318342924118, mean p set: 0.44713932275772095
loss_pred:0.015437585301697254, decouple_loss:0.0005298473406583071
The modified gen p mean: 0.44661596417427063, gen p mean: -0.12289097905158997, mean p set: 0.44719311594963074
loss_pred:0.015165341086685658, decouple_loss:0.0004882249631918967
Iteration: 1052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457668662071228, gen p mean: -0.1204371526837349, mean p set: 0.4463409185409546
loss_pred:0.01530411746352911, decouple_loss:0.0004143097612541169
The modified gen p mean: 0.44729068875312805, gen p mean: -0.11771495640277863, mean p set: 0.4478660225868225The modified gen p mean: 0.44600626826286316, gen p mean: -0.11690399050712585, mean p set: 0.4465799629688263
loss_pred:0.0160354096442461, decouple_loss:0.0003560988116078079
loss_pred:0.01516710128635168, decouple_loss:0.00046503209159709513
Iteration: 1053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445599228143692, gen p mean: -0.11510365456342697, mean p set: 0.446174293756485
loss_pred:0.01536459382623434, decouple_loss:0.00048337725456804037
The modified gen p mean: 0.4460826814174652, gen p mean: -0.11060501635074615, mean p set: 0.4466569721698761
loss_pred:0.015535968355834484, decouple_loss:0.0007676336099393666
The modified gen p mean: 0.446460485458374, gen p mean: -0.11562667787075043, mean p set: 0.4470359981060028
loss_pred:0.01497728656977415, decouple_loss:0.0006688034627586603
Iteration: 1054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44578367471694946, gen p mean: -0.11240314692258835, mean p set: 0.4463599622249603
The modified gen p mean: 0.445864200592041, gen p mean: -0.114470936357975, mean p set: 0.4464392364025116
loss_pred:0.01529552973806858, decouple_loss:0.0003850374196190387
loss_pred:0.0152791328728199, decouple_loss:0.0004266182368155569
The modified gen p mean: 0.44608646631240845, gen p mean: -0.1073734238743782, mean p set: 0.44666188955307007
loss_pred:0.015528924763202667, decouple_loss:0.0004471825959626585
Iteration: 1055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44638147950172424, gen p mean: -0.11607648432254791, mean p set: 0.44695594906806946
The modified gen p mean: 0.44546979665756226, gen p mean: -0.11775977909564972, mean p set: 0.44604605436325073
loss_pred:0.014657294377684593, decouple_loss:0.0004988389555364847
loss_pred:0.014884582720696926, decouple_loss:0.00045879141543991864
The modified gen p mean: 0.4463757574558258, gen p mean: -0.11277128756046295, mean p set: 0.44695156812667847
loss_pred:0.01507734227925539, decouple_loss:0.0005557816475629807
Iteration: 1056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475513994693756, gen p mean: -0.11162978410720825, mean p set: 0.44812965393066406
loss_pred:0.015560492873191833, decouple_loss:0.000501415110193193
The modified gen p mean: 0.4464367628097534, gen p mean: -0.11563529074192047, mean p set: 0.4470106363296509
loss_pred:0.015360278077423573, decouple_loss:0.0004789469239767641
The modified gen p mean: 0.4470604360103607, gen p mean: -0.10888936370611191, mean p set: 0.44763532280921936
loss_pred:0.015653688460588455, decouple_loss:0.0005520078702829778
Iteration: 1057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462059736251831, gen p mean: -0.11395031958818436, mean p set: 0.44678211212158203
loss_pred:0.01507675088942051, decouple_loss:0.00048285789671353996
The modified gen p mean: 0.4469210207462311, gen p mean: -0.11971928924322128, mean p set: 0.44749611616134644
loss_pred:0.01513298973441124, decouple_loss:0.0004377111326903105
The modified gen p mean: 0.4464663863182068, gen p mean: -0.11557509750127792, mean p set: 0.4470418095588684
loss_pred:0.015080728568136692, decouple_loss:0.0003730941971298307
Iteration: 1058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786709547042847, gen p mean: -0.10643987357616425, mean p set: 0.4484444558620453
loss_pred:0.015794891864061356, decouple_loss:0.0005010141176171601
The modified gen p mean: 0.446501225233078, gen p mean: -0.11402221769094467, mean p set: 0.44707778096199036
loss_pred:0.015142724849283695, decouple_loss:0.0003721009998116642
The modified gen p mean: 0.44642797112464905, gen p mean: -0.10867417603731155, mean p set: 0.447003036737442
loss_pred:0.015233621001243591, decouple_loss:0.0004519016365520656
Iteration: 1059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44554153084754944, gen p mean: -0.10987776517868042, mean p set: 0.44611749053001404
The modified gen p mean: 0.4470660388469696, gen p mean: -0.1136004701256752, mean p set: 0.4476405084133148
loss_pred:0.015044036321341991, decouple_loss:0.00039447160088457167
loss_pred:0.015261220745742321, decouple_loss:0.0004192077904008329
The modified gen p mean: 0.44669803977012634, gen p mean: -0.1135568767786026, mean p set: 0.4472745358943939
loss_pred:0.01477762870490551, decouple_loss:0.0005142671288922429
Iteration: 1060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445372611284256, gen p mean: -0.11199480295181274, mean p set: 0.4459480941295624
The modified gen p mean: 0.44409605860710144, gen p mean: -0.10912734270095825, mean p set: 0.44466984272003174
loss_pred:0.015141895972192287, decouple_loss:0.0003698487998917699
loss_pred:0.01561681553721428, decouple_loss:0.00041775277350097895
The modified gen p mean: 0.44673895835876465, gen p mean: -0.11138246953487396, mean p set: 0.44731536507606506
loss_pred:0.015494572930037975, decouple_loss:0.000497469212859869
2023-05-02 07:05:12 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11800835281610489, mean p set: 0.4502691626548767
loss_pred:0.01704789511859417, decouple_loss:0.000777164357714355
The modified gen p mean: 0.44953444600105286, gen p mean: -0.11077260971069336, mean p set: 0.4500633478164673
loss_pred:0.016265371814370155, decouple_loss:0.000689372536726296
The modified gen p mean: 0.4498288333415985, gen p mean: -0.11042793095111847, mean p set: 0.45035696029663086
loss_pred:0.01659001037478447, decouple_loss:0.0008115837117657065
WV_1_PC_1_EH_0_PS_40, loss: 0.016672395169734955, avg_mse: 0.02601257711648941
current test mse: 0.026013
Iteration: 1061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458167254924774, gen p mean: -0.11649635434150696, mean p set: 0.44639402627944946
The modified gen p mean: 0.44708383083343506, gen p mean: -0.11860141903162003, mean p set: 0.44765836000442505
loss_pred:0.015077714808285236, decouple_loss:0.0003754540521185845
loss_pred:0.015120727941393852, decouple_loss:0.0005400585941970348
The modified gen p mean: 0.44537967443466187, gen p mean: -0.11864300817251205, mean p set: 0.44595643877983093
loss_pred:0.015116245485842228, decouple_loss:0.00037627233541570604
Iteration: 1062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44570109248161316, gen p mean: -0.11080751568078995, mean p set: 0.446274995803833
loss_pred:0.015349873341619968, decouple_loss:0.00042392194154672325
The modified gen p mean: 0.44682490825653076, gen p mean: -0.1143520325422287, mean p set: 0.447405070066452
The modified gen p mean: 0.44695615768432617, gen p mean: -0.118678517639637, mean p set: 0.4475320279598236
loss_pred:0.014979133382439613, decouple_loss:0.0004086504632141441
loss_pred:0.014647913165390491, decouple_loss:0.00047743605682626367
Iteration: 1063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458290934562683, gen p mean: -0.11657050251960754, mean p set: 0.44640541076660156
loss_pred:0.015480820089578629, decouple_loss:0.0003926315694116056
The modified gen p mean: 0.4469688832759857, gen p mean: -0.10994475334882736, mean p set: 0.4475449025630951
loss_pred:0.015448338352143764, decouple_loss:0.00047384214121848345
The modified gen p mean: 0.44671958684921265, gen p mean: -0.11722248792648315, mean p set: 0.44729533791542053
loss_pred:0.014770524576306343, decouple_loss:0.0004479264316614717
Iteration: 1064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462326169013977, gen p mean: -0.11362627148628235, mean p set: 0.4468083381652832The modified gen p mean: 0.44656211137771606, gen p mean: -0.1174718514084816, mean p set: 0.44714006781578064
loss_pred:0.015237563289701939, decouple_loss:0.0003973674320150167
loss_pred:0.01563245803117752, decouple_loss:0.00045126857003197074
The modified gen p mean: 0.4469577670097351, gen p mean: -0.11203747987747192, mean p set: 0.4475346803665161
loss_pred:0.01595000922679901, decouple_loss:0.000536389066837728
Iteration: 1065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44589945673942566, gen p mean: -0.1133565679192543, mean p set: 0.44647544622421265
loss_pred:0.015830211341381073, decouple_loss:0.000589624629355967
The modified gen p mean: 0.44753116369247437, gen p mean: -0.1185193657875061, mean p set: 0.4481041729450226
loss_pred:0.01577942632138729, decouple_loss:0.0004626750305760652
The modified gen p mean: 0.4466610848903656, gen p mean: -0.11472480744123459, mean p set: 0.44723621010780334
loss_pred:0.01493442989885807, decouple_loss:0.0005363429663702846
Iteration: 1066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455564320087433, gen p mean: -0.11496084928512573, mean p set: 0.44613370299339294
loss_pred:0.014993695542216301, decouple_loss:0.0004288264026399702
The modified gen p mean: 0.44713202118873596, gen p mean: -0.11925927549600601, mean p set: 0.44770827889442444
loss_pred:0.015584978275001049, decouple_loss:0.0004250687197782099
The modified gen p mean: 0.4450765550136566, gen p mean: -0.1202535405755043, mean p set: 0.4456527829170227
loss_pred:0.014938696287572384, decouple_loss:0.00043896131683140993
Iteration: 1067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470476806163788, gen p mean: -0.11528490483760834, mean p set: 0.4476243555545807
The modified gen p mean: 0.4457337260246277, gen p mean: -0.11479916423559189, mean p set: 0.44631072878837585
loss_pred:0.015055589377880096, decouple_loss:0.0005458273226395249
loss_pred:0.01490813959389925, decouple_loss:0.0004004220827482641
The modified gen p mean: 0.4463234543800354, gen p mean: -0.1148047223687172, mean p set: 0.4468989372253418
loss_pred:0.014907767064869404, decouple_loss:0.0005065849982202053
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694799184799194, gen p mean: -0.113717220723629, mean p set: 0.44752374291419983
The modified gen p mean: 0.44686660170555115, gen p mean: -0.11041910946369171, mean p set: 0.44744303822517395
loss_pred:0.015755923464894295, decouple_loss:0.00048372725723311305
loss_pred:0.015372202731668949, decouple_loss:0.0005032889312133193
The modified gen p mean: 0.44697099924087524, gen p mean: -0.11358369141817093, mean p set: 0.44754984974861145
loss_pred:0.014949955977499485, decouple_loss:0.0005420836387202144
Iteration: 1069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4448224604129791, gen p mean: -0.11123204231262207, mean p set: 0.4453986883163452
loss_pred:0.015777911990880966, decouple_loss:0.000513973762281239
The modified gen p mean: 0.44715896248817444, gen p mean: -0.11648600548505783, mean p set: 0.44773659110069275
loss_pred:0.014881742186844349, decouple_loss:0.0005167446797713637
The modified gen p mean: 0.4454873204231262, gen p mean: -0.11686040461063385, mean p set: 0.44606199860572815
loss_pred:0.015085851773619652, decouple_loss:0.0005021030665375292
Iteration: 1070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470583200454712, gen p mean: -0.11687526106834412, mean p set: 0.4476345181465149
loss_pred:0.015018844045698643, decouple_loss:0.000483204610645771
The modified gen p mean: 0.4463489353656769, gen p mean: -0.11417730152606964, mean p set: 0.4469238221645355
loss_pred:0.015510491095483303, decouple_loss:0.0004012890567537397
The modified gen p mean: 0.446274071931839, gen p mean: -0.1190473735332489, mean p set: 0.4468485414981842
loss_pred:0.015096316114068031, decouple_loss:0.0004198864917270839
2023-05-02 07:07:19 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12202829867601395, mean p set: 0.4502691626548767
loss_pred:0.017110811546444893, decouple_loss:0.0004915381432510912
The modified gen p mean: 0.449535995721817, gen p mean: -0.11453141272068024, mean p set: 0.4500633478164673
loss_pred:0.016337160021066666, decouple_loss:0.0004699656565207988
The modified gen p mean: 0.44982877373695374, gen p mean: -0.11468018591403961, mean p set: 0.45035696029663086
loss_pred:0.016653545200824738, decouple_loss:0.0005117030232213438
WV_1_PC_1_EH_0_PS_40, loss: 0.01672505959868431, avg_mse: 0.026138683781027794
current test mse: 0.026139
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
NaN value num: 0
Iteration: 1071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784075021743774, gen p mean: -0.11715161055326462, mean p set: 0.4484170973300934
loss_pred:0.016408979892730713, decouple_loss:0.0004337711143307388
The modified gen p mean: 0.4489639401435852, gen p mean: -0.10925361514091492, mean p set: 0.44953852891921997
loss_pred:0.016744432970881462, decouple_loss:0.00045120183494873345
The modified gen p mean: 0.44865143299102783, gen p mean: -0.11125672608613968, mean p set: 0.4492282271385193
loss_pred:0.016651112586259842, decouple_loss:0.00041950176819227636
Iteration: 1072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012396574020386, gen p mean: -0.11570172011852264, mean p set: 0.4507019817829132
loss_pred:0.01572437956929207, decouple_loss:0.0005483657005243003
The modified gen p mean: 0.44739630818367004, gen p mean: -0.11969126760959625, mean p set: 0.44797325134277344The modified gen p mean: 0.44738370180130005, gen p mean: -0.12001422792673111, mean p set: 0.4479599893093109
loss_pred:0.016942622140049934, decouple_loss:0.00052390102064237loss_pred:0.016492389142513275, decouple_loss:0.0004463796503841877
Iteration: 1073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790026545524597, gen p mean: -0.11544762551784515, mean p set: 0.44847577810287476
loss_pred:0.016380667686462402, decouple_loss:0.0004885584348812699
The modified gen p mean: 0.45035839080810547, gen p mean: -0.11924587935209274, mean p set: 0.4509304463863373
loss_pred:0.01573280058801174, decouple_loss:0.00043011907837353647
The modified gen p mean: 0.4485979974269867, gen p mean: -0.1182745099067688, mean p set: 0.44917523860931396
loss_pred:0.0164746455848217, decouple_loss:0.0004921233630739152
Iteration: 1074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448689341545105, gen p mean: -0.11389783769845963, mean p set: 0.4492657780647278
loss_pred:0.016468854621052742, decouple_loss:0.0004177182272542268
The modified gen p mean: 0.44852590560913086, gen p mean: -0.11636743694543839, mean p set: 0.4491029977798462
loss_pred:0.01660485379397869, decouple_loss:0.0004861975321546197
The modified gen p mean: 0.4491244852542877, gen p mean: -0.11068420857191086, mean p set: 0.4497022032737732
loss_pred:0.016499660909175873, decouple_loss:0.0004287038173060864
Iteration: 1075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492039382457733, gen p mean: -0.10889903455972672, mean p set: 0.4497818946838379
loss_pred:0.01668446883559227, decouple_loss:0.00045993662206456065
The modified gen p mean: 0.4488086998462677, gen p mean: -0.11294850707054138, mean p set: 0.4493875503540039
loss_pred:0.016653407365083694, decouple_loss:0.0003977179294452071
The modified gen p mean: 0.4490705728530884, gen p mean: -0.11469580978155136, mean p set: 0.4496472179889679
loss_pred:0.016397593542933464, decouple_loss:0.0005074299406260252
Iteration: 1076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450894296169281, gen p mean: -0.11760992556810379, mean p set: 0.4514707326889038
loss_pred:0.015675367787480354, decouple_loss:0.0005068612517789006
The modified gen p mean: 0.4496889114379883, gen p mean: -0.10658678412437439, mean p set: 0.45026645064353943
The modified gen p mean: 0.44727224111557007, gen p mean: -0.11589094251394272, mean p set: 0.4478487968444824
loss_pred:0.01608811505138874, decouple_loss:0.00047687641927041113
loss_pred:0.016032282263040543, decouple_loss:0.0004056379839312285
Iteration: 1077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755038619041443, gen p mean: -0.11028935015201569, mean p set: 0.4481256306171417
loss_pred:0.016134677454829216, decouple_loss:0.000508273602463305
The modified gen p mean: 0.4495975375175476, gen p mean: -0.10938555747270584, mean p set: 0.45017367601394653
The modified gen p mean: 0.4488094449043274, gen p mean: -0.10970911383628845, mean p set: 0.4493860900402069
loss_pred:0.015317637473344803, decouple_loss:0.0004215191875118762
loss_pred:0.016115983948111534, decouple_loss:0.0005540525307878852
Iteration: 1078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45025551319122314, gen p mean: -0.10955698788166046, mean p set: 0.45083382725715637
loss_pred:0.015994615852832794, decouple_loss:0.0005308758118189871
The modified gen p mean: 0.4497726261615753, gen p mean: -0.10644583404064178, mean p set: 0.4503500759601593
The modified gen p mean: 0.44993215799331665, gen p mean: -0.10713746398687363, mean p set: 0.4505065083503723
loss_pred:0.015481580048799515, decouple_loss:0.00045617291470989585
loss_pred:0.015576737932860851, decouple_loss:0.000379336008336395
Iteration: 1079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448583722114563, gen p mean: -0.11079239100217819, mean p set: 0.4491589367389679
loss_pred:0.01633608713746071, decouple_loss:0.0004722091543953866
The modified gen p mean: 0.4480527341365814, gen p mean: -0.11450238525867462, mean p set: 0.44863176345825195
The modified gen p mean: 0.44782188534736633, gen p mean: -0.10893718898296356, mean p set: 0.4483988583087921
loss_pred:0.017079636454582214, decouple_loss:0.0005001421086490154
loss_pred:0.015548893250524998, decouple_loss:0.0004487079568207264
Iteration: 1080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498644769191742, gen p mean: -0.11352334916591644, mean p set: 0.4504399299621582
loss_pred:0.015035905875265598, decouple_loss:0.0005391255836002529
The modified gen p mean: 0.45020636916160583, gen p mean: -0.11385870724916458, mean p set: 0.45078352093696594
loss_pred:0.015361796133220196, decouple_loss:0.0005016649956814945
The modified gen p mean: 0.448101669549942, gen p mean: -0.11379052698612213, mean p set: 0.44868043065071106
loss_pred:0.016264036297798157, decouple_loss:0.000554281345102936
2023-05-02 07:10:05 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12163694202899933, mean p set: 0.4502691626548767
loss_pred:0.017039813101291656, decouple_loss:0.0005109374178573489
The modified gen p mean: 0.44953465461730957, gen p mean: -0.11487670242786407, mean p set: 0.4500633478164673
loss_pred:0.016221757978200912, decouple_loss:0.0004806552024092525
The modified gen p mean: 0.4498276710510254, gen p mean: -0.11441122740507126, mean p set: 0.45035696029663086
loss_pred:0.016521647572517395, decouple_loss:0.0004495750763453543
WV_1_PC_1_EH_0_PS_40, loss: 0.016618426889181137, avg_mse: 0.02591668628156185
current test mse: 0.025917
Iteration: 1081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786977767944336, gen p mean: -0.11638166010379791, mean p set: 0.44844523072242737
loss_pred:0.016244079917669296, decouple_loss:0.0004456542374100536
The modified gen p mean: 0.44876906275749207, gen p mean: -0.11672547459602356, mean p set: 0.44934555888175964The modified gen p mean: 0.44953441619873047, gen p mean: -0.11325766146183014, mean p set: 0.4501113295555115
loss_pred:0.016218164935708046, decouple_loss:0.0005149127100594342
loss_pred:0.015614790841937065, decouple_loss:0.0005331606953404844
Iteration: 1082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496161937713623, gen p mean: -0.1085662692785263, mean p set: 0.4501916468143463
loss_pred:0.0169899370521307, decouple_loss:0.00043319122050888836
The modified gen p mean: 0.45012569427490234, gen p mean: -0.11282545328140259, mean p set: 0.4507031738758087The modified gen p mean: 0.4488412141799927, gen p mean: -0.11338072270154953, mean p set: 0.4494177997112274
loss_pred:0.016115859150886536, decouple_loss:0.0004191768530290574
loss_pred:0.01602417230606079, decouple_loss:0.0005529662012122571
Iteration: 1083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869595766067505, gen p mean: -0.10882255434989929, mean p set: 0.44927293062210083
loss_pred:0.01629805751144886, decouple_loss:0.0005017818184569478
The modified gen p mean: 0.44935470819473267, gen p mean: -0.11042381823062897, mean p set: 0.4499320983886719
The modified gen p mean: 0.4497981667518616, gen p mean: -0.11279510706663132, mean p set: 0.4503753185272217
loss_pred:0.01587105542421341, decouple_loss:0.0005183297325856984
loss_pred:0.015191842801868916, decouple_loss:0.000384237093385309
Iteration: 1084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799840450286865, gen p mean: -0.1117817685008049, mean p set: 0.448575496673584
loss_pred:0.016656670719385147, decouple_loss:0.0004291597579140216
The modified gen p mean: 0.4475487768650055, gen p mean: -0.11243816465139389, mean p set: 0.44812440872192383
loss_pred:0.015920594334602356, decouple_loss:0.0004796400316990912
The modified gen p mean: 0.4485265910625458, gen p mean: -0.11563869565725327, mean p set: 0.44910046458244324
loss_pred:0.016217956319451332, decouple_loss:0.0005055806832388043
Iteration: 1085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482121765613556, gen p mean: -0.11367397755384445, mean p set: 0.4487886428833008
loss_pred:0.016138261184096336, decouple_loss:0.0004194295033812523
The modified gen p mean: 0.44950512051582336, gen p mean: -0.10986924171447754, mean p set: 0.4500845670700073
loss_pred:0.01563280075788498, decouple_loss:0.00041549396701157093
The modified gen p mean: 0.44828951358795166, gen p mean: -0.11180580407381058, mean p set: 0.4488662779331207
loss_pred:0.015784259885549545, decouple_loss:0.00039141878369264305
Iteration: 1086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848281145095825, gen p mean: -0.11762407422065735, mean p set: 0.44906121492385864
loss_pred:0.016237154603004456, decouple_loss:0.0005398610956035554
The modified gen p mean: 0.45022833347320557, gen p mean: -0.1176447942852974, mean p set: 0.45080816745758057
The modified gen p mean: 0.4483051896095276, gen p mean: -0.11704355478286743, mean p set: 0.44888144731521606
loss_pred:0.016343122348189354, decouple_loss:0.0005063233547843993
loss_pred:0.015718286857008934, decouple_loss:0.00048214857815764844
Iteration: 1087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44936180114746094, gen p mean: -0.1176764965057373, mean p set: 0.44993606209754944
loss_pred:0.01580086164176464, decouple_loss:0.00038541629328392446
The modified gen p mean: 0.4483439326286316, gen p mean: -0.12253733724355698, mean p set: 0.4489196836948395
loss_pred:0.015804065391421318, decouple_loss:0.00040443913894705474
The modified gen p mean: 0.44968727231025696, gen p mean: -0.11845356225967407, mean p set: 0.45026108622550964
loss_pred:0.016171958297491074, decouple_loss:0.00045372755266726017
Iteration: 1088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835546612739563, gen p mean: -0.12256526201963425, mean p set: 0.44893211126327515
loss_pred:0.015779031440615654, decouple_loss:0.0004096991615369916
The modified gen p mean: 0.44831758737564087, gen p mean: -0.11725365370512009, mean p set: 0.4488941431045532
loss_pred:0.015590021386742592, decouple_loss:0.0004942815285176039
The modified gen p mean: 0.4486009478569031, gen p mean: -0.12398205697536469, mean p set: 0.4491797089576721
loss_pred:0.015720784664154053, decouple_loss:0.0003704034606926143
Iteration: 1089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481779932975769, gen p mean: -0.11884879320859909, mean p set: 0.4487546980381012
loss_pred:0.015903444960713387, decouple_loss:0.0003899837320204824
The modified gen p mean: 0.4488650858402252, gen p mean: -0.11651437729597092, mean p set: 0.44944456219673157
loss_pred:0.01647385209798813, decouple_loss:0.0004671821079682559
The modified gen p mean: 0.44963690638542175, gen p mean: -0.11915872246026993, mean p set: 0.45021507143974304
loss_pred:0.01581241935491562, decouple_loss:0.0005413072649389505
Iteration: 1090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479767382144928, gen p mean: -0.12123976647853851, mean p set: 0.44855284690856934
loss_pred:0.015871772542595863, decouple_loss:0.00041031226282939315
The modified gen p mean: 0.44972658157348633, gen p mean: -0.11503849178552628, mean p set: 0.4502998888492584
loss_pred:0.015171467326581478, decouple_loss:0.0003966296499129385
The modified gen p mean: 0.4494871497154236, gen p mean: -0.11462587863206863, mean p set: 0.450064092874527
loss_pred:0.016344668343663216, decouple_loss:0.0004467069520615041
2023-05-02 07:12:12 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12793585658073425, mean p set: 0.4502691626548767
loss_pred:0.01704050414264202, decouple_loss:0.0005292292917147279
The modified gen p mean: 0.44953465461730957, gen p mean: -0.11998070031404495, mean p set: 0.4500633478164673
loss_pred:0.016264863312244415, decouple_loss:0.00043392335646785796
The modified gen p mean: 0.4498263895511627, gen p mean: -0.11977268755435944, mean p set: 0.45035696029663086
loss_pred:0.01651245355606079, decouple_loss:0.00047115227789618075
WV_1_PC_1_EH_0_PS_40, loss: 0.016629844903945923, avg_mse: 0.025919955223798752
current test mse: 0.02592
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
NaN value num: 0
Iteration: 1091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474874436855316, gen p mean: -0.126546710729599, mean p set: 0.4480588138103485
loss_pred:0.01732819527387619, decouple_loss:0.0004454564768821001
The modified gen p mean: 0.44731268286705017, gen p mean: -0.1179279312491417, mean p set: 0.44789019227027893
loss_pred:0.01668979786336422, decouple_loss:0.00036942659062333405
The modified gen p mean: 0.4457818865776062, gen p mean: -0.1213284581899643, mean p set: 0.44635969400405884
loss_pred:0.016418008133769035, decouple_loss:0.0005096562090329826
Iteration: 1092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760483503341675, gen p mean: -0.12448094040155411, mean p set: 0.44818219542503357
loss_pred:0.01689637079834938, decouple_loss:0.0003720216336660087
The modified gen p mean: 0.44703900814056396, gen p mean: -0.12021706253290176, mean p set: 0.44761335849761963The modified gen p mean: 0.4473220407962799, gen p mean: -0.12121927738189697, mean p set: 0.4479012191295624
loss_pred:0.017382584512233734, decouple_loss:0.00043882246245630085loss_pred:0.016992634162306786, decouple_loss:0.00037129721022211015
Iteration: 1093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707638025283813, gen p mean: -0.11808197945356369, mean p set: 0.4476500451564789
loss_pred:0.01679806225001812, decouple_loss:0.0004958264762535691
The modified gen p mean: 0.4488736689090729, gen p mean: -0.11777040362358093, mean p set: 0.4494474530220032
The modified gen p mean: 0.4459848403930664, gen p mean: -0.11971583962440491, mean p set: 0.4465598464012146
loss_pred:0.017170291393995285, decouple_loss:0.0005304419901221991
loss_pred:0.016295388340950012, decouple_loss:0.0005329211708158255
Iteration: 1094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767656922340393, gen p mean: -0.11547888070344925, mean p set: 0.4482518434524536
loss_pred:0.016696371138095856, decouple_loss:0.0004384805215522647
The modified gen p mean: 0.4478127658367157, gen p mean: -0.11585743725299835, mean p set: 0.4483919143676758
loss_pred:0.01594461500644684, decouple_loss:0.0005316203460097313
The modified gen p mean: 0.4467529058456421, gen p mean: -0.11262428760528564, mean p set: 0.44732820987701416
loss_pred:0.017682179808616638, decouple_loss:0.0004403413331601769
Iteration: 1095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455183446407318, gen p mean: -0.11218909919261932, mean p set: 0.44609498977661133
loss_pred:0.016993217170238495, decouple_loss:0.00035150349140167236
The modified gen p mean: 0.4473402798175812, gen p mean: -0.11676236242055893, mean p set: 0.4479162395000458
loss_pred:0.01686650887131691, decouple_loss:0.0004145160783082247
The modified gen p mean: 0.448064923286438, gen p mean: -0.11380209773778915, mean p set: 0.44864365458488464
loss_pred:0.016120990738272667, decouple_loss:0.000558172760065645
Iteration: 1096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44575709104537964, gen p mean: -0.1210140660405159, mean p set: 0.4463336765766144
loss_pred:0.017078183591365814, decouple_loss:0.0006554966676048934
The modified gen p mean: 0.44864219427108765, gen p mean: -0.11694785952568054, mean p set: 0.44921690225601196
loss_pred:0.016316169872879982, decouple_loss:0.00047687278129160404
The modified gen p mean: 0.44632554054260254, gen p mean: -0.11984596401453018, mean p set: 0.4468995928764343
loss_pred:0.01692221313714981, decouple_loss:0.00046921829925850034
Iteration: 1097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44603216648101807, gen p mean: -0.12390514463186264, mean p set: 0.4466082453727722
loss_pred:0.0167744942009449, decouple_loss:0.0003784017462749034
The modified gen p mean: 0.4465878903865814, gen p mean: -0.12148616462945938, mean p set: 0.4471641182899475
loss_pred:0.0166572667658329, decouple_loss:0.00044338477891869843
The modified gen p mean: 0.44652044773101807, gen p mean: -0.11447616666555405, mean p set: 0.4470962882041931
loss_pred:0.017108798027038574, decouple_loss:0.00038227057666517794
Iteration: 1098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725507497787476, gen p mean: -0.11665716022253036, mean p set: 0.4478325843811035
loss_pred:0.017344780266284943, decouple_loss:0.0005026380531489849
The modified gen p mean: 0.4473583400249481, gen p mean: -0.11957637965679169, mean p set: 0.44793352484703064
The modified gen p mean: 0.4477403461933136, gen p mean: -0.1184956356883049, mean p set: 0.4483163356781006
loss_pred:0.0166314784437418, decouple_loss:0.0004331642121542245
loss_pred:0.01671169139444828, decouple_loss:0.0004106778942514211
Iteration: 1099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446737676858902, gen p mean: -0.11632990092039108, mean p set: 0.44731420278549194
The modified gen p mean: 0.4462612569332123, gen p mean: -0.12001699954271317, mean p set: 0.4468361735343933
loss_pred:0.016985716298222542, decouple_loss:0.0004433036665432155
loss_pred:0.01717715710401535, decouple_loss:0.000425530452048406
The modified gen p mean: 0.44800934195518494, gen p mean: -0.1142459362745285, mean p set: 0.4485847055912018
loss_pred:0.016652952879667282, decouple_loss:0.0003656398330349475
Iteration: 1100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676193594932556, gen p mean: -0.11299202591180801, mean p set: 0.44733667373657227
loss_pred:0.017287887632846832, decouple_loss:0.00043291764450259507
The modified gen p mean: 0.4480176866054535, gen p mean: -0.11519721150398254, mean p set: 0.44859373569488525
The modified gen p mean: 0.4462008476257324, gen p mean: -0.12156346440315247, mean p set: 0.4467763900756836
loss_pred:0.016716521233320236, decouple_loss:0.00035231682704761624
loss_pred:0.017160313203930855, decouple_loss:0.0004539688816294074
2023-05-02 07:14:54 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12276945263147354, mean p set: 0.4502691626548767
loss_pred:0.016958432272076607, decouple_loss:0.0005592371453531086
The modified gen p mean: 0.44953444600105286, gen p mean: -0.11484114080667496, mean p set: 0.4500633478164673
loss_pred:0.016300540417432785, decouple_loss:0.0005570643697865307
The modified gen p mean: 0.4498264789581299, gen p mean: -0.11434230953454971, mean p set: 0.45035696029663086
loss_pred:0.016532298177480698, decouple_loss:0.0005653744447045028
WV_1_PC_1_EH_0_PS_40, loss: 0.016625119373202324, avg_mse: 0.025919785723090172
current test mse: 0.02592
Iteration: 1101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699156284332275, gen p mean: -0.11641333252191544, mean p set: 0.44756653904914856
loss_pred:0.016406921669840813, decouple_loss:0.0006578621687367558
The modified gen p mean: 0.4453597664833069, gen p mean: -0.12270835787057877, mean p set: 0.4459342360496521
loss_pred:0.017073852941393852, decouple_loss:0.0004055593453813344
The modified gen p mean: 0.4466715157032013, gen p mean: -0.10843846946954727, mean p set: 0.44724923372268677
loss_pred:0.01675219088792801, decouple_loss:0.0004615224024746567
Iteration: 1102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452846050262451, gen p mean: -0.11715966463088989, mean p set: 0.4458599388599396
loss_pred:0.01632331684231758, decouple_loss:0.00046344249858520925
The modified gen p mean: 0.4464729130268097, gen p mean: -0.11528347432613373, mean p set: 0.44704747200012207
The modified gen p mean: 0.44799432158470154, gen p mean: -0.11847005784511566, mean p set: 0.4485665559768677
loss_pred:0.016260642558336258, decouple_loss:0.0005067771417088807
loss_pred:0.017059391364455223, decouple_loss:0.000368077598977834
Iteration: 1103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452979862689972, gen p mean: -0.12360992282629013, mean p set: 0.44587424397468567
The modified gen p mean: 0.4463365375995636, gen p mean: -0.12020605802536011, mean p set: 0.44691455364227295loss_pred:0.01762297935783863, decouple_loss:0.0005513501819223166
loss_pred:0.016251130029559135, decouple_loss:0.0005181545857340097
The modified gen p mean: 0.44606590270996094, gen p mean: -0.12209539115428925, mean p set: 0.4466424882411957
loss_pred:0.017252037301659584, decouple_loss:0.000480672053527087
Iteration: 1104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457347095012665, gen p mean: -0.11386988312005997, mean p set: 0.4463099241256714
loss_pred:0.01693098060786724, decouple_loss:0.0005212417454458773
The modified gen p mean: 0.44687527418136597, gen p mean: -0.12100137025117874, mean p set: 0.44745099544525146
loss_pred:0.017155829817056656, decouple_loss:0.0004992698668502271
The modified gen p mean: 0.4470057785511017, gen p mean: -0.12173383682966232, mean p set: 0.4475829601287842
loss_pred:0.0156246991828084, decouple_loss:0.00048566091572865844
Iteration: 1105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777652621269226, gen p mean: -0.12002404034137726, mean p set: 0.4483541250228882
loss_pred:0.01662847399711609, decouple_loss:0.0005045926664024591
The modified gen p mean: 0.4456256628036499, gen p mean: -0.11651158332824707, mean p set: 0.44620171189308167
loss_pred:0.017248952761292458, decouple_loss:0.0005108416662551463
The modified gen p mean: 0.4465343952178955, gen p mean: -0.12908758223056793, mean p set: 0.4471109211444855
loss_pred:0.017446156591176987, decouple_loss:0.00045923321158625185
Iteration: 1106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445409893989563, gen p mean: -0.1241193413734436, mean p set: 0.4459850490093231
loss_pred:0.016832469031214714, decouple_loss:0.0003625510144047439
The modified gen p mean: 0.445324569940567, gen p mean: -0.1224321573972702, mean p set: 0.44589856266975403
loss_pred:0.016836166381835938, decouple_loss:0.0004802985640708357
The modified gen p mean: 0.4469143748283386, gen p mean: -0.11996440589427948, mean p set: 0.4474896788597107
loss_pred:0.016184013336896896, decouple_loss:0.0003889848885592073
Iteration: 1107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477543830871582, gen p mean: -0.11529211699962616, mean p set: 0.44832971692085266
loss_pred:0.017349230125546455, decouple_loss:0.0005394213949330151
The modified gen p mean: 0.44756630063056946, gen p mean: -0.1141982227563858, mean p set: 0.44814398884773254
loss_pred:0.016261614859104156, decouple_loss:0.0004626340523827821
The modified gen p mean: 0.4478698968887329, gen p mean: -0.113592728972435, mean p set: 0.4484466016292572
loss_pred:0.01681833527982235, decouple_loss:0.00042315918835811317
Iteration: 1108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460310935974121, gen p mean: -0.11534509062767029, mean p set: 0.4466065764427185
loss_pred:0.015905162319540977, decouple_loss:0.0006151840789243579
The modified gen p mean: 0.4462517499923706, gen p mean: -0.1152740940451622, mean p set: 0.44682827591896057
The modified gen p mean: 0.44709455966949463, gen p mean: -0.11657604575157166, mean p set: 0.4476702809333801
loss_pred:0.01757408306002617, decouple_loss:0.0004903373774141073
loss_pred:0.016376918181777, decouple_loss:0.00040359882405027747
Iteration: 1109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787001609802246, gen p mean: -0.11939607560634613, mean p set: 0.4484492540359497
loss_pred:0.01582823507487774, decouple_loss:0.0004889840492978692
The modified gen p mean: 0.44748249650001526, gen p mean: -0.1228848472237587, mean p set: 0.44805923104286194
The modified gen p mean: 0.4477936625480652, gen p mean: -0.11819873750209808, mean p set: 0.4483678936958313
loss_pred:0.016920549795031548, decouple_loss:0.0005102112772874534
loss_pred:0.016518525779247284, decouple_loss:0.0004166632716078311
Iteration: 1110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44684547185897827, gen p mean: -0.12184269726276398, mean p set: 0.4474199414253235
loss_pred:0.017376823350787163, decouple_loss:0.00043630407890304923
The modified gen p mean: 0.44516512751579285, gen p mean: -0.1304483413696289, mean p set: 0.4457412362098694
The modified gen p mean: 0.4461590349674225, gen p mean: -0.13172684609889984, mean p set: 0.44673120975494385
loss_pred:0.0167550016194582, decouple_loss:0.00033767669810913503
loss_pred:0.016824442893266678, decouple_loss:0.00040933836135081947
2023-05-02 07:17:01 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.132480651140213, mean p set: 0.4502691626548767
loss_pred:0.01707141101360321, decouple_loss:0.0004535734187811613
The modified gen p mean: 0.44953653216362, gen p mean: -0.12531109154224396, mean p set: 0.4500633478164673
loss_pred:0.01627126894891262, decouple_loss:0.00041670966311357915
The modified gen p mean: 0.44982314109802246, gen p mean: -0.12476824969053268, mean p set: 0.45035696029663086
loss_pred:0.016572032123804092, decouple_loss:0.00044681632425636053
WV_1_PC_1_EH_0_PS_40, loss: 0.016660189256072044, avg_mse: 0.026065535843372345
current test mse: 0.026066
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
NaN value num: 0
Iteration: 1111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45223551988601685, gen p mean: -0.12069877237081528, mean p set: 0.45281070470809937
loss_pred:0.01516129169613123, decouple_loss:0.0005008537555113435
The modified gen p mean: 0.45262420177459717, gen p mean: -0.11767958849668503, mean p set: 0.45320072770118713
loss_pred:0.014974632300436497, decouple_loss:0.000543639063835144
The modified gen p mean: 0.45087480545043945, gen p mean: -0.1183500736951828, mean p set: 0.451452374458313
loss_pred:0.015421554446220398, decouple_loss:0.0005230338429100811
Iteration: 1112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513227939605713, gen p mean: -0.1207432895898819, mean p set: 0.4519002437591553
loss_pred:0.01452826801687479, decouple_loss:0.0006540589383803308
The modified gen p mean: 0.45201733708381653, gen p mean: -0.12198704481124878, mean p set: 0.4525940418243408The modified gen p mean: 0.4508821368217468, gen p mean: -0.12074898183345795, mean p set: 0.45146000385284424
loss_pred:0.014742299914360046, decouple_loss:0.0004630639450624585
loss_pred:0.015015802346169949, decouple_loss:0.0006557174492627382
Iteration: 1113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45122891664505005, gen p mean: -0.12230657786130905, mean p set: 0.45180612802505493
loss_pred:0.01551908627152443, decouple_loss:0.0007005083025433123
The modified gen p mean: 0.4526192843914032, gen p mean: -0.1208573579788208, mean p set: 0.4531993865966797The modified gen p mean: 0.45216813683509827, gen p mean: -0.12192369997501373, mean p set: 0.4527444541454315
loss_pred:0.015381700359284878, decouple_loss:0.0007690194179303944
loss_pred:0.014845612458884716, decouple_loss:0.0005385475233197212
Iteration: 1114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45072484016418457, gen p mean: -0.1251726597547531, mean p set: 0.45130228996276855
loss_pred:0.014727486297488213, decouple_loss:0.0005550393252633512
The modified gen p mean: 0.4512774348258972, gen p mean: -0.12399450689554214, mean p set: 0.4518548846244812
loss_pred:0.015751754865050316, decouple_loss:0.0006654615863226354
The modified gen p mean: 0.4523715376853943, gen p mean: -0.12790828943252563, mean p set: 0.45294755697250366
loss_pred:0.014430870302021503, decouple_loss:0.00072425976395607
Iteration: 1115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526174068450928, gen p mean: -0.12250799685716629, mean p set: 0.45319366455078125
loss_pred:0.013839198276400566, decouple_loss:0.0006847395561635494
The modified gen p mean: 0.4520537257194519, gen p mean: -0.12132362276315689, mean p set: 0.4526309072971344
loss_pred:0.014749662950634956, decouple_loss:0.0006279680528678
The modified gen p mean: 0.4527381360530853, gen p mean: -0.12727372348308563, mean p set: 0.4533170461654663
loss_pred:0.014510766603052616, decouple_loss:0.0005511435447260737
Iteration: 1116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509281516075134, gen p mean: -0.12116673588752747, mean p set: 0.4515043795108795
loss_pred:0.01581471413373947, decouple_loss:0.0007628980674780905
The modified gen p mean: 0.45210883021354675, gen p mean: -0.11959023773670197, mean p set: 0.45268580317497253
loss_pred:0.015162242576479912, decouple_loss:0.000619181664660573
The modified gen p mean: 0.45272719860076904, gen p mean: -0.12054060399532318, mean p set: 0.4533042907714844
loss_pred:0.014628180302679539, decouple_loss:0.0007662105490453541
Iteration: 1117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45074501633644104, gen p mean: -0.11856665462255478, mean p set: 0.4513244330883026
loss_pred:0.015425183810293674, decouple_loss:0.0005832950701005757
The modified gen p mean: 0.4521218538284302, gen p mean: -0.11930258572101593, mean p set: 0.45269855856895447
loss_pred:0.014611301012337208, decouple_loss:0.0006966798100620508
The modified gen p mean: 0.4516001045703888, gen p mean: -0.11637812107801437, mean p set: 0.4521775543689728
loss_pred:0.015790708363056183, decouple_loss:0.0005715833394788206
Iteration: 1118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505889415740967, gen p mean: -0.12071489542722702, mean p set: 0.4511641561985016
The modified gen p mean: 0.4512532949447632, gen p mean: -0.10692769289016724, mean p set: 0.45182904601097107loss_pred:0.014406573958694935, decouple_loss:0.0007175271166488528
loss_pred:0.016043400391936302, decouple_loss:0.0006415360840037465
The modified gen p mean: 0.45217475295066833, gen p mean: -0.11812806129455566, mean p set: 0.45275095105171204
loss_pred:0.014342792332172394, decouple_loss:0.0007049837149679661
Iteration: 1119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504704475402832, gen p mean: -0.10757413506507874, mean p set: 0.4510493874549866
loss_pred:0.016314521431922913, decouple_loss:0.0006979240570217371
The modified gen p mean: 0.450653076171875, gen p mean: -0.11073192954063416, mean p set: 0.4512292742729187
loss_pred:0.015914013609290123, decouple_loss:0.00066814647288993
The modified gen p mean: 0.4533843696117401, gen p mean: -0.11793342232704163, mean p set: 0.45395946502685547
loss_pred:0.014234933070838451, decouple_loss:0.0008553331135772169
Iteration: 1120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521316885948181, gen p mean: -0.11425553262233734, mean p set: 0.45270848274230957
loss_pred:0.015234461054205894, decouple_loss:0.0006258979556150734
The modified gen p mean: 0.45191511511802673, gen p mean: -0.11876418441534042, mean p set: 0.4524921178817749
The modified gen p mean: 0.45038706064224243, gen p mean: -0.11628367751836777, mean p set: 0.45096346735954285
loss_pred:0.014414863660931587, decouple_loss:0.0004640812403522432
loss_pred:0.015526387840509415, decouple_loss:0.0005712840938940644
2023-05-02 07:19:50 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1270759552717209, mean p set: 0.4502691626548767
loss_pred:0.017151623964309692, decouple_loss:0.0008103774162009358
The modified gen p mean: 0.44953376054763794, gen p mean: -0.11999154090881348, mean p set: 0.4500633478164673
loss_pred:0.016365259885787964, decouple_loss:0.0007467055693268776
The modified gen p mean: 0.44982999563217163, gen p mean: -0.11929032951593399, mean p set: 0.45035696029663086
loss_pred:0.016743874177336693, decouple_loss:0.0006584959919564426
WV_1_PC_1_EH_0_PS_40, loss: 0.016790512949228287, avg_mse: 0.026226090267300606
current test mse: 0.026226
Iteration: 1121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512613117694855, gen p mean: -0.11374858766794205, mean p set: 0.4518386423587799
loss_pred:0.015420832671225071, decouple_loss:0.0008024782291613519
The modified gen p mean: 0.45159950852394104, gen p mean: -0.10792914777994156, mean p set: 0.4521760940551758The modified gen p mean: 0.4523986279964447, gen p mean: -0.11081904172897339, mean p set: 0.45297735929489136
loss_pred:0.015449771657586098, decouple_loss:0.0006738186930306256loss_pred:0.01432221569120884, decouple_loss:0.0008014431805349886
Iteration: 1122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526187479496002, gen p mean: -0.11245771497488022, mean p set: 0.4531942903995514
loss_pred:0.015109152533113956, decouple_loss:0.0006241983501240611
The modified gen p mean: 0.4507196247577667, gen p mean: -0.11332808434963226, mean p set: 0.4512959122657776The modified gen p mean: 0.45044153928756714, gen p mean: -0.11072227358818054, mean p set: 0.4510186016559601
loss_pred:0.014331762678921223, decouple_loss:0.0007989475852809846loss_pred:0.015510482713580132, decouple_loss:0.0006498839939013124
Iteration: 1123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45266562700271606, gen p mean: -0.11233914643526077, mean p set: 0.45324259996414185
loss_pred:0.014591271989047527, decouple_loss:0.0008145939209498465
The modified gen p mean: 0.4523131549358368, gen p mean: -0.11543548852205276, mean p set: 0.4528883397579193The modified gen p mean: 0.4510844945907593, gen p mean: -0.10730354487895966, mean p set: 0.4516623318195343
loss_pred:0.01443309336900711, decouple_loss:0.000672256457619369
loss_pred:0.015229299664497375, decouple_loss:0.0007991501479409635
Iteration: 1124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121508836746216, gen p mean: -0.10687578469514847, mean p set: 0.4517904222011566
loss_pred:0.015342433005571365, decouple_loss:0.0006261773523874581
The modified gen p mean: 0.4520726799964905, gen p mean: -0.11115425825119019, mean p set: 0.45264923572540283
loss_pred:0.014851315878331661, decouple_loss:0.0005668658996000886
The modified gen p mean: 0.45284706354141235, gen p mean: -0.1092730462551117, mean p set: 0.4534226953983307
loss_pred:0.014268242754042149, decouple_loss:0.0007175453356467187
Iteration: 1125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451711505651474, gen p mean: -0.11028826236724854, mean p set: 0.45229020714759827
loss_pred:0.015023678541183472, decouple_loss:0.0005856334464624524
The modified gen p mean: 0.4529622793197632, gen p mean: -0.11293499171733856, mean p set: 0.4535389542579651
loss_pred:0.015176491811871529, decouple_loss:0.0005141241708770394
The modified gen p mean: 0.45094597339630127, gen p mean: -0.1141524687409401, mean p set: 0.45152196288108826
loss_pred:0.015560553409159184, decouple_loss:0.0006135932635515928
Iteration: 1126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45381495356559753, gen p mean: -0.11008473485708237, mean p set: 0.45439326763153076
loss_pred:0.014685569331049919, decouple_loss:0.0007393070845864713
The modified gen p mean: 0.45086848735809326, gen p mean: -0.10850545763969421, mean p set: 0.4514450132846832
loss_pred:0.015873800963163376, decouple_loss:0.0007033026195131242
The modified gen p mean: 0.44975918531417847, gen p mean: -0.11050039529800415, mean p set: 0.4503368139266968
loss_pred:0.015341505408287048, decouple_loss:0.0006231825682334602
Iteration: 1127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45388585329055786, gen p mean: -0.10968580096960068, mean p set: 0.45446059107780457
loss_pred:0.014053464867174625, decouple_loss:0.0004822006158065051
The modified gen p mean: 0.45098546147346497, gen p mean: -0.11064659804105759, mean p set: 0.4515630006790161
The modified gen p mean: 0.45211130380630493, gen p mean: -0.11302725225687027, mean p set: 0.4526892900466919
loss_pred:0.015761803835630417, decouple_loss:0.0004815997672267258
loss_pred:0.015168252401053905, decouple_loss:0.0006073592812754214
Iteration: 1128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510560929775238, gen p mean: -0.11470938473939896, mean p set: 0.4516349136829376
loss_pred:0.015525497496128082, decouple_loss:0.0008653589757159352
The modified gen p mean: 0.4514181315898895, gen p mean: -0.10833564400672913, mean p set: 0.4519941210746765
loss_pred:0.01503826305270195, decouple_loss:0.0004943300737068057
The modified gen p mean: 0.4542371928691864, gen p mean: -0.11176761239767075, mean p set: 0.4548146724700928
loss_pred:0.014568168669939041, decouple_loss:0.0005573725793510675
Iteration: 1129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507746696472168, gen p mean: -0.10846622288227081, mean p set: 0.4513503611087799
loss_pred:0.015300166793167591, decouple_loss:0.0005697941523976624
The modified gen p mean: 0.4521489441394806, gen p mean: -0.11442207545042038, mean p set: 0.4527256488800049
loss_pred:0.014462828636169434, decouple_loss:0.0006382059073075652
The modified gen p mean: 0.4535568356513977, gen p mean: -0.11008263379335403, mean p set: 0.4541351795196533
loss_pred:0.01415711548179388, decouple_loss:0.0004214136570226401
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
NaN value num: 0
Iteration: 1130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504510760307312, gen p mean: -0.11349979788064957, mean p set: 0.45102712512016296
loss_pred:0.015860052779316902, decouple_loss:0.0005120759014971554
The modified gen p mean: 0.44956061244010925, gen p mean: -0.11521676927804947, mean p set: 0.45013684034347534
The modified gen p mean: 0.45074737071990967, gen p mean: -0.1146756261587143, mean p set: 0.4513225853443146
loss_pred:0.016084227710962296, decouple_loss:0.0005257533630356193
loss_pred:0.014874015934765339, decouple_loss:0.0005146412877365947
2023-05-02 07:22:35 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1214851513504982, mean p set: 0.4502691626548767
loss_pred:0.017153851687908173, decouple_loss:0.0007720548310317099
The modified gen p mean: 0.44953498244285583, gen p mean: -0.11421428620815277, mean p set: 0.4500633478164673
loss_pred:0.016352221369743347, decouple_loss:0.0006006205221638083
The modified gen p mean: 0.44982898235321045, gen p mean: -0.11368166655302048, mean p set: 0.45035696029663086
loss_pred:0.016728414222598076, decouple_loss:0.0005304301739670336
WV_1_PC_1_EH_0_PS_40, loss: 0.01677655056118965, avg_mse: 0.026186717674136162
current test mse: 0.026187
Iteration: 1131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451633095741272, gen p mean: -0.10818333178758621, mean p set: 0.4522095024585724
loss_pred:0.015562997199594975, decouple_loss:0.00041319115553051233
The modified gen p mean: 0.4500015676021576, gen p mean: -0.11094298958778381, mean p set: 0.4505784809589386The modified gen p mean: 0.45213931798934937, gen p mean: -0.10983768105506897, mean p set: 0.4527163803577423
loss_pred:0.016366034746170044, decouple_loss:0.0006740755634382367
loss_pred:0.015589159913361073, decouple_loss:0.00046155203017406166
Iteration: 1132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45336002111434937, gen p mean: -0.09828206151723862, mean p set: 0.4539388418197632
loss_pred:0.015069853514432907, decouple_loss:0.0005184818292036653
The modified gen p mean: 0.4516162872314453, gen p mean: -0.09748554229736328, mean p set: 0.45219701528549194The modified gen p mean: 0.45191219449043274, gen p mean: -0.1013091430068016, mean p set: 0.4524913430213928
loss_pred:0.0155856404453516, decouple_loss:0.0005344810197129846
loss_pred:0.0161136407405138, decouple_loss:0.0005424169357866049
Iteration: 1133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512130320072174, gen p mean: -0.0923212543129921, mean p set: 0.4517900347709656
loss_pred:0.014651774428784847, decouple_loss:0.0006636964390054345
The modified gen p mean: 0.4514659345149994, gen p mean: -0.08904590457677841, mean p set: 0.4520423710346222
loss_pred:0.014663551934063435, decouple_loss:0.000402594159822911
The modified gen p mean: 0.45281726121902466, gen p mean: -0.09189306199550629, mean p set: 0.45339396595954895
loss_pred:0.015665845945477486, decouple_loss:0.0004979559453204274
Iteration: 1134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515571892261505, gen p mean: -0.09253741800785065, mean p set: 0.4521334171295166
loss_pred:0.01485816016793251, decouple_loss:0.0006208453560248017
The modified gen p mean: 0.45287710428237915, gen p mean: -0.09450464695692062, mean p set: 0.4534553289413452
loss_pred:0.01500914990901947, decouple_loss:0.0005546025931835175
The modified gen p mean: 0.45231375098228455, gen p mean: -0.09345649927854538, mean p set: 0.4528922438621521
loss_pred:0.01518632099032402, decouple_loss:0.0006565322983078659
Iteration: 1135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512738883495331, gen p mean: -0.09802314639091492, mean p set: 0.4518507122993469
loss_pred:0.016115272417664528, decouple_loss:0.00042668438982218504
The modified gen p mean: 0.4531771242618561, gen p mean: -0.10390114784240723, mean p set: 0.45375579595565796
loss_pred:0.014946314506232738, decouple_loss:0.0005793445161543787
The modified gen p mean: 0.4501602351665497, gen p mean: -0.1030261442065239, mean p set: 0.4507386088371277
loss_pred:0.015002056024968624, decouple_loss:0.0006428792257793248
Iteration: 1136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45031028985977173, gen p mean: -0.10680272430181503, mean p set: 0.450886607170105
loss_pred:0.01563643477857113, decouple_loss:0.00042659923201426864
The modified gen p mean: 0.45164984464645386, gen p mean: -0.09889298677444458, mean p set: 0.4522283971309662
loss_pred:0.01526943501085043, decouple_loss:0.00044906995026394725
The modified gen p mean: 0.4520707130432129, gen p mean: -0.09951796382665634, mean p set: 0.452647864818573
loss_pred:0.015015678480267525, decouple_loss:0.0004999696975573897
Iteration: 1137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837990403175354, gen p mean: -0.11306414008140564, mean p set: 0.44895628094673157
loss_pred:0.015620160847902298, decouple_loss:0.0006578045431524515
The modified gen p mean: 0.45022690296173096, gen p mean: -0.1052878126502037, mean p set: 0.4508056044578552
loss_pred:0.015476295724511147, decouple_loss:0.00045143565512262285
The modified gen p mean: 0.4493580162525177, gen p mean: -0.1051582470536232, mean p set: 0.4499339163303375
loss_pred:0.01584349013864994, decouple_loss:0.0004976968630217016
Iteration: 1138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45191600918769836, gen p mean: -0.10412401705980301, mean p set: 0.4524938464164734
loss_pred:0.014960522763431072, decouple_loss:0.0004986689891666174
The modified gen p mean: 0.4518986940383911, gen p mean: -0.10915274173021317, mean p set: 0.45247623324394226
loss_pred:0.015925347805023193, decouple_loss:0.0008689688984304667
The modified gen p mean: 0.4499279856681824, gen p mean: -0.10981272161006927, mean p set: 0.4505026042461395
loss_pred:0.015599518083035946, decouple_loss:0.000656522752251476
Iteration: 1139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45050084590911865, gen p mean: -0.11321946978569031, mean p set: 0.45107758045196533
loss_pred:0.015128595754504204, decouple_loss:0.000536358158569783
The modified gen p mean: 0.4505692720413208, gen p mean: -0.11125487834215164, mean p set: 0.45114725828170776
loss_pred:0.015124875120818615, decouple_loss:0.000557974330149591
The modified gen p mean: 0.45028796792030334, gen p mean: -0.1176377534866333, mean p set: 0.4508635997772217
loss_pred:0.015382902696728706, decouple_loss:0.0003943240153603256
Iteration: 1140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505980610847473, gen p mean: -0.10845500230789185, mean p set: 0.45117518305778503
loss_pred:0.014224582351744175, decouple_loss:0.0005662502953782678
The modified gen p mean: 0.451166033744812, gen p mean: -0.10544662922620773, mean p set: 0.45174357295036316
loss_pred:0.015548234805464745, decouple_loss:0.0006160506745800376
The modified gen p mean: 0.4502142071723938, gen p mean: -0.10857908427715302, mean p set: 0.45079126954078674
loss_pred:0.015331175178289413, decouple_loss:0.0006259498186409473
2023-05-02 07:24:42 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11692281067371368, mean p set: 0.4502691626548767
loss_pred:0.017060641199350357, decouple_loss:0.0005804635584354401
The modified gen p mean: 0.4495352804660797, gen p mean: -0.10996396094560623, mean p set: 0.4500633478164673
The modified gen p mean: 0.4498307406902313, gen p mean: -0.10916228592395782, mean p set: 0.45035696029663086
loss_pred:0.016424598172307014, decouple_loss:0.0006005920586176217
loss_pred:0.0166472140699625, decouple_loss:0.0005913916393183172
WV_1_PC_1_EH_0_PS_40, loss: 0.016740359365940094, avg_mse: 0.02604810707271099
current test mse: 0.026048
Iteration: 1141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528255760669708, gen p mean: -0.10408615320920944, mean p set: 0.45340198278427124
loss_pred:0.015063325874507427, decouple_loss:0.0005022715195082128
The modified gen p mean: 0.45223626494407654, gen p mean: -0.10456907004117966, mean p set: 0.4528115391731262
loss_pred:0.015576357953250408, decouple_loss:0.0004818744782824069
The modified gen p mean: 0.45196014642715454, gen p mean: -0.10133744031190872, mean p set: 0.4525359272956848
loss_pred:0.015124517492949963, decouple_loss:0.0005907730082981288
Iteration: 1142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520951807498932, gen p mean: -0.09388500452041626, mean p set: 0.4526708722114563
loss_pred:0.014427811838686466, decouple_loss:0.0006771936896257102
The modified gen p mean: 0.4519233703613281, gen p mean: -0.1020452156662941, mean p set: 0.45250123739242554The modified gen p mean: 0.45341214537620544, gen p mean: -0.10756577551364899, mean p set: 0.4539874494075775
loss_pred:0.01517840288579464, decouple_loss:0.0005867909057997167
loss_pred:0.014782240614295006, decouple_loss:0.00048213935224339366
Iteration: 1143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519188106060028, gen p mean: -0.09911058098077774, mean p set: 0.45249712467193604
loss_pred:0.01488512847572565, decouple_loss:0.0006154788425192237
The modified gen p mean: 0.4494347870349884, gen p mean: -0.09963809698820114, mean p set: 0.4500125050544739
loss_pred:0.015226119197905064, decouple_loss:0.0004791808605659753
The modified gen p mean: 0.4532740116119385, gen p mean: -0.10082735866308212, mean p set: 0.4538503587245941
loss_pred:0.01451034564524889, decouple_loss:0.0004451425629667938
Iteration: 1144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147550106048584, gen p mean: -0.09957962483167648, mean p set: 0.4520528018474579
loss_pred:0.01544857770204544, decouple_loss:0.0005142947775311768
The modified gen p mean: 0.45043691992759705, gen p mean: -0.09884781390428543, mean p set: 0.45101380348205566
loss_pred:0.015133360400795937, decouple_loss:0.0006035524420440197
The modified gen p mean: 0.45203837752342224, gen p mean: -0.09938639402389526, mean p set: 0.452614963054657
loss_pred:0.014753362163901329, decouple_loss:0.0005341416108421981
Iteration: 1145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45014703273773193, gen p mean: -0.09714090079069138, mean p set: 0.45072096586227417
loss_pred:0.015502474270761013, decouple_loss:0.0006289511802606285
The modified gen p mean: 0.4505903422832489, gen p mean: -0.10214130580425262, mean p set: 0.45116573572158813
loss_pred:0.014695392921566963, decouple_loss:0.0004933957825414836
The modified gen p mean: 0.45053309202194214, gen p mean: -0.09797509014606476, mean p set: 0.45110899209976196
loss_pred:0.0157600287348032, decouple_loss:0.0005187626811675727
Iteration: 1146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526625871658325, gen p mean: -0.10229742527008057, mean p set: 0.45323994755744934
loss_pred:0.015399307943880558, decouple_loss:0.0007663312135264277
The modified gen p mean: 0.4517391622066498, gen p mean: -0.09880116581916809, mean p set: 0.4523157775402069
loss_pred:0.015545397996902466, decouple_loss:0.0006955134449526668
The modified gen p mean: 0.4507218897342682, gen p mean: -0.0939432680606842, mean p set: 0.45129746198654175
loss_pred:0.015819599851965904, decouple_loss:0.000582680746447295
Iteration: 1147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44902196526527405, gen p mean: -0.10414708405733109, mean p set: 0.4495995044708252
loss_pred:0.015609794296324253, decouple_loss:0.0006934386910870671
The modified gen p mean: 0.45052626729011536, gen p mean: -0.10318160057067871, mean p set: 0.4511038064956665
The modified gen p mean: 0.4531837999820709, gen p mean: -0.10335536301136017, mean p set: 0.45376312732696533
loss_pred:0.014792898669838905, decouple_loss:0.0005215873243287206
loss_pred:0.014603735879063606, decouple_loss:0.0004407553351484239
Iteration: 1148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516935348510742, gen p mean: -0.10017222166061401, mean p set: 0.45226943492889404
loss_pred:0.01489782053977251, decouple_loss:0.0006077993311919272
The modified gen p mean: 0.44931477308273315, gen p mean: -0.10575464367866516, mean p set: 0.44988977909088135
The modified gen p mean: 0.45352205634117126, gen p mean: -0.10343652963638306, mean p set: 0.45409834384918213
loss_pred:0.015500763431191444, decouple_loss:0.0006398378172889352
loss_pred:0.014750944450497627, decouple_loss:0.00046902536996640265
Iteration: 1149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502345323562622, gen p mean: -0.1025896742939949, mean p set: 0.45081186294555664
loss_pred:0.015263973735272884, decouple_loss:0.0005371486186049879
The modified gen p mean: 0.4507962465286255, gen p mean: -0.09688133746385574, mean p set: 0.4513719379901886
loss_pred:0.015407928265631199, decouple_loss:0.0006909432704560459
The modified gen p mean: 0.45263439416885376, gen p mean: -0.09369093924760818, mean p set: 0.453212171792984
loss_pred:0.015234851278364658, decouple_loss:0.0005571255460381508
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
NaN value num: 0
Iteration: 1150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508398175239563, gen p mean: -0.09985262155532837, mean p set: 0.4514155089855194
loss_pred:0.016037875786423683, decouple_loss:0.0003564521321095526
The modified gen p mean: 0.4501887261867523, gen p mean: -0.09415699541568756, mean p set: 0.4507652819156647
The modified gen p mean: 0.45179063081741333, gen p mean: -0.10206127911806107, mean p set: 0.45236724615097046
loss_pred:0.016047697514295578, decouple_loss:0.0005072435596957803
loss_pred:0.015671856701374054, decouple_loss:0.0004895170568488538
2023-05-02 07:27:26 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10495229065418243, mean p set: 0.4502691626548767
loss_pred:0.01704847253859043, decouple_loss:0.00048518236144445837
The modified gen p mean: 0.4495357275009155, gen p mean: -0.09815505146980286, mean p set: 0.4500633478164673
loss_pred:0.01627393253147602, decouple_loss:0.0005294881411828101
The modified gen p mean: 0.4498280882835388, gen p mean: -0.09787467867136002, mean p set: 0.45035696029663086
loss_pred:0.01658540964126587, decouple_loss:0.0005735557642765343
WV_1_PC_1_EH_0_PS_40, loss: 0.01666240766644478, avg_mse: 0.025885077193379402
current test mse: 0.025885
Iteration: 1151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45034724473953247, gen p mean: -0.09856315702199936, mean p set: 0.4509235620498657
loss_pred:0.016310129314661026, decouple_loss:0.0005015950300730765
The modified gen p mean: 0.4487665891647339, gen p mean: -0.09766624122858047, mean p set: 0.4493427276611328
loss_pred:0.016976958140730858, decouple_loss:0.00047738547436892986
The modified gen p mean: 0.4500381350517273, gen p mean: -0.09605865925550461, mean p set: 0.45061448216438293
loss_pred:0.015545353293418884, decouple_loss:0.00042366128764115274
Iteration: 1152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45061978697776794, gen p mean: -0.103892482817173, mean p set: 0.45119625329971313
loss_pred:0.01666383445262909, decouple_loss:0.0006342977867461741
The modified gen p mean: 0.45008835196495056, gen p mean: -0.1063401997089386, mean p set: 0.450665146112442The modified gen p mean: 0.4508655369281769, gen p mean: -0.10319612920284271, mean p set: 0.45144200325012207
loss_pred:0.015306483954191208, decouple_loss:0.0006517351721413434
loss_pred:0.015952574089169502, decouple_loss:0.000629657763056457
Iteration: 1153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528016746044159, gen p mean: -0.10252796113491058, mean p set: 0.45337799191474915
loss_pred:0.014798322692513466, decouple_loss:0.0007318894495256245
The modified gen p mean: 0.4493018686771393, gen p mean: -0.09732115268707275, mean p set: 0.4498754143714905The modified gen p mean: 0.4501574635505676, gen p mean: -0.10209328681230545, mean p set: 0.4507328271865845
loss_pred:0.016268277540802956, decouple_loss:0.0007007246022112668
loss_pred:0.015872539952397346, decouple_loss:0.0003683730319608003
Iteration: 1154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848552346229553, gen p mean: -0.10368280112743378, mean p set: 0.4490624964237213
loss_pred:0.016388263553380966, decouple_loss:0.0006937216385267675
The modified gen p mean: 0.4493967592716217, gen p mean: -0.09891525655984879, mean p set: 0.4499734938144684
loss_pred:0.016430456191301346, decouple_loss:0.0006187992403283715
The modified gen p mean: 0.45039811730384827, gen p mean: -0.10099782794713974, mean p set: 0.45097532868385315
loss_pred:0.015376677736639977, decouple_loss:0.0007279342389665544
Iteration: 1155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502594769001007, gen p mean: -0.1055067926645279, mean p set: 0.4508368670940399
loss_pred:0.015002870000898838, decouple_loss:0.0004634906945284456
The modified gen p mean: 0.44997817277908325, gen p mean: -0.1052565723657608, mean p set: 0.4505557417869568
loss_pred:0.015898069366812706, decouple_loss:0.00047686020843684673
The modified gen p mean: 0.44949662685394287, gen p mean: -0.10450416803359985, mean p set: 0.4500739574432373
loss_pred:0.01546506304293871, decouple_loss:0.00048397277714684606
Iteration: 1156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482639729976654, gen p mean: -0.11052112281322479, mean p set: 0.4488401710987091
loss_pred:0.016270533204078674, decouple_loss:0.0005447522853501141
The modified gen p mean: 0.45035043358802795, gen p mean: -0.11097190529108047, mean p set: 0.45092687010765076
loss_pred:0.0156998448073864, decouple_loss:0.00038814658182673156
The modified gen p mean: 0.4495825171470642, gen p mean: -0.10808402299880981, mean p set: 0.45015794038772583
loss_pred:0.016213148832321167, decouple_loss:0.00047869558329693973
Iteration: 1157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45195433497428894, gen p mean: -0.10726418346166611, mean p set: 0.45253270864486694
loss_pred:0.016142331063747406, decouple_loss:0.0004228687030263245
The modified gen p mean: 0.45239338278770447, gen p mean: -0.10815447568893433, mean p set: 0.4529707729816437
loss_pred:0.015489762648940086, decouple_loss:0.00048162389430217445
The modified gen p mean: 0.45091888308525085, gen p mean: -0.10919776558876038, mean p set: 0.45149579644203186
loss_pred:0.015901824459433556, decouple_loss:0.0004930290160700679
Iteration: 1158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492909610271454, gen p mean: -0.10434062033891678, mean p set: 0.4498651623725891
loss_pred:0.016609013080596924, decouple_loss:0.00046306216972880065
The modified gen p mean: 0.4492502808570862, gen p mean: -0.09886913746595383, mean p set: 0.449828565120697
loss_pred:0.01627730391919613, decouple_loss:0.0005967727629467845
The modified gen p mean: 0.447983980178833, gen p mean: -0.10823677480220795, mean p set: 0.44856053590774536
loss_pred:0.016649367287755013, decouple_loss:0.0005314635927788913
Iteration: 1159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498703181743622, gen p mean: -0.10854215174913406, mean p set: 0.4504478871822357
loss_pred:0.01619342714548111, decouple_loss:0.0006028132629580796
The modified gen p mean: 0.45249688625335693, gen p mean: -0.10772682726383209, mean p set: 0.4530760943889618
loss_pred:0.014528774656355381, decouple_loss:0.0007709286874160171
The modified gen p mean: 0.44996076822280884, gen p mean: -0.10513561218976974, mean p set: 0.4505384862422943
loss_pred:0.015430809929966927, decouple_loss:0.0005639369483105838
Iteration: 1160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480849504470825, gen p mean: -0.11059657484292984, mean p set: 0.4486609697341919
loss_pred:0.016661621630191803, decouple_loss:0.0004619019746314734
The modified gen p mean: 0.45285937190055847, gen p mean: -0.10808288305997849, mean p set: 0.4534335732460022
loss_pred:0.014949630945920944, decouple_loss:0.0005819954094476998
The modified gen p mean: 0.4524165391921997, gen p mean: -0.10605431348085403, mean p set: 0.45299485325813293
loss_pred:0.01647772081196308, decouple_loss:0.0008772892178967595
2023-05-02 07:29:32 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11584249883890152, mean p set: 0.4502691626548767
loss_pred:0.017078479751944542, decouple_loss:0.0007672610809095204
The modified gen p mean: 0.4495345950126648, gen p mean: -0.10963238775730133, mean p set: 0.4500633478164673
loss_pred:0.016301337629556656, decouple_loss:0.0005530546186491847
The modified gen p mean: 0.4498275816440582, gen p mean: -0.10884706676006317, mean p set: 0.45035696029663086
loss_pred:0.0166190005838871, decouple_loss:0.00045791789307259023
WV_1_PC_1_EH_0_PS_40, loss: 0.016695909202098846, avg_mse: 0.026023495942354202
current test mse: 0.026023
Iteration: 1161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496302604675293, gen p mean: -0.10917564481496811, mean p set: 0.45020779967308044
loss_pred:0.015490280464291573, decouple_loss:0.0006875924300402403
The modified gen p mean: 0.4494745135307312, gen p mean: -0.10827387869358063, mean p set: 0.4500502049922943
loss_pred:0.015517906285822392, decouple_loss:0.000554512778762728
The modified gen p mean: 0.4497627913951874, gen p mean: -0.10973221063613892, mean p set: 0.4503386318683624
loss_pred:0.016608448699116707, decouple_loss:0.0006863536546006799
Iteration: 1162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509374797344208, gen p mean: -0.10428928583860397, mean p set: 0.45151469111442566
loss_pred:0.01608050987124443, decouple_loss:0.0006008920609019697
The modified gen p mean: 0.44846418499946594, gen p mean: -0.10621242225170135, mean p set: 0.44904032349586487The modified gen p mean: 0.4504648745059967, gen p mean: -0.10830700397491455, mean p set: 0.45104163885116577
loss_pred:0.016245223581790924, decouple_loss:0.0005577364936470985
loss_pred:0.015546123497188091, decouple_loss:0.0005715300212614238
Iteration: 1163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503253102302551, gen p mean: -0.1027013435959816, mean p set: 0.45089974999427795
loss_pred:0.015407142229378223, decouple_loss:0.000362060236511752
The modified gen p mean: 0.4497883915901184, gen p mean: -0.10433562844991684, mean p set: 0.4503653943538666The modified gen p mean: 0.4507715404033661, gen p mean: -0.10774215310811996, mean p set: 0.45134952664375305
loss_pred:0.015596033073961735, decouple_loss:0.0005155017133802176
loss_pred:0.016482414677739143, decouple_loss:0.0006783524877391756
Iteration: 1164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497305154800415, gen p mean: -0.1061629205942154, mean p set: 0.45030441880226135
loss_pred:0.015758004039525986, decouple_loss:0.00037485547363758087
The modified gen p mean: 0.44991523027420044, gen p mean: -0.10401099175214767, mean p set: 0.4504922032356262
loss_pred:0.016058029606938362, decouple_loss:0.00038206978933885694
The modified gen p mean: 0.45265746116638184, gen p mean: -0.10667260736227036, mean p set: 0.45323646068573
loss_pred:0.014824251644313335, decouple_loss:0.00041949612204916775
Iteration: 1165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862785935401917, gen p mean: -0.11433273553848267, mean p set: 0.4492030143737793
loss_pred:0.016240742057561874, decouple_loss:0.0007519471109844744
The modified gen p mean: 0.44922930002212524, gen p mean: -0.11605589836835861, mean p set: 0.44980570673942566
loss_pred:0.01528945192694664, decouple_loss:0.0005371016450226307
The modified gen p mean: 0.4505576193332672, gen p mean: -0.11078312993049622, mean p set: 0.4511338472366333
loss_pred:0.015300014987587929, decouple_loss:0.0006423055310733616
Iteration: 1166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508707821369171, gen p mean: -0.11894629150629044, mean p set: 0.45144885778427124
loss_pred:0.01602126844227314, decouple_loss:0.00046523529454134405
The modified gen p mean: 0.4527355134487152, gen p mean: -0.11589062958955765, mean p set: 0.45331335067749023
loss_pred:0.014679767191410065, decouple_loss:0.0005059640971012414
The modified gen p mean: 0.45100417733192444, gen p mean: -0.11396315693855286, mean p set: 0.4515804052352905
loss_pred:0.01516888290643692, decouple_loss:0.00043491180986166
Iteration: 1167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532094895839691, gen p mean: -0.11588600277900696, mean p set: 0.4537888467311859
loss_pred:0.01594178006052971, decouple_loss:0.0005305850063450634
The modified gen p mean: 0.4484279155731201, gen p mean: -0.12276890873908997, mean p set: 0.44900277256965637
loss_pred:0.01699642464518547, decouple_loss:0.0004034418670926243
The modified gen p mean: 0.4489248991012573, gen p mean: -0.12326160818338394, mean p set: 0.4495016634464264
loss_pred:0.016775013878941536, decouple_loss:0.0004357830330263823
Iteration: 1168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44979774951934814, gen p mean: -0.12020644545555115, mean p set: 0.45037373900413513
loss_pred:0.01534320693463087, decouple_loss:0.0005006313440389931
The modified gen p mean: 0.45187389850616455, gen p mean: -0.11800887435674667, mean p set: 0.45245006680488586
loss_pred:0.015190377831459045, decouple_loss:0.0006771199405193329
The modified gen p mean: 0.45188239216804504, gen p mean: -0.11977650970220566, mean p set: 0.45245808362960815
loss_pred:0.01466215867549181, decouple_loss:0.0005739072221331298
Iteration: 1169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492616653442383, gen p mean: -0.11844088137149811, mean p set: 0.4498375654220581
loss_pred:0.016021473333239555, decouple_loss:0.0004954332252964377
The modified gen p mean: 0.4494607150554657, gen p mean: -0.12874358892440796, mean p set: 0.45003804564476013
loss_pred:0.015464447438716888, decouple_loss:0.0005368696874938905
The modified gen p mean: 0.448944628238678, gen p mean: -0.12018872797489166, mean p set: 0.4495201110839844
loss_pred:0.015536816790699959, decouple_loss:0.00046916340943425894
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
NaN value num: 0
Iteration: 1170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45153117179870605, gen p mean: -0.12303530424833298, mean p set: 0.4521084129810333
The modified gen p mean: 0.44745469093322754, gen p mean: -0.11547274142503738, mean p set: 0.44803333282470703loss_pred:0.016238242387771606, decouple_loss:0.0005203592590987682
loss_pred:0.015249021351337433, decouple_loss:0.0006891821976751089
The modified gen p mean: 0.450444757938385, gen p mean: -0.11628692597150803, mean p set: 0.45102187991142273
loss_pred:0.015835827216506004, decouple_loss:0.00045915349619463086
2023-05-02 07:32:19 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11940603703260422, mean p set: 0.4502691626548767
loss_pred:0.01702786795794964, decouple_loss:0.0004454942827578634
The modified gen p mean: 0.4495362937450409, gen p mean: -0.1126963421702385, mean p set: 0.4500633478164673
loss_pred:0.01629307121038437, decouple_loss:0.00046002594172023237
The modified gen p mean: 0.4498271048069, gen p mean: -0.11218038201332092, mean p set: 0.45035696029663086
loss_pred:0.016529962420463562, decouple_loss:0.0005769360577687621
WV_1_PC_1_EH_0_PS_40, loss: 0.01664167456328869, avg_mse: 0.025949979200959206
current test mse: 0.02595
Iteration: 1171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503069221973419, gen p mean: -0.11554654687643051, mean p set: 0.4508877694606781
loss_pred:0.016211964190006256, decouple_loss:0.0005527458852156997
The modified gen p mean: 0.44998443126678467, gen p mean: -0.10520287603139877, mean p set: 0.4505615830421448The modified gen p mean: 0.44999557733535767, gen p mean: -0.10537061840295792, mean p set: 0.45057329535484314
loss_pred:0.015741657465696335, decouple_loss:0.000490705540869385
loss_pred:0.016233161091804504, decouple_loss:0.0005101048736833036
Iteration: 1172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776976108551025, gen p mean: -0.108043372631073, mean p set: 0.4483462870121002
loss_pred:0.015443027019500732, decouple_loss:0.000621371844317764
The modified gen p mean: 0.44962307810783386, gen p mean: -0.10769562423229218, mean p set: 0.4502002000808716The modified gen p mean: 0.447243332862854, gen p mean: -0.11250892281532288, mean p set: 0.4478166699409485
loss_pred:0.015470074489712715, decouple_loss:0.0004356200515758246loss_pred:0.016228029504418373, decouple_loss:0.0006862489390186965
Iteration: 1173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514355957508087, gen p mean: -0.107868991792202, mean p set: 0.4520123302936554
loss_pred:0.015317747369408607, decouple_loss:0.0005588146741501987
The modified gen p mean: 0.44708627462387085, gen p mean: -0.10798926651477814, mean p set: 0.4476604163646698
loss_pred:0.016237016767263412, decouple_loss:0.0004886022070422769
The modified gen p mean: 0.4512767195701599, gen p mean: -0.10200142860412598, mean p set: 0.45185160636901855
loss_pred:0.016349783167243004, decouple_loss:0.000568665680475533
Iteration: 1174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968003034591675, gen p mean: -0.1138417199254036, mean p set: 0.45025739073753357
loss_pred:0.016653787344694138, decouple_loss:0.0005828997818753123
The modified gen p mean: 0.45011135935783386, gen p mean: -0.10822702944278717, mean p set: 0.4506881833076477
loss_pred:0.01551381591707468, decouple_loss:0.0005487182061187923
The modified gen p mean: 0.44919562339782715, gen p mean: -0.10406055301427841, mean p set: 0.44977399706840515
loss_pred:0.016006072983145714, decouple_loss:0.00043456366984173656
Iteration: 1175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515942931175232, gen p mean: -0.11033120006322861, mean p set: 0.45216912031173706
loss_pred:0.015873689204454422, decouple_loss:0.000533140089828521
The modified gen p mean: 0.44998878240585327, gen p mean: -0.10756728798151016, mean p set: 0.45056405663490295
loss_pred:0.015815502032637596, decouple_loss:0.0004523231473285705
The modified gen p mean: 0.4472048282623291, gen p mean: -0.10858561098575592, mean p set: 0.44778314232826233
loss_pred:0.01619027368724346, decouple_loss:0.0006187342223711312
Iteration: 1176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520820677280426, gen p mean: -0.1090247631072998, mean p set: 0.4526605010032654
loss_pred:0.014922000467777252, decouple_loss:0.0004502725787460804
The modified gen p mean: 0.44748371839523315, gen p mean: -0.10656951367855072, mean p set: 0.44805923104286194
The modified gen p mean: 0.4490662217140198, gen p mean: -0.09381937235593796, mean p set: 0.4496413469314575
loss_pred:0.015338682569563389, decouple_loss:0.00048202069592662156
loss_pred:0.01617952063679695, decouple_loss:0.0004887810791842639
Iteration: 1177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486381411552429, gen p mean: -0.10137873888015747, mean p set: 0.44921693205833435
loss_pred:0.01606544852256775, decouple_loss:0.0005075447261333466
The modified gen p mean: 0.4476920962333679, gen p mean: -0.10347361117601395, mean p set: 0.44826605916023254
loss_pred:0.016321688890457153, decouple_loss:0.0004365469503682107
The modified gen p mean: 0.44856032729148865, gen p mean: -0.09870558977127075, mean p set: 0.449136883020401
loss_pred:0.016554860398173332, decouple_loss:0.0004941194201819599
Iteration: 1178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803082942962646, gen p mean: -0.10757346451282501, mean p set: 0.4486050307750702
loss_pred:0.015681227669119835, decouple_loss:0.00042771498556248844
The modified gen p mean: 0.448257178068161, gen p mean: -0.10589658468961716, mean p set: 0.44883257150650024
loss_pred:0.014930015429854393, decouple_loss:0.000502719369251281
The modified gen p mean: 0.4474734961986542, gen p mean: -0.10911145806312561, mean p set: 0.4480479061603546
loss_pred:0.01563391275703907, decouple_loss:0.0004514134780038148
Iteration: 1179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479818642139435, gen p mean: -0.11444951593875885, mean p set: 0.44855889678001404
loss_pred:0.015244944021105766, decouple_loss:0.0005270009278319776
The modified gen p mean: 0.44947001338005066, gen p mean: -0.11484593898057938, mean p set: 0.4500448405742645
The modified gen p mean: 0.4495101273059845, gen p mean: -0.11120480298995972, mean p set: 0.4500843286514282
loss_pred:0.01539324689656496, decouple_loss:0.0007580780074931681
loss_pred:0.016153275966644287, decouple_loss:0.0005789092392660677
Iteration: 1180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45127052068710327, gen p mean: -0.1178869679570198, mean p set: 0.4518480598926544
loss_pred:0.014307321049273014, decouple_loss:0.0005771449650637805
The modified gen p mean: 0.4521794617176056, gen p mean: -0.12161113321781158, mean p set: 0.4527588486671448
loss_pred:0.014866717159748077, decouple_loss:0.0003878524003084749
The modified gen p mean: 0.44986891746520996, gen p mean: -0.1190616562962532, mean p set: 0.4504449665546417
loss_pred:0.015855280682444572, decouple_loss:0.00047553982585668564
2023-05-02 07:34:26 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12577006220817566, mean p set: 0.4502691626548767
loss_pred:0.017150456085801125, decouple_loss:0.0006149765104055405
The modified gen p mean: 0.44953516125679016, gen p mean: -0.11872011423110962, mean p set: 0.4500633478164673
loss_pred:0.016395103186368942, decouple_loss:0.0007226075395010412
The modified gen p mean: 0.4498293995857239, gen p mean: -0.11854969710111618, mean p set: 0.45035696029663086
loss_pred:0.016649138182401657, decouple_loss:0.0006923464243300259
WV_1_PC_1_EH_0_PS_40, loss: 0.016765398904681206, avg_mse: 0.02607056125998497
current test mse: 0.026071
Iteration: 1181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491773247718811, gen p mean: -0.12034117430448532, mean p set: 0.4497537314891815
loss_pred:0.014862474985420704, decouple_loss:0.0003857826523017138
The modified gen p mean: 0.4495936930179596, gen p mean: -0.11044047027826309, mean p set: 0.45017069578170776
loss_pred:0.01548486016690731, decouple_loss:0.0007969095604494214
The modified gen p mean: 0.4501613974571228, gen p mean: -0.11383127421140671, mean p set: 0.45073726773262024
loss_pred:0.015673324465751648, decouple_loss:0.00047160402755253017
Iteration: 1182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990208745002747, gen p mean: -0.10959412902593613, mean p set: 0.45047977566719055
The modified gen p mean: 0.4486526548862457, gen p mean: -0.10640207678079605, mean p set: 0.4492295980453491
loss_pred:0.015189273282885551, decouple_loss:0.000577012833673507
loss_pred:0.015853557735681534, decouple_loss:0.0008827745914459229
The modified gen p mean: 0.4473816454410553, gen p mean: -0.11633751541376114, mean p set: 0.44795873761177063
loss_pred:0.015954697504639626, decouple_loss:0.0005652392865158617
Iteration: 1183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831591844558716, gen p mean: -0.10543356090784073, mean p set: 0.44889137148857117The modified gen p mean: 0.45012256503105164, gen p mean: -0.10987292975187302, mean p set: 0.45069968700408936
loss_pred:0.016288354992866516, decouple_loss:0.0004904349916614592
loss_pred:0.01459707785397768, decouple_loss:0.000715166621375829
The modified gen p mean: 0.45145219564437866, gen p mean: -0.10989251732826233, mean p set: 0.4520305097103119
loss_pred:0.014639925211668015, decouple_loss:0.0005675245192833245
Iteration: 1184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491892158985138, gen p mean: -0.10525485873222351, mean p set: 0.44976580142974854
loss_pred:0.016156166791915894, decouple_loss:0.0004954187897965312
The modified gen p mean: 0.4485170543193817, gen p mean: -0.10405765473842621, mean p set: 0.44909143447875977
loss_pred:0.015824533998966217, decouple_loss:0.0006561573827639222
The modified gen p mean: 0.4500068128108978, gen p mean: -0.10197028517723083, mean p set: 0.4505856931209564
loss_pred:0.015686146914958954, decouple_loss:0.000544568058103323
Iteration: 1185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451188325881958, gen p mean: -0.10751063376665115, mean p set: 0.45176324248313904
loss_pred:0.014445214532315731, decouple_loss:0.0004615401558112353
The modified gen p mean: 0.4486079216003418, gen p mean: -0.10493812710046768, mean p set: 0.4491817057132721
loss_pred:0.015001245774328709, decouple_loss:0.0006835029926151037
The modified gen p mean: 0.45095983147621155, gen p mean: -0.09788824617862701, mean p set: 0.451536625623703
loss_pred:0.015598260797560215, decouple_loss:0.00047271931543946266
Iteration: 1186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507550001144409, gen p mean: -0.10710353404283524, mean p set: 0.45133325457572937
loss_pred:0.01583964005112648, decouple_loss:0.0006774557405151427
The modified gen p mean: 0.4497342109680176, gen p mean: -0.10332151502370834, mean p set: 0.4503127932548523
loss_pred:0.014832315035164356, decouple_loss:0.00052668247371912
The modified gen p mean: 0.451266348361969, gen p mean: -0.10762862861156464, mean p set: 0.45184415578842163
loss_pred:0.01487010158598423, decouple_loss:0.000701078271958977
Iteration: 1187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490414559841156, gen p mean: -0.11063919216394424, mean p set: 0.44961604475975037
loss_pred:0.015108611434698105, decouple_loss:0.0005464312271215022
The modified gen p mean: 0.4471806287765503, gen p mean: -0.10953840613365173, mean p set: 0.44775813817977905
The modified gen p mean: 0.4490475058555603, gen p mean: -0.10769475251436234, mean p set: 0.44962644577026367
loss_pred:0.015319310128688812, decouple_loss:0.0006363106076605618
loss_pred:0.015473222360014915, decouple_loss:0.0005940480041317642
Iteration: 1188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482755959033966, gen p mean: -0.11563614010810852, mean p set: 0.44885390996932983
loss_pred:0.014766789972782135, decouple_loss:0.0007247055182233453
The modified gen p mean: 0.4493398070335388, gen p mean: -0.11168553680181503, mean p set: 0.44991356134414673
loss_pred:0.015692416578531265, decouple_loss:0.0004985479754395783
The modified gen p mean: 0.4481163024902344, gen p mean: -0.10783275961875916, mean p set: 0.44869256019592285
loss_pred:0.01524485182017088, decouple_loss:0.0009013201924972236
Iteration: 1189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44985684752464294, gen p mean: -0.10832075774669647, mean p set: 0.4504333436489105
loss_pred:0.014940943568944931, decouple_loss:0.000567861192394048
The modified gen p mean: 0.45055872201919556, gen p mean: -0.10793069750070572, mean p set: 0.45113611221313477
The modified gen p mean: 0.44715452194213867, gen p mean: -0.11263328790664673, mean p set: 0.44773074984550476
loss_pred:0.01604406163096428, decouple_loss:0.0006032423116266727
loss_pred:0.015168046578764915, decouple_loss:0.0006506022182293236
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 1190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44885820150375366, gen p mean: -0.11291588842868805, mean p set: 0.4494354724884033
The modified gen p mean: 0.44927576184272766, gen p mean: -0.11485803872346878, mean p set: 0.44985130429267883
loss_pred:0.01551394909620285, decouple_loss:0.0007907284889370203
loss_pred:0.015499578788876534, decouple_loss:0.0005458613159134984
The modified gen p mean: 0.44719454646110535, gen p mean: -0.11966324597597122, mean p set: 0.44777119159698486
loss_pred:0.016153495758771896, decouple_loss:0.0005915015353821218
2023-05-02 07:37:10 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12202262133359909, mean p set: 0.4502691626548767
loss_pred:0.017258726060390472, decouple_loss:0.0004716269322670996
The modified gen p mean: 0.4495326280593872, gen p mean: -0.1159384548664093, mean p set: 0.4500633478164673
loss_pred:0.016360297799110413, decouple_loss:0.0005972731742076576
The modified gen p mean: 0.44982728362083435, gen p mean: -0.1154949814081192, mean p set: 0.45035696029663086
loss_pred:0.016640132293105125, decouple_loss:0.0005580931901931763
WV_1_PC_1_EH_0_PS_40, loss: 0.016780167818069458, avg_mse: 0.02609897218644619
current test mse: 0.026099
Iteration: 1191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458771347999573, gen p mean: -0.11582892388105392, mean p set: 0.44645413756370544
loss_pred:0.015661675482988358, decouple_loss:0.0006593089201487601
The modified gen p mean: 0.4476563036441803, gen p mean: -0.12016481906175613, mean p set: 0.4482314884662628
loss_pred:0.015379311516880989, decouple_loss:0.0004917633486911654
The modified gen p mean: 0.44793379306793213, gen p mean: -0.11476831138134003, mean p set: 0.44850867986679077
loss_pred:0.015372872352600098, decouple_loss:0.000960111734457314
Iteration: 1192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480922222137451, gen p mean: -0.11978834122419357, mean p set: 0.4486686885356903
loss_pred:0.015719003975391388, decouple_loss:0.0007302472367882729
The modified gen p mean: 0.4490998685359955, gen p mean: -0.1115034744143486, mean p set: 0.44967639446258545The modified gen p mean: 0.44892895221710205, gen p mean: -0.11613398790359497, mean p set: 0.4495036005973816
loss_pred:0.01517147570848465, decouple_loss:0.0006830035708844662loss_pred:0.015984538942575455, decouple_loss:0.0006126202642917633
Iteration: 1193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742661714553833, gen p mean: -0.12148050218820572, mean p set: 0.4480014741420746
loss_pred:0.015324631705880165, decouple_loss:0.0008239244925789535
The modified gen p mean: 0.4462103545665741, gen p mean: -0.12596215307712555, mean p set: 0.4467865526676178
loss_pred:0.01619631052017212, decouple_loss:0.0008491957560181618
The modified gen p mean: 0.4485090970993042, gen p mean: -0.1249147430062294, mean p set: 0.44908660650253296
loss_pred:0.015642913058400154, decouple_loss:0.0006844131858088076
Iteration: 1194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893980026245117, gen p mean: -0.12095222622156143, mean p set: 0.44951605796813965
loss_pred:0.01507037878036499, decouple_loss:0.0006720194942317903
The modified gen p mean: 0.4481825530529022, gen p mean: -0.1193406879901886, mean p set: 0.4487598240375519
loss_pred:0.01546286791563034, decouple_loss:0.00047583115519955754
The modified gen p mean: 0.4470091462135315, gen p mean: -0.11922518163919449, mean p set: 0.4475817382335663
loss_pred:0.015792137011885643, decouple_loss:0.0005104416632093489
Iteration: 1195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452647268772125, gen p mean: -0.12524475157260895, mean p set: 0.44584187865257263
loss_pred:0.015942120924592018, decouple_loss:0.0005120050627738237
The modified gen p mean: 0.44847872853279114, gen p mean: -0.12135156244039536, mean p set: 0.4490565061569214
loss_pred:0.0151651157066226, decouple_loss:0.0004701527359429747
The modified gen p mean: 0.44736409187316895, gen p mean: -0.12253765016794205, mean p set: 0.4479406476020813
loss_pred:0.015365325845777988, decouple_loss:0.0004862459609284997
Iteration: 1196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475248456001282, gen p mean: -0.12244816869497299, mean p set: 0.4481014013290405
loss_pred:0.0159442201256752, decouple_loss:0.0006353909848257899
The modified gen p mean: 0.4478946328163147, gen p mean: -0.12279511243104935, mean p set: 0.448468953371048
loss_pred:0.015807107090950012, decouple_loss:0.000568435643799603
The modified gen p mean: 0.4483751356601715, gen p mean: -0.1235131248831749, mean p set: 0.4489506781101227
loss_pred:0.015666238963603973, decouple_loss:0.0006373000796884298
Iteration: 1197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846034049987793, gen p mean: -0.11880742013454437, mean p set: 0.4490351974964142
The modified gen p mean: 0.44714900851249695, gen p mean: -0.11805084347724915, mean p set: 0.4477252662181854
loss_pred:0.01483689621090889, decouple_loss:0.0005502625135704875
loss_pred:0.0158816147595644, decouple_loss:0.0004883526707999408
The modified gen p mean: 0.4471030533313751, gen p mean: -0.1244601458311081, mean p set: 0.44767823815345764
loss_pred:0.01515600923448801, decouple_loss:0.0005386355333030224
Iteration: 1198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705843925476074, gen p mean: -0.12170904874801636, mean p set: 0.4476326107978821
loss_pred:0.01503107137978077, decouple_loss:0.0005981851718388498
The modified gen p mean: 0.4478943943977356, gen p mean: -0.11535362154245377, mean p set: 0.44847002625465393
loss_pred:0.01546963956207037, decouple_loss:0.0005325151141732931
The modified gen p mean: 0.4478670060634613, gen p mean: -0.12848536670207977, mean p set: 0.44844329357147217
loss_pred:0.015748953446745872, decouple_loss:0.0007454843143932521
Iteration: 1199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829246401786804, gen p mean: -0.11846531182527542, mean p set: 0.4488692581653595
The modified gen p mean: 0.44872891902923584, gen p mean: -0.11805859953165054, mean p set: 0.44930681586265564
loss_pred:0.015334338881075382, decouple_loss:0.0005617637070827186
loss_pred:0.01562684401869774, decouple_loss:0.0005063741118647158
The modified gen p mean: 0.44811195135116577, gen p mean: -0.1236753836274147, mean p set: 0.4486868679523468
loss_pred:0.014929872006177902, decouple_loss:0.00046171480789780617
Iteration: 1200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462646245956421, gen p mean: -0.12558628618717194, mean p set: 0.4468391239643097
loss_pred:0.015478856861591339, decouple_loss:0.0005523320287466049
The modified gen p mean: 0.44812631607055664, gen p mean: -0.13158291578292847, mean p set: 0.44869908690452576
loss_pred:0.015162095427513123, decouple_loss:0.0005153528763912618
The modified gen p mean: 0.4473181664943695, gen p mean: -0.12974552810192108, mean p set: 0.4478928744792938
loss_pred:0.014978945255279541, decouple_loss:0.00046013263636268675
2023-05-02 07:39:17 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12832386791706085, mean p set: 0.4502691626548767
loss_pred:0.017129428684711456, decouple_loss:0.0006838012486696243
The modified gen p mean: 0.44953328371047974, gen p mean: -0.12085767835378647, mean p set: 0.4500633478164673
loss_pred:0.016347184777259827, decouple_loss:0.0006630084244534373
The modified gen p mean: 0.4498281180858612, gen p mean: -0.12072647362947464, mean p set: 0.45035696029663086
loss_pred:0.01669083908200264, decouple_loss:0.0005637763533741236
WV_1_PC_1_EH_0_PS_40, loss: 0.016754327341914177, avg_mse: 0.026082053780555725
current test mse: 0.026082
Iteration: 1201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474635720252991, gen p mean: -0.11377989500761032, mean p set: 0.4480399191379547
loss_pred:0.014731337316334248, decouple_loss:0.0006228688871487975
The modified gen p mean: 0.44746649265289307, gen p mean: -0.12374188750982285, mean p set: 0.4480428397655487The modified gen p mean: 0.44587811827659607, gen p mean: -0.12826970219612122, mean p set: 0.44645223021507263
loss_pred:0.014372803270816803, decouple_loss:0.0005128758493810892loss_pred:0.015598072670400143, decouple_loss:0.0005641015013679862
Iteration: 1202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482611119747162, gen p mean: -0.1262281984090805, mean p set: 0.4488369822502136
loss_pred:0.01543688029050827, decouple_loss:0.00042483684956096113
The modified gen p mean: 0.44737330079078674, gen p mean: -0.1266484558582306, mean p set: 0.44794782996177673
The modified gen p mean: 0.4478410482406616, gen p mean: -0.12651465833187103, mean p set: 0.44841864705085754
loss_pred:0.0160568468272686, decouple_loss:0.0005484798457473516
loss_pred:0.015350942499935627, decouple_loss:0.0004991245223209262
Iteration: 1203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44557103514671326, gen p mean: -0.12961196899414062, mean p set: 0.4461473524570465
loss_pred:0.01589071936905384, decouple_loss:0.000579901272431016
The modified gen p mean: 0.44706517457962036, gen p mean: -0.12019766867160797, mean p set: 0.44764280319213867
loss_pred:0.015530520118772984, decouple_loss:0.0005148269701749086
The modified gen p mean: 0.44836652278900146, gen p mean: -0.12494264543056488, mean p set: 0.4489421248435974
loss_pred:0.015223714523017406, decouple_loss:0.0005365979159250855
Iteration: 1204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44586610794067383, gen p mean: -0.12213169783353806, mean p set: 0.4464397132396698
loss_pred:0.015649931505322456, decouple_loss:0.0004884795635007322
The modified gen p mean: 0.44816261529922485, gen p mean: -0.11389870941638947, mean p set: 0.4487389624118805
loss_pred:0.015751155093312263, decouple_loss:0.0005382088129408658
The modified gen p mean: 0.4476064443588257, gen p mean: -0.12303266674280167, mean p set: 0.448184072971344
loss_pred:0.015562396496534348, decouple_loss:0.0005821012891829014
Iteration: 1205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754457473754883, gen p mean: -0.1141430139541626, mean p set: 0.44812238216400146
loss_pred:0.01558216568082571, decouple_loss:0.00046721359831281006
The modified gen p mean: 0.44706690311431885, gen p mean: -0.11149900406599045, mean p set: 0.44764459133148193
loss_pred:0.014875524677336216, decouple_loss:0.0004339558945503086
The modified gen p mean: 0.44808927178382874, gen p mean: -0.1132158562541008, mean p set: 0.4486646354198456
loss_pred:0.01505553163588047, decouple_loss:0.0004844654176849872
Iteration: 1206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476926326751709, gen p mean: -0.11082577705383301, mean p set: 0.44826918840408325
loss_pred:0.015378092415630817, decouple_loss:0.000597942213062197
The modified gen p mean: 0.4467999339103699, gen p mean: -0.10607610642910004, mean p set: 0.4473777115345001
loss_pred:0.016084888949990273, decouple_loss:0.0005235939170233905
The modified gen p mean: 0.4470908045768738, gen p mean: -0.10512897372245789, mean p set: 0.4476655125617981
loss_pred:0.014617965556681156, decouple_loss:0.0005264803767204285
Iteration: 1207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737112522125244, gen p mean: -0.1087050810456276, mean p set: 0.4479483664035797
loss_pred:0.01502909604460001, decouple_loss:0.00036028202157467604
The modified gen p mean: 0.4472271502017975, gen p mean: -0.10439254343509674, mean p set: 0.44780370593070984
loss_pred:0.015837542712688446, decouple_loss:0.0005497795646078885
The modified gen p mean: 0.44864001870155334, gen p mean: -0.10599670559167862, mean p set: 0.4492167532444
loss_pred:0.01583646424114704, decouple_loss:0.00038951332680881023
Iteration: 1208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479354918003082, gen p mean: -0.10908952355384827, mean p set: 0.4485113322734833
loss_pred:0.01471894420683384, decouple_loss:0.0004975376068614423
The modified gen p mean: 0.4476950466632843, gen p mean: -0.10863502323627472, mean p set: 0.44827160239219666
loss_pred:0.016054663807153702, decouple_loss:0.0005657018627971411
The modified gen p mean: 0.44886624813079834, gen p mean: -0.10368089377880096, mean p set: 0.44944167137145996
loss_pred:0.01508426945656538, decouple_loss:0.00044199966941960156
Iteration: 1209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483441114425659, gen p mean: -0.11145030707120895, mean p set: 0.448919415473938
loss_pred:0.015307852067053318, decouple_loss:0.0005788035923615098
The modified gen p mean: 0.4463176429271698, gen p mean: -0.11783580482006073, mean p set: 0.44689464569091797
loss_pred:0.015606134198606014, decouple_loss:0.0006003245944157243
The modified gen p mean: 0.448320209980011, gen p mean: -0.1164994090795517, mean p set: 0.44889581203460693
loss_pred:0.01575520820915699, decouple_loss:0.0009381675627082586
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
NaN value num: 0
Iteration: 1210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45159921050071716, gen p mean: -0.11024695634841919, mean p set: 0.4521753489971161
loss_pred:0.016394680365920067, decouple_loss:0.0006186573882587254
The modified gen p mean: 0.45095449686050415, gen p mean: -0.10341934114694595, mean p set: 0.45153123140335083
The modified gen p mean: 0.4527951180934906, gen p mean: -0.1057257428765297, mean p set: 0.45337265729904175
loss_pred:0.015009683556854725, decouple_loss:0.0006399950361810625
loss_pred:0.015533882193267345, decouple_loss:0.000578067556489259
2023-05-02 07:41:58 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12293530255556107, mean p set: 0.4502691626548767
loss_pred:0.017070071771740913, decouple_loss:0.0005010199965909123
The modified gen p mean: 0.44953569769859314, gen p mean: -0.11764322221279144, mean p set: 0.4500633478164673
loss_pred:0.01638481207191944, decouple_loss:0.0005142221925780177
The modified gen p mean: 0.44982871413230896, gen p mean: -0.1174158826470375, mean p set: 0.45035696029663086
loss_pred:0.016610655933618546, decouple_loss:0.0005398708744905889
WV_1_PC_1_EH_0_PS_40, loss: 0.0167144313454628, avg_mse: 0.026073474436998367
current test mse: 0.026073
Iteration: 1211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45095935463905334, gen p mean: -0.10681835561990738, mean p set: 0.4515356123447418
loss_pred:0.01662656106054783, decouple_loss:0.0004520374059211463
The modified gen p mean: 0.45232975482940674, gen p mean: -0.10610660910606384, mean p set: 0.4529041349887848
loss_pred:0.015626704320311546, decouple_loss:0.0005318776820786297
The modified gen p mean: 0.453016996383667, gen p mean: -0.10702715069055557, mean p set: 0.45359519124031067
loss_pred:0.01583344116806984, decouple_loss:0.000530021614395082
Iteration: 1212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524061381816864, gen p mean: -0.10293645411729813, mean p set: 0.45298269391059875
loss_pred:0.01677427813410759, decouple_loss:0.0008245430653914809
The modified gen p mean: 0.4517538547515869, gen p mean: -0.10915529727935791, mean p set: 0.4523301124572754The modified gen p mean: 0.4507976472377777, gen p mean: -0.10627671331167221, mean p set: 0.45137453079223633
loss_pred:0.01659146323800087, decouple_loss:0.0006091765826568007
loss_pred:0.01675000600516796, decouple_loss:0.000570720003452152
Iteration: 1213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514578878879547, gen p mean: -0.11055213212966919, mean p set: 0.4520357549190521
loss_pred:0.015735648572444916, decouple_loss:0.0005152504309080541
The modified gen p mean: 0.45017698407173157, gen p mean: -0.10293538123369217, mean p set: 0.45075303316116333The modified gen p mean: 0.4527081847190857, gen p mean: -0.10856471955776215, mean p set: 0.45328596234321594
loss_pred:0.015055608004331589, decouple_loss:0.0007734778919257224
loss_pred:0.017160089686512947, decouple_loss:0.0007831617258489132
Iteration: 1214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45142224431037903, gen p mean: -0.101551853120327, mean p set: 0.45199838280677795
loss_pred:0.01637115515768528, decouple_loss:0.0005280119949020445
The modified gen p mean: 0.4509624242782593, gen p mean: -0.10122345387935638, mean p set: 0.45153874158859253
loss_pred:0.0154526736587286, decouple_loss:0.0005457724328152835
The modified gen p mean: 0.45082443952560425, gen p mean: -0.11001753062009811, mean p set: 0.4514019787311554
loss_pred:0.015142747201025486, decouple_loss:0.0006088471855036914
Iteration: 1215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494648873806, gen p mean: -0.10881540924310684, mean p set: 0.4500395953655243
loss_pred:0.01524830050766468, decouple_loss:0.0004187866288702935
The modified gen p mean: 0.45222970843315125, gen p mean: -0.11149635165929794, mean p set: 0.4528064429759979
loss_pred:0.015799332410097122, decouple_loss:0.0005546761094592512
The modified gen p mean: 0.45158594846725464, gen p mean: -0.11116483062505722, mean p set: 0.4521616995334625
loss_pred:0.015944452956318855, decouple_loss:0.0005908975144848228
Iteration: 1216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515475332736969, gen p mean: -0.10515158623456955, mean p set: 0.4521217942237854
loss_pred:0.01724734716117382, decouple_loss:0.0004611069743987173
The modified gen p mean: 0.4523070454597473, gen p mean: -0.09989447891712189, mean p set: 0.4528812766075134
loss_pred:0.016762614250183105, decouple_loss:0.0006998859462328255
The modified gen p mean: 0.4513137936592102, gen p mean: -0.10018310695886612, mean p set: 0.45189085602760315
loss_pred:0.015872197225689888, decouple_loss:0.0007430806872434914
Iteration: 1217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507300555706024, gen p mean: -0.10425936430692673, mean p set: 0.451306015253067
loss_pred:0.017230281606316566, decouple_loss:0.0005149449571035802
The modified gen p mean: 0.4513527750968933, gen p mean: -0.10395758599042892, mean p set: 0.45193058252334595
The modified gen p mean: 0.45347970724105835, gen p mean: -0.10055042803287506, mean p set: 0.45405787229537964
loss_pred:0.01537658553570509, decouple_loss:0.00048123623128049076
loss_pred:0.015960227698087692, decouple_loss:0.0005039406823925674
Iteration: 1218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512309432029724, gen p mean: -0.10480205714702606, mean p set: 0.4518068730831146
loss_pred:0.01608799397945404, decouple_loss:0.000577087514102459
The modified gen p mean: 0.4516492784023285, gen p mean: -0.11421763151884079, mean p set: 0.4522242546081543
loss_pred:0.015105897560715675, decouple_loss:0.0005780665669590235
The modified gen p mean: 0.4533555805683136, gen p mean: -0.09898532181978226, mean p set: 0.4539310038089752
loss_pred:0.015503153204917908, decouple_loss:0.0006448270287364721
Iteration: 1219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511720836162567, gen p mean: -0.10636765509843826, mean p set: 0.4517495334148407
loss_pred:0.0159622635692358, decouple_loss:0.0006329009775072336
The modified gen p mean: 0.4517473578453064, gen p mean: -0.10832089930772781, mean p set: 0.452322781085968
The modified gen p mean: 0.4521767199039459, gen p mean: -0.10705377161502838, mean p set: 0.452752947807312
loss_pred:0.0170338936150074, decouple_loss:0.0007469623815268278
loss_pred:0.016527488827705383, decouple_loss:0.0006192174041643739
Iteration: 1220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997793436050415, gen p mean: -0.10724237561225891, mean p set: 0.45055609941482544
loss_pred:0.016405612230300903, decouple_loss:0.0005294860457070172
The modified gen p mean: 0.45178043842315674, gen p mean: -0.11227386444807053, mean p set: 0.4523584544658661
loss_pred:0.016408076509833336, decouple_loss:0.0005056233494542539
The modified gen p mean: 0.450937420129776, gen p mean: -0.11137059330940247, mean p set: 0.45151403546333313
loss_pred:0.01536868792027235, decouple_loss:0.0007108836434781551
2023-05-02 07:44:05 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12081196904182434, mean p set: 0.4502691626548767
loss_pred:0.01720721647143364, decouple_loss:0.0005137730622664094
The modified gen p mean: 0.44953712821006775, gen p mean: -0.11482862383127213, mean p set: 0.4500633478164673
loss_pred:0.01648452877998352, decouple_loss:0.0005274894647300243
The modified gen p mean: 0.4498295485973358, gen p mean: -0.11376141011714935, mean p set: 0.45035696029663086
loss_pred:0.016629835590720177, decouple_loss:0.0005795222823508084
WV_1_PC_1_EH_0_PS_40, loss: 0.01680087298154831, avg_mse: 0.02619217149913311
current test mse: 0.026192
Iteration: 1221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128917694091797, gen p mean: -0.10629376769065857, mean p set: 0.451865553855896
loss_pred:0.015835663303732872, decouple_loss:0.0006306607974693179
The modified gen p mean: 0.45088431239128113, gen p mean: -0.10320752114057541, mean p set: 0.4514599144458771
loss_pred:0.016117295250296593, decouple_loss:0.0007933997549116611
The modified gen p mean: 0.450150728225708, gen p mean: -0.10412292927503586, mean p set: 0.4507259726524353
loss_pred:0.0156350489705801, decouple_loss:0.0004999051452614367
Iteration: 1222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520874619483948, gen p mean: -0.10967244952917099, mean p set: 0.45266470313072205
loss_pred:0.015356720425188541, decouple_loss:0.00040379303391091526
The modified gen p mean: 0.4511193335056305, gen p mean: -0.10569410771131516, mean p set: 0.4516959488391876The modified gen p mean: 0.45080843567848206, gen p mean: -0.11112897843122482, mean p set: 0.451384037733078
loss_pred:0.015021911822259426, decouple_loss:0.0005916302325204015
loss_pred:0.014640082605183125, decouple_loss:0.0004941022489219904
Iteration: 1223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45209425687789917, gen p mean: -0.11350453644990921, mean p set: 0.45267003774642944
The modified gen p mean: 0.4514455497264862, gen p mean: -0.10507282614707947, mean p set: 0.4520217776298523
loss_pred:0.01638500764966011, decouple_loss:0.0005227876245044172
loss_pred:0.015773706138134003, decouple_loss:0.0005651364917866886
The modified gen p mean: 0.45123910903930664, gen p mean: -0.11822297424077988, mean p set: 0.45181599259376526
loss_pred:0.015676535665988922, decouple_loss:0.0005471362383104861
Iteration: 1224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45181000232696533, gen p mean: -0.11276215314865112, mean p set: 0.4523863196372986
loss_pred:0.014992884360253811, decouple_loss:0.0004975901101715863
The modified gen p mean: 0.4516371786594391, gen p mean: -0.1110907718539238, mean p set: 0.4522145688533783
loss_pred:0.016753582283854485, decouple_loss:0.0006421423167921603
The modified gen p mean: 0.45158541202545166, gen p mean: -0.10820271074771881, mean p set: 0.45216134190559387
loss_pred:0.016094885766506195, decouple_loss:0.0004907971597276628
Iteration: 1225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45131391286849976, gen p mean: -0.11073590815067291, mean p set: 0.45189085602760315
loss_pred:0.015171973034739494, decouple_loss:0.0005526833701878786
The modified gen p mean: 0.45245182514190674, gen p mean: -0.10815674811601639, mean p set: 0.453027606010437
loss_pred:0.014888308942317963, decouple_loss:0.0005908041493967175
The modified gen p mean: 0.45235854387283325, gen p mean: -0.11309190094470978, mean p set: 0.45293402671813965
loss_pred:0.01671574078500271, decouple_loss:0.0005913246423006058
Iteration: 1226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45190152525901794, gen p mean: -0.11443882435560226, mean p set: 0.45247751474380493
loss_pred:0.01623460277915001, decouple_loss:0.0006716653006151319
The modified gen p mean: 0.4522136449813843, gen p mean: -0.10475040972232819, mean p set: 0.45279279351234436
loss_pred:0.01645626313984394, decouple_loss:0.0005640614544972777
The modified gen p mean: 0.4497881829738617, gen p mean: -0.11442919820547104, mean p set: 0.45036500692367554
loss_pred:0.014310297556221485, decouple_loss:0.0004981377860531211
Iteration: 1227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512346088886261, gen p mean: -0.10325811058282852, mean p set: 0.4518103301525116
loss_pred:0.01511904876679182, decouple_loss:0.000440629490185529
The modified gen p mean: 0.4515654146671295, gen p mean: -0.1059907078742981, mean p set: 0.45214059948921204
loss_pred:0.015784336254000664, decouple_loss:0.00047585449647158384
The modified gen p mean: 0.453081339597702, gen p mean: -0.10343487560749054, mean p set: 0.45365968346595764
loss_pred:0.01601005718111992, decouple_loss:0.00043453864054754376
Iteration: 1228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45309674739837646, gen p mean: -0.10876040160655975, mean p set: 0.45367300510406494
loss_pred:0.01685316301882267, decouple_loss:0.00045991441584192216
The modified gen p mean: 0.4499223232269287, gen p mean: -0.1061423122882843, mean p set: 0.45049792528152466
loss_pred:0.015409573912620544, decouple_loss:0.0006732979090884328
The modified gen p mean: 0.45040011405944824, gen p mean: -0.10808522254228592, mean p set: 0.4509764611721039
loss_pred:0.01495059672743082, decouple_loss:0.0007508870912715793
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
NaN value num: 0
Iteration: 1229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45099133253097534, gen p mean: -0.1063203290104866, mean p set: 0.451566606760025
loss_pred:0.016581250354647636, decouple_loss:0.0006216276087798178
The modified gen p mean: 0.45137742161750793, gen p mean: -0.10027589648962021, mean p set: 0.45195385813713074
The modified gen p mean: 0.45181065797805786, gen p mean: -0.09807144850492477, mean p set: 0.4523874819278717
loss_pred:0.014643215574324131, decouple_loss:0.0007486330578103662
loss_pred:0.015351940877735615, decouple_loss:0.0007353792316280305
Iteration: 1230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450490802526474, gen p mean: -0.1149495393037796, mean p set: 0.4510670304298401
loss_pred:0.015270903706550598, decouple_loss:0.0005269026150926948
The modified gen p mean: 0.4536312222480774, gen p mean: -0.10554450005292892, mean p set: 0.45420756936073303
loss_pred:0.015264294110238552, decouple_loss:0.00045600670273415744
The modified gen p mean: 0.45083773136138916, gen p mean: -0.11472195386886597, mean p set: 0.45141491293907166
loss_pred:0.015830023214221, decouple_loss:0.0006542665068991482
2023-05-02 07:46:45 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12456806004047394, mean p set: 0.4502691626548767
loss_pred:0.017122741788625717, decouple_loss:0.0005008045118302107
The modified gen p mean: 0.4495372176170349, gen p mean: -0.11786074191331863, mean p set: 0.4500633478164673
loss_pred:0.01647012121975422, decouple_loss:0.0005155997932888567
The modified gen p mean: 0.4498286247253418, gen p mean: -0.11680467426776886, mean p set: 0.45035696029663086
loss_pred:0.0165972039103508, decouple_loss:0.000500028021633625
WV_1_PC_1_EH_0_PS_40, loss: 0.016755297780036926, avg_mse: 0.026134289801120758
current test mse: 0.026134
Iteration: 1231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506562054157257, gen p mean: -0.11295740306377411, mean p set: 0.45123252272605896
loss_pred:0.0157773420214653, decouple_loss:0.00038658914854750037
The modified gen p mean: 0.4508320689201355, gen p mean: -0.11483167856931686, mean p set: 0.45140859484672546The modified gen p mean: 0.4519920349121094, gen p mean: -0.11662640422582626, mean p set: 0.4525681734085083
loss_pred:0.015490619465708733, decouple_loss:0.0006562038906849921loss_pred:0.016212668269872665, decouple_loss:0.0004609987954609096
Iteration: 1232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521636962890625, gen p mean: -0.1160583347082138, mean p set: 0.4527396559715271
The modified gen p mean: 0.45223599672317505, gen p mean: -0.11425008624792099, mean p set: 0.45281288027763367loss_pred:0.015612215735018253, decouple_loss:0.0006762307020835578
loss_pred:0.016743848100304604, decouple_loss:0.0004968119319528341
The modified gen p mean: 0.4500806927680969, gen p mean: -0.1165187805891037, mean p set: 0.45065951347351074
loss_pred:0.015553743578493595, decouple_loss:0.0005170225631445646
Iteration: 1233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45106884837150574, gen p mean: -0.10791860520839691, mean p set: 0.4516444504261017
The modified gen p mean: 0.4501228630542755, gen p mean: -0.11188500374555588, mean p set: 0.4506986141204834
loss_pred:0.016234874725341797, decouple_loss:0.0005339825293049216
loss_pred:0.015804197639226913, decouple_loss:0.0003735595673788339
The modified gen p mean: 0.45058658719062805, gen p mean: -0.11573498696088791, mean p set: 0.45116284489631653
loss_pred:0.015255686827003956, decouple_loss:0.00045254049473442137
Iteration: 1234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45227718353271484, gen p mean: -0.11045674979686737, mean p set: 0.4528560936450958
loss_pred:0.015387725085020065, decouple_loss:0.0005935102817602456
The modified gen p mean: 0.45071667432785034, gen p mean: -0.10679525882005692, mean p set: 0.4512914717197418
loss_pred:0.015630872920155525, decouple_loss:0.0005190209485590458
The modified gen p mean: 0.45258578658103943, gen p mean: -0.1070191040635109, mean p set: 0.4531611502170563
loss_pred:0.01586579903960228, decouple_loss:0.0004924250533804297
Iteration: 1235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44998204708099365, gen p mean: -0.11628883332014084, mean p set: 0.45055627822875977
loss_pred:0.015679242089390755, decouple_loss:0.000627306173555553
The modified gen p mean: 0.44987422227859497, gen p mean: -0.11489342153072357, mean p set: 0.45045205950737
loss_pred:0.015389185398817062, decouple_loss:0.0005261043552309275
The modified gen p mean: 0.4504953622817993, gen p mean: -0.11412503570318222, mean p set: 0.4510722756385803
loss_pred:0.01617659069597721, decouple_loss:0.0004934326861985028
Iteration: 1236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45087283849716187, gen p mean: -0.10681161284446716, mean p set: 0.45144933462142944
loss_pred:0.014711852185428143, decouple_loss:0.000545418995898217
The modified gen p mean: 0.45144668221473694, gen p mean: -0.10989605635404587, mean p set: 0.4520217776298523
The modified gen p mean: 0.45021453499794006, gen p mean: -0.12170178443193436, mean p set: 0.45079126954078674
loss_pred:0.015028142370283604, decouple_loss:0.00047398070455528796
loss_pred:0.015172691084444523, decouple_loss:0.0004182903503533453
Iteration: 1237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498738944530487, gen p mean: -0.12082602083683014, mean p set: 0.4504498541355133
loss_pred:0.015575988218188286, decouple_loss:0.0004010125994682312
The modified gen p mean: 0.452097088098526, gen p mean: -0.1197582557797432, mean p set: 0.45267269015312195
loss_pred:0.014906248077750206, decouple_loss:0.0003946301294490695
The modified gen p mean: 0.45080092549324036, gen p mean: -0.12213843315839767, mean p set: 0.4513775408267975
loss_pred:0.01479625329375267, decouple_loss:0.0005030818865634501
Iteration: 1238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44988247752189636, gen p mean: -0.12135804444551468, mean p set: 0.450456827878952
loss_pred:0.01630249246954918, decouple_loss:0.00041506747948005795
The modified gen p mean: 0.45019206404685974, gen p mean: -0.12507839500904083, mean p set: 0.4507681429386139
loss_pred:0.015025878325104713, decouple_loss:0.0004314750840421766
The modified gen p mean: 0.4500141441822052, gen p mean: -0.12206479161977768, mean p set: 0.4505917727947235
loss_pred:0.01516131404787302, decouple_loss:0.0005434161867015064
Iteration: 1239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037004351615906, gen p mean: -0.11790134012699127, mean p set: 0.4509464502334595
loss_pred:0.01502643246203661, decouple_loss:0.0006029795040376484
The modified gen p mean: 0.4499721825122833, gen p mean: -0.12429934740066528, mean p set: 0.4505482017993927
loss_pred:0.015646236017346382, decouple_loss:0.00051800039364025
The modified gen p mean: 0.4520737826824188, gen p mean: -0.12341038137674332, mean p set: 0.4526509940624237
loss_pred:0.016396937891840935, decouple_loss:0.0005381011869758368
Iteration: 1240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509156048297882, gen p mean: -0.11837441474199295, mean p set: 0.45149174332618713
loss_pred:0.015055319294333458, decouple_loss:0.00044964748667553067
The modified gen p mean: 0.45028263330459595, gen p mean: -0.12509587407112122, mean p set: 0.45086002349853516
The modified gen p mean: 0.45017698407173157, gen p mean: -0.12423858791589737, mean p set: 0.450752317905426
loss_pred:0.015933429822325706, decouple_loss:0.0004139640659559518
loss_pred:0.014675158075988293, decouple_loss:0.0004651227791327983
2023-05-02 07:48:52 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12866458296775818, mean p set: 0.4502691626548767
loss_pred:0.017034465447068214, decouple_loss:0.0005005326820537448
The modified gen p mean: 0.4495325982570648, gen p mean: -0.12292324006557465, mean p set: 0.4500633478164673
loss_pred:0.01629805564880371, decouple_loss:0.0005207924405112863
The modified gen p mean: 0.44983261823654175, gen p mean: -0.12144733965396881, mean p set: 0.45035696029663086
loss_pred:0.016589371487498283, decouple_loss:0.00045061897253617644
WV_1_PC_1_EH_0_PS_40, loss: 0.01666516438126564, avg_mse: 0.025969335809350014
current test mse: 0.025969
Iteration: 1241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505651593208313, gen p mean: -0.12120948731899261, mean p set: 0.45114099979400635
loss_pred:0.015195850282907486, decouple_loss:0.00047704202006570995
The modified gen p mean: 0.4502074718475342, gen p mean: -0.1232215017080307, mean p set: 0.45078444480895996The modified gen p mean: 0.45031192898750305, gen p mean: -0.12055213004350662, mean p set: 0.4508858919143677
loss_pred:0.015572717413306236, decouple_loss:0.0004793709085788578
loss_pred:0.01516406238079071, decouple_loss:0.0004777630092576146
Iteration: 1242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489203691482544, gen p mean: -0.11867083609104156, mean p set: 0.4494965374469757
loss_pred:0.015558882616460323, decouple_loss:0.0004319665895309299
The modified gen p mean: 0.45212599635124207, gen p mean: -0.11774644255638123, mean p set: 0.4527009129524231The modified gen p mean: 0.45049721002578735, gen p mean: -0.12138456851243973, mean p set: 0.45107343792915344
loss_pred:0.014746580272912979, decouple_loss:0.0004706610052380711
loss_pred:0.015139861032366753, decouple_loss:0.0004619496176019311
Iteration: 1243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45177972316741943, gen p mean: -0.10933040827512741, mean p set: 0.4523571729660034
loss_pred:0.015075968578457832, decouple_loss:0.0004562657850328833
The modified gen p mean: 0.4500632882118225, gen p mean: -0.11734043061733246, mean p set: 0.4506409764289856
loss_pred:0.014877177774906158, decouple_loss:0.0005967540782876313
The modified gen p mean: 0.45379766821861267, gen p mean: -0.11509399116039276, mean p set: 0.45437467098236084
loss_pred:0.015017491765320301, decouple_loss:0.000564242189284414
Iteration: 1244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507546126842499, gen p mean: -0.11524496227502823, mean p set: 0.45133084058761597
loss_pred:0.015368591994047165, decouple_loss:0.0004403428465593606
The modified gen p mean: 0.45114216208457947, gen p mean: -0.1132182851433754, mean p set: 0.45171812176704407
loss_pred:0.015649262815713882, decouple_loss:0.00040335144149139524
The modified gen p mean: 0.4494932293891907, gen p mean: -0.11171509325504303, mean p set: 0.4500705301761627
loss_pred:0.0157712884247303, decouple_loss:0.0005002192920073867
Iteration: 1245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45205992460250854, gen p mean: -0.10995344817638397, mean p set: 0.452638179063797
loss_pred:0.015893300995230675, decouple_loss:0.0005743164801970124
The modified gen p mean: 0.4504753649234772, gen p mean: -0.11832628399133682, mean p set: 0.45105183124542236
loss_pred:0.01580577716231346, decouple_loss:0.00046702619874849916
The modified gen p mean: 0.4524341821670532, gen p mean: -0.11501403152942657, mean p set: 0.45301249623298645
loss_pred:0.015067837201058865, decouple_loss:0.0006060391897335649
Iteration: 1246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45075753331184387, gen p mean: -0.11205873638391495, mean p set: 0.45133426785469055
loss_pred:0.015550569631159306, decouple_loss:0.00047035267925821245
The modified gen p mean: 0.44999825954437256, gen p mean: -0.11350385844707489, mean p set: 0.4505741000175476
loss_pred:0.0156016880646348, decouple_loss:0.0005182042950764298
The modified gen p mean: 0.4505617618560791, gen p mean: -0.11400453001260757, mean p set: 0.4511401653289795
loss_pred:0.015721360221505165, decouple_loss:0.0006418180419132113
Iteration: 1247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524085819721222, gen p mean: -0.10702744871377945, mean p set: 0.4529861509799957
loss_pred:0.015568621456623077, decouple_loss:0.0006968025118112564
The modified gen p mean: 0.45341920852661133, gen p mean: -0.11108370870351791, mean p set: 0.453996479511261
The modified gen p mean: 0.4498785138130188, gen p mean: -0.11459256708621979, mean p set: 0.4504525363445282
loss_pred:0.01495377067476511, decouple_loss:0.0006805034936405718
loss_pred:0.015491736121475697, decouple_loss:0.0004070861905347556
Iteration: 1248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44964319467544556, gen p mean: -0.11340434849262238, mean p set: 0.4502184987068176
loss_pred:0.015327506698668003, decouple_loss:0.000533250451553613
The modified gen p mean: 0.44986891746520996, gen p mean: -0.11026447266340256, mean p set: 0.45044317841529846
The modified gen p mean: 0.45210906863212585, gen p mean: -0.10555194318294525, mean p set: 0.4526849389076233
loss_pred:0.015630530193448067, decouple_loss:0.00072829908458516
loss_pred:0.015631409361958504, decouple_loss:0.0007301990408450365
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 1249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44946712255477905, gen p mean: -0.11644283682107925, mean p set: 0.4500423073768616
The modified gen p mean: 0.4493192732334137, gen p mean: -0.11974973231554031, mean p set: 0.4498968720436096
loss_pred:0.015343527309596539, decouple_loss:0.0006326413131318986
loss_pred:0.013919079676270485, decouple_loss:0.00048618222353979945
The modified gen p mean: 0.4490082859992981, gen p mean: -0.11920709162950516, mean p set: 0.44958579540252686
loss_pred:0.01507672667503357, decouple_loss:0.00046808013576082885
Iteration: 1250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890719652175903, gen p mean: -0.12494413554668427, mean p set: 0.4494830369949341
loss_pred:0.014435476623475552, decouple_loss:0.0005501777050085366
The modified gen p mean: 0.44890791177749634, gen p mean: -0.12732146680355072, mean p set: 0.4494844079017639
The modified gen p mean: 0.44935211539268494, gen p mean: -0.12071932852268219, mean p set: 0.4499257802963257
loss_pred:0.015231841243803501, decouple_loss:0.0004702983424067497
loss_pred:0.014849109575152397, decouple_loss:0.0005031489999964833
2023-05-02 07:51:37 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1259962022304535, mean p set: 0.4502691626548767
loss_pred:0.01699952408671379, decouple_loss:0.00042660560575313866
The modified gen p mean: 0.4495373070240021, gen p mean: -0.11956421285867691, mean p set: 0.4500633478164673
loss_pred:0.016235295683145523, decouple_loss:0.00046372483484447
The modified gen p mean: 0.4498293995857239, gen p mean: -0.11838799715042114, mean p set: 0.45035696029663086
loss_pred:0.016546083614230156, decouple_loss:0.000525573967024684
WV_1_PC_1_EH_0_PS_40, loss: 0.01661723293364048, avg_mse: 0.02593931555747986
current test mse: 0.025939
Iteration: 1251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44865891337394714, gen p mean: -0.1157941147685051, mean p set: 0.4492337107658386
loss_pred:0.014400511980056763, decouple_loss:0.0004144040576647967
The modified gen p mean: 0.4497559368610382, gen p mean: -0.12003281712532043, mean p set: 0.4503350555896759The modified gen p mean: 0.44877612590789795, gen p mean: -0.1240948811173439, mean p set: 0.4493516683578491
loss_pred:0.014698021113872528, decouple_loss:0.000677955336868763loss_pred:0.01563398540019989, decouple_loss:0.0005389607395045459
Iteration: 1252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44991543889045715, gen p mean: -0.12224555015563965, mean p set: 0.4504936933517456
The modified gen p mean: 0.44714638590812683, gen p mean: -0.12264258414506912, mean p set: 0.4477207064628601
loss_pred:0.013714744709432125, decouple_loss:0.0005101835704408586
loss_pred:0.014582774601876736, decouple_loss:0.0005785283865407109
The modified gen p mean: 0.45032280683517456, gen p mean: -0.12643961608409882, mean p set: 0.4508989155292511
loss_pred:0.013890480622649193, decouple_loss:0.00043983987416140735
Iteration: 1253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448355108499527, gen p mean: -0.12396497279405594, mean p set: 0.4489321708679199
The modified gen p mean: 0.4501100182533264, gen p mean: -0.1273159235715866, mean p set: 0.4506858289241791
loss_pred:0.01466350071132183, decouple_loss:0.0003646782133728266
loss_pred:0.014354882761836052, decouple_loss:0.0006789336330257356
The modified gen p mean: 0.45014792680740356, gen p mean: -0.12476197630167007, mean p set: 0.4507233798503876
loss_pred:0.014690674841403961, decouple_loss:0.0006263891700655222
Iteration: 1254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997477531433105, gen p mean: -0.12921728193759918, mean p set: 0.4505492150783539
loss_pred:0.01400280836969614, decouple_loss:0.00043599758646450937
The modified gen p mean: 0.45044195652008057, gen p mean: -0.12650974094867706, mean p set: 0.4510194957256317
loss_pred:0.014097122475504875, decouple_loss:0.00036703795194625854
The modified gen p mean: 0.4496009051799774, gen p mean: -0.13037796318531036, mean p set: 0.45017769932746887
loss_pred:0.014139486476778984, decouple_loss:0.0004064173554070294
Iteration: 1255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44955843687057495, gen p mean: -0.1294301152229309, mean p set: 0.4501335322856903
loss_pred:0.014082038775086403, decouple_loss:0.0005363882519304752
The modified gen p mean: 0.4501260221004486, gen p mean: -0.12890231609344482, mean p set: 0.4507005214691162
loss_pred:0.01373919565230608, decouple_loss:0.0005684713833034039
The modified gen p mean: 0.44821637868881226, gen p mean: -0.12390950322151184, mean p set: 0.4487907588481903
loss_pred:0.01475790236145258, decouple_loss:0.0005620622541755438
Iteration: 1256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494163990020752, gen p mean: -0.12093749642372131, mean p set: 0.4499913156032562
loss_pred:0.014087991788983345, decouple_loss:0.000527100870385766
The modified gen p mean: 0.4496035873889923, gen p mean: -0.12085453420877457, mean p set: 0.4501778185367584
loss_pred:0.014650686644017696, decouple_loss:0.0005063765565864742
The modified gen p mean: 0.4503445327281952, gen p mean: -0.12243375182151794, mean p set: 0.4509190618991852
loss_pred:0.014712207950651646, decouple_loss:0.00044323099427856505
Iteration: 1257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488382935523987, gen p mean: -0.12127354741096497, mean p set: 0.4494141638278961
loss_pred:0.015172583982348442, decouple_loss:0.00038632730138488114
The modified gen p mean: 0.4488144516944885, gen p mean: -0.12418162077665329, mean p set: 0.44939103722572327
loss_pred:0.014662209898233414, decouple_loss:0.000399744079913944
The modified gen p mean: 0.44934526085853577, gen p mean: -0.1284354031085968, mean p set: 0.4499218463897705
loss_pred:0.014660865068435669, decouple_loss:0.0005143856978975236
Iteration: 1258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018622279167175, gen p mean: -0.12301167845726013, mean p set: 0.45076262950897217
loss_pred:0.01372009702026844, decouple_loss:0.0004962743259966373
The modified gen p mean: 0.44922298192977905, gen p mean: -0.1231161430478096, mean p set: 0.4497992694377899
loss_pred:0.014192194677889347, decouple_loss:0.0004914767923764884
The modified gen p mean: 0.4492340385913849, gen p mean: -0.12255318462848663, mean p set: 0.4498126208782196
loss_pred:0.014252787455916405, decouple_loss:0.0005803057574667037
Iteration: 1259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45035088062286377, gen p mean: -0.1179276704788208, mean p set: 0.45092666149139404
loss_pred:0.014254237525165081, decouple_loss:0.0005634739063680172
The modified gen p mean: 0.4478610157966614, gen p mean: -0.1214379295706749, mean p set: 0.44843724370002747
loss_pred:0.014324724674224854, decouple_loss:0.0005347352707758546
The modified gen p mean: 0.4506770670413971, gen p mean: -0.11406772583723068, mean p set: 0.4512515664100647
loss_pred:0.014300639741122723, decouple_loss:0.0004240333801135421
Iteration: 1260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489573538303375, gen p mean: -0.1099180355668068, mean p set: 0.44953563809394836
loss_pred:0.014459338039159775, decouple_loss:0.0005563446902669966
The modified gen p mean: 0.44743287563323975, gen p mean: -0.11050227284431458, mean p set: 0.448009192943573
loss_pred:0.014129338786005974, decouple_loss:0.0004143640398979187
The modified gen p mean: 0.4504980146884918, gen p mean: -0.11663258075714111, mean p set: 0.4510750472545624
loss_pred:0.014576421119272709, decouple_loss:0.0004631085030268878
2023-05-02 07:53:44 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12186241894960403, mean p set: 0.4502691626548767
loss_pred:0.016990523785352707, decouple_loss:0.0004752706445287913
The modified gen p mean: 0.4495360553264618, gen p mean: -0.11577489227056503, mean p set: 0.4500633478164673
loss_pred:0.016306325793266296, decouple_loss:0.0005703723290935159
The modified gen p mean: 0.44982731342315674, gen p mean: -0.11458911001682281, mean p set: 0.45035696029663086
loss_pred:0.016589157283306122, decouple_loss:0.0005052916239947081
WV_1_PC_1_EH_0_PS_40, loss: 0.016654519364237785, avg_mse: 0.02600882574915886
current test mse: 0.026009
Iteration: 1261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44897615909576416, gen p mean: -0.1215084120631218, mean p set: 0.4495563805103302
loss_pred:0.014791116118431091, decouple_loss:0.0004886378301307559
The modified gen p mean: 0.4491303861141205, gen p mean: -0.11701400578022003, mean p set: 0.449707955121994
loss_pred:0.014567210339009762, decouple_loss:0.0004833606362808496
The modified gen p mean: 0.45002201199531555, gen p mean: -0.11767669767141342, mean p set: 0.4505973160266876
loss_pred:0.014377409592270851, decouple_loss:0.0007286464679054916
Iteration: 1262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019078254699707, gen p mean: -0.11434388160705566, mean p set: 0.4507656991481781
loss_pred:0.014087362214922905, decouple_loss:0.000502965587656945
The modified gen p mean: 0.4498150050640106, gen p mean: -0.11493095010519028, mean p set: 0.4503912329673767The modified gen p mean: 0.4476420283317566, gen p mean: -0.11072594672441483, mean p set: 0.4482172131538391
loss_pred:0.013208532705903053, decouple_loss:0.000524533330462873loss_pred:0.014322135597467422, decouple_loss:0.00046222860692068934
Iteration: 1263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481560289859772, gen p mean: -0.12000101804733276, mean p set: 0.44873154163360596
loss_pred:0.014109630137681961, decouple_loss:0.00035694235702976584
The modified gen p mean: 0.4504825174808502, gen p mean: -0.11498803645372391, mean p set: 0.45106109976768494The modified gen p mean: 0.4488266706466675, gen p mean: -0.1155153289437294, mean p set: 0.4494022727012634
loss_pred:0.013536939397454262, decouple_loss:0.0003774261858779937
loss_pred:0.015060607343912125, decouple_loss:0.0003689620061777532
Iteration: 1264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471074342727661, gen p mean: -0.11537779122591019, mean p set: 0.4476839303970337
loss_pred:0.01438318844884634, decouple_loss:0.00041321240132674575
The modified gen p mean: 0.44867563247680664, gen p mean: -0.11146832257509232, mean p set: 0.4492511451244354
loss_pred:0.015526275150477886, decouple_loss:0.0006094843847677112
The modified gen p mean: 0.44930964708328247, gen p mean: -0.12206560373306274, mean p set: 0.4498860538005829
loss_pred:0.014977902173995972, decouple_loss:0.00042622850742191076
Iteration: 1265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891467690467834, gen p mean: -0.11113397032022476, mean p set: 0.44949066638946533
loss_pred:0.014519885182380676, decouple_loss:0.00041681129368953407
The modified gen p mean: 0.4485282897949219, gen p mean: -0.11233087629079819, mean p set: 0.4491027593612671
loss_pred:0.014477819204330444, decouple_loss:0.00036097405245527625
The modified gen p mean: 0.4482736587524414, gen p mean: -0.1208287850022316, mean p set: 0.44884857535362244
loss_pred:0.014592226594686508, decouple_loss:0.0004855951410718262
Iteration: 1266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493238627910614, gen p mean: -0.11548755317926407, mean p set: 0.4499005675315857
loss_pred:0.014333569444715977, decouple_loss:0.0005442739930003881
The modified gen p mean: 0.4474221169948578, gen p mean: -0.1111806184053421, mean p set: 0.4479977786540985
loss_pred:0.014157712459564209, decouple_loss:0.0005571904475800693
The modified gen p mean: 0.4483145475387573, gen p mean: -0.11076311022043228, mean p set: 0.44889214634895325
loss_pred:0.014349439181387424, decouple_loss:0.0005060629919171333
Iteration: 1267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982975721359253, gen p mean: -0.11551894247531891, mean p set: 0.450408935546875
loss_pred:0.013919243589043617, decouple_loss:0.00043342795106582344
The modified gen p mean: 0.4490564465522766, gen p mean: -0.1200559139251709, mean p set: 0.4496326744556427
loss_pred:0.014322062954306602, decouple_loss:0.00033962971065193415
The modified gen p mean: 0.44949522614479065, gen p mean: -0.11379406601190567, mean p set: 0.45007139444351196
loss_pred:0.014881103299558163, decouple_loss:0.0004337817372288555
Iteration: 1268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45006752014160156, gen p mean: -0.1174667477607727, mean p set: 0.45064398646354675
loss_pred:0.013231980614364147, decouple_loss:0.00043988251127302647
The modified gen p mean: 0.4502466022968292, gen p mean: -0.11363857984542847, mean p set: 0.4508228898048401
loss_pred:0.01374405063688755, decouple_loss:0.0003797463432420045
The modified gen p mean: 0.44778546690940857, gen p mean: -0.11357111483812332, mean p set: 0.44835996627807617
loss_pred:0.015242502093315125, decouple_loss:0.0004235219385009259
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463445842266083, gen p mean: -0.11968353390693665, mean p set: 0.44692057371139526
The modified gen p mean: 0.4464557468891144, gen p mean: -0.11997179687023163, mean p set: 0.44703078269958496
loss_pred:0.014745141379535198, decouple_loss:0.0006161226774565876
loss_pred:0.014828547835350037, decouple_loss:0.0005420446395874023
The modified gen p mean: 0.44708237051963806, gen p mean: -0.11415190994739532, mean p set: 0.44765836000442505
loss_pred:0.01580999046564102, decouple_loss:0.0005380829097703099
Iteration: 1270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468766450881958, gen p mean: -0.11757605522871017, mean p set: 0.44745346903800964
loss_pred:0.015675455331802368, decouple_loss:0.0005017329240217805
The modified gen p mean: 0.4481818675994873, gen p mean: -0.11718301475048065, mean p set: 0.44875821471214294
loss_pred:0.015460972674190998, decouple_loss:0.0005448898882605135
The modified gen p mean: 0.447479248046875, gen p mean: -0.12725965678691864, mean p set: 0.448056697845459
loss_pred:0.014864148572087288, decouple_loss:0.000425789097789675
2023-05-02 07:56:24 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11899024248123169, mean p set: 0.4502691626548767
loss_pred:0.01691616326570511, decouple_loss:0.00040119519690051675
The modified gen p mean: 0.44953447580337524, gen p mean: -0.11294834315776825, mean p set: 0.4500633478164673
loss_pred:0.0162582416087389, decouple_loss:0.0003805944579653442
The modified gen p mean: 0.4498278796672821, gen p mean: -0.11234436184167862, mean p set: 0.45035696029663086
loss_pred:0.016531994566321373, decouple_loss:0.0003694221959449351
WV_1_PC_1_EH_0_PS_40, loss: 0.016587987542152405, avg_mse: 0.025919215753674507
current test mse: 0.025919
Iteration: 1271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469412565231323, gen p mean: -0.11381363868713379, mean p set: 0.447516530752182
loss_pred:0.015323862433433533, decouple_loss:0.00037348284968174994
The modified gen p mean: 0.44757962226867676, gen p mean: -0.12025949358940125, mean p set: 0.4481556713581085The modified gen p mean: 0.4472799003124237, gen p mean: -0.1193108931183815, mean p set: 0.44785624742507935
loss_pred:0.01478629745543003, decouple_loss:0.0003694354381877929loss_pred:0.014446032233536243, decouple_loss:0.00040128722321242094
Iteration: 1272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682222604751587, gen p mean: -0.11860927194356918, mean p set: 0.44739779829978943
loss_pred:0.014802122488617897, decouple_loss:0.0006837026448920369
The modified gen p mean: 0.4491514265537262, gen p mean: -0.11283280700445175, mean p set: 0.44973060488700867The modified gen p mean: 0.4475913643836975, gen p mean: -0.11304090917110443, mean p set: 0.4481663107872009
loss_pred:0.014974897727370262, decouple_loss:0.0005703927599824965
loss_pred:0.015504454262554646, decouple_loss:0.0004824081261176616
Iteration: 1273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470479190349579, gen p mean: -0.113302081823349, mean p set: 0.44762295484542847
loss_pred:0.014733263291418552, decouple_loss:0.0005298952455632389
The modified gen p mean: 0.4475773274898529, gen p mean: -0.11067770421504974, mean p set: 0.44815176725387573
loss_pred:0.014681525528430939, decouple_loss:0.0005560840363614261
The modified gen p mean: 0.44907310605049133, gen p mean: -0.1092471033334732, mean p set: 0.44964826107025146
loss_pred:0.014977731741964817, decouple_loss:0.00040642457315698266
Iteration: 1274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44603776931762695, gen p mean: -0.11426803469657898, mean p set: 0.4466158449649811
loss_pred:0.014552573673427105, decouple_loss:0.00042586843483150005
The modified gen p mean: 0.4464093744754791, gen p mean: -0.11392617225646973, mean p set: 0.4469849467277527
loss_pred:0.014561174437403679, decouple_loss:0.0003562378988135606
The modified gen p mean: 0.4453648030757904, gen p mean: -0.11273371428251266, mean p set: 0.44594070315361023
loss_pred:0.014461361803114414, decouple_loss:0.0004335875855758786
Iteration: 1275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776466488838196, gen p mean: -0.11776596307754517, mean p set: 0.44834285974502563
loss_pred:0.015018247067928314, decouple_loss:0.0006555984145961702
The modified gen p mean: 0.4486721158027649, gen p mean: -0.11880407482385635, mean p set: 0.44924843311309814
loss_pred:0.014991940930485725, decouple_loss:0.0005278955795802176
The modified gen p mean: 0.44692304730415344, gen p mean: -0.11510124057531357, mean p set: 0.44750016927719116
loss_pred:0.01601499691605568, decouple_loss:0.000547792122233659
Iteration: 1276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795042276382446, gen p mean: -0.11977019160985947, mean p set: 0.4485260546207428
loss_pred:0.01485778670758009, decouple_loss:0.0005242049810476601
The modified gen p mean: 0.44689249992370605, gen p mean: -0.12430024147033691, mean p set: 0.4474697411060333
The modified gen p mean: 0.4472598433494568, gen p mean: -0.12028731405735016, mean p set: 0.44783279299736023
loss_pred:0.014776800759136677, decouple_loss:0.0004752645909320563
loss_pred:0.014772137627005577, decouple_loss:0.0005030899774283171
Iteration: 1277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478825032711029, gen p mean: -0.12296569347381592, mean p set: 0.44845691323280334
loss_pred:0.014890636317431927, decouple_loss:0.0004549858276732266
The modified gen p mean: 0.4477217197418213, gen p mean: -0.1266501396894455, mean p set: 0.44829845428466797
The modified gen p mean: 0.44655734300613403, gen p mean: -0.12502531707286835, mean p set: 0.4471312463283539
loss_pred:0.014237289316952229, decouple_loss:0.00043129888945259154
loss_pred:0.014341314323246479, decouple_loss:0.0004540802037809044
Iteration: 1278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468269944190979, gen p mean: -0.12528102099895477, mean p set: 0.44740432500839233
loss_pred:0.014591963030397892, decouple_loss:0.00043415665277279913
The modified gen p mean: 0.44641873240470886, gen p mean: -0.12355285882949829, mean p set: 0.4469926357269287
The modified gen p mean: 0.4474377930164337, gen p mean: -0.1195947527885437, mean p set: 0.4480137526988983
loss_pred:0.014900055713951588, decouple_loss:0.0005011385073885322
loss_pred:0.014820014126598835, decouple_loss:0.0005291847628541291
Iteration: 1279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466418921947479, gen p mean: -0.12095797061920166, mean p set: 0.4472208023071289
loss_pred:0.015078340657055378, decouple_loss:0.0004930982831865549
The modified gen p mean: 0.4469347596168518, gen p mean: -0.12318043410778046, mean p set: 0.4475100040435791
loss_pred:0.014157218858599663, decouple_loss:0.00033727294066920877
The modified gen p mean: 0.4483475387096405, gen p mean: -0.11815536767244339, mean p set: 0.44892388582229614
loss_pred:0.015366259962320328, decouple_loss:0.0005604699836112559
Iteration: 1280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462384283542633, gen p mean: -0.1153828501701355, mean p set: 0.44681257009506226
loss_pred:0.014382460154592991, decouple_loss:0.00041943788528442383
The modified gen p mean: 0.44714292883872986, gen p mean: -0.11584200710058212, mean p set: 0.44771912693977356
loss_pred:0.014610955491662025, decouple_loss:0.0005325173260644078
The modified gen p mean: 0.44543489813804626, gen p mean: -0.11760765314102173, mean p set: 0.4460061490535736
loss_pred:0.014712854288518429, decouple_loss:0.0005433958140201867
2023-05-02 07:58:30 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12017863243818283, mean p set: 0.4502691626548767
loss_pred:0.017028477042913437, decouple_loss:0.0007658983231522143
The modified gen p mean: 0.44953617453575134, gen p mean: -0.11425002664327621, mean p set: 0.4500633478164673
loss_pred:0.01622524857521057, decouple_loss:0.0006138893077149987
The modified gen p mean: 0.4498283565044403, gen p mean: -0.11357156932353973, mean p set: 0.45035696029663086
loss_pred:0.016649167984724045, decouple_loss:0.0006044378387741745
WV_1_PC_1_EH_0_PS_40, loss: 0.01666736975312233, avg_mse: 0.026004942134022713
current test mse: 0.026005
Iteration: 1281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868069887161255, gen p mean: -0.11866749823093414, mean p set: 0.4492546021938324
loss_pred:0.01486386451870203, decouple_loss:0.0006970364484004676
The modified gen p mean: 0.4467110335826874, gen p mean: -0.11981157958507538, mean p set: 0.4472857117652893
loss_pred:0.014426485635340214, decouple_loss:0.0005554425297304988
The modified gen p mean: 0.44727492332458496, gen p mean: -0.11833427846431732, mean p set: 0.4478478729724884
loss_pred:0.014334561303257942, decouple_loss:0.0005162617890164256
Iteration: 1282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44621366262435913, gen p mean: -0.118348129093647, mean p set: 0.44678959250450134
The modified gen p mean: 0.4464583098888397, gen p mean: -0.11914372444152832, mean p set: 0.4470318555831909
loss_pred:0.014397972263395786, decouple_loss:0.0004549220611806959
loss_pred:0.014650599099695683, decouple_loss:0.0003691400052048266
The modified gen p mean: 0.44679704308509827, gen p mean: -0.11744149774312973, mean p set: 0.4473719894886017
loss_pred:0.01503077894449234, decouple_loss:0.00039169806404970586
Iteration: 1283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817647337913513, gen p mean: -0.11619847267866135, mean p set: 0.44875115156173706
loss_pred:0.015098811127245426, decouple_loss:0.0007163406698964536
The modified gen p mean: 0.44651809334754944, gen p mean: -0.116268090903759, mean p set: 0.44709280133247375
loss_pred:0.014533661305904388, decouple_loss:0.00047739301226101816
The modified gen p mean: 0.44698619842529297, gen p mean: -0.11682248115539551, mean p set: 0.4475601017475128
loss_pred:0.014975926838815212, decouple_loss:0.000446238846052438
Iteration: 1284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660818576812744, gen p mean: -0.12261901795864105, mean p set: 0.44718244671821594
loss_pred:0.014507753774523735, decouple_loss:0.0003358015383128077
The modified gen p mean: 0.44730037450790405, gen p mean: -0.11659558117389679, mean p set: 0.44787725806236267
loss_pred:0.015482448972761631, decouple_loss:0.00047103711403906345
The modified gen p mean: 0.4465411603450775, gen p mean: -0.12219061702489853, mean p set: 0.4471190571784973
loss_pred:0.014205624349415302, decouple_loss:0.00037614430766552687
Iteration: 1285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460507929325104, gen p mean: -0.12358556687831879, mean p set: 0.4466286599636078
loss_pred:0.014559241943061352, decouple_loss:0.0004542961250990629
The modified gen p mean: 0.44631651043891907, gen p mean: -0.12359653413295746, mean p set: 0.4468908905982971
The modified gen p mean: 0.44739076495170593, gen p mean: -0.12315313518047333, mean p set: 0.447966605424881
loss_pred:0.014396186918020248, decouple_loss:0.0003951713442802429
loss_pred:0.0143928537145257, decouple_loss:0.0003923271142411977
Iteration: 1286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463590979576111, gen p mean: -0.12315038591623306, mean p set: 0.44693562388420105
loss_pred:0.01446747686713934, decouple_loss:0.0004061012587044388
The modified gen p mean: 0.44575995206832886, gen p mean: -0.12603424489498138, mean p set: 0.4463326036930084
The modified gen p mean: 0.44777342677116394, gen p mean: -0.12293188273906708, mean p set: 0.44834670424461365
loss_pred:0.014181198552250862, decouple_loss:0.0003861855366267264
loss_pred:0.01505137886852026, decouple_loss:0.0003446423215791583
Iteration: 1287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454312026500702, gen p mean: -0.12551000714302063, mean p set: 0.44600710272789
loss_pred:0.01472500991076231, decouple_loss:0.0005094105727039278
The modified gen p mean: 0.44659191370010376, gen p mean: -0.1223420649766922, mean p set: 0.4471677839756012
The modified gen p mean: 0.448064386844635, gen p mean: -0.11944650858640671, mean p set: 0.44864004850387573
loss_pred:0.014401466585695744, decouple_loss:0.0006298362859524786
loss_pred:0.015180773101747036, decouple_loss:0.000558790285140276
Iteration: 1288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728970527648926, gen p mean: -0.1275884211063385, mean p set: 0.44786328077316284
loss_pred:0.014030440710484982, decouple_loss:0.0005561099969781935
The modified gen p mean: 0.4470084309577942, gen p mean: -0.132149800658226, mean p set: 0.4475838840007782
The modified gen p mean: 0.44719547033309937, gen p mean: -0.13120779395103455, mean p set: 0.44777220487594604
loss_pred:0.014696909114718437, decouple_loss:0.00041387672536075115
loss_pred:0.014613863080739975, decouple_loss:0.0003816506650764495
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 1289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470595121383667, gen p mean: -0.1255791336297989, mean p set: 0.4476362466812134
loss_pred:0.015587853267788887, decouple_loss:0.0005520422128029168
The modified gen p mean: 0.44963258504867554, gen p mean: -0.12803983688354492, mean p set: 0.450207382440567
The modified gen p mean: 0.4473831355571747, gen p mean: -0.12698081135749817, mean p set: 0.4479579031467438
loss_pred:0.014181702397763729, decouple_loss:0.00048406177666038275
loss_pred:0.01486376766115427, decouple_loss:0.0005260793841443956
Iteration: 1290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483290910720825, gen p mean: -0.11915311217308044, mean p set: 0.4489034116268158
loss_pred:0.01448778621852398, decouple_loss:0.00040818407433107495
The modified gen p mean: 0.44784170389175415, gen p mean: -0.11661206185817719, mean p set: 0.44841691851615906
The modified gen p mean: 0.44849300384521484, gen p mean: -0.12236242741346359, mean p set: 0.4490686058998108
loss_pred:0.014176834374666214, decouple_loss:0.00045508728362619877
loss_pred:0.015129458159208298, decouple_loss:0.0005687776138074696
2023-05-02 08:01:10 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12164010852575302, mean p set: 0.4502691626548767
loss_pred:0.016891105100512505, decouple_loss:0.0005376006592996418
The modified gen p mean: 0.44953393936157227, gen p mean: -0.11551395058631897, mean p set: 0.4500633478164673
loss_pred:0.016157953068614006, decouple_loss:0.000520703848451376
The modified gen p mean: 0.4498295485973358, gen p mean: -0.11485163122415543, mean p set: 0.45035696029663086
loss_pred:0.016541441902518272, decouple_loss:0.0006295088678598404
WV_1_PC_1_EH_0_PS_40, loss: 0.016558296978473663, avg_mse: 0.02593524381518364
current test mse: 0.025935
Iteration: 1291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934505224227905, gen p mean: -0.11624269932508469, mean p set: 0.44992080330848694
loss_pred:0.015520207583904266, decouple_loss:0.0006859469576738775
The modified gen p mean: 0.44987326860427856, gen p mean: -0.12143579125404358, mean p set: 0.4504498541355133The modified gen p mean: 0.44808652997016907, gen p mean: -0.11554083228111267, mean p set: 0.44866296648979187
loss_pred:0.014171658083796501, decouple_loss:0.0004506499390117824
loss_pred:0.015037069097161293, decouple_loss:0.0005467450246214867
Iteration: 1292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44913169741630554, gen p mean: -0.11882852762937546, mean p set: 0.4497077465057373
loss_pred:0.014601603150367737, decouple_loss:0.0005673917476087809
The modified gen p mean: 0.44751405715942383, gen p mean: -0.1126316487789154, mean p set: 0.4480898678302765The modified gen p mean: 0.44861695170402527, gen p mean: -0.10933974385261536, mean p set: 0.44919553399086
loss_pred:0.014677544124424458, decouple_loss:0.0004789597005583346
loss_pred:0.014538571238517761, decouple_loss:0.00041744555346667767
Iteration: 1293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935527443885803, gen p mean: -0.11548741906881332, mean p set: 0.44993188977241516
loss_pred:0.014591034501791, decouple_loss:0.0005759775522165
The modified gen p mean: 0.4479101896286011, gen p mean: -0.11671240627765656, mean p set: 0.4484882652759552
loss_pred:0.014211749657988548, decouple_loss:0.00040415109833702445
The modified gen p mean: 0.4486810266971588, gen p mean: -0.11366740614175797, mean p set: 0.4492567181587219
loss_pred:0.01462591253221035, decouple_loss:0.00046738178934901953
Iteration: 1294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473496377468109, gen p mean: -0.1208963468670845, mean p set: 0.4479256868362427
loss_pred:0.01443004421889782, decouple_loss:0.000597262114752084
The modified gen p mean: 0.4488535225391388, gen p mean: -0.1149565652012825, mean p set: 0.449429988861084
loss_pred:0.015096670016646385, decouple_loss:0.0004003637586720288
The modified gen p mean: 0.4483083486557007, gen p mean: -0.12167853862047195, mean p set: 0.4488871097564697
loss_pred:0.014333102852106094, decouple_loss:0.0007210584590211511
Iteration: 1295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482561945915222, gen p mean: -0.11974869668483734, mean p set: 0.4488309919834137
loss_pred:0.015142879448831081, decouple_loss:0.0005822254461236298
The modified gen p mean: 0.4486646056175232, gen p mean: -0.1186462938785553, mean p set: 0.4492400586605072
loss_pred:0.01517497468739748, decouple_loss:0.0004857430758420378
The modified gen p mean: 0.4477500915527344, gen p mean: -0.11365005373954773, mean p set: 0.44832542538642883
loss_pred:0.014666709117591381, decouple_loss:0.0006691698217764497
Iteration: 1296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785046577453613, gen p mean: -0.1260349452495575, mean p set: 0.4484257698059082
loss_pred:0.01464286632835865, decouple_loss:0.0005370391299948096
The modified gen p mean: 0.44867756962776184, gen p mean: -0.12117426842451096, mean p set: 0.44925642013549805
loss_pred:0.014888046309351921, decouple_loss:0.0005639472510665655
The modified gen p mean: 0.44826260209083557, gen p mean: -0.12510834634304047, mean p set: 0.44883859157562256
loss_pred:0.013939186930656433, decouple_loss:0.00045387944555841386
Iteration: 1297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491341710090637, gen p mean: -0.11288661509752274, mean p set: 0.44971105456352234
loss_pred:0.01433176826685667, decouple_loss:0.000498458743095398
The modified gen p mean: 0.4477359354496002, gen p mean: -0.1166684627532959, mean p set: 0.4483124613761902
The modified gen p mean: 0.4484476149082184, gen p mean: -0.12114231288433075, mean p set: 0.4490225911140442
loss_pred:0.013922322541475296, decouple_loss:0.0006162283825688064
loss_pred:0.014716404490172863, decouple_loss:0.0005355457542464137
Iteration: 1298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490453600883484, gen p mean: -0.11155574768781662, mean p set: 0.4496217370033264
loss_pred:0.013838088139891624, decouple_loss:0.0003221627266611904
The modified gen p mean: 0.4472411870956421, gen p mean: -0.11687248945236206, mean p set: 0.4478180706501007
The modified gen p mean: 0.44806501269340515, gen p mean: -0.11721280962228775, mean p set: 0.4486420452594757
loss_pred:0.015214325860142708, decouple_loss:0.0005510382470674813
loss_pred:0.015017847530543804, decouple_loss:0.0005111637292429805
Iteration: 1299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44857439398765564, gen p mean: -0.12076946347951889, mean p set: 0.449150025844574
loss_pred:0.014179330319166183, decouple_loss:0.0004104793770238757
The modified gen p mean: 0.4496154487133026, gen p mean: -0.11956476420164108, mean p set: 0.45019209384918213
loss_pred:0.015143077820539474, decouple_loss:0.000412703346228227
The modified gen p mean: 0.44871240854263306, gen p mean: -0.11683442443609238, mean p set: 0.4492858350276947
loss_pred:0.013853522017598152, decouple_loss:0.000437710783444345
Iteration: 1300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44847992062568665, gen p mean: -0.11218748241662979, mean p set: 0.44905519485473633
loss_pred:0.014499031938612461, decouple_loss:0.00045148079516366124
The modified gen p mean: 0.4475223422050476, gen p mean: -0.11351960152387619, mean p set: 0.4480970501899719
loss_pred:0.014217863790690899, decouple_loss:0.00038363339263014495
The modified gen p mean: 0.4484018385410309, gen p mean: -0.11923479288816452, mean p set: 0.44897738099098206
loss_pred:0.013756966218352318, decouple_loss:0.0005238322191871703
2023-05-02 08:03:16 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12154936045408249, mean p set: 0.4502691626548767
loss_pred:0.016922252252697945, decouple_loss:0.00041144093847833574
The modified gen p mean: 0.44953370094299316, gen p mean: -0.11527059227228165, mean p set: 0.4500633478164673
loss_pred:0.01617075875401497, decouple_loss:0.00039001775439828634
The modified gen p mean: 0.4498306214809418, gen p mean: -0.11490913480520248, mean p set: 0.45035696029663086
loss_pred:0.016522549092769623, decouple_loss:0.00044508042628876865
WV_1_PC_1_EH_0_PS_40, loss: 0.01655929535627365, avg_mse: 0.02593516744673252
current test mse: 0.025935
Iteration: 1301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872555136680603, gen p mean: -0.11483870446681976, mean p set: 0.44930222630500793
loss_pred:0.014507886953651905, decouple_loss:0.00033310751314274967
The modified gen p mean: 0.4476127028465271, gen p mean: -0.11229676008224487, mean p set: 0.4481886029243469
loss_pred:0.01423670630902052, decouple_loss:0.00034370130742900074
The modified gen p mean: 0.44772908091545105, gen p mean: -0.11518692970275879, mean p set: 0.44830384850502014
loss_pred:0.013851296156644821, decouple_loss:0.0003768830210901797
Iteration: 1302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448753297328949, gen p mean: -0.11648397892713547, mean p set: 0.44932955503463745
loss_pred:0.014692800119519234, decouple_loss:0.0003703059337567538
The modified gen p mean: 0.44885942339897156, gen p mean: -0.11764603108167648, mean p set: 0.44943690299987793The modified gen p mean: 0.44759219884872437, gen p mean: -0.11040669679641724, mean p set: 0.4481671154499054
loss_pred:0.014134960249066353, decouple_loss:0.00031524902442470193
loss_pred:0.014148538000881672, decouple_loss:0.00039124954491853714
Iteration: 1303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849005341529846, gen p mean: -0.11916767060756683, mean p set: 0.4490663409233093
loss_pred:0.014126076363027096, decouple_loss:0.00047281826846301556
The modified gen p mean: 0.4484268128871918, gen p mean: -0.12154775857925415, mean p set: 0.44900044798851013
loss_pred:0.014175744727253914, decouple_loss:0.000398053991375491
The modified gen p mean: 0.4490848779678345, gen p mean: -0.12116017192602158, mean p set: 0.44965940713882446
loss_pred:0.013694226741790771, decouple_loss:0.0004686817992478609
Iteration: 1304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448306679725647, gen p mean: -0.1136498898267746, mean p set: 0.4488828480243683
loss_pred:0.014797584153711796, decouple_loss:0.000766148732509464
The modified gen p mean: 0.44799062609672546, gen p mean: -0.11585213243961334, mean p set: 0.44856372475624084
loss_pred:0.014212234877049923, decouple_loss:0.0003974778519477695
The modified gen p mean: 0.4477757513523102, gen p mean: -0.11690331995487213, mean p set: 0.44834965467453003
loss_pred:0.014939667657017708, decouple_loss:0.0005318893236108124
Iteration: 1305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448318749666214, gen p mean: -0.12129300087690353, mean p set: 0.4488929510116577
loss_pred:0.014549365267157555, decouple_loss:0.0004217390378471464
The modified gen p mean: 0.44907259941101074, gen p mean: -0.12409979104995728, mean p set: 0.4496510326862335
loss_pred:0.014466282911598682, decouple_loss:0.0004113976610824466
The modified gen p mean: 0.4478248953819275, gen p mean: -0.11516864597797394, mean p set: 0.44840162992477417
loss_pred:0.013852851465344429, decouple_loss:0.00047068740241229534
Iteration: 1306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789332151412964, gen p mean: -0.1257820725440979, mean p set: 0.448469340801239
loss_pred:0.014288357459008694, decouple_loss:0.0004891371354460716
The modified gen p mean: 0.4500996768474579, gen p mean: -0.12133339047431946, mean p set: 0.4506753385066986
The modified gen p mean: 0.44858917593955994, gen p mean: -0.11687946319580078, mean p set: 0.44916436076164246
loss_pred:0.014152667485177517, decouple_loss:0.0005245436332188547
loss_pred:0.014058462344110012, decouple_loss:0.00036917728721164167
Iteration: 1307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487221837043762, gen p mean: -0.11812885105609894, mean p set: 0.44930025935173035
The modified gen p mean: 0.44888004660606384, gen p mean: -0.11924629658460617, mean p set: 0.44945937395095825
loss_pred:0.013982071541249752, decouple_loss:0.00034033774863928556
loss_pred:0.013306126929819584, decouple_loss:0.00035306825884617865
The modified gen p mean: 0.44855549931526184, gen p mean: -0.11228001117706299, mean p set: 0.44913092255592346
loss_pred:0.01438638474792242, decouple_loss:0.0004155971691943705
Iteration: 1308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479893743991852, gen p mean: -0.11317343264818192, mean p set: 0.4485659599304199
loss_pred:0.014473655261099339, decouple_loss:0.00046791459317319095
The modified gen p mean: 0.4493490755558014, gen p mean: -0.12049520760774612, mean p set: 0.4499247372150421
loss_pred:0.013680420815944672, decouple_loss:0.00033058729604817927
The modified gen p mean: 0.4480796158313751, gen p mean: -0.1205325499176979, mean p set: 0.4486553370952606
loss_pred:0.01465789508074522, decouple_loss:0.0004164423735346645
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 1309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806694984436035, gen p mean: -0.1090678945183754, mean p set: 0.4486429989337921
loss_pred:0.014680461958050728, decouple_loss:0.00044697735575027764
The modified gen p mean: 0.4471159279346466, gen p mean: -0.11745787411928177, mean p set: 0.4476914703845978
The modified gen p mean: 0.44737282395362854, gen p mean: -0.12066683173179626, mean p set: 0.44795170426368713
loss_pred:0.014766603708267212, decouple_loss:0.0004275818355381489
loss_pred:0.014834756962954998, decouple_loss:0.00038365504588000476
Iteration: 1310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860759377479553, gen p mean: -0.11483016610145569, mean p set: 0.449184387922287
loss_pred:0.014443525113165379, decouple_loss:0.00037853195681236684
The modified gen p mean: 0.4486667811870575, gen p mean: -0.10599162429571152, mean p set: 0.44924309849739075
The modified gen p mean: 0.44699543714523315, gen p mean: -0.11262380331754684, mean p set: 0.44756919145584106
loss_pred:0.014587095938622952, decouple_loss:0.00045911609777249396
loss_pred:0.0156465545296669, decouple_loss:0.000447319180238992
2023-05-02 08:06:01 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12109636515378952, mean p set: 0.4502691626548767
loss_pred:0.016930148005485535, decouple_loss:0.000489837781060487
The modified gen p mean: 0.4495334327220917, gen p mean: -0.11494399607181549, mean p set: 0.4500633478164673
loss_pred:0.016163935884833336, decouple_loss:0.0004527942801360041
The modified gen p mean: 0.44982755184173584, gen p mean: -0.11415798962116241, mean p set: 0.45035696029663086
loss_pred:0.0165603905916214, decouple_loss:0.00046047495561651886
WV_1_PC_1_EH_0_PS_40, loss: 0.016574878245592117, avg_mse: 0.025916632264852524
current test mse: 0.025917
Iteration: 1311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714269042015076, gen p mean: -0.11851301044225693, mean p set: 0.44772061705589294
loss_pred:0.01455793995410204, decouple_loss:0.0005623804754577577
The modified gen p mean: 0.446991890668869, gen p mean: -0.12425168603658676, mean p set: 0.44756677746772766The modified gen p mean: 0.4484412968158722, gen p mean: -0.11413435637950897, mean p set: 0.4490176737308502
loss_pred:0.014734300784766674, decouple_loss:0.0003875082766171545
loss_pred:0.014302319847047329, decouple_loss:0.00032210786594077945
Iteration: 1312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701623916625977, gen p mean: -0.11999338120222092, mean p set: 0.44759422540664673
loss_pred:0.01466681994497776, decouple_loss:0.0005158019484952092
The modified gen p mean: 0.4461873769760132, gen p mean: -0.11039421707391739, mean p set: 0.44676467776298523The modified gen p mean: 0.4468279480934143, gen p mean: -0.11276714503765106, mean p set: 0.4474049210548401
loss_pred:0.014311294071376324, decouple_loss:0.00039273680886253715
loss_pred:0.014720430597662926, decouple_loss:0.0003483056789264083
Iteration: 1313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467445909976959, gen p mean: -0.12159693986177444, mean p set: 0.4473215639591217
loss_pred:0.014919789507985115, decouple_loss:0.0005577497067861259
The modified gen p mean: 0.44820263981819153, gen p mean: -0.10917964577674866, mean p set: 0.44877946376800537
loss_pred:0.013839757069945335, decouple_loss:0.00040940273902378976
The modified gen p mean: 0.4472278952598572, gen p mean: -0.12060604989528656, mean p set: 0.4478025436401367
loss_pred:0.014514046721160412, decouple_loss:0.0004710943321697414
Iteration: 1314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780266284942627, gen p mean: -0.110467828810215, mean p set: 0.4483802020549774
loss_pred:0.014194210059940815, decouple_loss:0.0004773448163177818
The modified gen p mean: 0.4476620554924011, gen p mean: -0.1169663667678833, mean p set: 0.4482361972332001
loss_pred:0.014518631622195244, decouple_loss:0.0003902554453816265
The modified gen p mean: 0.4466237425804138, gen p mean: -0.12108094245195389, mean p set: 0.4471994936466217
loss_pred:0.014934070408344269, decouple_loss:0.0005183542380109429
Iteration: 1315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790101051330566, gen p mean: -0.1193184107542038, mean p set: 0.4484791159629822
loss_pred:0.014550413936376572, decouple_loss:0.00044382447958923876
The modified gen p mean: 0.44879549741744995, gen p mean: -0.10823991894721985, mean p set: 0.44937291741371155
loss_pred:0.014457345940172672, decouple_loss:0.0005340842180885375
The modified gen p mean: 0.44619956612586975, gen p mean: -0.11949604749679565, mean p set: 0.44677630066871643
loss_pred:0.015264206565916538, decouple_loss:0.00039400646346621215
Iteration: 1316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721707701683044, gen p mean: -0.11675569415092468, mean p set: 0.44779151678085327
loss_pred:0.01433267630636692, decouple_loss:0.00040005642222240567
The modified gen p mean: 0.44809404015541077, gen p mean: -0.11294060200452805, mean p set: 0.4486709535121918
loss_pred:0.013821035623550415, decouple_loss:0.00044553534826263785
The modified gen p mean: 0.4473305940628052, gen p mean: -0.12028525024652481, mean p set: 0.44790735840797424
loss_pred:0.014472450129687786, decouple_loss:0.0003920561575796455
Iteration: 1317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474336802959442, gen p mean: -0.12278150767087936, mean p set: 0.44800853729248047
loss_pred:0.014669091440737247, decouple_loss:0.00045160172157920897
The modified gen p mean: 0.44795161485671997, gen p mean: -0.12460655719041824, mean p set: 0.4485274851322174
The modified gen p mean: 0.44682565331459045, gen p mean: -0.11822166293859482, mean p set: 0.4474024176597595
loss_pred:0.01449583750218153, decouple_loss:0.00041451724246144295
loss_pred:0.014449370093643665, decouple_loss:0.0003616984176915139
Iteration: 1318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737014174461365, gen p mean: -0.12455207109451294, mean p set: 0.4479469656944275
loss_pred:0.014689750969409943, decouple_loss:0.00039192376425489783
The modified gen p mean: 0.4470759630203247, gen p mean: -0.12649905681610107, mean p set: 0.44765228033065796
The modified gen p mean: 0.4464530944824219, gen p mean: -0.1190129891037941, mean p set: 0.4470299780368805
loss_pred:0.014829684980213642, decouple_loss:0.0003880733856931329
loss_pred:0.015161767601966858, decouple_loss:0.0004519473004620522
Iteration: 1319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474121034145355, gen p mean: -0.11649660766124725, mean p set: 0.44798827171325684
loss_pred:0.014047220349311829, decouple_loss:0.0005149860517121851
The modified gen p mean: 0.4465314745903015, gen p mean: -0.11470071971416473, mean p set: 0.447108656167984
loss_pred:0.013914335519075394, decouple_loss:0.0003554598952177912
The modified gen p mean: 0.4479001462459564, gen p mean: -0.12516184151172638, mean p set: 0.4484758675098419
loss_pred:0.01451872568577528, decouple_loss:0.0005072708008810878
Iteration: 1320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461759030818939, gen p mean: -0.11439666152000427, mean p set: 0.44675159454345703
loss_pred:0.015257020480930805, decouple_loss:0.0004106993437744677
The modified gen p mean: 0.44780102372169495, gen p mean: -0.1123318150639534, mean p set: 0.4483778774738312
The modified gen p mean: 0.4473636746406555, gen p mean: -0.12271170318126678, mean p set: 0.44793838262557983
loss_pred:0.014321143738925457, decouple_loss:0.0003283430414739996
loss_pred:0.014410297386348248, decouple_loss:0.0004520553338807076
2023-05-02 08:08:08 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12376340478658676, mean p set: 0.4502691626548767
loss_pred:0.016876082867383957, decouple_loss:0.00042691349517554045
The modified gen p mean: 0.4495380222797394, gen p mean: -0.11678528040647507, mean p set: 0.4500633478164673
loss_pred:0.016132866963744164, decouple_loss:0.00040998507756739855
The modified gen p mean: 0.44983014464378357, gen p mean: -0.11660706251859665, mean p set: 0.45035696029663086
loss_pred:0.01645663194358349, decouple_loss:0.0003979097818955779
WV_1_PC_1_EH_0_PS_40, loss: 0.016509108245372772, avg_mse: 0.025820480659604073
current test mse: 0.02582
Iteration: 1321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468191862106323, gen p mean: -0.11540615558624268, mean p set: 0.44739410281181335
loss_pred:0.015446975827217102, decouple_loss:0.0004091652517672628
The modified gen p mean: 0.4479881823062897, gen p mean: -0.11431355774402618, mean p set: 0.4485653042793274The modified gen p mean: 0.44753456115722656, gen p mean: -0.11378292739391327, mean p set: 0.4481112062931061
loss_pred:0.013768409378826618, decouple_loss:0.00039153502439148724
loss_pred:0.015202648937702179, decouple_loss:0.0003929820086341351
Iteration: 1322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482946991920471, gen p mean: -0.11213003844022751, mean p set: 0.4488696753978729
loss_pred:0.013891305774450302, decouple_loss:0.0003377660468686372
The modified gen p mean: 0.448041170835495, gen p mean: -0.12106003612279892, mean p set: 0.4486168920993805The modified gen p mean: 0.4464266896247864, gen p mean: -0.12386858463287354, mean p set: 0.44700247049331665
loss_pred:0.014376149512827396, decouple_loss:0.00035940861562266946
loss_pred:0.014844648540019989, decouple_loss:0.00038450025022029877
Iteration: 1323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447897732257843, gen p mean: -0.11381912976503372, mean p set: 0.44847285747528076
loss_pred:0.014104348607361317, decouple_loss:0.0003416824620217085
The modified gen p mean: 0.4488203525543213, gen p mean: -0.10950692743062973, mean p set: 0.4493965804576874
loss_pred:0.01388061884790659, decouple_loss:0.0003988073440268636
The modified gen p mean: 0.44778525829315186, gen p mean: -0.11734143644571304, mean p set: 0.44836175441741943
loss_pred:0.014313194900751114, decouple_loss:0.00043069483945146203
Iteration: 1324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838669896125793, gen p mean: -0.11375801265239716, mean p set: 0.4489628076553345
The modified gen p mean: 0.44731405377388, gen p mean: -0.1099214106798172, mean p set: 0.4478895962238312
loss_pred:0.014233922585844994, decouple_loss:0.00038226679316721857
loss_pred:0.013954694382846355, decouple_loss:0.00037755942321382463
The modified gen p mean: 0.4471607804298401, gen p mean: -0.1203247532248497, mean p set: 0.4477385878562927
loss_pred:0.014847088605165482, decouple_loss:0.00043537639430724084
Iteration: 1325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467216730117798, gen p mean: -0.11627818644046783, mean p set: 0.44729676842689514
loss_pred:0.01457041222602129, decouple_loss:0.0004114797920919955
The modified gen p mean: 0.44694942235946655, gen p mean: -0.11211542040109634, mean p set: 0.4475267231464386
loss_pred:0.014478674158453941, decouple_loss:0.00044580435496754944
The modified gen p mean: 0.44735175371170044, gen p mean: -0.11086133867502213, mean p set: 0.4479270875453949
loss_pred:0.014053551480174065, decouple_loss:0.0003840065619442612
Iteration: 1326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477502405643463, gen p mean: -0.1125449389219284, mean p set: 0.44832685589790344
loss_pred:0.014325186610221863, decouple_loss:0.000393819558667019
The modified gen p mean: 0.44717535376548767, gen p mean: -0.1144791841506958, mean p set: 0.4477514624595642
loss_pred:0.01400209590792656, decouple_loss:0.0004667790199164301
The modified gen p mean: 0.4466046094894409, gen p mean: -0.11040091514587402, mean p set: 0.4471812844276428
loss_pred:0.014750631526112556, decouple_loss:0.00038205855526030064
Iteration: 1327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699981808662415, gen p mean: -0.11190631240606308, mean p set: 0.4475743770599365
loss_pred:0.01547908317297697, decouple_loss:0.0003527852240949869
The modified gen p mean: 0.44668400287628174, gen p mean: -0.11873931437730789, mean p set: 0.44725939631462097
loss_pred:0.01472204178571701, decouple_loss:0.00047934846952557564
The modified gen p mean: 0.4486859142780304, gen p mean: -0.11678390204906464, mean p set: 0.44926023483276367
loss_pred:0.01419792603701353, decouple_loss:0.0003951514372602105
Iteration: 1328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642016291618347, gen p mean: -0.11257568746805191, mean p set: 0.4469953179359436
loss_pred:0.01441125012934208, decouple_loss:0.00041516919736750424
The modified gen p mean: 0.447672963142395, gen p mean: -0.12186208367347717, mean p set: 0.44824886322021484
loss_pred:0.01413679774850607, decouple_loss:0.000420699012465775
The modified gen p mean: 0.44769594073295593, gen p mean: -0.12052541971206665, mean p set: 0.44827136397361755
loss_pred:0.014158726669847965, decouple_loss:0.0005024162819609046
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
NaN value num: 0
Iteration: 1329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501219093799591, gen p mean: -0.11034127324819565, mean p set: 0.4506988525390625
loss_pred:0.014846202917397022, decouple_loss:0.0005800410290248692
The modified gen p mean: 0.45102640986442566, gen p mean: -0.11322198808193207, mean p set: 0.4516029953956604
loss_pred:0.015218988060951233, decouple_loss:0.0005357909831218421
The modified gen p mean: 0.4500672519207001, gen p mean: -0.10437222570180893, mean p set: 0.4506444036960602
loss_pred:0.015375128015875816, decouple_loss:0.000504101044498384
Iteration: 1330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44885557889938354, gen p mean: -0.11056037992238998, mean p set: 0.44943130016326904
The modified gen p mean: 0.4499432444572449, gen p mean: -0.11273685842752457, mean p set: 0.45051753520965576
loss_pred:0.015395318157970905, decouple_loss:0.0005321956123225391
loss_pred:0.015224795788526535, decouple_loss:0.00037548234104178846
The modified gen p mean: 0.44978001713752747, gen p mean: -0.11525440216064453, mean p set: 0.4503568708896637
loss_pred:0.014556544832885265, decouple_loss:0.0005265584914013743
2023-05-02 08:10:58 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12204457819461823, mean p set: 0.4502691626548767
loss_pred:0.016840677708387375, decouple_loss:0.00038982758997008204
The modified gen p mean: 0.44953453540802, gen p mean: -0.11523301899433136, mean p set: 0.4500633478164673
loss_pred:0.016152823343873024, decouple_loss:0.0004068661364726722
The modified gen p mean: 0.4498301148414612, gen p mean: -0.11490123718976974, mean p set: 0.45035696029663086
loss_pred:0.01646798476576805, decouple_loss:0.00039630485116504133
WV_1_PC_1_EH_0_PS_40, loss: 0.016507044434547424, avg_mse: 0.02578623965382576
current test mse: 0.025786
Iteration: 1331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501742124557495, gen p mean: -0.10846567898988724, mean p set: 0.45075103640556335
loss_pred:0.015321481972932816, decouple_loss:0.00044002378126606345
The modified gen p mean: 0.4505857825279236, gen p mean: -0.11061140149831772, mean p set: 0.45116233825683594
loss_pred:0.014976171776652336, decouple_loss:0.0004811151302419603
The modified gen p mean: 0.4497247040271759, gen p mean: -0.1187780499458313, mean p set: 0.45029953122138977
loss_pred:0.014812284149229527, decouple_loss:0.0005039889947511256
Iteration: 1332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505772888660431, gen p mean: -0.11374605447053909, mean p set: 0.45115405321121216
loss_pred:0.015264018438756466, decouple_loss:0.0004345555789768696
The modified gen p mean: 0.450234979391098, gen p mean: -0.1127995103597641, mean p set: 0.45081138610839844The modified gen p mean: 0.4502752423286438, gen p mean: -0.10371646285057068, mean p set: 0.4508519768714905
loss_pred:0.014996225945651531, decouple_loss:0.0006086079520173371loss_pred:0.014530382119119167, decouple_loss:0.00038349986425600946
Iteration: 1333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495762884616852, gen p mean: -0.10827409476041794, mean p set: 0.4501529335975647
loss_pred:0.014724723063409328, decouple_loss:0.0005672164843417704
The modified gen p mean: 0.4489229619503021, gen p mean: -0.11163389682769775, mean p set: 0.4494975507259369
loss_pred:0.014729196205735207, decouple_loss:0.0006028655916452408
The modified gen p mean: 0.4490969777107239, gen p mean: -0.10564202070236206, mean p set: 0.4496713876724243
loss_pred:0.01498348731547594, decouple_loss:0.000526702671777457
Iteration: 1334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488677382469177, gen p mean: -0.10396312177181244, mean p set: 0.44944292306900024
loss_pred:0.014451384544372559, decouple_loss:0.00046201309305615723
The modified gen p mean: 0.4494275450706482, gen p mean: -0.09747613221406937, mean p set: 0.4500047266483307
loss_pred:0.0147886723279953, decouple_loss:0.0003870452055707574
The modified gen p mean: 0.4512188732624054, gen p mean: -0.09853655844926834, mean p set: 0.45179483294487
loss_pred:0.014783605933189392, decouple_loss:0.0007160690729506314
Iteration: 1335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502350389957428, gen p mean: -0.0985264778137207, mean p set: 0.45081067085266113
loss_pred:0.014939958229660988, decouple_loss:0.0006318929954431951
The modified gen p mean: 0.4482894837856293, gen p mean: -0.0980195552110672, mean p set: 0.4488658010959625
loss_pred:0.014735985547304153, decouple_loss:0.0006017654086463153
The modified gen p mean: 0.4501100182533264, gen p mean: -0.10345465689897537, mean p set: 0.45068684220314026
loss_pred:0.015036766417324543, decouple_loss:0.000517137348651886
Iteration: 1336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498370289802551, gen p mean: -0.10484784096479416, mean p set: 0.4504128098487854
loss_pred:0.014858483336865902, decouple_loss:0.0003982162452302873
The modified gen p mean: 0.4489266276359558, gen p mean: -0.1027330830693245, mean p set: 0.4495031237602234
loss_pred:0.014018360525369644, decouple_loss:0.0004640272236429155
The modified gen p mean: 0.45096996426582336, gen p mean: -0.10288306325674057, mean p set: 0.4515463411808014
loss_pred:0.01474885456264019, decouple_loss:0.0004264757444616407
Iteration: 1337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44920721650123596, gen p mean: -0.10254915058612823, mean p set: 0.4497842490673065
loss_pred:0.014459865167737007, decouple_loss:0.00038142595440149307
The modified gen p mean: 0.4493178129196167, gen p mean: -0.10631139576435089, mean p set: 0.4498935639858246
The modified gen p mean: 0.44970276951789856, gen p mean: -0.10737413913011551, mean p set: 0.45027947425842285
loss_pred:0.015006312169134617, decouple_loss:0.0004618651873897761
loss_pred:0.014761687256395817, decouple_loss:0.0004931007861159742
Iteration: 1338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490055441856384, gen p mean: -0.10108430683612823, mean p set: 0.4495818316936493
loss_pred:0.014936038292944431, decouple_loss:0.0005669166566804051
The modified gen p mean: 0.4512538015842438, gen p mean: -0.10729759931564331, mean p set: 0.45183131098747253
The modified gen p mean: 0.4490150809288025, gen p mean: -0.11116621643304825, mean p set: 0.449592649936676
loss_pred:0.014147480018436909, decouple_loss:0.00045455447980202734
loss_pred:0.01446656882762909, decouple_loss:0.00037518079625442624
Iteration: 1339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501131772994995, gen p mean: -0.10616390407085419, mean p set: 0.4506879150867462
loss_pred:0.01484525203704834, decouple_loss:0.00037168170092627406
The modified gen p mean: 0.44914641976356506, gen p mean: -0.10681746900081635, mean p set: 0.4497208595275879
The modified gen p mean: 0.4517347812652588, gen p mean: -0.10255724936723709, mean p set: 0.4523118734359741
loss_pred:0.015185500495135784, decouple_loss:0.0005981652648188174
loss_pred:0.015349897556006908, decouple_loss:0.0004100289661437273
Iteration: 1340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44999492168426514, gen p mean: -0.10353726148605347, mean p set: 0.4505685865879059
loss_pred:0.016085751354694366, decouple_loss:0.0005581271834671497
The modified gen p mean: 0.44999265670776367, gen p mean: -0.10447150468826294, mean p set: 0.4505689740180969
The modified gen p mean: 0.4482842981815338, gen p mean: -0.10340818762779236, mean p set: 0.44886115193367004
loss_pred:0.015005099587142467, decouple_loss:0.00038543809205293655
loss_pred:0.014388127252459526, decouple_loss:0.0005211458192206919
2023-05-02 08:13:02 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11277163028717041, mean p set: 0.4502691626548767
loss_pred:0.016997840255498886, decouple_loss:0.0005921307019889355
The modified gen p mean: 0.44953784346580505, gen p mean: -0.10645921528339386, mean p set: 0.4500633478164673
loss_pred:0.01631256565451622, decouple_loss:0.0006859224522486329
The modified gen p mean: 0.44982674717903137, gen p mean: -0.10640063881874084, mean p set: 0.45035696029663086
loss_pred:0.016661733388900757, decouple_loss:0.0005277538439258933
WV_1_PC_1_EH_0_PS_40, loss: 0.016687478870153427, avg_mse: 0.025977352634072304
current test mse: 0.025977
Iteration: 1341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971731305122375, gen p mean: -0.10048870742321014, mean p set: 0.45029497146606445
loss_pred:0.015047731809318066, decouple_loss:0.0005195168196223676
The modified gen p mean: 0.4504048526287079, gen p mean: -0.10138217359781265, mean p set: 0.45098140835762024
loss_pred:0.01539556123316288, decouple_loss:0.0005706791998818517
The modified gen p mean: 0.4503898322582245, gen p mean: -0.10204855352640152, mean p set: 0.4509684145450592
loss_pred:0.015047148801386356, decouple_loss:0.0005505728186108172
Iteration: 1342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496435225009918, gen p mean: -0.10673689097166061, mean p set: 0.4502204656600952The modified gen p mean: 0.45065999031066895, gen p mean: -0.1018705666065216, mean p set: 0.45123711228370667
loss_pred:0.014393382705748081, decouple_loss:0.0004174579225946218
loss_pred:0.016309818252921104, decouple_loss:0.000664412509649992
The modified gen p mean: 0.4514949917793274, gen p mean: -0.09849875420331955, mean p set: 0.45207199454307556
loss_pred:0.01526575442403555, decouple_loss:0.0004899594932794571
Iteration: 1343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010241866111755, gen p mean: -0.09698508679866791, mean p set: 0.4506790041923523
loss_pred:0.015092779882252216, decouple_loss:0.0004416155570652336
The modified gen p mean: 0.4498060345649719, gen p mean: -0.09582747519016266, mean p set: 0.45038288831710815The modified gen p mean: 0.45017534494400024, gen p mean: -0.10445716977119446, mean p set: 0.45075175166130066
loss_pred:0.015425501391291618, decouple_loss:0.0004887806135229766loss_pred:0.015894312411546707, decouple_loss:0.0006069670198485255
Iteration: 1344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45205289125442505, gen p mean: -0.1005706787109375, mean p set: 0.45262953639030457
loss_pred:0.015071801841259003, decouple_loss:0.0004889629781246185
The modified gen p mean: 0.4509390592575073, gen p mean: -0.10516609996557236, mean p set: 0.45151498913764954
loss_pred:0.015852322801947594, decouple_loss:0.00045758174383081496
The modified gen p mean: 0.4489917457103729, gen p mean: -0.10986003279685974, mean p set: 0.44956985116004944
loss_pred:0.014758894219994545, decouple_loss:0.00039205016219057143
Iteration: 1345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494524598121643, gen p mean: -0.09950599074363708, mean p set: 0.4500291645526886
The modified gen p mean: 0.45041847229003906, gen p mean: -0.1020364761352539, mean p set: 0.450996994972229
loss_pred:0.014599462039768696, decouple_loss:0.0004602833359967917
loss_pred:0.015381190925836563, decouple_loss:0.00040390429785475135
The modified gen p mean: 0.45175883173942566, gen p mean: -0.1016707792878151, mean p set: 0.4523356258869171
loss_pred:0.014669260010123253, decouple_loss:0.0004626611771527678
Iteration: 1346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44987475872039795, gen p mean: -0.09883497655391693, mean p set: 0.45045042037963867
loss_pred:0.015042574144899845, decouple_loss:0.00042085759923793375
The modified gen p mean: 0.45085591077804565, gen p mean: -0.09929775446653366, mean p set: 0.4514326751232147
The modified gen p mean: 0.4498260021209717, gen p mean: -0.09228219091892242, mean p set: 0.4504052996635437
loss_pred:0.014426995068788528, decouple_loss:0.0003861102741211653
loss_pred:0.01526498794555664, decouple_loss:0.0005193360266275704
Iteration: 1347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518353343009949, gen p mean: -0.09782551229000092, mean p set: 0.45241379737854004
loss_pred:0.014917292632162571, decouple_loss:0.0003888049686793238
The modified gen p mean: 0.4506343603134155, gen p mean: -0.09795185178518295, mean p set: 0.4512108564376831
The modified gen p mean: 0.44978922605514526, gen p mean: -0.09965184330940247, mean p set: 0.45036759972572327
loss_pred:0.014615818858146667, decouple_loss:0.00047465332318097353
loss_pred:0.015035498887300491, decouple_loss:0.0004328199429437518
Iteration: 1348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44991883635520935, gen p mean: -0.09837061166763306, mean p set: 0.4504949152469635
loss_pred:0.01466231420636177, decouple_loss:0.00043972485582344234
The modified gen p mean: 0.4505265951156616, gen p mean: -0.10093916207551956, mean p set: 0.45110228657722473
loss_pred:0.01557475421577692, decouple_loss:0.00045003581908531487
The modified gen p mean: 0.44916829466819763, gen p mean: -0.10350979119539261, mean p set: 0.4497469365596771
loss_pred:0.01477928925305605, decouple_loss:0.00036584981717169285
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 1349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476644694805145, gen p mean: -0.11028356105089188, mean p set: 0.4482399523258209
loss_pred:0.015439734794199467, decouple_loss:0.0005812851013615727
The modified gen p mean: 0.44727596640586853, gen p mean: -0.10602878779172897, mean p set: 0.44785353541374207
The modified gen p mean: 0.4475620687007904, gen p mean: -0.11239476501941681, mean p set: 0.4481387734413147
loss_pred:0.014986622147262096, decouple_loss:0.000484947842778638
loss_pred:0.015082739293575287, decouple_loss:0.0006514012929983437
Iteration: 1350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476330876350403, gen p mean: -0.11201988160610199, mean p set: 0.4482089579105377
loss_pred:0.015283376909792423, decouple_loss:0.00057141890283674
The modified gen p mean: 0.44674089550971985, gen p mean: -0.10737939178943634, mean p set: 0.44731831550598145
The modified gen p mean: 0.44812533259391785, gen p mean: -0.10773350298404694, mean p set: 0.44870179891586304
loss_pred:0.015459070913493633, decouple_loss:0.0006888574571348727
loss_pred:0.015573936514556408, decouple_loss:0.0005313734873197973
2023-05-02 08:15:45 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12366653978824615, mean p set: 0.4502691626548767
loss_pred:0.01701768860220909, decouple_loss:0.000519061868544668
The modified gen p mean: 0.44953519105911255, gen p mean: -0.1160065159201622, mean p set: 0.4500633478164673
loss_pred:0.016298575326800346, decouple_loss:0.000590469513554126
The modified gen p mean: 0.44982826709747314, gen p mean: -0.11583214998245239, mean p set: 0.45035696029663086
loss_pred:0.01660006120800972, decouple_loss:0.0005646002828143537
WV_1_PC_1_EH_0_PS_40, loss: 0.016666676849126816, avg_mse: 0.02604331076145172
current test mse: 0.026043
Iteration: 1351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470386803150177, gen p mean: -0.12347637116909027, mean p set: 0.44761648774147034
loss_pred:0.01462798472493887, decouple_loss:0.0006918471190147102
The modified gen p mean: 0.44824251532554626, gen p mean: -0.1146429032087326, mean p set: 0.4488186836242676
loss_pred:0.015070556662976742, decouple_loss:0.00048520081327296793
The modified gen p mean: 0.4474667012691498, gen p mean: -0.11902248859405518, mean p set: 0.4480433166027069
loss_pred:0.014177354983985424, decouple_loss:0.0007234957301989198
Iteration: 1352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806912541389465, gen p mean: -0.11175218969583511, mean p set: 0.4486466944217682
The modified gen p mean: 0.44846734404563904, gen p mean: -0.119884192943573, mean p set: 0.44904205203056335
loss_pred:0.015198388136923313, decouple_loss:0.00047451083082705736
loss_pred:0.014758025296032429, decouple_loss:0.0006118163000792265The modified gen p mean: 0.44714170694351196, gen p mean: -0.12061934173107147, mean p set: 0.44771865010261536
loss_pred:0.014420054852962494, decouple_loss:0.0003900878073181957
Iteration: 1353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819214940071106, gen p mean: -0.12269211560487747, mean p set: 0.4487678110599518
The modified gen p mean: 0.44863438606262207, gen p mean: -0.11832283437252045, mean p set: 0.4492107927799225
loss_pred:0.014811056666076183, decouple_loss:0.000464645738247782
loss_pred:0.015188564546406269, decouple_loss:0.00045415424392558634
The modified gen p mean: 0.448813259601593, gen p mean: -0.1198422834277153, mean p set: 0.4493890404701233
loss_pred:0.014847365207970142, decouple_loss:0.0004644814180210233
Iteration: 1354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482859969139099, gen p mean: -0.11619025468826294, mean p set: 0.4488621652126312
The modified gen p mean: 0.44875025749206543, gen p mean: -0.11859265714883804, mean p set: 0.4493274986743927
loss_pred:0.015338973142206669, decouple_loss:0.0005501753184944391
loss_pred:0.015002354979515076, decouple_loss:0.0005527632893063128
The modified gen p mean: 0.4473285377025604, gen p mean: -0.1210777759552002, mean p set: 0.4479069411754608
loss_pred:0.01548258401453495, decouple_loss:0.0004995910567231476
Iteration: 1355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726240634918213, gen p mean: -0.11818348616361618, mean p set: 0.4478406012058258
loss_pred:0.01515574287623167, decouple_loss:0.00043209808063693345
The modified gen p mean: 0.44717055559158325, gen p mean: -0.11990118771791458, mean p set: 0.4477456510066986
loss_pred:0.015384557656943798, decouple_loss:0.000502820301335305
The modified gen p mean: 0.44778600335121155, gen p mean: -0.10914669185876846, mean p set: 0.4483618438243866
loss_pred:0.014686591923236847, decouple_loss:0.0004238950496073812
Iteration: 1356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447445809841156, gen p mean: -0.12099337577819824, mean p set: 0.44802039861679077
loss_pred:0.01444188691675663, decouple_loss:0.0004868334799539298
The modified gen p mean: 0.44744712114334106, gen p mean: -0.12040268629789352, mean p set: 0.4480248689651489
loss_pred:0.01466348022222519, decouple_loss:0.00043750976328738034
The modified gen p mean: 0.446715772151947, gen p mean: -0.12025883793830872, mean p set: 0.4472944438457489
loss_pred:0.014707486145198345, decouple_loss:0.00039560749428346753
Iteration: 1357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482017755508423, gen p mean: -0.1172930896282196, mean p set: 0.44877755641937256
loss_pred:0.0154035659506917, decouple_loss:0.0004851480189245194
The modified gen p mean: 0.4468769133090973, gen p mean: -0.12123750895261765, mean p set: 0.44745007157325745
The modified gen p mean: 0.4464869201183319, gen p mean: -0.12097824364900589, mean p set: 0.44706112146377563
loss_pred:0.014247674494981766, decouple_loss:0.0005474694189615548
loss_pred:0.015099707059562206, decouple_loss:0.0004411114496178925
Iteration: 1358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728726148605347, gen p mean: -0.1226162537932396, mean p set: 0.4478645324707031
loss_pred:0.014528386294841766, decouple_loss:0.0004722612211480737
The modified gen p mean: 0.4476393163204193, gen p mean: -0.1176571473479271, mean p set: 0.44821682572364807
The modified gen p mean: 0.44788360595703125, gen p mean: -0.122294582426548, mean p set: 0.44846081733703613
loss_pred:0.01527365017682314, decouple_loss:0.00042163924081251025
loss_pred:0.014545521698892117, decouple_loss:0.0004598016384989023
Iteration: 1359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777482748031616, gen p mean: -0.11862736195325851, mean p set: 0.4483511745929718
The modified gen p mean: 0.4468522071838379, gen p mean: -0.12364102900028229, mean p set: 0.44742754101753235
loss_pred:0.014775648713111877, decouple_loss:0.00048292180872522295
loss_pred:0.014393417164683342, decouple_loss:0.00041536992648616433
The modified gen p mean: 0.4482139050960541, gen p mean: -0.12034815549850464, mean p set: 0.44879069924354553
loss_pred:0.014263923279941082, decouple_loss:0.00038481192314065993
Iteration: 1360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476611018180847, gen p mean: -0.11557081341743469, mean p set: 0.44823944568634033
loss_pred:0.014929605647921562, decouple_loss:0.0003976620500907302
The modified gen p mean: 0.447128564119339, gen p mean: -0.11610228568315506, mean p set: 0.44770246744155884
loss_pred:0.014689354225993156, decouple_loss:0.0004982124664820731
The modified gen p mean: 0.44751814007759094, gen p mean: -0.11859283596277237, mean p set: 0.4480917155742645
loss_pred:0.01543007418513298, decouple_loss:0.0005813778843730688
2023-05-02 08:17:50 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12069312483072281, mean p set: 0.4502691626548767
loss_pred:0.017029540613293648, decouple_loss:0.000512824219185859
The modified gen p mean: 0.4495355486869812, gen p mean: -0.11419609189033508, mean p set: 0.4500633478164673
loss_pred:0.016251131892204285, decouple_loss:0.0004793096159119159
The modified gen p mean: 0.4498298168182373, gen p mean: -0.11361286789178848, mean p set: 0.45035696029663086
loss_pred:0.016602862626314163, decouple_loss:0.00041035632602870464
WV_1_PC_1_EH_0_PS_40, loss: 0.016651220619678497, avg_mse: 0.026046520099043846
current test mse: 0.026047
Iteration: 1361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477415382862091, gen p mean: -0.11507949978113174, mean p set: 0.44831904768943787
loss_pred:0.015219219960272312, decouple_loss:0.00040256278589367867
The modified gen p mean: 0.4460750222206116, gen p mean: -0.11377719044685364, mean p set: 0.44665300846099854The modified gen p mean: 0.4473530948162079, gen p mean: -0.11693496257066727, mean p set: 0.44792893528938293
loss_pred:0.015017024241387844, decouple_loss:0.0003645099059212953
loss_pred:0.015190989710390568, decouple_loss:0.0005055763176642358
Iteration: 1362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724586606025696, gen p mean: -0.112887442111969, mean p set: 0.4478210508823395The modified gen p mean: 0.44797787070274353, gen p mean: -0.11701752990484238, mean p set: 0.44855615496635437
loss_pred:0.015140069648623466, decouple_loss:0.000375281844753772
loss_pred:0.014693157747387886, decouple_loss:0.0004980742232874036
The modified gen p mean: 0.4475719630718231, gen p mean: -0.11406507343053818, mean p set: 0.44814959168434143
loss_pred:0.014546200633049011, decouple_loss:0.00045753110316582024
Iteration: 1363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481688439846039, gen p mean: -0.11500369012355804, mean p set: 0.4487457573413849
loss_pred:0.014973767101764679, decouple_loss:0.00043702812399715185
The modified gen p mean: 0.44696998596191406, gen p mean: -0.12028627842664719, mean p set: 0.44754406809806824The modified gen p mean: 0.4474327862262726, gen p mean: -0.12248437851667404, mean p set: 0.4480080008506775
loss_pred:0.014619020745158195, decouple_loss:0.0004883432993665338
loss_pred:0.0150359608232975, decouple_loss:0.0004123047401662916
Iteration: 1364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471644461154938, gen p mean: -0.1187862977385521, mean p set: 0.4477413594722748
The modified gen p mean: 0.44770440459251404, gen p mean: -0.12840934097766876, mean p set: 0.44828295707702637
loss_pred:0.01498788595199585, decouple_loss:0.0004412151174619794
loss_pred:0.015226650983095169, decouple_loss:0.00046598853077739477
The modified gen p mean: 0.44735202193260193, gen p mean: -0.12424641847610474, mean p set: 0.4479289650917053
loss_pred:0.015252484008669853, decouple_loss:0.00048165852786041796
Iteration: 1365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44703832268714905, gen p mean: -0.12089674919843674, mean p set: 0.4476131498813629
loss_pred:0.014073566533625126, decouple_loss:0.000461222865851596
The modified gen p mean: 0.4476485848426819, gen p mean: -0.12444400042295456, mean p set: 0.4482249617576599
loss_pred:0.01457634475082159, decouple_loss:0.00037814275128766894
The modified gen p mean: 0.4489147663116455, gen p mean: -0.11735919117927551, mean p set: 0.4494889974594116
loss_pred:0.014054170809686184, decouple_loss:0.00037558062467724085
Iteration: 1366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476575255393982, gen p mean: -0.1190725639462471, mean p set: 0.4482308626174927
The modified gen p mean: 0.4477112293243408, gen p mean: -0.1186787486076355, mean p set: 0.4482864737510681loss_pred:0.014822873286902905, decouple_loss:0.0005340836942195892
loss_pred:0.014641279354691505, decouple_loss:0.0005530648049898446
The modified gen p mean: 0.4466012120246887, gen p mean: -0.11930624395608902, mean p set: 0.4471800923347473
loss_pred:0.015163467265665531, decouple_loss:0.000532968551851809
Iteration: 1367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470318853855133, gen p mean: -0.11006224900484085, mean p set: 0.44760891795158386
loss_pred:0.015287019312381744, decouple_loss:0.00041299083386547863
The modified gen p mean: 0.4472479820251465, gen p mean: -0.11542397737503052, mean p set: 0.4478244483470917
loss_pred:0.014646277762949467, decouple_loss:0.00038999159005470574
The modified gen p mean: 0.4460292160511017, gen p mean: -0.11215117573738098, mean p set: 0.44660380482673645
loss_pred:0.015212667174637318, decouple_loss:0.00040424379403702915
Iteration: 1368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761720299720764, gen p mean: -0.11613286286592484, mean p set: 0.44819164276123047
loss_pred:0.014321795664727688, decouple_loss:0.00046007538912817836
The modified gen p mean: 0.447491317987442, gen p mean: -0.11875234544277191, mean p set: 0.44806867837905884
loss_pred:0.014761787839233875, decouple_loss:0.00048684715875424445
The modified gen p mean: 0.4471718370914459, gen p mean: -0.11011514812707901, mean p set: 0.4477475583553314
loss_pred:0.014273228123784065, decouple_loss:0.0003768021706491709
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
NaN value num: 0
Iteration: 1369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449285089969635, gen p mean: -0.1051328182220459, mean p set: 0.4498610198497772
The modified gen p mean: 0.44981056451797485, gen p mean: -0.1033332496881485, mean p set: 0.4503854513168335loss_pred:0.015615365467965603, decouple_loss:0.0006147361127659678
loss_pred:0.014121551997959614, decouple_loss:0.00047758303117007017
The modified gen p mean: 0.4514866769313812, gen p mean: -0.10507062077522278, mean p set: 0.45206427574157715
loss_pred:0.015546969138085842, decouple_loss:0.0006352474447339773
Iteration: 1370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496251344680786, gen p mean: -0.10610966384410858, mean p set: 0.45020246505737305
loss_pred:0.015376203693449497, decouple_loss:0.00047167230513878167
The modified gen p mean: 0.45069921016693115, gen p mean: -0.10735655575990677, mean p set: 0.4512771964073181
loss_pred:0.015331345610320568, decouple_loss:0.000539536529686302
The modified gen p mean: 0.45175474882125854, gen p mean: -0.10313987731933594, mean p set: 0.45233187079429626
loss_pred:0.01567484624683857, decouple_loss:0.0005087211029604077
2023-05-02 08:20:31 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11783549934625626, mean p set: 0.4502691626548767
loss_pred:0.017007146030664444, decouple_loss:0.0007343067554756999
The modified gen p mean: 0.44953498244285583, gen p mean: -0.11166927963495255, mean p set: 0.4500633478164673
loss_pred:0.01627272367477417, decouple_loss:0.0007134871557354927
The modified gen p mean: 0.4498291015625, gen p mean: -0.11122721433639526, mean p set: 0.45035696029663086
loss_pred:0.016497934237122536, decouple_loss:0.0008341403445228934
WV_1_PC_1_EH_0_PS_40, loss: 0.016630632802844048, avg_mse: 0.025929296389222145
current test mse: 0.025929
Iteration: 1371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904616475105286, gen p mean: -0.11406972259283066, mean p set: 0.4496227502822876
loss_pred:0.013721690513193607, decouple_loss:0.00045552951632998884
The modified gen p mean: 0.4520736634731293, gen p mean: -0.10889194160699844, mean p set: 0.45265159010887146
loss_pred:0.014952055178582668, decouple_loss:0.0005200941814109683
The modified gen p mean: 0.44936227798461914, gen p mean: -0.11126928776502609, mean p set: 0.44994187355041504
loss_pred:0.01457980740815401, decouple_loss:0.0006386212771758437
Iteration: 1372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497831463813782, gen p mean: -0.10678525269031525, mean p set: 0.4503614008426666
loss_pred:0.014920804649591446, decouple_loss:0.000590452691540122
The modified gen p mean: 0.45250076055526733, gen p mean: -0.10970830917358398, mean p set: 0.4530782699584961The modified gen p mean: 0.4492049813270569, gen p mean: -0.10578864067792892, mean p set: 0.4497832953929901
loss_pred:0.015175547450780869, decouple_loss:0.0005599578726105392
loss_pred:0.01540690939873457, decouple_loss:0.000673774688038975
Iteration: 1373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504010081291199, gen p mean: -0.10332100093364716, mean p set: 0.4509774148464203
loss_pred:0.015646489337086678, decouple_loss:0.0005441573448479176
The modified gen p mean: 0.4489998519420624, gen p mean: -0.10738611221313477, mean p set: 0.44957494735717773The modified gen p mean: 0.45130327343940735, gen p mean: -0.1006782054901123, mean p set: 0.4518806040287018
loss_pred:0.01399146020412445, decouple_loss:0.0005364513490349054
loss_pred:0.014879563823342323, decouple_loss:0.0005200895247980952
Iteration: 1374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45112162828445435, gen p mean: -0.10305654257535934, mean p set: 0.45169880986213684
loss_pred:0.015322573482990265, decouple_loss:0.0005388789577409625
The modified gen p mean: 0.44915732741355896, gen p mean: -0.10295869410037994, mean p set: 0.4497336745262146
loss_pred:0.014984853565692902, decouple_loss:0.0006569146644324064
The modified gen p mean: 0.4505302906036377, gen p mean: -0.10426266491413116, mean p set: 0.4511072635650635
loss_pred:0.01536761038005352, decouple_loss:0.0004019408661406487
Iteration: 1375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492074251174927, gen p mean: -0.10246793180704117, mean p set: 0.44978389143943787
loss_pred:0.013926117680966854, decouple_loss:0.0006060373852960765
The modified gen p mean: 0.45149651169776917, gen p mean: -0.09101653099060059, mean p set: 0.45207321643829346
loss_pred:0.015536043792963028, decouple_loss:0.0004228628531564027
The modified gen p mean: 0.44924721121788025, gen p mean: -0.0953405350446701, mean p set: 0.44982221722602844
loss_pred:0.015581652522087097, decouple_loss:0.0005391558515839279
Iteration: 1376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498015344142914, gen p mean: -0.09939969331026077, mean p set: 0.4503765404224396
loss_pred:0.01524258404970169, decouple_loss:0.0006582673522643745
The modified gen p mean: 0.4496992528438568, gen p mean: -0.10814741253852844, mean p set: 0.450275719165802
loss_pred:0.013720220886170864, decouple_loss:0.000532976642716676
The modified gen p mean: 0.4495532214641571, gen p mean: -0.10972363501787186, mean p set: 0.4501286447048187
loss_pred:0.013534138910472393, decouple_loss:0.0005966776516288519
Iteration: 1377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490364193916321, gen p mean: -0.10774838179349899, mean p set: 0.44961148500442505
loss_pred:0.014552759006619453, decouple_loss:0.0005313757574185729
The modified gen p mean: 0.4496851861476898, gen p mean: -0.10635196417570114, mean p set: 0.4502619802951813
loss_pred:0.015166510827839375, decouple_loss:0.00044746752246282995
The modified gen p mean: 0.4489331543445587, gen p mean: -0.10059548914432526, mean p set: 0.44950950145721436
loss_pred:0.015104103833436966, decouple_loss:0.0005405206466093659
Iteration: 1378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44981515407562256, gen p mean: -0.10537277907133102, mean p set: 0.45039013028144836
loss_pred:0.015118969604372978, decouple_loss:0.0004674560041166842
The modified gen p mean: 0.45010024309158325, gen p mean: -0.10891323536634445, mean p set: 0.45067763328552246
The modified gen p mean: 0.4490022659301758, gen p mean: -0.1147211492061615, mean p set: 0.44958019256591797
loss_pred:0.014964782632887363, decouple_loss:0.00047885830281302333
loss_pred:0.014155141077935696, decouple_loss:0.000424189172917977
Iteration: 1379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492349624633789, gen p mean: -0.11533505469560623, mean p set: 0.4498123526573181
loss_pred:0.014987548813223839, decouple_loss:0.0004491647705435753
The modified gen p mean: 0.45142337679862976, gen p mean: -0.107419453561306, mean p set: 0.45200085639953613
The modified gen p mean: 0.45013880729675293, gen p mean: -0.11224708706140518, mean p set: 0.45071735978126526
loss_pred:0.014892839826643467, decouple_loss:0.000517066742759198
loss_pred:0.014003717340528965, decouple_loss:0.00042353520984761417
Iteration: 1380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494926333427429, gen p mean: -0.1053788959980011, mean p set: 0.45006775856018066
loss_pred:0.014787929132580757, decouple_loss:0.0005851920577697456
The modified gen p mean: 0.45102694630622864, gen p mean: -0.10622909665107727, mean p set: 0.4516032636165619
The modified gen p mean: 0.4497840106487274, gen p mean: -0.11930841952562332, mean p set: 0.4503604471683502
loss_pred:0.01463343482464552, decouple_loss:0.0005938499234616756
loss_pred:0.01390051282942295, decouple_loss:0.000484295014757663
2023-05-02 08:22:35 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12369140237569809, mean p set: 0.4502691626548767
loss_pred:0.01708611473441124, decouple_loss:0.0008260628092102706
The modified gen p mean: 0.44953417778015137, gen p mean: -0.11743269860744476, mean p set: 0.4500633478164673
loss_pred:0.016320910304784775, decouple_loss:0.0006810296326875687
The modified gen p mean: 0.4498279392719269, gen p mean: -0.1169581189751625, mean p set: 0.45035696029663086
loss_pred:0.016547689214348793, decouple_loss:0.0007568368455395103
WV_1_PC_1_EH_0_PS_40, loss: 0.016689304262399673, avg_mse: 0.02597351185977459
current test mse: 0.025974
Iteration: 1381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494331181049347, gen p mean: -0.10895548015832901, mean p set: 0.4500081539154053
loss_pred:0.015110217966139317, decouple_loss:0.0004884767695330083
The modified gen p mean: 0.4488617181777954, gen p mean: -0.11160504072904587, mean p set: 0.4494384825229645The modified gen p mean: 0.44933387637138367, gen p mean: -0.11045189946889877, mean p set: 0.44991159439086914
loss_pred:0.014294587075710297, decouple_loss:0.0005464136484079063
loss_pred:0.014108213596045971, decouple_loss:0.0004532819730229676
Iteration: 1382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496614933013916, gen p mean: -0.1141585260629654, mean p set: 0.4502403438091278
loss_pred:0.014184800907969475, decouple_loss:0.00039477954851463437
The modified gen p mean: 0.44958409667015076, gen p mean: -0.12341746687889099, mean p set: 0.4501604735851288The modified gen p mean: 0.44913384318351746, gen p mean: -0.11260271072387695, mean p set: 0.44970813393592834
loss_pred:0.013826861046254635, decouple_loss:0.000448560924269259
loss_pred:0.014792674221098423, decouple_loss:0.0003689705044962466
Iteration: 1383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511735141277313, gen p mean: -0.11364200711250305, mean p set: 0.45175236463546753
loss_pred:0.015315715223550797, decouple_loss:0.0006137415766716003
The modified gen p mean: 0.44999852776527405, gen p mean: -0.11111439019441605, mean p set: 0.4505756199359894The modified gen p mean: 0.4500805735588074, gen p mean: -0.11437822878360748, mean p set: 0.45065566897392273
loss_pred:0.015478923916816711, decouple_loss:0.0004955719341523945
loss_pred:0.015035116113722324, decouple_loss:0.00046045766794122756
Iteration: 1384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494341015815735, gen p mean: -0.10685688257217407, mean p set: 0.4500085711479187
loss_pred:0.01549378503113985, decouple_loss:0.0004416496376506984
The modified gen p mean: 0.4510989785194397, gen p mean: -0.11225636303424835, mean p set: 0.451677143573761
loss_pred:0.01522863656282425, decouple_loss:0.0004888687399215996
The modified gen p mean: 0.4490155577659607, gen p mean: -0.1057191863656044, mean p set: 0.4495929181575775
loss_pred:0.014941606670618057, decouple_loss:0.0005669352831318974
Iteration: 1385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489077031612396, gen p mean: -0.10477355867624283, mean p set: 0.44948339462280273
loss_pred:0.014658045023679733, decouple_loss:0.0005799977807328105
The modified gen p mean: 0.4502238631248474, gen p mean: -0.11114884912967682, mean p set: 0.45080122351646423
loss_pred:0.015288439579308033, decouple_loss:0.00042581825982779264
The modified gen p mean: 0.448981910943985, gen p mean: -0.1150149255990982, mean p set: 0.4495577812194824
loss_pred:0.014704440720379353, decouple_loss:0.0003909448569174856
Iteration: 1386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104607939720154, gen p mean: -0.10290984809398651, mean p set: 0.4516216814517975
The modified gen p mean: 0.4490940272808075, gen p mean: -0.11315800249576569, mean p set: 0.4496690630912781
loss_pred:0.01523697841912508, decouple_loss:0.000425099628046155
loss_pred:0.014278644695878029, decouple_loss:0.0004533312749117613
The modified gen p mean: 0.45116740465164185, gen p mean: -0.10922382771968842, mean p set: 0.45174553990364075
loss_pred:0.015110091306269169, decouple_loss:0.0006524172495119274
Iteration: 1387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493851065635681, gen p mean: -0.10235517472028732, mean p set: 0.44996196031570435
loss_pred:0.01551134418696165, decouple_loss:0.00043444911716505885
The modified gen p mean: 0.4512993097305298, gen p mean: -0.10947166383266449, mean p set: 0.45187583565711975
The modified gen p mean: 0.4517645537853241, gen p mean: -0.09955722093582153, mean p set: 0.4523402154445648
loss_pred:0.015232945792376995, decouple_loss:0.000481195718748495
loss_pred:0.015621084719896317, decouple_loss:0.00042818012298084795
Iteration: 1388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499375820159912, gen p mean: -0.10493135452270508, mean p set: 0.45051491260528564
loss_pred:0.01440514624118805, decouple_loss:0.00040410232031717896
The modified gen p mean: 0.4496266841888428, gen p mean: -0.10671702772378922, mean p set: 0.45020341873168945
The modified gen p mean: 0.4503626823425293, gen p mean: -0.10616438090801239, mean p set: 0.45093992352485657
loss_pred:0.015163956210017204, decouple_loss:0.0004412648268043995
loss_pred:0.015383410267531872, decouple_loss:0.00045312781003303826
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
NaN value num: 0
Iteration: 1389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535471796989441, gen p mean: -0.09788260608911514, mean p set: 0.45412477850914
The modified gen p mean: 0.45320144295692444, gen p mean: -0.09882402420043945, mean p set: 0.45377665758132935
loss_pred:0.015624918043613434, decouple_loss:0.0005997093394398689
loss_pred:0.01510187890380621, decouple_loss:0.0007100101793184876
The modified gen p mean: 0.45248672366142273, gen p mean: -0.10248956829309464, mean p set: 0.45306292176246643
loss_pred:0.01635034754872322, decouple_loss:0.0005313167930580676
Iteration: 1390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532390236854553, gen p mean: -0.0987435057759285, mean p set: 0.4538169205188751
loss_pred:0.014871637336909771, decouple_loss:0.00046279552043415606
The modified gen p mean: 0.4516690671443939, gen p mean: -0.09824052453041077, mean p set: 0.4522446393966675
The modified gen p mean: 0.4515674412250519, gen p mean: -0.10015878826379776, mean p set: 0.45214447379112244
loss_pred:0.015781408175826073, decouple_loss:0.0003676728520076722
loss_pred:0.015595450066030025, decouple_loss:0.0003966660879086703
2023-05-02 08:25:20 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1147664487361908, mean p set: 0.4502691626548767
loss_pred:0.017004799097776413, decouple_loss:0.0008872385951690376
The modified gen p mean: 0.4495360553264618, gen p mean: -0.10812799632549286, mean p set: 0.4500633478164673
loss_pred:0.01633935607969761, decouple_loss:0.0006132291746325791
The modified gen p mean: 0.4498263895511627, gen p mean: -0.10822927206754684, mean p set: 0.45035696029663086
loss_pred:0.016536662355065346, decouple_loss:0.0006917646969668567
WV_1_PC_1_EH_0_PS_40, loss: 0.016663476824760437, avg_mse: 0.02601010724902153
current test mse: 0.02601
Iteration: 1391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508522152900696, gen p mean: -0.0975596085190773, mean p set: 0.4514295160770416
loss_pred:0.015911277383565903, decouple_loss:0.0004105985863134265
The modified gen p mean: 0.45358148217201233, gen p mean: -0.10156188905239105, mean p set: 0.4541594386100769The modified gen p mean: 0.4518378674983978, gen p mean: -0.09114115685224533, mean p set: 0.4524155259132385
loss_pred:0.015557543374598026, decouple_loss:0.000561106251552701loss_pred:0.015102870762348175, decouple_loss:0.00046260052477009594
Iteration: 1392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526421129703522, gen p mean: -0.0997319296002388, mean p set: 0.4532190263271332
loss_pred:0.015338189899921417, decouple_loss:0.000434868416050449
The modified gen p mean: 0.4517519772052765, gen p mean: -0.09158681333065033, mean p set: 0.45232921838760376The modified gen p mean: 0.4536011517047882, gen p mean: -0.10060717910528183, mean p set: 0.45417800545692444
loss_pred:0.015416392125189304, decouple_loss:0.0004237977263983339
loss_pred:0.015642352402210236, decouple_loss:0.0005270458641462028
Iteration: 1393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538554251194, gen p mean: -0.10396703332662582, mean p set: 0.454429566860199
loss_pred:0.015257123857736588, decouple_loss:0.0004160872776992619
The modified gen p mean: 0.45316293835639954, gen p mean: -0.1001984179019928, mean p set: 0.4537392258644104
loss_pred:0.01573823392391205, decouple_loss:0.0004527471319306642
The modified gen p mean: 0.45280712842941284, gen p mean: -0.1004900112748146, mean p set: 0.4533842206001282
loss_pred:0.01595819555222988, decouple_loss:0.0005439835367724299
Iteration: 1394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45190608501434326, gen p mean: -0.10329651087522507, mean p set: 0.45248425006866455
loss_pred:0.01594395563006401, decouple_loss:0.0004504496755544096
The modified gen p mean: 0.45344242453575134, gen p mean: -0.1035287007689476, mean p set: 0.4540198743343353
loss_pred:0.015440724790096283, decouple_loss:0.0005162434536032379
The modified gen p mean: 0.45429667830467224, gen p mean: -0.10650226473808289, mean p set: 0.4548746943473816
loss_pred:0.015584458597004414, decouple_loss:0.0004923815722577274
Iteration: 1395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45347633957862854, gen p mean: -0.10477513819932938, mean p set: 0.45405256748199463
loss_pred:0.015930617228150368, decouple_loss:0.0006160418270155787
The modified gen p mean: 0.4532638192176819, gen p mean: -0.10058338940143585, mean p set: 0.4538425803184509
loss_pred:0.01585354283452034, decouple_loss:0.0004950287402607501
The modified gen p mean: 0.4524882435798645, gen p mean: -0.10817115753889084, mean p set: 0.4530661106109619
loss_pred:0.01514999009668827, decouple_loss:0.0005496167577803135
Iteration: 1396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45240527391433716, gen p mean: -0.10225265473127365, mean p set: 0.45298275351524353
loss_pred:0.016270173713564873, decouple_loss:0.0005198213621042669
The modified gen p mean: 0.4522106647491455, gen p mean: -0.10384055972099304, mean p set: 0.45278772711753845
loss_pred:0.016573090106248856, decouple_loss:0.0005442208494059741
The modified gen p mean: 0.4511841833591461, gen p mean: -0.10422446578741074, mean p set: 0.45176076889038086
loss_pred:0.014683286659419537, decouple_loss:0.00042261951602995396
Iteration: 1397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537331759929657, gen p mean: -0.09952686727046967, mean p set: 0.4543079137802124
loss_pred:0.016000237315893173, decouple_loss:0.0005236410070210695
The modified gen p mean: 0.4502531588077545, gen p mean: -0.098607636988163, mean p set: 0.4508306682109833
The modified gen p mean: 0.45222559571266174, gen p mean: -0.09765025228261948, mean p set: 0.45280152559280396
loss_pred:0.016051089391112328, decouple_loss:0.00044889087439514697
loss_pred:0.015925679355859756, decouple_loss:0.00041673489613458514
Iteration: 1398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4546499252319336, gen p mean: -0.10347837954759598, mean p set: 0.45522719621658325
loss_pred:0.01594184897840023, decouple_loss:0.0005175076657906175
The modified gen p mean: 0.45426931977272034, gen p mean: -0.10636545717716217, mean p set: 0.45484670996665955
The modified gen p mean: 0.45261329412460327, gen p mean: -0.10217886418104172, mean p set: 0.4531923532485962
loss_pred:0.01540249865502119, decouple_loss:0.00043368450133129954
loss_pred:0.016132529824972153, decouple_loss:0.0005282651982270181
Iteration: 1399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452224463224411, gen p mean: -0.1001046672463417, mean p set: 0.4528021812438965
loss_pred:0.015906406566500664, decouple_loss:0.0004742229066323489
The modified gen p mean: 0.45172062516212463, gen p mean: -0.1014019325375557, mean p set: 0.4522961974143982
The modified gen p mean: 0.4519362449645996, gen p mean: -0.09759709239006042, mean p set: 0.45251336693763733
loss_pred:0.016109520569443703, decouple_loss:0.000506075972225517
loss_pred:0.01632709987461567, decouple_loss:0.0006089673843234777
Iteration: 1400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45257827639579773, gen p mean: -0.10675825923681259, mean p set: 0.4531553387641907
The modified gen p mean: 0.4518067538738251, gen p mean: -0.10038075596094131, mean p set: 0.452383428812027
loss_pred:0.01570207253098488, decouple_loss:0.00043312791967764497
loss_pred:0.015853773802518845, decouple_loss:0.00045928015606477857
The modified gen p mean: 0.4523429572582245, gen p mean: -0.10562320798635483, mean p set: 0.4529195725917816
loss_pred:0.015637170523405075, decouple_loss:0.0003603560326155275
2023-05-02 08:27:25 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12327379733324051, mean p set: 0.4502691626548767
loss_pred:0.016965411603450775, decouple_loss:0.00045244235661812127
The modified gen p mean: 0.44953733682632446, gen p mean: -0.11606519669294357, mean p set: 0.4500633478164673
loss_pred:0.016331950202584267, decouple_loss:0.0004622644337359816
The modified gen p mean: 0.44983112812042236, gen p mean: -0.11625644564628601, mean p set: 0.45035696029663086
loss_pred:0.01659354567527771, decouple_loss:0.0004947492270730436
WV_1_PC_1_EH_0_PS_40, loss: 0.016653794795274734, avg_mse: 0.02598450519144535
current test mse: 0.025985
Iteration: 1401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530662000179291, gen p mean: -0.10695832222700119, mean p set: 0.4536438286304474
loss_pred:0.016061360016465187, decouple_loss:0.0005614287219941616
The modified gen p mean: 0.45304712653160095, gen p mean: -0.10815923660993576, mean p set: 0.45362505316734314
loss_pred:0.015741489827632904, decouple_loss:0.0006288405857048929
The modified gen p mean: 0.45441943407058716, gen p mean: -0.11394832283258438, mean p set: 0.4549979567527771
loss_pred:0.015751687809824944, decouple_loss:0.0006404515006579459
Iteration: 1402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510125517845154, gen p mean: -0.1036989837884903, mean p set: 0.45158764719963074
loss_pred:0.015720823779702187, decouple_loss:0.000440341595094651
The modified gen p mean: 0.4514642655849457, gen p mean: -0.10131952166557312, mean p set: 0.4520424008369446The modified gen p mean: 0.45163342356681824, gen p mean: -0.10701478272676468, mean p set: 0.45221033692359924
loss_pred:0.016124125570058823, decouple_loss:0.0004978419165126979
loss_pred:0.015134844928979874, decouple_loss:0.000534398655872792
Iteration: 1403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527411460876465, gen p mean: -0.11502735316753387, mean p set: 0.45331934094429016
loss_pred:0.01485538575798273, decouple_loss:0.0006566854426637292
The modified gen p mean: 0.4529569745063782, gen p mean: -0.1142054870724678, mean p set: 0.4535352885723114The modified gen p mean: 0.45151039958000183, gen p mean: -0.10979017615318298, mean p set: 0.45208826661109924
loss_pred:0.015212975442409515, decouple_loss:0.0007077702321112156
loss_pred:0.015189919620752335, decouple_loss:0.0005439271335490048
Iteration: 1404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45179814100265503, gen p mean: -0.11184876412153244, mean p set: 0.4523732364177704
loss_pred:0.01601393334567547, decouple_loss:0.0005229205125942826
The modified gen p mean: 0.4509911835193634, gen p mean: -0.11453858762979507, mean p set: 0.45156678557395935
loss_pred:0.015957394614815712, decouple_loss:0.0005418497603386641
The modified gen p mean: 0.4516133964061737, gen p mean: -0.11093167960643768, mean p set: 0.45219212770462036
loss_pred:0.015355133451521397, decouple_loss:0.0004213155771140009
Iteration: 1405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45254161953926086, gen p mean: -0.11574932187795639, mean p set: 0.453119158744812
loss_pred:0.01576661504805088, decouple_loss:0.0004680899146478623
The modified gen p mean: 0.4544859230518341, gen p mean: -0.11662980169057846, mean p set: 0.45506227016448975
loss_pred:0.015396148897707462, decouple_loss:0.000511844118591398
The modified gen p mean: 0.45182302594184875, gen p mean: -0.11461906135082245, mean p set: 0.452399343252182
loss_pred:0.01530337706208229, decouple_loss:0.00046333353384397924
Iteration: 1406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524526596069336, gen p mean: -0.11896726489067078, mean p set: 0.4530290365219116
loss_pred:0.015422324649989605, decouple_loss:0.0007109612342901528
The modified gen p mean: 0.45169031620025635, gen p mean: -0.11006103456020355, mean p set: 0.4522660970687866
loss_pred:0.016102246940135956, decouple_loss:0.000606341811362654
The modified gen p mean: 0.45182156562805176, gen p mean: -0.11831307411193848, mean p set: 0.4524010717868805
loss_pred:0.01614147610962391, decouple_loss:0.000681913283187896
Iteration: 1407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45216137170791626, gen p mean: -0.11868573725223541, mean p set: 0.45273926854133606
loss_pred:0.015217467211186886, decouple_loss:0.0006822458235546947
The modified gen p mean: 0.4529407024383545, gen p mean: -0.114335797727108, mean p set: 0.45351678133010864
loss_pred:0.015126029029488564, decouple_loss:0.0004276564868632704
The modified gen p mean: 0.4514591693878174, gen p mean: -0.11628808081150055, mean p set: 0.45203670859336853
loss_pred:0.016086295247077942, decouple_loss:0.0004868534451816231
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 1408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773995876312256, gen p mean: -0.12634582817554474, mean p set: 0.44831427931785583
loss_pred:0.015238722786307335, decouple_loss:0.0005057771923020482
The modified gen p mean: 0.44616982340812683, gen p mean: -0.12765809893608093, mean p set: 0.446748286485672
The modified gen p mean: 0.4463275074958801, gen p mean: -0.12467997521162033, mean p set: 0.44690370559692383
loss_pred:0.016042880713939667, decouple_loss:0.0005584151949733496
loss_pred:0.015417635440826416, decouple_loss:0.000539155793376267
Iteration: 1409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800713658332825, gen p mean: -0.12966816127300262, mean p set: 0.44858217239379883
loss_pred:0.015156473033130169, decouple_loss:0.0005932609201408923
The modified gen p mean: 0.4481877386569977, gen p mean: -0.12470252811908722, mean p set: 0.44876447319984436
loss_pred:0.014884719625115395, decouple_loss:0.00041629374027252197
The modified gen p mean: 0.44488298892974854, gen p mean: -0.13156773149967194, mean p set: 0.4454576373100281
loss_pred:0.015456668101251125, decouple_loss:0.00048280361806973815
Iteration: 1410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465869665145874, gen p mean: -0.12159917503595352, mean p set: 0.44716206192970276
loss_pred:0.015608915127813816, decouple_loss:0.0004858676402363926
The modified gen p mean: 0.44635024666786194, gen p mean: -0.13088002800941467, mean p set: 0.44692835211753845
The modified gen p mean: 0.44570791721343994, gen p mean: -0.12538988888263702, mean p set: 0.4462839961051941
loss_pred:0.014824718236923218, decouple_loss:0.0006574204890057445
loss_pred:0.015119124203920364, decouple_loss:0.0004516795161180198
2023-05-02 08:30:09 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12679195404052734, mean p set: 0.4502691626548767
loss_pred:0.01693558506667614, decouple_loss:0.0006167488172650337
The modified gen p mean: 0.4495362639427185, gen p mean: -0.12011734396219254, mean p set: 0.4500633478164673
loss_pred:0.01630331762135029, decouple_loss:0.0006298348307609558
The modified gen p mean: 0.449828177690506, gen p mean: -0.12029096484184265, mean p set: 0.45035696029663086
loss_pred:0.01653030700981617, decouple_loss:0.0005145332543179393
WV_1_PC_1_EH_0_PS_40, loss: 0.016619089990854263, avg_mse: 0.02593931555747986
current test mse: 0.025939
Iteration: 1411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688329100608826, gen p mean: -0.12338763475418091, mean p set: 0.4474574029445648
loss_pred:0.015318786725401878, decouple_loss:0.0005560712306760252
The modified gen p mean: 0.4449138939380646, gen p mean: -0.13035613298416138, mean p set: 0.44549062848091125The modified gen p mean: 0.4470348060131073, gen p mean: -0.12054579704999924, mean p set: 0.4476129114627838
loss_pred:0.015818389132618904, decouple_loss:0.0006014238460920751loss_pred:0.014913677237927914, decouple_loss:0.00040780569543130696
Iteration: 1412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477667808532715, gen p mean: -0.12710094451904297, mean p set: 0.4483422338962555
loss_pred:0.014990421943366528, decouple_loss:0.0005271998234093189
The modified gen p mean: 0.4471769332885742, gen p mean: -0.12630486488342285, mean p set: 0.44775307178497314The modified gen p mean: 0.44845327734947205, gen p mean: -0.12177620828151703, mean p set: 0.4490286707878113
loss_pred:0.014165529981255531, decouple_loss:0.0004939335631206632
loss_pred:0.01575988344848156, decouple_loss:0.0006617398466914892
Iteration: 1413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44684290885925293, gen p mean: -0.1250801384449005, mean p set: 0.44741740822792053
loss_pred:0.01605488359928131, decouple_loss:0.0004742917080875486
The modified gen p mean: 0.44762107729911804, gen p mean: -0.12813042104244232, mean p set: 0.4481981694698334
loss_pred:0.015545056201517582, decouple_loss:0.00047742691822350025
The modified gen p mean: 0.44622743129730225, gen p mean: -0.12835590541362762, mean p set: 0.44680383801460266
loss_pred:0.015105742029845715, decouple_loss:0.0004364652559161186
Iteration: 1414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478651285171509, gen p mean: -0.1281164288520813, mean p set: 0.44844114780426025
loss_pred:0.015229463577270508, decouple_loss:0.000482135423226282
The modified gen p mean: 0.44578295946121216, gen p mean: -0.12676388025283813, mean p set: 0.44635844230651855
loss_pred:0.01517053134739399, decouple_loss:0.0006431081565096974
The modified gen p mean: 0.4467178285121918, gen p mean: -0.12303923815488815, mean p set: 0.44729292392730713
loss_pred:0.015396219678223133, decouple_loss:0.0004949092981405556
Iteration: 1415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468686580657959, gen p mean: -0.1196080818772316, mean p set: 0.44744551181793213
loss_pred:0.014910687692463398, decouple_loss:0.0005255129071883857
The modified gen p mean: 0.4475034475326538, gen p mean: -0.12734000384807587, mean p set: 0.44808200001716614
loss_pred:0.014352885074913502, decouple_loss:0.00044986786087974906
The modified gen p mean: 0.44743427634239197, gen p mean: -0.11425738036632538, mean p set: 0.448009192943573
loss_pred:0.015269381925463676, decouple_loss:0.00044880693894810975
Iteration: 1416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447767049074173, gen p mean: -0.11946582049131393, mean p set: 0.44834378361701965
loss_pred:0.014551311731338501, decouple_loss:0.0005440638051368296
The modified gen p mean: 0.44735682010650635, gen p mean: -0.12605462968349457, mean p set: 0.4479331374168396
loss_pred:0.015243991278111935, decouple_loss:0.0005730930133722723
The modified gen p mean: 0.44781187176704407, gen p mean: -0.12707440555095673, mean p set: 0.44838783144950867
loss_pred:0.014981305226683617, decouple_loss:0.00043415301479399204
Iteration: 1417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446639746427536, gen p mean: -0.11513949185609818, mean p set: 0.44721704721450806
loss_pred:0.014511833898723125, decouple_loss:0.0004426600644364953
The modified gen p mean: 0.4470144510269165, gen p mean: -0.11821059882640839, mean p set: 0.44758957624435425
loss_pred:0.015209544450044632, decouple_loss:0.0003553426649887115
The modified gen p mean: 0.4471026360988617, gen p mean: -0.11657732725143433, mean p set: 0.4476804733276367
loss_pred:0.01571616902947426, decouple_loss:0.00045051341294310987
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763487577438354, gen p mean: -0.11748456954956055, mean p set: 0.448209285736084
loss_pred:0.014677482657134533, decouple_loss:0.0005997518310323358
The modified gen p mean: 0.44777926802635193, gen p mean: -0.11840523779392242, mean p set: 0.4483581483364105
loss_pred:0.014227312989532948, decouple_loss:0.0005298116593621671
The modified gen p mean: 0.4489389657974243, gen p mean: -0.12232736498117447, mean p set: 0.4495137631893158
loss_pred:0.014759756624698639, decouple_loss:0.0005403034156188369
Iteration: 1419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485001564025879, gen p mean: -0.11960498988628387, mean p set: 0.44907715916633606
loss_pred:0.014552121050655842, decouple_loss:0.00046587243559770286
The modified gen p mean: 0.4463895559310913, gen p mean: -0.12450145930051804, mean p set: 0.44696754217147827
loss_pred:0.014190123416483402, decouple_loss:0.0004552482860162854
The modified gen p mean: 0.44613197445869446, gen p mean: -0.11913171410560608, mean p set: 0.4467063546180725
loss_pred:0.015275975689291954, decouple_loss:0.0003984453796874732
Iteration: 1420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471181631088257, gen p mean: -0.12415914982557297, mean p set: 0.44769522547721863
loss_pred:0.015132321044802666, decouple_loss:0.0005117318942211568
The modified gen p mean: 0.44712403416633606, gen p mean: -0.11879779398441315, mean p set: 0.4477007985115051
The modified gen p mean: 0.44731393456459045, gen p mean: -0.11592750251293182, mean p set: 0.4478902518749237
loss_pred:0.015203472226858139, decouple_loss:0.0004951092414557934
loss_pred:0.015351591631770134, decouple_loss:0.0005205089692026377
2023-05-02 08:32:14 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12601016461849213, mean p set: 0.4502691626548767
loss_pred:0.017092902213335037, decouple_loss:0.000461237330455333
The modified gen p mean: 0.44953453540802, gen p mean: -0.11914646625518799, mean p set: 0.4500633478164673
loss_pred:0.016303086653351784, decouple_loss:0.00046092295087873936
The modified gen p mean: 0.44982847571372986, gen p mean: -0.11902987211942673, mean p set: 0.45035696029663086
loss_pred:0.01662733219563961, decouple_loss:0.0005565809551626444
WV_1_PC_1_EH_0_PS_40, loss: 0.016699086874723434, avg_mse: 0.026086341589689255
current test mse: 0.026086
Iteration: 1421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466054141521454, gen p mean: -0.12380074709653854, mean p set: 0.44717955589294434
loss_pred:0.014729496091604233, decouple_loss:0.0005146775511093438
The modified gen p mean: 0.44650906324386597, gen p mean: -0.12576234340667725, mean p set: 0.44708412885665894
loss_pred:0.015104654245078564, decouple_loss:0.00047287208144553006
The modified gen p mean: 0.44540464878082275, gen p mean: -0.13087022304534912, mean p set: 0.44598105549812317
loss_pred:0.014658789150416851, decouple_loss:0.0004173320485278964
Iteration: 1422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471789002418518, gen p mean: -0.11552463471889496, mean p set: 0.4477542042732239
The modified gen p mean: 0.4468204379081726, gen p mean: -0.1259431093931198, mean p set: 0.44739776849746704
loss_pred:0.01532097440212965, decouple_loss:0.00047086525592021644
loss_pred:0.014723681844770908, decouple_loss:0.00044013519072905183
The modified gen p mean: 0.4458822011947632, gen p mean: -0.12927645444869995, mean p set: 0.446456640958786
loss_pred:0.014816496521234512, decouple_loss:0.0004567960277199745
Iteration: 1423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465126395225525, gen p mean: -0.12938916683197021, mean p set: 0.4470905363559723
The modified gen p mean: 0.4462018311023712, gen p mean: -0.12531989812850952, mean p set: 0.4467789828777313
loss_pred:0.014768009074032307, decouple_loss:0.000518354878295213
loss_pred:0.01507883332669735, decouple_loss:0.0005126055330038071
The modified gen p mean: 0.44601356983184814, gen p mean: -0.1281578540802002, mean p set: 0.4465861916542053
loss_pred:0.014771644957363605, decouple_loss:0.0004342893080320209
Iteration: 1424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457545578479767, gen p mean: -0.1235000267624855, mean p set: 0.4463306665420532
loss_pred:0.015066423453390598, decouple_loss:0.00046935322461649776
The modified gen p mean: 0.4465845823287964, gen p mean: -0.1234816312789917, mean p set: 0.44716131687164307
loss_pred:0.015173351392149925, decouple_loss:0.00044347631046548486
The modified gen p mean: 0.4463649392127991, gen p mean: -0.11785067617893219, mean p set: 0.44694095849990845
loss_pred:0.015694880858063698, decouple_loss:0.00035180404665879905
Iteration: 1425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480397701263428, gen p mean: -0.12107731401920319, mean p set: 0.44861549139022827
loss_pred:0.014930902980268002, decouple_loss:0.00041070111910812557
The modified gen p mean: 0.4471380114555359, gen p mean: -0.12232515960931778, mean p set: 0.44771286845207214
loss_pred:0.014675650745630264, decouple_loss:0.00046744971768930554
The modified gen p mean: 0.4464494287967682, gen p mean: -0.12259379774332047, mean p set: 0.4470267593860626
loss_pred:0.014822478406131268, decouple_loss:0.0005408817087300122
Iteration: 1426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446532666683197, gen p mean: -0.12027516216039658, mean p set: 0.44710773229599
loss_pred:0.015072931535542011, decouple_loss:0.00040045901550911367
The modified gen p mean: 0.44736194610595703, gen p mean: -0.12357331812381744, mean p set: 0.44793781638145447
loss_pred:0.015385297127068043, decouple_loss:0.0004023680230602622
The modified gen p mean: 0.44635507464408875, gen p mean: -0.1178879514336586, mean p set: 0.4469318985939026
loss_pred:0.015298648737370968, decouple_loss:0.00044276416883803904
Iteration: 1427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474523365497589, gen p mean: -0.12594102323055267, mean p set: 0.44802701473236084
loss_pred:0.013540158048272133, decouple_loss:0.0005578576819971204
The modified gen p mean: 0.44548267126083374, gen p mean: -0.11797057092189789, mean p set: 0.4460590183734894
The modified gen p mean: 0.44830575585365295, gen p mean: -0.12028367817401886, mean p set: 0.448881059885025
loss_pred:0.014946064911782742, decouple_loss:0.00048796850023791194
loss_pred:0.014821063727140427, decouple_loss:0.0003618396585807204
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 1428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901329278945923, gen p mean: -0.11368558555841446, mean p set: 0.44958946108818054
loss_pred:0.014791506342589855, decouple_loss:0.0004730567161459476
The modified gen p mean: 0.44925951957702637, gen p mean: -0.12198249250650406, mean p set: 0.44983842968940735
The modified gen p mean: 0.4483047127723694, gen p mean: -0.10574209690093994, mean p set: 0.44888070225715637
loss_pred:0.015310385264456272, decouple_loss:0.00048009620513767004
loss_pred:0.014545976184308529, decouple_loss:0.000568397983442992
Iteration: 1429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804105162620544, gen p mean: -0.11318881064653397, mean p set: 0.44861605763435364
loss_pred:0.014753231778740883, decouple_loss:0.0004931321018375456
The modified gen p mean: 0.4503118097782135, gen p mean: -0.11090728640556335, mean p set: 0.4508882462978363
loss_pred:0.014759749174118042, decouple_loss:0.0006309664458967745
The modified gen p mean: 0.4492637515068054, gen p mean: -0.11437755823135376, mean p set: 0.4498407244682312
loss_pred:0.014863426797091961, decouple_loss:0.0005331141292117536
Iteration: 1430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779831171035767, gen p mean: -0.10908986628055573, mean p set: 0.44837456941604614
loss_pred:0.014701196923851967, decouple_loss:0.0004867439274676144
The modified gen p mean: 0.4491117298603058, gen p mean: -0.11752134561538696, mean p set: 0.449687123298645
loss_pred:0.015407112427055836, decouple_loss:0.0004999068914912641
The modified gen p mean: 0.4479980170726776, gen p mean: -0.11298360675573349, mean p set: 0.4485769271850586
loss_pred:0.014422551728785038, decouple_loss:0.0004248363838996738
2023-05-02 08:34:59 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12029291689395905, mean p set: 0.4502691626548767
loss_pred:0.01696586422622204, decouple_loss:0.00046395821846090257
The modified gen p mean: 0.4495333731174469, gen p mean: -0.11369448900222778, mean p set: 0.4500633478164673
loss_pred:0.016234800219535828, decouple_loss:0.0005385007825680077
The modified gen p mean: 0.4498313069343567, gen p mean: -0.11388245970010757, mean p set: 0.45035696029663086
loss_pred:0.016562137752771378, decouple_loss:0.000663223210722208
WV_1_PC_1_EH_0_PS_40, loss: 0.016615360975265503, avg_mse: 0.02597702108323574
current test mse: 0.025977
Iteration: 1431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44888147711753845, gen p mean: -0.11464741826057434, mean p set: 0.44945788383483887
loss_pred:0.0143831642344594, decouple_loss:0.00041508328285999596
The modified gen p mean: 0.4489240348339081, gen p mean: -0.11687545478343964, mean p set: 0.44949984550476074
loss_pred:0.014878091402351856, decouple_loss:0.0005074936198070645
The modified gen p mean: 0.4496930241584778, gen p mean: -0.11514618992805481, mean p set: 0.4502703547477722
loss_pred:0.015035102143883705, decouple_loss:0.0006224152748472989
Iteration: 1432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482923150062561, gen p mean: -0.12140808999538422, mean p set: 0.4488680362701416
loss_pred:0.014109001494944096, decouple_loss:0.00048293228610418737
The modified gen p mean: 0.4493463635444641, gen p mean: -0.10996824502944946, mean p set: 0.4499235153198242The modified gen p mean: 0.448453426361084, gen p mean: -0.11871489882469177, mean p set: 0.44902855157852173
loss_pred:0.015086628496646881, decouple_loss:0.0004785086784977466
loss_pred:0.015141329728066921, decouple_loss:0.00047616491792723536
Iteration: 1433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476315975189209, gen p mean: -0.11776766180992126, mean p set: 0.44820865988731384
loss_pred:0.014883813448250294, decouple_loss:0.0005965196760371327
The modified gen p mean: 0.4489838480949402, gen p mean: -0.11835640668869019, mean p set: 0.4495595097541809The modified gen p mean: 0.4487142264842987, gen p mean: -0.11765719205141068, mean p set: 0.449288934469223
loss_pred:0.014749478548765182, decouple_loss:0.0005316463066264987
loss_pred:0.014854342676699162, decouple_loss:0.000575015670619905
Iteration: 1434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787153601646423, gen p mean: -0.11118511855602264, mean p set: 0.44844722747802734
loss_pred:0.014966842718422413, decouple_loss:0.0004267965559847653
The modified gen p mean: 0.449428528547287, gen p mean: -0.12573423981666565, mean p set: 0.4500042200088501
loss_pred:0.015014763921499252, decouple_loss:0.000434187677456066
The modified gen p mean: 0.4477931559085846, gen p mean: -0.11423379182815552, mean p set: 0.4483669102191925
loss_pred:0.014588353224098682, decouple_loss:0.00043526128865778446
Iteration: 1435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714778661727905, gen p mean: -0.11493336409330368, mean p set: 0.4477255642414093
loss_pred:0.014141654595732689, decouple_loss:0.00038791223778389394
The modified gen p mean: 0.4472902715206146, gen p mean: -0.12476593255996704, mean p set: 0.4478663504123688
loss_pred:0.014316650107502937, decouple_loss:0.0004265637253411114
The modified gen p mean: 0.44902244210243225, gen p mean: -0.12164910137653351, mean p set: 0.4495994448661804
loss_pred:0.014840350486338139, decouple_loss:0.0004347061039879918
Iteration: 1436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903624057769775, gen p mean: -0.11790318787097931, mean p set: 0.4496126174926758
loss_pred:0.014179193414747715, decouple_loss:0.0006927335052751005
The modified gen p mean: 0.44876953959465027, gen p mean: -0.12167564779520035, mean p set: 0.4493459463119507
loss_pred:0.015307295136153698, decouple_loss:0.0007032006978988647
The modified gen p mean: 0.44866007566452026, gen p mean: -0.10884532332420349, mean p set: 0.4492368996143341
loss_pred:0.014673633500933647, decouple_loss:0.0005419593653641641
Iteration: 1437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500586688518524, gen p mean: -0.11279278248548508, mean p set: 0.4506332576274872
loss_pred:0.014026280492544174, decouple_loss:0.000491386279463768
The modified gen p mean: 0.4485609233379364, gen p mean: -0.11901192367076874, mean p set: 0.449137419462204
loss_pred:0.014755871146917343, decouple_loss:0.000458691269159317
The modified gen p mean: 0.44747838377952576, gen p mean: -0.1149391382932663, mean p set: 0.448056697845459
loss_pred:0.014180843718349934, decouple_loss:0.0004022723587695509
Iteration: 1438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480138421058655, gen p mean: -0.10875976830720901, mean p set: 0.4485895335674286
loss_pred:0.014025140553712845, decouple_loss:0.00038660800782963634
The modified gen p mean: 0.44805771112442017, gen p mean: -0.11548957228660583, mean p set: 0.448634535074234
loss_pred:0.014504306018352509, decouple_loss:0.00037918126326985657
The modified gen p mean: 0.4498879611492157, gen p mean: -0.11312287300825119, mean p set: 0.45046207308769226
loss_pred:0.014466587454080582, decouple_loss:0.000507097109220922
Iteration: 1439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448434054851532, gen p mean: -0.11711245030164719, mean p set: 0.44900989532470703
loss_pred:0.014654915779829025, decouple_loss:0.0004308266506996006
The modified gen p mean: 0.4483858048915863, gen p mean: -0.12468178570270538, mean p set: 0.44896194338798523
loss_pred:0.015075654722750187, decouple_loss:0.0006802663556300104
The modified gen p mean: 0.4463936686515808, gen p mean: -0.12306346744298935, mean p set: 0.4469698667526245
loss_pred:0.01441715843975544, decouple_loss:0.00046538497554138303
Iteration: 1440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45005425810813904, gen p mean: -0.11660128086805344, mean p set: 0.45063140988349915
loss_pred:0.014525411650538445, decouple_loss:0.00042952122748829424
The modified gen p mean: 0.4486508071422577, gen p mean: -0.12259475886821747, mean p set: 0.4492279887199402
loss_pred:0.014101080596446991, decouple_loss:0.0004098860954400152
The modified gen p mean: 0.4492933452129364, gen p mean: -0.11537808924913406, mean p set: 0.4498685300350189
loss_pred:0.015040161088109016, decouple_loss:0.00037367723416537046
2023-05-02 08:37:07 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12568330764770508, mean p set: 0.4502691626548767
loss_pred:0.016958337277173996, decouple_loss:0.0004262936708983034
The modified gen p mean: 0.44953590631484985, gen p mean: -0.11930174380540848, mean p set: 0.4500633478164673
loss_pred:0.01621846854686737, decouple_loss:0.0004446636885404587
The modified gen p mean: 0.4498291313648224, gen p mean: -0.11946006864309311, mean p set: 0.45035696029663086
loss_pred:0.01654517650604248, decouple_loss:0.0004544967378024012
WV_1_PC_1_EH_0_PS_40, loss: 0.016596084460616112, avg_mse: 0.02590353414416313
current test mse: 0.025904
Iteration: 1441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860216975212097, gen p mean: -0.1206311509013176, mean p set: 0.44917967915534973
loss_pred:0.014426310546696186, decouple_loss:0.0004232451901771128
The modified gen p mean: 0.44777390360832214, gen p mean: -0.1171761304140091, mean p set: 0.4483490288257599The modified gen p mean: 0.45010554790496826, gen p mean: -0.11991610378026962, mean p set: 0.450682133436203
loss_pred:0.01441975124180317, decouple_loss:0.00040443340549245477
loss_pred:0.014580909162759781, decouple_loss:0.00040917686419561505
Iteration: 1442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801443815231323, gen p mean: -0.11687400192022324, mean p set: 0.4485909342765808
loss_pred:0.015092716552317142, decouple_loss:0.0005535853561013937
The modified gen p mean: 0.4487825334072113, gen p mean: -0.1257898360490799, mean p set: 0.44936034083366394The modified gen p mean: 0.4490719139575958, gen p mean: -0.12137177586555481, mean p set: 0.44964301586151123
loss_pred:0.014441034756600857, decouple_loss:0.00042071507778018713
loss_pred:0.015083902515470982, decouple_loss:0.0004046373360324651
Iteration: 1443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465272128582001, gen p mean: -0.12677866220474243, mean p set: 0.44710251688957214
loss_pred:0.014574697241187096, decouple_loss:0.00047972091124393046
The modified gen p mean: 0.44972363114356995, gen p mean: -0.11702749878168106, mean p set: 0.45029905438423157The modified gen p mean: 0.4487486481666565, gen p mean: -0.1194535568356514, mean p set: 0.44932347536087036
loss_pred:0.014688043855130672, decouple_loss:0.0004925522953271866
loss_pred:0.014279576018452644, decouple_loss:0.0003922398027498275
Iteration: 1444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948455691337585, gen p mean: -0.1254929155111313, mean p set: 0.4500616788864136
The modified gen p mean: 0.44930410385131836, gen p mean: -0.12241692841053009, mean p set: 0.44987955689430237
loss_pred:0.014615205116569996, decouple_loss:0.00039289984852075577
loss_pred:0.0144196143373847, decouple_loss:0.0004715890099760145
The modified gen p mean: 0.44840943813323975, gen p mean: -0.12460552901029587, mean p set: 0.44898566603660583
loss_pred:0.014332061633467674, decouple_loss:0.0004728756030090153
Iteration: 1445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762954115867615, gen p mean: -0.1231595054268837, mean p set: 0.44820713996887207
loss_pred:0.014980122447013855, decouple_loss:0.0004439468029886484
The modified gen p mean: 0.4496494233608246, gen p mean: -0.11889327317476273, mean p set: 0.45022737979888916
loss_pred:0.014935506507754326, decouple_loss:0.00038528500590473413
The modified gen p mean: 0.4487341642379761, gen p mean: -0.12539589405059814, mean p set: 0.44930922985076904
loss_pred:0.014321496710181236, decouple_loss:0.00039541360456496477
Iteration: 1446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937682151794434, gen p mean: -0.11648201197385788, mean p set: 0.4499533474445343
The modified gen p mean: 0.4483668804168701, gen p mean: -0.11563871055841446, mean p set: 0.448943167924881
loss_pred:0.014535740949213505, decouple_loss:0.0004946898552589118
loss_pred:0.014400152489542961, decouple_loss:0.00048557345871813595
The modified gen p mean: 0.44980981945991516, gen p mean: -0.11978393793106079, mean p set: 0.4503842294216156
loss_pred:0.014697562903165817, decouple_loss:0.00041166500886902213
Iteration: 1447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754648208618164, gen p mean: -0.12174073606729507, mean p set: 0.4481198489665985
loss_pred:0.014265540987253189, decouple_loss:0.0004205030563753098
The modified gen p mean: 0.4491770267486572, gen p mean: -0.11891364306211472, mean p set: 0.44975459575653076
loss_pred:0.014315420761704445, decouple_loss:0.00034951019915752113
The modified gen p mean: 0.4484640955924988, gen p mean: -0.1271040141582489, mean p set: 0.44904085993766785
loss_pred:0.01417495496571064, decouple_loss:0.00035628461046144366
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
NaN value num: 0
Iteration: 1448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761016964912415, gen p mean: -0.11742720007896423, mean p set: 0.4481865465641022
The modified gen p mean: 0.44655725359916687, gen p mean: -0.1195889487862587, mean p set: 0.4471317529678345
loss_pred:0.015744434669613838, decouple_loss:0.000420898461015895
loss_pred:0.01702634058892727, decouple_loss:0.0004691999056376517
The modified gen p mean: 0.44470852613449097, gen p mean: -0.12085919082164764, mean p set: 0.4452835023403168
loss_pred:0.01688656583428383, decouple_loss:0.0005291384877637029
Iteration: 1449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471144676208496, gen p mean: -0.11909399181604385, mean p set: 0.4476911425590515
loss_pred:0.01595974527299404, decouple_loss:0.00037103952490724623
The modified gen p mean: 0.4479001760482788, gen p mean: -0.118145652115345, mean p set: 0.44847550988197327
loss_pred:0.016480371356010437, decouple_loss:0.0004776513669639826
The modified gen p mean: 0.4472041726112366, gen p mean: -0.12091671675443649, mean p set: 0.44777825474739075
loss_pred:0.016863210126757622, decouple_loss:0.0005298234755173326
Iteration: 1450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715267419815063, gen p mean: -0.11634451150894165, mean p set: 0.44772669672966003
loss_pred:0.01582268998026848, decouple_loss:0.00039549320354126394
The modified gen p mean: 0.4470854699611664, gen p mean: -0.11979233473539352, mean p set: 0.44765937328338623
The modified gen p mean: 0.4467224180698395, gen p mean: -0.1213439553976059, mean p set: 0.4472973346710205
loss_pred:0.015718532726168633, decouple_loss:0.00037485850043594837
loss_pred:0.0163976289331913, decouple_loss:0.0004249558551236987
2023-05-02 08:39:49 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1209675595164299, mean p set: 0.4502691626548767
loss_pred:0.016932442784309387, decouple_loss:0.0004944512038491666
The modified gen p mean: 0.4495333433151245, gen p mean: -0.11427049338817596, mean p set: 0.4500633478164673
loss_pred:0.016170136630535126, decouple_loss:0.00048125992179848254
The modified gen p mean: 0.44982802867889404, gen p mean: -0.11417300254106522, mean p set: 0.45035696029663086
loss_pred:0.016451645642518997, decouple_loss:0.0004205175209790468
WV_1_PC_1_EH_0_PS_40, loss: 0.01654134690761566, avg_mse: 0.025837237015366554
current test mse: 0.025837
Iteration: 1451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460883140563965, gen p mean: -0.11570330709218979, mean p set: 0.4466627538204193
loss_pred:0.01697673462331295, decouple_loss:0.00044203607831150293
The modified gen p mean: 0.44678935408592224, gen p mean: -0.11595364660024643, mean p set: 0.4473651349544525The modified gen p mean: 0.4466298222541809, gen p mean: -0.11669605225324631, mean p set: 0.4472050368785858
loss_pred:0.015996178612113, decouple_loss:0.0005249602254480124
loss_pred:0.016995059326291084, decouple_loss:0.00038929213769733906
Iteration: 1452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680696725845337, gen p mean: -0.1154714897274971, mean p set: 0.44738152623176575
loss_pred:0.01739056035876274, decouple_loss:0.00038261828012764454
The modified gen p mean: 0.4473414719104767, gen p mean: -0.11658377945423126, mean p set: 0.44791650772094727The modified gen p mean: 0.4482840597629547, gen p mean: -0.11549936234951019, mean p set: 0.44885969161987305
loss_pred:0.016754556447267532, decouple_loss:0.00041214691009372473
loss_pred:0.016292531043291092, decouple_loss:0.0003943385381717235
Iteration: 1453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789353013038635, gen p mean: -0.11490203440189362, mean p set: 0.44847017526626587
loss_pred:0.015788942575454712, decouple_loss:0.0004232617502566427
The modified gen p mean: 0.44811367988586426, gen p mean: -0.11305919289588928, mean p set: 0.448689341545105
loss_pred:0.015658661723136902, decouple_loss:0.0003732900077011436
The modified gen p mean: 0.44733116030693054, gen p mean: -0.11258566379547119, mean p set: 0.44790738821029663
loss_pred:0.015615520998835564, decouple_loss:0.00046048895455896854
Iteration: 1454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44652754068374634, gen p mean: -0.11680079996585846, mean p set: 0.44710254669189453
loss_pred:0.017034534364938736, decouple_loss:0.0004880203923676163
The modified gen p mean: 0.44687420129776, gen p mean: -0.11419490724802017, mean p set: 0.44744715094566345
loss_pred:0.01690489798784256, decouple_loss:0.00047099453513510525
The modified gen p mean: 0.44779014587402344, gen p mean: -0.11574860662221909, mean p set: 0.4483644366264343
loss_pred:0.01563148759305477, decouple_loss:0.00038691243389621377
Iteration: 1455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482581615447998, gen p mean: -0.12352172285318375, mean p set: 0.44883349537849426
loss_pred:0.016130121424794197, decouple_loss:0.00044895842438563704
The modified gen p mean: 0.44436922669410706, gen p mean: -0.1158246174454689, mean p set: 0.4449447691440582
loss_pred:0.01693532057106495, decouple_loss:0.0004567579017020762
The modified gen p mean: 0.447233647108078, gen p mean: -0.11415703594684601, mean p set: 0.44780823588371277
loss_pred:0.01561126671731472, decouple_loss:0.00033509076456539333
Iteration: 1456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682469964027405, gen p mean: -0.12307894229888916, mean p set: 0.4473983943462372
loss_pred:0.015678510069847107, decouple_loss:0.0004792643594555557
The modified gen p mean: 0.44701817631721497, gen p mean: -0.12284909188747406, mean p set: 0.4475955367088318
loss_pred:0.015187853015959263, decouple_loss:0.0004588782030623406
The modified gen p mean: 0.44815218448638916, gen p mean: -0.12117045372724533, mean p set: 0.4487268626689911
loss_pred:0.01679474115371704, decouple_loss:0.0004743894678540528
Iteration: 1457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839221239089966, gen p mean: -0.12013755738735199, mean p set: 0.4489684998989105
loss_pred:0.015556815080344677, decouple_loss:0.000398677890188992
The modified gen p mean: 0.4464070796966553, gen p mean: -0.12131428718566895, mean p set: 0.4469830095767975
loss_pred:0.016669386997818947, decouple_loss:0.00038390851113945246
The modified gen p mean: 0.44441038370132446, gen p mean: -0.12154211848974228, mean p set: 0.4449867010116577
loss_pred:0.016952242702245712, decouple_loss:0.0004166151338722557
Iteration: 1458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791558384895325, gen p mean: -0.12299808114767075, mean p set: 0.44849109649658203
loss_pred:0.015791503712534904, decouple_loss:0.0004681331920437515
The modified gen p mean: 0.4480268061161041, gen p mean: -0.1211840808391571, mean p set: 0.44860225915908813
The modified gen p mean: 0.4467143714427948, gen p mean: -0.12503814697265625, mean p set: 0.4472928047180176
loss_pred:0.01651722937822342, decouple_loss:0.0005633604014292359
loss_pred:0.01689746417105198, decouple_loss:0.00043690757593140006
Iteration: 1459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473411738872528, gen p mean: -0.12877939641475677, mean p set: 0.44791924953460693
loss_pred:0.016229841858148575, decouple_loss:0.00047434575390070677
The modified gen p mean: 0.44839009642601013, gen p mean: -0.12285623699426651, mean p set: 0.4489658772945404
The modified gen p mean: 0.4472023844718933, gen p mean: -0.12619081139564514, mean p set: 0.4477783739566803
loss_pred:0.016839541494846344, decouple_loss:0.00042165996273979545
loss_pred:0.017113329842686653, decouple_loss:0.0003811111382674426
Iteration: 1460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729679822921753, gen p mean: -0.11450471729040146, mean p set: 0.4478755593299866
loss_pred:0.015596325509250164, decouple_loss:0.00043878305586986244
The modified gen p mean: 0.44486793875694275, gen p mean: -0.11744842678308487, mean p set: 0.4454438388347626
loss_pred:0.016574665904045105, decouple_loss:0.00042729880078695714
The modified gen p mean: 0.44710254669189453, gen p mean: -0.12540973722934723, mean p set: 0.4476792514324188
loss_pred:0.01697959192097187, decouple_loss:0.0003948085068259388
2023-05-02 08:41:56 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1248800978064537, mean p set: 0.4502691626548767
loss_pred:0.016996366903185844, decouple_loss:0.0005262611084617674
The modified gen p mean: 0.4495350420475006, gen p mean: -0.11824098974466324, mean p set: 0.4500633478164673
loss_pred:0.016213862225413322, decouple_loss:0.0004567853466141969
The modified gen p mean: 0.4498298168182373, gen p mean: -0.11799903959035873, mean p set: 0.45035696029663086
loss_pred:0.01646285690367222, decouple_loss:0.0003734822676051408
WV_1_PC_1_EH_0_PS_40, loss: 0.016580304130911827, avg_mse: 0.025963816791772842
current test mse: 0.025964
Iteration: 1461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459346830844879, gen p mean: -0.12105227261781693, mean p set: 0.44650891423225403
loss_pred:0.016326572746038437, decouple_loss:0.000439973984612152
The modified gen p mean: 0.4473535716533661, gen p mean: -0.1197652742266655, mean p set: 0.4479292929172516
loss_pred:0.01627710834145546, decouple_loss:0.000522627669852227
The modified gen p mean: 0.44748368859291077, gen p mean: -0.121332086622715, mean p set: 0.44805940985679626
loss_pred:0.016200711950659752, decouple_loss:0.0004203751450404525
Iteration: 1462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467681348323822, gen p mean: -0.12434651702642441, mean p set: 0.4473438560962677
loss_pred:0.016360238194465637, decouple_loss:0.0004303595924284309
The modified gen p mean: 0.4474305808544159, gen p mean: -0.12103056162595749, mean p set: 0.4480046033859253The modified gen p mean: 0.4475126564502716, gen p mean: -0.1211186870932579, mean p set: 0.4480881989002228
loss_pred:0.016072824597358704, decouple_loss:0.0005655277636833489
loss_pred:0.015167185105383396, decouple_loss:0.0003983252972830087
Iteration: 1463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468819797039032, gen p mean: -0.1266852468252182, mean p set: 0.4474547207355499
loss_pred:0.016278693452477455, decouple_loss:0.0005035109352320433
The modified gen p mean: 0.4479485750198364, gen p mean: -0.12632153928279877, mean p set: 0.44852742552757263
loss_pred:0.017096146941184998, decouple_loss:0.000451727508334443
The modified gen p mean: 0.44813162088394165, gen p mean: -0.12606923282146454, mean p set: 0.44870737195014954
loss_pred:0.015593334101140499, decouple_loss:0.00038125936407595873
Iteration: 1464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467664062976837, gen p mean: -0.1272364854812622, mean p set: 0.44734519720077515
loss_pred:0.016704214736819267, decouple_loss:0.0003560876357369125
The modified gen p mean: 0.4479617774486542, gen p mean: -0.12711115181446075, mean p set: 0.44853606820106506
loss_pred:0.016505077481269836, decouple_loss:0.00042132739326916635
The modified gen p mean: 0.4471677839756012, gen p mean: -0.12854573130607605, mean p set: 0.447741836309433
loss_pred:0.016580330207943916, decouple_loss:0.0004319845756981522
Iteration: 1465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466438591480255, gen p mean: -0.12481044977903366, mean p set: 0.4472196698188782
loss_pred:0.016260093078017235, decouple_loss:0.0003757979138754308
The modified gen p mean: 0.4470481276512146, gen p mean: -0.12455755472183228, mean p set: 0.4476243257522583
loss_pred:0.017092222347855568, decouple_loss:0.0004027386603411287
The modified gen p mean: 0.4475792944431305, gen p mean: -0.12378355115652084, mean p set: 0.4481572210788727
loss_pred:0.016473840922117233, decouple_loss:0.0003883092722389847
Iteration: 1466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44544515013694763, gen p mean: -0.1241043359041214, mean p set: 0.44602203369140625
loss_pred:0.01658550836145878, decouple_loss:0.00042791978921741247
The modified gen p mean: 0.4476143717765808, gen p mean: -0.12012628465890884, mean p set: 0.4481930732727051
The modified gen p mean: 0.44801387190818787, gen p mean: -0.126747265458107, mean p set: 0.44859054684638977
loss_pred:0.01655362918972969, decouple_loss:0.000395577255403623
loss_pred:0.016519224271178246, decouple_loss:0.000553518591914326
Iteration: 1467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830450415611267, gen p mean: -0.12600845098495483, mean p set: 0.4488775134086609
loss_pred:0.016509147360920906, decouple_loss:0.00037984453956596553
The modified gen p mean: 0.44702452421188354, gen p mean: -0.11969011276960373, mean p set: 0.4476010203361511
loss_pred:0.015615565702319145, decouple_loss:0.00040539063047617674
The modified gen p mean: 0.4474000632762909, gen p mean: -0.12061984091997147, mean p set: 0.4479779005050659
loss_pred:0.017044898122549057, decouple_loss:0.0003933004045393318
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
NaN value num: 0
Iteration: 1468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497590959072113, gen p mean: -0.11866524815559387, mean p set: 0.4503363370895386
The modified gen p mean: 0.4502410888671875, gen p mean: -0.12123072892427444, mean p set: 0.45081907510757446
loss_pred:0.016505029052495956, decouple_loss:0.0004468748811632395
loss_pred:0.016163542866706848, decouple_loss:0.00043488809023983777
The modified gen p mean: 0.4508310854434967, gen p mean: -0.12623971700668335, mean p set: 0.45140841603279114
loss_pred:0.01624785177409649, decouple_loss:0.0004668570472858846
Iteration: 1469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506358504295349, gen p mean: -0.12304806709289551, mean p set: 0.451210081577301
loss_pred:0.01582874357700348, decouple_loss:0.0004586206341627985
The modified gen p mean: 0.4491319954395294, gen p mean: -0.12001719325780869, mean p set: 0.449710875749588
loss_pred:0.017021069303154945, decouple_loss:0.000432550412369892
The modified gen p mean: 0.4490559995174408, gen p mean: -0.12259722501039505, mean p set: 0.4496335983276367
loss_pred:0.015771588310599327, decouple_loss:0.00045203830813989043
Iteration: 1470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44974485039711, gen p mean: -0.1251559853553772, mean p set: 0.4503205716609955
loss_pred:0.016654251143336296, decouple_loss:0.0005594973335973918
The modified gen p mean: 0.44923120737075806, gen p mean: -0.12048307061195374, mean p set: 0.4498059153556824
The modified gen p mean: 0.4485247731208801, gen p mean: -0.1222408264875412, mean p set: 0.4491001069545746
loss_pred:0.01654624007642269, decouple_loss:0.0004622412088792771
loss_pred:0.01594902202486992, decouple_loss:0.0004010992997791618
2023-05-02 08:44:41 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13166508078575134, mean p set: 0.4502691626548767
loss_pred:0.016997428610920906, decouple_loss:0.0003753499477170408
The modified gen p mean: 0.44953441619873047, gen p mean: -0.12479735910892487, mean p set: 0.4500633478164673
loss_pred:0.0162710752338171, decouple_loss:0.0005097658722661436
The modified gen p mean: 0.4498300552368164, gen p mean: -0.1244436502456665, mean p set: 0.45035696029663086
loss_pred:0.016496442258358, decouple_loss:0.0005156195256859064
WV_1_PC_1_EH_0_PS_40, loss: 0.01661166176199913, avg_mse: 0.026058096438646317
current test mse: 0.026058
Iteration: 1471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487956464290619, gen p mean: -0.12089468538761139, mean p set: 0.4493708908557892
loss_pred:0.016656620427966118, decouple_loss:0.0005046291626058519
The modified gen p mean: 0.4485344886779785, gen p mean: -0.12544074654579163, mean p set: 0.4491093158721924The modified gen p mean: 0.4505139887332916, gen p mean: -0.1263551115989685, mean p set: 0.451090544462204
loss_pred:0.016448959708213806, decouple_loss:0.00043687826837413013loss_pred:0.01509812381118536, decouple_loss:0.0006354982033371925
Iteration: 1472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506986439228058, gen p mean: -0.12260375916957855, mean p set: 0.4512770175933838
The modified gen p mean: 0.45053160190582275, gen p mean: -0.12519347667694092, mean p set: 0.451107382774353loss_pred:0.015952857211232185, decouple_loss:0.00042712176218628883
loss_pred:0.015548557974398136, decouple_loss:0.0005251024849712849
The modified gen p mean: 0.44921058416366577, gen p mean: -0.11791591346263885, mean p set: 0.44978588819503784
loss_pred:0.01629086211323738, decouple_loss:0.0003416771942283958
Iteration: 1473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501173198223114, gen p mean: -0.12657524645328522, mean p set: 0.45069611072540283
loss_pred:0.01609985902905464, decouple_loss:0.0004876457678619772
The modified gen p mean: 0.4511169493198395, gen p mean: -0.11813481897115707, mean p set: 0.451691210269928
loss_pred:0.015716426074504852, decouple_loss:0.0004827441880479455
The modified gen p mean: 0.45077088475227356, gen p mean: -0.1193079799413681, mean p set: 0.45134806632995605
loss_pred:0.01629282534122467, decouple_loss:0.0005685880896635354
Iteration: 1474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45074108242988586, gen p mean: -0.11857634782791138, mean p set: 0.4513164758682251
loss_pred:0.016130667179822922, decouple_loss:0.0004510064609348774
The modified gen p mean: 0.4486728608608246, gen p mean: -0.12325755506753922, mean p set: 0.44924622774124146
loss_pred:0.01580255664885044, decouple_loss:0.0005711148260161281
The modified gen p mean: 0.4485238790512085, gen p mean: -0.11796972900629044, mean p set: 0.44910016655921936
loss_pred:0.01613636501133442, decouple_loss:0.0005743200890719891
Iteration: 1475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023345947265625, gen p mean: -0.11486794799566269, mean p set: 0.4508116841316223
The modified gen p mean: 0.45002982020378113, gen p mean: -0.12512479722499847, mean p set: 0.45060214400291443
loss_pred:0.016447631642222404, decouple_loss:0.00048474324285052717
loss_pred:0.01567036099731922, decouple_loss:0.0003886616323143244
The modified gen p mean: 0.4489326477050781, gen p mean: -0.11953772604465485, mean p set: 0.4495084881782532
loss_pred:0.016116809099912643, decouple_loss:0.0004548918514046818
Iteration: 1476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500848054885864, gen p mean: -0.12348338216543198, mean p set: 0.45066148042678833
The modified gen p mean: 0.4501301050186157, gen p mean: -0.12234291434288025, mean p set: 0.4507073163986206
loss_pred:0.015709111467003822, decouple_loss:0.00048623874317854643
loss_pred:0.0165112242102623, decouple_loss:0.0005894774221815169
The modified gen p mean: 0.4486932158470154, gen p mean: -0.12276591360569, mean p set: 0.4492696523666382
loss_pred:0.015549758449196815, decouple_loss:0.0004085442051291466
Iteration: 1477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497182071208954, gen p mean: -0.1218314841389656, mean p set: 0.4502963423728943
loss_pred:0.015620598569512367, decouple_loss:0.00044688762864097953
The modified gen p mean: 0.44967901706695557, gen p mean: -0.12061159312725067, mean p set: 0.45025497674942017
loss_pred:0.015654921531677246, decouple_loss:0.0004417013260535896
The modified gen p mean: 0.45035409927368164, gen p mean: -0.12529931962490082, mean p set: 0.4509302079677582
loss_pred:0.015932640060782433, decouple_loss:0.0005796047626063228
Iteration: 1478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508797228336334, gen p mean: -0.11847145855426788, mean p set: 0.4514552056789398
loss_pred:0.01625058799982071, decouple_loss:0.0004981124075129628
The modified gen p mean: 0.45026683807373047, gen p mean: -0.11604595929384232, mean p set: 0.45084407925605774
loss_pred:0.01686914823949337, decouple_loss:0.0004624220891855657
The modified gen p mean: 0.4490540325641632, gen p mean: -0.11596601456403732, mean p set: 0.44962990283966064
loss_pred:0.016494153067469597, decouple_loss:0.0005085725570097566
Iteration: 1479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450545072555542, gen p mean: -0.12731987237930298, mean p set: 0.45112112164497375
loss_pred:0.015475811436772346, decouple_loss:0.0005068617174401879
The modified gen p mean: 0.4509679973125458, gen p mean: -0.1219172552227974, mean p set: 0.45154935121536255
loss_pred:0.016969211399555206, decouple_loss:0.00042424220009706914
The modified gen p mean: 0.4513370990753174, gen p mean: -0.12327873706817627, mean p set: 0.45191389322280884
loss_pred:0.015918871387839317, decouple_loss:0.0004805252538062632
Iteration: 1480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504469335079193, gen p mean: -0.1289823055267334, mean p set: 0.4510233402252197
The modified gen p mean: 0.45015498995780945, gen p mean: -0.1281055063009262, mean p set: 0.4507302939891815
loss_pred:0.016532819718122482, decouple_loss:0.0004315712139941752
loss_pred:0.016619157046079636, decouple_loss:0.00046177691547200084
The modified gen p mean: 0.4496648907661438, gen p mean: -0.12215258181095123, mean p set: 0.450238436460495
loss_pred:0.01532443892210722, decouple_loss:0.00047061554505489767
2023-05-02 08:46:47 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13769449293613434, mean p set: 0.4502691626548767
loss_pred:0.01709897071123123, decouple_loss:0.000496933760587126
The modified gen p mean: 0.44953447580337524, gen p mean: -0.1304442584514618, mean p set: 0.4500633478164673
loss_pred:0.01630229316651821, decouple_loss:0.00044646472088061273
The modified gen p mean: 0.44982820749282837, gen p mean: -0.12982869148254395, mean p set: 0.45035696029663086
loss_pred:0.016472293063998222, decouple_loss:0.0004578451334964484
WV_1_PC_1_EH_0_PS_40, loss: 0.01664787344634533, avg_mse: 0.026066480204463005
current test mse: 0.026066
Iteration: 1481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508012533187866, gen p mean: -0.12956354022026062, mean p set: 0.45137593150138855
loss_pred:0.017077436670660973, decouple_loss:0.0004614565405063331
The modified gen p mean: 0.45020103454589844, gen p mean: -0.1282527893781662, mean p set: 0.4507790505886078The modified gen p mean: 0.45062530040740967, gen p mean: -0.13186028599739075, mean p set: 0.45120275020599365
loss_pred:0.016632890328764915, decouple_loss:0.00039930822094902396
loss_pred:0.015478504821658134, decouple_loss:0.0004630893818102777
Iteration: 1482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474834203720093, gen p mean: -0.12387651950120926, mean p set: 0.4480571150779724
loss_pred:0.01573915034532547, decouple_loss:0.0004789892409462482
The modified gen p mean: 0.45003005862236023, gen p mean: -0.1217535063624382, mean p set: 0.45060789585113525The modified gen p mean: 0.4497847557067871, gen p mean: -0.12091343104839325, mean p set: 0.4503605365753174
loss_pred:0.016745615750551224, decouple_loss:0.00047068868298083544
loss_pred:0.01523106824606657, decouple_loss:0.00042052549542859197
Iteration: 1483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502567648887634, gen p mean: -0.1202109158039093, mean p set: 0.4508344829082489
loss_pred:0.01566738821566105, decouple_loss:0.000531209516339004
The modified gen p mean: 0.4491479694843292, gen p mean: -0.12110681086778641, mean p set: 0.4497242569923401The modified gen p mean: 0.45010143518447876, gen p mean: -0.12577715516090393, mean p set: 0.4506766200065613
loss_pred:0.016371244564652443, decouple_loss:0.00044067646376788616
loss_pred:0.016219362616539, decouple_loss:0.0007024080841802061
Iteration: 1484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45056813955307007, gen p mean: -0.1204814538359642, mean p set: 0.4511445164680481
loss_pred:0.016209321096539497, decouple_loss:0.00046249310253188014
The modified gen p mean: 0.4497765898704529, gen p mean: -0.12195049971342087, mean p set: 0.45035505294799805
loss_pred:0.016123821958899498, decouple_loss:0.00040672419709153473
The modified gen p mean: 0.45082545280456543, gen p mean: -0.11750826239585876, mean p set: 0.4514020085334778
loss_pred:0.016151953488588333, decouple_loss:0.00046863159514032304
Iteration: 1485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496701657772064, gen p mean: -0.11769426614046097, mean p set: 0.4502485692501068
loss_pred:0.01632590964436531, decouple_loss:0.0005176361883059144
The modified gen p mean: 0.4473308324813843, gen p mean: -0.11630946397781372, mean p set: 0.4479064345359802
loss_pred:0.015822062268853188, decouple_loss:0.0005748921539634466
The modified gen p mean: 0.4507421553134918, gen p mean: -0.12144579738378525, mean p set: 0.4513210952281952
loss_pred:0.0161671731621027, decouple_loss:0.0004202132113277912
Iteration: 1486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503653049468994, gen p mean: -0.12265223264694214, mean p set: 0.4509435296058655
loss_pred:0.01581237092614174, decouple_loss:0.0003816304088104516
The modified gen p mean: 0.4506165087223053, gen p mean: -0.12348392605781555, mean p set: 0.45119279623031616
The modified gen p mean: 0.44853225350379944, gen p mean: -0.12629884481430054, mean p set: 0.44910821318626404
loss_pred:0.015447322279214859, decouple_loss:0.0005805499968118966
loss_pred:0.016148362308740616, decouple_loss:0.0004641710256692022
Iteration: 1487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492766857147217, gen p mean: -0.12101735919713974, mean p set: 0.4498521387577057
loss_pred:0.015866393223404884, decouple_loss:0.00036055190139450133
The modified gen p mean: 0.4490112066268921, gen p mean: -0.1218486875295639, mean p set: 0.44958674907684326
The modified gen p mean: 0.4504280984401703, gen p mean: -0.12557236850261688, mean p set: 0.45100319385528564
loss_pred:0.016555415466427803, decouple_loss:0.00036061013815924525
loss_pred:0.015585342422127724, decouple_loss:0.0004429845721460879
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
NaN value num: 0
Iteration: 1488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44882717728614807, gen p mean: -0.12563924491405487, mean p set: 0.44940266013145447
The modified gen p mean: 0.45268338918685913, gen p mean: -0.12568087875843048, mean p set: 0.45326003432273865
loss_pred:0.01482723094522953, decouple_loss:0.0004289622011128813
loss_pred:0.014667242765426636, decouple_loss:0.00047321838792413473
The modified gen p mean: 0.4480453133583069, gen p mean: -0.1306714415550232, mean p set: 0.44862014055252075
loss_pred:0.015016123652458191, decouple_loss:0.0004125639970880002
Iteration: 1489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45106032490730286, gen p mean: -0.12349015474319458, mean p set: 0.4516368806362152
loss_pred:0.015346097759902477, decouple_loss:0.00038659051642753184
The modified gen p mean: 0.45125317573547363, gen p mean: -0.12466707080602646, mean p set: 0.4518289566040039
loss_pred:0.01455102302134037, decouple_loss:0.0004652830248232931
The modified gen p mean: 0.451506644487381, gen p mean: -0.12510642409324646, mean p set: 0.45208731293678284
loss_pred:0.014793825335800648, decouple_loss:0.00035454562748782337
Iteration: 1490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937238097190857, gen p mean: -0.13394467532634735, mean p set: 0.449952095746994
loss_pred:0.014868714846670628, decouple_loss:0.0005113242659717798
The modified gen p mean: 0.44964659214019775, gen p mean: -0.13463006913661957, mean p set: 0.45022377371788025
loss_pred:0.015086359344422817, decouple_loss:0.0003678598441183567
The modified gen p mean: 0.44959554076194763, gen p mean: -0.1242043599486351, mean p set: 0.4501752555370331
loss_pred:0.015164592303335667, decouple_loss:0.0006195484311319888
2023-05-02 08:49:32 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13775014877319336, mean p set: 0.4502691626548767
loss_pred:0.017092464491724968, decouple_loss:0.00040645833360031247
The modified gen p mean: 0.44953423738479614, gen p mean: -0.1310773640871048, mean p set: 0.4500633478164673
loss_pred:0.016240950673818588, decouple_loss:0.0005457837251015007
The modified gen p mean: 0.4498276710510254, gen p mean: -0.13026219606399536, mean p set: 0.45035696029663086
loss_pred:0.016438208520412445, decouple_loss:0.0006380908307619393
WV_1_PC_1_EH_0_PS_40, loss: 0.016617048531770706, avg_mse: 0.025996418669819832
current test mse: 0.025996
Iteration: 1491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487549066543579, gen p mean: -0.13361875712871552, mean p set: 0.4493304491043091
loss_pred:0.01521304715424776, decouple_loss:0.00040729029569774866
The modified gen p mean: 0.4497160315513611, gen p mean: -0.13042107224464417, mean p set: 0.45029211044311523
loss_pred:0.0150193115696311, decouple_loss:0.00042966671753674746
The modified gen p mean: 0.45139846205711365, gen p mean: -0.1224566400051117, mean p set: 0.45197638869285583
loss_pred:0.014497198164463043, decouple_loss:0.00041572676855139434
Iteration: 1492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44941091537475586, gen p mean: -0.13348005712032318, mean p set: 0.44998836517333984
loss_pred:0.01518678292632103, decouple_loss:0.00039212839328683913
The modified gen p mean: 0.4492532014846802, gen p mean: -0.12539999186992645, mean p set: 0.4498332440853119The modified gen p mean: 0.45135414600372314, gen p mean: -0.12990985810756683, mean p set: 0.4519321024417877
loss_pred:0.01506883930414915, decouple_loss:0.0005223317421041429loss_pred:0.014775400049984455, decouple_loss:0.000526218384038657
Iteration: 1493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498966336250305, gen p mean: -0.13168077170848846, mean p set: 0.4504731595516205
loss_pred:0.014965919777750969, decouple_loss:0.0004009211843367666
The modified gen p mean: 0.4475657641887665, gen p mean: -0.13807372748851776, mean p set: 0.448142409324646
loss_pred:0.015432169660925865, decouple_loss:0.0005748748662881553
The modified gen p mean: 0.4503030776977539, gen p mean: -0.13245826959609985, mean p set: 0.45087674260139465
loss_pred:0.01583770476281643, decouple_loss:0.0006015603430569172
Iteration: 1494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497705101966858, gen p mean: -0.13224196434020996, mean p set: 0.4503476321697235
loss_pred:0.014824703335762024, decouple_loss:0.0004762384050991386
The modified gen p mean: 0.45017552375793457, gen p mean: -0.12861131131649017, mean p set: 0.45075374841690063
loss_pred:0.015351617708802223, decouple_loss:0.0004051870491821319
The modified gen p mean: 0.45072418451309204, gen p mean: -0.13124415278434753, mean p set: 0.45130327343940735
loss_pred:0.014586362056434155, decouple_loss:0.0004549422301352024
Iteration: 1495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512426257133484, gen p mean: -0.1266997754573822, mean p set: 0.4518211781978607
loss_pred:0.01555594615638256, decouple_loss:0.0006630857824347913
The modified gen p mean: 0.44970229268074036, gen p mean: -0.12639406323432922, mean p set: 0.45028162002563477
loss_pred:0.015629945322871208, decouple_loss:0.0003906588244717568
The modified gen p mean: 0.4496898949146271, gen p mean: -0.12653547525405884, mean p set: 0.45026808977127075
loss_pred:0.015251844190061092, decouple_loss:0.00035062083043158054
Iteration: 1496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513779878616333, gen p mean: -0.1256813406944275, mean p set: 0.45195427536964417
loss_pred:0.014599116519093513, decouple_loss:0.00044975211494602263
The modified gen p mean: 0.4515712261199951, gen p mean: -0.12742668390274048, mean p set: 0.4521452486515045
loss_pred:0.014681903645396233, decouple_loss:0.00045272381976246834
The modified gen p mean: 0.4511304199695587, gen p mean: -0.1270177811384201, mean p set: 0.4517051577568054
loss_pred:0.015001990832388401, decouple_loss:0.00044646591413766146
Iteration: 1497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513152241706848, gen p mean: -0.1312708556652069, mean p set: 0.4518939256668091
loss_pred:0.014856407418847084, decouple_loss:0.0008137631812132895
The modified gen p mean: 0.4514530599117279, gen p mean: -0.12854796648025513, mean p set: 0.4520314931869507
loss_pred:0.014566637575626373, decouple_loss:0.0005272081471048295
The modified gen p mean: 0.44916003942489624, gen p mean: -0.12614911794662476, mean p set: 0.4497356712818146
loss_pred:0.014553348533809185, decouple_loss:0.0005306999082677066
Iteration: 1498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489547312259674, gen p mean: -0.13199573755264282, mean p set: 0.44953182339668274
loss_pred:0.01514190249145031, decouple_loss:0.00041587106534279883
The modified gen p mean: 0.45274075865745544, gen p mean: -0.12858371436595917, mean p set: 0.4533170461654663
loss_pred:0.014652809128165245, decouple_loss:0.00040703246486373246
The modified gen p mean: 0.4492990970611572, gen p mean: -0.12642060220241547, mean p set: 0.4498729407787323
loss_pred:0.015793822705745697, decouple_loss:0.00036222406197339296
Iteration: 1499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489439129829407, gen p mean: -0.13120374083518982, mean p set: 0.44951876997947693
loss_pred:0.014945343136787415, decouple_loss:0.0004968135617673397
The modified gen p mean: 0.4527595341205597, gen p mean: -0.12935490906238556, mean p set: 0.45333418250083923
The modified gen p mean: 0.4527861177921295, gen p mean: -0.13214312493801117, mean p set: 0.4533640444278717
loss_pred:0.014306064695119858, decouple_loss:0.00046863738680258393
loss_pred:0.014788524247705936, decouple_loss:0.000443875789642334
Iteration: 1500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44929367303848267, gen p mean: -0.12682965397834778, mean p set: 0.4498688280582428
The modified gen p mean: 0.45113903284072876, gen p mean: -0.1251683235168457, mean p set: 0.4517160654067993
loss_pred:0.014920714311301708, decouple_loss:0.00038263382157310843
loss_pred:0.015192361548542976, decouple_loss:0.00044827794772572815
The modified gen p mean: 0.4493407905101776, gen p mean: -0.12832878530025482, mean p set: 0.4499163329601288
loss_pred:0.016035547479987144, decouple_loss:0.000376324140233919
2023-05-02 08:51:39 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1315382868051529, mean p set: 0.4502691626548767
loss_pred:0.017063718289136887, decouple_loss:0.00043201108928769827
The modified gen p mean: 0.44982853531837463, gen p mean: -0.12404196709394455, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495355486869812, gen p mean: -0.12463682144880295, mean p set: 0.4500633478164673
loss_pred:0.016536705195903778, decouple_loss:0.0005028897430747747
loss_pred:0.016317598521709442, decouple_loss:0.00048080860869958997
WV_1_PC_1_EH_0_PS_40, loss: 0.01666293665766716, avg_mse: 0.026059338822960854
current test mse: 0.026059
Iteration: 1501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45085686445236206, gen p mean: -0.11739084124565125, mean p set: 0.4514331519603729
loss_pred:0.014686664566397667, decouple_loss:0.0003649971913546324
The modified gen p mean: 0.44959336519241333, gen p mean: -0.12967175245285034, mean p set: 0.4501676559448242
loss_pred:0.01510477066040039, decouple_loss:0.000444070843514055
The modified gen p mean: 0.44865086674690247, gen p mean: -0.12804344296455383, mean p set: 0.44922778010368347
loss_pred:0.015122435055673122, decouple_loss:0.00041750961099751294
Iteration: 1502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45118165016174316, gen p mean: -0.12504591047763824, mean p set: 0.4517599642276764
loss_pred:0.014444010332226753, decouple_loss:0.00039030570769682527
The modified gen p mean: 0.45104819536209106, gen p mean: -0.12372774630784988, mean p set: 0.45162567496299744The modified gen p mean: 0.44982385635375977, gen p mean: -0.1289198398590088, mean p set: 0.45039960741996765
loss_pred:0.015145346522331238, decouple_loss:0.00037820497527718544
loss_pred:0.015562049113214016, decouple_loss:0.0003615370369516313
Iteration: 1503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498712122440338, gen p mean: -0.1336241066455841, mean p set: 0.4504474103450775The modified gen p mean: 0.4518803358078003, gen p mean: -0.12228520959615707, mean p set: 0.4524591267108917
loss_pred:0.014731330797076225, decouple_loss:0.0003580596239771694
loss_pred:0.014661085791885853, decouple_loss:0.0004921568324789405
The modified gen p mean: 0.4517430067062378, gen p mean: -0.12494999915361404, mean p set: 0.4523191750049591
loss_pred:0.015256425365805626, decouple_loss:0.0004370763199403882
Iteration: 1504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511841833591461, gen p mean: -0.1235259473323822, mean p set: 0.45175832509994507
The modified gen p mean: 0.4510284960269928, gen p mean: -0.12853196263313293, mean p set: 0.4516025483608246
loss_pred:0.01464771293103695, decouple_loss:0.000405442260671407
loss_pred:0.015278992243111134, decouple_loss:0.0003499112499412149
The modified gen p mean: 0.45038917660713196, gen p mean: -0.13212460279464722, mean p set: 0.4509674608707428
loss_pred:0.014625757932662964, decouple_loss:0.00042879683314822614
Iteration: 1505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504890739917755, gen p mean: -0.13200438022613525, mean p set: 0.4510645270347595
loss_pred:0.0144923385232687, decouple_loss:0.0003614557208493352
The modified gen p mean: 0.44964876770973206, gen p mean: -0.12783695757389069, mean p set: 0.45022279024124146
loss_pred:0.014979143626987934, decouple_loss:0.00035023799864575267
The modified gen p mean: 0.4506586790084839, gen p mean: -0.12589263916015625, mean p set: 0.4512324035167694
loss_pred:0.014940432272851467, decouple_loss:0.0004997866926714778
Iteration: 1506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514102041721344, gen p mean: -0.1344171017408371, mean p set: 0.4519873261451721
The modified gen p mean: 0.4510847330093384, gen p mean: -0.13129234313964844, mean p set: 0.4516620337963104
loss_pred:0.015180925838649273, decouple_loss:0.0005820727674290538
loss_pred:0.014861215837299824, decouple_loss:0.00042225862853229046
The modified gen p mean: 0.4489925801753998, gen p mean: -0.1304551213979721, mean p set: 0.4495701789855957
loss_pred:0.015332844108343124, decouple_loss:0.00038147016311995685
Iteration: 1507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520530700683594, gen p mean: -0.13298654556274414, mean p set: 0.45262959599494934
loss_pred:0.014209332875907421, decouple_loss:0.0004646728921215981
The modified gen p mean: 0.45006388425827026, gen p mean: -0.1296742707490921, mean p set: 0.4506407380104065
The modified gen p mean: 0.4514056444168091, gen p mean: -0.13101507723331451, mean p set: 0.45198073983192444
loss_pred:0.014845460653305054, decouple_loss:0.0004241068381816149
loss_pred:0.014641152694821358, decouple_loss:0.0005057862726971507
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
NaN value num: 0
Iteration: 1508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488997459411621, gen p mean: -0.13879768550395966, mean p set: 0.4494765102863312
The modified gen p mean: 0.4479029178619385, gen p mean: -0.13547566533088684, mean p set: 0.4484792649745941
loss_pred:0.015337574295699596, decouple_loss:0.00042150745866820216
loss_pred:0.01664081960916519, decouple_loss:0.0004913772572763264
The modified gen p mean: 0.4473785161972046, gen p mean: -0.1369766891002655, mean p set: 0.4479536712169647
loss_pred:0.016761749982833862, decouple_loss:0.0004938770434819162
Iteration: 1509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719794392585754, gen p mean: -0.1372055560350418, mean p set: 0.4477744400501251
The modified gen p mean: 0.4468911290168762, gen p mean: -0.13676904141902924, mean p set: 0.4474656283855438
loss_pred:0.01644776202738285, decouple_loss:0.0004976778291165829
loss_pred:0.015663621947169304, decouple_loss:0.0005329178529791534
The modified gen p mean: 0.4468117654323578, gen p mean: -0.13138291239738464, mean p set: 0.447390615940094
loss_pred:0.01747845858335495, decouple_loss:0.0006596203311346471
Iteration: 1510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731637835502625, gen p mean: -0.13209356367588043, mean p set: 0.44789421558380127
loss_pred:0.016168665140867233, decouple_loss:0.0003813582588918507
The modified gen p mean: 0.4479858875274658, gen p mean: -0.12668755650520325, mean p set: 0.44855955243110657
The modified gen p mean: 0.44650933146476746, gen p mean: -0.13545411825180054, mean p set: 0.44708430767059326
loss_pred:0.015989160165190697, decouple_loss:0.00037560166674666107
loss_pred:0.0164366215467453, decouple_loss:0.000461733085103333
2023-05-02 08:54:24 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13209958374500275, mean p set: 0.4502691626548767
loss_pred:0.01694643124938011, decouple_loss:0.0005030443426221609
The modified gen p mean: 0.4495367407798767, gen p mean: -0.1250363439321518, mean p set: 0.4500633478164673
loss_pred:0.016224440187215805, decouple_loss:0.0005264756618998945
The modified gen p mean: 0.4498298764228821, gen p mean: -0.12436481565237045, mean p set: 0.45035696029663086
loss_pred:0.016442682594060898, decouple_loss:0.0004398082382977009
WV_1_PC_1_EH_0_PS_40, loss: 0.016562338918447495, avg_mse: 0.0258181169629097
current test mse: 0.025818
Iteration: 1511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470333158969879, gen p mean: -0.12472594529390335, mean p set: 0.4476097822189331
loss_pred:0.01615924946963787, decouple_loss:0.00039713369915261865
The modified gen p mean: 0.4463784098625183, gen p mean: -0.12495151162147522, mean p set: 0.44695067405700684The modified gen p mean: 0.44707977771759033, gen p mean: -0.12157410383224487, mean p set: 0.44765329360961914
loss_pred:0.016972700133919716, decouple_loss:0.000628805544693023
loss_pred:0.016141116619110107, decouple_loss:0.00039411045145243406
Iteration: 1512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497512876987457, gen p mean: -0.11832163482904434, mean p set: 0.45032617449760437
loss_pred:0.015655236318707466, decouple_loss:0.00039421190740540624
The modified gen p mean: 0.4472214877605438, gen p mean: -0.11779819428920746, mean p set: 0.44779905676841736The modified gen p mean: 0.44687584042549133, gen p mean: -0.12126254290342331, mean p set: 0.44745421409606934
loss_pred:0.016398753970861435, decouple_loss:0.000567751529160887
loss_pred:0.015677768737077713, decouple_loss:0.00038083206163719296
Iteration: 1513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484189748764038, gen p mean: -0.12788860499858856, mean p set: 0.44899317622184753
loss_pred:0.01548907719552517, decouple_loss:0.00044021342182531953
The modified gen p mean: 0.44732171297073364, gen p mean: -0.11862369626760483, mean p set: 0.44789883494377136
loss_pred:0.016405634582042694, decouple_loss:0.00041930892621167004
The modified gen p mean: 0.44707441329956055, gen p mean: -0.12639959156513214, mean p set: 0.4476519823074341
loss_pred:0.015423620119690895, decouple_loss:0.00045368075370788574
Iteration: 1514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820743799209595, gen p mean: -0.12879721820354462, mean p set: 0.44878458976745605
loss_pred:0.015045872889459133, decouple_loss:0.00044032366713508964
The modified gen p mean: 0.44802126288414, gen p mean: -0.12339907884597778, mean p set: 0.44859588146209717
loss_pred:0.016676655039191246, decouple_loss:0.0003949363308493048
The modified gen p mean: 0.446813702583313, gen p mean: -0.12423121929168701, mean p set: 0.4473898112773895
loss_pred:0.01577453501522541, decouple_loss:0.00037919674650765955
Iteration: 1515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474005401134491, gen p mean: -0.12351004034280777, mean p set: 0.447974294424057
loss_pred:0.01575530134141445, decouple_loss:0.0003894104447681457
The modified gen p mean: 0.4484652280807495, gen p mean: -0.12124676257371902, mean p set: 0.44904273748397827
loss_pred:0.01551637053489685, decouple_loss:0.0003715350467246026
The modified gen p mean: 0.449052095413208, gen p mean: -0.1223202794790268, mean p set: 0.4496292173862457
loss_pred:0.01530319731682539, decouple_loss:0.00040069970418699086
Iteration: 1516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741299748420715, gen p mean: -0.12333784997463226, mean p set: 0.44798994064331055
loss_pred:0.01649406924843788, decouple_loss:0.0004849506658501923
The modified gen p mean: 0.44689297676086426, gen p mean: -0.12380564957857132, mean p set: 0.44746968150138855
The modified gen p mean: 0.4482094943523407, gen p mean: -0.12585291266441345, mean p set: 0.4487842917442322
loss_pred:0.015790406614542007, decouple_loss:0.0003744780842680484
loss_pred:0.016217626631259918, decouple_loss:0.0004949574358761311
Iteration: 1517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480389952659607, gen p mean: -0.1329205185174942, mean p set: 0.44861429929733276
loss_pred:0.015688572078943253, decouple_loss:0.0004961381782777607
The modified gen p mean: 0.44805166125297546, gen p mean: -0.12212911993265152, mean p set: 0.44862788915634155
loss_pred:0.015050235204398632, decouple_loss:0.0004892167053185403
The modified gen p mean: 0.4482583999633789, gen p mean: -0.12916302680969238, mean p set: 0.448832243680954
loss_pred:0.01733999140560627, decouple_loss:0.00041498400969430804
Iteration: 1518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44703420996665955, gen p mean: -0.11982949078083038, mean p set: 0.44761213660240173
loss_pred:0.016306158155202866, decouple_loss:0.0003398503758944571
The modified gen p mean: 0.4490003287792206, gen p mean: -0.12451935559511185, mean p set: 0.44957301020622253
loss_pred:0.015208094380795956, decouple_loss:0.0003596363530959934
The modified gen p mean: 0.44681042432785034, gen p mean: -0.12476564943790436, mean p set: 0.44738876819610596
loss_pred:0.017088498920202255, decouple_loss:0.0004503486561588943
Iteration: 1519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492945671081543, gen p mean: -0.12500137090682983, mean p set: 0.4498717188835144
loss_pred:0.015410004183650017, decouple_loss:0.0003928247606381774
The modified gen p mean: 0.44694939255714417, gen p mean: -0.12530803680419922, mean p set: 0.4475262761116028
loss_pred:0.01679057627916336, decouple_loss:0.0004746515187434852
The modified gen p mean: 0.4486064314842224, gen p mean: -0.11892417073249817, mean p set: 0.4491809606552124
loss_pred:0.015087404288351536, decouple_loss:0.0004830379330087453
Iteration: 1520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495750665664673, gen p mean: -0.12447495013475418, mean p set: 0.45015189051628113
The modified gen p mean: 0.45008939504623413, gen p mean: -0.12302770465612411, mean p set: 0.450667142868042
loss_pred:0.015636790543794632, decouple_loss:0.00038632185896858573
loss_pred:0.015775104984641075, decouple_loss:0.0004286090552341193
The modified gen p mean: 0.44852837920188904, gen p mean: -0.11719538271427155, mean p set: 0.4491044282913208
loss_pred:0.015250582247972488, decouple_loss:0.00037853949470445514
2023-05-02 08:56:31 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1301996260881424, mean p set: 0.4502691626548767
loss_pred:0.01693107932806015, decouple_loss:0.0003838043485302478
The modified gen p mean: 0.44953617453575134, gen p mean: -0.1229945719242096, mean p set: 0.4500633478164673
loss_pred:0.016244154423475266, decouple_loss:0.0004252632206771523
The modified gen p mean: 0.4498274028301239, gen p mean: -0.12274659425020218, mean p set: 0.45035696029663086
loss_pred:0.01647871918976307, decouple_loss:0.0004011988639831543
WV_1_PC_1_EH_0_PS_40, loss: 0.016571490094065666, avg_mse: 0.025887593626976013
current test mse: 0.025888
Iteration: 1521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782504439353943, gen p mean: -0.12293586879968643, mean p set: 0.44840285181999207
loss_pred:0.01551046408712864, decouple_loss:0.0004473295994102955
The modified gen p mean: 0.44908836483955383, gen p mean: -0.12151558697223663, mean p set: 0.4496642053127289The modified gen p mean: 0.44909000396728516, gen p mean: -0.12108438462018967, mean p set: 0.44966837763786316
loss_pred:0.014908753335475922, decouple_loss:0.00032978947274386883
loss_pred:0.015475044026970863, decouple_loss:0.0004105050174985081
Iteration: 1522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482242166996002, gen p mean: -0.12372955679893494, mean p set: 0.44879916310310364
loss_pred:0.015622987411916256, decouple_loss:0.00043106035445816815
The modified gen p mean: 0.44682741165161133, gen p mean: -0.11843407154083252, mean p set: 0.4474024772644043The modified gen p mean: 0.44762933254241943, gen p mean: -0.12036137282848358, mean p set: 0.44820311665534973
loss_pred:0.015813492238521576, decouple_loss:0.00040186542901210487
loss_pred:0.01551639474928379, decouple_loss:0.0003652908490039408
Iteration: 1523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765323400497437, gen p mean: -0.12060505896806717, mean p set: 0.4482274651527405
The modified gen p mean: 0.44763270020484924, gen p mean: -0.12429191172122955, mean p set: 0.44820842146873474
loss_pred:0.016683954745531082, decouple_loss:0.00043418866698630154
loss_pred:0.01592300646007061, decouple_loss:0.0004141934623476118
The modified gen p mean: 0.4496319890022278, gen p mean: -0.12211845070123672, mean p set: 0.45020791888237
loss_pred:0.01540945190936327, decouple_loss:0.00040173466550186276
Iteration: 1524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486996829509735, gen p mean: -0.11464622616767883, mean p set: 0.44927728176116943
loss_pred:0.015430274419486523, decouple_loss:0.00044699260615743697
The modified gen p mean: 0.4477723240852356, gen p mean: -0.11865390092134476, mean p set: 0.44834980368614197
loss_pred:0.01699879951775074, decouple_loss:0.0003556358569767326
The modified gen p mean: 0.4492056369781494, gen p mean: -0.11666326969861984, mean p set: 0.4497813284397125
loss_pred:0.014872925356030464, decouple_loss:0.00035448200651444495
Iteration: 1525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474082291126251, gen p mean: -0.11443856358528137, mean p set: 0.4479839503765106
The modified gen p mean: 0.44769126176834106, gen p mean: -0.12335461378097534, mean p set: 0.44826775789260864
loss_pred:0.01607106439769268, decouple_loss:0.0003685277479235083
loss_pred:0.01694072224199772, decouple_loss:0.000344339496223256
The modified gen p mean: 0.44645625352859497, gen p mean: -0.12709690630435944, mean p set: 0.4470324218273163
loss_pred:0.016248079016804695, decouple_loss:0.00044441205682232976
Iteration: 1526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725167751312256, gen p mean: -0.12207991629838943, mean p set: 0.4478277862071991
loss_pred:0.01650087907910347, decouple_loss:0.0004034352023154497
The modified gen p mean: 0.44823122024536133, gen p mean: -0.11630351841449738, mean p set: 0.44880858063697815
loss_pred:0.01595935970544815, decouple_loss:0.00041056517511606216
The modified gen p mean: 0.4471605122089386, gen p mean: -0.11989367008209229, mean p set: 0.4477371573448181
loss_pred:0.015613418072462082, decouple_loss:0.00040167648694477975
Iteration: 1527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490652084350586, gen p mean: -0.11944203078746796, mean p set: 0.44964075088500977
The modified gen p mean: 0.4477822184562683, gen p mean: -0.11902293562889099, mean p set: 0.44835713505744934
loss_pred:0.015124850906431675, decouple_loss:0.00044842815259471536
loss_pred:0.015542338602244854, decouple_loss:0.00045989753562025726
The modified gen p mean: 0.4486055374145508, gen p mean: -0.1234511286020279, mean p set: 0.4491821527481079
loss_pred:0.015043837949633598, decouple_loss:0.00035725862835533917
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
NaN value num: 0
Iteration: 1528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467654228210449, gen p mean: -0.12692689895629883, mean p set: 0.4473387897014618
loss_pred:0.01645844243466854, decouple_loss:0.00037632303428836167
The modified gen p mean: 0.4461676776409149, gen p mean: -0.1213223934173584, mean p set: 0.446742981672287
The modified gen p mean: 0.4460883140563965, gen p mean: -0.12111807614564896, mean p set: 0.44666171073913574
loss_pred:0.016678864136338234, decouple_loss:0.0003932408872060478
loss_pred:0.016489574685692787, decouple_loss:0.0003509424568619579
Iteration: 1529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468246102333069, gen p mean: -0.11741168051958084, mean p set: 0.4474022090435028
loss_pred:0.016558988019824028, decouple_loss:0.00047155001084320247
The modified gen p mean: 0.4468514919281006, gen p mean: -0.11821719259023666, mean p set: 0.4474250078201294
The modified gen p mean: 0.44825273752212524, gen p mean: -0.12631046772003174, mean p set: 0.44882747530937195
loss_pred:0.016758695244789124, decouple_loss:0.0005657713045366108
loss_pred:0.01678432896733284, decouple_loss:0.0004737599811051041
Iteration: 1530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767460227012634, gen p mean: -0.12579713761806488, mean p set: 0.448250949382782
loss_pred:0.017070645466446877, decouple_loss:0.00046339863911271095
The modified gen p mean: 0.44678282737731934, gen p mean: -0.12551447749137878, mean p set: 0.4473620653152466
The modified gen p mean: 0.4466727674007416, gen p mean: -0.12202462553977966, mean p set: 0.44724777340888977
loss_pred:0.017275331541895866, decouple_loss:0.0006697307690046728
loss_pred:0.01603682152926922, decouple_loss:0.000534501567017287
2023-05-02 08:59:12 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1338772475719452, mean p set: 0.4502691626548767
loss_pred:0.016843264922499657, decouple_loss:0.0003822210419457406
The modified gen p mean: 0.44982844591140747, gen p mean: -0.12677107751369476, mean p set: 0.45035696029663086
The modified gen p mean: 0.44953635334968567, gen p mean: -0.12710686028003693, mean p set: 0.4500633478164673
loss_pred:0.016528837382793427, decouple_loss:0.0004854937724303454
loss_pred:0.016293849796056747, decouple_loss:0.00039572821697220206
WV_1_PC_1_EH_0_PS_40, loss: 0.0165763758122921, avg_mse: 0.025898175314068794
current test mse: 0.025898
Iteration: 1531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468035101890564, gen p mean: -0.1218445897102356, mean p set: 0.44737857580184937
loss_pred:0.016712721437215805, decouple_loss:0.00038450650754384696
The modified gen p mean: 0.4466935992240906, gen p mean: -0.12519925832748413, mean p set: 0.44726744294166565
loss_pred:0.016402894631028175, decouple_loss:0.0003491688403300941
The modified gen p mean: 0.4461909532546997, gen p mean: -0.12568947672843933, mean p set: 0.4467630088329315
loss_pred:0.01702723652124405, decouple_loss:0.0005304172518663108
Iteration: 1532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849494099617004, gen p mean: -0.1196257472038269, mean p set: 0.44906821846961975
loss_pred:0.01577286422252655, decouple_loss:0.00038973827031441033
The modified gen p mean: 0.44612225890159607, gen p mean: -0.12547320127487183, mean p set: 0.4466968774795532The modified gen p mean: 0.4458320438861847, gen p mean: -0.1325075775384903, mean p set: 0.44641000032424927
loss_pred:0.016859373077750206, decouple_loss:0.0004673838266171515
loss_pred:0.01632664166390896, decouple_loss:0.00040965256630443037
Iteration: 1533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486537277698517, gen p mean: -0.12627306580543518, mean p set: 0.4492294192314148
loss_pred:0.016438402235507965, decouple_loss:0.00037229625741019845
The modified gen p mean: 0.4476773142814636, gen p mean: -0.12996922433376312, mean p set: 0.4482557475566864
loss_pred:0.016761772334575653, decouple_loss:0.000660489487927407
The modified gen p mean: 0.4480878710746765, gen p mean: -0.12347976863384247, mean p set: 0.4486643373966217
loss_pred:0.017122352495789528, decouple_loss:0.0005280597833916545
Iteration: 1534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472271502017975, gen p mean: -0.1299288421869278, mean p set: 0.44780007004737854
loss_pred:0.016281327232718468, decouple_loss:0.0003412137448322028
The modified gen p mean: 0.44741371273994446, gen p mean: -0.1288086324930191, mean p set: 0.44799190759658813
loss_pred:0.015761245042085648, decouple_loss:0.00042658118763938546
The modified gen p mean: 0.4476920962333679, gen p mean: -0.12398002296686172, mean p set: 0.44826972484588623
loss_pred:0.015509651042521, decouple_loss:0.0005162002053111792
Iteration: 1535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44618821144104004, gen p mean: -0.13375945389270782, mean p set: 0.4467627704143524
loss_pred:0.016696378588676453, decouple_loss:0.0003372612700331956
The modified gen p mean: 0.44612959027290344, gen p mean: -0.1258958876132965, mean p set: 0.44670480489730835
The modified gen p mean: 0.4476693272590637, gen p mean: -0.1304457038640976, mean p set: 0.44824743270874023
loss_pred:0.016073033213615417, decouple_loss:0.0003656705084722489
loss_pred:0.017182137817144394, decouple_loss:0.0003539460012689233
Iteration: 1536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469163417816162, gen p mean: -0.12629424035549164, mean p set: 0.4474903643131256
loss_pred:0.01640193536877632, decouple_loss:0.0005135225364938378
The modified gen p mean: 0.44627243280410767, gen p mean: -0.13075821101665497, mean p set: 0.4468485414981842
The modified gen p mean: 0.4474336802959442, gen p mean: -0.1326550990343094, mean p set: 0.44801223278045654
loss_pred:0.015702977776527405, decouple_loss:0.0004995526396669447
loss_pred:0.01697319932281971, decouple_loss:0.00038842158392071724
Iteration: 1537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483925402164459, gen p mean: -0.12873366475105286, mean p set: 0.4489694833755493
The modified gen p mean: 0.4465925097465515, gen p mean: -0.12006954103708267, mean p set: 0.4471668004989624
loss_pred:0.016727615147829056, decouple_loss:0.0005488942842930555
loss_pred:0.016616785898804665, decouple_loss:0.0005478665116243064
The modified gen p mean: 0.4462711215019226, gen p mean: -0.12843003869056702, mean p set: 0.44684502482414246
loss_pred:0.015486114658415318, decouple_loss:0.0004815137945115566
Iteration: 1538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460553824901581, gen p mean: -0.13422413170337677, mean p set: 0.44662904739379883
loss_pred:0.016382329165935516, decouple_loss:0.00046691970783285797
The modified gen p mean: 0.4475375711917877, gen p mean: -0.12968654930591583, mean p set: 0.44811415672302246
loss_pred:0.016915861517190933, decouple_loss:0.00047972920583561063
The modified gen p mean: 0.4474274218082428, gen p mean: -0.1261771321296692, mean p set: 0.448001891374588
loss_pred:0.01724354922771454, decouple_loss:0.0004880945198237896
Iteration: 1539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469945728778839, gen p mean: -0.1288737952709198, mean p set: 0.44756564497947693
loss_pred:0.015647439286112785, decouple_loss:0.0003582054050639272
The modified gen p mean: 0.4469899833202362, gen p mean: -0.12925437092781067, mean p set: 0.44756606221199036
loss_pred:0.01607641577720642, decouple_loss:0.00044781863107346
The modified gen p mean: 0.44569939374923706, gen p mean: -0.1332966536283493, mean p set: 0.4462752044200897
loss_pred:0.01638297736644745, decouple_loss:0.0004960117512382567
Iteration: 1540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487662613391876, gen p mean: -0.13184846937656403, mean p set: 0.44934335350990295
loss_pred:0.0170018021017313, decouple_loss:0.0003786282613873482
The modified gen p mean: 0.4477129876613617, gen p mean: -0.1215270385146141, mean p set: 0.44828951358795166
loss_pred:0.016028765588998795, decouple_loss:0.0004302358138374984
The modified gen p mean: 0.4470473527908325, gen p mean: -0.12202300131320953, mean p set: 0.44762495160102844
loss_pred:0.015753544867038727, decouple_loss:0.0003569374093785882
2023-05-02 09:01:17 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13489656150341034, mean p set: 0.4502691626548767
loss_pred:0.016936354339122772, decouple_loss:0.00045105887693353
The modified gen p mean: 0.4495373070240021, gen p mean: -0.1281387060880661, mean p set: 0.4500633478164673
loss_pred:0.016214285045862198, decouple_loss:0.0003964275529142469
The modified gen p mean: 0.44983237981796265, gen p mean: -0.127736434340477, mean p set: 0.45035696029663086
loss_pred:0.016472656279802322, decouple_loss:0.0004014793084934354
WV_1_PC_1_EH_0_PS_40, loss: 0.01656191609799862, avg_mse: 0.025906847789883614
current test mse: 0.025907
Iteration: 1541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472443163394928, gen p mean: -0.1313214898109436, mean p set: 0.4478208124637604
loss_pred:0.016878146678209305, decouple_loss:0.00037735197111032903
The modified gen p mean: 0.44690102338790894, gen p mean: -0.13102103769779205, mean p set: 0.4474782347679138The modified gen p mean: 0.44818827509880066, gen p mean: -0.12252071499824524, mean p set: 0.44876134395599365
loss_pred:0.016652274876832962, decouple_loss:0.0003264985280111432
loss_pred:0.01686754822731018, decouple_loss:0.00036641929182223976
Iteration: 1542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459746479988098, gen p mean: -0.12839695811271667, mean p set: 0.446553498506546
The modified gen p mean: 0.4481447637081146, gen p mean: -0.12317248433828354, mean p set: 0.4487190544605255
loss_pred:0.016425466164946556, decouple_loss:0.00036383161204867065
loss_pred:0.016453459858894348, decouple_loss:0.0004883488290943205
The modified gen p mean: 0.4459095597267151, gen p mean: -0.12591515481472015, mean p set: 0.44648540019989014
loss_pred:0.017236698418855667, decouple_loss:0.00040442755562253296
Iteration: 1543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488137662410736, gen p mean: -0.12323600053787231, mean p set: 0.449388325214386
loss_pred:0.016380295157432556, decouple_loss:0.0004423541249707341
The modified gen p mean: 0.4472312927246094, gen p mean: -0.12166714668273926, mean p set: 0.4478082060813904
loss_pred:0.016074594110250473, decouple_loss:0.00035038430360145867
The modified gen p mean: 0.4460607171058655, gen p mean: -0.1325587034225464, mean p set: 0.4466361403465271
loss_pred:0.016212524846196175, decouple_loss:0.00041668396443128586
Iteration: 1544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466358721256256, gen p mean: -0.12985163927078247, mean p set: 0.4472139775753021
loss_pred:0.015740567818284035, decouple_loss:0.0007131955353543162
The modified gen p mean: 0.4464963972568512, gen p mean: -0.13455307483673096, mean p set: 0.44707152247428894
loss_pred:0.016044054180383682, decouple_loss:0.00045277754543349147
The modified gen p mean: 0.44792136549949646, gen p mean: -0.13058283925056458, mean p set: 0.4484969973564148
loss_pred:0.017091557383537292, decouple_loss:0.00039832229958847165
Iteration: 1545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462551176548004, gen p mean: -0.13518081605434418, mean p set: 0.44682982563972473
loss_pred:0.016448043286800385, decouple_loss:0.0004951388691551983
The modified gen p mean: 0.4462471008300781, gen p mean: -0.13572488725185394, mean p set: 0.4468248784542084
loss_pred:0.01621241867542267, decouple_loss:0.0003338957903906703
The modified gen p mean: 0.44819846749305725, gen p mean: -0.1289198100566864, mean p set: 0.44877323508262634
loss_pred:0.015957416966557503, decouple_loss:0.0003515101270750165
Iteration: 1546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467224180698395, gen p mean: -0.13771434128284454, mean p set: 0.44730156660079956
loss_pred:0.016778871417045593, decouple_loss:0.0004381488251965493
The modified gen p mean: 0.44825825095176697, gen p mean: -0.13329589366912842, mean p set: 0.44883307814598083
The modified gen p mean: 0.4460761547088623, gen p mean: -0.14115916192531586, mean p set: 0.4466526508331299
loss_pred:0.016661683097481728, decouple_loss:0.0003601358621381223
loss_pred:0.01595410890877247, decouple_loss:0.00042288764961995184
Iteration: 1547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682949781417847, gen p mean: -0.1371961236000061, mean p set: 0.4474048614501953
loss_pred:0.016577856615185738, decouple_loss:0.00040681325481273234
The modified gen p mean: 0.448630154132843, gen p mean: -0.1326378583908081, mean p set: 0.4492022693157196
loss_pred:0.016439540311694145, decouple_loss:0.0005027163424529135
The modified gen p mean: 0.4461963176727295, gen p mean: -0.13748830556869507, mean p set: 0.4467707574367523
loss_pred:0.016420524567365646, decouple_loss:0.000606487796176225
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 1548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478210508823395, gen p mean: -0.1359347105026245, mean p set: 0.44839832186698914
The modified gen p mean: 0.447788804769516, gen p mean: -0.13921551406383514, mean p set: 0.44836533069610596
loss_pred:0.014929649420082569, decouple_loss:0.0005945529555901885
loss_pred:0.015672003850340843, decouple_loss:0.0004823547205887735
The modified gen p mean: 0.44866743683815, gen p mean: -0.1377556473016739, mean p set: 0.4492427408695221
loss_pred:0.015133701264858246, decouple_loss:0.0005037891678512096
Iteration: 1549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473245143890381, gen p mean: -0.1380496323108673, mean p set: 0.4478999972343445
loss_pred:0.01540612243115902, decouple_loss:0.0003566937521100044
The modified gen p mean: 0.44776275753974915, gen p mean: -0.14052730798721313, mean p set: 0.448341965675354
The modified gen p mean: 0.44762352108955383, gen p mean: -0.1379680633544922, mean p set: 0.448201984167099
loss_pred:0.01560777984559536, decouple_loss:0.00036169536178931594
loss_pred:0.014841640368103981, decouple_loss:0.0004610799078363925
Iteration: 1550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478622078895569, gen p mean: -0.13598300516605377, mean p set: 0.44843557476997375
loss_pred:0.015274599194526672, decouple_loss:0.0005665297503583133
The modified gen p mean: 0.4476967751979828, gen p mean: -0.13649968802928925, mean p set: 0.4482753276824951
The modified gen p mean: 0.4480174779891968, gen p mean: -0.13381758332252502, mean p set: 0.4485950171947479
loss_pred:0.015634827315807343, decouple_loss:0.00046102129272185266
loss_pred:0.015696808695793152, decouple_loss:0.0005295661394484341
2023-05-02 09:04:02 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1330413520336151, mean p set: 0.4502691626548767
loss_pred:0.01690397411584854, decouple_loss:0.00044839741894975305
The modified gen p mean: 0.4495331645011902, gen p mean: -0.1264881044626236, mean p set: 0.4500633478164673
loss_pred:0.01616128720343113, decouple_loss:0.00045731986756436527
The modified gen p mean: 0.4498279094696045, gen p mean: -0.12552744150161743, mean p set: 0.45035696029663086
loss_pred:0.01653524488210678, decouple_loss:0.0004501025250647217
WV_1_PC_1_EH_0_PS_40, loss: 0.01655609905719757, avg_mse: 0.025916537269949913
current test mse: 0.025917
Iteration: 1551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480174779891968, gen p mean: -0.12644025683403015, mean p set: 0.44859370589256287
loss_pred:0.015290436334908009, decouple_loss:0.000504524796269834
The modified gen p mean: 0.44802138209342957, gen p mean: -0.12765638530254364, mean p set: 0.44859760999679565The modified gen p mean: 0.4477064609527588, gen p mean: -0.13232578337192535, mean p set: 0.44828253984451294
loss_pred:0.01613330841064453, decouple_loss:0.00035817903699353337
loss_pred:0.015306561253964901, decouple_loss:0.0003265555715188384
Iteration: 1552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448040246963501, gen p mean: -0.13102443516254425, mean p set: 0.4486139416694641
loss_pred:0.015046376734972, decouple_loss:0.0004438181931618601
The modified gen p mean: 0.4484657943248749, gen p mean: -0.12571917474269867, mean p set: 0.44904080033302307The modified gen p mean: 0.44789883494377136, gen p mean: -0.1315295547246933, mean p set: 0.44847777485847473
loss_pred:0.014669395051896572, decouple_loss:0.00040726654697209597
loss_pred:0.015006926842033863, decouple_loss:0.00041788481757976115
Iteration: 1553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906681776046753, gen p mean: -0.12616802752017975, mean p set: 0.4496433436870575
loss_pred:0.015223246067762375, decouple_loss:0.00036795606138184667
The modified gen p mean: 0.4483518600463867, gen p mean: -0.12496079504489899, mean p set: 0.44892874360084534
loss_pred:0.015073491260409355, decouple_loss:0.00042149744695052505
The modified gen p mean: 0.44735172390937805, gen p mean: -0.12483523041009903, mean p set: 0.44792643189430237
loss_pred:0.015391731634736061, decouple_loss:0.00034655799390748143
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44870999455451965, gen p mean: -0.12558472156524658, mean p set: 0.44928398728370667The modified gen p mean: 0.44753119349479675, gen p mean: -0.12942947447299957, mean p set: 0.44810721278190613
loss_pred:0.015576018020510674, decouple_loss:0.00043941690819337964
loss_pred:0.015274112112820148, decouple_loss:0.00035648426273837686
The modified gen p mean: 0.44823187589645386, gen p mean: -0.12255151569843292, mean p set: 0.4488089084625244
loss_pred:0.01536322571337223, decouple_loss:0.0003870936343446374
Iteration: 1555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471047818660736, gen p mean: -0.12813006341457367, mean p set: 0.4476796090602875
loss_pred:0.015451786108314991, decouple_loss:0.00032507782452739775
The modified gen p mean: 0.4479692578315735, gen p mean: -0.12362200766801834, mean p set: 0.44854387640953064
loss_pred:0.01560037862509489, decouple_loss:0.0003675722109619528
The modified gen p mean: 0.447320818901062, gen p mean: -0.12206777185201645, mean p set: 0.44789719581604004
loss_pred:0.0150722935795784, decouple_loss:0.00037216124474070966
Iteration: 1556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761765003204346, gen p mean: -0.12365800142288208, mean p set: 0.44819343090057373
loss_pred:0.01516296062618494, decouple_loss:0.00042581913294270635
The modified gen p mean: 0.447807252407074, gen p mean: -0.12512604892253876, mean p set: 0.44838467240333557
The modified gen p mean: 0.44718217849731445, gen p mean: -0.12319149821996689, mean p set: 0.4477587640285492
loss_pred:0.014881386421620846, decouple_loss:0.0004412046109791845
loss_pred:0.015195580199360847, decouple_loss:0.00039321306394413114
Iteration: 1557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702786207199097, gen p mean: -0.12205548584461212, mean p set: 0.4476061165332794
loss_pred:0.015242119319736958, decouple_loss:0.00044912201701663435
The modified gen p mean: 0.4482542872428894, gen p mean: -0.11982358247041702, mean p set: 0.4488312005996704
loss_pred:0.014590464532375336, decouple_loss:0.00042375194607302547
The modified gen p mean: 0.44740796089172363, gen p mean: -0.12326359003782272, mean p set: 0.4479837417602539
loss_pred:0.015398970805108547, decouple_loss:0.00040127133252099156
Iteration: 1558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476897120475769, gen p mean: -0.11831317842006683, mean p set: 0.44826412200927734
loss_pred:0.015330757945775986, decouple_loss:0.000460410286905244
The modified gen p mean: 0.4477086663246155, gen p mean: -0.1204913780093193, mean p set: 0.44828298687934875
The modified gen p mean: 0.4480923116207123, gen p mean: -0.12139105796813965, mean p set: 0.4486706554889679
loss_pred:0.015592442825436592, decouple_loss:0.0004216850211378187
loss_pred:0.014501921832561493, decouple_loss:0.00045778724597766995
Iteration: 1559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778206944465637, gen p mean: -0.12189050763845444, mean p set: 0.4483576714992523
loss_pred:0.015505210496485233, decouple_loss:0.0003520417376421392
The modified gen p mean: 0.4475199580192566, gen p mean: -0.12171176075935364, mean p set: 0.448095440864563
loss_pred:0.014676928520202637, decouple_loss:0.0003598890616558492
The modified gen p mean: 0.447853147983551, gen p mean: -0.11489298939704895, mean p set: 0.44843021035194397
loss_pred:0.014682896435260773, decouple_loss:0.0004201261035632342
Iteration: 1560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480217397212982, gen p mean: -0.1219901591539383, mean p set: 0.44859638810157776
loss_pred:0.015664108097553253, decouple_loss:0.0003699459775816649
The modified gen p mean: 0.448201447725296, gen p mean: -0.1174403727054596, mean p set: 0.448775053024292
loss_pred:0.015750689432024956, decouple_loss:0.0005046362639404833
The modified gen p mean: 0.44742292165756226, gen p mean: -0.11628169566392899, mean p set: 0.44799885153770447
loss_pred:0.014616111293435097, decouple_loss:0.0003330776817165315
2023-05-02 09:06:08 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.119377501308918, mean p set: 0.4502691626548767
loss_pred:0.016968930140137672, decouple_loss:0.0003523502382449806
The modified gen p mean: 0.4495316743850708, gen p mean: -0.11316731572151184, mean p set: 0.4500633478164673
loss_pred:0.016130728647112846, decouple_loss:0.00036910365452058613
The modified gen p mean: 0.44983038306236267, gen p mean: -0.11230441927909851, mean p set: 0.45035696029663086
loss_pred:0.016472578048706055, decouple_loss:0.00037839642027392983
WV_1_PC_1_EH_0_PS_40, loss: 0.016542410477995872, avg_mse: 0.02583164907991886
current test mse: 0.025832
Iteration: 1561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813013076782227, gen p mean: -0.1114673987030983, mean p set: 0.4487065374851227
loss_pred:0.014671139419078827, decouple_loss:0.00035394480801187456
The modified gen p mean: 0.44797462224960327, gen p mean: -0.11374201625585556, mean p set: 0.4485490918159485
loss_pred:0.015774793922901154, decouple_loss:0.0004490787396207452
The modified gen p mean: 0.4479038417339325, gen p mean: -0.11793527007102966, mean p set: 0.44847962260246277
loss_pred:0.01576809026300907, decouple_loss:0.00031161162769421935
Iteration: 1562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471934139728546, gen p mean: -0.121008962392807, mean p set: 0.44776955246925354
loss_pred:0.015140742994844913, decouple_loss:0.0003751445619855076
The modified gen p mean: 0.44761937856674194, gen p mean: -0.1167282834649086, mean p set: 0.44819650053977966The modified gen p mean: 0.44868823885917664, gen p mean: -0.12284184247255325, mean p set: 0.44926151633262634
loss_pred:0.014397677034139633, decouple_loss:0.00046434885007329285loss_pred:0.014836959540843964, decouple_loss:0.0004367859219200909
Iteration: 1563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781067967414856, gen p mean: -0.11799692362546921, mean p set: 0.44838589429855347
loss_pred:0.015441207215189934, decouple_loss:0.0004042959481012076
The modified gen p mean: 0.4479709267616272, gen p mean: -0.1190900057554245, mean p set: 0.44854554533958435The modified gen p mean: 0.4483303129673004, gen p mean: -0.12286220490932465, mean p set: 0.4489077031612396
loss_pred:0.014278328977525234, decouple_loss:0.00046928515075705945
loss_pred:0.014433503150939941, decouple_loss:0.0004185254801996052
Iteration: 1564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475385844707489, gen p mean: -0.12152677774429321, mean p set: 0.4481166899204254
loss_pred:0.015596487559378147, decouple_loss:0.0004833170969504863
The modified gen p mean: 0.44742071628570557, gen p mean: -0.12115580588579178, mean p set: 0.4479960799217224
loss_pred:0.01519983820617199, decouple_loss:0.0004138169751968235
The modified gen p mean: 0.4474043846130371, gen p mean: -0.12028714269399643, mean p set: 0.44797900319099426
loss_pred:0.015164862386882305, decouple_loss:0.0003985688672401011
Iteration: 1565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788482785224915, gen p mean: -0.1239401325583458, mean p set: 0.44846177101135254
loss_pred:0.01508081704378128, decouple_loss:0.0005072015337646008
The modified gen p mean: 0.4479069113731384, gen p mean: -0.1221357136964798, mean p set: 0.4484822154045105
The modified gen p mean: 0.4483211040496826, gen p mean: -0.12137012928724289, mean p set: 0.44889721274375916
loss_pred:0.01495699305087328, decouple_loss:0.00039051510975696146
loss_pred:0.014715122058987617, decouple_loss:0.0004699438577517867
Iteration: 1566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476760923862457, gen p mean: -0.12840689718723297, mean p set: 0.4482516348361969
The modified gen p mean: 0.44744184613227844, gen p mean: -0.12314238399267197, mean p set: 0.4480193257331848
loss_pred:0.015289075672626495, decouple_loss:0.0005177183775231242
loss_pred:0.014869135804474354, decouple_loss:0.0004067191621288657
The modified gen p mean: 0.447456419467926, gen p mean: -0.1320199966430664, mean p set: 0.44802939891815186
loss_pred:0.01512538269162178, decouple_loss:0.00043163602822460234
Iteration: 1567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485883414745331, gen p mean: -0.12599971890449524, mean p set: 0.4491655230522156
loss_pred:0.014792089350521564, decouple_loss:0.0005303679499775171
The modified gen p mean: 0.4477565288543701, gen p mean: -0.124233677983284, mean p set: 0.4483332633972168
The modified gen p mean: 0.4477365016937256, gen p mean: -0.1244366392493248, mean p set: 0.4483139216899872
loss_pred:0.015035253018140793, decouple_loss:0.00044742177124135196
loss_pred:0.014814144931733608, decouple_loss:0.0005628525977954268
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
NaN value num: 0
Iteration: 1568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508875608444214, gen p mean: -0.12129756808280945, mean p set: 0.4514629542827606
loss_pred:0.015517652966082096, decouple_loss:0.0004508538404479623
The modified gen p mean: 0.4494789242744446, gen p mean: -0.1254657804965973, mean p set: 0.45005518198013306
The modified gen p mean: 0.450001984834671, gen p mean: -0.12632253766059875, mean p set: 0.4505777657032013
loss_pred:0.015498954802751541, decouple_loss:0.0004438971809577197
loss_pred:0.01597084477543831, decouple_loss:0.00039602775359526277
Iteration: 1569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507615268230438, gen p mean: -0.12145265936851501, mean p set: 0.45133963227272034
loss_pred:0.015745064243674278, decouple_loss:0.00044300896115601063
The modified gen p mean: 0.4517229199409485, gen p mean: -0.12730467319488525, mean p set: 0.4523029327392578
loss_pred:0.015523506328463554, decouple_loss:0.0004698253469541669
The modified gen p mean: 0.4526735544204712, gen p mean: -0.12368273735046387, mean p set: 0.4532485604286194
loss_pred:0.016010580584406853, decouple_loss:0.0005627595237456262
Iteration: 1570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45229217410087585, gen p mean: -0.12270715832710266, mean p set: 0.452870637178421
loss_pred:0.01635109633207321, decouple_loss:0.0003825189487542957
The modified gen p mean: 0.45081445574760437, gen p mean: -0.12376747280359268, mean p set: 0.451394259929657
loss_pred:0.015619158744812012, decouple_loss:0.0004000482149422169
The modified gen p mean: 0.4524855613708496, gen p mean: -0.12283065915107727, mean p set: 0.45306456089019775
loss_pred:0.015425624325871468, decouple_loss:0.00040426591294817626
2023-05-02 09:08:49 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1299511045217514, mean p set: 0.4502691626548767
loss_pred:0.01687232404947281, decouple_loss:0.00041679030982777476
The modified gen p mean: 0.44953441619873047, gen p mean: -0.12357202172279358, mean p set: 0.4500633478164673
loss_pred:0.01615617424249649, decouple_loss:0.0004761740274261683
The modified gen p mean: 0.44982707500457764, gen p mean: -0.12251999974250793, mean p set: 0.45035696029663086
loss_pred:0.01645255833864212, decouple_loss:0.00045950646745041013
WV_1_PC_1_EH_0_PS_40, loss: 0.016516227275133133, avg_mse: 0.02578778751194477
current test mse: 0.025788
Iteration: 1571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452369749546051, gen p mean: -0.11282029002904892, mean p set: 0.45294633507728577
loss_pred:0.015532681718468666, decouple_loss:0.00043031745008192956
The modified gen p mean: 0.4524989426136017, gen p mean: -0.11812230199575424, mean p set: 0.4530753493309021The modified gen p mean: 0.45061081647872925, gen p mean: -0.125962033867836, mean p set: 0.4511864483356476
loss_pred:0.015267599374055862, decouple_loss:0.0004339114238973707
loss_pred:0.015951016917824745, decouple_loss:0.00037735229125246406
Iteration: 1572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520537853240967, gen p mean: -0.12054894119501114, mean p set: 0.4526323080062866
loss_pred:0.015407281927764416, decouple_loss:0.0004040985950268805
The modified gen p mean: 0.4520954191684723, gen p mean: -0.11548062413930893, mean p set: 0.45267021656036377The modified gen p mean: 0.4527708888053894, gen p mean: -0.1221100315451622, mean p set: 0.45334672927856445
loss_pred:0.015732433646917343, decouple_loss:0.0004627250600606203
loss_pred:0.01560941431671381, decouple_loss:0.0005137230618856847
Iteration: 1573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45290979743003845, gen p mean: -0.12022600322961807, mean p set: 0.45348870754241943
loss_pred:0.015705697238445282, decouple_loss:0.0005859602242708206
The modified gen p mean: 0.45157942175865173, gen p mean: -0.12128095328807831, mean p set: 0.45215752720832825
loss_pred:0.015408762730658054, decouple_loss:0.00047098787035793066
The modified gen p mean: 0.4509105086326599, gen p mean: -0.12918366491794586, mean p set: 0.45148760080337524
loss_pred:0.015193523839116096, decouple_loss:0.0004878515610471368
Iteration: 1574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45286694169044495, gen p mean: -0.11822137236595154, mean p set: 0.4534425735473633
loss_pred:0.015700390562415123, decouple_loss:0.0004198355309199542
The modified gen p mean: 0.4501955509185791, gen p mean: -0.126776784658432, mean p set: 0.45077502727508545
loss_pred:0.015774492174386978, decouple_loss:0.00035088389995507896
The modified gen p mean: 0.45145514607429504, gen p mean: -0.12539412081241608, mean p set: 0.45203009247779846
loss_pred:0.014959604479372501, decouple_loss:0.00038987031439319253
Iteration: 1575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45237410068511963, gen p mean: -0.1330164074897766, mean p set: 0.4529498815536499
loss_pred:0.015321670100092888, decouple_loss:0.0005059386603534222
The modified gen p mean: 0.45122236013412476, gen p mean: -0.12875115871429443, mean p set: 0.4518008232116699
loss_pred:0.015084892511367798, decouple_loss:0.0003298130177427083
The modified gen p mean: 0.4524022042751312, gen p mean: -0.12780646979808807, mean p set: 0.4529772400856018
loss_pred:0.015243467874825, decouple_loss:0.0004116404161322862
Iteration: 1576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45336824655532837, gen p mean: -0.12643618881702423, mean p set: 0.4539449214935303
loss_pred:0.015712128952145576, decouple_loss:0.0005016684881411493
The modified gen p mean: 0.4519732594490051, gen p mean: -0.12407045066356659, mean p set: 0.45254912972450256
loss_pred:0.015338312834501266, decouple_loss:0.0004119147197343409
The modified gen p mean: 0.4530137777328491, gen p mean: -0.13005216419696808, mean p set: 0.45359036326408386
loss_pred:0.01619505137205124, decouple_loss:0.0005152212106622756
Iteration: 1577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45212048292160034, gen p mean: -0.13239474594593048, mean p set: 0.45269668102264404
loss_pred:0.015120740048587322, decouple_loss:0.0003582421049941331
The modified gen p mean: 0.45193973183631897, gen p mean: -0.12163858115673065, mean p set: 0.452517032623291
The modified gen p mean: 0.45249512791633606, gen p mean: -0.13275274634361267, mean p set: 0.453070729970932
loss_pred:0.015488357283174992, decouple_loss:0.0004009322146885097
loss_pred:0.015459084883332253, decouple_loss:0.0006423808517865837
Iteration: 1578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506787657737732, gen p mean: -0.12375728040933609, mean p set: 0.45125651359558105
loss_pred:0.015094952657818794, decouple_loss:0.0005111120408400893
The modified gen p mean: 0.45479151606559753, gen p mean: -0.12849286198616028, mean p set: 0.45536860823631287
loss_pred:0.014967848546802998, decouple_loss:0.0005334715242497623
The modified gen p mean: 0.45270833373069763, gen p mean: -0.12932874262332916, mean p set: 0.45328548550605774
loss_pred:0.015199335291981697, decouple_loss:0.0007197496597655118
Iteration: 1579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44926270842552185, gen p mean: -0.12515540421009064, mean p set: 0.4498353600502014
loss_pred:0.015421345829963684, decouple_loss:0.0004990067100152373
The modified gen p mean: 0.45132899284362793, gen p mean: -0.12417665123939514, mean p set: 0.45190730690956116
The modified gen p mean: 0.45122283697128296, gen p mean: -0.12189602106809616, mean p set: 0.45180368423461914
loss_pred:0.015835648402571678, decouple_loss:0.0004692247894126922
loss_pred:0.015478050336241722, decouple_loss:0.0004950097645632923
Iteration: 1580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537317156791687, gen p mean: -0.1219099685549736, mean p set: 0.4543078541755676
loss_pred:0.015508483164012432, decouple_loss:0.0006202855729497969
The modified gen p mean: 0.452398419380188, gen p mean: -0.11683361232280731, mean p set: 0.452976793050766
The modified gen p mean: 0.45260870456695557, gen p mean: -0.12491767853498459, mean p set: 0.4531856179237366
loss_pred:0.015403169207274914, decouple_loss:0.0005556468386203051
loss_pred:0.0149688133969903, decouple_loss:0.0005529386107809842
2023-05-02 09:10:53 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12977324426174164, mean p set: 0.4502691626548767
loss_pred:0.016979312524199486, decouple_loss:0.0005560169811360538
The modified gen p mean: 0.4495370388031006, gen p mean: -0.12306462228298187, mean p set: 0.4500633478164673
loss_pred:0.01625312864780426, decouple_loss:0.0006220361101441085
The modified gen p mean: 0.44983211159706116, gen p mean: -0.1225200966000557, mean p set: 0.45035696029663086
loss_pred:0.01652798429131508, decouple_loss:0.0007583901169709861
WV_1_PC_1_EH_0_PS_40, loss: 0.016619082540273666, avg_mse: 0.02588302455842495
current test mse: 0.025883
Iteration: 1581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45556575059890747, gen p mean: -0.12164594233036041, mean p set: 0.45614469051361084
The modified gen p mean: 0.4529334306716919, gen p mean: -0.11944454908370972, mean p set: 0.45351067185401917
loss_pred:0.015575995668768883, decouple_loss:0.0004949329304508865
loss_pred:0.015257424674928188, decouple_loss:0.0006497818976640701
The modified gen p mean: 0.4522301256656647, gen p mean: -0.12218526005744934, mean p set: 0.4528070092201233
loss_pred:0.015407778322696686, decouple_loss:0.0004899922641925514
Iteration: 1582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450995534658432, gen p mean: -0.118109792470932, mean p set: 0.45157214999198914
loss_pred:0.015758734196424484, decouple_loss:0.0005327958497218788
The modified gen p mean: 0.45193904638290405, gen p mean: -0.12108735740184784, mean p set: 0.45251479744911194The modified gen p mean: 0.45381009578704834, gen p mean: -0.12216868251562119, mean p set: 0.4543859660625458
loss_pred:0.015208747237920761, decouple_loss:0.00044871377758681774
loss_pred:0.014653106220066547, decouple_loss:0.0005965402233414352
Iteration: 1583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451200395822525, gen p mean: -0.12656259536743164, mean p set: 0.451773464679718
loss_pred:0.015444791875779629, decouple_loss:0.0005218667211011052
The modified gen p mean: 0.45131421089172363, gen p mean: -0.12123506516218185, mean p set: 0.45189061760902405
loss_pred:0.01521677803248167, decouple_loss:0.0006043331231921911
The modified gen p mean: 0.4522897005081177, gen p mean: -0.11598832905292511, mean p set: 0.4528656601905823
loss_pred:0.015447411686182022, decouple_loss:0.0005933850770816207
Iteration: 1584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45027998089790344, gen p mean: -0.12136881798505783, mean p set: 0.45085322856903076
loss_pred:0.01597185619175434, decouple_loss:0.0005012500914745033
The modified gen p mean: 0.45463860034942627, gen p mean: -0.11906122416257858, mean p set: 0.4552163779735565
loss_pred:0.015672195702791214, decouple_loss:0.0005762419896200299
The modified gen p mean: 0.45295894145965576, gen p mean: -0.1202176958322525, mean p set: 0.45353925228118896
loss_pred:0.015452837571501732, decouple_loss:0.0005139436107128859
Iteration: 1585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501519203186035, gen p mean: -0.12163810431957245, mean p set: 0.45073044300079346
loss_pred:0.015604262240231037, decouple_loss:0.0003692549653351307
The modified gen p mean: 0.44959402084350586, gen p mean: -0.12559670209884644, mean p set: 0.45016953349113464
loss_pred:0.015504869632422924, decouple_loss:0.00040438753785565495
The modified gen p mean: 0.45243245363235474, gen p mean: -0.1257043480873108, mean p set: 0.4530124366283417
loss_pred:0.015326308086514473, decouple_loss:0.0005525494925677776
Iteration: 1586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451538622379303, gen p mean: -0.12337063252925873, mean p set: 0.45211559534072876
The modified gen p mean: 0.4516941010951996, gen p mean: -0.12323588132858276, mean p set: 0.45227131247520447loss_pred:0.015321584418416023, decouple_loss:0.00036028536851517856
loss_pred:0.015473633073270321, decouple_loss:0.0004933970631100237
The modified gen p mean: 0.45123162865638733, gen p mean: -0.12175823748111725, mean p set: 0.4518042206764221
loss_pred:0.0150985736399889, decouple_loss:0.000467801874037832
Iteration: 1587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45273470878601074, gen p mean: -0.12456899881362915, mean p set: 0.4533127248287201
The modified gen p mean: 0.45158636569976807, gen p mean: -0.12927120923995972, mean p set: 0.4521603584289551
loss_pred:0.015227274969220161, decouple_loss:0.0005009880987927318
loss_pred:0.014823212288320065, decouple_loss:0.00040373989031650126
The modified gen p mean: 0.4507790207862854, gen p mean: -0.13084548711776733, mean p set: 0.4513516426086426
loss_pred:0.015200278721749783, decouple_loss:0.00040294943028129637
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 1588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44594112038612366, gen p mean: -0.13176697492599487, mean p set: 0.44651728868484497
loss_pred:0.015298595651984215, decouple_loss:0.0006585541996173561
The modified gen p mean: 0.44796034693717957, gen p mean: -0.13415084779262543, mean p set: 0.4485393166542053
The modified gen p mean: 0.4465351700782776, gen p mean: -0.13774043321609497, mean p set: 0.4471103250980377
loss_pred:0.014630663208663464, decouple_loss:0.00046430237125605345
loss_pred:0.015694640576839447, decouple_loss:0.0006145680090412498
Iteration: 1589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718101620674133, gen p mean: -0.13754792511463165, mean p set: 0.44775745272636414
loss_pred:0.015079467557370663, decouple_loss:0.00035978941014036536
The modified gen p mean: 0.4478619396686554, gen p mean: -0.1380886286497116, mean p set: 0.44843369722366333
loss_pred:0.015102573670446873, decouple_loss:0.0003865778853651136
The modified gen p mean: 0.44800084829330444, gen p mean: -0.1342509686946869, mean p set: 0.4485742151737213
loss_pred:0.015024966560304165, decouple_loss:0.000377100077457726
Iteration: 1590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446746289730072, gen p mean: -0.13498885929584503, mean p set: 0.4473235309123993
loss_pred:0.014963322319090366, decouple_loss:0.0005678771412931383
The modified gen p mean: 0.4472334384918213, gen p mean: -0.13704580068588257, mean p set: 0.4478101134300232
The modified gen p mean: 0.44735169410705566, gen p mean: -0.13052241504192352, mean p set: 0.44792816042900085
loss_pred:0.015111429616808891, decouple_loss:0.0004974523326382041
loss_pred:0.014739351347088814, decouple_loss:0.0005615112604573369
2023-05-02 09:13:38 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.14021077752113342, mean p set: 0.4502691626548767
loss_pred:0.016970563679933548, decouple_loss:0.0005610116641037166
The modified gen p mean: 0.44953668117523193, gen p mean: -0.13348938524723053, mean p set: 0.4500633478164673
loss_pred:0.01626572385430336, decouple_loss:0.000525364768691361
The modified gen p mean: 0.44982972741127014, gen p mean: -0.133116215467453, mean p set: 0.45035696029663086
loss_pred:0.016481919214129448, decouple_loss:0.0004375582793727517
WV_1_PC_1_EH_0_PS_40, loss: 0.016598135232925415, avg_mse: 0.0259700994938612
current test mse: 0.02597
Iteration: 1591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482418894767761, gen p mean: -0.13691653311252594, mean p set: 0.4488171935081482
loss_pred:0.014907781966030598, decouple_loss:0.00045681354822590947
The modified gen p mean: 0.4471597373485565, gen p mean: -0.1369873434305191, mean p set: 0.44773492217063904The modified gen p mean: 0.4461716115474701, gen p mean: -0.1356273740530014, mean p set: 0.4467467665672302
loss_pred:0.014914145693182945, decouple_loss:0.0005314518930390477
loss_pred:0.014870664104819298, decouple_loss:0.00042677452438510954
Iteration: 1592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807863235473633, gen p mean: -0.138506218791008, mean p set: 0.4486536979675293
loss_pred:0.014768601395189762, decouple_loss:0.00037143053486943245
The modified gen p mean: 0.44659847021102905, gen p mean: -0.13920806348323822, mean p set: 0.4471730887889862The modified gen p mean: 0.44692426919937134, gen p mean: -0.1370711773633957, mean p set: 0.4474954903125763
loss_pred:0.01517280749976635, decouple_loss:0.0004257963737472892
loss_pred:0.015508675016462803, decouple_loss:0.0004440300108399242
Iteration: 1593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485574960708618, gen p mean: -0.13377708196640015, mean p set: 0.4491317868232727
loss_pred:0.014566371217370033, decouple_loss:0.0005294985021464527
The modified gen p mean: 0.4477689266204834, gen p mean: -0.1304740160703659, mean p set: 0.4483456313610077
loss_pred:0.014957952313125134, decouple_loss:0.0006087225046940148
The modified gen p mean: 0.447073757648468, gen p mean: -0.12973414361476898, mean p set: 0.44764673709869385
loss_pred:0.015088064596056938, decouple_loss:0.0006764689460396767
Iteration: 1594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472172260284424, gen p mean: -0.13981536030769348, mean p set: 0.4477926790714264
loss_pred:0.015217217616736889, decouple_loss:0.0005476827500388026
The modified gen p mean: 0.4481792747974396, gen p mean: -0.14014215767383575, mean p set: 0.44875964522361755
loss_pred:0.015001915395259857, decouple_loss:0.0005594282993115485
The modified gen p mean: 0.4466649293899536, gen p mean: -0.1372576802968979, mean p set: 0.447241872549057
loss_pred:0.015455900691449642, decouple_loss:0.0005578847485594451
Iteration: 1595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806426763534546, gen p mean: -0.13493186235427856, mean p set: 0.4486377537250519
loss_pred:0.015002381056547165, decouple_loss:0.0004219060647301376
The modified gen p mean: 0.44752955436706543, gen p mean: -0.13906721770763397, mean p set: 0.44810402393341064
loss_pred:0.014588000252842903, decouple_loss:0.0003857990668620914
The modified gen p mean: 0.4474390149116516, gen p mean: -0.13125433027744293, mean p set: 0.4480171501636505
loss_pred:0.0152791328728199, decouple_loss:0.0004285226168576628
Iteration: 1596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44655856490135193, gen p mean: -0.13128207623958588, mean p set: 0.44713273644447327
loss_pred:0.014976989477872849, decouple_loss:0.00037479083403013647
The modified gen p mean: 0.44575971364974976, gen p mean: -0.13520820438861847, mean p set: 0.446336567401886
loss_pred:0.015032275579869747, decouple_loss:0.00039607309736311436
The modified gen p mean: 0.44658324122428894, gen p mean: -0.13258254528045654, mean p set: 0.4471621811389923
loss_pred:0.014919753186404705, decouple_loss:0.00042268552351742983
Iteration: 1597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477277994155884, gen p mean: -0.1377437263727188, mean p set: 0.44830334186553955
loss_pred:0.014743269421160221, decouple_loss:0.00044594969949685037
The modified gen p mean: 0.4459688663482666, gen p mean: -0.1321999579668045, mean p set: 0.4465450048446655
loss_pred:0.014799253083765507, decouple_loss:0.00045751951984129846
The modified gen p mean: 0.44609636068344116, gen p mean: -0.13437823951244354, mean p set: 0.44667288661003113
loss_pred:0.014640397392213345, decouple_loss:0.0004891406861133873
Iteration: 1598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800350069999695, gen p mean: -0.12990300357341766, mean p set: 0.44857946038246155
loss_pred:0.014492735266685486, decouple_loss:0.0004383868654258549
The modified gen p mean: 0.4480993151664734, gen p mean: -0.12825758755207062, mean p set: 0.4486773908138275
The modified gen p mean: 0.4465823769569397, gen p mean: -0.13079294562339783, mean p set: 0.44715774059295654
loss_pred:0.014686631970107555, decouple_loss:0.0004818144370801747
loss_pred:0.014732449315488338, decouple_loss:0.0004327698552515358
Iteration: 1599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478990435600281, gen p mean: -0.13000835478305817, mean p set: 0.4484725892543793
loss_pred:0.014279372058808804, decouple_loss:0.000446088524768129
The modified gen p mean: 0.44822561740875244, gen p mean: -0.12187527120113373, mean p set: 0.4487995207309723
loss_pred:0.015264767222106457, decouple_loss:0.00040468829683959484
The modified gen p mean: 0.4478306472301483, gen p mean: -0.12912517786026, mean p set: 0.44840726256370544
loss_pred:0.01494896225631237, decouple_loss:0.0003934725536964834
Iteration: 1600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476287364959717, gen p mean: -0.1228436678647995, mean p set: 0.44820424914360046
loss_pred:0.015035073272883892, decouple_loss:0.0004059204657096416
The modified gen p mean: 0.4477689564228058, gen p mean: -0.12437499314546585, mean p set: 0.44834527373313904
The modified gen p mean: 0.44632819294929504, gen p mean: -0.12410110980272293, mean p set: 0.4469052851200104
loss_pred:0.015407138504087925, decouple_loss:0.00044551590690389276
loss_pred:0.01454025600105524, decouple_loss:0.0005814220639877021
2023-05-02 09:15:43 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12940295040607452, mean p set: 0.4502691626548767
loss_pred:0.01703461818397045, decouple_loss:0.00046286475844681263
The modified gen p mean: 0.4495348334312439, gen p mean: -0.12282787263393402, mean p set: 0.4500633478164673
loss_pred:0.01620618999004364, decouple_loss:0.00043181105866096914
The modified gen p mean: 0.44982773065567017, gen p mean: -0.1220463365316391, mean p set: 0.45035696029663086
loss_pred:0.016468117013573647, decouple_loss:0.0004254264058545232
WV_1_PC_1_EH_0_PS_40, loss: 0.016591643914580345, avg_mse: 0.02599465660750866
current test mse: 0.025995
Iteration: 1601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741711020469666, gen p mean: -0.12348847091197968, mean p set: 0.44799429178237915
loss_pred:0.014248955063521862, decouple_loss:0.00036627743975259364
The modified gen p mean: 0.44774702191352844, gen p mean: -0.12458518892526627, mean p set: 0.44832614064216614
The modified gen p mean: 0.44737425446510315, gen p mean: -0.12258419394493103, mean p set: 0.4479508101940155
loss_pred:0.01405350398272276, decouple_loss:0.000531148980371654
loss_pred:0.015087312087416649, decouple_loss:0.0004384079948067665
Iteration: 1602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803038239479065, gen p mean: -0.12375131249427795, mean p set: 0.44860827922821045
loss_pred:0.014341708272695541, decouple_loss:0.00043288213782943785
The modified gen p mean: 0.447560578584671, gen p mean: -0.1259947419166565, mean p set: 0.4481382668018341The modified gen p mean: 0.44724467396736145, gen p mean: -0.12568128108978271, mean p set: 0.447822630405426
loss_pred:0.014617782086133957, decouple_loss:0.00042246407247148454
loss_pred:0.01455976814031601, decouple_loss:0.0003635529428720474
Iteration: 1603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718971848487854, gen p mean: -0.12060899287462234, mean p set: 0.4477651119232178
loss_pred:0.015024688094854355, decouple_loss:0.0004489511775318533
The modified gen p mean: 0.44854027032852173, gen p mean: -0.12712164223194122, mean p set: 0.449113667011261
loss_pred:0.014814488589763641, decouple_loss:0.00044657065882347524
The modified gen p mean: 0.44802069664001465, gen p mean: -0.12443173676729202, mean p set: 0.4485970735549927
loss_pred:0.01414287369698286, decouple_loss:0.00034162821248173714
Iteration: 1604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472283124923706, gen p mean: -0.12931425869464874, mean p set: 0.44780153036117554
loss_pred:0.015611213631927967, decouple_loss:0.0005065264995209873
The modified gen p mean: 0.4479488134384155, gen p mean: -0.12472733855247498, mean p set: 0.44852498173713684
loss_pred:0.015155616216361523, decouple_loss:0.0003785276785492897
The modified gen p mean: 0.44724103808403015, gen p mean: -0.12925319373607635, mean p set: 0.44781628251075745
loss_pred:0.015188231132924557, decouple_loss:0.00042872352059930563
Iteration: 1605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462290108203888, gen p mean: -0.13075873255729675, mean p set: 0.4468037486076355
loss_pred:0.015057200565934181, decouple_loss:0.0003841174184344709
The modified gen p mean: 0.4477478265762329, gen p mean: -0.12181894481182098, mean p set: 0.44832247495651245
loss_pred:0.01546463929116726, decouple_loss:0.0003690549056045711
The modified gen p mean: 0.4470977187156677, gen p mean: -0.12136398255825043, mean p set: 0.4476746618747711
loss_pred:0.01482449471950531, decouple_loss:0.0004060888895764947
Iteration: 1606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751814007759094, gen p mean: -0.12205655872821808, mean p set: 0.4480930268764496
loss_pred:0.015057758428156376, decouple_loss:0.00039952757651917636
The modified gen p mean: 0.447678804397583, gen p mean: -0.13145811855793, mean p set: 0.4482541084289551
The modified gen p mean: 0.44724586606025696, gen p mean: -0.12499560415744781, mean p set: 0.44781988859176636
loss_pred:0.014965252950787544, decouple_loss:0.0003754968929570168
loss_pred:0.015430503524839878, decouple_loss:0.0004130549496039748
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454822540283203, gen p mean: -0.11871007829904556, mean p set: 0.4460587203502655
The modified gen p mean: 0.4466024339199066, gen p mean: -0.1204519122838974, mean p set: 0.447177916765213
loss_pred:0.014438148587942123, decouple_loss:0.0004089700523763895
loss_pred:0.014453737996518612, decouple_loss:0.00036155260750092566
The modified gen p mean: 0.44759735465049744, gen p mean: -0.12408366799354553, mean p set: 0.44817250967025757
loss_pred:0.014839979819953442, decouple_loss:0.0003704639384523034
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 1608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767796993255615, gen p mean: -0.11981173604726791, mean p set: 0.4482552707195282
loss_pred:0.015706175938248634, decouple_loss:0.00039718032348901033
The modified gen p mean: 0.44793033599853516, gen p mean: -0.11986533552408218, mean p set: 0.4485079050064087
The modified gen p mean: 0.4480409622192383, gen p mean: -0.12426849454641342, mean p set: 0.44861847162246704
loss_pred:0.014641270972788334, decouple_loss:0.0003662006347440183
loss_pred:0.014804021455347538, decouple_loss:0.00037616793997585773
Iteration: 1609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823357462882996, gen p mean: -0.12045332044363022, mean p set: 0.44880983233451843
loss_pred:0.016219252720475197, decouple_loss:0.0004423582286108285
The modified gen p mean: 0.4475075602531433, gen p mean: -0.11877872049808502, mean p set: 0.4480845034122467
loss_pred:0.01599985919892788, decouple_loss:0.000377126969397068
The modified gen p mean: 0.4502823054790497, gen p mean: -0.12484720349311829, mean p set: 0.4508599638938904
loss_pred:0.01520970556885004, decouple_loss:0.0006179476040415466
Iteration: 1610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481920003890991, gen p mean: -0.11291837692260742, mean p set: 0.44876912236213684
loss_pred:0.015544385649263859, decouple_loss:0.00039054936496540904
The modified gen p mean: 0.4490903317928314, gen p mean: -0.12460852414369583, mean p set: 0.4496676027774811
The modified gen p mean: 0.4486450254917145, gen p mean: -0.11566048860549927, mean p set: 0.44922152161598206
loss_pred:0.015802277252078056, decouple_loss:0.000405497761676088
loss_pred:0.0157424658536911, decouple_loss:0.00039290208951570094
2023-05-02 09:18:22 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12228582054376602, mean p set: 0.4502691626548767
loss_pred:0.01690821722149849, decouple_loss:0.0003538402961567044
The modified gen p mean: 0.44953563809394836, gen p mean: -0.11610132455825806, mean p set: 0.4500633478164673
loss_pred:0.01606391929090023, decouple_loss:0.0004883403889834881
The modified gen p mean: 0.44982755184173584, gen p mean: -0.11539166420698166, mean p set: 0.45035696029663086
loss_pred:0.016465386375784874, decouple_loss:0.0004784642660524696
WV_1_PC_1_EH_0_PS_40, loss: 0.016501186415553093, avg_mse: 0.025770151987671852
current test mse: 0.02577
Iteration: 1611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775110483169556, gen p mean: -0.1220763549208641, mean p set: 0.44832760095596313
loss_pred:0.014978902414441109, decouple_loss:0.0004267581389285624
The modified gen p mean: 0.44831809401512146, gen p mean: -0.11725965887308121, mean p set: 0.448894202709198The modified gen p mean: 0.4485663175582886, gen p mean: -0.11708233505487442, mean p set: 0.4491422176361084
loss_pred:0.015860438346862793, decouple_loss:0.00035519132507033646
loss_pred:0.015410682186484337, decouple_loss:0.00041958506335504353
Iteration: 1612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728001952171326, gen p mean: -0.1166851744055748, mean p set: 0.44785773754119873
The modified gen p mean: 0.4483779966831207, gen p mean: -0.11870777606964111, mean p set: 0.44895321130752563
loss_pred:0.01509676780551672, decouple_loss:0.00045510943164117634
loss_pred:0.014914287254214287, decouple_loss:0.00040504129719920456
The modified gen p mean: 0.4477618336677551, gen p mean: -0.12126272171735764, mean p set: 0.44833654165267944
loss_pred:0.015268707647919655, decouple_loss:0.0003821889404207468
Iteration: 1613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753095507621765, gen p mean: -0.12295100837945938, mean p set: 0.4481090009212494
loss_pred:0.015137401409447193, decouple_loss:0.000436605594586581
The modified gen p mean: 0.4474489688873291, gen p mean: -0.12153766304254532, mean p set: 0.4480244815349579
loss_pred:0.015172222629189491, decouple_loss:0.0005804703687317669
The modified gen p mean: 0.4472994804382324, gen p mean: -0.12344588339328766, mean p set: 0.4478755593299866
loss_pred:0.014786042273044586, decouple_loss:0.0004133309703320265
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481208622455597, gen p mean: -0.11728192865848541, mean p set: 0.44869568943977356
loss_pred:0.01517590694129467, decouple_loss:0.0004139070806559175
The modified gen p mean: 0.4474674165248871, gen p mean: -0.11720523983240128, mean p set: 0.44804567098617554
loss_pred:0.014708113856613636, decouple_loss:0.0004861454654019326
The modified gen p mean: 0.4494146704673767, gen p mean: -0.11589571088552475, mean p set: 0.4499906599521637
loss_pred:0.015160663984715939, decouple_loss:0.0004227246972732246
Iteration: 1615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484238028526306, gen p mean: -0.12135156244039536, mean p set: 0.4489997327327728
loss_pred:0.015107457526028156, decouple_loss:0.000508459925185889
The modified gen p mean: 0.447619765996933, gen p mean: -0.11707183718681335, mean p set: 0.44819530844688416
loss_pred:0.01544207613915205, decouple_loss:0.0004859712498728186
The modified gen p mean: 0.44701167941093445, gen p mean: -0.1159171536564827, mean p set: 0.4475880563259125
loss_pred:0.015509660355746746, decouple_loss:0.0004643024876713753
Iteration: 1616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815772771835327, gen p mean: -0.11471409350633621, mean p set: 0.4487335979938507
loss_pred:0.015132760629057884, decouple_loss:0.0004177308874204755
The modified gen p mean: 0.44724342226982117, gen p mean: -0.1204100251197815, mean p set: 0.4478192627429962
loss_pred:0.014117876067757607, decouple_loss:0.0003374579537194222
The modified gen p mean: 0.4493597745895386, gen p mean: -0.11764128506183624, mean p set: 0.4499371349811554
loss_pred:0.015000865794718266, decouple_loss:0.0005139301065355539
Iteration: 1617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481514096260071, gen p mean: -0.11317127197980881, mean p set: 0.44872695207595825
loss_pred:0.015308236703276634, decouple_loss:0.0003485929628368467
The modified gen p mean: 0.4476785361766815, gen p mean: -0.11848776787519455, mean p set: 0.44825538992881775
The modified gen p mean: 0.44848963618278503, gen p mean: -0.11890998482704163, mean p set: 0.4490683674812317
loss_pred:0.014814605005085468, decouple_loss:0.00043261193786747754
loss_pred:0.014757869765162468, decouple_loss:0.00036774977343156934
Iteration: 1618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803234934806824, gen p mean: -0.12549492716789246, mean p set: 0.44860783219337463
loss_pred:0.014656645245850086, decouple_loss:0.0004404678475111723
The modified gen p mean: 0.4475877583026886, gen p mean: -0.1256883591413498, mean p set: 0.44816285371780396
The modified gen p mean: 0.44851186871528625, gen p mean: -0.1201493889093399, mean p set: 0.4490887224674225
loss_pred:0.014261163771152496, decouple_loss:0.0005665834178216755
loss_pred:0.0144839808344841, decouple_loss:0.0004457480099517852
Iteration: 1619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480687975883484, gen p mean: -0.12461631745100021, mean p set: 0.4486456513404846
loss_pred:0.015648603439331055, decouple_loss:0.0004498734197113663
The modified gen p mean: 0.44794565439224243, gen p mean: -0.12454506009817123, mean p set: 0.44852176308631897
The modified gen p mean: 0.44705280661582947, gen p mean: -0.1220497265458107, mean p set: 0.44762876629829407
loss_pred:0.015652988106012344, decouple_loss:0.0003764572902582586
loss_pred:0.016504941508173943, decouple_loss:0.00042629410745576024
Iteration: 1620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784054160118103, gen p mean: -0.12464823573827744, mean p set: 0.4484177529811859
loss_pred:0.015370511449873447, decouple_loss:0.000359662197297439
The modified gen p mean: 0.44909781217575073, gen p mean: -0.12430304288864136, mean p set: 0.4496730864048004
The modified gen p mean: 0.4474095106124878, gen p mean: -0.1251196563243866, mean p set: 0.44798803329467773
loss_pred:0.015365250408649445, decouple_loss:0.00041499719372950494
loss_pred:0.014762855134904385, decouple_loss:0.0004230847698636353
2023-05-02 09:20:28 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12526468932628632, mean p set: 0.4502691626548767
loss_pred:0.016933178529143333, decouple_loss:0.0004078232159372419
The modified gen p mean: 0.44953590631484985, gen p mean: -0.11907760053873062, mean p set: 0.4500633478164673
loss_pred:0.016121726483106613, decouple_loss:0.00048103989684022963
The modified gen p mean: 0.4498266875743866, gen p mean: -0.11803025752305984, mean p set: 0.45035696029663086
loss_pred:0.016461944207549095, decouple_loss:0.00042805986595340073
WV_1_PC_1_EH_0_PS_40, loss: 0.01652756705880165, avg_mse: 0.02586556226015091
current test mse: 0.025866
Iteration: 1621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498647451400757, gen p mean: -0.12369591742753983, mean p set: 0.45043665170669556
loss_pred:0.015305235981941223, decouple_loss:0.0003898395807482302
The modified gen p mean: 0.44700872898101807, gen p mean: -0.12311466038227081, mean p set: 0.44758591055870056
loss_pred:0.014543402940034866, decouple_loss:0.0004345649213064462
The modified gen p mean: 0.44831594824790955, gen p mean: -0.12086993455886841, mean p set: 0.4488913416862488
loss_pred:0.015946393832564354, decouple_loss:0.00037290260661393404
Iteration: 1622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473153352737427, gen p mean: -0.12025725096464157, mean p set: 0.44789400696754456
loss_pred:0.015455941669642925, decouple_loss:0.00037969695404171944
The modified gen p mean: 0.4471856951713562, gen p mean: -0.12302683293819427, mean p set: 0.4477599561214447The modified gen p mean: 0.4479571580886841, gen p mean: -0.11676480621099472, mean p set: 0.4485322833061218
loss_pred:0.014819251373410225, decouple_loss:0.0005344864330254495
loss_pred:0.014842924661934376, decouple_loss:0.000391882611438632
Iteration: 1623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486081004142761, gen p mean: -0.11851087957620621, mean p set: 0.44918495416641235
The modified gen p mean: 0.4476332664489746, gen p mean: -0.12121168524026871, mean p set: 0.44820985198020935
loss_pred:0.014892562292516232, decouple_loss:0.00042331748409196734
loss_pred:0.015548204071819782, decouple_loss:0.0004385923675727099
The modified gen p mean: 0.44851377606391907, gen p mean: -0.1199074536561966, mean p set: 0.44908908009529114
loss_pred:0.015476873144507408, decouple_loss:0.0003632689767982811
Iteration: 1624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44834837317466736, gen p mean: -0.11980689316987991, mean p set: 0.44892382621765137
The modified gen p mean: 0.44711098074913025, gen p mean: -0.12072668969631195, mean p set: 0.447688490152359
loss_pred:0.014865369535982609, decouple_loss:0.00046208841376937926
loss_pred:0.015051952563226223, decouple_loss:0.00043726287549361587
The modified gen p mean: 0.4479990005493164, gen p mean: -0.11985558271408081, mean p set: 0.44857507944107056
loss_pred:0.014719893224537373, decouple_loss:0.000400526070734486
Iteration: 1625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477273225784302, gen p mean: -0.11898911744356155, mean p set: 0.4483044445514679
loss_pred:0.015410472638905048, decouple_loss:0.0006023151217959821
The modified gen p mean: 0.44742169976234436, gen p mean: -0.12089823186397552, mean p set: 0.44799840450286865
loss_pred:0.015702687203884125, decouple_loss:0.00040848972275853157
The modified gen p mean: 0.44831833243370056, gen p mean: -0.12162904441356659, mean p set: 0.4488926827907562
loss_pred:0.015295423567295074, decouple_loss:0.00044399109901860356
Iteration: 1626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496113359928131, gen p mean: -0.12839868664741516, mean p set: 0.4501863420009613
loss_pred:0.015049725770950317, decouple_loss:0.0004202003183308989
The modified gen p mean: 0.44826430082321167, gen p mean: -0.12193262577056885, mean p set: 0.4488394856452942
loss_pred:0.015172070823609829, decouple_loss:0.0004504678363446146
The modified gen p mean: 0.44818058609962463, gen p mean: -0.12445038557052612, mean p set: 0.4487592875957489
loss_pred:0.015961213037371635, decouple_loss:0.00037757671088911593
Iteration: 1627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710177183151245, gen p mean: -0.12290579825639725, mean p set: 0.4476771950721741
loss_pred:0.01633753813803196, decouple_loss:0.0005388168501667678
The modified gen p mean: 0.4472801387310028, gen p mean: -0.12574627995491028, mean p set: 0.4478580951690674
loss_pred:0.01477731578052044, decouple_loss:0.0006206178804859519
The modified gen p mean: 0.4473164677619934, gen p mean: -0.12360674887895584, mean p set: 0.44789284467697144
loss_pred:0.014776119031012058, decouple_loss:0.0003521843464113772
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 1628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785642623901367, gen p mean: -0.12377750873565674, mean p set: 0.4484313726425171
The modified gen p mean: 0.44765573740005493, gen p mean: -0.12134253233671188, mean p set: 0.4482291042804718
loss_pred:0.015412897802889347, decouple_loss:0.000480489747133106
loss_pred:0.015115153044462204, decouple_loss:0.0006024092435836792
The modified gen p mean: 0.4485406279563904, gen p mean: -0.12311392277479172, mean p set: 0.44911760091781616
loss_pred:0.015116633847355843, decouple_loss:0.0004274567181710154
Iteration: 1629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465671479701996, gen p mean: -0.12362018972635269, mean p set: 0.44714176654815674
loss_pred:0.01515888050198555, decouple_loss:0.0003972938866354525
The modified gen p mean: 0.44946277141571045, gen p mean: -0.12551848590373993, mean p set: 0.45003825426101685
loss_pred:0.014911464415490627, decouple_loss:0.0004914096789434552
The modified gen p mean: 0.44888725876808167, gen p mean: -0.12090601772069931, mean p set: 0.4494645595550537
loss_pred:0.015143820084631443, decouple_loss:0.0004047414113301784
Iteration: 1630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841256737709045, gen p mean: -0.1253643035888672, mean p set: 0.44898921251296997
loss_pred:0.0145388999953866, decouple_loss:0.0004007455427199602
The modified gen p mean: 0.44625845551490784, gen p mean: -0.12225887179374695, mean p set: 0.44683340191841125
The modified gen p mean: 0.44945335388183594, gen p mean: -0.12298790365457535, mean p set: 0.450029194355011
loss_pred:0.015339468605816364, decouple_loss:0.000437232869444415
loss_pred:0.015260644257068634, decouple_loss:0.00043678382644429803
2023-05-02 09:23:15 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1283080130815506, mean p set: 0.4502691626548767
loss_pred:0.016936684027314186, decouple_loss:0.0004945338587276638
The modified gen p mean: 0.4495350122451782, gen p mean: -0.12179536372423172, mean p set: 0.4500633478164673
loss_pred:0.016089683398604393, decouple_loss:0.0004383301711641252
The modified gen p mean: 0.4498254954814911, gen p mean: -0.120775006711483, mean p set: 0.45035696029663086
loss_pred:0.016403157263994217, decouple_loss:0.00038969036540947855
WV_1_PC_1_EH_0_PS_40, loss: 0.01649855077266693, avg_mse: 0.025781139731407166
current test mse: 0.025781
Iteration: 1631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799262285232544, gen p mean: -0.12545470893383026, mean p set: 0.44856706261634827
loss_pred:0.015015453100204468, decouple_loss:0.0005031835753470659
The modified gen p mean: 0.44893690943717957, gen p mean: -0.1228359043598175, mean p set: 0.44951245188713074The modified gen p mean: 0.4476277828216553, gen p mean: -0.11644013226032257, mean p set: 0.4482038617134094
loss_pred:0.014557095244526863, decouple_loss:0.00040328718023374677
loss_pred:0.014897619374096394, decouple_loss:0.0006491855019703507
Iteration: 1632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849419593811035, gen p mean: -0.12904968857765198, mean p set: 0.44906941056251526
loss_pred:0.014904365874826908, decouple_loss:0.0004314657999202609
The modified gen p mean: 0.4472997784614563, gen p mean: -0.11761748045682907, mean p set: 0.447873055934906The modified gen p mean: 0.4484771192073822, gen p mean: -0.1250118464231491, mean p set: 0.4490547776222229
loss_pred:0.014968261122703552, decouple_loss:0.00047264230670407414
loss_pred:0.014716126024723053, decouple_loss:0.0004410396795719862
Iteration: 1633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486713707447052, gen p mean: -0.12662392854690552, mean p set: 0.44924765825271606
loss_pred:0.014702025800943375, decouple_loss:0.000498033594340086
The modified gen p mean: 0.44867372512817383, gen p mean: -0.12650591135025024, mean p set: 0.44925105571746826
loss_pred:0.015171797014772892, decouple_loss:0.00047632845235057175
The modified gen p mean: 0.4485992193222046, gen p mean: -0.12619775533676147, mean p set: 0.44917428493499756
loss_pred:0.01451132446527481, decouple_loss:0.0003974924620706588
Iteration: 1634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868963956832886, gen p mean: -0.12352366745471954, mean p set: 0.44926580786705017
loss_pred:0.014650596305727959, decouple_loss:0.00044990930473431945
The modified gen p mean: 0.4488525092601776, gen p mean: -0.1169900894165039, mean p set: 0.4494262933731079
loss_pred:0.015390870161354542, decouple_loss:0.0005421378300525248
The modified gen p mean: 0.4481170177459717, gen p mean: -0.12205326557159424, mean p set: 0.4486922323703766
loss_pred:0.015344664454460144, decouple_loss:0.0004781740135513246
Iteration: 1635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852861762046814, gen p mean: -0.11765001714229584, mean p set: 0.44910410046577454
loss_pred:0.015210679732263088, decouple_loss:0.00042953420779667795
The modified gen p mean: 0.44716131687164307, gen p mean: -0.11899904161691666, mean p set: 0.4477364122867584
loss_pred:0.015070423483848572, decouple_loss:0.00046288687735795975
The modified gen p mean: 0.4477590024471283, gen p mean: -0.11598745733499527, mean p set: 0.4483354985713959
loss_pred:0.015273705124855042, decouple_loss:0.0003793870273511857
Iteration: 1636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479169547557831, gen p mean: -0.1180015280842781, mean p set: 0.4484924077987671
loss_pred:0.014898556284606457, decouple_loss:0.0005580054130405188
The modified gen p mean: 0.4491058588027954, gen p mean: -0.11816810816526413, mean p set: 0.449685275554657
The modified gen p mean: 0.44727960228919983, gen p mean: -0.11802969872951508, mean p set: 0.44785305857658386
loss_pred:0.015020906925201416, decouple_loss:0.0004540499357972294
loss_pred:0.015000802464783192, decouple_loss:0.0003729716991074383
Iteration: 1637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830605387687683, gen p mean: -0.11865551769733429, mean p set: 0.4488835632801056
loss_pred:0.01430654525756836, decouple_loss:0.00047345602069981396
The modified gen p mean: 0.44837895035743713, gen p mean: -0.12224017083644867, mean p set: 0.44895440340042114
The modified gen p mean: 0.4485413134098053, gen p mean: -0.12056010216474533, mean p set: 0.4491156041622162
loss_pred:0.014691621996462345, decouple_loss:0.0005411225720308721
loss_pred:0.015066059306263924, decouple_loss:0.0006000979919917881
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476667642593384, gen p mean: -0.11598364263772964, mean p set: 0.4482443630695343
loss_pred:0.015377464704215527, decouple_loss:0.000526436953805387
The modified gen p mean: 0.4486235976219177, gen p mean: -0.11800805479288101, mean p set: 0.4492001235485077
The modified gen p mean: 0.44804227352142334, gen p mean: -0.11850927025079727, mean p set: 0.44861912727355957
loss_pred:0.014642692171037197, decouple_loss:0.0004748540522996336
loss_pred:0.015142890624701977, decouple_loss:0.0004989008302800357
Iteration: 1639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486488401889801, gen p mean: -0.12251339852809906, mean p set: 0.4492258131504059
loss_pred:0.014670045115053654, decouple_loss:0.00046426578774116933
The modified gen p mean: 0.4485321044921875, gen p mean: -0.12541182339191437, mean p set: 0.44910916686058044
loss_pred:0.015089289285242558, decouple_loss:0.0005388536374084651
The modified gen p mean: 0.44794967770576477, gen p mean: -0.12431951612234116, mean p set: 0.4485251009464264
loss_pred:0.015372197143733501, decouple_loss:0.0006125507061369717
Iteration: 1640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862663745880127, gen p mean: -0.12319304049015045, mean p set: 0.4492073655128479
loss_pred:0.014348944649100304, decouple_loss:0.0007206440786831081
The modified gen p mean: 0.44829562306404114, gen p mean: -0.12606939673423767, mean p set: 0.44887199997901917
loss_pred:0.014811915345489979, decouple_loss:0.0006356020458042622
The modified gen p mean: 0.44746583700180054, gen p mean: -0.12452506273984909, mean p set: 0.44804278016090393
loss_pred:0.015399056486785412, decouple_loss:0.0009123460622504354
2023-05-02 09:25:20 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12868450582027435, mean p set: 0.4502691626548767
loss_pred:0.01691691018640995, decouple_loss:0.0005310441483743489
The modified gen p mean: 0.4495394229888916, gen p mean: -0.12205564975738525, mean p set: 0.4500633478164673
loss_pred:0.016085295006632805, decouple_loss:0.0006192659493535757
The modified gen p mean: 0.4498263895511627, gen p mean: -0.12139055877923965, mean p set: 0.45035696029663086
loss_pred:0.01635902374982834, decouple_loss:0.0005313859437592328
WV_1_PC_1_EH_0_PS_40, loss: 0.01648177206516266, avg_mse: 0.025797860696911812
current test mse: 0.025798
Iteration: 1641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481094181537628, gen p mean: -0.1250300258398056, mean p set: 0.4486883282661438
loss_pred:0.015032858587801456, decouple_loss:0.0005842616083100438
The modified gen p mean: 0.4492344856262207, gen p mean: -0.12609252333641052, mean p set: 0.44981372356414795
loss_pred:0.014392861165106297, decouple_loss:0.0005731015116907656
The modified gen p mean: 0.44798505306243896, gen p mean: -0.12513317167758942, mean p set: 0.44855865836143494
loss_pred:0.014956355094909668, decouple_loss:0.0004937495104968548
Iteration: 1642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485943913459778, gen p mean: -0.12376026809215546, mean p set: 0.44916975498199463
loss_pred:0.015256564132869244, decouple_loss:0.00035508174914866686
The modified gen p mean: 0.44823816418647766, gen p mean: -0.11886845529079437, mean p set: 0.4488137364387512The modified gen p mean: 0.44796162843704224, gen p mean: -0.12375302612781525, mean p set: 0.44853806495666504
loss_pred:0.015279890038073063, decouple_loss:0.00041237479308620095
loss_pred:0.014377914369106293, decouple_loss:0.00045603516628034413
Iteration: 1643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937488436698914, gen p mean: -0.11843134462833405, mean p set: 0.44995051622390747
loss_pred:0.014951929450035095, decouple_loss:0.0006220376235432923
The modified gen p mean: 0.44810280203819275, gen p mean: -0.12418553978204727, mean p set: 0.4486764669418335The modified gen p mean: 0.4486081600189209, gen p mean: -0.12414529174566269, mean p set: 0.4491857588291168
loss_pred:0.014490324072539806, decouple_loss:0.0005044114077463746
loss_pred:0.014793972484767437, decouple_loss:0.0005355241592042148
Iteration: 1644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470970630645752, gen p mean: -0.11789344996213913, mean p set: 0.4476754069328308
loss_pred:0.014880836009979248, decouple_loss:0.0003158199251629412
The modified gen p mean: 0.44733330607414246, gen p mean: -0.12006436288356781, mean p set: 0.4479115903377533
loss_pred:0.01492889504879713, decouple_loss:0.00036601253668777645
The modified gen p mean: 0.448201447725296, gen p mean: -0.12321924418210983, mean p set: 0.4487766921520233
loss_pred:0.014785001054406166, decouple_loss:0.00034728582249954343
Iteration: 1645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474877417087555, gen p mean: -0.1150142028927803, mean p set: 0.4480650722980499
loss_pred:0.014645691961050034, decouple_loss:0.00039148092037066817
The modified gen p mean: 0.44879356026649475, gen p mean: -0.12188930064439774, mean p set: 0.44937053322792053
loss_pred:0.015019634738564491, decouple_loss:0.00036686332896351814
The modified gen p mean: 0.44790175557136536, gen p mean: -0.12014305591583252, mean p set: 0.4484765827655792
loss_pred:0.014859466813504696, decouple_loss:0.000311171606881544
Iteration: 1646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742199778556824, gen p mean: -0.11991856247186661, mean p set: 0.4479973018169403
loss_pred:0.014802656136453152, decouple_loss:0.0005503807333298028
The modified gen p mean: 0.4490484893321991, gen p mean: -0.12361699342727661, mean p set: 0.4496248662471771
loss_pred:0.014989621937274933, decouple_loss:0.0004346934147179127
The modified gen p mean: 0.44867777824401855, gen p mean: -0.12054390460252762, mean p set: 0.4492553174495697
loss_pred:0.014718077145516872, decouple_loss:0.0004042522341478616
Iteration: 1647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481351971626282, gen p mean: -0.12062758952379227, mean p set: 0.44871124625205994
loss_pred:0.014731667935848236, decouple_loss:0.0004337251593824476
The modified gen p mean: 0.44873079657554626, gen p mean: -0.12876150012016296, mean p set: 0.44930675625801086
loss_pred:0.014809212647378445, decouple_loss:0.00042282516369596124
The modified gen p mean: 0.44846394658088684, gen p mean: -0.12358590215444565, mean p set: 0.4490397274494171
loss_pred:0.015047811903059483, decouple_loss:0.00042891374323517084
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
NaN value num: 0
Iteration: 1648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44639936089515686, gen p mean: -0.12207256257534027, mean p set: 0.4469749927520752
loss_pred:0.016775809228420258, decouple_loss:0.00038598565151914954
The modified gen p mean: 0.44733506441116333, gen p mean: -0.12583830952644348, mean p set: 0.4479101598262787
The modified gen p mean: 0.4482167959213257, gen p mean: -0.11304812133312225, mean p set: 0.44879260659217834
loss_pred:0.01724451594054699, decouple_loss:0.0005171056254766881
loss_pred:0.016876665875315666, decouple_loss:0.0004616824153345078
Iteration: 1649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480453133583069, gen p mean: -0.12267745286226273, mean p set: 0.44862115383148193
loss_pred:0.016939686611294746, decouple_loss:0.0004875323793385178
The modified gen p mean: 0.4457818865776062, gen p mean: -0.1232808381319046, mean p set: 0.44635701179504395
loss_pred:0.016883639618754387, decouple_loss:0.0007615433423779905
The modified gen p mean: 0.4483887553215027, gen p mean: -0.12431460618972778, mean p set: 0.448962926864624
loss_pred:0.016864506527781487, decouple_loss:0.0006107151857577264
Iteration: 1650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688674807548523, gen p mean: -0.12187154591083527, mean p set: 0.4474611282348633
loss_pred:0.015852704644203186, decouple_loss:0.0007689420599490404
The modified gen p mean: 0.4472787082195282, gen p mean: -0.12859851121902466, mean p set: 0.4478538930416107
loss_pred:0.016317151486873627, decouple_loss:0.0008041431428864598
The modified gen p mean: 0.44828560948371887, gen p mean: -0.1290789097547531, mean p set: 0.4488610029220581
loss_pred:0.017380837351083755, decouple_loss:0.0003791578928939998
2023-05-02 09:28:12 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12827439606189728, mean p set: 0.4502691626548767
loss_pred:0.01682528480887413, decouple_loss:0.0004982928512617946
The modified gen p mean: 0.44953447580337524, gen p mean: -0.1211945191025734, mean p set: 0.4500633478164673
loss_pred:0.016134096309542656, decouple_loss:0.00040905390051193535
The modified gen p mean: 0.4498290419578552, gen p mean: -0.12032168358564377, mean p set: 0.45035696029663086
loss_pred:0.0164019912481308, decouple_loss:0.0005210659583099186
WV_1_PC_1_EH_0_PS_40, loss: 0.016477597877383232, avg_mse: 0.02579144947230816
current test mse: 0.025791
Iteration: 1651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468705356121063, gen p mean: -0.12287356704473495, mean p set: 0.44744452834129333
loss_pred:0.016408704221248627, decouple_loss:0.00037582789082080126
The modified gen p mean: 0.4482376277446747, gen p mean: -0.12191624939441681, mean p set: 0.44881540536880493The modified gen p mean: 0.4479692876338959, gen p mean: -0.11914769560098648, mean p set: 0.44854697585105896
loss_pred:0.016733752563595772, decouple_loss:0.00041104422416538loss_pred:0.01660618744790554, decouple_loss:0.00039971451042219996
Iteration: 1652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460935890674591, gen p mean: -0.11911121010780334, mean p set: 0.4466691315174103
loss_pred:0.016815442591905594, decouple_loss:0.0003876376722473651
The modified gen p mean: 0.4471781551837921, gen p mean: -0.12167272716760635, mean p set: 0.4477544128894806The modified gen p mean: 0.44800060987472534, gen p mean: -0.1178693100810051, mean p set: 0.44857820868492126
loss_pred:0.0170111283659935, decouple_loss:0.0005952948122285306
loss_pred:0.016538910567760468, decouple_loss:0.0005683152703568339
Iteration: 1653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482886493206024, gen p mean: -0.10792966187000275, mean p set: 0.44886404275894165
loss_pred:0.016593001782894135, decouple_loss:0.00042386495624668896
The modified gen p mean: 0.4475686252117157, gen p mean: -0.11600650101900101, mean p set: 0.4481455683708191The modified gen p mean: 0.4469163715839386, gen p mean: -0.11882387846708298, mean p set: 0.4474906623363495
loss_pred:0.016493698582053185, decouple_loss:0.00047225572052411735
loss_pred:0.0155786769464612, decouple_loss:0.00043657905189320445
Iteration: 1654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676387310028076, gen p mean: -0.11861007660627365, mean p set: 0.4473411440849304
loss_pred:0.016220996156334877, decouple_loss:0.0004697150143329054
The modified gen p mean: 0.44809406995773315, gen p mean: -0.11416466534137726, mean p set: 0.44866740703582764
loss_pred:0.016314471140503883, decouple_loss:0.0003667465643957257
The modified gen p mean: 0.4473584294319153, gen p mean: -0.11619259417057037, mean p set: 0.4479345977306366
loss_pred:0.01675626076757908, decouple_loss:0.0003549192624632269
Iteration: 1655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734054803848267, gen p mean: -0.11728738993406296, mean p set: 0.44791483879089355
loss_pred:0.01696748100221157, decouple_loss:0.00037512011476792395
The modified gen p mean: 0.44698792695999146, gen p mean: -0.11863113939762115, mean p set: 0.4475629925727844
loss_pred:0.01660049334168434, decouple_loss:0.0003962807822972536
The modified gen p mean: 0.44642016291618347, gen p mean: -0.1166495829820633, mean p set: 0.4469953775405884
loss_pred:0.01710614189505577, decouple_loss:0.0003971538972109556
Iteration: 1656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708573818206787, gen p mean: -0.12016385048627853, mean p set: 0.4476608335971832
loss_pred:0.015633411705493927, decouple_loss:0.00035087185096926987
The modified gen p mean: 0.44696882367134094, gen p mean: -0.12271089106798172, mean p set: 0.4475422501564026
The modified gen p mean: 0.44554606080055237, gen p mean: -0.1200510784983635, mean p set: 0.44612136483192444
loss_pred:0.016592619940638542, decouple_loss:0.00042453737114556134
loss_pred:0.017305288463830948, decouple_loss:0.0005420353845693171
Iteration: 1657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771090149879456, gen p mean: -0.11705721169710159, mean p set: 0.4482869803905487
loss_pred:0.01644936203956604, decouple_loss:0.00037962180795148015
The modified gen p mean: 0.44644856452941895, gen p mean: -0.1274213343858719, mean p set: 0.447025865316391
The modified gen p mean: 0.44722115993499756, gen p mean: -0.123396135866642, mean p set: 0.44779476523399353
loss_pred:0.016146421432495117, decouple_loss:0.00037804184830747545
loss_pred:0.015432783402502537, decouple_loss:0.0003388489130884409
Iteration: 1658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470716118812561, gen p mean: -0.12738512456417084, mean p set: 0.44764822721481323
The modified gen p mean: 0.44661036133766174, gen p mean: -0.1267162412405014, mean p set: 0.4471881687641144
loss_pred:0.016499578952789307, decouple_loss:0.00041710969526320696
loss_pred:0.016654236242175102, decouple_loss:0.0003981479094363749
The modified gen p mean: 0.44703012704849243, gen p mean: -0.12916098535060883, mean p set: 0.44760507345199585
loss_pred:0.015595121309161186, decouple_loss:0.0003747106820810586
Iteration: 1659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44604164361953735, gen p mean: -0.12999224662780762, mean p set: 0.44661614298820496
loss_pred:0.017462408170104027, decouple_loss:0.00037063949275761843
The modified gen p mean: 0.44820013642311096, gen p mean: -0.12339820712804794, mean p set: 0.44877323508262634
loss_pred:0.01635890267789364, decouple_loss:0.0004164033744018525
The modified gen p mean: 0.44864022731781006, gen p mean: -0.13323011994361877, mean p set: 0.4492153227329254
loss_pred:0.016846420243382454, decouple_loss:0.0005454678321257234
Iteration: 1660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44547733664512634, gen p mean: -0.1330273300409317, mean p set: 0.4460543990135193
The modified gen p mean: 0.44738155603408813, gen p mean: -0.13326111435890198, mean p set: 0.4479564428329468
loss_pred:0.01683131977915764, decouple_loss:0.0005091197090223432
loss_pred:0.0166619922965765, decouple_loss:0.00035015810863114893
The modified gen p mean: 0.4469921588897705, gen p mean: -0.13501796126365662, mean p set: 0.44756677746772766
loss_pred:0.01667887158691883, decouple_loss:0.00044407235691323876
2023-05-02 09:30:17 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1407657265663147, mean p set: 0.4502691626548767
loss_pred:0.016971861943602562, decouple_loss:0.00044093281030654907
The modified gen p mean: 0.4495351314544678, gen p mean: -0.13411696255207062, mean p set: 0.4500633478164673
loss_pred:0.016159165650606155, decouple_loss:0.00045381809468381107
The modified gen p mean: 0.44982871413230896, gen p mean: -0.13314934074878693, mean p set: 0.45035696029663086
loss_pred:0.016488002613186836, decouple_loss:0.0003981181071139872
WV_1_PC_1_EH_0_PS_40, loss: 0.016561225056648254, avg_mse: 0.025862857699394226
current test mse: 0.025863
Iteration: 1661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822219014167786, gen p mean: -0.12906032800674438, mean p set: 0.448795348405838
loss_pred:0.015943743288517, decouple_loss:0.0004302674497012049
The modified gen p mean: 0.4473673105239868, gen p mean: -0.1354716569185257, mean p set: 0.4479401111602783The modified gen p mean: 0.44640371203422546, gen p mean: -0.1395443230867386, mean p set: 0.44697946310043335
loss_pred:0.016702601686120033, decouple_loss:0.00042480704723857343
loss_pred:0.0168275386095047, decouple_loss:0.00040802141302265227
Iteration: 1662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447347491979599, gen p mean: -0.13397783041000366, mean p set: 0.4479246735572815
loss_pred:0.016505775973200798, decouple_loss:0.0004293540841899812
The modified gen p mean: 0.446659117937088, gen p mean: -0.13716153800487518, mean p set: 0.4472349286079407The modified gen p mean: 0.4491969645023346, gen p mean: -0.1294415146112442, mean p set: 0.44977301359176636
loss_pred:0.016587499529123306, decouple_loss:0.00038907129783183336loss_pred:0.01627252995967865, decouple_loss:0.0005506968591362238
Iteration: 1663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465983808040619, gen p mean: -0.1361132711172104, mean p set: 0.44717782735824585
The modified gen p mean: 0.4487873613834381, gen p mean: -0.1292208731174469, mean p set: 0.4493623375892639
loss_pred:0.016138069331645966, decouple_loss:0.0003920135204680264
loss_pred:0.016296014189720154, decouple_loss:0.0003444383619353175
The modified gen p mean: 0.44745567440986633, gen p mean: -0.13188916444778442, mean p set: 0.4480341970920563
loss_pred:0.017280403524637222, decouple_loss:0.00045831373427063227
Iteration: 1664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698187708854675, gen p mean: -0.13531535863876343, mean p set: 0.4475582540035248
loss_pred:0.017307119444012642, decouple_loss:0.0003749032039195299
The modified gen p mean: 0.4476184546947479, gen p mean: -0.12960055470466614, mean p set: 0.44819167256355286
loss_pred:0.01638725958764553, decouple_loss:0.00031192018650472164
The modified gen p mean: 0.44749316573143005, gen p mean: -0.13451388478279114, mean p set: 0.4480704367160797
loss_pred:0.016364257782697678, decouple_loss:0.0005597943090833724
Iteration: 1665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711047410964966, gen p mean: -0.13097479939460754, mean p set: 0.4476872384548187
loss_pred:0.016652699559926987, decouple_loss:0.00045296826283447444
The modified gen p mean: 0.4460703432559967, gen p mean: -0.12924741208553314, mean p set: 0.4466463625431061
loss_pred:0.01719852350652218, decouple_loss:0.00039283576188609004
The modified gen p mean: 0.44658246636390686, gen p mean: -0.1313847005367279, mean p set: 0.4471576511859894
loss_pred:0.01640493795275688, decouple_loss:0.0004004550282843411
Iteration: 1666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713857769966125, gen p mean: -0.12811379134655, mean p set: 0.44771403074264526
loss_pred:0.016543986275792122, decouple_loss:0.0004926261026412249
The modified gen p mean: 0.44749385118484497, gen p mean: -0.12609609961509705, mean p set: 0.4480665326118469
loss_pred:0.01583683118224144, decouple_loss:0.00047296364209614694
The modified gen p mean: 0.448993444442749, gen p mean: -0.124214768409729, mean p set: 0.44956785440444946
loss_pred:0.016528701409697533, decouple_loss:0.0004099760262761265
Iteration: 1667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475069046020508, gen p mean: -0.12832902371883392, mean p set: 0.44808605313301086
loss_pred:0.016588903963565826, decouple_loss:0.0004369601374492049
The modified gen p mean: 0.44714319705963135, gen p mean: -0.13062748312950134, mean p set: 0.4477194845676422
loss_pred:0.01638164184987545, decouple_loss:0.0003453675308264792
The modified gen p mean: 0.44805651903152466, gen p mean: -0.12412212789058685, mean p set: 0.44863274693489075
loss_pred:0.016158482059836388, decouple_loss:0.0003839628188870847
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
NaN value num: 0
Iteration: 1668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450204461812973, gen p mean: -0.12041578441858292, mean p set: 0.4507834315299988
The modified gen p mean: 0.4521707594394684, gen p mean: -0.1185380294919014, mean p set: 0.45275044441223145
loss_pred:0.015203159302473068, decouple_loss:0.0005320917698554695
loss_pred:0.015662461519241333, decouple_loss:0.0005426605930551887
The modified gen p mean: 0.4493226408958435, gen p mean: -0.12556785345077515, mean p set: 0.4499017596244812
loss_pred:0.016824165359139442, decouple_loss:0.00043241423554718494
Iteration: 1669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497862756252289, gen p mean: -0.1187765821814537, mean p set: 0.45036324858665466
loss_pred:0.015288574621081352, decouple_loss:0.00048582081217318773
The modified gen p mean: 0.448787122964859, gen p mean: -0.12541338801383972, mean p set: 0.4493626356124878
The modified gen p mean: 0.4515920579433441, gen p mean: -0.1253298819065094, mean p set: 0.4521697759628296
loss_pred:0.015823569148778915, decouple_loss:0.0004570365999825299
loss_pred:0.015726368874311447, decouple_loss:0.0004720064462162554
Iteration: 1670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493551552295685, gen p mean: -0.1250801831483841, mean p set: 0.44993001222610474
loss_pred:0.015449617989361286, decouple_loss:0.00045731247519142926
The modified gen p mean: 0.4490143358707428, gen p mean: -0.12377821654081345, mean p set: 0.4495861530303955
The modified gen p mean: 0.45166823267936707, gen p mean: -0.1220550686120987, mean p set: 0.4522422254085541
loss_pred:0.016091790050268173, decouple_loss:0.00046660852967761457
loss_pred:0.015891436487436295, decouple_loss:0.00043653129250742495
2023-05-02 09:32:55 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13274499773979187, mean p set: 0.4502691626548767
loss_pred:0.01699654571712017, decouple_loss:0.0006460900185629725
The modified gen p mean: 0.44953230023384094, gen p mean: -0.12625710666179657, mean p set: 0.4500633478164673
loss_pred:0.016140375286340714, decouple_loss:0.0005105150630697608
The modified gen p mean: 0.4498281180858612, gen p mean: -0.12533684074878693, mean p set: 0.45035696029663086
loss_pred:0.016438039019703865, decouple_loss:0.0004939445643685758
WV_1_PC_1_EH_0_PS_40, loss: 0.016552496701478958, avg_mse: 0.025860575959086418
current test mse: 0.025861
Iteration: 1671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44981110095977783, gen p mean: -0.12164447456598282, mean p set: 0.4503864049911499
loss_pred:0.016771242022514343, decouple_loss:0.0005827040877193213
The modified gen p mean: 0.4519405961036682, gen p mean: -0.12346377968788147, mean p set: 0.452515572309494The modified gen p mean: 0.45018470287323, gen p mean: -0.12673449516296387, mean p set: 0.4507574439048767
loss_pred:0.01604890078306198, decouple_loss:0.00046632991870865226
loss_pred:0.016359640285372734, decouple_loss:0.0007229012553580105
Iteration: 1672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45188528299331665, gen p mean: -0.11710315942764282, mean p set: 0.4524637460708618
loss_pred:0.01622285693883896, decouple_loss:0.0004354954871814698
The modified gen p mean: 0.45224300026893616, gen p mean: -0.12116821110248566, mean p set: 0.45281848311424255The modified gen p mean: 0.4516007602214813, gen p mean: -0.11558847874403, mean p set: 0.45218008756637573
loss_pred:0.01594671793282032, decouple_loss:0.0006636499892920256loss_pred:0.016355976462364197, decouple_loss:0.0005653864936903119
Iteration: 1673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114025473594666, gen p mean: -0.11702017486095428, mean p set: 0.45171716809272766
loss_pred:0.016176307573914528, decouple_loss:0.0003661701048258692
The modified gen p mean: 0.45161858201026917, gen p mean: -0.12235034257173538, mean p set: 0.4521923363208771The modified gen p mean: 0.45016011595726013, gen p mean: -0.12300396710634232, mean p set: 0.450737327337265
loss_pred:0.015755431726574898, decouple_loss:0.0005437905783765018
loss_pred:0.015421400777995586, decouple_loss:0.00048757478361949325
Iteration: 1674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498392939567566, gen p mean: -0.12225469946861267, mean p set: 0.4504155218601227
loss_pred:0.01713954284787178, decouple_loss:0.0006216926849447191
The modified gen p mean: 0.45077231526374817, gen p mean: -0.12255897372961044, mean p set: 0.4513484537601471
loss_pred:0.015320876613259315, decouple_loss:0.0005250939866527915
The modified gen p mean: 0.45221030712127686, gen p mean: -0.12037721276283264, mean p set: 0.4527881443500519
loss_pred:0.015976225957274437, decouple_loss:0.000610742368735373
Iteration: 1675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523105323314667, gen p mean: -0.11990959942340851, mean p set: 0.45288676023483276
loss_pred:0.016052229329943657, decouple_loss:0.0004366327484603971
The modified gen p mean: 0.45161426067352295, gen p mean: -0.12179841101169586, mean p set: 0.45219019055366516
loss_pred:0.01558701228350401, decouple_loss:0.0004527386336121708
The modified gen p mean: 0.4501686990261078, gen p mean: -0.12252005934715271, mean p set: 0.45074281096458435
loss_pred:0.01576773077249527, decouple_loss:0.0003364759322721511
Iteration: 1676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451825350522995, gen p mean: -0.11342806369066238, mean p set: 0.4524017870426178
loss_pred:0.015481959097087383, decouple_loss:0.0005418115761131048
The modified gen p mean: 0.44991958141326904, gen p mean: -0.11815622448921204, mean p set: 0.4504959285259247
The modified gen p mean: 0.4492383301258087, gen p mean: -0.12003611028194427, mean p set: 0.4498138427734375
loss_pred:0.015846101567149162, decouple_loss:0.0003183967201039195
loss_pred:0.015514347702264786, decouple_loss:0.00043197133345529437
Iteration: 1677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45201489329338074, gen p mean: -0.12396179884672165, mean p set: 0.4525927007198334
loss_pred:0.015015778131783009, decouple_loss:0.0005584993050433695
The modified gen p mean: 0.44967371225357056, gen p mean: -0.12300542742013931, mean p set: 0.4502466022968292
The modified gen p mean: 0.44937723875045776, gen p mean: -0.12486369162797928, mean p set: 0.449949711561203
loss_pred:0.016033688560128212, decouple_loss:0.0004361770988907665
loss_pred:0.015149502083659172, decouple_loss:0.00044863185030408204
Iteration: 1678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012226700782776, gen p mean: -0.12185700237751007, mean p set: 0.4506973326206207
loss_pred:0.01597384549677372, decouple_loss:0.00040754253859631717
The modified gen p mean: 0.4513080418109894, gen p mean: -0.12000640481710434, mean p set: 0.45188307762145996
The modified gen p mean: 0.4527808427810669, gen p mean: -0.11935435235500336, mean p set: 0.45335903763771057
loss_pred:0.015924951061606407, decouple_loss:0.0004170574829913676
loss_pred:0.015361488796770573, decouple_loss:0.0004608231829479337
Iteration: 1679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487156271934509, gen p mean: -0.12608684599399567, mean p set: 0.44929152727127075
loss_pred:0.015954915434122086, decouple_loss:0.00038806666270829737
The modified gen p mean: 0.4518550634384155, gen p mean: -0.12145433574914932, mean p set: 0.4524324834346771
The modified gen p mean: 0.45133358240127563, gen p mean: -0.11957390606403351, mean p set: 0.45191019773483276
loss_pred:0.015453530475497246, decouple_loss:0.0004513922904152423
loss_pred:0.015745259821414948, decouple_loss:0.0004253576626069844
Iteration: 1680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44914230704307556, gen p mean: -0.11882707476615906, mean p set: 0.4497171640396118
loss_pred:0.015120415017008781, decouple_loss:0.0005523500149138272
The modified gen p mean: 0.4521979093551636, gen p mean: -0.11540819704532623, mean p set: 0.4527750313282013
loss_pred:0.01539633423089981, decouple_loss:0.00045232774573378265
The modified gen p mean: 0.4493955075740814, gen p mean: -0.122836634516716, mean p set: 0.44997072219848633
loss_pred:0.015567605383694172, decouple_loss:0.000580867228563875
2023-05-02 09:35:00 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12547893822193146, mean p set: 0.4502691626548767
loss_pred:0.016988875344395638, decouple_loss:0.0004631106276065111
The modified gen p mean: 0.44953370094299316, gen p mean: -0.11835185438394547, mean p set: 0.4500633478164673
loss_pred:0.01620357111096382, decouple_loss:0.00045390287414193153
The modified gen p mean: 0.44982871413230896, gen p mean: -0.11758856475353241, mean p set: 0.45035696029663086
loss_pred:0.01647217944264412, decouple_loss:0.0004325041372794658
WV_1_PC_1_EH_0_PS_40, loss: 0.01657736673951149, avg_mse: 0.025905851274728775
current test mse: 0.025906
Iteration: 1681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45132529735565186, gen p mean: -0.11664282530546188, mean p set: 0.4519013464450836
loss_pred:0.015575253404676914, decouple_loss:0.00038503159885294735
The modified gen p mean: 0.4486537277698517, gen p mean: -0.11997664719820023, mean p set: 0.4492310881614685The modified gen p mean: 0.44889581203460693, gen p mean: -0.12215820699930191, mean p set: 0.4494739770889282
loss_pred:0.01612904481589794, decouple_loss:0.00044385896762833loss_pred:0.01634255237877369, decouple_loss:0.0004141816170886159
Iteration: 1682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963768124580383, gen p mean: -0.11461550742387772, mean p set: 0.45021387934684753
loss_pred:0.015558523125946522, decouple_loss:0.0004394293646328151
The modified gen p mean: 0.4503391981124878, gen p mean: -0.11210040748119354, mean p set: 0.4509148597717285The modified gen p mean: 0.44987955689430237, gen p mean: -0.11551986634731293, mean p set: 0.4504547715187073
loss_pred:0.014821231365203857, decouple_loss:0.0005712407873943448
loss_pred:0.017027081921696663, decouple_loss:0.0003597210452426225
Iteration: 1683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44974571466445923, gen p mean: -0.11216127127408981, mean p set: 0.4503213167190552
loss_pred:0.015167701058089733, decouple_loss:0.00043350306805223227
The modified gen p mean: 0.451949805021286, gen p mean: -0.11259908229112625, mean p set: 0.4525245130062103
loss_pred:0.014909842982888222, decouple_loss:0.0004987352876923978
The modified gen p mean: 0.44931504130363464, gen p mean: -0.11031362414360046, mean p set: 0.44989094138145447
loss_pred:0.015482797287404537, decouple_loss:0.00037553292349912226
Iteration: 1684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45138421654701233, gen p mean: -0.10968658328056335, mean p set: 0.45195919275283813
loss_pred:0.015548985451459885, decouple_loss:0.0005699925823137164
The modified gen p mean: 0.44976332783699036, gen p mean: -0.11302786320447922, mean p set: 0.45034095644950867
loss_pred:0.01586294360458851, decouple_loss:0.00047393268323503435
The modified gen p mean: 0.4519348442554474, gen p mean: -0.10777964442968369, mean p set: 0.4525114893913269
loss_pred:0.01612982340157032, decouple_loss:0.0004810785176232457
Iteration: 1685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44857388734817505, gen p mean: -0.1163410171866417, mean p set: 0.44915124773979187
loss_pred:0.015784800052642822, decouple_loss:0.0004605971626006067
The modified gen p mean: 0.45154789090156555, gen p mean: -0.11255472898483276, mean p set: 0.4521242678165436
loss_pred:0.016072694212198257, decouple_loss:0.0004393253766465932
The modified gen p mean: 0.4521673321723938, gen p mean: -0.11132634431123734, mean p set: 0.452744722366333
loss_pred:0.015144707635045052, decouple_loss:0.0005291566485539079
Iteration: 1686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521692097187042, gen p mean: -0.10990673303604126, mean p set: 0.45274588465690613
loss_pred:0.015148348174989223, decouple_loss:0.0004871527198702097
The modified gen p mean: 0.4517730176448822, gen p mean: -0.11391491442918777, mean p set: 0.4523504674434662
loss_pred:0.01623285748064518, decouple_loss:0.0005141030414961278
The modified gen p mean: 0.4488983452320099, gen p mean: -0.11527541279792786, mean p set: 0.4494730830192566
loss_pred:0.016086136922240257, decouple_loss:0.000495320709887892
Iteration: 1687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45003679394721985, gen p mean: -0.11791794747114182, mean p set: 0.4506123960018158
loss_pred:0.015522513538599014, decouple_loss:0.0006107979570515454
The modified gen p mean: 0.4521234929561615, gen p mean: -0.11353981494903564, mean p set: 0.45270055532455444
loss_pred:0.015647433698177338, decouple_loss:0.0005509513430297375
The modified gen p mean: 0.4497465193271637, gen p mean: -0.11843422055244446, mean p set: 0.4503243863582611
loss_pred:0.015245870687067509, decouple_loss:0.0004740136209875345
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
NaN value num: 0
Iteration: 1688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44911742210388184, gen p mean: -0.12736302614212036, mean p set: 0.44969442486763
The modified gen p mean: 0.4485718905925751, gen p mean: -0.12731793522834778, mean p set: 0.4491483271121979
loss_pred:0.017216665670275688, decouple_loss:0.00034244643757119775
loss_pred:0.016549158841371536, decouple_loss:0.00041083336691372097
The modified gen p mean: 0.449654221534729, gen p mean: -0.1218767762184143, mean p set: 0.4502294957637787
loss_pred:0.01723228394985199, decouple_loss:0.0004368566151242703
Iteration: 1689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449362576007843, gen p mean: -0.11893540620803833, mean p set: 0.4499370753765106
loss_pred:0.016633346676826477, decouple_loss:0.00041182624408975244
The modified gen p mean: 0.4502827227115631, gen p mean: -0.1234169453382492, mean p set: 0.45085832476615906
The modified gen p mean: 0.45003601908683777, gen p mean: -0.12034033238887787, mean p set: 0.45061272382736206
loss_pred:0.015940392389893532, decouple_loss:0.00038548914017155766
loss_pred:0.01698363572359085, decouple_loss:0.00047722828458063304
Iteration: 1690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486786127090454, gen p mean: -0.12328678369522095, mean p set: 0.44925686717033386
loss_pred:0.016433896496891975, decouple_loss:0.00037689879536628723
The modified gen p mean: 0.4492630362510681, gen p mean: -0.12602558732032776, mean p set: 0.44983765482902527
loss_pred:0.015634864568710327, decouple_loss:0.000428947270847857
The modified gen p mean: 0.44863054156303406, gen p mean: -0.12492363899946213, mean p set: 0.44920605421066284
loss_pred:0.0169687420129776, decouple_loss:0.0006327631417661905
2023-05-02 09:37:48 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1297396719455719, mean p set: 0.4502691626548767
loss_pred:0.01690482348203659, decouple_loss:0.0005247013177722692
The modified gen p mean: 0.4495367705821991, gen p mean: -0.12302730232477188, mean p set: 0.4500633478164673
loss_pred:0.016259895637631416, decouple_loss:0.0005049524479545653
The modified gen p mean: 0.4498269259929657, gen p mean: -0.12180327624082565, mean p set: 0.45035696029663086
loss_pred:0.016490818932652473, decouple_loss:0.00046491273678839207
WV_1_PC_1_EH_0_PS_40, loss: 0.016576755791902542, avg_mse: 0.025911327451467514
current test mse: 0.025911
Iteration: 1691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494743049144745, gen p mean: -0.12204030156135559, mean p set: 0.4500521421432495
loss_pred:0.01590263471007347, decouple_loss:0.00038579810643568635
The modified gen p mean: 0.449809730052948, gen p mean: -0.11967555433511734, mean p set: 0.450385719537735The modified gen p mean: 0.4488447308540344, gen p mean: -0.12065683305263519, mean p set: 0.4494204819202423
loss_pred:0.01612841710448265, decouple_loss:0.00040911920950748026
loss_pred:0.017264094203710556, decouple_loss:0.000457390007795766
Iteration: 1692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486806392669678, gen p mean: -0.1238599568605423, mean p set: 0.44925400614738464
loss_pred:0.016328400000929832, decouple_loss:0.00042992361704818904
The modified gen p mean: 0.4491000771522522, gen p mean: -0.11733148992061615, mean p set: 0.44967401027679443The modified gen p mean: 0.4489516019821167, gen p mean: -0.12301409989595413, mean p set: 0.4495299160480499
loss_pred:0.015969082713127136, decouple_loss:0.0004529165744315833
loss_pred:0.016813168302178383, decouple_loss:0.0003453061799518764
Iteration: 1693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860029220581055, gen p mean: -0.11631938070058823, mean p set: 0.449175626039505
loss_pred:0.016068940982222557, decouple_loss:0.0005266545922495425
The modified gen p mean: 0.4496326446533203, gen p mean: -0.12508277595043182, mean p set: 0.45020923018455505The modified gen p mean: 0.44952383637428284, gen p mean: -0.11861228197813034, mean p set: 0.45009905099868774
loss_pred:0.016272375360131264, decouple_loss:0.0005025908467359841
loss_pred:0.016121413558721542, decouple_loss:0.00048307201359421015
Iteration: 1694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804808497428894, gen p mean: -0.12103072553873062, mean p set: 0.4486234188079834
loss_pred:0.016521312296390533, decouple_loss:0.00037160475039854646
The modified gen p mean: 0.4495560824871063, gen p mean: -0.11985144019126892, mean p set: 0.4501313269138336
loss_pred:0.015782061964273453, decouple_loss:0.0002933788055088371
The modified gen p mean: 0.4496232271194458, gen p mean: -0.11793389171361923, mean p set: 0.45019885897636414
loss_pred:0.016549523919820786, decouple_loss:0.00045017374213784933
Iteration: 1695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495666027069092, gen p mean: -0.12615638971328735, mean p set: 0.4501429796218872
loss_pred:0.016089459881186485, decouple_loss:0.0004519136855378747
The modified gen p mean: 0.44964465498924255, gen p mean: -0.1298702210187912, mean p set: 0.4502195417881012
loss_pred:0.016358831897377968, decouple_loss:0.0003168707771692425
The modified gen p mean: 0.4480724036693573, gen p mean: -0.1278543770313263, mean p set: 0.44864723086357117
loss_pred:0.016851184889674187, decouple_loss:0.0004185001307632774
Iteration: 1696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44912973046302795, gen p mean: -0.126810684800148, mean p set: 0.4497062563896179
loss_pred:0.016311170533299446, decouple_loss:0.0003832033253274858
The modified gen p mean: 0.44871652126312256, gen p mean: -0.1272956132888794, mean p set: 0.44929149746894836
The modified gen p mean: 0.45018428564071655, gen p mean: -0.1265622228384018, mean p set: 0.4507625102996826
loss_pred:0.017011484131217003, decouple_loss:0.0003754441859200597
loss_pred:0.016726985573768616, decouple_loss:0.0003519980818964541
Iteration: 1697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817689061164856, gen p mean: -0.1241605281829834, mean p set: 0.44875091314315796
loss_pred:0.01600414700806141, decouple_loss:0.0003633396700024605
The modified gen p mean: 0.4497572183609009, gen p mean: -0.12182337790727615, mean p set: 0.45033130049705505
The modified gen p mean: 0.4489022493362427, gen p mean: -0.12513692677021027, mean p set: 0.4494764804840088
loss_pred:0.016277402639389038, decouple_loss:0.0003853964153677225
loss_pred:0.01665441505610943, decouple_loss:0.0005089558544568717
Iteration: 1698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44949662685394287, gen p mean: -0.1265307068824768, mean p set: 0.4500735104084015
loss_pred:0.01633661426603794, decouple_loss:0.0003795633092522621
The modified gen p mean: 0.449200838804245, gen p mean: -0.12197703868150711, mean p set: 0.4497784972190857
loss_pred:0.01773335039615631, decouple_loss:0.00036601736792363226
The modified gen p mean: 0.4490829408168793, gen p mean: -0.12591654062271118, mean p set: 0.44966015219688416
loss_pred:0.016318032518029213, decouple_loss:0.0003894770925398916
Iteration: 1699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44843217730522156, gen p mean: -0.11930738389492035, mean p set: 0.4490078091621399
loss_pred:0.01683180034160614, decouple_loss:0.00043367623584344983
The modified gen p mean: 0.44938430190086365, gen p mean: -0.12304766476154327, mean p set: 0.4499610364437103
The modified gen p mean: 0.44986599683761597, gen p mean: -0.12120505422353745, mean p set: 0.45043838024139404
loss_pred:0.01685146987438202, decouple_loss:0.00035585544537752867
loss_pred:0.015677373856306076, decouple_loss:0.00040616950718685985
Iteration: 1700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781455397605896, gen p mean: -0.12476865202188492, mean p set: 0.4483890235424042
loss_pred:0.016561437398195267, decouple_loss:0.0004182266420684755
The modified gen p mean: 0.4481040835380554, gen p mean: -0.12237294018268585, mean p set: 0.44867777824401855
loss_pred:0.01656801626086235, decouple_loss:0.00037562052602879703
The modified gen p mean: 0.44845089316368103, gen p mean: -0.12254973500967026, mean p set: 0.44902318716049194
loss_pred:0.016247862949967384, decouple_loss:0.00031853621476329863
2023-05-02 09:39:53 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13526800274848938, mean p set: 0.4502691626548767
loss_pred:0.016930876299738884, decouple_loss:0.00045228522503748536
The modified gen p mean: 0.44953453540802, gen p mean: -0.12893669307231903, mean p set: 0.4500633478164673
loss_pred:0.01624392904341221, decouple_loss:0.0005107289762236178
The modified gen p mean: 0.44983071088790894, gen p mean: -0.12777064740657806, mean p set: 0.45035696029663086
loss_pred:0.016395121812820435, decouple_loss:0.0004542507231235504
WV_1_PC_1_EH_0_PS_40, loss: 0.016546931117773056, avg_mse: 0.02575523778796196
current test mse: 0.025755
At step 1700, Best test: 0.025755
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 1701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815871119499207, gen p mean: -0.126108780503273, mean p set: 0.4487350583076477
loss_pred:0.016032112762331963, decouple_loss:0.0004918586346320808
The modified gen p mean: 0.4493694007396698, gen p mean: -0.12965770065784454, mean p set: 0.4499465525150299
loss_pred:0.015696018934249878, decouple_loss:0.00040137124597094953
The modified gen p mean: 0.44884514808654785, gen p mean: -0.13217535614967346, mean p set: 0.4494244158267975
loss_pred:0.015567893162369728, decouple_loss:0.0003573960857465863
Iteration: 1702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860702753067017, gen p mean: -0.12959738075733185, mean p set: 0.4491855800151825
loss_pred:0.016320422291755676, decouple_loss:0.0004257911932654679
The modified gen p mean: 0.44854676723480225, gen p mean: -0.1314040571451187, mean p set: 0.4491247832775116The modified gen p mean: 0.4491110146045685, gen p mean: -0.13405267894268036, mean p set: 0.4496876895427704
loss_pred:0.016717782244086266, decouple_loss:0.0003684103430714458
loss_pred:0.016443496569991112, decouple_loss:0.0003883377939928323
Iteration: 1703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497814178466797, gen p mean: -0.13616369664669037, mean p set: 0.45035961270332336
loss_pred:0.016554664820432663, decouple_loss:0.0003586402744986117
The modified gen p mean: 0.44960206747055054, gen p mean: -0.12994562089443207, mean p set: 0.45017439126968384
loss_pred:0.01707933284342289, decouple_loss:0.00041421601781621575
The modified gen p mean: 0.44867661595344543, gen p mean: -0.12613904476165771, mean p set: 0.44925227761268616
loss_pred:0.01608685962855816, decouple_loss:0.0003303944831714034
Iteration: 1704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839274883270264, gen p mean: -0.1294851303100586, mean p set: 0.44897153973579407
loss_pred:0.016476936638355255, decouple_loss:0.00035128340823575854
The modified gen p mean: 0.44938358664512634, gen p mean: -0.12594404816627502, mean p set: 0.44995957612991333
loss_pred:0.016004901379346848, decouple_loss:0.00039340698276646435
The modified gen p mean: 0.4500782787799835, gen p mean: -0.12749594449996948, mean p set: 0.4506526291370392
loss_pred:0.0166231207549572, decouple_loss:0.0004156268551014364
Iteration: 1705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488610029220581, gen p mean: -0.12327009439468384, mean p set: 0.44943687319755554
loss_pred:0.016491724178195, decouple_loss:0.0004639773687813431
The modified gen p mean: 0.4497973322868347, gen p mean: -0.12378884851932526, mean p set: 0.4503738284111023
loss_pred:0.015659945085644722, decouple_loss:0.0004383284249342978
The modified gen p mean: 0.44960352778434753, gen p mean: -0.1269107162952423, mean p set: 0.4501812756061554
loss_pred:0.016688132658600807, decouple_loss:0.0003866359475068748
Iteration: 1706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962278008461, gen p mean: -0.12198291718959808, mean p set: 0.4501986801624298
loss_pred:0.01593952253460884, decouple_loss:0.00036136709968559444
The modified gen p mean: 0.448355108499527, gen p mean: -0.12279953807592392, mean p set: 0.4489312171936035
loss_pred:0.016530880704522133, decouple_loss:0.00037939829053357244
The modified gen p mean: 0.44878309965133667, gen p mean: -0.12665347754955292, mean p set: 0.4493584930896759
loss_pred:0.017033005133271217, decouple_loss:0.00043368784827180207
Iteration: 1707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44897231459617615, gen p mean: -0.1263262778520584, mean p set: 0.4495510160923004
loss_pred:0.01721350848674774, decouple_loss:0.00036116482806392014
The modified gen p mean: 0.4495373070240021, gen p mean: -0.1232311949133873, mean p set: 0.450113981962204
The modified gen p mean: 0.44989511370658875, gen p mean: -0.11541391909122467, mean p set: 0.4504740536212921
loss_pred:0.016802296042442322, decouple_loss:0.000469523569336161
loss_pred:0.015600399114191532, decouple_loss:0.0005372230079956353
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 1708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775229692459106, gen p mean: -0.12465783208608627, mean p set: 0.4483300447463989
loss_pred:0.01569671556353569, decouple_loss:0.0004902305081486702
The modified gen p mean: 0.44642284512519836, gen p mean: -0.12116716057062149, mean p set: 0.4469989240169525
The modified gen p mean: 0.44736194610595703, gen p mean: -0.1207188069820404, mean p set: 0.4479365348815918
loss_pred:0.015465364791452885, decouple_loss:0.000505574163980782
loss_pred:0.016112374141812325, decouple_loss:0.0004563595284707844
Iteration: 1709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464087188243866, gen p mean: -0.12260659784078598, mean p set: 0.4469858705997467
loss_pred:0.015813356265425682, decouple_loss:0.00047801551409065723
The modified gen p mean: 0.4468788206577301, gen p mean: -0.11913952231407166, mean p set: 0.44745591282844543
loss_pred:0.015464261174201965, decouple_loss:0.00036693632137030363
The modified gen p mean: 0.44764021039009094, gen p mean: -0.11644895374774933, mean p set: 0.44821488857269287
loss_pred:0.0155592430382967, decouple_loss:0.0003940151946153492
Iteration: 1710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465737044811249, gen p mean: -0.12541180849075317, mean p set: 0.44714680314064026
loss_pred:0.015465197153389454, decouple_loss:0.00047681661089882255
The modified gen p mean: 0.4469476640224457, gen p mean: -0.1218390241265297, mean p set: 0.44752398133277893
loss_pred:0.015126998536288738, decouple_loss:0.0005224898341111839
The modified gen p mean: 0.4471626281738281, gen p mean: -0.12130539864301682, mean p set: 0.44773682951927185
loss_pred:0.014991319738328457, decouple_loss:0.00043063436169177294
2023-05-02 09:42:38 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12598976492881775, mean p set: 0.4502691626548767
loss_pred:0.01692560873925686, decouple_loss:0.0005737749161198735
The modified gen p mean: 0.44953325390815735, gen p mean: -0.11939755827188492, mean p set: 0.4500633478164673
loss_pred:0.01610136590898037, decouple_loss:0.0005459350650198758
The modified gen p mean: 0.44983071088790894, gen p mean: -0.11802038550376892, mean p set: 0.45035696029663086
loss_pred:0.016306724399328232, decouple_loss:0.000591890886425972
WV_1_PC_1_EH_0_PS_40, loss: 0.01647309400141239, avg_mse: 0.0256333127617836
current test mse: 0.025633
At step 1710, Best test: 0.025633
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 1711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474753737449646, gen p mean: -0.12629060447216034, mean p set: 0.4480500817298889
loss_pred:0.014748940244317055, decouple_loss:0.0004951439914293587
The modified gen p mean: 0.44741490483283997, gen p mean: -0.11861022561788559, mean p set: 0.4479900598526001
loss_pred:0.01591464690864086, decouple_loss:0.0005543418228626251
The modified gen p mean: 0.4456486403942108, gen p mean: -0.12244657427072525, mean p set: 0.44622352719306946
loss_pred:0.01573891006410122, decouple_loss:0.0007898190524429083
Iteration: 1712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44628867506980896, gen p mean: -0.11609480530023575, mean p set: 0.4468649923801422
loss_pred:0.015435491688549519, decouple_loss:0.00043209458817727864
The modified gen p mean: 0.4471525549888611, gen p mean: -0.11725727468729019, mean p set: 0.44772863388061523The modified gen p mean: 0.4474952816963196, gen p mean: -0.12096372246742249, mean p set: 0.4480704963207245
loss_pred:0.01532809343189001, decouple_loss:0.0006236615008674562loss_pred:0.015681838616728783, decouple_loss:0.0005592013476416469
Iteration: 1713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44639021158218384, gen p mean: -0.11519394814968109, mean p set: 0.44696730375289917
The modified gen p mean: 0.446443110704422, gen p mean: -0.11462777107954025, mean p set: 0.4470199644565582
The modified gen p mean: 0.4476207196712494, gen p mean: -0.11418512463569641, mean p set: 0.44819650053977966loss_pred:0.015125703997910023, decouple_loss:0.0004755184636451304
loss_pred:0.015226587653160095, decouple_loss:0.0006072589312680066
loss_pred:0.015018733218312263, decouple_loss:0.0004024094087071717
Iteration: 1714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461708962917328, gen p mean: -0.1164935976266861, mean p set: 0.44674646854400635
loss_pred:0.014881123788654804, decouple_loss:0.0005925425793975592
The modified gen p mean: 0.4461323916912079, gen p mean: -0.11313355714082718, mean p set: 0.446708619594574
loss_pred:0.015483484603464603, decouple_loss:0.0006623938679695129
The modified gen p mean: 0.4475204646587372, gen p mean: -0.11066347360610962, mean p set: 0.4480966627597809
loss_pred:0.015478231012821198, decouple_loss:0.0005319142364896834
Iteration: 1715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44659239053726196, gen p mean: -0.11768146604299545, mean p set: 0.44716861844062805
loss_pred:0.015261676162481308, decouple_loss:0.00044859974877908826
The modified gen p mean: 0.44649335741996765, gen p mean: -0.12049844861030579, mean p set: 0.44706523418426514
loss_pred:0.01537706796079874, decouple_loss:0.0005119707202538848
The modified gen p mean: 0.44621357321739197, gen p mean: -0.11850988864898682, mean p set: 0.44678789377212524
loss_pred:0.014807832427322865, decouple_loss:0.0003465560148470104
Iteration: 1716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44689759612083435, gen p mean: -0.12627705931663513, mean p set: 0.4474724233150482
The modified gen p mean: 0.4462515711784363, gen p mean: -0.12196791172027588, mean p set: 0.4468272626399994
loss_pred:0.015520354732871056, decouple_loss:0.00047393544809892774
loss_pred:0.015878334641456604, decouple_loss:0.000456616427982226
The modified gen p mean: 0.4454934597015381, gen p mean: -0.1185881495475769, mean p set: 0.4460710883140564
loss_pred:0.01506793312728405, decouple_loss:0.00044889398850500584
Iteration: 1717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464525282382965, gen p mean: -0.12068746238946915, mean p set: 0.44702792167663574
loss_pred:0.015211757272481918, decouple_loss:0.0007033442961983383
The modified gen p mean: 0.44667768478393555, gen p mean: -0.12840652465820312, mean p set: 0.44725584983825684
loss_pred:0.015081956051290035, decouple_loss:0.0005733341095037758
The modified gen p mean: 0.4468750059604645, gen p mean: -0.11997497826814651, mean p set: 0.44745174050331116
loss_pred:0.015422208234667778, decouple_loss:0.0006466507911682129
Iteration: 1718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468610882759094, gen p mean: -0.13024748861789703, mean p set: 0.44743674993515015
loss_pred:0.0151693569496274, decouple_loss:0.0004966080305166543
The modified gen p mean: 0.44640883803367615, gen p mean: -0.12385667115449905, mean p set: 0.44698208570480347
loss_pred:0.016253311187028885, decouple_loss:0.0004796913417521864
The modified gen p mean: 0.44714727997779846, gen p mean: -0.13142983615398407, mean p set: 0.4477214217185974
loss_pred:0.015151859261095524, decouple_loss:0.00046740795369260013
Iteration: 1719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701293110847473, gen p mean: -0.12301115691661835, mean p set: 0.4475901126861572
The modified gen p mean: 0.44687706232070923, gen p mean: -0.12865756452083588, mean p set: 0.44745466113090515
loss_pred:0.015466999262571335, decouple_loss:0.0005229009548202157
loss_pred:0.014976325444877148, decouple_loss:0.00043138774344697595
The modified gen p mean: 0.4473063051700592, gen p mean: -0.12407396733760834, mean p set: 0.447883665561676
loss_pred:0.016125736758112907, decouple_loss:0.00034958607284352183
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44662711024284363, gen p mean: -0.11574606597423553, mean p set: 0.4472024440765381
loss_pred:0.01552592683583498, decouple_loss:0.00046087632654234767
The modified gen p mean: 0.4469626545906067, gen p mean: -0.12032297253608704, mean p set: 0.4475388824939728
loss_pred:0.014072369784116745, decouple_loss:0.0004065773682668805
The modified gen p mean: 0.4458909034729004, gen p mean: -0.1211286187171936, mean p set: 0.4464685022830963
loss_pred:0.015944385901093483, decouple_loss:0.0005012429901398718
2023-05-02 09:44:50 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12239609658718109, mean p set: 0.4502691626548767
loss_pred:0.016933709383010864, decouple_loss:0.0005145191680639982
The modified gen p mean: 0.4495350122451782, gen p mean: -0.11625102907419205, mean p set: 0.4500633478164673
loss_pred:0.01606632024049759, decouple_loss:0.0004572085163090378
The modified gen p mean: 0.44982945919036865, gen p mean: -0.11473690718412399, mean p set: 0.45035696029663086
loss_pred:0.016409317031502724, decouple_loss:0.00037424545735120773
WV_1_PC_1_EH_0_PS_40, loss: 0.016492215916514397, avg_mse: 0.02570779249072075
current test mse: 0.025708
Iteration: 1721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44556787610054016, gen p mean: -0.11885717511177063, mean p set: 0.4461430609226227
loss_pred:0.016075097024440765, decouple_loss:0.0005177882849238813
The modified gen p mean: 0.44571956992149353, gen p mean: -0.11768292635679245, mean p set: 0.4462953209877014
loss_pred:0.01470822561532259, decouple_loss:0.0005067738238722086
The modified gen p mean: 0.44664931297302246, gen p mean: -0.12473846971988678, mean p set: 0.44722431898117065
loss_pred:0.015109335072338581, decouple_loss:0.00043382495641708374
Iteration: 1722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44598275423049927, gen p mean: -0.1159951463341713, mean p set: 0.4465586841106415
loss_pred:0.015637444332242012, decouple_loss:0.00039079340058378875
The modified gen p mean: 0.44650906324386597, gen p mean: -0.11462952196598053, mean p set: 0.4470832645893097
The modified gen p mean: 0.44712555408477783, gen p mean: -0.11976324021816254, mean p set: 0.4476989209651947
loss_pred:0.015245075337588787, decouple_loss:0.00046062859473749995
loss_pred:0.015611911192536354, decouple_loss:0.00041642689029686153
Iteration: 1723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460238218307495, gen p mean: -0.11837472766637802, mean p set: 0.44659891724586487
loss_pred:0.015427148900926113, decouple_loss:0.0005705046933144331
The modified gen p mean: 0.446433424949646, gen p mean: -0.12046533823013306, mean p set: 0.44700896739959717The modified gen p mean: 0.44691896438598633, gen p mean: -0.12089171260595322, mean p set: 0.44749605655670166
loss_pred:0.015069913119077682, decouple_loss:0.00034482707269489765
loss_pred:0.01564316637814045, decouple_loss:0.0005488234455697238
Iteration: 1724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743484258651733, gen p mean: -0.12469309568405151, mean p set: 0.4480128884315491
loss_pred:0.016219068318605423, decouple_loss:0.00044708597124554217
The modified gen p mean: 0.4473753273487091, gen p mean: -0.1252320557832718, mean p set: 0.4479503035545349
loss_pred:0.014361179433763027, decouple_loss:0.00044183811405673623
The modified gen p mean: 0.44616153836250305, gen p mean: -0.1242922693490982, mean p set: 0.4467359483242035
loss_pred:0.015428954735398293, decouple_loss:0.00042719230987131596
Iteration: 1725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44581225514411926, gen p mean: -0.1262044459581375, mean p set: 0.44638508558273315
loss_pred:0.015070214867591858, decouple_loss:0.0005466634756885469
The modified gen p mean: 0.44668877124786377, gen p mean: -0.12885944545269012, mean p set: 0.44726207852363586
loss_pred:0.015196817927062511, decouple_loss:0.0005886576836928725
The modified gen p mean: 0.44698870182037354, gen p mean: -0.12964224815368652, mean p set: 0.44756782054901123
loss_pred:0.014799610711634159, decouple_loss:0.0005363775999285281
Iteration: 1726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447855681180954, gen p mean: -0.12807899713516235, mean p set: 0.4484312832355499
loss_pred:0.015280566178262234, decouple_loss:0.0004528560093604028
The modified gen p mean: 0.4465217888355255, gen p mean: -0.12833468616008759, mean p set: 0.44709739089012146
loss_pred:0.015831803902983665, decouple_loss:0.0004875212616752833
The modified gen p mean: 0.44655144214630127, gen p mean: -0.13168741762638092, mean p set: 0.4471304714679718
loss_pred:0.015559950843453407, decouple_loss:0.0004134776536375284
Iteration: 1727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475109279155731, gen p mean: -0.1294436752796173, mean p set: 0.4480864405632019
loss_pred:0.015105189755558968, decouple_loss:0.0004216203815303743
The modified gen p mean: 0.44614967703819275, gen p mean: -0.13051608204841614, mean p set: 0.44672611355781555
loss_pred:0.015826189890503883, decouple_loss:0.00035546495928429067
The modified gen p mean: 0.4472690224647522, gen p mean: -0.13373728096485138, mean p set: 0.4478432536125183
loss_pred:0.01541204284876585, decouple_loss:0.00036953904782421887
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 1728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784870743751526, gen p mean: -0.1246572807431221, mean p set: 0.44842392206192017
loss_pred:0.014993440359830856, decouple_loss:0.00041605570004321635
The modified gen p mean: 0.44921186566352844, gen p mean: -0.12154493480920792, mean p set: 0.4497894048690796
The modified gen p mean: 0.4485277235507965, gen p mean: -0.12554048001766205, mean p set: 0.44910159707069397
loss_pred:0.0149238845333457, decouple_loss:0.0005013888003304601
loss_pred:0.015178762376308441, decouple_loss:0.00044833970605395734
Iteration: 1729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44843053817749023, gen p mean: -0.12768760323524475, mean p set: 0.4490082263946533
loss_pred:0.014926542527973652, decouple_loss:0.0004760843876283616
The modified gen p mean: 0.44824913144111633, gen p mean: -0.11875756084918976, mean p set: 0.4488248825073242
loss_pred:0.015238849446177483, decouple_loss:0.0006499396404251456
The modified gen p mean: 0.4477510452270508, gen p mean: -0.13002482056617737, mean p set: 0.44832560420036316
loss_pred:0.015057622455060482, decouple_loss:0.0005174531252123415
Iteration: 1730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771525263786316, gen p mean: -0.12465241551399231, mean p set: 0.44829061627388
loss_pred:0.015048515051603317, decouple_loss:0.0003529749810695648
The modified gen p mean: 0.44920095801353455, gen p mean: -0.11587259918451309, mean p set: 0.44977647066116333
The modified gen p mean: 0.448976993560791, gen p mean: -0.12281269580125809, mean p set: 0.4495515525341034
loss_pred:0.014928669668734074, decouple_loss:0.000398973556002602
loss_pred:0.015101071447134018, decouple_loss:0.00038154484354890883
2023-05-02 09:47:33 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12549032270908356, mean p set: 0.4502691626548767
loss_pred:0.016911955550312996, decouple_loss:0.0003673249448183924
The modified gen p mean: 0.4495372772216797, gen p mean: -0.11955884099006653, mean p set: 0.4500633478164673
loss_pred:0.01610652543604374, decouple_loss:0.00040592782897874713
The modified gen p mean: 0.4498293995857239, gen p mean: -0.11808805167675018, mean p set: 0.45035696029663086
loss_pred:0.016496483236551285, decouple_loss:0.00047346786595880985
WV_1_PC_1_EH_0_PS_40, loss: 0.016525767743587494, avg_mse: 0.025882652029395103
current test mse: 0.025883
Iteration: 1731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876018166542053, gen p mean: -0.1229444295167923, mean p set: 0.44933852553367615
loss_pred:0.014985687099397182, decouple_loss:0.0005220243474468589
The modified gen p mean: 0.44841915369033813, gen p mean: -0.11911547929048538, mean p set: 0.44899484515190125The modified gen p mean: 0.4499456584453583, gen p mean: -0.11632481962442398, mean p set: 0.450520396232605
loss_pred:0.015948684886097908, decouple_loss:0.0004779071605298668loss_pred:0.014921908266842365, decouple_loss:0.00040392004302702844
Iteration: 1732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499697685241699, gen p mean: -0.11352381110191345, mean p set: 0.45054665207862854
loss_pred:0.014878048561513424, decouple_loss:0.00040877211722545326
The modified gen p mean: 0.4489155411720276, gen p mean: -0.11080832034349442, mean p set: 0.4494929015636444The modified gen p mean: 0.4497327506542206, gen p mean: -0.11618687957525253, mean p set: 0.450310081243515
loss_pred:0.01510006096214056, decouple_loss:0.0003909626684617251
loss_pred:0.015051335096359253, decouple_loss:0.0005509497132152319
Iteration: 1733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906455278396606, gen p mean: -0.11430908739566803, mean p set: 0.44964277744293213
loss_pred:0.015100170858204365, decouple_loss:0.0003943851334042847
The modified gen p mean: 0.44777369499206543, gen p mean: -0.12113498896360397, mean p set: 0.44834738969802856
loss_pred:0.014713291078805923, decouple_loss:0.00037168015842325985
The modified gen p mean: 0.4491449296474457, gen p mean: -0.11795113235712051, mean p set: 0.44971972703933716
loss_pred:0.014797471463680267, decouple_loss:0.00036218887544237077
Iteration: 1734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494583308696747, gen p mean: -0.12227984517812729, mean p set: 0.45003435015678406
loss_pred:0.01470378041267395, decouple_loss:0.000390610279282555
The modified gen p mean: 0.4493398666381836, gen p mean: -0.1275591105222702, mean p set: 0.44991445541381836
loss_pred:0.0150778042152524, decouple_loss:0.0004387431254144758
The modified gen p mean: 0.4478307366371155, gen p mean: -0.12034852802753448, mean p set: 0.4484051764011383
loss_pred:0.014793852344155312, decouple_loss:0.0003363032010383904
Iteration: 1735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481775462627411, gen p mean: -0.12945562601089478, mean p set: 0.4487546384334564
loss_pred:0.015382410027086735, decouple_loss:0.0005747021059505641
The modified gen p mean: 0.44843676686286926, gen p mean: -0.11936961114406586, mean p set: 0.44901344180107117
loss_pred:0.014971515163779259, decouple_loss:0.00033669680124148726
The modified gen p mean: 0.45059680938720703, gen p mean: -0.11790554225444794, mean p set: 0.451172411441803
loss_pred:0.014896181412041187, decouple_loss:0.0005628699436783791
Iteration: 1736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485270380973816, gen p mean: -0.11704962700605392, mean p set: 0.44910016655921936
loss_pred:0.01543419063091278, decouple_loss:0.0003825417661573738
The modified gen p mean: 0.4484174847602844, gen p mean: -0.12077783793210983, mean p set: 0.4489958584308624
The modified gen p mean: 0.4498268961906433, gen p mean: -0.12442121654748917, mean p set: 0.4504038989543915
loss_pred:0.015005293302237988, decouple_loss:0.0003655007458291948
loss_pred:0.014621675945818424, decouple_loss:0.0005272732232697308
Iteration: 1737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497314989566803, gen p mean: -0.11939192563295364, mean p set: 0.4503089487552643
loss_pred:0.014410661533474922, decouple_loss:0.0003655285108834505
The modified gen p mean: 0.44912025332450867, gen p mean: -0.11972363293170929, mean p set: 0.4496983587741852
loss_pred:0.015226922929286957, decouple_loss:0.0005506978486664593
The modified gen p mean: 0.4489385783672333, gen p mean: -0.11771170049905777, mean p set: 0.4495154023170471
loss_pred:0.014352831989526749, decouple_loss:0.00041788077214732766
Iteration: 1738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486595690250397, gen p mean: -0.12392469495534897, mean p set: 0.449236124753952
loss_pred:0.01469014585018158, decouple_loss:0.00036587222712114453
The modified gen p mean: 0.4481342136859894, gen p mean: -0.12405946105718613, mean p set: 0.44871246814727783
The modified gen p mean: 0.44869500398635864, gen p mean: -0.11688914895057678, mean p set: 0.44927287101745605
loss_pred:0.015177766792476177, decouple_loss:0.00039201253093779087
loss_pred:0.015175660140812397, decouple_loss:0.0005232588737271726
Iteration: 1739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877898693084717, gen p mean: -0.12444987893104553, mean p set: 0.4493550956249237
loss_pred:0.01465169433504343, decouple_loss:0.000364443170838058
The modified gen p mean: 0.4481388032436371, gen p mean: -0.12047222256660461, mean p set: 0.4487136900424957
The modified gen p mean: 0.4491856098175049, gen p mean: -0.11560946702957153, mean p set: 0.4497624933719635
loss_pred:0.015342245809733868, decouple_loss:0.00039463964640162885
loss_pred:0.014975853264331818, decouple_loss:0.0004456395108718425
Iteration: 1740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509645700454712, gen p mean: -0.11723753064870834, mean p set: 0.4515393376350403
loss_pred:0.014768717810511589, decouple_loss:0.000605907931458205
The modified gen p mean: 0.44943878054618835, gen p mean: -0.1194603219628334, mean p set: 0.4500153958797455
loss_pred:0.01399477943778038, decouple_loss:0.00043446803465485573
The modified gen p mean: 0.44939035177230835, gen p mean: -0.11997361481189728, mean p set: 0.44996556639671326
loss_pred:0.014570347033441067, decouple_loss:0.000532579782884568
2023-05-02 09:49:40 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12983164191246033, mean p set: 0.4502691626548767
loss_pred:0.016855431720614433, decouple_loss:0.0005180964944884181
The modified gen p mean: 0.44953590631484985, gen p mean: -0.12383808940649033, mean p set: 0.4500633478164673
loss_pred:0.016101183369755745, decouple_loss:0.0005635899724438787
The modified gen p mean: 0.44982802867889404, gen p mean: -0.1227242648601532, mean p set: 0.45035696029663086
loss_pred:0.016428286209702492, decouple_loss:0.0004664525913540274
WV_1_PC_1_EH_0_PS_40, loss: 0.01648743636906147, avg_mse: 0.025742631405591965
current test mse: 0.025743
Iteration: 1741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479151666164398, gen p mean: -0.12514270842075348, mean p set: 0.44848892092704773
loss_pred:0.01513573806732893, decouple_loss:0.00034247784060426056
The modified gen p mean: 0.4494677782058716, gen p mean: -0.12229806184768677, mean p set: 0.45004376769065857
loss_pred:0.013558260165154934, decouple_loss:0.0004111831949558109
The modified gen p mean: 0.45001447200775146, gen p mean: -0.12717925012111664, mean p set: 0.45059165358543396
loss_pred:0.015121916308999062, decouple_loss:0.000450845283921808
Iteration: 1742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488048553466797, gen p mean: -0.12245269119739532, mean p set: 0.4493807256221771The modified gen p mean: 0.4482991695404053, gen p mean: -0.11970873922109604, mean p set: 0.4488753378391266
loss_pred:0.014574228785932064, decouple_loss:0.0003212691517546773
loss_pred:0.015030858106911182, decouple_loss:0.0004215966328047216
The modified gen p mean: 0.449004203081131, gen p mean: -0.1254105269908905, mean p set: 0.4495806396007538
loss_pred:0.014093088917434216, decouple_loss:0.00034913182025775313
Iteration: 1743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839465618133545, gen p mean: -0.12096932530403137, mean p set: 0.44897210597991943
loss_pred:0.014996534213423729, decouple_loss:0.0003586408856790513
The modified gen p mean: 0.4479321837425232, gen p mean: -0.1265382468700409, mean p set: 0.44850850105285645
loss_pred:0.014317595399916172, decouple_loss:0.0003275195194873959
The modified gen p mean: 0.44883760809898376, gen p mean: -0.11716648191213608, mean p set: 0.44941237568855286
loss_pred:0.015064041130244732, decouple_loss:0.00037752880598418415
Iteration: 1744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493553936481476, gen p mean: -0.1241595670580864, mean p set: 0.4499303698539734
loss_pred:0.015369820408523083, decouple_loss:0.00047486487892456353
The modified gen p mean: 0.4478716254234314, gen p mean: -0.12395577132701874, mean p set: 0.4484458863735199
loss_pred:0.014723130501806736, decouple_loss:0.000409536121878773
The modified gen p mean: 0.44778239727020264, gen p mean: -0.12214421480894089, mean p set: 0.4483579099178314
loss_pred:0.01393395196646452, decouple_loss:0.00031705148285254836
Iteration: 1745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486951529979706, gen p mean: -0.12015627324581146, mean p set: 0.4492739737033844
loss_pred:0.015059994533658028, decouple_loss:0.0003832069633062929
The modified gen p mean: 0.4493553638458252, gen p mean: -0.11784438788890839, mean p set: 0.4499305486679077
loss_pred:0.014353753998875618, decouple_loss:0.0003960849135182798
The modified gen p mean: 0.4489021301269531, gen p mean: -0.1245637834072113, mean p set: 0.4494836926460266
loss_pred:0.014596251770853996, decouple_loss:0.00040217855712398887
Iteration: 1746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489121735095978, gen p mean: -0.11585637927055359, mean p set: 0.4494885504245758
loss_pred:0.015513979829847813, decouple_loss:0.000421676057158038
The modified gen p mean: 0.4485952854156494, gen p mean: -0.11709564179182053, mean p set: 0.4491713047027588
loss_pred:0.015240371227264404, decouple_loss:0.0003792423813138157
The modified gen p mean: 0.4474634826183319, gen p mean: -0.12522512674331665, mean p set: 0.4480412006378174
loss_pred:0.015032267197966576, decouple_loss:0.00045735438470728695
Iteration: 1747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480009078979492, gen p mean: -0.11743715405464172, mean p set: 0.4485754370689392
loss_pred:0.015225674025714397, decouple_loss:0.0003994634607806802
The modified gen p mean: 0.44952288269996643, gen p mean: -0.12121709436178207, mean p set: 0.4500974118709564
loss_pred:0.014394119381904602, decouple_loss:0.0003105248906649649
The modified gen p mean: 0.4492857754230499, gen p mean: -0.11256693303585052, mean p set: 0.44986000657081604
loss_pred:0.014497306197881699, decouple_loss:0.00037422688910737634
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
NaN value num: 0
Iteration: 1748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450797975063324, gen p mean: -0.11410938203334808, mean p set: 0.4513757526874542
loss_pred:0.014538053423166275, decouple_loss:0.0004530794685706496
The modified gen p mean: 0.44802379608154297, gen p mean: -0.11420790106058121, mean p set: 0.4485994875431061
The modified gen p mean: 0.45105335116386414, gen p mean: -0.11420439183712006, mean p set: 0.45162826776504517
loss_pred:0.016317684203386307, decouple_loss:0.0005176450940780342
loss_pred:0.014483124017715454, decouple_loss:0.00040500579052604735
Iteration: 1749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45185545086860657, gen p mean: -0.11121384054422379, mean p set: 0.4524308443069458
loss_pred:0.01498743798583746, decouple_loss:0.0004798793524969369
The modified gen p mean: 0.4512508809566498, gen p mean: -0.11545651406049728, mean p set: 0.451826274394989
The modified gen p mean: 0.4501442313194275, gen p mean: -0.11230265349149704, mean p set: 0.45071932673454285
loss_pred:0.015463893301784992, decouple_loss:0.00043249723967164755
loss_pred:0.015407768078148365, decouple_loss:0.0003948047524318099
Iteration: 1750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503633379936218, gen p mean: -0.11340845376253128, mean p set: 0.4509385824203491
loss_pred:0.015447955578565598, decouple_loss:0.0005124805029481649
The modified gen p mean: 0.4502438008785248, gen p mean: -0.11162856221199036, mean p set: 0.4508203864097595
The modified gen p mean: 0.4505847990512848, gen p mean: -0.1118246540427208, mean p set: 0.4511634409427643
loss_pred:0.015291057527065277, decouple_loss:0.0003812325594481081
loss_pred:0.015867186710238457, decouple_loss:0.0005136079853400588
2023-05-02 09:52:30 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12418417632579803, mean p set: 0.4502691626548767
loss_pred:0.016826435923576355, decouple_loss:0.0005194399855099618
The modified gen p mean: 0.44953522086143494, gen p mean: -0.1183663010597229, mean p set: 0.4500633478164673
loss_pred:0.016134921461343765, decouple_loss:0.0005259809549897909
The modified gen p mean: 0.44982796907424927, gen p mean: -0.11743476986885071, mean p set: 0.45035696029663086
loss_pred:0.016338437795639038, decouple_loss:0.00043322466081008315
WV_1_PC_1_EH_0_PS_40, loss: 0.01645790785551071, avg_mse: 0.025675425305962563
current test mse: 0.025675
Iteration: 1751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45056700706481934, gen p mean: -0.10836827009916306, mean p set: 0.4511450529098511
loss_pred:0.014849524013698101, decouple_loss:0.00044689903734251857
The modified gen p mean: 0.4491143226623535, gen p mean: -0.10883386433124542, mean p set: 0.44969022274017334The modified gen p mean: 0.45137253403663635, gen p mean: -0.1168956309556961, mean p set: 0.4519474506378174
loss_pred:0.015137413516640663, decouple_loss:0.0003702515095937997loss_pred:0.014920497313141823, decouple_loss:0.0003489301889203489
Iteration: 1752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451093465089798, gen p mean: -0.11068959534168243, mean p set: 0.4516703188419342
loss_pred:0.01602211594581604, decouple_loss:0.00047314309631474316
The modified gen p mean: 0.45054250955581665, gen p mean: -0.1101846843957901, mean p set: 0.45111945271492004The modified gen p mean: 0.4505969285964966, gen p mean: -0.11055012792348862, mean p set: 0.4511736333370209
loss_pred:0.01509492564946413, decouple_loss:0.0003400605055503547
loss_pred:0.015015906654298306, decouple_loss:0.00033932525548152626
Iteration: 1753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497615694999695, gen p mean: -0.10511045157909393, mean p set: 0.4503384232521057
loss_pred:0.014620587229728699, decouple_loss:0.0006778480019420385
The modified gen p mean: 0.44974780082702637, gen p mean: -0.10966784507036209, mean p set: 0.45032238960266113
loss_pred:0.015781546011567116, decouple_loss:0.0004293087113182992
The modified gen p mean: 0.4483892619609833, gen p mean: -0.10068614780902863, mean p set: 0.4489688575267792
loss_pred:0.016804242506623268, decouple_loss:0.00048375953338108957
Iteration: 1754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45029014348983765, gen p mean: -0.11372110992670059, mean p set: 0.45086607336997986
The modified gen p mean: 0.4497585594654083, gen p mean: -0.11223886907100677, mean p set: 0.4503360688686371
loss_pred:0.015992846339941025, decouple_loss:0.0005192667595110834
loss_pred:0.015779724344611168, decouple_loss:0.0005719223991036415
The modified gen p mean: 0.45053455233573914, gen p mean: -0.11596512049436569, mean p set: 0.4511139988899231
loss_pred:0.015567801892757416, decouple_loss:0.000553936290089041
Iteration: 1755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44916167855262756, gen p mean: -0.10955888032913208, mean p set: 0.44973814487457275The modified gen p mean: 0.44808876514434814, gen p mean: -0.10828161239624023, mean p set: 0.4486648738384247
loss_pred:0.01628413423895836, decouple_loss:0.0004527843266259879
loss_pred:0.015797264873981476, decouple_loss:0.0003886889317072928
The modified gen p mean: 0.44981810450553894, gen p mean: -0.11648891121149063, mean p set: 0.4503934979438782
loss_pred:0.015406060963869095, decouple_loss:0.00047581412945874035
Iteration: 1756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108288526535034, gen p mean: -0.11826257407665253, mean p set: 0.451659619808197
loss_pred:0.014871923252940178, decouple_loss:0.0004187517915852368
The modified gen p mean: 0.45105284452438354, gen p mean: -0.11340402811765671, mean p set: 0.4516293406486511
The modified gen p mean: 0.45214998722076416, gen p mean: -0.11195980757474899, mean p set: 0.45272788405418396
loss_pred:0.014918766915798187, decouple_loss:0.00046917612780816853
loss_pred:0.015970725566148758, decouple_loss:0.0005096846725791693
Iteration: 1757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089998841285706, gen p mean: -0.1123916432261467, mean p set: 0.4514772295951843
loss_pred:0.015167786739766598, decouple_loss:0.0004250983183737844
The modified gen p mean: 0.450286865234375, gen p mean: -0.11874552816152573, mean p set: 0.45086219906806946
The modified gen p mean: 0.4488736689090729, gen p mean: -0.11796414107084274, mean p set: 0.44945064187049866
loss_pred:0.015949469059705734, decouple_loss:0.0004455451271496713
loss_pred:0.015915296971797943, decouple_loss:0.0005976739339530468
Iteration: 1758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509061574935913, gen p mean: -0.11801572144031525, mean p set: 0.4514824450016022
The modified gen p mean: 0.45168450474739075, gen p mean: -0.10754342377185822, mean p set: 0.4522624611854553
loss_pred:0.014926974661648273, decouple_loss:0.0005425949930213392
loss_pred:0.015213550999760628, decouple_loss:0.0005097202374599874
The modified gen p mean: 0.4493021070957184, gen p mean: -0.11524076014757156, mean p set: 0.44987818598747253
loss_pred:0.01634599082171917, decouple_loss:0.00044603116111829877
Iteration: 1759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45074206590652466, gen p mean: -0.10648121684789658, mean p set: 0.4513179361820221
The modified gen p mean: 0.4501344561576843, gen p mean: -0.11028110235929489, mean p set: 0.4507116973400116
loss_pred:0.014455245807766914, decouple_loss:0.0005745795788243413
loss_pred:0.01593029499053955, decouple_loss:0.0007086898549459875
The modified gen p mean: 0.4503624141216278, gen p mean: -0.10713236778974533, mean p set: 0.4509407579898834
loss_pred:0.014176762662827969, decouple_loss:0.0005264926585368812
Iteration: 1760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45115798711776733, gen p mean: -0.10877323895692825, mean p set: 0.45173394680023193
loss_pred:0.014834403060376644, decouple_loss:0.0006404752493835986
The modified gen p mean: 0.44906607270240784, gen p mean: -0.10705370455980301, mean p set: 0.4496423602104187
loss_pred:0.015735667198896408, decouple_loss:0.0006152092246338725
The modified gen p mean: 0.45063912868499756, gen p mean: -0.10910811275243759, mean p set: 0.4512156844139099
loss_pred:0.014910329133272171, decouple_loss:0.0004708600463345647
2023-05-02 09:54:38 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11798065900802612, mean p set: 0.4502691626548767
loss_pred:0.0168649572879076, decouple_loss:0.0006013249512761831
The modified gen p mean: 0.4495355784893036, gen p mean: -0.11156576871871948, mean p set: 0.4500633478164673
loss_pred:0.016290660947561264, decouple_loss:0.0005132111255079508
The modified gen p mean: 0.4498290419578552, gen p mean: -0.11037670075893402, mean p set: 0.45035696029663086
loss_pred:0.01641598902642727, decouple_loss:0.0004682902945205569
WV_1_PC_1_EH_0_PS_40, loss: 0.016550250351428986, avg_mse: 0.025772463530302048
current test mse: 0.025772
Iteration: 1761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45132192969322205, gen p mean: -0.1057322770357132, mean p set: 0.45189934968948364
loss_pred:0.014487119391560555, decouple_loss:0.0005527983885258436
The modified gen p mean: 0.4482566714286804, gen p mean: -0.10761407762765884, mean p set: 0.448832631111145The modified gen p mean: 0.45117267966270447, gen p mean: -0.10625004768371582, mean p set: 0.45174965262413025
loss_pred:0.016161995008587837, decouple_loss:0.0005568109336309135
loss_pred:0.014314885251224041, decouple_loss:0.00048759678611531854
Iteration: 1762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518410861492157, gen p mean: -0.10355893522500992, mean p set: 0.4524208605289459
loss_pred:0.016168687492609024, decouple_loss:0.0005444835987873375
The modified gen p mean: 0.4503648579120636, gen p mean: -0.10064855217933655, mean p set: 0.45094114542007446The modified gen p mean: 0.45105892419815063, gen p mean: -0.10511013120412827, mean p set: 0.45163747668266296
loss_pred:0.014981926418840885, decouple_loss:0.0006426291074603796loss_pred:0.014543781988322735, decouple_loss:0.0006405672756955028
Iteration: 1763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504386782646179, gen p mean: -0.10330657660961151, mean p set: 0.45101502537727356
loss_pred:0.015123867429792881, decouple_loss:0.0005281774792820215
The modified gen p mean: 0.44937026500701904, gen p mean: -0.09893631190061569, mean p set: 0.44994789361953735
loss_pred:0.0165280569344759, decouple_loss:0.0004732919333036989
The modified gen p mean: 0.45050081610679626, gen p mean: -0.10043885558843613, mean p set: 0.4510786831378937
loss_pred:0.014609787613153458, decouple_loss:0.0004941301885992289
Iteration: 1764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512211084365845, gen p mean: -0.09792833775281906, mean p set: 0.4517979323863983
loss_pred:0.014371245168149471, decouple_loss:0.00046692549949511886
The modified gen p mean: 0.4500858783721924, gen p mean: -0.10227268934249878, mean p set: 0.450663298368454
loss_pred:0.01546800322830677, decouple_loss:0.0003987388627137989
The modified gen p mean: 0.4486440420150757, gen p mean: -0.09310866892337799, mean p set: 0.44922199845314026
loss_pred:0.016001151874661446, decouple_loss:0.0004892327124252915
Iteration: 1765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45039820671081543, gen p mean: -0.0979638546705246, mean p set: 0.45097577571868896
The modified gen p mean: 0.44890597462654114, gen p mean: -0.10039566457271576, mean p set: 0.44948139786720276
loss_pred:0.015141659416258335, decouple_loss:0.0007528472342528403
loss_pred:0.016177013516426086, decouple_loss:0.0008083610446192324
The modified gen p mean: 0.4501402676105499, gen p mean: -0.09668342024087906, mean p set: 0.4507162272930145
loss_pred:0.014768223278224468, decouple_loss:0.0005499226390384138
Iteration: 1766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45178529620170593, gen p mean: -0.10195266455411911, mean p set: 0.4523622393608093
The modified gen p mean: 0.45190757513046265, gen p mean: -0.09966433048248291, mean p set: 0.4524841606616974
loss_pred:0.015083021484315395, decouple_loss:0.0005857468349859118
loss_pred:0.014930532313883305, decouple_loss:0.0005844268016517162
The modified gen p mean: 0.45172542333602905, gen p mean: -0.1036866158246994, mean p set: 0.45230305194854736
loss_pred:0.0150368707254529, decouple_loss:0.0005896515212953091
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
NaN value num: 0
Iteration: 1767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446372389793396, gen p mean: -0.12093892693519592, mean p set: 0.4469445049762726
The modified gen p mean: 0.44833844900131226, gen p mean: -0.11132451146841049, mean p set: 0.448914498090744
loss_pred:0.016568396240472794, decouple_loss:0.0005990842473693192
loss_pred:0.01591433957219124, decouple_loss:0.00046179312630556524
The modified gen p mean: 0.446368545293808, gen p mean: -0.11270599067211151, mean p set: 0.4469434916973114
loss_pred:0.016793522983789444, decouple_loss:0.0004176796064712107
Iteration: 1768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471885859966278, gen p mean: -0.11741403490304947, mean p set: 0.44776445627212524
loss_pred:0.017002733424305916, decouple_loss:0.0004218500398565084
The modified gen p mean: 0.4459870159626007, gen p mean: -0.12151595950126648, mean p set: 0.4465617835521698
The modified gen p mean: 0.44731974601745605, gen p mean: -0.11716756969690323, mean p set: 0.44789573550224304
loss_pred:0.016152657568454742, decouple_loss:0.0005398942739702761
loss_pred:0.016355426982045174, decouple_loss:0.00047949713189154863
Iteration: 1769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467708468437195, gen p mean: -0.1211540475487709, mean p set: 0.4473479390144348
loss_pred:0.016793757677078247, decouple_loss:0.00046602924703620374
The modified gen p mean: 0.4485747516155243, gen p mean: -0.11598585546016693, mean p set: 0.44915181398391724
The modified gen p mean: 0.4469420313835144, gen p mean: -0.12268704921007156, mean p set: 0.4475182592868805
loss_pred:0.016085658222436905, decouple_loss:0.000501164176966995
loss_pred:0.016973167657852173, decouple_loss:0.0004969583824276924
Iteration: 1770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470079243183136, gen p mean: -0.12087452411651611, mean p set: 0.4475840926170349
loss_pred:0.015887243673205376, decouple_loss:0.00044584384886547923
The modified gen p mean: 0.446006715297699, gen p mean: -0.11700260639190674, mean p set: 0.4465792179107666
The modified gen p mean: 0.44620010256767273, gen p mean: -0.11725570261478424, mean p set: 0.44677734375
loss_pred:0.01656615175306797, decouple_loss:0.00042854397906921804
loss_pred:0.016210198402404785, decouple_loss:0.0004353044496383518
2023-05-02 09:57:33 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12733785808086395, mean p set: 0.4502691626548767
loss_pred:0.01685544289648533, decouple_loss:0.0004182493139524013
The modified gen p mean: 0.44953596591949463, gen p mean: -0.1207771897315979, mean p set: 0.4500633478164673
loss_pred:0.016231747344136238, decouple_loss:0.0004614863428287208
The modified gen p mean: 0.4498252868652344, gen p mean: -0.12003549933433533, mean p set: 0.45035696029663086
loss_pred:0.016343042254447937, decouple_loss:0.0004549061704892665
WV_1_PC_1_EH_0_PS_40, loss: 0.016498988494277, avg_mse: 0.02573026344180107
current test mse: 0.02573
Iteration: 1771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458615779876709, gen p mean: -0.123674176633358, mean p set: 0.4464368224143982
loss_pred:0.016702044755220413, decouple_loss:0.00048391701420769095
The modified gen p mean: 0.44760599732398987, gen p mean: -0.1219077855348587, mean p set: 0.4481818377971649The modified gen p mean: 0.4466039538383484, gen p mean: -0.1196582093834877, mean p set: 0.44717922806739807
loss_pred:0.01651373878121376, decouple_loss:0.00046507298247888684loss_pred:0.016277719289064407, decouple_loss:0.00041891419095918536
Iteration: 1772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609594345092773, gen p mean: -0.12108336389064789, mean p set: 0.4466714859008789
loss_pred:0.015864187851548195, decouple_loss:0.00040969246765598655
The modified gen p mean: 0.448001891374588, gen p mean: -0.11996801197528839, mean p set: 0.44857561588287354The modified gen p mean: 0.44728806614875793, gen p mean: -0.12348019331693649, mean p set: 0.4478640854358673
loss_pred:0.015466496348381042, decouple_loss:0.00032944080885499716
loss_pred:0.01686621457338333, decouple_loss:0.0004514751199167222
Iteration: 1773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476288855075836, gen p mean: -0.12621955573558807, mean p set: 0.4482041299343109
The modified gen p mean: 0.446697473526001, gen p mean: -0.12444230914115906, mean p set: 0.44727540016174316loss_pred:0.015497090294957161, decouple_loss:0.00037048113881610334
loss_pred:0.015911929309368134, decouple_loss:0.00036512574297375977
The modified gen p mean: 0.446637362241745, gen p mean: -0.12511679530143738, mean p set: 0.44721341133117676
loss_pred:0.015876760706305504, decouple_loss:0.00034762921859510243
Iteration: 1774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770753383636475, gen p mean: -0.12517854571342468, mean p set: 0.44828227162361145
loss_pred:0.017043959349393845, decouple_loss:0.00042073643999174237
The modified gen p mean: 0.4481687545776367, gen p mean: -0.1274649053812027, mean p set: 0.44874683022499084
loss_pred:0.01591813750565052, decouple_loss:0.00042453102651052177
The modified gen p mean: 0.4468432366847992, gen p mean: -0.1231319010257721, mean p set: 0.4474189281463623
loss_pred:0.01682518795132637, decouple_loss:0.0004270994395483285
Iteration: 1775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466482102870941, gen p mean: -0.1261892020702362, mean p set: 0.44722142815589905The modified gen p mean: 0.44721299409866333, gen p mean: -0.12403477728366852, mean p set: 0.4477900266647339
loss_pred:0.017129579558968544, decouple_loss:0.0004989841836504638
loss_pred:0.016064805909991264, decouple_loss:0.0004166431026533246
The modified gen p mean: 0.44634243845939636, gen p mean: -0.12756459414958954, mean p set: 0.4469192922115326
loss_pred:0.017473503947257996, decouple_loss:0.0005195937119424343
Iteration: 1776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692206382751465, gen p mean: -0.1276382952928543, mean p set: 0.4474962055683136
loss_pred:0.016526715829968452, decouple_loss:0.0004444700025487691
The modified gen p mean: 0.4455195367336273, gen p mean: -0.12701420485973358, mean p set: 0.446098268032074
The modified gen p mean: 0.4472450017929077, gen p mean: -0.1257064789533615, mean p set: 0.4478198289871216
loss_pred:0.0166863352060318, decouple_loss:0.0005416652420535684
loss_pred:0.0158672034740448, decouple_loss:0.00046379450941458344
Iteration: 1777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477173388004303, gen p mean: -0.12710729241371155, mean p set: 0.44829463958740234
loss_pred:0.01679195649921894, decouple_loss:0.000410231965361163
The modified gen p mean: 0.44790971279144287, gen p mean: -0.11630506068468094, mean p set: 0.44848719239234924
loss_pred:0.015621272847056389, decouple_loss:0.000407883373554796
The modified gen p mean: 0.44727882742881775, gen p mean: -0.1333562284708023, mean p set: 0.4478553533554077
loss_pred:0.017156103625893593, decouple_loss:0.0005482012638822198
Iteration: 1778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784313440322876, gen p mean: -0.1219225823879242, mean p set: 0.44842231273651123
loss_pred:0.01602781005203724, decouple_loss:0.0005092006176710129
The modified gen p mean: 0.44785889983177185, gen p mean: -0.12219234555959702, mean p set: 0.4484359920024872
loss_pred:0.01563572883605957, decouple_loss:0.00037863405304960907
The modified gen p mean: 0.44805774092674255, gen p mean: -0.12637777626514435, mean p set: 0.44863349199295044
loss_pred:0.015997707843780518, decouple_loss:0.0005453821504488587
Iteration: 1779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445550799369812, gen p mean: -0.12317971885204315, mean p set: 0.4461243748664856
loss_pred:0.015702513977885246, decouple_loss:0.0004698332049883902
The modified gen p mean: 0.44777435064315796, gen p mean: -0.12546370923519135, mean p set: 0.4483503997325897
The modified gen p mean: 0.44678038358688354, gen p mean: -0.12105236947536469, mean p set: 0.44735562801361084
loss_pred:0.015841588377952576, decouple_loss:0.0005272760754451156
loss_pred:0.01571337692439556, decouple_loss:0.00046396811376325786
Iteration: 1780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477084279060364, gen p mean: -0.1316225528717041, mean p set: 0.4482823610305786
loss_pred:0.016367200762033463, decouple_loss:0.00042397610377520323
The modified gen p mean: 0.4476087689399719, gen p mean: -0.1225273385643959, mean p set: 0.44818708300590515
The modified gen p mean: 0.44601649045944214, gen p mean: -0.12570452690124512, mean p set: 0.4465934634208679
loss_pred:0.015910370275378227, decouple_loss:0.00042121531441807747
loss_pred:0.01566157676279545, decouple_loss:0.0004213015199638903
2023-05-02 09:59:39 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12980180978775024, mean p set: 0.4502691626548767
loss_pred:0.01685757003724575, decouple_loss:0.0004067898844368756
The modified gen p mean: 0.4495362341403961, gen p mean: -0.12331189960241318, mean p set: 0.4500633478164673
loss_pred:0.016210859641432762, decouple_loss:0.000529985991306603
The modified gen p mean: 0.449827641248703, gen p mean: -0.12241855263710022, mean p set: 0.45035696029663086
loss_pred:0.01641380414366722, decouple_loss:0.0004014552105218172
WV_1_PC_1_EH_0_PS_40, loss: 0.01651638187468052, avg_mse: 0.025747740641236305
current test mse: 0.025748
Iteration: 1781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447165846824646, gen p mean: -0.11869246512651443, mean p set: 0.44774138927459717
loss_pred:0.017014071345329285, decouple_loss:0.0004327311471570283
The modified gen p mean: 0.44647303223609924, gen p mean: -0.12181562930345535, mean p set: 0.44704926013946533
loss_pred:0.01686982437968254, decouple_loss:0.0004127497086301446
The modified gen p mean: 0.44791898131370544, gen p mean: -0.12287510931491852, mean p set: 0.44849371910095215
loss_pred:0.015689149498939514, decouple_loss:0.0004194806679151952
Iteration: 1782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716304540634155, gen p mean: -0.12287572026252747, mean p set: 0.4477398097515106
loss_pred:0.01643604040145874, decouple_loss:0.0004383402701932937
The modified gen p mean: 0.44685834646224976, gen p mean: -0.12006203085184097, mean p set: 0.44743436574935913The modified gen p mean: 0.4468809962272644, gen p mean: -0.12003196030855179, mean p set: 0.4474555552005768
loss_pred:0.01560353022068739, decouple_loss:0.0004141798708587885
loss_pred:0.016715984791517258, decouple_loss:0.0004636671219486743
Iteration: 1783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475092887878418, gen p mean: -0.12285705655813217, mean p set: 0.4480871260166168
loss_pred:0.01586250215768814, decouple_loss:0.0003902350727003068
The modified gen p mean: 0.44751808047294617, gen p mean: -0.12535414099693298, mean p set: 0.4480923116207123
loss_pred:0.016086231917142868, decouple_loss:0.000324784021358937
The modified gen p mean: 0.44775399565696716, gen p mean: -0.12220899015665054, mean p set: 0.4483303725719452
loss_pred:0.015914663672447205, decouple_loss:0.000350292248185724
Iteration: 1784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654589891433716, gen p mean: -0.12291115522384644, mean p set: 0.44712120294570923
loss_pred:0.016727875918149948, decouple_loss:0.00037149680429138243
The modified gen p mean: 0.4468873143196106, gen p mean: -0.13168293237686157, mean p set: 0.44746658205986023
loss_pred:0.016835931688547134, decouple_loss:0.0006364823784679174
The modified gen p mean: 0.4470316469669342, gen p mean: -0.11927824467420578, mean p set: 0.4476066827774048
loss_pred:0.01617029309272766, decouple_loss:0.0004050605930387974
Iteration: 1785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478146433830261, gen p mean: -0.12157365679740906, mean p set: 0.44839179515838623
loss_pred:0.015487508848309517, decouple_loss:0.00036294577876105905
The modified gen p mean: 0.44689956307411194, gen p mean: -0.13178278505802155, mean p set: 0.44747358560562134
loss_pred:0.01649780012667179, decouple_loss:0.000567035109270364
The modified gen p mean: 0.4462736248970032, gen p mean: -0.1317214071750641, mean p set: 0.446853369474411
loss_pred:0.0167551152408123, decouple_loss:0.00046074303099885583
Iteration: 1786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463246166706085, gen p mean: -0.12321939319372177, mean p set: 0.44690072536468506
loss_pred:0.01560021098703146, decouple_loss:0.0006461849552579224
The modified gen p mean: 0.44639092683792114, gen p mean: -0.12116895616054535, mean p set: 0.4469677805900574
The modified gen p mean: 0.44539403915405273, gen p mean: -0.12900888919830322, mean p set: 0.4459685981273651
loss_pred:0.01670447178184986, decouple_loss:0.0005208300426602364
loss_pred:0.016282476484775543, decouple_loss:0.0004704867897089571
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
NaN value num: 0
Iteration: 1787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497724771499634, gen p mean: -0.11820340156555176, mean p set: 0.45034709572792053
The modified gen p mean: 0.45072054862976074, gen p mean: -0.11761114746332169, mean p set: 0.45129671692848206loss_pred:0.016090484336018562, decouple_loss:0.0009055201662704349
loss_pred:0.015352493152022362, decouple_loss:0.0006396774551831186
The modified gen p mean: 0.4494766294956207, gen p mean: -0.12174366414546967, mean p set: 0.45005232095718384
loss_pred:0.01566680520772934, decouple_loss:0.0005261224578134716
Iteration: 1788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971299171447754, gen p mean: -0.11273379623889923, mean p set: 0.45028993487358093
loss_pred:0.015549850650131702, decouple_loss:0.0004733552341349423
The modified gen p mean: 0.450280100107193, gen p mean: -0.11070936918258667, mean p set: 0.4508568048477173
The modified gen p mean: 0.45062875747680664, gen p mean: -0.10955562442541122, mean p set: 0.45120492577552795
loss_pred:0.015833914279937744, decouple_loss:0.0006873785168863833
loss_pred:0.01619974710047245, decouple_loss:0.0004809256934095174
Iteration: 1789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492326080799103, gen p mean: -0.10759606957435608, mean p set: 0.44980788230895996
loss_pred:0.015782279893755913, decouple_loss:0.0005629266961477697
The modified gen p mean: 0.4504745602607727, gen p mean: -0.11296738684177399, mean p set: 0.45105046033859253
The modified gen p mean: 0.4496372640132904, gen p mean: -0.106608547270298, mean p set: 0.4502144455909729
loss_pred:0.015582910738885403, decouple_loss:0.0006052302778698504
loss_pred:0.01512504555284977, decouple_loss:0.0005902590928599238
Iteration: 1790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507003724575043, gen p mean: -0.11351606249809265, mean p set: 0.45127591490745544
loss_pred:0.015531419776380062, decouple_loss:0.0007946129771880805
The modified gen p mean: 0.4501062035560608, gen p mean: -0.11232992261648178, mean p set: 0.4506819546222687
The modified gen p mean: 0.4492146074771881, gen p mean: -0.10474718362092972, mean p set: 0.4497903883457184
loss_pred:0.014811175875365734, decouple_loss:0.0006953664706088603
loss_pred:0.015828760340809822, decouple_loss:0.00046137344907037914
2023-05-02 10:02:29 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1260320395231247, mean p set: 0.4502691626548767
loss_pred:0.01695716567337513, decouple_loss:0.0006804458098486066
The modified gen p mean: 0.4495329260826111, gen p mean: -0.11959671229124069, mean p set: 0.4500633478164673
loss_pred:0.01621210388839245, decouple_loss:0.0005807577981613576
The modified gen p mean: 0.44982823729515076, gen p mean: -0.11877614259719849, mean p set: 0.45035696029663086
loss_pred:0.016493460163474083, decouple_loss:0.0006852090009488165
WV_1_PC_1_EH_0_PS_40, loss: 0.016586683690547943, avg_mse: 0.025804921984672546
current test mse: 0.025805
Iteration: 1791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903066754341125, gen p mean: -0.11132753640413284, mean p set: 0.44960469007492065
loss_pred:0.01579388417303562, decouple_loss:0.0004047086404170841
The modified gen p mean: 0.4497774839401245, gen p mean: -0.10934372991323471, mean p set: 0.450351357460022The modified gen p mean: 0.4507349133491516, gen p mean: -0.11009608954191208, mean p set: 0.4513128101825714
loss_pred:0.01566699706017971, decouple_loss:0.0006214967579580843
loss_pred:0.015812838450074196, decouple_loss:0.0007049737614579499
Iteration: 1792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969597458839417, gen p mean: -0.11689268052577972, mean p set: 0.4502711296081543
loss_pred:0.014627293683588505, decouple_loss:0.0005244178464636207
The modified gen p mean: 0.45033156871795654, gen p mean: -0.11132748425006866, mean p set: 0.45090827345848083The modified gen p mean: 0.45056188106536865, gen p mean: -0.11513369530439377, mean p set: 0.45113804936408997
loss_pred:0.016347767785191536, decouple_loss:0.000526018557138741
loss_pred:0.015081197023391724, decouple_loss:0.0007249771151691675
Iteration: 1793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45086488127708435, gen p mean: -0.11997025460004807, mean p set: 0.4514424204826355
loss_pred:0.014270913787186146, decouple_loss:0.0005466981674544513
The modified gen p mean: 0.45060884952545166, gen p mean: -0.12074054032564163, mean p set: 0.4511845111846924
loss_pred:0.01485643070191145, decouple_loss:0.0006014577229507267
The modified gen p mean: 0.4487275183200836, gen p mean: -0.11461469531059265, mean p set: 0.44930416345596313
loss_pred:0.01546144112944603, decouple_loss:0.000525336479768157
Iteration: 1794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506671130657196, gen p mean: -0.12428954243659973, mean p set: 0.4512425363063812
loss_pred:0.015148771926760674, decouple_loss:0.0006532404804602265
The modified gen p mean: 0.4498504102230072, gen p mean: -0.11756651848554611, mean p set: 0.45042750239372253
loss_pred:0.015660002827644348, decouple_loss:0.0005453764460980892
The modified gen p mean: 0.44965407252311707, gen p mean: -0.1163681373000145, mean p set: 0.4502323865890503
loss_pred:0.01549562532454729, decouple_loss:0.0004399627505335957
Iteration: 1795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45079442858695984, gen p mean: -0.12414642423391342, mean p set: 0.45136934518814087
loss_pred:0.015120533294975758, decouple_loss:0.00042323212255723774
The modified gen p mean: 0.44998177886009216, gen p mean: -0.12176913768053055, mean p set: 0.4505578577518463
loss_pred:0.015103371813893318, decouple_loss:0.0004325526824686676
The modified gen p mean: 0.450419157743454, gen p mean: -0.12260780483484268, mean p set: 0.4509945213794708
loss_pred:0.01508069783449173, decouple_loss:0.00036763137904927135
Iteration: 1796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490712285041809, gen p mean: -0.1242811381816864, mean p set: 0.4496467411518097
loss_pred:0.016511518508195877, decouple_loss:0.0004181598196737468
The modified gen p mean: 0.448972225189209, gen p mean: -0.1213550940155983, mean p set: 0.4495491087436676
The modified gen p mean: 0.45032384991645813, gen p mean: -0.11788542568683624, mean p set: 0.45090147852897644
loss_pred:0.01528456062078476, decouple_loss:0.0003960856993217021
loss_pred:0.015970075502991676, decouple_loss:0.0005827904678881168
Iteration: 1797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497990310192108, gen p mean: -0.11270356178283691, mean p set: 0.45037728548049927
loss_pred:0.01565227098762989, decouple_loss:0.00048790808068588376
The modified gen p mean: 0.45072656869888306, gen p mean: -0.12223494797945023, mean p set: 0.4513028562068939
The modified gen p mean: 0.4500400722026825, gen p mean: -0.12096428126096725, mean p set: 0.45061591267585754
loss_pred:0.015347977168858051, decouple_loss:0.0005482503329403698
loss_pred:0.014932391233742237, decouple_loss:0.00037837287527509034
Iteration: 1798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450662761926651, gen p mean: -0.11808297783136368, mean p set: 0.4512394070625305
loss_pred:0.016048496589064598, decouple_loss:0.0004515474138315767
The modified gen p mean: 0.45052069425582886, gen p mean: -0.1186572015285492, mean p set: 0.4510977864265442
loss_pred:0.014885768294334412, decouple_loss:0.000520953384693712
The modified gen p mean: 0.4499225318431854, gen p mean: -0.1195758730173111, mean p set: 0.45049992203712463
loss_pred:0.014985200949013233, decouple_loss:0.0004442355129867792
Iteration: 1799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502337872982025, gen p mean: -0.11269200593233109, mean p set: 0.45081210136413574
loss_pred:0.014817981980741024, decouple_loss:0.0005261522019281983
The modified gen p mean: 0.4492265582084656, gen p mean: -0.11025620251893997, mean p set: 0.44980117678642273
The modified gen p mean: 0.44977790117263794, gen p mean: -0.11161661148071289, mean p set: 0.4503557085990906
loss_pred:0.015858164057135582, decouple_loss:0.0005466676084324718
loss_pred:0.015377947129309177, decouple_loss:0.0006455138209275901
Iteration: 1800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489727020263672, gen p mean: -0.11123412102460861, mean p set: 0.4495503306388855
loss_pred:0.014971689321100712, decouple_loss:0.0004993404145352542
The modified gen p mean: 0.450553834438324, gen p mean: -0.10866692662239075, mean p set: 0.4511294364929199
The modified gen p mean: 0.4517207741737366, gen p mean: -0.10666422545909882, mean p set: 0.45230039954185486
loss_pred:0.015511048957705498, decouple_loss:0.0004670991038437933
loss_pred:0.015528841875493526, decouple_loss:0.00036839439417235553
2023-05-02 10:04:36 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12581782042980194, mean p set: 0.4502691626548767
loss_pred:0.01698552444577217, decouple_loss:0.0006235603359527886
The modified gen p mean: 0.44953519105911255, gen p mean: -0.11986871808767319, mean p set: 0.4500633478164673
loss_pred:0.016310205683112144, decouple_loss:0.0005686561926268041
The modified gen p mean: 0.4498285949230194, gen p mean: -0.11876791715621948, mean p set: 0.45035696029663086
loss_pred:0.016514891758561134, decouple_loss:0.000496155524160713
WV_1_PC_1_EH_0_PS_40, loss: 0.016631681472063065, avg_mse: 0.025921419262886047
current test mse: 0.025921
Iteration: 1801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44981881976127625, gen p mean: -0.1112913116812706, mean p set: 0.450395792722702
loss_pred:0.015470939688384533, decouple_loss:0.00042012252379208803
The modified gen p mean: 0.45023027062416077, gen p mean: -0.11308087408542633, mean p set: 0.45080649852752686The modified gen p mean: 0.44903913140296936, gen p mean: -0.11280331015586853, mean p set: 0.4496149718761444
loss_pred:0.015001873485744, decouple_loss:0.0004222287388984114
loss_pred:0.01511419378221035, decouple_loss:0.0005095062660984695
Iteration: 1802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45076775550842285, gen p mean: -0.10451795160770416, mean p set: 0.4513426423072815
loss_pred:0.015489282086491585, decouple_loss:0.0004447240207809955
The modified gen p mean: 0.4508845806121826, gen p mean: -0.1121402159333229, mean p set: 0.45145899057388306The modified gen p mean: 0.44813650846481323, gen p mean: -0.10960705578327179, mean p set: 0.4487132728099823
loss_pred:0.015764323994517326, decouple_loss:0.0005431259050965309loss_pred:0.015485509298741817, decouple_loss:0.0003539134340826422
Iteration: 1803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044443011283875, gen p mean: -0.11044508218765259, mean p set: 0.45102033019065857
loss_pred:0.014966856688261032, decouple_loss:0.0005881914403289557
The modified gen p mean: 0.45114535093307495, gen p mean: -0.10991425067186356, mean p set: 0.4517212510108948The modified gen p mean: 0.4499112069606781, gen p mean: -0.11195334792137146, mean p set: 0.4504863917827606
loss_pred:0.014806151390075684, decouple_loss:0.0005119126872159541
loss_pred:0.015473896637558937, decouple_loss:0.0005644881166517735
Iteration: 1804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45045921206474304, gen p mean: -0.10655927658081055, mean p set: 0.4510340988636017
loss_pred:0.015372696332633495, decouple_loss:0.0004882636421825737
The modified gen p mean: 0.4497227966785431, gen p mean: -0.10589599609375, mean p set: 0.4503003656864166
loss_pred:0.015393580310046673, decouple_loss:0.0004324476176407188
The modified gen p mean: 0.4499746561050415, gen p mean: -0.11233212798833847, mean p set: 0.4505513310432434
loss_pred:0.014468665234744549, decouple_loss:0.0007034115260466933
Iteration: 1805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504658877849579, gen p mean: -0.10796205699443817, mean p set: 0.4510418474674225
loss_pred:0.0150385033339262, decouple_loss:0.0004575400671456009
The modified gen p mean: 0.44871771335601807, gen p mean: -0.10573466867208481, mean p set: 0.4492945969104767
loss_pred:0.015017573721706867, decouple_loss:0.0004403512575663626
The modified gen p mean: 0.45032259821891785, gen p mean: -0.10797461867332458, mean p set: 0.4508983790874481
loss_pred:0.015616323798894882, decouple_loss:0.0003650111029855907
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
NaN value num: 0
Iteration: 1806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518439471721649, gen p mean: -0.10754530876874924, mean p set: 0.4524218738079071
The modified gen p mean: 0.4518226385116577, gen p mean: -0.1097184345126152, mean p set: 0.45239993929862976
loss_pred:0.014871647581458092, decouple_loss:0.0005540666752494872
loss_pred:0.014907756820321083, decouple_loss:0.0004988214350305498
The modified gen p mean: 0.4503629207611084, gen p mean: -0.10606275498867035, mean p set: 0.45093876123428345
loss_pred:0.014840804040431976, decouple_loss:0.0006646473775617778
Iteration: 1807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521467089653015, gen p mean: -0.11210950464010239, mean p set: 0.4527246057987213
loss_pred:0.015194791369140148, decouple_loss:0.0007415958680212498
The modified gen p mean: 0.45163196325302124, gen p mean: -0.11244707554578781, mean p set: 0.45220664143562317
loss_pred:0.014576185494661331, decouple_loss:0.0007267881301231682
The modified gen p mean: 0.4517804980278015, gen p mean: -0.10861288756132126, mean p set: 0.45235851407051086
loss_pred:0.01492939330637455, decouple_loss:0.000531803525518626
Iteration: 1808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495306611061096, gen p mean: -0.11084001511335373, mean p set: 0.45010724663734436
loss_pred:0.014862623065710068, decouple_loss:0.0005537918186746538
The modified gen p mean: 0.45241233706474304, gen p mean: -0.10965917259454727, mean p set: 0.4529889225959778
loss_pred:0.014329391531646252, decouple_loss:0.0005361063522286713
The modified gen p mean: 0.449686735868454, gen p mean: -0.10944564640522003, mean p set: 0.45026299357414246
loss_pred:0.014913630671799183, decouple_loss:0.0005650271777994931
Iteration: 1809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505893886089325, gen p mean: -0.10946288704872131, mean p set: 0.45116758346557617
loss_pred:0.014970830641686916, decouple_loss:0.0005408377037383616
The modified gen p mean: 0.4532841444015503, gen p mean: -0.10945214331150055, mean p set: 0.4538613259792328
loss_pred:0.014589237049221992, decouple_loss:0.0005280487239360809
The modified gen p mean: 0.4503204822540283, gen p mean: -0.11153648793697357, mean p set: 0.4508955478668213
loss_pred:0.014501498080790043, decouple_loss:0.0005025226273573935
Iteration: 1810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520072638988495, gen p mean: -0.10884185880422592, mean p set: 0.4525846242904663
loss_pred:0.015113051049411297, decouple_loss:0.00042058018152602017
The modified gen p mean: 0.45100486278533936, gen p mean: -0.10871893912553787, mean p set: 0.4515817165374756
The modified gen p mean: 0.4503510892391205, gen p mean: -0.11863706260919571, mean p set: 0.4509281814098358
loss_pred:0.014975963160395622, decouple_loss:0.0004960565711371601
loss_pred:0.014758889563381672, decouple_loss:0.00037526144296862185
2023-05-02 10:07:32 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1224251389503479, mean p set: 0.4502691626548767
loss_pred:0.01692548580467701, decouple_loss:0.0006414818344637752
The modified gen p mean: 0.4495360255241394, gen p mean: -0.11630363017320633, mean p set: 0.4500633478164673
loss_pred:0.016305427998304367, decouple_loss:0.0005181208252906799
The modified gen p mean: 0.44982725381851196, gen p mean: -0.11520014703273773, mean p set: 0.45035696029663086
loss_pred:0.01654297672212124, decouple_loss:0.000503971241414547
WV_1_PC_1_EH_0_PS_40, loss: 0.01661902293562889, avg_mse: 0.025921324267983437
current test mse: 0.025921
Iteration: 1811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45272788405418396, gen p mean: -0.10788879543542862, mean p set: 0.4533045291900635
loss_pred:0.014188338071107864, decouple_loss:0.0004390827671159059
The modified gen p mean: 0.4504830837249756, gen p mean: -0.10749446600675583, mean p set: 0.4510599374771118
loss_pred:0.01460196077823639, decouple_loss:0.0004706487525254488
The modified gen p mean: 0.45037227869033813, gen p mean: -0.10916841775178909, mean p set: 0.45094895362854004
loss_pred:0.014603232964873314, decouple_loss:0.00036435038782656193
Iteration: 1812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45149552822113037, gen p mean: -0.10848774760961533, mean p set: 0.4520733654499054
loss_pred:0.014821705408394337, decouple_loss:0.0004572104662656784
The modified gen p mean: 0.4509267508983612, gen p mean: -0.1032167375087738, mean p set: 0.45150282979011536The modified gen p mean: 0.4511220157146454, gen p mean: -0.1022333949804306, mean p set: 0.45169830322265625
loss_pred:0.014834091998636723, decouple_loss:0.0005611747619695961loss_pred:0.014307264238595963, decouple_loss:0.0005082788411527872
Iteration: 1813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45211002230644226, gen p mean: -0.10880934447050095, mean p set: 0.45268896222114563
loss_pred:0.01407326478511095, decouple_loss:0.000417134229792282
The modified gen p mean: 0.4507299065589905, gen p mean: -0.10776703804731369, mean p set: 0.45130568742752075
loss_pred:0.01479522418230772, decouple_loss:0.0003872828674502671
The modified gen p mean: 0.45070964097976685, gen p mean: -0.10601897537708282, mean p set: 0.45128652453422546
loss_pred:0.014833703637123108, decouple_loss:0.0004653754585888237
Iteration: 1814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511023461818695, gen p mean: -0.10759831964969635, mean p set: 0.4516802132129669
loss_pred:0.014039846137166023, decouple_loss:0.0006561442278325558
The modified gen p mean: 0.450979620218277, gen p mean: -0.10921844094991684, mean p set: 0.45155444741249084
loss_pred:0.014688000082969666, decouple_loss:0.0003525224165059626
The modified gen p mean: 0.45136165618896484, gen p mean: -0.10485002398490906, mean p set: 0.4519391357898712
loss_pred:0.014263666234910488, decouple_loss:0.0005956419045105577
Iteration: 1815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45119616389274597, gen p mean: -0.10967626422643661, mean p set: 0.45177337527275085
loss_pred:0.014737160876393318, decouple_loss:0.0005633190157823265
The modified gen p mean: 0.4505923390388489, gen p mean: -0.10655968636274338, mean p set: 0.45116788148880005
loss_pred:0.015178789384663105, decouple_loss:0.0004942248924635351
The modified gen p mean: 0.4517326056957245, gen p mean: -0.10777589678764343, mean p set: 0.4523092210292816
loss_pred:0.014312325045466423, decouple_loss:0.0006130327237769961
Iteration: 1816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45309826731681824, gen p mean: -0.1096477136015892, mean p set: 0.45367616415023804
loss_pred:0.0152042331174016, decouple_loss:0.0005209023947827518
The modified gen p mean: 0.45245814323425293, gen p mean: -0.11098452657461166, mean p set: 0.45303553342819214
The modified gen p mean: 0.4502091705799103, gen p mean: -0.11704910546541214, mean p set: 0.450788289308548
loss_pred:0.014386670663952827, decouple_loss:0.0003764069697353989
loss_pred:0.014526030980050564, decouple_loss:0.00043826387263834476
Iteration: 1817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513775706291199, gen p mean: -0.11099283397197723, mean p set: 0.4519527554512024
loss_pred:0.014478955417871475, decouple_loss:0.0005817891214974225
The modified gen p mean: 0.45253312587738037, gen p mean: -0.11377019435167313, mean p set: 0.45310890674591064
The modified gen p mean: 0.45076316595077515, gen p mean: -0.11726091057062149, mean p set: 0.45134058594703674
loss_pred:0.014576606452465057, decouple_loss:0.0005927513702772558
loss_pred:0.014279958792030811, decouple_loss:0.0003597652539610863
Iteration: 1818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45094072818756104, gen p mean: -0.11328139156103134, mean p set: 0.4515168070793152
The modified gen p mean: 0.4527773857116699, gen p mean: -0.11391348391771317, mean p set: 0.45335304737091064
loss_pred:0.014659957028925419, decouple_loss:0.0004233039217069745
loss_pred:0.015242371708154678, decouple_loss:0.00044948444701731205
The modified gen p mean: 0.44977229833602905, gen p mean: -0.11374792456626892, mean p set: 0.45034632086753845
loss_pred:0.014798391610383987, decouple_loss:0.0007062937947921455
Iteration: 1819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45160502195358276, gen p mean: -0.11132349818944931, mean p set: 0.45218244194984436
loss_pred:0.014646481722593307, decouple_loss:0.0004200857656542212
The modified gen p mean: 0.4517451524734497, gen p mean: -0.11377078294754028, mean p set: 0.4523225724697113
The modified gen p mean: 0.44986218214035034, gen p mean: -0.1133127361536026, mean p set: 0.45044055581092834
loss_pred:0.014179429970681667, decouple_loss:0.0005233128904365003
loss_pred:0.015039063058793545, decouple_loss:0.00037572329165413976
Iteration: 1820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517190456390381, gen p mean: -0.10869426280260086, mean p set: 0.45229440927505493
loss_pred:0.01501868013292551, decouple_loss:0.0005515199154615402
The modified gen p mean: 0.4517286419868469, gen p mean: -0.11223236471414566, mean p set: 0.4523046314716339
loss_pred:0.014840904623270035, decouple_loss:0.0005465408321470022
The modified gen p mean: 0.44998836517333984, gen p mean: -0.11316248029470444, mean p set: 0.4505651295185089
loss_pred:0.014446885325014591, decouple_loss:0.0003019568684976548
2023-05-02 10:09:38 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12434116750955582, mean p set: 0.4502691626548767
loss_pred:0.016920194029808044, decouple_loss:0.0004228974285069853
The modified gen p mean: 0.44953587651252747, gen p mean: -0.11769940704107285, mean p set: 0.4500633478164673
loss_pred:0.01627061329782009, decouple_loss:0.00045394766493700445
The modified gen p mean: 0.44982975721359253, gen p mean: -0.11660049855709076, mean p set: 0.45035696029663086
loss_pred:0.016474757343530655, decouple_loss:0.0005196812562644482
WV_1_PC_1_EH_0_PS_40, loss: 0.016578463837504387, avg_mse: 0.02585754171013832
current test mse: 0.025858
Iteration: 1821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44985464215278625, gen p mean: -0.10949067771434784, mean p set: 0.45042940974235535
loss_pred:0.0149435019120574, decouple_loss:0.0005149950738996267
The modified gen p mean: 0.44963350892066956, gen p mean: -0.11194732785224915, mean p set: 0.4502086043357849
loss_pred:0.014377693645656109, decouple_loss:0.00036576675483956933
The modified gen p mean: 0.45191532373428345, gen p mean: -0.10824070125818253, mean p set: 0.4524940252304077
loss_pred:0.01404570508748293, decouple_loss:0.00042565775220282376
Iteration: 1822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511876404285431, gen p mean: -0.11032982915639877, mean p set: 0.45176488161087036
loss_pred:0.014607316814363003, decouple_loss:0.0006458936259150505
The modified gen p mean: 0.4511682093143463, gen p mean: -0.11267374455928802, mean p set: 0.4517459571361542The modified gen p mean: 0.4491841793060303, gen p mean: -0.10916592180728912, mean p set: 0.4497600495815277
loss_pred:0.014996270649135113, decouple_loss:0.00039870955515652895
loss_pred:0.01465592160820961, decouple_loss:0.0005832167225889862
Iteration: 1823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517934322357178, gen p mean: -0.10667478293180466, mean p set: 0.4523712396621704
loss_pred:0.01487158052623272, decouple_loss:0.00047287033521570265
The modified gen p mean: 0.45193544030189514, gen p mean: -0.10757216811180115, mean p set: 0.45251214504241943
loss_pred:0.014574788510799408, decouple_loss:0.000524514471180737
The modified gen p mean: 0.45051997900009155, gen p mean: -0.11336709558963776, mean p set: 0.45109736919403076
loss_pred:0.014174949377775192, decouple_loss:0.0005634286790154874
Iteration: 1824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517935812473297, gen p mean: -0.10988521575927734, mean p set: 0.4523715376853943
loss_pred:0.014040451496839523, decouple_loss:0.0005953915533609688
The modified gen p mean: 0.450672447681427, gen p mean: -0.10542077571153641, mean p set: 0.45124995708465576
loss_pred:0.01417966652661562, decouple_loss:0.000436195929069072
The modified gen p mean: 0.450131893157959, gen p mean: -0.10968217253684998, mean p set: 0.4507088363170624
loss_pred:0.01470501534640789, decouple_loss:0.0003895788686349988
Iteration: 1825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45106613636016846, gen p mean: -0.10665439069271088, mean p set: 0.45164093375205994
loss_pred:0.013921191915869713, decouple_loss:0.0004886037786491215
The modified gen p mean: 0.451225221157074, gen p mean: -0.10362821817398071, mean p set: 0.4518023431301117
loss_pred:0.014178632758557796, decouple_loss:0.0006413962692022324
The modified gen p mean: 0.45047199726104736, gen p mean: -0.10867787152528763, mean p set: 0.45104846358299255
loss_pred:0.014082680456340313, decouple_loss:0.0003940588212572038
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
NaN value num: 0
Iteration: 1826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853726029396057, gen p mean: -0.10781601071357727, mean p set: 0.44911229610443115
loss_pred:0.015087033621966839, decouple_loss:0.00042587073403410614
The modified gen p mean: 0.44953253865242004, gen p mean: -0.11309278756380081, mean p set: 0.45010754466056824
The modified gen p mean: 0.4489828944206238, gen p mean: -0.10924726724624634, mean p set: 0.4495586156845093
loss_pred:0.015421014279127121, decouple_loss:0.0003976564621552825
loss_pred:0.016098840162158012, decouple_loss:0.0004357174038887024
Iteration: 1827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792440533638, gen p mean: -0.11237315833568573, mean p set: 0.44850265979766846
loss_pred:0.014971236698329449, decouple_loss:0.000582791690248996
The modified gen p mean: 0.44895344972610474, gen p mean: -0.10971992462873459, mean p set: 0.44952985644340515
The modified gen p mean: 0.4487628936767578, gen p mean: -0.11403788626194, mean p set: 0.4493407607078552
loss_pred:0.015153459273278713, decouple_loss:0.0004261514695826918
loss_pred:0.015752647072076797, decouple_loss:0.0005214926204644144
Iteration: 1828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490600526332855, gen p mean: -0.11640939861536026, mean p set: 0.44963738322257996
loss_pred:0.015475587919354439, decouple_loss:0.0004306374758016318
The modified gen p mean: 0.44896671175956726, gen p mean: -0.11560886353254318, mean p set: 0.4495418667793274
The modified gen p mean: 0.44926586747169495, gen p mean: -0.11111907660961151, mean p set: 0.44983911514282227
loss_pred:0.015358677133917809, decouple_loss:0.00042557049891911447
loss_pred:0.014946604147553444, decouple_loss:0.0003948118828702718
Iteration: 1829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497835636138916, gen p mean: -0.10964466631412506, mean p set: 0.450359970331192
loss_pred:0.01450490765273571, decouple_loss:0.00040563452057540417
The modified gen p mean: 0.4482053816318512, gen p mean: -0.11585604399442673, mean p set: 0.4487801790237427
loss_pred:0.01464137714356184, decouple_loss:0.0004181347321718931
The modified gen p mean: 0.45024749636650085, gen p mean: -0.11320606619119644, mean p set: 0.45082634687423706
loss_pred:0.014637602493166924, decouple_loss:0.0004221248091198504
Iteration: 1830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492930471897125, gen p mean: -0.1155296340584755, mean p set: 0.4498702585697174
loss_pred:0.015789251774549484, decouple_loss:0.0004198150127194822
The modified gen p mean: 0.44954028725624084, gen p mean: -0.10934163630008698, mean p set: 0.4501173794269562
loss_pred:0.015287351794540882, decouple_loss:0.0004925416433252394
The modified gen p mean: 0.44845065474510193, gen p mean: -0.11437997221946716, mean p set: 0.44902974367141724
loss_pred:0.015408704988658428, decouple_loss:0.0006113688577897847
2023-05-02 10:12:25 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12193737924098969, mean p set: 0.4502691626548767
loss_pred:0.016814207658171654, decouple_loss:0.00041618917020969093
The modified gen p mean: 0.44953376054763794, gen p mean: -0.11544054001569748, mean p set: 0.4500633478164673
loss_pred:0.01618381030857563, decouple_loss:0.0004603028064593673
The modified gen p mean: 0.4498286843299866, gen p mean: -0.11446178704500198, mean p set: 0.45035696029663086
loss_pred:0.01639777235686779, decouple_loss:0.0005968476762063801
WV_1_PC_1_EH_0_PS_40, loss: 0.016489818692207336, avg_mse: 0.025780191645026207
current test mse: 0.02578
Iteration: 1831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494965374469757, gen p mean: -0.11927443742752075, mean p set: 0.4500705897808075
loss_pred:0.014494034461677074, decouple_loss:0.00040515000000596046
The modified gen p mean: 0.4507327377796173, gen p mean: -0.11326391994953156, mean p set: 0.45131051540374756The modified gen p mean: 0.4503227770328522, gen p mean: -0.11284583061933517, mean p set: 0.45089972019195557
loss_pred:0.016320757567882538, decouple_loss:0.00043679424561560154loss_pred:0.01524696871638298, decouple_loss:0.00036958116106688976
Iteration: 1832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824519753456116, gen p mean: -0.11385419219732285, mean p set: 0.4488218426704407
loss_pred:0.01613127440214157, decouple_loss:0.00044826962403021753
The modified gen p mean: 0.4498399496078491, gen p mean: -0.11184729635715485, mean p set: 0.45041564106941223
The modified gen p mean: 0.4488065838813782, gen p mean: -0.11490999162197113, mean p set: 0.44938161969184875
loss_pred:0.0149243688210845, decouple_loss:0.0004693779337685555
loss_pred:0.014562011696398258, decouple_loss:0.0004663907166104764
Iteration: 1833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930970668792725, gen p mean: -0.11746305972337723, mean p set: 0.44988682866096497
loss_pred:0.015205484814941883, decouple_loss:0.00044167650048621
The modified gen p mean: 0.4495282769203186, gen p mean: -0.12183456867933273, mean p set: 0.4501064419746399
loss_pred:0.014711886644363403, decouple_loss:0.0004989597946405411
The modified gen p mean: 0.4475349485874176, gen p mean: -0.11761488765478134, mean p set: 0.4481101632118225
loss_pred:0.014761397615075111, decouple_loss:0.0007040785858407617
Iteration: 1834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485907256603241, gen p mean: -0.11871428042650223, mean p set: 0.44916728138923645
loss_pred:0.014287983067333698, decouple_loss:0.0005391722661443055
The modified gen p mean: 0.44998130202293396, gen p mean: -0.12007641792297363, mean p set: 0.4505566358566284
loss_pred:0.01474652998149395, decouple_loss:0.0003835892421193421
The modified gen p mean: 0.45012378692626953, gen p mean: -0.1150379329919815, mean p set: 0.45070016384124756
loss_pred:0.014696423895657063, decouple_loss:0.0003533822891768068
Iteration: 1835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44845396280288696, gen p mean: -0.11407136917114258, mean p set: 0.4490301311016083
loss_pred:0.014680180698633194, decouple_loss:0.000397035590140149
The modified gen p mean: 0.4487735629081726, gen p mean: -0.12071377784013748, mean p set: 0.449349045753479
loss_pred:0.015765706077218056, decouple_loss:0.00040399370482191443
The modified gen p mean: 0.45021384954452515, gen p mean: -0.12207421660423279, mean p set: 0.45079004764556885
loss_pred:0.01498959306627512, decouple_loss:0.0004022317589260638
Iteration: 1836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449049711227417, gen p mean: -0.11404680460691452, mean p set: 0.4496253430843353
loss_pred:0.014524984173476696, decouple_loss:0.00048193297698162496
The modified gen p mean: 0.4498800039291382, gen p mean: -0.12087739259004593, mean p set: 0.4504591226577759
The modified gen p mean: 0.44917112588882446, gen p mean: -0.11221656203269958, mean p set: 0.4497474730014801
loss_pred:0.01472594402730465, decouple_loss:0.0004429596592672169
loss_pred:0.015156549401581287, decouple_loss:0.0004903266672044992
Iteration: 1837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493025839328766, gen p mean: -0.11401326209306717, mean p set: 0.4498787224292755
loss_pred:0.014126390218734741, decouple_loss:0.00036563421599566936
The modified gen p mean: 0.4506099820137024, gen p mean: -0.11271744221448898, mean p set: 0.4511880874633789
loss_pred:0.015462614595890045, decouple_loss:0.0004701339057646692
The modified gen p mean: 0.4489094316959381, gen p mean: -0.1168350800871849, mean p set: 0.44948363304138184
loss_pred:0.01492482703179121, decouple_loss:0.00036394852213561535
Iteration: 1838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447877436876297, gen p mean: -0.11714810132980347, mean p set: 0.4484533667564392
The modified gen p mean: 0.44787317514419556, gen p mean: -0.11889032274484634, mean p set: 0.44845086336135864
loss_pred:0.015556233003735542, decouple_loss:0.0003957937005907297
loss_pred:0.015688123181462288, decouple_loss:0.0003569569089449942
The modified gen p mean: 0.44957488775253296, gen p mean: -0.1198934018611908, mean p set: 0.45015186071395874
loss_pred:0.01614667847752571, decouple_loss:0.00040309145697392523
Iteration: 1839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45009690523147583, gen p mean: -0.12214237451553345, mean p set: 0.45067599415779114
loss_pred:0.014625033363699913, decouple_loss:0.0004647838941309601
The modified gen p mean: 0.44947442412376404, gen p mean: -0.12067577242851257, mean p set: 0.4500495493412018
The modified gen p mean: 0.44978389143943787, gen p mean: -0.11801502108573914, mean p set: 0.4503614604473114
loss_pred:0.015312871895730495, decouple_loss:0.0004234937659930438
loss_pred:0.014747549779713154, decouple_loss:0.0004938927013427019
Iteration: 1840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774261116981506, gen p mean: -0.11859556287527084, mean p set: 0.44831863045692444
loss_pred:0.015660172328352928, decouple_loss:0.0005887664156034589
The modified gen p mean: 0.4491509199142456, gen p mean: -0.11214624345302582, mean p set: 0.44972777366638184
loss_pred:0.014948703348636627, decouple_loss:0.00037022540345788
The modified gen p mean: 0.44763636589050293, gen p mean: -0.11789485812187195, mean p set: 0.44821181893348694
loss_pred:0.014757581055164337, decouple_loss:0.0004678049881476909
2023-05-02 10:14:32 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12639504671096802, mean p set: 0.4502691626548767
loss_pred:0.0168452225625515, decouple_loss:0.0004044845700263977
The modified gen p mean: 0.4495340883731842, gen p mean: -0.11999846994876862, mean p set: 0.4500633478164673
loss_pred:0.016202282160520554, decouple_loss:0.00044328407966531813
The modified gen p mean: 0.449828177690506, gen p mean: -0.1192827820777893, mean p set: 0.45035696029663086
loss_pred:0.016385456547141075, decouple_loss:0.0004821170587092638
WV_1_PC_1_EH_0_PS_40, loss: 0.016499817371368408, avg_mse: 0.02583322674036026
current test mse: 0.025833
Iteration: 1841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023593306541443, gen p mean: -0.12247160077095032, mean p set: 0.450813353061676
The modified gen p mean: 0.4481436610221863, gen p mean: -0.1192232221364975, mean p set: 0.4487202763557434
loss_pred:0.014855880290269852, decouple_loss:0.00040656866622157395
loss_pred:0.014363149181008339, decouple_loss:0.0003937372821383178
The modified gen p mean: 0.44951382279396057, gen p mean: -0.11916552484035492, mean p set: 0.4500916600227356
loss_pred:0.014512880705296993, decouple_loss:0.0004263872397132218
Iteration: 1842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479936361312866, gen p mean: -0.11814838647842407, mean p set: 0.4485691785812378
loss_pred:0.014672116376459599, decouple_loss:0.0003940483438782394
The modified gen p mean: 0.4509678781032562, gen p mean: -0.12011198699474335, mean p set: 0.4515438675880432The modified gen p mean: 0.45000264048576355, gen p mean: -0.11437484622001648, mean p set: 0.45058029890060425
loss_pred:0.0161751676350832, decouple_loss:0.0004652744100894779
loss_pred:0.015377231873571873, decouple_loss:0.0005116784013807774
Iteration: 1843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499019980430603, gen p mean: -0.12106651812791824, mean p set: 0.4504770338535309
loss_pred:0.014690317213535309, decouple_loss:0.00032373424619436264
The modified gen p mean: 0.45019668340682983, gen p mean: -0.12355832755565643, mean p set: 0.4507721960544586
The modified gen p mean: 0.44998785853385925, gen p mean: -0.11964293569326401, mean p set: 0.4505636692047119
loss_pred:0.01480927411466837, decouple_loss:0.0003986986412201077loss_pred:0.014984006993472576, decouple_loss:0.0003643612435553223
Iteration: 1844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495079815387726, gen p mean: -0.11886727064847946, mean p set: 0.4500848054885864
loss_pred:0.015862170606851578, decouple_loss:0.0003378073452040553
The modified gen p mean: 0.449093759059906, gen p mean: -0.12350007891654968, mean p set: 0.44967490434646606
loss_pred:0.014185898937284946, decouple_loss:0.0003446199407335371
The modified gen p mean: 0.44758841395378113, gen p mean: -0.11942921578884125, mean p set: 0.44816452264785767
loss_pred:0.015575087629258633, decouple_loss:0.0003520025929901749
Iteration: 1845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44920456409454346, gen p mean: -0.1193673312664032, mean p set: 0.4497811496257782
loss_pred:0.015832584351301193, decouple_loss:0.0003761377010960132
The modified gen p mean: 0.4489845335483551, gen p mean: -0.12030010670423508, mean p set: 0.4495590031147003
loss_pred:0.014913174323737621, decouple_loss:0.00035785502404905856
The modified gen p mean: 0.44990459084510803, gen p mean: -0.12443342059850693, mean p set: 0.450480192899704
loss_pred:0.015347513370215893, decouple_loss:0.0004457393370103091
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
NaN value num: 0
Iteration: 1846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450784295797348, gen p mean: -0.11760822683572769, mean p set: 0.45136159658432007The modified gen p mean: 0.45170673727989197, gen p mean: -0.11061828583478928, mean p set: 0.452282190322876
loss_pred:0.01467941515147686, decouple_loss:0.00048435464850626886loss_pred:0.014846613630652428, decouple_loss:0.0004875985032413155
The modified gen p mean: 0.4498445391654968, gen p mean: -0.12135632336139679, mean p set: 0.4504196047782898
loss_pred:0.014323597773909569, decouple_loss:0.0004950466100126505
Iteration: 1847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4548676013946533, gen p mean: -0.1190466359257698, mean p set: 0.45544660091400146
loss_pred:0.015143243595957756, decouple_loss:0.00033461666316725314
The modified gen p mean: 0.45062193274497986, gen p mean: -0.1137503907084465, mean p set: 0.4511997699737549
The modified gen p mean: 0.4520190358161926, gen p mean: -0.11280851811170578, mean p set: 0.45259830355644226
loss_pred:0.015086375176906586, decouple_loss:0.0004750900552608073
loss_pred:0.015692993998527527, decouple_loss:0.0006109827663749456
Iteration: 1848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45291101932525635, gen p mean: -0.11440753936767578, mean p set: 0.453487753868103
loss_pred:0.01561778038740158, decouple_loss:0.00036114073009230196
The modified gen p mean: 0.45169490575790405, gen p mean: -0.10730385780334473, mean p set: 0.45227164030075073
loss_pred:0.01613929495215416, decouple_loss:0.0004593620542436838
The modified gen p mean: 0.45186638832092285, gen p mean: -0.11272994428873062, mean p set: 0.4524429440498352
loss_pred:0.014407896436750889, decouple_loss:0.0005317505565471947
Iteration: 1849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509022533893585, gen p mean: -0.11452329903841019, mean p set: 0.45147937536239624
loss_pred:0.014809462241828442, decouple_loss:0.0007124030380509794
The modified gen p mean: 0.45197227597236633, gen p mean: -0.1107531487941742, mean p set: 0.45254963636398315
The modified gen p mean: 0.4530618488788605, gen p mean: -0.11660506576299667, mean p set: 0.45363950729370117
loss_pred:0.015932513400912285, decouple_loss:0.0006057820864953101
loss_pred:0.01507448311895132, decouple_loss:0.0004968663561157882
Iteration: 1850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511827528476715, gen p mean: -0.11449289321899414, mean p set: 0.45175933837890625
loss_pred:0.014402647502720356, decouple_loss:0.00044706129119731486
The modified gen p mean: 0.4531053602695465, gen p mean: -0.12473239749670029, mean p set: 0.4536832273006439
The modified gen p mean: 0.4500458538532257, gen p mean: -0.11663210391998291, mean p set: 0.4506206214427948
loss_pred:0.014994196593761444, decouple_loss:0.0007728602504357696
loss_pred:0.014132944867014885, decouple_loss:0.0004689226334448904
2023-05-02 10:17:18 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13020287454128265, mean p set: 0.4502691626548767
loss_pred:0.016904328018426895, decouple_loss:0.000412943831179291
The modified gen p mean: 0.4495362341403961, gen p mean: -0.12376859784126282, mean p set: 0.4500633478164673
loss_pred:0.016271473839879036, decouple_loss:0.0004417449817992747
The modified gen p mean: 0.4498280882835388, gen p mean: -0.12256839126348495, mean p set: 0.45035696029663086
loss_pred:0.0164842177182436, decouple_loss:0.0005290675908327103
WV_1_PC_1_EH_0_PS_40, loss: 0.016576401889324188, avg_mse: 0.025928663089871407
current test mse: 0.025929
Iteration: 1851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45186012983322144, gen p mean: -0.11614914983510971, mean p set: 0.4524341821670532
loss_pred:0.014707963913679123, decouple_loss:0.0004037337494082749
The modified gen p mean: 0.4503270387649536, gen p mean: -0.11872569471597672, mean p set: 0.45090195536613464
loss_pred:0.01522486750036478, decouple_loss:0.0004971244488842785
The modified gen p mean: 0.4513614773750305, gen p mean: -0.11850254982709885, mean p set: 0.451936274766922
loss_pred:0.015692956745624542, decouple_loss:0.0005138770793564618
Iteration: 1852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45340394973754883, gen p mean: -0.11707387864589691, mean p set: 0.45397984981536865
loss_pred:0.014186318963766098, decouple_loss:0.00048072211211547256
The modified gen p mean: 0.4536586403846741, gen p mean: -0.11757666617631912, mean p set: 0.4542378783226013The modified gen p mean: 0.4495008885860443, gen p mean: -0.1145702451467514, mean p set: 0.4500764310359955
loss_pred:0.015476821921765804, decouple_loss:0.0004975355695933104
loss_pred:0.015438580885529518, decouple_loss:0.0006822262657806277
Iteration: 1853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45297709107398987, gen p mean: -0.12353888899087906, mean p set: 0.4535527229309082
loss_pred:0.016664067283272743, decouple_loss:0.0005200353916734457
The modified gen p mean: 0.4533000588417053, gen p mean: -0.11568235605955124, mean p set: 0.4538773000240326
loss_pred:0.016322916373610497, decouple_loss:0.00043931399704888463
The modified gen p mean: 0.45203033089637756, gen p mean: -0.11966372281312943, mean p set: 0.4526059925556183
loss_pred:0.016343075782060623, decouple_loss:0.0005184733890928328
Iteration: 1854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536518454551697, gen p mean: -0.11827243119478226, mean p set: 0.45422741770744324
loss_pred:0.01541142351925373, decouple_loss:0.00047378017916344106
The modified gen p mean: 0.452481210231781, gen p mean: -0.1194457933306694, mean p set: 0.4530578553676605
loss_pred:0.016792671754956245, decouple_loss:0.0005880726967006922
The modified gen p mean: 0.4528394043445587, gen p mean: -0.11399316787719727, mean p set: 0.4534182846546173
loss_pred:0.016131818294525146, decouple_loss:0.0005028840387240052
Iteration: 1855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45229849219322205, gen p mean: -0.11785422265529633, mean p set: 0.45287883281707764
loss_pred:0.014022803865373135, decouple_loss:0.00046555648441426456
The modified gen p mean: 0.45263513922691345, gen p mean: -0.12079460918903351, mean p set: 0.4532114863395691
loss_pred:0.015237532556056976, decouple_loss:0.0005503036081790924
The modified gen p mean: 0.452989786863327, gen p mean: -0.1241406723856926, mean p set: 0.4535693824291229
loss_pred:0.014734376221895218, decouple_loss:0.0005730557022616267
Iteration: 1856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45334672927856445, gen p mean: -0.12292356044054031, mean p set: 0.4539260268211365
loss_pred:0.014729969203472137, decouple_loss:0.0005626819329336286
The modified gen p mean: 0.45308947563171387, gen p mean: -0.11517517268657684, mean p set: 0.45366615056991577
The modified gen p mean: 0.45075562596321106, gen p mean: -0.11363538354635239, mean p set: 0.4513308107852936
loss_pred:0.016306167468428612, decouple_loss:0.0004966720589436591
loss_pred:0.015249054878950119, decouple_loss:0.0003740160900633782
Iteration: 1857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4547683000564575, gen p mean: -0.11894069612026215, mean p set: 0.45534548163414
loss_pred:0.014536108821630478, decouple_loss:0.0005972959916107357
The modified gen p mean: 0.44954365491867065, gen p mean: -0.11836042255163193, mean p set: 0.45011797547340393
The modified gen p mean: 0.45298275351524353, gen p mean: -0.11943969875574112, mean p set: 0.45355919003486633
loss_pred:0.014413903467357159, decouple_loss:0.0004405211948323995
loss_pred:0.016900794580578804, decouple_loss:0.0005313932779245079
Iteration: 1858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531969130039215, gen p mean: -0.11389261484146118, mean p set: 0.4537713825702667
loss_pred:0.015230541117489338, decouple_loss:0.0004668559122364968
The modified gen p mean: 0.45045697689056396, gen p mean: -0.1137494221329689, mean p set: 0.4510316848754883
loss_pred:0.014752351678907871, decouple_loss:0.0003973454877268523
The modified gen p mean: 0.450155645608902, gen p mean: -0.11345437914133072, mean p set: 0.4507310390472412
loss_pred:0.015622872859239578, decouple_loss:0.00038453246816061437
Iteration: 1859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45325130224227905, gen p mean: -0.10886984318494797, mean p set: 0.4538283348083496
loss_pred:0.015969514846801758, decouple_loss:0.0004376093565952033
The modified gen p mean: 0.45031964778900146, gen p mean: -0.1081496998667717, mean p set: 0.4508957266807556
The modified gen p mean: 0.451108455657959, gen p mean: -0.10547733306884766, mean p set: 0.45168498158454895
loss_pred:0.014780859462916851, decouple_loss:0.00041477111517451704
loss_pred:0.015478056855499744, decouple_loss:0.0004381472244858742
Iteration: 1860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4540702998638153, gen p mean: -0.10968448221683502, mean p set: 0.454647958278656
loss_pred:0.014715902507305145, decouple_loss:0.00044123255065642297
The modified gen p mean: 0.4495100975036621, gen p mean: -0.11716535687446594, mean p set: 0.4500868618488312
The modified gen p mean: 0.45395177602767944, gen p mean: -0.11015569418668747, mean p set: 0.4545283913612366
loss_pred:0.01407552883028984, decouple_loss:0.000606522720772773
loss_pred:0.014127488248050213, decouple_loss:0.0004751624946948141
2023-05-02 10:19:25 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12590838968753815, mean p set: 0.4502691626548767
loss_pred:0.016884077340364456, decouple_loss:0.00045213804696686566
The modified gen p mean: 0.44953569769859314, gen p mean: -0.11931063234806061, mean p set: 0.4500633478164673
loss_pred:0.01627718284726143, decouple_loss:0.00040516952867619693
The modified gen p mean: 0.4498283863067627, gen p mean: -0.11866645514965057, mean p set: 0.45035696029663086
loss_pred:0.016451425850391388, decouple_loss:0.0004916888428851962
WV_1_PC_1_EH_0_PS_40, loss: 0.01656004600226879, avg_mse: 0.025845667347311974
current test mse: 0.025846
Iteration: 1861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45011812448501587, gen p mean: -0.11584684997797012, mean p set: 0.4506944417953491
loss_pred:0.015571247786283493, decouple_loss:0.00038980008685030043
The modified gen p mean: 0.4497864246368408, gen p mean: -0.1128963977098465, mean p set: 0.4503626525402069The modified gen p mean: 0.4517991542816162, gen p mean: -0.11192446202039719, mean p set: 0.4523768723011017
loss_pred:0.01486631017178297, decouple_loss:0.0004483650263864547
loss_pred:0.013998099602758884, decouple_loss:0.0003742628905456513
Iteration: 1862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45282411575317383, gen p mean: -0.11740825325250626, mean p set: 0.4534010887145996
loss_pred:0.015279093757271767, decouple_loss:0.0005046026199124753
The modified gen p mean: 0.45207473635673523, gen p mean: -0.1166890487074852, mean p set: 0.452653169631958The modified gen p mean: 0.45135489106178284, gen p mean: -0.11945632100105286, mean p set: 0.4519317150115967
loss_pred:0.01610432006418705, decouple_loss:0.0004913524608127773
loss_pred:0.016254039481282234, decouple_loss:0.0005187774077057838
Iteration: 1863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518060088157654, gen p mean: -0.11480862647294998, mean p set: 0.45238202810287476
loss_pred:0.014052792452275753, decouple_loss:0.000464605021988973
The modified gen p mean: 0.4527772068977356, gen p mean: -0.12322172522544861, mean p set: 0.4533534646034241
loss_pred:0.015257686376571655, decouple_loss:0.0004750180523842573
The modified gen p mean: 0.45229336619377136, gen p mean: -0.11041617393493652, mean p set: 0.45286890864372253
loss_pred:0.01683969236910343, decouple_loss:0.000522702350281179
Iteration: 1864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45030882954597473, gen p mean: -0.11848349124193192, mean p set: 0.4508844316005707
loss_pred:0.014331252314150333, decouple_loss:0.0004249142075423151
The modified gen p mean: 0.45143938064575195, gen p mean: -0.1141492947936058, mean p set: 0.4520170986652374
loss_pred:0.015933383256196976, decouple_loss:0.000415377551689744
The modified gen p mean: 0.4505109190940857, gen p mean: -0.11589445918798447, mean p set: 0.4510881304740906
loss_pred:0.014994760975241661, decouple_loss:0.0004881752247456461
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 1865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470176100730896, gen p mean: -0.12601423263549805, mean p set: 0.4475933611392975
loss_pred:0.015673557296395302, decouple_loss:0.00043344227015040815
The modified gen p mean: 0.4465937912464142, gen p mean: -0.1281033605337143, mean p set: 0.4471684396266937
The modified gen p mean: 0.44754907488822937, gen p mean: -0.12639617919921875, mean p set: 0.44812917709350586
loss_pred:0.01566278375685215, decouple_loss:0.0004286730254534632
loss_pred:0.01563628390431404, decouple_loss:0.00043968172394670546
Iteration: 1866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487319588661194, gen p mean: -0.14267225563526154, mean p set: 0.449308842420578
loss_pred:0.015232812613248825, decouple_loss:0.0005222736508585513
The modified gen p mean: 0.44898322224617004, gen p mean: -0.13024461269378662, mean p set: 0.4495594799518585
loss_pred:0.015341406688094139, decouple_loss:0.0005552059737965465
The modified gen p mean: 0.44794753193855286, gen p mean: -0.13423369824886322, mean p set: 0.4485217034816742
loss_pred:0.015458907000720501, decouple_loss:0.0005336012691259384
Iteration: 1867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475991725921631, gen p mean: -0.12043529748916626, mean p set: 0.4481755197048187
loss_pred:0.01786825805902481, decouple_loss:0.000516280997544527
The modified gen p mean: 0.44740647077560425, gen p mean: -0.11269379407167435, mean p set: 0.44798195362091064
loss_pred:0.018145453184843063, decouple_loss:0.0005509373731911182
The modified gen p mean: 0.44953328371047974, gen p mean: -0.11665090173482895, mean p set: 0.45010778307914734
loss_pred:0.01768738031387329, decouple_loss:0.0005955707747489214
Iteration: 1868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787952303886414, gen p mean: -0.11778874695301056, mean p set: 0.44845467805862427
loss_pred:0.019558187574148178, decouple_loss:0.0006234326283447444
The modified gen p mean: 0.44757142663002014, gen p mean: -0.1208166629076004, mean p set: 0.44814783334732056
loss_pred:0.02024582214653492, decouple_loss:0.0007118445937521756
The modified gen p mean: 0.44798991084098816, gen p mean: -0.11467202007770538, mean p set: 0.44856393337249756
loss_pred:0.02184390462934971, decouple_loss:0.0006012203521095216
Iteration: 1869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475904703140259, gen p mean: -0.12481094896793365, mean p set: 0.4481693506240845
loss_pred:0.019604908302426338, decouple_loss:0.0007528429268859327
The modified gen p mean: 0.44758981466293335, gen p mean: -0.12929922342300415, mean p set: 0.44816869497299194
The modified gen p mean: 0.4470398426055908, gen p mean: -0.12331347167491913, mean p set: 0.4476158618927002
loss_pred:0.02029799483716488, decouple_loss:0.00071098463376984
loss_pred:0.01989901438355446, decouple_loss:0.0007398638990707695
Iteration: 1870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474821984767914, gen p mean: -0.12744022905826569, mean p set: 0.44805845618247986
loss_pred:0.01856292597949505, decouple_loss:0.0008546099415980279
The modified gen p mean: 0.4472183883190155, gen p mean: -0.13080568611621857, mean p set: 0.4477936327457428
The modified gen p mean: 0.4485348165035248, gen p mean: -0.1227756217122078, mean p set: 0.4491144120693207
loss_pred:0.01813579350709915, decouple_loss:0.0008074983488768339
loss_pred:0.01908368244767189, decouple_loss:0.000787257042247802
2023-05-02 10:22:06 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1409846842288971, mean p set: 0.4502691626548767
loss_pred:0.019911495968699455, decouple_loss:0.0008226572535932064
The modified gen p mean: 0.4495353102684021, gen p mean: -0.1322740614414215, mean p set: 0.4500633478164673
loss_pred:0.01940889097750187, decouple_loss:0.0009496664861217141
The modified gen p mean: 0.44983145594596863, gen p mean: -0.13242721557617188, mean p set: 0.45035696029663086
loss_pred:0.019811902195215225, decouple_loss:0.0008285991498269141
WV_1_PC_1_EH_0_PS_40, loss: 0.019754111766815186, avg_mse: 0.02993120811879635
current test mse: 0.029931
Iteration: 1871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844305515289307, gen p mean: -0.13085514307022095, mean p set: 0.4490176737308502
loss_pred:0.01833624206483364, decouple_loss:0.0007188029703684151
The modified gen p mean: 0.4475580155849457, gen p mean: -0.13639527559280396, mean p set: 0.44813597202301025The modified gen p mean: 0.44848376512527466, gen p mean: -0.13515187799930573, mean p set: 0.44905948638916016
loss_pred:0.018457166850566864, decouple_loss:0.0008006390416994691
loss_pred:0.01871725358068943, decouple_loss:0.0009679078939370811
Iteration: 1872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489958882331848, gen p mean: -0.13300193846225739, mean p set: 0.4495725929737091
loss_pred:0.017891939729452133, decouple_loss:0.0008723462233319879
The modified gen p mean: 0.4480340778827667, gen p mean: -0.1350012868642807, mean p set: 0.44860655069351196The modified gen p mean: 0.44725826382637024, gen p mean: -0.14026226103305817, mean p set: 0.44783204793930054
loss_pred:0.01706857979297638, decouple_loss:0.0008690768154338002
loss_pred:0.01790079101920128, decouple_loss:0.0008155684336088598
Iteration: 1873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802021980285645, gen p mean: -0.1481301337480545, mean p set: 0.4485950767993927
loss_pred:0.01775343343615532, decouple_loss:0.0008636435959488153
The modified gen p mean: 0.44853901863098145, gen p mean: -0.14423243701457977, mean p set: 0.4491148293018341
loss_pred:0.01721440814435482, decouple_loss:0.0008341032662428916
The modified gen p mean: 0.4478801488876343, gen p mean: -0.14832720160484314, mean p set: 0.44845813512802124
loss_pred:0.01697569526731968, decouple_loss:0.000959963072091341
Iteration: 1874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480568766593933, gen p mean: -0.14911213517189026, mean p set: 0.44863179326057434
loss_pred:0.017656750977039337, decouple_loss:0.0008260274771600962
The modified gen p mean: 0.4477936029434204, gen p mean: -0.14635124802589417, mean p set: 0.4483700692653656
loss_pred:0.017537521198391914, decouple_loss:0.0008660242892801762
The modified gen p mean: 0.4471786618232727, gen p mean: -0.14965924620628357, mean p set: 0.44775503873825073
loss_pred:0.01788092590868473, decouple_loss:0.000913009513169527
Iteration: 1875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764211773872375, gen p mean: -0.13350725173950195, mean p set: 0.44821614027023315
loss_pred:0.017826318740844727, decouple_loss:0.0007911387947387993
The modified gen p mean: 0.44644099473953247, gen p mean: -0.1308613419532776, mean p set: 0.44701725244522095
loss_pred:0.01767180860042572, decouple_loss:0.0009637650800868869
The modified gen p mean: 0.44819921255111694, gen p mean: -0.1289423257112503, mean p set: 0.4487749934196472
loss_pred:0.017636636272072792, decouple_loss:0.0009578786557540298
Iteration: 1876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696375727653503, gen p mean: -0.13614381849765778, mean p set: 0.44753962755203247
loss_pred:0.017039241269230843, decouple_loss:0.0008891719044186175
The modified gen p mean: 0.44706273078918457, gen p mean: -0.13076843321323395, mean p set: 0.4476364552974701
loss_pred:0.017578309401869774, decouple_loss:0.000804632727522403
The modified gen p mean: 0.44670534133911133, gen p mean: -0.1315070539712906, mean p set: 0.4472792148590088
loss_pred:0.017342813313007355, decouple_loss:0.000892968091648072
Iteration: 1877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473758935928345, gen p mean: -0.1382092535495758, mean p set: 0.4479523003101349
The modified gen p mean: 0.44769152998924255, gen p mean: -0.14322112500667572, mean p set: 0.4482676684856415
loss_pred:0.01728983409702778, decouple_loss:0.0007939195493236184
loss_pred:0.01675564795732498, decouple_loss:0.0007863979553803802
The modified gen p mean: 0.448609322309494, gen p mean: -0.14171193540096283, mean p set: 0.44918543100357056
loss_pred:0.016452964395284653, decouple_loss:0.0008178143762052059
Iteration: 1878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694942235946655, gen p mean: -0.15415945649147034, mean p set: 0.4475235044956207
loss_pred:0.016648462042212486, decouple_loss:0.0007246334571391344
The modified gen p mean: 0.44710567593574524, gen p mean: -0.15415391325950623, mean p set: 0.44768205285072327
loss_pred:0.017932947725057602, decouple_loss:0.0008070070180110633
The modified gen p mean: 0.44729459285736084, gen p mean: -0.15241533517837524, mean p set: 0.4478708505630493
loss_pred:0.016224782913923264, decouple_loss:0.0006636559846810997
Iteration: 1879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467371106147766, gen p mean: -0.16793400049209595, mean p set: 0.4473148286342621
The modified gen p mean: 0.44770753383636475, gen p mean: -0.16003841161727905, mean p set: 0.4482842683792114
loss_pred:0.016593720763921738, decouple_loss:0.0008632283424958587
loss_pred:0.016885047778487206, decouple_loss:0.0009094392298720777
The modified gen p mean: 0.4469339847564697, gen p mean: -0.16353429853916168, mean p set: 0.4475088119506836
loss_pred:0.01665159873664379, decouple_loss:0.000871132651809603
Iteration: 1880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476611614227295, gen p mean: -0.15865905582904816, mean p set: 0.44824254512786865
loss_pred:0.01689138635993004, decouple_loss:0.0007998115033842623
The modified gen p mean: 0.4470856785774231, gen p mean: -0.16246134042739868, mean p set: 0.4476613700389862
loss_pred:0.016320757567882538, decouple_loss:0.0008037262596189976
The modified gen p mean: 0.4493846893310547, gen p mean: -0.155687615275383, mean p set: 0.4499603509902954
loss_pred:0.015790779143571854, decouple_loss:0.000920552876777947
2023-05-02 10:24:10 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.16568823158740997, mean p set: 0.4502691626548767
loss_pred:0.01822161115705967, decouple_loss:0.0008322216453962028
The modified gen p mean: 0.44953444600105286, gen p mean: -0.1585843712091446, mean p set: 0.4500633478164673
loss_pred:0.017569787800312042, decouple_loss:0.0008458068477921188
The modified gen p mean: 0.449829638004303, gen p mean: -0.15746580064296722, mean p set: 0.45035696029663086
loss_pred:0.01772581785917282, decouple_loss:0.000785290147177875
WV_1_PC_1_EH_0_PS_40, loss: 0.01788012683391571, avg_mse: 0.027265720069408417
current test mse: 0.027266
Iteration: 1881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765105843544006, gen p mean: -0.15627020597457886, mean p set: 0.44822585582733154
loss_pred:0.016338830813765526, decouple_loss:0.0007025427184998989
The modified gen p mean: 0.4477541148662567, gen p mean: -0.1577838808298111, mean p set: 0.4483305513858795
The modified gen p mean: 0.44784608483314514, gen p mean: -0.1570737510919571, mean p set: 0.44842052459716797
loss_pred:0.016817530617117882, decouple_loss:0.0007957498892210424
loss_pred:0.01608315482735634, decouple_loss:0.0008390954462811351
Iteration: 1882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473109841346741, gen p mean: -0.153630793094635, mean p set: 0.4478912055492401
loss_pred:0.01672971434891224, decouple_loss:0.0010538722854107618
The modified gen p mean: 0.44801560044288635, gen p mean: -0.15897753834724426, mean p set: 0.44859078526496887The modified gen p mean: 0.44748762249946594, gen p mean: -0.15497173368930817, mean p set: 0.4480615258216858
loss_pred:0.015487059019505978, decouple_loss:0.0008200965821743011
loss_pred:0.01549548003822565, decouple_loss:0.0006298605585470796
Iteration: 1883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680556654930115, gen p mean: -0.16370950639247894, mean p set: 0.4473792016506195
loss_pred:0.0160895474255085, decouple_loss:0.0007316117989830673
The modified gen p mean: 0.44779255986213684, gen p mean: -0.15587612986564636, mean p set: 0.44836780428886414
loss_pred:0.017466440796852112, decouple_loss:0.0006481011514551938
The modified gen p mean: 0.4471043646335602, gen p mean: -0.15632040798664093, mean p set: 0.4476836025714874
loss_pred:0.014820527285337448, decouple_loss:0.0006295981002040207
Iteration: 1884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447231262922287, gen p mean: -0.16782115399837494, mean p set: 0.44780364632606506
loss_pred:0.016234716400504112, decouple_loss:0.0006465668557211757
The modified gen p mean: 0.4474390149116516, gen p mean: -0.15790151059627533, mean p set: 0.4480154812335968
loss_pred:0.015545469708740711, decouple_loss:0.0008462827536277473
The modified gen p mean: 0.4480651617050171, gen p mean: -0.15916411578655243, mean p set: 0.4486410617828369
loss_pred:0.01557956263422966, decouple_loss:0.0007385094650089741
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
NaN value num: 0
Iteration: 1885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448329895734787, gen p mean: -0.16107667982578278, mean p set: 0.4489073157310486
loss_pred:0.01800696738064289, decouple_loss:0.000659892859403044
The modified gen p mean: 0.4486130177974701, gen p mean: -0.15070781111717224, mean p set: 0.4491897523403168
loss_pred:0.01728707365691662, decouple_loss:0.0008629605290479958
The modified gen p mean: 0.4500837028026581, gen p mean: -0.15705466270446777, mean p set: 0.45066434144973755
loss_pred:0.01811733841896057, decouple_loss:0.000784240779466927
Iteration: 1886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45028650760650635, gen p mean: -0.15549920499324799, mean p set: 0.4508638381958008
loss_pred:0.01619347184896469, decouple_loss:0.000572159537114203
The modified gen p mean: 0.44865724444389343, gen p mean: -0.15025028586387634, mean p set: 0.4492320418357849
The modified gen p mean: 0.4490039050579071, gen p mean: -0.1458255499601364, mean p set: 0.449579656124115
loss_pred:0.01756732352077961, decouple_loss:0.0005954895750619471
loss_pred:0.017151745036244392, decouple_loss:0.0006352099007926881
Iteration: 1887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449341356754303, gen p mean: -0.1485232561826706, mean p set: 0.4499170780181885
loss_pred:0.01646461710333824, decouple_loss:0.0008430356392636895
The modified gen p mean: 0.44890323281288147, gen p mean: -0.14998658001422882, mean p set: 0.4494785666465759
loss_pred:0.018944043666124344, decouple_loss:0.0008807848789729178
The modified gen p mean: 0.45009174942970276, gen p mean: -0.14910341799259186, mean p set: 0.4506652057170868
loss_pred:0.016452983021736145, decouple_loss:0.0007079243659973145
Iteration: 1888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925203919410706, gen p mean: -0.1508983075618744, mean p set: 0.449830561876297
loss_pred:0.017833003774285316, decouple_loss:0.0008844558615237474
The modified gen p mean: 0.4494907557964325, gen p mean: -0.14867451786994934, mean p set: 0.45006415247917175
The modified gen p mean: 0.44944897294044495, gen p mean: -0.1467026174068451, mean p set: 0.45002496242523193
loss_pred:0.01797998882830143, decouple_loss:0.0007204413996078074
loss_pred:0.016842234879732132, decouple_loss:0.000735318404622376
Iteration: 1889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891357421875, gen p mean: -0.15241585671901703, mean p set: 0.44949114322662354
loss_pred:0.01734485849738121, decouple_loss:0.0007150725577957928
The modified gen p mean: 0.44900834560394287, gen p mean: -0.1552235633134842, mean p set: 0.4495847821235657
loss_pred:0.017147457227110863, decouple_loss:0.0006517125875689089
The modified gen p mean: 0.4481845200061798, gen p mean: -0.1606973260641098, mean p set: 0.4487626254558563
loss_pred:0.01753176935017109, decouple_loss:0.0006494317203760147
Iteration: 1890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490104019641876, gen p mean: -0.15218624472618103, mean p set: 0.44958263635635376
loss_pred:0.016668664291501045, decouple_loss:0.0006676414050161839
The modified gen p mean: 0.4491232633590698, gen p mean: -0.15412509441375732, mean p set: 0.44970032572746277
The modified gen p mean: 0.4492822587490082, gen p mean: -0.15158183872699738, mean p set: 0.4498618543148041
loss_pred:0.017082376405596733, decouple_loss:0.0005428065196610987
loss_pred:0.0160627830773592, decouple_loss:0.0005114359082654119
2023-05-02 10:26:59 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.16018816828727722, mean p set: 0.4502691626548767
loss_pred:0.017526552081108093, decouple_loss:0.0006321934633888304
The modified gen p mean: 0.4495372772216797, gen p mean: -0.1523553878068924, mean p set: 0.4500633478164673
loss_pred:0.016908612102270126, decouple_loss:0.0007565850391983986
The modified gen p mean: 0.4498284161090851, gen p mean: -0.1513693779706955, mean p set: 0.45035696029663086
loss_pred:0.017025362700223923, decouple_loss:0.0006967947701923549
WV_1_PC_1_EH_0_PS_40, loss: 0.017188269644975662, avg_mse: 0.026531623676419258
current test mse: 0.026532
Iteration: 1891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494929611682892, gen p mean: -0.15711157023906708, mean p set: 0.4500678777694702
loss_pred:0.0166461244225502, decouple_loss:0.0006503884796984494
The modified gen p mean: 0.44748958945274353, gen p mean: -0.1586921066045761, mean p set: 0.4480692446231842The modified gen p mean: 0.44944626092910767, gen p mean: -0.14292335510253906, mean p set: 0.45002689957618713
loss_pred:0.017351113259792328, decouple_loss:0.0009099710732698441
loss_pred:0.01763007417321205, decouple_loss:0.0007426811498589814
Iteration: 1892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496936798095703, gen p mean: -0.1551920622587204, mean p set: 0.4502682387828827
The modified gen p mean: 0.44980379939079285, gen p mean: -0.15379902720451355, mean p set: 0.45037850737571716
loss_pred:0.017595412209630013, decouple_loss:0.000542928057257086
loss_pred:0.01679368130862713, decouple_loss:0.000686144339852035
The modified gen p mean: 0.44867581129074097, gen p mean: -0.15340130031108856, mean p set: 0.44925177097320557
loss_pred:0.01755833998322487, decouple_loss:0.000542281661182642
Iteration: 1893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502272605895996, gen p mean: -0.15034310519695282, mean p set: 0.45080211758613586
loss_pred:0.017799265682697296, decouple_loss:0.000730486586689949
The modified gen p mean: 0.4493388235569, gen p mean: -0.15337492525577545, mean p set: 0.44991692900657654
loss_pred:0.017905261367559433, decouple_loss:0.0006440786528401077
The modified gen p mean: 0.45007482171058655, gen p mean: -0.1551879197359085, mean p set: 0.45065340399742126
loss_pred:0.017166228964924812, decouple_loss:0.0008695805445313454
Iteration: 1894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495292603969574, gen p mean: -0.14880405366420746, mean p set: 0.45010536909103394
loss_pred:0.01744423620402813, decouple_loss:0.0006354908691719174
The modified gen p mean: 0.44971033930778503, gen p mean: -0.14780986309051514, mean p set: 0.45029157400131226
loss_pred:0.017108656466007233, decouple_loss:0.0005435360944829881
The modified gen p mean: 0.44842463731765747, gen p mean: -0.1502254158258438, mean p set: 0.4489997923374176
loss_pred:0.017339807003736496, decouple_loss:0.0007557776989415288
Iteration: 1895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448580265045166, gen p mean: -0.1364128440618515, mean p set: 0.44915536046028137
loss_pred:0.016910387203097343, decouple_loss:0.00043840959551744163
The modified gen p mean: 0.44770777225494385, gen p mean: -0.14263835549354553, mean p set: 0.4482865631580353
loss_pred:0.018077123910188675, decouple_loss:0.0006251298473216593
The modified gen p mean: 0.44687575101852417, gen p mean: -0.14549434185028076, mean p set: 0.44745081663131714
loss_pred:0.017717577517032623, decouple_loss:0.0005726723466068506
Iteration: 1896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472109377384186, gen p mean: -0.13405951857566833, mean p set: 0.44778892397880554
loss_pred:0.017442487180233, decouple_loss:0.0006003073649480939
The modified gen p mean: 0.44785773754119873, gen p mean: -0.13213007152080536, mean p set: 0.4484367072582245
loss_pred:0.018019499257206917, decouple_loss:0.0005967422039248049
The modified gen p mean: 0.44845741987228394, gen p mean: -0.12999694049358368, mean p set: 0.4490341246128082
loss_pred:0.016655126586556435, decouple_loss:0.0005611885571852326
Iteration: 1897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803258776664734, gen p mean: -0.12303441017866135, mean p set: 0.44860872626304626
loss_pred:0.016694700345396996, decouple_loss:0.0005355537286959589
The modified gen p mean: 0.44830945134162903, gen p mean: -0.13085801899433136, mean p set: 0.4488857388496399
loss_pred:0.017397431656718254, decouple_loss:0.0006033246172592044
The modified gen p mean: 0.4488539397716522, gen p mean: -0.11632251739501953, mean p set: 0.4494294226169586
loss_pred:0.018079426139593124, decouple_loss:0.0005933823995292187
Iteration: 1898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901251792907715, gen p mean: -0.12289761006832123, mean p set: 0.4495871365070343
loss_pred:0.017090030014514923, decouple_loss:0.00044874116429127753
The modified gen p mean: 0.4493921995162964, gen p mean: -0.13180898129940033, mean p set: 0.44996798038482666
loss_pred:0.017710000276565552, decouple_loss:0.0005119259003549814
The modified gen p mean: 0.4499235451221466, gen p mean: -0.12097292393445969, mean p set: 0.4505000710487366
loss_pred:0.017171526327729225, decouple_loss:0.0005376178887672722
Iteration: 1899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45064282417297363, gen p mean: -0.12054424732923508, mean p set: 0.451217383146286
loss_pred:0.016591528430581093, decouple_loss:0.0005242182523943484
The modified gen p mean: 0.4473626911640167, gen p mean: -0.1171882376074791, mean p set: 0.4479367434978485
loss_pred:0.017347194254398346, decouple_loss:0.0005378025816753507
The modified gen p mean: 0.4477633535861969, gen p mean: -0.1161087304353714, mean p set: 0.44833892583847046
loss_pred:0.018457088619470596, decouple_loss:0.0005705480580218136
Iteration: 1900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779905676841736, gen p mean: -0.11122236400842667, mean p set: 0.44837674498558044
loss_pred:0.016350658610463142, decouple_loss:0.0006194674642756581
The modified gen p mean: 0.44906193017959595, gen p mean: -0.11233051121234894, mean p set: 0.44963809847831726
loss_pred:0.01608341559767723, decouple_loss:0.00046056477003730834
The modified gen p mean: 0.4475589394569397, gen p mean: -0.1088518351316452, mean p set: 0.4481346309185028
loss_pred:0.018331438302993774, decouple_loss:0.0006709352019242942
2023-05-02 10:29:04 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12446625530719757, mean p set: 0.4502691626548767
loss_pred:0.017384065315127373, decouple_loss:0.0005294865695759654
The modified gen p mean: 0.4495370090007782, gen p mean: -0.11752241849899292, mean p set: 0.4500633478164673
loss_pred:0.016761019825935364, decouple_loss:0.0005580743891187012
The modified gen p mean: 0.4498271942138672, gen p mean: -0.11618206650018692, mean p set: 0.45035696029663086
loss_pred:0.016896111890673637, decouple_loss:0.0005787842092104256
WV_1_PC_1_EH_0_PS_40, loss: 0.017041504383087158, avg_mse: 0.026332594454288483
current test mse: 0.026333
Iteration: 1901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479033946990967, gen p mean: -0.120516337454319, mean p set: 0.44847843050956726
loss_pred:0.01749872788786888, decouple_loss:0.0004918153281323612
The modified gen p mean: 0.44831234216690063, gen p mean: -0.12050169706344604, mean p set: 0.44888877868652344
loss_pred:0.017225978896021843, decouple_loss:0.0005051015759818256
The modified gen p mean: 0.4473530948162079, gen p mean: -0.12155348807573318, mean p set: 0.4479283094406128
loss_pred:0.017605498433113098, decouple_loss:0.00045429461169987917
Iteration: 1902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448601096868515, gen p mean: -0.1226026639342308, mean p set: 0.44917726516723633
loss_pred:0.016981733962893486, decouple_loss:0.0004485350800678134
The modified gen p mean: 0.44686564803123474, gen p mean: -0.12656991183757782, mean p set: 0.4474412202835083The modified gen p mean: 0.44690579175949097, gen p mean: -0.12758471071720123, mean p set: 0.4474814832210541
loss_pred:0.01748019829392433, decouple_loss:0.0004524679679889232
loss_pred:0.01758562959730625, decouple_loss:0.0005203490145504475
Iteration: 1903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485989809036255, gen p mean: -0.1234581470489502, mean p set: 0.44917601346969604
loss_pred:0.018036022782325745, decouple_loss:0.0005027566803619266
The modified gen p mean: 0.44895899295806885, gen p mean: -0.1287059187889099, mean p set: 0.44953596591949463
loss_pred:0.01630849391222, decouple_loss:0.00043198480852879584
The modified gen p mean: 0.4474160373210907, gen p mean: -0.12904441356658936, mean p set: 0.4479937255382538
loss_pred:0.017228182405233383, decouple_loss:0.0004430999979376793
Iteration: 1904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44921091198921204, gen p mean: -0.12941741943359375, mean p set: 0.449788898229599
loss_pred:0.016657773405313492, decouple_loss:0.00048308755503967404
The modified gen p mean: 0.44847026467323303, gen p mean: -0.12015209347009659, mean p set: 0.44904592633247375
loss_pred:0.01770433597266674, decouple_loss:0.0005722857895307243
The modified gen p mean: 0.44864651560783386, gen p mean: -0.12277624756097794, mean p set: 0.4492203891277313
loss_pred:0.016979364678263664, decouple_loss:0.0005628035869449377
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
NaN value num: 0
Iteration: 1905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519396126270294, gen p mean: -0.12232433259487152, mean p set: 0.45251601934432983
loss_pred:0.015975190326571465, decouple_loss:0.0005232840194366872The modified gen p mean: 0.4514451026916504, gen p mean: -0.12239417433738708, mean p set: 0.4520223140716553
loss_pred:0.016006801277399063, decouple_loss:0.0004399240424390882
The modified gen p mean: 0.4495890438556671, gen p mean: -0.12128973752260208, mean p set: 0.4501630365848541
loss_pred:0.015223235823214054, decouple_loss:0.00047115370398387313
Iteration: 1906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502221643924713, gen p mean: -0.12269067019224167, mean p set: 0.45079872012138367
loss_pred:0.016801675781607628, decouple_loss:0.0005201697931624949
The modified gen p mean: 0.44918909668922424, gen p mean: -0.12326253205537796, mean p set: 0.4497682452201843
loss_pred:0.016437912359833717, decouple_loss:0.0005545055610127747
The modified gen p mean: 0.45108601450920105, gen p mean: -0.1255575567483902, mean p set: 0.4516623318195343
loss_pred:0.0153294513002038, decouple_loss:0.00048417176003567874
Iteration: 1907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44967418909072876, gen p mean: -0.12611980736255646, mean p set: 0.4502543807029724
loss_pred:0.01676858775317669, decouple_loss:0.0006526785437017679
The modified gen p mean: 0.4502022862434387, gen p mean: -0.12049124389886856, mean p set: 0.450778603553772
The modified gen p mean: 0.45195233821868896, gen p mean: -0.12162236869335175, mean p set: 0.4525294005870819
loss_pred:0.016561539843678474, decouple_loss:0.00046848246711306274
loss_pred:0.015654752030968666, decouple_loss:0.0006736436625942588
Iteration: 1908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45133012533187866, gen p mean: -0.12489467859268188, mean p set: 0.451905757188797
loss_pred:0.016219742596149445, decouple_loss:0.0004645487933885306
The modified gen p mean: 0.45162856578826904, gen p mean: -0.1226055845618248, mean p set: 0.452203631401062
The modified gen p mean: 0.45108461380004883, gen p mean: -0.13052907586097717, mean p set: 0.4516597390174866
loss_pred:0.015824919566512108, decouple_loss:0.0004768354119732976
loss_pred:0.015414484776556492, decouple_loss:0.00046501774340867996
Iteration: 1909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523716866970062, gen p mean: -0.1230039894580841, mean p set: 0.45294854044914246
loss_pred:0.015165939927101135, decouple_loss:0.0004923702799715102
The modified gen p mean: 0.45168909430503845, gen p mean: -0.12556856870651245, mean p set: 0.452263742685318
loss_pred:0.015314013697206974, decouple_loss:0.0005174818797968328
The modified gen p mean: 0.4504051208496094, gen p mean: -0.12164953351020813, mean p set: 0.4509834945201874
loss_pred:0.01600070111453533, decouple_loss:0.0005760615458711982
Iteration: 1910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939959049224854, gen p mean: -0.12395157665014267, mean p set: 0.449973464012146
loss_pred:0.01608557254076004, decouple_loss:0.0004994029877707362
The modified gen p mean: 0.4508933126926422, gen p mean: -0.12386135011911392, mean p set: 0.45147088170051575
The modified gen p mean: 0.45156189799308777, gen p mean: -0.12555503845214844, mean p set: 0.4521428644657135
loss_pred:0.015645328909158707, decouple_loss:0.00042431880137883127
loss_pred:0.014851955696940422, decouple_loss:0.00048580276779830456
2023-05-02 10:31:47 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12977463006973267, mean p set: 0.4502691626548767
loss_pred:0.017194362357258797, decouple_loss:0.00046476759598590434
The modified gen p mean: 0.4495348036289215, gen p mean: -0.12252561002969742, mean p set: 0.4500633478164673
loss_pred:0.01654757931828499, decouple_loss:0.0004744666221085936
The modified gen p mean: 0.44982922077178955, gen p mean: -0.12157744914293289, mean p set: 0.45035696029663086
loss_pred:0.01674385368824005, decouple_loss:0.0005091252387501299
WV_1_PC_1_EH_0_PS_40, loss: 0.016852738335728645, avg_mse: 0.026159007102251053
current test mse: 0.026159
Iteration: 1911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498341977596283, gen p mean: -0.11987544596195221, mean p set: 0.4504096210002899
loss_pred:0.016468901187181473, decouple_loss:0.0005039707757532597
The modified gen p mean: 0.4497147798538208, gen p mean: -0.11683173477649689, mean p set: 0.45029133558273315The modified gen p mean: 0.4524135887622833, gen p mean: -0.11955805867910385, mean p set: 0.4529906213283539
loss_pred:0.016595281660556793, decouple_loss:0.0004060343489982188loss_pred:0.015415740199387074, decouple_loss:0.0004973763134330511
Iteration: 1912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509952664375305, gen p mean: -0.11891178786754608, mean p set: 0.4515727162361145
loss_pred:0.015426595695316792, decouple_loss:0.0005537226679734886
The modified gen p mean: 0.45132991671562195, gen p mean: -0.1298322081565857, mean p set: 0.45190224051475525The modified gen p mean: 0.4503439664840698, gen p mean: -0.12464416027069092, mean p set: 0.4509196877479553
loss_pred:0.016438685357570648, decouple_loss:0.0005104187875986099
loss_pred:0.015982385724782944, decouple_loss:0.0005410103476606309
Iteration: 1913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530400037765503, gen p mean: -0.12199719250202179, mean p set: 0.45361581444740295
loss_pred:0.015385725535452366, decouple_loss:0.0005646696081385016
The modified gen p mean: 0.44930002093315125, gen p mean: -0.12101682275533676, mean p set: 0.44987794756889343
loss_pred:0.01623520441353321, decouple_loss:0.0005184489418752491
The modified gen p mean: 0.45074960589408875, gen p mean: -0.12155935913324356, mean p set: 0.4513280689716339
loss_pred:0.015327932313084602, decouple_loss:0.0005942364223301411
Iteration: 1914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493674635887146, gen p mean: -0.12148255109786987, mean p set: 0.44993916153907776
loss_pred:0.015399396419525146, decouple_loss:0.0004221249255351722
The modified gen p mean: 0.4497182071208954, gen p mean: -0.12131340801715851, mean p set: 0.4502951502799988
loss_pred:0.015399114228785038, decouple_loss:0.00048007251461967826
The modified gen p mean: 0.45114755630493164, gen p mean: -0.12773144245147705, mean p set: 0.45172062516212463
loss_pred:0.016372164711356163, decouple_loss:0.00043055531568825245
Iteration: 1915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019733905792236, gen p mean: -0.1192949116230011, mean p set: 0.4507746696472168
loss_pred:0.016428407281637192, decouple_loss:0.0005164063768461347
The modified gen p mean: 0.4517229199409485, gen p mean: -0.12915948033332825, mean p set: 0.4522954225540161
loss_pred:0.015399142168462276, decouple_loss:0.0004370768729131669
The modified gen p mean: 0.4509902894496918, gen p mean: -0.12147194892168045, mean p set: 0.4515630006790161
loss_pred:0.015278812497854233, decouple_loss:0.0004815428692381829
Iteration: 1916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509780704975128, gen p mean: -0.12156285345554352, mean p set: 0.4515514075756073
loss_pred:0.016210053116083145, decouple_loss:0.0005209477385506034
The modified gen p mean: 0.449966698884964, gen p mean: -0.12322496622800827, mean p set: 0.45054367184638977
loss_pred:0.015090876258909702, decouple_loss:0.00042556371772661805
The modified gen p mean: 0.44952473044395447, gen p mean: -0.12428372353315353, mean p set: 0.45010536909103394
loss_pred:0.015269267372786999, decouple_loss:0.00045552963274531066
Iteration: 1917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451837420463562, gen p mean: -0.12676987051963806, mean p set: 0.45241761207580566
loss_pred:0.015526718460023403, decouple_loss:0.000399918295443058
The modified gen p mean: 0.45162510871887207, gen p mean: -0.1245281994342804, mean p set: 0.45220157504081726
loss_pred:0.01507718674838543, decouple_loss:0.0004021486674901098
The modified gen p mean: 0.4515738785266876, gen p mean: -0.1362607628107071, mean p set: 0.4521483778953552
loss_pred:0.016169657930731773, decouple_loss:0.0005079659167677164
Iteration: 1918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536079168319702, gen p mean: -0.12291917949914932, mean p set: 0.45418456196784973
loss_pred:0.015277538448572159, decouple_loss:0.00043393453233875334
The modified gen p mean: 0.4532952904701233, gen p mean: -0.12543964385986328, mean p set: 0.453868567943573
loss_pred:0.015051810070872307, decouple_loss:0.0004815311694983393
The modified gen p mean: 0.4520130753517151, gen p mean: -0.1270289570093155, mean p set: 0.4525899887084961
loss_pred:0.015363390557467937, decouple_loss:0.000514363287948072
Iteration: 1919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507458806037903, gen p mean: -0.12791961431503296, mean p set: 0.4513210654258728
loss_pred:0.01578066125512123, decouple_loss:0.0005057110683992505
The modified gen p mean: 0.45169031620025635, gen p mean: -0.12882301211357117, mean p set: 0.4522706866264343
loss_pred:0.01619729772210121, decouple_loss:0.0006240485818125308
The modified gen p mean: 0.4517037570476532, gen p mean: -0.12889382243156433, mean p set: 0.45228299498558044
loss_pred:0.015493318438529968, decouple_loss:0.0004837091837543994
Iteration: 1920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45109322667121887, gen p mean: -0.11894912272691727, mean p set: 0.45166799426078796
loss_pred:0.015550564043223858, decouple_loss:0.0005966879543848336
The modified gen p mean: 0.44978195428848267, gen p mean: -0.12497296929359436, mean p set: 0.4503602981567383
loss_pred:0.015562506392598152, decouple_loss:0.0007046257378533483
The modified gen p mean: 0.4504030644893646, gen p mean: -0.12478382885456085, mean p set: 0.4509831368923187
loss_pred:0.016291551291942596, decouple_loss:0.0006883751484565437
2023-05-02 10:33:54 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1385268270969391, mean p set: 0.4502691626548767
loss_pred:0.017137546092271805, decouple_loss:0.0004604380519594997
The modified gen p mean: 0.44953402876853943, gen p mean: -0.13117973506450653, mean p set: 0.4500633478164673
loss_pred:0.016453200951218605, decouple_loss:0.00046000751899555326
The modified gen p mean: 0.44982871413230896, gen p mean: -0.13035276532173157, mean p set: 0.45035696029663086
loss_pred:0.01668560318648815, decouple_loss:0.00043159519555047154
WV_1_PC_1_EH_0_PS_40, loss: 0.016781318932771683, avg_mse: 0.026091119274497032
current test mse: 0.026091
Iteration: 1921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44926008582115173, gen p mean: -0.1311282366514206, mean p set: 0.4498387575149536
loss_pred:0.016168981790542603, decouple_loss:0.0005746968672610819
The modified gen p mean: 0.45077136158943176, gen p mean: -0.12583625316619873, mean p set: 0.4513498842716217
loss_pred:0.015157957561314106, decouple_loss:0.0005181428277865052
The modified gen p mean: 0.4516642093658447, gen p mean: -0.12935087084770203, mean p set: 0.4522424042224884
loss_pred:0.015319166705012321, decouple_loss:0.0004131826281081885
Iteration: 1922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44986119866371155, gen p mean: -0.12421637773513794, mean p set: 0.4504365921020508
The modified gen p mean: 0.4526974856853485, gen p mean: -0.1285841017961502, mean p set: 0.4532740116119385
loss_pred:0.014757945202291012, decouple_loss:0.0004477903130464256
loss_pred:0.015227350406348705, decouple_loss:0.0004155792994424701
The modified gen p mean: 0.45141857862472534, gen p mean: -0.12651951611042023, mean p set: 0.45199474692344666
loss_pred:0.014891466125845909, decouple_loss:0.0005167415365576744
Iteration: 1923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45043233036994934, gen p mean: -0.12141604721546173, mean p set: 0.45101073384284973
loss_pred:0.016229327768087387, decouple_loss:0.00050723971799016
The modified gen p mean: 0.4502461850643158, gen p mean: -0.12385202944278717, mean p set: 0.45082080364227295The modified gen p mean: 0.4507719576358795, gen p mean: -0.12925559282302856, mean p set: 0.45135000348091125
loss_pred:0.015163051895797253, decouple_loss:0.000532343634404242loss_pred:0.015944719314575195, decouple_loss:0.0003689011500682682
Iteration: 1924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930827617645264, gen p mean: -0.1257510483264923, mean p set: 0.4498836398124695
loss_pred:0.015575547702610493, decouple_loss:0.00045878830133005977
The modified gen p mean: 0.4495006799697876, gen p mean: -0.12404715269804001, mean p set: 0.45007672905921936
loss_pred:0.015685871243476868, decouple_loss:0.0003934130072593689
The modified gen p mean: 0.4512130320072174, gen p mean: -0.12014701217412949, mean p set: 0.4517904818058014
loss_pred:0.016272686421871185, decouple_loss:0.00042333040619269013
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
NaN value num: 0
Iteration: 1925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449756920337677, gen p mean: -0.1166590079665184, mean p set: 0.4503326416015625
loss_pred:0.016587357968091965, decouple_loss:0.0005591935478150845
The modified gen p mean: 0.4493992030620575, gen p mean: -0.11741089820861816, mean p set: 0.4499790072441101
loss_pred:0.015815554186701775, decouple_loss:0.0005113036022521555
The modified gen p mean: 0.4513297975063324, gen p mean: -0.11819349229335785, mean p set: 0.451905757188797
loss_pred:0.015230421908199787, decouple_loss:0.0004462204815354198
Iteration: 1926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45011788606643677, gen p mean: -0.1227153092622757, mean p set: 0.450695663690567
loss_pred:0.015620567835867405, decouple_loss:0.00037366163451224566
The modified gen p mean: 0.44975095987319946, gen p mean: -0.11947433650493622, mean p set: 0.45032599568367004
loss_pred:0.015393792651593685, decouple_loss:0.00044440303463488817
The modified gen p mean: 0.44716811180114746, gen p mean: -0.12791338562965393, mean p set: 0.4477446675300598
loss_pred:0.015451123006641865, decouple_loss:0.00040291750337928534
Iteration: 1927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45162394642829895, gen p mean: -0.11358531564474106, mean p set: 0.45219725370407104
loss_pred:0.015039926394820213, decouple_loss:0.0005731149576604366
The modified gen p mean: 0.4502958655357361, gen p mean: -0.11446353048086166, mean p set: 0.45087239146232605
loss_pred:0.01578933745622635, decouple_loss:0.00040766794700175524
The modified gen p mean: 0.45060646533966064, gen p mean: -0.11644545942544937, mean p set: 0.4511836767196655
loss_pred:0.01674826629459858, decouple_loss:0.0004653542418964207
Iteration: 1928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505098760128021, gen p mean: -0.11864525824785233, mean p set: 0.4510878920555115
loss_pred:0.016070131212472916, decouple_loss:0.0005422754911705852
The modified gen p mean: 0.4529024064540863, gen p mean: -0.11411025375127792, mean p set: 0.4534813165664673
loss_pred:0.016042450442910194, decouple_loss:0.0007676560198888183
The modified gen p mean: 0.44908758997917175, gen p mean: -0.11496550589799881, mean p set: 0.44966429471969604
loss_pred:0.01614069938659668, decouple_loss:0.0006356817902997136
Iteration: 1929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528806805610657, gen p mean: -0.11527309566736221, mean p set: 0.4534589648246765
The modified gen p mean: 0.4498775005340576, gen p mean: -0.11869503557682037, mean p set: 0.45045459270477295
loss_pred:0.015510675497353077, decouple_loss:0.0007308031781576574
loss_pred:0.014803187921643257, decouple_loss:0.0004578641674015671
The modified gen p mean: 0.4487433135509491, gen p mean: -0.12254202365875244, mean p set: 0.4493206739425659
loss_pred:0.015074037946760654, decouple_loss:0.0005818281206302345
Iteration: 1930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490761458873749, gen p mean: -0.12387396395206451, mean p set: 0.4496527314186096
loss_pred:0.015734445303678513, decouple_loss:0.0005068847676739097
The modified gen p mean: 0.44924309849739075, gen p mean: -0.12748754024505615, mean p set: 0.44981902837753296
loss_pred:0.015445857308804989, decouple_loss:0.0005267598899081349
The modified gen p mean: 0.4484636187553406, gen p mean: -0.12972012162208557, mean p set: 0.44903984665870667
loss_pred:0.01569642685353756, decouple_loss:0.0004402392660267651
2023-05-02 10:36:39 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13902918994426727, mean p set: 0.4502691626548767
loss_pred:0.01731550134718418, decouple_loss:0.0007086634286679327
The modified gen p mean: 0.44953468441963196, gen p mean: -0.1311541348695755, mean p set: 0.4500633478164673
loss_pred:0.016599109396338463, decouple_loss:0.0007108661229722202
The modified gen p mean: 0.4498297870159149, gen p mean: -0.13049708306789398, mean p set: 0.45035696029663086
loss_pred:0.016782255843281746, decouple_loss:0.0006662943051196635
WV_1_PC_1_EH_0_PS_40, loss: 0.01693372055888176, avg_mse: 0.026275720447301865
current test mse: 0.026276
Iteration: 1931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498252868652344, gen p mean: -0.11857423186302185, mean p set: 0.45040273666381836
loss_pred:0.015321234241127968, decouple_loss:0.0007228207541629672
The modified gen p mean: 0.4527275562286377, gen p mean: -0.12183967232704163, mean p set: 0.45330190658569336The modified gen p mean: 0.44971489906311035, gen p mean: -0.1296391487121582, mean p set: 0.4502916932106018
loss_pred:0.015221421606838703, decouple_loss:0.0006888167699798942
loss_pred:0.01603986881673336, decouple_loss:0.0005520414561033249
Iteration: 1932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494418203830719, gen p mean: -0.11844225972890854, mean p set: 0.4500192403793335
The modified gen p mean: 0.4529518187046051, gen p mean: -0.12112019211053848, mean p set: 0.45352625846862793
loss_pred:0.015538032166659832, decouple_loss:0.0005335801979526877
loss_pred:0.015213257633149624, decouple_loss:0.0006787950405851007
The modified gen p mean: 0.4488312005996704, gen p mean: -0.13036410510540009, mean p set: 0.4494048058986664
loss_pred:0.014756712131202221, decouple_loss:0.00046442452003248036
Iteration: 1933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499896168708801, gen p mean: -0.12334448099136353, mean p set: 0.4505661725997925
loss_pred:0.015065751038491726, decouple_loss:0.0005372244631871581
The modified gen p mean: 0.4500357210636139, gen p mean: -0.12031332403421402, mean p set: 0.45061424374580383
loss_pred:0.015401334501802921, decouple_loss:0.0004277825355529785
The modified gen p mean: 0.44970712065696716, gen p mean: -0.12155912816524506, mean p set: 0.45028528571128845
loss_pred:0.014916828833520412, decouple_loss:0.00040754047222435474
Iteration: 1934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44966715574264526, gen p mean: -0.12352798879146576, mean p set: 0.4502440094947815
The modified gen p mean: 0.45246586203575134, gen p mean: -0.11732891201972961, mean p set: 0.45304545760154724
loss_pred:0.016254205256700516, decouple_loss:0.0005989581113681197
loss_pred:0.015256412327289581, decouple_loss:0.0006595187005586922
The modified gen p mean: 0.452075719833374, gen p mean: -0.11511893570423126, mean p set: 0.45265257358551025
loss_pred:0.015370266512036324, decouple_loss:0.0005984625313431025
Iteration: 1935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510961174964905, gen p mean: -0.12561003863811493, mean p set: 0.4516725242137909
loss_pred:0.015986407175660133, decouple_loss:0.0005852654576301575
The modified gen p mean: 0.4492465555667877, gen p mean: -0.11943824589252472, mean p set: 0.44982537627220154
loss_pred:0.01579253003001213, decouple_loss:0.0005733331781812012
The modified gen p mean: 0.4515288174152374, gen p mean: -0.12436334043741226, mean p set: 0.4521060883998871
loss_pred:0.015415056608617306, decouple_loss:0.0005222130566835403
Iteration: 1936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486730992794037, gen p mean: -0.11982517689466476, mean p set: 0.44924721121788025
loss_pred:0.014818944968283176, decouple_loss:0.000506958516780287
The modified gen p mean: 0.4483683109283447, gen p mean: -0.1240353137254715, mean p set: 0.44894298911094666
The modified gen p mean: 0.4494387209415436, gen p mean: -0.1141822338104248, mean p set: 0.4500143229961395
loss_pred:0.014619591645896435, decouple_loss:0.0005198678700253367
loss_pred:0.015261764638125896, decouple_loss:0.0005289797554723918
Iteration: 1937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997912645339966, gen p mean: -0.11998861283063889, mean p set: 0.4505581855773926
loss_pred:0.01563763990998268, decouple_loss:0.00046981711057014763
The modified gen p mean: 0.44913700222969055, gen p mean: -0.12125413864850998, mean p set: 0.4497148096561432
loss_pred:0.015117848291993141, decouple_loss:0.0004677932884078473
The modified gen p mean: 0.45021122694015503, gen p mean: -0.11970654875040054, mean p set: 0.4507887363433838
loss_pred:0.014650171622633934, decouple_loss:0.00050977838691324
Iteration: 1938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500318765640259, gen p mean: -0.12152250111103058, mean p set: 0.4506070911884308
loss_pred:0.01585015095770359, decouple_loss:0.0006793179200030863
The modified gen p mean: 0.45307058095932007, gen p mean: -0.10862157493829727, mean p set: 0.45364704728126526
The modified gen p mean: 0.4485950767993927, gen p mean: -0.11888979375362396, mean p set: 0.44917213916778564
loss_pred:0.015035523101687431, decouple_loss:0.0006038422579877079
loss_pred:0.014769148081541061, decouple_loss:0.0007236144738271832
Iteration: 1939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495934844017029, gen p mean: -0.11337734758853912, mean p set: 0.4501686692237854
loss_pred:0.015386411920189857, decouple_loss:0.0004969745641574264
The modified gen p mean: 0.45012742280960083, gen p mean: -0.11522728949785233, mean p set: 0.4507025480270386
loss_pred:0.01606915518641472, decouple_loss:0.0005990155041217804
The modified gen p mean: 0.449632853269577, gen p mean: -0.127722829580307, mean p set: 0.45020797848701477
loss_pred:0.01578686572611332, decouple_loss:0.0006504744524136186
Iteration: 1940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45116570591926575, gen p mean: -0.11658725142478943, mean p set: 0.4517436623573303
loss_pred:0.015665274113416672, decouple_loss:0.0006318225641734898
The modified gen p mean: 0.4526403248310089, gen p mean: -0.11486417055130005, mean p set: 0.4532198905944824
loss_pred:0.01578664220869541, decouple_loss:0.0005181115120649338
The modified gen p mean: 0.4504956603050232, gen p mean: -0.11997484415769577, mean p set: 0.4510722756385803
loss_pred:0.014762530103325844, decouple_loss:0.00048480386612936854
2023-05-02 10:38:45 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12466543167829514, mean p set: 0.4502691626548767
loss_pred:0.01721569523215294, decouple_loss:0.000462439056718722
The modified gen p mean: 0.44953370094299316, gen p mean: -0.11758839339017868, mean p set: 0.4500633478164673
loss_pred:0.01653119921684265, decouple_loss:0.0005853988113813102
The modified gen p mean: 0.4498307406902313, gen p mean: -0.11682654917240143, mean p set: 0.45035696029663086
loss_pred:0.016762999817728996, decouple_loss:0.0005809914437122643
WV_1_PC_1_EH_0_PS_40, loss: 0.016863780096173286, avg_mse: 0.026197155937552452
current test mse: 0.026197
Iteration: 1941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486372172832489, gen p mean: -0.11551308631896973, mean p set: 0.44921332597732544
loss_pred:0.015543800778687, decouple_loss:0.0005284232902340591
The modified gen p mean: 0.4496247172355652, gen p mean: -0.11321912705898285, mean p set: 0.45020267367362976The modified gen p mean: 0.44880664348602295, gen p mean: -0.11885063350200653, mean p set: 0.4493838846683502
loss_pred:0.016020705923438072, decouple_loss:0.0004743814351968467loss_pred:0.015855176374316216, decouple_loss:0.0005529664340429008
Iteration: 1942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503915309906006, gen p mean: -0.11888989806175232, mean p set: 0.45096808671951294The modified gen p mean: 0.45348453521728516, gen p mean: -0.11390625685453415, mean p set: 0.45406150817871094
loss_pred:0.014597787521779537, decouple_loss:0.0005444495473057032loss_pred:0.014912051148712635, decouple_loss:0.0009274098556488752
The modified gen p mean: 0.4497397243976593, gen p mean: -0.11479779332876205, mean p set: 0.45031604170799255
loss_pred:0.015382998622953892, decouple_loss:0.0006215171306394041
Iteration: 1943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522554874420166, gen p mean: -0.11581076681613922, mean p set: 0.4528343677520752
loss_pred:0.015054433606564999, decouple_loss:0.0005084703443571925
The modified gen p mean: 0.4526198208332062, gen p mean: -0.11588523536920547, mean p set: 0.4531964957714081
loss_pred:0.015412925742566586, decouple_loss:0.0005442002438940108
The modified gen p mean: 0.4495895802974701, gen p mean: -0.12186586856842041, mean p set: 0.45016786456108093
loss_pred:0.015625711530447006, decouple_loss:0.0006414271774701774
Iteration: 1944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496051073074341, gen p mean: -0.12223963439464569, mean p set: 0.45018163323402405
loss_pred:0.015416212379932404, decouple_loss:0.0005646171630360186
The modified gen p mean: 0.45255210995674133, gen p mean: -0.1177135556936264, mean p set: 0.4531312584877014
loss_pred:0.015525502152740955, decouple_loss:0.0006962099578231573
The modified gen p mean: 0.4514579474925995, gen p mean: -0.12037036567926407, mean p set: 0.4520338773727417
loss_pred:0.015454286709427834, decouple_loss:0.0007500969804823399
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 1945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478877782821655, gen p mean: -0.1255745142698288, mean p set: 0.44846272468566895
loss_pred:0.013881929218769073, decouple_loss:0.000776472210418433
The modified gen p mean: 0.44879505038261414, gen p mean: -0.13458406925201416, mean p set: 0.4493709206581116
loss_pred:0.015378960408270359, decouple_loss:0.0006682446110062301
The modified gen p mean: 0.4471716284751892, gen p mean: -0.12426835298538208, mean p set: 0.447748064994812
loss_pred:0.014822649769484997, decouple_loss:0.0005178031278774142
Iteration: 1946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485306441783905, gen p mean: -0.12158472836017609, mean p set: 0.44910773634910583
loss_pred:0.014378468506038189, decouple_loss:0.0007374054403044283
The modified gen p mean: 0.4488484263420105, gen p mean: -0.1317072957754135, mean p set: 0.4494233727455139
loss_pred:0.0152019327506423, decouple_loss:0.0006295898929238319
The modified gen p mean: 0.4492572546005249, gen p mean: -0.12480209767818451, mean p set: 0.4498351216316223
loss_pred:0.014675280079245567, decouple_loss:0.0007998661021701992
Iteration: 1947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660088419914246, gen p mean: -0.1309666931629181, mean p set: 0.447174608707428
loss_pred:0.015452483668923378, decouple_loss:0.0004683537990786135
The modified gen p mean: 0.4486618638038635, gen p mean: -0.12485480308532715, mean p set: 0.44923779368400574
loss_pred:0.015145049430429935, decouple_loss:0.0005508882459253073
The modified gen p mean: 0.44829830527305603, gen p mean: -0.12234669923782349, mean p set: 0.44887375831604004
loss_pred:0.015741750597953796, decouple_loss:0.00047084028483368456
Iteration: 1948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44986259937286377, gen p mean: -0.11553622037172318, mean p set: 0.4504365622997284
loss_pred:0.013955307193100452, decouple_loss:0.0005588670610450208
The modified gen p mean: 0.4472525715827942, gen p mean: -0.11833048611879349, mean p set: 0.44782793521881104
loss_pred:0.015350437723100185, decouple_loss:0.0006198932533152401
The modified gen p mean: 0.4473305940628052, gen p mean: -0.12648458778858185, mean p set: 0.4479064643383026
loss_pred:0.01486134435981512, decouple_loss:0.0004196616937406361
Iteration: 1949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474011957645416, gen p mean: -0.12151592969894409, mean p set: 0.4479774832725525
loss_pred:0.014374973252415657, decouple_loss:0.0005317690665833652
The modified gen p mean: 0.44862839579582214, gen p mean: -0.12339004874229431, mean p set: 0.44920656085014343
loss_pred:0.014699974097311497, decouple_loss:0.0005752849974669516
The modified gen p mean: 0.4482678472995758, gen p mean: -0.1232660636305809, mean p set: 0.44884639978408813
loss_pred:0.01470194198191166, decouple_loss:0.0006027893978171051
Iteration: 1950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962742924690247, gen p mean: -0.1272405982017517, mean p set: 0.45020073652267456
loss_pred:0.013935748487710953, decouple_loss:0.0006330280448310077
The modified gen p mean: 0.44897952675819397, gen p mean: -0.11370889842510223, mean p set: 0.449554443359375
loss_pred:0.014613855630159378, decouple_loss:0.0005043931305408478
The modified gen p mean: 0.44798046350479126, gen p mean: -0.11720647662878036, mean p set: 0.4485572874546051
loss_pred:0.01504370104521513, decouple_loss:0.0005933992797508836
2023-05-02 10:41:28 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1314517706632614, mean p set: 0.4502691626548767
loss_pred:0.01704302616417408, decouple_loss:0.0006476106937043369
The modified gen p mean: 0.44953426718711853, gen p mean: -0.12435422837734222, mean p set: 0.4500633478164673
loss_pred:0.016329260542988777, decouple_loss:0.0006054259720258415
The modified gen p mean: 0.4498274028301239, gen p mean: -0.12359090149402618, mean p set: 0.45035696029663086
loss_pred:0.016709091141819954, decouple_loss:0.0006316223880276084
WV_1_PC_1_EH_0_PS_40, loss: 0.0167252030223608, avg_mse: 0.025961702689528465
current test mse: 0.025962
Iteration: 1951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830551743507385, gen p mean: -0.12281227856874466, mean p set: 0.4488815367221832
loss_pred:0.015763316303491592, decouple_loss:0.0005690829129889607
The modified gen p mean: 0.44966140389442444, gen p mean: -0.12974685430526733, mean p set: 0.45023879408836365
The modified gen p mean: 0.4490637481212616, gen p mean: -0.12857063114643097, mean p set: 0.4496400058269501
loss_pred:0.015103592537343502, decouple_loss:0.0004536640190053731
loss_pred:0.014377526007592678, decouple_loss:0.0004631493939086795
Iteration: 1952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480970501899719, gen p mean: -0.1252274215221405, mean p set: 0.44867458939552307
loss_pred:0.015337275341153145, decouple_loss:0.0006715877098031342
The modified gen p mean: 0.4487510025501251, gen p mean: -0.1287141740322113, mean p set: 0.4493279755115509The modified gen p mean: 0.4478608965873718, gen p mean: -0.12692897021770477, mean p set: 0.44843384623527527
loss_pred:0.013713828288018703, decouple_loss:0.00047301940503530204loss_pred:0.014734582975506783, decouple_loss:0.0005636478308588266
Iteration: 1953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728872179985046, gen p mean: -0.12099386751651764, mean p set: 0.44786569476127625
loss_pred:0.014571639709174633, decouple_loss:0.0008761009084992111
The modified gen p mean: 0.4515610337257385, gen p mean: -0.12317154556512833, mean p set: 0.4521370232105255
loss_pred:0.014470483176410198, decouple_loss:0.0008676560828462243
The modified gen p mean: 0.4483228325843811, gen p mean: -0.12155374884605408, mean p set: 0.44889771938323975
loss_pred:0.015655431896448135, decouple_loss:0.0007581525132991374
Iteration: 1954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810354709625244, gen p mean: -0.13019254803657532, mean p set: 0.44867774844169617
loss_pred:0.014925839379429817, decouple_loss:0.0006525648641400039
The modified gen p mean: 0.4470195174217224, gen p mean: -0.1301313042640686, mean p set: 0.4475933015346527
loss_pred:0.01499566063284874, decouple_loss:0.0005228436202742159
The modified gen p mean: 0.44775670766830444, gen p mean: -0.1203191801905632, mean p set: 0.44833314418792725
loss_pred:0.015117807313799858, decouple_loss:0.0005125487223267555
Iteration: 1955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756534695625305, gen p mean: -0.11817911267280579, mean p set: 0.4481402039527893
loss_pred:0.014719204045832157, decouple_loss:0.0007364099728874862
The modified gen p mean: 0.4473387897014618, gen p mean: -0.11413802206516266, mean p set: 0.4479128420352936
loss_pred:0.014379956759512424, decouple_loss:0.0005608242354355752
The modified gen p mean: 0.4466926157474518, gen p mean: -0.12360040843486786, mean p set: 0.4472704529762268
loss_pred:0.01462317630648613, decouple_loss:0.000597087200731039
Iteration: 1956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468212425708771, gen p mean: -0.11489935964345932, mean p set: 0.447394996881485
loss_pred:0.014319123700261116, decouple_loss:0.00052877317648381
The modified gen p mean: 0.4497036933898926, gen p mean: -0.12086087465286255, mean p set: 0.4502794146537781
loss_pred:0.014612851664423943, decouple_loss:0.0007330835214816034
The modified gen p mean: 0.44883695244789124, gen p mean: -0.12546883523464203, mean p set: 0.4494149386882782
loss_pred:0.014675808139145374, decouple_loss:0.0006744251004420221
Iteration: 1957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756776094436646, gen p mean: -0.11685136705636978, mean p set: 0.44814345240592957
loss_pred:0.015248289331793785, decouple_loss:0.0005343345110304654
The modified gen p mean: 0.4489095211029053, gen p mean: -0.12580262124538422, mean p set: 0.4494871497154236
loss_pred:0.013162411749362946, decouple_loss:0.0006824962911196053
The modified gen p mean: 0.4474612772464752, gen p mean: -0.11624691635370255, mean p set: 0.44803765416145325
loss_pred:0.014673245139420033, decouple_loss:0.0006168093532323837
Iteration: 1958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853001832962036, gen p mean: -0.1239381805062294, mean p set: 0.44910797476768494
loss_pred:0.013903872109949589, decouple_loss:0.0005421510431915522
The modified gen p mean: 0.45065611600875854, gen p mean: -0.11784711480140686, mean p set: 0.45123034715652466
loss_pred:0.014084151946008205, decouple_loss:0.0005704861832782626
The modified gen p mean: 0.44871076941490173, gen p mean: -0.11468981206417084, mean p set: 0.4492860734462738
loss_pred:0.014485209248960018, decouple_loss:0.000470938888611272
Iteration: 1959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732025265693665, gen p mean: -0.1210084855556488, mean p set: 0.4478965699672699
loss_pred:0.01462893933057785, decouple_loss:0.0005970393540337682
The modified gen p mean: 0.4485984146595001, gen p mean: -0.1203576847910881, mean p set: 0.449176549911499
The modified gen p mean: 0.4496596157550812, gen p mean: -0.11409983038902283, mean p set: 0.4502353370189667
loss_pred:0.01460207998752594, decouple_loss:0.0005776318139396608
loss_pred:0.013902664184570312, decouple_loss:0.0006493853288702667
Iteration: 1960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449516236782074, gen p mean: -0.12576252222061157, mean p set: 0.45009157061576843
loss_pred:0.013678602874279022, decouple_loss:0.0005965382442809641
The modified gen p mean: 0.4484652280807495, gen p mean: -0.12544529139995575, mean p set: 0.44904303550720215
loss_pred:0.015062067657709122, decouple_loss:0.0005049665924161673
The modified gen p mean: 0.4481000602245331, gen p mean: -0.1307801902294159, mean p set: 0.44867387413978577
loss_pred:0.014530173502862453, decouple_loss:0.000503784918691963
2023-05-02 10:43:34 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1294839084148407, mean p set: 0.4502691626548767
loss_pred:0.016994768753647804, decouple_loss:0.0005692559061571956
The modified gen p mean: 0.4495335519313812, gen p mean: -0.12254641205072403, mean p set: 0.4500633478164673
loss_pred:0.016241488978266716, decouple_loss:0.0006464853649958968
The modified gen p mean: 0.4498295485973358, gen p mean: -0.1217174082994461, mean p set: 0.45035696029663086
loss_pred:0.016601858660578728, decouple_loss:0.0006047876086086035
WV_1_PC_1_EH_0_PS_40, loss: 0.016643047332763672, avg_mse: 0.025933800265192986
current test mse: 0.025934
Iteration: 1961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903287291526794, gen p mean: -0.13064241409301758, mean p set: 0.4496042728424072
loss_pred:0.013122009113430977, decouple_loss:0.0005880870157852769
The modified gen p mean: 0.4477611184120178, gen p mean: -0.1207333654165268, mean p set: 0.4483363628387451The modified gen p mean: 0.448807954788208, gen p mean: -0.11764445900917053, mean p set: 0.4493841528892517
loss_pred:0.0148640600964427, decouple_loss:0.0006705629057250917
loss_pred:0.014548211358487606, decouple_loss:0.0007443393697030842
Iteration: 1962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716066122055054, gen p mean: -0.1124521866440773, mean p set: 0.4477371871471405
loss_pred:0.014564375393092632, decouple_loss:0.0004970162408426404
The modified gen p mean: 0.44717392325401306, gen p mean: -0.12215062975883484, mean p set: 0.4477499723434448The modified gen p mean: 0.44745028018951416, gen p mean: -0.11493103951215744, mean p set: 0.4480287730693817
loss_pred:0.014429187402129173, decouple_loss:0.0007152248290367424
loss_pred:0.015277029015123844, decouple_loss:0.0006523047341033816
Iteration: 1963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45009827613830566, gen p mean: -0.1139838919043541, mean p set: 0.45067334175109863
The modified gen p mean: 0.4482802748680115, gen p mean: -0.122149758040905, mean p set: 0.44885799288749695
loss_pred:0.01393596176058054, decouple_loss:0.0006195830646902323
loss_pred:0.014221989549696445, decouple_loss:0.00070099753793329
The modified gen p mean: 0.44994115829467773, gen p mean: -0.11420472711324692, mean p set: 0.4505176842212677
loss_pred:0.013685067184269428, decouple_loss:0.0007270033238455653
Iteration: 1964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489854872226715, gen p mean: -0.12237653881311417, mean p set: 0.4495624303817749
loss_pred:0.013993523083627224, decouple_loss:0.000577637692913413
The modified gen p mean: 0.44802168011665344, gen p mean: -0.11929086595773697, mean p set: 0.44859644770622253
loss_pred:0.014411689713597298, decouple_loss:0.0007661156123504043
The modified gen p mean: 0.44760212302207947, gen p mean: -0.11616439372301102, mean p set: 0.4481779932975769
loss_pred:0.01531759463250637, decouple_loss:0.0005826874403283
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
NaN value num: 0
Iteration: 1965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487343430519104, gen p mean: -0.11736731231212616, mean p set: 0.44931429624557495
The modified gen p mean: 0.44974449276924133, gen p mean: -0.12012078613042831, mean p set: 0.45031872391700745
loss_pred:0.01603843830525875, decouple_loss:0.0005390786682255566
loss_pred:0.015169774182140827, decouple_loss:0.0007132211467251182
The modified gen p mean: 0.448507696390152, gen p mean: -0.11817775666713715, mean p set: 0.44908347725868225
loss_pred:0.01518145389854908, decouple_loss:0.0007741062436252832
Iteration: 1966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44988828897476196, gen p mean: -0.12324909120798111, mean p set: 0.4504653811454773
loss_pred:0.01516935508698225, decouple_loss:0.0006217923946678638
The modified gen p mean: 0.4487963020801544, gen p mean: -0.12364352494478226, mean p set: 0.44937488436698914
loss_pred:0.015050388872623444, decouple_loss:0.0005069914041087031
The modified gen p mean: 0.45009902119636536, gen p mean: -0.1175692081451416, mean p set: 0.45067429542541504
loss_pred:0.015125425532460213, decouple_loss:0.0007027902756817639
Iteration: 1967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45074257254600525, gen p mean: -0.11610100418329239, mean p set: 0.4513188898563385
loss_pred:0.015271534211933613, decouple_loss:0.0006911869859322906
The modified gen p mean: 0.4500536024570465, gen p mean: -0.11922503262758255, mean p set: 0.4506286382675171
The modified gen p mean: 0.44873368740081787, gen p mean: -0.11642967909574509, mean p set: 0.44931018352508545
loss_pred:0.014791898429393768, decouple_loss:0.0004742141754832119
loss_pred:0.01572955958545208, decouple_loss:0.00071272550849244
Iteration: 1968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930925965309143, gen p mean: -0.12248614430427551, mean p set: 0.4498820900917053
loss_pred:0.01477838959544897, decouple_loss:0.0007150900783017278
The modified gen p mean: 0.45026895403862, gen p mean: -0.11569228023290634, mean p set: 0.4508443772792816
The modified gen p mean: 0.4497082531452179, gen p mean: -0.11440368741750717, mean p set: 0.4502848982810974
loss_pred:0.01517737377434969, decouple_loss:0.0005899797542952001
loss_pred:0.015241461805999279, decouple_loss:0.0006343655986711383
Iteration: 1969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484233558177948, gen p mean: -0.11477655917406082, mean p set: 0.4490005075931549
loss_pred:0.015008862130343914, decouple_loss:0.0005057903472334146
The modified gen p mean: 0.45094120502471924, gen p mean: -0.1167755126953125, mean p set: 0.45151427388191223
loss_pred:0.015379575081169605, decouple_loss:0.0005708217504434288
The modified gen p mean: 0.4481448829174042, gen p mean: -0.11639154702425003, mean p set: 0.4487225413322449
loss_pred:0.014970497228205204, decouple_loss:0.0006191200227476656
Iteration: 1970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45046666264533997, gen p mean: -0.11978334933519363, mean p set: 0.45104461908340454
loss_pred:0.015184903517365456, decouple_loss:0.0005720567423850298
The modified gen p mean: 0.44891688227653503, gen p mean: -0.11869700998067856, mean p set: 0.449493408203125
loss_pred:0.015405312180519104, decouple_loss:0.00070163857890293
The modified gen p mean: 0.45007577538490295, gen p mean: -0.11623453348875046, mean p set: 0.4506531357765198
loss_pred:0.015387135557830334, decouple_loss:0.0005923591670580208
2023-05-02 10:46:17 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12766174972057343, mean p set: 0.4502691626548767
loss_pred:0.016973290592432022, decouple_loss:0.0004897034377790987
The modified gen p mean: 0.4495341181755066, gen p mean: -0.12068039923906326, mean p set: 0.4500633478164673
loss_pred:0.0162358395755291, decouple_loss:0.0005210596136748791
The modified gen p mean: 0.44982844591140747, gen p mean: -0.11986442655324936, mean p set: 0.45035696029663086
loss_pred:0.016576776280999184, decouple_loss:0.0004661305865738541
WV_1_PC_1_EH_0_PS_40, loss: 0.016619917005300522, avg_mse: 0.02583841234445572
current test mse: 0.025838
Iteration: 1971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947344064712524, gen p mean: -0.11519617587327957, mean p set: 0.45005032420158386
loss_pred:0.014677202329039574, decouple_loss:0.0004298654675949365
The modified gen p mean: 0.4498271048069, gen p mean: -0.1147371307015419, mean p set: 0.45040175318717957
The modified gen p mean: 0.45024028420448303, gen p mean: -0.109436996281147, mean p set: 0.4508165121078491
loss_pred:0.014690946787595749, decouple_loss:0.0004124416154809296
loss_pred:0.014777579344809055, decouple_loss:0.0004317461571190506
Iteration: 1972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879597425460815, gen p mean: -0.11647702753543854, mean p set: 0.44937294721603394
loss_pred:0.014642653986811638, decouple_loss:0.0004754209076054394
The modified gen p mean: 0.4488762617111206, gen p mean: -0.11451878398656845, mean p set: 0.44945380091667175The modified gen p mean: 0.4502139389514923, gen p mean: -0.11476966738700867, mean p set: 0.45079106092453003
loss_pred:0.015122797340154648, decouple_loss:0.0005270158289931715
loss_pred:0.014906344003975391, decouple_loss:0.0006255634361878037
Iteration: 1973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44988754391670227, gen p mean: -0.11104261875152588, mean p set: 0.45046308636665344
loss_pred:0.015174596570432186, decouple_loss:0.0006147555541247129
The modified gen p mean: 0.4501025378704071, gen p mean: -0.1173015907406807, mean p set: 0.45067667961120605
loss_pred:0.01463306788355112, decouple_loss:0.0006192062282934785
The modified gen p mean: 0.44813334941864014, gen p mean: -0.10949068516492844, mean p set: 0.44870832562446594
loss_pred:0.015512550249695778, decouple_loss:0.0005878114607185125
Iteration: 1974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071515440940857, gen p mean: -0.11526395380496979, mean p set: 0.4512903094291687
loss_pred:0.014889394864439964, decouple_loss:0.0005423516849987209
The modified gen p mean: 0.4501287639141083, gen p mean: -0.12128786742687225, mean p set: 0.4507039785385132
loss_pred:0.014933299273252487, decouple_loss:0.0005685332580469549
The modified gen p mean: 0.4499547779560089, gen p mean: -0.11634932458400726, mean p set: 0.45053014159202576
loss_pred:0.014581413008272648, decouple_loss:0.0007794591365382075
Iteration: 1975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511799216270447, gen p mean: -0.11236301809549332, mean p set: 0.45175716280937195
loss_pred:0.014947116374969482, decouple_loss:0.00044355657882988453
The modified gen p mean: 0.4497810900211334, gen p mean: -0.12665334343910217, mean p set: 0.4503578245639801
loss_pred:0.015755226835608482, decouple_loss:0.000526765885297209
The modified gen p mean: 0.45004597306251526, gen p mean: -0.12111438065767288, mean p set: 0.4506239891052246
loss_pred:0.014728136360645294, decouple_loss:0.0005081404815427959
Iteration: 1976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485052227973938, gen p mean: -0.12319166958332062, mean p set: 0.4490794241428375
loss_pred:0.01512353215366602, decouple_loss:0.0008096203091554344
The modified gen p mean: 0.4485195279121399, gen p mean: -0.12431138008832932, mean p set: 0.44909584522247314
loss_pred:0.014759290963411331, decouple_loss:0.0007439355249516666
The modified gen p mean: 0.44987767934799194, gen p mean: -0.1211118996143341, mean p set: 0.45045775175094604
loss_pred:0.01453158538788557, decouple_loss:0.000744304561521858
Iteration: 1977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450041800737381, gen p mean: -0.12243255227804184, mean p set: 0.45061951875686646
loss_pred:0.014948813244700432, decouple_loss:0.0005815847543999553
The modified gen p mean: 0.45071732997894287, gen p mean: -0.12271321564912796, mean p set: 0.4512932300567627
loss_pred:0.014953410252928734, decouple_loss:0.0005497391102835536
The modified gen p mean: 0.4482609033584595, gen p mean: -0.12075038999319077, mean p set: 0.4488380551338196
loss_pred:0.014698675833642483, decouple_loss:0.00045880183461122215
Iteration: 1978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44941720366477966, gen p mean: -0.12048596888780594, mean p set: 0.4499933123588562
loss_pred:0.014839042909443378, decouple_loss:0.0005762046203017235
The modified gen p mean: 0.44976869225502014, gen p mean: -0.12436320632696152, mean p set: 0.4503445625305176
The modified gen p mean: 0.4481922686100006, gen p mean: -0.11753346771001816, mean p set: 0.4487698972225189
loss_pred:0.015611467882990837, decouple_loss:0.0005232905386947095
loss_pred:0.014994356781244278, decouple_loss:0.0005028685554862022
Iteration: 1979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082923769950867, gen p mean: -0.10518750548362732, mean p set: 0.4514070451259613
loss_pred:0.01563933491706848, decouple_loss:0.0005580778233706951
The modified gen p mean: 0.45000502467155457, gen p mean: -0.11408469825983047, mean p set: 0.45058220624923706
loss_pred:0.014957739971578121, decouple_loss:0.0005544075975194573
The modified gen p mean: 0.4485129415988922, gen p mean: -0.11291863769292831, mean p set: 0.44908758997917175
loss_pred:0.015559566207230091, decouple_loss:0.0004261774884071201
Iteration: 1980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510844945907593, gen p mean: -0.10909067839384079, mean p set: 0.4516618549823761The modified gen p mean: 0.4506646692752838, gen p mean: -0.11109677702188492, mean p set: 0.4512398838996887
loss_pred:0.01501170452684164, decouple_loss:0.0003867332998197526
loss_pred:0.01526444312185049, decouple_loss:0.00046695375931449234
The modified gen p mean: 0.45040321350097656, gen p mean: -0.11073056608438492, mean p set: 0.4509795904159546
loss_pred:0.015036145225167274, decouple_loss:0.00047595190699212253
2023-05-02 10:48:22 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11897843331098557, mean p set: 0.4502691626548767
loss_pred:0.016955314204096794, decouple_loss:0.0006031136144883931
The modified gen p mean: 0.4495338201522827, gen p mean: -0.11206674575805664, mean p set: 0.4500633478164673
loss_pred:0.01624281518161297, decouple_loss:0.0006733651389367878
The modified gen p mean: 0.44982966780662537, gen p mean: -0.11138392239809036, mean p set: 0.45035696029663086
loss_pred:0.016699960455298424, decouple_loss:0.0005283229402266443
WV_1_PC_1_EH_0_PS_40, loss: 0.016662776470184326, avg_mse: 0.02587147429585457
current test mse: 0.025871
Iteration: 1981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877463579177856, gen p mean: -0.1119280532002449, mean p set: 0.4493492543697357
loss_pred:0.015136810019612312, decouple_loss:0.0006164009100757539
The modified gen p mean: 0.44926074147224426, gen p mean: -0.10888718068599701, mean p set: 0.44983693957328796The modified gen p mean: 0.44975900650024414, gen p mean: -0.11191429942846298, mean p set: 0.45033547282218933
loss_pred:0.014853456988930702, decouple_loss:0.000506936339661479
loss_pred:0.015192410908639431, decouple_loss:0.0006002334412187338
Iteration: 1982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508485198020935, gen p mean: -0.10095734894275665, mean p set: 0.4514269232749939
The modified gen p mean: 0.45001617074012756, gen p mean: -0.10446260124444962, mean p set: 0.4505939483642578
loss_pred:0.015829820185899734, decouple_loss:0.0005875896895304322
loss_pred:0.015165945515036583, decouple_loss:0.0008324182126671076
The modified gen p mean: 0.44949862360954285, gen p mean: -0.1096925288438797, mean p set: 0.4500750005245209
loss_pred:0.01500549353659153, decouple_loss:0.000495195621624589
Iteration: 1983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501799941062927, gen p mean: -0.10348904132843018, mean p set: 0.4507562518119812
loss_pred:0.015231777913868427, decouple_loss:0.0006193008157424629
The modified gen p mean: 0.45006781816482544, gen p mean: -0.1033693253993988, mean p set: 0.45064401626586914
loss_pred:0.015089113265275955, decouple_loss:0.0005403812974691391
The modified gen p mean: 0.45108461380004883, gen p mean: -0.10346491634845734, mean p set: 0.451661616563797
loss_pred:0.015619966201484203, decouple_loss:0.00045576292905025184
Iteration: 1984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502390921115875, gen p mean: -0.10857616364955902, mean p set: 0.45081597566604614
The modified gen p mean: 0.44936394691467285, gen p mean: -0.11450796574354172, mean p set: 0.44993993639945984
loss_pred:0.01541403029114008, decouple_loss:0.0005263420753180981
loss_pred:0.01592184416949749, decouple_loss:0.0008072152268141508
The modified gen p mean: 0.4504140615463257, gen p mean: -0.11131151020526886, mean p set: 0.45099109411239624
loss_pred:0.014942113310098648, decouple_loss:0.0005108727491460741
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
NaN value num: 0
Iteration: 1985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45148003101348877, gen p mean: -0.11729598045349121, mean p set: 0.45205825567245483
loss_pred:0.015548166818916798, decouple_loss:0.0005260463221929967
The modified gen p mean: 0.45002299547195435, gen p mean: -0.11435549706220627, mean p set: 0.45059797167778015
loss_pred:0.015408499166369438, decouple_loss:0.0007340049487538636
The modified gen p mean: 0.4496965706348419, gen p mean: -0.11724291741847992, mean p set: 0.45027294754981995
loss_pred:0.015782807022333145, decouple_loss:0.0008250048849731684
Iteration: 1986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515921473503113, gen p mean: -0.12179891020059586, mean p set: 0.4521687626838684
loss_pred:0.015626922249794006, decouple_loss:0.0004898190381936729
The modified gen p mean: 0.4489080309867859, gen p mean: -0.11733096092939377, mean p set: 0.4494839310646057
The modified gen p mean: 0.44964733719825745, gen p mean: -0.1162196472287178, mean p set: 0.4502235949039459
loss_pred:0.015094929374754429, decouple_loss:0.000609429320320487
loss_pred:0.015401609241962433, decouple_loss:0.0004416193114593625
Iteration: 1987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509834945201874, gen p mean: -0.1282113790512085, mean p set: 0.45155924558639526
loss_pred:0.014986658468842506, decouple_loss:0.0005437719519250095
The modified gen p mean: 0.44865164160728455, gen p mean: -0.12879911065101624, mean p set: 0.44922852516174316
The modified gen p mean: 0.44770440459251404, gen p mean: -0.12684786319732666, mean p set: 0.4482796788215637
loss_pred:0.014897222630679607, decouple_loss:0.0004226187593303621
loss_pred:0.014861159026622772, decouple_loss:0.0004081208899151534
Iteration: 1988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515478312969208, gen p mean: -0.13245889544487, mean p set: 0.4521230459213257
loss_pred:0.01511796098202467, decouple_loss:0.000541627174243331
The modified gen p mean: 0.44800493121147156, gen p mean: -0.13322967290878296, mean p set: 0.4485791027545929
loss_pred:0.015033899806439877, decouple_loss:0.00042932224459946156
The modified gen p mean: 0.4496874213218689, gen p mean: -0.1293465942144394, mean p set: 0.45026326179504395
loss_pred:0.015342985279858112, decouple_loss:0.0006048939540050924
Iteration: 1989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516121745109558, gen p mean: -0.12212681025266647, mean p set: 0.4521893560886383
loss_pred:0.01551258284598589, decouple_loss:0.0005926724406890571
The modified gen p mean: 0.4500621557235718, gen p mean: -0.11737580597400665, mean p set: 0.4506383240222931
The modified gen p mean: 0.44843044877052307, gen p mean: -0.11707602441310883, mean p set: 0.44900739192962646
loss_pred:0.015504783019423485, decouple_loss:0.0005792747251689434
loss_pred:0.015735125169157982, decouple_loss:0.0005983793525956571
Iteration: 1990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45205289125442505, gen p mean: -0.1228998601436615, mean p set: 0.45262959599494934
loss_pred:0.014416778460144997, decouple_loss:0.0004973647883161902
The modified gen p mean: 0.45145416259765625, gen p mean: -0.12342694401741028, mean p set: 0.4520282447338104
The modified gen p mean: 0.4510728418827057, gen p mean: -0.12103261053562164, mean p set: 0.4516487121582031
loss_pred:0.015169001184403896, decouple_loss:0.00042387988651171327
loss_pred:0.015419105999171734, decouple_loss:0.0004274013626854867
2023-05-02 10:51:00 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1352926343679428, mean p set: 0.4502691626548767
loss_pred:0.01716356724500656, decouple_loss:0.00045851044706068933
The modified gen p mean: 0.44953352212905884, gen p mean: -0.128721684217453, mean p set: 0.4500633478164673
loss_pred:0.016442105174064636, decouple_loss:0.0005144295864738524
The modified gen p mean: 0.44982439279556274, gen p mean: -0.127701073884964, mean p set: 0.45035696029663086
loss_pred:0.01669801026582718, decouple_loss:0.0005134876701049507
WV_1_PC_1_EH_0_PS_40, loss: 0.016792668029665947, avg_mse: 0.02611633576452732
current test mse: 0.026116
Iteration: 1991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982483983039856, gen p mean: -0.12756521999835968, mean p set: 0.450398713350296
loss_pred:0.015083792619407177, decouple_loss:0.0005046370206400752
The modified gen p mean: 0.4493926763534546, gen p mean: -0.12690410017967224, mean p set: 0.449969619512558
loss_pred:0.015587483532726765, decouple_loss:0.0004103413375560194
The modified gen p mean: 0.44968676567077637, gen p mean: -0.1287248730659485, mean p set: 0.4502636790275574
loss_pred:0.014639426954090595, decouple_loss:0.00047872524010017514
Iteration: 1992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44899359345436096, gen p mean: -0.12615618109703064, mean p set: 0.44957149028778076
loss_pred:0.015678200870752335, decouple_loss:0.0003791745693888515
The modified gen p mean: 0.44858378171920776, gen p mean: -0.12688472867012024, mean p set: 0.4491605758666992The modified gen p mean: 0.45062193274497986, gen p mean: -0.12996624410152435, mean p set: 0.4511985182762146
loss_pred:0.014845207333564758, decouple_loss:0.0004064054519403726loss_pred:0.01513747125864029, decouple_loss:0.0005237056757323444
Iteration: 1993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755271077156067, gen p mean: -0.12045370042324066, mean p set: 0.44812753796577454
The modified gen p mean: 0.4512932002544403, gen p mean: -0.12290786951780319, mean p set: 0.45187318325042725
loss_pred:0.015550361014902592, decouple_loss:0.000568260729778558
loss_pred:0.014873848296701908, decouple_loss:0.0005281283520162106
The modified gen p mean: 0.44798731803894043, gen p mean: -0.12731510400772095, mean p set: 0.44856342673301697
loss_pred:0.01463925652205944, decouple_loss:0.0005471404874697328
Iteration: 1994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482431411743164, gen p mean: -0.1163700744509697, mean p set: 0.44882118701934814
loss_pred:0.015455669723451138, decouple_loss:0.00042128562927246094
The modified gen p mean: 0.4507617652416229, gen p mean: -0.12573851644992828, mean p set: 0.4513396918773651
loss_pred:0.014821887947618961, decouple_loss:0.0004088622226845473
The modified gen p mean: 0.45059189200401306, gen p mean: -0.1237834244966507, mean p set: 0.4511696398258209
loss_pred:0.015650641173124313, decouple_loss:0.0005228071240708232
Iteration: 1995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503668546676636, gen p mean: -0.12458588182926178, mean p set: 0.4509415924549103
loss_pred:0.014613613486289978, decouple_loss:0.000524182221852243
The modified gen p mean: 0.45010414719581604, gen p mean: -0.12129169702529907, mean p set: 0.4506807327270508
The modified gen p mean: 0.4513099491596222, gen p mean: -0.12510472536087036, mean p set: 0.45188701152801514
loss_pred:0.014692962169647217, decouple_loss:0.0005842888494953513
loss_pred:0.014349089004099369, decouple_loss:0.0006255288026295602
Iteration: 1996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502844512462616, gen p mean: -0.1234140545129776, mean p set: 0.45085906982421875
loss_pred:0.014834071509540081, decouple_loss:0.0006210426799952984
The modified gen p mean: 0.44829994440078735, gen p mean: -0.12720754742622375, mean p set: 0.44887110590934753
loss_pred:0.01575872302055359, decouple_loss:0.0007649864419363439
The modified gen p mean: 0.45099884271621704, gen p mean: -0.12200681865215302, mean p set: 0.45157620310783386
loss_pred:0.015146346762776375, decouple_loss:0.0005773698212578893
Iteration: 1997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484981894493103, gen p mean: -0.12730181217193604, mean p set: 0.44907721877098083
loss_pred:0.014944260939955711, decouple_loss:0.0005037203663960099
The modified gen p mean: 0.4510018825531006, gen p mean: -0.12327495217323303, mean p set: 0.4515781104564667
loss_pred:0.015249754302203655, decouple_loss:0.0004779518349096179
The modified gen p mean: 0.4520108699798584, gen p mean: -0.12785649299621582, mean p set: 0.45258763432502747
loss_pred:0.015378192998468876, decouple_loss:0.0006257806671783328
Iteration: 1998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44986647367477417, gen p mean: -0.12294764816761017, mean p set: 0.45044276118278503
loss_pred:0.014870028011500835, decouple_loss:0.000474923086585477
The modified gen p mean: 0.45016050338745117, gen p mean: -0.12278839200735092, mean p set: 0.45073628425598145
The modified gen p mean: 0.4511236846446991, gen p mean: -0.12075385451316833, mean p set: 0.4517004191875458
loss_pred:0.015070026740431786, decouple_loss:0.000481368595501408
loss_pred:0.014570890925824642, decouple_loss:0.00047660808195360005
Iteration: 1999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45035988092422485, gen p mean: -0.11413200199604034, mean p set: 0.45093685388565063
The modified gen p mean: 0.4491238296031952, gen p mean: -0.12024987488985062, mean p set: 0.4497029781341553
loss_pred:0.015153192915022373, decouple_loss:0.0007964430842548609
loss_pred:0.01466151513159275, decouple_loss:0.0006361500709317625
The modified gen p mean: 0.4506259262561798, gen p mean: -0.11953570693731308, mean p set: 0.4512050449848175
loss_pred:0.014717365615069866, decouple_loss:0.0006372399511747062
Iteration: 2000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505137801170349, gen p mean: -0.11528067290782928, mean p set: 0.4510902166366577
loss_pred:0.014546990394592285, decouple_loss:0.0008260551257990301
The modified gen p mean: 0.4485549032688141, gen p mean: -0.11343853920698166, mean p set: 0.4491298198699951
The modified gen p mean: 0.45177650451660156, gen p mean: -0.11998757719993591, mean p set: 0.45235374569892883
loss_pred:0.014813662506639957, decouple_loss:0.0005437803920358419
loss_pred:0.013992574997246265, decouple_loss:0.0006320592947304249
2023-05-02 10:53:05 itr: 2000
training loss: [0.01402418 0.01458829 0.01484085]
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_2000.ckpt
2023-05-02 10:53:09 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13135528564453125, mean p set: 0.4502691626548767
loss_pred:0.017107181251049042, decouple_loss:0.0005062861600890756
The modified gen p mean: 0.44953295588493347, gen p mean: -0.12449675053358078, mean p set: 0.4500633478164673
loss_pred:0.016564855352044106, decouple_loss:0.00056733243400231
The modified gen p mean: 0.4498263895511627, gen p mean: -0.12320880591869354, mean p set: 0.45035696029663086
loss_pred:0.016741923987865448, decouple_loss:0.0005045203724876046
WV_1_PC_1_EH_0_PS_40, loss: 0.01683095656335354, avg_mse: 0.02608628384768963
current test mse: 0.026086
Iteration: 2001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487170875072479, gen p mean: -0.12101449817419052, mean p set: 0.44929447770118713
loss_pred:0.01500854454934597, decouple_loss:0.0006351531483232975
The modified gen p mean: 0.4499571621417999, gen p mean: -0.12027638405561447, mean p set: 0.4505334198474884The modified gen p mean: 0.44826599955558777, gen p mean: -0.11822795122861862, mean p set: 0.44883993268013
loss_pred:0.015079156495630741, decouple_loss:0.0005103392177261412
loss_pred:0.014501063153147697, decouple_loss:0.000545709568541497
Iteration: 2002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478340744972229, gen p mean: -0.1270732283592224, mean p set: 0.44841381907463074
loss_pred:0.014816983602941036, decouple_loss:0.0004633188946172595
The modified gen p mean: 0.4482364058494568, gen p mean: -0.12425220012664795, mean p set: 0.44880905747413635The modified gen p mean: 0.44818851351737976, gen p mean: -0.11909962445497513, mean p set: 0.4487653374671936
loss_pred:0.015263768844306469, decouple_loss:0.0005917576490901411loss_pred:0.014861651696264744, decouple_loss:0.00048656630679033697
Iteration: 2003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519217908382416, gen p mean: -0.12788578867912292, mean p set: 0.45250096917152405
loss_pred:0.015203807502985, decouple_loss:0.0005744834779761732
The modified gen p mean: 0.4508035480976105, gen p mean: -0.1266641914844513, mean p set: 0.45137983560562134
loss_pred:0.014850134029984474, decouple_loss:0.0005288060638122261
The modified gen p mean: 0.45084550976753235, gen p mean: -0.122674360871315, mean p set: 0.4514223337173462
loss_pred:0.014942610636353493, decouple_loss:0.0005400122026912868
Iteration: 2004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790810346603394, gen p mean: -0.12882694602012634, mean p set: 0.44848257303237915
loss_pred:0.014664484187960625, decouple_loss:0.0004999171360395849
The modified gen p mean: 0.44943591952323914, gen p mean: -0.12895320355892181, mean p set: 0.45001283288002014
loss_pred:0.014500035904347897, decouple_loss:0.000674354494549334
The modified gen p mean: 0.4505113363265991, gen p mean: -0.12572352588176727, mean p set: 0.45108291506767273
loss_pred:0.014732723124325275, decouple_loss:0.0004511655424721539
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 2005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44662144780158997, gen p mean: -0.13156650960445404, mean p set: 0.44719746708869934
The modified gen p mean: 0.446956604719162, gen p mean: -0.132186159491539, mean p set: 0.4475364685058594
loss_pred:0.015381346456706524, decouple_loss:0.00045352859888225794
loss_pred:0.014885511249303818, decouple_loss:0.000504285329952836
The modified gen p mean: 0.4467133581638336, gen p mean: -0.1320270299911499, mean p set: 0.44729331135749817
loss_pred:0.015516436658799648, decouple_loss:0.00043149932753294706
Iteration: 2006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467000961303711, gen p mean: -0.12280785292387009, mean p set: 0.44727569818496704
loss_pred:0.014958277344703674, decouple_loss:0.0006785194273106754
The modified gen p mean: 0.44596168398857117, gen p mean: -0.12245069444179535, mean p set: 0.44653791189193726
The modified gen p mean: 0.44664517045021057, gen p mean: -0.12868455052375793, mean p set: 0.44722166657447815
loss_pred:0.015378438867628574, decouple_loss:0.000645291293039918
loss_pred:0.015309348702430725, decouple_loss:0.0005606963532045484
Iteration: 2007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669023156166077, gen p mean: -0.12342790514230728, mean p set: 0.4472668468952179
loss_pred:0.015057224780321121, decouple_loss:0.00044861005153506994
The modified gen p mean: 0.44657102227211, gen p mean: -0.1185535416007042, mean p set: 0.4471467435359955
The modified gen p mean: 0.4450806975364685, gen p mean: -0.11911755055189133, mean p set: 0.44565579295158386
loss_pred:0.014813590794801712, decouple_loss:0.0004311561642680317
loss_pred:0.015221910551190376, decouple_loss:0.0007103363750502467
Iteration: 2008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467444121837616, gen p mean: -0.11791504919528961, mean p set: 0.4473183751106262
loss_pred:0.01545295212417841, decouple_loss:0.00042441010009497404
The modified gen p mean: 0.4465274512767792, gen p mean: -0.1145862266421318, mean p set: 0.4471038281917572
The modified gen p mean: 0.44623100757598877, gen p mean: -0.12157679349184036, mean p set: 0.44680705666542053
loss_pred:0.015434462577104568, decouple_loss:0.0003797548124566674
loss_pred:0.01532779261469841, decouple_loss:0.0004155371861997992
Iteration: 2009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446338415145874, gen p mean: -0.11830035597085953, mean p set: 0.44691362977027893
loss_pred:0.01524877268821001, decouple_loss:0.0006134393042884767
The modified gen p mean: 0.44657471776008606, gen p mean: -0.12017999589443207, mean p set: 0.4471500515937805
The modified gen p mean: 0.4470558762550354, gen p mean: -0.11402573436498642, mean p set: 0.4476316571235657
loss_pred:0.015486899763345718, decouple_loss:0.0006892714882269502
loss_pred:0.015573493205010891, decouple_loss:0.0006659441278316081
Iteration: 2010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464833736419678, gen p mean: -0.11824588477611542, mean p set: 0.44706007838249207
loss_pred:0.014614223502576351, decouple_loss:0.0004690994101110846
The modified gen p mean: 0.4469131827354431, gen p mean: -0.12360047549009323, mean p set: 0.44748565554618835
The modified gen p mean: 0.4472496509552002, gen p mean: -0.12177584320306778, mean p set: 0.44782721996307373
loss_pred:0.014664954505860806, decouple_loss:0.00042539541027508676
loss_pred:0.014771278947591782, decouple_loss:0.0005548710469156504
2023-05-02 10:55:54 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.12427051365375519, mean p set: 0.4502691626548767
loss_pred:0.01683868281543255, decouple_loss:0.0005537785473279655
The modified gen p mean: 0.44953903555870056, gen p mean: -0.11743313074111938, mean p set: 0.4500633478164673
loss_pred:0.016245586797595024, decouple_loss:0.0005537352408282459
The modified gen p mean: 0.4498305022716522, gen p mean: -0.1161552220582962, mean p set: 0.45035696029663086
loss_pred:0.016540374606847763, decouple_loss:0.0004996650968678296
WV_1_PC_1_EH_0_PS_40, loss: 0.016568336635828018, avg_mse: 0.02573610283434391
current test mse: 0.025736
Iteration: 2011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474675953388214, gen p mean: -0.11753403395414352, mean p set: 0.4480440020561218
loss_pred:0.014611640945076942, decouple_loss:0.0004896172904409468
The modified gen p mean: 0.4469229578971863, gen p mean: -0.11805251985788345, mean p set: 0.44749704003334045
loss_pred:0.01581643894314766, decouple_loss:0.00042436111834831536
The modified gen p mean: 0.4464721381664276, gen p mean: -0.11692104488611221, mean p set: 0.44704607129096985
loss_pred:0.014653545804321766, decouple_loss:0.00038876882172189653
Iteration: 2012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471525549888611, gen p mean: -0.1205333024263382, mean p set: 0.4477251172065735
loss_pred:0.015168441459536552, decouple_loss:0.00039866019506007433
The modified gen p mean: 0.44672614336013794, gen p mean: -0.12111036479473114, mean p set: 0.44730156660079956
loss_pred:0.015070101246237755, decouple_loss:0.0006085196509957314
The modified gen p mean: 0.4465916156768799, gen p mean: -0.1160881519317627, mean p set: 0.4471670687198639
loss_pred:0.014788459055125713, decouple_loss:0.0005383992684073746
Iteration: 2013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469572603702545, gen p mean: -0.11998073756694794, mean p set: 0.44753265380859375
loss_pred:0.014697094447910786, decouple_loss:0.0004622548876795918
The modified gen p mean: 0.44597092270851135, gen p mean: -0.12050511687994003, mean p set: 0.4465474784374237The modified gen p mean: 0.4468529224395752, gen p mean: -0.11695029586553574, mean p set: 0.4474301338195801
loss_pred:0.01502261497080326, decouple_loss:0.00045888812746852636
loss_pred:0.014840357936918736, decouple_loss:0.0005017758812755346
Iteration: 2014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44601312279701233, gen p mean: -0.1255086213350296, mean p set: 0.44658660888671875
loss_pred:0.01496818009763956, decouple_loss:0.0005147157935425639
The modified gen p mean: 0.44749176502227783, gen p mean: -0.12029250711202621, mean p set: 0.44806838035583496
loss_pred:0.014498807489871979, decouple_loss:0.0005432565812952816
The modified gen p mean: 0.44688498973846436, gen p mean: -0.12498652935028076, mean p set: 0.44746461510658264
loss_pred:0.01479368656873703, decouple_loss:0.0004273029917385429
Iteration: 2015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463387429714203, gen p mean: -0.12487252801656723, mean p set: 0.44691479206085205
loss_pred:0.01573910191655159, decouple_loss:0.0005384532851167023
The modified gen p mean: 0.4476669728755951, gen p mean: -0.12426547706127167, mean p set: 0.4482450783252716
loss_pred:0.014815324917435646, decouple_loss:0.0005060865078121424
The modified gen p mean: 0.4460045099258423, gen p mean: -0.1291881799697876, mean p set: 0.4465794563293457
loss_pred:0.015070373192429543, decouple_loss:0.0004393919662106782
Iteration: 2016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460192620754242, gen p mean: -0.1299334168434143, mean p set: 0.44659578800201416
loss_pred:0.014827333390712738, decouple_loss:0.0003921103780157864
The modified gen p mean: 0.4464268386363983, gen p mean: -0.12656711041927338, mean p set: 0.4470020830631256
loss_pred:0.015172561630606651, decouple_loss:0.0003875799011439085
The modified gen p mean: 0.44760802388191223, gen p mean: -0.1232433095574379, mean p set: 0.44818106293678284
loss_pred:0.014517364092171192, decouple_loss:0.0004978878423571587
Iteration: 2017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467732310295105, gen p mean: -0.1264641135931015, mean p set: 0.4473506212234497
loss_pred:0.015054122544825077, decouple_loss:0.0005424860282801092
The modified gen p mean: 0.4460301995277405, gen p mean: -0.12110483646392822, mean p set: 0.4466037154197693
The modified gen p mean: 0.4462711215019226, gen p mean: -0.12465233355760574, mean p set: 0.446846604347229
loss_pred:0.015379037708044052, decouple_loss:0.0004178232338745147
loss_pred:0.014866308309137821, decouple_loss:0.0004827789671253413
Iteration: 2018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473079442977905, gen p mean: -0.122287817299366, mean p set: 0.44788506627082825
loss_pred:0.014749963767826557, decouple_loss:0.00036977932904846966
The modified gen p mean: 0.44528213143348694, gen p mean: -0.12585577368736267, mean p set: 0.445857435464859
The modified gen p mean: 0.4452122151851654, gen p mean: -0.12467629462480545, mean p set: 0.44578808546066284
loss_pred:0.015481255017220974, decouple_loss:0.00043696595821529627
loss_pred:0.014771724119782448, decouple_loss:0.00047225519665516913
Iteration: 2019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471563994884491, gen p mean: -0.11880163103342056, mean p set: 0.4477333426475525
loss_pred:0.01578066311776638, decouple_loss:0.0004865149676334113
The modified gen p mean: 0.44590070843696594, gen p mean: -0.11666891723871231, mean p set: 0.44647684693336487
The modified gen p mean: 0.44687944650650024, gen p mean: -0.12248414009809494, mean p set: 0.4474572241306305
loss_pred:0.015739113092422485, decouple_loss:0.0005041582626290619
loss_pred:0.014602859504520893, decouple_loss:0.00047611119225621223
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455747902393341, gen p mean: -0.12327299267053604, mean p set: 0.4461512565612793
loss_pred:0.014838801696896553, decouple_loss:0.0004355388227850199
The modified gen p mean: 0.44668474793434143, gen p mean: -0.12505556643009186, mean p set: 0.44726231694221497
loss_pred:0.014660854823887348, decouple_loss:0.0004801001341547817
The modified gen p mean: 0.4478485584259033, gen p mean: -0.12986521422863007, mean p set: 0.44842633605003357
loss_pred:0.014314482919871807, decouple_loss:0.0005320620839484036
2023-05-02 10:57:59 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13050515949726105, mean p set: 0.4502691626548767
loss_pred:0.016958748921751976, decouple_loss:0.00039221139741130173
The modified gen p mean: 0.4495371878147125, gen p mean: -0.12379119545221329, mean p set: 0.4500633478164673
loss_pred:0.016297873109579086, decouple_loss:0.0004880070628132671
The modified gen p mean: 0.4498300850391388, gen p mean: -0.1228318065404892, mean p set: 0.45035696029663086
loss_pred:0.0165419764816761, decouple_loss:0.0004559166554827243
WV_1_PC_1_EH_0_PS_40, loss: 0.016621802002191544, avg_mse: 0.025889968499541283
current test mse: 0.02589
Iteration: 2021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642123579978943, gen p mean: -0.12656161189079285, mean p set: 0.4469999372959137
loss_pred:0.015064194798469543, decouple_loss:0.00039499078411608934
The modified gen p mean: 0.4483543932437897, gen p mean: -0.12807287275791168, mean p set: 0.4489297568798065The modified gen p mean: 0.4467100203037262, gen p mean: -0.1273106187582016, mean p set: 0.44728413224220276
loss_pred:0.014186142012476921, decouple_loss:0.00043832973460666835
loss_pred:0.01467028260231018, decouple_loss:0.0005313797737471759
Iteration: 2022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470367133617401, gen p mean: -0.12186126410961151, mean p set: 0.44760966300964355
loss_pred:0.015270260162651539, decouple_loss:0.00040672800969332457
The modified gen p mean: 0.4462439715862274, gen p mean: -0.1284988820552826, mean p set: 0.446819543838501The modified gen p mean: 0.44510820508003235, gen p mean: -0.1270248293876648, mean p set: 0.4456845819950104
loss_pred:0.014987803995609283, decouple_loss:0.00039291783468797803
loss_pred:0.01502885390073061, decouple_loss:0.00046509510139003396
Iteration: 2023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462437033653259, gen p mean: -0.1266767978668213, mean p set: 0.44682133197784424
loss_pred:0.014859220013022423, decouple_loss:0.0005685520591214299
The modified gen p mean: 0.44660815596580505, gen p mean: -0.12577304244041443, mean p set: 0.447183758020401The modified gen p mean: 0.4467853903770447, gen p mean: -0.1303274780511856, mean p set: 0.4473608434200287
loss_pred:0.014991779811680317, decouple_loss:0.00048700932529754937
loss_pred:0.015066072344779968, decouple_loss:0.0004981184611096978
Iteration: 2024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749587774276733, gen p mean: -0.12598833441734314, mean p set: 0.44807347655296326
loss_pred:0.014719045720994473, decouple_loss:0.00046876512351445854
The modified gen p mean: 0.44670698046684265, gen p mean: -0.12996657192707062, mean p set: 0.44728177785873413
loss_pred:0.014780968427658081, decouple_loss:0.0003959768218919635
The modified gen p mean: 0.4464198052883148, gen p mean: -0.12987568974494934, mean p set: 0.44699564576148987
loss_pred:0.015009371563792229, decouple_loss:0.00042993799434043467
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
NaN value num: 0
Iteration: 2025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849029183387756, gen p mean: -0.11714010685682297, mean p set: 0.4490673840045929The modified gen p mean: 0.4506644010543823, gen p mean: -0.11870530992746353, mean p set: 0.4512411952018738
loss_pred:0.015949048101902008, decouple_loss:0.0005340210045687854
loss_pred:0.014382492750883102, decouple_loss:0.00046654584002681077
The modified gen p mean: 0.44763636589050293, gen p mean: -0.12762001156806946, mean p set: 0.4482121169567108
loss_pred:0.01614290475845337, decouple_loss:0.00047022910439409316
Iteration: 2026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809776544570923, gen p mean: -0.1213792935013771, mean p set: 0.44867488741874695
loss_pred:0.0156524907797575, decouple_loss:0.0005179235013201833
The modified gen p mean: 0.44705355167388916, gen p mean: -0.12220189720392227, mean p set: 0.4476247727870941
loss_pred:0.016314547508955002, decouple_loss:0.0006119890604168177
The modified gen p mean: 0.451626718044281, gen p mean: -0.11752535402774811, mean p set: 0.4522051215171814
loss_pred:0.015077325515449047, decouple_loss:0.0004938683705404401
Iteration: 2027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831183552742004, gen p mean: -0.11852147430181503, mean p set: 0.4488905668258667
loss_pred:0.015858640894293785, decouple_loss:0.000588304188568145
The modified gen p mean: 0.45076337456703186, gen p mean: -0.11165880411863327, mean p set: 0.45134055614471436
loss_pred:0.01661209762096405, decouple_loss:0.0006693223840557039
The modified gen p mean: 0.44898489117622375, gen p mean: -0.1122029721736908, mean p set: 0.4495622515678406
loss_pred:0.016292016953229904, decouple_loss:0.00046968457172624767
Iteration: 2028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45020195841789246, gen p mean: -0.11325719207525253, mean p set: 0.4507790505886078
loss_pred:0.015721557661890984, decouple_loss:0.00046567319077439606
The modified gen p mean: 0.45045921206474304, gen p mean: -0.11027580499649048, mean p set: 0.4510376751422882
loss_pred:0.015771793201565742, decouple_loss:0.0003507855290081352
The modified gen p mean: 0.4475332498550415, gen p mean: -0.11155802756547928, mean p set: 0.4481086730957031
loss_pred:0.016393177211284637, decouple_loss:0.0006069347145967185
Iteration: 2029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490193724632263, gen p mean: -0.10883472859859467, mean p set: 0.44959574937820435
The modified gen p mean: 0.44854918122291565, gen p mean: -0.1100507527589798, mean p set: 0.449124276638031
loss_pred:0.01558165904134512, decouple_loss:0.00043743077549152076
loss_pred:0.015485696494579315, decouple_loss:0.0004264526069164276
The modified gen p mean: 0.45064035058021545, gen p mean: -0.1099492609500885, mean p set: 0.4512166678905487
loss_pred:0.015197970904409885, decouple_loss:0.0005992432706989348
Iteration: 2030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500323534011841, gen p mean: -0.10944199562072754, mean p set: 0.4506089687347412
loss_pred:0.015710342675447464, decouple_loss:0.000493824016302824
The modified gen p mean: 0.45060768723487854, gen p mean: -0.11059977859258652, mean p set: 0.4511849880218506
The modified gen p mean: 0.4486413300037384, gen p mean: -0.11349336802959442, mean p set: 0.44921740889549255
loss_pred:0.015293550677597523, decouple_loss:0.0005739458138123155
loss_pred:0.016186712309718132, decouple_loss:0.00037155600148253143
2023-05-02 11:00:38 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12480897456407547, mean p set: 0.4502691626548767
loss_pred:0.016915790736675262, decouple_loss:0.00041015975875779986
The modified gen p mean: 0.44953611493110657, gen p mean: -0.11836043745279312, mean p set: 0.4500633478164673
loss_pred:0.016230983659625053, decouple_loss:0.0004297064442653209
The modified gen p mean: 0.4498283863067627, gen p mean: -0.11773396283388138, mean p set: 0.45035696029663086
loss_pred:0.01657947339117527, decouple_loss:0.00043762687710113823
WV_1_PC_1_EH_0_PS_40, loss: 0.016596708446741104, avg_mse: 0.025797268375754356
current test mse: 0.025797
Iteration: 2031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794028997421265, gen p mean: -0.11845915764570236, mean p set: 0.4485168755054474
loss_pred:0.01568671315908432, decouple_loss:0.0005525680026039481
The modified gen p mean: 0.45015713572502136, gen p mean: -0.11249282211065292, mean p set: 0.45073163509368896The modified gen p mean: 0.4499378800392151, gen p mean: -0.11510051041841507, mean p set: 0.4505128264427185
loss_pred:0.01639845408499241, decouple_loss:0.00044876825995743275
loss_pred:0.014924194663763046, decouple_loss:0.000421020551584661
Iteration: 2032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479651153087616, gen p mean: -0.12109682708978653, mean p set: 0.4485437870025635
loss_pred:0.01595444045960903, decouple_loss:0.00042434732313267887
The modified gen p mean: 0.4489305317401886, gen p mean: -0.11464249342679977, mean p set: 0.4495069682598114The modified gen p mean: 0.4475955069065094, gen p mean: -0.11575287580490112, mean p set: 0.44817185401916504
loss_pred:0.016392702236771584, decouple_loss:0.0004510712460614741
loss_pred:0.01609557680785656, decouple_loss:0.0005040895193815231
Iteration: 2033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45016705989837646, gen p mean: -0.11702834069728851, mean p set: 0.45074358582496643
loss_pred:0.015542101114988327, decouple_loss:0.0006057808641344309
The modified gen p mean: 0.4492366313934326, gen p mean: -0.11759058386087418, mean p set: 0.4498141407966614The modified gen p mean: 0.4506794810295105, gen p mean: -0.11773056536912918, mean p set: 0.45125463604927063
loss_pred:0.016039351001381874, decouple_loss:0.0006660552462562919
loss_pred:0.01416058000177145, decouple_loss:0.0007196216029115021
Iteration: 2034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904953241348267, gen p mean: -0.11280332505702972, mean p set: 0.44962626695632935
loss_pred:0.016056228429079056, decouple_loss:0.000545013346709311
The modified gen p mean: 0.449739545583725, gen p mean: -0.11735057830810547, mean p set: 0.45032137632369995
loss_pred:0.015779973939061165, decouple_loss:0.0004091658629477024
The modified gen p mean: 0.44664615392684937, gen p mean: -0.11863058060407639, mean p set: 0.44722285866737366
loss_pred:0.015276136808097363, decouple_loss:0.0005985634634271264
Iteration: 2035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787341356277466, gen p mean: -0.11590602993965149, mean p set: 0.44845154881477356
loss_pred:0.015694918110966682, decouple_loss:0.00039068557089194655
The modified gen p mean: 0.45069795846939087, gen p mean: -0.1171683818101883, mean p set: 0.4512731432914734
loss_pred:0.014826052822172642, decouple_loss:0.0004310987424105406
The modified gen p mean: 0.44819405674934387, gen p mean: -0.11812201887369156, mean p set: 0.448770135641098
loss_pred:0.016015948727726936, decouple_loss:0.00036071089562028646
Iteration: 2036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483000636100769, gen p mean: -0.13089895248413086, mean p set: 0.44887641072273254
loss_pred:0.01602245308458805, decouple_loss:0.0006473782123066485
The modified gen p mean: 0.45062777400016785, gen p mean: -0.11949635297060013, mean p set: 0.4512079358100891
loss_pred:0.014569757506251335, decouple_loss:0.0005463357665576041
The modified gen p mean: 0.44881781935691833, gen p mean: -0.12072589993476868, mean p set: 0.44939300417900085
loss_pred:0.015319152735173702, decouple_loss:0.0005419095978140831
Iteration: 2037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470103681087494, gen p mean: -0.12264847755432129, mean p set: 0.44758492708206177
loss_pred:0.015317665413022041, decouple_loss:0.0004273332597222179
The modified gen p mean: 0.45106449723243713, gen p mean: -0.12005015462636948, mean p set: 0.45164018869400024
loss_pred:0.014343751594424248, decouple_loss:0.0004787010548170656
The modified gen p mean: 0.45001235604286194, gen p mean: -0.11673673987388611, mean p set: 0.4505882263183594
loss_pred:0.01570849120616913, decouple_loss:0.0006124215433374047
Iteration: 2038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499371349811554, gen p mean: -0.11731891334056854, mean p set: 0.45051300525665283
loss_pred:0.01529407873749733, decouple_loss:0.00043186426046304405
The modified gen p mean: 0.44969961047172546, gen p mean: -0.1181030347943306, mean p set: 0.4502742886543274
loss_pred:0.01586727239191532, decouple_loss:0.0005143072339706123
The modified gen p mean: 0.4484603703022003, gen p mean: -0.12008457630872726, mean p set: 0.4490378499031067
loss_pred:0.015367747284471989, decouple_loss:0.00045644590863958
Iteration: 2039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504666030406952, gen p mean: -0.11959633231163025, mean p set: 0.4510430097579956
loss_pred:0.014733471907675266, decouple_loss:0.0006689370493404567
The modified gen p mean: 0.4498594105243683, gen p mean: -0.1215265616774559, mean p set: 0.45043426752090454
loss_pred:0.015121353790163994, decouple_loss:0.0006611101562157273
The modified gen p mean: 0.4494014382362366, gen p mean: -0.12179107218980789, mean p set: 0.4499780237674713
loss_pred:0.01594104804098606, decouple_loss:0.0005234428099356592
Iteration: 2040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472561478614807, gen p mean: -0.1202600821852684, mean p set: 0.4478309452533722
loss_pred:0.01630200631916523, decouple_loss:0.0004408093518577516
The modified gen p mean: 0.4483211934566498, gen p mean: -0.11326692253351212, mean p set: 0.44889700412750244
The modified gen p mean: 0.4493936598300934, gen p mean: -0.1192074790596962, mean p set: 0.44997039437294006
loss_pred:0.016274211928248405, decouple_loss:0.0005549808265641332
loss_pred:0.015577089972794056, decouple_loss:0.0005348845152184367
2023-05-02 11:02:43 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12808632850646973, mean p set: 0.4502691626548767
loss_pred:0.016930514946579933, decouple_loss:0.0005661931354552507
The modified gen p mean: 0.44953346252441406, gen p mean: -0.12124375998973846, mean p set: 0.4500633478164673
loss_pred:0.016172872856259346, decouple_loss:0.0005147566553205252
The modified gen p mean: 0.44982966780662537, gen p mean: -0.12056367844343185, mean p set: 0.45035696029663086
loss_pred:0.016552211716771126, decouple_loss:0.00045701986528001726
WV_1_PC_1_EH_0_PS_40, loss: 0.016577500849962234, avg_mse: 0.02582094445824623
current test mse: 0.025821
Iteration: 2041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495348632335663, gen p mean: -0.11705546081066132, mean p set: 0.4501139223575592
loss_pred:0.015331318601965904, decouple_loss:0.0004072314768563956
The modified gen p mean: 0.4492979347705841, gen p mean: -0.11651478707790375, mean p set: 0.4498726725578308The modified gen p mean: 0.4495363235473633, gen p mean: -0.11466151475906372, mean p set: 0.45011213421821594
loss_pred:0.016414465382695198, decouple_loss:0.00043700658716261387
loss_pred:0.01584581285715103, decouple_loss:0.00047443489893339574
Iteration: 2042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785305857658386, gen p mean: -0.1247912123799324, mean p set: 0.44842615723609924
loss_pred:0.016033818945288658, decouple_loss:0.0005620744777843356
The modified gen p mean: 0.4490250051021576, gen p mean: -0.11141960322856903, mean p set: 0.44960159063339233The modified gen p mean: 0.4506302773952484, gen p mean: -0.11587391793727875, mean p set: 0.4512060284614563
loss_pred:0.015234851278364658, decouple_loss:0.0004570788296405226
loss_pred:0.015353838913142681, decouple_loss:0.00047889354755170643
Iteration: 2043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466440975666046, gen p mean: -0.12257993966341019, mean p set: 0.44721853733062744
The modified gen p mean: 0.4477686882019043, gen p mean: -0.12350457161664963, mean p set: 0.44834598898887634loss_pred:0.01507868617773056, decouple_loss:0.0003739410312846303
loss_pred:0.015578409656882286, decouple_loss:0.00047908167471177876
The modified gen p mean: 0.4493732452392578, gen p mean: -0.11642879992723465, mean p set: 0.44995033740997314
loss_pred:0.015816425904631615, decouple_loss:0.00054963055299595
Iteration: 2044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752275943756104, gen p mean: -0.12453069537878036, mean p set: 0.4480978846549988
loss_pred:0.01588410697877407, decouple_loss:0.0007788888178765774
The modified gen p mean: 0.44864755868911743, gen p mean: -0.1272943913936615, mean p set: 0.4492231011390686
loss_pred:0.01604437455534935, decouple_loss:0.00038068986032158136
The modified gen p mean: 0.45095983147621155, gen p mean: -0.11848438531160355, mean p set: 0.45153409242630005
loss_pred:0.014643682166934013, decouple_loss:0.0006827477482147515
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
NaN value num: 0
Iteration: 2045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486871063709259, gen p mean: -0.12343736737966537, mean p set: 0.4492642879486084
loss_pred:0.015679510310292244, decouple_loss:0.000512930448167026
The modified gen p mean: 0.4497970938682556, gen p mean: -0.12177208065986633, mean p set: 0.45037439465522766
loss_pred:0.01526560913771391, decouple_loss:0.0005019867676310241
The modified gen p mean: 0.45181944966316223, gen p mean: -0.11747363209724426, mean p set: 0.4523966908454895
loss_pred:0.015484290197491646, decouple_loss:0.00045876725926063955
Iteration: 2046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522479176521301, gen p mean: -0.11966384202241898, mean p set: 0.4528287649154663
loss_pred:0.015842214226722717, decouple_loss:0.00036759927752427757
The modified gen p mean: 0.4511190354824066, gen p mean: -0.11434438079595566, mean p set: 0.4516959488391876
The modified gen p mean: 0.45180976390838623, gen p mean: -0.12157297879457474, mean p set: 0.4523853361606598
loss_pred:0.016093961894512177, decouple_loss:0.0003602839133236557
loss_pred:0.01650443859398365, decouple_loss:0.0005291961133480072
Iteration: 2047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44979435205459595, gen p mean: -0.12262210994958878, mean p set: 0.45037025213241577
loss_pred:0.015542116016149521, decouple_loss:0.0005120609421283007
The modified gen p mean: 0.4512088894844055, gen p mean: -0.11939767003059387, mean p set: 0.4517871141433716
The modified gen p mean: 0.44887879490852356, gen p mean: -0.12178648263216019, mean p set: 0.4494556486606598
loss_pred:0.01602504774928093, decouple_loss:0.0004420964396558702
loss_pred:0.015773728489875793, decouple_loss:0.0003108590899500996
Iteration: 2048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521857500076294, gen p mean: -0.1168963834643364, mean p set: 0.45276302099227905
loss_pred:0.016347873955965042, decouple_loss:0.0004464153607841581
The modified gen p mean: 0.4515959322452545, gen p mean: -0.12238741666078568, mean p set: 0.45217210054397583
loss_pred:0.015974493697285652, decouple_loss:0.0005248798988759518
The modified gen p mean: 0.4500572979450226, gen p mean: -0.12213463336229324, mean p set: 0.4506323039531708
loss_pred:0.016557490453124046, decouple_loss:0.0004831684345845133
Iteration: 2049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487115144729614, gen p mean: -0.12260591983795166, mean p set: 0.44928696751594543
loss_pred:0.014422541484236717, decouple_loss:0.0004332569660618901
The modified gen p mean: 0.45084893703460693, gen p mean: -0.12280939519405365, mean p set: 0.45142364501953125
loss_pred:0.01624680683016777, decouple_loss:0.0004674903757404536
The modified gen p mean: 0.44981902837753296, gen p mean: -0.12661822140216827, mean p set: 0.4503953158855438
loss_pred:0.015670454129576683, decouple_loss:0.00043917098082602024
Iteration: 2050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45003756880760193, gen p mean: -0.12306595593690872, mean p set: 0.4506132900714874
loss_pred:0.015984203666448593, decouple_loss:0.0004825635114684701
The modified gen p mean: 0.4492129683494568, gen p mean: -0.12308133393526077, mean p set: 0.44978898763656616
loss_pred:0.015088994987308979, decouple_loss:0.00044879488996230066
The modified gen p mean: 0.4492448568344116, gen p mean: -0.12423373758792877, mean p set: 0.4498198330402374
loss_pred:0.015721352770924568, decouple_loss:0.00038491981104016304
2023-05-02 11:05:27 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13052278757095337, mean p set: 0.4502691626548767
loss_pred:0.016971446573734283, decouple_loss:0.00037041353061795235
The modified gen p mean: 0.4495352804660797, gen p mean: -0.12323455512523651, mean p set: 0.4500633478164673
loss_pred:0.016286151483654976, decouple_loss:0.00041841715574264526
The modified gen p mean: 0.4498286843299866, gen p mean: -0.12273794412612915, mean p set: 0.45035696029663086
loss_pred:0.016502125188708305, decouple_loss:0.0003915595298167318
WV_1_PC_1_EH_0_PS_40, loss: 0.016606247052550316, avg_mse: 0.025790756568312645
current test mse: 0.025791
Iteration: 2051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518032670021057, gen p mean: -0.11160365492105484, mean p set: 0.4523797929286957
loss_pred:0.015949716791510582, decouple_loss:0.00046598826884292066
The modified gen p mean: 0.45221108198165894, gen p mean: -0.1198953315615654, mean p set: 0.452788382768631
loss_pred:0.015693064779043198, decouple_loss:0.00044228785554878414
The modified gen p mean: 0.45126044750213623, gen p mean: -0.11118804663419724, mean p set: 0.4518364667892456
loss_pred:0.01615644432604313, decouple_loss:0.0005025278660468757
Iteration: 2052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504745602607727, gen p mean: -0.12088639289140701, mean p set: 0.4510500431060791
loss_pred:0.016057340428233147, decouple_loss:0.0006766717997379601
The modified gen p mean: 0.4512024521827698, gen p mean: -0.12484319508075714, mean p set: 0.4517802298069The modified gen p mean: 0.4487468898296356, gen p mean: -0.1218632161617279, mean p set: 0.44932547211647034
loss_pred:0.015831630676984787, decouple_loss:0.0006277604843489826loss_pred:0.015794804319739342, decouple_loss:0.0004743820463772863
Iteration: 2053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44920697808265686, gen p mean: -0.12377279251813889, mean p set: 0.449785053730011
loss_pred:0.01547253131866455, decouple_loss:0.0004610121832229197
The modified gen p mean: 0.4516009986400604, gen p mean: -0.11807259917259216, mean p set: 0.4521786570549011The modified gen p mean: 0.44991832971572876, gen p mean: -0.11808564513921738, mean p set: 0.45049622654914856
loss_pred:0.014646203257143497, decouple_loss:0.00040554074803367257loss_pred:0.016773879528045654, decouple_loss:0.0004503736272454262
Iteration: 2054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503333568572998, gen p mean: -0.11204737424850464, mean p set: 0.4509114921092987
The modified gen p mean: 0.45013487339019775, gen p mean: -0.11789845675230026, mean p set: 0.4507118761539459
loss_pred:0.01551965344697237, decouple_loss:0.0006059706793166697
loss_pred:0.016201524063944817, decouple_loss:0.0003611318825278431
The modified gen p mean: 0.4501897096633911, gen p mean: -0.11883989721536636, mean p set: 0.4507678747177124
loss_pred:0.015047699213027954, decouple_loss:0.000364217150490731
Iteration: 2055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104891061782837, gen p mean: -0.11277132481336594, mean p set: 0.451625794172287
loss_pred:0.01495000533759594, decouple_loss:0.00040685455314815044
The modified gen p mean: 0.449659138917923, gen p mean: -0.11912305653095245, mean p set: 0.45023679733276367
The modified gen p mean: 0.4497522711753845, gen p mean: -0.11483658850193024, mean p set: 0.4503283202648163
loss_pred:0.015650350600481033, decouple_loss:0.00036218808963894844
loss_pred:0.015319925732910633, decouple_loss:0.0007256362005136907
Iteration: 2056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488697350025177, gen p mean: -0.12065127491950989, mean p set: 0.44944655895233154
loss_pred:0.014904182404279709, decouple_loss:0.0003754174686037004
The modified gen p mean: 0.4510035812854767, gen p mean: -0.11419758200645447, mean p set: 0.4515781104564667
loss_pred:0.015156149864196777, decouple_loss:0.0004640068218577653
The modified gen p mean: 0.449618399143219, gen p mean: -0.11453656852245331, mean p set: 0.4501945972442627
loss_pred:0.01606733165681362, decouple_loss:0.00043052207911387086
Iteration: 2057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832196831703186, gen p mean: -0.11540856212377548, mean p set: 0.44889846444129944
loss_pred:0.01733158528804779, decouple_loss:0.0005073953070677817
The modified gen p mean: 0.4494876265525818, gen p mean: -0.11966539919376373, mean p set: 0.45006316900253296
loss_pred:0.01576193794608116, decouple_loss:0.00043985084630548954
The modified gen p mean: 0.44982656836509705, gen p mean: -0.11779116839170456, mean p set: 0.4504021108150482
loss_pred:0.016797872260212898, decouple_loss:0.00046214048052206635
Iteration: 2058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512295722961426, gen p mean: -0.11797595024108887, mean p set: 0.4518067240715027
loss_pred:0.01483983639627695, decouple_loss:0.0004625189467333257
The modified gen p mean: 0.45037075877189636, gen p mean: -0.1218210980296135, mean p set: 0.45094767212867737
The modified gen p mean: 0.4515044689178467, gen p mean: -0.12165951728820801, mean p set: 0.45208439230918884
loss_pred:0.017289478331804276, decouple_loss:0.00042432936606928706
loss_pred:0.016015121713280678, decouple_loss:0.0005326922400854528
Iteration: 2059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451229453086853, gen p mean: -0.12592259049415588, mean p set: 0.45180633664131165
The modified gen p mean: 0.4512058198451996, gen p mean: -0.12343791872262955, mean p set: 0.4517803192138672
loss_pred:0.015840351581573486, decouple_loss:0.0003901449963450432
loss_pred:0.01648102141916752, decouple_loss:0.0004414742288645357
The modified gen p mean: 0.44943779706954956, gen p mean: -0.12886439263820648, mean p set: 0.4500194787979126
loss_pred:0.015560719184577465, decouple_loss:0.0006416446412913501
Iteration: 2060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44989827275276184, gen p mean: -0.12766596674919128, mean p set: 0.4504729211330414
loss_pred:0.015350133180618286, decouple_loss:0.00038029233110137284
The modified gen p mean: 0.4484708309173584, gen p mean: -0.12051799893379211, mean p set: 0.44904741644859314
loss_pred:0.017835265025496483, decouple_loss:0.0003901218587998301
The modified gen p mean: 0.44905591011047363, gen p mean: -0.12483794242143631, mean p set: 0.44963186979293823
loss_pred:0.017174480482935905, decouple_loss:0.00048123893793672323
2023-05-02 11:07:32 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13715620338916779, mean p set: 0.4502691626548767
loss_pred:0.01693722791969776, decouple_loss:0.0003730967582669109
The modified gen p mean: 0.44953256845474243, gen p mean: -0.1296698898077011, mean p set: 0.4500633478164673
loss_pred:0.016269780695438385, decouple_loss:0.00039099875721149147
The modified gen p mean: 0.449828177690506, gen p mean: -0.12872283160686493, mean p set: 0.45035696029663086
loss_pred:0.016480794176459312, decouple_loss:0.0004367769870441407
WV_1_PC_1_EH_0_PS_40, loss: 0.016582615673542023, avg_mse: 0.025808697566390038
current test mse: 0.025809
Iteration: 2061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500288665294647, gen p mean: -0.1296384483575821, mean p set: 0.45060670375823975
loss_pred:0.015583454631268978, decouple_loss:0.000345046806614846
The modified gen p mean: 0.45030951499938965, gen p mean: -0.1259654313325882, mean p set: 0.4508860111236572
loss_pred:0.015205216594040394, decouple_loss:0.00040937087032943964
The modified gen p mean: 0.4509345591068268, gen p mean: -0.1324019432067871, mean p set: 0.4515089690685272
loss_pred:0.015690399333834648, decouple_loss:0.0003669624566100538
Iteration: 2062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45065850019454956, gen p mean: -0.12955614924430847, mean p set: 0.4512340724468231
loss_pred:0.016254989430308342, decouple_loss:0.0003819908597506583
The modified gen p mean: 0.45030513405799866, gen p mean: -0.12636041641235352, mean p set: 0.4508816599845886The modified gen p mean: 0.45006272196769714, gen p mean: -0.12871697545051575, mean p set: 0.4506370425224304
loss_pred:0.015358507633209229, decouple_loss:0.0005353844026103616
loss_pred:0.017218250781297684, decouple_loss:0.00039362520328722894
Iteration: 2063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499867558479309, gen p mean: -0.12288684397935867, mean p set: 0.4505631625652313
loss_pred:0.015482527203857899, decouple_loss:0.00038469169521704316
The modified gen p mean: 0.4513402283191681, gen p mean: -0.12119083106517792, mean p set: 0.4519183933734894
loss_pred:0.014763354323804379, decouple_loss:0.00033725282992236316
The modified gen p mean: 0.4500482380390167, gen p mean: -0.11973954737186432, mean p set: 0.4506262540817261
loss_pred:0.015299501828849316, decouple_loss:0.00033256213646382093
Iteration: 2064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45183396339416504, gen p mean: -0.12027770280838013, mean p set: 0.452411413192749
loss_pred:0.016448253765702248, decouple_loss:0.0005804697866551578
The modified gen p mean: 0.4495326280593872, gen p mean: -0.12583543360233307, mean p set: 0.45010891556739807
loss_pred:0.015537811443209648, decouple_loss:0.00038444437086582184
The modified gen p mean: 0.45146915316581726, gen p mean: -0.12079980224370956, mean p set: 0.4520488977432251
loss_pred:0.015731923282146454, decouple_loss:0.0005036076181568205
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 2065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763484597206116, gen p mean: -0.13195517659187317, mean p set: 0.4482114315032959
The modified gen p mean: 0.44716018438339233, gen p mean: -0.1261959671974182, mean p set: 0.44773516058921814
loss_pred:0.014374611899256706, decouple_loss:0.0003912611282430589
loss_pred:0.015422830358147621, decouple_loss:0.0005294608417898417
The modified gen p mean: 0.44742724299430847, gen p mean: -0.12713757157325745, mean p set: 0.4479990005493164
loss_pred:0.014686409384012222, decouple_loss:0.000571237993426621
Iteration: 2066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475270211696625, gen p mean: -0.12653188407421112, mean p set: 0.4481014907360077
loss_pred:0.014539712108671665, decouple_loss:0.0004823715426027775
The modified gen p mean: 0.44825243949890137, gen p mean: -0.1267077475786209, mean p set: 0.4488280117511749
loss_pred:0.014892276376485825, decouple_loss:0.00041933360625989735
The modified gen p mean: 0.4485570192337036, gen p mean: -0.12641367316246033, mean p set: 0.449133038520813
loss_pred:0.015060165897011757, decouple_loss:0.000336783064994961
Iteration: 2067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472668766975403, gen p mean: -0.12172102183103561, mean p set: 0.44784215092658997
loss_pred:0.01443957444280386, decouple_loss:0.0004361947940196842
The modified gen p mean: 0.4476781487464905, gen p mean: -0.12247829884290695, mean p set: 0.4482528567314148
The modified gen p mean: 0.44921907782554626, gen p mean: -0.12222161144018173, mean p set: 0.4497953951358795
loss_pred:0.014094456098973751, decouple_loss:0.000384560291422531
loss_pred:0.014660824090242386, decouple_loss:0.0003137568128295243
Iteration: 2068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472166895866394, gen p mean: -0.12121985107660294, mean p set: 0.4477945566177368
loss_pred:0.014818825758993626, decouple_loss:0.00033554615220054984
The modified gen p mean: 0.4470210373401642, gen p mean: -0.12580373883247375, mean p set: 0.44759488105773926
loss_pred:0.015296912752091885, decouple_loss:0.00042283470975235105
The modified gen p mean: 0.44802772998809814, gen p mean: -0.131337508559227, mean p set: 0.44860297441482544
loss_pred:0.014218451455235481, decouple_loss:0.00041122431866824627
Iteration: 2069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44847723841667175, gen p mean: -0.1256055235862732, mean p set: 0.44905373454093933
loss_pred:0.014849472790956497, decouple_loss:0.0003429637581575662
The modified gen p mean: 0.4480520486831665, gen p mean: -0.12746581435203552, mean p set: 0.4486263692378998
loss_pred:0.015080776065587997, decouple_loss:0.0003781449340749532
The modified gen p mean: 0.44827914237976074, gen p mean: -0.1208973303437233, mean p set: 0.4488582909107208
loss_pred:0.015040742233395576, decouple_loss:0.0004278281703591347
Iteration: 2070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786423444747925, gen p mean: -0.1341537982225418, mean p set: 0.44844159483909607
loss_pred:0.014176911674439907, decouple_loss:0.00041917766793631017
The modified gen p mean: 0.4478558599948883, gen p mean: -0.1333153396844864, mean p set: 0.44843214750289917
The modified gen p mean: 0.44822779297828674, gen p mean: -0.12950053811073303, mean p set: 0.4488038718700409
loss_pred:0.014464233070611954, decouple_loss:0.000365323357982561
loss_pred:0.014080123044550419, decouple_loss:0.00042972792289219797
2023-05-02 11:10:15 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12845881283283234, mean p set: 0.4502691626548767
loss_pred:0.01692279800772667, decouple_loss:0.00039015113725326955
The modified gen p mean: 0.44953787326812744, gen p mean: -0.12116362154483795, mean p set: 0.4500633478164673
loss_pred:0.01625204086303711, decouple_loss:0.00042668767855502665
The modified gen p mean: 0.4498303532600403, gen p mean: -0.12020058929920197, mean p set: 0.45035696029663086
loss_pred:0.01650792360305786, decouple_loss:0.00034898737794719636
WV_1_PC_1_EH_0_PS_40, loss: 0.016580352559685707, avg_mse: 0.025780372321605682
current test mse: 0.02578
Iteration: 2071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448966383934021, gen p mean: -0.12248612940311432, mean p set: 0.4495420455932617
loss_pred:0.013850175775587559, decouple_loss:0.0002723187499213964
The modified gen p mean: 0.4474083185195923, gen p mean: -0.12253959476947784, mean p set: 0.44798383116722107
loss_pred:0.01560000516474247, decouple_loss:0.00033598265144973993
The modified gen p mean: 0.4492884576320648, gen p mean: -0.11831715703010559, mean p set: 0.4498658776283264
loss_pred:0.014472771435976028, decouple_loss:0.0003779950784519315
Iteration: 2072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786208868026733, gen p mean: -0.11484351754188538, mean p set: 0.4484385848045349
loss_pred:0.014135380275547504, decouple_loss:0.0004036227473989129
The modified gen p mean: 0.44867950677871704, gen p mean: -0.11821088194847107, mean p set: 0.4492571949958801The modified gen p mean: 0.44699329137802124, gen p mean: -0.1249704509973526, mean p set: 0.4475710391998291
loss_pred:0.014035209082067013, decouple_loss:0.00032853352604433894loss_pred:0.014139167964458466, decouple_loss:0.00037089610123075545
Iteration: 2073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807982444763184, gen p mean: -0.11814422160387039, mean p set: 0.44865697622299194
loss_pred:0.014667073264718056, decouple_loss:0.00034198694629594684
The modified gen p mean: 0.4480603337287903, gen p mean: -0.11743495613336563, mean p set: 0.4486351013183594The modified gen p mean: 0.44746169447898865, gen p mean: -0.11463715881109238, mean p set: 0.44803711771965027
loss_pred:0.014199553057551384, decouple_loss:0.0003205194079782814
loss_pred:0.01531743910163641, decouple_loss:0.0003354093641974032
Iteration: 2074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714057445526123, gen p mean: -0.11543580144643784, mean p set: 0.44771671295166016
loss_pred:0.01496913656592369, decouple_loss:0.000382570899091661
The modified gen p mean: 0.44735977053642273, gen p mean: -0.11712299287319183, mean p set: 0.44793590903282166
loss_pred:0.014437474310398102, decouple_loss:0.0003554513677954674
The modified gen p mean: 0.4479842483997345, gen p mean: -0.1177099198102951, mean p set: 0.44856035709381104
loss_pred:0.014054966159164906, decouple_loss:0.00035606385790742934
Iteration: 2075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893285632133484, gen p mean: -0.11879251897335052, mean p set: 0.4495067000389099
loss_pred:0.013258160091936588, decouple_loss:0.00044092576717957854
The modified gen p mean: 0.4473550617694855, gen p mean: -0.12199947983026505, mean p set: 0.4479329288005829
loss_pred:0.014026896096765995, decouple_loss:0.0004871914570685476
The modified gen p mean: 0.44754162430763245, gen p mean: -0.12098953872919083, mean p set: 0.44811877608299255
loss_pred:0.014268222264945507, decouple_loss:0.0004545064875856042
Iteration: 2076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472060799598694, gen p mean: -0.12105584144592285, mean p set: 0.4477807283401489
loss_pred:0.015075755305588245, decouple_loss:0.000376993470126763
The modified gen p mean: 0.44651973247528076, gen p mean: -0.12374990433454514, mean p set: 0.4470933675765991
loss_pred:0.01446629036217928, decouple_loss:0.0003104723000433296
The modified gen p mean: 0.4483662545681, gen p mean: -0.12212973833084106, mean p set: 0.44894084334373474
loss_pred:0.014428751543164253, decouple_loss:0.00036141107557341456
Iteration: 2077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472660422325134, gen p mean: -0.12023390084505081, mean p set: 0.44784268736839294
loss_pred:0.015424967743456364, decouple_loss:0.00036107120104134083
The modified gen p mean: 0.4482831060886383, gen p mean: -0.11704875528812408, mean p set: 0.4488586187362671
loss_pred:0.014093493111431599, decouple_loss:0.0003568573447410017
The modified gen p mean: 0.4486338198184967, gen p mean: -0.12400925159454346, mean p set: 0.44921019673347473
loss_pred:0.014519940130412579, decouple_loss:0.000386044877814129
Iteration: 2078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448276549577713, gen p mean: -0.11816391348838806, mean p set: 0.4488556683063507
loss_pred:0.014622814953327179, decouple_loss:0.0003699645458254963
The modified gen p mean: 0.44812965393066406, gen p mean: -0.12329185009002686, mean p set: 0.4487045109272003
loss_pred:0.01411509420722723, decouple_loss:0.0003903753822669387
The modified gen p mean: 0.44758734107017517, gen p mean: -0.11716855317354202, mean p set: 0.44816192984580994
loss_pred:0.01384048443287611, decouple_loss:0.0005707083619199693
Iteration: 2079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793203473091125, gen p mean: -0.11884263157844543, mean p set: 0.4485081434249878
loss_pred:0.01471532229334116, decouple_loss:0.0003391298232600093
The modified gen p mean: 0.4483344554901123, gen p mean: -0.12221146374940872, mean p set: 0.4489099383354187
loss_pred:0.013793237507343292, decouple_loss:0.0003358259273227304
The modified gen p mean: 0.44803011417388916, gen p mean: -0.11635029315948486, mean p set: 0.4486044645309448
loss_pred:0.013962430879473686, decouple_loss:0.000372522248653695
Iteration: 2080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840431213378906, gen p mean: -0.121156707406044, mean p set: 0.4489794969558716
loss_pred:0.014384221285581589, decouple_loss:0.0003753724740818143
The modified gen p mean: 0.4484217166900635, gen p mean: -0.11822932213544846, mean p set: 0.4489966928958893
loss_pred:0.014439690858125687, decouple_loss:0.0003194617747794837
The modified gen p mean: 0.44793054461479187, gen p mean: -0.12526090443134308, mean p set: 0.4485073983669281
loss_pred:0.01414717547595501, decouple_loss:0.00044568534940481186
2023-05-02 11:12:20 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12887896597385406, mean p set: 0.4502691626548767
loss_pred:0.01689680851995945, decouple_loss:0.0006220384384505451
The modified gen p mean: 0.4495367407798767, gen p mean: -0.1217140182852745, mean p set: 0.4500633478164673
loss_pred:0.016223356127738953, decouple_loss:0.0005156769184395671
The modified gen p mean: 0.44982752203941345, gen p mean: -0.12109285593032837, mean p set: 0.45035696029663086
loss_pred:0.01651271991431713, decouple_loss:0.0005227976362220943
WV_1_PC_1_EH_0_PS_40, loss: 0.016571972519159317, avg_mse: 0.02579180710017681
current test mse: 0.025792
Iteration: 2081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717416167259216, gen p mean: -0.11667445302009583, mean p set: 0.4477514326572418
loss_pred:0.015161477029323578, decouple_loss:0.0004065011744387448
The modified gen p mean: 0.44829297065734863, gen p mean: -0.1314048171043396, mean p set: 0.4488692879676819
loss_pred:0.014713258482515812, decouple_loss:0.0004831562691833824
The modified gen p mean: 0.4471920430660248, gen p mean: -0.12721098959445953, mean p set: 0.44776979088783264
loss_pred:0.014060813002288342, decouple_loss:0.0004738700808957219
Iteration: 2082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801223278045654, gen p mean: -0.13185451924800873, mean p set: 0.4485870599746704
loss_pred:0.013783290050923824, decouple_loss:0.0004826384538318962
The modified gen p mean: 0.4484076201915741, gen p mean: -0.13734740018844604, mean p set: 0.4489799737930298The modified gen p mean: 0.4476817846298218, gen p mean: -0.12592725455760956, mean p set: 0.44825834035873413
loss_pred:0.014642138034105301, decouple_loss:0.0004637506790459156loss_pred:0.01433895155787468, decouple_loss:0.0004203332937322557
Iteration: 2083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44850245118141174, gen p mean: -0.12519922852516174, mean p set: 0.4490780532360077
loss_pred:0.014185446314513683, decouple_loss:0.0004682761791627854
The modified gen p mean: 0.4473743736743927, gen p mean: -0.12615695595741272, mean p set: 0.4479498863220215The modified gen p mean: 0.446834534406662, gen p mean: -0.1283673644065857, mean p set: 0.4474125802516937
loss_pred:0.013859723694622517, decouple_loss:0.00044825783697888255
loss_pred:0.014213455840945244, decouple_loss:0.0004633617354556918
Iteration: 2084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755008816719055, gen p mean: -0.12579874694347382, mean p set: 0.44812890887260437
loss_pred:0.014451484195888042, decouple_loss:0.0004092571325600147
The modified gen p mean: 0.4470614194869995, gen p mean: -0.12455764412879944, mean p set: 0.44763508439064026
loss_pred:0.013916973024606705, decouple_loss:0.0005397703498601913
The modified gen p mean: 0.4472004771232605, gen p mean: -0.12736988067626953, mean p set: 0.44777724146842957
loss_pred:0.015140697360038757, decouple_loss:0.0005069182370789349
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
NaN value num: 0
Iteration: 2085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45173776149749756, gen p mean: -0.11232122778892517, mean p set: 0.45231500267982483
loss_pred:0.014643737114965916, decouple_loss:0.00043393875239416957
The modified gen p mean: 0.4493006467819214, gen p mean: -0.12135139852762222, mean p set: 0.4498787522315979
loss_pred:0.014509853906929493, decouple_loss:0.0005406353739090264
The modified gen p mean: 0.4503105878829956, gen p mean: -0.11850492656230927, mean p set: 0.45088624954223633
loss_pred:0.016162600368261337, decouple_loss:0.0005843862891197205
Iteration: 2086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515177011489868, gen p mean: -0.11041205376386642, mean p set: 0.45209503173828125
loss_pred:0.014715743251144886, decouple_loss:0.0005226319772191346
The modified gen p mean: 0.4523128569126129, gen p mean: -0.11666901409626007, mean p set: 0.45288947224617004
loss_pred:0.014890357851982117, decouple_loss:0.0006159276817925274
The modified gen p mean: 0.4516444802284241, gen p mean: -0.11701315641403198, mean p set: 0.45222437381744385
loss_pred:0.015150834806263447, decouple_loss:0.0005679513560608029
Iteration: 2087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511410593986511, gen p mean: -0.1068827286362648, mean p set: 0.451716810464859
loss_pred:0.014932485297322273, decouple_loss:0.00046699566883035004
The modified gen p mean: 0.4540014863014221, gen p mean: -0.1124977394938469, mean p set: 0.4545804262161255
loss_pred:0.015452360734343529, decouple_loss:0.0004014511068817228
The modified gen p mean: 0.45394590497016907, gen p mean: -0.11546988785266876, mean p set: 0.45452532172203064
loss_pred:0.015054143033921719, decouple_loss:0.0003680607187561691
Iteration: 2088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45218637585639954, gen p mean: -0.11181166768074036, mean p set: 0.45276156067848206
loss_pred:0.014953721314668655, decouple_loss:0.0005077789537608624
The modified gen p mean: 0.45300763845443726, gen p mean: -0.11909744143486023, mean p set: 0.45358556509017944
loss_pred:0.014529010280966759, decouple_loss:0.00047788917436264455
The modified gen p mean: 0.4522411525249481, gen p mean: -0.11020918935537338, mean p set: 0.4528190791606903
loss_pred:0.01490649115294218, decouple_loss:0.0005440294044092298
Iteration: 2089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45149487257003784, gen p mean: -0.11292031407356262, mean p set: 0.4520728290081024
loss_pred:0.014814089983701706, decouple_loss:0.0006003364687785506
The modified gen p mean: 0.4511058032512665, gen p mean: -0.11125358194112778, mean p set: 0.4516817331314087
loss_pred:0.015213423408567905, decouple_loss:0.0006106824730522931
The modified gen p mean: 0.4531530737876892, gen p mean: -0.11083628237247467, mean p set: 0.4537295699119568
loss_pred:0.01541992463171482, decouple_loss:0.0006532793049700558
Iteration: 2090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529949128627777, gen p mean: -0.11343281716108322, mean p set: 0.4535713791847229
loss_pred:0.015091693960130215, decouple_loss:0.0005200927844271064
The modified gen p mean: 0.4533424973487854, gen p mean: -0.11718232184648514, mean p set: 0.453921914100647
loss_pred:0.015416366048157215, decouple_loss:0.0005970361526124179
The modified gen p mean: 0.4527294337749481, gen p mean: -0.11091721802949905, mean p set: 0.4533047676086426
loss_pred:0.015452506020665169, decouple_loss:0.0004032810975331813
2023-05-02 11:15:04 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13445228338241577, mean p set: 0.4502691626548767
loss_pred:0.017007026821374893, decouple_loss:0.0005628372891806066
The modified gen p mean: 0.4495348036289215, gen p mean: -0.12718741595745087, mean p set: 0.4500633478164673
loss_pred:0.016390006989240646, decouple_loss:0.0005497773527167737
The modified gen p mean: 0.44983038306236267, gen p mean: -0.12689289450645447, mean p set: 0.45035696029663086
loss_pred:0.016594979912042618, decouple_loss:0.00046800210839137435
WV_1_PC_1_EH_0_PS_40, loss: 0.016690349206328392, avg_mse: 0.025869324803352356
current test mse: 0.025869
Iteration: 2091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526343047618866, gen p mean: -0.11785726994276047, mean p set: 0.45321348309516907
loss_pred:0.01502295397222042, decouple_loss:0.00046425769687630236
The modified gen p mean: 0.45373955368995667, gen p mean: -0.1201881691813469, mean p set: 0.45431381464004517The modified gen p mean: 0.453019380569458, gen p mean: -0.12602241337299347, mean p set: 0.4535963535308838
loss_pred:0.015233462676405907, decouple_loss:0.0006796891684643924loss_pred:0.014447584748268127, decouple_loss:0.0004619397805072367
Iteration: 2092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504580497741699, gen p mean: -0.12613807618618011, mean p set: 0.4510363042354584
loss_pred:0.015069752931594849, decouple_loss:0.00040983312646858394
The modified gen p mean: 0.4517669379711151, gen p mean: -0.11623882502317429, mean p set: 0.4523443579673767The modified gen p mean: 0.4494873881340027, gen p mean: -0.12354810535907745, mean p set: 0.45006391406059265
loss_pred:0.0143455620855093, decouple_loss:0.0004408278618939221loss_pred:0.015222172252833843, decouple_loss:0.0006001407746225595
Iteration: 2093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518481194972992, gen p mean: -0.11634061485528946, mean p set: 0.45242658257484436
loss_pred:0.015382863581180573, decouple_loss:0.0005517539684660733
The modified gen p mean: 0.4547654986381531, gen p mean: -0.11525219678878784, mean p set: 0.4553443193435669
loss_pred:0.014746901579201221, decouple_loss:0.0006865093018859625
The modified gen p mean: 0.45002004504203796, gen p mean: -0.11556828022003174, mean p set: 0.4505993127822876
loss_pred:0.015014166943728924, decouple_loss:0.0005518412799574435
Iteration: 2094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504944682121277, gen p mean: -0.11182371526956558, mean p set: 0.451071560382843
loss_pred:0.014895970933139324, decouple_loss:0.0004973944160155952
The modified gen p mean: 0.451944500207901, gen p mean: -0.10690224170684814, mean p set: 0.45252126455307007
loss_pred:0.014429809525609016, decouple_loss:0.0006973723648115993
The modified gen p mean: 0.4512133300304413, gen p mean: -0.11215697973966599, mean p set: 0.4517882466316223
loss_pred:0.01548083033412695, decouple_loss:0.0005368958809413016
Iteration: 2095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45032694935798645, gen p mean: -0.11458341032266617, mean p set: 0.4509033262729645
loss_pred:0.014589224942028522, decouple_loss:0.0004358904843684286
The modified gen p mean: 0.45064759254455566, gen p mean: -0.1107688918709755, mean p set: 0.4512208104133606
loss_pred:0.015183349139988422, decouple_loss:0.0004684112500399351
The modified gen p mean: 0.4522048234939575, gen p mean: -0.10877010971307755, mean p set: 0.4527818560600281
loss_pred:0.014563354663550854, decouple_loss:0.000505025964230299
Iteration: 2096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502953588962555, gen p mean: -0.10494473576545715, mean p set: 0.45086991786956787
loss_pred:0.01483390387147665, decouple_loss:0.000510722806211561
The modified gen p mean: 0.45184144377708435, gen p mean: -0.10524941235780716, mean p set: 0.4524182975292206
loss_pred:0.015247351489961147, decouple_loss:0.0004216825182083994
The modified gen p mean: 0.44936713576316833, gen p mean: -0.10749693959951401, mean p set: 0.4499439597129822
loss_pred:0.0146242156624794, decouple_loss:0.0004561009118333459
Iteration: 2097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45394623279571533, gen p mean: -0.10370314866304398, mean p set: 0.45452621579170227
loss_pred:0.014181393198668957, decouple_loss:0.0006466605118475854
The modified gen p mean: 0.45028549432754517, gen p mean: -0.09568428248167038, mean p set: 0.45086169242858887
loss_pred:0.01522117294371128, decouple_loss:0.00047579818055965006
The modified gen p mean: 0.450153112411499, gen p mean: -0.1029389351606369, mean p set: 0.4507260322570801
loss_pred:0.015301018953323364, decouple_loss:0.00045149362995289266
Iteration: 2098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510766565799713, gen p mean: -0.09442228823900223, mean p set: 0.45165497064590454
loss_pred:0.01574704423546791, decouple_loss:0.0004033639852423221
The modified gen p mean: 0.4526335597038269, gen p mean: -0.09913680702447891, mean p set: 0.4532093107700348
loss_pred:0.015231205150485039, decouple_loss:0.00048072714707814157
The modified gen p mean: 0.4504885971546173, gen p mean: -0.10665547102689743, mean p set: 0.4510650634765625
loss_pred:0.014643396250903606, decouple_loss:0.0004489523416850716
Iteration: 2099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44967299699783325, gen p mean: -0.11325954645872116, mean p set: 0.45025137066841125
loss_pred:0.014657580293715, decouple_loss:0.00041262866579927504
The modified gen p mean: 0.4513399302959442, gen p mean: -0.10410262644290924, mean p set: 0.4519164264202118
loss_pred:0.015277341939508915, decouple_loss:0.0003802186984103173
The modified gen p mean: 0.45047643780708313, gen p mean: -0.09950751066207886, mean p set: 0.45105352997779846
loss_pred:0.015600982122123241, decouple_loss:0.0003932455147150904
Iteration: 2100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45249325037002563, gen p mean: -0.11212461441755295, mean p set: 0.45306864380836487
loss_pred:0.015964902937412262, decouple_loss:0.0005175808910280466
The modified gen p mean: 0.45207488536834717, gen p mean: -0.10826355218887329, mean p set: 0.45265111327171326
loss_pred:0.015488369390368462, decouple_loss:0.0005295270239003003
The modified gen p mean: 0.45186877250671387, gen p mean: -0.11197441071271896, mean p set: 0.4524455666542053
loss_pred:0.014728647656738758, decouple_loss:0.00039459342951886356
2023-05-02 11:17:10 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13112714886665344, mean p set: 0.4502691626548767
loss_pred:0.016958320513367653, decouple_loss:0.0005001091049052775
The modified gen p mean: 0.44953736662864685, gen p mean: -0.12397574633359909, mean p set: 0.4500633478164673
loss_pred:0.016316184774041176, decouple_loss:0.0004157050570938736
The modified gen p mean: 0.44982948899269104, gen p mean: -0.12383156269788742, mean p set: 0.45035696029663086
loss_pred:0.016571661457419395, decouple_loss:0.0004148559528402984
WV_1_PC_1_EH_0_PS_40, loss: 0.016637567430734634, avg_mse: 0.025828244164586067
current test mse: 0.025828
Iteration: 2101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44984233379364014, gen p mean: -0.1186421737074852, mean p set: 0.4504178762435913
loss_pred:0.01482025720179081, decouple_loss:0.00038034087629057467
The modified gen p mean: 0.4505069851875305, gen p mean: -0.11166652292013168, mean p set: 0.45108428597450256
loss_pred:0.015164118260145187, decouple_loss:0.00037134747253730893
The modified gen p mean: 0.45093533396720886, gen p mean: -0.11786063015460968, mean p set: 0.4515113830566406
loss_pred:0.01478416845202446, decouple_loss:0.00039310636930167675
Iteration: 2102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524877071380615, gen p mean: -0.11591625213623047, mean p set: 0.453065425157547
loss_pred:0.015525572933256626, decouple_loss:0.0003965636424254626
The modified gen p mean: 0.4532434344291687, gen p mean: -0.11539041996002197, mean p set: 0.45382463932037354The modified gen p mean: 0.4506552219390869, gen p mean: -0.12492023408412933, mean p set: 0.451235830783844
loss_pred:0.015468545258045197, decouple_loss:0.00040761317359283566
loss_pred:0.01394325029104948, decouple_loss:0.00032590562477707863
Iteration: 2103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45191308856010437, gen p mean: -0.12056370824575424, mean p set: 0.45249199867248535
loss_pred:0.01521969772875309, decouple_loss:0.00033662363421171904
The modified gen p mean: 0.4510749578475952, gen p mean: -0.11625035852193832, mean p set: 0.4516505002975464The modified gen p mean: 0.4503285586833954, gen p mean: -0.12618452310562134, mean p set: 0.45090457797050476
loss_pred:0.014499050565063953, decouple_loss:0.00044371100375428796
loss_pred:0.014342647045850754, decouple_loss:0.00034383105230517685
Iteration: 2104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518929123878479, gen p mean: -0.12140272557735443, mean p set: 0.4524688422679901
loss_pred:0.014719493687152863, decouple_loss:0.00046986775123514235
The modified gen p mean: 0.45280495285987854, gen p mean: -0.1119556725025177, mean p set: 0.45338064432144165
loss_pred:0.016118492931127548, decouple_loss:0.0005474478821270168
The modified gen p mean: 0.449605256319046, gen p mean: -0.12358195334672928, mean p set: 0.45018270611763
loss_pred:0.014030266553163528, decouple_loss:0.00040135253220796585
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
NaN value num: 0
Iteration: 2105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482300281524658, gen p mean: -0.11925692111253738, mean p set: 0.44880592823028564
The modified gen p mean: 0.45040345191955566, gen p mean: -0.11524428427219391, mean p set: 0.45097923278808594
loss_pred:0.015499845147132874, decouple_loss:0.0005687203374691308
loss_pred:0.015362564474344254, decouple_loss:0.0004931259900331497
The modified gen p mean: 0.4504363536834717, gen p mean: -0.11530032753944397, mean p set: 0.45101216435432434
loss_pred:0.01593337208032608, decouple_loss:0.0006370393093675375
Iteration: 2106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488849937915802, gen p mean: -0.11148419231176376, mean p set: 0.4494609236717224
loss_pred:0.01567927561700344, decouple_loss:0.0006347389426082373
The modified gen p mean: 0.4483247399330139, gen p mean: -0.11587590724229813, mean p set: 0.4489029347896576
loss_pred:0.015106195583939552, decouple_loss:0.00041631393833085895
The modified gen p mean: 0.4501549005508423, gen p mean: -0.1127992570400238, mean p set: 0.4507306218147278
loss_pred:0.015275941230356693, decouple_loss:0.0004518234927672893
Iteration: 2107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504886269569397, gen p mean: -0.11496402323246002, mean p set: 0.45106494426727295
loss_pred:0.015060583129525185, decouple_loss:0.0004578743828460574
The modified gen p mean: 0.4500942528247833, gen p mean: -0.11512294411659241, mean p set: 0.45067140460014343
loss_pred:0.015223146416246891, decouple_loss:0.0004854034341406077
The modified gen p mean: 0.4488123953342438, gen p mean: -0.10577253997325897, mean p set: 0.44938743114471436
loss_pred:0.015041566453874111, decouple_loss:0.000446659600129351
Iteration: 2108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490000605583191, gen p mean: -0.1052074283361435, mean p set: 0.4495759904384613
loss_pred:0.01636866293847561, decouple_loss:0.00042381143430247903
The modified gen p mean: 0.4506783187389374, gen p mean: -0.10106584429740906, mean p set: 0.45125457644462585
loss_pred:0.015634100884199142, decouple_loss:0.0004970520967617631
The modified gen p mean: 0.4510473906993866, gen p mean: -0.10143931955099106, mean p set: 0.45162320137023926
loss_pred:0.01597304455935955, decouple_loss:0.0006859633722342551
Iteration: 2109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527285397052765, gen p mean: -0.0978413075208664, mean p set: 0.45330584049224854
loss_pred:0.016206204891204834, decouple_loss:0.00045708107063546777
The modified gen p mean: 0.4503880441188812, gen p mean: -0.09616653621196747, mean p set: 0.450965940952301
loss_pred:0.015586419962346554, decouple_loss:0.0004889196716248989
The modified gen p mean: 0.45164892077445984, gen p mean: -0.09774885326623917, mean p set: 0.45222410559654236
loss_pred:0.016056925058364868, decouple_loss:0.0005450979224406183
Iteration: 2110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001181960105896, gen p mean: -0.10268277674913406, mean p set: 0.4505888819694519
loss_pred:0.016088072210550308, decouple_loss:0.0004511580045800656
The modified gen p mean: 0.450907826423645, gen p mean: -0.1028352677822113, mean p set: 0.45148617029190063
loss_pred:0.01616993360221386, decouple_loss:0.0005155573599040508
The modified gen p mean: 0.4487193524837494, gen p mean: -0.10558163374662399, mean p set: 0.44929495453834534
loss_pred:0.015441819094121456, decouple_loss:0.00045538952690549195
2023-05-02 11:19:54 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.122149258852005, mean p set: 0.4502691626548767
loss_pred:0.017102215439081192, decouple_loss:0.0004090737202204764
The modified gen p mean: 0.44953352212905884, gen p mean: -0.11560023576021194, mean p set: 0.4500633478164673
loss_pred:0.016481740400195122, decouple_loss:0.0004165018326602876
The modified gen p mean: 0.44982674717903137, gen p mean: -0.11542762070894241, mean p set: 0.45035696029663086
loss_pred:0.01671857200562954, decouple_loss:0.0003776813391596079
WV_1_PC_1_EH_0_PS_40, loss: 0.016787564381957054, avg_mse: 0.025953199714422226
current test mse: 0.025953
Iteration: 2111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496454894542694, gen p mean: -0.1106509119272232, mean p set: 0.450222373008728
loss_pred:0.015464916825294495, decouple_loss:0.00040679745143279433
The modified gen p mean: 0.4496905505657196, gen p mean: -0.11065167188644409, mean p set: 0.45026499032974243The modified gen p mean: 0.449033260345459, gen p mean: -0.1094493418931961, mean p set: 0.4496089518070221
loss_pred:0.014597724191844463, decouple_loss:0.00036141599412076175
loss_pred:0.016327889636158943, decouple_loss:0.00040054041892290115
Iteration: 2112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495029151439667, gen p mean: -0.11640731990337372, mean p set: 0.4500787556171417
loss_pred:0.01600995846092701, decouple_loss:0.0004901840002276003
The modified gen p mean: 0.4513629972934723, gen p mean: -0.1025790423154831, mean p set: 0.45194050669670105The modified gen p mean: 0.4487933814525604, gen p mean: -0.11466092616319656, mean p set: 0.4493706524372101
loss_pred:0.015714121982455254, decouple_loss:0.00047082884702831507
loss_pred:0.015227041207253933, decouple_loss:0.0003917000722140074
Iteration: 2113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485551714897156, gen p mean: -0.12375801056623459, mean p set: 0.4491318166255951
loss_pred:0.01549364160746336, decouple_loss:0.00042115835822187364
The modified gen p mean: 0.44899556040763855, gen p mean: -0.12046505510807037, mean p set: 0.4495715796947479
loss_pred:0.01497913058847189, decouple_loss:0.0004803961783181876
The modified gen p mean: 0.4508000314235687, gen p mean: -0.1173790842294693, mean p set: 0.4513741731643677
loss_pred:0.014814558438956738, decouple_loss:0.0003948746307287365
Iteration: 2114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45316269993782043, gen p mean: -0.11870728433132172, mean p set: 0.45373791456222534
loss_pred:0.016344191506505013, decouple_loss:0.0004510238068178296
The modified gen p mean: 0.44903564453125, gen p mean: -0.12618039548397064, mean p set: 0.44961294531822205
loss_pred:0.015795908868312836, decouple_loss:0.0005164110334590077
The modified gen p mean: 0.451127290725708, gen p mean: -0.11987747997045517, mean p set: 0.4517059326171875
loss_pred:0.016598008573055267, decouple_loss:0.0006452803499996662
Iteration: 2115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45190808176994324, gen p mean: -0.11870864033699036, mean p set: 0.4524822235107422
loss_pred:0.01580987498164177, decouple_loss:0.0005119701381772757
The modified gen p mean: 0.44975805282592773, gen p mean: -0.12787291407585144, mean p set: 0.4503369629383087
loss_pred:0.015381211414933205, decouple_loss:0.0004203545395284891
The modified gen p mean: 0.4509814381599426, gen p mean: -0.10895754396915436, mean p set: 0.4515543580055237
loss_pred:0.016082823276519775, decouple_loss:0.00045986135955899954
Iteration: 2116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497281014919281, gen p mean: -0.1196996346116066, mean p set: 0.45030519366264343
loss_pred:0.014880020171403885, decouple_loss:0.00039773964090272784
The modified gen p mean: 0.44913196563720703, gen p mean: -0.12042675167322159, mean p set: 0.4497094452381134
The modified gen p mean: 0.44902557134628296, gen p mean: -0.12038362771272659, mean p set: 0.4496016502380371
loss_pred:0.015312645584344864, decouple_loss:0.0005234563141129911
loss_pred:0.015592231415212154, decouple_loss:0.0003669051802717149
Iteration: 2117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910281896591187, gen p mean: -0.11406701058149338, mean p set: 0.4496786296367645
loss_pred:0.015020598657429218, decouple_loss:0.0003807730972766876
The modified gen p mean: 0.4491650462150574, gen p mean: -0.11712387204170227, mean p set: 0.4497406780719757
loss_pred:0.014845818281173706, decouple_loss:0.00040731244371272624
The modified gen p mean: 0.44851353764533997, gen p mean: -0.10779153555631638, mean p set: 0.4490891993045807
loss_pred:0.015660280361771584, decouple_loss:0.00047411094419658184
Iteration: 2118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45279058814048767, gen p mean: -0.10722113400697708, mean p set: 0.4533670246601105
loss_pred:0.015629494562745094, decouple_loss:0.00064569350797683
The modified gen p mean: 0.4494151473045349, gen p mean: -0.10705547779798508, mean p set: 0.44999220967292786
loss_pred:0.015123255550861359, decouple_loss:0.0004792275431100279
The modified gen p mean: 0.4510229229927063, gen p mean: -0.10455635190010071, mean p set: 0.4515989124774933
loss_pred:0.016280733048915863, decouple_loss:0.000510323909111321
Iteration: 2119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44985395669937134, gen p mean: -0.10862509161233902, mean p set: 0.45042943954467773
loss_pred:0.015628907829523087, decouple_loss:0.0004160321259405464
The modified gen p mean: 0.45163142681121826, gen p mean: -0.09935088455677032, mean p set: 0.45220720767974854
loss_pred:0.015721669420599937, decouple_loss:0.00042735671740956604
The modified gen p mean: 0.44948023557662964, gen p mean: -0.11032786220312119, mean p set: 0.45005717873573303
loss_pred:0.015301280654966831, decouple_loss:0.0004045209789182991
Iteration: 2120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45070168375968933, gen p mean: -0.10804948210716248, mean p set: 0.45127683877944946
loss_pred:0.014813248999416828, decouple_loss:0.0004702016885858029
The modified gen p mean: 0.4504010081291199, gen p mean: -0.10799349099397659, mean p set: 0.45097601413726807
The modified gen p mean: 0.45091626048088074, gen p mean: -0.10390942543745041, mean p set: 0.45149263739585876
loss_pred:0.016153499484062195, decouple_loss:0.0005954655935056508
loss_pred:0.015137208625674248, decouple_loss:0.000542826484888792
2023-05-02 11:22:00 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12408160418272018, mean p set: 0.4502691626548767
loss_pred:0.016960592940449715, decouple_loss:0.0004358854203019291
The modified gen p mean: 0.4495348632335663, gen p mean: -0.11757181584835052, mean p set: 0.4500633478164673
loss_pred:0.01634453423321247, decouple_loss:0.00045695557491853833
The modified gen p mean: 0.44982945919036865, gen p mean: -0.11729233711957932, mean p set: 0.45035696029663086
loss_pred:0.01665472984313965, decouple_loss:0.0004838735330849886
WV_1_PC_1_EH_0_PS_40, loss: 0.01667623221874237, avg_mse: 0.025899482890963554
current test mse: 0.025899
Iteration: 2121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817057251930237, gen p mean: -0.11589354276657104, mean p set: 0.4487481415271759
loss_pred:0.015338093973696232, decouple_loss:0.00035233682137914
The modified gen p mean: 0.4483633041381836, gen p mean: -0.11240219324827194, mean p set: 0.4489399194717407
The modified gen p mean: 0.44947442412376404, gen p mean: -0.10666985809803009, mean p set: 0.45004913210868835
loss_pred:0.014944483526051044, decouple_loss:0.0004060956125613302
loss_pred:0.01555607933551073, decouple_loss:0.0005127126933075488
Iteration: 2122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44961658120155334, gen p mean: -0.115679070353508, mean p set: 0.4501922130584717The modified gen p mean: 0.4496903121471405, gen p mean: -0.11739406734704971, mean p set: 0.4502660930156708
loss_pred:0.01533007062971592, decouple_loss:0.00043804713641293347loss_pred:0.015341406688094139, decouple_loss:0.00042908458271995187
The modified gen p mean: 0.4489326477050781, gen p mean: -0.11656337976455688, mean p set: 0.4495096802711487
loss_pred:0.015146155841648579, decouple_loss:0.00035983783891424537
Iteration: 2123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44857001304626465, gen p mean: -0.10858184099197388, mean p set: 0.44914600253105164
The modified gen p mean: 0.45239347219467163, gen p mean: -0.111487977206707, mean p set: 0.4529705345630646
loss_pred:0.015229078941047192, decouple_loss:0.0004442506469786167
loss_pred:0.015187372453510761, decouple_loss:0.0005903597921133041
The modified gen p mean: 0.45013973116874695, gen p mean: -0.11497970670461655, mean p set: 0.4507175385951996
loss_pred:0.015185113996267319, decouple_loss:0.00036862853448837996
Iteration: 2124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483451545238495, gen p mean: -0.11486341059207916, mean p set: 0.44892165064811707
loss_pred:0.015230612829327583, decouple_loss:0.00040186854312196374
The modified gen p mean: 0.4508948028087616, gen p mean: -0.09815656393766403, mean p set: 0.45147207379341125
loss_pred:0.01571522280573845, decouple_loss:0.0005249209934845567
The modified gen p mean: 0.44920748472213745, gen p mean: -0.11235339194536209, mean p set: 0.4497845768928528
loss_pred:0.01607368513941765, decouple_loss:0.0004210970946587622
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 2125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446981817483902, gen p mean: -0.12105391174554825, mean p set: 0.4475582242012024
loss_pred:0.014859979040920734, decouple_loss:0.0004904892412014306
The modified gen p mean: 0.44755032658576965, gen p mean: -0.11365370452404022, mean p set: 0.4481275677680969
loss_pred:0.015336435288190842, decouple_loss:0.0003837531548924744
The modified gen p mean: 0.4457584023475647, gen p mean: -0.11470306664705276, mean p set: 0.4463328719139099
loss_pred:0.015230038203299046, decouple_loss:0.00048379693180322647
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470999240875244, gen p mean: -0.11490000784397125, mean p set: 0.4476762115955353
loss_pred:0.014848824590444565, decouple_loss:0.0005402470706030726
The modified gen p mean: 0.44772765040397644, gen p mean: -0.11671601235866547, mean p set: 0.4483036994934082
loss_pred:0.01472685020416975, decouple_loss:0.00036298943450674415
The modified gen p mean: 0.44642460346221924, gen p mean: -0.12071983516216278, mean p set: 0.44700121879577637
loss_pred:0.015801969915628433, decouple_loss:0.0004190718464087695
Iteration: 2127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44588562846183777, gen p mean: -0.11598993837833405, mean p set: 0.4464643895626068
loss_pred:0.015425069257616997, decouple_loss:0.00042887317249551415
The modified gen p mean: 0.4479878842830658, gen p mean: -0.11862365156412125, mean p set: 0.44856566190719604
loss_pred:0.0149534335359931, decouple_loss:0.00041215913370251656
The modified gen p mean: 0.44687631726264954, gen p mean: -0.11774680763483047, mean p set: 0.4474518895149231
loss_pred:0.015098823234438896, decouple_loss:0.0004345883207861334
Iteration: 2128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468179941177368, gen p mean: -0.12045647948980331, mean p set: 0.447394996881485
loss_pred:0.015229741111397743, decouple_loss:0.0004438920586835593
The modified gen p mean: 0.4483293294906616, gen p mean: -0.12521174550056458, mean p set: 0.4489026963710785
The modified gen p mean: 0.4470110237598419, gen p mean: -0.12019310891628265, mean p set: 0.447585791349411
loss_pred:0.014925673604011536, decouple_loss:0.00046829390339553356
loss_pred:0.015086580067873001, decouple_loss:0.00042500923154875636
Iteration: 2129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471501111984253, gen p mean: -0.1253068596124649, mean p set: 0.44772762060165405
loss_pred:0.014474771916866302, decouple_loss:0.0003416070539969951
The modified gen p mean: 0.44679275155067444, gen p mean: -0.11622066050767899, mean p set: 0.447368860244751
loss_pred:0.015421527437865734, decouple_loss:0.00035677754203788936
The modified gen p mean: 0.4460729956626892, gen p mean: -0.11601803451776505, mean p set: 0.4466512203216553
loss_pred:0.015721652656793594, decouple_loss:0.0004532062739599496
Iteration: 2130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464888274669647, gen p mean: -0.1229209378361702, mean p set: 0.4470658302307129
loss_pred:0.015480647794902325, decouple_loss:0.0004051696159876883
The modified gen p mean: 0.4459303319454193, gen p mean: -0.12375982105731964, mean p set: 0.446504145860672
loss_pred:0.015304356813430786, decouple_loss:0.0004998153890483081
The modified gen p mean: 0.4479256570339203, gen p mean: -0.12635637819766998, mean p set: 0.44850221276283264
loss_pred:0.01482293289154768, decouple_loss:0.00042778882198035717
2023-05-02 11:24:45 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1274743527173996, mean p set: 0.4502691626548767
loss_pred:0.016856417059898376, decouple_loss:0.0003542409685906023
The modified gen p mean: 0.44953304529190063, gen p mean: -0.12094184756278992, mean p set: 0.4500633478164673
loss_pred:0.016254844143986702, decouple_loss:0.00037643351242877543
The modified gen p mean: 0.449826717376709, gen p mean: -0.12025991082191467, mean p set: 0.45035696029663086
loss_pred:0.01654990203678608, decouple_loss:0.0003938655718229711
WV_1_PC_1_EH_0_PS_40, loss: 0.016572464257478714, avg_mse: 0.02575397863984108
current test mse: 0.025754
Iteration: 2131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775497913360596, gen p mean: -0.12597768008708954, mean p set: 0.44833290576934814
loss_pred:0.014865027740597725, decouple_loss:0.0003559596079867333
The modified gen p mean: 0.447227418422699, gen p mean: -0.12903575599193573, mean p set: 0.4478035867214203The modified gen p mean: 0.4464453458786011, gen p mean: -0.1256316900253296, mean p set: 0.44701918959617615
loss_pred:0.015341141261160374, decouple_loss:0.0004338372964411974
loss_pred:0.015638355165719986, decouple_loss:0.0004954191972501576
Iteration: 2132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447083055973053, gen p mean: -0.1256164014339447, mean p set: 0.4476585388183594
The modified gen p mean: 0.4471023976802826, gen p mean: -0.1276938021183014, mean p set: 0.44767507910728455
loss_pred:0.015200969763100147, decouple_loss:0.00043360615381971
loss_pred:0.014819586649537086, decouple_loss:0.0003884151519741863
The modified gen p mean: 0.44799572229385376, gen p mean: -0.12471137940883636, mean p set: 0.448570191860199
loss_pred:0.014940017834305763, decouple_loss:0.0003285050333943218
Iteration: 2133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459421932697296, gen p mean: -0.12224192172288895, mean p set: 0.44651639461517334
The modified gen p mean: 0.4487299919128418, gen p mean: -0.13044866919517517, mean p set: 0.44930580258369446
loss_pred:0.01537640206515789, decouple_loss:0.0003888641658704728
loss_pred:0.014609893783926964, decouple_loss:0.0003751708718482405
The modified gen p mean: 0.4476223289966583, gen p mean: -0.1227753609418869, mean p set: 0.44819772243499756
loss_pred:0.015435892157256603, decouple_loss:0.0003939863236155361
Iteration: 2134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749385118484497, gen p mean: -0.1200333833694458, mean p set: 0.44806966185569763
loss_pred:0.014664793387055397, decouple_loss:0.00035782891791313887
The modified gen p mean: 0.44670841097831726, gen p mean: -0.12022488564252853, mean p set: 0.4472809433937073
loss_pred:0.015332743525505066, decouple_loss:0.0004738461575470865
The modified gen p mean: 0.4469553828239441, gen p mean: -0.11966162174940109, mean p set: 0.4475339949131012
loss_pred:0.015430605039000511, decouple_loss:0.00037303753197193146
Iteration: 2135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686323404312134, gen p mean: -0.11793798953294754, mean p set: 0.4474363923072815
loss_pred:0.014985824003815651, decouple_loss:0.0004970488371327519
The modified gen p mean: 0.4466077387332916, gen p mean: -0.11499932408332825, mean p set: 0.4471836984157562
loss_pred:0.015199112705886364, decouple_loss:0.0004211583873257041
The modified gen p mean: 0.4467456340789795, gen p mean: -0.1208902969956398, mean p set: 0.44731974601745605
loss_pred:0.014983415603637695, decouple_loss:0.0005216677091084421
Iteration: 2136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44666728377342224, gen p mean: -0.1210150495171547, mean p set: 0.44724223017692566
loss_pred:0.015122190117835999, decouple_loss:0.00038261464214883745
The modified gen p mean: 0.44724443554878235, gen p mean: -0.12160822004079819, mean p set: 0.44781920313835144
loss_pred:0.01529315859079361, decouple_loss:0.0003959172172471881
The modified gen p mean: 0.44741496443748474, gen p mean: -0.1174987256526947, mean p set: 0.4479915201663971
loss_pred:0.014636225998401642, decouple_loss:0.0004048562259413302
Iteration: 2137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464474320411682, gen p mean: -0.11995790898799896, mean p set: 0.44702303409576416
loss_pred:0.015147415921092033, decouple_loss:0.00037632230669260025
The modified gen p mean: 0.44686591625213623, gen p mean: -0.1181216686964035, mean p set: 0.4474417567253113
loss_pred:0.01507670246064663, decouple_loss:0.00046809198101982474
The modified gen p mean: 0.4467756152153015, gen p mean: -0.11854394525289536, mean p set: 0.44735097885131836
loss_pred:0.014691632241010666, decouple_loss:0.00037350718048401177
Iteration: 2138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467705488204956, gen p mean: -0.11750023066997528, mean p set: 0.4473459720611572
loss_pred:0.01511656679213047, decouple_loss:0.0004248869663570076
The modified gen p mean: 0.44701674580574036, gen p mean: -0.12183412164449692, mean p set: 0.447593629360199
The modified gen p mean: 0.44692131876945496, gen p mean: -0.11841542273759842, mean p set: 0.4474965035915375
loss_pred:0.014862271025776863, decouple_loss:0.0003641285584308207
loss_pred:0.014603165909647942, decouple_loss:0.0004941124352626503
Iteration: 2139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477161467075348, gen p mean: -0.11928632110357285, mean p set: 0.44829118251800537
loss_pred:0.014501155354082584, decouple_loss:0.00037307164166122675
The modified gen p mean: 0.4469870328903198, gen p mean: -0.12457379698753357, mean p set: 0.4475627839565277
The modified gen p mean: 0.44726040959358215, gen p mean: -0.12168209254741669, mean p set: 0.4478381872177124
loss_pred:0.013790419325232506, decouple_loss:0.0003316865477245301
loss_pred:0.014734717085957527, decouple_loss:0.00041965433047153056
Iteration: 2140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471292197704315, gen p mean: -0.12230229377746582, mean p set: 0.4477064609527588
loss_pred:0.014555379748344421, decouple_loss:0.000384609418688342
The modified gen p mean: 0.4472597539424896, gen p mean: -0.12336266785860062, mean p set: 0.44783177971839905
loss_pred:0.015088164247572422, decouple_loss:0.0004658812249545008
The modified gen p mean: 0.4468154311180115, gen p mean: -0.12152627855539322, mean p set: 0.44738972187042236
loss_pred:0.01504598744213581, decouple_loss:0.00032622076105326414
2023-05-02 11:26:52 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12872661650180817, mean p set: 0.4502691626548767
loss_pred:0.016857262700796127, decouple_loss:0.0003970001998823136
The modified gen p mean: 0.4495340585708618, gen p mean: -0.12163300067186356, mean p set: 0.4500633478164673
loss_pred:0.01613868772983551, decouple_loss:0.0003796753007918596
The modified gen p mean: 0.4498274028301239, gen p mean: -0.12108416110277176, mean p set: 0.45035696029663086
loss_pred:0.016540132462978363, decouple_loss:0.0004197025264147669
WV_1_PC_1_EH_0_PS_40, loss: 0.016531966626644135, avg_mse: 0.025776663795113564
current test mse: 0.025777
Iteration: 2141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468945860862732, gen p mean: -0.12501703202724457, mean p set: 0.4474670886993408
loss_pred:0.014517107978463173, decouple_loss:0.0003243154496885836
The modified gen p mean: 0.44600391387939453, gen p mean: -0.11846143007278442, mean p set: 0.44658011198043823The modified gen p mean: 0.44604504108428955, gen p mean: -0.12137731909751892, mean p set: 0.4466211497783661
loss_pred:0.015322073362767696, decouple_loss:0.000528471078723669loss_pred:0.01480085402727127, decouple_loss:0.00035044620744884014
Iteration: 2142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466135799884796, gen p mean: -0.12387294322252274, mean p set: 0.44718724489212036
loss_pred:0.015211241319775581, decouple_loss:0.00034502011840231717
The modified gen p mean: 0.44594883918762207, gen p mean: -0.12508757412433624, mean p set: 0.4465225338935852The modified gen p mean: 0.44699540734291077, gen p mean: -0.12777960300445557, mean p set: 0.4475724399089813
loss_pred:0.01484223548322916, decouple_loss:0.0004131595778744668
loss_pred:0.014660347253084183, decouple_loss:0.00037904217606410384
Iteration: 2143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467697739601135, gen p mean: -0.12327585369348526, mean p set: 0.4473433792591095
loss_pred:0.014951631426811218, decouple_loss:0.0003874159592669457
The modified gen p mean: 0.4478830397129059, gen p mean: -0.12493668496608734, mean p set: 0.44846251606941223
loss_pred:0.014339683577418327, decouple_loss:0.0003413801605347544
The modified gen p mean: 0.446348637342453, gen p mean: -0.12282560765743256, mean p set: 0.44692397117614746
loss_pred:0.015222818590700626, decouple_loss:0.00041593704372644424
Iteration: 2144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461539387702942, gen p mean: -0.1193511113524437, mean p set: 0.44673141837120056
loss_pred:0.01532304473221302, decouple_loss:0.000350303016602993
The modified gen p mean: 0.4462055265903473, gen p mean: -0.120929054915905, mean p set: 0.4467797577381134
loss_pred:0.015040706843137741, decouple_loss:0.0003819788107648492
The modified gen p mean: 0.4466665983200073, gen p mean: -0.12264598160982132, mean p set: 0.44724246859550476
loss_pred:0.014548967592418194, decouple_loss:0.0003342964337207377
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
NaN value num: 0
Iteration: 2145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45003682374954224, gen p mean: -0.10707249492406845, mean p set: 0.45061564445495605
The modified gen p mean: 0.44851911067962646, gen p mean: -0.10793532431125641, mean p set: 0.4490962028503418loss_pred:0.015415948815643787, decouple_loss:0.00040371104842051864
loss_pred:0.015272241085767746, decouple_loss:0.0004769556690007448
The modified gen p mean: 0.4501625895500183, gen p mean: -0.11146911978721619, mean p set: 0.4507381319999695
loss_pred:0.015474328771233559, decouple_loss:0.00040201275260187685
Iteration: 2146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496886730194092, gen p mean: -0.10667366534471512, mean p set: 0.4502647817134857
loss_pred:0.015505076386034489, decouple_loss:0.000345403648680076
The modified gen p mean: 0.44859954714775085, gen p mean: -0.10621239989995956, mean p set: 0.44917601346969604
The modified gen p mean: 0.45087456703186035, gen p mean: -0.10359346866607666, mean p set: 0.4514475464820862
loss_pred:0.015275261364877224, decouple_loss:0.0003646306577138603
loss_pred:0.016144342720508575, decouple_loss:0.00045759030035696924
Iteration: 2147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45217663049697876, gen p mean: -0.1049049124121666, mean p set: 0.4527532756328583
loss_pred:0.015451597981154919, decouple_loss:0.0004331482923589647
The modified gen p mean: 0.45135942101478577, gen p mean: -0.10502070933580399, mean p set: 0.45193424820899963
loss_pred:0.015888525173068047, decouple_loss:0.0003909276856575161
The modified gen p mean: 0.4492146074771881, gen p mean: -0.10514484345912933, mean p set: 0.44979190826416016
loss_pred:0.015287122689187527, decouple_loss:0.00040318287210538983
Iteration: 2148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45243778824806213, gen p mean: -0.10442940145730972, mean p set: 0.45301464200019836
loss_pred:0.015001939609646797, decouple_loss:0.0005196601850911975
The modified gen p mean: 0.45009902119636536, gen p mean: -0.10679356008768082, mean p set: 0.45067617297172546
loss_pred:0.014625546522438526, decouple_loss:0.0004148408188484609
The modified gen p mean: 0.45028385519981384, gen p mean: -0.10707882046699524, mean p set: 0.4508603513240814
loss_pred:0.015865640714764595, decouple_loss:0.00039451211341656744
Iteration: 2149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493868052959442, gen p mean: -0.10213000327348709, mean p set: 0.44996383786201477
loss_pred:0.015675121918320656, decouple_loss:0.000434365269029513
The modified gen p mean: 0.4508034288883209, gen p mean: -0.10426755249500275, mean p set: 0.45137903094291687
loss_pred:0.016194777563214302, decouple_loss:0.00045093821245245636
The modified gen p mean: 0.4497337341308594, gen p mean: -0.10307206213474274, mean p set: 0.4503108859062195
loss_pred:0.015273123048245907, decouple_loss:0.00042796501656994224
Iteration: 2150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501863420009613, gen p mean: -0.10249357670545578, mean p set: 0.4507634937763214
loss_pred:0.015520873479545116, decouple_loss:0.00045914127258583903
The modified gen p mean: 0.45031309127807617, gen p mean: -0.11086493730545044, mean p set: 0.45088836550712585
loss_pred:0.015467884950339794, decouple_loss:0.0004337199206929654
The modified gen p mean: 0.4524736702442169, gen p mean: -0.10209933668375015, mean p set: 0.4530515968799591
loss_pred:0.01536051370203495, decouple_loss:0.0004289789649192244
2023-05-02 11:29:37 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11674156039953232, mean p set: 0.4502691626548767
loss_pred:0.016886482015252113, decouple_loss:0.0004937153425998986
The modified gen p mean: 0.44953569769859314, gen p mean: -0.10984089970588684, mean p set: 0.4500633478164673
loss_pred:0.016183027997612953, decouple_loss:0.0004507403646130115
The modified gen p mean: 0.4498291611671448, gen p mean: -0.10940336436033249, mean p set: 0.45035696029663086
loss_pred:0.01664450205862522, decouple_loss:0.0004035901802126318
WV_1_PC_1_EH_0_PS_40, loss: 0.016593804582953453, avg_mse: 0.025804243981838226
current test mse: 0.025804
Iteration: 2151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449484646320343, gen p mean: -0.10630317777395248, mean p set: 0.450061172246933
loss_pred:0.016003914177417755, decouple_loss:0.0005429425509646535
The modified gen p mean: 0.44942015409469604, gen p mean: -0.10217445343732834, mean p set: 0.44999533891677856
loss_pred:0.015548964962363243, decouple_loss:0.0004991173045709729
The modified gen p mean: 0.45028263330459595, gen p mean: -0.10258688777685165, mean p set: 0.45085835456848145
loss_pred:0.015250238589942455, decouple_loss:0.0005118249682709575
Iteration: 2152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492605924606323, gen p mean: -0.104264996945858, mean p set: 0.4498359262943268
loss_pred:0.015247895382344723, decouple_loss:0.00051114521920681
The modified gen p mean: 0.44895175099372864, gen p mean: -0.10216124355792999, mean p set: 0.4495299756526947The modified gen p mean: 0.45028698444366455, gen p mean: -0.10163221508264542, mean p set: 0.4508640468120575
loss_pred:0.015505983494222164, decouple_loss:0.00040324864676222205
loss_pred:0.01499833445996046, decouple_loss:0.00031694662175141275
Iteration: 2153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44940638542175293, gen p mean: -0.10492803156375885, mean p set: 0.44998228549957275
loss_pred:0.0153961768373847, decouple_loss:0.0005491746705956757
The modified gen p mean: 0.4490007758140564, gen p mean: -0.10666902363300323, mean p set: 0.44957631826400757
loss_pred:0.01529440563172102, decouple_loss:0.0005646434146910906
The modified gen p mean: 0.4511179029941559, gen p mean: -0.10064445436000824, mean p set: 0.45169559121131897
loss_pred:0.015811249613761902, decouple_loss:0.0004355595738161355
Iteration: 2154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45155397057533264, gen p mean: -0.10791522264480591, mean p set: 0.45213228464126587
loss_pred:0.015042168088257313, decouple_loss:0.0005535775562748313
The modified gen p mean: 0.44944900274276733, gen p mean: -0.10688567161560059, mean p set: 0.45002463459968567
loss_pred:0.0149453179910779, decouple_loss:0.0004713885427918285
The modified gen p mean: 0.4500756859779358, gen p mean: -0.1102924644947052, mean p set: 0.4506552517414093
loss_pred:0.016177762299776077, decouple_loss:0.00048212724504992366
Iteration: 2155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44805264472961426, gen p mean: -0.1120847538113594, mean p set: 0.4486272633075714
loss_pred:0.015482273884117603, decouple_loss:0.0003708430740516633
The modified gen p mean: 0.44964781403541565, gen p mean: -0.11048455536365509, mean p set: 0.4502233564853668
loss_pred:0.014903834089636803, decouple_loss:0.00045542389852926135
The modified gen p mean: 0.45010730624198914, gen p mean: -0.10576959699392319, mean p set: 0.45068490505218506
loss_pred:0.015309709124267101, decouple_loss:0.00036684153019450605
Iteration: 2156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44921764731407166, gen p mean: -0.1064191535115242, mean p set: 0.4497922658920288
loss_pred:0.0152590936049819, decouple_loss:0.0005014842026866972
The modified gen p mean: 0.4498976469039917, gen p mean: -0.10546783357858658, mean p set: 0.45047301054000854
The modified gen p mean: 0.44957050681114197, gen p mean: -0.10315439105033875, mean p set: 0.4501486122608185
loss_pred:0.015690399333834648, decouple_loss:0.000497288245242089
loss_pred:0.015296528115868568, decouple_loss:0.0005635635461658239
Iteration: 2157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449790894985199, gen p mean: -0.10302957147359848, mean p set: 0.4503673017024994
loss_pred:0.014511789195239544, decouple_loss:0.00036407168954610825
The modified gen p mean: 0.45187607407569885, gen p mean: -0.10493079572916031, mean p set: 0.4524524509906769
loss_pred:0.014733275398612022, decouple_loss:0.00042702065547928214
The modified gen p mean: 0.4502110481262207, gen p mean: -0.10195432603359222, mean p set: 0.45078805088996887
loss_pred:0.015442568808794022, decouple_loss:0.0004858695319853723
Iteration: 2158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844308495521545, gen p mean: -0.10768986493349075, mean p set: 0.4490193724632263
loss_pred:0.014737394638359547, decouple_loss:0.0005158318090252578
The modified gen p mean: 0.44916170835494995, gen p mean: -0.09717952460050583, mean p set: 0.44973790645599365
The modified gen p mean: 0.4499301612377167, gen p mean: -0.103375144302845, mean p set: 0.4505075514316559
loss_pred:0.014700706116855145, decouple_loss:0.00038899711216799915
loss_pred:0.01555955596268177, decouple_loss:0.0005466751172207296
Iteration: 2159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45240554213523865, gen p mean: -0.09833960235118866, mean p set: 0.4529832601547241
loss_pred:0.014384470880031586, decouple_loss:0.0005887980805709958
The modified gen p mean: 0.4532122015953064, gen p mean: -0.0985024943947792, mean p set: 0.4537885785102844
loss_pred:0.014220583252608776, decouple_loss:0.0005538849509321153
The modified gen p mean: 0.4487801492214203, gen p mean: -0.09907061606645584, mean p set: 0.4493563175201416
loss_pred:0.015437818132340908, decouple_loss:0.00036212237318977714
Iteration: 2160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44932353496551514, gen p mean: -0.09644979983568192, mean p set: 0.44989991188049316
loss_pred:0.014724798500537872, decouple_loss:0.0004989331355318427
The modified gen p mean: 0.44974789023399353, gen p mean: -0.0968279018998146, mean p set: 0.4503227472305298
loss_pred:0.015055879950523376, decouple_loss:0.00036856395308859646
The modified gen p mean: 0.45207276940345764, gen p mean: -0.09609512239694595, mean p set: 0.4526490569114685
loss_pred:0.014578226953744888, decouple_loss:0.00043472080142237246
2023-05-02 11:31:44 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11282309889793396, mean p set: 0.4502691626548767
loss_pred:0.016915788874030113, decouple_loss:0.0005032481858506799
The modified gen p mean: 0.44953399896621704, gen p mean: -0.10609861463308334, mean p set: 0.4500633478164673
loss_pred:0.016236046329140663, decouple_loss:0.0006050578667782247
The modified gen p mean: 0.4498283565044403, gen p mean: -0.1059064194560051, mean p set: 0.45035696029663086
loss_pred:0.016549566760659218, decouple_loss:0.0005634785047732294
WV_1_PC_1_EH_0_PS_40, loss: 0.01659499853849411, avg_mse: 0.02583450637757778
current test mse: 0.025835
Iteration: 2161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493846893310547, gen p mean: -0.10304137319326401, mean p set: 0.4499586224555969
loss_pred:0.01470232754945755, decouple_loss:0.00038976475480012596
The modified gen p mean: 0.45228996872901917, gen p mean: -0.09982983022928238, mean p set: 0.4528670310974121
loss_pred:0.015089903026819229, decouple_loss:0.0005753941368311644
The modified gen p mean: 0.44991442561149597, gen p mean: -0.10214097797870636, mean p set: 0.4504907429218292
loss_pred:0.015820374712347984, decouple_loss:0.00046137109166011214
Iteration: 2162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013681054115295, gen p mean: -0.099372498691082, mean p set: 0.45071205496788025
loss_pred:0.015200848691165447, decouple_loss:0.0004452274879440665
The modified gen p mean: 0.44981876015663147, gen p mean: -0.1116381287574768, mean p set: 0.450395405292511The modified gen p mean: 0.4486464262008667, gen p mean: -0.10631820559501648, mean p set: 0.44922199845314026
loss_pred:0.01456098910421133, decouple_loss:0.0006720312521792948
loss_pred:0.014951741322875023, decouple_loss:0.0006716937059536576
Iteration: 2163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45138394832611084, gen p mean: -0.10261107981204987, mean p set: 0.4519580006599426
loss_pred:0.015618367120623589, decouple_loss:0.0004601823748089373
The modified gen p mean: 0.45163509249687195, gen p mean: -0.10250740498304367, mean p set: 0.45221027731895447
loss_pred:0.015379483811557293, decouple_loss:0.0004896399914287031
The modified gen p mean: 0.450464129447937, gen p mean: -0.10332456976175308, mean p set: 0.45104068517684937
loss_pred:0.015276147052645683, decouple_loss:0.00041156791849061847
Iteration: 2164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507339298725128, gen p mean: -0.11385851353406906, mean p set: 0.4513118267059326
loss_pred:0.015084278769791126, decouple_loss:0.000354144285665825
The modified gen p mean: 0.4499300718307495, gen p mean: -0.10776388645172119, mean p set: 0.4505055248737335
loss_pred:0.014738226309418678, decouple_loss:0.0004481773648876697
The modified gen p mean: 0.4490766227245331, gen p mean: -0.10571157187223434, mean p set: 0.4496554732322693
loss_pred:0.014889203943312168, decouple_loss:0.0003452195378486067
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 2165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774991273880005, gen p mean: -0.11130169034004211, mean p set: 0.44832706451416016
The modified gen p mean: 0.44605135917663574, gen p mean: -0.11717699468135834, mean p set: 0.4466274678707123
loss_pred:0.0157314445823431, decouple_loss:0.00041063822573050857
loss_pred:0.015735572203993797, decouple_loss:0.00047888318658806384
The modified gen p mean: 0.4465215802192688, gen p mean: -0.11828345060348511, mean p set: 0.44709834456443787
loss_pred:0.015511342324316502, decouple_loss:0.00048517013783566654
Iteration: 2166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683408737182617, gen p mean: -0.12016108632087708, mean p set: 0.44740915298461914
loss_pred:0.015857744961977005, decouple_loss:0.0005108319455757737
The modified gen p mean: 0.4492110013961792, gen p mean: -0.1137554794549942, mean p set: 0.449787974357605
loss_pred:0.015233663842082024, decouple_loss:0.0004906420945189893
The modified gen p mean: 0.4477461576461792, gen p mean: -0.11192019283771515, mean p set: 0.4483223557472229
loss_pred:0.015015675686299801, decouple_loss:0.00043313996866345406
Iteration: 2167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900140166282654, gen p mean: -0.13030391931533813, mean p set: 0.44957879185676575
loss_pred:0.014708131551742554, decouple_loss:0.0004989731241948903
The modified gen p mean: 0.44718214869499207, gen p mean: -0.12960927188396454, mean p set: 0.44775891304016113
The modified gen p mean: 0.4476848840713501, gen p mean: -0.12742415070533752, mean p set: 0.44826194643974304
loss_pred:0.0157958772033453, decouple_loss:0.00040113466093316674
loss_pred:0.015467964112758636, decouple_loss:0.0004547035205177963
Iteration: 2168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483007490634918, gen p mean: -0.12274905294179916, mean p set: 0.44887441396713257
loss_pred:0.01535202469676733, decouple_loss:0.0005260686739347875
The modified gen p mean: 0.4479229152202606, gen p mean: -0.12552262842655182, mean p set: 0.4484986364841461
The modified gen p mean: 0.4467352330684662, gen p mean: -0.12265543639659882, mean p set: 0.4473150670528412
loss_pred:0.01564793288707733, decouple_loss:0.0003677158965729177
loss_pred:0.016251035034656525, decouple_loss:0.0005723759531974792
Iteration: 2169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472641050815582, gen p mean: -0.13450714945793152, mean p set: 0.44784191250801086
loss_pred:0.01553951296955347, decouple_loss:0.00043697963701561093
The modified gen p mean: 0.44698411226272583, gen p mean: -0.13625192642211914, mean p set: 0.447562575340271
The modified gen p mean: 0.4493354558944702, gen p mean: -0.13191251456737518, mean p set: 0.4499136209487915
loss_pred:0.015990233048796654, decouple_loss:0.00035613353247754276
loss_pred:0.01576169580221176, decouple_loss:0.0004018947947770357
Iteration: 2170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793370366096497, gen p mean: -0.11708787083625793, mean p set: 0.4485120475292206
The modified gen p mean: 0.447700560092926, gen p mean: -0.11723476648330688, mean p set: 0.44827497005462646loss_pred:0.016460824757814407, decouple_loss:0.00037460337625816464
loss_pred:0.014961999841034412, decouple_loss:0.00042001286055892706
The modified gen p mean: 0.4467908442020416, gen p mean: -0.11920949071645737, mean p set: 0.44736772775650024
loss_pred:0.015423787757754326, decouple_loss:0.0005181027809157968
2023-05-02 11:34:29 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1282779723405838, mean p set: 0.4502691626548767
loss_pred:0.017093753442168236, decouple_loss:0.0005300097982399166
The modified gen p mean: 0.44953304529190063, gen p mean: -0.12151552736759186, mean p set: 0.4500633478164673
loss_pred:0.016513338312506676, decouple_loss:0.0004936906625516713
The modified gen p mean: 0.4498252272605896, gen p mean: -0.12074374407529831, mean p set: 0.45035696029663086
loss_pred:0.016780564561486244, decouple_loss:0.00045549453352577984
WV_1_PC_1_EH_0_PS_40, loss: 0.01682053878903389, avg_mse: 0.026331912726163864
current test mse: 0.026332
Iteration: 2171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479367434978485, gen p mean: -0.12005030363798141, mean p set: 0.44851356744766235
loss_pred:0.01556667871773243, decouple_loss:0.00043083314085379243
The modified gen p mean: 0.44744205474853516, gen p mean: -0.11865758150815964, mean p set: 0.44801437854766846
loss_pred:0.01536945067346096, decouple_loss:0.0005007016588933766
The modified gen p mean: 0.447724848985672, gen p mean: -0.12356331944465637, mean p set: 0.4482978880405426
loss_pred:0.015596587210893631, decouple_loss:0.0004842718772124499
Iteration: 2172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44606050848960876, gen p mean: -0.13152283430099487, mean p set: 0.4466356933116913The modified gen p mean: 0.44822725653648376, gen p mean: -0.12738800048828125, mean p set: 0.4488007128238678
loss_pred:0.015490038320422173, decouple_loss:0.0004378088633529842
loss_pred:0.01531870849430561, decouple_loss:0.00044410262489691377
The modified gen p mean: 0.44757792353630066, gen p mean: -0.13047438859939575, mean p set: 0.4481530487537384
loss_pred:0.015095571987330914, decouple_loss:0.0004587243020068854
Iteration: 2173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468833804130554, gen p mean: -0.13122299313545227, mean p set: 0.4474617540836334
loss_pred:0.015737973153591156, decouple_loss:0.00044361353502608836
The modified gen p mean: 0.44688501954078674, gen p mean: -0.134073868393898, mean p set: 0.44745954871177673
loss_pred:0.015789024531841278, decouple_loss:0.0004759996954817325
The modified gen p mean: 0.4492930471897125, gen p mean: -0.12788057327270508, mean p set: 0.449869304895401
loss_pred:0.015578774735331535, decouple_loss:0.0004475356254260987
Iteration: 2174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484238028526306, gen p mean: -0.1332525759935379, mean p set: 0.44900041818618774
loss_pred:0.015182862058281898, decouple_loss:0.0005511625204235315
The modified gen p mean: 0.4472978413105011, gen p mean: -0.13492511212825775, mean p set: 0.4478735327720642
loss_pred:0.01568332500755787, decouple_loss:0.0004667121102102101
The modified gen p mean: 0.44973257184028625, gen p mean: -0.12990103662014008, mean p set: 0.45031026005744934
loss_pred:0.015457728877663612, decouple_loss:0.0004574031045194715
Iteration: 2175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44704389572143555, gen p mean: -0.13388359546661377, mean p set: 0.44761988520622253
loss_pred:0.016079572960734367, decouple_loss:0.00044328931835480034
The modified gen p mean: 0.4460606276988983, gen p mean: -0.1332210898399353, mean p set: 0.4466353952884674
loss_pred:0.015822406858205795, decouple_loss:0.0003639120259322226
The modified gen p mean: 0.44718989729881287, gen p mean: -0.12517660856246948, mean p set: 0.4477689266204834
loss_pred:0.016081493347883224, decouple_loss:0.00043641633237712085
Iteration: 2176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463304877281189, gen p mean: -0.1294291913509369, mean p set: 0.4469049572944641
loss_pred:0.016508392989635468, decouple_loss:0.0004088710411451757
The modified gen p mean: 0.4473194181919098, gen p mean: -0.12447444349527359, mean p set: 0.44789430499076843
loss_pred:0.016172396019101143, decouple_loss:0.00043713810737244785
The modified gen p mean: 0.4467020332813263, gen p mean: -0.1299598067998886, mean p set: 0.44727712869644165
loss_pred:0.01581084541976452, decouple_loss:0.00036999682197347283
Iteration: 2177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475081264972687, gen p mean: -0.11845336854457855, mean p set: 0.44808489084243774
loss_pred:0.015618625096976757, decouple_loss:0.0004107757704332471
The modified gen p mean: 0.44811388850212097, gen p mean: -0.11800138652324677, mean p set: 0.44869065284729004
The modified gen p mean: 0.4475102424621582, gen p mean: -0.11745598912239075, mean p set: 0.448087215423584
loss_pred:0.01574193686246872, decouple_loss:0.00044508898281492293
loss_pred:0.01554621011018753, decouple_loss:0.0004637672391254455
Iteration: 2178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475174844264984, gen p mean: -0.11428684741258621, mean p set: 0.4480946362018585
loss_pred:0.015609007328748703, decouple_loss:0.00035806934465654194
The modified gen p mean: 0.4472304582595825, gen p mean: -0.11129753291606903, mean p set: 0.44780421257019043
loss_pred:0.015100181102752686, decouple_loss:0.0003831311478279531
The modified gen p mean: 0.44549089670181274, gen p mean: -0.11663275957107544, mean p set: 0.44606801867485046
loss_pred:0.015835026279091835, decouple_loss:0.0005607895436696708
Iteration: 2179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740307331085205, gen p mean: -0.11952449381351471, mean p set: 0.4479758143424988
loss_pred:0.01492423564195633, decouple_loss:0.0003955113352276385
The modified gen p mean: 0.44707441329956055, gen p mean: -0.12127446383237839, mean p set: 0.447646826505661
The modified gen p mean: 0.44599342346191406, gen p mean: -0.1226717084646225, mean p set: 0.44656795263290405
loss_pred:0.015625502914190292, decouple_loss:0.0004686932370532304
loss_pred:0.015960101038217545, decouple_loss:0.0005136759136803448
Iteration: 2180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860953092575073, gen p mean: -0.12590129673480988, mean p set: 0.449184387922287
loss_pred:0.01520874910056591, decouple_loss:0.0005151346558704972
The modified gen p mean: 0.4484522044658661, gen p mean: -0.11925714462995529, mean p set: 0.44902777671813965
loss_pred:0.01537962257862091, decouple_loss:0.00041107682045549154
The modified gen p mean: 0.44826850295066833, gen p mean: -0.1259198784828186, mean p set: 0.4488462209701538
loss_pred:0.015589507296681404, decouple_loss:0.0004362595791462809
2023-05-02 11:36:35 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.1320340931415558, mean p set: 0.4502691626548767
loss_pred:0.017357483506202698, decouple_loss:0.0004864692746195942
The modified gen p mean: 0.4495362341403961, gen p mean: -0.12585245072841644, mean p set: 0.4500633478164673
loss_pred:0.016763608902692795, decouple_loss:0.00048209476517513394
The modified gen p mean: 0.4498277008533478, gen p mean: -0.1253553032875061, mean p set: 0.45035696029663086
loss_pred:0.017160452902317047, decouple_loss:0.00047547026770189404
WV_1_PC_1_EH_0_PS_40, loss: 0.01711791567504406, avg_mse: 0.026550080627202988
current test mse: 0.02655
Iteration: 2181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473392069339752, gen p mean: -0.1265878975391388, mean p set: 0.4479130506515503
loss_pred:0.015376390889286995, decouple_loss:0.00038787658559158444
The modified gen p mean: 0.4453926682472229, gen p mean: -0.13184842467308044, mean p set: 0.445966511964798
loss_pred:0.015859004110097885, decouple_loss:0.0004312302335165441
The modified gen p mean: 0.4471028745174408, gen p mean: -0.12967287003993988, mean p set: 0.44767752289772034
loss_pred:0.015543557703495026, decouple_loss:0.0004167165025137365
Iteration: 2182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702810049057007, gen p mean: -0.13347533345222473, mean p set: 0.4476076066493988
loss_pred:0.015499458648264408, decouple_loss:0.00036506869946606457
The modified gen p mean: 0.4487001895904541, gen p mean: -0.1291874796152115, mean p set: 0.4492754638195038The modified gen p mean: 0.44821441173553467, gen p mean: -0.12691543996334076, mean p set: 0.4487912356853485
loss_pred:0.01547908503562212, decouple_loss:0.0004822782357223332
loss_pred:0.01581380143761635, decouple_loss:0.00039696518797427416
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764256477355957, gen p mean: -0.13369542360305786, mean p set: 0.44821611046791077
The modified gen p mean: 0.44851794838905334, gen p mean: -0.13147592544555664, mean p set: 0.44909462332725525
loss_pred:0.015889940783381462, decouple_loss:0.0004874608130194247
loss_pred:0.015184682793915272, decouple_loss:0.0005097889807075262
The modified gen p mean: 0.4484165906906128, gen p mean: -0.13235776126384735, mean p set: 0.4489942789077759
loss_pred:0.015407721512019634, decouple_loss:0.0004291853401809931
Iteration: 2184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471825957298279, gen p mean: -0.13259708881378174, mean p set: 0.44775715470314026
loss_pred:0.015585219487547874, decouple_loss:0.00042891857447102666
The modified gen p mean: 0.4461401104927063, gen p mean: -0.1354197859764099, mean p set: 0.44671642780303955
loss_pred:0.015664996579289436, decouple_loss:0.0004294823156669736
The modified gen p mean: 0.4467104375362396, gen p mean: -0.13278499245643616, mean p set: 0.4472885727882385
loss_pred:0.016244329512119293, decouple_loss:0.00041073726606555283
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
NaN value num: 0
Iteration: 2185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511357545852661, gen p mean: -0.12328384071588516, mean p set: 0.45171278715133667
loss_pred:0.016257360577583313, decouple_loss:0.000510029261931777
The modified gen p mean: 0.44978490471839905, gen p mean: -0.12119294703006744, mean p set: 0.4503606855869293
loss_pred:0.016702746972441673, decouple_loss:0.0005099953850731254
The modified gen p mean: 0.44998055696487427, gen p mean: -0.13158993422985077, mean p set: 0.4505594074726105
loss_pred:0.015732061117887497, decouple_loss:0.0004230264457874
Iteration: 2186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507274031639099, gen p mean: -0.11975390464067459, mean p set: 0.4513033628463745
loss_pred:0.015595155768096447, decouple_loss:0.0004237724933773279
The modified gen p mean: 0.45338407158851624, gen p mean: -0.12272023409605026, mean p set: 0.4539635181427002
loss_pred:0.015810592100024223, decouple_loss:0.0005364298704080284
The modified gen p mean: 0.45071539282798767, gen p mean: -0.12185078114271164, mean p set: 0.45129111409187317
loss_pred:0.016479574143886566, decouple_loss:0.0005616485141217709
Iteration: 2187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45056188106536865, gen p mean: -0.12399718910455704, mean p set: 0.45113492012023926
loss_pred:0.01618395559489727, decouple_loss:0.0005604918696917593
The modified gen p mean: 0.4502685070037842, gen p mean: -0.11617878079414368, mean p set: 0.45084720849990845
loss_pred:0.016015328466892242, decouple_loss:0.0004984319675713778
The modified gen p mean: 0.45338472723960876, gen p mean: -0.11951465159654617, mean p set: 0.4539616107940674
loss_pred:0.01615743897855282, decouple_loss:0.0005382125964388251
Iteration: 2188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45506519079208374, gen p mean: -0.12194300442934036, mean p set: 0.45564278960227966
loss_pred:0.015300708822906017, decouple_loss:0.0005894216592423618
The modified gen p mean: 0.4516102969646454, gen p mean: -0.11461815237998962, mean p set: 0.4521867632865906
loss_pred:0.015012279152870178, decouple_loss:0.0004806959186680615
The modified gen p mean: 0.450386643409729, gen p mean: -0.11836106330156326, mean p set: 0.45096486806869507
loss_pred:0.016854673624038696, decouple_loss:0.0005626472411677241
Iteration: 2189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44984346628189087, gen p mean: -0.11289701610803604, mean p set: 0.450419545173645
loss_pred:0.016690026968717575, decouple_loss:0.00042741201468743384
The modified gen p mean: 0.4514746069908142, gen p mean: -0.11601851135492325, mean p set: 0.4520516097545624
The modified gen p mean: 0.4494795799255371, gen p mean: -0.11929547041654587, mean p set: 0.45005589723587036
loss_pred:0.015074857510626316, decouple_loss:0.00037890116800554097
loss_pred:0.015895409509539604, decouple_loss:0.00048549938946962357
Iteration: 2190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501190483570099, gen p mean: -0.12169141322374344, mean p set: 0.4506944417953491
loss_pred:0.015603250823915005, decouple_loss:0.0003911556559614837
The modified gen p mean: 0.4518740773200989, gen p mean: -0.11501726508140564, mean p set: 0.45245081186294556
loss_pred:0.015660880133509636, decouple_loss:0.0004401618498377502
The modified gen p mean: 0.4544759690761566, gen p mean: -0.11795124411582947, mean p set: 0.4550555646419525
loss_pred:0.014794268645346165, decouple_loss:0.0005827126442454755
2023-05-02 11:39:27 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1308036893606186, mean p set: 0.4502691626548767
loss_pred:0.017109505832195282, decouple_loss:0.000516076514031738
The modified gen p mean: 0.44953539967536926, gen p mean: -0.12436099350452423, mean p set: 0.4500633478164673
loss_pred:0.016335787251591682, decouple_loss:0.00044002188951708376
The modified gen p mean: 0.449831485748291, gen p mean: -0.12399104982614517, mean p set: 0.45035696029663086
loss_pred:0.016760539263486862, decouple_loss:0.0004994039773009717
WV_1_PC_1_EH_0_PS_40, loss: 0.016759535297751427, avg_mse: 0.026066184043884277
current test mse: 0.026066
Iteration: 2191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499993622303009, gen p mean: -0.1269383579492569, mean p set: 0.450576514005661
loss_pred:0.014992298558354378, decouple_loss:0.00044709700159728527
The modified gen p mean: 0.45179030299186707, gen p mean: -0.1225535199046135, mean p set: 0.4523661732673645
loss_pred:0.015818435698747635, decouple_loss:0.00047174529754556715
The modified gen p mean: 0.4495142996311188, gen p mean: -0.12743176519870758, mean p set: 0.4500890374183655
loss_pred:0.016357973217964172, decouple_loss:0.0005206269561313093
Iteration: 2192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522932767868042, gen p mean: -0.12513497471809387, mean p set: 0.4528714418411255
loss_pred:0.015248473733663559, decouple_loss:0.00044843886280432343
The modified gen p mean: 0.4529232084751129, gen p mean: -0.12699337303638458, mean p set: 0.4534992575645447The modified gen p mean: 0.45208653807640076, gen p mean: -0.13001921772956848, mean p set: 0.45266276597976685
loss_pred:0.015702515840530396, decouple_loss:0.0004826354270335287
loss_pred:0.015400988981127739, decouple_loss:0.00047425812226720154
Iteration: 2193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45122531056404114, gen p mean: -0.12982802093029022, mean p set: 0.4517989158630371
loss_pred:0.015563887543976307, decouple_loss:0.000488883291836828
The modified gen p mean: 0.45136910676956177, gen p mean: -0.13186444342136383, mean p set: 0.45194417238235474
loss_pred:0.0155649958178401, decouple_loss:0.0004325459012761712
The modified gen p mean: 0.45021867752075195, gen p mean: -0.13692791759967804, mean p set: 0.45079267024993896
loss_pred:0.015314195305109024, decouple_loss:0.0004501792718656361
Iteration: 2194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45139726996421814, gen p mean: -0.13245923817157745, mean p set: 0.45197439193725586
loss_pred:0.015602268278598785, decouple_loss:0.0005324684898369014
The modified gen p mean: 0.4510912597179413, gen p mean: -0.1291283369064331, mean p set: 0.4516713619232178
loss_pred:0.015396181493997574, decouple_loss:0.0004577682993840426
The modified gen p mean: 0.451692134141922, gen p mean: -0.13192535936832428, mean p set: 0.452269583940506
loss_pred:0.015617766417562962, decouple_loss:0.0005558875855058432
Iteration: 2195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45275750756263733, gen p mean: -0.1328638792037964, mean p set: 0.45333370566368103
loss_pred:0.0154613321647048, decouple_loss:0.0004936199984513223
The modified gen p mean: 0.45037269592285156, gen p mean: -0.12747062742710114, mean p set: 0.45095011591911316
loss_pred:0.015168077312409878, decouple_loss:0.00045917610987089574
The modified gen p mean: 0.4496077299118042, gen p mean: -0.13167349994182587, mean p set: 0.4501844644546509
loss_pred:0.015792211517691612, decouple_loss:0.0005500148981809616
Iteration: 2196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504348933696747, gen p mean: -0.1311182677745819, mean p set: 0.45101335644721985
loss_pred:0.015848981216549873, decouple_loss:0.0004417698073666543
The modified gen p mean: 0.45167291164398193, gen p mean: -0.13355955481529236, mean p set: 0.45224812626838684
The modified gen p mean: 0.44938749074935913, gen p mean: -0.1334819793701172, mean p set: 0.44996097683906555
loss_pred:0.01451641321182251, decouple_loss:0.00042921153362840414
loss_pred:0.015249120071530342, decouple_loss:0.0004399377794470638
Iteration: 2197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449298232793808, gen p mean: -0.13314767181873322, mean p set: 0.44987502694129944
loss_pred:0.01573304831981659, decouple_loss:0.0004693796799983829
The modified gen p mean: 0.4511511027812958, gen p mean: -0.12680171430110931, mean p set: 0.4517273008823395
The modified gen p mean: 0.4515360891819, gen p mean: -0.12260250747203827, mean p set: 0.4521104097366333
loss_pred:0.015436949208378792, decouple_loss:0.0006128700915724039
loss_pred:0.014787090942263603, decouple_loss:0.0005040925461798906
Iteration: 2198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4543837606906891, gen p mean: -0.12501230835914612, mean p set: 0.45496177673339844
loss_pred:0.015635503455996513, decouple_loss:0.0005395246553234756
The modified gen p mean: 0.4517093598842621, gen p mean: -0.12033458054065704, mean p set: 0.4522860050201416
loss_pred:0.015457440167665482, decouple_loss:0.00046431858208961785
The modified gen p mean: 0.45309972763061523, gen p mean: -0.12271107733249664, mean p set: 0.4536796808242798
loss_pred:0.01603439822793007, decouple_loss:0.0004554394690785557
Iteration: 2199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44932591915130615, gen p mean: -0.1216386929154396, mean p set: 0.44990074634552
loss_pred:0.015724338591098785, decouple_loss:0.0004847993841394782
The modified gen p mean: 0.44833293557167053, gen p mean: -0.12220680713653564, mean p set: 0.44890692830085754
The modified gen p mean: 0.45151400566101074, gen p mean: -0.12037190794944763, mean p set: 0.4520919919013977
loss_pred:0.016251828521490097, decouple_loss:0.0004921856452710927
loss_pred:0.015500599518418312, decouple_loss:0.0005857754149474204
Iteration: 2200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45092034339904785, gen p mean: -0.11323222517967224, mean p set: 0.45149728655815125
loss_pred:0.016690021380782127, decouple_loss:0.0005724222864955664
The modified gen p mean: 0.44998911023139954, gen p mean: -0.11047697067260742, mean p set: 0.45056599378585815
The modified gen p mean: 0.45115765929222107, gen p mean: -0.11542009562253952, mean p set: 0.45173338055610657
loss_pred:0.016212381422519684, decouple_loss:0.000572690274566412
loss_pred:0.01543204765766859, decouple_loss:0.0006008578347973526
2023-05-02 11:41:33 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12155503779649734, mean p set: 0.4502691626548767
loss_pred:0.01701434515416622, decouple_loss:0.0004930991563014686
The modified gen p mean: 0.4495355784893036, gen p mean: -0.11530742049217224, mean p set: 0.4500633478164673
loss_pred:0.01635775901377201, decouple_loss:0.00043231406016275287
The modified gen p mean: 0.4498275816440582, gen p mean: -0.11429417133331299, mean p set: 0.45035696029663086
loss_pred:0.016606945544481277, decouple_loss:0.0003945976495742798
WV_1_PC_1_EH_0_PS_40, loss: 0.01668168418109417, avg_mse: 0.025953764095902443
current test mse: 0.025954
Iteration: 2201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518694281578064, gen p mean: -0.11480455845594406, mean p set: 0.45244714617729187
loss_pred:0.01499076560139656, decouple_loss:0.0003692850295919925
The modified gen p mean: 0.45162349939346313, gen p mean: -0.11192488670349121, mean p set: 0.452201247215271
loss_pred:0.015775498002767563, decouple_loss:0.0005301397177390754
The modified gen p mean: 0.4502921998500824, gen p mean: -0.11155326664447784, mean p set: 0.45086869597435
loss_pred:0.016069771721959114, decouple_loss:0.00038588556344620883
Iteration: 2202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508822560310364, gen p mean: -0.11120174080133438, mean p set: 0.4514580965042114
loss_pred:0.015232354402542114, decouple_loss:0.0005162939196452498
The modified gen p mean: 0.4513811767101288, gen p mean: -0.11599009484052658, mean p set: 0.4519573748111725
The modified gen p mean: 0.4483698606491089, gen p mean: -0.11687740683555603, mean p set: 0.4489463269710541
loss_pred:0.014927650801837444, decouple_loss:0.00037549962871707976
loss_pred:0.015347802080214024, decouple_loss:0.0003995068254880607
Iteration: 2203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524240493774414, gen p mean: -0.12398745119571686, mean p set: 0.45299920439720154
loss_pred:0.015269703231751919, decouple_loss:0.0003666271222755313
The modified gen p mean: 0.45121726393699646, gen p mean: -0.11764142662286758, mean p set: 0.45179659128189087The modified gen p mean: 0.44992193579673767, gen p mean: -0.12367995083332062, mean p set: 0.45049911737442017
loss_pred:0.015418274328112602, decouple_loss:0.0005864968406967819
loss_pred:0.015399819239974022, decouple_loss:0.0003983448841609061
Iteration: 2204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45163753628730774, gen p mean: -0.12370944023132324, mean p set: 0.45221641659736633
loss_pred:0.01521106157451868, decouple_loss:0.00036655852454714477
The modified gen p mean: 0.4500066936016083, gen p mean: -0.11839962750673294, mean p set: 0.4505843222141266
loss_pred:0.01626279391348362, decouple_loss:0.0005088777397759259
The modified gen p mean: 0.45173022150993347, gen p mean: -0.12477412074804306, mean p set: 0.45230618119239807
loss_pred:0.01615743339061737, decouple_loss:0.0003272824687883258
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
NaN value num: 0
Iteration: 2205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501402676105499, gen p mean: -0.12787413597106934, mean p set: 0.4507170021533966
The modified gen p mean: 0.44997045397758484, gen p mean: -0.1180320754647255, mean p set: 0.45054522156715393
loss_pred:0.015057540498673916, decouple_loss:0.0005158705171197653
loss_pred:0.015981482341885567, decouple_loss:0.0005735903978347778
The modified gen p mean: 0.44870734214782715, gen p mean: -0.12208644300699234, mean p set: 0.4492831230163574
loss_pred:0.015043159946799278, decouple_loss:0.00042259905603714287
Iteration: 2206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450439453125, gen p mean: -0.11900780349969864, mean p set: 0.45101693272590637
loss_pred:0.014876408502459526, decouple_loss:0.0006064383196644485
The modified gen p mean: 0.4500269293785095, gen p mean: -0.11974232643842697, mean p set: 0.4506039321422577
loss_pred:0.015009344555437565, decouple_loss:0.00043105855002067983
The modified gen p mean: 0.451130747795105, gen p mean: -0.12401770800352097, mean p set: 0.4517087936401367
loss_pred:0.015409991145133972, decouple_loss:0.00043381756404414773
Iteration: 2207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481077790260315, gen p mean: -0.12095365673303604, mean p set: 0.44868484139442444
loss_pred:0.014546333812177181, decouple_loss:0.000347054359735921
The modified gen p mean: 0.4489828050136566, gen p mean: -0.11344820261001587, mean p set: 0.4495590925216675
loss_pred:0.015168385580182076, decouple_loss:0.00036295762402005494
The modified gen p mean: 0.44814035296440125, gen p mean: -0.11924786120653152, mean p set: 0.44871723651885986
loss_pred:0.014941645786166191, decouple_loss:0.00039046118035912514
Iteration: 2208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024076104164124, gen p mean: -0.11569299548864365, mean p set: 0.450818806886673
loss_pred:0.015326365828514099, decouple_loss:0.00045106542529538274
The modified gen p mean: 0.44759055972099304, gen p mean: -0.11086112260818481, mean p set: 0.44816699624061584
loss_pred:0.014950338751077652, decouple_loss:0.0005770556745119393
The modified gen p mean: 0.4502878189086914, gen p mean: -0.10912267118692398, mean p set: 0.45086413621902466
loss_pred:0.014427240937948227, decouple_loss:0.000381893856683746
Iteration: 2209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758251309394836, gen p mean: -0.11319927126169205, mean p set: 0.44815847277641296
loss_pred:0.014570699073374271, decouple_loss:0.0004096433985978365
The modified gen p mean: 0.44912317395210266, gen p mean: -0.1096314936876297, mean p set: 0.4497006833553314
loss_pred:0.015583109110593796, decouple_loss:0.0004982227692380548
The modified gen p mean: 0.4500874876976013, gen p mean: -0.10863516479730606, mean p set: 0.45066389441490173
loss_pred:0.015198273584246635, decouple_loss:0.0004582966212183237
Iteration: 2210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449194997549057, gen p mean: -0.11127185821533203, mean p set: 0.4497711658477783
loss_pred:0.015415594913065434, decouple_loss:0.00039834773633629084
The modified gen p mean: 0.44799095392227173, gen p mean: -0.11694544553756714, mean p set: 0.4485662281513214
loss_pred:0.014592676423490047, decouple_loss:0.0003471620148047805
The modified gen p mean: 0.44982877373695374, gen p mean: -0.11552328616380692, mean p set: 0.4504070580005646
loss_pred:0.015051078051328659, decouple_loss:0.00042700342601165175
2023-05-02 11:44:16 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12875013053417206, mean p set: 0.4502691626548767
loss_pred:0.01695721037685871, decouple_loss:0.0004047873371746391
The modified gen p mean: 0.4495335519313812, gen p mean: -0.12226042151451111, mean p set: 0.4500633478164673
The modified gen p mean: 0.4498260021209717, gen p mean: -0.12124266475439072, mean p set: 0.45035696029663086
loss_pred:0.016403082758188248, decouple_loss:0.0003924042684957385
loss_pred:0.01671585440635681, decouple_loss:0.0003744310524780303
WV_1_PC_1_EH_0_PS_40, loss: 0.016711577773094177, avg_mse: 0.026011839509010315
current test mse: 0.026012
Iteration: 2211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504290223121643, gen p mean: -0.11605211347341537, mean p set: 0.45100489258766174
loss_pred:0.014488759450614452, decouple_loss:0.00040239698137156665
The modified gen p mean: 0.4485398828983307, gen p mean: -0.11482330411672592, mean p set: 0.44911646842956543The modified gen p mean: 0.4502291679382324, gen p mean: -0.11817608028650284, mean p set: 0.45080679655075073
loss_pred:0.014771193265914917, decouple_loss:0.00032516694045625627
loss_pred:0.015017807483673096, decouple_loss:0.0003422674199100584
Iteration: 2212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44991546869277954, gen p mean: -0.11570142954587936, mean p set: 0.45049232244491577
The modified gen p mean: 0.44947531819343567, gen p mean: -0.11932767182588577, mean p set: 0.4500511884689331
loss_pred:0.014227863401174545, decouple_loss:0.0005568779888562858
loss_pred:0.014625279232859612, decouple_loss:0.00043268618173897266
The modified gen p mean: 0.4474189579486847, gen p mean: -0.11752883344888687, mean p set: 0.44799432158470154
loss_pred:0.014366901479661465, decouple_loss:0.00037533100112341344
Iteration: 2213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496510624885559, gen p mean: -0.11427578330039978, mean p set: 0.4502274990081787
loss_pred:0.01410292275249958, decouple_loss:0.0004540104710031301
The modified gen p mean: 0.4495079815387726, gen p mean: -0.11745573580265045, mean p set: 0.45008742809295654
loss_pred:0.014673597179353237, decouple_loss:0.0004459672491066158
The modified gen p mean: 0.4495992660522461, gen p mean: -0.1126529648900032, mean p set: 0.45017489790916443
loss_pred:0.01468578353524208, decouple_loss:0.00035518326330929995
Iteration: 2214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44964364171028137, gen p mean: -0.10742823034524918, mean p set: 0.4502197206020355
loss_pred:0.015280736610293388, decouple_loss:0.00039523697341792285
The modified gen p mean: 0.4478038549423218, gen p mean: -0.11320198327302933, mean p set: 0.448382169008255
loss_pred:0.015002560801804066, decouple_loss:0.000466370111098513
The modified gen p mean: 0.44732367992401123, gen p mean: -0.11836487799882889, mean p set: 0.44790026545524597
loss_pred:0.015491384081542492, decouple_loss:0.00038659287383779883
Iteration: 2215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509117007255554, gen p mean: -0.1139940395951271, mean p set: 0.45148739218711853
loss_pred:0.014916491694748402, decouple_loss:0.0005303719663061202
The modified gen p mean: 0.4500860869884491, gen p mean: -0.1096290573477745, mean p set: 0.4506619870662689
loss_pred:0.014671680517494678, decouple_loss:0.0006816170061938465
The modified gen p mean: 0.4478395879268646, gen p mean: -0.11169339716434479, mean p set: 0.4484158456325531
loss_pred:0.014618315733969212, decouple_loss:0.0004038802580907941
Iteration: 2216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012083649635315, gen p mean: -0.10707911849021912, mean p set: 0.45069950819015503
loss_pred:0.014250986278057098, decouple_loss:0.0004507636767812073
The modified gen p mean: 0.4474198520183563, gen p mean: -0.11405935138463974, mean p set: 0.44799768924713135
loss_pred:0.014985445886850357, decouple_loss:0.00031712997588329017
The modified gen p mean: 0.4501410722732544, gen p mean: -0.10312257707118988, mean p set: 0.450714111328125
loss_pred:0.014117291197180748, decouple_loss:0.00043210311559960246
Iteration: 2217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45011410117149353, gen p mean: -0.10713451355695724, mean p set: 0.45069149136543274
loss_pred:0.01480874139815569, decouple_loss:0.00046725530410185456
The modified gen p mean: 0.45024824142456055, gen p mean: -0.10870295017957687, mean p set: 0.4508250057697296
The modified gen p mean: 0.4501930773258209, gen p mean: -0.10492789000272751, mean p set: 0.4507685601711273
loss_pred:0.014988665468990803, decouple_loss:0.0005073893698863685
loss_pred:0.014411256648600101, decouple_loss:0.0004544317489489913
Iteration: 2218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478691518306732, gen p mean: -0.10552309453487396, mean p set: 0.4484463632106781
loss_pred:0.014161902479827404, decouple_loss:0.0003680309164337814
The modified gen p mean: 0.44792062044143677, gen p mean: -0.09997349232435226, mean p set: 0.4484984576702118
The modified gen p mean: 0.45080962777137756, gen p mean: -0.10169088840484619, mean p set: 0.4513837993144989
loss_pred:0.014518320560455322, decouple_loss:0.00038070190930739045
loss_pred:0.014212241396307945, decouple_loss:0.0004728581407107413
Iteration: 2219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475547671318054, gen p mean: -0.10972820967435837, mean p set: 0.4481312930583954
loss_pred:0.014569095335900784, decouple_loss:0.00032956982613541186
The modified gen p mean: 0.447695791721344, gen p mean: -0.10278908163309097, mean p set: 0.44827190041542053
The modified gen p mean: 0.44747334718704224, gen p mean: -0.10695873200893402, mean p set: 0.4480490982532501
loss_pred:0.01421276293694973, decouple_loss:0.0003125897783320397
loss_pred:0.014877662062644958, decouple_loss:0.000427224556915462
Iteration: 2220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472281038761139, gen p mean: -0.10627486556768417, mean p set: 0.44780364632606506
loss_pred:0.014885781332850456, decouple_loss:0.0004206006706226617
The modified gen p mean: 0.44963473081588745, gen p mean: -0.10255441069602966, mean p set: 0.45021358132362366
The modified gen p mean: 0.44741353392601013, gen p mean: -0.10101586580276489, mean p set: 0.4479900598526001
loss_pred:0.014025213196873665, decouple_loss:0.0005534584634006023
loss_pred:0.015407664701342583, decouple_loss:0.000494501378852874
2023-05-02 11:46:22 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11253351718187332, mean p set: 0.4502691626548767
loss_pred:0.01692834682762623, decouple_loss:0.000492074410431087
The modified gen p mean: 0.44953426718711853, gen p mean: -0.10650612413883209, mean p set: 0.4500633478164673
loss_pred:0.01634041965007782, decouple_loss:0.0005041054100729525
The modified gen p mean: 0.44982975721359253, gen p mean: -0.10566440969705582, mean p set: 0.45035696029663086
loss_pred:0.016600733622908592, decouple_loss:0.0005197984864935279
WV_1_PC_1_EH_0_PS_40, loss: 0.016648434102535248, avg_mse: 0.02593955211341381
current test mse: 0.02594
Iteration: 2221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495950937271118, gen p mean: -0.09783631563186646, mean p set: 0.4501708745956421
loss_pred:0.014658208005130291, decouple_loss:0.0005072365165688097
The modified gen p mean: 0.4481147527694702, gen p mean: -0.10524865984916687, mean p set: 0.4486904740333557The modified gen p mean: 0.4474944770336151, gen p mean: -0.10739820450544357, mean p set: 0.4480723738670349
loss_pred:0.014094359241425991, decouple_loss:0.0003769760951399803
loss_pred:0.014652960933744907, decouple_loss:0.00036755381734110415
Iteration: 2222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479677379131317, gen p mean: -0.10083770751953125, mean p set: 0.4485446512699127
The modified gen p mean: 0.4487285912036896, gen p mean: -0.0989975556731224, mean p set: 0.44930723309516907
loss_pred:0.014274745248258114, decouple_loss:0.0003840469289571047
loss_pred:0.014518169686198235, decouple_loss:0.00036297645419836044
The modified gen p mean: 0.44928380846977234, gen p mean: -0.09928121417760849, mean p set: 0.4498618245124817
loss_pred:0.014461004175245762, decouple_loss:0.0003567013773135841
Iteration: 2223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044323801994324, gen p mean: -0.09746818244457245, mean p set: 0.451019287109375
loss_pred:0.014089814387261868, decouple_loss:0.0005278915050439537
The modified gen p mean: 0.448271244764328, gen p mean: -0.10217475891113281, mean p set: 0.44884851574897766
loss_pred:0.01490002404898405, decouple_loss:0.0004981531528756022
The modified gen p mean: 0.4490659534931183, gen p mean: -0.10232281684875488, mean p set: 0.4496413767337799
loss_pred:0.014499682001769543, decouple_loss:0.0004096246266271919
Iteration: 2224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495401978492737, gen p mean: -0.10036326944828033, mean p set: 0.45011407136917114
The modified gen p mean: 0.4472409188747406, gen p mean: -0.09830475598573685, mean p set: 0.44781580567359924
loss_pred:0.01488318108022213, decouple_loss:0.00035072650643996894
loss_pred:0.014679895713925362, decouple_loss:0.000445152836618945
The modified gen p mean: 0.4477390944957733, gen p mean: -0.09858793765306473, mean p set: 0.44831526279449463
loss_pred:0.01487074512988329, decouple_loss:0.0003825974417850375
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
NaN value num: 0
Iteration: 2225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44999179244041443, gen p mean: -0.107874795794487, mean p set: 0.4505697786808014
The modified gen p mean: 0.4510408043861389, gen p mean: -0.10309571027755737, mean p set: 0.45161738991737366
loss_pred:0.01779070682823658, decouple_loss:0.0004920933861285448
loss_pred:0.01570226065814495, decouple_loss:0.0004947849665768445
The modified gen p mean: 0.4502176344394684, gen p mean: -0.10538972169160843, mean p set: 0.4507925808429718
loss_pred:0.016611643135547638, decouple_loss:0.0004237049142830074
Iteration: 2226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45119062066078186, gen p mean: -0.09844345599412918, mean p set: 0.45176616311073303
loss_pred:0.016550101339817047, decouple_loss:0.00046962490887381136
The modified gen p mean: 0.4507790803909302, gen p mean: -0.10061024129390717, mean p set: 0.45135459303855896
loss_pred:0.015434211120009422, decouple_loss:0.00043960390030406415
The modified gen p mean: 0.45207616686820984, gen p mean: -0.10334515571594238, mean p set: 0.45265302062034607
loss_pred:0.015431877225637436, decouple_loss:0.0006886107148602605
Iteration: 2227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869911670684814, gen p mean: -0.10831686109304428, mean p set: 0.44927823543548584
loss_pred:0.0163443461060524, decouple_loss:0.0003779063990805298
The modified gen p mean: 0.44970566034317017, gen p mean: -0.10979282855987549, mean p set: 0.450283020734787
loss_pred:0.015780754387378693, decouple_loss:0.00042935615056194365
The modified gen p mean: 0.4500536620616913, gen p mean: -0.10874784737825394, mean p set: 0.45063063502311707
loss_pred:0.016145717352628708, decouple_loss:0.0004475993919186294
Iteration: 2228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517211318016052, gen p mean: -0.107424795627594, mean p set: 0.45229944586753845
loss_pred:0.016406720504164696, decouple_loss:0.0004194610519334674
The modified gen p mean: 0.45039665699005127, gen p mean: -0.10774554312229156, mean p set: 0.4509739875793457
loss_pred:0.01588926836848259, decouple_loss:0.0003803493455052376
The modified gen p mean: 0.45024973154067993, gen p mean: -0.11034755408763885, mean p set: 0.4508259892463684
loss_pred:0.015808165073394775, decouple_loss:0.0003708926378749311
Iteration: 2229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509292244911194, gen p mean: -0.11284603923559189, mean p set: 0.45150595903396606
loss_pred:0.01638101413846016, decouple_loss:0.0004605993162840605
The modified gen p mean: 0.4497925043106079, gen p mean: -0.11635179072618484, mean p set: 0.4503689110279083
loss_pred:0.016106707975268364, decouple_loss:0.00037543268990702927
The modified gen p mean: 0.4507221281528473, gen p mean: -0.10225168615579605, mean p set: 0.4512987732887268
loss_pred:0.016143521293997765, decouple_loss:0.00036138322320766747
Iteration: 2230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508194029331207, gen p mean: -0.11029298603534698, mean p set: 0.45139649510383606
loss_pred:0.0165262371301651, decouple_loss:0.00043391744839027524
The modified gen p mean: 0.45025742053985596, gen p mean: -0.110137939453125, mean p set: 0.4508335292339325
loss_pred:0.01620078645646572, decouple_loss:0.0004070815339218825
The modified gen p mean: 0.45128005743026733, gen p mean: -0.10861267894506454, mean p set: 0.4518546462059021
loss_pred:0.016235485672950745, decouple_loss:0.0004330855153966695
2023-05-02 11:49:18 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12051423639059067, mean p set: 0.4502691626548767
loss_pred:0.016851108521223068, decouple_loss:0.00042353541357442737
The modified gen p mean: 0.4495331048965454, gen p mean: -0.11433467268943787, mean p set: 0.4500633478164673
loss_pred:0.01622714102268219, decouple_loss:0.000443093478679657
The modified gen p mean: 0.44982975721359253, gen p mean: -0.11369464546442032, mean p set: 0.45035696029663086
loss_pred:0.016527723520994186, decouple_loss:0.0003837746917270124
WV_1_PC_1_EH_0_PS_40, loss: 0.016556166112422943, avg_mse: 0.025779521092772484
current test mse: 0.02578
Iteration: 2231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45074695348739624, gen p mean: -0.10611700266599655, mean p set: 0.4513244926929474
loss_pred:0.017174404114484787, decouple_loss:0.0004059844941366464
The modified gen p mean: 0.44869256019592285, gen p mean: -0.1092040166258812, mean p set: 0.4492678940296173
loss_pred:0.016047390177845955, decouple_loss:0.0003648720739874989
The modified gen p mean: 0.45061030983924866, gen p mean: -0.11246614158153534, mean p set: 0.4511867165565491
loss_pred:0.01730247214436531, decouple_loss:0.0004395619034767151
Iteration: 2232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500240385532379, gen p mean: -0.10919153690338135, mean p set: 0.4505978226661682
The modified gen p mean: 0.4511696398258209, gen p mean: -0.11146427690982819, mean p set: 0.45174556970596313
loss_pred:0.016011301428079605, decouple_loss:0.00033976513077504933
The modified gen p mean: 0.45020991563796997, gen p mean: -0.11338099837303162, mean p set: 0.4507865309715271loss_pred:0.01648678071796894, decouple_loss:0.0003998138417955488
loss_pred:0.015585595741868019, decouple_loss:0.000464582844870165
Iteration: 2233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451508492231369, gen p mean: -0.11044805496931076, mean p set: 0.45208606123924255
loss_pred:0.015977254137396812, decouple_loss:0.0005064085707999766
The modified gen p mean: 0.45025843381881714, gen p mean: -0.1115492433309555, mean p set: 0.45083388686180115
loss_pred:0.01602456346154213, decouple_loss:0.0004640711413230747
The modified gen p mean: 0.4509544372558594, gen p mean: -0.11397866904735565, mean p set: 0.45152872800827026
loss_pred:0.01617998071014881, decouple_loss:0.00045313325244933367
Iteration: 2234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507828652858734, gen p mean: -0.11091876029968262, mean p set: 0.4513612687587738
The modified gen p mean: 0.44969284534454346, gen p mean: -0.11258021742105484, mean p set: 0.4502687156200409loss_pred:0.015827946364879608, decouple_loss:0.00039688340621069074
loss_pred:0.01600007712841034, decouple_loss:0.00042927238973788917
The modified gen p mean: 0.4507297873497009, gen p mean: -0.10951942950487137, mean p set: 0.4513053894042969
loss_pred:0.015449810773134232, decouple_loss:0.0003738765371963382
Iteration: 2235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500007927417755, gen p mean: -0.11133094877004623, mean p set: 0.4505743086338043
The modified gen p mean: 0.45083358883857727, gen p mean: -0.10692095756530762, mean p set: 0.45141053199768066
loss_pred:0.016733165830373764, decouple_loss:0.0004111482994630933
loss_pred:0.016265548765659332, decouple_loss:0.00042131374357268214
The modified gen p mean: 0.44990718364715576, gen p mean: -0.10786721855401993, mean p set: 0.45048442482948303
loss_pred:0.01624586619436741, decouple_loss:0.0004339296428952366
Iteration: 2236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516125023365021, gen p mean: -0.10768269002437592, mean p set: 0.45218974351882935
loss_pred:0.01654168777167797, decouple_loss:0.0004943973035551608
The modified gen p mean: 0.4514993131160736, gen p mean: -0.11076109856367111, mean p set: 0.4520775377750397
loss_pred:0.01575077697634697, decouple_loss:0.0004684468440245837
The modified gen p mean: 0.4505777359008789, gen p mean: -0.10615094006061554, mean p set: 0.4511536657810211
loss_pred:0.015853142365813255, decouple_loss:0.00037748084287159145
Iteration: 2237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503515064716339, gen p mean: -0.11433018743991852, mean p set: 0.4509296715259552
loss_pred:0.017542429268360138, decouple_loss:0.0005365944234654307
The modified gen p mean: 0.4508196711540222, gen p mean: -0.11310772597789764, mean p set: 0.45139533281326294
loss_pred:0.015502509661018848, decouple_loss:0.0003852460067719221
The modified gen p mean: 0.4524246156215668, gen p mean: -0.11410544067621231, mean p set: 0.45300063490867615
loss_pred:0.015519551001489162, decouple_loss:0.0003549714165274054
Iteration: 2238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45141521096229553, gen p mean: -0.11223267018795013, mean p set: 0.45199018716812134
loss_pred:0.016192035749554634, decouple_loss:0.0005269920220598578
The modified gen p mean: 0.4507680833339691, gen p mean: -0.11233553290367126, mean p set: 0.4513457417488098
loss_pred:0.01646883599460125, decouple_loss:0.00038900243816897273
The modified gen p mean: 0.4505797028541565, gen p mean: -0.12182455509901047, mean p set: 0.4511551260948181
loss_pred:0.01726187765598297, decouple_loss:0.0004188739985693246
Iteration: 2239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499966502189636, gen p mean: -0.11601171642541885, mean p set: 0.4505757987499237
loss_pred:0.015515315346419811, decouple_loss:0.00032320327591151
The modified gen p mean: 0.45045822858810425, gen p mean: -0.11108995974063873, mean p set: 0.4510355293750763
loss_pred:0.015900051221251488, decouple_loss:0.0005270331166684628
The modified gen p mean: 0.45172667503356934, gen p mean: -0.115786612033844, mean p set: 0.4523037374019623
loss_pred:0.01580880768597126, decouple_loss:0.00037132034776732326
Iteration: 2240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508618712425232, gen p mean: -0.11513809859752655, mean p set: 0.45144134759902954
loss_pred:0.016101961955428123, decouple_loss:0.000363023835234344
The modified gen p mean: 0.4520150423049927, gen p mean: -0.11400610208511353, mean p set: 0.45259371399879456
loss_pred:0.01600152999162674, decouple_loss:0.00046486075734719634
The modified gen p mean: 0.45047545433044434, gen p mean: -0.11390731483697891, mean p set: 0.4510516822338104
loss_pred:0.01553686149418354, decouple_loss:0.0004705115279648453
2023-05-02 11:51:25 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12451344728469849, mean p set: 0.4502691626548767
loss_pred:0.0169009268283844, decouple_loss:0.00046183777158148587
The modified gen p mean: 0.44953152537345886, gen p mean: -0.11781666427850723, mean p set: 0.4500633478164673
loss_pred:0.016239676624536514, decouple_loss:0.0005536423996090889
The modified gen p mean: 0.44982975721359253, gen p mean: -0.1174669861793518, mean p set: 0.45035696029663086
loss_pred:0.01651906967163086, decouple_loss:0.0006096152355894446
WV_1_PC_1_EH_0_PS_40, loss: 0.016580309718847275, avg_mse: 0.025796743109822273
current test mse: 0.025797
Iteration: 2241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049458742141724, gen p mean: -0.11193281412124634, mean p set: 0.4510705769062042
loss_pred:0.01575467735528946, decouple_loss:0.0003693501930683851
The modified gen p mean: 0.45070627331733704, gen p mean: -0.12142664194107056, mean p set: 0.45128458738327026
loss_pred:0.016160359606146812, decouple_loss:0.000473826308734715
The modified gen p mean: 0.4502814710140228, gen p mean: -0.11576738208532333, mean p set: 0.450858473777771
loss_pred:0.016274161636829376, decouple_loss:0.0005013089976273477
Iteration: 2242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001789927482605, gen p mean: -0.118585504591465, mean p set: 0.4505924582481384
The modified gen p mean: 0.44900771975517273, gen p mean: -0.11491885781288147, mean p set: 0.4495851993560791
loss_pred:0.01615176349878311, decouple_loss:0.00034552463330328465
loss_pred:0.015742259100079536, decouple_loss:0.0003647471603471786
The modified gen p mean: 0.4502057731151581, gen p mean: -0.11759225279092789, mean p set: 0.45078244805336
loss_pred:0.01630658097565174, decouple_loss:0.0003799365658778697
Iteration: 2243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45105522871017456, gen p mean: -0.1127961277961731, mean p set: 0.4516315758228302
loss_pred:0.016597623005509377, decouple_loss:0.0005061313277110457
The modified gen p mean: 0.4505264163017273, gen p mean: -0.11540324240922928, mean p set: 0.4511035680770874
loss_pred:0.016641143709421158, decouple_loss:0.00036734846071340144
The modified gen p mean: 0.4513392448425293, gen p mean: -0.11414874345064163, mean p set: 0.4519176781177521
loss_pred:0.01584554836153984, decouple_loss:0.00037679492379538715
Iteration: 2244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508150517940521, gen p mean: -0.11522677540779114, mean p set: 0.45139408111572266
loss_pred:0.016373343765735626, decouple_loss:0.0005826152628287673
The modified gen p mean: 0.45110365748405457, gen p mean: -0.11456798762083054, mean p set: 0.4516811966896057
loss_pred:0.01595032960176468, decouple_loss:0.00048380185035057366
The modified gen p mean: 0.45127415657043457, gen p mean: -0.11741840839385986, mean p set: 0.4518486559391022
loss_pred:0.015467110089957714, decouple_loss:0.0004558746295515448
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
NaN value num: 0
Iteration: 2245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45188412070274353, gen p mean: -0.11468978971242905, mean p set: 0.4524628818035126
loss_pred:0.015096815302968025, decouple_loss:0.00047139759408310056
The modified gen p mean: 0.45148488879203796, gen p mean: -0.11861909180879593, mean p set: 0.4520629048347473
loss_pred:0.015070000663399696, decouple_loss:0.0003684805706143379
The modified gen p mean: 0.4503043591976166, gen p mean: -0.11914770305156708, mean p set: 0.45088011026382446
loss_pred:0.015039265155792236, decouple_loss:0.00041228526970371604
Iteration: 2246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501822292804718, gen p mean: -0.11875396966934204, mean p set: 0.45075568556785583
loss_pred:0.014971216209232807, decouple_loss:0.0004921889049001038
The modified gen p mean: 0.45177483558654785, gen p mean: -0.12022799998521805, mean p set: 0.4523541033267975
The modified gen p mean: 0.4478800594806671, gen p mean: -0.12472087144851685, mean p set: 0.448453426361084
loss_pred:0.015160910785198212, decouple_loss:0.00038163195131346583
loss_pred:0.015914127230644226, decouple_loss:0.0003460985899437219
Iteration: 2247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44825559854507446, gen p mean: -0.12223771214485168, mean p set: 0.44883227348327637
loss_pred:0.015725238248705864, decouple_loss:0.00034635147312656045
The modified gen p mean: 0.4489598572254181, gen p mean: -0.12052110582590103, mean p set: 0.4495377540588379
The modified gen p mean: 0.45106837153434753, gen p mean: -0.12266855686903, mean p set: 0.45164522528648376
loss_pred:0.0158979594707489, decouple_loss:0.0003281865210738033
loss_pred:0.01548877265304327, decouple_loss:0.0003164037480019033
Iteration: 2248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935983419418335, gen p mean: -0.12126857042312622, mean p set: 0.4499378204345703
The modified gen p mean: 0.45253244042396545, gen p mean: -0.12196031957864761, mean p set: 0.45311251282691956
loss_pred:0.015531716868281364, decouple_loss:0.00036215607542544603
loss_pred:0.014616034924983978, decouple_loss:0.00034637260250747204
The modified gen p mean: 0.4495561718940735, gen p mean: -0.12764255702495575, mean p set: 0.4501332640647888
loss_pred:0.01602259650826454, decouple_loss:0.00033893887302838266
Iteration: 2249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533420503139496, gen p mean: -0.118236243724823, mean p set: 0.4539194405078888
loss_pred:0.014827586710453033, decouple_loss:0.0004934188327752054
The modified gen p mean: 0.44924888014793396, gen p mean: -0.12458683550357819, mean p set: 0.4498278796672821
loss_pred:0.015776343643665314, decouple_loss:0.0003378229739610106
The modified gen p mean: 0.44792890548706055, gen p mean: -0.12087363749742508, mean p set: 0.44850653409957886
loss_pred:0.015658600255846977, decouple_loss:0.0003716398496180773
Iteration: 2250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489285945892334, gen p mean: -0.12175930291414261, mean p set: 0.4495052993297577
loss_pred:0.015501786954700947, decouple_loss:0.0003303747216705233
The modified gen p mean: 0.45129311084747314, gen p mean: -0.12846848368644714, mean p set: 0.45186808705329895
The modified gen p mean: 0.44937703013420105, gen p mean: -0.12349924445152283, mean p set: 0.4499515891075134
loss_pred:0.014413231983780861, decouple_loss:0.00045941490679979324
loss_pred:0.015654578804969788, decouple_loss:0.00037944933865219355
2023-05-02 11:54:11 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13442586362361908, mean p set: 0.4502691626548767
loss_pred:0.016846662387251854, decouple_loss:0.00048638315638527274
The modified gen p mean: 0.4495357871055603, gen p mean: -0.12764644622802734, mean p set: 0.4500633478164673
loss_pred:0.016224561259150505, decouple_loss:0.0004130485176574439
The modified gen p mean: 0.4498274028301239, gen p mean: -0.12740951776504517, mean p set: 0.45035696029663086
loss_pred:0.016569528728723526, decouple_loss:0.0003940719470847398
WV_1_PC_1_EH_0_PS_40, loss: 0.01656847819685936, avg_mse: 0.02577224187552929
current test mse: 0.025772
Iteration: 2251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521481990814209, gen p mean: -0.12351182848215103, mean p set: 0.452727735042572
loss_pred:0.01493608858436346, decouple_loss:0.0004983155522495508
The modified gen p mean: 0.44895145297050476, gen p mean: -0.12573088705539703, mean p set: 0.44952961802482605The modified gen p mean: 0.45267829298973083, gen p mean: -0.12277018278837204, mean p set: 0.45325586199760437
loss_pred:0.01548313070088625, decouple_loss:0.00036858965177088976loss_pred:0.015450174920260906, decouple_loss:0.00046933285193517804
Iteration: 2252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505571722984314, gen p mean: -0.12712620198726654, mean p set: 0.45113280415534973
loss_pred:0.014414013363420963, decouple_loss:0.0004703485465142876
The modified gen p mean: 0.45344045758247375, gen p mean: -0.1252070963382721, mean p set: 0.4540169835090637The modified gen p mean: 0.44838592410087585, gen p mean: -0.1250675618648529, mean p set: 0.4489629566669464
loss_pred:0.014625424519181252, decouple_loss:0.0004538223147392273loss_pred:0.015965396538376808, decouple_loss:0.00040380607242695987
Iteration: 2253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495372176170349, gen p mean: -0.1282983422279358, mean p set: 0.4501151144504547
loss_pred:0.015577981248497963, decouple_loss:0.0004462541837710887
The modified gen p mean: 0.4489409029483795, gen p mean: -0.12187675386667252, mean p set: 0.4495220482349396
loss_pred:0.01564333401620388, decouple_loss:0.0004899038467556238
The modified gen p mean: 0.45014700293540955, gen p mean: -0.12278640270233154, mean p set: 0.450724720954895
loss_pred:0.014759395271539688, decouple_loss:0.0004126402491237968
Iteration: 2254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450264573097229, gen p mean: -0.11786806583404541, mean p set: 0.4508405923843384
loss_pred:0.014442546293139458, decouple_loss:0.0004160206008236855
The modified gen p mean: 0.4520514905452728, gen p mean: -0.11497090011835098, mean p set: 0.45262858271598816
loss_pred:0.015047380700707436, decouple_loss:0.0004574054037220776
The modified gen p mean: 0.45267626643180847, gen p mean: -0.11852741986513138, mean p set: 0.4532550275325775
loss_pred:0.01496413629502058, decouple_loss:0.0004687114851549268
Iteration: 2255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45109081268310547, gen p mean: -0.12265035510063171, mean p set: 0.4516671597957611
loss_pred:0.015868404880166054, decouple_loss:0.00041613742359913886
The modified gen p mean: 0.4515314996242523, gen p mean: -0.11721960455179214, mean p set: 0.45210903882980347
loss_pred:0.015383901074528694, decouple_loss:0.0004392116388771683
The modified gen p mean: 0.4524516761302948, gen p mean: -0.12434130162000656, mean p set: 0.4530285596847534
loss_pred:0.015463811345398426, decouple_loss:0.000598761485889554
Iteration: 2256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490731954574585, gen p mean: -0.11667243391275406, mean p set: 0.44964808225631714
loss_pred:0.016020052134990692, decouple_loss:0.00038254025275819004
The modified gen p mean: 0.4520086944103241, gen p mean: -0.1162729412317276, mean p set: 0.4525880217552185
loss_pred:0.014638970606029034, decouple_loss:0.00045502453576773405
The modified gen p mean: 0.44798752665519714, gen p mean: -0.12074311822652817, mean p set: 0.44856709241867065
loss_pred:0.015776975080370903, decouple_loss:0.0005544355371966958
Iteration: 2257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951963424682617, gen p mean: -0.12003212422132492, mean p set: 0.45009464025497437
loss_pred:0.015518521890044212, decouple_loss:0.0005424102419055998
The modified gen p mean: 0.45119136571884155, gen p mean: -0.11589153110980988, mean p set: 0.45176732540130615
The modified gen p mean: 0.44785594940185547, gen p mean: -0.11173126101493835, mean p set: 0.44843316078186035
loss_pred:0.015357252210378647, decouple_loss:0.00045476332888938487
loss_pred:0.015895767137408257, decouple_loss:0.00034680162207223475
Iteration: 2258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501844644546509, gen p mean: -0.11362753063440323, mean p set: 0.4507615268230438
loss_pred:0.015608792193233967, decouple_loss:0.00045766771654598415
The modified gen p mean: 0.4504151940345764, gen p mean: -0.10641881078481674, mean p set: 0.4509917199611664
The modified gen p mean: 0.4514029324054718, gen p mean: -0.10434271395206451, mean p set: 0.45197993516921997
loss_pred:0.01488194428384304, decouple_loss:0.00048348409472964704
loss_pred:0.015080522745847702, decouple_loss:0.00046540010953322053
Iteration: 2259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512648582458496, gen p mean: -0.10764908790588379, mean p set: 0.4518432915210724
loss_pred:0.014852475374937057, decouple_loss:0.0004262443690095097
The modified gen p mean: 0.4476722776889801, gen p mean: -0.1129063218832016, mean p set: 0.4482481777667999
loss_pred:0.015658775344491005, decouple_loss:0.00047172390623018146
The modified gen p mean: 0.4522608518600464, gen p mean: -0.10959631204605103, mean p set: 0.4528384804725647
loss_pred:0.01471760869026184, decouple_loss:0.000532813835889101
Iteration: 2260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520476460456848, gen p mean: -0.111817367374897, mean p set: 0.45262470841407776
loss_pred:0.01444307155907154, decouple_loss:0.0005568558699451387
The modified gen p mean: 0.45377102494239807, gen p mean: -0.11584850400686264, mean p set: 0.4543490707874298
The modified gen p mean: 0.4535996615886688, gen p mean: -0.1058776006102562, mean p set: 0.45417720079421997
loss_pred:0.014584248885512352, decouple_loss:0.000442299380665645
loss_pred:0.015742717310786247, decouple_loss:0.0004762968164868653
2023-05-02 11:56:18 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12788432836532593, mean p set: 0.4502691626548767
loss_pred:0.01681421883404255, decouple_loss:0.000432140426710248
The modified gen p mean: 0.4495358169078827, gen p mean: -0.12154004722833633, mean p set: 0.4500633478164673
loss_pred:0.016255900263786316, decouple_loss:0.0005132111837156117
The modified gen p mean: 0.44982483983039856, gen p mean: -0.1211799904704094, mean p set: 0.45035696029663086
loss_pred:0.016512461006641388, decouple_loss:0.0004099264042451978
WV_1_PC_1_EH_0_PS_40, loss: 0.016550114378333092, avg_mse: 0.025775933638215065
current test mse: 0.025776
Iteration: 2261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45137321949005127, gen p mean: -0.11599566042423248, mean p set: 0.45195209980010986
The modified gen p mean: 0.4517956078052521, gen p mean: -0.1180286779999733, mean p set: 0.45237189531326294
loss_pred:0.015147225931286812, decouple_loss:0.0004172333865426481
loss_pred:0.015242463909089565, decouple_loss:0.0005390908918343484
The modified gen p mean: 0.4532437026500702, gen p mean: -0.10948465764522552, mean p set: 0.4538205564022064
loss_pred:0.015351969748735428, decouple_loss:0.0003805037122219801
Iteration: 2262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510502219200134, gen p mean: -0.1261296421289444, mean p set: 0.45162856578826904
loss_pred:0.0142579460516572, decouple_loss:0.0004898647894151509
The modified gen p mean: 0.4526890218257904, gen p mean: -0.12290164828300476, mean p set: 0.4532664716243744The modified gen p mean: 0.44960591197013855, gen p mean: -0.1214815080165863, mean p set: 0.45018160343170166
loss_pred:0.014947954565286636, decouple_loss:0.00044403280480764806
loss_pred:0.01589381881058216, decouple_loss:0.00043637328781187534
Iteration: 2263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45099586248397827, gen p mean: -0.12314441055059433, mean p set: 0.45157068967819214
loss_pred:0.014886467717587948, decouple_loss:0.0004497864574659616
The modified gen p mean: 0.452806681394577, gen p mean: -0.11273497343063354, mean p set: 0.4533843994140625
loss_pred:0.015515392646193504, decouple_loss:0.0003498946316540241
The modified gen p mean: 0.4535876214504242, gen p mean: -0.11882621049880981, mean p set: 0.4541688859462738
loss_pred:0.0147299999371171, decouple_loss:0.00056285789469257
Iteration: 2264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500260353088379, gen p mean: -0.12298096716403961, mean p set: 0.45060133934020996
The modified gen p mean: 0.4488445818424225, gen p mean: -0.12534895539283752, mean p set: 0.44942015409469604
loss_pred:0.014524386264383793, decouple_loss:0.0004725100880023092
loss_pred:0.015720097348093987, decouple_loss:0.000377616030164063
The modified gen p mean: 0.450429230928421, gen p mean: -0.1146497055888176, mean p set: 0.4510028660297394
loss_pred:0.014709167182445526, decouple_loss:0.0005134671228006482
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
NaN value num: 0
Iteration: 2265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44572368264198303, gen p mean: -0.12290450930595398, mean p set: 0.4462999701499939
loss_pred:0.017102649435400963, decouple_loss:0.00038558474625460804
The modified gen p mean: 0.4487514793872833, gen p mean: -0.12056264281272888, mean p set: 0.4493277370929718
The modified gen p mean: 0.447352796792984, gen p mean: -0.12678705155849457, mean p set: 0.44792690873146057
loss_pred:0.014837482944130898, decouple_loss:0.0005482759443111718
loss_pred:0.016630027443170547, decouple_loss:0.0003975553554482758
Iteration: 2266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44605743885040283, gen p mean: -0.12281090766191483, mean p set: 0.4466344118118286
loss_pred:0.0176348015666008, decouple_loss:0.00040246453136205673
The modified gen p mean: 0.44855064153671265, gen p mean: -0.1204938068985939, mean p set: 0.44912847876548767
loss_pred:0.015048435889184475, decouple_loss:0.0004586406867019832
The modified gen p mean: 0.4470309019088745, gen p mean: -0.13148938119411469, mean p set: 0.44760826230049133
loss_pred:0.017158105969429016, decouple_loss:0.0005469630123116076
Iteration: 2267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44650283455848694, gen p mean: -0.11842183768749237, mean p set: 0.4470764696598053
loss_pred:0.016342241317033768, decouple_loss:0.00033111541415564716
The modified gen p mean: 0.4456915557384491, gen p mean: -0.1160140410065651, mean p set: 0.44626984000205994
The modified gen p mean: 0.44686973094940186, gen p mean: -0.12252113968133926, mean p set: 0.44744330644607544
loss_pred:0.015984805300831795, decouple_loss:0.00032647032639943063
loss_pred:0.01592447981238365, decouple_loss:0.00040407732012681663
Iteration: 2268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44612717628479004, gen p mean: -0.11993268132209778, mean p set: 0.4466996490955353
loss_pred:0.016501985490322113, decouple_loss:0.0003356982197146863
The modified gen p mean: 0.44619816541671753, gen p mean: -0.12545612454414368, mean p set: 0.44677287340164185
loss_pred:0.01690036803483963, decouple_loss:0.00043231810559518635
The modified gen p mean: 0.44578930735588074, gen p mean: -0.12323556840419769, mean p set: 0.44636544585227966
loss_pred:0.01658872328698635, decouple_loss:0.000329305388731882
Iteration: 2269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446920245885849, gen p mean: -0.11961674690246582, mean p set: 0.44749733805656433
loss_pred:0.01642109453678131, decouple_loss:0.0003950200916733593
The modified gen p mean: 0.4461843967437744, gen p mean: -0.11778625845909119, mean p set: 0.4467623829841614
loss_pred:0.01677890308201313, decouple_loss:0.0003823598090093583
The modified gen p mean: 0.4474582374095917, gen p mean: -0.12025006115436554, mean p set: 0.4480360448360443
loss_pred:0.015150092542171478, decouple_loss:0.0004547632997855544
Iteration: 2270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609537720680237, gen p mean: -0.12263515591621399, mean p set: 0.44667208194732666
loss_pred:0.016218703240156174, decouple_loss:0.0003626075922511518
The modified gen p mean: 0.4474165439605713, gen p mean: -0.12005290389060974, mean p set: 0.4479944705963135
The modified gen p mean: 0.4468885660171509, gen p mean: -0.12424643337726593, mean p set: 0.4474653899669647
loss_pred:0.015896227210760117, decouple_loss:0.00041555421194061637
loss_pred:0.016165131703019142, decouple_loss:0.000390144094126299
2023-05-02 11:59:02 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12800073623657227, mean p set: 0.4502691626548767
loss_pred:0.016832591965794563, decouple_loss:0.0004673764924518764
The modified gen p mean: 0.44953668117523193, gen p mean: -0.12142359465360641, mean p set: 0.4500633478164673
loss_pred:0.016221527010202408, decouple_loss:0.0004174593777861446
The modified gen p mean: 0.44982653856277466, gen p mean: -0.12082269787788391, mean p set: 0.45035696029663086
loss_pred:0.016492407768964767, decouple_loss:0.00042147591011598706
WV_1_PC_1_EH_0_PS_40, loss: 0.01653728261590004, avg_mse: 0.02570180408656597
current test mse: 0.025702
Iteration: 2271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446805477142334, gen p mean: -0.12735004723072052, mean p set: 0.4473839998245239
loss_pred:0.015861794352531433, decouple_loss:0.00039743579691275954
The modified gen p mean: 0.44624316692352295, gen p mean: -0.13086315989494324, mean p set: 0.4468180239200592
loss_pred:0.016767587512731552, decouple_loss:0.0004691520589403808
The modified gen p mean: 0.44634097814559937, gen p mean: -0.12077963352203369, mean p set: 0.44691601395606995
loss_pred:0.016970966011285782, decouple_loss:0.0004429632390383631
Iteration: 2272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459059536457062, gen p mean: -0.12102943658828735, mean p set: 0.44648122787475586
loss_pred:0.015896674245595932, decouple_loss:0.0003551144036464393
The modified gen p mean: 0.4468885660171509, gen p mean: -0.1172887459397316, mean p set: 0.4474627375602722The modified gen p mean: 0.4455912411212921, gen p mean: -0.12171164900064468, mean p set: 0.4461663067340851
loss_pred:0.016268009319901466, decouple_loss:0.00043325196020305157
loss_pred:0.016661636531352997, decouple_loss:0.00046150939306244254
Iteration: 2273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44614699482917786, gen p mean: -0.12303139269351959, mean p set: 0.4467245936393738
loss_pred:0.01686607114970684, decouple_loss:0.0003779861726798117
The modified gen p mean: 0.44666537642478943, gen p mean: -0.11821966618299484, mean p set: 0.4472403824329376
loss_pred:0.016848091036081314, decouple_loss:0.0003257999778725207
The modified gen p mean: 0.44557300209999084, gen p mean: -0.11903185397386551, mean p set: 0.4461488425731659
loss_pred:0.016149520874023438, decouple_loss:0.00033736505429260433
Iteration: 2274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453873634338379, gen p mean: -0.12168904393911362, mean p set: 0.4459622800350189
loss_pred:0.016765868291258812, decouple_loss:0.00043359334813430905
The modified gen p mean: 0.4471295475959778, gen p mean: -0.12450400739908218, mean p set: 0.44770586490631104
loss_pred:0.01647052727639675, decouple_loss:0.0007103544776327908
The modified gen p mean: 0.446344256401062, gen p mean: -0.12139330059289932, mean p set: 0.4469212293624878
loss_pred:0.01560412161052227, decouple_loss:0.0005525642191059887
Iteration: 2275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814714789390564, gen p mean: -0.1296539604663849, mean p set: 0.44872260093688965
loss_pred:0.01521484274417162, decouple_loss:0.00040768328472040594
The modified gen p mean: 0.44752922654151917, gen p mean: -0.12820538878440857, mean p set: 0.44810721278190613
loss_pred:0.015365452505648136, decouple_loss:0.00046517440932802856
The modified gen p mean: 0.44553589820861816, gen p mean: -0.12449523061513901, mean p set: 0.44611287117004395
loss_pred:0.016149427741765976, decouple_loss:0.0003828492190223187
Iteration: 2276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44623786211013794, gen p mean: -0.12905825674533844, mean p set: 0.4468151926994324
loss_pred:0.015991732478141785, decouple_loss:0.0003408961638342589
The modified gen p mean: 0.4479712247848511, gen p mean: -0.12701673805713654, mean p set: 0.4485476016998291
The modified gen p mean: 0.44739505648612976, gen p mean: -0.12888221442699432, mean p set: 0.4479721784591675
loss_pred:0.014901439659297466, decouple_loss:0.0003792116476688534
loss_pred:0.015223822556436062, decouple_loss:0.00038607275928370655
Iteration: 2277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44610103964805603, gen p mean: -0.1323453038930893, mean p set: 0.4466760754585266
loss_pred:0.016382230445742607, decouple_loss:0.0004186673613730818
The modified gen p mean: 0.44655856490135193, gen p mean: -0.13109922409057617, mean p set: 0.4471311867237091
loss_pred:0.015721919015049934, decouple_loss:0.0005279727629385889
The modified gen p mean: 0.44649839401245117, gen p mean: -0.13319873809814453, mean p set: 0.44707679748535156
loss_pred:0.016891757026314735, decouple_loss:0.00046098491293378174
Iteration: 2278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671255350112915, gen p mean: -0.13644535839557648, mean p set: 0.44728702306747437
loss_pred:0.01688147522509098, decouple_loss:0.0005082731950096786
The modified gen p mean: 0.44658225774765015, gen p mean: -0.1284230649471283, mean p set: 0.44716089963912964
loss_pred:0.01569635607302189, decouple_loss:0.00042052939534187317
The modified gen p mean: 0.44802191853523254, gen p mean: -0.13011547923088074, mean p set: 0.44859790802001953
loss_pred:0.014903775416314602, decouple_loss:0.000388149986974895
Iteration: 2279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44577333331108093, gen p mean: -0.13154424726963043, mean p set: 0.44634416699409485
loss_pred:0.016167594119906425, decouple_loss:0.0003899272996932268
The modified gen p mean: 0.44559580087661743, gen p mean: -0.13326576352119446, mean p set: 0.4461705982685089
The modified gen p mean: 0.4462774693965912, gen p mean: -0.13638246059417725, mean p set: 0.4468543529510498
loss_pred:0.0164309274405241, decouple_loss:0.0003410101344343275
loss_pred:0.016585098579525948, decouple_loss:0.00036474791704677045
Iteration: 2280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44572532176971436, gen p mean: -0.13234713673591614, mean p set: 0.44630083441734314
loss_pred:0.015687083825469017, decouple_loss:0.0004665136511903256
The modified gen p mean: 0.4463934302330017, gen p mean: -0.13246984779834747, mean p set: 0.4469709098339081
The modified gen p mean: 0.4455026388168335, gen p mean: -0.1329634040594101, mean p set: 0.4460771083831787
loss_pred:0.015409895218908787, decouple_loss:0.0005344332312233746
loss_pred:0.016797680407762527, decouple_loss:0.00041174638317897916
2023-05-02 12:01:09 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1394878327846527, mean p set: 0.4502691626548767
loss_pred:0.016857365146279335, decouple_loss:0.00047162079135887325
The modified gen p mean: 0.44953519105911255, gen p mean: -0.13298346102237701, mean p set: 0.4500633478164673
loss_pred:0.016185706481337547, decouple_loss:0.000537438434548676
The modified gen p mean: 0.44982773065567017, gen p mean: -0.13253352046012878, mean p set: 0.45035696029663086
loss_pred:0.016435714438557625, decouple_loss:0.0005349238053895533
WV_1_PC_1_EH_0_PS_40, loss: 0.016518661752343178, avg_mse: 0.025711214169859886
current test mse: 0.025711
Iteration: 2281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459982216358185, gen p mean: -0.13535411655902863, mean p set: 0.4465733468532562
loss_pred:0.0161586944013834, decouple_loss:0.0005044266581535339
The modified gen p mean: 0.44671666622161865, gen p mean: -0.1362055540084839, mean p set: 0.4472929835319519The modified gen p mean: 0.4463956654071808, gen p mean: -0.13409869372844696, mean p set: 0.4469703137874603
loss_pred:0.015717947855591774, decouple_loss:0.0005001440877094865loss_pred:0.01635662652552128, decouple_loss:0.0004967684508301318
Iteration: 2282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468505382537842, gen p mean: -0.13281472027301788, mean p set: 0.4474280774593353
loss_pred:0.016018902882933617, decouple_loss:0.0003435749968048185
The modified gen p mean: 0.44676029682159424, gen p mean: -0.131265327334404, mean p set: 0.44733378291130066The modified gen p mean: 0.4456367492675781, gen p mean: -0.1357131004333496, mean p set: 0.44621503353118896
loss_pred:0.01654587872326374, decouple_loss:0.00039690255653113127loss_pred:0.01564081758260727, decouple_loss:0.0004377703298814595
Iteration: 2283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463658034801483, gen p mean: -0.12878552079200745, mean p set: 0.44694146513938904
The modified gen p mean: 0.44783815741539, gen p mean: -0.13681204617023468, mean p set: 0.44841480255126953
loss_pred:0.01600954681634903, decouple_loss:0.0003496697754599154
loss_pred:0.014877226203680038, decouple_loss:0.0006306756404228508
The modified gen p mean: 0.4467760920524597, gen p mean: -0.1343873143196106, mean p set: 0.4473523199558258
loss_pred:0.015570675022900105, decouple_loss:0.0003458652936387807
Iteration: 2284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445862740278244, gen p mean: -0.13052985072135925, mean p set: 0.4464380145072937
loss_pred:0.015219379216432571, decouple_loss:0.0004276936815585941
The modified gen p mean: 0.4462733566761017, gen p mean: -0.12864121794700623, mean p set: 0.4468507766723633
loss_pred:0.016186460852622986, decouple_loss:0.00044563846313394606
The modified gen p mean: 0.44589322805404663, gen p mean: -0.12889821827411652, mean p set: 0.4464716613292694
loss_pred:0.015769748017191887, decouple_loss:0.00042462165583856404
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
NaN value num: 0
Iteration: 2285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529278576374054, gen p mean: -0.11414063721895218, mean p set: 0.4535035192966461
loss_pred:0.015462526120245457, decouple_loss:0.00038139885873533785
The modified gen p mean: 0.4542669951915741, gen p mean: -0.11089114844799042, mean p set: 0.45484453439712524
loss_pred:0.014858683571219444, decouple_loss:0.00046224799007177353
The modified gen p mean: 0.45017358660697937, gen p mean: -0.11674797534942627, mean p set: 0.4507507383823395
loss_pred:0.015124564990401268, decouple_loss:0.0006011993973515928
Iteration: 2286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45382586121559143, gen p mean: -0.11031382530927658, mean p set: 0.4544040560722351
loss_pred:0.015608035959303379, decouple_loss:0.00046382760046981275
The modified gen p mean: 0.4536668658256531, gen p mean: -0.11383862048387527, mean p set: 0.4542456865310669
loss_pred:0.01579236425459385, decouple_loss:0.00043806948815472424
The modified gen p mean: 0.4523726999759674, gen p mean: -0.11318793892860413, mean p set: 0.45295077562332153
loss_pred:0.014426040463149548, decouple_loss:0.0005415436462499201
Iteration: 2287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529319107532501, gen p mean: -0.11401285976171494, mean p set: 0.4535074532032013
loss_pred:0.014523147605359554, decouple_loss:0.000579694053158164
The modified gen p mean: 0.4524179995059967, gen p mean: -0.11669529229402542, mean p set: 0.45299461483955383
loss_pred:0.015454050153493881, decouple_loss:0.000401426776079461
The modified gen p mean: 0.45209839940071106, gen p mean: -0.11401974409818649, mean p set: 0.4526754915714264
loss_pred:0.015338130295276642, decouple_loss:0.0004604070563800633
Iteration: 2288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4544943571090698, gen p mean: -0.11241846531629562, mean p set: 0.45507341623306274
loss_pred:0.014683963730931282, decouple_loss:0.0004912606091238558
The modified gen p mean: 0.45319265127182007, gen p mean: -0.1128295511007309, mean p set: 0.4537711441516876
loss_pred:0.015297246165573597, decouple_loss:0.0006159798358567059
The modified gen p mean: 0.4540309011936188, gen p mean: -0.11722532659769058, mean p set: 0.45460760593414307
loss_pred:0.015065726824104786, decouple_loss:0.0005743379588238895
Iteration: 2289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45226359367370605, gen p mean: -0.11528488248586655, mean p set: 0.4528396725654602
loss_pred:0.014783140271902084, decouple_loss:0.00044350733514875174
The modified gen p mean: 0.4527675211429596, gen p mean: -0.11962524801492691, mean p set: 0.4533441960811615
The modified gen p mean: 0.45311203598976135, gen p mean: -0.1071481704711914, mean p set: 0.45369112491607666
loss_pred:0.0152360238134861, decouple_loss:0.00043189211282879114
loss_pred:0.015956247225403786, decouple_loss:0.0004836323787458241
Iteration: 2290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452787846326828, gen p mean: -0.11462997645139694, mean p set: 0.45336446166038513
loss_pred:0.015115464106202126, decouple_loss:0.0003948645608033985
The modified gen p mean: 0.45342814922332764, gen p mean: -0.11092761904001236, mean p set: 0.4540044963359833
loss_pred:0.015848657116293907, decouple_loss:0.0006067845388315618
The modified gen p mean: 0.45377621054649353, gen p mean: -0.11048794537782669, mean p set: 0.45435431599617004
loss_pred:0.015379438176751137, decouple_loss:0.0004987552529200912
2023-05-02 12:03:52 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13232651352882385, mean p set: 0.4502691626548767
loss_pred:0.016996167600154877, decouple_loss:0.000565442955121398
The modified gen p mean: 0.4495350122451782, gen p mean: -0.12603802978992462, mean p set: 0.4500633478164673
loss_pred:0.016162868589162827, decouple_loss:0.000523556605912745
The modified gen p mean: 0.4498274624347687, gen p mean: -0.12567955255508423, mean p set: 0.45035696029663086
loss_pred:0.016545234248042107, decouple_loss:0.0004691673384513706
WV_1_PC_1_EH_0_PS_40, loss: 0.016594059765338898, avg_mse: 0.025831475853919983
current test mse: 0.025831
Iteration: 2291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533516466617584, gen p mean: -0.11798380315303802, mean p set: 0.45392709970474243
loss_pred:0.015491792932152748, decouple_loss:0.0005189183866605163
The modified gen p mean: 0.4526592493057251, gen p mean: -0.11527787148952484, mean p set: 0.45323580503463745The modified gen p mean: 0.45303815603256226, gen p mean: -0.12179660052061081, mean p set: 0.45361828804016113
loss_pred:0.014968400821089745, decouple_loss:0.0005239279707893729
loss_pred:0.014808956533670425, decouple_loss:0.00041248180787079036
Iteration: 2292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45277532935142517, gen p mean: -0.11761514842510223, mean p set: 0.4533534049987793
loss_pred:0.015078037977218628, decouple_loss:0.0004760326410178095
The modified gen p mean: 0.4533234238624573, gen p mean: -0.11741701513528824, mean p set: 0.4538998007774353The modified gen p mean: 0.4528719484806061, gen p mean: -0.11833725869655609, mean p set: 0.45345136523246765
loss_pred:0.014365680515766144, decouple_loss:0.0005010987515561283
loss_pred:0.015706874430179596, decouple_loss:0.0005517023964785039
Iteration: 2293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523523151874542, gen p mean: -0.1148875504732132, mean p set: 0.45293015241622925
loss_pred:0.014021161943674088, decouple_loss:0.0004953065072186291
The modified gen p mean: 0.45246899127960205, gen p mean: -0.11903325468301773, mean p set: 0.453046590089798The modified gen p mean: 0.4523308277130127, gen p mean: -0.11750095337629318, mean p set: 0.4529087543487549
loss_pred:0.015263358131051064, decouple_loss:0.00039953927625901997
loss_pred:0.015261388383805752, decouple_loss:0.0006929659284651279
Iteration: 2294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45286643505096436, gen p mean: -0.11699647456407547, mean p set: 0.4534422755241394
loss_pred:0.015264621935784817, decouple_loss:0.0005014892085455358
The modified gen p mean: 0.45364829897880554, gen p mean: -0.12528620660305023, mean p set: 0.4542261064052582
loss_pred:0.015188836492598057, decouple_loss:0.0005539311096072197
The modified gen p mean: 0.4538027048110962, gen p mean: -0.1238659992814064, mean p set: 0.4543784260749817
loss_pred:0.015548835508525372, decouple_loss:0.0006263935356400907
Iteration: 2295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533369541168213, gen p mean: -0.1191282719373703, mean p set: 0.4539128243923187
loss_pred:0.01490241289138794, decouple_loss:0.00045365284313447773
The modified gen p mean: 0.4528704583644867, gen p mean: -0.11445484310388565, mean p set: 0.4534461498260498
loss_pred:0.015433927066624165, decouple_loss:0.0004748778883367777
The modified gen p mean: 0.45267578959465027, gen p mean: -0.11171571165323257, mean p set: 0.45325344800949097
loss_pred:0.01478673331439495, decouple_loss:0.0004763652104884386
Iteration: 2296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4542067348957062, gen p mean: -0.11857490241527557, mean p set: 0.4547848105430603
The modified gen p mean: 0.45307835936546326, gen p mean: -0.11220762878656387, mean p set: 0.4536536633968353
loss_pred:0.014942208305001259, decouple_loss:0.0005048856255598366
loss_pred:0.01520086731761694, decouple_loss:0.0004053617303725332
The modified gen p mean: 0.4529334306716919, gen p mean: -0.11603827774524689, mean p set: 0.45351284742355347
loss_pred:0.015360417775809765, decouple_loss:0.0004166852741036564
Iteration: 2297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529944658279419, gen p mean: -0.11510653793811798, mean p set: 0.4535713493824005
loss_pred:0.01473113615065813, decouple_loss:0.00041355652501806617
The modified gen p mean: 0.4520646631717682, gen p mean: -0.1105547696352005, mean p set: 0.45264074206352234
loss_pred:0.015285619534552097, decouple_loss:0.0005036479560658336
The modified gen p mean: 0.45326030254364014, gen p mean: -0.1078614816069603, mean p set: 0.45383745431900024
loss_pred:0.015124623663723469, decouple_loss:0.0005298156174831092
Iteration: 2298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45338883996009827, gen p mean: -0.11781121045351028, mean p set: 0.45396625995635986
loss_pred:0.015550895594060421, decouple_loss:0.00046601888607256114
The modified gen p mean: 0.4535238742828369, gen p mean: -0.109552763402462, mean p set: 0.4541010856628418
loss_pred:0.014492148533463478, decouple_loss:0.0003715335042215884
The modified gen p mean: 0.4517287313938141, gen p mean: -0.11082930862903595, mean p set: 0.45230671763420105
loss_pred:0.015470917336642742, decouple_loss:0.0004315547412261367
Iteration: 2299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529062509536743, gen p mean: -0.10824441909790039, mean p set: 0.453481525182724
loss_pred:0.015435608103871346, decouple_loss:0.00047419447218999267
The modified gen p mean: 0.4529542624950409, gen p mean: -0.10840041190385818, mean p set: 0.453529417514801
The modified gen p mean: 0.4524533748626709, gen p mean: -0.10784736275672913, mean p set: 0.4530305862426758
loss_pred:0.014677957631647587, decouple_loss:0.0003698364307638258
loss_pred:0.015077783726155758, decouple_loss:0.000362972728908062
Iteration: 2300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505937397480011, gen p mean: -0.10442858934402466, mean p set: 0.451170951128006
loss_pred:0.014769579283893108, decouple_loss:0.0005445816204883158
The modified gen p mean: 0.4517969489097595, gen p mean: -0.10697522014379501, mean p set: 0.45237207412719727
loss_pred:0.01477111503481865, decouple_loss:0.00043792734504677355
The modified gen p mean: 0.4522806406021118, gen p mean: -0.1081852987408638, mean p set: 0.4528588652610779
loss_pred:0.01499366108328104, decouple_loss:0.00040641363011673093
2023-05-02 12:05:59 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1201578676700592, mean p set: 0.4502691626548767
loss_pred:0.016947560012340546, decouple_loss:0.0005914772627875209
The modified gen p mean: 0.4495338797569275, gen p mean: -0.11385340243577957, mean p set: 0.4500633478164673
loss_pred:0.01624430902302265, decouple_loss:0.0006647261325269938
The modified gen p mean: 0.44982773065567017, gen p mean: -0.11364475637674332, mean p set: 0.45035696029663086
loss_pred:0.016516519710421562, decouple_loss:0.0005550729692913592
WV_1_PC_1_EH_0_PS_40, loss: 0.01659965142607689, avg_mse: 0.02590830996632576
current test mse: 0.025908
Iteration: 2301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.454343318939209, gen p mean: -0.1034122183918953, mean p set: 0.45491892099380493
loss_pred:0.014999196864664555, decouple_loss:0.0004574103222694248
The modified gen p mean: 0.4534107446670532, gen p mean: -0.09743983298540115, mean p set: 0.453988641500473
loss_pred:0.015658292919397354, decouple_loss:0.000550571596249938
The modified gen p mean: 0.4501660466194153, gen p mean: -0.10458845645189285, mean p set: 0.45074325799942017
loss_pred:0.014838972128927708, decouple_loss:0.00044417515164241195
Iteration: 2302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523174464702606, gen p mean: -0.10750661790370941, mean p set: 0.4528941214084625
The modified gen p mean: 0.45367735624313354, gen p mean: -0.11264894157648087, mean p set: 0.45425495505332947
loss_pred:0.014909001998603344, decouple_loss:0.00043710312456823885
loss_pred:0.01554240845143795, decouple_loss:0.0004949002177454531
The modified gen p mean: 0.4532531499862671, gen p mean: -0.11091344803571701, mean p set: 0.4538280665874481
loss_pred:0.015346920117735863, decouple_loss:0.00040119263576343656
Iteration: 2303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45312127470970154, gen p mean: -0.10910800844430923, mean p set: 0.4536985456943512
loss_pred:0.015172600746154785, decouple_loss:0.0003921105817425996
The modified gen p mean: 0.45229294896125793, gen p mean: -0.10783975571393967, mean p set: 0.4528715908527374The modified gen p mean: 0.4539170563220978, gen p mean: -0.11473985761404037, mean p set: 0.4544958472251892
loss_pred:0.014293071813881397, decouple_loss:0.0006450858199968934
loss_pred:0.015167438425123692, decouple_loss:0.000564203888643533
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 2304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469412565231323, gen p mean: -0.12161368131637573, mean p set: 0.44751641154289246
loss_pred:0.01483951322734356, decouple_loss:0.0005743478541262448
The modified gen p mean: 0.44652700424194336, gen p mean: -0.12102608382701874, mean p set: 0.4471038579940796
loss_pred:0.015949329361319542, decouple_loss:0.000649972993414849
The modified gen p mean: 0.4483075737953186, gen p mean: -0.11776259541511536, mean p set: 0.44888240098953247
loss_pred:0.014399630017578602, decouple_loss:0.0006374234799295664
Iteration: 2305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44600021839141846, gen p mean: -0.12192165851593018, mean p set: 0.4465774595737457
loss_pred:0.015657903626561165, decouple_loss:0.00048552322550676763
The modified gen p mean: 0.446839839220047, gen p mean: -0.12037119269371033, mean p set: 0.447416752576828
loss_pred:0.014311493374407291, decouple_loss:0.00038353411946445704
The modified gen p mean: 0.446579247713089, gen p mean: -0.1221996396780014, mean p set: 0.44715800881385803
loss_pred:0.013677982613444328, decouple_loss:0.00042783524258993566
Iteration: 2306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475706219673157, gen p mean: -0.11955157667398453, mean p set: 0.44814640283584595
loss_pred:0.015166500583291054, decouple_loss:0.0003653386083897203
The modified gen p mean: 0.44808799028396606, gen p mean: -0.12532038986682892, mean p set: 0.4486611485481262
The modified gen p mean: 0.44735875725746155, gen p mean: -0.12637364864349365, mean p set: 0.447934627532959
loss_pred:0.015196208842098713, decouple_loss:0.0005009868182241917
loss_pred:0.01525515504181385, decouple_loss:0.0005591150256805122
Iteration: 2307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744443893432617, gen p mean: -0.12138216197490692, mean p set: 0.44801655411720276
loss_pred:0.01362595148384571, decouple_loss:0.0005945992888882756
The modified gen p mean: 0.44674786925315857, gen p mean: -0.1215982586145401, mean p set: 0.44732168316841125
loss_pred:0.01421580370515585, decouple_loss:0.0004848144017159939
The modified gen p mean: 0.4477137625217438, gen p mean: -0.12339335680007935, mean p set: 0.4482881724834442
loss_pred:0.014853941276669502, decouple_loss:0.0003994193975813687
Iteration: 2308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692984223365784, gen p mean: -0.12121064960956573, mean p set: 0.4475066065788269
loss_pred:0.013734785839915276, decouple_loss:0.0005343217635527253
The modified gen p mean: 0.4466121792793274, gen p mean: -0.12493222206830978, mean p set: 0.4471876323223114
loss_pred:0.015100308693945408, decouple_loss:0.00044041688670404255
The modified gen p mean: 0.4470801055431366, gen p mean: -0.12394078075885773, mean p set: 0.44765499234199524
loss_pred:0.014875144697725773, decouple_loss:0.0004970764857716858
Iteration: 2309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44655540585517883, gen p mean: -0.12480053305625916, mean p set: 0.44713205099105835
loss_pred:0.014539184980094433, decouple_loss:0.00040770755731500685
The modified gen p mean: 0.446599543094635, gen p mean: -0.12221682816743851, mean p set: 0.44717565178871155
loss_pred:0.015135308727622032, decouple_loss:0.00040510983671993017
The modified gen p mean: 0.4472931921482086, gen p mean: -0.11470616608858109, mean p set: 0.44786933064460754
loss_pred:0.014875739812850952, decouple_loss:0.0003942309704143554
Iteration: 2310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471103549003601, gen p mean: -0.11639955639839172, mean p set: 0.44768741726875305
loss_pred:0.014440419152379036, decouple_loss:0.0004953496973030269
The modified gen p mean: 0.44720035791397095, gen p mean: -0.11993923038244247, mean p set: 0.4477759599685669
The modified gen p mean: 0.44793951511383057, gen p mean: -0.1221122220158577, mean p set: 0.4485190510749817
loss_pred:0.015153049491345882, decouple_loss:0.0004086532862856984
loss_pred:0.015172040089964867, decouple_loss:0.0004375549906399101
2023-05-02 12:08:43 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12645210325717926, mean p set: 0.4502691626548767
loss_pred:0.016872338950634003, decouple_loss:0.0005580103024840355
The modified gen p mean: 0.44953450560569763, gen p mean: -0.11999063938856125, mean p set: 0.4500633478164673
loss_pred:0.016274074092507362, decouple_loss:0.0005407361895777285
The modified gen p mean: 0.44982632994651794, gen p mean: -0.11985350400209427, mean p set: 0.45035696029663086
loss_pred:0.016499020159244537, decouple_loss:0.0004584715352393687
WV_1_PC_1_EH_0_PS_40, loss: 0.016574431210756302, avg_mse: 0.025861941277980804
current test mse: 0.025862
Iteration: 2311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44627898931503296, gen p mean: -0.13251419365406036, mean p set: 0.4468553960323334
loss_pred:0.014804872684180737, decouple_loss:0.0003754949430003762
The modified gen p mean: 0.44720059633255005, gen p mean: -0.12210456281900406, mean p set: 0.4477759003639221
loss_pred:0.014286931604146957, decouple_loss:0.00048380461521446705
The modified gen p mean: 0.4468623697757721, gen p mean: -0.12702488899230957, mean p set: 0.44743743538856506
loss_pred:0.014925384894013405, decouple_loss:0.0004579407686833292
Iteration: 2312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470732808113098, gen p mean: -0.11712763458490372, mean p set: 0.4476470947265625
The modified gen p mean: 0.44706451892852783, gen p mean: -0.12199857831001282, mean p set: 0.44764021039009094
loss_pred:0.014294122345745564, decouple_loss:0.00039954428211785853
loss_pred:0.014997387304902077, decouple_loss:0.0004787782090716064
The modified gen p mean: 0.4481152594089508, gen p mean: -0.11458444595336914, mean p set: 0.4486927390098572
loss_pred:0.013928928412497044, decouple_loss:0.0003307648585177958
Iteration: 2313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44709837436676025, gen p mean: -0.11283721774816513, mean p set: 0.4476739168167114
loss_pred:0.014873537234961987, decouple_loss:0.00040103995706886053
The modified gen p mean: 0.4464258849620819, gen p mean: -0.119600810110569, mean p set: 0.4470026195049286
loss_pred:0.014708276838064194, decouple_loss:0.0004555296036414802
The modified gen p mean: 0.446696400642395, gen p mean: -0.12075357884168625, mean p set: 0.4472716748714447
loss_pred:0.015439223498106003, decouple_loss:0.00038745946949347854
Iteration: 2314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471805691719055, gen p mean: -0.11382356286048889, mean p set: 0.4477570950984955
loss_pred:0.014208769425749779, decouple_loss:0.000554983620531857
The modified gen p mean: 0.4486609399318695, gen p mean: -0.115999236702919, mean p set: 0.44923636317253113
loss_pred:0.01390201598405838, decouple_loss:0.0005012512556277215
The modified gen p mean: 0.4467628002166748, gen p mean: -0.11747770756483078, mean p set: 0.4473371207714081
loss_pred:0.01378597691655159, decouple_loss:0.0004316264530643821
Iteration: 2315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710734486579895, gen p mean: -0.11567458510398865, mean p set: 0.4476839005947113
loss_pred:0.013385036028921604, decouple_loss:0.0005418714135885239
The modified gen p mean: 0.44643527269363403, gen p mean: -0.11440485715866089, mean p set: 0.4470112919807434
loss_pred:0.013613320887088776, decouple_loss:0.0006020564469508827
The modified gen p mean: 0.4460484981536865, gen p mean: -0.12358745187520981, mean p set: 0.44662564992904663
loss_pred:0.015019030310213566, decouple_loss:0.0005031905020587146
Iteration: 2316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44805121421813965, gen p mean: -0.11710899323225021, mean p set: 0.4486280083656311
loss_pred:0.01403787825256586, decouple_loss:0.0004048534028697759
The modified gen p mean: 0.44721299409866333, gen p mean: -0.11696834117174149, mean p set: 0.4477875828742981
loss_pred:0.014879163354635239, decouple_loss:0.00044449331471696496
The modified gen p mean: 0.4467967748641968, gen p mean: -0.12347456067800522, mean p set: 0.4473738372325897
loss_pred:0.013780329376459122, decouple_loss:0.00046284552081488073
Iteration: 2317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465358257293701, gen p mean: -0.12903712689876556, mean p set: 0.4471111297607422
loss_pred:0.014316746965050697, decouple_loss:0.00036804951378144324
The modified gen p mean: 0.4468201696872711, gen p mean: -0.11927762627601624, mean p set: 0.44739529490470886
loss_pred:0.014126657508313656, decouple_loss:0.0003417962871026248
The modified gen p mean: 0.44709542393684387, gen p mean: -0.11667894572019577, mean p set: 0.4476735293865204
loss_pred:0.014400399290025234, decouple_loss:0.00033797702053561807
Iteration: 2318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465309977531433, gen p mean: -0.11530346423387527, mean p set: 0.4471050798892975
loss_pred:0.013816510327160358, decouple_loss:0.0004394973802845925
The modified gen p mean: 0.4468560218811035, gen p mean: -0.12168454378843307, mean p set: 0.4474334716796875
loss_pred:0.014739645645022392, decouple_loss:0.0006104393978603184
The modified gen p mean: 0.44802412390708923, gen p mean: -0.11541566997766495, mean p set: 0.44860100746154785
loss_pred:0.014086018316447735, decouple_loss:0.00046018880675546825
Iteration: 2319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707077741622925, gen p mean: -0.11327104270458221, mean p set: 0.44764676690101624
loss_pred:0.0148949408903718, decouple_loss:0.0004511645529419184
The modified gen p mean: 0.44760459661483765, gen p mean: -0.11867593973875046, mean p set: 0.44817930459976196
loss_pred:0.014449842274188995, decouple_loss:0.00039130356162786484
The modified gen p mean: 0.44811877608299255, gen p mean: -0.11448533087968826, mean p set: 0.44869264960289
loss_pred:0.014024144038558006, decouple_loss:0.0003580446064006537
Iteration: 2320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477549195289612, gen p mean: -0.11591598391532898, mean p set: 0.44832831621170044
loss_pred:0.015044533647596836, decouple_loss:0.00043286444270052016
The modified gen p mean: 0.4474584758281708, gen p mean: -0.12063917517662048, mean p set: 0.4480327367782593
loss_pred:0.014309405349195004, decouple_loss:0.00038560008397325873
The modified gen p mean: 0.4481526017189026, gen p mean: -0.11524874716997147, mean p set: 0.44872787594795227
loss_pred:0.013660581782460213, decouple_loss:0.000394002185203135
2023-05-02 12:10:50 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11907534301280975, mean p set: 0.4502691626548767
loss_pred:0.01693803258240223, decouple_loss:0.00034664044505916536
The modified gen p mean: 0.44953542947769165, gen p mean: -0.11270534992218018, mean p set: 0.4500633478164673
loss_pred:0.016282446682453156, decouple_loss:0.00037064930074848235
The modified gen p mean: 0.44983145594596863, gen p mean: -0.1128881499171257, mean p set: 0.45035696029663086
loss_pred:0.016491658985614777, decouple_loss:0.00042287047835998237
WV_1_PC_1_EH_0_PS_40, loss: 0.01658971607685089, avg_mse: 0.025921080261468887
current test mse: 0.025921
Iteration: 2321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44597530364990234, gen p mean: -0.1182781234383583, mean p set: 0.4465501010417938
The modified gen p mean: 0.4472992420196533, gen p mean: -0.11847273260354996, mean p set: 0.4478755593299866
loss_pred:0.014576232992112637, decouple_loss:0.00043318356620147824
loss_pred:0.015070893801748753, decouple_loss:0.0004772217944264412
The modified gen p mean: 0.44631075859069824, gen p mean: -0.11108792573213577, mean p set: 0.44688504934310913
loss_pred:0.013901326805353165, decouple_loss:0.0003824049199465662
Iteration: 2322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472809135913849, gen p mean: -0.11475653946399689, mean p set: 0.44785767793655396
loss_pred:0.015050332993268967, decouple_loss:0.0005349111161194742
The modified gen p mean: 0.44650882482528687, gen p mean: -0.11370418965816498, mean p set: 0.44708362221717834The modified gen p mean: 0.44722166657447815, gen p mean: -0.11194053292274475, mean p set: 0.4477977156639099
loss_pred:0.014256760478019714, decouple_loss:0.0003802264982368797loss_pred:0.014196260832250118, decouple_loss:0.0005613316898234189
Iteration: 2323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44805121421813965, gen p mean: -0.10969991236925125, mean p set: 0.44862768054008484
loss_pred:0.013902426697313786, decouple_loss:0.00043473803089000285
The modified gen p mean: 0.4473755657672882, gen p mean: -0.11622735112905502, mean p set: 0.4479525089263916
loss_pred:0.014494870789349079, decouple_loss:0.00041771080577746034
The modified gen p mean: 0.44785183668136597, gen p mean: -0.11260953545570374, mean p set: 0.44842812418937683
loss_pred:0.014484475366771221, decouple_loss:0.0003568757383618504
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
NaN value num: 0
Iteration: 2324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45120978355407715, gen p mean: -0.10447126626968384, mean p set: 0.4517868459224701
loss_pred:0.015219176188111305, decouple_loss:0.0004811159160453826
The modified gen p mean: 0.451989084482193, gen p mean: -0.11211457848548889, mean p set: 0.4525669813156128
loss_pred:0.015709636732935905, decouple_loss:0.00041629670886322856
The modified gen p mean: 0.4526263475418091, gen p mean: -0.107940673828125, mean p set: 0.45320409536361694
loss_pred:0.01593165099620819, decouple_loss:0.0005561919533647597
Iteration: 2325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45301926136016846, gen p mean: -0.11523588001728058, mean p set: 0.4535945653915405
loss_pred:0.013807011768221855, decouple_loss:0.0003987523668911308
The modified gen p mean: 0.4518928825855255, gen p mean: -0.10662805289030075, mean p set: 0.45247119665145874
loss_pred:0.016550857573747635, decouple_loss:0.0005337857874110341
The modified gen p mean: 0.45235684514045715, gen p mean: -0.1061801090836525, mean p set: 0.4529314935207367
loss_pred:0.014630947262048721, decouple_loss:0.0005151712102815509
Iteration: 2326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522804319858551, gen p mean: -0.10315360128879547, mean p set: 0.45285579562187195
loss_pred:0.016087213531136513, decouple_loss:0.0005043258424848318
The modified gen p mean: 0.45419591665267944, gen p mean: -0.10171201080083847, mean p set: 0.4547733962535858
loss_pred:0.015641000121831894, decouple_loss:0.0005171254160813987
The modified gen p mean: 0.4523331820964813, gen p mean: -0.10026763379573822, mean p set: 0.4529101252555847
loss_pred:0.014545157551765442, decouple_loss:0.0003833366499748081
Iteration: 2327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45258817076683044, gen p mean: -0.09799139201641083, mean p set: 0.4531652331352234
loss_pred:0.015529870055615902, decouple_loss:0.000402618054067716
The modified gen p mean: 0.4536809027194977, gen p mean: -0.09872341901063919, mean p set: 0.45425835251808167
loss_pred:0.015707435086369514, decouple_loss:0.0004035186721011996
The modified gen p mean: 0.45406636595726013, gen p mean: -0.09578298032283783, mean p set: 0.45464417338371277
loss_pred:0.015855446457862854, decouple_loss:0.0005187302595004439
Iteration: 2328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518364369869232, gen p mean: -0.10907094925642014, mean p set: 0.4524134397506714
loss_pred:0.014420089311897755, decouple_loss:0.00042904738802462816
The modified gen p mean: 0.45213600993156433, gen p mean: -0.10317441076040268, mean p set: 0.4527120590209961
loss_pred:0.015495045110583305, decouple_loss:0.0005232327966950834
The modified gen p mean: 0.45400986075401306, gen p mean: -0.10504628717899323, mean p set: 0.45458728075027466
loss_pred:0.015242042019963264, decouple_loss:0.0004934996250085533
Iteration: 2329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45268577337265015, gen p mean: -0.10779280960559845, mean p set: 0.4532618522644043
loss_pred:0.016230696812272072, decouple_loss:0.00047227658797055483
The modified gen p mean: 0.4524886906147003, gen p mean: -0.110723115503788, mean p set: 0.45306530594825745
loss_pred:0.014366288669407368, decouple_loss:0.00046653643948957324
The modified gen p mean: 0.4517923891544342, gen p mean: -0.10799174010753632, mean p set: 0.4523705840110779
loss_pred:0.014979954808950424, decouple_loss:0.00044940441148355603
Iteration: 2330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526754319667816, gen p mean: -0.11050213128328323, mean p set: 0.4532524347305298
loss_pred:0.014996287412941456, decouple_loss:0.0005685025244019926
The modified gen p mean: 0.45124614238739014, gen p mean: -0.10542451590299606, mean p set: 0.4518222510814667
loss_pred:0.015382442623376846, decouple_loss:0.00040901737520471215
The modified gen p mean: 0.452644407749176, gen p mean: -0.11338694393634796, mean p set: 0.45322301983833313
loss_pred:0.014148203656077385, decouple_loss:0.0004819872265215963
2023-05-02 12:13:35 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12519606947898865, mean p set: 0.4502691626548767
loss_pred:0.01696242205798626, decouple_loss:0.00043834577081725
The modified gen p mean: 0.4495348036289215, gen p mean: -0.11864954233169556, mean p set: 0.4500633478164673
loss_pred:0.01634366251528263, decouple_loss:0.0006435500108636916
The modified gen p mean: 0.44983068108558655, gen p mean: -0.11865592002868652, mean p set: 0.45035696029663086
loss_pred:0.016545146703720093, decouple_loss:0.000504512747284025
WV_1_PC_1_EH_0_PS_40, loss: 0.016643516719341278, avg_mse: 0.025963256135582924
current test mse: 0.025963
Iteration: 2331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45240890979766846, gen p mean: -0.11424127221107483, mean p set: 0.4529862403869629
loss_pred:0.014197351410984993, decouple_loss:0.0004992545582354069
The modified gen p mean: 0.45149683952331543, gen p mean: -0.10863271355628967, mean p set: 0.4520712196826935
loss_pred:0.014899928122758865, decouple_loss:0.0003584503137972206
The modified gen p mean: 0.4535416066646576, gen p mean: -0.11879206448793411, mean p set: 0.45411795377731323
loss_pred:0.014024082571268082, decouple_loss:0.00037631794111803174
Iteration: 2332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45151954889297485, gen p mean: -0.12329348921775818, mean p set: 0.4520983099937439
loss_pred:0.01621118374168873, decouple_loss:0.0004871259443461895
The modified gen p mean: 0.4518563747406006, gen p mean: -0.11337003856897354, mean p set: 0.4524330198764801The modified gen p mean: 0.4516964852809906, gen p mean: -0.11924424022436142, mean p set: 0.45227310061454773
loss_pred:0.014597004279494286, decouple_loss:0.00036175610148347914loss_pred:0.01662805676460266, decouple_loss:0.00041495548794046044
Iteration: 2333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45262983441352844, gen p mean: -0.1256333440542221, mean p set: 0.453206866979599
loss_pred:0.013640325516462326, decouple_loss:0.0003625493554864079
The modified gen p mean: 0.4528858959674835, gen p mean: -0.12228818237781525, mean p set: 0.4534636437892914
loss_pred:0.016001418232917786, decouple_loss:0.00042943432345055044
The modified gen p mean: 0.45190685987472534, gen p mean: -0.11906148493289948, mean p set: 0.4524819552898407
loss_pred:0.016099607571959496, decouple_loss:0.0005739229964092374
Iteration: 2334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521443247795105, gen p mean: -0.11741375923156738, mean p set: 0.4527222514152527
loss_pred:0.015362157486379147, decouple_loss:0.0004622958367690444
The modified gen p mean: 0.45244255661964417, gen p mean: -0.11413240432739258, mean p set: 0.4530191123485565
loss_pred:0.01592964679002762, decouple_loss:0.00040150314453057945
The modified gen p mean: 0.45158880949020386, gen p mean: -0.11834661662578583, mean p set: 0.4521646797657013
loss_pred:0.015512249432504177, decouple_loss:0.00034936441807076335
Iteration: 2335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45295584201812744, gen p mean: -0.10697506368160248, mean p set: 0.45353299379348755
loss_pred:0.0160683523863554, decouple_loss:0.00034476674045436084
The modified gen p mean: 0.45315393805503845, gen p mean: -0.11228513717651367, mean p set: 0.45373082160949707
loss_pred:0.014132417738437653, decouple_loss:0.0005048384191468358
The modified gen p mean: 0.45474886894226074, gen p mean: -0.10372769087553024, mean p set: 0.4553252160549164
loss_pred:0.015780165791511536, decouple_loss:0.00041019811760634184
Iteration: 2336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45281311869621277, gen p mean: -0.11831934750080109, mean p set: 0.45338940620422363
loss_pred:0.016022546216845512, decouple_loss:0.00043596039176918566
The modified gen p mean: 0.4524223506450653, gen p mean: -0.11203800141811371, mean p set: 0.4530031979084015
The modified gen p mean: 0.4512520730495453, gen p mean: -0.11117944121360779, mean p set: 0.4518284201622009
loss_pred:0.01615005172789097, decouple_loss:0.0005077266250737011
loss_pred:0.015153096988797188, decouple_loss:0.00038213699008338153
Iteration: 2337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45310431718826294, gen p mean: -0.0969373881816864, mean p set: 0.45368245244026184
loss_pred:0.015570488758385181, decouple_loss:0.0006471038213931024
The modified gen p mean: 0.4530389606952667, gen p mean: -0.10290689021348953, mean p set: 0.45361486077308655
The modified gen p mean: 0.45345258712768555, gen p mean: -0.09836641699075699, mean p set: 0.4540300667285919
loss_pred:0.01431732252240181, decouple_loss:0.0003856162657029927
loss_pred:0.01593681611120701, decouple_loss:0.0005098513211123645
Iteration: 2338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524896740913391, gen p mean: -0.0989910289645195, mean p set: 0.4530657231807709
loss_pred:0.01471261028200388, decouple_loss:0.00037357539986260235
The modified gen p mean: 0.4524152874946594, gen p mean: -0.09874191135168076, mean p set: 0.4529918134212494
The modified gen p mean: 0.45221662521362305, gen p mean: -0.10198597609996796, mean p set: 0.45279404520988464
loss_pred:0.015816228464245796, decouple_loss:0.0004032102006021887
loss_pred:0.01573016121983528, decouple_loss:0.0006123666535131633
Iteration: 2339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520519971847534, gen p mean: -0.10002269595861435, mean p set: 0.45262637734413147
The modified gen p mean: 0.45291396975517273, gen p mean: -0.10350620001554489, mean p set: 0.45349109172821045loss_pred:0.015273000113666058, decouple_loss:0.0004272113728802651
loss_pred:0.015265928581357002, decouple_loss:0.00039971605292521417
The modified gen p mean: 0.45301952958106995, gen p mean: -0.09972865879535675, mean p set: 0.4535960853099823
loss_pred:0.016462359577417374, decouple_loss:0.00048468244494870305
Iteration: 2340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45171019434928894, gen p mean: -0.10963485389947891, mean p set: 0.4522823691368103
loss_pred:0.014624814502894878, decouple_loss:0.0004186263831797987
The modified gen p mean: 0.45322200655937195, gen p mean: -0.11434817314147949, mean p set: 0.4538002610206604
The modified gen p mean: 0.45111727714538574, gen p mean: -0.11053989082574844, mean p set: 0.45169031620025635
loss_pred:0.01511781383305788, decouple_loss:0.0005414835759438574
loss_pred:0.014891709201037884, decouple_loss:0.0004782952310051769
2023-05-02 12:15:41 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12486124783754349, mean p set: 0.4502691626548767
loss_pred:0.01709102839231491, decouple_loss:0.00048613149556331336
The modified gen p mean: 0.44953596591949463, gen p mean: -0.11872240155935287, mean p set: 0.4500633478164673
loss_pred:0.016354920342564583, decouple_loss:0.000517212029080838
The modified gen p mean: 0.4498291015625, gen p mean: -0.11845792084932327, mean p set: 0.45035696029663086
loss_pred:0.016748622059822083, decouple_loss:0.0005238598096184433
WV_1_PC_1_EH_0_PS_40, loss: 0.016756977885961533, avg_mse: 0.026170069351792336
current test mse: 0.02617
Iteration: 2341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531061351299286, gen p mean: -0.11184622347354889, mean p set: 0.4536839425563812
loss_pred:0.015867095440626144, decouple_loss:0.0003418666310608387
The modified gen p mean: 0.45246097445487976, gen p mean: -0.11191102862358093, mean p set: 0.4530394971370697
loss_pred:0.015629131346940994, decouple_loss:0.00039148860378190875
The modified gen p mean: 0.45230749249458313, gen p mean: -0.11373262107372284, mean p set: 0.4528862237930298
loss_pred:0.01518478523939848, decouple_loss:0.0004289860662538558
Iteration: 2342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45200926065444946, gen p mean: -0.1117677241563797, mean p set: 0.45258474349975586
loss_pred:0.015893714502453804, decouple_loss:0.0005726440576836467
The modified gen p mean: 0.4518057405948639, gen p mean: -0.11514950543642044, mean p set: 0.45238441228866577The modified gen p mean: 0.4532932937145233, gen p mean: -0.11309608817100525, mean p set: 0.4538719952106476
loss_pred:0.014717459678649902, decouple_loss:0.000572742719668895
loss_pred:0.01567002944648266, decouple_loss:0.000509540899656713
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
NaN value num: 0
Iteration: 2343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963622093200684, gen p mean: -0.11946218460798264, mean p set: 0.4502132534980774
loss_pred:0.01729571260511875, decouple_loss:0.00045740444329567254
The modified gen p mean: 0.4493348300457001, gen p mean: -0.12084069848060608, mean p set: 0.44991254806518555
The modified gen p mean: 0.4492357671260834, gen p mean: -0.11729121208190918, mean p set: 0.4498090147972107
loss_pred:0.016749117523431778, decouple_loss:0.0004422049387358129
loss_pred:0.017196353524923325, decouple_loss:0.00041773795965127647
Iteration: 2344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45072510838508606, gen p mean: -0.11622261255979538, mean p set: 0.45130112767219543
loss_pred:0.015979934483766556, decouple_loss:0.0005022995756007731
The modified gen p mean: 0.45050081610679626, gen p mean: -0.13051347434520721, mean p set: 0.4510760009288788
loss_pred:0.01565251313149929, decouple_loss:0.0005524748121388257
The modified gen p mean: 0.44932129979133606, gen p mean: -0.1252075731754303, mean p set: 0.449899822473526
loss_pred:0.016048336401581764, decouple_loss:0.000451631989562884
Iteration: 2345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45222413539886475, gen p mean: -0.12622442841529846, mean p set: 0.4527982771396637
loss_pred:0.01665167137980461, decouple_loss:0.00046040743472985923
The modified gen p mean: 0.4511371850967407, gen p mean: -0.12196236848831177, mean p set: 0.4517151117324829
loss_pred:0.016034724190831184, decouple_loss:0.00040732347406446934
The modified gen p mean: 0.4506644010543823, gen p mean: -0.12081479281187057, mean p set: 0.4512418508529663
loss_pred:0.015896642580628395, decouple_loss:0.00044869942939840257
Iteration: 2346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45074692368507385, gen p mean: -0.12622866034507751, mean p set: 0.45132210850715637
loss_pred:0.01634903997182846, decouple_loss:0.0004192176565993577
The modified gen p mean: 0.45165136456489563, gen p mean: -0.12508510053157806, mean p set: 0.4522300362586975
The modified gen p mean: 0.45143643021583557, gen p mean: -0.12625032663345337, mean p set: 0.45201170444488525
loss_pred:0.016756916418671608, decouple_loss:0.00047600592370145023
loss_pred:0.015360096469521523, decouple_loss:0.00042563810711726546
Iteration: 2347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497280716896057, gen p mean: -0.13071584701538086, mean p set: 0.45030614733695984
loss_pred:0.016522038727998734, decouple_loss:0.0004189657629467547
The modified gen p mean: 0.45087119936943054, gen p mean: -0.12988677620887756, mean p set: 0.45144689083099365
The modified gen p mean: 0.4496219754219055, gen p mean: -0.1272413730621338, mean p set: 0.4502009153366089
loss_pred:0.01647895760834217, decouple_loss:0.00046971486881375313
loss_pred:0.016457010060548782, decouple_loss:0.0004964927793480456
Iteration: 2348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45105400681495667, gen p mean: -0.1274273544549942, mean p set: 0.45163068175315857
The modified gen p mean: 0.4517386257648468, gen p mean: -0.13316167891025543, mean p set: 0.45231279730796814loss_pred:0.015914779156446457, decouple_loss:0.0005230667884461582
loss_pred:0.017276426777243614, decouple_loss:0.000478749891044572
The modified gen p mean: 0.4518766701221466, gen p mean: -0.1296921819448471, mean p set: 0.4524562954902649
loss_pred:0.015550105832517147, decouple_loss:0.0003469423099886626
Iteration: 2349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505440890789032, gen p mean: -0.1359645426273346, mean p set: 0.4511202275753021
loss_pred:0.015767313539981842, decouple_loss:0.0005414080806076527
The modified gen p mean: 0.45134249329566956, gen p mean: -0.12542471289634705, mean p set: 0.4519175887107849
The modified gen p mean: 0.44934824109077454, gen p mean: -0.1294102966785431, mean p set: 0.44992515444755554
loss_pred:0.01562764309346676, decouple_loss:0.00044892699224874377
loss_pred:0.0162523090839386, decouple_loss:0.0003695166378747672
Iteration: 2350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45139482617378235, gen p mean: -0.12333135306835175, mean p set: 0.4519709050655365
loss_pred:0.015963131561875343, decouple_loss:0.0005348144331946969
The modified gen p mean: 0.44977158308029175, gen p mean: -0.12501738965511322, mean p set: 0.45034801959991455
loss_pred:0.01594066433608532, decouple_loss:0.0005044598365202546
The modified gen p mean: 0.45028743147850037, gen p mean: -0.12949912250041962, mean p set: 0.45086249709129333
loss_pred:0.015389643609523773, decouple_loss:0.000508223834913224
2023-05-02 12:18:24 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13121531903743744, mean p set: 0.4502691626548767
loss_pred:0.016990359872579575, decouple_loss:0.0004946884582750499
The modified gen p mean: 0.4498300552368164, gen p mean: -0.12388782203197479, mean p set: 0.45035696029663086
The modified gen p mean: 0.44953784346580505, gen p mean: -0.1237323209643364, mean p set: 0.4500633478164673
loss_pred:0.01659258082509041, decouple_loss:0.0005568700144067407
loss_pred:0.01628042384982109, decouple_loss:0.0004313992103561759
WV_1_PC_1_EH_0_PS_40, loss: 0.01664583757519722, avg_mse: 0.025878246873617172
current test mse: 0.025878
Iteration: 2351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45132142305374146, gen p mean: -0.11625663936138153, mean p set: 0.45189735293388367
The modified gen p mean: 0.4524511694908142, gen p mean: -0.11732849478721619, mean p set: 0.45303085446357727
loss_pred:0.017071226611733437, decouple_loss:0.00044631678611040115
loss_pred:0.015563762746751308, decouple_loss:0.00048807356506586075
The modified gen p mean: 0.4517790675163269, gen p mean: -0.12208676338195801, mean p set: 0.4523555636405945
loss_pred:0.014957412146031857, decouple_loss:0.0005502004059962928
Iteration: 2352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997143745422363, gen p mean: -0.12304379045963287, mean p set: 0.4505466818809509
The modified gen p mean: 0.451781302690506, gen p mean: -0.11653406918048859, mean p set: 0.452357679605484
loss_pred:0.015971265733242035, decouple_loss:0.00032116734655573964
loss_pred:0.015224914997816086, decouple_loss:0.0006022041197866201
The modified gen p mean: 0.45259466767311096, gen p mean: -0.1157936379313469, mean p set: 0.45317062735557556
loss_pred:0.016314422711730003, decouple_loss:0.00036847914452664554
Iteration: 2353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511203467845917, gen p mean: -0.11531315743923187, mean p set: 0.4516952931880951
loss_pred:0.01549617014825344, decouple_loss:0.0005093318177387118
The modified gen p mean: 0.45068731904029846, gen p mean: -0.1196134015917778, mean p set: 0.4512638449668884
loss_pred:0.01541861705482006, decouple_loss:0.0004936858895234764
The modified gen p mean: 0.450006902217865, gen p mean: -0.11909019947052002, mean p set: 0.45058155059814453
loss_pred:0.015872491523623466, decouple_loss:0.0003178340557496995
Iteration: 2354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45026740431785583, gen p mean: -0.12385496497154236, mean p set: 0.4508419334888458
loss_pred:0.016093356534838676, decouple_loss:0.00037333002546802163
The modified gen p mean: 0.4518290162086487, gen p mean: -0.12160994857549667, mean p set: 0.4524042010307312
loss_pred:0.014850638806819916, decouple_loss:0.00045473131467588246
The modified gen p mean: 0.45070844888687134, gen p mean: -0.12072476744651794, mean p set: 0.4512876868247986
loss_pred:0.016178026795387268, decouple_loss:0.00041254624375142157
Iteration: 2355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44959816336631775, gen p mean: -0.11761865019798279, mean p set: 0.450173020362854
The modified gen p mean: 0.44973528385162354, gen p mean: -0.12278633564710617, mean p set: 0.45031243562698364loss_pred:0.01611068844795227, decouple_loss:0.00034492326085455716
loss_pred:0.01574980840086937, decouple_loss:0.00042816231143660843
The modified gen p mean: 0.44994691014289856, gen p mean: -0.12326544523239136, mean p set: 0.45052459836006165
loss_pred:0.015652254223823547, decouple_loss:0.00046931812539696693
Iteration: 2356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502292275428772, gen p mean: -0.11945042014122009, mean p set: 0.4508068561553955
loss_pred:0.016249576583504677, decouple_loss:0.00047550289309583604
The modified gen p mean: 0.45201271772384644, gen p mean: -0.12171484529972076, mean p set: 0.45258599519729614
The modified gen p mean: 0.45075568556785583, gen p mean: -0.11620135605335236, mean p set: 0.45133206248283386
loss_pred:0.016325389966368675, decouple_loss:0.00040729643660597503
loss_pred:0.016228344291448593, decouple_loss:0.0004245872260071337
Iteration: 2357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501732289791107, gen p mean: -0.12321852147579193, mean p set: 0.45074760913848877
loss_pred:0.016041263937950134, decouple_loss:0.0006550280377268791
The modified gen p mean: 0.45073625445365906, gen p mean: -0.11788658052682877, mean p set: 0.45131561160087585
The modified gen p mean: 0.45118558406829834, gen p mean: -0.1185338944196701, mean p set: 0.4517611861228943
loss_pred:0.01531913224607706, decouple_loss:0.00040366602479480207
loss_pred:0.015981361269950867, decouple_loss:0.0005312706925906241
Iteration: 2358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45224061608314514, gen p mean: -0.1238650232553482, mean p set: 0.45281848311424255
loss_pred:0.014908679760992527, decouple_loss:0.0005158801795914769
The modified gen p mean: 0.4508584141731262, gen p mean: -0.12227392941713333, mean p set: 0.45143812894821167
The modified gen p mean: 0.45143675804138184, gen p mean: -0.12244655191898346, mean p set: 0.4520154595375061
loss_pred:0.016213171184062958, decouple_loss:0.0003825453750323504
loss_pred:0.015585568733513355, decouple_loss:0.0004075306933373213
Iteration: 2359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45120781660079956, gen p mean: -0.12281502783298492, mean p set: 0.45178699493408203
loss_pred:0.01610284112393856, decouple_loss:0.0003711837634909898
The modified gen p mean: 0.45002973079681396, gen p mean: -0.12826544046401978, mean p set: 0.45060768723487854
loss_pred:0.015936333686113358, decouple_loss:0.0005447717849165201
The modified gen p mean: 0.44951385259628296, gen p mean: -0.12968461215496063, mean p set: 0.4500918984413147
loss_pred:0.016319962218403816, decouple_loss:0.0004332589451223612
Iteration: 2360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45199814438819885, gen p mean: -0.12078960239887238, mean p set: 0.45257672667503357
loss_pred:0.014958619140088558, decouple_loss:0.00044595045619644225
The modified gen p mean: 0.4507142901420593, gen p mean: -0.12649628520011902, mean p set: 0.4512922167778015
The modified gen p mean: 0.45163023471832275, gen p mean: -0.1222921833395958, mean p set: 0.4522075653076172
loss_pred:0.015930168330669403, decouple_loss:0.00044033440644852817
loss_pred:0.015576236881315708, decouple_loss:0.000567399722058326
2023-05-02 12:20:30 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13574102520942688, mean p set: 0.4502691626548767
loss_pred:0.017025906592607498, decouple_loss:0.000448397797299549
The modified gen p mean: 0.44953393936157227, gen p mean: -0.12842407822608948, mean p set: 0.4500633478164673
loss_pred:0.0163101963698864, decouple_loss:0.0007188546005636454
The modified gen p mean: 0.4498296082019806, gen p mean: -0.12798258662223816, mean p set: 0.45035696029663086
loss_pred:0.016497164964675903, decouple_loss:0.0007484570960514247
WV_1_PC_1_EH_0_PS_40, loss: 0.016643017530441284, avg_mse: 0.025857092812657356
current test mse: 0.025857
Iteration: 2361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45063817501068115, gen p mean: -0.12622928619384766, mean p set: 0.4512137174606323
loss_pred:0.015974881127476692, decouple_loss:0.0006205562967807055
The modified gen p mean: 0.44961848855018616, gen p mean: -0.12656772136688232, mean p set: 0.4501960873603821
loss_pred:0.015656329691410065, decouple_loss:0.00044389607501216233
The modified gen p mean: 0.44955694675445557, gen p mean: -0.12480408698320389, mean p set: 0.45013299584388733
loss_pred:0.015574556775391102, decouple_loss:0.0004207093734294176
Iteration: 2362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45074552297592163, gen p mean: -0.11666788905858994, mean p set: 0.451321005821228
loss_pred:0.015714915469288826, decouple_loss:0.0006080628954805434
The modified gen p mean: 0.4508688151836395, gen p mean: -0.11861445009708405, mean p set: 0.4514442980289459The modified gen p mean: 0.45000478625297546, gen p mean: -0.12285208702087402, mean p set: 0.45058050751686096
loss_pred:0.015488112345337868, decouple_loss:0.00044945499394088984
loss_pred:0.016025660559535027, decouple_loss:0.000369349610991776
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
NaN value num: 0
Iteration: 2363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472545087337494, gen p mean: -0.1256485879421234, mean p set: 0.44783106446266174
loss_pred:0.015130454674363136, decouple_loss:0.00046221609227359295
The modified gen p mean: 0.445587694644928, gen p mean: -0.13005419075489044, mean p set: 0.4461626410484314
loss_pred:0.015299483202397823, decouple_loss:0.0005449179443530738
The modified gen p mean: 0.4471660554409027, gen p mean: -0.13064445555210114, mean p set: 0.4477405250072479
loss_pred:0.01514857541769743, decouple_loss:0.0003320376854389906
Iteration: 2364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469381272792816, gen p mean: -0.1285317987203598, mean p set: 0.4475148916244507
loss_pred:0.015066035091876984, decouple_loss:0.0004353071271907538
The modified gen p mean: 0.44749534130096436, gen p mean: -0.11893025785684586, mean p set: 0.44807007908821106
loss_pred:0.015464487485587597, decouple_loss:0.0005399813526310027
The modified gen p mean: 0.44831138849258423, gen p mean: -0.126918762922287, mean p set: 0.4488895833492279
loss_pred:0.015414871275424957, decouple_loss:0.0006425991305150092
Iteration: 2365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44606277346611023, gen p mean: -0.12140639126300812, mean p set: 0.44663766026496887
loss_pred:0.015586775727570057, decouple_loss:0.00046843860764056444
The modified gen p mean: 0.44548746943473816, gen p mean: -0.12119560688734055, mean p set: 0.44606053829193115
loss_pred:0.015778979286551476, decouple_loss:0.0004362512845546007
The modified gen p mean: 0.4460639953613281, gen p mean: -0.11857597529888153, mean p set: 0.4466399550437927
loss_pred:0.015753116458654404, decouple_loss:0.0005590641521848738
Iteration: 2366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460925757884979, gen p mean: -0.12060736119747162, mean p set: 0.4466695487499237
loss_pred:0.01602664776146412, decouple_loss:0.0005415939376689494
The modified gen p mean: 0.4474533498287201, gen p mean: -0.11525407433509827, mean p set: 0.44803011417388916
The modified gen p mean: 0.4464397132396698, gen p mean: -0.12051475793123245, mean p set: 0.44701457023620605
loss_pred:0.01666451245546341, decouple_loss:0.0006486180936917663
loss_pred:0.016098102554678917, decouple_loss:0.00041985540883615613
Iteration: 2367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729673862457275, gen p mean: -0.12039884179830551, mean p set: 0.4478742182254791
loss_pred:0.01595512218773365, decouple_loss:0.000598088139668107
The modified gen p mean: 0.4493318498134613, gen p mean: -0.12563928961753845, mean p set: 0.44990822672843933
The modified gen p mean: 0.44719210267066956, gen p mean: -0.11701782047748566, mean p set: 0.4477635622024536
loss_pred:0.01587705872952938, decouple_loss:0.0005570754292421043
loss_pred:0.015117285773158073, decouple_loss:0.0003786282322835177
Iteration: 2368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447217732667923, gen p mean: -0.11776423454284668, mean p set: 0.44779494404792786
loss_pred:0.01576589047908783, decouple_loss:0.000510017853230238
The modified gen p mean: 0.4461292326450348, gen p mean: -0.12262088060379028, mean p set: 0.44670340418815613
The modified gen p mean: 0.4474332928657532, gen p mean: -0.11633797734975815, mean p set: 0.4480101466178894
loss_pred:0.015726177021861076, decouple_loss:0.0005669703823514283
loss_pred:0.014976777136325836, decouple_loss:0.00059535913169384
Iteration: 2369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44748175144195557, gen p mean: -0.11805389821529388, mean p set: 0.44805875420570374
loss_pred:0.015095788985490799, decouple_loss:0.00045040404074825346
The modified gen p mean: 0.4479552209377289, gen p mean: -0.11437125504016876, mean p set: 0.4485294818878174
The modified gen p mean: 0.44689685106277466, gen p mean: -0.12293124198913574, mean p set: 0.4474751055240631
loss_pred:0.01591130532324314, decouple_loss:0.0005641967873089015
loss_pred:0.01538949552923441, decouple_loss:0.0005690003163181245
Iteration: 2370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468526840209961, gen p mean: -0.11132308095693588, mean p set: 0.44742998480796814
loss_pred:0.016545061022043228, decouple_loss:0.00046455240226350725
The modified gen p mean: 0.448956698179245, gen p mean: -0.1253758817911148, mean p set: 0.44953420758247375
loss_pred:0.015715545043349266, decouple_loss:0.0004996155621483922
The modified gen p mean: 0.44636255502700806, gen p mean: -0.12062298506498337, mean p set: 0.4469371736049652
loss_pred:0.01574910804629326, decouple_loss:0.00040795901441015303
2023-05-02 12:23:15 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.127717524766922, mean p set: 0.4502691626548767
loss_pred:0.01687583141028881, decouple_loss:0.0005022553377784789
The modified gen p mean: 0.44953301548957825, gen p mean: -0.12072566151618958, mean p set: 0.4500633478164673
loss_pred:0.016140786930918694, decouple_loss:0.0003724748094100505
The modified gen p mean: 0.4498273730278015, gen p mean: -0.12016002833843231, mean p set: 0.45035696029663086
loss_pred:0.016369324177503586, decouple_loss:0.0003534814459271729
WV_1_PC_1_EH_0_PS_40, loss: 0.016482451930642128, avg_mse: 0.025723395869135857
current test mse: 0.025723
Iteration: 2371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473094940185547, gen p mean: -0.12525352835655212, mean p set: 0.44788476824760437
loss_pred:0.014888572506606579, decouple_loss:0.00046520194155164063
The modified gen p mean: 0.44699323177337646, gen p mean: -0.12903869152069092, mean p set: 0.447569340467453The modified gen p mean: 0.4470440149307251, gen p mean: -0.12190258502960205, mean p set: 0.44762122631073
loss_pred:0.015800582244992256, decouple_loss:0.00037638680078089237loss_pred:0.015115478076040745, decouple_loss:0.0005360548966564238
Iteration: 2372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473241865634918, gen p mean: -0.11998411267995834, mean p set: 0.4478980302810669
loss_pred:0.015302538871765137, decouple_loss:0.0006732515757903457
The modified gen p mean: 0.4470386207103729, gen p mean: -0.1264561116695404, mean p set: 0.4476166069507599The modified gen p mean: 0.44666123390197754, gen p mean: -0.12484423071146011, mean p set: 0.44723597168922424
loss_pred:0.015408598817884922, decouple_loss:0.0007216149242594838loss_pred:0.01598752848803997, decouple_loss:0.0005364820244722068
Iteration: 2373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708144664764404, gen p mean: -0.1209307461977005, mean p set: 0.44765612483024597
loss_pred:0.015584846958518028, decouple_loss:0.0005351356230676174
The modified gen p mean: 0.4475085437297821, gen p mean: -0.12295986711978912, mean p set: 0.44808676838874817
loss_pred:0.0154455890879035, decouple_loss:0.0004300160217098892
The modified gen p mean: 0.4476293921470642, gen p mean: -0.11977356672286987, mean p set: 0.44820722937583923
loss_pred:0.015861451625823975, decouple_loss:0.0005535904783755541
Iteration: 2374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757530093193054, gen p mean: -0.1215110719203949, mean p set: 0.448152095079422
loss_pred:0.014999225735664368, decouple_loss:0.0003503689367789775
The modified gen p mean: 0.4483739733695984, gen p mean: -0.11618325859308243, mean p set: 0.4489504396915436
loss_pred:0.015779869630932808, decouple_loss:0.00033904530573636293
The modified gen p mean: 0.44714194536209106, gen p mean: -0.11450425535440445, mean p set: 0.4477180242538452
loss_pred:0.01578538306057453, decouple_loss:0.0003422996087465435
Iteration: 2375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711387157440186, gen p mean: -0.11680193990468979, mean p set: 0.44769227504730225
loss_pred:0.015262719243764877, decouple_loss:0.0007257223478518426
The modified gen p mean: 0.4466162323951721, gen p mean: -0.11952442675828934, mean p set: 0.44719216227531433
loss_pred:0.0157096516340971, decouple_loss:0.0005366973928175867
The modified gen p mean: 0.4471394121646881, gen p mean: -0.11646205186843872, mean p set: 0.4477160573005676
loss_pred:0.015476911328732967, decouple_loss:0.0006564616924151778
Iteration: 2376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470537602901459, gen p mean: -0.11401653289794922, mean p set: 0.44762900471687317
loss_pred:0.014547465369105339, decouple_loss:0.0003637303307186812
The modified gen p mean: 0.447227418422699, gen p mean: -0.11919532716274261, mean p set: 0.44780099391937256
The modified gen p mean: 0.4462994337081909, gen p mean: -0.11791017651557922, mean p set: 0.4468752145767212
loss_pred:0.01541175227612257, decouple_loss:0.0006530897808261216
loss_pred:0.015270233154296875, decouple_loss:0.0006068479851819575
Iteration: 2377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729939103126526, gen p mean: -0.11644759029150009, mean p set: 0.4478749930858612
loss_pred:0.015435981564223766, decouple_loss:0.0003791837370954454
The modified gen p mean: 0.4476296305656433, gen p mean: -0.12275606393814087, mean p set: 0.44820359349250793
loss_pred:0.015005811117589474, decouple_loss:0.00045628851512447
The modified gen p mean: 0.4477959871292114, gen p mean: -0.1202351376414299, mean p set: 0.448373407125473
loss_pred:0.01498471200466156, decouple_loss:0.0005064213182777166
Iteration: 2378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471994638442993, gen p mean: -0.11758477985858917, mean p set: 0.44777578115463257
loss_pred:0.015521793626248837, decouple_loss:0.0004316380654927343
The modified gen p mean: 0.4468455910682678, gen p mean: -0.1245281994342804, mean p set: 0.4474208950996399
The modified gen p mean: 0.4469682574272156, gen p mean: -0.10836069285869598, mean p set: 0.447546124458313
loss_pred:0.015138499438762665, decouple_loss:0.0004250708152540028
loss_pred:0.016388239338994026, decouple_loss:0.00035722641041502357
Iteration: 2379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761911034584045, gen p mean: -0.11155927926301956, mean p set: 0.4481947124004364
loss_pred:0.015743602067232132, decouple_loss:0.0005433582700788975
The modified gen p mean: 0.4468543827533722, gen p mean: -0.11527903378009796, mean p set: 0.44742920994758606
The modified gen p mean: 0.44689369201660156, gen p mean: -0.1191885694861412, mean p set: 0.44746798276901245
loss_pred:0.015470795333385468, decouple_loss:0.0004435240989550948
loss_pred:0.015729643404483795, decouple_loss:0.0004605635767802596
Iteration: 2380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475856423377991, gen p mean: -0.11491694301366806, mean p set: 0.448160856962204
loss_pred:0.01590009033679962, decouple_loss:0.00047053268644958735
The modified gen p mean: 0.44585633277893066, gen p mean: -0.11629978567361832, mean p set: 0.4464336037635803
The modified gen p mean: 0.44730010628700256, gen p mean: -0.11797132343053818, mean p set: 0.4478749632835388
loss_pred:0.015338484197854996, decouple_loss:0.000601483799982816
loss_pred:0.015514139086008072, decouple_loss:0.0006156605086289346
2023-05-02 12:25:21 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1238284558057785, mean p set: 0.4502691626548767
loss_pred:0.01690833270549774, decouple_loss:0.0003709215088747442
The modified gen p mean: 0.4495355784893036, gen p mean: -0.11771708726882935, mean p set: 0.4500633478164673
loss_pred:0.016243979334831238, decouple_loss:0.00038520272937603295
The modified gen p mean: 0.44982749223709106, gen p mean: -0.11723841726779938, mean p set: 0.45035696029663086
loss_pred:0.01640627533197403, decouple_loss:0.00039828597800806165
WV_1_PC_1_EH_0_PS_40, loss: 0.016538769006729126, avg_mse: 0.02585308812558651
current test mse: 0.025853
Iteration: 2381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467127323150635, gen p mean: -0.1223025768995285, mean p set: 0.44729119539260864
loss_pred:0.015314891003072262, decouple_loss:0.00043461189488880336
The modified gen p mean: 0.44839030504226685, gen p mean: -0.12375214695930481, mean p set: 0.44896718859672546The modified gen p mean: 0.44642215967178345, gen p mean: -0.11802909523248672, mean p set: 0.44699984788894653
loss_pred:0.01593414507806301, decouple_loss:0.00038690707879140973loss_pred:0.015753263607621193, decouple_loss:0.0005330391577444971
Iteration: 2382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44626593589782715, gen p mean: -0.12255983054637909, mean p set: 0.4468367099761963
The modified gen p mean: 0.44776710867881775, gen p mean: -0.11867652833461761, mean p set: 0.44834375381469727
loss_pred:0.015608610585331917, decouple_loss:0.0004191820917185396
loss_pred:0.016103046014904976, decouple_loss:0.00035958245280198753
The modified gen p mean: 0.4465196132659912, gen p mean: -0.1230296641588211, mean p set: 0.44709208607673645
loss_pred:0.015360522083938122, decouple_loss:0.0004799185262527317
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 2383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44613152742385864, gen p mean: -0.12358079850673676, mean p set: 0.4467087388038635
loss_pred:0.015796732157468796, decouple_loss:0.0003759090031962842
The modified gen p mean: 0.44661587476730347, gen p mean: -0.12702856957912445, mean p set: 0.4471932351589203
The modified gen p mean: 0.4458583891391754, gen p mean: -0.12662506103515625, mean p set: 0.44643494486808777
loss_pred:0.01633642613887787, decouple_loss:0.0004889986012130976
loss_pred:0.015417282469570637, decouple_loss:0.0003766046720556915
Iteration: 2384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479367136955261, gen p mean: -0.12887373566627502, mean p set: 0.44851207733154297
loss_pred:0.015201400965452194, decouple_loss:0.0003710416494868696
The modified gen p mean: 0.4453867971897125, gen p mean: -0.13100317120552063, mean p set: 0.44596222043037415
loss_pred:0.01543907355517149, decouple_loss:0.0004470706917345524
The modified gen p mean: 0.44613781571388245, gen p mean: -0.12266796827316284, mean p set: 0.44671353697776794
loss_pred:0.015736447647213936, decouple_loss:0.0004011357668787241
Iteration: 2385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464365541934967, gen p mean: -0.12334920465946198, mean p set: 0.4470142424106598
loss_pred:0.015202243812382221, decouple_loss:0.0003808341862168163
The modified gen p mean: 0.4464055299758911, gen p mean: -0.12915322184562683, mean p set: 0.4469846189022064
loss_pred:0.01623339205980301, decouple_loss:0.0003237987111788243
The modified gen p mean: 0.4460972547531128, gen p mean: -0.12696002423763275, mean p set: 0.44667407870292664
loss_pred:0.01608538068830967, decouple_loss:0.0003211944131180644
Iteration: 2386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463967978954315, gen p mean: -0.12882724404335022, mean p set: 0.4469722807407379
loss_pred:0.015388641506433487, decouple_loss:0.0004498120688367635
The modified gen p mean: 0.44550296664237976, gen p mean: -0.13130518794059753, mean p set: 0.4460800588130951
loss_pred:0.015193944796919823, decouple_loss:0.00039576509152539074
The modified gen p mean: 0.44573792815208435, gen p mean: -0.12491008639335632, mean p set: 0.4463140368461609
loss_pred:0.015469553880393505, decouple_loss:0.00037549802800640464
Iteration: 2387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44621914625167847, gen p mean: -0.12939243018627167, mean p set: 0.44679760932922363
loss_pred:0.01612655073404312, decouple_loss:0.0003255467745475471
The modified gen p mean: 0.4465300142765045, gen p mean: -0.12556125223636627, mean p set: 0.447105348110199
loss_pred:0.015583742409944534, decouple_loss:0.00042200516327284276
The modified gen p mean: 0.4474122226238251, gen p mean: -0.12795355916023254, mean p set: 0.44799020886421204
loss_pred:0.01510096900165081, decouple_loss:0.00041864928789436817
Iteration: 2388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468736946582794, gen p mean: -0.12432563304901123, mean p set: 0.44744786620140076
loss_pred:0.015731969848275185, decouple_loss:0.00035035956534557045
The modified gen p mean: 0.44731032848358154, gen p mean: -0.1278713196516037, mean p set: 0.44788745045661926
loss_pred:0.015943968668580055, decouple_loss:0.0004621681000571698
The modified gen p mean: 0.44740983843803406, gen p mean: -0.12946321070194244, mean p set: 0.4479850232601166
loss_pred:0.015868032351136208, decouple_loss:0.0003151862183585763
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466627836227417, gen p mean: -0.12022902816534042, mean p set: 0.4472399353981018
loss_pred:0.01572754606604576, decouple_loss:0.0005382837262004614
The modified gen p mean: 0.44519710540771484, gen p mean: -0.1292267143726349, mean p set: 0.4457741975784302
The modified gen p mean: 0.44637489318847656, gen p mean: -0.12779013812541962, mean p set: 0.44695183634757996
loss_pred:0.015232293866574764, decouple_loss:0.00042422403930686414
loss_pred:0.015666751191020012, decouple_loss:0.00036885167355649173
Iteration: 2390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795656204223633, gen p mean: -0.1249009221792221, mean p set: 0.448532372713089
loss_pred:0.015489227138459682, decouple_loss:0.00037786090979352593
The modified gen p mean: 0.4475247263908386, gen p mean: -0.12736663222312927, mean p set: 0.4480991065502167
The modified gen p mean: 0.4459747076034546, gen p mean: -0.12450190633535385, mean p set: 0.44655176997184753
loss_pred:0.015504280105233192, decouple_loss:0.000369679561117664
loss_pred:0.015838565304875374, decouple_loss:0.00035869781277142465
2023-05-02 12:28:11 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12798818945884705, mean p set: 0.4502691626548767
loss_pred:0.016837533563375473, decouple_loss:0.00034088926622644067
The modified gen p mean: 0.4495333433151245, gen p mean: -0.12167337536811829, mean p set: 0.4500633478164673
loss_pred:0.01618262566626072, decouple_loss:0.000373711867723614
The modified gen p mean: 0.4498288333415985, gen p mean: -0.12153276801109314, mean p set: 0.45035696029663086
loss_pred:0.01645665615797043, decouple_loss:0.0004230471095070243
WV_1_PC_1_EH_0_PS_40, loss: 0.016511231660842896, avg_mse: 0.025752857327461243
current test mse: 0.025753
Iteration: 2391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660502672195435, gen p mean: -0.1269383430480957, mean p set: 0.4471801817417145
loss_pred:0.01608528010547161, decouple_loss:0.00046411907533183694
The modified gen p mean: 0.44635480642318726, gen p mean: -0.12330833822488785, mean p set: 0.4469307065010071
loss_pred:0.016348794102668762, decouple_loss:0.00038389131077565253
The modified gen p mean: 0.44580551981925964, gen p mean: -0.12498236447572708, mean p set: 0.4463808834552765
loss_pred:0.015391227789223194, decouple_loss:0.00038322218460962176
Iteration: 2392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715848565101624, gen p mean: -0.12213815003633499, mean p set: 0.447732150554657
The modified gen p mean: 0.44718360900878906, gen p mean: -0.1256336122751236, mean p set: 0.44775912165641785
loss_pred:0.015344955027103424, decouple_loss:0.0003455747209955007
loss_pred:0.01584550552070141, decouple_loss:0.00032666430342942476
The modified gen p mean: 0.44784489274024963, gen p mean: -0.12382815033197403, mean p set: 0.4484235644340515
loss_pred:0.015107200480997562, decouple_loss:0.0003616836329456419
Iteration: 2393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448313444852829, gen p mean: -0.12415368854999542, mean p set: 0.44888943433761597
The modified gen p mean: 0.4455864727497101, gen p mean: -0.11987804621458054, mean p set: 0.44616246223449707
loss_pred:0.01536373421549797, decouple_loss:0.00030336278723552823
loss_pred:0.01572076790034771, decouple_loss:0.00031889163074083626
The modified gen p mean: 0.44635534286499023, gen p mean: -0.12523747980594635, mean p set: 0.44692856073379517
loss_pred:0.0150659941136837, decouple_loss:0.00030831480398774147
Iteration: 2394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44636648893356323, gen p mean: -0.12236915528774261, mean p set: 0.4469420909881592
loss_pred:0.01560472883284092, decouple_loss:0.00029966197325848043
The modified gen p mean: 0.4479224979877472, gen p mean: -0.12210951745510101, mean p set: 0.4484979510307312
loss_pred:0.01585950329899788, decouple_loss:0.0003210213326383382
The modified gen p mean: 0.44768840074539185, gen p mean: -0.12390516698360443, mean p set: 0.4482622444629669
loss_pred:0.01564304158091545, decouple_loss:0.00029087564325891435
Iteration: 2395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464491903781891, gen p mean: -0.12056450545787811, mean p set: 0.44702646136283875
loss_pred:0.015023414976894855, decouple_loss:0.0003287375729996711
The modified gen p mean: 0.44646942615509033, gen p mean: -0.12616360187530518, mean p set: 0.44704657793045044
loss_pred:0.015711326152086258, decouple_loss:0.00040017388528212905
The modified gen p mean: 0.4466829299926758, gen p mean: -0.12303967773914337, mean p set: 0.44725537300109863
loss_pred:0.015166876837611198, decouple_loss:0.00037746955058537424
Iteration: 2396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465564787387848, gen p mean: -0.1239723339676857, mean p set: 0.44713470339775085
loss_pred:0.01568772830069065, decouple_loss:0.00034670537570491433
The modified gen p mean: 0.4456629753112793, gen p mean: -0.12590186297893524, mean p set: 0.4462362825870514
The modified gen p mean: 0.44774946570396423, gen p mean: -0.12133833020925522, mean p set: 0.448323518037796
loss_pred:0.014886981807649136, decouple_loss:0.0003780350089073181
loss_pred:0.015541011467576027, decouple_loss:0.00036232973798178136
Iteration: 2397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461207687854767, gen p mean: -0.12092992663383484, mean p set: 0.44669607281684875
loss_pred:0.014884132891893387, decouple_loss:0.00039111540536396205
The modified gen p mean: 0.4469413459300995, gen p mean: -0.12590287625789642, mean p set: 0.44751712679862976
loss_pred:0.015785925090312958, decouple_loss:0.00038357629091478884
The modified gen p mean: 0.44733887910842896, gen p mean: -0.12295986711978912, mean p set: 0.447918564081192
loss_pred:0.014740264043211937, decouple_loss:0.0004960657679475844
Iteration: 2398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729799032211304, gen p mean: -0.11996912211179733, mean p set: 0.44787484407424927
loss_pred:0.01496214885264635, decouple_loss:0.0003462077002041042
The modified gen p mean: 0.44644153118133545, gen p mean: -0.12647482752799988, mean p set: 0.4470173120498657
The modified gen p mean: 0.4467349052429199, gen p mean: -0.12335072457790375, mean p set: 0.4473114311695099
loss_pred:0.015242655761539936, decouple_loss:0.0003055107081308961
loss_pred:0.014593194238841534, decouple_loss:0.00029587402241304517
Iteration: 2399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44582730531692505, gen p mean: -0.1208331361413002, mean p set: 0.4464031159877777
loss_pred:0.015077732503414154, decouple_loss:0.0002803959068842232
The modified gen p mean: 0.44574132561683655, gen p mean: -0.12823154032230377, mean p set: 0.44631776213645935
loss_pred:0.014928041957318783, decouple_loss:0.0005026529543101788
The modified gen p mean: 0.44709324836730957, gen p mean: -0.12246182560920715, mean p set: 0.44766902923583984
loss_pred:0.015277926810085773, decouple_loss:0.00040721773984842
Iteration: 2400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680336117744446, gen p mean: -0.12274563312530518, mean p set: 0.44737792015075684
loss_pred:0.015157285146415234, decouple_loss:0.0003294155467301607
The modified gen p mean: 0.4475221037864685, gen p mean: -0.12380542606115341, mean p set: 0.44809842109680176
The modified gen p mean: 0.44592225551605225, gen p mean: -0.12482650578022003, mean p set: 0.4465000033378601
loss_pred:0.015531434677541256, decouple_loss:0.0003268571163062006
loss_pred:0.014865446835756302, decouple_loss:0.00037120276829227805
2023-05-02 12:30:18 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12758010625839233, mean p set: 0.4502691626548767
loss_pred:0.01685008779168129, decouple_loss:0.00041411828715354204
The modified gen p mean: 0.44953563809394836, gen p mean: -0.12051599472761154, mean p set: 0.4500633478164673
loss_pred:0.016189800575375557, decouple_loss:0.00035011660656891763
The modified gen p mean: 0.44982898235321045, gen p mean: -0.12055843323469162, mean p set: 0.45035696029663086
loss_pred:0.016401801258325577, decouple_loss:0.00033522830926813185
WV_1_PC_1_EH_0_PS_40, loss: 0.01649888977408409, avg_mse: 0.025829771533608437
current test mse: 0.02583
Iteration: 2401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44596102833747864, gen p mean: -0.12112214416265488, mean p set: 0.44653645157814026
loss_pred:0.014445310458540916, decouple_loss:0.0003829152847174555
The modified gen p mean: 0.4464738070964813, gen p mean: -0.12282765656709671, mean p set: 0.4470498263835907The modified gen p mean: 0.44582563638687134, gen p mean: -0.12481622397899628, mean p set: 0.44640329480171204
loss_pred:0.014574133791029453, decouple_loss:0.0003375139203853905
loss_pred:0.015586908906698227, decouple_loss:0.00030519530992023647
Iteration: 2402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475550949573517, gen p mean: -0.12151746451854706, mean p set: 0.44813206791877747
loss_pred:0.015497172251343727, decouple_loss:0.00039128988282755017
The modified gen p mean: 0.4475027918815613, gen p mean: -0.12154521048069, mean p set: 0.44807806611061096The modified gen p mean: 0.4461471736431122, gen p mean: -0.12046001851558685, mean p set: 0.4467202425003052
loss_pred:0.0157608725130558, decouple_loss:0.0003554777358658612
loss_pred:0.015286744572222233, decouple_loss:0.00037813858943991363
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
NaN value num: 0
Iteration: 2403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508465528488159, gen p mean: -0.10911218822002411, mean p set: 0.4514252245426178
loss_pred:0.01579655334353447, decouple_loss:0.00034110824344679713
The modified gen p mean: 0.45161300897598267, gen p mean: -0.10737495869398117, mean p set: 0.45218998193740845
loss_pred:0.016103265807032585, decouple_loss:0.0003570246044546366
The modified gen p mean: 0.45152270793914795, gen p mean: -0.10778674483299255, mean p set: 0.4520973861217499
loss_pred:0.016011152416467667, decouple_loss:0.00041474972385913134
Iteration: 2404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44993746280670166, gen p mean: -0.10900643467903137, mean p set: 0.4505161941051483
loss_pred:0.015312876552343369, decouple_loss:0.00038800446782261133
The modified gen p mean: 0.4516180157661438, gen p mean: -0.10643357783555984, mean p set: 0.4521932005882263
loss_pred:0.01572597585618496, decouple_loss:0.00037885320489294827
The modified gen p mean: 0.4501994550228119, gen p mean: -0.11332838237285614, mean p set: 0.45077693462371826
loss_pred:0.014831095933914185, decouple_loss:0.00039976276457309723
Iteration: 2405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509148895740509, gen p mean: -0.10580459237098694, mean p set: 0.451490581035614
loss_pred:0.015615721233189106, decouple_loss:0.0004098283243365586
The modified gen p mean: 0.45040038228034973, gen p mean: -0.10434591770172119, mean p set: 0.4509766697883606
loss_pred:0.01589871756732464, decouple_loss:0.00044062756933271885
The modified gen p mean: 0.4512883424758911, gen p mean: -0.10792569816112518, mean p set: 0.4518631398677826
loss_pred:0.016819609329104424, decouple_loss:0.0006069699884392321
Iteration: 2406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451438844203949, gen p mean: -0.1028117910027504, mean p set: 0.45201605558395386
loss_pred:0.016197677701711655, decouple_loss:0.00035497514181770384
The modified gen p mean: 0.45089828968048096, gen p mean: -0.10197203606367111, mean p set: 0.4514739513397217
loss_pred:0.01601136475801468, decouple_loss:0.0004443896177690476
The modified gen p mean: 0.44953566789627075, gen p mean: -0.11059573292732239, mean p set: 0.45011407136917114
loss_pred:0.01599465310573578, decouple_loss:0.00043253431795164943
Iteration: 2407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45166364312171936, gen p mean: -0.09999901056289673, mean p set: 0.4522396922111511
loss_pred:0.015254889614880085, decouple_loss:0.0006114943535067141
The modified gen p mean: 0.45058003067970276, gen p mean: -0.10083312541246414, mean p set: 0.4511570930480957
The modified gen p mean: 0.45231837034225464, gen p mean: -0.11380694061517715, mean p set: 0.45289358496665955
loss_pred:0.016109609976410866, decouple_loss:0.0005416590720415115
loss_pred:0.014986502937972546, decouple_loss:0.0005541020655073225
Iteration: 2408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45076701045036316, gen p mean: -0.10286184400320053, mean p set: 0.45134201645851135
loss_pred:0.015854571014642715, decouple_loss:0.0004886782844550908
The modified gen p mean: 0.4507817029953003, gen p mean: -0.1051737442612648, mean p set: 0.451358824968338
The modified gen p mean: 0.4516562521457672, gen p mean: -0.10391828417778015, mean p set: 0.45223185420036316
loss_pred:0.01552729681134224, decouple_loss:0.000687005405779928
loss_pred:0.015355660580098629, decouple_loss:0.0005347638507373631
Iteration: 2409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45250847935676575, gen p mean: -0.09759699553251266, mean p set: 0.4530864953994751
loss_pred:0.015466609038412571, decouple_loss:0.0003218087658751756
The modified gen p mean: 0.45017609000205994, gen p mean: -0.10132139176130295, mean p set: 0.4507540166378021
The modified gen p mean: 0.45005354285240173, gen p mean: -0.10428053140640259, mean p set: 0.45062902569770813
loss_pred:0.015613911673426628, decouple_loss:0.00036685055238194764
loss_pred:0.015459184534847736, decouple_loss:0.0003692294703796506
Iteration: 2410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498080909252167, gen p mean: -0.1051209419965744, mean p set: 0.45038551092147827
loss_pred:0.015203114598989487, decouple_loss:0.00042336664046160877
The modified gen p mean: 0.45149847865104675, gen p mean: -0.10946084558963776, mean p set: 0.4520759880542755
The modified gen p mean: 0.44973233342170715, gen p mean: -0.1081860363483429, mean p set: 0.4503083825111389
loss_pred:0.015117204748094082, decouple_loss:0.000469439837615937
loss_pred:0.01600750908255577, decouple_loss:0.0005314121954143047
2023-05-02 12:33:01 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12329811602830887, mean p set: 0.4502691626548767
loss_pred:0.0169417355209589, decouple_loss:0.0008745594532229006
The modified gen p mean: 0.4495370090007782, gen p mean: -0.11589682102203369, mean p set: 0.4500633478164673
loss_pred:0.016275398433208466, decouple_loss:0.0006085429922677577
The modified gen p mean: 0.4498271644115448, gen p mean: -0.11586172878742218, mean p set: 0.45035696029663086
loss_pred:0.016427384689450264, decouple_loss:0.0005730663542635739
WV_1_PC_1_EH_0_PS_40, loss: 0.016582442447543144, avg_mse: 0.025815486907958984
current test mse: 0.025815
Iteration: 2411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45035865902900696, gen p mean: -0.11415271461009979, mean p set: 0.45093417167663574
loss_pred:0.015703700482845306, decouple_loss:0.0004703613230958581
The modified gen p mean: 0.45232340693473816, gen p mean: -0.1113460585474968, mean p set: 0.45289894938468933The modified gen p mean: 0.45082542300224304, gen p mean: -0.1137993112206459, mean p set: 0.45140039920806885
loss_pred:0.01518468651920557, decouple_loss:0.0005859735538251698
loss_pred:0.015172749757766724, decouple_loss:0.0004666870227083564
Iteration: 2412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097798109054565, gen p mean: -0.11017362773418427, mean p set: 0.45155417919158936
loss_pred:0.016000105068087578, decouple_loss:0.00043921900214627385
The modified gen p mean: 0.45044729113578796, gen p mean: -0.11757928133010864, mean p set: 0.4510243833065033The modified gen p mean: 0.45127275586128235, gen p mean: -0.11060145497322083, mean p set: 0.4518493115901947
loss_pred:0.015863891690969467, decouple_loss:0.0003517673467285931
loss_pred:0.015718156471848488, decouple_loss:0.00036282718065194786
Iteration: 2413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059242844581604, gen p mean: -0.11797262728214264, mean p set: 0.45116883516311646
loss_pred:0.015872694551944733, decouple_loss:0.0005285013467073441
The modified gen p mean: 0.44991761445999146, gen p mean: -0.11247224360704422, mean p set: 0.4504954218864441
loss_pred:0.015500230714678764, decouple_loss:0.0005134561215527356
The modified gen p mean: 0.4512142539024353, gen p mean: -0.11362769454717636, mean p set: 0.45179006457328796
loss_pred:0.015518448315560818, decouple_loss:0.0004954047617502511
Iteration: 2414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45021697878837585, gen p mean: -0.1214718371629715, mean p set: 0.4507933557033539
loss_pred:0.015215063467621803, decouple_loss:0.00036528799682855606
The modified gen p mean: 0.45125189423561096, gen p mean: -0.11473146080970764, mean p set: 0.45182737708091736
loss_pred:0.015957782045006752, decouple_loss:0.00041579449316486716
The modified gen p mean: 0.45229318737983704, gen p mean: -0.12119372189044952, mean p set: 0.45286911725997925
loss_pred:0.015178714878857136, decouple_loss:0.0005118352710269392
Iteration: 2415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45005401968955994, gen p mean: -0.11927823722362518, mean p set: 0.45062994956970215
loss_pred:0.016150329262018204, decouple_loss:0.00037304405122995377
The modified gen p mean: 0.4521652162075043, gen p mean: -0.12421311438083649, mean p set: 0.452742338180542
loss_pred:0.014805308543145657, decouple_loss:0.0004041219362989068
The modified gen p mean: 0.45023369789123535, gen p mean: -0.11678646504878998, mean p set: 0.4508115351200104
loss_pred:0.015275866724550724, decouple_loss:0.0006357560050673783
Iteration: 2416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114532113075256, gen p mean: -0.11903323978185654, mean p set: 0.451722115278244
The modified gen p mean: 0.45160791277885437, gen p mean: -0.11827190220355988, mean p set: 0.45218396186828613loss_pred:0.015886014327406883, decouple_loss:0.0005053309723734856
loss_pred:0.01637660339474678, decouple_loss:0.000555650913156569
The modified gen p mean: 0.4516870677471161, gen p mean: -0.11798963695764542, mean p set: 0.452263206243515
loss_pred:0.015170451253652573, decouple_loss:0.00030930651701055467
Iteration: 2417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45290330052375793, gen p mean: -0.1201028972864151, mean p set: 0.453481525182724
loss_pred:0.014696755446493626, decouple_loss:0.00042989294161088765
The modified gen p mean: 0.45297330617904663, gen p mean: -0.12023947387933731, mean p set: 0.45354846119880676
loss_pred:0.014948741532862186, decouple_loss:0.00045658950693905354
The modified gen p mean: 0.44936928153038025, gen p mean: -0.11752481013536453, mean p set: 0.4499463438987732
loss_pred:0.016003791242837906, decouple_loss:0.0005186815978959203
Iteration: 2418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523037374019623, gen p mean: -0.11214154213666916, mean p set: 0.4528786242008209
The modified gen p mean: 0.45099136233329773, gen p mean: -0.11860235035419464, mean p set: 0.45156532526016235
loss_pred:0.015704084187746048, decouple_loss:0.00041006592800840735
loss_pred:0.014508603140711784, decouple_loss:0.0004086595436092466
The modified gen p mean: 0.4505578577518463, gen p mean: -0.1109166145324707, mean p set: 0.4511346220970154
loss_pred:0.01529504545032978, decouple_loss:0.00040957346209324896
Iteration: 2419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519992470741272, gen p mean: -0.11761114001274109, mean p set: 0.4525797963142395
loss_pred:0.014940464869141579, decouple_loss:0.0003387047618161887
The modified gen p mean: 0.44934943318367004, gen p mean: -0.11434004455804825, mean p set: 0.44992655515670776
loss_pred:0.016148315742611885, decouple_loss:0.0003806451568379998
The modified gen p mean: 0.45184701681137085, gen p mean: -0.12244683504104614, mean p set: 0.4524238109588623
loss_pred:0.015125167556107044, decouple_loss:0.0003616027534008026
Iteration: 2420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508746266365051, gen p mean: -0.1073562428355217, mean p set: 0.451449453830719
loss_pred:0.015376734547317028, decouple_loss:0.0004571113095153123
The modified gen p mean: 0.4503815472126007, gen p mean: -0.10813843458890915, mean p set: 0.4509580433368683
The modified gen p mean: 0.45090097188949585, gen p mean: -0.114393450319767, mean p set: 0.4514811336994171
loss_pred:0.015255079604685307, decouple_loss:0.0005492828786373138
loss_pred:0.015769321471452713, decouple_loss:0.00034659248194657266
2023-05-02 12:35:08 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1229393407702446, mean p set: 0.4502691626548767
loss_pred:0.016989143565297127, decouple_loss:0.0006100927712395787
The modified gen p mean: 0.44953489303588867, gen p mean: -0.11597401648759842, mean p set: 0.4500633478164673
loss_pred:0.0163187887519598, decouple_loss:0.0005598281277343631
The modified gen p mean: 0.4498309791088104, gen p mean: -0.11601171642541885, mean p set: 0.45035696029663086
loss_pred:0.016426512971520424, decouple_loss:0.0005069919279776514
WV_1_PC_1_EH_0_PS_40, loss: 0.016606098040938377, avg_mse: 0.025852471590042114
current test mse: 0.025852
Iteration: 2421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45096907019615173, gen p mean: -0.1126239076256752, mean p set: 0.45154494047164917
The modified gen p mean: 0.45117735862731934, gen p mean: -0.10968837887048721, mean p set: 0.45175471901893616
loss_pred:0.01436957810074091, decouple_loss:0.0003560404875315726
loss_pred:0.01566704921424389, decouple_loss:0.00034537786268629134
The modified gen p mean: 0.45011115074157715, gen p mean: -0.10748527944087982, mean p set: 0.4506874978542328
loss_pred:0.016005864366889, decouple_loss:0.000496214022859931
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
NaN value num: 0
Iteration: 2422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521794021129608, gen p mean: -0.11540921777486801, mean p set: 0.45275866985321045
loss_pred:0.016379952430725098, decouple_loss:0.00037449461524374783
The modified gen p mean: 0.45273318886756897, gen p mean: -0.11370200663805008, mean p set: 0.45330876111984253The modified gen p mean: 0.453459769487381, gen p mean: -0.11142580956220627, mean p set: 0.45403948426246643
loss_pred:0.015796028077602386, decouple_loss:0.00035154478973709047
loss_pred:0.015079066157341003, decouple_loss:0.000345748063409701
Iteration: 2423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45240554213523865, gen p mean: -0.11546044051647186, mean p set: 0.4529838562011719
loss_pred:0.01641080714762211, decouple_loss:0.00044857250759378076
The modified gen p mean: 0.45164188742637634, gen p mean: -0.11365266144275665, mean p set: 0.4522179961204529
loss_pred:0.016612447798252106, decouple_loss:0.0003063667973037809
The modified gen p mean: 0.4517711400985718, gen p mean: -0.1167621910572052, mean p set: 0.45234808325767517
loss_pred:0.01628849096596241, decouple_loss:0.0004154027556069195
Iteration: 2424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45249632000923157, gen p mean: -0.12058146297931671, mean p set: 0.4530721604824066
loss_pred:0.016392555087804794, decouple_loss:0.00043173859012313187
The modified gen p mean: 0.45206519961357117, gen p mean: -0.11166966706514359, mean p set: 0.45264187455177307
loss_pred:0.015628889203071594, decouple_loss:0.0003354554937686771
The modified gen p mean: 0.4517099857330322, gen p mean: -0.11331482976675034, mean p set: 0.4522865414619446
loss_pred:0.014969315379858017, decouple_loss:0.0003786895249504596
Iteration: 2425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45171859860420227, gen p mean: -0.11278599500656128, mean p set: 0.45229360461235046
loss_pred:0.014948710799217224, decouple_loss:0.0003143462527077645
The modified gen p mean: 0.4515123665332794, gen p mean: -0.1179652065038681, mean p set: 0.4520886242389679
loss_pred:0.01666278764605522, decouple_loss:0.00040988987893797457
The modified gen p mean: 0.45229431986808777, gen p mean: -0.11963129788637161, mean p set: 0.4528692364692688
loss_pred:0.015668202191591263, decouple_loss:0.0003487385984044522
Iteration: 2426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45093438029289246, gen p mean: -0.11530013382434845, mean p set: 0.4515085816383362
loss_pred:0.015898482874035835, decouple_loss:0.0006069098599255085
The modified gen p mean: 0.4517423212528229, gen p mean: -0.11267051845788956, mean p set: 0.4523204565048218
The modified gen p mean: 0.4522496163845062, gen p mean: -0.11338933557271957, mean p set: 0.4528285562992096
loss_pred:0.015211233869194984, decouple_loss:0.00034397590206936
loss_pred:0.016693921759724617, decouple_loss:0.00039543930324725807
Iteration: 2427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516342878341675, gen p mean: -0.1105302944779396, mean p set: 0.4522091746330261
loss_pred:0.016393618658185005, decouple_loss:0.00035129691241309047
The modified gen p mean: 0.45141953229904175, gen p mean: -0.10403050482273102, mean p set: 0.4519991874694824
The modified gen p mean: 0.45129767060279846, gen p mean: -0.10942833125591278, mean p set: 0.4518720209598541
loss_pred:0.014930853620171547, decouple_loss:0.00036767107667401433
loss_pred:0.016075018793344498, decouple_loss:0.00034161406802013516
Iteration: 2428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533140957355499, gen p mean: -0.10678081959486008, mean p set: 0.4538889527320862
The modified gen p mean: 0.4514951705932617, gen p mean: -0.107574462890625, mean p set: 0.4520726501941681
loss_pred:0.015535017475485802, decouple_loss:0.0003594127483665943
loss_pred:0.016162822023034096, decouple_loss:0.00033452661591582
The modified gen p mean: 0.4517476260662079, gen p mean: -0.10186642408370972, mean p set: 0.45232388377189636
loss_pred:0.01544103492051363, decouple_loss:0.0003554747672751546
Iteration: 2429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538184702396393, gen p mean: -0.10385079681873322, mean p set: 0.45439544320106506
loss_pred:0.015387246385216713, decouple_loss:0.00034699347452260554
The modified gen p mean: 0.4496031403541565, gen p mean: -0.10855510085821152, mean p set: 0.45017948746681213
loss_pred:0.01638604700565338, decouple_loss:0.0003734261845238507
The modified gen p mean: 0.45127809047698975, gen p mean: -0.10139662027359009, mean p set: 0.45185646414756775
loss_pred:0.016152335330843925, decouple_loss:0.00041637197136878967
Iteration: 2430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516364634037018, gen p mean: -0.10843095183372498, mean p set: 0.45221248269081116The modified gen p mean: 0.4515032470226288, gen p mean: -0.10748942196369171, mean p set: 0.45207729935646057
loss_pred:0.0158437117934227, decouple_loss:0.00033498197444714606
loss_pred:0.016050061210989952, decouple_loss:0.00042493725777603686
The modified gen p mean: 0.4530588388442993, gen p mean: -0.10390295833349228, mean p set: 0.4536357522010803
loss_pred:0.015030888840556145, decouple_loss:0.00031671335455030203
2023-05-02 12:37:51 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1219811886548996, mean p set: 0.4502691626548767
loss_pred:0.016899148002266884, decouple_loss:0.0004987700376659632
The modified gen p mean: 0.44953736662864685, gen p mean: -0.11473532766103745, mean p set: 0.4500633478164673
loss_pred:0.016333704814314842, decouple_loss:0.0005181684973649681
The modified gen p mean: 0.44983065128326416, gen p mean: -0.11452323198318481, mean p set: 0.45035696029663086
loss_pred:0.01649126224219799, decouple_loss:0.00047199640539474785
WV_1_PC_1_EH_0_PS_40, loss: 0.016599521040916443, avg_mse: 0.025860249996185303
current test mse: 0.02586
Iteration: 2431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515571892261505, gen p mean: -0.10672062635421753, mean p set: 0.4521334171295166
loss_pred:0.015968792140483856, decouple_loss:0.00032208790071308613
The modified gen p mean: 0.45282572507858276, gen p mean: -0.11394283175468445, mean p set: 0.4534013867378235
loss_pred:0.015303990803658962, decouple_loss:0.00036035888479091227
The modified gen p mean: 0.45078322291374207, gen p mean: -0.10790648311376572, mean p set: 0.45135995745658875
loss_pred:0.01525803655385971, decouple_loss:0.00032531010219827294
Iteration: 2432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519794285297394, gen p mean: -0.1053658202290535, mean p set: 0.4525543749332428
The modified gen p mean: 0.4512087106704712, gen p mean: -0.10216592252254486, mean p set: 0.45178544521331787loss_pred:0.01574314571917057, decouple_loss:0.00035029149148613214
loss_pred:0.015696220099925995, decouple_loss:0.0003590195265132934
The modified gen p mean: 0.45087844133377075, gen p mean: -0.10799355804920197, mean p set: 0.45145612955093384
loss_pred:0.01663580723106861, decouple_loss:0.0004143286496400833
Iteration: 2433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517800509929657, gen p mean: -0.10970029979944229, mean p set: 0.4523581564426422
loss_pred:0.015561462379992008, decouple_loss:0.00040142855141311884
The modified gen p mean: 0.4534643590450287, gen p mean: -0.10024382174015045, mean p set: 0.45404139161109924The modified gen p mean: 0.4537789821624756, gen p mean: -0.10110079497098923, mean p set: 0.45435523986816406
loss_pred:0.01531840581446886, decouple_loss:0.00037836781120859087
loss_pred:0.01608259230852127, decouple_loss:0.0004537696368061006
Iteration: 2434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523072838783264, gen p mean: -0.10762222111225128, mean p set: 0.45288369059562683
loss_pred:0.01537034846842289, decouple_loss:0.0005140566499903798
The modified gen p mean: 0.4534505605697632, gen p mean: -0.1004885584115982, mean p set: 0.45402759313583374
loss_pred:0.015939941629767418, decouple_loss:0.00040366381290368736
The modified gen p mean: 0.45147034525871277, gen p mean: -0.10772176831960678, mean p set: 0.45204824209213257
loss_pred:0.015781743451952934, decouple_loss:0.0003739555540960282
Iteration: 2435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45118415355682373, gen p mean: -0.11270240694284439, mean p set: 0.45176082849502563
loss_pred:0.015348570421338081, decouple_loss:0.0006257359636947513
The modified gen p mean: 0.4522925019264221, gen p mean: -0.10915397852659225, mean p set: 0.452871710062027
loss_pred:0.015788407996296883, decouple_loss:0.00046384960296563804
The modified gen p mean: 0.4510972201824188, gen p mean: -0.10721258819103241, mean p set: 0.45167189836502075
loss_pred:0.01593742147088051, decouple_loss:0.0005394634208641946
Iteration: 2436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515983760356903, gen p mean: -0.10782122611999512, mean p set: 0.45217597484588623
loss_pred:0.015633678063750267, decouple_loss:0.00037048751255497336
The modified gen p mean: 0.4508492648601532, gen p mean: -0.10374774783849716, mean p set: 0.4514249265193939
The modified gen p mean: 0.4534532427787781, gen p mean: -0.11743694543838501, mean p set: 0.45403069257736206
loss_pred:0.01555394846946001, decouple_loss:0.0003074217529501766
loss_pred:0.015762751922011375, decouple_loss:0.0003477858263067901
Iteration: 2437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45234397053718567, gen p mean: -0.11203920096158981, mean p set: 0.4529213011264801
loss_pred:0.01569967530667782, decouple_loss:0.0003969817771576345
The modified gen p mean: 0.4519057869911194, gen p mean: -0.11602621525526047, mean p set: 0.45248281955718994
The modified gen p mean: 0.4509750306606293, gen p mean: -0.10960295796394348, mean p set: 0.4515518248081207
loss_pred:0.015893269330263138, decouple_loss:0.00046206003753468394
loss_pred:0.01548149436712265, decouple_loss:0.00042496604146435857
Iteration: 2438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515213966369629, gen p mean: -0.11521222442388535, mean p set: 0.45209699869155884
loss_pred:0.016525421291589737, decouple_loss:0.00044838417670689523
The modified gen p mean: 0.45405155420303345, gen p mean: -0.11419877409934998, mean p set: 0.45463061332702637
The modified gen p mean: 0.4522315263748169, gen p mean: -0.11588109284639359, mean p set: 0.45280906558036804
loss_pred:0.015330887399613857, decouple_loss:0.0003925207129213959
loss_pred:0.015449716709554195, decouple_loss:0.0004309529031161219
Iteration: 2439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45016050338745117, gen p mean: -0.1215474009513855, mean p set: 0.45073869824409485
loss_pred:0.015479261055588722, decouple_loss:0.0003779596299864352
The modified gen p mean: 0.4519510269165039, gen p mean: -0.11774621903896332, mean p set: 0.45252567529678345
loss_pred:0.015229299664497375, decouple_loss:0.00036698466283269227
The modified gen p mean: 0.4517631232738495, gen p mean: -0.1149216741323471, mean p set: 0.4523428976535797
loss_pred:0.015580916777253151, decouple_loss:0.0004119273799005896
Iteration: 2440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524865448474884, gen p mean: -0.11472904682159424, mean p set: 0.4530635178089142
loss_pred:0.015432975254952908, decouple_loss:0.00040788447950035334
The modified gen p mean: 0.4512578248977661, gen p mean: -0.11850675940513611, mean p set: 0.4518350064754486
The modified gen p mean: 0.45027536153793335, gen p mean: -0.1214253231883049, mean p set: 0.45085132122039795
loss_pred:0.01564505696296692, decouple_loss:0.0004797553992830217
loss_pred:0.016607332974672318, decouple_loss:0.00035199025296606123
2023-05-02 12:39:57 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1300230175256729, mean p set: 0.4502691626548767
loss_pred:0.016848977655172348, decouple_loss:0.00039354476029984653
The modified gen p mean: 0.4495351314544678, gen p mean: -0.1230221837759018, mean p set: 0.4500633478164673
loss_pred:0.016340339556336403, decouple_loss:0.00042356172343716025
The modified gen p mean: 0.44982707500457764, gen p mean: -0.12251557409763336, mean p set: 0.45035696029663086
loss_pred:0.01649433933198452, decouple_loss:0.00042894473881460726
WV_1_PC_1_EH_0_PS_40, loss: 0.016581987962126732, avg_mse: 0.02585306391119957
current test mse: 0.025853
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
NaN value num: 0
Iteration: 2441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45055967569351196, gen p mean: -0.1151251569390297, mean p set: 0.45113739371299744
loss_pred:0.014933927915990353, decouple_loss:0.0003890171938110143
The modified gen p mean: 0.4480664134025574, gen p mean: -0.11654860526323318, mean p set: 0.4486430585384369
loss_pred:0.014772767201066017, decouple_loss:0.00047456688480451703
The modified gen p mean: 0.4518228769302368, gen p mean: -0.11837593466043472, mean p set: 0.4524003565311432
loss_pred:0.015446057543158531, decouple_loss:0.00042040389962494373
Iteration: 2442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449779212474823, gen p mean: -0.11965862661600113, mean p set: 0.4503563344478607
loss_pred:0.014531123451888561, decouple_loss:0.0003325851575937122
The modified gen p mean: 0.45005878806114197, gen p mean: -0.11017047613859177, mean p set: 0.45063650608062744The modified gen p mean: 0.4488050043582916, gen p mean: -0.11177526414394379, mean p set: 0.44938188791275024
loss_pred:0.015401127748191357, decouple_loss:0.00036220153560861945
loss_pred:0.014856708236038685, decouple_loss:0.0003988389507867396
Iteration: 2443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502688944339752, gen p mean: -0.10923884063959122, mean p set: 0.4508446753025055
loss_pred:0.015238604508340359, decouple_loss:0.0005064953584223986
The modified gen p mean: 0.4475410282611847, gen p mean: -0.12096425890922546, mean p set: 0.44811883568763733
loss_pred:0.015343846753239632, decouple_loss:0.0003832881338894367
The modified gen p mean: 0.44968563318252563, gen p mean: -0.1155499592423439, mean p set: 0.45025986433029175
loss_pred:0.014774925075471401, decouple_loss:0.00046754840877838433
Iteration: 2444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500403106212616, gen p mean: -0.11597129702568054, mean p set: 0.45061561465263367
loss_pred:0.014584261924028397, decouple_loss:0.0003595889429561794
The modified gen p mean: 0.4480666518211365, gen p mean: -0.11060000211000443, mean p set: 0.448642760515213
loss_pred:0.01602538302540779, decouple_loss:0.00032601793645881116
The modified gen p mean: 0.44769957661628723, gen p mean: -0.11820660531520844, mean p set: 0.44827285408973694
loss_pred:0.01531681977212429, decouple_loss:0.00036022713175043464
Iteration: 2445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018601417541504, gen p mean: -0.11331795156002045, mean p set: 0.45076125860214233
loss_pred:0.014488856308162212, decouple_loss:0.0003027295751962811
The modified gen p mean: 0.4487867057323456, gen p mean: -0.10943181067705154, mean p set: 0.44936051964759827
loss_pred:0.014815581031143665, decouple_loss:0.000339597841957584
The modified gen p mean: 0.4503445625305176, gen p mean: -0.10686326026916504, mean p set: 0.4509223401546478
loss_pred:0.015274024568498135, decouple_loss:0.00043934653513133526
Iteration: 2446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500837028026581, gen p mean: -0.10792073607444763, mean p set: 0.4506600499153137
loss_pred:0.01534139085561037, decouple_loss:0.0003765490837395191
The modified gen p mean: 0.44703683257102966, gen p mean: -0.11747734248638153, mean p set: 0.4476113021373749
The modified gen p mean: 0.44836223125457764, gen p mean: -0.12058690190315247, mean p set: 0.4489381015300751
loss_pred:0.015711231157183647, decouple_loss:0.0004787191573996097
loss_pred:0.01548562292009592, decouple_loss:0.0004298532730899751
Iteration: 2447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498744606971741, gen p mean: -0.10799840092658997, mean p set: 0.45045000314712524
loss_pred:0.015416824258863926, decouple_loss:0.0003548850945662707
The modified gen p mean: 0.44962918758392334, gen p mean: -0.10966141521930695, mean p set: 0.4502054452896118
loss_pred:0.015451941639184952, decouple_loss:0.00036340023507364094
The modified gen p mean: 0.45035281777381897, gen p mean: -0.1128087118268013, mean p set: 0.4509299099445343
loss_pred:0.015201284550130367, decouple_loss:0.0004640157276298851
Iteration: 2448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784072041511536, gen p mean: -0.11449737101793289, mean p set: 0.44841670989990234
loss_pred:0.014975924976170063, decouple_loss:0.0005082972929812968
The modified gen p mean: 0.4499029815196991, gen p mean: -0.11371815949678421, mean p set: 0.45048198103904724
loss_pred:0.01469623576849699, decouple_loss:0.0003155613667331636
The modified gen p mean: 0.45115306973457336, gen p mean: -0.11418472230434418, mean p set: 0.4517301619052887
loss_pred:0.015324101783335209, decouple_loss:0.0005754242301918566
Iteration: 2449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488219916820526, gen p mean: -0.11837629973888397, mean p set: 0.44939908385276794
loss_pred:0.014288241043686867, decouple_loss:0.0004987843567505479
The modified gen p mean: 0.44781357049942017, gen p mean: -0.1109209731221199, mean p set: 0.4483916759490967
loss_pred:0.015533543191850185, decouple_loss:0.00040349093615077436
The modified gen p mean: 0.4489743411540985, gen p mean: -0.11570031195878983, mean p set: 0.44955018162727356
loss_pred:0.01527438685297966, decouple_loss:0.00039756434853188694
Iteration: 2450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505327641963959, gen p mean: -0.11130726337432861, mean p set: 0.4511106312274933
loss_pred:0.015397271141409874, decouple_loss:0.0005580571014434099
The modified gen p mean: 0.4494907259941101, gen p mean: -0.11085688322782516, mean p set: 0.45006507635116577
loss_pred:0.01610691472887993, decouple_loss:0.0003626068355515599
The modified gen p mean: 0.44783106446266174, gen p mean: -0.11146486550569534, mean p set: 0.44840651750564575
loss_pred:0.015511125326156616, decouple_loss:0.00041611705091781914
2023-05-02 12:42:42 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12469957023859024, mean p set: 0.4502691626548767
loss_pred:0.01680922694504261, decouple_loss:0.0004060371720697731
The modified gen p mean: 0.44953593611717224, gen p mean: -0.11783617734909058, mean p set: 0.4500633478164673
loss_pred:0.01628500409424305, decouple_loss:0.0003757982049137354
The modified gen p mean: 0.44982603192329407, gen p mean: -0.11751001328229904, mean p set: 0.45035696029663086
loss_pred:0.01649787835776806, decouple_loss:0.000369199609849602
WV_1_PC_1_EH_0_PS_40, loss: 0.016549888998270035, avg_mse: 0.025781769305467606
current test mse: 0.025782
Iteration: 2451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487237334251404, gen p mean: -0.12036623805761337, mean p set: 0.44930049777030945
loss_pred:0.015147949568927288, decouple_loss:0.00035554732312448323
The modified gen p mean: 0.4508814215660095, gen p mean: -0.11116892844438553, mean p set: 0.451458215713501The modified gen p mean: 0.4487694799900055, gen p mean: -0.11048966646194458, mean p set: 0.44934722781181335
loss_pred:0.014891459606587887, decouple_loss:0.0005089418846182525
loss_pred:0.01519334502518177, decouple_loss:0.00032360601471737027
Iteration: 2452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841912388801575, gen p mean: -0.11530130356550217, mean p set: 0.4489981234073639
loss_pred:0.014661255292594433, decouple_loss:0.0004554669721983373
The modified gen p mean: 0.4487876892089844, gen p mean: -0.11069777607917786, mean p set: 0.4493641257286072The modified gen p mean: 0.4501746594905853, gen p mean: -0.10586021840572357, mean p set: 0.4507491886615753
loss_pred:0.01429617777466774, decouple_loss:0.0003730692551471293loss_pred:0.015232428908348083, decouple_loss:0.00046696909703314304
Iteration: 2453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972965121269226, gen p mean: -0.10986063629388809, mean p set: 0.4503055810928345
loss_pred:0.015188949182629585, decouple_loss:0.00030947651248425245
The modified gen p mean: 0.4491492807865143, gen p mean: -0.10897800326347351, mean p set: 0.4497230648994446The modified gen p mean: 0.450459748506546, gen p mean: -0.11181031912565231, mean p set: 0.4510374367237091
loss_pred:0.015296360477805138, decouple_loss:0.00043955823639407754loss_pred:0.014655791223049164, decouple_loss:0.0003626295074354857
Iteration: 2454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492083489894867, gen p mean: -0.113969586789608, mean p set: 0.4497860372066498
loss_pred:0.01515190489590168, decouple_loss:0.0003899330331478268
The modified gen p mean: 0.4502674639225006, gen p mean: -0.11707088351249695, mean p set: 0.45084071159362793
loss_pred:0.01440923660993576, decouple_loss:0.00031232554465532303
The modified gen p mean: 0.44942507147789, gen p mean: -0.11500366032123566, mean p set: 0.45000073313713074
loss_pred:0.015076027251780033, decouple_loss:0.0005325179663486779
Iteration: 2455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44805675745010376, gen p mean: -0.11698129773139954, mean p set: 0.448630690574646
loss_pred:0.014229374937713146, decouple_loss:0.0003028294595424086
The modified gen p mean: 0.44950225949287415, gen p mean: -0.11567921191453934, mean p set: 0.45007678866386414
loss_pred:0.015692535787820816, decouple_loss:0.000527433177921921
The modified gen p mean: 0.44862014055252075, gen p mean: -0.11357588320970535, mean p set: 0.44919705390930176
loss_pred:0.014763141050934792, decouple_loss:0.0003186710528098047
Iteration: 2456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476444721221924, gen p mean: -0.1199469193816185, mean p set: 0.4482189118862152
loss_pred:0.015557052567601204, decouple_loss:0.000760683324187994
The modified gen p mean: 0.448455274105072, gen p mean: -0.12318472564220428, mean p set: 0.44903138279914856
loss_pred:0.01487433910369873, decouple_loss:0.0004739551222883165
The modified gen p mean: 0.4480833113193512, gen p mean: -0.11602173000574112, mean p set: 0.44865939021110535
loss_pred:0.014828764833509922, decouple_loss:0.0003925047640223056
Iteration: 2457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947707653045654, gen p mean: -0.11424390226602554, mean p set: 0.45005226135253906
loss_pred:0.015589849092066288, decouple_loss:0.00041663937736302614
The modified gen p mean: 0.45002496242523193, gen p mean: -0.11897315084934235, mean p set: 0.4506036043167114
The modified gen p mean: 0.4495127499103546, gen p mean: -0.11906898766756058, mean p set: 0.450085312128067
loss_pred:0.015120666474103928, decouple_loss:0.00044615668593905866
loss_pred:0.015086101368069649, decouple_loss:0.00040105555672198534
Iteration: 2458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480260908603668, gen p mean: -0.11798519641160965, mean p set: 0.44860365986824036
loss_pred:0.014887253753840923, decouple_loss:0.0005219317390583456
The modified gen p mean: 0.4498805105686188, gen p mean: -0.11986994743347168, mean p set: 0.45045650005340576
loss_pred:0.014328483492136002, decouple_loss:0.000471777020720765
The modified gen p mean: 0.45223546028137207, gen p mean: -0.12187901884317398, mean p set: 0.4528099000453949
loss_pred:0.014491717331111431, decouple_loss:0.0004793087427970022
Iteration: 2459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493710696697235, gen p mean: -0.12931352853775024, mean p set: 0.4499492049217224
loss_pred:0.014227188192307949, decouple_loss:0.00037121973582543433
The modified gen p mean: 0.44950512051582336, gen p mean: -0.1220448762178421, mean p set: 0.4500850439071655
The modified gen p mean: 0.4487370550632477, gen p mean: -0.11983905732631683, mean p set: 0.44931453466415405
loss_pred:0.014809438958764076, decouple_loss:0.00041082731331698596
loss_pred:0.015263423323631287, decouple_loss:0.0004289790813345462
Iteration: 2460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45047545433044434, gen p mean: -0.11541993170976639, mean p set: 0.45105084776878357
loss_pred:0.015319756232202053, decouple_loss:0.0005723692593164742
The modified gen p mean: 0.4497510492801666, gen p mean: -0.12182719260454178, mean p set: 0.4503287672996521
loss_pred:0.01507032010704279, decouple_loss:0.0004244550073053688
The modified gen p mean: 0.450321227312088, gen p mean: -0.11651989072561264, mean p set: 0.45089852809906006
loss_pred:0.015320958569645882, decouple_loss:0.0005116988904774189
2023-05-02 12:44:51 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13339421153068542, mean p set: 0.4502691626548767
loss_pred:0.01689002476632595, decouple_loss:0.00043316520168446004
The modified gen p mean: 0.44953474402427673, gen p mean: -0.12703649699687958, mean p set: 0.4500633478164673
loss_pred:0.016291221603751183, decouple_loss:0.0003823846345767379
The modified gen p mean: 0.4498285949230194, gen p mean: -0.12673337757587433, mean p set: 0.45035696029663086
loss_pred:0.0165440384298563, decouple_loss:0.00042019790271297097
WV_1_PC_1_EH_0_PS_40, loss: 0.016595691442489624, avg_mse: 0.025828951969742775
current test mse: 0.025829
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
NaN value num: 0
Iteration: 2461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45190075039863586, gen p mean: -0.12713637948036194, mean p set: 0.45247551798820496
loss_pred:0.014449294656515121, decouple_loss:0.00038378144381567836
The modified gen p mean: 0.45122843980789185, gen p mean: -0.12532258033752441, mean p set: 0.4518038034439087
loss_pred:0.014128852635622025, decouple_loss:0.00038216510438360274
The modified gen p mean: 0.4503464996814728, gen p mean: -0.1223960816860199, mean p set: 0.4509258568286896
loss_pred:0.0147859463468194, decouple_loss:0.000525627052411437
Iteration: 2462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475213587284088, gen p mean: -0.12721635401248932, mean p set: 0.44809824228286743
loss_pred:0.014786683954298496, decouple_loss:0.0004493877640925348
The modified gen p mean: 0.44843074679374695, gen p mean: -0.1263798177242279, mean p set: 0.44900739192962646The modified gen p mean: 0.4485417306423187, gen p mean: -0.1257948875427246, mean p set: 0.44911783933639526
loss_pred:0.01515468955039978, decouple_loss:0.00048648909432813525
loss_pred:0.01481552328914404, decouple_loss:0.0005838166689500213
Iteration: 2463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851401448249817, gen p mean: -0.12777748703956604, mean p set: 0.44908812642097473
loss_pred:0.01540022250264883, decouple_loss:0.00045227506780065596
The modified gen p mean: 0.449204683303833, gen p mean: -0.11354684829711914, mean p set: 0.4497814178466797
loss_pred:0.015352416783571243, decouple_loss:0.0003547098021954298
The modified gen p mean: 0.4490119516849518, gen p mean: -0.11935413628816605, mean p set: 0.44958722591400146
loss_pred:0.015299188904464245, decouple_loss:0.0004153069166932255
Iteration: 2464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496613144874573, gen p mean: -0.12608148157596588, mean p set: 0.45023781061172485
loss_pred:0.014633465558290482, decouple_loss:0.00035125893191434443
The modified gen p mean: 0.4521792232990265, gen p mean: -0.11413564532995224, mean p set: 0.45275649428367615
loss_pred:0.0143584581092, decouple_loss:0.0006090139504522085
The modified gen p mean: 0.4520707130432129, gen p mean: -0.11928462237119675, mean p set: 0.4526459276676178
loss_pred:0.01429047528654337, decouple_loss:0.0006775129586458206
Iteration: 2465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513418674468994, gen p mean: -0.12058188021183014, mean p set: 0.4519214332103729
loss_pred:0.013751194812357426, decouple_loss:0.000575913698412478
The modified gen p mean: 0.45206788182258606, gen p mean: -0.11472421884536743, mean p set: 0.45264333486557007
loss_pred:0.014084087684750557, decouple_loss:0.0005348413251340389
The modified gen p mean: 0.44848448038101196, gen p mean: -0.11862240731716156, mean p set: 0.4490615427494049
loss_pred:0.01572815142571926, decouple_loss:0.0005789566785097122
Iteration: 2466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44927549362182617, gen p mean: -0.11727027595043182, mean p set: 0.4498515725135803
loss_pred:0.014416463673114777, decouple_loss:0.0005771822179667652
The modified gen p mean: 0.4513171911239624, gen p mean: -0.11268300563097, mean p set: 0.4518917500972748
The modified gen p mean: 0.45130521059036255, gen p mean: -0.11403177678585052, mean p set: 0.4518826901912689
loss_pred:0.014572850428521633, decouple_loss:0.00047280985745601356
loss_pred:0.015044961124658585, decouple_loss:0.0006267253775149584
Iteration: 2467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450058251619339, gen p mean: -0.11473939567804337, mean p set: 0.4506358802318573
loss_pred:0.015121527947485447, decouple_loss:0.00046438336721621454
The modified gen p mean: 0.4476904571056366, gen p mean: -0.1195654645562172, mean p set: 0.4482645094394684
The modified gen p mean: 0.45036858320236206, gen p mean: -0.1156853586435318, mean p set: 0.4509424567222595
loss_pred:0.01532671507447958, decouple_loss:0.0004885595990344882
loss_pred:0.01474958099424839, decouple_loss:0.0004292984085623175
Iteration: 2468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495939314365387, gen p mean: -0.11943574249744415, mean p set: 0.45017367601394653
loss_pred:0.014726005494594574, decouple_loss:0.0004377408477012068
The modified gen p mean: 0.45042842626571655, gen p mean: -0.11915774643421173, mean p set: 0.4510088264942169
loss_pred:0.014328278601169586, decouple_loss:0.0004535529587883502
The modified gen p mean: 0.44880566000938416, gen p mean: -0.12142828106880188, mean p set: 0.449381947517395
loss_pred:0.014587044715881348, decouple_loss:0.00040100078331306577
Iteration: 2469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849124550819397, gen p mean: -0.12525132298469543, mean p set: 0.4490666687488556
loss_pred:0.014672793447971344, decouple_loss:0.0003710406890604645
The modified gen p mean: 0.45095011591911316, gen p mean: -0.12058942764997482, mean p set: 0.45152729749679565
The modified gen p mean: 0.4497296214103699, gen p mean: -0.12271006405353546, mean p set: 0.45030689239501953
loss_pred:0.014631313271820545, decouple_loss:0.00046398930135183036
loss_pred:0.014780968427658081, decouple_loss:0.0004098255012650043
Iteration: 2470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44918811321258545, gen p mean: -0.12405149638652802, mean p set: 0.44976404309272766
loss_pred:0.014865336008369923, decouple_loss:0.00040845139301382005
The modified gen p mean: 0.44968751072883606, gen p mean: -0.12988783419132233, mean p set: 0.45026248693466187
The modified gen p mean: 0.4477827847003937, gen p mean: -0.12333419173955917, mean p set: 0.4483596682548523
loss_pred:0.014905787073075771, decouple_loss:0.0004297423001844436
loss_pred:0.015516310930252075, decouple_loss:0.0005286239320412278
2023-05-02 12:47:46 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1358022838830948, mean p set: 0.4502691626548767
loss_pred:0.016988664865493774, decouple_loss:0.00044804628123529255
The modified gen p mean: 0.4495350122451782, gen p mean: -0.1291360855102539, mean p set: 0.4500633478164673
loss_pred:0.01630937121808529, decouple_loss:0.00042367761489003897
The modified gen p mean: 0.44982749223709106, gen p mean: -0.1291087120771408, mean p set: 0.45035696029663086
loss_pred:0.016461782157421112, decouple_loss:0.0004262373549863696
WV_1_PC_1_EH_0_PS_40, loss: 0.016608238220214844, avg_mse: 0.0258762426674366
current test mse: 0.025876
Iteration: 2471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891557097435, gen p mean: -0.1312285214662552, mean p set: 0.4494905471801758
loss_pred:0.014535217545926571, decouple_loss:0.0005532953073270619
The modified gen p mean: 0.4500837028026581, gen p mean: -0.12761279940605164, mean p set: 0.45065850019454956
loss_pred:0.01438654400408268, decouple_loss:0.0004557739302981645
The modified gen p mean: 0.44893285632133484, gen p mean: -0.1270332783460617, mean p set: 0.4495079815387726
loss_pred:0.014647300355136395, decouple_loss:0.0005916840163990855
Iteration: 2472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496288597583771, gen p mean: -0.12696833908557892, mean p set: 0.4502033293247223
loss_pred:0.014581136405467987, decouple_loss:0.00037011835956946015
The modified gen p mean: 0.4488368630409241, gen p mean: -0.13492771983146667, mean p set: 0.44941338896751404
The modified gen p mean: 0.4498225748538971, gen p mean: -0.12282377481460571, mean p set: 0.4504006803035736
loss_pred:0.014288902282714844, decouple_loss:0.0004729169886559248
loss_pred:0.014895007945597172, decouple_loss:0.0004488476843107492
Iteration: 2473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45020899176597595, gen p mean: -0.12021782994270325, mean p set: 0.4507831633090973
loss_pred:0.015166009776294231, decouple_loss:0.0005975671811029315
The modified gen p mean: 0.4513615667819977, gen p mean: -0.1274520605802536, mean p set: 0.45193883776664734
loss_pred:0.01418555062264204, decouple_loss:0.0004692352085839957
The modified gen p mean: 0.44999825954437256, gen p mean: -0.1305210292339325, mean p set: 0.4505738615989685
loss_pred:0.014186506159603596, decouple_loss:0.0005604332545772195
Iteration: 2474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45239394903182983, gen p mean: -0.11863446235656738, mean p set: 0.45297008752822876
loss_pred:0.014254901558160782, decouple_loss:0.00042557864799164236
The modified gen p mean: 0.45044589042663574, gen p mean: -0.12096290290355682, mean p set: 0.4510234594345093
loss_pred:0.015234078280627728, decouple_loss:0.0004955314216203988
The modified gen p mean: 0.4490653872489929, gen p mean: -0.11346172541379929, mean p set: 0.44963955879211426
loss_pred:0.01482356060296297, decouple_loss:0.0004439148469828069
Iteration: 2475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449929416179657, gen p mean: -0.1131291389465332, mean p set: 0.4505072236061096
loss_pred:0.01471471693366766, decouple_loss:0.00044212370994500816
The modified gen p mean: 0.44936278462409973, gen p mean: -0.12105631083250046, mean p set: 0.44993945956230164
loss_pred:0.014050326310098171, decouple_loss:0.0004957283963449299
The modified gen p mean: 0.45167040824890137, gen p mean: -0.1149706020951271, mean p set: 0.4522479474544525
loss_pred:0.014340458437800407, decouple_loss:0.0004040855565108359
Iteration: 2476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499491751194, gen p mean: -0.10907981544733047, mean p set: 0.4505264163017273
loss_pred:0.01414174772799015, decouple_loss:0.0006329956231638789
The modified gen p mean: 0.448903352022171, gen p mean: -0.11195039749145508, mean p set: 0.4494827091693878
The modified gen p mean: 0.4500284194946289, gen p mean: -0.11091474443674088, mean p set: 0.45060494542121887
loss_pred:0.014825108461081982, decouple_loss:0.0005856028292328119
loss_pred:0.014798314310610294, decouple_loss:0.0004376879951450974
Iteration: 2477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499181807041168, gen p mean: -0.11426575481891632, mean p set: 0.4504929184913635
loss_pred:0.014671931974589825, decouple_loss:0.00036648858804255724
The modified gen p mean: 0.45273885130882263, gen p mean: -0.103581503033638, mean p set: 0.4533156752586365
The modified gen p mean: 0.45083087682724, gen p mean: -0.10701750218868256, mean p set: 0.45140528678894043
loss_pred:0.014789972454309464, decouple_loss:0.0004937781486660242
loss_pred:0.014077212661504745, decouple_loss:0.0004556842031888664
Iteration: 2478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517221748828888, gen p mean: -0.10830602794885635, mean p set: 0.4522995054721832
loss_pred:0.014287146739661694, decouple_loss:0.00060445157578215
The modified gen p mean: 0.44967371225357056, gen p mean: -0.11299701035022736, mean p set: 0.45024624466896057
loss_pred:0.014572751708328724, decouple_loss:0.00041383522329851985
The modified gen p mean: 0.45130985975265503, gen p mean: -0.10747402161359787, mean p set: 0.451885849237442
loss_pred:0.01476228702813387, decouple_loss:0.0005529261543415487
Iteration: 2479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498850405216217, gen p mean: -0.11371821910142899, mean p set: 0.45045995712280273
loss_pred:0.014922094531357288, decouple_loss:0.0005295602604746819
The modified gen p mean: 0.4494032561779022, gen p mean: -0.11272123456001282, mean p set: 0.4499800503253937
loss_pred:0.015281429514288902, decouple_loss:0.0004466953396331519
The modified gen p mean: 0.4509847164154053, gen p mean: -0.11529138684272766, mean p set: 0.45156213641166687
loss_pred:0.014613701961934566, decouple_loss:0.0005361911607906222
Iteration: 2480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019471645355225, gen p mean: -0.11985789239406586, mean p set: 0.4507688283920288
loss_pred:0.015129514038562775, decouple_loss:0.0005062533891759813
The modified gen p mean: 0.45127686858177185, gen p mean: -0.12223104387521744, mean p set: 0.4518527686595917
The modified gen p mean: 0.44894668459892273, gen p mean: -0.12614521384239197, mean p set: 0.44952380657196045
loss_pred:0.013965531252324581, decouple_loss:0.0003804359585046768
loss_pred:0.014517155475914478, decouple_loss:0.0004230584600009024
2023-05-02 12:49:54 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13506557047367096, mean p set: 0.4502691626548767
loss_pred:0.016888761892914772, decouple_loss:0.00040539525798521936
The modified gen p mean: 0.4495343565940857, gen p mean: -0.128258615732193, mean p set: 0.4500633478164673
loss_pred:0.01628660038113594, decouple_loss:0.00043176350300200284
The modified gen p mean: 0.44982999563217163, gen p mean: -0.12813632190227509, mean p set: 0.45035696029663086
loss_pred:0.016498571261763573, decouple_loss:0.00037990882992744446
WV_1_PC_1_EH_0_PS_40, loss: 0.01657826267182827, avg_mse: 0.0258954931050539
current test mse: 0.025895
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
NaN value num: 0
Iteration: 2481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501100480556488, gen p mean: -0.12020935863256454, mean p set: 0.45068594813346863
loss_pred:0.01460166648030281, decouple_loss:0.000418363168137148
The modified gen p mean: 0.45036497712135315, gen p mean: -0.13147437572479248, mean p set: 0.45094096660614014
loss_pred:0.014788066036999226, decouple_loss:0.0004506144323386252
The modified gen p mean: 0.4496549963951111, gen p mean: -0.12587830424308777, mean p set: 0.45023199915885925
loss_pred:0.014624528586864471, decouple_loss:0.0003935002605430782
Iteration: 2482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947168231010437, gen p mean: -0.11927661299705505, mean p set: 0.4500472843647003
loss_pred:0.015630368143320084, decouple_loss:0.0004993291804566979
The modified gen p mean: 0.44887036085128784, gen p mean: -0.12254048138856888, mean p set: 0.4494488537311554The modified gen p mean: 0.44955912232398987, gen p mean: -0.11815434694290161, mean p set: 0.45013532042503357
loss_pred:0.014281626790761948, decouple_loss:0.0004194586363155395
loss_pred:0.015399128198623657, decouple_loss:0.000488738005515188
Iteration: 2483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517095386981964, gen p mean: -0.12074729800224304, mean p set: 0.45228907465934753
loss_pred:0.014875954948365688, decouple_loss:0.0004402772174216807
The modified gen p mean: 0.4498785138130188, gen p mean: -0.12830200791358948, mean p set: 0.4504542350769043
loss_pred:0.014881930314004421, decouple_loss:0.0003296150534879416
The modified gen p mean: 0.4514276385307312, gen p mean: -0.12070990353822708, mean p set: 0.45200514793395996
loss_pred:0.014937937259674072, decouple_loss:0.0003665567492134869
Iteration: 2484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492710828781128, gen p mean: -0.12028709053993225, mean p set: 0.4498482048511505
loss_pred:0.015040161088109016, decouple_loss:0.00034978121402673423
The modified gen p mean: 0.44892576336860657, gen p mean: -0.12306996434926987, mean p set: 0.4495048522949219
loss_pred:0.014974711462855339, decouple_loss:0.0003718745429068804
The modified gen p mean: 0.4496942162513733, gen p mean: -0.11594204604625702, mean p set: 0.45027193427085876
loss_pred:0.014786405488848686, decouple_loss:0.00042794414912350476
Iteration: 2485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504105746746063, gen p mean: -0.12193019688129425, mean p set: 0.450985848903656
loss_pred:0.014554217457771301, decouple_loss:0.00030897630495019257
The modified gen p mean: 0.44850289821624756, gen p mean: -0.11848714202642441, mean p set: 0.44908010959625244
loss_pred:0.015054366551339626, decouple_loss:0.00040816073305904865
The modified gen p mean: 0.4503135681152344, gen p mean: -0.11973588913679123, mean p set: 0.4508911669254303
loss_pred:0.014591860584914684, decouple_loss:0.00044005323434248567
Iteration: 2486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45170044898986816, gen p mean: -0.11432816088199615, mean p set: 0.45227932929992676
loss_pred:0.015467412769794464, decouple_loss:0.0005350789870135486
The modified gen p mean: 0.4494273364543915, gen p mean: -0.1230715662240982, mean p set: 0.4500034749507904
The modified gen p mean: 0.44865190982818604, gen p mean: -0.11735348403453827, mean p set: 0.44922736287117004
loss_pred:0.015533174388110638, decouple_loss:0.0003119724860880524
loss_pred:0.015210834331810474, decouple_loss:0.0003864369064103812
Iteration: 2487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45094406604766846, gen p mean: -0.11362306028604507, mean p set: 0.4515224099159241
loss_pred:0.015354268252849579, decouple_loss:0.0004039210907649249
The modified gen p mean: 0.44892609119415283, gen p mean: -0.12264103442430496, mean p set: 0.4495026767253876
The modified gen p mean: 0.4508899748325348, gen p mean: -0.11503737419843674, mean p set: 0.4514676034450531
loss_pred:0.014144564978778362, decouple_loss:0.0003498090663924813
loss_pred:0.014746482484042645, decouple_loss:0.0003758148814085871
Iteration: 2488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45191776752471924, gen p mean: -0.12336227297782898, mean p set: 0.4524949789047241
loss_pred:0.014334450475871563, decouple_loss:0.0005202532047405839
The modified gen p mean: 0.4502685070037842, gen p mean: -0.1260995715856552, mean p set: 0.45084765553474426
The modified gen p mean: 0.4516962170600891, gen p mean: -0.1197686567902565, mean p set: 0.45227181911468506
loss_pred:0.014144666492938995, decouple_loss:0.00035533675691112876
loss_pred:0.014979562722146511, decouple_loss:0.0005401265225373209
Iteration: 2489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519534111022949, gen p mean: -0.11806696653366089, mean p set: 0.45253291726112366
loss_pred:0.014593813568353653, decouple_loss:0.0004278288106434047
The modified gen p mean: 0.450989305973053, gen p mean: -0.11835390329360962, mean p set: 0.45156344771385193
The modified gen p mean: 0.4529065787792206, gen p mean: -0.1195429265499115, mean p set: 0.45348381996154785
loss_pred:0.014616869390010834, decouple_loss:0.0004599040257744491
loss_pred:0.015082638710737228, decouple_loss:0.0004031300195492804
Iteration: 2490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877225160598755, gen p mean: -0.11801126599311829, mean p set: 0.4493463933467865
loss_pred:0.015171894803643227, decouple_loss:0.00042282763752155006
The modified gen p mean: 0.4485244154930115, gen p mean: -0.12564291059970856, mean p set: 0.44910362362861633
The modified gen p mean: 0.4525999426841736, gen p mean: -0.12245635688304901, mean p set: 0.4531742036342621
loss_pred:0.014617291279137135, decouple_loss:0.0003755035577341914
loss_pred:0.015119785442948341, decouple_loss:0.00040148539119400084
2023-05-02 12:52:57 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1345384418964386, mean p set: 0.4502691626548767
loss_pred:0.016917884349822998, decouple_loss:0.00042000162648037076
The modified gen p mean: 0.4495333433151245, gen p mean: -0.1277408003807068, mean p set: 0.4500633478164673
loss_pred:0.016224531456828117, decouple_loss:0.0005102634313516319
The modified gen p mean: 0.44982606172561646, gen p mean: -0.12756922841072083, mean p set: 0.45035696029663086
loss_pred:0.016605615615844727, decouple_loss:0.00036897274549119174
WV_1_PC_1_EH_0_PS_40, loss: 0.016604332253336906, avg_mse: 0.025880588218569756
current test mse: 0.025881
Iteration: 2491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500717520713806, gen p mean: -0.12302668392658234, mean p set: 0.450647234916687
loss_pred:0.014799455180764198, decouple_loss:0.0003237048804294318
The modified gen p mean: 0.44984766840934753, gen p mean: -0.11733027547597885, mean p set: 0.4504234194755554
loss_pred:0.01566736027598381, decouple_loss:0.0003636906621977687
The modified gen p mean: 0.4520142376422882, gen p mean: -0.11399158090353012, mean p set: 0.4525914490222931
loss_pred:0.014958754181861877, decouple_loss:0.00036537472624331713
Iteration: 2492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495065212249756, gen p mean: -0.1215021088719368, mean p set: 0.45008331537246704
loss_pred:0.014384509064257145, decouple_loss:0.0005185393383726478
The modified gen p mean: 0.4493113160133362, gen p mean: -0.12331406027078629, mean p set: 0.44988515973091125The modified gen p mean: 0.45031285285949707, gen p mean: -0.114560566842556, mean p set: 0.45089030265808105
loss_pred:0.014893998391926289, decouple_loss:0.00041039081406779587loss_pred:0.015023774467408657, decouple_loss:0.0003938472946174443
Iteration: 2493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499325752258301, gen p mean: -0.12447625398635864, mean p set: 0.4505097270011902
loss_pred:0.014359022490680218, decouple_loss:0.0005371067090891302
The modified gen p mean: 0.4522917568683624, gen p mean: -0.11088481545448303, mean p set: 0.45286887884140015
loss_pred:0.01436542347073555, decouple_loss:0.0006713960319757462
The modified gen p mean: 0.4513680040836334, gen p mean: -0.11731017380952835, mean p set: 0.45194414258003235
loss_pred:0.014352437108755112, decouple_loss:0.00036597836879082024
Iteration: 2494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489670395851135, gen p mean: -0.1195453628897667, mean p set: 0.44954198598861694
loss_pred:0.014665946364402771, decouple_loss:0.00036070114583708346
The modified gen p mean: 0.45214253664016724, gen p mean: -0.1157013475894928, mean p set: 0.4527186155319214
loss_pred:0.01426833774894476, decouple_loss:0.0003990227705799043
The modified gen p mean: 0.45041143894195557, gen p mean: -0.1228146106004715, mean p set: 0.4509873688220978
loss_pred:0.014157427474856377, decouple_loss:0.0003633004962466657
Iteration: 2495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45180654525756836, gen p mean: -0.12026894837617874, mean p set: 0.4523826837539673
loss_pred:0.014755186624825, decouple_loss:0.0005716923624277115
The modified gen p mean: 0.44847023487091064, gen p mean: -0.11877991259098053, mean p set: 0.44904735684394836
loss_pred:0.013863835483789444, decouple_loss:0.000465036544483155
The modified gen p mean: 0.4495134949684143, gen p mean: -0.11539703607559204, mean p set: 0.4500887989997864
loss_pred:0.014409465715289116, decouple_loss:0.0005327260587364435
Iteration: 2496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44980740547180176, gen p mean: -0.12765048444271088, mean p set: 0.4503830373287201
loss_pred:0.013852727599442005, decouple_loss:0.0004290157521609217
The modified gen p mean: 0.44912874698638916, gen p mean: -0.12358605116605759, mean p set: 0.4497041702270508
loss_pred:0.014046684838831425, decouple_loss:0.0003103646158706397
The modified gen p mean: 0.45138347148895264, gen p mean: -0.11648435145616531, mean p set: 0.4519574046134949
loss_pred:0.014676603488624096, decouple_loss:0.0004208326281514019
Iteration: 2497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049718022346497, gen p mean: -0.11578913778066635, mean p set: 0.45107173919677734
loss_pred:0.01470105815678835, decouple_loss:0.0004028943367302418
The modified gen p mean: 0.4517442584037781, gen p mean: -0.11625462025403976, mean p set: 0.45232194662094116
loss_pred:0.014462773688137531, decouple_loss:0.00045830669114366174
The modified gen p mean: 0.4511328637599945, gen p mean: -0.11398302763700485, mean p set: 0.45171138644218445
loss_pred:0.014865171164274216, decouple_loss:0.000468359183287248
Iteration: 2498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45131945610046387, gen p mean: -0.11538542062044144, mean p set: 0.45189690589904785
loss_pred:0.014072293415665627, decouple_loss:0.0005824338295497
The modified gen p mean: 0.44915199279785156, gen p mean: -0.12418515235185623, mean p set: 0.4497282803058624
loss_pred:0.014399523846805096, decouple_loss:0.00042718040640465915
The modified gen p mean: 0.4503006935119629, gen p mean: -0.1153048649430275, mean p set: 0.4508790671825409
loss_pred:0.014661582186818123, decouple_loss:0.0005794662865810096
Iteration: 2499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953352212905884, gen p mean: -0.11829718947410583, mean p set: 0.45011085271835327
loss_pred:0.015495040453970432, decouple_loss:0.0004671301576308906
The modified gen p mean: 0.44949057698249817, gen p mean: -0.12458563596010208, mean p set: 0.45006799697875977
loss_pred:0.013979566283524036, decouple_loss:0.00048288938705809414
The modified gen p mean: 0.4493114650249481, gen p mean: -0.12830457091331482, mean p set: 0.44988757371902466
loss_pred:0.013846591114997864, decouple_loss:0.00044378708116710186
Iteration: 2500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877275824546814, gen p mean: -0.1209663599729538, mean p set: 0.44935014843940735
loss_pred:0.013632063753902912, decouple_loss:0.00033238183823414147
The modified gen p mean: 0.4493037760257721, gen p mean: -0.12315314263105392, mean p set: 0.44988009333610535
The modified gen p mean: 0.4522479176521301, gen p mean: -0.11409176886081696, mean p set: 0.45282456278800964
loss_pred:0.013664538972079754, decouple_loss:0.0002834136539604515
loss_pred:0.014612487517297268, decouple_loss:0.0003966204822063446
2023-05-02 12:55:06 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13000504672527313, mean p set: 0.4502691626548767
loss_pred:0.016810515895485878, decouple_loss:0.00043932776316069067
The modified gen p mean: 0.44953453540802, gen p mean: -0.1232258602976799, mean p set: 0.4500633478164673
loss_pred:0.016166774556040764, decouple_loss:0.0005714314756914973
The modified gen p mean: 0.44982773065567017, gen p mean: -0.12319296598434448, mean p set: 0.45035696029663086
loss_pred:0.016517965123057365, decouple_loss:0.0005306300008669496
WV_1_PC_1_EH_0_PS_40, loss: 0.01652410812675953, avg_mse: 0.0257997065782547
current test mse: 0.0258
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
NaN value num: 0
Iteration: 2501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879651069641113, gen p mean: -0.11252639442682266, mean p set: 0.44937264919281006
loss_pred:0.015535284765064716, decouple_loss:0.0005903469282202423
The modified gen p mean: 0.4503118693828583, gen p mean: -0.1246105507016182, mean p set: 0.450888991355896
loss_pred:0.014597009867429733, decouple_loss:0.0005395953776314855
The modified gen p mean: 0.45145100355148315, gen p mean: -0.11908888071775436, mean p set: 0.45202508568763733
loss_pred:0.016807105392217636, decouple_loss:0.0006217968766577542
Iteration: 2502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097097754478455, gen p mean: -0.11674225330352783, mean p set: 0.45154598355293274
loss_pred:0.014490281231701374, decouple_loss:0.0005374360480345786
The modified gen p mean: 0.44940686225891113, gen p mean: -0.1130223348736763, mean p set: 0.4499855935573578The modified gen p mean: 0.4484446048736572, gen p mean: -0.11460461467504501, mean p set: 0.44901934266090393
loss_pred:0.01508359145373106, decouple_loss:0.00037644762778654695loss_pred:0.014707907103002071, decouple_loss:0.0005209848750382662
Iteration: 2503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489084780216217, gen p mean: -0.11383382976055145, mean p set: 0.44948288798332214
loss_pred:0.014341036789119244, decouple_loss:0.0003832205547951162
The modified gen p mean: 0.4490942060947418, gen p mean: -0.1055469661951065, mean p set: 0.44967135787010193The modified gen p mean: 0.4496287405490875, gen p mean: -0.10610183328390121, mean p set: 0.45020708441734314
loss_pred:0.015476015396416187, decouple_loss:0.00037767854519188404
loss_pred:0.015658847987651825, decouple_loss:0.0003729674790520221
Iteration: 2504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494682550430298, gen p mean: -0.11015430837869644, mean p set: 0.4500446021556854
loss_pred:0.015192265622317791, decouple_loss:0.0003645606921054423
The modified gen p mean: 0.45069175958633423, gen p mean: -0.11283561587333679, mean p set: 0.45127037167549133
loss_pred:0.014682354405522346, decouple_loss:0.0006222293013706803
The modified gen p mean: 0.4520729184150696, gen p mean: -0.10857090353965759, mean p set: 0.4526497423648834
loss_pred:0.014902605675160885, decouple_loss:0.0006885885959491134
Iteration: 2505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495418071746826, gen p mean: -0.10963517427444458, mean p set: 0.45011985301971436
loss_pred:0.01452084630727768, decouple_loss:0.0004778205475304276
The modified gen p mean: 0.45014315843582153, gen p mean: -0.10212427377700806, mean p set: 0.45072001218795776
loss_pred:0.01510921586304903, decouple_loss:0.000604835047852248
The modified gen p mean: 0.4475442171096802, gen p mean: -0.10726122558116913, mean p set: 0.44812071323394775
loss_pred:0.01475880853831768, decouple_loss:0.0007411834085360169
Iteration: 2506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502341151237488, gen p mean: -0.11270290613174438, mean p set: 0.45080891251564026
loss_pred:0.01538839004933834, decouple_loss:0.0006234303582459688
The modified gen p mean: 0.4481460750102997, gen p mean: -0.10809340327978134, mean p set: 0.4487208127975464
loss_pred:0.01458132266998291, decouple_loss:0.0004571450699586421
The modified gen p mean: 0.4477896988391876, gen p mean: -0.10355529934167862, mean p set: 0.4483667314052582
loss_pred:0.01511357631534338, decouple_loss:0.0005306063103489578
Iteration: 2507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494464695453644, gen p mean: -0.10724808275699615, mean p set: 0.4500221312046051
loss_pred:0.01432493980973959, decouple_loss:0.000490453967358917
The modified gen p mean: 0.4488249719142914, gen p mean: -0.10317528247833252, mean p set: 0.44940370321273804
The modified gen p mean: 0.44914528727531433, gen p mean: -0.11328618973493576, mean p set: 0.4497230052947998
loss_pred:0.015409293584525585, decouple_loss:0.0004496251931414008
loss_pred:0.014461356215178967, decouple_loss:0.00038966783904470503
Iteration: 2508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726499915122986, gen p mean: -0.11458136141300201, mean p set: 0.44784078001976013
loss_pred:0.014703945256769657, decouple_loss:0.0005277334712445736
The modified gen p mean: 0.45022058486938477, gen p mean: -0.10962427407503128, mean p set: 0.45079630613327026
loss_pred:0.014688899740576744, decouple_loss:0.0004205334116704762
The modified gen p mean: 0.4476979076862335, gen p mean: -0.11274602264165878, mean p set: 0.4482741951942444
loss_pred:0.015124953351914883, decouple_loss:0.0005622412427328527
Iteration: 2509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488671123981476, gen p mean: -0.11201857030391693, mean p set: 0.4494428038597107
loss_pred:0.014992139302194118, decouple_loss:0.0005185523768886924
The modified gen p mean: 0.4486961364746094, gen p mean: -0.1046416237950325, mean p set: 0.4492756426334381
The modified gen p mean: 0.45017555356025696, gen p mean: -0.1061895489692688, mean p set: 0.45075252652168274
loss_pred:0.01603475771844387, decouple_loss:0.0004210853949189186
loss_pred:0.014969861134886742, decouple_loss:0.0003787413297686726
Iteration: 2510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449844628572464, gen p mean: -0.11764423549175262, mean p set: 0.45041805505752563
loss_pred:0.014271453022956848, decouple_loss:0.0003992323763668537
The modified gen p mean: 0.44774824380874634, gen p mean: -0.11079484224319458, mean p set: 0.4483225345611572
The modified gen p mean: 0.44726088643074036, gen p mean: -0.1173291802406311, mean p set: 0.4478350281715393
loss_pred:0.015129347331821918, decouple_loss:0.00038509874138981104
loss_pred:0.015101704746484756, decouple_loss:0.0003334103093948215
2023-05-02 12:58:14 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1252204328775406, mean p set: 0.4502691626548767
loss_pred:0.016834024339914322, decouple_loss:0.00044606695882976055
The modified gen p mean: 0.4495350420475006, gen p mean: -0.11891170591115952, mean p set: 0.4500633478164673
loss_pred:0.016253981739282608, decouple_loss:0.00038676842814311385
The modified gen p mean: 0.4498283863067627, gen p mean: -0.11851342767477036, mean p set: 0.45035696029663086
loss_pred:0.01655069924890995, decouple_loss:0.00038815519656054676
WV_1_PC_1_EH_0_PS_40, loss: 0.01656658574938774, avg_mse: 0.025823144242167473
current test mse: 0.025823
Iteration: 2511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771748781204224, gen p mean: -0.1171589344739914, mean p set: 0.44829264283180237
loss_pred:0.014750110916793346, decouple_loss:0.00040202419040724635
The modified gen p mean: 0.45100072026252747, gen p mean: -0.1128103956580162, mean p set: 0.4515767991542816The modified gen p mean: 0.449744313955307, gen p mean: -0.1162087693810463, mean p set: 0.45031946897506714
loss_pred:0.014258300885558128, decouple_loss:0.0003204793611075729
loss_pred:0.015278123319149017, decouple_loss:0.0003560460754670203
Iteration: 2512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483692944049835, gen p mean: -0.11225510388612747, mean p set: 0.4489456117153168
loss_pred:0.014411172829568386, decouple_loss:0.0003639431088231504
The modified gen p mean: 0.4488108456134796, gen p mean: -0.1077951043844223, mean p set: 0.44938766956329346The modified gen p mean: 0.44935908913612366, gen p mean: -0.11176841706037521, mean p set: 0.44993579387664795
loss_pred:0.014517703093588352, decouple_loss:0.00033188069937750697
loss_pred:0.014564242213964462, decouple_loss:0.0003396136162336916
Iteration: 2513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903841614723206, gen p mean: -0.10394389927387238, mean p set: 0.4496145248413086
loss_pred:0.0158374160528183, decouple_loss:0.0003939878079108894
The modified gen p mean: 0.4477185308933258, gen p mean: -0.11816609650850296, mean p set: 0.44829609990119934
loss_pred:0.015202454291284084, decouple_loss:0.0003400781424716115
The modified gen p mean: 0.45053422451019287, gen p mean: -0.11240154504776001, mean p set: 0.451111376285553
loss_pred:0.014339219778776169, decouple_loss:0.0003352815401740372
Iteration: 2514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45075708627700806, gen p mean: -0.11035735160112381, mean p set: 0.4513324499130249
loss_pred:0.014429823495447636, decouple_loss:0.0003015980764757842
The modified gen p mean: 0.44847023487091064, gen p mean: -0.10851599276065826, mean p set: 0.44904619455337524
loss_pred:0.0157806184142828, decouple_loss:0.0003860389697365463
The modified gen p mean: 0.4503876268863678, gen p mean: -0.1088782548904419, mean p set: 0.4509623348712921
loss_pred:0.01531927939504385, decouple_loss:0.0004123728140257299
Iteration: 2515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503612816333771, gen p mean: -0.11221101880073547, mean p set: 0.4509376883506775
loss_pred:0.01435866579413414, decouple_loss:0.0003921265888493508
The modified gen p mean: 0.45101696252822876, gen p mean: -0.1097075343132019, mean p set: 0.4515925347805023
loss_pred:0.01423689629882574, decouple_loss:0.0006698971264995635
The modified gen p mean: 0.4493831396102905, gen p mean: -0.11183559894561768, mean p set: 0.4499594569206238
loss_pred:0.014389953576028347, decouple_loss:0.0005531358765438199
Iteration: 2516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496757686138153, gen p mean: -0.10405974090099335, mean p set: 0.4502522349357605
loss_pred:0.014303524047136307, decouple_loss:0.000367199070751667
The modified gen p mean: 0.45164743065834045, gen p mean: -0.10530038177967072, mean p set: 0.45222434401512146
The modified gen p mean: 0.4501465857028961, gen p mean: -0.10419659316539764, mean p set: 0.4507228434085846
loss_pred:0.014749527908861637, decouple_loss:0.00047699225251562893
loss_pred:0.01453506201505661, decouple_loss:0.0004622321866918355
Iteration: 2517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449383020401001, gen p mean: -0.10522951930761337, mean p set: 0.4499596655368805
loss_pred:0.014398333616554737, decouple_loss:0.0002907476737163961
The modified gen p mean: 0.4491353929042816, gen p mean: -0.09747578948736191, mean p set: 0.44971367716789246
loss_pred:0.0156007781624794, decouple_loss:0.00037729335599578917
The modified gen p mean: 0.45132923126220703, gen p mean: -0.10783878713846207, mean p set: 0.4519057869911194
loss_pred:0.016299717128276825, decouple_loss:0.00037352461367845535
Iteration: 2518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45073479413986206, gen p mean: -0.10118222236633301, mean p set: 0.45131269097328186
loss_pred:0.014059829525649548, decouple_loss:0.00043402548180893064
The modified gen p mean: 0.4485377073287964, gen p mean: -0.10065338015556335, mean p set: 0.4491138160228729
The modified gen p mean: 0.44984880089759827, gen p mean: -0.09994726628065109, mean p set: 0.4504237771034241
loss_pred:0.014858884736895561, decouple_loss:0.00038510013837367296
loss_pred:0.015053153969347477, decouple_loss:0.000440115574747324
Iteration: 2519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448856383562088, gen p mean: -0.10781510174274445, mean p set: 0.44943416118621826
loss_pred:0.0142712676897645, decouple_loss:0.0004963917308486998
The modified gen p mean: 0.448067307472229, gen p mean: -0.10659651458263397, mean p set: 0.4486435651779175
loss_pred:0.014309274032711983, decouple_loss:0.000461009971331805
The modified gen p mean: 0.4510330557823181, gen p mean: -0.10747094452381134, mean p set: 0.45161086320877075
loss_pred:0.014798487536609173, decouple_loss:0.00034922113991342485
Iteration: 2520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447284996509552, gen p mean: -0.11628586798906326, mean p set: 0.4478597342967987
loss_pred:0.015016602352261543, decouple_loss:0.00035341616603545845
The modified gen p mean: 0.4503357410430908, gen p mean: -0.11138983815908432, mean p set: 0.45091089606285095
loss_pred:0.014536000788211823, decouple_loss:0.00041086648707278073
The modified gen p mean: 0.45022857189178467, gen p mean: -0.1090020164847374, mean p set: 0.4508056342601776
loss_pred:0.014045191928744316, decouple_loss:0.00038276767008937895
2023-05-02 13:00:20 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12384741008281708, mean p set: 0.4502691626548767
loss_pred:0.016872523352503777, decouple_loss:0.0003736456565093249
The modified gen p mean: 0.4495352506637573, gen p mean: -0.11811559647321701, mean p set: 0.4500633478164673
loss_pred:0.016286466270685196, decouple_loss:0.0004528397403191775
The modified gen p mean: 0.4498281180858612, gen p mean: -0.11766796559095383, mean p set: 0.45035696029663086
loss_pred:0.01652274653315544, decouple_loss:0.00044225138844922185
WV_1_PC_1_EH_0_PS_40, loss: 0.01658172532916069, avg_mse: 0.025860188528895378
current test mse: 0.02586
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
NaN value num: 0
Iteration: 2521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487246572971344, gen p mean: -0.1191202774643898, mean p set: 0.4492984712123871
loss_pred:0.01474779099225998, decouple_loss:0.00035398892941884696
The modified gen p mean: 0.4495096206665039, gen p mean: -0.1214427575469017, mean p set: 0.45008379220962524
loss_pred:0.015136606059968472, decouple_loss:0.0003630982537288219
The modified gen p mean: 0.44833746552467346, gen p mean: -0.11953885108232498, mean p set: 0.44891470670700073
loss_pred:0.015184463933110237, decouple_loss:0.00047684836317785084
Iteration: 2522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678840041160583, gen p mean: -0.12247461825609207, mean p set: 0.4473629891872406
loss_pred:0.015815865248441696, decouple_loss:0.00046542880591005087
The modified gen p mean: 0.44601061940193176, gen p mean: -0.1215183213353157, mean p set: 0.4465877413749695The modified gen p mean: 0.4477708637714386, gen p mean: -0.11856520920991898, mean p set: 0.44834744930267334
loss_pred:0.016034604981541634, decouple_loss:0.0004996532225050032
loss_pred:0.016198784112930298, decouple_loss:0.0006390018970705569
Iteration: 2523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745567440986633, gen p mean: -0.12085554748773575, mean p set: 0.4480300843715668
loss_pred:0.015280447900295258, decouple_loss:0.0004898325423710048
The modified gen p mean: 0.448315292596817, gen p mean: -0.12271063029766083, mean p set: 0.4488913118839264
loss_pred:0.015542424283921719, decouple_loss:0.0004156154172960669
The modified gen p mean: 0.44937390089035034, gen p mean: -0.12085932493209839, mean p set: 0.44994887709617615
loss_pred:0.01531202346086502, decouple_loss:0.0004854578583035618
Iteration: 2524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476550817489624, gen p mean: -0.11519704759120941, mean p set: 0.4482339918613434
loss_pred:0.015752729028463364, decouple_loss:0.0004946558619849384
The modified gen p mean: 0.44806861877441406, gen p mean: -0.11786223948001862, mean p set: 0.4486467242240906
loss_pred:0.015835218131542206, decouple_loss:0.0005066327867098153
The modified gen p mean: 0.4477863609790802, gen p mean: -0.12101990729570389, mean p set: 0.4483628571033478
loss_pred:0.0167783685028553, decouple_loss:0.00032026960980147123
Iteration: 2525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786688685417175, gen p mean: -0.11886312067508698, mean p set: 0.44844383001327515
loss_pred:0.014902034774422646, decouple_loss:0.00047658904804848135
The modified gen p mean: 0.44674795866012573, gen p mean: -0.12150415033102036, mean p set: 0.4473235011100769
loss_pred:0.01672804355621338, decouple_loss:0.00047603738494217396
The modified gen p mean: 0.4469025433063507, gen p mean: -0.12147373706102371, mean p set: 0.44747960567474365
loss_pred:0.014949016273021698, decouple_loss:0.0005265379440970719
Iteration: 2526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743895530700684, gen p mean: -0.1239955723285675, mean p set: 0.448015421628952
loss_pred:0.01500335056334734, decouple_loss:0.0003837464319076389
The modified gen p mean: 0.44782790541648865, gen p mean: -0.11611030250787735, mean p set: 0.4484068751335144
loss_pred:0.015362268313765526, decouple_loss:0.0003824050072580576
The modified gen p mean: 0.4477947950363159, gen p mean: -0.11924559623003006, mean p set: 0.44836878776550293
loss_pred:0.015503927133977413, decouple_loss:0.00039376519271172583
Iteration: 2527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471907913684845, gen p mean: -0.12081814557313919, mean p set: 0.44776758551597595
loss_pred:0.015725480392575264, decouple_loss:0.0005283941864036024
The modified gen p mean: 0.4467827379703522, gen p mean: -0.12327481806278229, mean p set: 0.44735774397850037
The modified gen p mean: 0.4481891095638275, gen p mean: -0.1209845319390297, mean p set: 0.44876575469970703
loss_pred:0.015542672015726566, decouple_loss:0.00036479116533882916
loss_pred:0.015504991635680199, decouple_loss:0.00036021359846927226
Iteration: 2528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781944155693054, gen p mean: -0.1256871521472931, mean p set: 0.44839391112327576
loss_pred:0.01516680233180523, decouple_loss:0.00038296901038847864
The modified gen p mean: 0.44789350032806396, gen p mean: -0.12647388875484467, mean p set: 0.44846805930137634
The modified gen p mean: 0.44570308923721313, gen p mean: -0.12460403144359589, mean p set: 0.44628140330314636
loss_pred:0.015914181247353554, decouple_loss:0.0005025986465625465
loss_pred:0.015732765197753906, decouple_loss:0.00039577955612912774
Iteration: 2529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44633570313453674, gen p mean: -0.12210767716169357, mean p set: 0.4469138979911804The modified gen p mean: 0.4479333460330963, gen p mean: -0.11807747930288315, mean p set: 0.4485074579715729
loss_pred:0.01677600108087063, decouple_loss:0.00037465195055119693
loss_pred:0.015131315216422081, decouple_loss:0.0003557190066203475
The modified gen p mean: 0.44765955209732056, gen p mean: -0.12551265954971313, mean p set: 0.44823703169822693
loss_pred:0.01675323024392128, decouple_loss:0.00045877377851866186
Iteration: 2530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469223916530609, gen p mean: -0.12489047646522522, mean p set: 0.4474983811378479
The modified gen p mean: 0.44817405939102173, gen p mean: -0.12689124047756195, mean p set: 0.4487498700618744
loss_pred:0.015414922498166561, decouple_loss:0.0005994835519231856
loss_pred:0.014774808660149574, decouple_loss:0.00046729124733246863
The modified gen p mean: 0.4483749568462372, gen p mean: -0.1189730316400528, mean p set: 0.44894686341285706
loss_pred:0.015699787065386772, decouple_loss:0.00036043673753738403
2023-05-02 13:03:34 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13071206212043762, mean p set: 0.4502691626548767
loss_pred:0.01688876561820507, decouple_loss:0.0004970961599610746
The modified gen p mean: 0.4495348334312439, gen p mean: -0.12417325377464294, mean p set: 0.4500633478164673
loss_pred:0.016276221722364426, decouple_loss:0.0004782290488947183
The modified gen p mean: 0.4498305916786194, gen p mean: -0.12371109426021576, mean p set: 0.45035696029663086
loss_pred:0.016460303217172623, decouple_loss:0.00044651905773207545
WV_1_PC_1_EH_0_PS_40, loss: 0.016565462574362755, avg_mse: 0.025855641812086105
current test mse: 0.025856
Iteration: 2531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44641759991645813, gen p mean: -0.12380001693964005, mean p set: 0.4469919800758362
loss_pred:0.01651723124086857, decouple_loss:0.00041709403740242124
The modified gen p mean: 0.4474297761917114, gen p mean: -0.13024581968784332, mean p set: 0.44800424575805664
loss_pred:0.014989740215241909, decouple_loss:0.0005125491297803819
The modified gen p mean: 0.4474610984325409, gen p mean: -0.12654437124729156, mean p set: 0.4480408728122711
loss_pred:0.016038866713643074, decouple_loss:0.0004417784512042999
Iteration: 2532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480653703212738, gen p mean: -0.12777766585350037, mean p set: 0.4486440122127533
loss_pred:0.01583690196275711, decouple_loss:0.00035250914515927434
The modified gen p mean: 0.4474399983882904, gen p mean: -0.13344648480415344, mean p set: 0.4480130672454834The modified gen p mean: 0.44737765192985535, gen p mean: -0.13060253858566284, mean p set: 0.44795146584510803
loss_pred:0.015667933970689774, decouple_loss:0.0004489563580136746
loss_pred:0.015356560237705708, decouple_loss:0.00045754312304779887
Iteration: 2533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447537362575531, gen p mean: -0.1334604024887085, mean p set: 0.44811269640922546
loss_pred:0.015917198732495308, decouple_loss:0.0004445345257408917
The modified gen p mean: 0.4470061957836151, gen p mean: -0.12758009135723114, mean p set: 0.4475806653499603
loss_pred:0.015213611535727978, decouple_loss:0.00046131614362820983
The modified gen p mean: 0.44701558351516724, gen p mean: -0.13122877478599548, mean p set: 0.44758832454681396
loss_pred:0.01668880507349968, decouple_loss:0.0004513550375122577
Iteration: 2534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474628269672394, gen p mean: -0.13017205893993378, mean p set: 0.44804099202156067
loss_pred:0.015316064469516277, decouple_loss:0.0004438837931957096
The modified gen p mean: 0.4477704167366028, gen p mean: -0.13374781608581543, mean p set: 0.44834810495376587
loss_pred:0.015533403493463993, decouple_loss:0.0004767351201735437
The modified gen p mean: 0.4489540755748749, gen p mean: -0.13041546940803528, mean p set: 0.4495314955711365
loss_pred:0.015801943838596344, decouple_loss:0.0003995372971985489
Iteration: 2535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750699400901794, gen p mean: -0.1318989247083664, mean p set: 0.4480820298194885
loss_pred:0.015216559171676636, decouple_loss:0.00032818299951031804
The modified gen p mean: 0.4474852681159973, gen p mean: -0.13106131553649902, mean p set: 0.4480629861354828
loss_pred:0.015440861694514751, decouple_loss:0.00039731283322907984
The modified gen p mean: 0.4474802315235138, gen p mean: -0.13570591807365417, mean p set: 0.4480586349964142
loss_pred:0.01569378562271595, decouple_loss:0.00040347425965592265
Iteration: 2536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831374287605286, gen p mean: -0.13219036161899567, mean p set: 0.4488873779773712
loss_pred:0.015851927921175957, decouple_loss:0.0005864127888344228
The modified gen p mean: 0.4477991461753845, gen p mean: -0.12663555145263672, mean p set: 0.4483754336833954
loss_pred:0.015523655340075493, decouple_loss:0.0005004192353226244
The modified gen p mean: 0.44753363728523254, gen p mean: -0.12787581980228424, mean p set: 0.4481058716773987
loss_pred:0.015270298346877098, decouple_loss:0.00039919171831570566
Iteration: 2537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454343318939209, gen p mean: -0.12801961600780487, mean p set: 0.4460088610649109
loss_pred:0.015712356194853783, decouple_loss:0.0004842981870751828
The modified gen p mean: 0.447370320558548, gen p mean: -0.13309374451637268, mean p set: 0.4479452073574066
loss_pred:0.014798739925026894, decouple_loss:0.0005446180584840477
The modified gen p mean: 0.4468708634376526, gen p mean: -0.132561594247818, mean p set: 0.44744521379470825
loss_pred:0.01569445990025997, decouple_loss:0.0003539501631166786
Iteration: 2538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469100534915924, gen p mean: -0.130649596452713, mean p set: 0.44748660922050476
loss_pred:0.015178498812019825, decouple_loss:0.000369642220903188
The modified gen p mean: 0.4471478760242462, gen p mean: -0.13219374418258667, mean p set: 0.4477272629737854
The modified gen p mean: 0.44892460107803345, gen p mean: -0.12804387509822845, mean p set: 0.4494989514350891
loss_pred:0.015728721395134926, decouple_loss:0.0004239026748109609
loss_pred:0.015473333187401295, decouple_loss:0.00036237086169421673
Iteration: 2539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838711619377136, gen p mean: -0.13326974213123322, mean p set: 0.4489644169807434
loss_pred:0.014694808050990105, decouple_loss:0.0003352700441610068
The modified gen p mean: 0.4483058452606201, gen p mean: -0.1308247298002243, mean p set: 0.448879599571228
loss_pred:0.01523988414555788, decouple_loss:0.0003935032873414457
The modified gen p mean: 0.4475969672203064, gen p mean: -0.1325094848871231, mean p set: 0.44817492365837097
loss_pred:0.014698708429932594, decouple_loss:0.000347762688761577
Iteration: 2540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468137323856354, gen p mean: -0.1262156367301941, mean p set: 0.4473893940448761
loss_pred:0.015752559527754784, decouple_loss:0.00040746034937910736
The modified gen p mean: 0.4473988115787506, gen p mean: -0.13252483308315277, mean p set: 0.44797322154045105
loss_pred:0.01560472883284092, decouple_loss:0.0004320107400417328
The modified gen p mean: 0.44825664162635803, gen p mean: -0.12874862551689148, mean p set: 0.44883236289024353
loss_pred:0.015626108273863792, decouple_loss:0.00044492760207504034
2023-05-02 13:05:41 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13273099064826965, mean p set: 0.4502691626548767
loss_pred:0.01682329550385475, decouple_loss:0.00046194199239835143
The modified gen p mean: 0.44953545928001404, gen p mean: -0.12579584121704102, mean p set: 0.4500633478164673
loss_pred:0.01624840684235096, decouple_loss:0.00038100825622677803
The modified gen p mean: 0.4498286843299866, gen p mean: -0.125444695353508, mean p set: 0.45035696029663086
loss_pred:0.016554120928049088, decouple_loss:0.0004223523137625307
WV_1_PC_1_EH_0_PS_40, loss: 0.01656302809715271, avg_mse: 0.025874635204672813
current test mse: 0.025875
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 2541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45005398988723755, gen p mean: -0.1246362030506134, mean p set: 0.4506319463253021
loss_pred:0.01569582149386406, decouple_loss:0.000384041661163792
The modified gen p mean: 0.4497941732406616, gen p mean: -0.12711171805858612, mean p set: 0.45036831498146057
loss_pred:0.01574675366282463, decouple_loss:0.00042468641186133027
The modified gen p mean: 0.449989914894104, gen p mean: -0.1289466917514801, mean p set: 0.45056453347206116
loss_pred:0.016360696405172348, decouple_loss:0.0003966882359236479
Iteration: 2542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915658235549927, gen p mean: -0.12573131918907166, mean p set: 0.44973650574684143
loss_pred:0.015386613085865974, decouple_loss:0.00039276835741475224
The modified gen p mean: 0.4501844048500061, gen p mean: -0.1193893775343895, mean p set: 0.4507621228694916The modified gen p mean: 0.45014381408691406, gen p mean: -0.12475301325321198, mean p set: 0.4507182538509369
loss_pred:0.016145184636116028, decouple_loss:0.0003837228287011385
loss_pred:0.01532159186899662, decouple_loss:0.0004628176975529641
Iteration: 2543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934067130088806, gen p mean: -0.1227617859840393, mean p set: 0.4499199688434601
loss_pred:0.01581582985818386, decouple_loss:0.0003822504368145019
The modified gen p mean: 0.4481191039085388, gen p mean: -0.12197751551866531, mean p set: 0.4486955404281616
loss_pred:0.016045354306697845, decouple_loss:0.0004950161674059927
The modified gen p mean: 0.45015639066696167, gen p mean: -0.12444233149290085, mean p set: 0.45073747634887695
loss_pred:0.016473984345793724, decouple_loss:0.00043433744576759636
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45069512724876404, gen p mean: -0.12445930391550064, mean p set: 0.45127072930336
loss_pred:0.015875348821282387, decouple_loss:0.0003329240716993809
The modified gen p mean: 0.4506795108318329, gen p mean: -0.11902806907892227, mean p set: 0.4512575566768646
loss_pred:0.01591053418815136, decouple_loss:0.0003587622777558863
The modified gen p mean: 0.4495728313922882, gen p mean: -0.11981644481420517, mean p set: 0.45014673471450806
loss_pred:0.01550275832414627, decouple_loss:0.00041729502845555544
Iteration: 2545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45004671812057495, gen p mean: -0.11677490174770355, mean p set: 0.45062586665153503
loss_pred:0.016044629737734795, decouple_loss:0.0003844720486085862
The modified gen p mean: 0.4495587944984436, gen p mean: -0.1139175295829773, mean p set: 0.450135201215744
loss_pred:0.015159602276980877, decouple_loss:0.0004635173245333135
The modified gen p mean: 0.44983842968940735, gen p mean: -0.11160273104906082, mean p set: 0.4504148066043854
loss_pred:0.016126194968819618, decouple_loss:0.0003812763898167759
Iteration: 2546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492599666118622, gen p mean: -0.1164059191942215, mean p set: 0.4498342275619507
loss_pred:0.015496093779802322, decouple_loss:0.0004495635803323239
The modified gen p mean: 0.45007380843162537, gen p mean: -0.11162213981151581, mean p set: 0.4506498873233795
loss_pred:0.016046088188886642, decouple_loss:0.00036896485835313797
The modified gen p mean: 0.44861462712287903, gen p mean: -0.11343839019536972, mean p set: 0.4491916298866272
loss_pred:0.015795821323990822, decouple_loss:0.0005549037014134228
Iteration: 2547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511411786079407, gen p mean: -0.11348747462034225, mean p set: 0.4517151713371277
loss_pred:0.016061648726463318, decouple_loss:0.00035178338293917477
The modified gen p mean: 0.45001059770584106, gen p mean: -0.11783026158809662, mean p set: 0.45058757066726685
loss_pred:0.015730688348412514, decouple_loss:0.0003510379756335169
The modified gen p mean: 0.4492560029029846, gen p mean: -0.11793868988752365, mean p set: 0.4498307406902313
loss_pred:0.015100945718586445, decouple_loss:0.0003139034961350262
Iteration: 2548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45052585005760193, gen p mean: -0.11361619830131531, mean p set: 0.451102077960968
loss_pred:0.015444180928170681, decouple_loss:0.00041940712253563106
The modified gen p mean: 0.450587660074234, gen p mean: -0.1144004538655281, mean p set: 0.45116761326789856
loss_pred:0.016017485409975052, decouple_loss:0.00040936365257948637
The modified gen p mean: 0.4504986107349396, gen p mean: -0.1123310849070549, mean p set: 0.4510757029056549
loss_pred:0.016351481899619102, decouple_loss:0.00038541352842003107
Iteration: 2549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498063623905182, gen p mean: -0.11487303674221039, mean p set: 0.45038241147994995
loss_pred:0.015319190919399261, decouple_loss:0.0004175502108410001
The modified gen p mean: 0.44976353645324707, gen p mean: -0.11902560293674469, mean p set: 0.4503425657749176
loss_pred:0.015140650793910027, decouple_loss:0.0003120054316241294
The modified gen p mean: 0.4493767321109772, gen p mean: -0.11309240758419037, mean p set: 0.44995349645614624
loss_pred:0.015598773956298828, decouple_loss:0.0003852890804409981
Iteration: 2550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506229758262634, gen p mean: -0.11747627705335617, mean p set: 0.4511975646018982
loss_pred:0.015137022361159325, decouple_loss:0.0003850480425171554
The modified gen p mean: 0.4496796727180481, gen p mean: -0.11501964926719666, mean p set: 0.4502556622028351
loss_pred:0.015820734202861786, decouple_loss:0.00035022609517909586
The modified gen p mean: 0.4504259526729584, gen p mean: -0.12153254449367523, mean p set: 0.4510018229484558
loss_pred:0.016629228368401527, decouple_loss:0.00037376550608314574
2023-05-02 13:08:52 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12715670466423035, mean p set: 0.4502691626548767
loss_pred:0.016695303842425346, decouple_loss:0.0004749246290884912
The modified gen p mean: 0.44953733682632446, gen p mean: -0.12122669070959091, mean p set: 0.4500633478164673
loss_pred:0.016094457358121872, decouple_loss:0.00046860944712534547
The modified gen p mean: 0.4498290419578552, gen p mean: -0.12092900276184082, mean p set: 0.45035696029663086
loss_pred:0.016419898718595505, decouple_loss:0.0004882158536929637
WV_1_PC_1_EH_0_PS_40, loss: 0.01642708294093609, avg_mse: 0.025592617690563202
current test mse: 0.025593
At step 2550, Best test: 0.025593
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 2551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485158324241638, gen p mean: -0.12080597877502441, mean p set: 0.4490925073623657
loss_pred:0.015886809676885605, decouple_loss:0.0003354427171871066
The modified gen p mean: 0.4490396976470947, gen p mean: -0.12203259766101837, mean p set: 0.4496159553527832
loss_pred:0.01555973757058382, decouple_loss:0.00041975980275310576
The modified gen p mean: 0.4490114152431488, gen p mean: -0.12015797197818756, mean p set: 0.4495888352394104
loss_pred:0.015539219602942467, decouple_loss:0.00045109697384759784
Iteration: 2552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915199279785156, gen p mean: -0.12248353660106659, mean p set: 0.44972866773605347
loss_pred:0.016104931011795998, decouple_loss:0.0003994347353000194
The modified gen p mean: 0.4494626522064209, gen p mean: -0.12648247182369232, mean p set: 0.4500381648540497The modified gen p mean: 0.45010069012641907, gen p mean: -0.11835046857595444, mean p set: 0.45067691802978516
loss_pred:0.015324888750910759, decouple_loss:0.00033517894917167723
loss_pred:0.015891553834080696, decouple_loss:0.0005326876416802406
Iteration: 2553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45003989338874817, gen p mean: -0.1314946711063385, mean p set: 0.4506154954433441
The modified gen p mean: 0.44970959424972534, gen p mean: -0.12689833343029022, mean p set: 0.4502823054790497loss_pred:0.016030412167310715, decouple_loss:0.00032663054298609495
loss_pred:0.015647003427147865, decouple_loss:0.00031673823832534254
The modified gen p mean: 0.4493108093738556, gen p mean: -0.12714919447898865, mean p set: 0.44988352060317993
loss_pred:0.014851170592010021, decouple_loss:0.00035761334584094584
Iteration: 2554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503495693206787, gen p mean: -0.12285958230495453, mean p set: 0.45092761516571045
The modified gen p mean: 0.4496314525604248, gen p mean: -0.12870670855045319, mean p set: 0.4502067267894745
loss_pred:0.015757743269205093, decouple_loss:0.00042392255272716284
loss_pred:0.015301018953323364, decouple_loss:0.00048241723561659455
The modified gen p mean: 0.4485870599746704, gen p mean: -0.1266298145055771, mean p set: 0.4491656422615051
loss_pred:0.015763984993100166, decouple_loss:0.00044414473813958466
Iteration: 2555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492250382900238, gen p mean: -0.12605927884578705, mean p set: 0.4498046338558197
loss_pred:0.016034584492444992, decouple_loss:0.00033071122015826404
The modified gen p mean: 0.4500059187412262, gen p mean: -0.13417068123817444, mean p set: 0.450583815574646
loss_pred:0.01590670272707939, decouple_loss:0.00029899674700573087
The modified gen p mean: 0.450283408164978, gen p mean: -0.12395807355642319, mean p set: 0.4508611261844635
loss_pred:0.01589978300035, decouple_loss:0.00036897731479257345
Iteration: 2556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44923657178878784, gen p mean: -0.12816819548606873, mean p set: 0.4498143792152405
loss_pred:0.015575663186609745, decouple_loss:0.0002903175773099065
The modified gen p mean: 0.4495622217655182, gen p mean: -0.13199669122695923, mean p set: 0.4501415491104126
loss_pred:0.015358376316726208, decouple_loss:0.00040370956412516534
The modified gen p mean: 0.4502438008785248, gen p mean: -0.1279817670583725, mean p set: 0.4508230984210968
loss_pred:0.01559005118906498, decouple_loss:0.00031456045689992607
Iteration: 2557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480336904525757, gen p mean: -0.12850873172283173, mean p set: 0.448609322309494
loss_pred:0.01588345691561699, decouple_loss:0.0003693671606015414
The modified gen p mean: 0.4488731324672699, gen p mean: -0.12817196547985077, mean p set: 0.44944941997528076
The modified gen p mean: 0.4507306218147278, gen p mean: -0.1313771903514862, mean p set: 0.4513084292411804
loss_pred:0.01563110388815403, decouple_loss:0.0003490058588795364
loss_pred:0.015778332948684692, decouple_loss:0.00032568766619078815
Iteration: 2558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486154615879059, gen p mean: -0.13079263269901276, mean p set: 0.4491928219795227
loss_pred:0.015287378802895546, decouple_loss:0.0004082786035723984
The modified gen p mean: 0.44931238889694214, gen p mean: -0.12751531600952148, mean p set: 0.44988662004470825
loss_pred:0.015681074932217598, decouple_loss:0.0003559838223736733
The modified gen p mean: 0.4489527642726898, gen p mean: -0.12783218920230865, mean p set: 0.44952836632728577
loss_pred:0.015201423317193985, decouple_loss:0.000298213999485597
Iteration: 2559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960200786590576, gen p mean: -0.12382553517818451, mean p set: 0.45017993450164795
loss_pred:0.01553101371973753, decouple_loss:0.0003883284516632557
The modified gen p mean: 0.44880303740501404, gen p mean: -0.12487051635980606, mean p set: 0.4493815302848816
The modified gen p mean: 0.4494900107383728, gen p mean: -0.12424247711896896, mean p set: 0.45006564259529114
loss_pred:0.01583065651357174, decouple_loss:0.0003497845900710672
loss_pred:0.015658976510167122, decouple_loss:0.0003408929333090782
Iteration: 2560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037055015563965, gen p mean: -0.12210603058338165, mean p set: 0.4509483277797699
loss_pred:0.01629536598920822, decouple_loss:0.00044190167682245374
The modified gen p mean: 0.4491235315799713, gen p mean: -0.12182508409023285, mean p set: 0.4496990144252777
The modified gen p mean: 0.44925734400749207, gen p mean: -0.11829540878534317, mean p set: 0.4498307704925537
loss_pred:0.01612582989037037, decouple_loss:0.0003267151187174022
loss_pred:0.015688231214880943, decouple_loss:0.00036770905717276037
2023-05-02 13:11:03 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12834443151950836, mean p set: 0.4502691626548767
loss_pred:0.016671184450387955, decouple_loss:0.0004030373238492757
The modified gen p mean: 0.4495340585708618, gen p mean: -0.12273385375738144, mean p set: 0.4500633478164673
loss_pred:0.01607995294034481, decouple_loss:0.00041844521183520555
The modified gen p mean: 0.44982969760894775, gen p mean: -0.12222711741924286, mean p set: 0.45035696029663086
loss_pred:0.01635856367647648, decouple_loss:0.000343148538377136
WV_1_PC_1_EH_0_PS_40, loss: 0.016389310359954834, avg_mse: 0.02554481476545334
current test mse: 0.025545
At step 2560, Best test: 0.025545
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
NaN value num: 0
Iteration: 2561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45072174072265625, gen p mean: -0.12304620444774628, mean p set: 0.4512959122657776
loss_pred:0.014180583879351616, decouple_loss:0.0004489365383051336
The modified gen p mean: 0.45159444212913513, gen p mean: -0.11896070092916489, mean p set: 0.4521713852882385
loss_pred:0.01397830992937088, decouple_loss:0.0005006746505387127
The modified gen p mean: 0.4525379240512848, gen p mean: -0.11856730282306671, mean p set: 0.45311427116394043
loss_pred:0.014611024409532547, decouple_loss:0.0005357881309464574
Iteration: 2562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45316609740257263, gen p mean: -0.11906849592924118, mean p set: 0.45374393463134766
loss_pred:0.014175107702612877, decouple_loss:0.00045241002226248384
The modified gen p mean: 0.4519979655742645, gen p mean: -0.11306227743625641, mean p set: 0.45257216691970825
The modified gen p mean: 0.45022502541542053, gen p mean: -0.11693952232599258, mean p set: 0.45080041885375977
loss_pred:0.014285417273640633, decouple_loss:0.0004767744103446603
loss_pred:0.014963568188250065, decouple_loss:0.000325523316860199
Iteration: 2563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45195645093917847, gen p mean: -0.11058061569929123, mean p set: 0.4525352716445923
loss_pred:0.014889085665345192, decouple_loss:0.0004065294924657792
The modified gen p mean: 0.4549785852432251, gen p mean: -0.11346922069787979, mean p set: 0.4555578827857971
The modified gen p mean: 0.44944649934768677, gen p mean: -0.11082182079553604, mean p set: 0.4500231444835663
loss_pred:0.014930494129657745, decouple_loss:0.0004058158665429801
loss_pred:0.015442583709955215, decouple_loss:0.00046346025192178786
Iteration: 2564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514307379722595, gen p mean: -0.11327886581420898, mean p set: 0.4520109295845032
The modified gen p mean: 0.4516583979129791, gen p mean: -0.10403114557266235, mean p set: 0.4522334337234497
loss_pred:0.014872035942971706, decouple_loss:0.000497737608384341
loss_pred:0.014751200564205647, decouple_loss:0.0005601305747404695
The modified gen p mean: 0.4510483741760254, gen p mean: -0.10785241425037384, mean p set: 0.4516242742538452
loss_pred:0.0148623613640666, decouple_loss:0.00039731289143674076
Iteration: 2565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496639668941498, gen p mean: -0.10522186011075974, mean p set: 0.45023927092552185
The modified gen p mean: 0.451139897108078, gen p mean: -0.10667040944099426, mean p set: 0.4517159163951874
loss_pred:0.015534764155745506, decouple_loss:0.00046159286284819245
loss_pred:0.014991617761552334, decouple_loss:0.00047803675988689065
The modified gen p mean: 0.45266348123550415, gen p mean: -0.11074136942625046, mean p set: 0.45324212312698364
loss_pred:0.013832973316311836, decouple_loss:0.00043139184708707035
Iteration: 2566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104193687438965, gen p mean: -0.11390607804059982, mean p set: 0.4516180753707886
loss_pred:0.014421101659536362, decouple_loss:0.0004335397097747773
The modified gen p mean: 0.4524918794631958, gen p mean: -0.1049378365278244, mean p set: 0.4530712962150574
loss_pred:0.014104369096457958, decouple_loss:0.0004887240938842297
The modified gen p mean: 0.45108047127723694, gen p mean: -0.10846977680921555, mean p set: 0.4516550898551941
loss_pred:0.014467700384557247, decouple_loss:0.0003973072743974626
Iteration: 2567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45317935943603516, gen p mean: -0.11269572377204895, mean p set: 0.45375576615333557
loss_pred:0.01398173626512289, decouple_loss:0.00039063848089426756
The modified gen p mean: 0.4524897634983063, gen p mean: -0.11041560769081116, mean p set: 0.45306602120399475
The modified gen p mean: 0.45259708166122437, gen p mean: -0.1142214983701706, mean p set: 0.45317476987838745
loss_pred:0.01425950974225998, decouple_loss:0.0007688850746490061
loss_pred:0.014000493101775646, decouple_loss:0.00044158700620755553
Iteration: 2568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45197126269340515, gen p mean: -0.110891193151474, mean p set: 0.45254871249198914
loss_pred:0.015068908222019672, decouple_loss:0.00037903207703493536
The modified gen p mean: 0.449552059173584, gen p mean: -0.11240923404693604, mean p set: 0.4501282274723053
loss_pred:0.01502623688429594, decouple_loss:0.0004250855708960444
The modified gen p mean: 0.45258545875549316, gen p mean: -0.11128129065036774, mean p set: 0.45316070318222046
loss_pred:0.014349782839417458, decouple_loss:0.0004213216307107359
Iteration: 2569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491633474826813, gen p mean: -0.11984117329120636, mean p set: 0.44974127411842346
loss_pred:0.014932375401258469, decouple_loss:0.0007096062763594091
The modified gen p mean: 0.45215749740600586, gen p mean: -0.12039268761873245, mean p set: 0.4527343511581421
loss_pred:0.014742867089807987, decouple_loss:0.0006300913519226015
The modified gen p mean: 0.4506378173828125, gen p mean: -0.11558721214532852, mean p set: 0.4512145519256592
loss_pred:0.014805741608142853, decouple_loss:0.0006997379241511226
Iteration: 2570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507763385772705, gen p mean: -0.11747803539037704, mean p set: 0.4513528347015381
loss_pred:0.015008766204118729, decouple_loss:0.0005418777582235634
The modified gen p mean: 0.4500651955604553, gen p mean: -0.11591631174087524, mean p set: 0.4506414532661438
loss_pred:0.014845470897853374, decouple_loss:0.0005170370568521321
The modified gen p mean: 0.4523746967315674, gen p mean: -0.12260763347148895, mean p set: 0.45295095443725586
loss_pred:0.014224039390683174, decouple_loss:0.0004446466045919806
2023-05-02 13:14:34 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12971486151218414, mean p set: 0.4502691626548767
loss_pred:0.016812093555927277, decouple_loss:0.0005860105738975108
The modified gen p mean: 0.44953492283821106, gen p mean: -0.12382092326879501, mean p set: 0.4500633478164673
loss_pred:0.016277367249131203, decouple_loss:0.0004881630593445152
The modified gen p mean: 0.4498284161090851, gen p mean: -0.12318895012140274, mean p set: 0.45035696029663086
loss_pred:0.016513386741280556, decouple_loss:0.0004189448955003172
WV_1_PC_1_EH_0_PS_40, loss: 0.016559168696403503, avg_mse: 0.025798410177230835
current test mse: 0.025798
Iteration: 2571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45251625776290894, gen p mean: -0.114618681371212, mean p set: 0.4530937969684601
loss_pred:0.014684787951409817, decouple_loss:0.000463955570012331
The modified gen p mean: 0.4499070644378662, gen p mean: -0.1140092983841896, mean p set: 0.4504847228527069The modified gen p mean: 0.45157676935195923, gen p mean: -0.11666694283485413, mean p set: 0.4521520435810089
loss_pred:0.015680477023124695, decouple_loss:0.0004409295506775379
loss_pred:0.014572111889719963, decouple_loss:0.00038730556843802333
Iteration: 2572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524553120136261, gen p mean: -0.11741234362125397, mean p set: 0.4530309736728668
loss_pred:0.014421199448406696, decouple_loss:0.00047361364704556763
The modified gen p mean: 0.44901618361473083, gen p mean: -0.11643926054239273, mean p set: 0.44959282875061035The modified gen p mean: 0.4519553780555725, gen p mean: -0.10868048667907715, mean p set: 0.45252999663352966
loss_pred:0.014417371712625027, decouple_loss:0.00048387402785010636loss_pred:0.015075411647558212, decouple_loss:0.00047762421309016645
Iteration: 2573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503309428691864, gen p mean: -0.11491576582193375, mean p set: 0.4509062170982361
The modified gen p mean: 0.45119547843933105, gen p mean: -0.11581612378358841, mean p set: 0.45177099108695984
loss_pred:0.015016980469226837, decouple_loss:0.0003737594815902412
loss_pred:0.014726747758686543, decouple_loss:0.0006724250270053744
The modified gen p mean: 0.45091238617897034, gen p mean: -0.11234068125486374, mean p set: 0.45148876309394836
loss_pred:0.014884085394442081, decouple_loss:0.0004742929304484278
Iteration: 2574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45087677240371704, gen p mean: -0.11212469637393951, mean p set: 0.4514535665512085
loss_pred:0.01479837391525507, decouple_loss:0.00037788067129440606
The modified gen p mean: 0.4508053660392761, gen p mean: -0.11475751549005508, mean p set: 0.4513835310935974
loss_pred:0.014895200729370117, decouple_loss:0.0003732314216904342
The modified gen p mean: 0.4520334303379059, gen p mean: -0.11897368729114532, mean p set: 0.45260855555534363
loss_pred:0.013835194520652294, decouple_loss:0.0003931259852834046
Iteration: 2575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523674547672272, gen p mean: -0.1133054718375206, mean p set: 0.45294511318206787
loss_pred:0.014133825898170471, decouple_loss:0.0007113955798558891
The modified gen p mean: 0.44940024614334106, gen p mean: -0.11321225762367249, mean p set: 0.44997847080230713
loss_pred:0.014672558754682541, decouple_loss:0.0004580007225740701
The modified gen p mean: 0.4513305127620697, gen p mean: -0.10828083008527756, mean p set: 0.4519054889678955
loss_pred:0.014149511232972145, decouple_loss:0.0007101721130311489
Iteration: 2576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510844349861145, gen p mean: -0.1102590337395668, mean p set: 0.45166051387786865
loss_pred:0.014376542530953884, decouple_loss:0.0005070575862191617
The modified gen p mean: 0.45349472761154175, gen p mean: -0.1144384890794754, mean p set: 0.4540724456310272
The modified gen p mean: 0.4518558084964752, gen p mean: -0.10505086183547974, mean p set: 0.4524320662021637
loss_pred:0.014156077988445759, decouple_loss:0.00035032816231250763
loss_pred:0.014313549734652042, decouple_loss:0.00048369349678978324
Iteration: 2577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108306407928467, gen p mean: -0.10868445783853531, mean p set: 0.45165982842445374
loss_pred:0.014537755399942398, decouple_loss:0.0004898519837297499
The modified gen p mean: 0.451214075088501, gen p mean: -0.10875242203474045, mean p set: 0.4517918825149536
The modified gen p mean: 0.45270460844039917, gen p mean: -0.10846848785877228, mean p set: 0.45328083634376526
loss_pred:0.014139640145003796, decouple_loss:0.0005877154180780053
loss_pred:0.01469456311315298, decouple_loss:0.0005096109234727919
Iteration: 2578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505065977573395, gen p mean: -0.11753955483436584, mean p set: 0.45108485221862793
loss_pred:0.014278192073106766, decouple_loss:0.00056224106810987
The modified gen p mean: 0.45384687185287476, gen p mean: -0.11023494601249695, mean p set: 0.4544260501861572
loss_pred:0.014457848854362965, decouple_loss:0.0006564729264937341
The modified gen p mean: 0.45222893357276917, gen p mean: -0.11466450244188309, mean p set: 0.45280560851097107
loss_pred:0.014021794311702251, decouple_loss:0.0005366879049688578
Iteration: 2579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527570605278015, gen p mean: -0.10831140726804733, mean p set: 0.4533340632915497
loss_pred:0.014610175974667072, decouple_loss:0.0004521396476775408
The modified gen p mean: 0.4518894553184509, gen p mean: -0.1121954694390297, mean p set: 0.45246621966362
loss_pred:0.01452580001205206, decouple_loss:0.00035878142807632685
The modified gen p mean: 0.44993433356285095, gen p mean: -0.11121652275323868, mean p set: 0.4505091905593872
loss_pred:0.015336531214416027, decouple_loss:0.0004601325199473649
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
NaN value num: 0
Iteration: 2580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493118226528168, gen p mean: -0.11421886831521988, mean p set: 0.4498874545097351
loss_pred:0.014276837930083275, decouple_loss:0.00046432888484559953
The modified gen p mean: 0.4513968527317047, gen p mean: -0.10750594735145569, mean p set: 0.4519725739955902
The modified gen p mean: 0.4486052989959717, gen p mean: -0.11524932831525803, mean p set: 0.44918093085289
loss_pred:0.015192529186606407, decouple_loss:0.000500616617500782
loss_pred:0.014585748314857483, decouple_loss:0.00042604372720234096
2023-05-02 13:17:40 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12728624045848846, mean p set: 0.4502691626548767
loss_pred:0.016733231022953987, decouple_loss:0.0005970587371848524
The modified gen p mean: 0.4495365023612976, gen p mean: -0.12146089226007462, mean p set: 0.4500633478164673
loss_pred:0.016229374334216118, decouple_loss:0.0006189384148456156
The modified gen p mean: 0.44982969760894775, gen p mean: -0.12094949930906296, mean p set: 0.45035696029663086
loss_pred:0.016476955264806747, decouple_loss:0.0005678666057065129
WV_1_PC_1_EH_0_PS_40, loss: 0.016509585082530975, avg_mse: 0.025752771645784378
current test mse: 0.025753
Iteration: 2581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516356587409973, gen p mean: -0.11705555766820908, mean p set: 0.45221275091171265
loss_pred:0.014544464647769928, decouple_loss:0.0006658753263764083
The modified gen p mean: 0.44958728551864624, gen p mean: -0.11970925331115723, mean p set: 0.4501636028289795The modified gen p mean: 0.45033323764801025, gen p mean: -0.11971128731966019, mean p set: 0.45091211795806885
loss_pred:0.014407072216272354, decouple_loss:0.0005505168228410184
loss_pred:0.01469973661005497, decouple_loss:0.0005995091050863266
Iteration: 2582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452605664730072, gen p mean: -0.11509256809949875, mean p set: 0.45318490266799927
loss_pred:0.014799674041569233, decouple_loss:0.0004706425534095615
The modified gen p mean: 0.449591726064682, gen p mean: -0.11358745396137238, mean p set: 0.4501683712005615The modified gen p mean: 0.45211881399154663, gen p mean: -0.11730579286813736, mean p set: 0.45269572734832764
loss_pred:0.014758347533643246, decouple_loss:0.0003836429968941957loss_pred:0.01414746418595314, decouple_loss:0.0006477651186287403
Iteration: 2583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491581320762634, gen p mean: -0.11966756731271744, mean p set: 0.4497344493865967
loss_pred:0.01475705299526453, decouple_loss:0.0004883324145339429
The modified gen p mean: 0.45075327157974243, gen p mean: -0.12213000655174255, mean p set: 0.45132896304130554The modified gen p mean: 0.45050448179244995, gen p mean: -0.12010957300662994, mean p set: 0.45107904076576233
loss_pred:0.014734312891960144, decouple_loss:0.0005636699497699738
loss_pred:0.01450519822537899, decouple_loss:0.000405228667659685
Iteration: 2584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45207011699676514, gen p mean: -0.12406086921691895, mean p set: 0.4526461362838745
loss_pred:0.014043747447431087, decouple_loss:0.0008021162357181311
The modified gen p mean: 0.44902077317237854, gen p mean: -0.12178556621074677, mean p set: 0.44959568977355957
loss_pred:0.01473940722644329, decouple_loss:0.00044848149991594255
The modified gen p mean: 0.45361366868019104, gen p mean: -0.11987188458442688, mean p set: 0.4541929364204407
loss_pred:0.014939557760953903, decouple_loss:0.00060857372591272
Iteration: 2585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451327919960022, gen p mean: -0.11974170058965683, mean p set: 0.4519027769565582
loss_pred:0.014033276587724686, decouple_loss:0.00042519380804151297
The modified gen p mean: 0.45044344663619995, gen p mean: -0.12121041864156723, mean p set: 0.4510199725627899
loss_pred:0.014589903876185417, decouple_loss:0.0005466786678880453
The modified gen p mean: 0.4504196345806122, gen p mean: -0.12676742672920227, mean p set: 0.45099470019340515
loss_pred:0.014703845605254173, decouple_loss:0.0005526065942831337
Iteration: 2586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44965073466300964, gen p mean: -0.12263467162847519, mean p set: 0.45022767782211304
loss_pred:0.014610028825700283, decouple_loss:0.0004530855221673846
The modified gen p mean: 0.448461651802063, gen p mean: -0.12086431682109833, mean p set: 0.4490357041358948
loss_pred:0.014259998686611652, decouple_loss:0.00035231534275226295
The modified gen p mean: 0.4492940902709961, gen p mean: -0.11742135137319565, mean p set: 0.4498707354068756
loss_pred:0.014475107192993164, decouple_loss:0.0005303562502376735
Iteration: 2587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45042335987091064, gen p mean: -0.11306586116552353, mean p set: 0.45099982619285583
loss_pred:0.014738304540514946, decouple_loss:0.0005021750694140792
The modified gen p mean: 0.4499515891075134, gen p mean: -0.11902540922164917, mean p set: 0.45052674412727356
loss_pred:0.014264121651649475, decouple_loss:0.0007185910362750292
The modified gen p mean: 0.4506777822971344, gen p mean: -0.11109843850135803, mean p set: 0.45125362277030945
loss_pred:0.014300942420959473, decouple_loss:0.0007519125938415527
Iteration: 2588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526229798793793, gen p mean: -0.11007972806692123, mean p set: 0.45320096611976624
loss_pred:0.014592140913009644, decouple_loss:0.0007715302053838968
The modified gen p mean: 0.4508792459964752, gen p mean: -0.11455759406089783, mean p set: 0.4514558017253876
loss_pred:0.014430846087634563, decouple_loss:0.0004812917613890022
The modified gen p mean: 0.44950515031814575, gen p mean: -0.11614638566970825, mean p set: 0.450082391500473
loss_pred:0.014115862548351288, decouple_loss:0.00047178668319247663
Iteration: 2589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531196653842926, gen p mean: -0.10733512043952942, mean p set: 0.4536963999271393
loss_pred:0.014676106162369251, decouple_loss:0.000392089452361688
The modified gen p mean: 0.449140727519989, gen p mean: -0.11049673706293106, mean p set: 0.44971778988838196
The modified gen p mean: 0.45215922594070435, gen p mean: -0.11024964600801468, mean p set: 0.45273545384407043
loss_pred:0.014446952380239964, decouple_loss:0.0003463320608716458
loss_pred:0.014604898169636726, decouple_loss:0.0004054653400089592
Iteration: 2590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45042988657951355, gen p mean: -0.12076076120138168, mean p set: 0.45100730657577515
loss_pred:0.014673028141260147, decouple_loss:0.000860463420394808
The modified gen p mean: 0.4512456953525543, gen p mean: -0.1123509481549263, mean p set: 0.4518203139305115
The modified gen p mean: 0.44970133900642395, gen p mean: -0.117831751704216, mean p set: 0.4502776563167572
loss_pred:0.014214987866580486, decouple_loss:0.0005950439954176545
loss_pred:0.014163509011268616, decouple_loss:0.0007114791660569608
2023-05-02 13:19:47 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12790244817733765, mean p set: 0.4502691626548767
loss_pred:0.01681126281619072, decouple_loss:0.0007504359818994999
The modified gen p mean: 0.4495372176170349, gen p mean: -0.122178815305233, mean p set: 0.4500633478164673
loss_pred:0.016406306996941566, decouple_loss:0.000677442760206759
The modified gen p mean: 0.4498263895511627, gen p mean: -0.12160756438970566, mean p set: 0.45035696029663086
loss_pred:0.016573157161474228, decouple_loss:0.0005441269022412598
WV_1_PC_1_EH_0_PS_40, loss: 0.0166297759860754, avg_mse: 0.025898747146129608
current test mse: 0.025899
Iteration: 2591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513983130455017, gen p mean: -0.1127825528383255, mean p set: 0.451975017786026
loss_pred:0.014436802826821804, decouple_loss:0.0006120071629993618
The modified gen p mean: 0.4517297148704529, gen p mean: -0.11094528436660767, mean p set: 0.4523043632507324The modified gen p mean: 0.4512098729610443, gen p mean: -0.11752026528120041, mean p set: 0.45178547501564026
loss_pred:0.014164603315293789, decouple_loss:0.0005280534387566149
loss_pred:0.014095037244260311, decouple_loss:0.0005795496981590986
Iteration: 2592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879114627838135, gen p mean: -0.11729515343904495, mean p set: 0.4493648409843445
loss_pred:0.014366152696311474, decouple_loss:0.00043796905083581805
The modified gen p mean: 0.4503616690635681, gen p mean: -0.11125937849283218, mean p set: 0.4509369134902954The modified gen p mean: 0.45151376724243164, gen p mean: -0.11568798869848251, mean p set: 0.452089786529541
loss_pred:0.014888107776641846, decouple_loss:0.0004139522206969559
loss_pred:0.013718289323151112, decouple_loss:0.0005961859133094549
Iteration: 2593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520411491394043, gen p mean: -0.11594102531671524, mean p set: 0.45261847972869873
loss_pred:0.014459196478128433, decouple_loss:0.0005442690453492105
The modified gen p mean: 0.44967886805534363, gen p mean: -0.12205828726291656, mean p set: 0.4502570331096649
loss_pred:0.014891469851136208, decouple_loss:0.0005122337606735528
The modified gen p mean: 0.4498439133167267, gen p mean: -0.12534166872501373, mean p set: 0.4504190683364868
loss_pred:0.014796178787946701, decouple_loss:0.00047990132588893175
Iteration: 2594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45146769285202026, gen p mean: -0.11708905547857285, mean p set: 0.4520416855812073
loss_pred:0.014506809413433075, decouple_loss:0.0004226175369694829
The modified gen p mean: 0.4511618912220001, gen p mean: -0.11556734889745712, mean p set: 0.451738178730011
loss_pred:0.014495433308184147, decouple_loss:0.0009050164371728897
The modified gen p mean: 0.4511505365371704, gen p mean: -0.11280141770839691, mean p set: 0.4517255127429962
loss_pred:0.014261245727539062, decouple_loss:0.0006283761467784643
Iteration: 2595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901448488235474, gen p mean: -0.11193192005157471, mean p set: 0.4495902955532074
loss_pred:0.01416839100420475, decouple_loss:0.0005083286087028682
The modified gen p mean: 0.4507083594799042, gen p mean: -0.11055491119623184, mean p set: 0.45128580927848816
loss_pred:0.014324438758194447, decouple_loss:0.00045420241076499224
The modified gen p mean: 0.4507603049278259, gen p mean: -0.1108958050608635, mean p set: 0.45133697986602783
loss_pred:0.014392070472240448, decouple_loss:0.0005427511059679091
Iteration: 2596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453065425157547, gen p mean: -0.11036451160907745, mean p set: 0.4536430835723877
loss_pred:0.014679805375635624, decouple_loss:0.0005016938666813076
The modified gen p mean: 0.45119693875312805, gen p mean: -0.11258303374052048, mean p set: 0.45177412033081055
The modified gen p mean: 0.4488529562950134, gen p mean: -0.117080919444561, mean p set: 0.4494280517101288
loss_pred:0.014166711829602718, decouple_loss:0.00042134287650696933
loss_pred:0.01382230594754219, decouple_loss:0.0006207469268701971
Iteration: 2597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506700038909912, gen p mean: -0.10748331993818283, mean p set: 0.45124614238739014
loss_pred:0.014878267422318459, decouple_loss:0.0004880947817582637
The modified gen p mean: 0.45125067234039307, gen p mean: -0.10749870538711548, mean p set: 0.45182791352272034
loss_pred:0.015006505884230137, decouple_loss:0.0004834594437852502
The modified gen p mean: 0.45115798711776733, gen p mean: -0.11173923313617706, mean p set: 0.4517350196838379
loss_pred:0.014018215239048004, decouple_loss:0.0006861832225695252
Iteration: 2598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45148906111717224, gen p mean: -0.10995030403137207, mean p set: 0.45206621289253235
loss_pred:0.014106919057667255, decouple_loss:0.000795699015725404
The modified gen p mean: 0.45226559042930603, gen p mean: -0.11591850966215134, mean p set: 0.45284390449523926
loss_pred:0.01430481020361185, decouple_loss:0.0006080364692024887
The modified gen p mean: 0.4519793391227722, gen p mean: -0.11001753062009811, mean p set: 0.4525558054447174
loss_pred:0.01417600829154253, decouple_loss:0.0008598109125159681
Iteration: 2599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844523072242737, gen p mean: -0.11606276035308838, mean p set: 0.44902369379997253
loss_pred:0.014540605247020721, decouple_loss:0.0006062889005988836
The modified gen p mean: 0.4514479339122772, gen p mean: -0.11520756036043167, mean p set: 0.4520263373851776
The modified gen p mean: 0.45256441831588745, gen p mean: -0.10847267508506775, mean p set: 0.45314162969589233
loss_pred:0.013882468454539776, decouple_loss:0.00043497467413544655
loss_pred:0.014516685158014297, decouple_loss:0.0005312884459272027
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
NaN value num: 0
Iteration: 2600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691959023475647, gen p mean: -0.11735470592975616, mean p set: 0.4474940896034241
loss_pred:0.01616688072681427, decouple_loss:0.0004191277257632464
The modified gen p mean: 0.44836828112602234, gen p mean: -0.12052550166845322, mean p set: 0.44894295930862427
The modified gen p mean: 0.4479135572910309, gen p mean: -0.12086056172847748, mean p set: 0.44848933815956116
loss_pred:0.016139153391122818, decouple_loss:0.0005581852747127414
loss_pred:0.0156560018658638, decouple_loss:0.0005698940949514508
2023-05-02 13:22:54 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12583772838115692, mean p set: 0.4502691626548767
loss_pred:0.016771415248513222, decouple_loss:0.0003547268861439079
The modified gen p mean: 0.449535071849823, gen p mean: -0.1192566454410553, mean p set: 0.4500633478164673
loss_pred:0.01631404273211956, decouple_loss:0.00041867708205245435
The modified gen p mean: 0.44982603192329407, gen p mean: -0.1190822422504425, mean p set: 0.45035696029663086
loss_pred:0.016525670886039734, decouple_loss:0.0003935920540243387
WV_1_PC_1_EH_0_PS_40, loss: 0.016556493937969208, avg_mse: 0.02579197846353054
current test mse: 0.025792
Iteration: 2601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447964608669281, gen p mean: -0.12096633017063141, mean p set: 0.44853898882865906
loss_pred:0.015957824885845184, decouple_loss:0.0006784290308132768
The modified gen p mean: 0.4476538896560669, gen p mean: -0.12239516526460648, mean p set: 0.4482278525829315The modified gen p mean: 0.448138564825058, gen p mean: -0.11874938011169434, mean p set: 0.4487142562866211
loss_pred:0.015581736341118813, decouple_loss:0.000614803924690932loss_pred:0.01659250445663929, decouple_loss:0.000431844440754503
Iteration: 2602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475780427455902, gen p mean: -0.1221943348646164, mean p set: 0.44815748929977417
loss_pred:0.016331538558006287, decouple_loss:0.0004364086198620498
The modified gen p mean: 0.4483994245529175, gen p mean: -0.11977925896644592, mean p set: 0.44897785782814026The modified gen p mean: 0.4479764699935913, gen p mean: -0.1249944195151329, mean p set: 0.44855156540870667
loss_pred:0.016023365780711174, decouple_loss:0.0003471612581051886loss_pred:0.015066017396748066, decouple_loss:0.000434431858593598
Iteration: 2603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482942223548889, gen p mean: -0.11830833554267883, mean p set: 0.44886863231658936
loss_pred:0.01596410945057869, decouple_loss:0.0007008135435171425
The modified gen p mean: 0.4488650858402252, gen p mean: -0.11949694901704788, mean p set: 0.4494416415691376
loss_pred:0.0156779196113348, decouple_loss:0.00045618595322594047
The modified gen p mean: 0.44733476638793945, gen p mean: -0.11619783937931061, mean p set: 0.4479096829891205
loss_pred:0.016346078366041183, decouple_loss:0.0005503937718458474
Iteration: 2604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482978880405426, gen p mean: -0.12269352376461029, mean p set: 0.44887417554855347
loss_pred:0.01525562722235918, decouple_loss:0.0003490288509055972
The modified gen p mean: 0.4488164186477661, gen p mean: -0.12323831766843796, mean p set: 0.4493922293186188
loss_pred:0.015895435586571693, decouple_loss:0.00046757052768953145
The modified gen p mean: 0.4472328722476959, gen p mean: -0.12250828742980957, mean p set: 0.4478082060813904
loss_pred:0.01615779846906662, decouple_loss:0.00037167785922065377
Iteration: 2605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787490367889404, gen p mean: -0.1232539713382721, mean p set: 0.4484483003616333
loss_pred:0.015851277858018875, decouple_loss:0.00041006453102454543
The modified gen p mean: 0.4478475749492645, gen p mean: -0.1237029880285263, mean p set: 0.44842007756233215
loss_pred:0.015419268049299717, decouple_loss:0.00037748186150565743
The modified gen p mean: 0.4481368064880371, gen p mean: -0.11847440153360367, mean p set: 0.44871240854263306
loss_pred:0.016554750502109528, decouple_loss:0.000483541312860325
Iteration: 2606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806715846061707, gen p mean: -0.12256482243537903, mean p set: 0.44863903522491455
loss_pred:0.016120316460728645, decouple_loss:0.0003620859934017062
The modified gen p mean: 0.44758251309394836, gen p mean: -0.1260393112897873, mean p set: 0.44815871119499207
loss_pred:0.015547494404017925, decouple_loss:0.00044962562969885767
The modified gen p mean: 0.44773760437965393, gen p mean: -0.12378796935081482, mean p set: 0.4483153223991394
loss_pred:0.015720203518867493, decouple_loss:0.0003357913519721478
Iteration: 2607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484158754348755, gen p mean: -0.1286727488040924, mean p set: 0.4489932656288147
loss_pred:0.01605057343840599, decouple_loss:0.0004136374336667359
The modified gen p mean: 0.44809669256210327, gen p mean: -0.1204562857747078, mean p set: 0.44867268204689026
loss_pred:0.016337722539901733, decouple_loss:0.0004131457826588303
The modified gen p mean: 0.447165310382843, gen p mean: -0.12135495245456696, mean p set: 0.44774329662323
loss_pred:0.015814943239092827, decouple_loss:0.0004457716422621161
Iteration: 2608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44826599955558777, gen p mean: -0.12443330138921738, mean p set: 0.4488413631916046
loss_pred:0.016132786870002747, decouple_loss:0.000439958821516484
The modified gen p mean: 0.4478014409542084, gen p mean: -0.1293305903673172, mean p set: 0.4483753740787506
loss_pred:0.014667167328298092, decouple_loss:0.0004676004173234105
The modified gen p mean: 0.44734668731689453, gen p mean: -0.1199377030134201, mean p set: 0.44792336225509644
loss_pred:0.0158693864941597, decouple_loss:0.00043327180901542306
Iteration: 2609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472043514251709, gen p mean: -0.1204531192779541, mean p set: 0.44777801632881165
loss_pred:0.015969034284353256, decouple_loss:0.0003372200299054384
The modified gen p mean: 0.4475773274898529, gen p mean: -0.12429969757795334, mean p set: 0.4481523036956787
loss_pred:0.015722496435046196, decouple_loss:0.00037433221586979926
The modified gen p mean: 0.44840896129608154, gen p mean: -0.12126242369413376, mean p set: 0.44898611307144165
loss_pred:0.015812786296010017, decouple_loss:0.0003520682221278548
Iteration: 2610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483663737773895, gen p mean: -0.11716964840888977, mean p set: 0.44894248247146606
loss_pred:0.01615215465426445, decouple_loss:0.00044621096458286047
The modified gen p mean: 0.44746923446655273, gen p mean: -0.11659351736307144, mean p set: 0.44804492592811584
The modified gen p mean: 0.4483707845211029, gen p mean: -0.11940471827983856, mean p set: 0.44894954562187195
loss_pred:0.01575505919754505, decouple_loss:0.0004658701946027577
loss_pred:0.015260772779583931, decouple_loss:0.000339346268447116
2023-05-02 13:25:01 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12478701025247574, mean p set: 0.4502691626548767
loss_pred:0.01687368005514145, decouple_loss:0.0005063709104433656
The modified gen p mean: 0.44953545928001404, gen p mean: -0.11810727417469025, mean p set: 0.4500633478164673
loss_pred:0.016239047050476074, decouple_loss:0.00043844434549100697
The modified gen p mean: 0.44982895255088806, gen p mean: -0.11821654438972473, mean p set: 0.45035696029663086
loss_pred:0.016476625576615334, decouple_loss:0.00039373099571093917
WV_1_PC_1_EH_0_PS_40, loss: 0.016552094370126724, avg_mse: 0.02584186941385269
current test mse: 0.025842
Iteration: 2611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769594073295593, gen p mean: -0.1210109293460846, mean p set: 0.4482729434967041
loss_pred:0.01562323048710823, decouple_loss:0.0005312328576110303
The modified gen p mean: 0.4469026029109955, gen p mean: -0.11974803358316422, mean p set: 0.4474784731864929
loss_pred:0.015931028872728348, decouple_loss:0.0003604613884817809
The modified gen p mean: 0.44756191968917847, gen p mean: -0.12347660213708878, mean p set: 0.4481373429298401
loss_pred:0.01442490890622139, decouple_loss:0.00041199332918040454
Iteration: 2612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733133912086487, gen p mean: -0.11731989681720734, mean p set: 0.4479075074195862The modified gen p mean: 0.44856134057044983, gen p mean: -0.11900036036968231, mean p set: 0.4491376578807831
loss_pred:0.015826459974050522, decouple_loss:0.00041134582716040313
loss_pred:0.016243835911154747, decouple_loss:0.00038499358925037086
The modified gen p mean: 0.44756442308425903, gen p mean: -0.12228771299123764, mean p set: 0.4481372833251953
loss_pred:0.016218693926930428, decouple_loss:0.0003228186396881938
Iteration: 2613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472804367542267, gen p mean: -0.12600740790367126, mean p set: 0.44785749912261963
loss_pred:0.016291867941617966, decouple_loss:0.0004260815621819347
The modified gen p mean: 0.4474043846130371, gen p mean: -0.11687568575143814, mean p set: 0.4479822516441345
loss_pred:0.016461936756968498, decouple_loss:0.0003839540877379477
The modified gen p mean: 0.44746118783950806, gen p mean: -0.12787631154060364, mean p set: 0.44803571701049805
loss_pred:0.015176764689385891, decouple_loss:0.000391766574466601
Iteration: 2614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769763946533203, gen p mean: -0.12300017476081848, mean p set: 0.4482739567756653
loss_pred:0.015855953097343445, decouple_loss:0.00037514735595323145
The modified gen p mean: 0.44751399755477905, gen p mean: -0.12867134809494019, mean p set: 0.44808903336524963
loss_pred:0.015993444249033928, decouple_loss:0.0003524285275489092
The modified gen p mean: 0.4481576979160309, gen p mean: -0.12130511552095413, mean p set: 0.4487318992614746
loss_pred:0.015843860805034637, decouple_loss:0.0003774008946493268
Iteration: 2615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474231004714966, gen p mean: -0.12789103388786316, mean p set: 0.447996586561203
loss_pred:0.016187749803066254, decouple_loss:0.0003156733000651002
The modified gen p mean: 0.44837331771850586, gen p mean: -0.127540722489357, mean p set: 0.44895002245903015
loss_pred:0.015970738604664803, decouple_loss:0.0004224833392072469
The modified gen p mean: 0.4476712942123413, gen p mean: -0.12662267684936523, mean p set: 0.4482477605342865
loss_pred:0.015699684619903564, decouple_loss:0.00046067850780673325
Iteration: 2616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891443848609924, gen p mean: -0.13072918355464935, mean p set: 0.44949179887771606
loss_pred:0.01555880717933178, decouple_loss:0.00039823533734306693
The modified gen p mean: 0.44715508818626404, gen p mean: -0.1239970475435257, mean p set: 0.4477321207523346
The modified gen p mean: 0.44787466526031494, gen p mean: -0.12752410769462585, mean p set: 0.44845062494277954
loss_pred:0.01662638783454895, decouple_loss:0.00045582017628476024
loss_pred:0.015533632598817348, decouple_loss:0.00040129289845936
Iteration: 2617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482560157775879, gen p mean: -0.12732642889022827, mean p set: 0.44883155822753906
loss_pred:0.015627730637788773, decouple_loss:0.0003939447633456439
The modified gen p mean: 0.44786253571510315, gen p mean: -0.12896227836608887, mean p set: 0.44843775033950806
The modified gen p mean: 0.44724342226982117, gen p mean: -0.12528350949287415, mean p set: 0.4478190541267395
loss_pred:0.015868984162807465, decouple_loss:0.0005067941383458674
loss_pred:0.016249556094408035, decouple_loss:0.0003175875754095614
Iteration: 2618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474371373653412, gen p mean: -0.12020515650510788, mean p set: 0.4480125904083252
loss_pred:0.01584547944366932, decouple_loss:0.0003356857050675899
The modified gen p mean: 0.447926789522171, gen p mean: -0.1264563798904419, mean p set: 0.4485030770301819
The modified gen p mean: 0.4482751488685608, gen p mean: -0.12202903628349304, mean p set: 0.4488488733768463
loss_pred:0.015453181229531765, decouple_loss:0.0003940375754609704
loss_pred:0.015674473717808723, decouple_loss:0.00040587972034700215
Iteration: 2619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877421855926514, gen p mean: -0.12483121454715729, mean p set: 0.449349969625473
loss_pred:0.014833930879831314, decouple_loss:0.0004868706164415926
The modified gen p mean: 0.4478422701358795, gen p mean: -0.1262381225824356, mean p set: 0.44841820001602173
The modified gen p mean: 0.44876840710639954, gen p mean: -0.12110781669616699, mean p set: 0.4493470788002014
loss_pred:0.014761652797460556, decouple_loss:0.0003778167883865535
loss_pred:0.015939408913254738, decouple_loss:0.00032700790325179696
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 2620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477262794971466, gen p mean: -0.12102389335632324, mean p set: 0.44830334186553955
loss_pred:0.014843585900962353, decouple_loss:0.00037299582618288696
The modified gen p mean: 0.4479908049106598, gen p mean: -0.12478050589561462, mean p set: 0.4485662877559662
The modified gen p mean: 0.44867298007011414, gen p mean: -0.12195135653018951, mean p set: 0.44924864172935486
loss_pred:0.014255321584641933, decouple_loss:0.0003893760440405458
loss_pred:0.013621801510453224, decouple_loss:0.0004950503935106099
2023-05-02 13:28:03 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12649066746234894, mean p set: 0.4502691626548767
loss_pred:0.01682589016854763, decouple_loss:0.00044461406650952995
The modified gen p mean: 0.4495348632335663, gen p mean: -0.11954507231712341, mean p set: 0.4500633478164673
loss_pred:0.016172463074326515, decouple_loss:0.0004425481893122196
The modified gen p mean: 0.44982874393463135, gen p mean: -0.11937015503644943, mean p set: 0.45035696029663086
loss_pred:0.016469482332468033, decouple_loss:0.0003442722954787314
WV_1_PC_1_EH_0_PS_40, loss: 0.016509801149368286, avg_mse: 0.025761788710951805
current test mse: 0.025762
Iteration: 2621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476827383041382, gen p mean: -0.11920491605997086, mean p set: 0.4482576549053192
loss_pred:0.014444109983742237, decouple_loss:0.0003249726432841271
The modified gen p mean: 0.4480356276035309, gen p mean: -0.12251564115285873, mean p set: 0.44860947132110596The modified gen p mean: 0.44663572311401367, gen p mean: -0.12069685757160187, mean p set: 0.4472118318080902
loss_pred:0.014189867302775383, decouple_loss:0.000441739393863827
loss_pred:0.01435677707195282, decouple_loss:0.0003620566858444363
Iteration: 2622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470134973526001, gen p mean: -0.12953469157218933, mean p set: 0.44758692383766174
loss_pred:0.015229137614369392, decouple_loss:0.0004865486698690802
The modified gen p mean: 0.4470613896846771, gen p mean: -0.12499123811721802, mean p set: 0.4476398825645447The modified gen p mean: 0.44712525606155396, gen p mean: -0.12547729909420013, mean p set: 0.4477039873600006
loss_pred:0.014695863239467144, decouple_loss:0.0003361196140758693
loss_pred:0.013948291540145874, decouple_loss:0.00037186805275268853
Iteration: 2623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483312964439392, gen p mean: -0.12528708577156067, mean p set: 0.448910653591156
loss_pred:0.013621000573039055, decouple_loss:0.0003060683375224471
The modified gen p mean: 0.44647374749183655, gen p mean: -0.12312372028827667, mean p set: 0.4470519721508026
loss_pred:0.014446349814534187, decouple_loss:0.00029836955945938826
The modified gen p mean: 0.44848236441612244, gen p mean: -0.12703342735767365, mean p set: 0.4490576982498169
loss_pred:0.013619160279631615, decouple_loss:0.0002776880282908678
Iteration: 2624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750502705574036, gen p mean: -0.12700913846492767, mean p set: 0.448081910610199
loss_pred:0.014835931360721588, decouple_loss:0.000419530930230394
The modified gen p mean: 0.4475407004356384, gen p mean: -0.12983930110931396, mean p set: 0.4481172263622284
loss_pred:0.014610175974667072, decouple_loss:0.0003217991325072944
The modified gen p mean: 0.4477287530899048, gen p mean: -0.12799037992954254, mean p set: 0.448304146528244
loss_pred:0.014108318835496902, decouple_loss:0.0003896655107382685
Iteration: 2625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465731084346771, gen p mean: -0.12420529872179031, mean p set: 0.4471501410007477
loss_pred:0.014537511393427849, decouple_loss:0.0003976963635068387
The modified gen p mean: 0.44731605052948, gen p mean: -0.12951236963272095, mean p set: 0.44789108633995056
loss_pred:0.014711455442011356, decouple_loss:0.0004091932496521622
The modified gen p mean: 0.4480302035808563, gen p mean: -0.12775151431560516, mean p set: 0.4486064314842224
loss_pred:0.013936813920736313, decouple_loss:0.00043607232510112226
Iteration: 2626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463565945625305, gen p mean: -0.12845292687416077, mean p set: 0.4469318985939026
loss_pred:0.015173780731856823, decouple_loss:0.00044263643212616444
The modified gen p mean: 0.44704920053482056, gen p mean: -0.1266828179359436, mean p set: 0.44762441515922546
loss_pred:0.013997039757668972, decouple_loss:0.0005167145282030106
The modified gen p mean: 0.44808655977249146, gen p mean: -0.1237100288271904, mean p set: 0.44866064190864563
loss_pred:0.01430918462574482, decouple_loss:0.0004992898902855814
Iteration: 2627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471076726913452, gen p mean: -0.12437383085489273, mean p set: 0.44768473505973816
loss_pred:0.014412978664040565, decouple_loss:0.00035350993857719004
The modified gen p mean: 0.44712841510772705, gen p mean: -0.12491776049137115, mean p set: 0.44770386815071106
The modified gen p mean: 0.44811591506004333, gen p mean: -0.12247747927904129, mean p set: 0.44869139790534973
loss_pred:0.014235231094062328, decouple_loss:0.0003867073100991547
loss_pred:0.013992520980536938, decouple_loss:0.0003249583824072033
Iteration: 2628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483942985534668, gen p mean: -0.12140408903360367, mean p set: 0.44897186756134033
loss_pred:0.013762852177023888, decouple_loss:0.0002784663229249418
The modified gen p mean: 0.44875043630599976, gen p mean: -0.12056923657655716, mean p set: 0.449325829744339
The modified gen p mean: 0.4474217891693115, gen p mean: -0.12227633595466614, mean p set: 0.4479982852935791
loss_pred:0.01303447037935257, decouple_loss:0.00032161580747924745
loss_pred:0.013752886094152927, decouple_loss:0.000327827176079154
Iteration: 2629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795575737953186, gen p mean: -0.12653757631778717, mean p set: 0.44853144884109497
The modified gen p mean: 0.4485703408718109, gen p mean: -0.12159310281276703, mean p set: 0.4491487443447113
loss_pred:0.01411241851747036, decouple_loss:0.0003740280226338655
loss_pred:0.013680970296263695, decouple_loss:0.00029262539464980364
The modified gen p mean: 0.4471312463283539, gen p mean: -0.1184493824839592, mean p set: 0.4477090537548065
loss_pred:0.014097687788307667, decouple_loss:0.00038110491004772484
Iteration: 2630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480260908603668, gen p mean: -0.12056072056293488, mean p set: 0.4486024081707001
loss_pred:0.014131400734186172, decouple_loss:0.000305614696117118
The modified gen p mean: 0.44712361693382263, gen p mean: -0.12593235075473785, mean p set: 0.4477013349533081
loss_pred:0.014598507434129715, decouple_loss:0.0003336228837724775
The modified gen p mean: 0.4474239647388458, gen p mean: -0.11875904351472855, mean p set: 0.44800183176994324
loss_pred:0.014243407174944878, decouple_loss:0.0003931881219614297
2023-05-02 13:30:09 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12267501652240753, mean p set: 0.4502691626548767
loss_pred:0.01683596707880497, decouple_loss:0.0003331607731524855
The modified gen p mean: 0.44953233003616333, gen p mean: -0.11617656797170639, mean p set: 0.4500633478164673
loss_pred:0.0161923635751009, decouple_loss:0.00038446119287982583
The modified gen p mean: 0.4498264789581299, gen p mean: -0.11570219695568085, mean p set: 0.45035696029663086
loss_pred:0.016498953104019165, decouple_loss:0.0004113227769266814
WV_1_PC_1_EH_0_PS_40, loss: 0.01652790978550911, avg_mse: 0.025860827416181564
current test mse: 0.025861
Iteration: 2631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44884243607521057, gen p mean: -0.11790778487920761, mean p set: 0.44941452145576477
loss_pred:0.01406191848218441, decouple_loss:0.0003676373162306845
The modified gen p mean: 0.44791314005851746, gen p mean: -0.11606285721063614, mean p set: 0.448486864566803The modified gen p mean: 0.44772985577583313, gen p mean: -0.11602818220853806, mean p set: 0.44830429553985596
loss_pred:0.013855841010808945, decouple_loss:0.0003179395280312747
loss_pred:0.013688205741345882, decouple_loss:0.0003712303296197206
Iteration: 2632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707804918289185, gen p mean: -0.12233544141054153, mean p set: 0.4476523995399475
loss_pred:0.014474007301032543, decouple_loss:0.0003790447080973536
The modified gen p mean: 0.4472625255584717, gen p mean: -0.11795033514499664, mean p set: 0.4478378891944885The modified gen p mean: 0.4468022882938385, gen p mean: -0.12070566415786743, mean p set: 0.44737890362739563
loss_pred:0.013779900968074799, decouple_loss:0.00033620919566601515
loss_pred:0.014239941723644733, decouple_loss:0.000479565846035257
Iteration: 2633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676366448402405, gen p mean: -0.12174162268638611, mean p set: 0.4473388195037842
The modified gen p mean: 0.44680294394493103, gen p mean: -0.11703669279813766, mean p set: 0.4473787844181061
loss_pred:0.01406087726354599, decouple_loss:0.0003883932949975133
loss_pred:0.01415945217013359, decouple_loss:0.0004260350833646953
The modified gen p mean: 0.44761526584625244, gen p mean: -0.11496654897928238, mean p set: 0.4481918513774872
loss_pred:0.01390797272324562, decouple_loss:0.0004410813853610307
Iteration: 2634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701915979385376, gen p mean: -0.12263405323028564, mean p set: 0.44759440422058105
loss_pred:0.013851812109351158, decouple_loss:0.00032842307700775564
The modified gen p mean: 0.4483093023300171, gen p mean: -0.1163555383682251, mean p set: 0.44888588786125183
loss_pred:0.013818374834954739, decouple_loss:0.0003741830005310476
The modified gen p mean: 0.44781526923179626, gen p mean: -0.12507161498069763, mean p set: 0.4483886957168579
loss_pred:0.014042914845049381, decouple_loss:0.00044915295438840985
Iteration: 2635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654953479766846, gen p mean: -0.12840694189071655, mean p set: 0.4471273422241211
loss_pred:0.014640860259532928, decouple_loss:0.00043291994370520115
The modified gen p mean: 0.44708508253097534, gen p mean: -0.11775137484073639, mean p set: 0.4476620554924011
loss_pred:0.014225692488253117, decouple_loss:0.00035310795647092164
The modified gen p mean: 0.4479430317878723, gen p mean: -0.12214668095111847, mean p set: 0.4485197067260742
loss_pred:0.013701311312615871, decouple_loss:0.00040605527465231717
Iteration: 2636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786643981933594, gen p mean: -0.12540225684642792, mean p set: 0.448443204164505
loss_pred:0.013789534568786621, decouple_loss:0.0003381937858648598
The modified gen p mean: 0.44718554615974426, gen p mean: -0.12021519988775253, mean p set: 0.4477570950984955
The modified gen p mean: 0.4472546875476837, gen p mean: -0.12767411768436432, mean p set: 0.44783034920692444
loss_pred:0.014104258269071579, decouple_loss:0.00047833050484769046
loss_pred:0.014070039615035057, decouple_loss:0.000274315825663507
Iteration: 2637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839322566986084, gen p mean: -0.12531748414039612, mean p set: 0.44896969199180603
loss_pred:0.013990475796163082, decouple_loss:0.0003718215739354491
The modified gen p mean: 0.44689977169036865, gen p mean: -0.12273814529180527, mean p set: 0.4474763870239258
loss_pred:0.014430439099669456, decouple_loss:0.0003862925514113158
The modified gen p mean: 0.44822952151298523, gen p mean: -0.1309899091720581, mean p set: 0.44880568981170654
loss_pred:0.01395100262016058, decouple_loss:0.0003601524804253131
Iteration: 2638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737347960472107, gen p mean: -0.12652304768562317, mean p set: 0.44794946908950806
loss_pred:0.01385489571839571, decouple_loss:0.0004639306280296296
The modified gen p mean: 0.44908279180526733, gen p mean: -0.1219683289527893, mean p set: 0.44966015219688416
The modified gen p mean: 0.44816598296165466, gen p mean: -0.13176113367080688, mean p set: 0.4487426280975342
loss_pred:0.013383390381932259, decouple_loss:0.00042704332736320794
loss_pred:0.014278537593781948, decouple_loss:0.0003910156083293259
Iteration: 2639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474283456802368, gen p mean: -0.12703993916511536, mean p set: 0.44800394773483276
loss_pred:0.01428530178964138, decouple_loss:0.0004278444976080209
The modified gen p mean: 0.44766464829444885, gen p mean: -0.1272536963224411, mean p set: 0.4482389986515045
The modified gen p mean: 0.44684746861457825, gen p mean: -0.12329818308353424, mean p set: 0.447422593832016
loss_pred:0.013839581049978733, decouple_loss:0.00035912077873945236
loss_pred:0.014284213073551655, decouple_loss:0.00038400437915697694
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 2640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463176429271698, gen p mean: -0.1268729269504547, mean p set: 0.4468948543071747
loss_pred:0.014631843194365501, decouple_loss:0.0003399597480893135
The modified gen p mean: 0.44814184308052063, gen p mean: -0.12708762288093567, mean p set: 0.4487214982509613
The modified gen p mean: 0.44826701283454895, gen p mean: -0.12496719509363174, mean p set: 0.4488431215286255
loss_pred:0.015105688944458961, decouple_loss:0.00035871437285095453
loss_pred:0.014497688040137291, decouple_loss:0.0004273693193681538
2023-05-02 13:33:14 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12554825842380524, mean p set: 0.4502691626548767
loss_pred:0.016833191737532616, decouple_loss:0.0005064577562734485
The modified gen p mean: 0.44953635334968567, gen p mean: -0.11930477619171143, mean p set: 0.4500633478164673
loss_pred:0.016159970313310623, decouple_loss:0.00043070715037174523
The modified gen p mean: 0.4498295485973358, gen p mean: -0.11905676126480103, mean p set: 0.45035696029663086
loss_pred:0.01639045588672161, decouple_loss:0.0003633225569501519
WV_1_PC_1_EH_0_PS_40, loss: 0.0164828822016716, avg_mse: 0.02577611617743969
current test mse: 0.025776
Iteration: 2641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44605037569999695, gen p mean: -0.12194367498159409, mean p set: 0.4466237425804138
loss_pred:0.01447780430316925, decouple_loss:0.0003918670699931681
The modified gen p mean: 0.4474382996559143, gen p mean: -0.11835269629955292, mean p set: 0.4480155408382416The modified gen p mean: 0.4482976496219635, gen p mean: -0.1193598061800003, mean p set: 0.4488748610019684
loss_pred:0.015927568078041077, decouple_loss:0.0004039341292809695
loss_pred:0.01527791190892458, decouple_loss:0.00047669134801253676
Iteration: 2642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465349018573761, gen p mean: -0.11832987517118454, mean p set: 0.447110116481781
loss_pred:0.015399735420942307, decouple_loss:0.00040545209776610136
The modified gen p mean: 0.4474945068359375, gen p mean: -0.12150338292121887, mean p set: 0.4480707347393036The modified gen p mean: 0.4467339515686035, gen p mean: -0.1261206716299057, mean p set: 0.447309285402298
loss_pred:0.015388819389045238, decouple_loss:0.000364299543434754
loss_pred:0.01435134932398796, decouple_loss:0.000318625767249614
Iteration: 2643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44693148136138916, gen p mean: -0.12263291329145432, mean p set: 0.44750893115997314
The modified gen p mean: 0.44914427399635315, gen p mean: -0.1179686039686203, mean p set: 0.4497232735157013
loss_pred:0.014451189897954464, decouple_loss:0.00037002062890678644
loss_pred:0.0143010588362813, decouple_loss:0.0003821945283561945
The modified gen p mean: 0.44783902168273926, gen p mean: -0.11433840543031693, mean p set: 0.44841471314430237
loss_pred:0.014927005395293236, decouple_loss:0.0003450742515269667
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484257698059082, gen p mean: -0.11387784034013748, mean p set: 0.44900330901145935
loss_pred:0.014074527658522129, decouple_loss:0.000390036148019135
The modified gen p mean: 0.445789098739624, gen p mean: -0.1161566972732544, mean p set: 0.44636374711990356
loss_pred:0.014441764913499355, decouple_loss:0.0004720710567198694
The modified gen p mean: 0.44762474298477173, gen p mean: -0.11759509891271591, mean p set: 0.44819900393486023
loss_pred:0.014526369981467724, decouple_loss:0.0004249138874001801
Iteration: 2645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785577058792114, gen p mean: -0.1167680099606514, mean p set: 0.44843170046806335
loss_pred:0.014325839467346668, decouple_loss:0.000470629776827991
The modified gen p mean: 0.4478936493396759, gen p mean: -0.1157744824886322, mean p set: 0.448472261428833
loss_pred:0.01401925552636385, decouple_loss:0.0004095316107850522
The modified gen p mean: 0.44732430577278137, gen p mean: -0.12098896503448486, mean p set: 0.4479025602340698
loss_pred:0.01434666384011507, decouple_loss:0.0003113368875347078
Iteration: 2646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481538236141205, gen p mean: -0.11791277676820755, mean p set: 0.4487282633781433
loss_pred:0.014536777511239052, decouple_loss:0.00036907338653691113
The modified gen p mean: 0.4481251835823059, gen p mean: -0.11419995129108429, mean p set: 0.4486992359161377
loss_pred:0.015124211087822914, decouple_loss:0.00043535864097066224
The modified gen p mean: 0.4481203258037567, gen p mean: -0.11569542437791824, mean p set: 0.44869574904441833
loss_pred:0.01472062710672617, decouple_loss:0.00040808782796375453
Iteration: 2647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475799798965454, gen p mean: -0.11669620871543884, mean p set: 0.4481564164161682
loss_pred:0.014445238746702671, decouple_loss:0.00046813307562842965
The modified gen p mean: 0.44696158170700073, gen p mean: -0.12096509337425232, mean p set: 0.4475356340408325
loss_pred:0.014270058833062649, decouple_loss:0.00034853172837756574
The modified gen p mean: 0.44844457507133484, gen p mean: -0.12065518647432327, mean p set: 0.4490198791027069
loss_pred:0.014560585841536522, decouple_loss:0.00028902673511765897
Iteration: 2648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690772891044617, gen p mean: -0.12374573200941086, mean p set: 0.4474853575229645
loss_pred:0.014094957150518894, decouple_loss:0.0003621985379140824
The modified gen p mean: 0.44790831208229065, gen p mean: -0.11588378250598907, mean p set: 0.4484834671020508
The modified gen p mean: 0.44679129123687744, gen p mean: -0.11988181620836258, mean p set: 0.447368323802948
loss_pred:0.014291570521891117, decouple_loss:0.0003315533103886992
loss_pred:0.014685088768601418, decouple_loss:0.00034900952596217394
Iteration: 2649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44703635573387146, gen p mean: -0.11990433186292648, mean p set: 0.4476125240325928
loss_pred:0.014666267670691013, decouple_loss:0.0003092800616286695
The modified gen p mean: 0.4469773769378662, gen p mean: -0.11931734532117844, mean p set: 0.44755110144615173
loss_pred:0.014953801408410072, decouple_loss:0.00034817770938389003
The modified gen p mean: 0.4470696747303009, gen p mean: -0.1193096861243248, mean p set: 0.4476448595523834
loss_pred:0.014863823540508747, decouple_loss:0.0003127674281131476
Iteration: 2650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499896168708801, gen p mean: -0.12061972916126251, mean p set: 0.4505683481693268
loss_pred:0.013925701379776001, decouple_loss:0.0003992487327195704
The modified gen p mean: 0.448944628238678, gen p mean: -0.12073346972465515, mean p set: 0.44952166080474854
loss_pred:0.014362292364239693, decouple_loss:0.00040964019717648625
The modified gen p mean: 0.44797825813293457, gen p mean: -0.1162373349070549, mean p set: 0.4485537111759186
loss_pred:0.015657594427466393, decouple_loss:0.0004342807224020362
2023-05-02 13:35:21 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12354227155447006, mean p set: 0.4502691626548767
loss_pred:0.01680609956383705, decouple_loss:0.00037056373548693955
The modified gen p mean: 0.4495358467102051, gen p mean: -0.11729422956705093, mean p set: 0.4500633478164673
loss_pred:0.01612219773232937, decouple_loss:0.00041505685658194125
The modified gen p mean: 0.4498273730278015, gen p mean: -0.11729216575622559, mean p set: 0.45035696029663086
loss_pred:0.016349704936146736, decouple_loss:0.0003542242047842592
WV_1_PC_1_EH_0_PS_40, loss: 0.01644499972462654, avg_mse: 0.025702785700559616
current test mse: 0.025703
Iteration: 2651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753408432006836, gen p mean: -0.11642324924468994, mean p set: 0.4481089115142822
loss_pred:0.015051709488034248, decouple_loss:0.00036032235948368907
The modified gen p mean: 0.4481446444988251, gen p mean: -0.12072870880365372, mean p set: 0.44871997833251953The modified gen p mean: 0.44960707426071167, gen p mean: -0.12302438169717789, mean p set: 0.45018208026885986
loss_pred:0.014139700680971146, decouple_loss:0.0003627395781222731
loss_pred:0.013306191191077232, decouple_loss:0.0003295486676506698
Iteration: 2652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488264322280884, gen p mean: -0.12265179306268692, mean p set: 0.44939976930618286
loss_pred:0.014443907886743546, decouple_loss:0.0004746506456285715
The modified gen p mean: 0.44767066836357117, gen p mean: -0.12402070313692093, mean p set: 0.4482479691505432
The modified gen p mean: 0.4490892291069031, gen p mean: -0.12415500730276108, mean p set: 0.449665904045105
loss_pred:0.015332772396504879, decouple_loss:0.00042147375643253326
loss_pred:0.013726331293582916, decouple_loss:0.00032203414593823254
Iteration: 2653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447690486907959, gen p mean: -0.12541033327579498, mean p set: 0.4482649564743042
loss_pred:0.014538413845002651, decouple_loss:0.00037931924453005195
The modified gen p mean: 0.4467577636241913, gen p mean: -0.12763917446136475, mean p set: 0.4473358392715454
loss_pred:0.014254780486226082, decouple_loss:0.0003666780248750001
The modified gen p mean: 0.44871971011161804, gen p mean: -0.12618465721607208, mean p set: 0.44929543137550354
loss_pred:0.014393885619938374, decouple_loss:0.0003946207871194929
Iteration: 2654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468207061290741, gen p mean: -0.12965524196624756, mean p set: 0.4473958909511566
loss_pred:0.014471936970949173, decouple_loss:0.00043015077244490385
The modified gen p mean: 0.44668805599212646, gen p mean: -0.12388014793395996, mean p set: 0.44726231694221497
loss_pred:0.015399136580526829, decouple_loss:0.0004627276794053614
The modified gen p mean: 0.44823238253593445, gen p mean: -0.12651532888412476, mean p set: 0.4488097131252289
loss_pred:0.014765256084501743, decouple_loss:0.0005820615333504975
Iteration: 2655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479404091835022, gen p mean: -0.12852232158184052, mean p set: 0.4485156238079071
loss_pred:0.013824263587594032, decouple_loss:0.0005168961361050606
The modified gen p mean: 0.4494585692882538, gen p mean: -0.13146717846393585, mean p set: 0.4500364065170288
loss_pred:0.014213725924491882, decouple_loss:0.00046235654735937715
The modified gen p mean: 0.44748133420944214, gen p mean: -0.1353466957807541, mean p set: 0.4480571746826172
loss_pred:0.014576301909983158, decouple_loss:0.00044119483209215105
Iteration: 2656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484657943248749, gen p mean: -0.1310396045446396, mean p set: 0.44904476404190063
loss_pred:0.01487523503601551, decouple_loss:0.0002798881323542446
The modified gen p mean: 0.4476119875907898, gen p mean: -0.12633107602596283, mean p set: 0.4481905400753021
loss_pred:0.014433891512453556, decouple_loss:0.0003042024909518659
The modified gen p mean: 0.4479910135269165, gen p mean: -0.1301116645336151, mean p set: 0.4485693573951721
loss_pred:0.0139289116486907, decouple_loss:0.0002951943315565586
Iteration: 2657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493483304977417, gen p mean: -0.12851941585540771, mean p set: 0.4499242305755615
loss_pred:0.014440135098993778, decouple_loss:0.0005051821353845298
The modified gen p mean: 0.4480273425579071, gen p mean: -0.12643413245677948, mean p set: 0.44860541820526123
loss_pred:0.01469923835247755, decouple_loss:0.000540221924893558
The modified gen p mean: 0.450065940618515, gen p mean: -0.13055235147476196, mean p set: 0.4506426155567169
loss_pred:0.014168432913720608, decouple_loss:0.000598133250605315
Iteration: 2658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773876667022705, gen p mean: -0.1283694952726364, mean p set: 0.4483180344104767
loss_pred:0.015077896416187286, decouple_loss:0.00044093135511502624
The modified gen p mean: 0.4471587836742401, gen p mean: -0.12579762935638428, mean p set: 0.4477330446243286
loss_pred:0.01450628973543644, decouple_loss:0.0004913271404802799
The modified gen p mean: 0.4477468729019165, gen p mean: -0.12446311116218567, mean p set: 0.44832107424736023
loss_pred:0.01502380520105362, decouple_loss:0.0005641360185109079
Iteration: 2659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483354091644287, gen p mean: -0.12308267503976822, mean p set: 0.4489106833934784
loss_pred:0.014538494870066643, decouple_loss:0.00041204277658835053
The modified gen p mean: 0.44655168056488037, gen p mean: -0.12794309854507446, mean p set: 0.4471263289451599
loss_pred:0.013885540887713432, decouple_loss:0.00041521197999827564
The modified gen p mean: 0.44731026887893677, gen p mean: -0.12656477093696594, mean p set: 0.4478845000267029
loss_pred:0.014043351635336876, decouple_loss:0.0004248986369930208
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 2660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475354850292206, gen p mean: -0.12295857816934586, mean p set: 0.4481123387813568
loss_pred:0.014529557898640633, decouple_loss:0.0003318205417599529
The modified gen p mean: 0.4472044110298157, gen p mean: -0.12264440208673477, mean p set: 0.44777771830558777
The modified gen p mean: 0.44766828417778015, gen p mean: -0.12659919261932373, mean p set: 0.44824355840682983
loss_pred:0.015360342338681221, decouple_loss:0.0004341079038567841
loss_pred:0.01544338557869196, decouple_loss:0.0003605684614740312
2023-05-02 13:38:46 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1289663016796112, mean p set: 0.4502691626548767
loss_pred:0.016848251223564148, decouple_loss:0.00037161054206080735
The modified gen p mean: 0.44953498244285583, gen p mean: -0.12257809191942215, mean p set: 0.4500633478164673
loss_pred:0.016170881688594818, decouple_loss:0.00037419397267512977
The modified gen p mean: 0.4498295187950134, gen p mean: -0.12231995165348053, mean p set: 0.45035696029663086
loss_pred:0.016399934887886047, decouple_loss:0.00034237050567753613
WV_1_PC_1_EH_0_PS_40, loss: 0.016491157934069633, avg_mse: 0.025761380791664124
current test mse: 0.025761
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804641604423523, gen p mean: -0.1297919899225235, mean p set: 0.4486217796802521
loss_pred:0.014823772944509983, decouple_loss:0.00037055101711302996
The modified gen p mean: 0.44748130440711975, gen p mean: -0.1279027909040451, mean p set: 0.4480603337287903The modified gen p mean: 0.44756975769996643, gen p mean: -0.1267383098602295, mean p set: 0.4481448233127594
loss_pred:0.015023318119347095, decouple_loss:0.00042430360917933285
loss_pred:0.015105945989489555, decouple_loss:0.00030237529426813126
Iteration: 2662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472404718399048, gen p mean: -0.12402895092964172, mean p set: 0.44781771302223206
loss_pred:0.015447428449988365, decouple_loss:0.00036963901948183775
The modified gen p mean: 0.44736263155937195, gen p mean: -0.12572383880615234, mean p set: 0.44793930649757385The modified gen p mean: 0.44709742069244385, gen p mean: -0.12576179206371307, mean p set: 0.44767072796821594
loss_pred:0.015515470877289772, decouple_loss:0.000393341964809224loss_pred:0.015443996526300907, decouple_loss:0.0004786437493748963
Iteration: 2663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717279076576233, gen p mean: -0.1292247325181961, mean p set: 0.44774720072746277
loss_pred:0.014482371509075165, decouple_loss:0.0003908465150743723
The modified gen p mean: 0.4476662278175354, gen p mean: -0.13132502138614655, mean p set: 0.4482428729534149
loss_pred:0.014804420992732048, decouple_loss:0.0004449644184205681
The modified gen p mean: 0.44689086079597473, gen p mean: -0.12294363230466843, mean p set: 0.4474641680717468
loss_pred:0.01578756794333458, decouple_loss:0.00043306357110850513
Iteration: 2664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708743691444397, gen p mean: -0.127767413854599, mean p set: 0.4476645588874817
loss_pred:0.01516767404973507, decouple_loss:0.0005128245684318244
The modified gen p mean: 0.4472961127758026, gen p mean: -0.12331148236989975, mean p set: 0.4478713572025299
loss_pred:0.015435977838933468, decouple_loss:0.0006351263727992773
The modified gen p mean: 0.4475012421607971, gen p mean: -0.1282987743616104, mean p set: 0.44807714223861694
loss_pred:0.015107711777091026, decouple_loss:0.0005396290216594934
Iteration: 2665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705694913864136, gen p mean: -0.12707999348640442, mean p set: 0.44763314723968506
loss_pred:0.0155177628621459, decouple_loss:0.000361944199539721
The modified gen p mean: 0.4477604627609253, gen p mean: -0.1281350553035736, mean p set: 0.44833505153656006
loss_pred:0.01510428823530674, decouple_loss:0.00041538276127539575
The modified gen p mean: 0.4476960301399231, gen p mean: -0.13062269985675812, mean p set: 0.4482708275318146
loss_pred:0.015729105100035667, decouple_loss:0.0003069705853704363
Iteration: 2666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752323627471924, gen p mean: -0.12645137310028076, mean p set: 0.4481000304222107
loss_pred:0.015127342194318771, decouple_loss:0.0006350079202093184
The modified gen p mean: 0.44744113087654114, gen p mean: -0.1252666562795639, mean p set: 0.4480176270008087
loss_pred:0.015280673280358315, decouple_loss:0.0004515132459346205
The modified gen p mean: 0.4472036063671112, gen p mean: -0.1275063157081604, mean p set: 0.4477778375148773
loss_pred:0.014521979726850986, decouple_loss:0.0005226960056461394
Iteration: 2667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476962089538574, gen p mean: -0.12381012737751007, mean p set: 0.4482730031013489
loss_pred:0.014799805358052254, decouple_loss:0.00040194240864366293
The modified gen p mean: 0.4468682110309601, gen p mean: -0.12517456710338593, mean p set: 0.447443425655365
The modified gen p mean: 0.4480367600917816, gen p mean: -0.12413600832223892, mean p set: 0.4486115872859955
loss_pred:0.014879723079502583, decouple_loss:0.0004422899801284075
loss_pred:0.015069104731082916, decouple_loss:0.0003389003104530275
Iteration: 2668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479379951953888, gen p mean: -0.12471828609704971, mean p set: 0.4485156238079071
loss_pred:0.014228696003556252, decouple_loss:0.00039137215935625136
The modified gen p mean: 0.447815865278244, gen p mean: -0.12138498574495316, mean p set: 0.4483889639377594
loss_pred:0.014709373004734516, decouple_loss:0.0004447425017133355
The modified gen p mean: 0.4470067620277405, gen p mean: -0.12806911766529083, mean p set: 0.44758090376853943
loss_pred:0.014708340167999268, decouple_loss:0.00037739973049610853
Iteration: 2669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762519001960754, gen p mean: -0.12032997608184814, mean p set: 0.44820162653923035
loss_pred:0.015372021123766899, decouple_loss:0.00048827979480847716
The modified gen p mean: 0.44764697551727295, gen p mean: -0.11963129788637161, mean p set: 0.4482216238975525
The modified gen p mean: 0.4484938979148865, gen p mean: -0.12669776380062103, mean p set: 0.4490669369697571
loss_pred:0.015566916204988956, decouple_loss:0.0005551505018956959
loss_pred:0.01465724129229784, decouple_loss:0.0004209797771181911
Iteration: 2670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482315480709076, gen p mean: -0.12355446070432663, mean p set: 0.4488099217414856
loss_pred:0.015409210696816444, decouple_loss:0.0005793129676021636
The modified gen p mean: 0.44742628931999207, gen p mean: -0.12461596727371216, mean p set: 0.4480043649673462
The modified gen p mean: 0.44682222604751587, gen p mean: -0.1253170371055603, mean p set: 0.44739648699760437
loss_pred:0.015381638891994953, decouple_loss:0.0005817755591124296
loss_pred:0.01586158759891987, decouple_loss:0.0004477945331018418
2023-05-02 13:40:52 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12784568965435028, mean p set: 0.4502691626548767
loss_pred:0.01683221571147442, decouple_loss:0.0005499611725099385
The modified gen p mean: 0.4495352506637573, gen p mean: -0.12164904177188873, mean p set: 0.4500633478164673
loss_pred:0.01613488234579563, decouple_loss:0.00042763588135130703
The modified gen p mean: 0.4498277008533478, gen p mean: -0.12133403867483139, mean p set: 0.45035696029663086
loss_pred:0.016460414975881577, decouple_loss:0.00036586367059499025
WV_1_PC_1_EH_0_PS_40, loss: 0.016498228535056114, avg_mse: 0.02583501860499382
current test mse: 0.025835
Iteration: 2671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667506217956543, gen p mean: -0.12220302224159241, mean p set: 0.44725102186203003
loss_pred:0.01432473212480545, decouple_loss:0.00047782124602235854
The modified gen p mean: 0.4459179639816284, gen p mean: -0.12490467727184296, mean p set: 0.44649389386177063The modified gen p mean: 0.4469222128391266, gen p mean: -0.1225866749882698, mean p set: 0.44749921560287476
loss_pred:0.014275435358285904, decouple_loss:0.00036251230631023645
loss_pred:0.014977269805967808, decouple_loss:0.00041935144690796733
Iteration: 2672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756829738616943, gen p mean: -0.12315738201141357, mean p set: 0.4481445848941803
The modified gen p mean: 0.4475151598453522, gen p mean: -0.12205713242292404, mean p set: 0.4480897784233093
loss_pred:0.014641819521784782, decouple_loss:0.0004853180143982172
loss_pred:0.01488449890166521, decouple_loss:0.00045843273983336985
The modified gen p mean: 0.44849205017089844, gen p mean: -0.12946289777755737, mean p set: 0.4490697383880615
loss_pred:0.014493745751678944, decouple_loss:0.00046913078404031694
Iteration: 2673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710397720336914, gen p mean: -0.12895779311656952, mean p set: 0.44768041372299194
loss_pred:0.014325480908155441, decouple_loss:0.0004731066292151809
The modified gen p mean: 0.44709643721580505, gen p mean: -0.12839698791503906, mean p set: 0.44767072796821594
loss_pred:0.01525229960680008, decouple_loss:0.0004174174973741174
The modified gen p mean: 0.44790977239608765, gen p mean: -0.13035322725772858, mean p set: 0.44848695397377014
loss_pred:0.01465874444693327, decouple_loss:0.0004272118676453829
Iteration: 2674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473939538002014, gen p mean: -0.12571179866790771, mean p set: 0.4479702413082123
loss_pred:0.014855694025754929, decouple_loss:0.00048969587078318
The modified gen p mean: 0.44655677676200867, gen p mean: -0.128091961145401, mean p set: 0.44713303446769714
loss_pred:0.01441853865981102, decouple_loss:0.0002930967602878809
The modified gen p mean: 0.4477231204509735, gen p mean: -0.13240034878253937, mean p set: 0.4482952058315277
loss_pred:0.01467711292207241, decouple_loss:0.0003412158112041652
Iteration: 2675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743111729621887, gen p mean: -0.13177645206451416, mean p set: 0.4480067491531372
loss_pred:0.01495558861643076, decouple_loss:0.0004008268006145954
The modified gen p mean: 0.4472595453262329, gen p mean: -0.12822598218917847, mean p set: 0.44783589243888855
loss_pred:0.014576275832951069, decouple_loss:0.00035405581002123654
The modified gen p mean: 0.4474327564239502, gen p mean: -0.13144244253635406, mean p set: 0.44800713658332825
loss_pred:0.014528632164001465, decouple_loss:0.0005183875327929854
Iteration: 2676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44644758105278015, gen p mean: -0.12843593955039978, mean p set: 0.44702383875846863
loss_pred:0.014546696096658707, decouple_loss:0.00032825538073666394
The modified gen p mean: 0.4473898112773895, gen p mean: -0.12627418339252472, mean p set: 0.4479668438434601
loss_pred:0.015534115023911, decouple_loss:0.0005117037799209356
The modified gen p mean: 0.44713452458381653, gen p mean: -0.1288088858127594, mean p set: 0.44771143794059753
loss_pred:0.015259972773492336, decouple_loss:0.0005168384523130953
Iteration: 2677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735074043273926, gen p mean: -0.13250131905078888, mean p set: 0.44792598485946655
loss_pred:0.014874857850372791, decouple_loss:0.0005629145889542997
The modified gen p mean: 0.4461822807788849, gen p mean: -0.130189910531044, mean p set: 0.4467572569847107
loss_pred:0.014124417677521706, decouple_loss:0.00043819707934744656
The modified gen p mean: 0.4467175006866455, gen p mean: -0.13206268846988678, mean p set: 0.44729599356651306
loss_pred:0.014252377673983574, decouple_loss:0.00040626132977195084
Iteration: 2678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702470302581787, gen p mean: -0.12923386693000793, mean p set: 0.4475988745689392
loss_pred:0.014632395468652248, decouple_loss:0.0005190126248635352
The modified gen p mean: 0.4469827115535736, gen p mean: -0.12718670070171356, mean p set: 0.44755926728248596
The modified gen p mean: 0.44708412885665894, gen p mean: -0.13159742951393127, mean p set: 0.4476606547832489
loss_pred:0.01561428140848875, decouple_loss:0.0003744449932128191
loss_pred:0.015405281446874142, decouple_loss:0.0004353984841145575
Iteration: 2679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749385118484497, gen p mean: -0.1324286162853241, mean p set: 0.44806763529777527
loss_pred:0.014609168283641338, decouple_loss:0.0005548389162868261
The modified gen p mean: 0.44722944498062134, gen p mean: -0.13169078528881073, mean p set: 0.4478038251399994
The modified gen p mean: 0.44746193289756775, gen p mean: -0.13083188235759735, mean p set: 0.4480361342430115
loss_pred:0.014820506796240807, decouple_loss:0.00045422939001582563
loss_pred:0.015013161115348339, decouple_loss:0.0003708307631313801
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
NaN value num: 0
Iteration: 2680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45170748233795166, gen p mean: -0.12561389803886414, mean p set: 0.45228278636932373
loss_pred:0.013873327523469925, decouple_loss:0.0004562045796774328
The modified gen p mean: 0.44824063777923584, gen p mean: -0.1253855675458908, mean p set: 0.4488172233104706
loss_pred:0.014702984131872654, decouple_loss:0.0005054658395238221
The modified gen p mean: 0.4513065814971924, gen p mean: -0.12250573933124542, mean p set: 0.4518847167491913
loss_pred:0.014178222045302391, decouple_loss:0.0004391083202790469
2023-05-02 13:43:44 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1329173445701599, mean p set: 0.4502691626548767
loss_pred:0.016840936616063118, decouple_loss:0.0004429200489539653
The modified gen p mean: 0.4495357871055603, gen p mean: -0.12688378989696503, mean p set: 0.4500633478164673
loss_pred:0.01613994501531124, decouple_loss:0.0004973974428139627
The modified gen p mean: 0.44982805848121643, gen p mean: -0.12643581628799438, mean p set: 0.45035696029663086
loss_pred:0.016439536586403847, decouple_loss:0.000534205581061542
WV_1_PC_1_EH_0_PS_40, loss: 0.016498049721121788, avg_mse: 0.025830160826444626
current test mse: 0.02583
Iteration: 2681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516645073890686, gen p mean: -0.12674079835414886, mean p set: 0.45224204659461975
loss_pred:0.014137749560177326, decouple_loss:0.0004572052275761962
The modified gen p mean: 0.45190709829330444, gen p mean: -0.12081993371248245, mean p set: 0.45248204469680786The modified gen p mean: 0.45131513476371765, gen p mean: -0.1222446858882904, mean p set: 0.4518887996673584
loss_pred:0.014075914397835732, decouple_loss:0.0004931514849886298
loss_pred:0.013789180666208267, decouple_loss:0.0004521165101323277
Iteration: 2682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509020447731018, gen p mean: -0.115816131234169, mean p set: 0.4514783024787903
loss_pred:0.015107529237866402, decouple_loss:0.0006599481566809118
The modified gen p mean: 0.45022353529930115, gen p mean: -0.11625666916370392, mean p set: 0.4507984220981598The modified gen p mean: 0.450447678565979, gen p mean: -0.1162605732679367, mean p set: 0.4510226845741272
loss_pred:0.014265269041061401, decouple_loss:0.0004137369978707284loss_pred:0.01449495181441307, decouple_loss:0.00035393561120145023
Iteration: 2683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502109885215759, gen p mean: -0.11439964175224304, mean p set: 0.4507897198200226
loss_pred:0.014201782643795013, decouple_loss:0.0003879369469359517
The modified gen p mean: 0.4517853856086731, gen p mean: -0.1143961250782013, mean p set: 0.4523625671863556
loss_pred:0.015147412195801735, decouple_loss:0.0004481571668293327
The modified gen p mean: 0.450135201215744, gen p mean: -0.11217508465051651, mean p set: 0.45071083307266235
loss_pred:0.014030253514647484, decouple_loss:0.0003939775051549077
Iteration: 2684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452053964138031, gen p mean: -0.12211107462644577, mean p set: 0.4526314437389374
loss_pred:0.014037919230759144, decouple_loss:0.00044652819633483887
The modified gen p mean: 0.4498497247695923, gen p mean: -0.11539454758167267, mean p set: 0.4504260718822479
loss_pred:0.014898717403411865, decouple_loss:0.00044264306779950857
The modified gen p mean: 0.45162466168403625, gen p mean: -0.11533460766077042, mean p set: 0.45220106840133667
loss_pred:0.014353488571941853, decouple_loss:0.0004351817478891462
Iteration: 2685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504651129245758, gen p mean: -0.11256204545497894, mean p set: 0.45104217529296875
loss_pred:0.014523950405418873, decouple_loss:0.0004515788168646395
The modified gen p mean: 0.4499622583389282, gen p mean: -0.1149032935500145, mean p set: 0.45053830742836
loss_pred:0.014037078246474266, decouple_loss:0.0004967970307916403
The modified gen p mean: 0.4525821805000305, gen p mean: -0.11343100666999817, mean p set: 0.4531586468219757
loss_pred:0.01421965379267931, decouple_loss:0.0006117469165474176
Iteration: 2686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493153393268585, gen p mean: -0.11454608291387558, mean p set: 0.4498947560787201
loss_pred:0.014542413875460625, decouple_loss:0.0004397515731398016
The modified gen p mean: 0.4515973925590515, gen p mean: -0.1136971116065979, mean p set: 0.45217567682266235
loss_pred:0.014048452489078045, decouple_loss:0.0004256496613379568
The modified gen p mean: 0.450420618057251, gen p mean: -0.11531522870063782, mean p set: 0.45099693536758423
loss_pred:0.013918749988079071, decouple_loss:0.00044877969776280224
Iteration: 2687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506804943084717, gen p mean: -0.11213067173957825, mean p set: 0.45125675201416016
loss_pred:0.014359302818775177, decouple_loss:0.0003370553895365447
The modified gen p mean: 0.4518686830997467, gen p mean: -0.11630269140005112, mean p set: 0.45244479179382324
loss_pred:0.014296644367277622, decouple_loss:0.0004473159497138113
The modified gen p mean: 0.4519527554512024, gen p mean: -0.1146504357457161, mean p set: 0.45253023505210876
loss_pred:0.014305747114121914, decouple_loss:0.0004049931885674596
Iteration: 2688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44902732968330383, gen p mean: -0.11792106181383133, mean p set: 0.44960182905197144
loss_pred:0.014961903914809227, decouple_loss:0.0005453296471387148
The modified gen p mean: 0.451192706823349, gen p mean: -0.1176881268620491, mean p set: 0.4517684876918793
loss_pred:0.014307132922112942, decouple_loss:0.0004801553732249886
The modified gen p mean: 0.45159706473350525, gen p mean: -0.1167437806725502, mean p set: 0.45217224955558777
loss_pred:0.014324741438031197, decouple_loss:0.0004358884762041271
Iteration: 2689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128679275512695, gen p mean: -0.11817806214094162, mean p set: 0.4518622159957886
loss_pred:0.014547256752848625, decouple_loss:0.000516403466463089
The modified gen p mean: 0.4511634409427643, gen p mean: -0.11606784164905548, mean p set: 0.45174074172973633
loss_pred:0.013888454996049404, decouple_loss:0.0005250662798061967
The modified gen p mean: 0.45148107409477234, gen p mean: -0.12209607660770416, mean p set: 0.45205995440483093
loss_pred:0.01447095163166523, decouple_loss:0.0006081722676753998
Iteration: 2690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933241605758667, gen p mean: -0.12252451479434967, mean p set: 0.4499072730541229
loss_pred:0.013659183867275715, decouple_loss:0.0004488389240577817
The modified gen p mean: 0.4491134583950043, gen p mean: -0.12370429933071136, mean p set: 0.4496879279613495
loss_pred:0.015098334290087223, decouple_loss:0.0005050522740930319
The modified gen p mean: 0.44897714257240295, gen p mean: -0.12354394048452377, mean p set: 0.449554443359375
loss_pred:0.015163176693022251, decouple_loss:0.0005107248434796929
2023-05-02 13:45:51 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1352790892124176, mean p set: 0.4502691626548767
loss_pred:0.01693606562912464, decouple_loss:0.00043275870848447084
The modified gen p mean: 0.4495348632335663, gen p mean: -0.12906675040721893, mean p set: 0.4500633478164673
loss_pred:0.01625073328614235, decouple_loss:0.0004523689567577094
The modified gen p mean: 0.4498250484466553, gen p mean: -0.12867283821105957, mean p set: 0.45035696029663086
loss_pred:0.016510479152202606, decouple_loss:0.0004683258885052055
WV_1_PC_1_EH_0_PS_40, loss: 0.016588319092988968, avg_mse: 0.02595640905201435
current test mse: 0.025956
Iteration: 2691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503615200519562, gen p mean: -0.12552335858345032, mean p set: 0.4509369432926178
loss_pred:0.013817476108670235, decouple_loss:0.0005043476703576744
The modified gen p mean: 0.4503856599330902, gen p mean: -0.1185409352183342, mean p set: 0.45096179842948914
The modified gen p mean: 0.4508969783782959, gen p mean: -0.12487796694040298, mean p set: 0.45147067308425903
loss_pred:0.014622068032622337, decouple_loss:0.00041079765651375055
loss_pred:0.013975081034004688, decouple_loss:0.00046031567035242915
Iteration: 2692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45078137516975403, gen p mean: -0.124967560172081, mean p set: 0.4513586759567261
loss_pred:0.014350872486829758, decouple_loss:0.0005889708991162479
The modified gen p mean: 0.4508747458457947, gen p mean: -0.12823082506656647, mean p set: 0.4514505863189697The modified gen p mean: 0.45085665583610535, gen p mean: -0.12811671197414398, mean p set: 0.4514320194721222
loss_pred:0.01382578257471323, decouple_loss:0.0005218247533775866loss_pred:0.014422767795622349, decouple_loss:0.0005247151129879057
Iteration: 2693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45317548513412476, gen p mean: -0.12409724295139313, mean p set: 0.45375457406044006
loss_pred:0.014847865328192711, decouple_loss:0.0005938995745964348
The modified gen p mean: 0.45109421014785767, gen p mean: -0.12732593715190887, mean p set: 0.45167064666748047The modified gen p mean: 0.4508604407310486, gen p mean: -0.12779907882213593, mean p set: 0.4514361619949341
loss_pred:0.014031198807060719, decouple_loss:0.0005286068771965802
loss_pred:0.013840748928487301, decouple_loss:0.0004958987119607627
Iteration: 2694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517666697502136, gen p mean: -0.1263437569141388, mean p set: 0.4523402452468872
loss_pred:0.014434047043323517, decouple_loss:0.0004298299609217793
The modified gen p mean: 0.45002105832099915, gen p mean: -0.1241549625992775, mean p set: 0.4505949914455414
loss_pred:0.014419997110962868, decouple_loss:0.000389053369872272
The modified gen p mean: 0.4507160484790802, gen p mean: -0.12726932764053345, mean p set: 0.45129311084747314
loss_pred:0.013989154249429703, decouple_loss:0.0004255755338817835
Iteration: 2695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44999656081199646, gen p mean: -0.12547379732131958, mean p set: 0.45057356357574463
loss_pred:0.014886664226651192, decouple_loss:0.0004139414813835174
The modified gen p mean: 0.45087364315986633, gen p mean: -0.12318819016218185, mean p set: 0.45144835114479065
loss_pred:0.01443243958055973, decouple_loss:0.0004191187326796353
The modified gen p mean: 0.45024675130844116, gen p mean: -0.12406450510025024, mean p set: 0.4508242905139923
loss_pred:0.014043564908206463, decouple_loss:0.0004828720702789724
Iteration: 2696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962549209594727, gen p mean: -0.12268546968698502, mean p set: 0.4502032399177551
loss_pred:0.0150480717420578, decouple_loss:0.0004988060682080686
The modified gen p mean: 0.45091715455055237, gen p mean: -0.12109833210706711, mean p set: 0.45149585604667664
The modified gen p mean: 0.45227375626564026, gen p mean: -0.12346407026052475, mean p set: 0.45284903049468994
loss_pred:0.014508983120322227, decouple_loss:0.000440487201558426
loss_pred:0.014649594202637672, decouple_loss:0.0004740545991808176
Iteration: 2697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507826864719391, gen p mean: -0.12262915074825287, mean p set: 0.45135921239852905
loss_pred:0.014334236271679401, decouple_loss:0.00044546465505845845
The modified gen p mean: 0.4493771493434906, gen p mean: -0.11852885037660599, mean p set: 0.4499543607234955
loss_pred:0.014166523702442646, decouple_loss:0.000458784430520609
The modified gen p mean: 0.4504472017288208, gen p mean: -0.1211259663105011, mean p set: 0.4510255753993988
loss_pred:0.013792471960186958, decouple_loss:0.000454423192422837
Iteration: 2698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505082368850708, gen p mean: -0.11653084307909012, mean p set: 0.4510842561721802
loss_pred:0.013692065142095089, decouple_loss:0.0003694658516906202
The modified gen p mean: 0.44959673285484314, gen p mean: -0.11975488811731339, mean p set: 0.4501703083515167
loss_pred:0.013949736952781677, decouple_loss:0.00032845186069607735
The modified gen p mean: 0.45129984617233276, gen p mean: -0.11951122432947159, mean p set: 0.45187288522720337
loss_pred:0.014329514466226101, decouple_loss:0.00045089187915436924
Iteration: 2699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45057469606399536, gen p mean: -0.11839605867862701, mean p set: 0.4511524438858032
loss_pred:0.014137410558760166, decouple_loss:0.0004128112050238997
The modified gen p mean: 0.45073434710502625, gen p mean: -0.11384262889623642, mean p set: 0.4513106644153595
loss_pred:0.013983476907014847, decouple_loss:0.00043193335295654833
The modified gen p mean: 0.4530448019504547, gen p mean: -0.11899448931217194, mean p set: 0.45362117886543274
loss_pred:0.014826503582298756, decouple_loss:0.0005559732671827078
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
NaN value num: 0
Iteration: 2700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480319321155548, gen p mean: -0.12389113754034042, mean p set: 0.4486088454723358
loss_pred:0.015187637880444527, decouple_loss:0.0004072468145750463
The modified gen p mean: 0.44695329666137695, gen p mean: -0.12446499615907669, mean p set: 0.4475279748439789
The modified gen p mean: 0.44642215967178345, gen p mean: -0.12099350243806839, mean p set: 0.44700080156326294
loss_pred:0.016554106026887894, decouple_loss:0.0005173483514226973
loss_pred:0.01648222655057907, decouple_loss:0.0003893001994583756
2023-05-02 13:48:36 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13072821497917175, mean p set: 0.4502691626548767
loss_pred:0.016948765143752098, decouple_loss:0.00048718659672886133
The modified gen p mean: 0.44953402876853943, gen p mean: -0.12446056306362152, mean p set: 0.4500633478164673
loss_pred:0.01619071513414383, decouple_loss:0.0004070997820235789
The modified gen p mean: 0.44982901215553284, gen p mean: -0.12412484735250473, mean p set: 0.45035696029663086
loss_pred:0.01638074405491352, decouple_loss:0.00045144089381210506
WV_1_PC_1_EH_0_PS_40, loss: 0.01652917079627514, avg_mse: 0.02579624205827713
current test mse: 0.025796
Iteration: 2701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909587502479553, gen p mean: -0.12464434653520584, mean p set: 0.44967013597488403
loss_pred:0.015508407726883888, decouple_loss:0.0003944274503737688
The modified gen p mean: 0.4478796124458313, gen p mean: -0.12555824220180511, mean p set: 0.44845619797706604The modified gen p mean: 0.44701436161994934, gen p mean: -0.1265750229358673, mean p set: 0.44758954644203186
loss_pred:0.015106188133358955, decouple_loss:0.00047385579091496766
loss_pred:0.01641308143734932, decouple_loss:0.00042212667176499963
Iteration: 2702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669368863105774, gen p mean: -0.12246406823396683, mean p set: 0.4472734034061432
The modified gen p mean: 0.4488009214401245, gen p mean: -0.12408605962991714, mean p set: 0.4493786096572876
loss_pred:0.01658652164041996, decouple_loss:0.0004700533754657954
loss_pred:0.0154789499938488, decouple_loss:0.0004668498004321009
The modified gen p mean: 0.4474388062953949, gen p mean: -0.12220321595668793, mean p set: 0.44801533222198486
loss_pred:0.015525827184319496, decouple_loss:0.0004587553848978132
Iteration: 2703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480322301387787, gen p mean: -0.12249349802732468, mean p set: 0.44860756397247314
The modified gen p mean: 0.44712331891059875, gen p mean: -0.12497261166572571, mean p set: 0.44770026206970215
loss_pred:0.015054631978273392, decouple_loss:0.00047739563160575926
loss_pred:0.016592638567090034, decouple_loss:0.0003711375466082245
The modified gen p mean: 0.44748154282569885, gen p mean: -0.12846924364566803, mean p set: 0.44805729389190674
loss_pred:0.016432298347353935, decouple_loss:0.00040588638512417674
Iteration: 2704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811123609542847, gen p mean: -0.12787142395973206, mean p set: 0.44868648052215576
loss_pred:0.015301401726901531, decouple_loss:0.0005257910233922303
The modified gen p mean: 0.4492892324924469, gen p mean: -0.13064876198768616, mean p set: 0.44986119866371155
loss_pred:0.016207654029130936, decouple_loss:0.0003872312663588673
The modified gen p mean: 0.4476047456264496, gen p mean: -0.12575647234916687, mean p set: 0.4481804668903351
loss_pred:0.01522678229957819, decouple_loss:0.0006100861355662346
Iteration: 2705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478757083415985, gen p mean: -0.13047389686107635, mean p set: 0.4484530985355377
loss_pred:0.015570986084640026, decouple_loss:0.0004770689702127129
The modified gen p mean: 0.4457380473613739, gen p mean: -0.1279023438692093, mean p set: 0.44631341099739075
loss_pred:0.016482850536704063, decouple_loss:0.0004259441629983485
The modified gen p mean: 0.44796422123908997, gen p mean: -0.13598433136940002, mean p set: 0.44854092597961426
loss_pred:0.016069673001766205, decouple_loss:0.00047892931615933776
Iteration: 2706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487794041633606, gen p mean: -0.12733542919158936, mean p set: 0.44935378432273865
loss_pred:0.015436090528964996, decouple_loss:0.0004415410803630948
The modified gen p mean: 0.44815564155578613, gen p mean: -0.1317502111196518, mean p set: 0.44873231649398804
loss_pred:0.015492879785597324, decouple_loss:0.0004524670948740095
The modified gen p mean: 0.44721102714538574, gen p mean: -0.13112658262252808, mean p set: 0.447790265083313
loss_pred:0.015483936294913292, decouple_loss:0.0004619109386112541
Iteration: 2707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476810097694397, gen p mean: -0.13176500797271729, mean p set: 0.44825637340545654
loss_pred:0.01561672706156969, decouple_loss:0.00040775572415441275
The modified gen p mean: 0.44791585206985474, gen p mean: -0.1316407173871994, mean p set: 0.44849130511283875
The modified gen p mean: 0.44848722219467163, gen p mean: -0.13302411139011383, mean p set: 0.4490620791912079
loss_pred:0.015177811495959759, decouple_loss:0.0003335341752972454
loss_pred:0.01628824695944786, decouple_loss:0.0004660837003029883
Iteration: 2708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45028799772262573, gen p mean: -0.13260343670845032, mean p set: 0.4508633017539978
The modified gen p mean: 0.449455201625824, gen p mean: -0.1323118805885315, mean p set: 0.4500318169593811loss_pred:0.014636156149208546, decouple_loss:0.00037361940485425293
loss_pred:0.014852941036224365, decouple_loss:0.00034733416396193206
The modified gen p mean: 0.44816720485687256, gen p mean: -0.13124597072601318, mean p set: 0.44874924421310425
loss_pred:0.015220927074551582, decouple_loss:0.00043157185427844524
Iteration: 2709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461507797241211, gen p mean: -0.1317063570022583, mean p set: 0.44672608375549316
loss_pred:0.016417531296610832, decouple_loss:0.0005559844430536032
The modified gen p mean: 0.44801199436187744, gen p mean: -0.13269802927970886, mean p set: 0.4485867917537689
loss_pred:0.015796955674886703, decouple_loss:0.00041885083192028105
The modified gen p mean: 0.44725853204727173, gen p mean: -0.13139156997203827, mean p set: 0.4478370249271393
loss_pred:0.015878302976489067, decouple_loss:0.00043207863927818835
Iteration: 2710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44899803400039673, gen p mean: -0.12995946407318115, mean p set: 0.449575275182724
loss_pred:0.01552116870880127, decouple_loss:0.0004146603459957987
The modified gen p mean: 0.4481881260871887, gen p mean: -0.1372378021478653, mean p set: 0.4487628936767578
loss_pred:0.01599251478910446, decouple_loss:0.0004288080963306129
The modified gen p mean: 0.4501630663871765, gen p mean: -0.1326102316379547, mean p set: 0.4507392346858978
loss_pred:0.01491997018456459, decouple_loss:0.00033981812885031104
2023-05-02 13:50:43 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13656838238239288, mean p set: 0.4502691626548767
loss_pred:0.016885878518223763, decouple_loss:0.00042348416172899306
The modified gen p mean: 0.4495369493961334, gen p mean: -0.13071857392787933, mean p set: 0.4500633478164673
loss_pred:0.01620001718401909, decouple_loss:0.0005552246584556997
The modified gen p mean: 0.44982802867889404, gen p mean: -0.13021858036518097, mean p set: 0.45035696029663086
loss_pred:0.016309890896081924, decouple_loss:0.0005304342485032976
WV_1_PC_1_EH_0_PS_40, loss: 0.01649041473865509, avg_mse: 0.02576243132352829
current test mse: 0.025762
Iteration: 2711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482085704803467, gen p mean: -0.13013988733291626, mean p set: 0.44878700375556946
loss_pred:0.015566962771117687, decouple_loss:0.00046487609506584704
The modified gen p mean: 0.44763365387916565, gen p mean: -0.13306236267089844, mean p set: 0.44820740818977356The modified gen p mean: 0.448002427816391, gen p mean: -0.12791933119297028, mean p set: 0.4485757648944855
loss_pred:0.016049658879637718, decouple_loss:0.0003772485943045467
loss_pred:0.015217955224215984, decouple_loss:0.00044898129999637604
Iteration: 2712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464162290096283, gen p mean: -0.12523433566093445, mean p set: 0.4469884932041168
loss_pred:0.015895038843154907, decouple_loss:0.0004922234802506864
The modified gen p mean: 0.44606950879096985, gen p mean: -0.1263621300458908, mean p set: 0.4466431736946106The modified gen p mean: 0.447977751493454, gen p mean: -0.1374574899673462, mean p set: 0.4485483467578888
loss_pred:0.015786640346050262, decouple_loss:0.0003892112581524998
loss_pred:0.015913603827357292, decouple_loss:0.0004095225885976106
Iteration: 2713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482102692127228, gen p mean: -0.1319926530122757, mean p set: 0.4487842321395874
loss_pred:0.015505721792578697, decouple_loss:0.0003842042642645538
The modified gen p mean: 0.4488961398601532, gen p mean: -0.12592150270938873, mean p set: 0.44947269558906555
loss_pred:0.015572279691696167, decouple_loss:0.00035869961720891297
The modified gen p mean: 0.4477677345275879, gen p mean: -0.13049708306789398, mean p set: 0.4483422338962555
loss_pred:0.015341647900640965, decouple_loss:0.00036876631202176213
Iteration: 2714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471431076526642, gen p mean: -0.1247081607580185, mean p set: 0.4477182924747467
loss_pred:0.01593461073935032, decouple_loss:0.0004767870414070785
The modified gen p mean: 0.4489719867706299, gen p mean: -0.12885253131389618, mean p set: 0.4495477080345154
loss_pred:0.015566435642540455, decouple_loss:0.000397811847506091
The modified gen p mean: 0.44662800431251526, gen p mean: -0.12443206459283829, mean p set: 0.44720733165740967
loss_pred:0.015382741577923298, decouple_loss:0.00040209360304288566
Iteration: 2715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44604167342185974, gen p mean: -0.12353183329105377, mean p set: 0.4466167390346527
loss_pred:0.016679618507623672, decouple_loss:0.0004412385751493275
The modified gen p mean: 0.4491244852542877, gen p mean: -0.12298470735549927, mean p set: 0.4497016966342926
loss_pred:0.015273130498826504, decouple_loss:0.0003475569828879088
The modified gen p mean: 0.4475090801715851, gen p mean: -0.12227688729763031, mean p set: 0.44808417558670044
loss_pred:0.015617532655596733, decouple_loss:0.00042231869883835316
Iteration: 2716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840744137763977, gen p mean: -0.12562815845012665, mean p set: 0.44898083806037903
loss_pred:0.015589575283229351, decouple_loss:0.00037080576294101775
The modified gen p mean: 0.44660425186157227, gen p mean: -0.12740086019039154, mean p set: 0.4471806287765503
loss_pred:0.01569966785609722, decouple_loss:0.0003458969295024872
The modified gen p mean: 0.447382390499115, gen p mean: -0.12463157624006271, mean p set: 0.4479617476463318
loss_pred:0.015217818319797516, decouple_loss:0.0004408150853123516
Iteration: 2717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478706419467926, gen p mean: -0.12891706824302673, mean p set: 0.4484488368034363
loss_pred:0.015302266925573349, decouple_loss:0.00040782621363177896
The modified gen p mean: 0.4482561945915222, gen p mean: -0.12682749330997467, mean p set: 0.4488303065299988
The modified gen p mean: 0.4487936794757843, gen p mean: -0.12086334079504013, mean p set: 0.44937095046043396
loss_pred:0.015205229632556438, decouple_loss:0.00027524243341758847
loss_pred:0.01555288303643465, decouple_loss:0.00042347426642663777
Iteration: 2718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475573003292084, gen p mean: -0.12523214519023895, mean p set: 0.4481366276741028
loss_pred:0.015505405142903328, decouple_loss:0.000500978552736342
The modified gen p mean: 0.44666409492492676, gen p mean: -0.12912511825561523, mean p set: 0.44724079966545105
The modified gen p mean: 0.44741907715797424, gen p mean: -0.1251000463962555, mean p set: 0.4479931592941284
loss_pred:0.016170749440789223, decouple_loss:0.00043087234371341765
loss_pred:0.01545796263962984, decouple_loss:0.0004963871324434876
Iteration: 2719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475260376930237, gen p mean: -0.1280977427959442, mean p set: 0.4481014907360077
loss_pred:0.015719641000032425, decouple_loss:0.0004324699693825096
The modified gen p mean: 0.4479297995567322, gen p mean: -0.12821979820728302, mean p set: 0.4485064744949341
The modified gen p mean: 0.44713103771209717, gen p mean: -0.12678152322769165, mean p set: 0.44770923256874084
loss_pred:0.015135315246880054, decouple_loss:0.0003633396700024605
loss_pred:0.01596042327582836, decouple_loss:0.0004103644168935716
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
NaN value num: 0
Iteration: 2720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44600099325180054, gen p mean: -0.12838774919509888, mean p set: 0.446577250957489
loss_pred:0.015741676092147827, decouple_loss:0.0004973479663021863
The modified gen p mean: 0.446686714887619, gen p mean: -0.13000179827213287, mean p set: 0.44726279377937317
The modified gen p mean: 0.4467708468437195, gen p mean: -0.12813477218151093, mean p set: 0.44734886288642883
loss_pred:0.017009112983942032, decouple_loss:0.0005058867973275483
loss_pred:0.015470219776034355, decouple_loss:0.0005298864562064409
2023-05-02 13:53:39 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13790784776210785, mean p set: 0.4502691626548767
loss_pred:0.01686510071158409, decouple_loss:0.0004416679439600557
The modified gen p mean: 0.4495350122451782, gen p mean: -0.13143955171108246, mean p set: 0.4500633478164673
loss_pred:0.016190610826015472, decouple_loss:0.00045354352914728224
The modified gen p mean: 0.4498264789581299, gen p mean: -0.13075263798236847, mean p set: 0.45035696029663086
loss_pred:0.016307415440678596, decouple_loss:0.0004372000985313207
WV_1_PC_1_EH_0_PS_40, loss: 0.01647658459842205, avg_mse: 0.02574985660612583
current test mse: 0.02575
Iteration: 2721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747355580329895, gen p mean: -0.13125810027122498, mean p set: 0.4480472505092621
loss_pred:0.01560639776289463, decouple_loss:0.0005238322191871703
The modified gen p mean: 0.4473140835762024, gen p mean: -0.1291646957397461, mean p set: 0.4478892683982849
loss_pred:0.015416017733514309, decouple_loss:0.0005514597287401557
The modified gen p mean: 0.4466685652732849, gen p mean: -0.13314604759216309, mean p set: 0.44724392890930176
loss_pred:0.01595512218773365, decouple_loss:0.00046777058742009103
Iteration: 2722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699880480766296, gen p mean: -0.13336992263793945, mean p set: 0.4475730061531067
loss_pred:0.015598407946527004, decouple_loss:0.0004880454216618091
The modified gen p mean: 0.4464336335659027, gen p mean: -0.13593174517154694, mean p set: 0.44700849056243896The modified gen p mean: 0.4464690089225769, gen p mean: -0.13507845997810364, mean p set: 0.44704464077949524
loss_pred:0.016129033640027046, decouple_loss:0.0003418071719352156loss_pred:0.015255007892847061, decouple_loss:0.00029164785519242287
Iteration: 2723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445707768201828, gen p mean: -0.13114912807941437, mean p set: 0.44628363847732544
loss_pred:0.01567690260708332, decouple_loss:0.0003766646550502628
The modified gen p mean: 0.4479556977748871, gen p mean: -0.13225050270557404, mean p set: 0.4485313296318054The modified gen p mean: 0.4468141198158264, gen p mean: -0.13369274139404297, mean p set: 0.4473875164985657
loss_pred:0.015374129638075829, decouple_loss:0.00042877503437921405
loss_pred:0.01676851138472557, decouple_loss:0.0003747815208043903
Iteration: 2724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464106261730194, gen p mean: -0.14052878320217133, mean p set: 0.4469883143901825
loss_pred:0.015583593398332596, decouple_loss:0.0005578220589086413
The modified gen p mean: 0.447469562292099, gen p mean: -0.136500746011734, mean p set: 0.4480447769165039
loss_pred:0.015483856201171875, decouple_loss:0.0005294482107274234
The modified gen p mean: 0.44820061326026917, gen p mean: -0.13879315555095673, mean p set: 0.4487774670124054
loss_pred:0.01483385544270277, decouple_loss:0.0004914519377052784
Iteration: 2725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853806495666504, gen p mean: -0.14145717024803162, mean p set: 0.4491124749183655
loss_pred:0.015434478409588337, decouple_loss:0.0003931542451027781
The modified gen p mean: 0.44641977548599243, gen p mean: -0.1368580162525177, mean p set: 0.4469945430755615
loss_pred:0.01593698374927044, decouple_loss:0.0004497969930525869
The modified gen p mean: 0.449377179145813, gen p mean: -0.13817693293094635, mean p set: 0.449957937002182
loss_pred:0.014666450209915638, decouple_loss:0.0004308069765102118
Iteration: 2726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732242822647095, gen p mean: -0.13983479142189026, mean p set: 0.44789931178092957
loss_pred:0.015252796933054924, decouple_loss:0.0004826821095775813
The modified gen p mean: 0.44747194647789, gen p mean: -0.13853073120117188, mean p set: 0.4480498135089874
loss_pred:0.015975402668118477, decouple_loss:0.00047939069918356836
The modified gen p mean: 0.4500088691711426, gen p mean: -0.13879361748695374, mean p set: 0.45058512687683105
loss_pred:0.015306728892028332, decouple_loss:0.0004437835013959557
Iteration: 2727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470418095588684, gen p mean: -0.13438011705875397, mean p set: 0.4476177394390106
The modified gen p mean: 0.44817787408828735, gen p mean: -0.13177627325057983, mean p set: 0.44875475764274597
loss_pred:0.015581320971250534, decouple_loss:0.000610348186455667
loss_pred:0.01520710252225399, decouple_loss:0.0005362340598367155
The modified gen p mean: 0.4480222165584564, gen p mean: -0.1427006870508194, mean p set: 0.4485994875431061
loss_pred:0.015850163996219635, decouple_loss:0.0006097854347899556
Iteration: 2728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757378101348877, gen p mean: -0.12477730214595795, mean p set: 0.4481465220451355
loss_pred:0.015107337385416031, decouple_loss:0.0006010401993989944
The modified gen p mean: 0.4462045431137085, gen p mean: -0.1269415318965912, mean p set: 0.4467800557613373
The modified gen p mean: 0.44562050700187683, gen p mean: -0.12426748126745224, mean p set: 0.4461957514286041
loss_pred:0.016556303948163986, decouple_loss:0.00043269325396977365
loss_pred:0.01526862196624279, decouple_loss:0.0005387939745560288
Iteration: 2729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44693055748939514, gen p mean: -0.12389371544122696, mean p set: 0.4475059509277344
loss_pred:0.016189811751246452, decouple_loss:0.0004473616136237979
The modified gen p mean: 0.44726821780204773, gen p mean: -0.11923998594284058, mean p set: 0.4478435218334198
loss_pred:0.015821091830730438, decouple_loss:0.00040993111906573176
The modified gen p mean: 0.44722780585289, gen p mean: -0.12199204415082932, mean p set: 0.44780290126800537
loss_pred:0.015798218548297882, decouple_loss:0.0003584318037610501
Iteration: 2730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476999044418335, gen p mean: -0.1201138123869896, mean p set: 0.44827520847320557
The modified gen p mean: 0.4484875798225403, gen p mean: -0.1274109035730362, mean p set: 0.449065238237381
loss_pred:0.015850679948925972, decouple_loss:0.0006606604438275099
loss_pred:0.01650289259850979, decouple_loss:0.0007158874068409204
The modified gen p mean: 0.4476599097251892, gen p mean: -0.12625160813331604, mean p set: 0.4482364058494568
loss_pred:0.016258353367447853, decouple_loss:0.0006356517551466823
2023-05-02 13:55:45 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13435286283493042, mean p set: 0.4502691626548767
loss_pred:0.016871033236384392, decouple_loss:0.0004934185417369008
The modified gen p mean: 0.4495360553264618, gen p mean: -0.1277400404214859, mean p set: 0.4500633478164673
loss_pred:0.016232267022132874, decouple_loss:0.0005509296897798777
The modified gen p mean: 0.44982606172561646, gen p mean: -0.1270817220211029, mean p set: 0.45035696029663086
loss_pred:0.01643204316496849, decouple_loss:0.0005953471991233528
WV_1_PC_1_EH_0_PS_40, loss: 0.016539109870791435, avg_mse: 0.02585715427994728
current test mse: 0.025857
Iteration: 2731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469917118549347, gen p mean: -0.12667693197727203, mean p set: 0.44756776094436646
loss_pred:0.015716351568698883, decouple_loss:0.0006337246741168201
The modified gen p mean: 0.4483332931995392, gen p mean: -0.12943615019321442, mean p set: 0.44890812039375305The modified gen p mean: 0.44910770654678345, gen p mean: -0.12913787364959717, mean p set: 0.4496842920780182
loss_pred:0.014791342429816723, decouple_loss:0.0004350349772721529loss_pred:0.014829693362116814, decouple_loss:0.00043467493378557265
Iteration: 2732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481790363788605, gen p mean: -0.12689362466335297, mean p set: 0.44875606894493103
loss_pred:0.015031537041068077, decouple_loss:0.00038394902367144823
The modified gen p mean: 0.446828156709671, gen p mean: -0.13249489665031433, mean p set: 0.44740378856658936The modified gen p mean: 0.4477705955505371, gen p mean: -0.12910114228725433, mean p set: 0.44834578037261963
loss_pred:0.015696821734309196, decouple_loss:0.00043351692147552967loss_pred:0.01522302720695734, decouple_loss:0.00040115960291586816
Iteration: 2733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475266635417938, gen p mean: -0.13525687158107758, mean p set: 0.44810381531715393
loss_pred:0.01574617065489292, decouple_loss:0.00042417028453201056
The modified gen p mean: 0.44640329480171204, gen p mean: -0.1331736147403717, mean p set: 0.44698062539100647
loss_pred:0.016451863572001457, decouple_loss:0.0005120615242049098
The modified gen p mean: 0.44708824157714844, gen p mean: -0.13099676370620728, mean p set: 0.4476620852947235
loss_pred:0.015618782490491867, decouple_loss:0.00034522268106229603
Iteration: 2734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463071823120117, gen p mean: -0.13336747884750366, mean p set: 0.44688549637794495
loss_pred:0.016982529312372208, decouple_loss:0.0003853817470371723
The modified gen p mean: 0.44787079095840454, gen p mean: -0.1353638768196106, mean p set: 0.44844627380371094
loss_pred:0.015332130715250969, decouple_loss:0.0005651339888572693
The modified gen p mean: 0.4467736780643463, gen p mean: -0.13243913650512695, mean p set: 0.4473509192466736
loss_pred:0.016133558005094528, decouple_loss:0.0003937945584766567
Iteration: 2735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716429710388184, gen p mean: -0.13765999674797058, mean p set: 0.4477372169494629
loss_pred:0.01595747470855713, decouple_loss:0.000425529113272205
The modified gen p mean: 0.4487551748752594, gen p mean: -0.14224275946617126, mean p set: 0.4493309259414673
loss_pred:0.016054926440119743, decouple_loss:0.0005331144784577191
The modified gen p mean: 0.4475955665111542, gen p mean: -0.13640961050987244, mean p set: 0.44817039370536804
loss_pred:0.014970417134463787, decouple_loss:0.000655114883556962
Iteration: 2736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467930793762207, gen p mean: -0.13419337570667267, mean p set: 0.44736701250076294
loss_pred:0.016277173534035683, decouple_loss:0.00045700574992224574
The modified gen p mean: 0.4490777850151062, gen p mean: -0.13813674449920654, mean p set: 0.4496566355228424
The modified gen p mean: 0.44717398285865784, gen p mean: -0.1412602663040161, mean p set: 0.447747141122818
loss_pred:0.015646154060959816, decouple_loss:0.0003712496254593134
loss_pred:0.015749357640743256, decouple_loss:0.00039932160871103406
Iteration: 2737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473250210285187, gen p mean: -0.13450784981250763, mean p set: 0.4478999078273773
loss_pred:0.0164074394851923, decouple_loss:0.0005299939657561481
The modified gen p mean: 0.44847372174263, gen p mean: -0.13058720529079437, mean p set: 0.44905006885528564
loss_pred:0.01536340918391943, decouple_loss:0.0004816967120859772
The modified gen p mean: 0.4466274380683899, gen p mean: -0.13335436582565308, mean p set: 0.44720491766929626
loss_pred:0.016410019248723984, decouple_loss:0.0005019454983994365
Iteration: 2738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465147852897644, gen p mean: -0.1343298703432083, mean p set: 0.4470905661582947
loss_pred:0.01579778641462326, decouple_loss:0.0004542678943835199
The modified gen p mean: 0.448047935962677, gen p mean: -0.13249143958091736, mean p set: 0.4486234486103058
The modified gen p mean: 0.4479133188724518, gen p mean: -0.1325073093175888, mean p set: 0.44848722219467163
loss_pred:0.015466825105249882, decouple_loss:0.00032342338818125427
loss_pred:0.015027393586933613, decouple_loss:0.0003025151963811368
Iteration: 2739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654667377471924, gen p mean: -0.13401895761489868, mean p set: 0.44712138175964355
The modified gen p mean: 0.4483143389225006, gen p mean: -0.1384359747171402, mean p set: 0.4488883912563324
loss_pred:0.016326798126101494, decouple_loss:0.000499748217407614
loss_pred:0.016161631792783737, decouple_loss:0.00047595493379049003
The modified gen p mean: 0.4469858407974243, gen p mean: -0.1405283361673355, mean p set: 0.44756510853767395
loss_pred:0.015123826451599598, decouple_loss:0.000467915553599596
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 2740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471045136451721, gen p mean: -0.14004889130592346, mean p set: 0.4476828873157501
The modified gen p mean: 0.4479445219039917, gen p mean: -0.14059366285800934, mean p set: 0.44852009415626526
loss_pred:0.014274698682129383, decouple_loss:0.0004431472916621715
loss_pred:0.014431449584662914, decouple_loss:0.00041248969500884414
The modified gen p mean: 0.4487970173358917, gen p mean: -0.1357244849205017, mean p set: 0.44937047362327576
loss_pred:0.014983395114541054, decouple_loss:0.0004971269518136978
2023-05-02 13:58:30 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.14094118773937225, mean p set: 0.4502691626548767
loss_pred:0.016822239384055138, decouple_loss:0.00040240498492494226
The modified gen p mean: 0.44953563809394836, gen p mean: -0.13417558372020721, mean p set: 0.4500633478164673
loss_pred:0.01621631719172001, decouple_loss:0.00047994236228987575
The modified gen p mean: 0.44983047246932983, gen p mean: -0.133851557970047, mean p set: 0.45035696029663086
loss_pred:0.01633930765092373, decouple_loss:0.00043322509736754
WV_1_PC_1_EH_0_PS_40, loss: 0.01648121327161789, avg_mse: 0.025796828791499138
current test mse: 0.025797
Iteration: 2741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760754704475403, gen p mean: -0.1339874267578125, mean p set: 0.4481825828552246
loss_pred:0.014085279777646065, decouple_loss:0.0003412655205465853
The modified gen p mean: 0.4461873769760132, gen p mean: -0.13344749808311462, mean p set: 0.44676437973976135The modified gen p mean: 0.4485487937927246, gen p mean: -0.12884238362312317, mean p set: 0.4491216838359833
loss_pred:0.01434908527880907, decouple_loss:0.0003816968819592148
loss_pred:0.014234906062483788, decouple_loss:0.00048038148088380694
Iteration: 2742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753167033195496, gen p mean: -0.1331968456506729, mean p set: 0.4481063485145569
loss_pred:0.014909448102116585, decouple_loss:0.0005996906547807157
The modified gen p mean: 0.44718989729881287, gen p mean: -0.13512831926345825, mean p set: 0.4477671980857849The modified gen p mean: 0.44734036922454834, gen p mean: -0.1330382078886032, mean p set: 0.44791606068611145
loss_pred:0.014604123309254646, decouple_loss:0.0003968639357481152loss_pred:0.014758178032934666, decouple_loss:0.00047478332999162376
Iteration: 2743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678109884262085, gen p mean: -0.13052242994308472, mean p set: 0.4473542869091034
loss_pred:0.014374286867678165, decouple_loss:0.00034142538788728416
The modified gen p mean: 0.4466952383518219, gen p mean: -0.13441906869411469, mean p set: 0.44727250933647156
loss_pred:0.014454472810029984, decouple_loss:0.00046528171515092254
The modified gen p mean: 0.44760599732398987, gen p mean: -0.1347981095314026, mean p set: 0.4481835961341858
loss_pred:0.014483293518424034, decouple_loss:0.0003908522194251418
Iteration: 2744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742485880851746, gen p mean: -0.13357439637184143, mean p set: 0.44800058007240295
loss_pred:0.013790063560009003, decouple_loss:0.00037680656532756984
The modified gen p mean: 0.44686615467071533, gen p mean: -0.13760605454444885, mean p set: 0.4474402070045471
loss_pred:0.014816178008913994, decouple_loss:0.0005926355952396989
The modified gen p mean: 0.4470885694026947, gen p mean: -0.1379542201757431, mean p set: 0.4476650059223175
loss_pred:0.014759411104023457, decouple_loss:0.0004206440644338727
Iteration: 2745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485567808151245, gen p mean: -0.12879270315170288, mean p set: 0.44913291931152344
loss_pred:0.014663155190646648, decouple_loss:0.0004303754831198603
The modified gen p mean: 0.44668442010879517, gen p mean: -0.13227294385433197, mean p set: 0.4472596049308777
loss_pred:0.014445574022829533, decouple_loss:0.0005139739369042218
The modified gen p mean: 0.4455340504646301, gen p mean: -0.13288632035255432, mean p set: 0.4461096227169037
loss_pred:0.014248632825911045, decouple_loss:0.0005193357937969267
Iteration: 2746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447209894657135, gen p mean: -0.13630132377147675, mean p set: 0.44778600335121155
loss_pred:0.014442122541368008, decouple_loss:0.000687199819367379
The modified gen p mean: 0.4468117356300354, gen p mean: -0.13912422955036163, mean p set: 0.4473881721496582
loss_pred:0.014384149573743343, decouple_loss:0.0006273789913393557
The modified gen p mean: 0.44733068346977234, gen p mean: -0.12954500317573547, mean p set: 0.4479072690010071
loss_pred:0.014543967321515083, decouple_loss:0.0004135359777137637
Iteration: 2747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471409022808075, gen p mean: -0.13417069613933563, mean p set: 0.4477144777774811
loss_pred:0.01426739152520895, decouple_loss:0.0003319574461784214
The modified gen p mean: 0.44829297065734863, gen p mean: -0.1376851499080658, mean p set: 0.44886934757232666
The modified gen p mean: 0.4479171633720398, gen p mean: -0.12750576436519623, mean p set: 0.4484962224960327
loss_pred:0.014083572663366795, decouple_loss:0.000461701798485592
loss_pred:0.01418716087937355, decouple_loss:0.000404205871745944
Iteration: 2748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486689567565918, gen p mean: -0.13398046791553497, mean p set: 0.44924822449684143
loss_pred:0.013921836391091347, decouple_loss:0.0004682141006924212
The modified gen p mean: 0.44836267828941345, gen p mean: -0.1388191282749176, mean p set: 0.448940247297287
The modified gen p mean: 0.44739407300949097, gen p mean: -0.13679634034633636, mean p set: 0.4479711353778839
loss_pred:0.014363572001457214, decouple_loss:0.00035950294113717973
loss_pred:0.014555010944604874, decouple_loss:0.0005366737605072558
Iteration: 2749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802168011665344, gen p mean: -0.13135702908039093, mean p set: 0.44860079884529114
loss_pred:0.014217018149793148, decouple_loss:0.00038252928061410785
The modified gen p mean: 0.44588014483451843, gen p mean: -0.13447809219360352, mean p set: 0.44645851850509644
loss_pred:0.014067893847823143, decouple_loss:0.0003971793921664357
The modified gen p mean: 0.4485911726951599, gen p mean: -0.13178323209285736, mean p set: 0.44917070865631104
loss_pred:0.014434067532420158, decouple_loss:0.000376334588509053
Iteration: 2750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463835656642914, gen p mean: -0.13620130717754364, mean p set: 0.44695839285850525
loss_pred:0.014212114736437798, decouple_loss:0.000351126043824479
The modified gen p mean: 0.44807615876197815, gen p mean: -0.13244225084781647, mean p set: 0.4486541748046875
The modified gen p mean: 0.4472287595272064, gen p mean: -0.13792620599269867, mean p set: 0.44780340790748596
loss_pred:0.01448766328394413, decouple_loss:0.0004239017143845558
loss_pred:0.014474970288574696, decouple_loss:0.0003783894644584507
2023-05-02 14:00:37 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13970117270946503, mean p set: 0.4502691626548767
loss_pred:0.01681693270802498, decouple_loss:0.0003685697156470269
The modified gen p mean: 0.44953563809394836, gen p mean: -0.13289359211921692, mean p set: 0.4500633478164673
loss_pred:0.016204552724957466, decouple_loss:0.00041581832920201123
The modified gen p mean: 0.44982680678367615, gen p mean: -0.13297374546527863, mean p set: 0.45035696029663086
loss_pred:0.016435274854302406, decouple_loss:0.00037512765266001225
WV_1_PC_1_EH_0_PS_40, loss: 0.016504913568496704, avg_mse: 0.025802262127399445
current test mse: 0.025802
Iteration: 2751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745662808418274, gen p mean: -0.13250958919525146, mean p set: 0.4480327069759369
loss_pred:0.013887401670217514, decouple_loss:0.00045059563126415014
The modified gen p mean: 0.4478033185005188, gen p mean: -0.1325448751449585, mean p set: 0.44837847352027893
loss_pred:0.01423126645386219, decouple_loss:0.0004099243087694049
The modified gen p mean: 0.4480274021625519, gen p mean: -0.1319684386253357, mean p set: 0.44860121607780457
loss_pred:0.013679509051144123, decouple_loss:0.0004206130397506058
Iteration: 2752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476238489151001, gen p mean: -0.1300915777683258, mean p set: 0.4481982886791229
loss_pred:0.01406609546393156, decouple_loss:0.0003541679761838168
The modified gen p mean: 0.44756051898002625, gen p mean: -0.1345469057559967, mean p set: 0.44813501834869385The modified gen p mean: 0.44764217734336853, gen p mean: -0.13072849810123444, mean p set: 0.44821637868881226
loss_pred:0.0144448671489954, decouple_loss:0.00033739564241841435loss_pred:0.014589555561542511, decouple_loss:0.00035218987613916397
Iteration: 2753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692328572273254, gen p mean: -0.13184772431850433, mean p set: 0.4475003480911255
loss_pred:0.014304518699645996, decouple_loss:0.0003162509819958359
The modified gen p mean: 0.44751429557800293, gen p mean: -0.1259094923734665, mean p set: 0.4480895698070526
loss_pred:0.013954517431557178, decouple_loss:0.00041211434290744364
The modified gen p mean: 0.4476357698440552, gen p mean: -0.12902510166168213, mean p set: 0.4482133686542511
loss_pred:0.014438562095165253, decouple_loss:0.0003643076925072819
Iteration: 2754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840189814567566, gen p mean: -0.12894538044929504, mean p set: 0.44897761940956116
loss_pred:0.01406055223196745, decouple_loss:0.00041926137055270374
The modified gen p mean: 0.4462834596633911, gen p mean: -0.13060922920703888, mean p set: 0.4468632936477661
loss_pred:0.014183326624333858, decouple_loss:0.00032128760358318686
The modified gen p mean: 0.44694116711616516, gen p mean: -0.13098804652690887, mean p set: 0.4475173056125641
loss_pred:0.014441803097724915, decouple_loss:0.0003429343632888049
Iteration: 2755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473237693309784, gen p mean: -0.13049526512622833, mean p set: 0.44789940118789673
loss_pred:0.014724193140864372, decouple_loss:0.00046159999328665435
The modified gen p mean: 0.4480453133583069, gen p mean: -0.12827949225902557, mean p set: 0.44862261414527893
loss_pred:0.013933004811406136, decouple_loss:0.0003754702629521489
The modified gen p mean: 0.4473797082901001, gen p mean: -0.1308753937482834, mean p set: 0.4479547441005707
loss_pred:0.013905325904488564, decouple_loss:0.00033728015841916203
Iteration: 2756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44645220041275024, gen p mean: -0.13263340294361115, mean p set: 0.4470282196998596
The modified gen p mean: 0.44768640398979187, gen p mean: -0.12419776618480682, mean p set: 0.4482652246952057
loss_pred:0.014154687523841858, decouple_loss:0.00031693591154180467
loss_pred:0.014050549827516079, decouple_loss:0.00029289579833857715
The modified gen p mean: 0.44759926199913025, gen p mean: -0.13267861306667328, mean p set: 0.44817450642585754
loss_pred:0.014404335990548134, decouple_loss:0.0004190746694803238
Iteration: 2757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485763907432556, gen p mean: -0.12942199409008026, mean p set: 0.4491502642631531
loss_pred:0.01446370966732502, decouple_loss:0.00031638320069760084
The modified gen p mean: 0.4478122591972351, gen p mean: -0.12778453528881073, mean p set: 0.44838836789131165
loss_pred:0.013669494539499283, decouple_loss:0.0004244443553034216
The modified gen p mean: 0.44718894362449646, gen p mean: -0.13290780782699585, mean p set: 0.4477669298648834
loss_pred:0.014419781975448132, decouple_loss:0.0003766839508898556
Iteration: 2758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478033185005188, gen p mean: -0.12644878029823303, mean p set: 0.4483788311481476
loss_pred:0.014536353759467602, decouple_loss:0.00037255018833093345
The modified gen p mean: 0.44675928354263306, gen p mean: -0.13162259757518768, mean p set: 0.4473342299461365
The modified gen p mean: 0.44773027300834656, gen p mean: -0.12684790790081024, mean p set: 0.4483039677143097
loss_pred:0.014335373416543007, decouple_loss:0.00040539304609410465
loss_pred:0.013976380228996277, decouple_loss:0.00035656566615216434
Iteration: 2759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473423957824707, gen p mean: -0.12889638543128967, mean p set: 0.4479212760925293
loss_pred:0.01396699994802475, decouple_loss:0.00037045340286567807
The modified gen p mean: 0.44684678316116333, gen p mean: -0.1294965147972107, mean p set: 0.4474206268787384
loss_pred:0.0142232496291399, decouple_loss:0.0003731540055014193
The modified gen p mean: 0.4477243423461914, gen p mean: -0.12766578793525696, mean p set: 0.4483005702495575
loss_pred:0.014829683117568493, decouple_loss:0.0003454748366493732
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
NaN value num: 0
Iteration: 2760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502275586128235, gen p mean: -0.12264804542064667, mean p set: 0.45080307126045227
loss_pred:0.015152998268604279, decouple_loss:0.0006487850332632661
The modified gen p mean: 0.44902709126472473, gen p mean: -0.12155190855264664, mean p set: 0.44960349798202515
The modified gen p mean: 0.44981202483177185, gen p mean: -0.12360775470733643, mean p set: 0.4503856897354126
loss_pred:0.014520223252475262, decouple_loss:0.00032389399711973965
loss_pred:0.015164653770625591, decouple_loss:0.00041564239654690027
2023-05-02 14:03:27 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13290536403656006, mean p set: 0.4502691626548767
loss_pred:0.01681642048060894, decouple_loss:0.0005713262944482267
The modified gen p mean: 0.4495358467102051, gen p mean: -0.1263597458600998, mean p set: 0.4500633478164673
loss_pred:0.016106367111206055, decouple_loss:0.0004418697499204427
The modified gen p mean: 0.44983020424842834, gen p mean: -0.12668924033641815, mean p set: 0.45035696029663086
loss_pred:0.016403259709477425, decouple_loss:0.00039094945532269776
WV_1_PC_1_EH_0_PS_40, loss: 0.01646541804075241, avg_mse: 0.025736073032021523
current test mse: 0.025736
Iteration: 2761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45220911502838135, gen p mean: -0.11546412855386734, mean p set: 0.45278817415237427
loss_pred:0.015727384015917778, decouple_loss:0.00045453477650880814
The modified gen p mean: 0.45080721378326416, gen p mean: -0.11560650914907455, mean p set: 0.45138245820999146The modified gen p mean: 0.4515303075313568, gen p mean: -0.12224796414375305, mean p set: 0.45210859179496765
loss_pred:0.015060490928590298, decouple_loss:0.00048114912351593375
loss_pred:0.014804719015955925, decouple_loss:0.00036371886380948126
Iteration: 2762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097994804382324, gen p mean: -0.10875792801380157, mean p set: 0.4515576958656311
The modified gen p mean: 0.4482898414134979, gen p mean: -0.11737937480211258, mean p set: 0.4488649070262909
loss_pred:0.014676613733172417, decouple_loss:0.00030812073964625597
loss_pred:0.014252202585339546, decouple_loss:0.0004609867464751005
The modified gen p mean: 0.4494646489620209, gen p mean: -0.11466366797685623, mean p set: 0.45004045963287354
loss_pred:0.014534393325448036, decouple_loss:0.0004040739149786532
Iteration: 2763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492393136024475, gen p mean: -0.11743232607841492, mean p set: 0.44981685280799866
loss_pred:0.014612333849072456, decouple_loss:0.0005418260116130114
The modified gen p mean: 0.4502457082271576, gen p mean: -0.12176688760519028, mean p set: 0.45082327723503113
loss_pred:0.01514149084687233, decouple_loss:0.00038618629332631826
The modified gen p mean: 0.4512021243572235, gen p mean: -0.11585880815982819, mean p set: 0.4517787992954254
loss_pred:0.014308355748653412, decouple_loss:0.00048272107960656285
Iteration: 2764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508848190307617, gen p mean: -0.11267111450433731, mean p set: 0.45146021246910095
The modified gen p mean: 0.4517940878868103, gen p mean: -0.10713853687047958, mean p set: 0.45236828923225403
loss_pred:0.01473522000014782, decouple_loss:0.00037789656198583543
loss_pred:0.015549455769360065, decouple_loss:0.00039377622306346893
The modified gen p mean: 0.4507066607475281, gen p mean: -0.10565996170043945, mean p set: 0.4512827396392822
loss_pred:0.014653044752776623, decouple_loss:0.0004092586459591985
Iteration: 2765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45176106691360474, gen p mean: -0.1135016679763794, mean p set: 0.45234063267707825
loss_pred:0.015483045019209385, decouple_loss:0.000413333997130394
The modified gen p mean: 0.450435608625412, gen p mean: -0.1142011359333992, mean p set: 0.4510097801685333
loss_pred:0.014310040511190891, decouple_loss:0.0004763661709148437
The modified gen p mean: 0.45233017206192017, gen p mean: -0.11755631119012833, mean p set: 0.452907919883728
loss_pred:0.015008089132606983, decouple_loss:0.0004418354947119951
Iteration: 2766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45120689272880554, gen p mean: -0.11309366673231125, mean p set: 0.4517843425273895
The modified gen p mean: 0.4493279457092285, gen p mean: -0.11794755607843399, mean p set: 0.44990551471710205
loss_pred:0.016005484387278557, decouple_loss:0.00038990084431134164
loss_pred:0.014122966676950455, decouple_loss:0.00035050095175392926
The modified gen p mean: 0.4510461688041687, gen p mean: -0.11516569554805756, mean p set: 0.4516221284866333
loss_pred:0.0142513457685709, decouple_loss:0.0005032459157519042
Iteration: 2767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450012743473053, gen p mean: -0.12338947504758835, mean p set: 0.4505898058414459
loss_pred:0.01520268153399229, decouple_loss:0.00044771592365577817
The modified gen p mean: 0.4513479471206665, gen p mean: -0.11973077058792114, mean p set: 0.4519265294075012
The modified gen p mean: 0.45068830251693726, gen p mean: -0.118172287940979, mean p set: 0.45126447081565857
loss_pred:0.015378900803625584, decouple_loss:0.0005006087012588978
loss_pred:0.014387518167495728, decouple_loss:0.0003826464817393571
Iteration: 2768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049917697906494, gen p mean: -0.12061858177185059, mean p set: 0.4510754346847534
loss_pred:0.014228581450879574, decouple_loss:0.0004669738409575075
The modified gen p mean: 0.4533136487007141, gen p mean: -0.11877203732728958, mean p set: 0.45388877391815186
The modified gen p mean: 0.4511072337627411, gen p mean: -0.11370959132909775, mean p set: 0.4516826570034027
loss_pred:0.015034623444080353, decouple_loss:0.0005710209370590746
loss_pred:0.015023747459053993, decouple_loss:0.00041603943100199103
Iteration: 2769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45191794633865356, gen p mean: -0.11538807302713394, mean p set: 0.45249274373054504
loss_pred:0.01564704440534115, decouple_loss:0.000521430280059576
The modified gen p mean: 0.45235517621040344, gen p mean: -0.11176136136054993, mean p set: 0.45293283462524414
The modified gen p mean: 0.45186999440193176, gen p mean: -0.11329793930053711, mean p set: 0.4524483382701874
loss_pred:0.014898587018251419, decouple_loss:0.0005030272295698524
loss_pred:0.015192539431154728, decouple_loss:0.0005510932533070445
Iteration: 2770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452985018491745, gen p mean: -0.11153221130371094, mean p set: 0.45355916023254395
loss_pred:0.014863367192447186, decouple_loss:0.0004482187214307487
The modified gen p mean: 0.44972866773605347, gen p mean: -0.11250206083059311, mean p set: 0.4503021836280823
The modified gen p mean: 0.4513019323348999, gen p mean: -0.11816642433404922, mean p set: 0.45187628269195557
loss_pred:0.014518653973937035, decouple_loss:0.0004699754063040018
loss_pred:0.014638068154454231, decouple_loss:0.0003856249968521297
2023-05-02 14:05:33 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12988373637199402, mean p set: 0.4502691626548767
loss_pred:0.016892708837985992, decouple_loss:0.0006264328840188682
The modified gen p mean: 0.4495335519313812, gen p mean: -0.12351934611797333, mean p set: 0.4500633478164673
loss_pred:0.016185486689209938, decouple_loss:0.0006869591306895018
The modified gen p mean: 0.4498291611671448, gen p mean: -0.12349843233823776, mean p set: 0.45035696029663086
loss_pred:0.01635814644396305, decouple_loss:0.000535637722350657
WV_1_PC_1_EH_0_PS_40, loss: 0.01650959812104702, avg_mse: 0.025765931233763695
current test mse: 0.025766
Iteration: 2771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45061928033828735, gen p mean: -0.12028736621141434, mean p set: 0.4511964023113251
loss_pred:0.014857945963740349, decouple_loss:0.0005406636046245694
The modified gen p mean: 0.45083680748939514, gen p mean: -0.11245023459196091, mean p set: 0.45141345262527466
loss_pred:0.015098845586180687, decouple_loss:0.0005372687592171133
The modified gen p mean: 0.4510630667209625, gen p mean: -0.11875762045383453, mean p set: 0.45163723826408386
loss_pred:0.015031670220196247, decouple_loss:0.0005825127009302378
Iteration: 2772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44932273030281067, gen p mean: -0.12110085785388947, mean p set: 0.4498981535434723
loss_pred:0.014312110841274261, decouple_loss:0.0005481638945639133
The modified gen p mean: 0.45150619745254517, gen p mean: -0.11708740890026093, mean p set: 0.4520801901817322The modified gen p mean: 0.45140549540519714, gen p mean: -0.12158851325511932, mean p set: 0.4519835412502289
loss_pred:0.014185160398483276, decouple_loss:0.0005317555041983724
loss_pred:0.014109158888459206, decouple_loss:0.00039832713082432747
Iteration: 2773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484158754348755, gen p mean: -0.12236884236335754, mean p set: 0.44899213314056396
loss_pred:0.014539568684995174, decouple_loss:0.00045784443500451744
The modified gen p mean: 0.4513828158378601, gen p mean: -0.11889065057039261, mean p set: 0.4519629180431366
loss_pred:0.0137508949264884, decouple_loss:0.000438340735854581
The modified gen p mean: 0.4518377482891083, gen p mean: -0.12139462679624557, mean p set: 0.4524140954017639
loss_pred:0.014485759660601616, decouple_loss:0.0006378426915034652
Iteration: 2774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502190053462982, gen p mean: -0.12883180379867554, mean p set: 0.450794517993927
loss_pred:0.014348745346069336, decouple_loss:0.0004193857894279063
The modified gen p mean: 0.4535103142261505, gen p mean: -0.11907435953617096, mean p set: 0.45408543944358826
loss_pred:0.014969314448535442, decouple_loss:0.00046477545402012765
The modified gen p mean: 0.4519045948982239, gen p mean: -0.12125251442193985, mean p set: 0.4524848163127899
loss_pred:0.014351185411214828, decouple_loss:0.0004781015741173178
Iteration: 2775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097866654396057, gen p mean: -0.12283199280500412, mean p set: 0.4515541195869446
loss_pred:0.01421202253550291, decouple_loss:0.0005053901695646346
The modified gen p mean: 0.4505975842475891, gen p mean: -0.1152370423078537, mean p set: 0.45117807388305664
loss_pred:0.01456315815448761, decouple_loss:0.0004817757580894977
The modified gen p mean: 0.4514218270778656, gen p mean: -0.11793158203363419, mean p set: 0.45199936628341675
loss_pred:0.01537416223436594, decouple_loss:0.0005526291788555682
Iteration: 2776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524706304073334, gen p mean: -0.11989735811948776, mean p set: 0.45304831862449646
loss_pred:0.015126966871321201, decouple_loss:0.0004636781523004174
The modified gen p mean: 0.4506095051765442, gen p mean: -0.11445464193820953, mean p set: 0.4511864483356476
loss_pred:0.014906453900039196, decouple_loss:0.00041465062531642616
The modified gen p mean: 0.45137614011764526, gen p mean: -0.11870449036359787, mean p set: 0.4519501030445099
loss_pred:0.014362230896949768, decouple_loss:0.00048454481293447316
Iteration: 2777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495455324649811, gen p mean: -0.12337124347686768, mean p set: 0.4501255452632904
loss_pred:0.014069541357457638, decouple_loss:0.0004912668955512345
The modified gen p mean: 0.4510555863380432, gen p mean: -0.12205559760332108, mean p set: 0.4516323506832123
The modified gen p mean: 0.45057782530784607, gen p mean: -0.12898026406764984, mean p set: 0.4511508643627167
loss_pred:0.014423930086195469, decouple_loss:0.00043227331480011344
loss_pred:0.014336134307086468, decouple_loss:0.00045813294127583504
Iteration: 2778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498217701911926, gen p mean: -0.12495853006839752, mean p set: 0.45039525628089905
loss_pred:0.014769067987799644, decouple_loss:0.0004000047338195145
The modified gen p mean: 0.45019060373306274, gen p mean: -0.12674996256828308, mean p set: 0.4507656991481781
The modified gen p mean: 0.4515286087989807, gen p mean: -0.1237313449382782, mean p set: 0.452106237411499
loss_pred:0.015619643963873386, decouple_loss:0.0005455475766211748
loss_pred:0.014562849886715412, decouple_loss:0.00039781050872989
Iteration: 2779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45060038566589355, gen p mean: -0.12974442541599274, mean p set: 0.45117560029029846
loss_pred:0.014037825167179108, decouple_loss:0.000401075289119035
The modified gen p mean: 0.4509713053703308, gen p mean: -0.12861670553684235, mean p set: 0.4515494108200073
loss_pred:0.014274374581873417, decouple_loss:0.00036074648960493505
The modified gen p mean: 0.4511531591415405, gen p mean: -0.12475106865167618, mean p set: 0.451731413602829
loss_pred:0.015782766044139862, decouple_loss:0.00043491978431120515
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
NaN value num: 0
Iteration: 2780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44621577858924866, gen p mean: -0.13438157737255096, mean p set: 0.44679519534111023
loss_pred:0.015227057971060276, decouple_loss:0.0005799502250738442
The modified gen p mean: 0.44756007194519043, gen p mean: -0.135946586728096, mean p set: 0.4481349289417267
The modified gen p mean: 0.4487316608428955, gen p mean: -0.13312199711799622, mean p set: 0.4493103623390198
loss_pred:0.015825266018509865, decouple_loss:0.0006316365906968713
loss_pred:0.015176774933934212, decouple_loss:0.0005162417073734105
2023-05-02 14:08:17 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13653351366519928, mean p set: 0.4502691626548767
loss_pred:0.01686410792171955, decouple_loss:0.0003837669501081109
The modified gen p mean: 0.44953396916389465, gen p mean: -0.1302661895751953, mean p set: 0.4500633478164673
loss_pred:0.016195183619856834, decouple_loss:0.0004314308753237128
The modified gen p mean: 0.4498302936553955, gen p mean: -0.1302279382944107, mean p set: 0.45035696029663086
loss_pred:0.016396284103393555, decouple_loss:0.0004676629323512316
WV_1_PC_1_EH_0_PS_40, loss: 0.01650657318532467, avg_mse: 0.025814959779381752
current test mse: 0.025815
Iteration: 2781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482002854347229, gen p mean: -0.13335011899471283, mean p set: 0.448774129152298
loss_pred:0.015699489042162895, decouple_loss:0.0004671415954362601
The modified gen p mean: 0.4460991322994232, gen p mean: -0.12894399464130402, mean p set: 0.446674108505249The modified gen p mean: 0.4485190212726593, gen p mean: -0.13130426406860352, mean p set: 0.44909629225730896
loss_pred:0.015168619342148304, decouple_loss:0.0004515785549301654
loss_pred:0.015953199937939644, decouple_loss:0.00045056972885504365
Iteration: 2782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474187195301056, gen p mean: -0.12999626994132996, mean p set: 0.4479977488517761
loss_pred:0.015683528035879135, decouple_loss:0.0005417402717284858
The modified gen p mean: 0.44685235619544983, gen p mean: -0.1291065663099289, mean p set: 0.4474274814128876The modified gen p mean: 0.4462184011936188, gen p mean: -0.12044114619493484, mean p set: 0.44679397344589233
loss_pred:0.014694186858832836, decouple_loss:0.000607138208579272
loss_pred:0.016028523445129395, decouple_loss:0.000550904544070363
Iteration: 2783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475744366645813, gen p mean: -0.1310698539018631, mean p set: 0.44815075397491455
loss_pred:0.015205361880362034, decouple_loss:0.00047122692922130227
The modified gen p mean: 0.4460669755935669, gen p mean: -0.1281970739364624, mean p set: 0.446643590927124
loss_pred:0.015526851639151573, decouple_loss:0.00044954573968425393
The modified gen p mean: 0.44896671175956726, gen p mean: -0.12737835943698883, mean p set: 0.44954198598861694
loss_pred:0.015511843375861645, decouple_loss:0.0005773670272901654
Iteration: 2784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459494948387146, gen p mean: -0.12384926527738571, mean p set: 0.44652286171913147
loss_pred:0.015377878211438656, decouple_loss:0.00041011942084878683
The modified gen p mean: 0.446280300617218, gen p mean: -0.12308169156312943, mean p set: 0.4468569755554199
loss_pred:0.015450828708708286, decouple_loss:0.00048539298586547375
The modified gen p mean: 0.4478006958961487, gen p mean: -0.12720534205436707, mean p set: 0.4483734667301178
loss_pred:0.015234467573463917, decouple_loss:0.00041625648736953735
Iteration: 2785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445970743894577, gen p mean: -0.11977899819612503, mean p set: 0.44654545187950134
loss_pred:0.015542606823146343, decouple_loss:0.00036470138002187014
The modified gen p mean: 0.4467793107032776, gen p mean: -0.12747643887996674, mean p set: 0.44735464453697205
loss_pred:0.014897458255290985, decouple_loss:0.00041985645657405257
The modified gen p mean: 0.4455142915248871, gen p mean: -0.12445840239524841, mean p set: 0.44608867168426514
loss_pred:0.01553301140666008, decouple_loss:0.00046846846817061305
Iteration: 2786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681522250175476, gen p mean: -0.1291649341583252, mean p set: 0.44739121198654175
loss_pred:0.015405992977321148, decouple_loss:0.0004499168135225773
The modified gen p mean: 0.4468585252761841, gen p mean: -0.1255931854248047, mean p set: 0.44743549823760986
The modified gen p mean: 0.4456334412097931, gen p mean: -0.13059866428375244, mean p set: 0.44620731472969055
loss_pred:0.015616651624441147, decouple_loss:0.000496916298288852
loss_pred:0.016040045768022537, decouple_loss:0.000538717838935554
Iteration: 2787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458431601524353, gen p mean: -0.13328447937965393, mean p set: 0.4464176893234253
The modified gen p mean: 0.44645142555236816, gen p mean: -0.135903462767601, mean p set: 0.44702741503715515
loss_pred:0.014955063350498676, decouple_loss:0.00040795275708660483
loss_pred:0.014967094175517559, decouple_loss:0.0003643374075181782
The modified gen p mean: 0.44685497879981995, gen p mean: -0.12898384034633636, mean p set: 0.44742733240127563
loss_pred:0.015240976586937904, decouple_loss:0.00045813428005203605
Iteration: 2788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702279567718506, gen p mean: -0.1336774230003357, mean p set: 0.44760003685951233
loss_pred:0.015514390543103218, decouple_loss:0.0004379804595373571
The modified gen p mean: 0.4464947581291199, gen p mean: -0.12703831493854523, mean p set: 0.4470725357532501
The modified gen p mean: 0.4457792639732361, gen p mean: -0.13177993893623352, mean p set: 0.44635435938835144
loss_pred:0.015495828352868557, decouple_loss:0.0004541084636002779
loss_pred:0.014233842492103577, decouple_loss:0.00043727265438064933
Iteration: 2789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465368092060089, gen p mean: -0.1321098655462265, mean p set: 0.44711199402809143
loss_pred:0.01565050147473812, decouple_loss:0.00046034346451051533
The modified gen p mean: 0.44562283158302307, gen p mean: -0.13079833984375, mean p set: 0.44620129466056824
The modified gen p mean: 0.44866830110549927, gen p mean: -0.13019028306007385, mean p set: 0.4492454528808594
loss_pred:0.015217120759189129, decouple_loss:0.0006090449751354754
loss_pred:0.015485367737710476, decouple_loss:0.0004916202160529792
Iteration: 2790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462672472000122, gen p mean: -0.12776273488998413, mean p set: 0.4468423128128052
loss_pred:0.01555436197668314, decouple_loss:0.00038411293644458055
The modified gen p mean: 0.44712191820144653, gen p mean: -0.129879891872406, mean p set: 0.44769448041915894
The modified gen p mean: 0.4471204876899719, gen p mean: -0.12769845128059387, mean p set: 0.4476989805698395
loss_pred:0.014961433596909046, decouple_loss:0.00046048840158618987
loss_pred:0.015092193149030209, decouple_loss:0.0004742977616842836
2023-05-02 14:10:24 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13285137712955475, mean p set: 0.4502691626548767
loss_pred:0.016913840547204018, decouple_loss:0.00043305239523760974
The modified gen p mean: 0.4495384693145752, gen p mean: -0.12653504312038422, mean p set: 0.4500633478164673
loss_pred:0.016210129484534264, decouple_loss:0.0005310664419084787
The modified gen p mean: 0.4498280882835388, gen p mean: -0.12671327590942383, mean p set: 0.45035696029663086
loss_pred:0.01642690598964691, decouple_loss:0.0003909838560502976
WV_1_PC_1_EH_0_PS_40, loss: 0.016539543867111206, avg_mse: 0.02585265412926674
current test mse: 0.025853
Iteration: 2791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463713765144348, gen p mean: -0.12815387547016144, mean p set: 0.446946382522583
loss_pred:0.01567024551331997, decouple_loss:0.00041725783376023173
The modified gen p mean: 0.4471040666103363, gen p mean: -0.12533800303936005, mean p set: 0.447676420211792
loss_pred:0.015448677353560925, decouple_loss:0.00039912742795422673
The modified gen p mean: 0.44570496678352356, gen p mean: -0.13003887236118317, mean p set: 0.44628050923347473
loss_pred:0.015283796004951, decouple_loss:0.0005156866973266006
Iteration: 2792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44944462180137634, gen p mean: -0.12486133724451065, mean p set: 0.45001867413520813
loss_pred:0.01504596695303917, decouple_loss:0.00036913875374011695
The modified gen p mean: 0.4486769437789917, gen p mean: -0.12768089771270752, mean p set: 0.44925111532211304The modified gen p mean: 0.44839081168174744, gen p mean: -0.1273617297410965, mean p set: 0.44896358251571655
loss_pred:0.01493181474506855, decouple_loss:0.00043735906365327537
loss_pred:0.01511329784989357, decouple_loss:0.00046833412488922477
Iteration: 2793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466931223869324, gen p mean: -0.12993186712265015, mean p set: 0.44727015495300293
loss_pred:0.01531444676220417, decouple_loss:0.00048091186909005046
The modified gen p mean: 0.447714626789093, gen p mean: -0.13383832573890686, mean p set: 0.4482870399951935The modified gen p mean: 0.44576266407966614, gen p mean: -0.12976285815238953, mean p set: 0.44634005427360535
loss_pred:0.015376133844256401, decouple_loss:0.0003790926712099463
loss_pred:0.015637274831533432, decouple_loss:0.0005401890957728028
Iteration: 2794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44554203748703003, gen p mean: -0.12704776227474213, mean p set: 0.44611674547195435
loss_pred:0.01534460112452507, decouple_loss:0.0004982477403245866
The modified gen p mean: 0.44640228152275085, gen p mean: -0.12797465920448303, mean p set: 0.44697561860084534
loss_pred:0.015184944495558739, decouple_loss:0.0004394613206386566
The modified gen p mean: 0.4472494423389435, gen p mean: -0.1289604902267456, mean p set: 0.4478275179862976
loss_pred:0.0148693872615695, decouple_loss:0.00037850518128834665
Iteration: 2795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477011263370514, gen p mean: -0.12967811524868011, mean p set: 0.4482783079147339
loss_pred:0.01488753966987133, decouple_loss:0.0004589696181938052
The modified gen p mean: 0.44783663749694824, gen p mean: -0.1307961344718933, mean p set: 0.44841188192367554
loss_pred:0.015017921105027199, decouple_loss:0.00043102327617816627
The modified gen p mean: 0.44680482149124146, gen p mean: -0.1307990998029709, mean p set: 0.44738173484802246
loss_pred:0.015854686498641968, decouple_loss:0.00039326256955973804
Iteration: 2796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446611613035202, gen p mean: -0.12941430509090424, mean p set: 0.4471885859966278
loss_pred:0.01520207803696394, decouple_loss:0.0004652750212699175
The modified gen p mean: 0.44672003388404846, gen p mean: -0.12615379691123962, mean p set: 0.44729360938072205
loss_pred:0.015078050084412098, decouple_loss:0.0006006720359437168
The modified gen p mean: 0.4466310441493988, gen p mean: -0.13305124640464783, mean p set: 0.4472094774246216
loss_pred:0.014460867270827293, decouple_loss:0.000411005545174703
Iteration: 2797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469870626926422, gen p mean: -0.1314653605222702, mean p set: 0.4475610554218292
loss_pred:0.015084520913660526, decouple_loss:0.0006004711030982435
The modified gen p mean: 0.4456610381603241, gen p mean: -0.12982173264026642, mean p set: 0.4462357461452484
loss_pred:0.0157418642193079, decouple_loss:0.00044084322871640325
The modified gen p mean: 0.44561028480529785, gen p mean: -0.1280612349510193, mean p set: 0.4461832046508789
loss_pred:0.015356079675257206, decouple_loss:0.000334631884470582
Iteration: 2798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44598454236984253, gen p mean: -0.1283550262451172, mean p set: 0.446562796831131
loss_pred:0.015220806002616882, decouple_loss:0.000377023738110438
The modified gen p mean: 0.4461234509944916, gen p mean: -0.13028162717819214, mean p set: 0.4466998875141144
loss_pred:0.01518599409610033, decouple_loss:0.0003651076112873852
The modified gen p mean: 0.44620633125305176, gen p mean: -0.13895271718502045, mean p set: 0.44678524136543274
loss_pred:0.015241843648254871, decouple_loss:0.0005456354701891541
Iteration: 2799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465077221393585, gen p mean: -0.13140243291854858, mean p set: 0.44708189368247986
loss_pred:0.01563073880970478, decouple_loss:0.0004620941181201488
The modified gen p mean: 0.44710859656333923, gen p mean: -0.13101235032081604, mean p set: 0.4476877748966217
loss_pred:0.015386076644062996, decouple_loss:0.0005596403498202562
The modified gen p mean: 0.44958269596099854, gen p mean: -0.13394619524478912, mean p set: 0.4501565396785736
loss_pred:0.014753881841897964, decouple_loss:0.0004123373073525727
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
NaN value num: 0
Iteration: 2800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497583508491516, gen p mean: -0.12458626180887222, mean p set: 0.45033523440361023
loss_pred:0.015413431450724602, decouple_loss:0.0005143089802004397
The modified gen p mean: 0.44838324189186096, gen p mean: -0.12611471116542816, mean p set: 0.44896015524864197
loss_pred:0.01557533536106348, decouple_loss:0.00046391808427870274
The modified gen p mean: 0.4495898187160492, gen p mean: -0.12365271896123886, mean p set: 0.45016783475875854
loss_pred:0.01470259390771389, decouple_loss:0.0004267586627975106
2023-05-02 14:13:09 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13957887887954712, mean p set: 0.4502691626548767
loss_pred:0.016858626157045364, decouple_loss:0.00040791809442453086
The modified gen p mean: 0.44953593611717224, gen p mean: -0.13341791927814484, mean p set: 0.4500633478164673
loss_pred:0.016139183193445206, decouple_loss:0.00042347743874415755
The modified gen p mean: 0.44982898235321045, gen p mean: -0.13325569033622742, mean p set: 0.45035696029663086
loss_pred:0.016330495476722717, decouple_loss:0.0004232348583173007
WV_1_PC_1_EH_0_PS_40, loss: 0.01646367833018303, avg_mse: 0.025730786845088005
current test mse: 0.025731
Iteration: 2801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499792456626892, gen p mean: -0.12405236065387726, mean p set: 0.45055249333381653
loss_pred:0.014751018024981022, decouple_loss:0.0004885024391114712
The modified gen p mean: 0.44724538922309875, gen p mean: -0.1248980239033699, mean p set: 0.44782212376594543The modified gen p mean: 0.4477410316467285, gen p mean: -0.12777775526046753, mean p set: 0.4483179748058319
loss_pred:0.015113525092601776, decouple_loss:0.00035713997203856707
loss_pred:0.015511894598603249, decouple_loss:0.0004121432430110872
Iteration: 2802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830384850502014, gen p mean: -0.12100815773010254, mean p set: 0.44887787103652954
loss_pred:0.01554225105792284, decouple_loss:0.00035615850356407464
The modified gen p mean: 0.44849613308906555, gen p mean: -0.12558162212371826, mean p set: 0.4490744471549988The modified gen p mean: 0.4482935070991516, gen p mean: -0.12157788127660751, mean p set: 0.44886893033981323
loss_pred:0.015414844267070293, decouple_loss:0.0003837473632302135loss_pred:0.016245568171143532, decouple_loss:0.0006072125397622585
Iteration: 2803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768592715263367, gen p mean: -0.11576104164123535, mean p set: 0.44826221466064453
loss_pred:0.015547809191048145, decouple_loss:0.00031304379808716476
The modified gen p mean: 0.4483239948749542, gen p mean: -0.1151297315955162, mean p set: 0.4489021897315979
loss_pred:0.015655286610126495, decouple_loss:0.00048656537546776235
The modified gen p mean: 0.44841650128364563, gen p mean: -0.12232585996389389, mean p set: 0.44899022579193115
loss_pred:0.015492774546146393, decouple_loss:0.00037505937507376075
Iteration: 2804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44967028498649597, gen p mean: -0.1162630096077919, mean p set: 0.4502470791339874
loss_pred:0.015552105382084846, decouple_loss:0.00047186677693389356
The modified gen p mean: 0.4496057629585266, gen p mean: -0.11142873764038086, mean p set: 0.4501826763153076
loss_pred:0.014421211555600166, decouple_loss:0.0004445071390364319
The modified gen p mean: 0.4480888247489929, gen p mean: -0.11633520573377609, mean p set: 0.44866451621055603
loss_pred:0.01472986489534378, decouple_loss:0.0005988636403344572
Iteration: 2805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45057839155197144, gen p mean: -0.1190161257982254, mean p set: 0.45115435123443604
loss_pred:0.015015846118330956, decouple_loss:0.0003583532525226474
The modified gen p mean: 0.45008131861686707, gen p mean: -0.11744321137666702, mean p set: 0.4506576955318451
loss_pred:0.015086079016327858, decouple_loss:0.0004445917729754001
The modified gen p mean: 0.45002883672714233, gen p mean: -0.12013981491327286, mean p set: 0.45060229301452637
loss_pred:0.014526795595884323, decouple_loss:0.00038955247146077454
Iteration: 2806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45053544640541077, gen p mean: -0.11354223638772964, mean p set: 0.45111238956451416
loss_pred:0.01598597690463066, decouple_loss:0.0005437611835077405
The modified gen p mean: 0.44955962896347046, gen p mean: -0.1166350319981575, mean p set: 0.45013487339019775
The modified gen p mean: 0.4499320387840271, gen p mean: -0.11708401143550873, mean p set: 0.4505079984664917
loss_pred:0.014957972802221775, decouple_loss:0.00040693237679079175
loss_pred:0.015177191235125065, decouple_loss:0.0004694185045082122
Iteration: 2807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886428117752075, gen p mean: -0.12390480190515518, mean p set: 0.449439138174057
loss_pred:0.015232078731060028, decouple_loss:0.0003616572357714176
The modified gen p mean: 0.44808611273765564, gen p mean: -0.11883772909641266, mean p set: 0.4486616849899292
The modified gen p mean: 0.44824326038360596, gen p mean: -0.1200881153345108, mean p set: 0.44881829619407654
loss_pred:0.015674803406000137, decouple_loss:0.00032112683402374387
loss_pred:0.015389587730169296, decouple_loss:0.0003232540038879961
Iteration: 2808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44991374015808105, gen p mean: -0.11659563332796097, mean p set: 0.4504888951778412
loss_pred:0.014499561861157417, decouple_loss:0.0004125514824409038
The modified gen p mean: 0.45024311542510986, gen p mean: -0.11545134335756302, mean p set: 0.45081809163093567
loss_pred:0.014988354407250881, decouple_loss:0.00046052757534198463
The modified gen p mean: 0.4484960436820984, gen p mean: -0.11706140637397766, mean p set: 0.44907310605049133
loss_pred:0.015173686668276787, decouple_loss:0.00039831484900787473
Iteration: 2809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738534092903137, gen p mean: -0.122250996530056, mean p set: 0.4479601979255676
loss_pred:0.014219512231647968, decouple_loss:0.0005074142245575786
The modified gen p mean: 0.4489082396030426, gen p mean: -0.11789749562740326, mean p set: 0.44948336482048035
loss_pred:0.015657024458050728, decouple_loss:0.00038372137350961566
The modified gen p mean: 0.45001518726348877, gen p mean: -0.11909536272287369, mean p set: 0.45058971643447876
loss_pred:0.01464240625500679, decouple_loss:0.00039685313822701573
Iteration: 2810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728848338127136, gen p mean: -0.1106145903468132, mean p set: 0.4478653073310852
loss_pred:0.015791315585374832, decouple_loss:0.0004066547262482345
The modified gen p mean: 0.4499162435531616, gen p mean: -0.11626855283975601, mean p set: 0.45049184560775757
loss_pred:0.015377286821603775, decouple_loss:0.00038583955029025674
The modified gen p mean: 0.4480193555355072, gen p mean: -0.10996530205011368, mean p set: 0.4485982656478882
loss_pred:0.015797650441527367, decouple_loss:0.0004473105655051768
2023-05-02 14:15:16 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12515437602996826, mean p set: 0.4502691626548767
loss_pred:0.016860593110322952, decouple_loss:0.0006454067770391703
The modified gen p mean: 0.4495353102684021, gen p mean: -0.11927574127912521, mean p set: 0.4500633478164673
loss_pred:0.016144653782248497, decouple_loss:0.0005695446161553264
The modified gen p mean: 0.449828177690506, gen p mean: -0.11861081421375275, mean p set: 0.45035696029663086
loss_pred:0.016427665948867798, decouple_loss:0.0005025119753554463
WV_1_PC_1_EH_0_PS_40, loss: 0.016506262123584747, avg_mse: 0.025760188698768616
current test mse: 0.02576
Iteration: 2811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45052504539489746, gen p mean: -0.10588584840297699, mean p set: 0.4511011838912964
loss_pred:0.015520178712904453, decouple_loss:0.0003687928547151387
The modified gen p mean: 0.44705167412757874, gen p mean: -0.11768651008605957, mean p set: 0.4476262331008911The modified gen p mean: 0.44974562525749207, gen p mean: -0.11022645235061646, mean p set: 0.4503222107887268
loss_pred:0.014277658425271511, decouple_loss:0.000402355391997844
loss_pred:0.014819989912211895, decouple_loss:0.00040261619142256677
Iteration: 2812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502170979976654, gen p mean: -0.1127941906452179, mean p set: 0.4507937431335449
loss_pred:0.014461795799434185, decouple_loss:0.00046348595060408115
The modified gen p mean: 0.45004260540008545, gen p mean: -0.11091676354408264, mean p set: 0.4506188929080963The modified gen p mean: 0.4504493474960327, gen p mean: -0.11112920939922333, mean p set: 0.4510261118412018
loss_pred:0.014362668618559837, decouple_loss:0.00036046351306140423
loss_pred:0.014407479204237461, decouple_loss:0.0005030417232774198
Iteration: 2813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447313517332077, gen p mean: -0.11730966717004776, mean p set: 0.44788995385169983
loss_pred:0.014780469238758087, decouple_loss:0.0004775101551786065
The modified gen p mean: 0.4471708834171295, gen p mean: -0.11691208928823471, mean p set: 0.44774648547172546
loss_pred:0.014249831438064575, decouple_loss:0.0005162638262845576
The modified gen p mean: 0.44978705048561096, gen p mean: -0.11189009994268417, mean p set: 0.4503651261329651
loss_pred:0.015068348497152328, decouple_loss:0.00034522367059253156
Iteration: 2814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742605090141296, gen p mean: -0.11219269037246704, mean p set: 0.44800323247909546
loss_pred:0.014775913208723068, decouple_loss:0.00036435850779525936
The modified gen p mean: 0.447689950466156, gen p mean: -0.11834636330604553, mean p set: 0.4482679069042206
loss_pred:0.014834023080766201, decouple_loss:0.000551781093236059
The modified gen p mean: 0.4493272304534912, gen p mean: -0.11514938622713089, mean p set: 0.44990259408950806
loss_pred:0.01464889757335186, decouple_loss:0.0003625430690590292
Iteration: 2815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829151034355164, gen p mean: -0.11316215991973877, mean p set: 0.4488682746887207
loss_pred:0.014809130690991879, decouple_loss:0.0003792121133301407
The modified gen p mean: 0.449798583984375, gen p mean: -0.11094239354133606, mean p set: 0.4503746032714844
loss_pred:0.014992065727710724, decouple_loss:0.0003023470926564187
The modified gen p mean: 0.4503059387207031, gen p mean: -0.11104634404182434, mean p set: 0.45088252425193787
loss_pred:0.014701921492815018, decouple_loss:0.00029954256024211645
Iteration: 2816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477390944957733, gen p mean: -0.11144663393497467, mean p set: 0.4483151137828827
The modified gen p mean: 0.4501871168613434, gen p mean: -0.10847803205251694, mean p set: 0.4507611393928528
loss_pred:0.015132149681448936, decouple_loss:0.0004570673918351531
loss_pred:0.015372462570667267, decouple_loss:0.00041343344491906464
The modified gen p mean: 0.44902503490448, gen p mean: -0.11196792870759964, mean p set: 0.4496016502380371
loss_pred:0.015501369722187519, decouple_loss:0.00040903774788603187
Iteration: 2817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807982444763184, gen p mean: -0.11190459877252579, mean p set: 0.44865772128105164
loss_pred:0.015469158999621868, decouple_loss:0.0004460541531443596
The modified gen p mean: 0.4473460912704468, gen p mean: -0.11398330330848694, mean p set: 0.4479213356971741
loss_pred:0.014550323598086834, decouple_loss:0.0004643094725906849
The modified gen p mean: 0.45065176486968994, gen p mean: -0.1135084256529808, mean p set: 0.4512310028076172
loss_pred:0.014316880144178867, decouple_loss:0.0003308350860606879
Iteration: 2818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501439034938812, gen p mean: -0.10785361379384995, mean p set: 0.45071908831596375
loss_pred:0.015444706194102764, decouple_loss:0.00035805930383503437
The modified gen p mean: 0.45018914341926575, gen p mean: -0.10522875189781189, mean p set: 0.4507671892642975
The modified gen p mean: 0.44737252593040466, gen p mean: -0.11195220053195953, mean p set: 0.447950154542923
loss_pred:0.015358716249465942, decouple_loss:0.0003191598516423255
loss_pred:0.015044130384922028, decouple_loss:0.0003079935850109905
Iteration: 2819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485127031803131, gen p mean: -0.11738646775484085, mean p set: 0.4490925371646881
loss_pred:0.016031477600336075, decouple_loss:0.0003916434070561081
The modified gen p mean: 0.4476454257965088, gen p mean: -0.10860635340213776, mean p set: 0.44822174310684204
The modified gen p mean: 0.4478161931037903, gen p mean: -0.11467267572879791, mean p set: 0.44839444756507874
loss_pred:0.015788406133651733, decouple_loss:0.00046263737021945417
loss_pred:0.014266228303313255, decouple_loss:0.00048845075070858
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
NaN value num: 0
Iteration: 2820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776806235313416, gen p mean: -0.12105536460876465, mean p set: 0.44834303855895996
loss_pred:0.015531275421380997, decouple_loss:0.0003890231892000884
The modified gen p mean: 0.44774070382118225, gen p mean: -0.12080712616443634, mean p set: 0.44831764698028564
The modified gen p mean: 0.44951972365379333, gen p mean: -0.11909385025501251, mean p set: 0.4500986337661743
loss_pred:0.0156809501349926, decouple_loss:0.0005402452079579234
loss_pred:0.01539510115981102, decouple_loss:0.00036633017589338124
2023-05-02 14:18:01 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12720488011837006, mean p set: 0.4502691626548767
loss_pred:0.016829296946525574, decouple_loss:0.0003755177604034543
The modified gen p mean: 0.4495368003845215, gen p mean: -0.12134595960378647, mean p set: 0.4500633478164673
loss_pred:0.01610305719077587, decouple_loss:0.0004327504721004516
The modified gen p mean: 0.44982609152793884, gen p mean: -0.12062160670757294, mean p set: 0.45035696029663086
loss_pred:0.016336290165781975, decouple_loss:0.0005378890200518072
WV_1_PC_1_EH_0_PS_40, loss: 0.01644531823694706, avg_mse: 0.02570032700896263
current test mse: 0.0257
Iteration: 2821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480816721916199, gen p mean: -0.1211850643157959, mean p set: 0.4486587643623352
loss_pred:0.015777776017785072, decouple_loss:0.00043096591252833605
The modified gen p mean: 0.44702067971229553, gen p mean: -0.11797941476106644, mean p set: 0.44759565591812134The modified gen p mean: 0.44902849197387695, gen p mean: -0.12580551207065582, mean p set: 0.4496051073074341
loss_pred:0.015458961948752403, decouple_loss:0.0004136356874369085
loss_pred:0.015587890520691872, decouple_loss:0.00034875510027632117
Iteration: 2822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483507573604584, gen p mean: -0.12582947313785553, mean p set: 0.44892963767051697
loss_pred:0.016166994348168373, decouple_loss:0.0004760529554914683
The modified gen p mean: 0.44721904397010803, gen p mean: -0.11988908052444458, mean p set: 0.44779375195503235
The modified gen p mean: 0.4496416747570038, gen p mean: -0.12669968605041504, mean p set: 0.4502195119857788
loss_pred:0.01621146872639656, decouple_loss:0.00044112023897469044
loss_pred:0.014524844475090504, decouple_loss:0.0005822220118716359
Iteration: 2823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44916799664497375, gen p mean: -0.12521785497665405, mean p set: 0.44974657893180847
loss_pred:0.01602245308458805, decouple_loss:0.0004912363947369158
The modified gen p mean: 0.4478505253791809, gen p mean: -0.12681888043880463, mean p set: 0.44842690229415894The modified gen p mean: 0.44983014464378357, gen p mean: -0.12662211060523987, mean p set: 0.4504074156284332
loss_pred:0.015104273334145546, decouple_loss:0.0006076991558074951
loss_pred:0.01524769514799118, decouple_loss:0.000490178819745779
Iteration: 2824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841355085372925, gen p mean: -0.13013039529323578, mean p set: 0.4489891827106476
loss_pred:0.016074474900960922, decouple_loss:0.00044228509068489075
The modified gen p mean: 0.4477370083332062, gen p mean: -0.1298290193080902, mean p set: 0.44831374287605286
loss_pred:0.015336238779127598, decouple_loss:0.0004045788082294166
The modified gen p mean: 0.4481137692928314, gen p mean: -0.12846969068050385, mean p set: 0.4486878216266632
loss_pred:0.015647495165467262, decouple_loss:0.0003724669513758272
Iteration: 2825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678887724876404, gen p mean: -0.12793707847595215, mean p set: 0.44736447930336
loss_pred:0.015836605802178383, decouple_loss:0.00034707022132351995
The modified gen p mean: 0.4487149715423584, gen p mean: -0.13835082948207855, mean p set: 0.4492875933647156
loss_pred:0.01578609272837639, decouple_loss:0.0004220473056193441
The modified gen p mean: 0.44793304800987244, gen p mean: -0.1328790932893753, mean p set: 0.4485076069831848
loss_pred:0.01587856002151966, decouple_loss:0.00038410694105550647
Iteration: 2826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449399471282959, gen p mean: -0.14034251868724823, mean p set: 0.4499753415584564
loss_pred:0.015259118750691414, decouple_loss:0.0004474598099477589
The modified gen p mean: 0.4474487900733948, gen p mean: -0.13417795300483704, mean p set: 0.44802385568618774
The modified gen p mean: 0.4480641484260559, gen p mean: -0.13961434364318848, mean p set: 0.448641300201416
loss_pred:0.01594780944287777, decouple_loss:0.0005283415084704757
loss_pred:0.015399504452943802, decouple_loss:0.000533215468749404
Iteration: 2827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481580853462219, gen p mean: -0.13893015682697296, mean p set: 0.4487301707267761
loss_pred:0.015943165868520737, decouple_loss:0.00035575329093262553
The modified gen p mean: 0.4479433596134186, gen p mean: -0.13293668627738953, mean p set: 0.44851937890052795
loss_pred:0.0159837007522583, decouple_loss:0.0003839578421320766
The modified gen p mean: 0.44929954409599304, gen p mean: -0.13266664743423462, mean p set: 0.4498783349990845
loss_pred:0.014821775257587433, decouple_loss:0.0003962963819503784
Iteration: 2828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474918842315674, gen p mean: -0.1356312781572342, mean p set: 0.44806647300720215
loss_pred:0.01483694463968277, decouple_loss:0.0004248649929650128
The modified gen p mean: 0.44782114028930664, gen p mean: -0.13072802126407623, mean p set: 0.44839733839035034
The modified gen p mean: 0.44829678535461426, gen p mean: -0.13231001794338226, mean p set: 0.4488738775253296
loss_pred:0.015916114673018456, decouple_loss:0.00034433245309628546
loss_pred:0.01453766692429781, decouple_loss:0.0003478002327028662
Iteration: 2829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770267605781555, gen p mean: -0.1290905475616455, mean p set: 0.4482775628566742
loss_pred:0.015433128923177719, decouple_loss:0.0005893253837712109
The modified gen p mean: 0.44783151149749756, gen p mean: -0.1354212462902069, mean p set: 0.44840967655181885
loss_pred:0.014998841099441051, decouple_loss:0.00042247932287864387
The modified gen p mean: 0.4481332302093506, gen p mean: -0.12921541929244995, mean p set: 0.44871172308921814
loss_pred:0.01662304438650608, decouple_loss:0.0005582223529927433
Iteration: 2830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001518726348877, gen p mean: -0.13570262491703033, mean p set: 0.4505901634693146
loss_pred:0.014507674612104893, decouple_loss:0.0004610532778315246
The modified gen p mean: 0.4476602375507355, gen p mean: -0.12998507916927338, mean p set: 0.4482342600822449
The modified gen p mean: 0.4485364258289337, gen p mean: -0.13603843748569489, mean p set: 0.4491157829761505
loss_pred:0.015202098526060581, decouple_loss:0.0005136493709869683
loss_pred:0.015279734507203102, decouple_loss:0.0005097887478768826
2023-05-02 14:20:08 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13802677392959595, mean p set: 0.4502691626548767
loss_pred:0.016890041530132294, decouple_loss:0.0003824671439360827
The modified gen p mean: 0.4495372474193573, gen p mean: -0.13179932534694672, mean p set: 0.4500633478164673
loss_pred:0.01614471711218357, decouple_loss:0.0004283194139134139
The modified gen p mean: 0.4498293101787567, gen p mean: -0.13127082586288452, mean p set: 0.45035696029663086
loss_pred:0.016395285725593567, decouple_loss:0.000484788091853261
WV_1_PC_1_EH_0_PS_40, loss: 0.016498275101184845, avg_mse: 0.02586069516837597
current test mse: 0.025861
Iteration: 2831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446670264005661, gen p mean: -0.12778693437576294, mean p set: 0.4472479820251465
loss_pred:0.015614370815455914, decouple_loss:0.00043476794962771237
The modified gen p mean: 0.44779449701309204, gen p mean: -0.12882398068904877, mean p set: 0.4483693838119507
loss_pred:0.015413638204336166, decouple_loss:0.0003601546341087669
The modified gen p mean: 0.4478153884410858, gen p mean: -0.13213327527046204, mean p set: 0.44839203357696533
loss_pred:0.015083469450473785, decouple_loss:0.00036232147249393165
Iteration: 2832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725826382637024, gen p mean: -0.1254924237728119, mean p set: 0.4478336274623871
loss_pred:0.01647552102804184, decouple_loss:0.0005838689394295216
The modified gen p mean: 0.4494120478630066, gen p mean: -0.13421091437339783, mean p set: 0.4499904215335846The modified gen p mean: 0.44820931553840637, gen p mean: -0.13288573920726776, mean p set: 0.4487864673137665
loss_pred:0.014484248124063015, decouple_loss:0.0004104922991245985
loss_pred:0.015322678722441196, decouple_loss:0.0004980227677151561
Iteration: 2833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482773542404175, gen p mean: -0.13213077187538147, mean p set: 0.4488562047481537
loss_pred:0.015941688790917397, decouple_loss:0.0006811890634708107
The modified gen p mean: 0.4479151666164398, gen p mean: -0.13240359723567963, mean p set: 0.44849133491516113
loss_pred:0.015466407872736454, decouple_loss:0.0005052363849245012
The modified gen p mean: 0.4485188126564026, gen p mean: -0.13681915402412415, mean p set: 0.4490949809551239
loss_pred:0.015239479951560497, decouple_loss:0.0006290884921327233
Iteration: 2834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492644965648651, gen p mean: -0.1335841715335846, mean p set: 0.44984182715415955
loss_pred:0.014855019748210907, decouple_loss:0.0003320910327602178
The modified gen p mean: 0.4489726424217224, gen p mean: -0.1320440173149109, mean p set: 0.4495508372783661
loss_pred:0.015049734152853489, decouple_loss:0.000557041319552809
The modified gen p mean: 0.4475807845592499, gen p mean: -0.1313229650259018, mean p set: 0.44815659523010254
loss_pred:0.015931174159049988, decouple_loss:0.0005124806193634868
Iteration: 2835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493354856967926, gen p mean: -0.12898899614810944, mean p set: 0.4499121904373169
loss_pred:0.015039644204080105, decouple_loss:0.0005621035234071314
The modified gen p mean: 0.4485227167606354, gen p mean: -0.12750600278377533, mean p set: 0.44909751415252686
loss_pred:0.016259130090475082, decouple_loss:0.0005277578020468354
The modified gen p mean: 0.44864392280578613, gen p mean: -0.13067582249641418, mean p set: 0.4492185115814209
loss_pred:0.01543840579688549, decouple_loss:0.000643914274405688
Iteration: 2836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481107294559479, gen p mean: -0.1288641095161438, mean p set: 0.44868478178977966
loss_pred:0.015575410798192024, decouple_loss:0.00042507649050094187
The modified gen p mean: 0.4482557773590088, gen p mean: -0.1320837289094925, mean p set: 0.44883406162261963
loss_pred:0.01553860493004322, decouple_loss:0.0004008575633633882
The modified gen p mean: 0.44751256704330444, gen p mean: -0.12950481474399567, mean p set: 0.4480896592140198
loss_pred:0.015777740627527237, decouple_loss:0.0004319092258810997
Iteration: 2837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792497158050537, gen p mean: -0.13222859799861908, mean p set: 0.44850072264671326
loss_pred:0.01589762046933174, decouple_loss:0.00043011922389268875
The modified gen p mean: 0.44772690534591675, gen p mean: -0.13220161199569702, mean p set: 0.44830331206321716
The modified gen p mean: 0.4479617774486542, gen p mean: -0.12834079563617706, mean p set: 0.44853708148002625
loss_pred:0.015975363552570343, decouple_loss:0.00033586498466320336
loss_pred:0.015765544027090073, decouple_loss:0.00036168377846479416
Iteration: 2838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796139001846313, gen p mean: -0.13045746088027954, mean p set: 0.4485383629798889
loss_pred:0.015325506217777729, decouple_loss:0.00047467302647419274
The modified gen p mean: 0.44874343276023865, gen p mean: -0.12851698696613312, mean p set: 0.44931817054748535
The modified gen p mean: 0.4479306638240814, gen p mean: -0.1318465918302536, mean p set: 0.44850850105285645
loss_pred:0.015467919409275055, decouple_loss:0.000455813278676942
loss_pred:0.015935704112052917, decouple_loss:0.00037856114795431495
Iteration: 2839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849711656570435, gen p mean: -0.1291757971048355, mean p set: 0.4490722715854645
The modified gen p mean: 0.44795650243759155, gen p mean: -0.12970156967639923, mean p set: 0.4485318660736084
loss_pred:0.015764255076646805, decouple_loss:0.0003923175681848079
loss_pred:0.015198654495179653, decouple_loss:0.00044156747753731906
The modified gen p mean: 0.44766753911972046, gen p mean: -0.1309824287891388, mean p set: 0.448240727186203
loss_pred:0.014864062890410423, decouple_loss:0.00041744380723685026
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480803608894348, gen p mean: -0.13775193691253662, mean p set: 0.4486584961414337
loss_pred:0.014815304428339005, decouple_loss:0.0004173333873040974
The modified gen p mean: 0.4467935562133789, gen p mean: -0.13947583734989166, mean p set: 0.4473665952682495
The modified gen p mean: 0.44667044281959534, gen p mean: -0.13262176513671875, mean p set: 0.447246253490448
loss_pred:0.015151701867580414, decouple_loss:0.00047312112292274833
loss_pred:0.014353815466165543, decouple_loss:0.00040984214865602553
2023-05-02 14:22:54 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.14161574840545654, mean p set: 0.4502691626548767
loss_pred:0.016843006014823914, decouple_loss:0.0004916391335427761
The modified gen p mean: 0.44953984022140503, gen p mean: -0.134891077876091, mean p set: 0.4500633478164673
loss_pred:0.016026746481657028, decouple_loss:0.0005419409135356545
The modified gen p mean: 0.44983235001564026, gen p mean: -0.13445276021957397, mean p set: 0.45035696029663086
loss_pred:0.016320832073688507, decouple_loss:0.0004980276571586728
WV_1_PC_1_EH_0_PS_40, loss: 0.016422389075160027, avg_mse: 0.025694284588098526
current test mse: 0.025694
Iteration: 2841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474962055683136, gen p mean: -0.13875295221805573, mean p set: 0.448073148727417
loss_pred:0.014903413131833076, decouple_loss:0.0005088739562779665
The modified gen p mean: 0.4487365484237671, gen p mean: -0.1433538794517517, mean p set: 0.44931700825691223
loss_pred:0.014779835008084774, decouple_loss:0.0006203915108926594
The modified gen p mean: 0.4472320079803467, gen p mean: -0.1457340270280838, mean p set: 0.4478095471858978
loss_pred:0.01495562307536602, decouple_loss:0.00044612112105824053
Iteration: 2842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701066613197327, gen p mean: -0.13972263038158417, mean p set: 0.44758522510528564
loss_pred:0.014833084307610989, decouple_loss:0.0003555545408744365
The modified gen p mean: 0.4481081962585449, gen p mean: -0.14423605799674988, mean p set: 0.44868341088294983The modified gen p mean: 0.4451620578765869, gen p mean: -0.14498059451580048, mean p set: 0.44573795795440674
loss_pred:0.014911294914782047, decouple_loss:0.00033997345599345863
loss_pred:0.014811539091169834, decouple_loss:0.0003605146484915167
Iteration: 2843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725194573402405, gen p mean: -0.13824069499969482, mean p set: 0.44782623648643494
loss_pred:0.014637191779911518, decouple_loss:0.0003833530063275248
The modified gen p mean: 0.44668179750442505, gen p mean: -0.14169283211231232, mean p set: 0.44725558161735535
loss_pred:0.014975507743656635, decouple_loss:0.00036142425960861146
The modified gen p mean: 0.44637206196784973, gen p mean: -0.14132608473300934, mean p set: 0.44694921374320984
loss_pred:0.01496454980224371, decouple_loss:0.00043454987462610006
Iteration: 2844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455925226211548, gen p mean: -0.14316333830356598, mean p set: 0.4461652636528015
loss_pred:0.014867420308291912, decouple_loss:0.00047827715752646327
The modified gen p mean: 0.4462268352508545, gen p mean: -0.13769909739494324, mean p set: 0.44680535793304443
loss_pred:0.014478914439678192, decouple_loss:0.0004573490296024829
The modified gen p mean: 0.44848018884658813, gen p mean: -0.13911862671375275, mean p set: 0.4490543007850647
loss_pred:0.015114499256014824, decouple_loss:0.0005879778182134032
Iteration: 2845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489511251449585, gen p mean: -0.13995999097824097, mean p set: 0.44952791929244995
loss_pred:0.014641465619206429, decouple_loss:0.0003220591461285949
The modified gen p mean: 0.4465987980365753, gen p mean: -0.13852408528327942, mean p set: 0.4471711814403534
loss_pred:0.014894791878759861, decouple_loss:0.00033645148505456746
The modified gen p mean: 0.44875961542129517, gen p mean: -0.13845506310462952, mean p set: 0.44933852553367615
loss_pred:0.015089538879692554, decouple_loss:0.00035941091482527554
Iteration: 2846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479122459888458, gen p mean: -0.13794991374015808, mean p set: 0.448486864566803
loss_pred:0.014971858821809292, decouple_loss:0.00041453426820226014
The modified gen p mean: 0.4457305371761322, gen p mean: -0.1354062557220459, mean p set: 0.44630563259124756
loss_pred:0.014423146843910217, decouple_loss:0.0004453885485418141
The modified gen p mean: 0.44711658358573914, gen p mean: -0.13509424030780792, mean p set: 0.4476941227912903
loss_pred:0.014936062507331371, decouple_loss:0.00033463805448263884
Iteration: 2847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467805325984955, gen p mean: -0.13558229804039001, mean p set: 0.4473566710948944
loss_pred:0.01447352021932602, decouple_loss:0.0003696962376125157
The modified gen p mean: 0.4458993375301361, gen p mean: -0.13120242953300476, mean p set: 0.44647401571273804
loss_pred:0.015100281685590744, decouple_loss:0.0005975114181637764
The modified gen p mean: 0.4461584985256195, gen p mean: -0.13751032948493958, mean p set: 0.44673389196395874
loss_pred:0.01442166231572628, decouple_loss:0.0004887169925495982
Iteration: 2848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44558191299438477, gen p mean: -0.1404714733362198, mean p set: 0.4461599588394165
loss_pred:0.014987087808549404, decouple_loss:0.0004181165131740272
The modified gen p mean: 0.4451962113380432, gen p mean: -0.13948005437850952, mean p set: 0.4457697868347168
loss_pred:0.014797625131905079, decouple_loss:0.0004463169607333839
The modified gen p mean: 0.44637635350227356, gen p mean: -0.13170625269412994, mean p set: 0.44695523381233215
loss_pred:0.014541998505592346, decouple_loss:0.00030604141647927463
Iteration: 2849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447167307138443, gen p mean: -0.13564886152744293, mean p set: 0.4477439522743225
loss_pred:0.014361754059791565, decouple_loss:0.00039474639925174415
The modified gen p mean: 0.44617506861686707, gen p mean: -0.1328849047422409, mean p set: 0.44675159454345703
The modified gen p mean: 0.4465264081954956, gen p mean: -0.13647067546844482, mean p set: 0.4471011161804199
loss_pred:0.014656635001301765, decouple_loss:0.0004679205303546041
loss_pred:0.015045280568301678, decouple_loss:0.00041158930980600417
Iteration: 2850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463162422180176, gen p mean: -0.1292303055524826, mean p set: 0.44689324498176575
loss_pred:0.015061475336551666, decouple_loss:0.00041198593680746853
The modified gen p mean: 0.4465474486351013, gen p mean: -0.12943564355373383, mean p set: 0.44712045788764954
loss_pred:0.014688816852867603, decouple_loss:0.00043085217475891113
The modified gen p mean: 0.44583502411842346, gen p mean: -0.12712816894054413, mean p set: 0.4464118480682373
loss_pred:0.01535762194544077, decouple_loss:0.0003593038418330252
2023-05-02 14:25:01 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.130553737282753, mean p set: 0.4502691626548767
loss_pred:0.016778994351625443, decouple_loss:0.00043742076377384365
The modified gen p mean: 0.4495311975479126, gen p mean: -0.1239750012755394, mean p set: 0.4500633478164673
loss_pred:0.0161126796156168, decouple_loss:0.00047752365935593843
The modified gen p mean: 0.4498283565044403, gen p mean: -0.12347320467233658, mean p set: 0.45035696029663086
loss_pred:0.01641102321445942, decouple_loss:0.0005617809947580099
WV_1_PC_1_EH_0_PS_40, loss: 0.016458844766020775, avg_mse: 0.025775201618671417
current test mse: 0.025775
Iteration: 2851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448700487613678, gen p mean: -0.13058286905288696, mean p set: 0.44927704334259033
loss_pred:0.014676550403237343, decouple_loss:0.00044330692617222667
The modified gen p mean: 0.44750460982322693, gen p mean: -0.12729720771312714, mean p set: 0.44808098673820496
loss_pred:0.014928344637155533, decouple_loss:0.00044545045238919556
The modified gen p mean: 0.44682490825653076, gen p mean: -0.1280367076396942, mean p set: 0.4473998546600342
loss_pred:0.014295654371380806, decouple_loss:0.00043096847366541624
Iteration: 2852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474199712276459, gen p mean: -0.13262821733951569, mean p set: 0.44799599051475525
loss_pred:0.014035039581358433, decouple_loss:0.00046320201363414526
The modified gen p mean: 0.44801169633865356, gen p mean: -0.13159377872943878, mean p set: 0.44858697056770325The modified gen p mean: 0.4461100697517395, gen p mean: -0.12758028507232666, mean p set: 0.44668781757354736
loss_pred:0.01459007803350687, decouple_loss:0.0003514678101055324
loss_pred:0.015384422615170479, decouple_loss:0.0004770822124555707
Iteration: 2853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462096393108368, gen p mean: -0.12996570765972137, mean p set: 0.4467838406562805
The modified gen p mean: 0.44568073749542236, gen p mean: -0.12772534787654877, mean p set: 0.44625577330589294
loss_pred:0.014267022721469402, decouple_loss:0.0003592967404983938
loss_pred:0.01480038557201624, decouple_loss:0.0004135341732762754
The modified gen p mean: 0.4461648762226105, gen p mean: -0.12647585570812225, mean p set: 0.4467402696609497
loss_pred:0.015161141753196716, decouple_loss:0.0003707836731337011
Iteration: 2854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820865988731384, gen p mean: -0.13429448008537292, mean p set: 0.4487825632095337
loss_pred:0.014702053740620613, decouple_loss:0.0006478196592070162
The modified gen p mean: 0.44787439703941345, gen p mean: -0.13251881301403046, mean p set: 0.4484470784664154
loss_pred:0.014776785857975483, decouple_loss:0.0004279009299352765
The modified gen p mean: 0.4457329511642456, gen p mean: -0.12751005589962006, mean p set: 0.44630685448646545
loss_pred:0.01491783931851387, decouple_loss:0.0005680409376509488
Iteration: 2855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725272059440613, gen p mean: -0.1323612630367279, mean p set: 0.4478280544281006
The modified gen p mean: 0.44599881768226624, gen p mean: -0.12820661067962646, mean p set: 0.4465752840042114
loss_pred:0.014756356365978718, decouple_loss:0.0005094266380183399
loss_pred:0.014794080518186092, decouple_loss:0.00048168294597417116
The modified gen p mean: 0.446955144405365, gen p mean: -0.13277243077754974, mean p set: 0.44752782583236694
loss_pred:0.014982608146965504, decouple_loss:0.0003991892153862864
Iteration: 2856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465863108634949, gen p mean: -0.1334792971611023, mean p set: 0.44715940952301025
loss_pred:0.014942686073482037, decouple_loss:0.0003148956166114658
The modified gen p mean: 0.4473472535610199, gen p mean: -0.13261787593364716, mean p set: 0.4479255974292755
loss_pred:0.014908074401319027, decouple_loss:0.00031727863824926317
The modified gen p mean: 0.4460517466068268, gen p mean: -0.12656189501285553, mean p set: 0.4466271698474884
loss_pred:0.014442608691751957, decouple_loss:0.0003822001162916422
Iteration: 2857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737401604652405, gen p mean: -0.13412326574325562, mean p set: 0.447951078414917
loss_pred:0.014312556944787502, decouple_loss:0.0004122999089304358
The modified gen p mean: 0.4459347128868103, gen p mean: -0.12921220064163208, mean p set: 0.44651132822036743
loss_pred:0.01533023826777935, decouple_loss:0.0003710160090122372
The modified gen p mean: 0.4467281103134155, gen p mean: -0.13606420159339905, mean p set: 0.4473038911819458
loss_pred:0.014393315650522709, decouple_loss:0.000373282004147768
Iteration: 2858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473652243614197, gen p mean: -0.13797429203987122, mean p set: 0.44794052839279175
loss_pred:0.014345427043735981, decouple_loss:0.0003562012570910156
The modified gen p mean: 0.4480784237384796, gen p mean: -0.13402967154979706, mean p set: 0.44865259528160095
loss_pred:0.014316978864371777, decouple_loss:0.0003771349729504436
The modified gen p mean: 0.44635429978370667, gen p mean: -0.1327587515115738, mean p set: 0.4469289183616638
loss_pred:0.014458229765295982, decouple_loss:0.00036966451443731785
Iteration: 2859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730186462402344, gen p mean: -0.12657444179058075, mean p set: 0.44787678122520447
loss_pred:0.014800586737692356, decouple_loss:0.0003069685772061348
The modified gen p mean: 0.4466194808483124, gen p mean: -0.1305602490901947, mean p set: 0.4471926689147949
loss_pred:0.014721295796334743, decouple_loss:0.00031962370849214494
The modified gen p mean: 0.4477154016494751, gen p mean: -0.134539395570755, mean p set: 0.4482913017272949
loss_pred:0.014640867710113525, decouple_loss:0.000444091041572392
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
NaN value num: 0
Iteration: 2860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45158615708351135, gen p mean: -0.12140427529811859, mean p set: 0.4521616995334625The modified gen p mean: 0.45355018973350525, gen p mean: -0.1221650093793869, mean p set: 0.45412924885749817
loss_pred:0.014956255443394184, decouple_loss:0.0005782422958873212
loss_pred:0.014559375122189522, decouple_loss:0.0005769825074821711
The modified gen p mean: 0.45388850569725037, gen p mean: -0.12354891002178192, mean p set: 0.45446687936782837
loss_pred:0.014519019983708858, decouple_loss:0.0006686484557576478
2023-05-02 14:27:45 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13497699797153473, mean p set: 0.4502691626548767
loss_pred:0.01677463762462139, decouple_loss:0.0003461239975877106
The modified gen p mean: 0.4495333433151245, gen p mean: -0.12842243909835815, mean p set: 0.4500633478164673
loss_pred:0.01605348102748394, decouple_loss:0.00038098718505352736
The modified gen p mean: 0.44982823729515076, gen p mean: -0.12778927385807037, mean p set: 0.45035696029663086
loss_pred:0.016377383843064308, decouple_loss:0.00039048882899805903
WV_1_PC_1_EH_0_PS_40, loss: 0.016420461237430573, avg_mse: 0.02568826824426651
current test mse: 0.025688
Iteration: 2861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45026811957359314, gen p mean: -0.11834173649549484, mean p set: 0.45084527134895325
The modified gen p mean: 0.45081353187561035, gen p mean: -0.12272985279560089, mean p set: 0.4513914883136749
loss_pred:0.01525985635817051, decouple_loss:0.0005314521258696914
loss_pred:0.014734744094312191, decouple_loss:0.0005039796233177185
The modified gen p mean: 0.452647864818573, gen p mean: -0.12215264141559601, mean p set: 0.4532293677330017
loss_pred:0.01441224291920662, decouple_loss:0.0005819876096211374
Iteration: 2862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510597288608551, gen p mean: -0.11740398406982422, mean p set: 0.45163676142692566
loss_pred:0.014631818979978561, decouple_loss:0.0005382001982070506
The modified gen p mean: 0.4512399733066559, gen p mean: -0.11399530619382858, mean p set: 0.4518158733844757The modified gen p mean: 0.45160582661628723, gen p mean: -0.11549857258796692, mean p set: 0.45218291878700256
loss_pred:0.015117687173187733, decouple_loss:0.0003901166783180088
loss_pred:0.014747018925845623, decouple_loss:0.0003779772960115224
Iteration: 2863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451712965965271, gen p mean: -0.11559998244047165, mean p set: 0.452288955450058
loss_pred:0.01468211505562067, decouple_loss:0.0005926925223320723
The modified gen p mean: 0.45110151171684265, gen p mean: -0.11610845476388931, mean p set: 0.4516795575618744
loss_pred:0.015063544735312462, decouple_loss:0.0007051269640214741
The modified gen p mean: 0.45021894574165344, gen p mean: -0.11276580393314362, mean p set: 0.45079749822616577
loss_pred:0.014864418655633926, decouple_loss:0.0005812656017951667
Iteration: 2864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45342695713043213, gen p mean: -0.11228940635919571, mean p set: 0.45400553941726685
loss_pred:0.013886043801903725, decouple_loss:0.0004483976517803967
The modified gen p mean: 0.45118647813796997, gen p mean: -0.1131671592593193, mean p set: 0.4517635107040405
loss_pred:0.014975308440625668, decouple_loss:0.0005087157478556037
The modified gen p mean: 0.45073968172073364, gen p mean: -0.11059042066335678, mean p set: 0.4513179063796997
loss_pred:0.015404107980430126, decouple_loss:0.00040653086034581065
Iteration: 2865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45076948404312134, gen p mean: -0.10891351848840714, mean p set: 0.45134520530700684
loss_pred:0.014864947646856308, decouple_loss:0.0003869608335662633
The modified gen p mean: 0.45123302936553955, gen p mean: -0.11047428101301193, mean p set: 0.4518086314201355
loss_pred:0.014984732493758202, decouple_loss:0.0003392955113667995
The modified gen p mean: 0.4509843587875366, gen p mean: -0.11333999782800674, mean p set: 0.45155712962150574
loss_pred:0.014226909726858139, decouple_loss:0.00038967112777754664
Iteration: 2866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519440829753876, gen p mean: -0.12131043523550034, mean p set: 0.45252230763435364
loss_pred:0.014645606279373169, decouple_loss:0.0009141565533354878
The modified gen p mean: 0.45206159353256226, gen p mean: -0.11580442637205124, mean p set: 0.4526367783546448
loss_pred:0.01474757306277752, decouple_loss:0.0005846019485034049
The modified gen p mean: 0.4520314335823059, gen p mean: -0.1159428209066391, mean p set: 0.4526068866252899
loss_pred:0.015045219101011753, decouple_loss:0.000609771755989641
Iteration: 2867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45251452922821045, gen p mean: -0.11424359679222107, mean p set: 0.45309484004974365
loss_pred:0.014388891868293285, decouple_loss:0.00048324669478461146
The modified gen p mean: 0.4505862295627594, gen p mean: -0.11412500590085983, mean p set: 0.45116350054740906
The modified gen p mean: 0.4512438476085663, gen p mean: -0.11793237924575806, mean p set: 0.45181941986083984
loss_pred:0.014849892817437649, decouple_loss:0.0004011360288131982
loss_pred:0.014990054070949554, decouple_loss:0.00033977688872255385
Iteration: 2868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45040416717529297, gen p mean: -0.12171465903520584, mean p set: 0.4509810209274292
loss_pred:0.01502339169383049, decouple_loss:0.0005385271506384015
The modified gen p mean: 0.4514463245868683, gen p mean: -0.1204509362578392, mean p set: 0.4520235061645508
The modified gen p mean: 0.45317065715789795, gen p mean: -0.12020266056060791, mean p set: 0.45374795794487
loss_pred:0.01406240276992321, decouple_loss:0.00048634959966875613
loss_pred:0.01444094069302082, decouple_loss:0.0005315246526151896
Iteration: 2869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513905346393585, gen p mean: -0.12685108184814453, mean p set: 0.4519648849964142
loss_pred:0.015277349390089512, decouple_loss:0.000531477911863476
The modified gen p mean: 0.4499935209751129, gen p mean: -0.11672800034284592, mean p set: 0.4505713880062103
The modified gen p mean: 0.4515525698661804, gen p mean: -0.12192919850349426, mean p set: 0.4521290957927704
loss_pred:0.0145332682877779, decouple_loss:0.0004210104525554925
loss_pred:0.014196222648024559, decouple_loss:0.0005330097628757358
Iteration: 2870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45328032970428467, gen p mean: -0.12379954010248184, mean p set: 0.453857421875
loss_pred:0.014260277152061462, decouple_loss:0.0006129746325314045
The modified gen p mean: 0.4504947364330292, gen p mean: -0.12330642342567444, mean p set: 0.45107436180114746
The modified gen p mean: 0.4506685733795166, gen p mean: -0.11990825086832047, mean p set: 0.45124444365501404
loss_pred:0.014039152301847935, decouple_loss:0.0006124208448454738
loss_pred:0.015156622976064682, decouple_loss:0.0004495704488363117
2023-05-02 14:29:51 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13786961138248444, mean p set: 0.4502691626548767
loss_pred:0.016914907842874527, decouple_loss:0.00045640268945135176
The modified gen p mean: 0.4495355784893036, gen p mean: -0.1314651370048523, mean p set: 0.4500633478164673
loss_pred:0.016201160848140717, decouple_loss:0.0004451724817045033
The modified gen p mean: 0.4498288333415985, gen p mean: -0.13073091208934784, mean p set: 0.45035696029663086
loss_pred:0.016438812017440796, decouple_loss:0.0003959801106248051
WV_1_PC_1_EH_0_PS_40, loss: 0.01653992012143135, avg_mse: 0.025836002081632614
current test mse: 0.025836
Iteration: 2871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505891501903534, gen p mean: -0.11879930645227432, mean p set: 0.45116302371025085
loss_pred:0.01527458056807518, decouple_loss:0.0003700094239320606
The modified gen p mean: 0.4512097239494324, gen p mean: -0.1235668957233429, mean p set: 0.45178526639938354
loss_pred:0.014737081713974476, decouple_loss:0.0004226758610457182
The modified gen p mean: 0.45074358582496643, gen p mean: -0.12237415462732315, mean p set: 0.45131972432136536
loss_pred:0.014814680442214012, decouple_loss:0.0004087573033757508
Iteration: 2872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45134514570236206, gen p mean: -0.1281910538673401, mean p set: 0.45192527770996094
loss_pred:0.015354973264038563, decouple_loss:0.0007614504429511726
The modified gen p mean: 0.45143064856529236, gen p mean: -0.123675137758255, mean p set: 0.45200681686401367The modified gen p mean: 0.45192819833755493, gen p mean: -0.12318046391010284, mean p set: 0.45250189304351807
loss_pred:0.014208359643816948, decouple_loss:0.0005736527964472771
loss_pred:0.014635851606726646, decouple_loss:0.0005961869028396904
Iteration: 2873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514986574649811, gen p mean: -0.1299419403076172, mean p set: 0.4520774185657501
The modified gen p mean: 0.45154687762260437, gen p mean: -0.12258165329694748, mean p set: 0.45212632417678833
loss_pred:0.014494913630187511, decouple_loss:0.0006263235118240118
loss_pred:0.014547538012266159, decouple_loss:0.0004496096807997674
The modified gen p mean: 0.45102739334106445, gen p mean: -0.12111494690179825, mean p set: 0.45160529017448425
loss_pred:0.014740989543497562, decouple_loss:0.0004309297655709088
Iteration: 2874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45205873250961304, gen p mean: -0.12764734029769897, mean p set: 0.4526348412036896
loss_pred:0.014610856771469116, decouple_loss:0.0004932955489493906
The modified gen p mean: 0.45113858580589294, gen p mean: -0.11787638068199158, mean p set: 0.45171689987182617
loss_pred:0.015049764886498451, decouple_loss:0.0004886121605522931
The modified gen p mean: 0.45254769921302795, gen p mean: -0.12874498963356018, mean p set: 0.4531228840351105
loss_pred:0.014448501169681549, decouple_loss:0.0004897002363577485
Iteration: 2875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511161744594574, gen p mean: -0.1213570237159729, mean p set: 0.45168986916542053
The modified gen p mean: 0.4522491693496704, gen p mean: -0.12091005593538284, mean p set: 0.45282885432243347loss_pred:0.014772499911487103, decouple_loss:0.0005319358315318823
loss_pred:0.013991440646350384, decouple_loss:0.0005484762950800359
The modified gen p mean: 0.4515123963356018, gen p mean: -0.12195829302072525, mean p set: 0.4520907402038574
loss_pred:0.014294499531388283, decouple_loss:0.0004435770388226956
Iteration: 2876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511409103870392, gen p mean: -0.12025763839483261, mean p set: 0.45171838998794556
loss_pred:0.014473671093583107, decouple_loss:0.00039167789509519935
The modified gen p mean: 0.45136377215385437, gen p mean: -0.11946531385183334, mean p set: 0.45193883776664734
loss_pred:0.014838462695479393, decouple_loss:0.00038753417902626097
The modified gen p mean: 0.4516615867614746, gen p mean: -0.11909447610378265, mean p set: 0.45223915576934814
loss_pred:0.014599258080124855, decouple_loss:0.0005243454361334443
Iteration: 2877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071661472320557, gen p mean: -0.11970055103302002, mean p set: 0.45129284262657166
The modified gen p mean: 0.4527772068977356, gen p mean: -0.11793072521686554, mean p set: 0.4533538818359375
loss_pred:0.014339247718453407, decouple_loss:0.0006331583135761321
loss_pred:0.014604080468416214, decouple_loss:0.00044798897579312325
The modified gen p mean: 0.4504552483558655, gen p mean: -0.12095750123262405, mean p set: 0.45103341341018677
loss_pred:0.014428973197937012, decouple_loss:0.0004564160481095314
Iteration: 2878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533504247665405, gen p mean: -0.1140056923031807, mean p set: 0.4539281725883484
loss_pred:0.014214006252586842, decouple_loss:0.0004427504900377244
The modified gen p mean: 0.4528813362121582, gen p mean: -0.11527924239635468, mean p set: 0.4534603953361511
loss_pred:0.014118197374045849, decouple_loss:0.000438856688560918
The modified gen p mean: 0.45070165395736694, gen p mean: -0.1110638901591301, mean p set: 0.4512788653373718
loss_pred:0.01457464974373579, decouple_loss:0.0005442767287604511
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
NaN value num: 0
Iteration: 2879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768330454826355, gen p mean: -0.12310938537120819, mean p set: 0.4482572078704834
The modified gen p mean: 0.4469617009162903, gen p mean: -0.12071575969457626, mean p set: 0.44753962755203247
loss_pred:0.01568661257624626, decouple_loss:0.00036042658030055463
loss_pred:0.01567693240940571, decouple_loss:0.0004191612533759326
The modified gen p mean: 0.4476454257965088, gen p mean: -0.12552432715892792, mean p set: 0.4482213854789734
loss_pred:0.01467511709779501, decouple_loss:0.00040102607454173267
Iteration: 2880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462519884109497, gen p mean: -0.1290457397699356, mean p set: 0.44682762026786804
loss_pred:0.015247160568833351, decouple_loss:0.0003315235662739724
The modified gen p mean: 0.44762924313545227, gen p mean: -0.12388452142477036, mean p set: 0.44820523262023926
loss_pred:0.0159697737544775, decouple_loss:0.0004003625945188105
The modified gen p mean: 0.446029931306839, gen p mean: -0.12711989879608154, mean p set: 0.44660601019859314
loss_pred:0.015479113906621933, decouple_loss:0.00032668490894138813
2023-05-02 14:32:38 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.136036217212677, mean p set: 0.4502691626548767
loss_pred:0.0168884489685297, decouple_loss:0.00040012176032178104
The modified gen p mean: 0.4495345652103424, gen p mean: -0.12980477511882782, mean p set: 0.4500633478164673
The modified gen p mean: 0.4498290717601776, gen p mean: -0.12955103814601898, mean p set: 0.45035696029663086
loss_pred:0.016198735684156418, decouple_loss:0.0003701300884131342
loss_pred:0.01642223633825779, decouple_loss:0.0003928814548999071
WV_1_PC_1_EH_0_PS_40, loss: 0.016522526741027832, avg_mse: 0.025850262492895126
current test mse: 0.02585
Iteration: 2881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465547204017639, gen p mean: -0.13527385890483856, mean p set: 0.4471314251422882
loss_pred:0.01586558297276497, decouple_loss:0.0005367808043956757
The modified gen p mean: 0.44833216071128845, gen p mean: -0.13044807314872742, mean p set: 0.4489063620567322The modified gen p mean: 0.4467746913433075, gen p mean: -0.1336318403482437, mean p set: 0.4473547637462616
loss_pred:0.015363208949565887, decouple_loss:0.0003602918004617095
loss_pred:0.015210560522973537, decouple_loss:0.00040496460860595107
Iteration: 2882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695547223091125, gen p mean: -0.13822926580905914, mean p set: 0.4475308060646057
The modified gen p mean: 0.4457639455795288, gen p mean: -0.13339510560035706, mean p set: 0.4463379681110382
loss_pred:0.016010010614991188, decouple_loss:0.0004521443333942443
loss_pred:0.016001442447304726, decouple_loss:0.0003757136582862586
The modified gen p mean: 0.44627487659454346, gen p mean: -0.13353797793388367, mean p set: 0.44684910774230957
loss_pred:0.015779659152030945, decouple_loss:0.00041548104491084814
Iteration: 2883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746726751327515, gen p mean: -0.1424359828233719, mean p set: 0.4480431377887726
loss_pred:0.015690943226218224, decouple_loss:0.0003959065652452409
The modified gen p mean: 0.4472467005252838, gen p mean: -0.1404784917831421, mean p set: 0.4478229880332947
loss_pred:0.015204137191176414, decouple_loss:0.0003941476752515882
The modified gen p mean: 0.44699960947036743, gen p mean: -0.14026515185832977, mean p set: 0.4475752115249634
loss_pred:0.014978278428316116, decouple_loss:0.000325157365296036
Iteration: 2884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448011577129364, gen p mean: -0.1349165290594101, mean p set: 0.44858479499816895
The modified gen p mean: 0.44674623012542725, gen p mean: -0.1370341032743454, mean p set: 0.4473206102848053
loss_pred:0.015151826664805412, decouple_loss:0.00042279067565687
loss_pred:0.01588989794254303, decouple_loss:0.0003183337685186416
The modified gen p mean: 0.4456285834312439, gen p mean: -0.1328262984752655, mean p set: 0.44620317220687866
loss_pred:0.015703806653618813, decouple_loss:0.0003550949040800333
Iteration: 2885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692763686180115, gen p mean: -0.1298195868730545, mean p set: 0.44750040769577026
The modified gen p mean: 0.44653937220573425, gen p mean: -0.13054676353931427, mean p set: 0.4471152722835541
loss_pred:0.01588049717247486, decouple_loss:0.00034939893521368504
loss_pred:0.01580175757408142, decouple_loss:0.0003144617367070168
The modified gen p mean: 0.44677650928497314, gen p mean: -0.13088619709014893, mean p set: 0.4473547041416168
loss_pred:0.015774725005030632, decouple_loss:0.00038025455432944
Iteration: 2886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474565088748932, gen p mean: -0.13150225579738617, mean p set: 0.4480331242084503
loss_pred:0.015117543749511242, decouple_loss:0.00045487817260436714
The modified gen p mean: 0.4477607309818268, gen p mean: -0.1312297284603119, mean p set: 0.4483358860015869
The modified gen p mean: 0.4470643103122711, gen p mean: -0.13474740087985992, mean p set: 0.44764068722724915
loss_pred:0.015432378277182579, decouple_loss:0.000368371547665447
loss_pred:0.015469817444682121, decouple_loss:0.0004712280351668596
Iteration: 2887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44857507944107056, gen p mean: -0.13459886610507965, mean p set: 0.4491514265537262
The modified gen p mean: 0.4471842348575592, gen p mean: -0.13415852189064026, mean p set: 0.4477632939815521
loss_pred:0.014666746370494366, decouple_loss:0.00041907746344804764
loss_pred:0.016453173011541367, decouple_loss:0.0004276538093108684
The modified gen p mean: 0.44777199625968933, gen p mean: -0.13061581552028656, mean p set: 0.44834673404693604
loss_pred:0.01525319367647171, decouple_loss:0.0003706390270963311
Iteration: 2888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44675394892692566, gen p mean: -0.13321548700332642, mean p set: 0.4473278820514679
loss_pred:0.015741735696792603, decouple_loss:0.00037386728217825294
The modified gen p mean: 0.4469315707683563, gen p mean: -0.13500207662582397, mean p set: 0.44750818610191345
loss_pred:0.01532742939889431, decouple_loss:0.00048065040027722716
The modified gen p mean: 0.44643667340278625, gen p mean: -0.13455162942409515, mean p set: 0.44701069593429565
loss_pred:0.015596270561218262, decouple_loss:0.0004384628846310079
Iteration: 2889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476185739040375, gen p mean: -0.13050881028175354, mean p set: 0.4481962025165558
The modified gen p mean: 0.4477136731147766, gen p mean: -0.13299237191677094, mean p set: 0.44829070568084717
loss_pred:0.0160477627068758, decouple_loss:0.00044874826562590897
loss_pred:0.016427192836999893, decouple_loss:0.0006071404786780477
The modified gen p mean: 0.4470193684101105, gen p mean: -0.13512225449085236, mean p set: 0.4475935399532318
loss_pred:0.015472841449081898, decouple_loss:0.00044298070133663714
Iteration: 2890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478749930858612, gen p mean: -0.1293872445821762, mean p set: 0.4484526515007019
loss_pred:0.015596759505569935, decouple_loss:0.00039069479680620134
The modified gen p mean: 0.44788631796836853, gen p mean: -0.1266099512577057, mean p set: 0.4484597444534302
The modified gen p mean: 0.44685351848602295, gen p mean: -0.13077755272388458, mean p set: 0.44742879271507263
loss_pred:0.015534737147390842, decouple_loss:0.00035828526597470045
loss_pred:0.01653098315000534, decouple_loss:0.00038093439070507884
2023-05-02 14:34:44 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13583523035049438, mean p set: 0.4502691626548767
loss_pred:0.01687779650092125, decouple_loss:0.00041535074706189334
The modified gen p mean: 0.4495358467102051, gen p mean: -0.12916171550750732, mean p set: 0.4500633478164673
loss_pred:0.01614999771118164, decouple_loss:0.0004110152367502451
The modified gen p mean: 0.4498291015625, gen p mean: -0.12899701297283173, mean p set: 0.45035696029663086
loss_pred:0.016417738050222397, decouple_loss:0.0004498733615037054
WV_1_PC_1_EH_0_PS_40, loss: 0.016503114253282547, avg_mse: 0.02579071745276451
current test mse: 0.025791
Iteration: 2891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475286304950714, gen p mean: -0.12832051515579224, mean p set: 0.4481023848056793
loss_pred:0.016182249411940575, decouple_loss:0.00041933395550586283
The modified gen p mean: 0.4467789828777313, gen p mean: -0.12932446599006653, mean p set: 0.447354793548584
The modified gen p mean: 0.44619670510292053, gen p mean: -0.12667438387870789, mean p set: 0.4467698633670807
loss_pred:0.016380328685045242, decouple_loss:0.0005267390515655279
loss_pred:0.01596379466354847, decouple_loss:0.0005225570639595389
Iteration: 2892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881394505500793, gen p mean: -0.13570840656757355, mean p set: 0.44939130544662476
loss_pred:0.015179580077528954, decouple_loss:0.00039443126297555864
The modified gen p mean: 0.44714227318763733, gen p mean: -0.12937460839748383, mean p set: 0.44771823287010193The modified gen p mean: 0.4483528137207031, gen p mean: -0.13347403705120087, mean p set: 0.4489297568798065
loss_pred:0.016118459403514862, decouple_loss:0.00042235548608005047loss_pred:0.014842664822936058, decouple_loss:0.00040494996937923133
Iteration: 2893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476695954799652, gen p mean: -0.13260474801063538, mean p set: 0.44824421405792236
loss_pred:0.015726838260889053, decouple_loss:0.00036156593705527484
The modified gen p mean: 0.44636082649230957, gen p mean: -0.13344834744930267, mean p set: 0.44693848490715027
loss_pred:0.016152922064065933, decouple_loss:0.00032060948433354497
The modified gen p mean: 0.44805359840393066, gen p mean: -0.13500694930553436, mean p set: 0.44863173365592957
loss_pred:0.014920886605978012, decouple_loss:0.0003300505632068962
Iteration: 2894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779568910598755, gen p mean: -0.13903725147247314, mean p set: 0.44836893677711487
loss_pred:0.015334674157202244, decouple_loss:0.0004372404655441642
The modified gen p mean: 0.44883185625076294, gen p mean: -0.14201371371746063, mean p set: 0.44940972328186035
loss_pred:0.014675775542855263, decouple_loss:0.0004566988500300795
The modified gen p mean: 0.4481411874294281, gen p mean: -0.14199252426624298, mean p set: 0.448716402053833
loss_pred:0.01454719714820385, decouple_loss:0.0004300791770219803
Iteration: 2895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479186534881592, gen p mean: -0.13845734298229218, mean p set: 0.44849663972854614
loss_pred:0.0158491600304842, decouple_loss:0.0004230508056934923
The modified gen p mean: 0.4477140009403229, gen p mean: -0.14028877019882202, mean p set: 0.448288232088089
loss_pred:0.015101277269423008, decouple_loss:0.0004881088389083743
The modified gen p mean: 0.4470701217651367, gen p mean: -0.1365566849708557, mean p set: 0.4476478397846222
loss_pred:0.015332881361246109, decouple_loss:0.00032619471312500536
Iteration: 2896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660282135009766, gen p mean: -0.13327036798000336, mean p set: 0.44717973470687866
loss_pred:0.016250964254140854, decouple_loss:0.0005030120373703539
The modified gen p mean: 0.44811704754829407, gen p mean: -0.13285239040851593, mean p set: 0.4486939311027527
loss_pred:0.015394789166748524, decouple_loss:0.0004338611615821719
The modified gen p mean: 0.44775161147117615, gen p mean: -0.14509114623069763, mean p set: 0.4483281373977661
loss_pred:0.015770209953188896, decouple_loss:0.0004812458355445415
Iteration: 2897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732049107551575, gen p mean: -0.1396605521440506, mean p set: 0.44789600372314453
loss_pred:0.015717487782239914, decouple_loss:0.0004977989010512829
The modified gen p mean: 0.44801685214042664, gen p mean: -0.1374950110912323, mean p set: 0.44859179854393005
The modified gen p mean: 0.4470759630203247, gen p mean: -0.1369430124759674, mean p set: 0.447655588388443
loss_pred:0.014764736406505108, decouple_loss:0.0004083063395228237
loss_pred:0.015809599310159683, decouple_loss:0.0003246553533244878
Iteration: 2898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448930025100708, gen p mean: -0.13526798784732819, mean p set: 0.4495074450969696
The modified gen p mean: 0.44670945405960083, gen p mean: -0.14021286368370056, mean p set: 0.44728490710258484
loss_pred:0.015395632945001125, decouple_loss:0.00032918303622864187
loss_pred:0.0150271812453866, decouple_loss:0.0005334653542377055
The modified gen p mean: 0.446479856967926, gen p mean: -0.1347389668226242, mean p set: 0.4470527172088623
loss_pred:0.01668836548924446, decouple_loss:0.00032718523289076984
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
NaN value num: 0
Iteration: 2899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486268162727356, gen p mean: -0.12976092100143433, mean p set: 0.4492046535015106
loss_pred:0.015678562223911285, decouple_loss:0.00038229269557632506
The modified gen p mean: 0.45167258381843567, gen p mean: -0.12978670001029968, mean p set: 0.4522458016872406
The modified gen p mean: 0.45113062858581543, gen p mean: -0.13563139736652374, mean p set: 0.4517081081867218
loss_pred:0.016125159338116646, decouple_loss:0.0004277412954252213
loss_pred:0.01564786769449711, decouple_loss:0.0004248581826686859
Iteration: 2900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506785273551941, gen p mean: -0.13497880101203918, mean p set: 0.4512555003166199
loss_pred:0.016120608896017075, decouple_loss:0.0005774779128842056
The modified gen p mean: 0.4499897062778473, gen p mean: -0.13136279582977295, mean p set: 0.45056816935539246
loss_pred:0.015441996976733208, decouple_loss:0.0004239152476657182
The modified gen p mean: 0.4513360261917114, gen p mean: -0.13747313618659973, mean p set: 0.45191308856010437
loss_pred:0.014544992707669735, decouple_loss:0.0004360791062936187
2023-05-02 14:37:29 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.14603780210018158, mean p set: 0.4502691626548767
loss_pred:0.016787761822342873, decouple_loss:0.00040921574691310525
The modified gen p mean: 0.4495350122451782, gen p mean: -0.13945692777633667, mean p set: 0.4500633478164673
loss_pred:0.016152845695614815, decouple_loss:0.0004083029052708298
The modified gen p mean: 0.44982901215553284, gen p mean: -0.13909432291984558, mean p set: 0.45035696029663086
loss_pred:0.016399424523115158, decouple_loss:0.000470644241431728
WV_1_PC_1_EH_0_PS_40, loss: 0.016468148678541183, avg_mse: 0.025771116837859154
current test mse: 0.025771
Iteration: 2901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495965540409088, gen p mean: -0.14294493198394775, mean p set: 0.4501744508743286
loss_pred:0.015443356707692146, decouple_loss:0.0003571111592464149
The modified gen p mean: 0.45111802220344543, gen p mean: -0.1372092217206955, mean p set: 0.451697438955307The modified gen p mean: 0.45013365149497986, gen p mean: -0.13532079756259918, mean p set: 0.4507121443748474
loss_pred:0.01610247977077961, decouple_loss:0.00038867542752996087loss_pred:0.01469878014177084, decouple_loss:0.00032586161978542805
Iteration: 2902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969308376312256, gen p mean: -0.13957653939723969, mean p set: 0.45026880502700806
loss_pred:0.015026119537651539, decouple_loss:0.0006015790277160704
The modified gen p mean: 0.44988980889320374, gen p mean: -0.14162662625312805, mean p set: 0.4504671096801758The modified gen p mean: 0.45079970359802246, gen p mean: -0.1377953290939331, mean p set: 0.45137470960617065
loss_pred:0.015962155535817146, decouple_loss:0.0003810279886238277
loss_pred:0.016445746645331383, decouple_loss:0.0004219316761009395
Iteration: 2903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45020556449890137, gen p mean: -0.13543879985809326, mean p set: 0.4507836401462555
loss_pred:0.015496457926928997, decouple_loss:0.0004930482828058302
The modified gen p mean: 0.45276007056236267, gen p mean: -0.13759636878967285, mean p set: 0.45333564281463623
loss_pred:0.013945138081908226, decouple_loss:0.000655133742839098
The modified gen p mean: 0.4485645890235901, gen p mean: -0.13529962301254272, mean p set: 0.44914230704307556
loss_pred:0.01471318956464529, decouple_loss:0.0003972952254116535
Iteration: 2904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500761032104492, gen p mean: -0.13077795505523682, mean p set: 0.4506521224975586
loss_pred:0.014858640730381012, decouple_loss:0.00040640190127305686
The modified gen p mean: 0.44813108444213867, gen p mean: -0.13165351748466492, mean p set: 0.4487107992172241
loss_pred:0.015476666390895844, decouple_loss:0.00032877540797926486
The modified gen p mean: 0.45066654682159424, gen p mean: -0.13798324763774872, mean p set: 0.4512436091899872
loss_pred:0.015188938938081264, decouple_loss:0.0004432563728187233
Iteration: 2905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485998749732971, gen p mean: -0.13181887567043304, mean p set: 0.4491777718067169
loss_pred:0.015358928591012955, decouple_loss:0.0004867385723628104
The modified gen p mean: 0.44896015524864197, gen p mean: -0.1337922215461731, mean p set: 0.4495377540588379
loss_pred:0.014878226444125175, decouple_loss:0.0004389561072457582
The modified gen p mean: 0.45108628273010254, gen p mean: -0.1324414759874344, mean p set: 0.4516648054122925
loss_pred:0.014121371321380138, decouple_loss:0.0003196563629899174
Iteration: 2906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45084166526794434, gen p mean: -0.13664725422859192, mean p set: 0.4514155387878418
loss_pred:0.015252441167831421, decouple_loss:0.0004479234339669347
The modified gen p mean: 0.449666291475296, gen p mean: -0.13761967420578003, mean p set: 0.4502442479133606
loss_pred:0.015470515005290508, decouple_loss:0.0005046887672506273
The modified gen p mean: 0.44980359077453613, gen p mean: -0.1382257342338562, mean p set: 0.4503801465034485
loss_pred:0.015092958696186543, decouple_loss:0.00046701624523848295
Iteration: 2907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44998377561569214, gen p mean: -0.13165545463562012, mean p set: 0.45056024193763733
loss_pred:0.015412737615406513, decouple_loss:0.00036884527071379125
The modified gen p mean: 0.44794967770576477, gen p mean: -0.13062319159507751, mean p set: 0.44852298498153687
loss_pred:0.015253879129886627, decouple_loss:0.0004003352951258421
The modified gen p mean: 0.45007479190826416, gen p mean: -0.13621512055397034, mean p set: 0.4506514370441437
loss_pred:0.015232573263347149, decouple_loss:0.0003808896872214973
Iteration: 2908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128023624420166, gen p mean: -0.1296282559633255, mean p set: 0.4518575668334961
loss_pred:0.015520289540290833, decouple_loss:0.0004257586260791868
The modified gen p mean: 0.45065152645111084, gen p mean: -0.13084092736244202, mean p set: 0.45122823119163513
loss_pred:0.015979083254933357, decouple_loss:0.0003966022050008178
The modified gen p mean: 0.4526832401752472, gen p mean: -0.1334240436553955, mean p set: 0.45325756072998047
loss_pred:0.014456010423600674, decouple_loss:0.0005206295172683895
Iteration: 2909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492574632167816, gen p mean: -0.13291719555854797, mean p set: 0.44983211159706116
loss_pred:0.014662695117294788, decouple_loss:0.000343333842465654
The modified gen p mean: 0.44831225275993347, gen p mean: -0.13151167333126068, mean p set: 0.4488857686519623
loss_pred:0.015801850706338882, decouple_loss:0.0003023576573468745
The modified gen p mean: 0.44958898425102234, gen p mean: -0.1315462440252304, mean p set: 0.45016559958457947
loss_pred:0.014132732525467873, decouple_loss:0.0004409163084346801
Iteration: 2910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506436586380005, gen p mean: -0.13250945508480072, mean p set: 0.4512195587158203
loss_pred:0.015817120671272278, decouple_loss:0.0005045921425335109
The modified gen p mean: 0.44958269596099854, gen p mean: -0.12656068801879883, mean p set: 0.4501582682132721
loss_pred:0.014629513956606388, decouple_loss:0.0003443660098128021
The modified gen p mean: 0.4482388198375702, gen p mean: -0.13249194622039795, mean p set: 0.44881677627563477
loss_pred:0.015247642993927002, decouple_loss:0.00028964283410459757
2023-05-02 14:39:35 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.14005441963672638, mean p set: 0.4502691626548767
loss_pred:0.016841094940900803, decouple_loss:0.00038114507333375514
The modified gen p mean: 0.44953402876853943, gen p mean: -0.1337672472000122, mean p set: 0.4500633478164673
loss_pred:0.016129566356539726, decouple_loss:0.0004390419053379446
The modified gen p mean: 0.44983017444610596, gen p mean: -0.13385455310344696, mean p set: 0.45035696029663086
loss_pred:0.016404379159212112, decouple_loss:0.00047361376346088946
WV_1_PC_1_EH_0_PS_40, loss: 0.016479909420013428, avg_mse: 0.025765005499124527
current test mse: 0.025765
Iteration: 2911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513949751853943, gen p mean: -0.12956683337688446, mean p set: 0.45197030901908875
loss_pred:0.015190811827778816, decouple_loss:0.0003942778566852212
The modified gen p mean: 0.4493972957134247, gen p mean: -0.1251126080751419, mean p set: 0.4499705135822296
loss_pred:0.014458615332841873, decouple_loss:0.0003551009576767683
The modified gen p mean: 0.45185333490371704, gen p mean: -0.1274789273738861, mean p set: 0.45243194699287415
loss_pred:0.01578899845480919, decouple_loss:0.000395450770156458
Iteration: 2912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45075663924217224, gen p mean: -0.1289834976196289, mean p set: 0.451333224773407
loss_pred:0.014758983626961708, decouple_loss:0.0004330251831561327
The modified gen p mean: 0.4500606656074524, gen p mean: -0.13358892500400543, mean p set: 0.4506361782550812The modified gen p mean: 0.45173555612564087, gen p mean: -0.13202695548534393, mean p set: 0.4523109793663025
loss_pred:0.015231295488774776, decouple_loss:0.00039040500996634364
loss_pred:0.01564551517367363, decouple_loss:0.000561417662538588
Iteration: 2913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516567587852478, gen p mean: -0.1259108930826187, mean p set: 0.45222997665405273
loss_pred:0.015234146267175674, decouple_loss:0.0004944963729940355
The modified gen p mean: 0.45025473833084106, gen p mean: -0.12776540219783783, mean p set: 0.45083242654800415
loss_pred:0.015028838068246841, decouple_loss:0.00028607287094928324
The modified gen p mean: 0.4513222575187683, gen p mean: -0.1300819367170334, mean p set: 0.4518985152244568
loss_pred:0.014881393872201443, decouple_loss:0.00034083036007359624
Iteration: 2914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507746696472168, gen p mean: -0.11932861804962158, mean p set: 0.4513501822948456
loss_pred:0.0156547911465168, decouple_loss:0.00038975515053607523
The modified gen p mean: 0.4523446261882782, gen p mean: -0.12097113579511642, mean p set: 0.45292070508003235
loss_pred:0.01596052572131157, decouple_loss:0.0003437431005295366
The modified gen p mean: 0.451259046792984, gen p mean: -0.12279196828603745, mean p set: 0.4518345892429352
loss_pred:0.015195711515843868, decouple_loss:0.00031530618434771895
Iteration: 2915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45026370882987976, gen p mean: -0.12437999248504639, mean p set: 0.450838565826416
loss_pred:0.01582065224647522, decouple_loss:0.0005039903917349875
The modified gen p mean: 0.4508379399776459, gen p mean: -0.12555989623069763, mean p set: 0.45141419768333435
loss_pred:0.015336067415773869, decouple_loss:0.0006034119869582355
The modified gen p mean: 0.4525867700576782, gen p mean: -0.12835277616977692, mean p set: 0.4531644284725189
loss_pred:0.014501256868243217, decouple_loss:0.0004957166966050863
Iteration: 2916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44918203353881836, gen p mean: -0.12110733985900879, mean p set: 0.4497554302215576
loss_pred:0.014767168089747429, decouple_loss:0.0003669463039841503
The modified gen p mean: 0.45315128564834595, gen p mean: -0.12534093856811523, mean p set: 0.45372650027275085
loss_pred:0.013661734759807587, decouple_loss:0.0003054478147532791
The modified gen p mean: 0.4523997902870178, gen p mean: -0.1203569546341896, mean p set: 0.45297905802726746
loss_pred:0.01574551872909069, decouple_loss:0.0004344350309111178
Iteration: 2917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45142242312431335, gen p mean: -0.11900585144758224, mean p set: 0.4519991874694824
loss_pred:0.016136080026626587, decouple_loss:0.000400275137508288
The modified gen p mean: 0.45080921053886414, gen p mean: -0.1259084790945053, mean p set: 0.45138633251190186
loss_pred:0.01458042673766613, decouple_loss:0.0003591760469134897
The modified gen p mean: 0.4494698941707611, gen p mean: -0.12940801680088043, mean p set: 0.4500464200973511
loss_pred:0.015094414353370667, decouple_loss:0.0005116302636452019
Iteration: 2918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505554139614105, gen p mean: -0.11908122152090073, mean p set: 0.4511326253414154
loss_pred:0.01593107543885708, decouple_loss:0.00047311827074736357
The modified gen p mean: 0.450605571269989, gen p mean: -0.1207059696316719, mean p set: 0.45118266344070435
loss_pred:0.015240545384585857, decouple_loss:0.0005721101188100874
The modified gen p mean: 0.45237302780151367, gen p mean: -0.12259108573198318, mean p set: 0.4529488980770111
loss_pred:0.014607762917876244, decouple_loss:0.00033376453211531043
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 2919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479968845844269, gen p mean: -0.12689130008220673, mean p set: 0.44857192039489746The modified gen p mean: 0.4488128125667572, gen p mean: -0.1258675456047058, mean p set: 0.44938814640045166
loss_pred:0.015589139424264431, decouple_loss:0.0003288018924649805loss_pred:0.015563015826046467, decouple_loss:0.0003280770033597946
The modified gen p mean: 0.44786107540130615, gen p mean: -0.13027721643447876, mean p set: 0.4484356641769409
loss_pred:0.015180936083197594, decouple_loss:0.0005181749584153295
Iteration: 2920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481810927391052, gen p mean: -0.12654194235801697, mean p set: 0.4487583637237549
loss_pred:0.015262369997799397, decouple_loss:0.00034689673339016736
The modified gen p mean: 0.4483494460582733, gen p mean: -0.12925508618354797, mean p set: 0.4489271342754364
loss_pred:0.014673424884676933, decouple_loss:0.0003890968218911439
The modified gen p mean: 0.44731393456459045, gen p mean: -0.12854135036468506, mean p set: 0.4478871822357178
loss_pred:0.01570734567940235, decouple_loss:0.00047880993224680424
2023-05-02 14:42:25 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1357375830411911, mean p set: 0.4502691626548767
loss_pred:0.016744477674365044, decouple_loss:0.00045244331704452634
The modified gen p mean: 0.4495353400707245, gen p mean: -0.12920989096164703, mean p set: 0.4500633478164673
loss_pred:0.016055233776569366, decouple_loss:0.0004250388592481613
The modified gen p mean: 0.44983136653900146, gen p mean: -0.12907126545906067, mean p set: 0.45035696029663086
loss_pred:0.016390535980463028, decouple_loss:0.0003580414049793035
WV_1_PC_1_EH_0_PS_40, loss: 0.01641734130680561, avg_mse: 0.025641707703471184
current test mse: 0.025642
Iteration: 2921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466669261455536, gen p mean: -0.1312509924173355, mean p set: 0.44724538922309875
loss_pred:0.015566100366413593, decouple_loss:0.00041065190453082323
The modified gen p mean: 0.44705531001091003, gen p mean: -0.12785838544368744, mean p set: 0.4476318955421448
loss_pred:0.015637990087270737, decouple_loss:0.00039678841130807996
The modified gen p mean: 0.4469383955001831, gen p mean: -0.13584046065807343, mean p set: 0.4475124180316925
loss_pred:0.01521226391196251, decouple_loss:0.00036771991290152073
Iteration: 2922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480675458908081, gen p mean: -0.13200286030769348, mean p set: 0.44864511489868164
loss_pred:0.014756605960428715, decouple_loss:0.0005062871496193111
The modified gen p mean: 0.4478805661201477, gen p mean: -0.13016389310359955, mean p set: 0.44845762848854065The modified gen p mean: 0.44735923409461975, gen p mean: -0.1375160813331604, mean p set: 0.4479339122772217
loss_pred:0.014491835609078407, decouple_loss:0.0005686167860403657
loss_pred:0.015386541374027729, decouple_loss:0.0004766883794218302
Iteration: 2923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480206072330475, gen p mean: -0.1351376622915268, mean p set: 0.4485968351364136
loss_pred:0.01455451175570488, decouple_loss:0.00047437191824428737
The modified gen p mean: 0.44787153601646423, gen p mean: -0.12816764414310455, mean p set: 0.4484493136405945
loss_pred:0.014669523574411869, decouple_loss:0.0003845888131763786
The modified gen p mean: 0.4478221535682678, gen p mean: -0.13074027001857758, mean p set: 0.44839873909950256
loss_pred:0.015341700986027718, decouple_loss:0.0004493374435696751
Iteration: 2924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731566309928894, gen p mean: -0.12985531985759735, mean p set: 0.447892427444458
loss_pred:0.015381465665996075, decouple_loss:0.00037541738129220903
The modified gen p mean: 0.4471380114555359, gen p mean: -0.13720093667507172, mean p set: 0.447712779045105
loss_pred:0.01502911001443863, decouple_loss:0.00041564053390175104
The modified gen p mean: 0.4472378194332123, gen p mean: -0.1294620782136917, mean p set: 0.44781461358070374
loss_pred:0.015460673719644547, decouple_loss:0.0004080769722349942
Iteration: 2925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44865989685058594, gen p mean: -0.1338123083114624, mean p set: 0.4492388963699341
loss_pred:0.014887437224388123, decouple_loss:0.0004538689099717885
The modified gen p mean: 0.4481505751609802, gen p mean: -0.1303940713405609, mean p set: 0.44872552156448364
The modified gen p mean: 0.44775867462158203, gen p mean: -0.13313931226730347, mean p set: 0.448335200548172
loss_pred:0.015225655399262905, decouple_loss:0.00039111828664317727
loss_pred:0.014699785970151424, decouple_loss:0.00044224096927791834
Iteration: 2926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752684235572815, gen p mean: -0.138130322098732, mean p set: 0.44810402393341064
loss_pred:0.014616499654948711, decouple_loss:0.00040806079050526023
The modified gen p mean: 0.44774267077445984, gen p mean: -0.13826961815357208, mean p set: 0.44831880927085876
The modified gen p mean: 0.44800862669944763, gen p mean: -0.13773702085018158, mean p set: 0.44858577847480774
loss_pred:0.015529654920101166, decouple_loss:0.0005391250015236437
loss_pred:0.014955263584852219, decouple_loss:0.0006052067037671804
Iteration: 2927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477582275867462, gen p mean: -0.13236913084983826, mean p set: 0.4483359158039093
loss_pred:0.014881990849971771, decouple_loss:0.00042858917731791735
The modified gen p mean: 0.4479259252548218, gen p mean: -0.1345098465681076, mean p set: 0.44850432872772217
The modified gen p mean: 0.4478185176849365, gen p mean: -0.13711917400360107, mean p set: 0.4483935534954071
loss_pred:0.014663678593933582, decouple_loss:0.00040547276148572564
loss_pred:0.01469868142157793, decouple_loss:0.0004253105435054749
Iteration: 2928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462747275829315, gen p mean: -0.13477467000484467, mean p set: 0.44685330986976624
loss_pred:0.015020431019365788, decouple_loss:0.0003854186797980219
The modified gen p mean: 0.4476569592952728, gen p mean: -0.12896105647087097, mean p set: 0.44823122024536133
loss_pred:0.015224076807498932, decouple_loss:0.00036347948480397463
The modified gen p mean: 0.44776275753974915, gen p mean: -0.1347552388906479, mean p set: 0.4483374059200287
loss_pred:0.0147401737049222, decouple_loss:0.0004982558311894536
Iteration: 2929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486950933933258, gen p mean: -0.1323125958442688, mean p set: 0.4492678940296173
loss_pred:0.014470751397311687, decouple_loss:0.0004300370637793094
The modified gen p mean: 0.4468277394771576, gen p mean: -0.13276928663253784, mean p set: 0.44740280508995056
The modified gen p mean: 0.4476948082447052, gen p mean: -0.12944422662258148, mean p set: 0.4482678174972534
loss_pred:0.014726811088621616, decouple_loss:0.00042946726898662746
loss_pred:0.014911211095750332, decouple_loss:0.00038817134918645024
Iteration: 2930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792550802230835, gen p mean: -0.12735237181186676, mean p set: 0.4485013484954834
loss_pred:0.015213132835924625, decouple_loss:0.00038256897823885083
The modified gen p mean: 0.4475244879722595, gen p mean: -0.12983958423137665, mean p set: 0.4481017291545868
loss_pred:0.014510253444314003, decouple_loss:0.0003077113360632211
The modified gen p mean: 0.448110967874527, gen p mean: -0.128542959690094, mean p set: 0.4486865699291229
loss_pred:0.014840178191661835, decouple_loss:0.0003843096492346376
2023-05-02 14:44:32 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12919571995735168, mean p set: 0.4502691626548767
loss_pred:0.016754433512687683, decouple_loss:0.0007312055095098913
The modified gen p mean: 0.4495338499546051, gen p mean: -0.12309231609106064, mean p set: 0.4500633478164673
loss_pred:0.01605042815208435, decouple_loss:0.000564222049433738
The modified gen p mean: 0.44982725381851196, gen p mean: -0.12258562445640564, mean p set: 0.45035696029663086
loss_pred:0.016385963186621666, decouple_loss:0.0004755099362228066
WV_1_PC_1_EH_0_PS_40, loss: 0.016426458954811096, avg_mse: 0.025670675560832024
current test mse: 0.025671
Iteration: 2931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821202754974365, gen p mean: -0.12621551752090454, mean p set: 0.44878846406936646
loss_pred:0.014368001371622086, decouple_loss:0.00044424846419133246
The modified gen p mean: 0.4485383629798889, gen p mean: -0.12647639214992523, mean p set: 0.44911372661590576
loss_pred:0.014774054288864136, decouple_loss:0.00038857609615661204
The modified gen p mean: 0.4486278295516968, gen p mean: -0.12675853073596954, mean p set: 0.44920313358306885
loss_pred:0.014742393977940083, decouple_loss:0.0004836681473534554
Iteration: 2932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44607216119766235, gen p mean: -0.12687471508979797, mean p set: 0.44664737582206726
The modified gen p mean: 0.4474332332611084, gen p mean: -0.12624450027942657, mean p set: 0.44800689816474915
loss_pred:0.015197306871414185, decouple_loss:0.0004112601454835385
loss_pred:0.014844225719571114, decouple_loss:0.00037157570477575064
The modified gen p mean: 0.4484386742115021, gen p mean: -0.12468145787715912, mean p set: 0.4490111172199249
loss_pred:0.014454809948801994, decouple_loss:0.0005123986629769206
Iteration: 2933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806864857673645, gen p mean: -0.12596167623996735, mean p set: 0.44864311814308167
loss_pred:0.014796284027397633, decouple_loss:0.0005153756937943399
The modified gen p mean: 0.4464769661426544, gen p mean: -0.12925972044467926, mean p set: 0.4470512866973877The modified gen p mean: 0.4480275809764862, gen p mean: -0.12891848385334015, mean p set: 0.448603093624115
loss_pred:0.014917716383934021, decouple_loss:0.00036111046210862696
loss_pred:0.014971270225942135, decouple_loss:0.0005330614512786269
Iteration: 2934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822630286216736, gen p mean: -0.1286049783229828, mean p set: 0.4488029479980469
loss_pred:0.01449552271515131, decouple_loss:0.0003452061500865966
The modified gen p mean: 0.44773200154304504, gen p mean: -0.1259099394083023, mean p set: 0.44831034541130066
loss_pred:0.0152664165943861, decouple_loss:0.0003876280097756535
The modified gen p mean: 0.4487852156162262, gen p mean: -0.13133852183818817, mean p set: 0.44936102628707886
loss_pred:0.01421118900179863, decouple_loss:0.00039391539758071303
Iteration: 2935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726061820983887, gen p mean: -0.13225142657756805, mean p set: 0.4478394687175751
loss_pred:0.015379460528492928, decouple_loss:0.0003481767198536545
The modified gen p mean: 0.44791361689567566, gen p mean: -0.1286022812128067, mean p set: 0.44848933815956116
loss_pred:0.014496083371341228, decouple_loss:0.00036118642310611904
The modified gen p mean: 0.44771596789360046, gen p mean: -0.13193204998970032, mean p set: 0.4482938349246979
loss_pred:0.014747269451618195, decouple_loss:0.00041215994860976934
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814470410346985, gen p mean: -0.1319791078567505, mean p set: 0.44871973991394043
loss_pred:0.015069438144564629, decouple_loss:0.00037759492988698184
The modified gen p mean: 0.4469089210033417, gen p mean: -0.13355986773967743, mean p set: 0.44748347997665405
loss_pred:0.014766143634915352, decouple_loss:0.0003417759435251355
The modified gen p mean: 0.4473665952682495, gen p mean: -0.12562327086925507, mean p set: 0.4479440450668335
loss_pred:0.014932528138160706, decouple_loss:0.00034939171746373177
Iteration: 2937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477144181728363, gen p mean: -0.13045860826969147, mean p set: 0.44829073548316956
loss_pred:0.015201879665255547, decouple_loss:0.000369129644241184
The modified gen p mean: 0.4486933648586273, gen p mean: -0.1289239227771759, mean p set: 0.44927188754081726
loss_pred:0.014526206068694592, decouple_loss:0.0003034901455976069
The modified gen p mean: 0.447727233171463, gen p mean: -0.12631741166114807, mean p set: 0.4483031630516052
loss_pred:0.01521358173340559, decouple_loss:0.0003884623874910176
Iteration: 2938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811922311782837, gen p mean: -0.12543468177318573, mean p set: 0.44869464635849
loss_pred:0.014809616841375828, decouple_loss:0.0004268694028723985
The modified gen p mean: 0.4472058117389679, gen p mean: -0.13124822080135345, mean p set: 0.4477825164794922
loss_pred:0.015174596570432186, decouple_loss:0.00041311493259854615
The modified gen p mean: 0.44796478748321533, gen p mean: -0.12329831719398499, mean p set: 0.4485422670841217
loss_pred:0.014765605330467224, decouple_loss:0.00039051222847774625
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
NaN value num: 0
Iteration: 2939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45177510380744934, gen p mean: -0.12026285380125046, mean p set: 0.452349454164505
loss_pred:0.015122625976800919, decouple_loss:0.001197069650515914
The modified gen p mean: 0.4519330859184265, gen p mean: -0.11902984976768494, mean p set: 0.4525096118450165
loss_pred:0.015450031496584415, decouple_loss:0.0011161980219185352
The modified gen p mean: 0.4515908360481262, gen p mean: -0.12039005756378174, mean p set: 0.4521671235561371
loss_pred:0.015415444038808346, decouple_loss:0.001264861668460071
Iteration: 2940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524438679218292, gen p mean: -0.12076088041067123, mean p set: 0.4530230164527893
loss_pred:0.015082350932061672, decouple_loss:0.00045775421313010156
The modified gen p mean: 0.45140358805656433, gen p mean: -0.1214323341846466, mean p set: 0.4519789516925812
loss_pred:0.016169792041182518, decouple_loss:0.0010558721842244267
The modified gen p mean: 0.45244091749191284, gen p mean: -0.1166689544916153, mean p set: 0.45301321148872375
loss_pred:0.015888456255197525, decouple_loss:0.0005339494673535228
2023-05-02 14:47:16 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13178613781929016, mean p set: 0.4502691626548767
loss_pred:0.016734369099140167, decouple_loss:0.0005706287920475006
The modified gen p mean: 0.4495333433151245, gen p mean: -0.12506937980651855, mean p set: 0.4500633478164673
loss_pred:0.01602492481470108, decouple_loss:0.0006331793265417218
The modified gen p mean: 0.44982948899269104, gen p mean: -0.12446261942386627, mean p set: 0.45035696029663086
loss_pred:0.01641697809100151, decouple_loss:0.0007183800335042179
WV_1_PC_1_EH_0_PS_40, loss: 0.01642412692308426, avg_mse: 0.02564367838203907
current test mse: 0.025644
Iteration: 2941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498961865901947, gen p mean: -0.12355993688106537, mean p set: 0.45047152042388916
loss_pred:0.0145539166405797, decouple_loss:0.0007168125594034791
The modified gen p mean: 0.45174843072891235, gen p mean: -0.11669271439313889, mean p set: 0.4523266553878784The modified gen p mean: 0.4510868787765503, gen p mean: -0.1228441447019577, mean p set: 0.4516604542732239
loss_pred:0.015478764660656452, decouple_loss:0.0004152892797719687loss_pred:0.015233565121889114, decouple_loss:0.0005282805650494993
Iteration: 2942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516967236995697, gen p mean: -0.12415166199207306, mean p set: 0.45227286219596863
The modified gen p mean: 0.451421320438385, gen p mean: -0.11703626811504364, mean p set: 0.4519975483417511
loss_pred:0.015067057684063911, decouple_loss:0.0005136723630130291
loss_pred:0.014907247386872768, decouple_loss:0.0005577586707659066
The modified gen p mean: 0.45245125889778137, gen p mean: -0.12053808569908142, mean p set: 0.4530283212661743
loss_pred:0.015196243301033974, decouple_loss:0.0005759226041845977
Iteration: 2943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45115163922309875, gen p mean: -0.11891113966703415, mean p set: 0.45172688364982605
loss_pred:0.01602224074304104, decouple_loss:0.0005906591541133821
The modified gen p mean: 0.45186367630958557, gen p mean: -0.12209418416023254, mean p set: 0.4524403214454651
loss_pred:0.015453493222594261, decouple_loss:0.0004315774713177234
The modified gen p mean: 0.45099279284477234, gen p mean: -0.12024925649166107, mean p set: 0.4515700936317444
loss_pred:0.014927009120583534, decouple_loss:0.0005596802802756429
Iteration: 2944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526064693927765, gen p mean: -0.12032055854797363, mean p set: 0.45318397879600525
loss_pred:0.01533685065805912, decouple_loss:0.0003709051525220275
The modified gen p mean: 0.4488788843154907, gen p mean: -0.1161787137389183, mean p set: 0.44945603609085083
loss_pred:0.015067820437252522, decouple_loss:0.0006490187952294946
The modified gen p mean: 0.45133599638938904, gen p mean: -0.12222366780042648, mean p set: 0.4519124925136566
loss_pred:0.015924090519547462, decouple_loss:0.0004294636601116508
Iteration: 2945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451812207698822, gen p mean: -0.11975650489330292, mean p set: 0.452386736869812
loss_pred:0.015925707295536995, decouple_loss:0.0004168185987509787
The modified gen p mean: 0.45194295048713684, gen p mean: -0.12233370542526245, mean p set: 0.4525170624256134
loss_pred:0.015500801615417004, decouple_loss:0.0003607181424740702
The modified gen p mean: 0.4504433572292328, gen p mean: -0.1181153729557991, mean p set: 0.451017826795578
loss_pred:0.015045142732560635, decouple_loss:0.00048078049439936876
Iteration: 2946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45112496614456177, gen p mean: -0.12541940808296204, mean p set: 0.45170560479164124
loss_pred:0.014485075138509274, decouple_loss:0.0004913892480544746
The modified gen p mean: 0.4516022503376007, gen p mean: -0.1277233213186264, mean p set: 0.45217666029930115
The modified gen p mean: 0.45386579632759094, gen p mean: -0.11766236275434494, mean p set: 0.4544433653354645
loss_pred:0.015110698528587818, decouple_loss:0.0004662300634663552
loss_pred:0.015835627913475037, decouple_loss:0.00039768387796357274
Iteration: 2947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500846564769745, gen p mean: -0.12077705562114716, mean p set: 0.4506586492061615
loss_pred:0.014916225336492062, decouple_loss:0.00048815770423971117
The modified gen p mean: 0.44989076256752014, gen p mean: -0.1245473325252533, mean p set: 0.45046815276145935
loss_pred:0.01476219017058611, decouple_loss:0.0005402739043347538
The modified gen p mean: 0.45150142908096313, gen p mean: -0.12447420507669449, mean p set: 0.4520816504955292
loss_pred:0.015421729534864426, decouple_loss:0.0005727540701627731
Iteration: 2948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503119885921478, gen p mean: -0.13139551877975464, mean p set: 0.45088884234428406
loss_pred:0.016183260828256607, decouple_loss:0.0004493983869906515
The modified gen p mean: 0.45137742161750793, gen p mean: -0.12645436823368073, mean p set: 0.45195385813713074
loss_pred:0.01574353687465191, decouple_loss:0.000496055232360959
The modified gen p mean: 0.4529249668121338, gen p mean: -0.12813621759414673, mean p set: 0.45350101590156555
loss_pred:0.015422994270920753, decouple_loss:0.00042824234697036445
Iteration: 2949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506770670413971, gen p mean: -0.12688903510570526, mean p set: 0.4512523412704468
loss_pred:0.014989716000854969, decouple_loss:0.00045591354137286544
The modified gen p mean: 0.4495219886302948, gen p mean: -0.1266963928937912, mean p set: 0.4500984251499176
loss_pred:0.01490909606218338, decouple_loss:0.0005656626308336854
The modified gen p mean: 0.45156779885292053, gen p mean: -0.12909509241580963, mean p set: 0.4521442651748657
loss_pred:0.015056335367262363, decouple_loss:0.0004969886504113674
Iteration: 2950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45268863439559937, gen p mean: -0.1305166333913803, mean p set: 0.4532662332057953
loss_pred:0.015053038485348225, decouple_loss:0.0003996575833298266
The modified gen p mean: 0.45088866353034973, gen p mean: -0.13372258841991425, mean p set: 0.4514661431312561
loss_pred:0.015365628525614738, decouple_loss:0.00041941757081076503
The modified gen p mean: 0.4516449272632599, gen p mean: -0.1324475258588791, mean p set: 0.4522245526313782
loss_pred:0.015065265819430351, decouple_loss:0.00039802378159947693
2023-05-02 14:49:23 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.14345748722553253, mean p set: 0.4502691626548767
loss_pred:0.016789179295301437, decouple_loss:0.00046389104682020843
The modified gen p mean: 0.44953685998916626, gen p mean: -0.1373775452375412, mean p set: 0.4500633478164673
loss_pred:0.016184253618121147, decouple_loss:0.00043960477341897786
The modified gen p mean: 0.44982972741127014, gen p mean: -0.13660094141960144, mean p set: 0.45035696029663086
loss_pred:0.01652844436466694, decouple_loss:0.0004460667259991169
WV_1_PC_1_EH_0_PS_40, loss: 0.016523119062185287, avg_mse: 0.0258114505559206
current test mse: 0.025811
Iteration: 2951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45198866724967957, gen p mean: -0.130294069647789, mean p set: 0.4525661766529083
loss_pred:0.015612197108566761, decouple_loss:0.0005191070958971977
The modified gen p mean: 0.45127415657043457, gen p mean: -0.1400030106306076, mean p set: 0.4518510699272156
loss_pred:0.01570339873433113, decouple_loss:0.0003731668693944812
The modified gen p mean: 0.45274868607521057, gen p mean: -0.13541975617408752, mean p set: 0.4533267617225647
loss_pred:0.014730426482856274, decouple_loss:0.000393683003494516
Iteration: 2952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507324695587158, gen p mean: -0.13622575998306274, mean p set: 0.45130833983421326
The modified gen p mean: 0.45124199986457825, gen p mean: -0.13192659616470337, mean p set: 0.4518203139305115
loss_pred:0.015059147030115128, decouple_loss:0.00040517840534448624
loss_pred:0.01563793420791626, decouple_loss:0.0007204207358881831
The modified gen p mean: 0.4510398805141449, gen p mean: -0.13425953686237335, mean p set: 0.4516153931617737
loss_pred:0.015582233667373657, decouple_loss:0.00044355556019581854
Iteration: 2953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114657282829285, gen p mean: -0.1333240270614624, mean p set: 0.4517205059528351
loss_pred:0.015564421191811562, decouple_loss:0.0004445855738595128
The modified gen p mean: 0.45173466205596924, gen p mean: -0.13169966638088226, mean p set: 0.4523128271102905The modified gen p mean: 0.45071449875831604, gen p mean: -0.13396720588207245, mean p set: 0.4512908160686493
loss_pred:0.015739265829324722, decouple_loss:0.0004138265212532133
loss_pred:0.014615477062761784, decouple_loss:0.00031714540091343224
Iteration: 2954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44957301020622253, gen p mean: -0.12495747953653336, mean p set: 0.4501498341560364
loss_pred:0.014714007265865803, decouple_loss:0.0005600593867711723
The modified gen p mean: 0.4488421678543091, gen p mean: -0.12340906262397766, mean p set: 0.4494180977344513
loss_pred:0.014890611171722412, decouple_loss:0.0005376202752813697
The modified gen p mean: 0.453660786151886, gen p mean: -0.1265823394060135, mean p set: 0.4542403817176819
loss_pred:0.015246784314513206, decouple_loss:0.0004352327960077673
Iteration: 2955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121172070503235, gen p mean: -0.12879620492458344, mean p set: 0.4517892897129059
loss_pred:0.014884143136441708, decouple_loss:0.00047318520955741405
The modified gen p mean: 0.4508570730686188, gen p mean: -0.12718142569065094, mean p set: 0.45143604278564453
loss_pred:0.014822647906839848, decouple_loss:0.0003802910214290023
The modified gen p mean: 0.45048022270202637, gen p mean: -0.13520388305187225, mean p set: 0.4510558545589447
loss_pred:0.015980347990989685, decouple_loss:0.00040288170566782355
Iteration: 2956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451506108045578, gen p mean: -0.1319655478000641, mean p set: 0.4520820379257202
loss_pred:0.015631722286343575, decouple_loss:0.0004479500057641417
The modified gen p mean: 0.45006272196769714, gen p mean: -0.1277540624141693, mean p set: 0.4506395757198334
loss_pred:0.015293712727725506, decouple_loss:0.0004003424837719649
The modified gen p mean: 0.4532986283302307, gen p mean: -0.1288347840309143, mean p set: 0.4538784623146057
loss_pred:0.014594736509025097, decouple_loss:0.0003697385254781693
Iteration: 2957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505080282688141, gen p mean: -0.1293145716190338, mean p set: 0.4510838985443115
loss_pred:0.015756724402308464, decouple_loss:0.0005770800053142011
The modified gen p mean: 0.45163947343826294, gen p mean: -0.12937456369400024, mean p set: 0.4522160291671753
loss_pred:0.015459436923265457, decouple_loss:0.0005009719752706587
The modified gen p mean: 0.4517819583415985, gen p mean: -0.1312868744134903, mean p set: 0.4523616135120392
loss_pred:0.015361625701189041, decouple_loss:0.00035595116787590086
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
NaN value num: 0
Iteration: 2958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450090229511261, gen p mean: -0.12988825142383575, mean p set: 0.4506658911705017
loss_pred:0.014428400434553623, decouple_loss:0.000403153826482594
The modified gen p mean: 0.44864413142204285, gen p mean: -0.13156245648860931, mean p set: 0.4492228329181671
loss_pred:0.014797654002904892, decouple_loss:0.0003953012346755713
The modified gen p mean: 0.44925832748413086, gen p mean: -0.13044621050357819, mean p set: 0.44983452558517456
loss_pred:0.015083447098731995, decouple_loss:0.00038537001819349825
Iteration: 2959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977039098739624, gen p mean: -0.13221074640750885, mean p set: 0.45034751296043396
loss_pred:0.014992691576480865, decouple_loss:0.0003812700160779059
The modified gen p mean: 0.4503592252731323, gen p mean: -0.13128305971622467, mean p set: 0.45093539357185364
loss_pred:0.015305940061807632, decouple_loss:0.0004230854392517358
The modified gen p mean: 0.45079272985458374, gen p mean: -0.1290331780910492, mean p set: 0.45137009024620056
loss_pred:0.013530717231333256, decouple_loss:0.00038329133531078696
Iteration: 2960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480355381965637, gen p mean: -0.1334366500377655, mean p set: 0.44861045479774475
loss_pred:0.014770816080272198, decouple_loss:0.0005058819078840315
The modified gen p mean: 0.4503702223300934, gen p mean: -0.12889575958251953, mean p set: 0.4509481191635132
loss_pred:0.014694932848215103, decouple_loss:0.00039502509753219783
The modified gen p mean: 0.4501398205757141, gen p mean: -0.1268836110830307, mean p set: 0.4507155418395996
loss_pred:0.014123650267720222, decouple_loss:0.0003279819793533534
2023-05-02 14:52:07 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13907292485237122, mean p set: 0.4502691626548767
loss_pred:0.016817158088088036, decouple_loss:0.0005642981268465519
The modified gen p mean: 0.4495304226875305, gen p mean: -0.1327095627784729, mean p set: 0.4500633478164673
loss_pred:0.016193993389606476, decouple_loss:0.0005670803366228938
The modified gen p mean: 0.44983047246932983, gen p mean: -0.13225193321704865, mean p set: 0.45035696029663086
loss_pred:0.01654885895550251, decouple_loss:0.0005294945440255105
WV_1_PC_1_EH_0_PS_40, loss: 0.016547685489058495, avg_mse: 0.025785233825445175
current test mse: 0.025785
Iteration: 2961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484705924987793, gen p mean: -0.12547264993190765, mean p set: 0.44904738664627075
loss_pred:0.014561379328370094, decouple_loss:0.00043804297456517816
The modified gen p mean: 0.4492741823196411, gen p mean: -0.1286998838186264, mean p set: 0.44984734058380127The modified gen p mean: 0.44829443097114563, gen p mean: -0.12286166846752167, mean p set: 0.4488722085952759
loss_pred:0.014957097359001637, decouple_loss:0.0004295091493986547loss_pred:0.014906677417457104, decouple_loss:0.0005084132426418364
Iteration: 2962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486587345600128, gen p mean: -0.13020725548267365, mean p set: 0.4492338001728058
loss_pred:0.014470749534666538, decouple_loss:0.00040426364284940064
The modified gen p mean: 0.4489787817001343, gen p mean: -0.12151763588190079, mean p set: 0.44955530762672424
The modified gen p mean: 0.449241042137146, gen p mean: -0.12908868491649628, mean p set: 0.4498175084590912
loss_pred:0.014558344148099422, decouple_loss:0.00045740598579868674
loss_pred:0.01487556379288435, decouple_loss:0.0004581829998642206
Iteration: 2963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915780425071716, gen p mean: -0.12734642624855042, mean p set: 0.4497326612472534
loss_pred:0.015187613666057587, decouple_loss:0.0004279480199329555
The modified gen p mean: 0.44755953550338745, gen p mean: -0.12413592636585236, mean p set: 0.4481392800807953
loss_pred:0.014608006924390793, decouple_loss:0.000341609469614923
The modified gen p mean: 0.4496479630470276, gen p mean: -0.12870536744594574, mean p set: 0.450225830078125
loss_pred:0.015380765311419964, decouple_loss:0.00040642396197654307
Iteration: 2964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482959508895874, gen p mean: -0.12357103824615479, mean p set: 0.44887450337409973
loss_pred:0.013906876556575298, decouple_loss:0.00034150946885347366
The modified gen p mean: 0.45020806789398193, gen p mean: -0.1283731460571289, mean p set: 0.45078325271606445
loss_pred:0.014078045263886452, decouple_loss:0.0004133764305151999
The modified gen p mean: 0.4508628249168396, gen p mean: -0.12401749193668365, mean p set: 0.4514385461807251
loss_pred:0.014670062810182571, decouple_loss:0.00042361021041870117
Iteration: 2965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873425364494324, gen p mean: -0.1263112872838974, mean p set: 0.4493105113506317
loss_pred:0.014890218153595924, decouple_loss:0.0005950807826593518
The modified gen p mean: 0.44939306378364563, gen p mean: -0.12435586750507355, mean p set: 0.4499700367450714
loss_pred:0.01480494812130928, decouple_loss:0.00033252101275138557
The modified gen p mean: 0.4494166374206543, gen p mean: -0.12154534459114075, mean p set: 0.44999319314956665
loss_pred:0.014784874394536018, decouple_loss:0.0004335434059612453
Iteration: 2966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44850954413414, gen p mean: -0.1268746703863144, mean p set: 0.4490853548049927
loss_pred:0.014241274446249008, decouple_loss:0.0004181912518106401
The modified gen p mean: 0.44921210408210754, gen p mean: -0.1286868453025818, mean p set: 0.44978684186935425
loss_pred:0.014402114786207676, decouple_loss:0.00036686036037281156
The modified gen p mean: 0.44937172532081604, gen p mean: -0.12387127429246902, mean p set: 0.44994959235191345
loss_pred:0.0143556147813797, decouple_loss:0.00033250346314162016
Iteration: 2967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448415070772171, gen p mean: -0.12491157650947571, mean p set: 0.44899222254753113
loss_pred:0.013433597050607204, decouple_loss:0.00033487260225228965
The modified gen p mean: 0.4490852952003479, gen p mean: -0.12745098769664764, mean p set: 0.4496622681617737
loss_pred:0.014226567931473255, decouple_loss:0.0003389805497135967
The modified gen p mean: 0.4499080777168274, gen p mean: -0.12843289971351624, mean p set: 0.45048466324806213
loss_pred:0.013996236957609653, decouple_loss:0.00032709460356272757
Iteration: 2968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482719600200653, gen p mean: -0.12418226152658463, mean p set: 0.4488454759120941
loss_pred:0.014591624028980732, decouple_loss:0.0005072068888694048
The modified gen p mean: 0.4486868977546692, gen p mean: -0.1278611272573471, mean p set: 0.4492644667625427
loss_pred:0.014087256044149399, decouple_loss:0.00034700948162935674
The modified gen p mean: 0.4499637186527252, gen p mean: -0.12661655247211456, mean p set: 0.4505395293235779
loss_pred:0.01522801723331213, decouple_loss:0.0004627726739272475
Iteration: 2969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483209550380707, gen p mean: -0.12036187201738358, mean p set: 0.44889989495277405
loss_pred:0.014607316814363003, decouple_loss:0.0003369232581462711
The modified gen p mean: 0.45033061504364014, gen p mean: -0.12177341431379318, mean p set: 0.4509085714817047
The modified gen p mean: 0.4476965367794037, gen p mean: -0.12031033635139465, mean p set: 0.44827306270599365
loss_pred:0.014181344769895077, decouple_loss:0.0004262851143721491
loss_pred:0.014261475764214993, decouple_loss:0.0004493487940635532
Iteration: 2970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010000467300415, gen p mean: -0.12281757593154907, mean p set: 0.4506763517856598
loss_pred:0.014427090995013714, decouple_loss:0.0004392910632304847
The modified gen p mean: 0.4484540820121765, gen p mean: -0.12367791682481766, mean p set: 0.44903048872947693
loss_pred:0.014784843660891056, decouple_loss:0.0004213055071886629
The modified gen p mean: 0.4494134783744812, gen p mean: -0.12177050858736038, mean p set: 0.44999101758003235
loss_pred:0.014522272162139416, decouple_loss:0.000446970050688833
2023-05-02 14:54:13 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13050146400928497, mean p set: 0.4502691626548767
loss_pred:0.01678517833352089, decouple_loss:0.00040021794848144054
The modified gen p mean: 0.4495355486869812, gen p mean: -0.12430872768163681, mean p set: 0.4500633478164673
loss_pred:0.016231447458267212, decouple_loss:0.0003786828019656241
The modified gen p mean: 0.449828177690506, gen p mean: -0.12403475493192673, mean p set: 0.45035696029663086
loss_pred:0.016445543617010117, decouple_loss:0.0003744964487850666
WV_1_PC_1_EH_0_PS_40, loss: 0.016506612300872803, avg_mse: 0.025753365829586983
current test mse: 0.025753
Iteration: 2971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992595911026, gen p mean: -0.11948928982019424, mean p set: 0.4505022168159485
loss_pred:0.014371574856340885, decouple_loss:0.0002722607459872961
The modified gen p mean: 0.44856393337249756, gen p mean: -0.11766277253627777, mean p set: 0.4491414725780487The modified gen p mean: 0.4490039348602295, gen p mean: -0.11973890662193298, mean p set: 0.4495784640312195
loss_pred:0.014600643888115883, decouple_loss:0.0002811014710459858
loss_pred:0.01485507469624281, decouple_loss:0.00041253629024140537
Iteration: 2972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491717219352722, gen p mean: -0.11938314139842987, mean p set: 0.4497472941875458
The modified gen p mean: 0.4493589997291565, gen p mean: -0.11177331209182739, mean p set: 0.4499356150627136
loss_pred:0.014451979659497738, decouple_loss:0.0002926922170445323
loss_pred:0.014564375393092632, decouple_loss:0.00038045377004891634
The modified gen p mean: 0.44803154468536377, gen p mean: -0.1145237609744072, mean p set: 0.44860953092575073
loss_pred:0.014309155754745007, decouple_loss:0.0004165066929999739
Iteration: 2973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44863829016685486, gen p mean: -0.1130913719534874, mean p set: 0.44921573996543884
loss_pred:0.013696769252419472, decouple_loss:0.000396970339352265
The modified gen p mean: 0.4488832354545593, gen p mean: -0.11280342191457748, mean p set: 0.4494599997997284
loss_pred:0.01428630668669939, decouple_loss:0.0003388351178728044
The modified gen p mean: 0.4500681161880493, gen p mean: -0.11357443034648895, mean p set: 0.45064541697502136
loss_pred:0.014845632947981358, decouple_loss:0.00030703545780852437
Iteration: 2974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996216893196106, gen p mean: -0.11344486474990845, mean p set: 0.4505380690097809
loss_pred:0.014329229481518269, decouple_loss:0.0003612391010392457
The modified gen p mean: 0.4481884241104126, gen p mean: -0.11897923797369003, mean p set: 0.44876495003700256
loss_pred:0.014097788371145725, decouple_loss:0.0003823774168267846
The modified gen p mean: 0.45028814673423767, gen p mean: -0.1181173101067543, mean p set: 0.45086273550987244
loss_pred:0.014202680438756943, decouple_loss:0.00037219212390482426
Iteration: 2975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482472538948059, gen p mean: -0.1149197593331337, mean p set: 0.4488237500190735
loss_pred:0.014920278452336788, decouple_loss:0.0002727466926444322
The modified gen p mean: 0.44879236817359924, gen p mean: -0.11812735348939896, mean p set: 0.44936615228652954
loss_pred:0.014369464479386806, decouple_loss:0.0003015079128090292
The modified gen p mean: 0.4472291171550751, gen p mean: -0.11021698266267776, mean p set: 0.44780394434928894
loss_pred:0.014128526672720909, decouple_loss:0.00028507033130154014
Iteration: 2976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506388008594513, gen p mean: -0.11264456808567047, mean p set: 0.45121368765830994
loss_pred:0.013510589487850666, decouple_loss:0.0003752214543055743
The modified gen p mean: 0.4504055082798004, gen p mean: -0.11691179126501083, mean p set: 0.45098215341567993
loss_pred:0.01455814391374588, decouple_loss:0.00032550745527260005
The modified gen p mean: 0.45109352469444275, gen p mean: -0.11311344057321548, mean p set: 0.45167189836502075
loss_pred:0.013778779655694962, decouple_loss:0.00032983272103592753
Iteration: 2977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498928487300873, gen p mean: -0.11351434886455536, mean p set: 0.4504702091217041
loss_pred:0.014489246532320976, decouple_loss:0.0002948025066871196
The modified gen p mean: 0.45000579953193665, gen p mean: -0.1127576008439064, mean p set: 0.4505808651447296
loss_pred:0.014220311306416988, decouple_loss:0.00034729973413050175
The modified gen p mean: 0.44786694645881653, gen p mean: -0.11715054512023926, mean p set: 0.4484439492225647
loss_pred:0.014496187679469585, decouple_loss:0.00037564572994597256
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
NaN value num: 0
Iteration: 2978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44689488410949707, gen p mean: -0.11863981932401657, mean p set: 0.4474692642688751
loss_pred:0.016580287367105484, decouple_loss:0.00032603603904135525
The modified gen p mean: 0.4461979568004608, gen p mean: -0.12200389802455902, mean p set: 0.446774959564209
The modified gen p mean: 0.4462324380874634, gen p mean: -0.12740498781204224, mean p set: 0.4468069076538086
loss_pred:0.016211869195103645, decouple_loss:0.00043874033144675195
loss_pred:0.01523391343653202, decouple_loss:0.0003623953671194613
Iteration: 2979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466036260128021, gen p mean: -0.12536825239658356, mean p set: 0.44717806577682495
loss_pred:0.016268707811832428, decouple_loss:0.00037005022750236094
The modified gen p mean: 0.44797423481941223, gen p mean: -0.12584808468818665, mean p set: 0.4485495090484619
The modified gen p mean: 0.4475901126861572, gen p mean: -0.12337971478700638, mean p set: 0.44816598296165466
loss_pred:0.016290800645947456, decouple_loss:0.0004264986782800406
loss_pred:0.016679171472787857, decouple_loss:0.0003678346110973507
Iteration: 2980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786232709884644, gen p mean: -0.1210106685757637, mean p set: 0.44843971729278564
loss_pred:0.015597927384078503, decouple_loss:0.0003168412658851594
The modified gen p mean: 0.4475458264350891, gen p mean: -0.12897704541683197, mean p set: 0.4481232166290283
The modified gen p mean: 0.44840705394744873, gen p mean: -0.12416400015354156, mean p set: 0.4489823877811432
loss_pred:0.015350161120295525, decouple_loss:0.00033869038452394307
loss_pred:0.015720494091510773, decouple_loss:0.0004191674233879894
2023-05-02 14:56:56 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13066209852695465, mean p set: 0.4502691626548767
loss_pred:0.01668572425842285, decouple_loss:0.0005605131736956537
The modified gen p mean: 0.44953611493110657, gen p mean: -0.12430982291698456, mean p set: 0.4500633478164673
loss_pred:0.01606242172420025, decouple_loss:0.0004802122130058706
The modified gen p mean: 0.4498305916786194, gen p mean: -0.12395579367876053, mean p set: 0.45035696029663086
loss_pred:0.016353175044059753, decouple_loss:0.0004551898455247283
WV_1_PC_1_EH_0_PS_40, loss: 0.016392039135098457, avg_mse: 0.025601470842957497
current test mse: 0.025601
Iteration: 2981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781404733657837, gen p mean: -0.1256684958934784, mean p set: 0.448391854763031
The modified gen p mean: 0.44736576080322266, gen p mean: -0.12878547608852386, mean p set: 0.4479442238807678
loss_pred:0.01594221033155918, decouple_loss:0.0003400997375138104
loss_pred:0.015646718442440033, decouple_loss:0.0003824247105512768
The modified gen p mean: 0.44650280475616455, gen p mean: -0.12889957427978516, mean p set: 0.4470786452293396
loss_pred:0.0159357488155365, decouple_loss:0.00047623334103263915
Iteration: 2982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464136064052582, gen p mean: -0.1284923553466797, mean p set: 0.4469875395298004
The modified gen p mean: 0.4490024149417877, gen p mean: -0.12861086428165436, mean p set: 0.4495777189731598
loss_pred:0.016000472009181976, decouple_loss:0.0004633574571926147
loss_pred:0.015868155285716057, decouple_loss:0.00034633150789886713
The modified gen p mean: 0.44783124327659607, gen p mean: -0.12306114286184311, mean p set: 0.4484054148197174
loss_pred:0.016175029799342155, decouple_loss:0.00034140783827751875
Iteration: 2983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498290419578552, gen p mean: -0.1271999031305313, mean p set: 0.45040658116340637
loss_pred:0.015095473267138004, decouple_loss:0.0004447187529876828
The modified gen p mean: 0.4467552602291107, gen p mean: -0.12509950995445251, mean p set: 0.4473304748535156
loss_pred:0.015754641965031624, decouple_loss:0.00037301392876543105
The modified gen p mean: 0.4474964141845703, gen p mean: -0.1254127323627472, mean p set: 0.4480714499950409
loss_pred:0.015501824207603931, decouple_loss:0.0004258507105987519
Iteration: 2984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720470905303955, gen p mean: -0.1288331001996994, mean p set: 0.44778236746788025
loss_pred:0.015836071223020554, decouple_loss:0.00036845944123342633
The modified gen p mean: 0.4491692781448364, gen p mean: -0.12791763246059418, mean p set: 0.44974398612976074
loss_pred:0.015031124465167522, decouple_loss:0.00047029045526869595
The modified gen p mean: 0.44748014211654663, gen p mean: -0.1331489384174347, mean p set: 0.44805458188056946
loss_pred:0.014726187102496624, decouple_loss:0.0003567346720956266
Iteration: 2985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696712493896484, gen p mean: -0.13080301880836487, mean p set: 0.44754326343536377
loss_pred:0.015888752415776253, decouple_loss:0.00036033234209753573
The modified gen p mean: 0.4478034973144531, gen p mean: -0.13058587908744812, mean p set: 0.44837686419487
loss_pred:0.016014916822314262, decouple_loss:0.0002943075669463724
The modified gen p mean: 0.4473147988319397, gen p mean: -0.12877677381038666, mean p set: 0.4478928744792938
loss_pred:0.016590245068073273, decouple_loss:0.0002898945240303874
Iteration: 2986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476839303970337, gen p mean: -0.13225466012954712, mean p set: 0.4482615292072296
loss_pred:0.01583128236234188, decouple_loss:0.00039802768151275814
The modified gen p mean: 0.4466797411441803, gen p mean: -0.13617172837257385, mean p set: 0.4472576081752777
loss_pred:0.015190842561423779, decouple_loss:0.0003848846536129713
The modified gen p mean: 0.44678062200546265, gen p mean: -0.13907276093959808, mean p set: 0.4473590552806854
loss_pred:0.015201924368739128, decouple_loss:0.00044136674841865897
Iteration: 2987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688329100608826, gen p mean: -0.13608068227767944, mean p set: 0.4474595785140991
loss_pred:0.015022844076156616, decouple_loss:0.00030747370328754187
The modified gen p mean: 0.4464568793773651, gen p mean: -0.13172148168087006, mean p set: 0.4470323920249939
loss_pred:0.015932269394397736, decouple_loss:0.0002930486516561359
The modified gen p mean: 0.44856351613998413, gen p mean: -0.13318976759910583, mean p set: 0.44914042949676514
loss_pred:0.01600477285683155, decouple_loss:0.0002921083359979093
Iteration: 2988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487699568271637, gen p mean: -0.13310803472995758, mean p set: 0.44934606552124023
loss_pred:0.015785638242959976, decouple_loss:0.00036847186856903136
The modified gen p mean: 0.4462203085422516, gen p mean: -0.13492803275585175, mean p set: 0.4467964172363281
loss_pred:0.01529140118509531, decouple_loss:0.0003923672193195671
The modified gen p mean: 0.44761422276496887, gen p mean: -0.1356118619441986, mean p set: 0.44819125533103943
loss_pred:0.014716300182044506, decouple_loss:0.0003027650236617774
Iteration: 2989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741636514663696, gen p mean: -0.13347601890563965, mean p set: 0.447992742061615
loss_pred:0.01612032949924469, decouple_loss:0.0004109129367861897
The modified gen p mean: 0.44728904962539673, gen p mean: -0.12901993095874786, mean p set: 0.44786348938941956
loss_pred:0.015360698103904724, decouple_loss:0.000327626068610698
The modified gen p mean: 0.4468592405319214, gen p mean: -0.12895987927913666, mean p set: 0.44743403792381287
loss_pred:0.016205159947276115, decouple_loss:0.00033946314943023026
Iteration: 2990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717368483543396, gen p mean: -0.13063719868659973, mean p set: 0.4477509558200836
loss_pred:0.016508614644408226, decouple_loss:0.00038981399848125875
The modified gen p mean: 0.4478378891944885, gen p mean: -0.12493299692869186, mean p set: 0.44841399788856506
loss_pred:0.0159605760127306, decouple_loss:0.00034712490742094815
The modified gen p mean: 0.4476630389690399, gen p mean: -0.12894698977470398, mean p set: 0.4482417702674866
loss_pred:0.015517724677920341, decouple_loss:0.00030774978222325444
2023-05-02 14:59:03 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13342924416065216, mean p set: 0.4502691626548767
loss_pred:0.016735412180423737, decouple_loss:0.000408310181228444
The modified gen p mean: 0.44953492283821106, gen p mean: -0.12711496651172638, mean p set: 0.4500633478164673
loss_pred:0.016124676913022995, decouple_loss:0.00040976027958095074
The modified gen p mean: 0.449828177690506, gen p mean: -0.12669385969638824, mean p set: 0.45035696029663086
loss_pred:0.01640332117676735, decouple_loss:0.0003712372272275388
WV_1_PC_1_EH_0_PS_40, loss: 0.01644095778465271, avg_mse: 0.025678150355815887
current test mse: 0.025678
Iteration: 2991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44652000069618225, gen p mean: -0.12848642468452454, mean p set: 0.44709256291389465
loss_pred:0.01572488620877266, decouple_loss:0.0002981061697937548
The modified gen p mean: 0.4471319019794464, gen p mean: -0.13239333033561707, mean p set: 0.44770732522010803
loss_pred:0.014930685982108116, decouple_loss:0.00030461145797744393
The modified gen p mean: 0.4477103650569916, gen p mean: -0.12579098343849182, mean p set: 0.4482884109020233
loss_pred:0.015079397708177567, decouple_loss:0.0002940900740213692
Iteration: 2992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468572735786438, gen p mean: -0.1285209357738495, mean p set: 0.4474305510520935
The modified gen p mean: 0.44754356145858765, gen p mean: -0.12601521611213684, mean p set: 0.448116660118103
loss_pred:0.01595393382012844, decouple_loss:0.00035898893838748336
loss_pred:0.01667119562625885, decouple_loss:0.0003304399433545768
The modified gen p mean: 0.4468710720539093, gen p mean: -0.12692108750343323, mean p set: 0.44745010137557983
loss_pred:0.016360651701688766, decouple_loss:0.00034509095712564886
Iteration: 2993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44675084948539734, gen p mean: -0.13002020120620728, mean p set: 0.44732505083084106
The modified gen p mean: 0.44652509689331055, gen p mean: -0.13454002141952515, mean p set: 0.447104811668396
loss_pred:0.015511532314121723, decouple_loss:0.0003354770306032151
loss_pred:0.014765343628823757, decouple_loss:0.00037751079071313143
The modified gen p mean: 0.44678470492362976, gen p mean: -0.13050925731658936, mean p set: 0.4473554790019989
loss_pred:0.015213266015052795, decouple_loss:0.0003982940106652677
Iteration: 2994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473998546600342, gen p mean: -0.12663955986499786, mean p set: 0.4479750096797943
loss_pred:0.016279103234410286, decouple_loss:0.0003247864078730345
The modified gen p mean: 0.4478514492511749, gen p mean: -0.1321873813867569, mean p set: 0.4484272003173828
loss_pred:0.015757190063595772, decouple_loss:0.0003503237385302782
The modified gen p mean: 0.4462549388408661, gen p mean: -0.1299637258052826, mean p set: 0.44682982563972473
loss_pred:0.014536486938595772, decouple_loss:0.00035180506529286504
Iteration: 2995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852927327156067, gen p mean: -0.12884089350700378, mean p set: 0.44910722970962524
loss_pred:0.01539662480354309, decouple_loss:0.00045346832484938204
The modified gen p mean: 0.44850507378578186, gen p mean: -0.12468577176332474, mean p set: 0.44908249378204346
loss_pred:0.015319242142140865, decouple_loss:0.0003512485418468714
The modified gen p mean: 0.447935551404953, gen p mean: -0.12982314825057983, mean p set: 0.4485093653202057
loss_pred:0.016148190945386887, decouple_loss:0.0003366273595020175
Iteration: 2996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448493629693985, gen p mean: -0.12883839011192322, mean p set: 0.44907209277153015
loss_pred:0.015881933271884918, decouple_loss:0.0004749832150992006
The modified gen p mean: 0.44681107997894287, gen p mean: -0.13118192553520203, mean p set: 0.447386234998703
The modified gen p mean: 0.44788044691085815, gen p mean: -0.1287364661693573, mean p set: 0.4484540522098541
loss_pred:0.015132036991417408, decouple_loss:0.000472068611998111
loss_pred:0.015184301882982254, decouple_loss:0.0004029282717965543
Iteration: 2997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478011727333069, gen p mean: -0.128414124250412, mean p set: 0.4483780562877655
loss_pred:0.015148812904953957, decouple_loss:0.00037366952165029943
The modified gen p mean: 0.44944247603416443, gen p mean: -0.12948545813560486, mean p set: 0.4500185549259186
The modified gen p mean: 0.44753772020339966, gen p mean: -0.12615689635276794, mean p set: 0.44811463356018066
loss_pred:0.015272306278347969, decouple_loss:0.00042835812200792134
loss_pred:0.016297364607453346, decouple_loss:0.00045656217844225466
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 2998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489005506038666, gen p mean: -0.13274911046028137, mean p set: 0.4494735598564148
loss_pred:0.015094000846147537, decouple_loss:0.0003473398683127016
The modified gen p mean: 0.4486875534057617, gen p mean: -0.13130706548690796, mean p set: 0.4492647647857666
The modified gen p mean: 0.4493234157562256, gen p mean: -0.13492758572101593, mean p set: 0.4498986005783081
loss_pred:0.014763077720999718, decouple_loss:0.00039718401967547834
loss_pred:0.01548287458717823, decouple_loss:0.0004266694886609912
Iteration: 2999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930151104927063, gen p mean: -0.1353723555803299, mean p set: 0.4498789310455322
loss_pred:0.015175795182585716, decouple_loss:0.0002989029453601688
The modified gen p mean: 0.44920065999031067, gen p mean: -0.13147199153900146, mean p set: 0.4497752785682678
The modified gen p mean: 0.44852685928344727, gen p mean: -0.1315244436264038, mean p set: 0.4491029977798462
loss_pred:0.014528719708323479, decouple_loss:0.0004177818482276052
loss_pred:0.015175512991845608, decouple_loss:0.00035799856414087117
Iteration: 3000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906291365623474, gen p mean: -0.13099633157253265, mean p set: 0.4496401250362396
loss_pred:0.015386953949928284, decouple_loss:0.0005270894034765661
The modified gen p mean: 0.4483172595500946, gen p mean: -0.133860245347023, mean p set: 0.4488937258720398
The modified gen p mean: 0.44886645674705505, gen p mean: -0.1302809715270996, mean p set: 0.4494384229183197
loss_pred:0.015661614015698433, decouple_loss:0.00043435991392470896
loss_pred:0.014313528314232826, decouple_loss:0.0005280676414258778
2023-05-02 15:01:53 itr: 3000
training loss: [0.01433993 0.01541331 0.01568333]
2023-05-02 15:01:53 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13686472177505493, mean p set: 0.4502691626548767
loss_pred:0.01669164188206196, decouple_loss:0.0004740920849144459
The modified gen p mean: 0.449535071849823, gen p mean: -0.13059356808662415, mean p set: 0.4500633478164673
loss_pred:0.016154618933796883, decouple_loss:0.00044140274985693395
The modified gen p mean: 0.4498269557952881, gen p mean: -0.1301211565732956, mean p set: 0.45035696029663086
loss_pred:0.01636836864054203, decouple_loss:0.0005259428871795535
WV_1_PC_1_EH_0_PS_40, loss: 0.016428900882601738, avg_mse: 0.02568546123802662
current test mse: 0.025685
Iteration: 3001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810450077056885, gen p mean: -0.13568687438964844, mean p set: 0.4486761689186096
loss_pred:0.015105271711945534, decouple_loss:0.00041831342969089746
The modified gen p mean: 0.44895899295806885, gen p mean: -0.13542866706848145, mean p set: 0.4495360851287842The modified gen p mean: 0.44883275032043457, gen p mean: -0.13449493050575256, mean p set: 0.4494089186191559
loss_pred:0.015143182128667831, decouple_loss:0.00037812915979884565
loss_pred:0.014815879054367542, decouple_loss:0.0004170222964603454
Iteration: 3002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44898778200149536, gen p mean: -0.13294707238674164, mean p set: 0.44956550002098083
loss_pred:0.015163751319050789, decouple_loss:0.0004125216801185161
The modified gen p mean: 0.44876545667648315, gen p mean: -0.13133567571640015, mean p set: 0.44934189319610596The modified gen p mean: 0.44928228855133057, gen p mean: -0.13655328750610352, mean p set: 0.4498598277568817
loss_pred:0.015004775486886501, decouple_loss:0.00045116085675545037loss_pred:0.014775421470403671, decouple_loss:0.0004845494986511767
Iteration: 3003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488530457019806, gen p mean: -0.13329358398914337, mean p set: 0.44942986965179443
loss_pred:0.014876868575811386, decouple_loss:0.0003674853651318699
The modified gen p mean: 0.4484429359436035, gen p mean: -0.1265508234500885, mean p set: 0.44901883602142334
loss_pred:0.014233472757041454, decouple_loss:0.0004930431023240089
The modified gen p mean: 0.4493856430053711, gen p mean: -0.1299355924129486, mean p set: 0.4499637186527252
loss_pred:0.014679931104183197, decouple_loss:0.0004515268374234438
Iteration: 3004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482875168323517, gen p mean: -0.12871700525283813, mean p set: 0.4488653242588043
loss_pred:0.015109721571207047, decouple_loss:0.00041968567529693246
The modified gen p mean: 0.44769665598869324, gen p mean: -0.12490609288215637, mean p set: 0.4482733905315399
loss_pred:0.015087787993252277, decouple_loss:0.0003766423324123025
The modified gen p mean: 0.44772449135780334, gen p mean: -0.12659788131713867, mean p set: 0.4483001232147217
loss_pred:0.015066900290548801, decouple_loss:0.0004577519721351564
Iteration: 3005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481852650642395, gen p mean: -0.12297431379556656, mean p set: 0.4487597644329071
loss_pred:0.014984650537371635, decouple_loss:0.00042127614142373204
The modified gen p mean: 0.44784530997276306, gen p mean: -0.12059882283210754, mean p set: 0.4484219551086426
loss_pred:0.014723232947289944, decouple_loss:0.00040546373929828405
The modified gen p mean: 0.44829559326171875, gen p mean: -0.1279187649488449, mean p set: 0.4488733410835266
loss_pred:0.015047750435769558, decouple_loss:0.0004906635731458664
Iteration: 3006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906046986579895, gen p mean: -0.13398683071136475, mean p set: 0.4496367573738098
loss_pred:0.014648865908384323, decouple_loss:0.0003497282159514725
The modified gen p mean: 0.4485420882701874, gen p mean: -0.12660329043865204, mean p set: 0.44911903142929077
loss_pred:0.01472305878996849, decouple_loss:0.00031714365468360484
The modified gen p mean: 0.4477302134037018, gen p mean: -0.12101651728153229, mean p set: 0.44830653071403503
loss_pred:0.014462538063526154, decouple_loss:0.00041980057721957564
Iteration: 3007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480653405189514, gen p mean: -0.12408487498760223, mean p set: 0.4486406445503235
loss_pred:0.015332077629864216, decouple_loss:0.00035390816628932953
The modified gen p mean: 0.4474245011806488, gen p mean: -0.13435348868370056, mean p set: 0.4480001628398895
loss_pred:0.015331455506384373, decouple_loss:0.0004352560208644718
The modified gen p mean: 0.44906166195869446, gen p mean: -0.1324417144060135, mean p set: 0.4496358335018158
loss_pred:0.014960845932364464, decouple_loss:0.0005750521086156368
Iteration: 3008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744420051574707, gen p mean: -0.13703329861164093, mean p set: 0.4480241537094116
loss_pred:0.015302297659218311, decouple_loss:0.0005342960357666016
The modified gen p mean: 0.44901829957962036, gen p mean: -0.13493551313877106, mean p set: 0.4495936930179596
The modified gen p mean: 0.4478800594806671, gen p mean: -0.13442957401275635, mean p set: 0.44845834374427795
loss_pred:0.014552710577845573, decouple_loss:0.0005270576220937073
loss_pred:0.014518369920551777, decouple_loss:0.0004659313999582082
Iteration: 3009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448591023683548, gen p mean: -0.128150075674057, mean p set: 0.4491669833660126
loss_pred:0.014605329371988773, decouple_loss:0.0005186860216781497
The modified gen p mean: 0.44935277104377747, gen p mean: -0.13599693775177002, mean p set: 0.449928879737854
loss_pred:0.014867332763969898, decouple_loss:0.000392787012970075
The modified gen p mean: 0.44928833842277527, gen p mean: -0.13872402906417847, mean p set: 0.4498666524887085
loss_pred:0.015028862282633781, decouple_loss:0.0002871348988264799
Iteration: 3010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474523961544037, gen p mean: -0.12425339221954346, mean p set: 0.4480302929878235
loss_pred:0.015127580612897873, decouple_loss:0.0004895124584436417
The modified gen p mean: 0.4480379521846771, gen p mean: -0.13460952043533325, mean p set: 0.44861117005348206
loss_pred:0.015422279946506023, decouple_loss:0.0003254899347666651
The modified gen p mean: 0.44872432947158813, gen p mean: -0.1351562738418579, mean p set: 0.4493010640144348
loss_pred:0.014879211783409119, decouple_loss:0.0003470353549346328
2023-05-02 15:04:00 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13459211587905884, mean p set: 0.4502691626548767
loss_pred:0.01670459285378456, decouple_loss:0.0003897515998687595
The modified gen p mean: 0.4495340883731842, gen p mean: -0.12808704376220703, mean p set: 0.4500633478164673
loss_pred:0.016061780974268913, decouple_loss:0.000391344161471352
The modified gen p mean: 0.4498274028301239, gen p mean: -0.1272101253271103, mean p set: 0.45035696029663086
loss_pred:0.016390850767493248, decouple_loss:0.0003956597065553069
WV_1_PC_1_EH_0_PS_40, loss: 0.01640535518527031, avg_mse: 0.025688258931040764
current test mse: 0.025688
Iteration: 3011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787558913230896, gen p mean: -0.12570704519748688, mean p set: 0.4484536051750183
loss_pred:0.015342703089118004, decouple_loss:0.00041311129461973906
The modified gen p mean: 0.4480988383293152, gen p mean: -0.12732063233852386, mean p set: 0.4486786425113678
loss_pred:0.015501526184380054, decouple_loss:0.0005465617869049311
The modified gen p mean: 0.448943167924881, gen p mean: -0.13283465802669525, mean p set: 0.44951972365379333
loss_pred:0.014506923966109753, decouple_loss:0.0003670158621389419
Iteration: 3012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486023485660553, gen p mean: -0.1305968314409256, mean p set: 0.44917774200439453
The modified gen p mean: 0.4488734006881714, gen p mean: -0.12981852889060974, mean p set: 0.4494534134864807
loss_pred:0.015273205004632473, decouple_loss:0.0004118660290259868
loss_pred:0.014429645612835884, decouple_loss:0.00046603119699284434
The modified gen p mean: 0.44893863797187805, gen p mean: -0.12662184238433838, mean p set: 0.44951876997947693
loss_pred:0.014774798415601254, decouple_loss:0.0004208462778478861
Iteration: 3013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44878989458084106, gen p mean: -0.1290767341852188, mean p set: 0.4493670165538788
loss_pred:0.0144016919657588, decouple_loss:0.0003861325094476342
The modified gen p mean: 0.44915059208869934, gen p mean: -0.12875336408615112, mean p set: 0.44972550868988037The modified gen p mean: 0.4484669864177704, gen p mean: -0.13416965305805206, mean p set: 0.4490435719490051
loss_pred:0.014704150147736073, decouple_loss:0.00032860992359928787
loss_pred:0.014734545722603798, decouple_loss:0.00035867319093085825
Iteration: 3014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480001926422119, gen p mean: -0.1325870156288147, mean p set: 0.448577344417572
loss_pred:0.014761839061975479, decouple_loss:0.00032625411404296756
The modified gen p mean: 0.44803497195243835, gen p mean: -0.1255134642124176, mean p set: 0.4486114978790283
loss_pred:0.015289971604943275, decouple_loss:0.00046418170677497983
The modified gen p mean: 0.44836097955703735, gen p mean: -0.1286047101020813, mean p set: 0.4489397704601288
loss_pred:0.014344582334160805, decouple_loss:0.0003191557480022311
Iteration: 3015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477941393852234, gen p mean: -0.1266535371541977, mean p set: 0.44836896657943726
loss_pred:0.015283565036952496, decouple_loss:0.00042365724220871925
The modified gen p mean: 0.448858380317688, gen p mean: -0.13182774186134338, mean p set: 0.4494372606277466
loss_pred:0.014374190010130405, decouple_loss:0.00031681807013228536
The modified gen p mean: 0.44867458939552307, gen p mean: -0.12868022918701172, mean p set: 0.44925159215927124
loss_pred:0.014688967727124691, decouple_loss:0.0003655803739093244
Iteration: 3016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494304955005646, gen p mean: -0.13641996681690216, mean p set: 0.4500062167644501
loss_pred:0.014659645967185497, decouple_loss:0.00032602460123598576
The modified gen p mean: 0.4484274089336395, gen p mean: -0.1243969276547432, mean p set: 0.4490050673484802
loss_pred:0.0151944849640131, decouple_loss:0.000328867114149034
The modified gen p mean: 0.4488978385925293, gen p mean: -0.12671571969985962, mean p set: 0.44947290420532227
loss_pred:0.014414017088711262, decouple_loss:0.00037587995757348835
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948041439056396, gen p mean: -0.13017651438713074, mean p set: 0.45005539059638977
loss_pred:0.014382810331881046, decouple_loss:0.00033046529279090464
The modified gen p mean: 0.4479140639305115, gen p mean: -0.12274844944477081, mean p set: 0.448492169380188
loss_pred:0.015099014155566692, decouple_loss:0.0003125392540823668
The modified gen p mean: 0.4493807256221771, gen p mean: -0.1269085854291916, mean p set: 0.4499538242816925
loss_pred:0.014655373990535736, decouple_loss:0.00046656272024847567
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 3018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469654858112335, gen p mean: -0.12717880308628082, mean p set: 0.44753846526145935
loss_pred:0.014176594093441963, decouple_loss:0.00045450980542227626
The modified gen p mean: 0.4469507038593292, gen p mean: -0.1287865936756134, mean p set: 0.44752633571624756
loss_pred:0.013448700308799744, decouple_loss:0.00038368336390703917
The modified gen p mean: 0.4473101794719696, gen p mean: -0.1254962533712387, mean p set: 0.4478890001773834
loss_pred:0.014145474880933762, decouple_loss:0.0006058701546862721
Iteration: 3019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477342963218689, gen p mean: -0.12019529193639755, mean p set: 0.4483111500740051
loss_pred:0.01424157153815031, decouple_loss:0.0007110731094144285
The modified gen p mean: 0.4475616216659546, gen p mean: -0.12656977772712708, mean p set: 0.4481384754180908
loss_pred:0.013388792984187603, decouple_loss:0.00040080281905829906
The modified gen p mean: 0.4487333595752716, gen p mean: -0.1311565637588501, mean p set: 0.4493098258972168
loss_pred:0.013565029948949814, decouple_loss:0.00042230094550177455
Iteration: 3020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491371214389801, gen p mean: -0.1317780613899231, mean p set: 0.4497106075286865
loss_pred:0.013852041214704514, decouple_loss:0.0005634347908198833
The modified gen p mean: 0.4471665024757385, gen p mean: -0.12969164550304413, mean p set: 0.4477404057979584
loss_pred:0.014023424126207829, decouple_loss:0.00044659076957032084
The modified gen p mean: 0.44608640670776367, gen p mean: -0.12754163146018982, mean p set: 0.4466628134250641
loss_pred:0.014369495213031769, decouple_loss:0.00031015320564620197
2023-05-02 15:06:47 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1337936371564865, mean p set: 0.4502691626548767
loss_pred:0.01674402691423893, decouple_loss:0.00039131217636168003
The modified gen p mean: 0.4495355784893036, gen p mean: -0.12716178596019745, mean p set: 0.4500633478164673
loss_pred:0.016035571694374084, decouple_loss:0.00044844060903415084
The modified gen p mean: 0.4498295783996582, gen p mean: -0.12603919208049774, mean p set: 0.45035696029663086
loss_pred:0.016345830634236336, decouple_loss:0.00044517384958453476
WV_1_PC_1_EH_0_PS_40, loss: 0.01639655977487564, avg_mse: 0.02569873444736004
current test mse: 0.025699
Iteration: 3021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474166929721832, gen p mean: -0.1310928761959076, mean p set: 0.44798991084098816
loss_pred:0.01331897173076868, decouple_loss:0.00029621037538163364
The modified gen p mean: 0.44779905676841736, gen p mean: -0.13168078660964966, mean p set: 0.4483746588230133The modified gen p mean: 0.4491920471191406, gen p mean: -0.125828355550766, mean p set: 0.44976967573165894
loss_pred:0.014063620939850807, decouple_loss:0.0005377118941396475loss_pred:0.013622010126709938, decouple_loss:0.0005445109563879669
Iteration: 3022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721099734306335, gen p mean: -0.13207247853279114, mean p set: 0.4477921724319458
The modified gen p mean: 0.45009809732437134, gen p mean: -0.12295261770486832, mean p set: 0.4506722390651703
loss_pred:0.013937397859990597, decouple_loss:0.00040667876601219177
loss_pred:0.013655466958880424, decouple_loss:0.0003440184227656573
The modified gen p mean: 0.44814324378967285, gen p mean: -0.1316363662481308, mean p set: 0.4487197697162628
loss_pred:0.01412277389317751, decouple_loss:0.00036616914439946413
Iteration: 3023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706791639328003, gen p mean: -0.12937435507774353, mean p set: 0.4476434886455536
loss_pred:0.013684666715562344, decouple_loss:0.00043168439879082143
The modified gen p mean: 0.44756361842155457, gen p mean: -0.12968629598617554, mean p set: 0.4481406807899475
loss_pred:0.01382320187985897, decouple_loss:0.0005923292483203113
The modified gen p mean: 0.44850289821624756, gen p mean: -0.12816587090492249, mean p set: 0.449078768491745
loss_pred:0.01374061405658722, decouple_loss:0.00040453378460370004
Iteration: 3024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476642310619354, gen p mean: -0.12368053942918777, mean p set: 0.44823670387268066
loss_pred:0.013761862181127071, decouple_loss:0.00042155597475357354
The modified gen p mean: 0.4486716687679291, gen p mean: -0.12534253299236298, mean p set: 0.44924619793891907
loss_pred:0.013668395578861237, decouple_loss:0.0003271109308116138
The modified gen p mean: 0.449104905128479, gen p mean: -0.12743887305259705, mean p set: 0.4496791362762451
loss_pred:0.013819258660078049, decouple_loss:0.0004267105832695961
Iteration: 3025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818124175071716, gen p mean: -0.13153746724128723, mean p set: 0.4487580358982086
loss_pred:0.01301927026361227, decouple_loss:0.00041831276030279696
The modified gen p mean: 0.44724956154823303, gen p mean: -0.12099326401948929, mean p set: 0.44782590866088867
loss_pred:0.01403041835874319, decouple_loss:0.0004057820187881589
The modified gen p mean: 0.4463061988353729, gen p mean: -0.12678484618663788, mean p set: 0.4468816816806793
loss_pred:0.01435891818255186, decouple_loss:0.0004846436786465347
Iteration: 3026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879859685897827, gen p mean: -0.12571421265602112, mean p set: 0.4493766129016876
loss_pred:0.013632683083415031, decouple_loss:0.00040462909964844584
The modified gen p mean: 0.4471818506717682, gen p mean: -0.12681514024734497, mean p set: 0.447760671377182
The modified gen p mean: 0.4492325484752655, gen p mean: -0.12479449063539505, mean p set: 0.4498105049133301
loss_pred:0.013925890438258648, decouple_loss:0.00045325097744353116
loss_pred:0.01410680077970028, decouple_loss:0.0005157302948646247
Iteration: 3027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727209210395813, gen p mean: -0.12270417809486389, mean p set: 0.44784975051879883
loss_pred:0.013216009363532066, decouple_loss:0.00046290928730741143
The modified gen p mean: 0.4483180046081543, gen p mean: -0.12571951746940613, mean p set: 0.4488963484764099
loss_pred:0.013715855777263641, decouple_loss:0.0003965924843214452
The modified gen p mean: 0.4473924934864044, gen p mean: -0.1315660923719406, mean p set: 0.4479677379131317
loss_pred:0.013439586386084557, decouple_loss:0.0004190615436527878
Iteration: 3028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44805794954299927, gen p mean: -0.13143663108348846, mean p set: 0.44863414764404297
loss_pred:0.013388619758188725, decouple_loss:0.00038309060619212687
The modified gen p mean: 0.44866928458213806, gen p mean: -0.12924213707447052, mean p set: 0.44924888014793396
loss_pred:0.013501091860234737, decouple_loss:0.000367947417544201
The modified gen p mean: 0.4468348026275635, gen p mean: -0.1301242560148239, mean p set: 0.44741132855415344
loss_pred:0.014340159483253956, decouple_loss:0.0005167935159988701
Iteration: 3029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784411787986755, gen p mean: -0.122478187084198, mean p set: 0.44841745495796204
loss_pred:0.013342665508389473, decouple_loss:0.0003613546141423285
The modified gen p mean: 0.44784659147262573, gen p mean: -0.12828131020069122, mean p set: 0.44842419028282166
loss_pred:0.013653445057570934, decouple_loss:0.00031028801458887756
The modified gen p mean: 0.44709935784339905, gen p mean: -0.13230985403060913, mean p set: 0.4476757347583771
loss_pred:0.013808777555823326, decouple_loss:0.0004018941253889352
Iteration: 3030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44636082649230957, gen p mean: -0.12899059057235718, mean p set: 0.4469376802444458
loss_pred:0.014005615375936031, decouple_loss:0.0004450375563465059
The modified gen p mean: 0.4480900168418884, gen p mean: -0.13009171187877655, mean p set: 0.44866541028022766
loss_pred:0.013809522613883018, decouple_loss:0.0005339742638170719
The modified gen p mean: 0.4465169906616211, gen p mean: -0.13270464539527893, mean p set: 0.44709157943725586
loss_pred:0.0138821667060256, decouple_loss:0.0003649246646091342
2023-05-02 15:08:54 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13667596876621246, mean p set: 0.4502691626548767
loss_pred:0.016789492219686508, decouple_loss:0.0003633274754974991
The modified gen p mean: 0.4495370388031006, gen p mean: -0.13019949197769165, mean p set: 0.4500633478164673
loss_pred:0.016107331961393356, decouple_loss:0.00036803781404159963
The modified gen p mean: 0.4498298764228821, gen p mean: -0.12923824787139893, mean p set: 0.45035696029663086
loss_pred:0.016458621248602867, decouple_loss:0.00033612753031775355
WV_1_PC_1_EH_0_PS_40, loss: 0.016469605267047882, avg_mse: 0.02580850012600422
current test mse: 0.025808
Iteration: 3031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482097327709198, gen p mean: -0.1333373486995697, mean p set: 0.44878509640693665
loss_pred:0.013855861499905586, decouple_loss:0.0004803962947335094
The modified gen p mean: 0.44927793741226196, gen p mean: -0.1284567266702652, mean p set: 0.44985491037368774The modified gen p mean: 0.44592413306236267, gen p mean: -0.12838198244571686, mean p set: 0.4464992880821228
loss_pred:0.013646167702972889, decouple_loss:0.00035514720366336405
loss_pred:0.014054842293262482, decouple_loss:0.00040200541843660176
Iteration: 3032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467769265174866, gen p mean: -0.13503101468086243, mean p set: 0.4473493695259094
loss_pred:0.013929764740169048, decouple_loss:0.00034902174957096577
The modified gen p mean: 0.44862180948257446, gen p mean: -0.13608475029468536, mean p set: 0.4491964280605316The modified gen p mean: 0.447933167219162, gen p mean: -0.13253040611743927, mean p set: 0.4485096037387848
loss_pred:0.01342496182769537, decouple_loss:0.0003867014602292329
loss_pred:0.013888170942664146, decouple_loss:0.0005544726154766977
Iteration: 3033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877883791923523, gen p mean: -0.13675297796726227, mean p set: 0.4493577182292938
loss_pred:0.01320786401629448, decouple_loss:0.0003954762651119381
The modified gen p mean: 0.44962331652641296, gen p mean: -0.13093219697475433, mean p set: 0.45020049810409546
loss_pred:0.013372676447033882, decouple_loss:0.0003025747719220817
The modified gen p mean: 0.44848498702049255, gen p mean: -0.1276823729276657, mean p set: 0.44906049966812134
loss_pred:0.013520569540560246, decouple_loss:0.0003866559127345681
Iteration: 3034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481368064880371, gen p mean: -0.13560855388641357, mean p set: 0.4487130343914032
loss_pred:0.013699375092983246, decouple_loss:0.00033661877387203276
The modified gen p mean: 0.44891002774238586, gen p mean: -0.12633934617042542, mean p set: 0.44948315620422363
loss_pred:0.01372663863003254, decouple_loss:0.00034684513229876757
The modified gen p mean: 0.4499416649341583, gen p mean: -0.12880359590053558, mean p set: 0.4505167305469513
loss_pred:0.014009609818458557, decouple_loss:0.0003118214081041515
Iteration: 3035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44912150502204895, gen p mean: -0.12573376297950745, mean p set: 0.44969815015792847
loss_pred:0.01369725726544857, decouple_loss:0.00032052831375040114
The modified gen p mean: 0.4482227861881256, gen p mean: -0.1319853812456131, mean p set: 0.44880014657974243
loss_pred:0.013071940280497074, decouple_loss:0.000334794691298157
The modified gen p mean: 0.44893038272857666, gen p mean: -0.12635022401809692, mean p set: 0.44950512051582336
loss_pred:0.013345783576369286, decouple_loss:0.0002778373600449413
Iteration: 3036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468350410461426, gen p mean: -0.13028545677661896, mean p set: 0.44741183519363403
loss_pred:0.013731710612773895, decouple_loss:0.00042010366450995207
The modified gen p mean: 0.44875550270080566, gen p mean: -0.12448623031377792, mean p set: 0.4493320882320404
loss_pred:0.013635938987135887, decouple_loss:0.00044012314174324274
The modified gen p mean: 0.4472891390323639, gen p mean: -0.12911269068717957, mean p set: 0.44786572456359863
loss_pred:0.01352191623300314, decouple_loss:0.00032803270732983947
Iteration: 3037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478081166744232, gen p mean: -0.11696894466876984, mean p set: 0.44838523864746094
loss_pred:0.014237869530916214, decouple_loss:0.0003322426928207278
The modified gen p mean: 0.449003666639328, gen p mean: -0.12078020721673965, mean p set: 0.4495809078216553
loss_pred:0.01354166865348816, decouple_loss:0.0004549110308289528
The modified gen p mean: 0.44691771268844604, gen p mean: -0.12422652542591095, mean p set: 0.44749414920806885
loss_pred:0.013962899334728718, decouple_loss:0.0005097658722661436
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
NaN value num: 0
Iteration: 3038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494745433330536, gen p mean: -0.12820939719676971, mean p set: 0.4500530958175659
The modified gen p mean: 0.4491453766822815, gen p mean: -0.1278417855501175, mean p set: 0.4497237801551819loss_pred:0.013719906099140644, decouple_loss:0.00027799210511147976
loss_pred:0.015364016406238079, decouple_loss:0.0003617322654463351
The modified gen p mean: 0.448072224855423, gen p mean: -0.12280227243900299, mean p set: 0.4486483037471771
loss_pred:0.015863662585616112, decouple_loss:0.00039154820842668414
Iteration: 3039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491773545742035, gen p mean: -0.12934783101081848, mean p set: 0.449752539396286
loss_pred:0.014178870245814323, decouple_loss:0.0004041094798594713
The modified gen p mean: 0.4490012228488922, gen p mean: -0.13033002614974976, mean p set: 0.44957417249679565
The modified gen p mean: 0.44410592317581177, gen p mean: -0.12863470613956451, mean p set: 0.44467902183532715
loss_pred:0.013839656487107277, decouple_loss:0.00030515907565131783
loss_pred:0.015614336356520653, decouple_loss:0.00030751750455237925
Iteration: 3040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471985995769501, gen p mean: -0.12540371716022491, mean p set: 0.4477749764919281
The modified gen p mean: 0.4463948905467987, gen p mean: -0.13039478659629822, mean p set: 0.4469718039035797
loss_pred:0.01627577282488346, decouple_loss:0.0003014662943314761
loss_pred:0.015042459592223167, decouple_loss:0.0003240306687075645
The modified gen p mean: 0.44517022371292114, gen p mean: -0.13038550317287445, mean p set: 0.4457470774650574
loss_pred:0.014966235496103764, decouple_loss:0.0003754168574232608
2023-05-02 15:11:38 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12944383919239044, mean p set: 0.4502691626548767
loss_pred:0.016735857352614403, decouple_loss:0.0003302384284324944
The modified gen p mean: 0.44953179359436035, gen p mean: -0.12288852781057358, mean p set: 0.4500633478164673
loss_pred:0.01601545140147209, decouple_loss:0.00033414969220757484
The modified gen p mean: 0.4498245120048523, gen p mean: -0.1220446303486824, mean p set: 0.45035696029663086
loss_pred:0.01637050323188305, decouple_loss:0.0003346273151692003
WV_1_PC_1_EH_0_PS_40, loss: 0.016390588134527206, avg_mse: 0.025660065934062004
current test mse: 0.02566
Iteration: 3041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44966477155685425, gen p mean: -0.12401077151298523, mean p set: 0.4502406716346741
loss_pred:0.014079133048653603, decouple_loss:0.00033545016776770353
The modified gen p mean: 0.44646474719047546, gen p mean: -0.12472878396511078, mean p set: 0.4470408260822296The modified gen p mean: 0.44826841354370117, gen p mean: -0.1297190636396408, mean p set: 0.4488413631916046
loss_pred:0.014969977550208569, decouple_loss:0.00037822057493031025loss_pred:0.015182281844317913, decouple_loss:0.0003508979280013591
Iteration: 3042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783857464790344, gen p mean: -0.12294956296682358, mean p set: 0.44841283559799194
loss_pred:0.015266614966094494, decouple_loss:0.00031168857822194695
The modified gen p mean: 0.44465476274490356, gen p mean: -0.12862877547740936, mean p set: 0.4452323615550995The modified gen p mean: 0.447127103805542, gen p mean: -0.1254119873046875, mean p set: 0.44770243763923645
loss_pred:0.014941520988941193, decouple_loss:0.0002970117493532598
loss_pred:0.01535218209028244, decouple_loss:0.00032845386886037886
Iteration: 3043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758152961730957, gen p mean: -0.1254337579011917, mean p set: 0.44815483689308167
loss_pred:0.015802083536982536, decouple_loss:0.00033978759893216193
The modified gen p mean: 0.44720566272735596, gen p mean: -0.12231650203466415, mean p set: 0.4477825164794922The modified gen p mean: 0.44629064202308655, gen p mean: -0.12865440547466278, mean p set: 0.4468673765659332
loss_pred:0.014778039418160915, decouple_loss:0.0003683011163957417
loss_pred:0.015367495827376842, decouple_loss:0.0003669960133265704
Iteration: 3044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466116726398468, gen p mean: -0.13554245233535767, mean p set: 0.44718730449676514
loss_pred:0.0150556406006217, decouple_loss:0.00048649031668901443
The modified gen p mean: 0.44675499200820923, gen p mean: -0.12638403475284576, mean p set: 0.4473304748535156
loss_pred:0.015626847743988037, decouple_loss:0.00032584284781478345
The modified gen p mean: 0.4475746154785156, gen p mean: -0.12520204484462738, mean p set: 0.4481523334980011
loss_pred:0.014846712350845337, decouple_loss:0.00026521377731114626
Iteration: 3045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479283094406128, gen p mean: -0.12547270953655243, mean p set: 0.4485023021697998
loss_pred:0.01610678806900978, decouple_loss:0.00036909247864969075
The modified gen p mean: 0.44806915521621704, gen p mean: -0.12862570583820343, mean p set: 0.4486467242240906
loss_pred:0.014927655458450317, decouple_loss:0.0003364980802871287
The modified gen p mean: 0.44570106267929077, gen p mean: -0.12915661931037903, mean p set: 0.4462781846523285
loss_pred:0.01606394723057747, decouple_loss:0.0003175296005792916
Iteration: 3046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854286313056946, gen p mean: -0.13059328496456146, mean p set: 0.44912174344062805
loss_pred:0.014940610155463219, decouple_loss:0.0003492248652037233
The modified gen p mean: 0.4467010796070099, gen p mean: -0.12936164438724518, mean p set: 0.447277694940567
loss_pred:0.016064079478383064, decouple_loss:0.00044395451550371945
The modified gen p mean: 0.4502941370010376, gen p mean: -0.13204635679721832, mean p set: 0.450869619846344
loss_pred:0.013744981959462166, decouple_loss:0.0002874575147870928
Iteration: 3047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44585034251213074, gen p mean: -0.13696372509002686, mean p set: 0.44642698764801025
loss_pred:0.015032087452709675, decouple_loss:0.00037540605990216136
The modified gen p mean: 0.44820570945739746, gen p mean: -0.13677871227264404, mean p set: 0.4487829804420471
loss_pred:0.0148920938372612, decouple_loss:0.00044363620691001415
The modified gen p mean: 0.44570767879486084, gen p mean: -0.13167710602283478, mean p set: 0.44628193974494934
loss_pred:0.014978675171732903, decouple_loss:0.00043054422712884843
Iteration: 3048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821619987487793, gen p mean: -0.13285225629806519, mean p set: 0.4487939476966858
loss_pred:0.01524033397436142, decouple_loss:0.00047458327026106417
The modified gen p mean: 0.44790658354759216, gen p mean: -0.12792645394802094, mean p set: 0.4484868049621582
loss_pred:0.01594790816307068, decouple_loss:0.00041499146027490497
The modified gen p mean: 0.4451994299888611, gen p mean: -0.13437728583812714, mean p set: 0.44577544927597046
loss_pred:0.014916801825165749, decouple_loss:0.00039585758349858224
Iteration: 3049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708481431007385, gen p mean: -0.13414524495601654, mean p set: 0.4476630687713623
loss_pred:0.014882678166031837, decouple_loss:0.00034265100839547813
The modified gen p mean: 0.4457368850708008, gen p mean: -0.13271363079547882, mean p set: 0.4463125169277191
loss_pred:0.015456297434866428, decouple_loss:0.00033041497226804495
The modified gen p mean: 0.44686639308929443, gen p mean: -0.13243237137794495, mean p set: 0.4474453032016754
loss_pred:0.015275262296199799, decouple_loss:0.0003391396312508732
Iteration: 3050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44577866792678833, gen p mean: -0.12585629522800446, mean p set: 0.44635626673698425
loss_pred:0.014881457202136517, decouple_loss:0.0003559949982445687
The modified gen p mean: 0.44505271315574646, gen p mean: -0.12980827689170837, mean p set: 0.4456256330013275
loss_pred:0.015337408520281315, decouple_loss:0.0003577015013433993
The modified gen p mean: 0.44804006814956665, gen p mean: -0.12057388573884964, mean p set: 0.4486178159713745
loss_pred:0.01558611262589693, decouple_loss:0.00034332385985180736
2023-05-02 15:13:44 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12820664048194885, mean p set: 0.4502691626548767
loss_pred:0.01684665121138096, decouple_loss:0.00036349066067487
The modified gen p mean: 0.449532687664032, gen p mean: -0.12218442559242249, mean p set: 0.4500633478164673
loss_pred:0.01612100936472416, decouple_loss:0.00035751188988797367
The modified gen p mean: 0.4498283565044403, gen p mean: -0.12153862416744232, mean p set: 0.45035696029663086
loss_pred:0.016380183398723602, decouple_loss:0.0003751977055799216
WV_1_PC_1_EH_0_PS_40, loss: 0.01646755263209343, avg_mse: 0.02578526921570301
current test mse: 0.025785
Iteration: 3051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743624329566956, gen p mean: -0.12545941770076752, mean p set: 0.4480111598968506
loss_pred:0.015345331281423569, decouple_loss:0.0003715328930411488
The modified gen p mean: 0.4475417137145996, gen p mean: -0.12115171551704407, mean p set: 0.44811511039733887The modified gen p mean: 0.4469723701477051, gen p mean: -0.12739136815071106, mean p set: 0.4475480318069458
loss_pred:0.015379178337752819, decouple_loss:0.0003448587085586041loss_pred:0.015473706647753716, decouple_loss:0.0003669351863209158
Iteration: 3052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692885875701904, gen p mean: -0.127553790807724, mean p set: 0.44750338792800903
loss_pred:0.014906720258295536, decouple_loss:0.00033954487298615277
The modified gen p mean: 0.4460213780403137, gen p mean: -0.1271221935749054, mean p set: 0.44659915566444397
The modified gen p mean: 0.44654297828674316, gen p mean: -0.13072408735752106, mean p set: 0.44711804389953613
loss_pred:0.015228468924760818, decouple_loss:0.000384267361368984
loss_pred:0.015330824069678783, decouple_loss:0.00031393568497151136
Iteration: 3053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844162464141846, gen p mean: -0.12109170854091644, mean p set: 0.4490150213241577
loss_pred:0.01596217416226864, decouple_loss:0.00035243574529886246
The modified gen p mean: 0.4467023015022278, gen p mean: -0.12617823481559753, mean p set: 0.44727998971939087
loss_pred:0.015171496197581291, decouple_loss:0.00031499325996264815
The modified gen p mean: 0.4460143446922302, gen p mean: -0.12528830766677856, mean p set: 0.44658976793289185
loss_pred:0.015167135745286942, decouple_loss:0.000377979944460094
Iteration: 3054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475416839122772, gen p mean: -0.13141514360904694, mean p set: 0.4481199383735657
loss_pred:0.014976575039327145, decouple_loss:0.0003222590312361717
The modified gen p mean: 0.4478122591972351, gen p mean: -0.1211748793721199, mean p set: 0.4483906924724579
loss_pred:0.015191259793937206, decouple_loss:0.00035131987533532083
The modified gen p mean: 0.4464575946331024, gen p mean: -0.12932418286800385, mean p set: 0.4470330774784088
loss_pred:0.014448621310293674, decouple_loss:0.00031652514007873833
Iteration: 3055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44530466198921204, gen p mean: -0.13208018243312836, mean p set: 0.44588083028793335
loss_pred:0.014933794736862183, decouple_loss:0.00029282981995493174
The modified gen p mean: 0.44852933287620544, gen p mean: -0.12702466547489166, mean p set: 0.4491027295589447
loss_pred:0.01533760130405426, decouple_loss:0.0003601768985390663
The modified gen p mean: 0.44748109579086304, gen p mean: -0.1267702430486679, mean p set: 0.4480600357055664
loss_pred:0.015602358616888523, decouple_loss:0.00033193916897289455
Iteration: 3056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44538626074790955, gen p mean: -0.1313350945711136, mean p set: 0.4459638297557831
loss_pred:0.01488795317709446, decouple_loss:0.00040982579230330884
The modified gen p mean: 0.4466184973716736, gen p mean: -0.1269836723804474, mean p set: 0.4471952021121979
loss_pred:0.01468958891928196, decouple_loss:0.0003248715656809509
The modified gen p mean: 0.44617408514022827, gen p mean: -0.13189244270324707, mean p set: 0.44674885272979736
loss_pred:0.015116897411644459, decouple_loss:0.0003137205494567752
Iteration: 3057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473921060562134, gen p mean: -0.12418152391910553, mean p set: 0.4479677379131317
loss_pred:0.015507756732404232, decouple_loss:0.00029804123914800584
The modified gen p mean: 0.4498971700668335, gen p mean: -0.12773732841014862, mean p set: 0.4504740536212921
loss_pred:0.013848435133695602, decouple_loss:0.0002933559298980981
The modified gen p mean: 0.4443957805633545, gen p mean: -0.1284470558166504, mean p set: 0.4449720084667206
loss_pred:0.015231037512421608, decouple_loss:0.00034316317760385573
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 3058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472162127494812, gen p mean: -0.1268572211265564, mean p set: 0.4477914571762085
loss_pred:0.014486600644886494, decouple_loss:0.00044352561235427856
The modified gen p mean: 0.44806647300720215, gen p mean: -0.1266632080078125, mean p set: 0.44864028692245483
The modified gen p mean: 0.44714128971099854, gen p mean: -0.12182667851448059, mean p set: 0.44771599769592285
loss_pred:0.015205247327685356, decouple_loss:0.00032120198011398315
loss_pred:0.014628870412707329, decouple_loss:0.0003532439877744764
Iteration: 3059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470909833908081, gen p mean: -0.1266814023256302, mean p set: 0.4476657211780548
loss_pred:0.014366056770086288, decouple_loss:0.00034502227208577096
The modified gen p mean: 0.4466594457626343, gen p mean: -0.1291804313659668, mean p set: 0.44723477959632874
loss_pred:0.015449236147105694, decouple_loss:0.0003461805172264576
The modified gen p mean: 0.44872793555259705, gen p mean: -0.12772877514362335, mean p set: 0.44930416345596313
loss_pred:0.014629381708800793, decouple_loss:0.0003129356191493571
Iteration: 3060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476687014102936, gen p mean: -0.12939094007015228, mean p set: 0.4482421875
loss_pred:0.014503748156130314, decouple_loss:0.00038766488432884216
The modified gen p mean: 0.44790756702423096, gen p mean: -0.128003790974617, mean p set: 0.4484843611717224
loss_pred:0.014821132645010948, decouple_loss:0.0003587958635762334
The modified gen p mean: 0.4476008117198944, gen p mean: -0.1279652714729309, mean p set: 0.44817429780960083
loss_pred:0.014869156293570995, decouple_loss:0.0004031007701996714
2023-05-02 15:16:29 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13286805152893066, mean p set: 0.4502691626548767
loss_pred:0.016787033528089523, decouple_loss:0.0003558694734238088
The modified gen p mean: 0.4495343565940857, gen p mean: -0.1261020451784134, mean p set: 0.4500633478164673
loss_pred:0.016039911657571793, decouple_loss:0.0003929483937099576
The modified gen p mean: 0.4498317837715149, gen p mean: -0.12529027462005615, mean p set: 0.45035696029663086
loss_pred:0.01637229323387146, decouple_loss:0.00038724581827409565
WV_1_PC_1_EH_0_PS_40, loss: 0.016418680548667908, avg_mse: 0.025708165019750595
current test mse: 0.025708
Iteration: 3061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481426477432251, gen p mean: -0.1267157346010208, mean p set: 0.44871804118156433
loss_pred:0.014620628207921982, decouple_loss:0.000302319967886433
The modified gen p mean: 0.4483058452606201, gen p mean: -0.1288803666830063, mean p set: 0.4488847255706787The modified gen p mean: 0.44733232259750366, gen p mean: -0.13090693950653076, mean p set: 0.4479072690010071
loss_pred:0.014529542066156864, decouple_loss:0.0004056975885760039loss_pred:0.014296181499958038, decouple_loss:0.0003458774881437421
Iteration: 3062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756847620010376, gen p mean: -0.123895063996315, mean p set: 0.4481446444988251
loss_pred:0.015447146259248257, decouple_loss:0.00038414678419940174
The modified gen p mean: 0.44744592905044556, gen p mean: -0.13157862424850464, mean p set: 0.44802361726760864The modified gen p mean: 0.44667237997055054, gen p mean: -0.1330825835466385, mean p set: 0.4472491443157196
loss_pred:0.014665218070149422, decouple_loss:0.00035023470991291106loss_pred:0.01441529393196106, decouple_loss:0.00029149706824682653
Iteration: 3063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726788997650146, gen p mean: -0.1363687813282013, mean p set: 0.4478473961353302
loss_pred:0.0151933329179883, decouple_loss:0.0004258295230101794
The modified gen p mean: 0.44734200835227966, gen p mean: -0.1294482946395874, mean p set: 0.4479181170463562
loss_pred:0.014641310088336468, decouple_loss:0.0004321507876738906
The modified gen p mean: 0.44785141944885254, gen p mean: -0.13252386450767517, mean p set: 0.44842514395713806
loss_pred:0.014824875630438328, decouple_loss:0.00036290541174821556
Iteration: 3064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718098640441895, gen p mean: -0.13683532178401947, mean p set: 0.4477572739124298
loss_pred:0.015272350050508976, decouple_loss:0.00036166119389235973
The modified gen p mean: 0.4472602307796478, gen p mean: -0.1385924220085144, mean p set: 0.4478357136249542
loss_pred:0.014626407995820045, decouple_loss:0.0004507814592216164
The modified gen p mean: 0.44613081216812134, gen p mean: -0.13436685502529144, mean p set: 0.44670602679252625
loss_pred:0.015184163115918636, decouple_loss:0.0003430605574976653
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699445366859436, gen p mean: -0.13651224970817566, mean p set: 0.4475705623626709
loss_pred:0.014124905690550804, decouple_loss:0.00036267226096242666
The modified gen p mean: 0.44805166125297546, gen p mean: -0.1349509209394455, mean p set: 0.44862401485443115
loss_pred:0.014982391148805618, decouple_loss:0.0004013521538581699
The modified gen p mean: 0.4480617344379425, gen p mean: -0.13234727084636688, mean p set: 0.4486437737941742
loss_pred:0.014350549317896366, decouple_loss:0.0005468783201649785
Iteration: 3066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773736596107483, gen p mean: -0.13921666145324707, mean p set: 0.4483122229576111
loss_pred:0.01432594284415245, decouple_loss:0.00040944130159914494
The modified gen p mean: 0.4473586976528168, gen p mean: -0.13642625510692596, mean p set: 0.44793686270713806
loss_pred:0.014668473973870277, decouple_loss:0.00034099133335985243
The modified gen p mean: 0.4465533196926117, gen p mean: -0.14278584718704224, mean p set: 0.4471310079097748
loss_pred:0.014103750698268414, decouple_loss:0.0003826699685305357
Iteration: 3067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484577775001526, gen p mean: -0.1419311761856079, mean p set: 0.4490325152873993
loss_pred:0.014127686619758606, decouple_loss:0.00041165942093357444
The modified gen p mean: 0.44643428921699524, gen p mean: -0.13799574971199036, mean p set: 0.44701075553894043
loss_pred:0.014680163934826851, decouple_loss:0.00032846658723428845
The modified gen p mean: 0.44719570875167847, gen p mean: -0.1369512528181076, mean p set: 0.4477703869342804
loss_pred:0.014810028485953808, decouple_loss:0.0003389294433873147
Iteration: 3068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492124319076538, gen p mean: -0.13832032680511475, mean p set: 0.4497888684272766
loss_pred:0.014270140789449215, decouple_loss:0.00042899796972051263
The modified gen p mean: 0.4471540153026581, gen p mean: -0.13317365944385529, mean p set: 0.4477294087409973
loss_pred:0.015081031247973442, decouple_loss:0.00033161963801831007
The modified gen p mean: 0.44756725430488586, gen p mean: -0.1265118271112442, mean p set: 0.4481441080570221
loss_pred:0.014390425756573677, decouple_loss:0.00033422367414459586
Iteration: 3069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678795337677, gen p mean: -0.12805040180683136, mean p set: 0.44736430048942566
loss_pred:0.014606095850467682, decouple_loss:0.00034150623832829297
The modified gen p mean: 0.4472316801548004, gen p mean: -0.13321274518966675, mean p set: 0.44780635833740234
loss_pred:0.01506704743951559, decouple_loss:0.0003093447885476053
The modified gen p mean: 0.44719988107681274, gen p mean: -0.12904396653175354, mean p set: 0.4477764964103699
loss_pred:0.01457605417817831, decouple_loss:0.0003893145767506212
Iteration: 3070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467124044895172, gen p mean: -0.13618497550487518, mean p set: 0.44728556275367737
loss_pred:0.015221853740513325, decouple_loss:0.00032253196695819497
The modified gen p mean: 0.44679611921310425, gen p mean: -0.1307089477777481, mean p set: 0.44737330079078674
loss_pred:0.01443032268434763, decouple_loss:0.0003179282648488879
The modified gen p mean: 0.4470255970954895, gen p mean: -0.1298981010913849, mean p set: 0.4476010799407959
loss_pred:0.014765315689146519, decouple_loss:0.0003492369141895324
2023-05-02 15:18:36 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13697484135627747, mean p set: 0.4502691626548767
loss_pred:0.01686146855354309, decouple_loss:0.00035251613007858396
The modified gen p mean: 0.449537992477417, gen p mean: -0.130459263920784, mean p set: 0.4500633478164673
loss_pred:0.01612885482609272, decouple_loss:0.000459888979094103
The modified gen p mean: 0.44982674717903137, gen p mean: -0.12982991337776184, mean p set: 0.45035696029663086
loss_pred:0.016432132571935654, decouple_loss:0.00039150851080194116
WV_1_PC_1_EH_0_PS_40, loss: 0.01649421826004982, avg_mse: 0.02582894079387188
current test mse: 0.025829
Iteration: 3071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44712311029434204, gen p mean: -0.1323717087507248, mean p set: 0.4476999342441559
loss_pred:0.014434878714382648, decouple_loss:0.00039624504279345274
The modified gen p mean: 0.4472467005252838, gen p mean: -0.13100454211235046, mean p set: 0.4478200376033783The modified gen p mean: 0.4477081894874573, gen p mean: -0.13444054126739502, mean p set: 0.4482831358909607
loss_pred:0.01494957972317934, decouple_loss:0.00031353990198113024
loss_pred:0.014423362910747528, decouple_loss:0.00036257936153560877
Iteration: 3072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446897953748703, gen p mean: -0.13355669379234314, mean p set: 0.44747352600097656
loss_pred:0.014418410137295723, decouple_loss:0.00035765927168540657
The modified gen p mean: 0.4478498697280884, gen p mean: -0.13302147388458252, mean p set: 0.4484269320964813The modified gen p mean: 0.44651392102241516, gen p mean: -0.13789941370487213, mean p set: 0.44708749651908875
loss_pred:0.014232114888727665, decouple_loss:0.0003918683505617082loss_pred:0.015033655799925327, decouple_loss:0.00032308592926710844
Iteration: 3073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44672200083732605, gen p mean: -0.13945485651493073, mean p set: 0.4472969174385071
loss_pred:0.014188299886882305, decouple_loss:0.0003414581879042089
The modified gen p mean: 0.447246789932251, gen p mean: -0.13137423992156982, mean p set: 0.44782111048698425The modified gen p mean: 0.4481728672981262, gen p mean: -0.14030689001083374, mean p set: 0.4487501382827759
loss_pred:0.01474908646196127, decouple_loss:0.000382089929189533
loss_pred:0.01414714939892292, decouple_loss:0.00029708616784773767
Iteration: 3074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737714529037476, gen p mean: -0.1233200877904892, mean p set: 0.4479510188102722
loss_pred:0.015101289376616478, decouple_loss:0.0003066103963647038
The modified gen p mean: 0.44801831245422363, gen p mean: -0.1322922557592392, mean p set: 0.4485948383808136
loss_pred:0.014705049805343151, decouple_loss:0.0004437062016222626
The modified gen p mean: 0.4485332667827606, gen p mean: -0.12815868854522705, mean p set: 0.44910916686058044
loss_pred:0.014725500717759132, decouple_loss:0.00034710956970229745
Iteration: 3075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44684526324272156, gen p mean: -0.12955112755298615, mean p set: 0.44742023944854736
loss_pred:0.014489092864096165, decouple_loss:0.0003464212641119957
The modified gen p mean: 0.44671210646629333, gen p mean: -0.1335388571023941, mean p set: 0.4472888708114624
loss_pred:0.014390358701348305, decouple_loss:0.0003046439087484032
The modified gen p mean: 0.4467337429523468, gen p mean: -0.12663428485393524, mean p set: 0.4473079442977905
loss_pred:0.01448146067559719, decouple_loss:0.0003353338688611984
Iteration: 3076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481137692928314, gen p mean: -0.12270042300224304, mean p set: 0.44868743419647217
loss_pred:0.014305456541478634, decouple_loss:0.0003845458850264549
The modified gen p mean: 0.4478529691696167, gen p mean: -0.12928272783756256, mean p set: 0.44843074679374695
loss_pred:0.014447789639234543, decouple_loss:0.00040124592487700284
The modified gen p mean: 0.4482263922691345, gen p mean: -0.12687236070632935, mean p set: 0.44880321621894836
loss_pred:0.014562937431037426, decouple_loss:0.0004234891966916621
Iteration: 3077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467877149581909, gen p mean: -0.12769821286201477, mean p set: 0.44736161828041077
loss_pred:0.014070440083742142, decouple_loss:0.0003311533364467323
The modified gen p mean: 0.4476436376571655, gen p mean: -0.12356650084257126, mean p set: 0.44822028279304504
The modified gen p mean: 0.44651123881340027, gen p mean: -0.12378965318202972, mean p set: 0.4470870792865753
loss_pred:0.014425527304410934, decouple_loss:0.0004680713464040309
loss_pred:0.015372178517282009, decouple_loss:0.00039262964855879545
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
NaN value num: 0
Iteration: 3078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45327937602996826, gen p mean: -0.11621524393558502, mean p set: 0.4538586437702179
The modified gen p mean: 0.452518492937088, gen p mean: -0.11687294393777847, mean p set: 0.4530949294567108loss_pred:0.015169625170528889, decouple_loss:0.0004862215428147465
loss_pred:0.015267452225089073, decouple_loss:0.0006633373559452593
The modified gen p mean: 0.4513179063796997, gen p mean: -0.10890591889619827, mean p set: 0.4518945813179016
loss_pred:0.01594054512679577, decouple_loss:0.00035500866943039
Iteration: 3079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45191067457199097, gen p mean: -0.11267276108264923, mean p set: 0.4524872601032257
loss_pred:0.015272071585059166, decouple_loss:0.00047554486081935465
The modified gen p mean: 0.453432559967041, gen p mean: -0.1140250414609909, mean p set: 0.45401036739349365
loss_pred:0.015301099047064781, decouple_loss:0.0003757934318855405
The modified gen p mean: 0.4525099992752075, gen p mean: -0.11768131703138351, mean p set: 0.453086256980896
loss_pred:0.015351799316704273, decouple_loss:0.0006533080013468862
Iteration: 3080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45237621665000916, gen p mean: -0.11575761437416077, mean p set: 0.452952116727829
loss_pred:0.015805160626769066, decouple_loss:0.0006743724807165563
The modified gen p mean: 0.45368191599845886, gen p mean: -0.12033269554376602, mean p set: 0.45425722002983093
loss_pred:0.014752603136003017, decouple_loss:0.00030481573776341975
The modified gen p mean: 0.4531766474246979, gen p mean: -0.12001708894968033, mean p set: 0.45375412702560425
loss_pred:0.014550863765180111, decouple_loss:0.000317893922328949
2023-05-02 15:21:23 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1368665099143982, mean p set: 0.4502691626548767
loss_pred:0.01683829538524151, decouple_loss:0.0004533345636446029
The modified gen p mean: 0.449535608291626, gen p mean: -0.13060584664344788, mean p set: 0.4500633478164673
loss_pred:0.016082964837551117, decouple_loss:0.0004584368143696338
The modified gen p mean: 0.44982826709747314, gen p mean: -0.1297813057899475, mean p set: 0.45035696029663086
loss_pred:0.01639009639620781, decouple_loss:0.0004183032433502376
WV_1_PC_1_EH_0_PS_40, loss: 0.016459288075566292, avg_mse: 0.025760186836123466
current test mse: 0.02576
Iteration: 3081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4540652334690094, gen p mean: -0.12069223821163177, mean p set: 0.45464229583740234
loss_pred:0.014683534391224384, decouple_loss:0.00036883907159790397
The modified gen p mean: 0.45081114768981934, gen p mean: -0.11612693965435028, mean p set: 0.4513874351978302The modified gen p mean: 0.4544790983200073, gen p mean: -0.11968916654586792, mean p set: 0.4550575017929077
loss_pred:0.015016229823231697, decouple_loss:0.000597200240008533
loss_pred:0.014877614565193653, decouple_loss:0.0005919943796470761
Iteration: 3082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45320355892181396, gen p mean: -0.12089397013187408, mean p set: 0.45378226041793823
loss_pred:0.014790049754083157, decouple_loss:0.0003469455405138433
The modified gen p mean: 0.45383089780807495, gen p mean: -0.12097249925136566, mean p set: 0.45440778136253357The modified gen p mean: 0.45224955677986145, gen p mean: -0.12181714177131653, mean p set: 0.4528234302997589
loss_pred:0.015109259635210037, decouple_loss:0.000497489410918206loss_pred:0.014954935759305954, decouple_loss:0.0003696320054586977
Iteration: 3083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528999328613281, gen p mean: -0.1197265088558197, mean p set: 0.4534760117530823
loss_pred:0.015372231602668762, decouple_loss:0.0003911381063517183
The modified gen p mean: 0.4534868001937866, gen p mean: -0.1210099458694458, mean p set: 0.45406532287597656The modified gen p mean: 0.4524860680103302, gen p mean: -0.11900557577610016, mean p set: 0.45306307077407837
loss_pred:0.014662512578070164, decouple_loss:0.000429055216955021
loss_pred:0.015382184647023678, decouple_loss:0.0004501227813307196
Iteration: 3084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45272573828697205, gen p mean: -0.11775519698858261, mean p set: 0.4532998204231262
loss_pred:0.014850000850856304, decouple_loss:0.0003477154241409153
The modified gen p mean: 0.45203056931495667, gen p mean: -0.1176571473479271, mean p set: 0.45260608196258545
loss_pred:0.015576846897602081, decouple_loss:0.0002946149616036564
The modified gen p mean: 0.4525391757488251, gen p mean: -0.12194433063268661, mean p set: 0.4531163275241852
loss_pred:0.015096700750291348, decouple_loss:0.0003450124931987375
Iteration: 3085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45199066400527954, gen p mean: -0.12057344615459442, mean p set: 0.45256906747817993
loss_pred:0.015557365491986275, decouple_loss:0.0003600659838411957
The modified gen p mean: 0.4520244002342224, gen p mean: -0.11635866016149521, mean p set: 0.4526006579399109
loss_pred:0.01494224276393652, decouple_loss:0.00040567037649452686
The modified gen p mean: 0.4526003301143646, gen p mean: -0.12043841183185577, mean p set: 0.45317837595939636
loss_pred:0.015517396852374077, decouple_loss:0.0002976657706312835
Iteration: 3086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45143166184425354, gen p mean: -0.11541515588760376, mean p set: 0.45200714468955994
loss_pred:0.01558033935725689, decouple_loss:0.00040072094998322427
The modified gen p mean: 0.4531659483909607, gen p mean: -0.11936283856630325, mean p set: 0.45374566316604614
The modified gen p mean: 0.4528588056564331, gen p mean: -0.11427447944879532, mean p set: 0.4534352123737335
loss_pred:0.015012295916676521, decouple_loss:0.00037352467188611627
loss_pred:0.015610434114933014, decouple_loss:0.00034055759897455573
Iteration: 3087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520556330680847, gen p mean: -0.11206496506929398, mean p set: 0.45263317227363586
loss_pred:0.014971746131777763, decouple_loss:0.00041234580567106605
The modified gen p mean: 0.4526351988315582, gen p mean: -0.1159093901515007, mean p set: 0.4532153010368347
The modified gen p mean: 0.45381617546081543, gen p mean: -0.11851757764816284, mean p set: 0.45439663529396057
loss_pred:0.01559927687048912, decouple_loss:0.0004793480329681188
loss_pred:0.01451413705945015, decouple_loss:0.00045501638669520617
Iteration: 3088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45342010259628296, gen p mean: -0.11414478719234467, mean p set: 0.4539981782436371
loss_pred:0.01467231847345829, decouple_loss:0.0004172214830759913
The modified gen p mean: 0.4532621502876282, gen p mean: -0.11596866697072983, mean p set: 0.45383843779563904
loss_pred:0.015085882507264614, decouple_loss:0.00042069179471582174
The modified gen p mean: 0.452558696269989, gen p mean: -0.1095830574631691, mean p set: 0.4531364440917969
loss_pred:0.015406926162540913, decouple_loss:0.0004045806126669049
Iteration: 3089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45414838194847107, gen p mean: -0.11616119742393494, mean p set: 0.45472750067710876
loss_pred:0.014639627188444138, decouple_loss:0.000345875188941136
The modified gen p mean: 0.45210304856300354, gen p mean: -0.11778518557548523, mean p set: 0.4526795446872711
The modified gen p mean: 0.4536226987838745, gen p mean: -0.1170109212398529, mean p set: 0.45420005917549133
loss_pred:0.015294333919882774, decouple_loss:0.0005408933502621949
loss_pred:0.014215580187737942, decouple_loss:0.00037237699143588543
Iteration: 3090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532172679901123, gen p mean: -0.11420609056949615, mean p set: 0.4537944197654724
loss_pred:0.01499869767576456, decouple_loss:0.000318860518746078
The modified gen p mean: 0.4536846876144409, gen p mean: -0.11761246621608734, mean p set: 0.4542624056339264
loss_pred:0.015642866492271423, decouple_loss:0.00042304268572479486
The modified gen p mean: 0.45418769121170044, gen p mean: -0.1190262883901596, mean p set: 0.4547651410102844
loss_pred:0.014640092849731445, decouple_loss:0.0005240190657787025
2023-05-02 15:23:29 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13182468712329865, mean p set: 0.4502691626548767
loss_pred:0.01687014102935791, decouple_loss:0.000512738130055368
The modified gen p mean: 0.4495364725589752, gen p mean: -0.12571099400520325, mean p set: 0.4500633478164673
loss_pred:0.01606362871825695, decouple_loss:0.0006001100409775972
The modified gen p mean: 0.4498292803764343, gen p mean: -0.12489385157823563, mean p set: 0.45035696029663086
loss_pred:0.016379626467823982, decouple_loss:0.0005542917060665786
WV_1_PC_1_EH_0_PS_40, loss: 0.01646558567881584, avg_mse: 0.025747686624526978
current test mse: 0.025748
Iteration: 3091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45162251591682434, gen p mean: -0.11216947436332703, mean p set: 0.4522015452384949
loss_pred:0.015608636662364006, decouple_loss:0.0003377856919541955
The modified gen p mean: 0.45232391357421875, gen p mean: -0.10954852402210236, mean p set: 0.45290088653564453
loss_pred:0.015618409961462021, decouple_loss:0.00040679468656890094
The modified gen p mean: 0.45216190814971924, gen p mean: -0.11530818790197372, mean p set: 0.4527394771575928
loss_pred:0.015696318820118904, decouple_loss:0.0003039394796360284
Iteration: 3092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530007243156433, gen p mean: -0.11324097961187363, mean p set: 0.4535783529281616
loss_pred:0.01474941149353981, decouple_loss:0.00044615293154492974
The modified gen p mean: 0.45297160744667053, gen p mean: -0.11419137567281723, mean p set: 0.4535493850708008The modified gen p mean: 0.4521331191062927, gen p mean: -0.11891824007034302, mean p set: 0.4527115225791931
loss_pred:0.014850628562271595, decouple_loss:0.0004908110131509602
loss_pred:0.014873814769089222, decouple_loss:0.0004084492102265358
Iteration: 3093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520684778690338, gen p mean: -0.11268232762813568, mean p set: 0.45264583826065063
loss_pred:0.01468576304614544, decouple_loss:0.00041443726513534784
The modified gen p mean: 0.4536493718624115, gen p mean: -0.11822188645601273, mean p set: 0.4542265832424164
loss_pred:0.014777403324842453, decouple_loss:0.00046695870696567
The modified gen p mean: 0.4538930058479309, gen p mean: -0.1150166392326355, mean p set: 0.4544689953327179
loss_pred:0.014866269193589687, decouple_loss:0.00030938524287194014
Iteration: 3094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45443591475486755, gen p mean: -0.11608871817588806, mean p set: 0.45501336455345154
loss_pred:0.01496803667396307, decouple_loss:0.0004136116767767817
The modified gen p mean: 0.4536953568458557, gen p mean: -0.11744124442338943, mean p set: 0.45427173376083374
loss_pred:0.014367313124239445, decouple_loss:0.00046527289669029415
The modified gen p mean: 0.45171263813972473, gen p mean: -0.11666817218065262, mean p set: 0.45228859782218933
loss_pred:0.014971951022744179, decouple_loss:0.00040572459693066776
Iteration: 3095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520414471626282, gen p mean: -0.11461389809846878, mean p set: 0.45261943340301514
loss_pred:0.015208374708890915, decouple_loss:0.000587362446822226
The modified gen p mean: 0.4530215859413147, gen p mean: -0.1169414147734642, mean p set: 0.4535987377166748
loss_pred:0.014516632072627544, decouple_loss:0.0006018034182488918
The modified gen p mean: 0.4515247046947479, gen p mean: -0.11626987159252167, mean p set: 0.45210132002830505
loss_pred:0.01467803306877613, decouple_loss:0.0005340888164937496
Iteration: 3096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4541912376880646, gen p mean: -0.11308637261390686, mean p set: 0.45476964116096497
loss_pred:0.015288974158465862, decouple_loss:0.0003562755009625107
The modified gen p mean: 0.4528430104255676, gen p mean: -0.11820439994335175, mean p set: 0.45342111587524414
loss_pred:0.01457590889185667, decouple_loss:0.00036496343091130257
The modified gen p mean: 0.45310595631599426, gen p mean: -0.11428838968276978, mean p set: 0.45368504524230957
loss_pred:0.01570785604417324, decouple_loss:0.0003516414435580373
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
NaN value num: 0
Iteration: 3097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044898986816406, gen p mean: -0.1156790480017662, mean p set: 0.4510236978530884
The modified gen p mean: 0.4528997242450714, gen p mean: -0.11654246598482132, mean p set: 0.45347464084625244
loss_pred:0.014226781204342842, decouple_loss:0.0003590364067349583
loss_pred:0.014987814240157604, decouple_loss:0.0003758681414183229
The modified gen p mean: 0.4506722688674927, gen p mean: -0.10943678021430969, mean p set: 0.4512505531311035
loss_pred:0.015228520147502422, decouple_loss:0.0003603284421842545
Iteration: 3098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496943950653076, gen p mean: -0.1108495220541954, mean p set: 0.4502705931663513
loss_pred:0.014435107819736004, decouple_loss:0.0003800659906119108
The modified gen p mean: 0.45133379101753235, gen p mean: -0.1124865934252739, mean p set: 0.45191025733947754
The modified gen p mean: 0.45034441351890564, gen p mean: -0.11491206288337708, mean p set: 0.4509201943874359
loss_pred:0.014693805947899818, decouple_loss:0.0005905752186663449
loss_pred:0.01496133953332901, decouple_loss:0.00041444896487519145
Iteration: 3099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931021332740784, gen p mean: -0.10765981674194336, mean p set: 0.4498852789402008
loss_pred:0.015703115612268448, decouple_loss:0.00040439912118017673
The modified gen p mean: 0.45130106806755066, gen p mean: -0.10832787305116653, mean p set: 0.45187634229660034
loss_pred:0.014876622706651688, decouple_loss:0.0003695988852996379
The modified gen p mean: 0.44942277669906616, gen p mean: -0.10987171530723572, mean p set: 0.44999685883522034
loss_pred:0.01456464547663927, decouple_loss:0.0003740026440937072
Iteration: 3100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44905808568000793, gen p mean: -0.11364149302244186, mean p set: 0.44963446259498596
loss_pred:0.014634905382990837, decouple_loss:0.0004913833108730614
The modified gen p mean: 0.44925665855407715, gen p mean: -0.10816311091184616, mean p set: 0.44983193278312683
loss_pred:0.015630709007382393, decouple_loss:0.00036753708263859153
The modified gen p mean: 0.45034414529800415, gen p mean: -0.11608435958623886, mean p set: 0.4509181082248688
loss_pred:0.014518378302454948, decouple_loss:0.000366184685844928
2023-05-02 15:26:13 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1271536648273468, mean p set: 0.4502691626548767
loss_pred:0.016931625083088875, decouple_loss:0.0006111711263656616
The modified gen p mean: 0.4495372772216797, gen p mean: -0.12067285925149918, mean p set: 0.4500633478164673
loss_pred:0.016149872913956642, decouple_loss:0.000536048028152436
The modified gen p mean: 0.4498293995857239, gen p mean: -0.12004179507493973, mean p set: 0.45035696029663086
loss_pred:0.01640979014337063, decouple_loss:0.0005405571428127587
WV_1_PC_1_EH_0_PS_40, loss: 0.016525225713849068, avg_mse: 0.025810513645410538
current test mse: 0.025811
Iteration: 3101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499075710773468, gen p mean: -0.11364839971065521, mean p set: 0.4504829943180084
loss_pred:0.01372128538787365, decouple_loss:0.00036170895327813923
The modified gen p mean: 0.4512867033481598, gen p mean: -0.11877204477787018, mean p set: 0.45186319947242737The modified gen p mean: 0.4498647451400757, gen p mean: -0.10756274312734604, mean p set: 0.450441837310791
loss_pred:0.014954470098018646, decouple_loss:0.00037857500137761235
loss_pred:0.01465487852692604, decouple_loss:0.0003787697642110288
Iteration: 3102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504856467247009, gen p mean: -0.11246435344219208, mean p set: 0.4510606527328491
loss_pred:0.014481019228696823, decouple_loss:0.00035648338962346315
The modified gen p mean: 0.44997841119766235, gen p mean: -0.11462964117527008, mean p set: 0.4505563974380493The modified gen p mean: 0.452519953250885, gen p mean: -0.11362432688474655, mean p set: 0.45309871435165405
loss_pred:0.015215827152132988, decouple_loss:0.0004733795067295432
loss_pred:0.014830272644758224, decouple_loss:0.00035336389555595815
Iteration: 3103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010045170783997, gen p mean: -0.11225266009569168, mean p set: 0.45067504048347473
loss_pred:0.01478904765099287, decouple_loss:0.00044512315071187913
The modified gen p mean: 0.45067450404167175, gen p mean: -0.11732383072376251, mean p set: 0.45125120878219604The modified gen p mean: 0.45014581084251404, gen p mean: -0.11315784603357315, mean p set: 0.45072323083877563
loss_pred:0.014504942111670971, decouple_loss:0.00034539986518211663
loss_pred:0.014349430799484253, decouple_loss:0.00043633385212160647
Iteration: 3104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059332251548767, gen p mean: -0.11425013840198517, mean p set: 0.4511701166629791
loss_pred:0.015346774831414223, decouple_loss:0.0004641723062377423
The modified gen p mean: 0.4513377547264099, gen p mean: -0.11792507022619247, mean p set: 0.4519140422344208
loss_pred:0.015020566061139107, decouple_loss:0.00040416017873212695
The modified gen p mean: 0.4498753249645233, gen p mean: -0.11389606446027756, mean p set: 0.4504503011703491
loss_pred:0.014738081954419613, decouple_loss:0.00046843907330185175
Iteration: 3105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501270055770874, gen p mean: -0.11106786131858826, mean p set: 0.4507034122943878
loss_pred:0.014306283555924892, decouple_loss:0.00040758505929261446
The modified gen p mean: 0.45032384991645813, gen p mean: -0.11148643493652344, mean p set: 0.4508971571922302
loss_pred:0.015124971978366375, decouple_loss:0.0003728686133399606
The modified gen p mean: 0.4508104920387268, gen p mean: -0.11021474003791809, mean p set: 0.4513859152793884
loss_pred:0.01500353030860424, decouple_loss:0.00038645684253424406
Iteration: 3106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517885744571686, gen p mean: -0.11918680369853973, mean p set: 0.4523652195930481
loss_pred:0.015103500336408615, decouple_loss:0.0005138655542396009
The modified gen p mean: 0.44955921173095703, gen p mean: -0.11697296053171158, mean p set: 0.4501340985298157
The modified gen p mean: 0.451499342918396, gen p mean: -0.1122569814324379, mean p set: 0.45207569003105164
loss_pred:0.014770925045013428, decouple_loss:0.0004109245492145419
loss_pred:0.014279050752520561, decouple_loss:0.00038184993900358677
Iteration: 3107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45254266262054443, gen p mean: -0.1134185791015625, mean p set: 0.45311927795410156
loss_pred:0.014311651699244976, decouple_loss:0.0003548557579051703
The modified gen p mean: 0.4500816762447357, gen p mean: -0.1163996011018753, mean p set: 0.4506555497646332
The modified gen p mean: 0.4503346085548401, gen p mean: -0.11582887917757034, mean p set: 0.4509105384349823
loss_pred:0.014101933687925339, decouple_loss:0.000352594448486343
loss_pred:0.014637050218880177, decouple_loss:0.00032240792643278837
Iteration: 3108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45260903239250183, gen p mean: -0.1128825768828392, mean p set: 0.45318400859832764
The modified gen p mean: 0.4491216540336609, gen p mean: -0.11706134676933289, mean p set: 0.4496982991695404
loss_pred:0.015294845215976238, decouple_loss:0.0003955057472921908
loss_pred:0.013988840393722057, decouple_loss:0.0003688788565341383
The modified gen p mean: 0.45027557015419006, gen p mean: -0.11647985130548477, mean p set: 0.4508511424064636
loss_pred:0.014353935606777668, decouple_loss:0.0003788676403928548
Iteration: 3109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45040372014045715, gen p mean: -0.11470703035593033, mean p set: 0.45097947120666504
loss_pred:0.015257682651281357, decouple_loss:0.00042518769623711705
The modified gen p mean: 0.45197516679763794, gen p mean: -0.11862234771251678, mean p set: 0.4525485932826996
loss_pred:0.014718872494995594, decouple_loss:0.000405307044275105
The modified gen p mean: 0.4505273997783661, gen p mean: -0.11553563177585602, mean p set: 0.45110225677490234
loss_pred:0.015106147155165672, decouple_loss:0.000456193316495046
Iteration: 3110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45021599531173706, gen p mean: -0.11712472885847092, mean p set: 0.4507932960987091
loss_pred:0.01428807619959116, decouple_loss:0.0003885013284161687
The modified gen p mean: 0.4525325894355774, gen p mean: -0.11607428640127182, mean p set: 0.4531055688858032
The modified gen p mean: 0.4499819278717041, gen p mean: -0.11827248334884644, mean p set: 0.45055902004241943
loss_pred:0.014787008985877037, decouple_loss:0.0003847167536150664
loss_pred:0.014975422993302345, decouple_loss:0.00042843999108299613
2023-05-02 15:28:18 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13075876235961914, mean p set: 0.4502691626548767
loss_pred:0.016878297552466393, decouple_loss:0.0005774553865194321
The modified gen p mean: 0.4495370388031006, gen p mean: -0.12364812195301056, mean p set: 0.4500633478164673
loss_pred:0.016184501349925995, decouple_loss:0.0005644600023515522
The modified gen p mean: 0.44982850551605225, gen p mean: -0.123292937874794, mean p set: 0.45035696029663086
loss_pred:0.016407236456871033, decouple_loss:0.000548010051716119
WV_1_PC_1_EH_0_PS_40, loss: 0.016518179327249527, avg_mse: 0.0258121807128191
current test mse: 0.025812
Iteration: 3111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518281817436218, gen p mean: -0.11669709533452988, mean p set: 0.4524039626121521
loss_pred:0.014431075192987919, decouple_loss:0.00047519049257971346
The modified gen p mean: 0.4499625861644745, gen p mean: -0.11829163134098053, mean p set: 0.45054012537002563The modified gen p mean: 0.45282670855522156, gen p mean: -0.11510279774665833, mean p set: 0.45340150594711304
loss_pred:0.014752192422747612, decouple_loss:0.00035853113513439894
loss_pred:0.014345829375088215, decouple_loss:0.00039927809848450124
Iteration: 3112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453157901763916, gen p mean: -0.11668471992015839, mean p set: 0.4537335932254791
loss_pred:0.014794602058827877, decouple_loss:0.00031331306672655046
The modified gen p mean: 0.4499320089817047, gen p mean: -0.10925289243459702, mean p set: 0.4505070447921753The modified gen p mean: 0.449114054441452, gen p mean: -0.11803938448429108, mean p set: 0.44968703389167786
loss_pred:0.015288247726857662, decouple_loss:0.00035198143450543284
loss_pred:0.014684988185763359, decouple_loss:0.0004714691312983632
Iteration: 3113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45167258381843567, gen p mean: -0.11281538009643555, mean p set: 0.4522497057914734
loss_pred:0.014591224491596222, decouple_loss:0.00038539935485459864
The modified gen p mean: 0.4524923264980316, gen p mean: -0.12403149902820587, mean p set: 0.4530709385871887
loss_pred:0.014316735789179802, decouple_loss:0.00037748340400867164
The modified gen p mean: 0.4493619501590729, gen p mean: -0.11596981436014175, mean p set: 0.449937105178833
loss_pred:0.013920619152486324, decouple_loss:0.0004953898605890572
Iteration: 3114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45315808057785034, gen p mean: -0.11364791542291641, mean p set: 0.4537356197834015
loss_pred:0.014615032821893692, decouple_loss:0.0004704091988969594
The modified gen p mean: 0.449504554271698, gen p mean: -0.11790450662374496, mean p set: 0.45008277893066406
loss_pred:0.01491119246929884, decouple_loss:0.0003587411774788052
The modified gen p mean: 0.45122796297073364, gen p mean: -0.12288730591535568, mean p set: 0.4518035352230072
loss_pred:0.014209081418812275, decouple_loss:0.0003176257014274597
Iteration: 3115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509870111942291, gen p mean: -0.11983492970466614, mean p set: 0.45156341791152954
loss_pred:0.01419480238109827, decouple_loss:0.0003577010938897729
The modified gen p mean: 0.4503574073314667, gen p mean: -0.11992741376161575, mean p set: 0.450937420129776
loss_pred:0.014699164777994156, decouple_loss:0.0003296757349744439
The modified gen p mean: 0.45010340213775635, gen p mean: -0.11800657212734222, mean p set: 0.45068085193634033
loss_pred:0.013982651755213737, decouple_loss:0.0004316178383305669
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
NaN value num: 0
Iteration: 3116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501180946826935, gen p mean: -0.1163388267159462, mean p set: 0.4506949186325073
loss_pred:0.015872478485107422, decouple_loss:0.0005173730314709246
The modified gen p mean: 0.45069700479507446, gen p mean: -0.12195023894309998, mean p set: 0.45127442479133606
The modified gen p mean: 0.4531818926334381, gen p mean: -0.12080112099647522, mean p set: 0.4537568688392639
loss_pred:0.015064890496432781, decouple_loss:0.00040856239502318203
loss_pred:0.014668437652289867, decouple_loss:0.00036981451557949185
Iteration: 3117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128220319747925, gen p mean: -0.11197759211063385, mean p set: 0.4518592655658722
loss_pred:0.016278576105833054, decouple_loss:0.00043831701623275876
The modified gen p mean: 0.45196786522865295, gen p mean: -0.11552891135215759, mean p set: 0.45254722237586975
The modified gen p mean: 0.4511276185512543, gen p mean: -0.11456838995218277, mean p set: 0.4517037868499756
loss_pred:0.014539660885930061, decouple_loss:0.00043833546806126833
loss_pred:0.015618077479302883, decouple_loss:0.0004363164189271629
Iteration: 3118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500657618045807, gen p mean: -0.11282270401716232, mean p set: 0.45064112544059753
loss_pred:0.01572216860949993, decouple_loss:0.0004634842334780842
The modified gen p mean: 0.45060932636260986, gen p mean: -0.11888016015291214, mean p set: 0.45118778944015503
The modified gen p mean: 0.45041143894195557, gen p mean: -0.11489203572273254, mean p set: 0.45098650455474854
loss_pred:0.015104150399565697, decouple_loss:0.0003645548422355205
loss_pred:0.014507578685879707, decouple_loss:0.00035889146965928376
Iteration: 3119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45101913809776306, gen p mean: -0.11249729245901108, mean p set: 0.45159485936164856
loss_pred:0.014531777240335941, decouple_loss:0.0004622196138370782
The modified gen p mean: 0.45055457949638367, gen p mean: -0.112250916659832, mean p set: 0.4511306881904602
loss_pred:0.014899780973792076, decouple_loss:0.0003383483272045851
The modified gen p mean: 0.4516615867614746, gen p mean: -0.11838541179895401, mean p set: 0.45223820209503174
loss_pred:0.014961222186684608, decouple_loss:0.00032432295847684145
Iteration: 3120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521511197090149, gen p mean: -0.11225951462984085, mean p set: 0.4527277946472168
loss_pred:0.015000239945948124, decouple_loss:0.00038269502692855895
The modified gen p mean: 0.4510314166545868, gen p mean: -0.1123528927564621, mean p set: 0.45160651206970215
The modified gen p mean: 0.4519194960594177, gen p mean: -0.1086612120270729, mean p set: 0.4524966776371002
loss_pred:0.015566685236990452, decouple_loss:0.0003655149193946272
loss_pred:0.015872696414589882, decouple_loss:0.00034331963979639113
2023-05-02 15:31:04 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12842118740081787, mean p set: 0.4502691626548767
loss_pred:0.016795547679066658, decouple_loss:0.0005783962551504374
The modified gen p mean: 0.44953668117523193, gen p mean: -0.1214955672621727, mean p set: 0.4500633478164673
loss_pred:0.01613352634012699, decouple_loss:0.0005361094954423606
The modified gen p mean: 0.44982632994651794, gen p mean: -0.12129238247871399, mean p set: 0.45035696029663086
loss_pred:0.01643681526184082, decouple_loss:0.0005294420407153666
WV_1_PC_1_EH_0_PS_40, loss: 0.016482695937156677, avg_mse: 0.02577720768749714
current test mse: 0.025777
Iteration: 3121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45144468545913696, gen p mean: -0.11391086131334305, mean p set: 0.45202142000198364
loss_pred:0.015408718958497047, decouple_loss:0.0003683568793348968
The modified gen p mean: 0.4505805969238281, gen p mean: -0.11236006766557693, mean p set: 0.4511549472808838The modified gen p mean: 0.451144814491272, gen p mean: -0.11558357626199722, mean p set: 0.4517228305339813
loss_pred:0.015494889579713345, decouple_loss:0.000402608304284513loss_pred:0.015344243496656418, decouple_loss:0.00043356610694900155
Iteration: 3122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518745541572571, gen p mean: -0.1139499843120575, mean p set: 0.4524519443511963
loss_pred:0.014858546666800976, decouple_loss:0.00036904128501191735
The modified gen p mean: 0.4522947072982788, gen p mean: -0.11607120931148529, mean p set: 0.45287254452705383The modified gen p mean: 0.45319393277168274, gen p mean: -0.1158413514494896, mean p set: 0.4537709653377533
loss_pred:0.015355427749454975, decouple_loss:0.0005245329230092466
loss_pred:0.014729111455380917, decouple_loss:0.0003622259828262031
Iteration: 3123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45069780945777893, gen p mean: -0.1132601648569107, mean p set: 0.45127376914024353
loss_pred:0.01596876233816147, decouple_loss:0.00043073485721834004
The modified gen p mean: 0.4512169361114502, gen p mean: -0.11423631012439728, mean p set: 0.4517951011657715
loss_pred:0.015189748257398605, decouple_loss:0.00035981182008981705
The modified gen p mean: 0.45132219791412354, gen p mean: -0.1108580231666565, mean p set: 0.4518997073173523
loss_pred:0.0156725961714983, decouple_loss:0.0004526229458861053
Iteration: 3124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523434042930603, gen p mean: -0.1123710423707962, mean p set: 0.45292118191719055
loss_pred:0.015378567390143871, decouple_loss:0.000543696922250092
The modified gen p mean: 0.4515061676502228, gen p mean: -0.11388373374938965, mean p set: 0.4520830810070038
loss_pred:0.015067663043737411, decouple_loss:0.00035307076177559793
The modified gen p mean: 0.45169195532798767, gen p mean: -0.11978860199451447, mean p set: 0.45226770639419556
loss_pred:0.014481530524790287, decouple_loss:0.00034602161031216383
Iteration: 3125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45164909958839417, gen p mean: -0.11922197788953781, mean p set: 0.45222529768943787
loss_pred:0.01524822786450386, decouple_loss:0.0003059893206227571
The modified gen p mean: 0.4513421952724457, gen p mean: -0.12548944354057312, mean p set: 0.451918363571167
loss_pred:0.014527221210300922, decouple_loss:0.00040536103188060224
The modified gen p mean: 0.4516925513744354, gen p mean: -0.12031378597021103, mean p set: 0.45226994156837463
loss_pred:0.014426259323954582, decouple_loss:0.00040842409362085164
Iteration: 3126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453873872756958, gen p mean: -0.12403065711259842, mean p set: 0.45445236563682556
loss_pred:0.014890437945723534, decouple_loss:0.000499433430377394
The modified gen p mean: 0.4521660804748535, gen p mean: -0.12061139941215515, mean p set: 0.45274418592453003
loss_pred:0.01447382103651762, decouple_loss:0.00039787538116797805
The modified gen p mean: 0.4514704644680023, gen p mean: -0.12608127295970917, mean p set: 0.45204612612724304
loss_pred:0.014404088258743286, decouple_loss:0.0003486488712951541
Iteration: 3127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524555206298828, gen p mean: -0.1273200809955597, mean p set: 0.4530346095561981
loss_pred:0.014610654674470425, decouple_loss:0.00035179336555302143
The modified gen p mean: 0.45244157314300537, gen p mean: -0.12076418101787567, mean p set: 0.45301714539527893
The modified gen p mean: 0.451516717672348, gen p mean: -0.12134062498807907, mean p set: 0.45209240913391113
loss_pred:0.015436552464962006, decouple_loss:0.0003377391549292952
loss_pred:0.014817100018262863, decouple_loss:0.00039852061308920383
Iteration: 3128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533446729183197, gen p mean: -0.12395461648702621, mean p set: 0.4539199471473694
loss_pred:0.014270368963479996, decouple_loss:0.0003885019395966083
The modified gen p mean: 0.4526057541370392, gen p mean: -0.12133148312568665, mean p set: 0.45318475365638733
loss_pred:0.014366073533892632, decouple_loss:0.0005734926671721041
The modified gen p mean: 0.4506329894065857, gen p mean: -0.11322696506977081, mean p set: 0.45121118426322937
loss_pred:0.015615960583090782, decouple_loss:0.0006869889912195504
Iteration: 3129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45150572061538696, gen p mean: -0.12095625698566437, mean p set: 0.4520838260650635
loss_pred:0.015272523276507854, decouple_loss:0.00038012120057828724
The modified gen p mean: 0.45047155022621155, gen p mean: -0.12140876054763794, mean p set: 0.4510461390018463
loss_pred:0.01589461788535118, decouple_loss:0.0004638379323296249
The modified gen p mean: 0.4513714611530304, gen p mean: -0.12243927270174026, mean p set: 0.45195040106773376
loss_pred:0.014375965110957623, decouple_loss:0.0004173398483544588
Iteration: 3130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497971832752228, gen p mean: -0.1214432641863823, mean p set: 0.45037490129470825
loss_pred:0.015640605241060257, decouple_loss:0.000590462819673121
The modified gen p mean: 0.45104891061782837, gen p mean: -0.12216843664646149, mean p set: 0.45162433385849
The modified gen p mean: 0.4510834515094757, gen p mean: -0.12397820502519608, mean p set: 0.4516591429710388
loss_pred:0.015301890671253204, decouple_loss:0.0005044343415647745
loss_pred:0.01468017976731062, decouple_loss:0.00038619813858531415
2023-05-02 15:33:10 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.132484570145607, mean p set: 0.4502691626548767
loss_pred:0.016848597675561905, decouple_loss:0.0005148443742655218
The modified gen p mean: 0.4495357871055603, gen p mean: -0.1255308836698532, mean p set: 0.4500633478164673
loss_pred:0.016175702214241028, decouple_loss:0.0004856160667259246
The modified gen p mean: 0.4498288333415985, gen p mean: -0.12556900084018707, mean p set: 0.45035696029663086
loss_pred:0.01639479771256447, decouple_loss:0.0004423166101332754
WV_1_PC_1_EH_0_PS_40, loss: 0.01649707928299904, avg_mse: 0.02582191489636898
current test mse: 0.025822
Iteration: 3131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45311930775642395, gen p mean: -0.11846672743558884, mean p set: 0.453695684671402
loss_pred:0.014627191238105297, decouple_loss:0.0003711290191859007
The modified gen p mean: 0.4515054523944855, gen p mean: -0.11877503991127014, mean p set: 0.45208099484443665The modified gen p mean: 0.45134469866752625, gen p mean: -0.11811541020870209, mean p set: 0.4519197940826416
loss_pred:0.015146947465837002, decouple_loss:0.0004158549418207258
loss_pred:0.014942171052098274, decouple_loss:0.00039781819214113057
Iteration: 3132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45217081904411316, gen p mean: -0.11643511801958084, mean p set: 0.4527485966682434
loss_pred:0.014728758484125137, decouple_loss:0.0003405117313377559
The modified gen p mean: 0.452166348695755, gen p mean: -0.11614962667226791, mean p set: 0.45274466276168823The modified gen p mean: 0.4501211643218994, gen p mean: -0.11699240654706955, mean p set: 0.45069798827171326
loss_pred:0.015204217284917831, decouple_loss:0.00038132918416522443
loss_pred:0.014226062223315239, decouple_loss:0.0003395418170839548
Iteration: 3133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537605345249176, gen p mean: -0.11704003065824509, mean p set: 0.4543396830558777
loss_pred:0.014647228643298149, decouple_loss:0.0003683961695060134
The modified gen p mean: 0.4513627290725708, gen p mean: -0.11684360355138779, mean p set: 0.45193958282470703
loss_pred:0.014617008157074451, decouple_loss:0.00038534155464731157
The modified gen p mean: 0.45107534527778625, gen p mean: -0.11758864670991898, mean p set: 0.45165136456489563
loss_pred:0.014709395356476307, decouple_loss:0.0003589080006349832
Iteration: 3134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510633945465088, gen p mean: -0.11567675322294235, mean p set: 0.4516381621360779
loss_pred:0.0151000265032053, decouple_loss:0.00035365851363167167
The modified gen p mean: 0.45097967982292175, gen p mean: -0.11829794198274612, mean p set: 0.4515587389469147
loss_pred:0.015231139957904816, decouple_loss:0.00039632467087358236
The modified gen p mean: 0.45194947719573975, gen p mean: -0.11812062561511993, mean p set: 0.4525245428085327
loss_pred:0.01421949453651905, decouple_loss:0.00046000219299457967
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 3135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889456033706665, gen p mean: -0.12666857242584229, mean p set: 0.4494676887989044
The modified gen p mean: 0.4463602602481842, gen p mean: -0.12854620814323425, mean p set: 0.44693389534950256loss_pred:0.014513210393488407, decouple_loss:0.0004304168978706002
loss_pred:0.014847767539322376, decouple_loss:0.0004749776271637529
The modified gen p mean: 0.44765931367874146, gen p mean: -0.13214126229286194, mean p set: 0.4482366442680359
loss_pred:0.013954631052911282, decouple_loss:0.0006686652777716517
Iteration: 3136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478376805782318, gen p mean: -0.12707093358039856, mean p set: 0.44841110706329346
loss_pred:0.015119445510208607, decouple_loss:0.0006233968888409436
The modified gen p mean: 0.44772395491600037, gen p mean: -0.1276969313621521, mean p set: 0.44829997420310974
loss_pred:0.014793315902352333, decouple_loss:0.0006041185115464032
The modified gen p mean: 0.4466902017593384, gen p mean: -0.1285555064678192, mean p set: 0.4472673535346985
loss_pred:0.015196768566966057, decouple_loss:0.0006054720724932849
Iteration: 3137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493858218193054, gen p mean: -0.12045939266681671, mean p set: 0.4499613046646118
loss_pred:0.01403767429292202, decouple_loss:0.00042587623465806246
The modified gen p mean: 0.4463427662849426, gen p mean: -0.12830086052417755, mean p set: 0.44691917300224304
The modified gen p mean: 0.44780823588371277, gen p mean: -0.12061072885990143, mean p set: 0.4483831226825714
loss_pred:0.014977940358221531, decouple_loss:0.0004790977109223604
loss_pred:0.014045532792806625, decouple_loss:0.000366357242455706
Iteration: 3138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482599198818207, gen p mean: -0.11281567811965942, mean p set: 0.4488346576690674
loss_pred:0.014286150224506855, decouple_loss:0.0004662947030737996
The modified gen p mean: 0.44852590560913086, gen p mean: -0.11247709393501282, mean p set: 0.4491024613380432
loss_pred:0.013746825978159904, decouple_loss:0.0006280486122705042
The modified gen p mean: 0.44793081283569336, gen p mean: -0.11065840721130371, mean p set: 0.44850608706474304
loss_pred:0.013537928462028503, decouple_loss:0.0005580724682658911
Iteration: 3139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478766918182373, gen p mean: -0.11119314283132553, mean p set: 0.4484524726867676
loss_pred:0.014586254954338074, decouple_loss:0.0003056685673072934
The modified gen p mean: 0.4482278525829315, gen p mean: -0.10935430973768234, mean p set: 0.4488039016723633
loss_pred:0.01354978047311306, decouple_loss:0.0004187290323898196
The modified gen p mean: 0.4481923282146454, gen p mean: -0.11282562464475632, mean p set: 0.44876906275749207
loss_pred:0.013423559255897999, decouple_loss:0.0005807874258607626
Iteration: 3140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890713691711426, gen p mean: -0.11033106595277786, mean p set: 0.449484258890152
loss_pred:0.014076851308345795, decouple_loss:0.0003861316363327205
The modified gen p mean: 0.4474171996116638, gen p mean: -0.11397796869277954, mean p set: 0.4479939937591553
The modified gen p mean: 0.44806233048439026, gen p mean: -0.11292744427919388, mean p set: 0.4486396908760071
loss_pred:0.014246040023863316, decouple_loss:0.0003301102842669934
loss_pred:0.01454856712371111, decouple_loss:0.0003423347952775657
2023-05-02 15:36:16 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11822623014450073, mean p set: 0.4502691626548767
loss_pred:0.016877440735697746, decouple_loss:0.0004988947184756398
The modified gen p mean: 0.449535071849823, gen p mean: -0.11138911545276642, mean p set: 0.4500633478164673
loss_pred:0.01610064134001732, decouple_loss:0.0005458251107484102
The modified gen p mean: 0.4498289227485657, gen p mean: -0.11130312085151672, mean p set: 0.45035696029663086
loss_pred:0.016366032883524895, decouple_loss:0.00047789793461561203
WV_1_PC_1_EH_0_PS_40, loss: 0.01647341623902321, avg_mse: 0.025735145434737206
current test mse: 0.025735
Iteration: 3141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474780559539795, gen p mean: -0.1100931242108345, mean p set: 0.4480552673339844
loss_pred:0.014116181060671806, decouple_loss:0.0005070703919045627
The modified gen p mean: 0.44829854369163513, gen p mean: -0.11192157864570618, mean p set: 0.448875367641449The modified gen p mean: 0.447698712348938, gen p mean: -0.10888607800006866, mean p set: 0.44827526807785034
loss_pred:0.014434183947741985, decouple_loss:0.000427606632001698
loss_pred:0.014608060009777546, decouple_loss:0.00043910249951295555
Iteration: 3142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688066840171814, gen p mean: -0.11027286946773529, mean p set: 0.4474572539329529
loss_pred:0.01428357232362032, decouple_loss:0.00037818020791746676
The modified gen p mean: 0.44682884216308594, gen p mean: -0.11152505874633789, mean p set: 0.44740498065948486
The modified gen p mean: 0.4476872384548187, gen p mean: -0.11438138782978058, mean p set: 0.44826218485832214
loss_pred:0.014340229332447052, decouple_loss:0.0003417089465074241
loss_pred:0.013922079466283321, decouple_loss:0.0004936286131851375
Iteration: 3143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476526975631714, gen p mean: -0.10700934380292892, mean p set: 0.4482302665710449
loss_pred:0.013942663557827473, decouple_loss:0.0004012084100395441
The modified gen p mean: 0.4475768506526947, gen p mean: -0.1179620623588562, mean p set: 0.44815701246261597
loss_pred:0.014348099939525127, decouple_loss:0.0003281816316302866
The modified gen p mean: 0.4472891390323639, gen p mean: -0.11368046700954437, mean p set: 0.4478660821914673
loss_pred:0.014168083667755127, decouple_loss:0.0003308091836515814
Iteration: 3144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677290320396423, gen p mean: -0.1227787658572197, mean p set: 0.4473487436771393
loss_pred:0.01457103993743658, decouple_loss:0.00041812943527475
The modified gen p mean: 0.4475233554840088, gen p mean: -0.12303336709737778, mean p set: 0.4481002688407898
loss_pred:0.014650840312242508, decouple_loss:0.00036649423418566585
The modified gen p mean: 0.4471696615219116, gen p mean: -0.11357230693101883, mean p set: 0.447747141122818
loss_pred:0.014338304288685322, decouple_loss:0.0004731563967652619
Iteration: 3145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484182298183441, gen p mean: -0.11448617279529572, mean p set: 0.4489942789077759
loss_pred:0.013794840313494205, decouple_loss:0.0003165786329191178
The modified gen p mean: 0.4467812776565552, gen p mean: -0.11909519881010056, mean p set: 0.44735386967658997
loss_pred:0.014670142903923988, decouple_loss:0.00036873199860565364
The modified gen p mean: 0.44785192608833313, gen p mean: -0.11830936372280121, mean p set: 0.4484281837940216
loss_pred:0.015020571649074554, decouple_loss:0.0003636341425590217
Iteration: 3146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44607868790626526, gen p mean: -0.11352667212486267, mean p set: 0.44665467739105225
loss_pred:0.01509936898946762, decouple_loss:0.00041670072823762894
The modified gen p mean: 0.4481126666069031, gen p mean: -0.11474724858999252, mean p set: 0.4486897885799408
loss_pred:0.013973226770758629, decouple_loss:0.0003451511438470334
The modified gen p mean: 0.4465099275112152, gen p mean: -0.11167236417531967, mean p set: 0.4470857083797455
loss_pred:0.015022275038063526, decouple_loss:0.00034697039518505335
Iteration: 3147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468216598033905, gen p mean: -0.12042196094989777, mean p set: 0.4473954439163208
loss_pred:0.014631295576691628, decouple_loss:0.00042376836063340306
The modified gen p mean: 0.44756248593330383, gen p mean: -0.11088793724775314, mean p set: 0.44813862442970276
loss_pred:0.014701779931783676, decouple_loss:0.00033035484375432134
The modified gen p mean: 0.4484812617301941, gen p mean: -0.12461020797491074, mean p set: 0.44905540347099304
loss_pred:0.01434650830924511, decouple_loss:0.000723932171240449
Iteration: 3148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801780581474304, gen p mean: -0.11669474840164185, mean p set: 0.44859424233436584
loss_pred:0.014509880915284157, decouple_loss:0.0003627064870670438
The modified gen p mean: 0.44908520579338074, gen p mean: -0.12131757289171219, mean p set: 0.4496593773365021
The modified gen p mean: 0.4478840231895447, gen p mean: -0.11434175074100494, mean p set: 0.44846025109291077
loss_pred:0.013486229814589024, decouple_loss:0.0005212966934777796
loss_pred:0.014048113487660885, decouple_loss:0.0005735150189138949
Iteration: 3149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782203435897827, gen p mean: -0.12325016409158707, mean p set: 0.4483965039253235
loss_pred:0.014025152660906315, decouple_loss:0.0004320459847804159
The modified gen p mean: 0.4473400413990021, gen p mean: -0.12415742129087448, mean p set: 0.44791606068611145
The modified gen p mean: 0.4471729099750519, gen p mean: -0.11849600076675415, mean p set: 0.4477500915527344
loss_pred:0.0141872214153409, decouple_loss:0.00029403483495116234
loss_pred:0.014079127460718155, decouple_loss:0.00036093220114707947
Iteration: 3150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726717472076416, gen p mean: -0.12226296216249466, mean p set: 0.4478446841239929
loss_pred:0.014478650875389576, decouple_loss:0.0005537891993299127
The modified gen p mean: 0.4471069574356079, gen p mean: -0.12078387290239334, mean p set: 0.4476827085018158
loss_pred:0.014172842726111412, decouple_loss:0.0005812200834043324
The modified gen p mean: 0.44794902205467224, gen p mean: -0.11546006798744202, mean p set: 0.4485248327255249
loss_pred:0.014135650359094143, decouple_loss:0.0003555402799975127
2023-05-02 15:38:22 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12406910955905914, mean p set: 0.4502691626548767
loss_pred:0.016839152202010155, decouple_loss:0.0004337173013482243
The modified gen p mean: 0.44953465461730957, gen p mean: -0.11752533912658691, mean p set: 0.4500633478164673
loss_pred:0.016170596703886986, decouple_loss:0.0004205970617476851
The modified gen p mean: 0.44982999563217163, gen p mean: -0.11724022030830383, mean p set: 0.45035696029663086
loss_pred:0.016407711431384087, decouple_loss:0.00036058653495274484
WV_1_PC_1_EH_0_PS_40, loss: 0.016492735594511032, avg_mse: 0.025800134986639023
current test mse: 0.0258
Iteration: 3151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837620854377747, gen p mean: -0.1188480332493782, mean p set: 0.44895458221435547
loss_pred:0.013609315268695354, decouple_loss:0.00040500523755326867
The modified gen p mean: 0.44800901412963867, gen p mean: -0.1176973432302475, mean p set: 0.4485850930213928
loss_pred:0.013733158819377422, decouple_loss:0.00032944214763119817
The modified gen p mean: 0.44968169927597046, gen p mean: -0.1212928518652916, mean p set: 0.45025789737701416
loss_pred:0.013513955287635326, decouple_loss:0.00040896053542383015
Iteration: 3152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475313425064087, gen p mean: -0.1144162192940712, mean p set: 0.44810861349105835
loss_pred:0.01389688067138195, decouple_loss:0.0002929834008682519
The modified gen p mean: 0.4492534101009369, gen p mean: -0.11441352963447571, mean p set: 0.4498293101787567The modified gen p mean: 0.4470360577106476, gen p mean: -0.11660368740558624, mean p set: 0.44761136174201965
loss_pred:0.014217083342373371, decouple_loss:0.00036800961242988706
loss_pred:0.014275392517447472, decouple_loss:0.00031335337553173304
Iteration: 3153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680845737457275, gen p mean: -0.11245563626289368, mean p set: 0.44738268852233887
loss_pred:0.014818410389125347, decouple_loss:0.00034244792186655104
The modified gen p mean: 0.44658729434013367, gen p mean: -0.11548404395580292, mean p set: 0.44716405868530273
loss_pred:0.014244269579648972, decouple_loss:0.0004002285422757268
The modified gen p mean: 0.4470648765563965, gen p mean: -0.11840998381376266, mean p set: 0.4476391673088074
loss_pred:0.014026268385350704, decouple_loss:0.00040208958671428263
Iteration: 3154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789090752601624, gen p mean: -0.12078645080327988, mean p set: 0.44846752285957336
loss_pred:0.01380248460918665, decouple_loss:0.0004500830254983157
The modified gen p mean: 0.4483393728733063, gen p mean: -0.11477264016866684, mean p set: 0.4489155113697052
loss_pred:0.01389290951192379, decouple_loss:0.0004968754365108907
The modified gen p mean: 0.4481670558452606, gen p mean: -0.1099405586719513, mean p set: 0.44874149560928345
loss_pred:0.013705456629395485, decouple_loss:0.0007110083242878318
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 3155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481319189071655, gen p mean: -0.10781197249889374, mean p set: 0.44870755076408386
loss_pred:0.01371294166892767, decouple_loss:0.00041456532198935747
The modified gen p mean: 0.44851943850517273, gen p mean: -0.11777801066637039, mean p set: 0.44909700751304626
loss_pred:0.013768601231276989, decouple_loss:0.0003806109307333827
The modified gen p mean: 0.44743672013282776, gen p mean: -0.12001907825469971, mean p set: 0.44801095128059387
loss_pred:0.015080209821462631, decouple_loss:0.00036851418553851545
Iteration: 3156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879254698753357, gen p mean: -0.12158927321434021, mean p set: 0.4493674635887146
loss_pred:0.014613873325288296, decouple_loss:0.00042921240674331784
The modified gen p mean: 0.4470473825931549, gen p mean: -0.11970721185207367, mean p set: 0.44762104749679565
loss_pred:0.015106060542166233, decouple_loss:0.0005325438687577844
The modified gen p mean: 0.4471069872379303, gen p mean: -0.12048666924238205, mean p set: 0.44768157601356506
loss_pred:0.014869580045342445, decouple_loss:0.0004783498588949442
Iteration: 3157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447466105222702, gen p mean: -0.11131491512060165, mean p set: 0.44804272055625916
loss_pred:0.01402051467448473, decouple_loss:0.0004676167736761272
The modified gen p mean: 0.44790953397750854, gen p mean: -0.12171505391597748, mean p set: 0.4484889805316925
loss_pred:0.014587068930268288, decouple_loss:0.00033660040935501456
The modified gen p mean: 0.4485974609851837, gen p mean: -0.12616296112537384, mean p set: 0.44917547702789307
loss_pred:0.014629808254539967, decouple_loss:0.0003336240188218653
Iteration: 3158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488345682621002, gen p mean: -0.12727759778499603, mean p set: 0.4494136571884155
loss_pred:0.013572216033935547, decouple_loss:0.0003155241720378399
The modified gen p mean: 0.4489068388938904, gen p mean: -0.13223543763160706, mean p set: 0.44948384165763855
loss_pred:0.014911801554262638, decouple_loss:0.00036314656608738005
The modified gen p mean: 0.4482676386833191, gen p mean: -0.1243685707449913, mean p set: 0.44884148240089417
loss_pred:0.013731182552874088, decouple_loss:0.00033667427487671375
Iteration: 3159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492223262786865, gen p mean: -0.1355098932981491, mean p set: 0.4497983753681183
loss_pred:0.014606875367462635, decouple_loss:0.0003823954612016678
The modified gen p mean: 0.44802412390708923, gen p mean: -0.13128970563411713, mean p set: 0.4485989212989807
loss_pred:0.01512190606445074, decouple_loss:0.000291423755697906
The modified gen p mean: 0.44709429144859314, gen p mean: -0.1319081038236618, mean p set: 0.44766971468925476
loss_pred:0.015082381665706635, decouple_loss:0.00038637255784124136
Iteration: 3160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44884684681892395, gen p mean: -0.134940043091774, mean p set: 0.44941920042037964
loss_pred:0.014901703223586082, decouple_loss:0.0003616816829890013
The modified gen p mean: 0.4493165612220764, gen p mean: -0.13558238744735718, mean p set: 0.449893057346344
The modified gen p mean: 0.4474359452724457, gen p mean: -0.1337774246931076, mean p set: 0.4480117857456207
loss_pred:0.014047541655600071, decouple_loss:0.00029451202135533094
loss_pred:0.014478016644716263, decouple_loss:0.00030229362891986966
2023-05-02 15:41:11 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1365721970796585, mean p set: 0.4502691626548767
loss_pred:0.016772542148828506, decouple_loss:0.00045581001904793084
The modified gen p mean: 0.4495384693145752, gen p mean: -0.12980443239212036, mean p set: 0.4500633478164673
The modified gen p mean: 0.4498293995857239, gen p mean: -0.1291523575782776, mean p set: 0.45035696029663086
loss_pred:0.016156567260622978, decouple_loss:0.0004251703794579953
loss_pred:0.01638522371649742, decouple_loss:0.00048668895033188164
WV_1_PC_1_EH_0_PS_40, loss: 0.016460906714200974, avg_mse: 0.025746259838342667
current test mse: 0.025746
Iteration: 3161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467254877090454, gen p mean: -0.13117052614688873, mean p set: 0.44730639457702637
loss_pred:0.014466321095824242, decouple_loss:0.00040979290497489274
The modified gen p mean: 0.44772592186927795, gen p mean: -0.13088856637477875, mean p set: 0.44830194115638733
loss_pred:0.014848316088318825, decouple_loss:0.0003709894372150302
The modified gen p mean: 0.44862616062164307, gen p mean: -0.13574686646461487, mean p set: 0.4492034912109375
loss_pred:0.014612074010074139, decouple_loss:0.00045867369044572115
Iteration: 3162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495052099227905, gen p mean: -0.12515829503536224, mean p set: 0.45008060336112976
loss_pred:0.014312372542917728, decouple_loss:0.00035196787212044
The modified gen p mean: 0.4482991099357605, gen p mean: -0.13373532891273499, mean p set: 0.44887539744377136The modified gen p mean: 0.44975027441978455, gen p mean: -0.12870743870735168, mean p set: 0.45032650232315063
loss_pred:0.014514679089188576, decouple_loss:0.00042730674613267183
loss_pred:0.014303511008620262, decouple_loss:0.0002979812561534345
Iteration: 3163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44911643862724304, gen p mean: -0.12780381739139557, mean p set: 0.4496924579143524
loss_pred:0.014037243090569973, decouple_loss:0.00044475513277575374
The modified gen p mean: 0.44798463582992554, gen p mean: -0.11720700562000275, mean p set: 0.4485621154308319
loss_pred:0.013958555646240711, decouple_loss:0.00048353837337344885
The modified gen p mean: 0.4481346309185028, gen p mean: -0.12075573951005936, mean p set: 0.4487088918685913
loss_pred:0.013755734078586102, decouple_loss:0.0003836578980553895
Iteration: 3164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494054615497589, gen p mean: -0.13301964104175568, mean p set: 0.4499812126159668
loss_pred:0.014477795921266079, decouple_loss:0.0005109132616780698
The modified gen p mean: 0.44790351390838623, gen p mean: -0.1272576004266739, mean p set: 0.44847777485847473
loss_pred:0.015339058823883533, decouple_loss:0.0005612527602352202
The modified gen p mean: 0.44778746366500854, gen p mean: -0.12593580782413483, mean p set: 0.44836267828941345
loss_pred:0.01516416110098362, decouple_loss:0.0005448644515126944
Iteration: 3165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477863013744354, gen p mean: -0.1314583122730255, mean p set: 0.44836223125457764
loss_pred:0.015184079296886921, decouple_loss:0.0003521838516462594
The modified gen p mean: 0.4484378397464752, gen p mean: -0.1315871626138687, mean p set: 0.44901350140571594
loss_pred:0.014555814675986767, decouple_loss:0.0003343435237184167
The modified gen p mean: 0.44717922806739807, gen p mean: -0.12866973876953125, mean p set: 0.4477550983428955
loss_pred:0.014664006419479847, decouple_loss:0.00046053441474214196
Iteration: 3166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44867852330207825, gen p mean: -0.1302822381258011, mean p set: 0.4492538273334503
loss_pred:0.014777587726712227, decouple_loss:0.00042387269786559045
The modified gen p mean: 0.4493196904659271, gen p mean: -0.1316453069448471, mean p set: 0.449893593788147
loss_pred:0.014276750385761261, decouple_loss:0.00032731128158047795
The modified gen p mean: 0.4482843279838562, gen p mean: -0.12292193621397018, mean p set: 0.4488604962825775
loss_pred:0.013640400022268295, decouple_loss:0.0004381334292702377
Iteration: 3167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477371871471405, gen p mean: -0.12892645597457886, mean p set: 0.4483141601085663
loss_pred:0.014420094899833202, decouple_loss:0.0003932612016797066
The modified gen p mean: 0.447552889585495, gen p mean: -0.12671059370040894, mean p set: 0.4481314718723297
The modified gen p mean: 0.44752296805381775, gen p mean: -0.13132181763648987, mean p set: 0.44810163974761963
loss_pred:0.015249445103108883, decouple_loss:0.00041681082802824676
loss_pred:0.014282084070146084, decouple_loss:0.0004396843141876161
Iteration: 3168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44970327615737915, gen p mean: -0.12836936116218567, mean p set: 0.4502778649330139
loss_pred:0.014826172031462193, decouple_loss:0.00034797118860296905
The modified gen p mean: 0.44731417298316956, gen p mean: -0.12696875631809235, mean p set: 0.44789305329322815
The modified gen p mean: 0.4487416744232178, gen p mean: -0.13069725036621094, mean p set: 0.449317067861557
loss_pred:0.014886072836816311, decouple_loss:0.00043105348595418036
loss_pred:0.014033251442015171, decouple_loss:0.0003740315733011812
Iteration: 3169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876253604888916, gen p mean: -0.12045532464981079, mean p set: 0.44933751225471497
loss_pred:0.01419174112379551, decouple_loss:0.00038423488149419427
The modified gen p mean: 0.44919663667678833, gen p mean: -0.12998409569263458, mean p set: 0.4497707486152649
loss_pred:0.01424386166036129, decouple_loss:0.000321746279951185
The modified gen p mean: 0.4475034475326538, gen p mean: -0.12796634435653687, mean p set: 0.4480784237384796
loss_pred:0.015175795182585716, decouple_loss:0.00031778402626514435
Iteration: 3170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716116786003113, gen p mean: -0.12680432200431824, mean p set: 0.44773876667022705
loss_pred:0.014742200262844563, decouple_loss:0.00038041805964894593
The modified gen p mean: 0.448661744594574, gen p mean: -0.12234009802341461, mean p set: 0.4492361843585968
loss_pred:0.01360249798744917, decouple_loss:0.00035392408608458936
The modified gen p mean: 0.4482817053794861, gen p mean: -0.12507009506225586, mean p set: 0.4488602578639984
loss_pred:0.01414103340357542, decouple_loss:0.00043057656148448586
2023-05-02 15:43:17 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1294592171907425, mean p set: 0.4502691626548767
loss_pred:0.01684553734958172, decouple_loss:0.0004061176732648164
The modified gen p mean: 0.44953489303588867, gen p mean: -0.12319879233837128, mean p set: 0.4500633478164673
loss_pred:0.016141444444656372, decouple_loss:0.0003670052974484861
The modified gen p mean: 0.44982704520225525, gen p mean: -0.12254304438829422, mean p set: 0.45035696029663086
loss_pred:0.016382180154323578, decouple_loss:0.0003434415557421744
WV_1_PC_1_EH_0_PS_40, loss: 0.016474997624754906, avg_mse: 0.025727756321430206
current test mse: 0.025728
Iteration: 3171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485515356063843, gen p mean: -0.12879972159862518, mean p set: 0.4491303265094757
loss_pred:0.013982436619699001, decouple_loss:0.0003344077558722347
The modified gen p mean: 0.4493531882762909, gen p mean: -0.12553027272224426, mean p set: 0.4499293565750122The modified gen p mean: 0.44837021827697754, gen p mean: -0.1258998066186905, mean p set: 0.448948472738266
loss_pred:0.014632915146648884, decouple_loss:0.0002993734087795019
loss_pred:0.015039244666695595, decouple_loss:0.00032076469506137073
Iteration: 3172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876277446746826, gen p mean: -0.13181187212467194, mean p set: 0.44933804869651794
loss_pred:0.013591164723038673, decouple_loss:0.000353206938598305
The modified gen p mean: 0.44854891300201416, gen p mean: -0.1277887523174286, mean p set: 0.44912344217300415The modified gen p mean: 0.4476071298122406, gen p mean: -0.12709055840969086, mean p set: 0.4481810927391052
loss_pred:0.013102252967655659, decouple_loss:0.00044940822408534586loss_pred:0.01510098297148943, decouple_loss:0.00045632279943674803
Iteration: 3173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485839605331421, gen p mean: -0.12258872389793396, mean p set: 0.4491572082042694
loss_pred:0.01375740859657526, decouple_loss:0.0003291316388640553
The modified gen p mean: 0.4477325677871704, gen p mean: -0.12767107784748077, mean p set: 0.4483092129230499
loss_pred:0.014288997277617455, decouple_loss:0.00038378630415536463
The modified gen p mean: 0.4484439194202423, gen p mean: -0.12802761793136597, mean p set: 0.44901934266090393
loss_pred:0.013767641969025135, decouple_loss:0.0003626389370765537
Iteration: 3174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804316759109497, gen p mean: -0.12904393672943115, mean p set: 0.4486178159713745
loss_pred:0.014519496820867062, decouple_loss:0.00040607343544252217
The modified gen p mean: 0.4489072561264038, gen p mean: -0.12544852495193481, mean p set: 0.449482798576355
loss_pred:0.014353486709296703, decouple_loss:0.00028813673998229206
The modified gen p mean: 0.44786885380744934, gen p mean: -0.13102009892463684, mean p set: 0.4484424889087677
loss_pred:0.014857284724712372, decouple_loss:0.0003188765258528292
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
NaN value num: 0
Iteration: 3175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513797163963318, gen p mean: -0.12261955440044403, mean p set: 0.4519580900669098
loss_pred:0.015016402117908001, decouple_loss:0.0005081637063995004
The modified gen p mean: 0.4509384036064148, gen p mean: -0.11666525900363922, mean p set: 0.45151615142822266
loss_pred:0.014738893136382103, decouple_loss:0.0004861368506681174
The modified gen p mean: 0.4524642527103424, gen p mean: -0.11850208789110184, mean p set: 0.4530409872531891
loss_pred:0.014393842779099941, decouple_loss:0.00044287522905506194
Iteration: 3176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45179325342178345, gen p mean: -0.11846963316202164, mean p set: 0.45237478613853455
loss_pred:0.015175485983490944, decouple_loss:0.0006619534688070416
The modified gen p mean: 0.4528777599334717, gen p mean: -0.11485738307237625, mean p set: 0.4534555673599243
loss_pred:0.014572745189070702, decouple_loss:0.0005025183781981468
The modified gen p mean: 0.450984388589859, gen p mean: -0.10857199132442474, mean p set: 0.4515622556209564
loss_pred:0.014896644279360771, decouple_loss:0.0003769516188185662
Iteration: 3177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45242366194725037, gen p mean: -0.10829785466194153, mean p set: 0.45300236344337463
loss_pred:0.014765898697078228, decouple_loss:0.00042889590258710086
The modified gen p mean: 0.4523174464702606, gen p mean: -0.11404313147068024, mean p set: 0.4528955817222595
loss_pred:0.014799876138567924, decouple_loss:0.0003754451754502952
The modified gen p mean: 0.4525159001350403, gen p mean: -0.1074882298707962, mean p set: 0.45309609174728394
loss_pred:0.014885267242789268, decouple_loss:0.00046570590347982943
Iteration: 3178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45308852195739746, gen p mean: -0.10751954466104507, mean p set: 0.4536671042442322
loss_pred:0.01426361221820116, decouple_loss:0.0005234787240624428
The modified gen p mean: 0.4506710171699524, gen p mean: -0.10875116288661957, mean p set: 0.45124828815460205
The modified gen p mean: 0.45031604170799255, gen p mean: -0.1066141277551651, mean p set: 0.45089107751846313
loss_pred:0.014251213520765305, decouple_loss:0.0004037225735373795
loss_pred:0.014571784064173698, decouple_loss:0.0004847222298849374
Iteration: 3179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452273964881897, gen p mean: -0.10882768034934998, mean p set: 0.45285117626190186
loss_pred:0.014592175371944904, decouple_loss:0.0003682700917124748
The modified gen p mean: 0.4506649374961853, gen p mean: -0.10786786675453186, mean p set: 0.45124077796936035
The modified gen p mean: 0.4501384198665619, gen p mean: -0.10838940739631653, mean p set: 0.4507158100605011
loss_pred:0.013887401670217514, decouple_loss:0.0006026553455740213
loss_pred:0.01414836198091507, decouple_loss:0.0007064844248816371
Iteration: 3180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45325422286987305, gen p mean: -0.10965494066476822, mean p set: 0.45383426547050476
The modified gen p mean: 0.4530279338359833, gen p mean: -0.10264700651168823, mean p set: 0.45360562205314636
loss_pred:0.014979037456214428, decouple_loss:0.00042963112355209887
loss_pred:0.014741201885044575, decouple_loss:0.00046334663056768477
The modified gen p mean: 0.4507276713848114, gen p mean: -0.10659787803888321, mean p set: 0.4513013958930969
loss_pred:0.014439384452998638, decouple_loss:0.0004492043808568269
2023-05-02 15:46:08 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1220034807920456, mean p set: 0.4502691626548767
loss_pred:0.01683223620057106, decouple_loss:0.00035057010245509446
The modified gen p mean: 0.44953635334968567, gen p mean: -0.11509647220373154, mean p set: 0.4500633478164673
loss_pred:0.016126636415719986, decouple_loss:0.0004514214815571904
The modified gen p mean: 0.4498288929462433, gen p mean: -0.11453265696763992, mean p set: 0.45035696029663086
loss_pred:0.01635623164474964, decouple_loss:0.00041632819920778275
WV_1_PC_1_EH_0_PS_40, loss: 0.016458675265312195, avg_mse: 0.025762883946299553
current test mse: 0.025763
Iteration: 3181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512406587600708, gen p mean: -0.10895925760269165, mean p set: 0.45181846618652344
loss_pred:0.014265385456383228, decouple_loss:0.0005841426318511367
The modified gen p mean: 0.45257583260536194, gen p mean: -0.10229719430208206, mean p set: 0.45315417647361755
The modified gen p mean: 0.45092183351516724, gen p mean: -0.11065677553415298, mean p set: 0.4514986276626587
loss_pred:0.014953375793993473, decouple_loss:0.000507754972204566
loss_pred:0.014794712886214256, decouple_loss:0.0004953311290591955
Iteration: 3182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45200666785240173, gen p mean: -0.10659642517566681, mean p set: 0.45258164405822754
loss_pred:0.014371296390891075, decouple_loss:0.0005111352656967938
The modified gen p mean: 0.452985554933548, gen p mean: -0.10553780943155289, mean p set: 0.4535618722438812The modified gen p mean: 0.4517067074775696, gen p mean: -0.10685451328754425, mean p set: 0.45228198170661926
loss_pred:0.014003465883433819, decouple_loss:0.0005950185004621744
loss_pred:0.014962858520448208, decouple_loss:0.0003961631446145475
Iteration: 3183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522862732410431, gen p mean: -0.11686617136001587, mean p set: 0.452862411737442
loss_pred:0.014607043005526066, decouple_loss:0.0005121988942846656
The modified gen p mean: 0.45200294256210327, gen p mean: -0.11026009917259216, mean p set: 0.4525795578956604
loss_pred:0.014545971527695656, decouple_loss:0.0003412982332520187
The modified gen p mean: 0.45121121406555176, gen p mean: -0.11218447983264923, mean p set: 0.4517892897129059
loss_pred:0.014390937052667141, decouple_loss:0.0005434083286672831
Iteration: 3184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508587419986725, gen p mean: -0.11523699760437012, mean p set: 0.45143428444862366
loss_pred:0.013853061012923717, decouple_loss:0.00046599595225416124
The modified gen p mean: 0.4526423215866089, gen p mean: -0.11798187345266342, mean p set: 0.45321789383888245
loss_pred:0.014462660998106003, decouple_loss:0.0003162681241519749
The modified gen p mean: 0.45199140906333923, gen p mean: -0.11395639926195145, mean p set: 0.4525703489780426
loss_pred:0.014368942938745022, decouple_loss:0.00036790300509892404
Iteration: 3185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450848788022995, gen p mean: -0.11274173110723495, mean p set: 0.45142796635627747
loss_pred:0.013741772621870041, decouple_loss:0.0003260097000747919
The modified gen p mean: 0.45134156942367554, gen p mean: -0.11986122280359268, mean p set: 0.45191919803619385
loss_pred:0.01412891037762165, decouple_loss:0.000387361302273348
The modified gen p mean: 0.45323461294174194, gen p mean: -0.11227647215127945, mean p set: 0.45381149649620056
loss_pred:0.01463119313120842, decouple_loss:0.00039690310950390995
Iteration: 3186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531099200248718, gen p mean: -0.11620455235242844, mean p set: 0.4536888301372528
loss_pred:0.01518296916037798, decouple_loss:0.00036733224987983704
The modified gen p mean: 0.4502207338809967, gen p mean: -0.11799362301826477, mean p set: 0.4507977068424225
loss_pred:0.014701816253364086, decouple_loss:0.0006486106431111693
The modified gen p mean: 0.4523565173149109, gen p mean: -0.11554430425167084, mean p set: 0.4529340863227844
loss_pred:0.014857816509902477, decouple_loss:0.0004591705510392785
Iteration: 3187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516563415527344, gen p mean: -0.11982571333646774, mean p set: 0.4522334337234497
loss_pred:0.014390842989087105, decouple_loss:0.00037228059954941273
The modified gen p mean: 0.4525279998779297, gen p mean: -0.11258381605148315, mean p set: 0.4531055986881256
The modified gen p mean: 0.45179980993270874, gen p mean: -0.11834611743688583, mean p set: 0.4523775279521942
loss_pred:0.014342880807816982, decouple_loss:0.00041433051228523254
loss_pred:0.01425268966704607, decouple_loss:0.00043501355685293674
Iteration: 3188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128723978996277, gen p mean: -0.11726577579975128, mean p set: 0.4518677592277527
The modified gen p mean: 0.45269709825515747, gen p mean: -0.10970551520586014, mean p set: 0.4532724618911743
loss_pred:0.014256522059440613, decouple_loss:0.00043224458931945264
loss_pred:0.014786102809011936, decouple_loss:0.0004008443502243608
The modified gen p mean: 0.45311158895492554, gen p mean: -0.1199989765882492, mean p set: 0.45368802547454834
loss_pred:0.015164338983595371, decouple_loss:0.0006016487022861838
Iteration: 3189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514768123626709, gen p mean: -0.11180685460567474, mean p set: 0.4520549178123474
loss_pred:0.015494638122618198, decouple_loss:0.00037083480856381357
The modified gen p mean: 0.4533267021179199, gen p mean: -0.10984896123409271, mean p set: 0.45390620827674866
The modified gen p mean: 0.4520711600780487, gen p mean: -0.11370078474283218, mean p set: 0.4526480436325073
loss_pred:0.01476371381431818, decouple_loss:0.0002914625802077353
loss_pred:0.014217380434274673, decouple_loss:0.0003088604426011443
Iteration: 3190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45286399126052856, gen p mean: -0.108675017952919, mean p set: 0.45344221591949463
The modified gen p mean: 0.4521794021129608, gen p mean: -0.11410336196422577, mean p set: 0.4527551829814911
loss_pred:0.014572177082300186, decouple_loss:0.00041247010813094676
loss_pred:0.014578518457710743, decouple_loss:0.0003508267109282315
The modified gen p mean: 0.45241761207580566, gen p mean: -0.10814154148101807, mean p set: 0.45299410820007324
loss_pred:0.014713856391608715, decouple_loss:0.0004383716732263565
2023-05-02 15:48:15 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12289527803659439, mean p set: 0.4502691626548767
loss_pred:0.01680668629705906, decouple_loss:0.0005233268020674586
The modified gen p mean: 0.4495355784893036, gen p mean: -0.11670313030481339, mean p set: 0.4500633478164673
loss_pred:0.016143150627613068, decouple_loss:0.0004798879090230912
The modified gen p mean: 0.4498284161090851, gen p mean: -0.11626823246479034, mean p set: 0.45035696029663086
loss_pred:0.016331611201167107, decouple_loss:0.0004027280956506729
WV_1_PC_1_EH_0_PS_40, loss: 0.016450583934783936, avg_mse: 0.025716254487633705
current test mse: 0.025716
Iteration: 3191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520263075828552, gen p mean: -0.11155006289482117, mean p set: 0.4526018798351288
loss_pred:0.014509353786706924, decouple_loss:0.0004801852337550372
The modified gen p mean: 0.4505140483379364, gen p mean: -0.11072488874197006, mean p set: 0.4510918855667114The modified gen p mean: 0.4506373405456543, gen p mean: -0.10795319825410843, mean p set: 0.45121341943740845
loss_pred:0.014094462618231773, decouple_loss:0.0005251155816949904loss_pred:0.014426155015826225, decouple_loss:0.00044630415504798293
Iteration: 3192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511517882347107, gen p mean: -0.10335218906402588, mean p set: 0.45172739028930664
loss_pred:0.01443078089505434, decouple_loss:0.00031214766204357147
The modified gen p mean: 0.4512917995452881, gen p mean: -0.1109560877084732, mean p set: 0.4518711566925049The modified gen p mean: 0.4507995545864105, gen p mean: -0.10762283205986023, mean p set: 0.451375812292099
loss_pred:0.014565960504114628, decouple_loss:0.00038390839472413063
loss_pred:0.015134559012949467, decouple_loss:0.0003559144679456949
Iteration: 3193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45196568965911865, gen p mean: -0.11319492757320404, mean p set: 0.45254209637641907
loss_pred:0.014493324793875217, decouple_loss:0.0004182083939667791
The modified gen p mean: 0.4513137936592102, gen p mean: -0.11803487688302994, mean p set: 0.45189008116722107
loss_pred:0.01472835149616003, decouple_loss:0.0005056174704805017
The modified gen p mean: 0.45354530215263367, gen p mean: -0.11266271024942398, mean p set: 0.45412078499794006
loss_pred:0.013813250698149204, decouple_loss:0.0005748404073528945
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
NaN value num: 0
Iteration: 3194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45017823576927185, gen p mean: -0.12043388187885284, mean p set: 0.450754314661026
loss_pred:0.016008572652935982, decouple_loss:0.0005162143497727811
The modified gen p mean: 0.4519766867160797, gen p mean: -0.1203237771987915, mean p set: 0.45255526900291443
loss_pred:0.016153959557414055, decouple_loss:0.0005124096642248333
The modified gen p mean: 0.4505121409893036, gen p mean: -0.12009082734584808, mean p set: 0.45108816027641296
loss_pred:0.01570110395550728, decouple_loss:0.00036912807263433933
Iteration: 3195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953736662864685, gen p mean: -0.1259271651506424, mean p set: 0.4501130282878876
loss_pred:0.015621156431734562, decouple_loss:0.0004878103791270405
The modified gen p mean: 0.4496857821941376, gen p mean: -0.1209145039319992, mean p set: 0.45026183128356934
loss_pred:0.01631632260978222, decouple_loss:0.00047529098810628057
The modified gen p mean: 0.44864341616630554, gen p mean: -0.12444671988487244, mean p set: 0.4492204785346985
loss_pred:0.016050973907113075, decouple_loss:0.0005029294989071786
Iteration: 3196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45034337043762207, gen p mean: -0.12324774265289307, mean p set: 0.45092108845710754
loss_pred:0.01657140627503395, decouple_loss:0.00044963578693568707
The modified gen p mean: 0.45001420378685, gen p mean: -0.12171147018671036, mean p set: 0.4505922794342041
loss_pred:0.01573481597006321, decouple_loss:0.0005396372871473432
The modified gen p mean: 0.44974711537361145, gen p mean: -0.12248559296131134, mean p set: 0.45032259821891785
loss_pred:0.016628790646791458, decouple_loss:0.00039565766928717494
Iteration: 3197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45022517442703247, gen p mean: -0.1187610998749733, mean p set: 0.4508011043071747
loss_pred:0.015933092683553696, decouple_loss:0.00038148180465213954
The modified gen p mean: 0.4501315951347351, gen p mean: -0.11994752287864685, mean p set: 0.4507102370262146
loss_pred:0.015697738155722618, decouple_loss:0.00039314874447882175
The modified gen p mean: 0.4500875174999237, gen p mean: -0.12210869044065475, mean p set: 0.4506663978099823
loss_pred:0.015594550408422947, decouple_loss:0.0004414031864143908
Iteration: 3198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501296281814575, gen p mean: -0.11918646097183228, mean p set: 0.45070680975914
loss_pred:0.016185186803340912, decouple_loss:0.00037209308356978
The modified gen p mean: 0.44982993602752686, gen p mean: -0.1140841394662857, mean p set: 0.45040687918663025
loss_pred:0.01574883796274662, decouple_loss:0.00033857623930089176
The modified gen p mean: 0.44924506545066833, gen p mean: -0.1209578886628151, mean p set: 0.44981908798217773
loss_pred:0.01529648993164301, decouple_loss:0.00033022408024407923
Iteration: 3199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893819093704224, gen p mean: -0.11996772885322571, mean p set: 0.4495159983634949
loss_pred:0.01570252701640129, decouple_loss:0.00037702004192397
The modified gen p mean: 0.4497552216053009, gen p mean: -0.12135512381792068, mean p set: 0.45033276081085205
loss_pred:0.015346136875450611, decouple_loss:0.0005360879586078227
The modified gen p mean: 0.4497164189815521, gen p mean: -0.11505559086799622, mean p set: 0.4502915143966675
loss_pred:0.015868254005908966, decouple_loss:0.0004210925253573805
Iteration: 3200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516329765319824, gen p mean: -0.11838634312152863, mean p set: 0.45220738649368286
loss_pred:0.015814734622836113, decouple_loss:0.0006549411918967962
The modified gen p mean: 0.449288010597229, gen p mean: -0.11723862588405609, mean p set: 0.44986405968666077
loss_pred:0.015879880636930466, decouple_loss:0.0004461861390154809
The modified gen p mean: 0.44888123869895935, gen p mean: -0.11284150928258896, mean p set: 0.449457585811615
loss_pred:0.0163115244358778, decouple_loss:0.0003688008291646838
2023-05-02 15:51:00 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.13332296907901764, mean p set: 0.4502691626548767
loss_pred:0.01687781512737274, decouple_loss:0.00043699663365259767
The modified gen p mean: 0.4495360255241394, gen p mean: -0.12674114108085632, mean p set: 0.4500633478164673
loss_pred:0.01620129495859146, decouple_loss:0.00043331659981049597
The modified gen p mean: 0.44982773065567017, gen p mean: -0.1259855031967163, mean p set: 0.45035696029663086
loss_pred:0.016416415572166443, decouple_loss:0.000409208529163152
WV_1_PC_1_EH_0_PS_40, loss: 0.016519835218787193, avg_mse: 0.025807339698076248
current test mse: 0.025807
Iteration: 3201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504610002040863, gen p mean: -0.11770475655794144, mean p set: 0.4510369300842285
loss_pred:0.01584419049322605, decouple_loss:0.0004986016429029405
The modified gen p mean: 0.4498905837535858, gen p mean: -0.11686673015356064, mean p set: 0.45046865940093994The modified gen p mean: 0.4513261020183563, gen p mean: -0.12143459171056747, mean p set: 0.45190247893333435
loss_pred:0.015400921925902367, decouple_loss:0.00041399296605959535
loss_pred:0.016395149752497673, decouple_loss:0.00045561918523162603
Iteration: 3202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44970983266830444, gen p mean: -0.1263837069272995, mean p set: 0.450285404920578
loss_pred:0.015735892578959465, decouple_loss:0.000479976850328967
The modified gen p mean: 0.4496798813343048, gen p mean: -0.12293117493391037, mean p set: 0.4502537250518799The modified gen p mean: 0.44934776425361633, gen p mean: -0.12758636474609375, mean p set: 0.44992440938949585
loss_pred:0.015118963085114956, decouple_loss:0.0004344996705185622
loss_pred:0.015487004071474075, decouple_loss:0.0004128857981413603
Iteration: 3203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449506014585495, gen p mean: -0.12319574505090714, mean p set: 0.45008236169815063
loss_pred:0.01620621420443058, decouple_loss:0.0005068198079243302
The modified gen p mean: 0.4485301375389099, gen p mean: -0.1257300078868866, mean p set: 0.44910579919815063
loss_pred:0.01570524461567402, decouple_loss:0.0004854313738178462
The modified gen p mean: 0.44949790835380554, gen p mean: -0.12258555740118027, mean p set: 0.45007210969924927
loss_pred:0.015123055316507816, decouple_loss:0.000503951741848141
Iteration: 3204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489268958568573, gen p mean: -0.12982773780822754, mean p set: 0.44950413703918457
loss_pred:0.016490034759044647, decouple_loss:0.0003812799695879221
The modified gen p mean: 0.449582040309906, gen p mean: -0.12775713205337524, mean p set: 0.45016080141067505
loss_pred:0.015352384187281132, decouple_loss:0.0003542316553648561
The modified gen p mean: 0.4503583312034607, gen p mean: -0.1242130920290947, mean p set: 0.45093461871147156
loss_pred:0.016188278794288635, decouple_loss:0.00041156509541906416
Iteration: 3205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486737847328186, gen p mean: -0.12953506410121918, mean p set: 0.4492502808570862
loss_pred:0.015402507036924362, decouple_loss:0.00040999657358042896
The modified gen p mean: 0.4493281841278076, gen p mean: -0.13119131326675415, mean p set: 0.44990405440330505
loss_pred:0.015509476885199547, decouple_loss:0.00041037966730073094
The modified gen p mean: 0.4495178461074829, gen p mean: -0.12246467173099518, mean p set: 0.4500959813594818
loss_pred:0.016018720343708992, decouple_loss:0.00040211674058809876
Iteration: 3206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491006135940552, gen p mean: -0.1180030107498169, mean p set: 0.44967761635780334
loss_pred:0.01589341089129448, decouple_loss:0.00038840866181999445
The modified gen p mean: 0.44947031140327454, gen p mean: -0.12885217368602753, mean p set: 0.4500441253185272
loss_pred:0.015843136236071587, decouple_loss:0.0004710910143330693
The modified gen p mean: 0.44928425550460815, gen p mean: -0.12782293558120728, mean p set: 0.44986429810523987
loss_pred:0.015613132156431675, decouple_loss:0.00047632979112677276
Iteration: 3207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491231441497803, gen p mean: -0.11627420783042908, mean p set: 0.4496959447860718
loss_pred:0.0160819198936224, decouple_loss:0.0004194326465949416
The modified gen p mean: 0.4491369128227234, gen p mean: -0.12913894653320312, mean p set: 0.4497132897377014
loss_pred:0.01530743483453989, decouple_loss:0.0003944278578273952
The modified gen p mean: 0.4485471844673157, gen p mean: -0.12566731870174408, mean p set: 0.44912293553352356
loss_pred:0.016348490491509438, decouple_loss:0.0003994448634330183
Iteration: 3208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501853585243225, gen p mean: -0.12099357694387436, mean p set: 0.4507644772529602
loss_pred:0.015858199447393417, decouple_loss:0.0003560507029760629
The modified gen p mean: 0.4479445517063141, gen p mean: -0.12530435621738434, mean p set: 0.4485178589820862
loss_pred:0.015252038836479187, decouple_loss:0.00037939430330879986
The modified gen p mean: 0.450534462928772, gen p mean: -0.12336675822734833, mean p set: 0.4511137008666992
loss_pred:0.015168700367212296, decouple_loss:0.00032016990007832646
Iteration: 3209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449308842420578, gen p mean: -0.11624132841825485, mean p set: 0.44988563656806946
loss_pred:0.015170401893556118, decouple_loss:0.0003683905233629048
The modified gen p mean: 0.44964873790740967, gen p mean: -0.12191932648420334, mean p set: 0.4502260982990265
loss_pred:0.015497147105634212, decouple_loss:0.00041485001565888524
The modified gen p mean: 0.44890061020851135, gen p mean: -0.12641026079654694, mean p set: 0.4494756758213043
loss_pred:0.014870797283947468, decouple_loss:0.00042901517008431256
Iteration: 3210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449409157037735, gen p mean: -0.1250409632921219, mean p set: 0.4499862790107727
loss_pred:0.015027960762381554, decouple_loss:0.00035895785549655557
The modified gen p mean: 0.45027631521224976, gen p mean: -0.12363708019256592, mean p set: 0.4508536458015442
The modified gen p mean: 0.4499349892139435, gen p mean: -0.11611227691173553, mean p set: 0.45051151514053345
loss_pred:0.015017399564385414, decouple_loss:0.0004765217599924654
loss_pred:0.01590602472424507, decouple_loss:0.00044692220399156213
2023-05-02 15:53:06 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13252386450767517, mean p set: 0.4502691626548767
loss_pred:0.016864242032170296, decouple_loss:0.0004561885434668511
The modified gen p mean: 0.4495314657688141, gen p mean: -0.12662556767463684, mean p set: 0.4500633478164673
loss_pred:0.01615341380238533, decouple_loss:0.0004641147970687598
The modified gen p mean: 0.44982776045799255, gen p mean: -0.12621882557868958, mean p set: 0.45035696029663086
loss_pred:0.016335247084498405, decouple_loss:0.0004804020863957703
WV_1_PC_1_EH_0_PS_40, loss: 0.016474314033985138, avg_mse: 0.02574443258345127
current test mse: 0.025744
Iteration: 3211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948866963386536, gen p mean: -0.12381751835346222, mean p set: 0.4500654339790344
loss_pred:0.01524877268821001, decouple_loss:0.0005055539077147841
The modified gen p mean: 0.44916799664497375, gen p mean: -0.12152803689241409, mean p set: 0.4497425854206085
loss_pred:0.015211042948067188, decouple_loss:0.00040636459016241133
The modified gen p mean: 0.448928564786911, gen p mean: -0.12542054057121277, mean p set: 0.4495038390159607
loss_pred:0.015145319513976574, decouple_loss:0.00036801694659516215
Iteration: 3212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852641224861145, gen p mean: -0.12196455895900726, mean p set: 0.4491018056869507
The modified gen p mean: 0.449552983045578, gen p mean: -0.12706832587718964, mean p set: 0.45012786984443665
loss_pred:0.015801802277565002, decouple_loss:0.00037954398430883884
loss_pred:0.014779475517570972, decouple_loss:0.00035040435614064336
The modified gen p mean: 0.44884419441223145, gen p mean: -0.12130559235811234, mean p set: 0.4494173526763916
loss_pred:0.01559215597808361, decouple_loss:0.00042774376925081015
Iteration: 3213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496787190437317, gen p mean: -0.12377100437879562, mean p set: 0.45025599002838135
loss_pred:0.015449550934135914, decouple_loss:0.0004181691037956625
The modified gen p mean: 0.4494808614253998, gen p mean: -0.12435857951641083, mean p set: 0.4500577449798584
loss_pred:0.014720547012984753, decouple_loss:0.0003831297217402607
The modified gen p mean: 0.4480108320713043, gen p mean: -0.12211406975984573, mean p set: 0.44858694076538086
loss_pred:0.016297314316034317, decouple_loss:0.0004101378144696355
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
NaN value num: 0
Iteration: 3214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513937532901764, gen p mean: -0.12358276546001434, mean p set: 0.45197123289108276
The modified gen p mean: 0.44945812225341797, gen p mean: -0.12229368090629578, mean p set: 0.4500344693660736
loss_pred:0.015666939318180084, decouple_loss:0.00044165970757603645
loss_pred:0.01546888705343008, decouple_loss:0.00040244811680167913
The modified gen p mean: 0.44933387637138367, gen p mean: -0.12356042116880417, mean p set: 0.4499092102050781
loss_pred:0.01429073978215456, decouple_loss:0.0003313017077744007
Iteration: 3215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492281675338745, gen p mean: -0.12573987245559692, mean p set: 0.4498039484024048
loss_pred:0.015226922929286957, decouple_loss:0.00046620884677395225
The modified gen p mean: 0.4483473002910614, gen p mean: -0.12463627755641937, mean p set: 0.4489240050315857
loss_pred:0.015001477673649788, decouple_loss:0.0006580890621989965
The modified gen p mean: 0.44779691100120544, gen p mean: -0.1308528035879135, mean p set: 0.44837433099746704
loss_pred:0.014868105761706829, decouple_loss:0.0004419040633365512
Iteration: 3216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498080015182495, gen p mean: -0.1238052025437355, mean p set: 0.45038262009620667
loss_pred:0.015163169242441654, decouple_loss:0.000388323183869943
The modified gen p mean: 0.4512042999267578, gen p mean: -0.1197139099240303, mean p set: 0.4517812132835388
loss_pred:0.014729367569088936, decouple_loss:0.000338427402311936
The modified gen p mean: 0.44963791966438293, gen p mean: -0.1270652413368225, mean p set: 0.4502134323120117
loss_pred:0.014649569988250732, decouple_loss:0.00039150778320617974
Iteration: 3217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44887879490852356, gen p mean: -0.1221664696931839, mean p set: 0.4494549334049225
loss_pred:0.015172909013926983, decouple_loss:0.00036677581374533474
The modified gen p mean: 0.44893306493759155, gen p mean: -0.12230125069618225, mean p set: 0.4495103359222412
loss_pred:0.015024757944047451, decouple_loss:0.00046459949226118624
The modified gen p mean: 0.4508068263530731, gen p mean: -0.12348473072052002, mean p set: 0.4513806104660034
loss_pred:0.014530343934893608, decouple_loss:0.00034039330785162747
Iteration: 3218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450176864862442, gen p mean: -0.12264754623174667, mean p set: 0.4507533609867096
loss_pred:0.014645424671471119, decouple_loss:0.000540232693310827
The modified gen p mean: 0.450920969247818, gen p mean: -0.11853791028261185, mean p set: 0.45149844884872437
loss_pred:0.014695661142468452, decouple_loss:0.0005937810055911541
The modified gen p mean: 0.44839510321617126, gen p mean: -0.1229206994175911, mean p set: 0.4489700198173523
loss_pred:0.014952611178159714, decouple_loss:0.0005953101790510118
Iteration: 3219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488094747066498, gen p mean: -0.11694266647100449, mean p set: 0.4493871033191681
loss_pred:0.014233781024813652, decouple_loss:0.0003370949416421354
The modified gen p mean: 0.4497167468070984, gen p mean: -0.12008647620677948, mean p set: 0.4502924084663391
loss_pred:0.014541534706950188, decouple_loss:0.00038577266968786716
The modified gen p mean: 0.4489997923374176, gen p mean: -0.11871813237667084, mean p set: 0.4495765268802643
loss_pred:0.014803432859480381, decouple_loss:0.00042542381561361253
Iteration: 3220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501372277736664, gen p mean: -0.11626898497343063, mean p set: 0.45071372389793396
loss_pred:0.014407921582460403, decouple_loss:0.00042393026524223387
The modified gen p mean: 0.44865772128105164, gen p mean: -0.11206061393022537, mean p set: 0.44923514127731323
loss_pred:0.01520736888051033, decouple_loss:0.0004293708479963243
The modified gen p mean: 0.4486600458621979, gen p mean: -0.11492110043764114, mean p set: 0.4492340683937073
loss_pred:0.015459317713975906, decouple_loss:0.0003755364450626075
2023-05-02 15:55:47 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12351489067077637, mean p set: 0.4502691626548767
loss_pred:0.016841089352965355, decouple_loss:0.0005624753539450467
The modified gen p mean: 0.44953277707099915, gen p mean: -0.11772719770669937, mean p set: 0.4500633478164673
loss_pred:0.016182737424969673, decouple_loss:0.0004970059380866587
The modified gen p mean: 0.4498279094696045, gen p mean: -0.11740736663341522, mean p set: 0.45035696029663086
loss_pred:0.016422132030129433, decouple_loss:0.0004831034457311034
WV_1_PC_1_EH_0_PS_40, loss: 0.016507696360349655, avg_mse: 0.02581055462360382
current test mse: 0.025811
Iteration: 3221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803011417388916, gen p mean: -0.11918671429157257, mean p set: 0.44860586524009705
loss_pred:0.015242498368024826, decouple_loss:0.0005430633318610489
The modified gen p mean: 0.44954177737236023, gen p mean: -0.11237959563732147, mean p set: 0.45011773705482483The modified gen p mean: 0.4482424855232239, gen p mean: -0.10956530272960663, mean p set: 0.4488198161125183
loss_pred:0.015417912043631077, decouple_loss:0.0004365411587059498
loss_pred:0.01566195674240589, decouple_loss:0.0003994383732788265
Iteration: 3222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817468523979187, gen p mean: -0.1125371977686882, mean p set: 0.4487510621547699
loss_pred:0.015205823816359043, decouple_loss:0.0005885505233891308
The modified gen p mean: 0.44930845499038696, gen p mean: -0.11425308138132095, mean p set: 0.4498836100101471The modified gen p mean: 0.4489274322986603, gen p mean: -0.11321491748094559, mean p set: 0.4495048522949219
loss_pred:0.015105747617781162, decouple_loss:0.00046108028618618846
loss_pred:0.015217219479382038, decouple_loss:0.00042414330528117716
Iteration: 3223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507732689380646, gen p mean: -0.11125399172306061, mean p set: 0.4513488709926605
The modified gen p mean: 0.4489901065826416, gen p mean: -0.11484014987945557, mean p set: 0.449567049741745
loss_pred:0.014788647182285786, decouple_loss:0.00040242233080789447
loss_pred:0.015171614475548267, decouple_loss:0.0003550408291630447
The modified gen p mean: 0.45042020082473755, gen p mean: -0.11854413896799088, mean p set: 0.45099538564682007
loss_pred:0.014289104379713535, decouple_loss:0.0003474348341114819
Iteration: 3224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488755166530609, gen p mean: -0.11676482856273651, mean p set: 0.4494513273239136
loss_pred:0.014850418083369732, decouple_loss:0.00039909506449475884
The modified gen p mean: 0.4481535851955414, gen p mean: -0.11980407685041428, mean p set: 0.44873207807540894
loss_pred:0.014977632090449333, decouple_loss:0.0004979121149517596
The modified gen p mean: 0.4495638906955719, gen p mean: -0.11958853155374527, mean p set: 0.45014408230781555
loss_pred:0.014994223602116108, decouple_loss:0.0004500073555391282
Iteration: 3225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44923728704452515, gen p mean: -0.12095244973897934, mean p set: 0.44981491565704346
loss_pred:0.015784071758389473, decouple_loss:0.0005122629809193313
The modified gen p mean: 0.4488838016986847, gen p mean: -0.12124711275100708, mean p set: 0.4494612514972687
loss_pred:0.0151798315346241, decouple_loss:0.0005257564480416477
The modified gen p mean: 0.45002251863479614, gen p mean: -0.12240339815616608, mean p set: 0.45059719681739807
loss_pred:0.014297429472208023, decouple_loss:0.0005741812055930495
Iteration: 3226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500957727432251, gen p mean: -0.12187785655260086, mean p set: 0.45067182183265686
loss_pred:0.01420409232378006, decouple_loss:0.00044674804667010903
The modified gen p mean: 0.4493516981601715, gen p mean: -0.12566567957401276, mean p set: 0.4499289393424988
loss_pred:0.01460221502929926, decouple_loss:0.0003891213855240494
The modified gen p mean: 0.44896796345710754, gen p mean: -0.12154296040534973, mean p set: 0.44954103231430054
loss_pred:0.015501200221478939, decouple_loss:0.00042307598050683737
Iteration: 3227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860029220581055, gen p mean: -0.11894603818655014, mean p set: 0.4491738975048065
loss_pred:0.015371086075901985, decouple_loss:0.0005005475832149386
The modified gen p mean: 0.4507187604904175, gen p mean: -0.11711272597312927, mean p set: 0.45129647850990295
The modified gen p mean: 0.4516625702381134, gen p mean: -0.12095227092504501, mean p set: 0.45223987102508545
loss_pred:0.01479779276996851, decouple_loss:0.0004685952153522521
loss_pred:0.014326573349535465, decouple_loss:0.0003975778236053884
Iteration: 3228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521496295928955, gen p mean: -0.12370013445615768, mean p set: 0.4527266025543213
loss_pred:0.015178580768406391, decouple_loss:0.00048652649275027215
The modified gen p mean: 0.448918879032135, gen p mean: -0.12255029380321503, mean p set: 0.4494934380054474
The modified gen p mean: 0.4493713974952698, gen p mean: -0.12365146726369858, mean p set: 0.4499458968639374
loss_pred:0.01443976629525423, decouple_loss:0.0005343478405848145
loss_pred:0.014829587191343307, decouple_loss:0.00028998497873544693
Iteration: 3229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45237401127815247, gen p mean: -0.11898688971996307, mean p set: 0.4529503583908081
loss_pred:0.014847432263195515, decouple_loss:0.0006696567288599908
The modified gen p mean: 0.44967618584632874, gen p mean: -0.1228751614689827, mean p set: 0.4502566158771515
loss_pred:0.01542475912719965, decouple_loss:0.0005999593413434923
The modified gen p mean: 0.4505341351032257, gen p mean: -0.1211300864815712, mean p set: 0.4511091411113739
loss_pred:0.01450643315911293, decouple_loss:0.0005687521770596504
Iteration: 3230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480440020561218, gen p mean: -0.121340312063694, mean p set: 0.44862303137779236
loss_pred:0.014400266110897064, decouple_loss:0.00044794767745770514
The modified gen p mean: 0.44752126932144165, gen p mean: -0.12264879047870636, mean p set: 0.44809725880622864
The modified gen p mean: 0.4517543613910675, gen p mean: -0.11812656372785568, mean p set: 0.4523291289806366
loss_pred:0.014736034907400608, decouple_loss:0.000510428857523948
loss_pred:0.014662696979939938, decouple_loss:0.000515103864017874
2023-05-02 15:57:53 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1300961822271347, mean p set: 0.4502691626548767
loss_pred:0.016838302835822105, decouple_loss:0.0005660145543515682
The modified gen p mean: 0.44953295588493347, gen p mean: -0.1246408224105835, mean p set: 0.4500633478164673
loss_pred:0.016196653246879578, decouple_loss:0.0005178466672077775
The modified gen p mean: 0.4498307704925537, gen p mean: -0.12405013293027878, mean p set: 0.45035696029663086
loss_pred:0.016432741656899452, decouple_loss:0.0005959230475127697
WV_1_PC_1_EH_0_PS_40, loss: 0.01651722937822342, avg_mse: 0.025837436318397522
current test mse: 0.025837
Iteration: 3231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522554874420166, gen p mean: -0.118741475045681, mean p set: 0.4528312385082245
loss_pred:0.01444974448531866, decouple_loss:0.0006007603369653225
The modified gen p mean: 0.45177191495895386, gen p mean: -0.12095765769481659, mean p set: 0.45234742760658264The modified gen p mean: 0.44890671968460083, gen p mean: -0.11853805184364319, mean p set: 0.44948065280914307
loss_pred:0.014554955996572971, decouple_loss:0.0005638694856315851loss_pred:0.014761249534785748, decouple_loss:0.0003322010743431747
Iteration: 3232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486575126647949, gen p mean: -0.12093017995357513, mean p set: 0.4492347836494446
loss_pred:0.014914949424564838, decouple_loss:0.000495267566293478
The modified gen p mean: 0.4499332010746002, gen p mean: -0.12287480384111404, mean p set: 0.450508713722229The modified gen p mean: 0.4506019353866577, gen p mean: -0.11886923760175705, mean p set: 0.45117899775505066
loss_pred:0.013735847547650337, decouple_loss:0.0005195754347369075
loss_pred:0.014441151171922684, decouple_loss:0.00037717793020419776
Iteration: 3233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500872790813446, gen p mean: -0.12251810729503632, mean p set: 0.450663685798645The modified gen p mean: 0.44828447699546814, gen p mean: -0.12284573912620544, mean p set: 0.44886186718940735
loss_pred:0.01421691756695509, decouple_loss:0.0006491067470051348
loss_pred:0.015448890626430511, decouple_loss:0.0004313821846153587
The modified gen p mean: 0.4496000111103058, gen p mean: -0.12482018768787384, mean p set: 0.45017653703689575
loss_pred:0.01545408833771944, decouple_loss:0.0008537022513337433
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 3234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476819634437561, gen p mean: -0.12465741485357285, mean p set: 0.4482579529285431
loss_pred:0.01413196511566639, decouple_loss:0.0004279103013686836
The modified gen p mean: 0.4482775330543518, gen p mean: -0.12510505318641663, mean p set: 0.44885557889938354
loss_pred:0.01384518388658762, decouple_loss:0.0005241562030278146
The modified gen p mean: 0.44865190982818604, gen p mean: -0.12560151517391205, mean p set: 0.4492274820804596
loss_pred:0.013757233507931232, decouple_loss:0.0006397379911504686
Iteration: 3235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816523790359497, gen p mean: -0.1342073678970337, mean p set: 0.4487411379814148
loss_pred:0.013648074120283127, decouple_loss:0.0003411149082239717
The modified gen p mean: 0.45079225301742554, gen p mean: -0.12635134160518646, mean p set: 0.4513660967350006
loss_pred:0.01410291064530611, decouple_loss:0.00035757236764766276
The modified gen p mean: 0.4484091103076935, gen p mean: -0.12428057938814163, mean p set: 0.44898515939712524
loss_pred:0.013905913569033146, decouple_loss:0.0004562284448184073
Iteration: 3236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931352138519287, gen p mean: -0.12293581664562225, mean p set: 0.44988885521888733
loss_pred:0.014397593215107918, decouple_loss:0.0006409146008081734
The modified gen p mean: 0.44866809248924255, gen p mean: -0.11912675946950912, mean p set: 0.4492424428462982
loss_pred:0.013812565244734287, decouple_loss:0.0005097852554172277
The modified gen p mean: 0.44866394996643066, gen p mean: -0.12663084268569946, mean p set: 0.4492388665676117
loss_pred:0.01349663082510233, decouple_loss:0.00037351646460592747
Iteration: 3237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481925666332245, gen p mean: -0.1308138221502304, mean p set: 0.4487667679786682
loss_pred:0.014037048444151878, decouple_loss:0.00045215219142846763
The modified gen p mean: 0.447513222694397, gen p mean: -0.12319325655698776, mean p set: 0.44809263944625854
The modified gen p mean: 0.4482383728027344, gen p mean: -0.12175673246383667, mean p set: 0.4488143026828766
loss_pred:0.013744576834142208, decouple_loss:0.00026337034069001675
loss_pred:0.014007547870278358, decouple_loss:0.00039156811544671655
Iteration: 3238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487431049346924, gen p mean: -0.11895626038312912, mean p set: 0.449319064617157
loss_pred:0.014013991691172123, decouple_loss:0.00034118560142815113
The modified gen p mean: 0.4469762146472931, gen p mean: -0.130209282040596, mean p set: 0.44755133986473083
loss_pred:0.013309638015925884, decouple_loss:0.00050042086513713
The modified gen p mean: 0.44899073243141174, gen p mean: -0.1269090473651886, mean p set: 0.4495646357536316
loss_pred:0.014001899398863316, decouple_loss:0.00041818578029051423
Iteration: 3239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44629886746406555, gen p mean: -0.13103699684143066, mean p set: 0.4468747675418854
loss_pred:0.014345931820571423, decouple_loss:0.0004446626699063927
The modified gen p mean: 0.44869691133499146, gen p mean: -0.12848909199237823, mean p set: 0.4492718279361725
loss_pred:0.01431319210678339, decouple_loss:0.0004093773022759706
The modified gen p mean: 0.4480803310871124, gen p mean: -0.13013342022895813, mean p set: 0.4486563205718994
loss_pred:0.013383974321186543, decouple_loss:0.0003185546665918082
Iteration: 3240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473895728588104, gen p mean: -0.1246483251452446, mean p set: 0.44796544313430786
loss_pred:0.013940781354904175, decouple_loss:0.00033811930916272104
The modified gen p mean: 0.4486226439476013, gen p mean: -0.11703328788280487, mean p set: 0.44919851422309875
The modified gen p mean: 0.4500860273838043, gen p mean: -0.12433554977178574, mean p set: 0.45066288113594055
loss_pred:0.013978530652821064, decouple_loss:0.00047580900718457997
loss_pred:0.013695533387362957, decouple_loss:0.00032063282560557127
2023-05-02 16:00:37 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12909719347953796, mean p set: 0.4502691626548767
loss_pred:0.016833044588565826, decouple_loss:0.0004337197751738131
The modified gen p mean: 0.4495319724082947, gen p mean: -0.12286579608917236, mean p set: 0.4500633478164673
loss_pred:0.016129635274410248, decouple_loss:0.0004002397181466222
The modified gen p mean: 0.4498281180858612, gen p mean: -0.12198039144277573, mean p set: 0.45035696029663086
loss_pred:0.016444452106952667, decouple_loss:0.000542367110028863
WV_1_PC_1_EH_0_PS_40, loss: 0.016491983085870743, avg_mse: 0.02584795281291008
current test mse: 0.025848
Iteration: 3241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478665292263031, gen p mean: -0.12334353476762772, mean p set: 0.44844454526901245
loss_pred:0.013429862447082996, decouple_loss:0.0003117806336376816
The modified gen p mean: 0.4474978744983673, gen p mean: -0.1254206746816635, mean p set: 0.4480714499950409The modified gen p mean: 0.44606155157089233, gen p mean: -0.12445186823606491, mean p set: 0.44663533568382263
loss_pred:0.013466320931911469, decouple_loss:0.0004067887784913182
loss_pred:0.013753678649663925, decouple_loss:0.0003195379103999585
Iteration: 3242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746920466423035, gen p mean: -0.12954910099506378, mean p set: 0.44804564118385315
loss_pred:0.01400038879364729, decouple_loss:0.00035339687019586563
The modified gen p mean: 0.44913554191589355, gen p mean: -0.1303274780511856, mean p set: 0.44971415400505066The modified gen p mean: 0.4482170343399048, gen p mean: -0.12357289344072342, mean p set: 0.44879457354545593
loss_pred:0.01435121800750494, decouple_loss:0.00042936025420203805
loss_pred:0.013785608112812042, decouple_loss:0.00032267646747641265
Iteration: 3243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44646671414375305, gen p mean: -0.12631632387638092, mean p set: 0.44704070687294006
The modified gen p mean: 0.44856274127960205, gen p mean: -0.1164863333106041, mean p set: 0.44913890957832336
loss_pred:0.013481643982231617, decouple_loss:0.0003901929303538054
loss_pred:0.013841354288160801, decouple_loss:0.0005104481242597103
The modified gen p mean: 0.4471803307533264, gen p mean: -0.12971201539039612, mean p set: 0.44775673747062683
loss_pred:0.013377413153648376, decouple_loss:0.00026659510331228375
Iteration: 3244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492585361003876, gen p mean: -0.11680324375629425, mean p set: 0.44983553886413574
loss_pred:0.013684787787497044, decouple_loss:0.00045936505193822086
The modified gen p mean: 0.45010820031166077, gen p mean: -0.12214150279760361, mean p set: 0.450685054063797
loss_pred:0.014026083052158356, decouple_loss:0.00037018730654381216
The modified gen p mean: 0.4481903612613678, gen p mean: -0.12217652052640915, mean p set: 0.44876742362976074
loss_pred:0.014045572839677334, decouple_loss:0.00034246424911543727
Iteration: 3245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482514262199402, gen p mean: -0.12795484066009521, mean p set: 0.4488264322280884
loss_pred:0.013739651069045067, decouple_loss:0.00031557519105263054
The modified gen p mean: 0.4481574296951294, gen p mean: -0.12248578667640686, mean p set: 0.4487343728542328
loss_pred:0.014629630371928215, decouple_loss:0.00036941765574738383
The modified gen p mean: 0.4480109214782715, gen p mean: -0.12143644690513611, mean p set: 0.4485855996608734
loss_pred:0.01396208070218563, decouple_loss:0.0003695852356031537
Iteration: 3246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479514956474304, gen p mean: -0.12055572122335434, mean p set: 0.4485265016555786
loss_pred:0.013181005604565144, decouple_loss:0.000352527538780123
The modified gen p mean: 0.44851967692375183, gen p mean: -0.12329225242137909, mean p set: 0.4490965008735657
loss_pred:0.014043441973626614, decouple_loss:0.000347901601344347
The modified gen p mean: 0.44853922724723816, gen p mean: -0.1216696947813034, mean p set: 0.4491168260574341
loss_pred:0.014312642626464367, decouple_loss:0.000382515718229115
Iteration: 3247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777435064315796, gen p mean: -0.1234142929315567, mean p set: 0.4483499228954315
loss_pred:0.013798192143440247, decouple_loss:0.00031832451350055635
The modified gen p mean: 0.44744765758514404, gen p mean: -0.12239627540111542, mean p set: 0.4480225145816803
The modified gen p mean: 0.44765400886535645, gen p mean: -0.12151020020246506, mean p set: 0.4482307732105255
loss_pred:0.014444723725318909, decouple_loss:0.0003571458801161498
loss_pred:0.013645922765135765, decouple_loss:0.0004076267941854894
Iteration: 3248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44641655683517456, gen p mean: -0.12786321341991425, mean p set: 0.446990966796875
loss_pred:0.013904905878007412, decouple_loss:0.00037110160337761045
The modified gen p mean: 0.44825810194015503, gen p mean: -0.11615102738142014, mean p set: 0.44883567094802856
loss_pred:0.014068803749978542, decouple_loss:0.0003404530871193856
The modified gen p mean: 0.4486241638660431, gen p mean: -0.1167251393198967, mean p set: 0.44920095801353455
loss_pred:0.013642041012644768, decouple_loss:0.00039086578181013465
Iteration: 3249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478329122066498, gen p mean: -0.11857757717370987, mean p set: 0.448408842086792
loss_pred:0.013991272076964378, decouple_loss:0.0003878721909131855
The modified gen p mean: 0.4477289617061615, gen p mean: -0.1197115033864975, mean p set: 0.44830387830734253
loss_pred:0.014553209766745567, decouple_loss:0.000417223694967106
The modified gen p mean: 0.4466956555843353, gen p mean: -0.12340684980154037, mean p set: 0.4472724497318268
loss_pred:0.013794735074043274, decouple_loss:0.00044477000483311713
Iteration: 3250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837960600852966, gen p mean: -0.12655040621757507, mean p set: 0.44895556569099426
loss_pred:0.014224804006516933, decouple_loss:0.0004988262080587447
The modified gen p mean: 0.4480080306529999, gen p mean: -0.11890552192926407, mean p set: 0.4485826790332794
loss_pred:0.01370358094573021, decouple_loss:0.00048167622298933566
The modified gen p mean: 0.4495260417461395, gen p mean: -0.12419608980417252, mean p set: 0.4501021206378937
loss_pred:0.013616441749036312, decouple_loss:0.00034537649480625987
2023-05-02 16:02:45 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12792964279651642, mean p set: 0.4502691626548767
loss_pred:0.016854822635650635, decouple_loss:0.00037109755794517696
The modified gen p mean: 0.4495319724082947, gen p mean: -0.12242219597101212, mean p set: 0.4500633478164673
loss_pred:0.016178200021386147, decouple_loss:0.000401249184506014
The modified gen p mean: 0.4498274028301239, gen p mean: -0.12160596996545792, mean p set: 0.45035696029663086
loss_pred:0.016529839485883713, decouple_loss:0.0004045786045026034
WV_1_PC_1_EH_0_PS_40, loss: 0.016540570184588432, avg_mse: 0.02589176781475544
current test mse: 0.025892
Iteration: 3251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472874104976654, gen p mean: -0.12726140022277832, mean p set: 0.4478631317615509
loss_pred:0.014019131660461426, decouple_loss:0.00043201749213039875
The modified gen p mean: 0.447697252035141, gen p mean: -0.12493765354156494, mean p set: 0.4482734203338623The modified gen p mean: 0.4475739598274231, gen p mean: -0.12245241552591324, mean p set: 0.4481477439403534
loss_pred:0.013650944456458092, decouple_loss:0.00040863335016183555
loss_pred:0.01392416376620531, decouple_loss:0.00029416504548862576
Iteration: 3252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446391761302948, gen p mean: -0.1304505318403244, mean p set: 0.44696733355522156The modified gen p mean: 0.44831061363220215, gen p mean: -0.1223573237657547, mean p set: 0.4488862454891205
loss_pred:0.013434839434921741, decouple_loss:0.00037787400651723146
loss_pred:0.014019923284649849, decouple_loss:0.0003961378533858806
The modified gen p mean: 0.44796478748321533, gen p mean: -0.12056601792573929, mean p set: 0.44854292273521423
loss_pred:0.013527941890060902, decouple_loss:0.0003132379206363112
Iteration: 3253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447792112827301, gen p mean: -0.13543424010276794, mean p set: 0.44836726784706116
The modified gen p mean: 0.4480911195278168, gen p mean: -0.12899468839168549, mean p set: 0.44866693019866943
loss_pred:0.01308247447013855, decouple_loss:0.00033593070111237466
loss_pred:0.01380893774330616, decouple_loss:0.0003744791611097753
The modified gen p mean: 0.4472227990627289, gen p mean: -0.12896065413951874, mean p set: 0.44780102372169495
loss_pred:0.01443943940103054, decouple_loss:0.00034046536893583834
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 3254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467049241065979, gen p mean: -0.13386930525302887, mean p set: 0.44728177785873413
loss_pred:0.015169281512498856, decouple_loss:0.0004378740268293768
The modified gen p mean: 0.4475574195384979, gen p mean: -0.13366037607192993, mean p set: 0.44813334941864014
loss_pred:0.014383720234036446, decouple_loss:0.0002939245605375618
The modified gen p mean: 0.4495134949684143, gen p mean: -0.1308353841304779, mean p set: 0.4500883221626282
loss_pred:0.014074243605136871, decouple_loss:0.00040256933425553143
Iteration: 3255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676417112350464, gen p mean: -0.12780256569385529, mean p set: 0.44733917713165283
loss_pred:0.014638029970228672, decouple_loss:0.0003152973367832601
The modified gen p mean: 0.4462611675262451, gen p mean: -0.13117080926895142, mean p set: 0.4468388855457306
loss_pred:0.015003188513219357, decouple_loss:0.0003864041354972869
The modified gen p mean: 0.44835567474365234, gen p mean: -0.12807254493236542, mean p set: 0.4489316940307617
loss_pred:0.014100216329097748, decouple_loss:0.0003454616235103458
Iteration: 3256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475368559360504, gen p mean: -0.13022582232952118, mean p set: 0.4481140077114105
loss_pred:0.014180806465446949, decouple_loss:0.00047251858632080257
The modified gen p mean: 0.4465077519416809, gen p mean: -0.12959149479866028, mean p set: 0.4470820426940918
The modified gen p mean: 0.4482206404209137, gen p mean: -0.1293725073337555, mean p set: 0.448797345161438
loss_pred:0.0144450468942523, decouple_loss:0.0004455690796021372
loss_pred:0.014699652791023254, decouple_loss:0.00032651229412294924
Iteration: 3257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469392001628876, gen p mean: -0.12271896004676819, mean p set: 0.44751542806625366
loss_pred:0.014124678447842598, decouple_loss:0.00040508972597308457
The modified gen p mean: 0.44646385312080383, gen p mean: -0.13184937834739685, mean p set: 0.44703981280326843
loss_pred:0.014751619659364223, decouple_loss:0.0003208049456588924
The modified gen p mean: 0.4474550187587738, gen p mean: -0.12199479341506958, mean p set: 0.44803139567375183
loss_pred:0.01481781154870987, decouple_loss:0.00031590854632668197
Iteration: 3258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892001152038574, gen p mean: -0.12553845345973969, mean p set: 0.4494958221912384
loss_pred:0.01430859137326479, decouple_loss:0.0004206635057926178
The modified gen p mean: 0.44728413224220276, gen p mean: -0.12325964123010635, mean p set: 0.4478605389595032
loss_pred:0.015092894434928894, decouple_loss:0.0004138106305617839
The modified gen p mean: 0.4465737044811249, gen p mean: -0.12025076895952225, mean p set: 0.4471484422683716
loss_pred:0.014082354493439198, decouple_loss:0.0003314646892249584
Iteration: 3259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480389356613159, gen p mean: -0.12152449041604996, mean p set: 0.44861525297164917
loss_pred:0.015071485191583633, decouple_loss:0.00037260528188198805
The modified gen p mean: 0.44915279746055603, gen p mean: -0.12480562180280685, mean p set: 0.4497283697128296
loss_pred:0.014038905501365662, decouple_loss:0.000329773552948609
The modified gen p mean: 0.44642066955566406, gen p mean: -0.12960360944271088, mean p set: 0.44699788093566895
loss_pred:0.014720471575856209, decouple_loss:0.0003101725596934557
Iteration: 3260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485222399234772, gen p mean: -0.12411582469940186, mean p set: 0.449098140001297
loss_pred:0.014483719132840633, decouple_loss:0.0004312358796596527
The modified gen p mean: 0.44814997911453247, gen p mean: -0.12763336300849915, mean p set: 0.4487267732620239
loss_pred:0.014392505399882793, decouple_loss:0.0003502242034301162
The modified gen p mean: 0.4476819932460785, gen p mean: -0.12768200039863586, mean p set: 0.4482575058937073
loss_pred:0.014626219868659973, decouple_loss:0.0004546909185592085
2023-05-02 16:05:28 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1306198537349701, mean p set: 0.4502691626548767
loss_pred:0.016846414655447006, decouple_loss:0.00042656349251046777
The modified gen p mean: 0.4495353102684021, gen p mean: -0.12467732280492783, mean p set: 0.4500633478164673
loss_pred:0.016124222427606583, decouple_loss:0.0003899169387295842
The modified gen p mean: 0.44982948899269104, gen p mean: -0.1240040734410286, mean p set: 0.45035696029663086
loss_pred:0.016497353091835976, decouple_loss:0.00040584622183814645
WV_1_PC_1_EH_0_PS_40, loss: 0.016509702429175377, avg_mse: 0.025860292837023735
current test mse: 0.02586
Iteration: 3261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468524754047394, gen p mean: -0.12455464154481888, mean p set: 0.4474294185638428
loss_pred:0.013709002174437046, decouple_loss:0.0005036627990193665
The modified gen p mean: 0.4467904269695282, gen p mean: -0.1292036771774292, mean p set: 0.44736534357070923The modified gen p mean: 0.4469522535800934, gen p mean: -0.12179838865995407, mean p set: 0.44752857089042664
loss_pred:0.015039971098303795, decouple_loss:0.0004660987469833344
loss_pred:0.01425442099571228, decouple_loss:0.00038587854942306876
Iteration: 3262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465806484222412, gen p mean: -0.12436829507350922, mean p set: 0.4471592903137207
loss_pred:0.014143934473395348, decouple_loss:0.0003800953272730112
The modified gen p mean: 0.446247398853302, gen p mean: -0.1264619529247284, mean p set: 0.4468221068382263The modified gen p mean: 0.4476257562637329, gen p mean: -0.12021331489086151, mean p set: 0.44820234179496765
loss_pred:0.014583251439034939, decouple_loss:0.00042149052023887634
loss_pred:0.01467578299343586, decouple_loss:0.0003219887730665505
Iteration: 3263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473908543586731, gen p mean: -0.11905256658792496, mean p set: 0.4479648470878601
loss_pred:0.01431293971836567, decouple_loss:0.0003934246487915516
The modified gen p mean: 0.44766926765441895, gen p mean: -0.12635983526706696, mean p set: 0.4482457637786865
loss_pred:0.014087707735598087, decouple_loss:0.0002881498949136585
The modified gen p mean: 0.44637027382850647, gen p mean: -0.12643054127693176, mean p set: 0.4469473958015442
loss_pred:0.014740408398211002, decouple_loss:0.00038838988984934986
Iteration: 3264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686704874038696, gen p mean: -0.12080992758274078, mean p set: 0.44744372367858887
loss_pred:0.014595159329473972, decouple_loss:0.00035980832763016224
The modified gen p mean: 0.4468000829219818, gen p mean: -0.11486716568470001, mean p set: 0.44737815856933594
loss_pred:0.01432167086750269, decouple_loss:0.00031365230097435415
The modified gen p mean: 0.4475294351577759, gen p mean: -0.11817709356546402, mean p set: 0.4481060206890106
loss_pred:0.014829879626631737, decouple_loss:0.0004361900209914893
Iteration: 3265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447447806596756, gen p mean: -0.11586714535951614, mean p set: 0.44802284240722656
loss_pred:0.014164857566356659, decouple_loss:0.00032874426688067615
The modified gen p mean: 0.44842347502708435, gen p mean: -0.1194566860795021, mean p set: 0.44899824261665344
loss_pred:0.014046424068510532, decouple_loss:0.0002950041089206934
The modified gen p mean: 0.4479144513607025, gen p mean: -0.11694106459617615, mean p set: 0.4484897553920746
loss_pred:0.014221202582120895, decouple_loss:0.00031175120966508985
Iteration: 3266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753095507621765, gen p mean: -0.11886606365442276, mean p set: 0.4481104910373688
loss_pred:0.014042445458471775, decouple_loss:0.00041722151217982173
The modified gen p mean: 0.4474089443683624, gen p mean: -0.11671420186758041, mean p set: 0.44798544049263
loss_pred:0.014917080290615559, decouple_loss:0.0003520281461533159
The modified gen p mean: 0.4471825361251831, gen p mean: -0.11493883281946182, mean p set: 0.4477604627609253
loss_pred:0.01456025056540966, decouple_loss:0.000333896663505584
Iteration: 3267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465268552303314, gen p mean: -0.11989616602659225, mean p set: 0.4471015930175781
loss_pred:0.015287262387573719, decouple_loss:0.0004285391478333622
The modified gen p mean: 0.44839873909950256, gen p mean: -0.12145054340362549, mean p set: 0.44897395372390747
The modified gen p mean: 0.4472545087337494, gen p mean: -0.11297411471605301, mean p set: 0.4478318989276886
loss_pred:0.014311542734503746, decouple_loss:0.00037363526644185185
loss_pred:0.01495442446321249, decouple_loss:0.00035693414974957705
Iteration: 3268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706639647483826, gen p mean: -0.11188817024230957, mean p set: 0.4476413428783417
loss_pred:0.014285077340900898, decouple_loss:0.0003022635355591774
The modified gen p mean: 0.4467805325984955, gen p mean: -0.11656360328197479, mean p set: 0.4473569989204407
loss_pred:0.013733350671827793, decouple_loss:0.0003453443350736052
The modified gen p mean: 0.4461945593357086, gen p mean: -0.12038981169462204, mean p set: 0.44677209854125977
loss_pred:0.014408973976969719, decouple_loss:0.0003878990828525275
Iteration: 3269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681382179260254, gen p mean: -0.11387511342763901, mean p set: 0.44738900661468506
loss_pred:0.013774053193628788, decouple_loss:0.0003611488500609994
The modified gen p mean: 0.4463845491409302, gen p mean: -0.11340799182653427, mean p set: 0.4469609558582306
loss_pred:0.013566740788519382, decouple_loss:0.0004306012997403741
The modified gen p mean: 0.4483311176300049, gen p mean: -0.12230044603347778, mean p set: 0.44890403747558594
loss_pred:0.014126840978860855, decouple_loss:0.00033003510907292366
Iteration: 3270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474850296974182, gen p mean: -0.1162901222705841, mean p set: 0.4480628967285156
loss_pred:0.01427025068551302, decouple_loss:0.0004941874649375677
The modified gen p mean: 0.4467774033546448, gen p mean: -0.12220802158117294, mean p set: 0.4473494589328766
loss_pred:0.01522271241992712, decouple_loss:0.0003672282909974456
The modified gen p mean: 0.4493202269077301, gen p mean: -0.11487133800983429, mean p set: 0.44989389181137085
loss_pred:0.013627207837998867, decouple_loss:0.0003704044211190194
2023-05-02 16:07:35 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12065080553293228, mean p set: 0.4502691626548767
loss_pred:0.016918595880270004, decouple_loss:0.00038067661807872355
The modified gen p mean: 0.4495338797569275, gen p mean: -0.11431024968624115, mean p set: 0.4500633478164673
loss_pred:0.016206810250878334, decouple_loss:0.00038190651684999466
The modified gen p mean: 0.4498310387134552, gen p mean: -0.11419098824262619, mean p set: 0.45035696029663086
loss_pred:0.01653505489230156, decouple_loss:0.0004060385108459741
WV_1_PC_1_EH_0_PS_40, loss: 0.016572965309023857, avg_mse: 0.025978706777095795
current test mse: 0.025979
Iteration: 3271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446956068277359, gen p mean: -0.11674988269805908, mean p set: 0.44753316044807434
loss_pred:0.01518759224563837, decouple_loss:0.00037200257065705955
The modified gen p mean: 0.4478863477706909, gen p mean: -0.11521119624376297, mean p set: 0.44846174120903015The modified gen p mean: 0.4474993050098419, gen p mean: -0.11870592832565308, mean p set: 0.44807443022727966
loss_pred:0.014261893928050995, decouple_loss:0.0003949346428271383
loss_pred:0.013877978548407555, decouple_loss:0.0004040481289848685
Iteration: 3272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468238055706024, gen p mean: -0.11715788394212723, mean p set: 0.4473989009857178
The modified gen p mean: 0.44714146852493286, gen p mean: -0.1160711869597435, mean p set: 0.4477183520793915
loss_pred:0.015224955976009369, decouple_loss:0.00038000650238245726
loss_pred:0.01553999911993742, decouple_loss:0.0004495986213441938
The modified gen p mean: 0.44792211055755615, gen p mean: -0.11751241236925125, mean p set: 0.4484971761703491
loss_pred:0.01380956545472145, decouple_loss:0.0003855866380035877
Iteration: 3273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465690851211548, gen p mean: -0.10996564477682114, mean p set: 0.44714486598968506
loss_pred:0.013427755795419216, decouple_loss:0.00034319888800382614
The modified gen p mean: 0.4482080042362213, gen p mean: -0.1191021278500557, mean p set: 0.4487859904766083
loss_pred:0.014512302353978157, decouple_loss:0.0003719312371686101
The modified gen p mean: 0.44683340191841125, gen p mean: -0.11699745804071426, mean p set: 0.4474082589149475
loss_pred:0.015423891134560108, decouple_loss:0.00041278847493231297
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
NaN value num: 0
Iteration: 3274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455769658088684, gen p mean: -0.10931190103292465, mean p set: 0.4461515247821808
loss_pred:0.015183962881565094, decouple_loss:0.0003910146187990904
The modified gen p mean: 0.44670894742012024, gen p mean: -0.11442626267671585, mean p set: 0.44728389382362366
loss_pred:0.016028447076678276, decouple_loss:0.0004882404173258692
The modified gen p mean: 0.4470265805721283, gen p mean: -0.11207235604524612, mean p set: 0.4475998878479004
loss_pred:0.016218284144997597, decouple_loss:0.00040071900002658367
Iteration: 3275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469767212867737, gen p mean: -0.11627653241157532, mean p set: 0.4475530982017517
loss_pred:0.016069963574409485, decouple_loss:0.00042714003939181566
The modified gen p mean: 0.44621339440345764, gen p mean: -0.11708445101976395, mean p set: 0.44678995013237
loss_pred:0.015556997619569302, decouple_loss:0.0002987938350997865
The modified gen p mean: 0.44578665494918823, gen p mean: -0.11824306845664978, mean p set: 0.44636404514312744
loss_pred:0.015487922355532646, decouple_loss:0.00044022686779499054
Iteration: 3276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465641677379608, gen p mean: -0.12037218362092972, mean p set: 0.44714057445526123
loss_pred:0.01582656241953373, decouple_loss:0.0005408191354945302
The modified gen p mean: 0.44820910692214966, gen p mean: -0.11427269876003265, mean p set: 0.4487886130809784
loss_pred:0.015297059901058674, decouple_loss:0.0004382356128189713
The modified gen p mean: 0.4455195367336273, gen p mean: -0.11960868537425995, mean p set: 0.44609320163726807
loss_pred:0.014692268334329128, decouple_loss:0.00039807395660318434
Iteration: 3277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490637481212616, gen p mean: -0.12205279618501663, mean p set: 0.44963929057121277
loss_pred:0.015490503050386906, decouple_loss:0.0003953371196985245
The modified gen p mean: 0.44878560304641724, gen p mean: -0.11526621133089066, mean p set: 0.4493609070777893
loss_pred:0.015269597060978413, decouple_loss:0.00034587239497341216
The modified gen p mean: 0.4464743137359619, gen p mean: -0.11711963266134262, mean p set: 0.4470517337322235
loss_pred:0.015499364584684372, decouple_loss:0.0003685932024382055
Iteration: 3278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472421705722809, gen p mean: -0.11965908855199814, mean p set: 0.44781720638275146
loss_pred:0.014940970577299595, decouple_loss:0.0005412025493569672
The modified gen p mean: 0.44582274556159973, gen p mean: -0.12471411377191544, mean p set: 0.44640052318573
loss_pred:0.015140926465392113, decouple_loss:0.0004993629409000278
The modified gen p mean: 0.447431355714798, gen p mean: -0.12329646944999695, mean p set: 0.4480063021183014
loss_pred:0.015290730632841587, decouple_loss:0.0004172752669546753
Iteration: 3279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458441734313965, gen p mean: -0.11652731150388718, mean p set: 0.446418434381485
loss_pred:0.015316557139158249, decouple_loss:0.00047414691653102636
The modified gen p mean: 0.44748613238334656, gen p mean: -0.1187998577952385, mean p set: 0.4480617940425873
loss_pred:0.015517552383244038, decouple_loss:0.0004965541884303093
The modified gen p mean: 0.4476499855518341, gen p mean: -0.12374242395162582, mean p set: 0.4482261538505554
loss_pred:0.015330576337873936, decouple_loss:0.0004694248491432518
Iteration: 3280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482027590274811, gen p mean: -0.11567099392414093, mean p set: 0.4487777352333069
loss_pred:0.015317592769861221, decouple_loss:0.0002929671318270266
The modified gen p mean: 0.4479784071445465, gen p mean: -0.11887675523757935, mean p set: 0.4485533535480499
loss_pred:0.015420964919030666, decouple_loss:0.00036272944998927414
The modified gen p mean: 0.4463889002799988, gen p mean: -0.11658301949501038, mean p set: 0.446968138217926
loss_pred:0.015319813042879105, decouple_loss:0.00038784011849202216
2023-05-02 16:10:20 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12406422197818756, mean p set: 0.4502691626548767
loss_pred:0.016831303015351295, decouple_loss:0.0003495484124869108
The modified gen p mean: 0.44953349232673645, gen p mean: -0.11822513490915298, mean p set: 0.4500633478164673
loss_pred:0.01613650470972061, decouple_loss:0.00039367630961351097
The modified gen p mean: 0.4498275816440582, gen p mean: -0.11799341440200806, mean p set: 0.45035696029663086
loss_pred:0.016426587477326393, decouple_loss:0.00031929451506584883
WV_1_PC_1_EH_0_PS_40, loss: 0.016482507809996605, avg_mse: 0.02579859085381031
current test mse: 0.025799
Iteration: 3281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471561908721924, gen p mean: -0.1181487888097763, mean p set: 0.4477316439151764
loss_pred:0.015205529518425465, decouple_loss:0.000411565211834386
The modified gen p mean: 0.44591519236564636, gen p mean: -0.12240870296955109, mean p set: 0.4464896619319916The modified gen p mean: 0.44600018858909607, gen p mean: -0.12106407433748245, mean p set: 0.44657647609710693
loss_pred:0.01541945431381464, decouple_loss:0.0003745365247596055
loss_pred:0.015101302415132523, decouple_loss:0.0003821765712928027
Iteration: 3282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44640377163887024, gen p mean: -0.11815696954727173, mean p set: 0.4469790756702423
loss_pred:0.015031781047582626, decouple_loss:0.00042294865124858916
The modified gen p mean: 0.44703006744384766, gen p mean: -0.1215677410364151, mean p set: 0.44760608673095703The modified gen p mean: 0.4489485025405884, gen p mean: -0.11893725395202637, mean p set: 0.44952526688575745
loss_pred:0.01623258739709854, decouple_loss:0.0004167789302300662loss_pred:0.014819171279668808, decouple_loss:0.00041489506838843226
Iteration: 3283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705289602279663, gen p mean: -0.12335940450429916, mean p set: 0.4476267099380493
loss_pred:0.016095977276563644, decouple_loss:0.00033778155921027064
The modified gen p mean: 0.4471966326236725, gen p mean: -0.12293510138988495, mean p set: 0.44777223467826843
loss_pred:0.015610144473612309, decouple_loss:0.0004528142453636974
The modified gen p mean: 0.4472331404685974, gen p mean: -0.12574291229248047, mean p set: 0.447811096906662
loss_pred:0.015138409100472927, decouple_loss:0.0003970495890825987
Iteration: 3284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44559308886528015, gen p mean: -0.13202515244483948, mean p set: 0.4461691081523895
loss_pred:0.015468209981918335, decouple_loss:0.0004323889152146876
The modified gen p mean: 0.4480119049549103, gen p mean: -0.12744656205177307, mean p set: 0.44858571887016296
loss_pred:0.015472885221242905, decouple_loss:0.00041468130075372756
The modified gen p mean: 0.44748368859291077, gen p mean: -0.1273874044418335, mean p set: 0.4480586051940918
loss_pred:0.015208515338599682, decouple_loss:0.0004277380066923797
Iteration: 3285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783908128738403, gen p mean: -0.13631831109523773, mean p set: 0.4484156668186188
loss_pred:0.01467850897461176, decouple_loss:0.00038234269595704973
The modified gen p mean: 0.4470949172973633, gen p mean: -0.132338285446167, mean p set: 0.4476713538169861
loss_pred:0.015515705570578575, decouple_loss:0.0003586901293601841
The modified gen p mean: 0.4471290409564972, gen p mean: -0.13136111199855804, mean p set: 0.44770559668540955
loss_pred:0.014875815249979496, decouple_loss:0.00031150152790360153
Iteration: 3286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462735652923584, gen p mean: -0.131081685423851, mean p set: 0.44684743881225586
loss_pred:0.01517583429813385, decouple_loss:0.0003483713371679187
The modified gen p mean: 0.4458363950252533, gen p mean: -0.13362090289592743, mean p set: 0.44641271233558655
The modified gen p mean: 0.44622939825057983, gen p mean: -0.1301117241382599, mean p set: 0.44680410623550415
loss_pred:0.015160888433456421, decouple_loss:0.0004397889715619385
loss_pred:0.015052844770252705, decouple_loss:0.0006006314069963992
Iteration: 3287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44639891386032104, gen p mean: -0.13090969622135162, mean p set: 0.4469743072986603
loss_pred:0.01535718236118555, decouple_loss:0.00031581343500874937
The modified gen p mean: 0.44530776143074036, gen p mean: -0.1340363472700119, mean p set: 0.44588136672973633
The modified gen p mean: 0.44528403878211975, gen p mean: -0.1341250091791153, mean p set: 0.44586169719696045
loss_pred:0.015379728749394417, decouple_loss:0.0004853688005823642
loss_pred:0.01502266339957714, decouple_loss:0.0005152981611900032
Iteration: 3288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44632068276405334, gen p mean: -0.13751299679279327, mean p set: 0.4468950033187866
loss_pred:0.015090973116457462, decouple_loss:0.00039906048914417624
The modified gen p mean: 0.4481389820575714, gen p mean: -0.12674131989479065, mean p set: 0.44871607422828674
The modified gen p mean: 0.44669416546821594, gen p mean: -0.1317126452922821, mean p set: 0.44727084040641785
loss_pred:0.015175123699009418, decouple_loss:0.00035713877878151834
loss_pred:0.014846697449684143, decouple_loss:0.0003508682129904628
Iteration: 3289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819584488868713, gen p mean: -0.1347644180059433, mean p set: 0.4487701654434204
loss_pred:0.014989293180406094, decouple_loss:0.000494909007102251
The modified gen p mean: 0.4486102759838104, gen p mean: -0.1307627111673355, mean p set: 0.44918572902679443
loss_pred:0.0154065927490592, decouple_loss:0.0004363187472335994
The modified gen p mean: 0.4452889859676361, gen p mean: -0.13394048810005188, mean p set: 0.4458634853363037
loss_pred:0.014931927435100079, decouple_loss:0.00043216132326051593
Iteration: 3290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44558829069137573, gen p mean: -0.1334310919046402, mean p set: 0.4461638331413269
loss_pred:0.015239948406815529, decouple_loss:0.0005727860843762755
The modified gen p mean: 0.44595664739608765, gen p mean: -0.12846969068050385, mean p set: 0.4465305209159851
loss_pred:0.01547387894243002, decouple_loss:0.00040109659312292933
The modified gen p mean: 0.44868993759155273, gen p mean: -0.13398809731006622, mean p set: 0.44926485419273376
loss_pred:0.015393228270113468, decouple_loss:0.0003932540712412447
2023-05-02 16:12:27 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13496391475200653, mean p set: 0.4502691626548767
loss_pred:0.016826162114739418, decouple_loss:0.00033162705949507654
The modified gen p mean: 0.44953447580337524, gen p mean: -0.12881620228290558, mean p set: 0.4500633478164673
loss_pred:0.016119809821248055, decouple_loss:0.0003446294867899269
The modified gen p mean: 0.4498285949230194, gen p mean: -0.1288309097290039, mean p set: 0.45035696029663086
loss_pred:0.01640426740050316, decouple_loss:0.00041358385351486504
WV_1_PC_1_EH_0_PS_40, loss: 0.016468245536088943, avg_mse: 0.02577696368098259
current test mse: 0.025777
Iteration: 3291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457906484603882, gen p mean: -0.13430283963680267, mean p set: 0.446366548538208
loss_pred:0.01555717084556818, decouple_loss:0.0003175431047566235
The modified gen p mean: 0.4465441405773163, gen p mean: -0.1325910985469818, mean p set: 0.4471185803413391The modified gen p mean: 0.4467128813266754, gen p mean: -0.1340506225824356, mean p set: 0.44728726148605347
loss_pred:0.014930620789527893, decouple_loss:0.00034975315793417394loss_pred:0.015223543159663677, decouple_loss:0.0004659618716686964
Iteration: 3292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492985010147095, gen p mean: -0.1284756362438202, mean p set: 0.44987761974334717
loss_pred:0.014567484147846699, decouple_loss:0.0005792719312012196
The modified gen p mean: 0.4469805359840393, gen p mean: -0.12618497014045715, mean p set: 0.4475557208061218The modified gen p mean: 0.4462378919124603, gen p mean: -0.1278143972158432, mean p set: 0.44681212306022644
loss_pred:0.01586046628654003, decouple_loss:0.00039969675708562136loss_pred:0.015199598856270313, decouple_loss:0.00041890417924150825
Iteration: 3293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44607067108154297, gen p mean: -0.1261732578277588, mean p set: 0.44664642214775085
loss_pred:0.015418905764818192, decouple_loss:0.0003310009487904608
The modified gen p mean: 0.4461463391780853, gen p mean: -0.12283448874950409, mean p set: 0.4467185139656067
loss_pred:0.0152592733502388, decouple_loss:0.0006043729372322559
The modified gen p mean: 0.44724780321121216, gen p mean: -0.12345767021179199, mean p set: 0.4478236734867096
loss_pred:0.015891296789050102, decouple_loss:0.0004300877917557955
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 3294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477064609527588, gen p mean: -0.12368759512901306, mean p set: 0.4482816159725189
loss_pred:0.014984763227403164, decouple_loss:0.0005273044225759804
The modified gen p mean: 0.44797709584236145, gen p mean: -0.1299879401922226, mean p set: 0.4485515058040619
loss_pred:0.015525919385254383, decouple_loss:0.00039743035449646413
The modified gen p mean: 0.4472053647041321, gen p mean: -0.1298997849225998, mean p set: 0.4477818012237549
loss_pred:0.014769350178539753, decouple_loss:0.00042475503869354725
Iteration: 3295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44604209065437317, gen p mean: -0.13065728545188904, mean p set: 0.4466179311275482
loss_pred:0.014807181432843208, decouple_loss:0.0004594908095896244
The modified gen p mean: 0.4460441470146179, gen p mean: -0.13114967942237854, mean p set: 0.44661951065063477
loss_pred:0.015099575743079185, decouple_loss:0.0004713197995442897
The modified gen p mean: 0.4477917551994324, gen p mean: -0.12688866257667542, mean p set: 0.44837021827697754
loss_pred:0.014905930496752262, decouple_loss:0.00045581822632811964
Iteration: 3296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44585081934928894, gen p mean: -0.13384339213371277, mean p set: 0.44642776250839233
The modified gen p mean: 0.4475926160812378, gen p mean: -0.13027667999267578, mean p set: 0.4481656849384308
loss_pred:0.014608580619096756, decouple_loss:0.0004418346215970814
loss_pred:0.015268685296177864, decouple_loss:0.0004594284691847861
The modified gen p mean: 0.44789353013038635, gen p mean: -0.12923941016197205, mean p set: 0.4484681785106659
loss_pred:0.015026746317744255, decouple_loss:0.0005263813654892147
Iteration: 3297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474290907382965, gen p mean: -0.1323389708995819, mean p set: 0.4480046033859253
loss_pred:0.014338299632072449, decouple_loss:0.0005351644940674305
The modified gen p mean: 0.4476388692855835, gen p mean: -0.13048452138900757, mean p set: 0.4482135772705078
The modified gen p mean: 0.4466187357902527, gen p mean: -0.13019515573978424, mean p set: 0.44719401001930237
loss_pred:0.014879018068313599, decouple_loss:0.000592088676057756
loss_pred:0.015509180724620819, decouple_loss:0.0004940635990351439
Iteration: 3298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478408396244049, gen p mean: -0.12889178097248077, mean p set: 0.4484192430973053
loss_pred:0.015276200138032436, decouple_loss:0.0003883489698637277
The modified gen p mean: 0.4476964771747589, gen p mean: -0.13169898092746735, mean p set: 0.44827502965927124
loss_pred:0.014720110222697258, decouple_loss:0.00035333679988980293
The modified gen p mean: 0.44689077138900757, gen p mean: -0.13122785091400146, mean p set: 0.44746458530426025
loss_pred:0.014676826074719429, decouple_loss:0.00034423754550516605
Iteration: 3299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474560022354126, gen p mean: -0.12363263219594955, mean p set: 0.44803258776664734
loss_pred:0.014569465070962906, decouple_loss:0.0005408120923675597
The modified gen p mean: 0.4466799795627594, gen p mean: -0.1322653591632843, mean p set: 0.44725507497787476
The modified gen p mean: 0.4462529718875885, gen p mean: -0.12905550003051758, mean p set: 0.4468306601047516
loss_pred:0.01452599000185728, decouple_loss:0.0005185098270885646
loss_pred:0.013822603970766068, decouple_loss:0.0004258171538822353
Iteration: 3300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837841391563416, gen p mean: -0.12382252514362335, mean p set: 0.448952317237854
loss_pred:0.014448408968746662, decouple_loss:0.0003911328094545752
The modified gen p mean: 0.4482704997062683, gen p mean: -0.12574422359466553, mean p set: 0.44884711503982544
loss_pred:0.015264795161783695, decouple_loss:0.0005105739110149443
The modified gen p mean: 0.44751375913619995, gen p mean: -0.12482037395238876, mean p set: 0.44809025526046753
loss_pred:0.014508150517940521, decouple_loss:0.0005193913821130991
2023-05-02 16:15:17 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12547922134399414, mean p set: 0.4502691626548767
loss_pred:0.016751741990447044, decouple_loss:0.0004646426532417536
The modified gen p mean: 0.44953304529190063, gen p mean: -0.11984147876501083, mean p set: 0.4500633478164673
loss_pred:0.016128018498420715, decouple_loss:0.0003530546382535249
The modified gen p mean: 0.44983020424842834, gen p mean: -0.12020574510097504, mean p set: 0.45035696029663086
loss_pred:0.016424154862761497, decouple_loss:0.00036956381518393755
WV_1_PC_1_EH_0_PS_40, loss: 0.0164544265717268, avg_mse: 0.025767846032977104
current test mse: 0.025768
Iteration: 3301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466665983200073, gen p mean: -0.1253422498703003, mean p set: 0.44724181294441223
loss_pred:0.014351516962051392, decouple_loss:0.00030130453524179757
The modified gen p mean: 0.4476299583911896, gen p mean: -0.12551897764205933, mean p set: 0.44820475578308105The modified gen p mean: 0.44784262776374817, gen p mean: -0.12309938669204712, mean p set: 0.44841933250427246
loss_pred:0.015652954578399658, decouple_loss:0.00037795447860844433
loss_pred:0.01560217048972845, decouple_loss:0.0003769525501411408
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483126997947693, gen p mean: -0.12286192923784256, mean p set: 0.44888749718666077
loss_pred:0.014186076819896698, decouple_loss:0.00037546525709331036
The modified gen p mean: 0.44708383083343506, gen p mean: -0.12139017879962921, mean p set: 0.44765913486480713
The modified gen p mean: 0.4474010169506073, gen p mean: -0.12084659188985825, mean p set: 0.44797828793525696
loss_pred:0.014705898240208626, decouple_loss:0.0003515556745696813
loss_pred:0.01507309079170227, decouple_loss:0.00039990898221731186
Iteration: 3303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472351670265198, gen p mean: -0.12084909528493881, mean p set: 0.4478125274181366
loss_pred:0.014507741667330265, decouple_loss:0.000336262775817886
The modified gen p mean: 0.44754889607429504, gen p mean: -0.12284297496080399, mean p set: 0.44812464714050293The modified gen p mean: 0.44752269983291626, gen p mean: -0.11513545364141464, mean p set: 0.44809815287590027
loss_pred:0.014747378416359425, decouple_loss:0.00042007656884379685
loss_pred:0.013913417235016823, decouple_loss:0.000314060045639053
Iteration: 3304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471282362937927, gen p mean: -0.12038283050060272, mean p set: 0.4477040469646454
loss_pred:0.01456539798527956, decouple_loss:0.00040920506580732763
The modified gen p mean: 0.445809543132782, gen p mean: -0.12417171895503998, mean p set: 0.44638389348983765
loss_pred:0.013863793574273586, decouple_loss:0.0005514199729077518
The modified gen p mean: 0.44799894094467163, gen p mean: -0.12225539237260818, mean p set: 0.4485739767551422
loss_pred:0.01429999340325594, decouple_loss:0.0004803377960342914
Iteration: 3305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744715094566345, gen p mean: -0.123644158244133, mean p set: 0.44802215695381165
loss_pred:0.01420842856168747, decouple_loss:0.00029109269962646067
The modified gen p mean: 0.4467357099056244, gen p mean: -0.1257978081703186, mean p set: 0.4473138451576233
loss_pred:0.014844745397567749, decouple_loss:0.0005603773170150816
The modified gen p mean: 0.44699183106422424, gen p mean: -0.1271100640296936, mean p set: 0.44756636023521423
loss_pred:0.014661208726465702, decouple_loss:0.0003906101919710636
Iteration: 3306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463399648666382, gen p mean: -0.1251426339149475, mean p set: 0.44691428542137146
loss_pred:0.015069820918142796, decouple_loss:0.00046238841605372727
The modified gen p mean: 0.44721609354019165, gen p mean: -0.12384886294603348, mean p set: 0.44779056310653687
loss_pred:0.0141526497900486, decouple_loss:0.00042457354720681906
The modified gen p mean: 0.4481368064880371, gen p mean: -0.12025164067745209, mean p set: 0.4487118422985077
loss_pred:0.014189842157065868, decouple_loss:0.0004866744566243142
Iteration: 3307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470207989215851, gen p mean: -0.12389644980430603, mean p set: 0.44759562611579895
loss_pred:0.014174752868711948, decouple_loss:0.0006358809769153595
The modified gen p mean: 0.4459534287452698, gen p mean: -0.12271801382303238, mean p set: 0.4465283155441284
The modified gen p mean: 0.4484909474849701, gen p mean: -0.12302776426076889, mean p set: 0.4490656852722168
loss_pred:0.015151538886129856, decouple_loss:0.0005586724146269262
loss_pred:0.01434787455946207, decouple_loss:0.0005742135108448565
Iteration: 3308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762182235717773, gen p mean: -0.11858091503381729, mean p set: 0.4481956660747528
loss_pred:0.014992154203355312, decouple_loss:0.0006862423615530133
The modified gen p mean: 0.4465218782424927, gen p mean: -0.12207545340061188, mean p set: 0.44709837436676025
The modified gen p mean: 0.44716140627861023, gen p mean: -0.1184399276971817, mean p set: 0.4477352201938629
loss_pred:0.015198849141597748, decouple_loss:0.000730873376596719
loss_pred:0.0151981171220541, decouple_loss:0.0004597831575665623
Iteration: 3309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480643570423126, gen p mean: -0.11918199807405472, mean p set: 0.4486413896083832
loss_pred:0.014056973159313202, decouple_loss:0.000489853962790221
The modified gen p mean: 0.4478088319301605, gen p mean: -0.11996248364448547, mean p set: 0.44838324189186096
The modified gen p mean: 0.44726860523223877, gen p mean: -0.11682382225990295, mean p set: 0.44784313440322876
loss_pred:0.0146798649802804, decouple_loss:0.0004991386085748672
loss_pred:0.015095630660653114, decouple_loss:0.00042711489368230104
Iteration: 3310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44617483019828796, gen p mean: -0.11902175843715668, mean p set: 0.4467509686946869
loss_pred:0.014750475995242596, decouple_loss:0.00048751209396868944
The modified gen p mean: 0.44723013043403625, gen p mean: -0.12320276349782944, mean p set: 0.4478060305118561
The modified gen p mean: 0.44739830493927, gen p mean: -0.12046635150909424, mean p set: 0.44797375798225403
loss_pred:0.014588532969355583, decouple_loss:0.0004374297568574548
loss_pred:0.01558185275644064, decouple_loss:0.0003803610452450812
2023-05-02 16:17:23 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12124402076005936, mean p set: 0.4502691626548767
loss_pred:0.016743486747145653, decouple_loss:0.0004751076630782336
The modified gen p mean: 0.4495360553264618, gen p mean: -0.1159428283572197, mean p set: 0.4500633478164673
loss_pred:0.01614156924188137, decouple_loss:0.0005428909207694232
The modified gen p mean: 0.44982871413230896, gen p mean: -0.11588998138904572, mean p set: 0.45035696029663086
loss_pred:0.016443626955151558, decouple_loss:0.0005695097497664392
WV_1_PC_1_EH_0_PS_40, loss: 0.016469353809952736, avg_mse: 0.02577362023293972
current test mse: 0.025774
Iteration: 3311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472847878932953, gen p mean: -0.11424841731786728, mean p set: 0.4478640854358673
loss_pred:0.01396566815674305, decouple_loss:0.00044423918006941676
The modified gen p mean: 0.4475915729999542, gen p mean: -0.11748766899108887, mean p set: 0.44816744327545166The modified gen p mean: 0.4480995535850525, gen p mean: -0.12043759971857071, mean p set: 0.4486749470233917
loss_pred:0.014848576858639717, decouple_loss:0.0007008306565694511
loss_pred:0.01474894117563963, decouple_loss:0.0005464323912747204
Iteration: 3312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471522271633148, gen p mean: -0.12443869560956955, mean p set: 0.447729229927063
loss_pred:0.014499322511255741, decouple_loss:0.0005494459182955325
The modified gen p mean: 0.44828560948371887, gen p mean: -0.12293312698602676, mean p set: 0.4488631784915924
The modified gen p mean: 0.44737207889556885, gen p mean: -0.12148801982402802, mean p set: 0.4479471743106842
loss_pred:0.014421561732888222, decouple_loss:0.0005309098633006215
loss_pred:0.014969848096370697, decouple_loss:0.0004897159524261951
Iteration: 3313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799578189849854, gen p mean: -0.12480764091014862, mean p set: 0.4485728442668915
The modified gen p mean: 0.446433961391449, gen p mean: -0.12958325445652008, mean p set: 0.4470071494579315
loss_pred:0.014840595424175262, decouple_loss:0.0003822773869615048
loss_pred:0.014401446096599102, decouple_loss:0.00042317205225117505
The modified gen p mean: 0.44715312123298645, gen p mean: -0.12537838518619537, mean p set: 0.4477280378341675
loss_pred:0.014401757158339024, decouple_loss:0.0003933554398827255
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 3314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488222599029541, gen p mean: -0.12698790431022644, mean p set: 0.4493984878063202
loss_pred:0.01520530879497528, decouple_loss:0.00041607441380620003
The modified gen p mean: 0.4489133656024933, gen p mean: -0.12564143538475037, mean p set: 0.44949063658714294
loss_pred:0.014569808728992939, decouple_loss:0.00035792746348306537
The modified gen p mean: 0.44974014163017273, gen p mean: -0.12961332499980927, mean p set: 0.4503171145915985
loss_pred:0.014555282890796661, decouple_loss:0.0003535126452334225
Iteration: 3315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937899708747864, gen p mean: -0.1182757318019867, mean p set: 0.44995465874671936
The modified gen p mean: 0.4496888816356659, gen p mean: -0.12569883465766907, mean p set: 0.4502677023410797
loss_pred:0.01435650885105133, decouple_loss:0.0003294247726444155
loss_pred:0.014617867767810822, decouple_loss:0.0003301555407233536
The modified gen p mean: 0.4491008520126343, gen p mean: -0.12348145246505737, mean p set: 0.44967731833457947
loss_pred:0.014319933950901031, decouple_loss:0.00045870948815718293
Iteration: 3316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449908971786499, gen p mean: -0.11672224849462509, mean p set: 0.4504837691783905
The modified gen p mean: 0.4500463008880615, gen p mean: -0.11617415398359299, mean p set: 0.4506189823150635
loss_pred:0.01457179430872202, decouple_loss:0.0003501707687973976
loss_pred:0.014480449259281158, decouple_loss:0.000427061109803617
The modified gen p mean: 0.44955766201019287, gen p mean: -0.12249229103326797, mean p set: 0.45013657212257385
loss_pred:0.01437318790704012, decouple_loss:0.00033500828430987895
Iteration: 3317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997382164001465, gen p mean: -0.11355184763669968, mean p set: 0.4505513906478882
The modified gen p mean: 0.4490993618965149, gen p mean: -0.11407677084207535, mean p set: 0.4496765732765198
loss_pred:0.014006488025188446, decouple_loss:0.00036873816861771047
loss_pred:0.015128192491829395, decouple_loss:0.00043642899254336953
The modified gen p mean: 0.4500903785228729, gen p mean: -0.1134968101978302, mean p set: 0.45066767930984497
loss_pred:0.014925086870789528, decouple_loss:0.00043511175317689776
Iteration: 3318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44959715008735657, gen p mean: -0.120309017598629, mean p set: 0.4501734673976898
loss_pred:0.014468180947005749, decouple_loss:0.00037943595089018345
The modified gen p mean: 0.448640912771225, gen p mean: -0.12196017801761627, mean p set: 0.449221134185791
The modified gen p mean: 0.4491737484931946, gen p mean: -0.11612135171890259, mean p set: 0.4497511684894562
loss_pred:0.01438503060489893, decouple_loss:0.00040017938590608537
loss_pred:0.01506031770259142, decouple_loss:0.00041771354153752327
Iteration: 3319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485359787940979, gen p mean: -0.11746486276388168, mean p set: 0.4491119980812073The modified gen p mean: 0.44957607984542847, gen p mean: -0.11474122107028961, mean p set: 0.4501534700393677
loss_pred:0.015361509285867214, decouple_loss:0.0003657678607851267
loss_pred:0.014550219289958477, decouple_loss:0.0002780141367111355
The modified gen p mean: 0.45072975754737854, gen p mean: -0.11399000138044357, mean p set: 0.45130491256713867
loss_pred:0.01430356316268444, decouple_loss:0.0003407442127354443
Iteration: 3320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487302005290985, gen p mean: -0.1126600056886673, mean p set: 0.4493071436882019
The modified gen p mean: 0.45056596398353577, gen p mean: -0.1134243905544281, mean p set: 0.451143354177475
loss_pred:0.015276470221579075, decouple_loss:0.00043880779412575066
loss_pred:0.014546217396855354, decouple_loss:0.0003089933015871793
The modified gen p mean: 0.44837045669555664, gen p mean: -0.1193637028336525, mean p set: 0.4489458501338959
loss_pred:0.014412272721529007, decouple_loss:0.00037172212614677846
2023-05-02 16:20:15 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12211824953556061, mean p set: 0.4502691626548767
loss_pred:0.016766516491770744, decouple_loss:0.0003658166097011417
The modified gen p mean: 0.4495347738265991, gen p mean: -0.1166522279381752, mean p set: 0.4500633478164673
loss_pred:0.01607806235551834, decouple_loss:0.0003592059656511992
The modified gen p mean: 0.4498302936553955, gen p mean: -0.11641456186771393, mean p set: 0.45035696029663086
loss_pred:0.01640077494084835, decouple_loss:0.0003554456343408674
WV_1_PC_1_EH_0_PS_40, loss: 0.016433127224445343, avg_mse: 0.025744596496224403
current test mse: 0.025745
Iteration: 3321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910675287246704, gen p mean: -0.11904843151569366, mean p set: 0.4496835172176361
loss_pred:0.014712037518620491, decouple_loss:0.00038330000825226307
The modified gen p mean: 0.44787657260894775, gen p mean: -0.11518052220344543, mean p set: 0.44845327734947205The modified gen p mean: 0.44793403148651123, gen p mean: -0.11604052782058716, mean p set: 0.44850999116897583
loss_pred:0.013962585479021072, decouple_loss:0.00044430908747017384
loss_pred:0.014623894356191158, decouple_loss:0.0003396005486138165
Iteration: 3322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013225078582764, gen p mean: -0.11066741496324539, mean p set: 0.45070981979370117
The modified gen p mean: 0.4491415321826935, gen p mean: -0.12007050216197968, mean p set: 0.4497183561325073
loss_pred:0.01421235129237175, decouple_loss:0.000504780444316566
loss_pred:0.01481133047491312, decouple_loss:0.00048650059034116566
The modified gen p mean: 0.44756361842155457, gen p mean: -0.11524300277233124, mean p set: 0.44813892245292664
loss_pred:0.015445650555193424, decouple_loss:0.0004663584695663303
Iteration: 3323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44959449768066406, gen p mean: -0.12146835774183273, mean p set: 0.45017269253730774
loss_pred:0.014621393755078316, decouple_loss:0.0004431989509612322
The modified gen p mean: 0.4504891633987427, gen p mean: -0.11449859291315079, mean p set: 0.45106619596481323
loss_pred:0.013756885193288326, decouple_loss:0.0005075758090242743
The modified gen p mean: 0.4500267803668976, gen p mean: -0.11278126388788223, mean p set: 0.4506046175956726
loss_pred:0.0145099563524127, decouple_loss:0.00042582835885696113
Iteration: 3324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482978880405426, gen p mean: -0.11487980931997299, mean p set: 0.4488740861415863
The modified gen p mean: 0.4485112130641937, gen p mean: -0.12127092480659485, mean p set: 0.44908788800239563
loss_pred:0.014465900138020515, decouple_loss:0.0004784734919667244
loss_pred:0.01538095623254776, decouple_loss:0.0004287161573302001
The modified gen p mean: 0.4501997232437134, gen p mean: -0.11203596740961075, mean p set: 0.4507763385772705
loss_pred:0.014048595912754536, decouple_loss:0.00043156123138032854
Iteration: 3325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492681324481964, gen p mean: -0.12097865343093872, mean p set: 0.4498424530029297
The modified gen p mean: 0.4488418698310852, gen p mean: -0.11964309960603714, mean p set: 0.4494198262691498
loss_pred:0.014625411480665207, decouple_loss:0.0003632868465501815
loss_pred:0.015021858736872673, decouple_loss:0.0005076988600194454
The modified gen p mean: 0.450015127658844, gen p mean: -0.11407063156366348, mean p set: 0.4505905210971832
loss_pred:0.014685814268887043, decouple_loss:0.00043575980816967785
Iteration: 3326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484173357486725, gen p mean: -0.12172441184520721, mean p set: 0.448993444442749
loss_pred:0.014668883755803108, decouple_loss:0.0005283807404339314
The modified gen p mean: 0.44795969128608704, gen p mean: -0.11921381950378418, mean p set: 0.4485381245613098
loss_pred:0.015366100706160069, decouple_loss:0.0005200886516831815
The modified gen p mean: 0.4507136642932892, gen p mean: -0.11871819198131561, mean p set: 0.45129016041755676
loss_pred:0.01444095280021429, decouple_loss:0.0003265209961682558
Iteration: 3327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489424228668213, gen p mean: -0.12524427473545074, mean p set: 0.4495182931423187
loss_pred:0.014370468445122242, decouple_loss:0.0003985706716775894
The modified gen p mean: 0.449554443359375, gen p mean: -0.1203303262591362, mean p set: 0.45013123750686646
The modified gen p mean: 0.44876667857170105, gen p mean: -0.1218784973025322, mean p set: 0.44934147596359253
loss_pred:0.014434964396059513, decouple_loss:0.00037374242674559355
loss_pred:0.014686135575175285, decouple_loss:0.000402071833377704
Iteration: 3328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919008016586304, gen p mean: -0.12595832347869873, mean p set: 0.4497663974761963
loss_pred:0.013982425443828106, decouple_loss:0.0003968180390074849
The modified gen p mean: 0.4484933316707611, gen p mean: -0.1260661482810974, mean p set: 0.44906798005104065
The modified gen p mean: 0.44902023673057556, gen p mean: -0.12455915659666061, mean p set: 0.44959837198257446
loss_pred:0.01455132756382227, decouple_loss:0.00047385835205204785
loss_pred:0.014931712299585342, decouple_loss:0.0003753162454813719
Iteration: 3329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45081019401550293, gen p mean: -0.11966312676668167, mean p set: 0.45138660073280334
The modified gen p mean: 0.44893336296081543, gen p mean: -0.12120708078145981, mean p set: 0.4495089054107666loss_pred:0.014279237017035484, decouple_loss:0.0005412523751147091
loss_pred:0.014446312561631203, decouple_loss:0.00044934728066436946
The modified gen p mean: 0.45028913021087646, gen p mean: -0.11840731650590897, mean p set: 0.4508661925792694
loss_pred:0.014092796482145786, decouple_loss:0.0005411035381257534
Iteration: 3330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968536496162415, gen p mean: -0.12308727204799652, mean p set: 0.45026013255119324
loss_pred:0.014540172182023525, decouple_loss:0.0004010076227132231
The modified gen p mean: 0.44876372814178467, gen p mean: -0.11916983872652054, mean p set: 0.4493391215801239
The modified gen p mean: 0.4479367136955261, gen p mean: -0.11879298835992813, mean p set: 0.44851261377334595
loss_pred:0.01423224899917841, decouple_loss:0.00045886007137596607
loss_pred:0.013578081503510475, decouple_loss:0.0004095997428521514
2023-05-02 16:22:21 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12468411028385162, mean p set: 0.4502691626548767
loss_pred:0.01676264777779579, decouple_loss:0.000499893503729254
The modified gen p mean: 0.4495353102684021, gen p mean: -0.11859401315450668, mean p set: 0.4500633478164673
loss_pred:0.01610923558473587, decouple_loss:0.000449547718744725
The modified gen p mean: 0.44982966780662537, gen p mean: -0.11812890321016312, mean p set: 0.45035696029663086
loss_pred:0.016373664140701294, decouple_loss:0.0003573833091650158
WV_1_PC_1_EH_0_PS_40, loss: 0.01643696241080761, avg_mse: 0.025736317038536072
current test mse: 0.025736
Iteration: 3331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481324553489685, gen p mean: -0.11851715296506882, mean p set: 0.44870686531066895
loss_pred:0.015666930004954338, decouple_loss:0.00038272570236586034
The modified gen p mean: 0.44917115569114685, gen p mean: -0.11532627791166306, mean p set: 0.4497471749782562The modified gen p mean: 0.44938838481903076, gen p mean: -0.12339591234922409, mean p set: 0.44996631145477295
loss_pred:0.013849858194589615, decouple_loss:0.0003500643651932478
loss_pred:0.014096921309828758, decouple_loss:0.0004013521538581699
Iteration: 3332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44917574524879456, gen p mean: -0.1102132573723793, mean p set: 0.4497552812099457
loss_pred:0.014018875546753407, decouple_loss:0.0005316497408784926
The modified gen p mean: 0.449337899684906, gen p mean: -0.11455179750919342, mean p set: 0.44991418719291687The modified gen p mean: 0.448274165391922, gen p mean: -0.11569509655237198, mean p set: 0.44884949922561646
loss_pred:0.014341122470796108, decouple_loss:0.00035690091317519546
loss_pred:0.014921249821782112, decouple_loss:0.000354294286807999
Iteration: 3333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919294118881226, gen p mean: -0.11535797268152237, mean p set: 0.4497673809528351
loss_pred:0.014698592014610767, decouple_loss:0.0005206925561651587
The modified gen p mean: 0.4482767581939697, gen p mean: -0.1135726273059845, mean p set: 0.44885316491127014The modified gen p mean: 0.44908592104911804, gen p mean: -0.1147160604596138, mean p set: 0.4496645927429199
loss_pred:0.01476942840963602, decouple_loss:0.00031169672729447484
loss_pred:0.014221210032701492, decouple_loss:0.00046865877811796963
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
NaN value num: 0
Iteration: 3334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519527554512024, gen p mean: -0.1093863993883133, mean p set: 0.4525293707847595
loss_pred:0.015444258227944374, decouple_loss:0.00040669681038707495
The modified gen p mean: 0.4536351263523102, gen p mean: -0.1183154284954071, mean p set: 0.4542112350463867
loss_pred:0.014927828684449196, decouple_loss:0.0006314912461675704
The modified gen p mean: 0.45156678557395935, gen p mean: -0.11197564750909805, mean p set: 0.4521428048610687
loss_pred:0.014133607968688011, decouple_loss:0.00036614417331293225
Iteration: 3335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45052462816238403, gen p mean: -0.10152693837881088, mean p set: 0.4511021673679352
loss_pred:0.014964881353080273, decouple_loss:0.0004161268880125135
The modified gen p mean: 0.45342397689819336, gen p mean: -0.107315294444561, mean p set: 0.45400142669677734
loss_pred:0.014789402484893799, decouple_loss:0.00039419482345692813
The modified gen p mean: 0.4512022137641907, gen p mean: -0.11186200380325317, mean p set: 0.4517782926559448
loss_pred:0.015021657571196556, decouple_loss:0.0004620781692210585
Iteration: 3336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523874819278717, gen p mean: -0.1082468330860138, mean p set: 0.4529651403427124
loss_pred:0.014679312705993652, decouple_loss:0.00033599193557165563
The modified gen p mean: 0.45340102910995483, gen p mean: -0.10704047977924347, mean p set: 0.4539780914783478
The modified gen p mean: 0.45024892687797546, gen p mean: -0.11186244338750839, mean p set: 0.4508254826068878
loss_pred:0.014873940497636795, decouple_loss:0.0004442367353476584
loss_pred:0.015317510813474655, decouple_loss:0.0004735045658890158
Iteration: 3337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45217758417129517, gen p mean: -0.10622821748256683, mean p set: 0.4527541399002075
loss_pred:0.014941107481718063, decouple_loss:0.000316010758979246
The modified gen p mean: 0.4535459578037262, gen p mean: -0.10988085716962814, mean p set: 0.4541240334510803
loss_pred:0.015010911040008068, decouple_loss:0.0003040322626475245
The modified gen p mean: 0.45321306586265564, gen p mean: -0.10268937796354294, mean p set: 0.45378997921943665
loss_pred:0.014315524138510227, decouple_loss:0.0003832117945421487
Iteration: 3338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978997111320496, gen p mean: -0.10624106228351593, mean p set: 0.4503670632839203
loss_pred:0.01468611229211092, decouple_loss:0.00030130200320854783
The modified gen p mean: 0.4522606432437897, gen p mean: -0.1037568673491478, mean p set: 0.4528374671936035
The modified gen p mean: 0.4524492919445038, gen p mean: -0.11201661080121994, mean p set: 0.45302614569664
loss_pred:0.015372495166957378, decouple_loss:0.00037835314287804067
loss_pred:0.014530832879245281, decouple_loss:0.0003541031910572201
Iteration: 3339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45299220085144043, gen p mean: -0.10582483559846878, mean p set: 0.45356857776641846
loss_pred:0.013943738304078579, decouple_loss:0.00031796543044038117
The modified gen p mean: 0.45018133521080017, gen p mean: -0.10611619055271149, mean p set: 0.4507599174976349
loss_pred:0.014806664548814297, decouple_loss:0.0003875194233842194
The modified gen p mean: 0.4534734785556793, gen p mean: -0.10565472394227982, mean p set: 0.4540506899356842
loss_pred:0.014843497425317764, decouple_loss:0.0005691591068170965
Iteration: 3340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45180606842041016, gen p mean: -0.10985846817493439, mean p set: 0.45238205790519714
loss_pred:0.0157769825309515, decouple_loss:0.00033491471549496055
The modified gen p mean: 0.45117005705833435, gen p mean: -0.11402195692062378, mean p set: 0.45174646377563477
loss_pred:0.014960790984332561, decouple_loss:0.00029084677225910127
The modified gen p mean: 0.4524647295475006, gen p mean: -0.11233220994472504, mean p set: 0.453043133020401
loss_pred:0.014496032148599625, decouple_loss:0.0003469181538093835
2023-05-02 16:25:11 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1264045685529709, mean p set: 0.4502691626548767
loss_pred:0.016747048124670982, decouple_loss:0.00035568178282119334
The modified gen p mean: 0.44953662157058716, gen p mean: -0.11996643245220184, mean p set: 0.4500633478164673
loss_pred:0.016075415536761284, decouple_loss:0.00039486176683567464
The modified gen p mean: 0.44982877373695374, gen p mean: -0.1192159429192543, mean p set: 0.45035696029663086
loss_pred:0.01631380431354046, decouple_loss:0.00039413158083334565
WV_1_PC_1_EH_0_PS_40, loss: 0.016397833824157715, avg_mse: 0.02567727491259575
current test mse: 0.025677
Iteration: 3341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45339515805244446, gen p mean: -0.11260378360748291, mean p set: 0.45397165417671204
loss_pred:0.014176839031279087, decouple_loss:0.0004173960187472403
The modified gen p mean: 0.4521661400794983, gen p mean: -0.11101221293210983, mean p set: 0.4527439475059509The modified gen p mean: 0.4499272108078003, gen p mean: -0.11260659247636795, mean p set: 0.4505046308040619
loss_pred:0.014676235616207123, decouple_loss:0.0003651102597359568loss_pred:0.014486387372016907, decouple_loss:0.00036758376518264413
Iteration: 3342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4540698230266571, gen p mean: -0.11765946447849274, mean p set: 0.45464667677879333
loss_pred:0.014468188397586346, decouple_loss:0.0004113680333830416
The modified gen p mean: 0.45172297954559326, gen p mean: -0.11741936206817627, mean p set: 0.4522990584373474The modified gen p mean: 0.4526745676994324, gen p mean: -0.11817500740289688, mean p set: 0.4532560408115387
loss_pred:0.014779224060475826, decouple_loss:0.0003874660760629922
loss_pred:0.014600353315472603, decouple_loss:0.00037055707070976496
Iteration: 3343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45038580894470215, gen p mean: -0.11029306799173355, mean p set: 0.450962096452713
loss_pred:0.015107396058738232, decouple_loss:0.00043892874964512885
The modified gen p mean: 0.45263051986694336, gen p mean: -0.1157408133149147, mean p set: 0.4532091021537781
loss_pred:0.015324868261814117, decouple_loss:0.000415688322391361
The modified gen p mean: 0.45271408557891846, gen p mean: -0.11270555853843689, mean p set: 0.4532904326915741
loss_pred:0.01483464427292347, decouple_loss:0.0004797664878424257
Iteration: 3344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527897834777832, gen p mean: -0.11380577832460403, mean p set: 0.4533679187297821
loss_pred:0.014209468849003315, decouple_loss:0.0003182030632160604
The modified gen p mean: 0.4520471394062042, gen p mean: -0.10961506515741348, mean p set: 0.4526262879371643
loss_pred:0.014670411124825478, decouple_loss:0.0004097319033462554
The modified gen p mean: 0.45177701115608215, gen p mean: -0.11331858485937119, mean p set: 0.4523538649082184
loss_pred:0.014578592032194138, decouple_loss:0.0003470974916126579
Iteration: 3345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534100294113159, gen p mean: -0.10673489421606064, mean p set: 0.4539869725704193
loss_pred:0.015422122552990913, decouple_loss:0.0003077821165788919
The modified gen p mean: 0.4526002109050751, gen p mean: -0.10917901992797852, mean p set: 0.45317909121513367
loss_pred:0.015029335394501686, decouple_loss:0.0002882256230805069
The modified gen p mean: 0.4529310464859009, gen p mean: -0.10826613754034042, mean p set: 0.4535069465637207
loss_pred:0.014098113402724266, decouple_loss:0.0002884984714910388
Iteration: 3346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452880322933197, gen p mean: -0.10825677961111069, mean p set: 0.4534578025341034
loss_pred:0.01454830076545477, decouple_loss:0.0004784208722412586
The modified gen p mean: 0.4524008631706238, gen p mean: -0.10663963854312897, mean p set: 0.45297572016716003
The modified gen p mean: 0.4511762261390686, gen p mean: -0.11125850677490234, mean p set: 0.4517534077167511
loss_pred:0.015434185974299908, decouple_loss:0.00031783164013177156
loss_pred:0.014541419222950935, decouple_loss:0.00044167746091261506
Iteration: 3347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528476893901825, gen p mean: -0.10623776167631149, mean p set: 0.4534248113632202
loss_pred:0.014615706168115139, decouple_loss:0.0003959940222557634
The modified gen p mean: 0.45313453674316406, gen p mean: -0.10254644602537155, mean p set: 0.45371225476264954
loss_pred:0.014778249897062778, decouple_loss:0.0003584425139706582
The modified gen p mean: 0.4528881013393402, gen p mean: -0.10454733669757843, mean p set: 0.4534684121608734
loss_pred:0.014427661895751953, decouple_loss:0.0002988630149047822
Iteration: 3348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45141977071762085, gen p mean: -0.10419684648513794, mean p set: 0.45199844241142273
loss_pred:0.014592551626265049, decouple_loss:0.0005037743831053376
The modified gen p mean: 0.45372456312179565, gen p mean: -0.10196132212877274, mean p set: 0.4543021321296692
The modified gen p mean: 0.4505975842475891, gen p mean: -0.09902788698673248, mean p set: 0.45117396116256714
loss_pred:0.01459707971662283, decouple_loss:0.00041307066567242146
loss_pred:0.014670156873762608, decouple_loss:0.00028042527264915407
Iteration: 3349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45349186658859253, gen p mean: -0.09947850555181503, mean p set: 0.45406821370124817
loss_pred:0.014370077289640903, decouple_loss:0.0004058350168634206
The modified gen p mean: 0.4510824680328369, gen p mean: -0.1012418195605278, mean p set: 0.4516587555408478
loss_pred:0.014148668386042118, decouple_loss:0.0003066276840399951
The modified gen p mean: 0.45200905203819275, gen p mean: -0.10200927406549454, mean p set: 0.45258408784866333
loss_pred:0.01482428889721632, decouple_loss:0.00043003124301321805
Iteration: 3350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506300091743469, gen p mean: -0.10546915233135223, mean p set: 0.45120686292648315
loss_pred:0.014524269849061966, decouple_loss:0.00038960264646448195
The modified gen p mean: 0.452669233083725, gen p mean: -0.10490380972623825, mean p set: 0.45324504375457764
loss_pred:0.014718381687998772, decouple_loss:0.0003046299098059535
The modified gen p mean: 0.4518502652645111, gen p mean: -0.10375888645648956, mean p set: 0.452427476644516
loss_pred:0.01486104354262352, decouple_loss:0.0003010962682310492
2023-05-02 16:27:17 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11608372628688812, mean p set: 0.4502691626548767
loss_pred:0.01672653667628765, decouple_loss:0.0004142870311625302
The modified gen p mean: 0.4495337903499603, gen p mean: -0.10935422033071518, mean p set: 0.4500633478164673
loss_pred:0.016179481521248817, decouple_loss:0.00042221686453558505
The modified gen p mean: 0.44982731342315674, gen p mean: -0.10887113213539124, mean p set: 0.45035696029663086
loss_pred:0.01645296812057495, decouple_loss:0.00041403231443837285
WV_1_PC_1_EH_0_PS_40, loss: 0.016473837196826935, avg_mse: 0.025749890133738518
current test mse: 0.02575
Iteration: 3351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45061203837394714, gen p mean: -0.10784702003002167, mean p set: 0.4511880576610565
loss_pred:0.015039934776723385, decouple_loss:0.0003488764341454953
The modified gen p mean: 0.4524173438549042, gen p mean: -0.10036293417215347, mean p set: 0.45299163460731506
loss_pred:0.013954107649624348, decouple_loss:0.00039629204547964036
The modified gen p mean: 0.45180490612983704, gen p mean: -0.09921860694885254, mean p set: 0.4523839056491852
loss_pred:0.014964629895985126, decouple_loss:0.0004108109278604388
Iteration: 3352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520602822303772, gen p mean: -0.09948411583900452, mean p set: 0.45263591408729553
loss_pred:0.014880613423883915, decouple_loss:0.00039236698648892343
The modified gen p mean: 0.4509482979774475, gen p mean: -0.1069103479385376, mean p set: 0.4515247046947479
The modified gen p mean: 0.45121267437934875, gen p mean: -0.10588360577821732, mean p set: 0.45178741216659546
loss_pred:0.014594598673284054, decouple_loss:0.00041266437619924545
loss_pred:0.01425125915557146, decouple_loss:0.00043313123751431704
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
NaN value num: 0
Iteration: 3353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522102475166321, gen p mean: -0.09791307151317596, mean p set: 0.4527874290943146
loss_pred:0.015203090384602547, decouple_loss:0.0005271137924864888
The modified gen p mean: 0.44995853304862976, gen p mean: -0.10137699544429779, mean p set: 0.45053553581237793
The modified gen p mean: 0.45148584246635437, gen p mean: -0.10177186131477356, mean p set: 0.4520612061023712
loss_pred:0.01527126133441925, decouple_loss:0.00036363734398037195
loss_pred:0.015234943479299545, decouple_loss:0.0005343104712665081
Iteration: 3354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45144543051719666, gen p mean: -0.11066623777151108, mean p set: 0.4520227611064911
The modified gen p mean: 0.4504491090774536, gen p mean: -0.10388080030679703, mean p set: 0.4510248601436615
loss_pred:0.01501398254185915, decouple_loss:0.0004497053741943091
loss_pred:0.014757546596229076, decouple_loss:0.00033881000126712024
The modified gen p mean: 0.45205003023147583, gen p mean: -0.10654057562351227, mean p set: 0.45262742042541504
loss_pred:0.014690329320728779, decouple_loss:0.0003247673739679158
Iteration: 3355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45158106088638306, gen p mean: -0.11096280068159103, mean p set: 0.4521573483943939
loss_pred:0.015361404977738857, decouple_loss:0.0004077185003552586
The modified gen p mean: 0.4519116282463074, gen p mean: -0.11911533772945404, mean p set: 0.4524872899055481
loss_pred:0.014833110384643078, decouple_loss:0.0004853992140851915
The modified gen p mean: 0.45175230503082275, gen p mean: -0.11450302600860596, mean p set: 0.4523273706436157
loss_pred:0.015023699030280113, decouple_loss:0.0005340637289918959
Iteration: 3356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504510760307312, gen p mean: -0.1205097958445549, mean p set: 0.4510296881198883
loss_pred:0.015621108002960682, decouple_loss:0.0003130397526547313
The modified gen p mean: 0.45100826025009155, gen p mean: -0.12034691125154495, mean p set: 0.4515860676765442
The modified gen p mean: 0.4511469900608063, gen p mean: -0.11648199707269669, mean p set: 0.45172441005706787
loss_pred:0.015046156942844391, decouple_loss:0.0004583326808642596
loss_pred:0.014998998492956161, decouple_loss:0.0003747862938325852
Iteration: 3357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45192384719848633, gen p mean: -0.12185375392436981, mean p set: 0.45249855518341064
loss_pred:0.015601643361151218, decouple_loss:0.00047391472617164254
The modified gen p mean: 0.4516224265098572, gen p mean: -0.12327747792005539, mean p set: 0.45219916105270386
The modified gen p mean: 0.4520522356033325, gen p mean: -0.11656732112169266, mean p set: 0.452627569437027
loss_pred:0.01511659286916256, decouple_loss:0.0006057602586224675
loss_pred:0.015587016940116882, decouple_loss:0.0006741798715665936
Iteration: 3358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510042369365692, gen p mean: -0.11886367201805115, mean p set: 0.4515799880027771
loss_pred:0.015070908702909946, decouple_loss:0.0004312089295126498
The modified gen p mean: 0.4504592716693878, gen p mean: -0.12245368212461472, mean p set: 0.4510330855846405
loss_pred:0.01503836177289486, decouple_loss:0.00044477428309619427
The modified gen p mean: 0.4515113830566406, gen p mean: -0.12115375697612762, mean p set: 0.45208823680877686
loss_pred:0.014856088906526566, decouple_loss:0.0003912076645065099
Iteration: 3359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511537253856659, gen p mean: -0.11682023108005524, mean p set: 0.451729416847229
loss_pred:0.015090994536876678, decouple_loss:0.0005166552728042006
The modified gen p mean: 0.45109930634498596, gen p mean: -0.1183113306760788, mean p set: 0.4516755938529968
loss_pred:0.014688098803162575, decouple_loss:0.00046208634739741683
The modified gen p mean: 0.45128706097602844, gen p mean: -0.11590204387903214, mean p set: 0.45186206698417664
loss_pred:0.015270715579390526, decouple_loss:0.00036623029154725373
Iteration: 3360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512648582458496, gen p mean: -0.11581970751285553, mean p set: 0.45184382796287537
loss_pred:0.014273164793848991, decouple_loss:0.0004307685303501785
The modified gen p mean: 0.4517500102519989, gen p mean: -0.11713413894176483, mean p set: 0.4523274898529053
The modified gen p mean: 0.45203670859336853, gen p mean: -0.10863851755857468, mean p set: 0.45261338353157043
loss_pred:0.014972478151321411, decouple_loss:0.0004424652724992484
loss_pred:0.014786865562200546, decouple_loss:0.0003632940351963043
2023-05-02 16:29:59 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12543566524982452, mean p set: 0.4502691626548767
loss_pred:0.016749978065490723, decouple_loss:0.00037871088716201484
The modified gen p mean: 0.44953441619873047, gen p mean: -0.11859138309955597, mean p set: 0.4500633478164673
loss_pred:0.016189690679311752, decouple_loss:0.0004118810757063329
The modified gen p mean: 0.4498279094696045, gen p mean: -0.1181437149643898, mean p set: 0.45035696029663086
loss_pred:0.01647663675248623, decouple_loss:0.0003841009456664324
WV_1_PC_1_EH_0_PS_40, loss: 0.016491681337356567, avg_mse: 0.025756962597370148
current test mse: 0.025757
Iteration: 3361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990989565849304, gen p mean: -0.11446920037269592, mean p set: 0.4504854083061218
loss_pred:0.015841785818338394, decouple_loss:0.00034294169745408
The modified gen p mean: 0.4514696002006531, gen p mean: -0.10985329747200012, mean p set: 0.45204487442970276
loss_pred:0.014216789975762367, decouple_loss:0.0003840684948954731
The modified gen p mean: 0.44963353872299194, gen p mean: -0.10646430402994156, mean p set: 0.45021140575408936
loss_pred:0.014952009543776512, decouple_loss:0.0004904015804640949
Iteration: 3362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500347375869751, gen p mean: -0.10594765096902847, mean p set: 0.45061367750167847
loss_pred:0.015159152448177338, decouple_loss:0.0004678495170082897
The modified gen p mean: 0.4495279788970947, gen p mean: -0.10592606663703918, mean p set: 0.4501059055328369
The modified gen p mean: 0.45151934027671814, gen p mean: -0.11088209599256516, mean p set: 0.45209604501724243
loss_pred:0.014894593507051468, decouple_loss:0.0004234009829815477
loss_pred:0.014779056422412395, decouple_loss:0.0004096534685231745
Iteration: 3363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45209500193595886, gen p mean: -0.11283688247203827, mean p set: 0.4526708424091339
loss_pred:0.014784821309149265, decouple_loss:0.0004116273776162416
The modified gen p mean: 0.4514239430427551, gen p mean: -0.10541310906410217, mean p set: 0.45199981331825256
loss_pred:0.014511169865727425, decouple_loss:0.00037999748019501567
The modified gen p mean: 0.45251011848449707, gen p mean: -0.10689383000135422, mean p set: 0.4530870020389557
loss_pred:0.01470959559082985, decouple_loss:0.000430502463132143
Iteration: 3364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45204514265060425, gen p mean: -0.107417531311512, mean p set: 0.4526216387748718
The modified gen p mean: 0.4514162242412567, gen p mean: -0.10689163208007812, mean p set: 0.4519910514354706
loss_pred:0.014703935012221336, decouple_loss:0.0005101888091303408
loss_pred:0.015068206936120987, decouple_loss:0.000460014765849337
The modified gen p mean: 0.4510706067085266, gen p mean: -0.10970024764537811, mean p set: 0.45164716243743896
loss_pred:0.01470685563981533, decouple_loss:0.00042178473086096346
Iteration: 3365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452605664730072, gen p mean: -0.10581144690513611, mean p set: 0.4531855285167694
loss_pred:0.01468701008707285, decouple_loss:0.0003870616783387959
The modified gen p mean: 0.4520565867424011, gen p mean: -0.1057107076048851, mean p set: 0.4526340067386627
loss_pred:0.01491560135036707, decouple_loss:0.000915127748157829
The modified gen p mean: 0.45241111516952515, gen p mean: -0.10515130311250687, mean p set: 0.4529881477355957
loss_pred:0.015231205150485039, decouple_loss:0.0008604348986409605
Iteration: 3366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45186975598335266, gen p mean: -0.11311938613653183, mean p set: 0.45244550704956055
loss_pred:0.014497003518044949, decouple_loss:0.0005167289637029171
The modified gen p mean: 0.45099687576293945, gen p mean: -0.10789241641759872, mean p set: 0.45157474279403687
loss_pred:0.014649643562734127, decouple_loss:0.00031136529287323356
The modified gen p mean: 0.45150354504585266, gen p mean: -0.10730310529470444, mean p set: 0.45208021998405457
loss_pred:0.014092282392084599, decouple_loss:0.0005837999051436782
Iteration: 3367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521418809890747, gen p mean: -0.10476452112197876, mean p set: 0.4527184069156647
loss_pred:0.014773072674870491, decouple_loss:0.0005434679333120584
The modified gen p mean: 0.45076897740364075, gen p mean: -0.11041785031557083, mean p set: 0.45134681463241577
The modified gen p mean: 0.45193004608154297, gen p mean: -0.11085312813520432, mean p set: 0.4525078237056732
loss_pred:0.014652774669229984, decouple_loss:0.0004636499215848744
loss_pred:0.01504354365170002, decouple_loss:0.0004452482389751822
Iteration: 3368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512873589992523, gen p mean: -0.10730677098035812, mean p set: 0.4518626928329468
loss_pred:0.014705696143209934, decouple_loss:0.0003230867732781917
The modified gen p mean: 0.45185667276382446, gen p mean: -0.10417861491441727, mean p set: 0.45243212580680847
loss_pred:0.014636107720434666, decouple_loss:0.0003841456491500139
The modified gen p mean: 0.4512946307659149, gen p mean: -0.10415614396333694, mean p set: 0.4518716335296631
loss_pred:0.0146593963727355, decouple_loss:0.0003546463558450341
Iteration: 3369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45153796672821045, gen p mean: -0.10211818665266037, mean p set: 0.45211732387542725
loss_pred:0.014780674129724503, decouple_loss:0.0004735287802759558
The modified gen p mean: 0.4514717161655426, gen p mean: -0.1076197475194931, mean p set: 0.4520479440689087
The modified gen p mean: 0.45141270756721497, gen p mean: -0.10405728965997696, mean p set: 0.4519905745983124
loss_pred:0.014450926333665848, decouple_loss:0.0003569441905710846
loss_pred:0.014912515878677368, decouple_loss:0.0003937121364288032
Iteration: 3370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529099464416504, gen p mean: -0.10609669983386993, mean p set: 0.4534855782985687
The modified gen p mean: 0.45147690176963806, gen p mean: -0.10888644307851791, mean p set: 0.45205479860305786
loss_pred:0.014636925421655178, decouple_loss:0.00047138481750153005
loss_pred:0.014198187738656998, decouple_loss:0.00038756008143536747
The modified gen p mean: 0.4493306577205658, gen p mean: -0.1011228859424591, mean p set: 0.4499078094959259
loss_pred:0.015086761675775051, decouple_loss:0.0005818800418637693
2023-05-02 16:32:05 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12073460966348648, mean p set: 0.4502691626548767
loss_pred:0.016767751425504684, decouple_loss:0.000569696887396276
The modified gen p mean: 0.4495350122451782, gen p mean: -0.11420323699712753, mean p set: 0.4500633478164673
loss_pred:0.016120698302984238, decouple_loss:0.000575902231503278
The modified gen p mean: 0.4498288035392761, gen p mean: -0.11384827643632889, mean p set: 0.45035696029663086
loss_pred:0.016440672799944878, decouple_loss:0.0004976410418748856
WV_1_PC_1_EH_0_PS_40, loss: 0.016470428556203842, avg_mse: 0.02573315240442753
current test mse: 0.025733
Iteration: 3371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45195382833480835, gen p mean: -0.11313126236200333, mean p set: 0.4525282084941864
loss_pred:0.014429274015128613, decouple_loss:0.0004984906408935785
The modified gen p mean: 0.45193567872047424, gen p mean: -0.10274721682071686, mean p set: 0.4525144100189209The modified gen p mean: 0.4512680172920227, gen p mean: -0.10869663953781128, mean p set: 0.4518454968929291
loss_pred:0.014827854931354523, decouple_loss:0.0008360890788026154
loss_pred:0.014842433854937553, decouple_loss:0.0006640204228460789
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
NaN value num: 0
Iteration: 3372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510098397731781, gen p mean: -0.11194049566984177, mean p set: 0.45158782601356506
loss_pred:0.016092276200652122, decouple_loss:0.0005132924998179078
The modified gen p mean: 0.45230787992477417, gen p mean: -0.10351479798555374, mean p set: 0.45288509130477905The modified gen p mean: 0.45156723260879517, gen p mean: -0.10491246730089188, mean p set: 0.4521452486515045
loss_pred:0.015399087220430374, decouple_loss:0.00047398978495039046loss_pred:0.01584537886083126, decouple_loss:0.0004404288192745298
Iteration: 3373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975247979164124, gen p mean: -0.11260934919118881, mean p set: 0.45032763481140137
loss_pred:0.015917865559458733, decouple_loss:0.0005434140912257135
The modified gen p mean: 0.45176973938941956, gen p mean: -0.11315714567899704, mean p set: 0.45234790444374084
loss_pred:0.015776321291923523, decouple_loss:0.0004247903125360608
The modified gen p mean: 0.44902417063713074, gen p mean: -0.11089734733104706, mean p set: 0.4496026933193207
loss_pred:0.016391238197684288, decouple_loss:0.0004678227996919304
Iteration: 3374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500693082809448, gen p mean: -0.11567305028438568, mean p set: 0.45064473152160645
loss_pred:0.016130302101373672, decouple_loss:0.0005728882388211787
The modified gen p mean: 0.4515905976295471, gen p mean: -0.11315591633319855, mean p set: 0.4521689713001251
loss_pred:0.016012508422136307, decouple_loss:0.0004658483376260847
The modified gen p mean: 0.45019227266311646, gen p mean: -0.12015921622514725, mean p set: 0.450769305229187
loss_pred:0.015348262153565884, decouple_loss:0.0004564102564472705
Iteration: 3375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511409103870392, gen p mean: -0.11448699235916138, mean p set: 0.45171743631362915
loss_pred:0.015544631518423557, decouple_loss:0.0004144932609051466
The modified gen p mean: 0.4530164897441864, gen p mean: -0.11172861605882645, mean p set: 0.4535941779613495
loss_pred:0.015880608931183815, decouple_loss:0.00040318744140677154
The modified gen p mean: 0.4508800506591797, gen p mean: -0.1148284375667572, mean p set: 0.4514564573764801
loss_pred:0.015446840785443783, decouple_loss:0.0004024604568257928
Iteration: 3376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521426558494568, gen p mean: -0.12098295986652374, mean p set: 0.45271924138069153
loss_pred:0.015135045163333416, decouple_loss:0.0006603123038075864
The modified gen p mean: 0.4515340030193329, gen p mean: -0.11757324635982513, mean p set: 0.45210960507392883
The modified gen p mean: 0.4514535963535309, gen p mean: -0.11702737212181091, mean p set: 0.45202744007110596
loss_pred:0.01498107984662056, decouple_loss:0.0007751889643259346
loss_pred:0.015880141407251358, decouple_loss:0.0006784274009987712
Iteration: 3377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128780603408813, gen p mean: -0.114414282143116, mean p set: 0.4518618583679199
loss_pred:0.01564526930451393, decouple_loss:0.00038615299854427576
The modified gen p mean: 0.45226821303367615, gen p mean: -0.11867903172969818, mean p set: 0.45284631848335266
The modified gen p mean: 0.4522732198238373, gen p mean: -0.11962423473596573, mean p set: 0.45284944772720337
loss_pred:0.01526498794555664, decouple_loss:0.0004733105597551912
loss_pred:0.015731830149888992, decouple_loss:0.0007520472281612456
Iteration: 3378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45216304063796997, gen p mean: -0.11602871865034103, mean p set: 0.45274025201797485
loss_pred:0.015733182430267334, decouple_loss:0.00046324546565301716
The modified gen p mean: 0.45009371638298035, gen p mean: -0.11749502271413803, mean p set: 0.45066869258880615
The modified gen p mean: 0.4523249566555023, gen p mean: -0.10963716357946396, mean p set: 0.4529035687446594
loss_pred:0.01628257893025875, decouple_loss:0.00040484400233253837
loss_pred:0.015722984448075294, decouple_loss:0.00036427867598831654
Iteration: 3379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509960114955902, gen p mean: -0.1172117367386818, mean p set: 0.45157456398010254
loss_pred:0.015319843776524067, decouple_loss:0.0004180939868092537
The modified gen p mean: 0.450528085231781, gen p mean: -0.11599288880825043, mean p set: 0.4511050879955292
The modified gen p mean: 0.45060399174690247, gen p mean: -0.11683844029903412, mean p set: 0.4511813521385193
loss_pred:0.01630127616226673, decouple_loss:0.00042851167381741107
loss_pred:0.01549556851387024, decouple_loss:0.00044828405953012407
Iteration: 3380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524238109588623, gen p mean: -0.11767282336950302, mean p set: 0.4530024528503418
loss_pred:0.015112423337996006, decouple_loss:0.0005925795994699001
The modified gen p mean: 0.4519546329975128, gen p mean: -0.11467214673757553, mean p set: 0.4525289833545685
The modified gen p mean: 0.452034592628479, gen p mean: -0.11200690269470215, mean p set: 0.45261165499687195
loss_pred:0.015725329518318176, decouple_loss:0.0005794318276457489
loss_pred:0.014688589610159397, decouple_loss:0.0004824566130992025
2023-05-02 16:35:03 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13126496970653534, mean p set: 0.4502691626548767
loss_pred:0.016814686357975006, decouple_loss:0.00046014561667107046
The modified gen p mean: 0.44953230023384094, gen p mean: -0.12473364919424057, mean p set: 0.4500633478164673
loss_pred:0.016100360080599785, decouple_loss:0.000530296703800559
The modified gen p mean: 0.44982725381851196, gen p mean: -0.12452992796897888, mean p set: 0.45035696029663086
loss_pred:0.01647583581507206, decouple_loss:0.0004720670694950968
WV_1_PC_1_EH_0_PS_40, loss: 0.016488002613186836, avg_mse: 0.0257825069129467
current test mse: 0.025783
Iteration: 3381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497372508049011, gen p mean: -0.12482811510562897, mean p set: 0.4503115713596344
loss_pred:0.015390821732580662, decouple_loss:0.00038274130201898515
The modified gen p mean: 0.44962558150291443, gen p mean: -0.12416352331638336, mean p set: 0.4502023756504059
loss_pred:0.015269946306943893, decouple_loss:0.0004752882232423872
The modified gen p mean: 0.452635258436203, gen p mean: -0.11838526278734207, mean p set: 0.453212171792984
loss_pred:0.015667714178562164, decouple_loss:0.0005044430727139115
Iteration: 3382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45171216130256653, gen p mean: -0.1250510960817337, mean p set: 0.4522883892059326
loss_pred:0.015222497284412384, decouple_loss:0.0003364489821251482
The modified gen p mean: 0.45103514194488525, gen p mean: -0.12650473415851593, mean p set: 0.4516104459762573The modified gen p mean: 0.452114462852478, gen p mean: -0.11427613347768784, mean p set: 0.45269373059272766
loss_pred:0.015819646418094635, decouple_loss:0.00039009368629194796
loss_pred:0.015449358150362968, decouple_loss:0.00043657078640535474
Iteration: 3383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516952335834503, gen p mean: -0.12030869722366333, mean p set: 0.45227110385894775
loss_pred:0.015338343568146229, decouple_loss:0.0005271889385767281
The modified gen p mean: 0.4527226984500885, gen p mean: -0.12145575881004333, mean p set: 0.4533001780509949
The modified gen p mean: 0.45220744609832764, gen p mean: -0.11669626086950302, mean p set: 0.45278608798980713
loss_pred:0.01535973884165287, decouple_loss:0.00032312769326381385
loss_pred:0.01651492342352867, decouple_loss:0.00040107499808073044
Iteration: 3384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514440596103668, gen p mean: -0.11477293819189072, mean p set: 0.4520201086997986
loss_pred:0.014979102648794651, decouple_loss:0.0004310129734221846
The modified gen p mean: 0.45054176449775696, gen p mean: -0.122404083609581, mean p set: 0.45111966133117676
loss_pred:0.016035789623856544, decouple_loss:0.0004331355157773942
The modified gen p mean: 0.45184963941574097, gen p mean: -0.11378348618745804, mean p set: 0.4524257183074951
loss_pred:0.016303790733218193, decouple_loss:0.00044937882921658456
Iteration: 3385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45254868268966675, gen p mean: -0.1172817200422287, mean p set: 0.4531249403953552
loss_pred:0.015587231144309044, decouple_loss:0.0006734453490935266
The modified gen p mean: 0.45240500569343567, gen p mean: -0.11652108281850815, mean p set: 0.4529826045036316
loss_pred:0.015524921007454395, decouple_loss:0.0004575435013975948
The modified gen p mean: 0.45097532868385315, gen p mean: -0.12325608730316162, mean p set: 0.45155251026153564
loss_pred:0.015760809183120728, decouple_loss:0.0006750677712261677
Iteration: 3386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024722814559937, gen p mean: -0.12143158912658691, mean p set: 0.4508230984210968
loss_pred:0.016013983637094498, decouple_loss:0.0006909024668857455
The modified gen p mean: 0.45263656973838806, gen p mean: -0.12254425138235092, mean p set: 0.45321333408355713
loss_pred:0.01527227833867073, decouple_loss:0.0004021654895041138
The modified gen p mean: 0.4525001645088196, gen p mean: -0.12668295204639435, mean p set: 0.45307838916778564
loss_pred:0.01522892341017723, decouple_loss:0.00041268308996222913
Iteration: 3387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45293569564819336, gen p mean: -0.12003282457590103, mean p set: 0.4535127878189087
loss_pred:0.015874294564127922, decouple_loss:0.0004302947490941733
The modified gen p mean: 0.4532798230648041, gen p mean: -0.1195233017206192, mean p set: 0.45385733246803284
The modified gen p mean: 0.4515024721622467, gen p mean: -0.12062676250934601, mean p set: 0.4520774781703949
loss_pred:0.016363443806767464, decouple_loss:0.00040819201967678964
loss_pred:0.015357928350567818, decouple_loss:0.0005351065774448216
Iteration: 3388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45027467608451843, gen p mean: -0.12451079487800598, mean p set: 0.4508522152900696
loss_pred:0.015544101595878601, decouple_loss:0.0005681355833075941
The modified gen p mean: 0.44975990056991577, gen p mean: -0.12066840380430222, mean p set: 0.450334757566452
The modified gen p mean: 0.449739009141922, gen p mean: -0.1227814257144928, mean p set: 0.4503157436847687
loss_pred:0.016068272292613983, decouple_loss:0.0006535344873555005
loss_pred:0.01580040715634823, decouple_loss:0.0005774055607616901
Iteration: 3389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45295870304107666, gen p mean: -0.12006063014268875, mean p set: 0.4535359740257263
loss_pred:0.015789706259965897, decouple_loss:0.00040616068872623146
The modified gen p mean: 0.4529728293418884, gen p mean: -0.12417161464691162, mean p set: 0.4535471498966217
The modified gen p mean: 0.4520321786403656, gen p mean: -0.12055843323469162, mean p set: 0.45260950922966003
loss_pred:0.014988436363637447, decouple_loss:0.0006304783164523542
loss_pred:0.01582416146993637, decouple_loss:0.0004529321158770472
Iteration: 3390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45185965299606323, gen p mean: -0.11765946447849274, mean p set: 0.45243576169013977
loss_pred:0.015431339852511883, decouple_loss:0.0004956836928613484
The modified gen p mean: 0.4498230814933777, gen p mean: -0.1178739070892334, mean p set: 0.45039960741996765
The modified gen p mean: 0.45197606086730957, gen p mean: -0.11516987532377243, mean p set: 0.45255225896835327
loss_pred:0.015784109011292458, decouple_loss:0.0004578741791192442
loss_pred:0.014676938764750957, decouple_loss:0.0004395311407279223
2023-05-02 16:37:10 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13051214814186096, mean p set: 0.4502691626548767
loss_pred:0.01683647371828556, decouple_loss:0.00037086516385897994
The modified gen p mean: 0.44953465461730957, gen p mean: -0.12440657615661621, mean p set: 0.4500633478164673
The modified gen p mean: 0.4498290717601776, gen p mean: -0.12400491535663605, mean p set: 0.45035696029663086
loss_pred:0.016127949580550194, decouple_loss:0.0004374990239739418
loss_pred:0.01645507477223873, decouple_loss:0.0003757089434657246
WV_1_PC_1_EH_0_PS_40, loss: 0.016492901369929314, avg_mse: 0.02578645385801792
current test mse: 0.025786
Iteration: 3391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451831579208374, gen p mean: -0.12334340065717697, mean p set: 0.45240524411201477
loss_pred:0.015314735472202301, decouple_loss:0.00048111419891938567
The modified gen p mean: 0.45124614238739014, gen p mean: -0.11449725925922394, mean p set: 0.45182281732559204The modified gen p mean: 0.4512154459953308, gen p mean: -0.11583162844181061, mean p set: 0.4517933130264282
loss_pred:0.015687627717852592, decouple_loss:0.0003677538188640028loss_pred:0.01597924716770649, decouple_loss:0.00034993060398846865
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
NaN value num: 0
Iteration: 3392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45053526759147644, gen p mean: -0.11642380803823471, mean p set: 0.45111262798309326
loss_pred:0.014394027180969715, decouple_loss:0.00044666038593277335
The modified gen p mean: 0.4516146779060364, gen p mean: -0.1150934100151062, mean p set: 0.4521912932395935The modified gen p mean: 0.4493778944015503, gen p mean: -0.11990261822938919, mean p set: 0.449951171875
loss_pred:0.014521660283207893, decouple_loss:0.00039564428152516484loss_pred:0.015092473477125168, decouple_loss:0.0003544092469383031
Iteration: 3393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45160600543022156, gen p mean: -0.11108628660440445, mean p set: 0.45218411087989807
loss_pred:0.014711318537592888, decouple_loss:0.00048335164319723845
The modified gen p mean: 0.44988423585891724, gen p mean: -0.12325197458267212, mean p set: 0.4504610598087311
The modified gen p mean: 0.45089012384414673, gen p mean: -0.11140795797109604, mean p set: 0.4514666199684143
loss_pred:0.014760472811758518, decouple_loss:0.00038721467717550695
loss_pred:0.01518526952713728, decouple_loss:0.00042132596718147397
Iteration: 3394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033952593803406, gen p mean: -0.11415083706378937, mean p set: 0.45091530680656433
loss_pred:0.014299064874649048, decouple_loss:0.00039781886152923107
The modified gen p mean: 0.4516078531742096, gen p mean: -0.11283519119024277, mean p set: 0.45218491554260254
loss_pred:0.014651917852461338, decouple_loss:0.00036530301440507174
The modified gen p mean: 0.4491603672504425, gen p mean: -0.11426720023155212, mean p set: 0.4497377276420593
loss_pred:0.014830597676336765, decouple_loss:0.0005483509157784283
Iteration: 3395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45153599977493286, gen p mean: -0.10651130229234695, mean p set: 0.452114462852478
loss_pred:0.014599545858800411, decouple_loss:0.000501198461279273
The modified gen p mean: 0.4509609639644623, gen p mean: -0.11179596930742264, mean p set: 0.4515382945537567
loss_pred:0.014116965234279633, decouple_loss:0.00041431994759477675
The modified gen p mean: 0.4498739242553711, gen p mean: -0.11338630318641663, mean p set: 0.45044994354248047
loss_pred:0.013704687356948853, decouple_loss:0.00043853861279785633
Iteration: 3396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509108066558838, gen p mean: -0.10658856481313705, mean p set: 0.45148730278015137
loss_pred:0.014333204366266727, decouple_loss:0.0004792299005202949
The modified gen p mean: 0.45132768154144287, gen p mean: -0.10942487418651581, mean p set: 0.4519042372703552
The modified gen p mean: 0.4517756998538971, gen p mean: -0.11210819333791733, mean p set: 0.45235124230384827
loss_pred:0.01455620490014553, decouple_loss:0.00038619679980911314
loss_pred:0.014418358914554119, decouple_loss:0.00032024382380768657
Iteration: 3397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512726664543152, gen p mean: -0.10637368261814117, mean p set: 0.45184803009033203
loss_pred:0.014317547902464867, decouple_loss:0.00039263765211217105
The modified gen p mean: 0.4510819911956787, gen p mean: -0.10457029193639755, mean p set: 0.45165911316871643
loss_pred:0.014549174346029758, decouple_loss:0.0004038123006466776
The modified gen p mean: 0.4507658779621124, gen p mean: -0.1065048947930336, mean p set: 0.4513408839702606
loss_pred:0.013910224661231041, decouple_loss:0.0004031186399515718
Iteration: 3398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44941869378089905, gen p mean: -0.1137201189994812, mean p set: 0.4499944746494293
loss_pred:0.014263780787587166, decouple_loss:0.0003790434275288135
The modified gen p mean: 0.4515419900417328, gen p mean: -0.10648692399263382, mean p set: 0.4521169364452362
loss_pred:0.013942193239927292, decouple_loss:0.00038914039032533765
The modified gen p mean: 0.4508812129497528, gen p mean: -0.102689728140831, mean p set: 0.45145851373672485
loss_pred:0.01438656635582447, decouple_loss:0.0004661884449888021
Iteration: 3399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485553503036499, gen p mean: -0.11423736810684204, mean p set: 0.4491320550441742
loss_pred:0.014607178047299385, decouple_loss:0.00041827873792499304
The modified gen p mean: 0.4521542191505432, gen p mean: -0.11202934384346008, mean p set: 0.4527328312397003
loss_pred:0.014242906123399734, decouple_loss:0.0004207859456073493
The modified gen p mean: 0.4489521384239197, gen p mean: -0.11553628742694855, mean p set: 0.4495277404785156
loss_pred:0.01437393669039011, decouple_loss:0.0004090846923645586
Iteration: 3400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492514431476593, gen p mean: -0.11779452115297318, mean p set: 0.4498288631439209
loss_pred:0.014622057788074017, decouple_loss:0.00045141950249671936
The modified gen p mean: 0.4492605924606323, gen p mean: -0.11580799520015717, mean p set: 0.44983968138694763
The modified gen p mean: 0.4499209225177765, gen p mean: -0.12134982645511627, mean p set: 0.4504970610141754
loss_pred:0.01388564519584179, decouple_loss:0.00038320134626701474
loss_pred:0.014445437118411064, decouple_loss:0.00040601694490760565
2023-05-02 16:39:58 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12680712342262268, mean p set: 0.4502691626548767
loss_pred:0.01688411831855774, decouple_loss:0.0003921985626220703
The modified gen p mean: 0.4495355784893036, gen p mean: -0.12085267901420593, mean p set: 0.4500633478164673
loss_pred:0.01625467650592327, decouple_loss:0.0004024660447612405
The modified gen p mean: 0.44983145594596863, gen p mean: -0.12014113366603851, mean p set: 0.45035696029663086
loss_pred:0.016513604670763016, decouple_loss:0.00040772263309918344
WV_1_PC_1_EH_0_PS_40, loss: 0.016570841893553734, avg_mse: 0.025913506746292114
current test mse: 0.025914
Iteration: 3401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512626528739929, gen p mean: -0.11156207323074341, mean p set: 0.4518391489982605
loss_pred:0.014492581598460674, decouple_loss:0.0004719970456790179
The modified gen p mean: 0.4510434567928314, gen p mean: -0.1071893647313118, mean p set: 0.45161959528923035The modified gen p mean: 0.4513559937477112, gen p mean: -0.11142187565565109, mean p set: 0.4519319236278534
loss_pred:0.014885347336530685, decouple_loss:0.0004959228099323809
loss_pred:0.01431885827332735, decouple_loss:0.0005017794901505113
Iteration: 3402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489935338497162, gen p mean: -0.1155906692147255, mean p set: 0.4495699107646942
loss_pred:0.015122574754059315, decouple_loss:0.0004484805394895375
The modified gen p mean: 0.4502066373825073, gen p mean: -0.10569523274898529, mean p set: 0.45078280568122864The modified gen p mean: 0.4514053165912628, gen p mean: -0.10864955186843872, mean p set: 0.45198163390159607
loss_pred:0.014795624651014805, decouple_loss:0.0004061516374349594
loss_pred:0.014715067110955715, decouple_loss:0.00040858506690710783
Iteration: 3403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479048550128937, gen p mean: -0.11461181193590164, mean p set: 0.44847941398620605
loss_pred:0.01398214790970087, decouple_loss:0.0003341689589433372
The modified gen p mean: 0.4494171142578125, gen p mean: -0.11445821076631546, mean p set: 0.44999441504478455
The modified gen p mean: 0.4514603912830353, gen p mean: -0.1085178554058075, mean p set: 0.45203638076782227
loss_pred:0.01483928319066763, decouple_loss:0.00038423214573413134
loss_pred:0.013842067681252956, decouple_loss:0.00044778166920877993
Iteration: 3404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488687813282013, gen p mean: -0.11210151016712189, mean p set: 0.44944530725479126
loss_pred:0.013951421715319157, decouple_loss:0.0003935687127523124
The modified gen p mean: 0.4492335915565491, gen p mean: -0.1071111261844635, mean p set: 0.4498084783554077
loss_pred:0.014932211488485336, decouple_loss:0.0003354788350407034
The modified gen p mean: 0.451678991317749, gen p mean: -0.10529524087905884, mean p set: 0.4522576630115509
loss_pred:0.013986237347126007, decouple_loss:0.00040181534131988883
Iteration: 3405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44870051741600037, gen p mean: -0.11102363467216492, mean p set: 0.44927680492401123
loss_pred:0.01559957955032587, decouple_loss:0.00047316274140030146
The modified gen p mean: 0.45155569911003113, gen p mean: -0.10395469516515732, mean p set: 0.4521304666996002
loss_pred:0.014625121839344501, decouple_loss:0.00042646750807762146
The modified gen p mean: 0.4503914713859558, gen p mean: -0.10132007300853729, mean p set: 0.4509679973125458
loss_pred:0.014879642054438591, decouple_loss:0.00046791776549071074
Iteration: 3406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479791522026062, gen p mean: -0.11272887885570526, mean p set: 0.44855502247810364
loss_pred:0.013910802081227303, decouple_loss:0.00032486661802977324
The modified gen p mean: 0.4515027701854706, gen p mean: -0.10082703828811646, mean p set: 0.45207884907722473
loss_pred:0.014405745081603527, decouple_loss:0.0004513071326073259
The modified gen p mean: 0.4518878161907196, gen p mean: -0.10696693509817123, mean p set: 0.45246466994285583
loss_pred:0.013722987845540047, decouple_loss:0.0003953115956392139
Iteration: 3407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510212540626526, gen p mean: -0.10871598869562149, mean p set: 0.4515971541404724
loss_pred:0.01403096504509449, decouple_loss:0.00046098671737127006
The modified gen p mean: 0.450616717338562, gen p mean: -0.10494440793991089, mean p set: 0.45119374990463257
loss_pred:0.014686820097267628, decouple_loss:0.00044000192428939044
The modified gen p mean: 0.4516116976737976, gen p mean: -0.10939107835292816, mean p set: 0.4521903395652771
loss_pred:0.014429532922804356, decouple_loss:0.0002860919339582324
Iteration: 3408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45087915658950806, gen p mean: -0.10698061436414719, mean p set: 0.451455295085907
loss_pred:0.014342963695526123, decouple_loss:0.0005223506013862789
The modified gen p mean: 0.4500059187412262, gen p mean: -0.11105359345674515, mean p set: 0.4505823850631714
loss_pred:0.014829089865088463, decouple_loss:0.00045657448936253786
The modified gen p mean: 0.44913962483406067, gen p mean: -0.11888278275728226, mean p set: 0.4497178792953491
loss_pred:0.014376991428434849, decouple_loss:0.0003925522032659501
Iteration: 3409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497048854827881, gen p mean: -0.11689387261867523, mean p set: 0.45028162002563477
loss_pred:0.015056665055453777, decouple_loss:0.00031381018925458193
The modified gen p mean: 0.4498043954372406, gen p mean: -0.11583995819091797, mean p set: 0.45038190484046936
loss_pred:0.014284747652709484, decouple_loss:0.0003604873490985483
The modified gen p mean: 0.4514346718788147, gen p mean: -0.11410962045192719, mean p set: 0.4520106315612793
loss_pred:0.014269312843680382, decouple_loss:0.00035977453808300197
Iteration: 3410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45075997710227966, gen p mean: -0.10653247684240341, mean p set: 0.4513375163078308
loss_pred:0.014417414553463459, decouple_loss:0.00033392253681086004
The modified gen p mean: 0.44790905714035034, gen p mean: -0.1198415532708168, mean p set: 0.44848471879959106
The modified gen p mean: 0.4517967104911804, gen p mean: -0.11196666955947876, mean p set: 0.4523736536502838
loss_pred:0.014276843518018723, decouple_loss:0.0002929622423835099
loss_pred:0.01439485140144825, decouple_loss:0.0004244211595505476
2023-05-02 16:42:04 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12292169779539108, mean p set: 0.4502691626548767
loss_pred:0.01684034802019596, decouple_loss:0.0003738400700967759
The modified gen p mean: 0.4495362937450409, gen p mean: -0.11687784641981125, mean p set: 0.4500633478164673
loss_pred:0.01622534915804863, decouple_loss:0.0004096479678992182
The modified gen p mean: 0.4498295485973358, gen p mean: -0.11612065881490707, mean p set: 0.45035696029663086
loss_pred:0.016478227451443672, decouple_loss:0.0003905661287717521
WV_1_PC_1_EH_0_PS_40, loss: 0.01653420925140381, avg_mse: 0.025828296318650246
current test mse: 0.025828
Iteration: 3411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089471340179443, gen p mean: -0.11042909324169159, mean p set: 0.45147234201431274
loss_pred:0.013699010014533997, decouple_loss:0.00027632899582386017
The modified gen p mean: 0.4481801688671112, gen p mean: -0.11752959340810776, mean p set: 0.4487546980381012
loss_pred:0.014429125934839249, decouple_loss:0.00035759020829573274
The modified gen p mean: 0.4511905014514923, gen p mean: -0.10411123186349869, mean p set: 0.4517684876918793
loss_pred:0.014722306281328201, decouple_loss:0.0005305164377205074
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
NaN value num: 0
Iteration: 3412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45232197642326355, gen p mean: -0.1021607518196106, mean p set: 0.452898770570755
loss_pred:0.015334894880652428, decouple_loss:0.00048427344881929457
The modified gen p mean: 0.45004594326019287, gen p mean: -0.10420794785022736, mean p set: 0.4506221413612366The modified gen p mean: 0.4507160484790802, gen p mean: -0.10419672727584839, mean p set: 0.45129165053367615
loss_pred:0.015356955118477345, decouple_loss:0.0004545412084553391
loss_pred:0.015186834149062634, decouple_loss:0.0003507093933876604
Iteration: 3413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450517475605011, gen p mean: -0.10207071155309677, mean p set: 0.4510968327522278
loss_pred:0.014917523600161076, decouple_loss:0.00034496610169298947
The modified gen p mean: 0.45143020153045654, gen p mean: -0.10279664397239685, mean p set: 0.45200711488723755
loss_pred:0.015309888869524002, decouple_loss:0.0004004623624496162
The modified gen p mean: 0.45013269782066345, gen p mean: -0.09633045643568039, mean p set: 0.4507089853286743
loss_pred:0.014830490574240685, decouple_loss:0.0002868162700906396
Iteration: 3414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45227453112602234, gen p mean: -0.10186117887496948, mean p set: 0.45285114645957947
loss_pred:0.014902821741998196, decouple_loss:0.000365838292054832
The modified gen p mean: 0.4513019621372223, gen p mean: -0.10038399696350098, mean p set: 0.45187854766845703
loss_pred:0.015486662276089191, decouple_loss:0.00035053951432928443
The modified gen p mean: 0.4515781104564667, gen p mean: -0.09829314798116684, mean p set: 0.4521554708480835
loss_pred:0.015216920524835587, decouple_loss:0.00036217880551703274
Iteration: 3415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514975845813751, gen p mean: -0.09720795601606369, mean p set: 0.452073335647583
loss_pred:0.015092657878994942, decouple_loss:0.0004195445217192173
The modified gen p mean: 0.4510781168937683, gen p mean: -0.10040683299303055, mean p set: 0.4516545534133911
loss_pred:0.015641512349247932, decouple_loss:0.0003671949671115726
The modified gen p mean: 0.45083126425743103, gen p mean: -0.09446681290864944, mean p set: 0.4514089822769165
loss_pred:0.015127010643482208, decouple_loss:0.0003581239143386483
Iteration: 3416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515836834907532, gen p mean: -0.09343412518501282, mean p set: 0.4521616995334625
loss_pred:0.015574579127132893, decouple_loss:0.00041459998465143144
The modified gen p mean: 0.45075273513793945, gen p mean: -0.09660878777503967, mean p set: 0.4513293206691742
loss_pred:0.014698892831802368, decouple_loss:0.0003403018636163324
The modified gen p mean: 0.4512576460838318, gen p mean: -0.0985378697514534, mean p set: 0.4518337547779083
loss_pred:0.015315999276936054, decouple_loss:0.0003209823335055262
Iteration: 3417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45098018646240234, gen p mean: -0.09537871927022934, mean p set: 0.4515573978424072
loss_pred:0.01470454316586256, decouple_loss:0.0003564425278455019
The modified gen p mean: 0.45094719529151917, gen p mean: -0.09436316043138504, mean p set: 0.45152246952056885
loss_pred:0.015934394672513008, decouple_loss:0.0003337447124067694
The modified gen p mean: 0.45092955231666565, gen p mean: -0.10085339099168777, mean p set: 0.45150890946388245
loss_pred:0.014366514980793, decouple_loss:0.0003659343929030001
Iteration: 3418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45184123516082764, gen p mean: -0.09716704487800598, mean p set: 0.4524179995059967
loss_pred:0.015578295104205608, decouple_loss:0.0004992571193724871
The modified gen p mean: 0.45006269216537476, gen p mean: -0.10563573241233826, mean p set: 0.45063820481300354
loss_pred:0.014928322285413742, decouple_loss:0.0004454361624084413
The modified gen p mean: 0.4511711597442627, gen p mean: -0.1033845841884613, mean p set: 0.4517492651939392
loss_pred:0.014168322086334229, decouple_loss:0.00040757362148724496
Iteration: 3419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529753029346466, gen p mean: -0.10366948693990707, mean p set: 0.4535543620586395
loss_pred:0.01472032442688942, decouple_loss:0.00040530264959670603
The modified gen p mean: 0.45047760009765625, gen p mean: -0.10317493975162506, mean p set: 0.4510560631752014
loss_pred:0.014568173326551914, decouple_loss:0.0004623256390914321
The modified gen p mean: 0.4509478509426117, gen p mean: -0.1059253066778183, mean p set: 0.4515230059623718
loss_pred:0.014565477147698402, decouple_loss:0.0003785260487347841
Iteration: 3420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496314525604248, gen p mean: -0.10934412479400635, mean p set: 0.4502072036266327
loss_pred:0.014825462363660336, decouple_loss:0.00037298465031199157
The modified gen p mean: 0.4506375789642334, gen p mean: -0.1070859283208847, mean p set: 0.45121413469314575
loss_pred:0.01498077530413866, decouple_loss:0.00039248698158189654
The modified gen p mean: 0.45010632276535034, gen p mean: -0.10884863883256912, mean p set: 0.450682133436203
loss_pred:0.015317555516958237, decouple_loss:0.0003565896477084607
2023-05-02 16:44:50 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12419215589761734, mean p set: 0.4502691626548767
loss_pred:0.016775475814938545, decouple_loss:0.00040830913349054754
The modified gen p mean: 0.44953402876853943, gen p mean: -0.11800175160169601, mean p set: 0.4500633478164673
loss_pred:0.016090571880340576, decouple_loss:0.0005064882570877671
The modified gen p mean: 0.44982877373695374, gen p mean: -0.1170554906129837, mean p set: 0.45035696029663086
loss_pred:0.01642158254981041, decouple_loss:0.0005091775092296302
WV_1_PC_1_EH_0_PS_40, loss: 0.01645294390618801, avg_mse: 0.025666944682598114
current test mse: 0.025667
Iteration: 3421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503602087497711, gen p mean: -0.1098746508359909, mean p set: 0.4509367048740387
loss_pred:0.014938698150217533, decouple_loss:0.0004975110059604049
The modified gen p mean: 0.450175404548645, gen p mean: -0.10994348675012589, mean p set: 0.45075303316116333The modified gen p mean: 0.4504334330558777, gen p mean: -0.11658326536417007, mean p set: 0.4510093629360199
loss_pred:0.01576053723692894, decouple_loss:0.0005289102555252612
loss_pred:0.014568144455552101, decouple_loss:0.0003917063295375556
Iteration: 3422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510363042354584, gen p mean: -0.1067262589931488, mean p set: 0.4516139328479767
loss_pred:0.015146540477871895, decouple_loss:0.0003738295054063201
The modified gen p mean: 0.4506956934928894, gen p mean: -0.10579477995634079, mean p set: 0.4512738585472107The modified gen p mean: 0.45232000946998596, gen p mean: -0.10599199682474136, mean p set: 0.4528968930244446
loss_pred:0.015636954456567764, decouple_loss:0.00045821000821888447
loss_pred:0.014642618596553802, decouple_loss:0.0004892237484455109
Iteration: 3423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45281535387039185, gen p mean: -0.11025702208280563, mean p set: 0.4533900320529938
loss_pred:0.015147959813475609, decouple_loss:0.00036592831020243466
The modified gen p mean: 0.4516240060329437, gen p mean: -0.10990219563245773, mean p set: 0.4522019624710083The modified gen p mean: 0.4514003098011017, gen p mean: -0.10685228556394577, mean p set: 0.451976478099823
loss_pred:0.015220263972878456, decouple_loss:0.00038223757292144
loss_pred:0.015579176135361195, decouple_loss:0.00037169436109252274
Iteration: 3424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45069462060928345, gen p mean: -0.11450434476137161, mean p set: 0.4512709379196167
loss_pred:0.01459977962076664, decouple_loss:0.0004352147807367146
The modified gen p mean: 0.4508916139602661, gen p mean: -0.11739667505025864, mean p set: 0.45146840810775757
loss_pred:0.015164995566010475, decouple_loss:0.0004045475216116756
The modified gen p mean: 0.45053407549858093, gen p mean: -0.11824008077383041, mean p set: 0.45111268758773804
loss_pred:0.013875570148229599, decouple_loss:0.0004495126486290246
Iteration: 3425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45137110352516174, gen p mean: -0.11474668979644775, mean p set: 0.4519473612308502
loss_pred:0.015322289429605007, decouple_loss:0.0006684419931843877
The modified gen p mean: 0.45098331570625305, gen p mean: -0.11188577860593796, mean p set: 0.4515584707260132
loss_pred:0.015727734193205833, decouple_loss:0.00043479978921823204
The modified gen p mean: 0.4514903724193573, gen p mean: -0.11703532189130783, mean p set: 0.45206722617149353
loss_pred:0.01519103441387415, decouple_loss:0.00038758100708946586
Iteration: 3426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45069971680641174, gen p mean: -0.11474856734275818, mean p set: 0.4512766897678375
loss_pred:0.015013578347861767, decouple_loss:0.0004469187406357378
The modified gen p mean: 0.4508957862854004, gen p mean: -0.1148538887500763, mean p set: 0.45147183537483215
loss_pred:0.01433072704821825, decouple_loss:0.00027031500940211117
The modified gen p mean: 0.4510152041912079, gen p mean: -0.11969095468521118, mean p set: 0.45159196853637695
loss_pred:0.0151897007599473, decouple_loss:0.0003139873151667416
Iteration: 3427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518113136291504, gen p mean: -0.11228574067354202, mean p set: 0.4523850381374359
loss_pred:0.015972847118973732, decouple_loss:0.0004588231386151165
The modified gen p mean: 0.4510071575641632, gen p mean: -0.11338148266077042, mean p set: 0.45158323645591736
The modified gen p mean: 0.450437992811203, gen p mean: -0.11674932390451431, mean p set: 0.4510124921798706
loss_pred:0.015678923577070236, decouple_loss:0.0004055408644489944
loss_pred:0.014705730602145195, decouple_loss:0.0003830704663414508
Iteration: 3428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451678991317749, gen p mean: -0.1121693104505539, mean p set: 0.45225754380226135
loss_pred:0.015889804810285568, decouple_loss:0.00044896863983012736
The modified gen p mean: 0.4516967236995697, gen p mean: -0.1157236099243164, mean p set: 0.4522736966609955
The modified gen p mean: 0.4508321285247803, gen p mean: -0.11617157608270645, mean p set: 0.4514085352420807
loss_pred:0.014724032022058964, decouple_loss:0.0003800245758611709
loss_pred:0.014284315519034863, decouple_loss:0.00045372804743237793
Iteration: 3429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114150643348694, gen p mean: -0.11428256332874298, mean p set: 0.4517157971858978
loss_pred:0.015215837396681309, decouple_loss:0.00045572235831059515
The modified gen p mean: 0.4504193961620331, gen p mean: -0.11182695627212524, mean p set: 0.45099735260009766
loss_pred:0.014251201413571835, decouple_loss:0.00034708870225585997
The modified gen p mean: 0.4520476460456848, gen p mean: -0.11442384123802185, mean p set: 0.4526248872280121
loss_pred:0.015007060021162033, decouple_loss:0.000408912543207407
Iteration: 3430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958680868148804, gen p mean: -0.1134452074766159, mean p set: 0.45016512274742126
loss_pred:0.015421277843415737, decouple_loss:0.00047287429333664477
The modified gen p mean: 0.45178085565567017, gen p mean: -0.11532936245203018, mean p set: 0.4523589313030243
loss_pred:0.014494527131319046, decouple_loss:0.00034336376120336354
The modified gen p mean: 0.4500034749507904, gen p mean: -0.10803625732660294, mean p set: 0.45058155059814453
loss_pred:0.015024363063275814, decouple_loss:0.0007126027485355735
2023-05-02 16:46:57 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1269044727087021, mean p set: 0.4502691626548767
loss_pred:0.016803253442049026, decouple_loss:0.0003819101257249713
The modified gen p mean: 0.44953635334968567, gen p mean: -0.12079832702875137, mean p set: 0.4500633478164673
loss_pred:0.01609201915562153, decouple_loss:0.000377446151105687
The modified gen p mean: 0.44982796907424927, gen p mean: -0.12027332931756973, mean p set: 0.45035696029663086
loss_pred:0.016408341005444527, decouple_loss:0.00040589069249108434
WV_1_PC_1_EH_0_PS_40, loss: 0.016453959047794342, avg_mse: 0.025639580562710762
current test mse: 0.02564
Iteration: 3431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45009374618530273, gen p mean: -0.11679492890834808, mean p set: 0.45066869258880615
loss_pred:0.015397271141409874, decouple_loss:0.00037536618765443563
The modified gen p mean: 0.45030537247657776, gen p mean: -0.12029357254505157, mean p set: 0.450882226228714The modified gen p mean: 0.4498262405395508, gen p mean: -0.11006330698728561, mean p set: 0.45040586590766907
loss_pred:0.014292699284851551, decouple_loss:0.0003439825086388737
loss_pred:0.01511376816779375, decouple_loss:0.0006559677422046661
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 3432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44871097803115845, gen p mean: -0.12729448080062866, mean p set: 0.44928810000419617
loss_pred:0.014924673363566399, decouple_loss:0.0004969194997102022
The modified gen p mean: 0.44757863879203796, gen p mean: -0.1263808012008667, mean p set: 0.44815605878829956The modified gen p mean: 0.4485163986682892, gen p mean: -0.13120727241039276, mean p set: 0.449090838432312
loss_pred:0.014486880041658878, decouple_loss:0.0003994940489064902
loss_pred:0.014719017781317234, decouple_loss:0.0004340004816185683
Iteration: 3433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469982981681824, gen p mean: -0.12353943288326263, mean p set: 0.44757208228111267
loss_pred:0.014401254244148731, decouple_loss:0.00045160643639974296
The modified gen p mean: 0.4471389949321747, gen p mean: -0.12274851649999619, mean p set: 0.4477138817310333
loss_pred:0.014713113196194172, decouple_loss:0.0004398291639517993
The modified gen p mean: 0.447462797164917, gen p mean: -0.12329057604074478, mean p set: 0.44803762435913086
loss_pred:0.014851436018943787, decouple_loss:0.0006178743205964565
Iteration: 3434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472102224826813, gen p mean: -0.12199899554252625, mean p set: 0.44778627157211304
loss_pred:0.014808918349444866, decouple_loss:0.000440573989180848
The modified gen p mean: 0.4487002193927765, gen p mean: -0.1267283856868744, mean p set: 0.44927650690078735
loss_pred:0.014147576875984669, decouple_loss:0.0003592862340155989
The modified gen p mean: 0.4483356475830078, gen p mean: -0.12491966784000397, mean p set: 0.4489142596721649
loss_pred:0.014571520499885082, decouple_loss:0.0004636103112716228
Iteration: 3435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462956488132477, gen p mean: -0.12177900224924088, mean p set: 0.44687098264694214
loss_pred:0.014116501435637474, decouple_loss:0.000396866409573704
The modified gen p mean: 0.4461336135864258, gen p mean: -0.12295997142791748, mean p set: 0.4467092752456665
loss_pred:0.015360482968389988, decouple_loss:0.0005167650524526834
The modified gen p mean: 0.4480193257331848, gen p mean: -0.11864206194877625, mean p set: 0.44859448075294495
loss_pred:0.015124190598726273, decouple_loss:0.000432136032031849
Iteration: 3436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480798542499542, gen p mean: -0.11909160763025284, mean p set: 0.4486530125141144
loss_pred:0.015212547965347767, decouple_loss:0.0004614242643583566
The modified gen p mean: 0.44666314125061035, gen p mean: -0.11774252355098724, mean p set: 0.4472406804561615
loss_pred:0.014662539586424828, decouple_loss:0.0003829386259894818
The modified gen p mean: 0.44805851578712463, gen p mean: -0.11895477771759033, mean p set: 0.4486321210861206
loss_pred:0.014549863524734974, decouple_loss:0.0005439858650788665
Iteration: 3437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44805780053138733, gen p mean: -0.12451926618814468, mean p set: 0.4486336410045624
loss_pred:0.01461084932088852, decouple_loss:0.00039465149166062474
The modified gen p mean: 0.44653764367103577, gen p mean: -0.11856748163700104, mean p set: 0.4471120834350586
loss_pred:0.014653250575065613, decouple_loss:0.0004029693955089897
The modified gen p mean: 0.4487222731113434, gen p mean: -0.12237545102834702, mean p set: 0.44929662346839905
loss_pred:0.01424237247556448, decouple_loss:0.00034414936089888215
Iteration: 3438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710665941238403, gen p mean: -0.12222761660814285, mean p set: 0.44768208265304565
loss_pred:0.0140066584572196, decouple_loss:0.0003586870152503252
The modified gen p mean: 0.4478604197502136, gen p mean: -0.12521296739578247, mean p set: 0.44843539595603943
loss_pred:0.014050408266484737, decouple_loss:0.0003473169344943017
The modified gen p mean: 0.4478120505809784, gen p mean: -0.12425320595502853, mean p set: 0.4483872950077057
loss_pred:0.014268622733652592, decouple_loss:0.00037831455119885504
Iteration: 3439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44593891501426697, gen p mean: -0.12812794744968414, mean p set: 0.44651445746421814
loss_pred:0.013845428824424744, decouple_loss:0.0004422441415954381
The modified gen p mean: 0.4468974769115448, gen p mean: -0.12388055771589279, mean p set: 0.44747447967529297
loss_pred:0.014500697143375874, decouple_loss:0.0005952561041340232
The modified gen p mean: 0.4464365839958191, gen p mean: -0.12355201691389084, mean p set: 0.44701406359672546
loss_pred:0.015083225443959236, decouple_loss:0.0006888779462315142
Iteration: 3440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489147663116455, gen p mean: -0.1275574415922165, mean p set: 0.44949212670326233
loss_pred:0.01404710952192545, decouple_loss:0.0005489498726092279
The modified gen p mean: 0.4471970796585083, gen p mean: -0.12126485258340836, mean p set: 0.4477720260620117
loss_pred:0.014385507442057133, decouple_loss:0.0005548035260289907
The modified gen p mean: 0.44629794359207153, gen p mean: -0.1261541098356247, mean p set: 0.44687342643737793
loss_pred:0.015331797301769257, decouple_loss:0.0005340637289918959
2023-05-02 16:49:41 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12640218436717987, mean p set: 0.4502691626548767
loss_pred:0.01678135059773922, decouple_loss:0.0003879047289956361
The modified gen p mean: 0.44953539967536926, gen p mean: -0.12017796188592911, mean p set: 0.4500633478164673
loss_pred:0.016115827485919, decouple_loss:0.0004293071979191154
The modified gen p mean: 0.44983163475990295, gen p mean: -0.11970719695091248, mean p set: 0.45035696029663086
loss_pred:0.01645730808377266, decouple_loss:0.00039940333226695657
WV_1_PC_1_EH_0_PS_40, loss: 0.016471773386001587, avg_mse: 0.025725720450282097
current test mse: 0.025726
Iteration: 3441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697311520576477, gen p mean: -0.1252964287996292, mean p set: 0.44754740595817566
loss_pred:0.015003479085862637, decouple_loss:0.00035137959639541805
The modified gen p mean: 0.4476127028465271, gen p mean: -0.12810160219669342, mean p set: 0.44818755984306335
loss_pred:0.014600655995309353, decouple_loss:0.0003718762891367078
The modified gen p mean: 0.4467765986919403, gen p mean: -0.12497996538877487, mean p set: 0.4473552703857422
loss_pred:0.014547867700457573, decouple_loss:0.0003346067387610674
Iteration: 3442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460594058036804, gen p mean: -0.12283322960138321, mean p set: 0.4466347098350525
The modified gen p mean: 0.4479392468929291, gen p mean: -0.12206362187862396, mean p set: 0.4485151767730713
loss_pred:0.01402707677334547, decouple_loss:0.0005044049466960132
loss_pred:0.01409606821835041, decouple_loss:0.00046753406058996916
The modified gen p mean: 0.4481547772884369, gen p mean: -0.12580668926239014, mean p set: 0.44873204827308655
loss_pred:0.013924396596848965, decouple_loss:0.0005528526962734759
Iteration: 3443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656628370285034, gen p mean: -0.12123080343008041, mean p set: 0.44714486598968506
loss_pred:0.014610926620662212, decouple_loss:0.0003999185864813626
The modified gen p mean: 0.4479486048221588, gen p mean: -0.12367144972085953, mean p set: 0.4485243558883667
loss_pred:0.013914985582232475, decouple_loss:0.00041665841126814485
The modified gen p mean: 0.4471471309661865, gen p mean: -0.12079961597919464, mean p set: 0.44772249460220337
loss_pred:0.014791958034038544, decouple_loss:0.00041066520498134196
Iteration: 3444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459178149700165, gen p mean: -0.11547444015741348, mean p set: 0.44649171829223633
loss_pred:0.014745648019015789, decouple_loss:0.0004281790170352906
The modified gen p mean: 0.4456465542316437, gen p mean: -0.1237344890832901, mean p set: 0.4462227523326874
loss_pred:0.013891561888158321, decouple_loss:0.0003816715907305479
The modified gen p mean: 0.4458761215209961, gen p mean: -0.12190694361925125, mean p set: 0.4464513063430786
loss_pred:0.014962056651711464, decouple_loss:0.0004138716612942517
Iteration: 3445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463474452495575, gen p mean: -0.11949790269136429, mean p set: 0.4469250440597534
loss_pred:0.015405766665935516, decouple_loss:0.0005702847265638411
The modified gen p mean: 0.4485640227794647, gen p mean: -0.12513089179992676, mean p set: 0.44913914799690247
loss_pred:0.01463631633669138, decouple_loss:0.00040307018207386136
The modified gen p mean: 0.4482581615447998, gen p mean: -0.11772928386926651, mean p set: 0.4488321542739868
loss_pred:0.014143245294690132, decouple_loss:0.00036255046143196523
Iteration: 3446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765791296958923, gen p mean: -0.12682069838047028, mean p set: 0.44823282957077026
loss_pred:0.014748230576515198, decouple_loss:0.00037226086715236306
The modified gen p mean: 0.4469887316226959, gen p mean: -0.1214783638715744, mean p set: 0.4475656747817993
The modified gen p mean: 0.44638606905937195, gen p mean: -0.12180553376674652, mean p set: 0.44696107506752014
loss_pred:0.014422817155718803, decouple_loss:0.00039292426663450897
loss_pred:0.014583527110517025, decouple_loss:0.000351190275978297
Iteration: 3447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466001093387604, gen p mean: -0.12687242031097412, mean p set: 0.44717034697532654
loss_pred:0.01513737440109253, decouple_loss:0.00036485769669525325
The modified gen p mean: 0.4471968710422516, gen p mean: -0.12343189120292664, mean p set: 0.44777190685272217
loss_pred:0.013874705880880356, decouple_loss:0.00038696458796039224
The modified gen p mean: 0.4473412334918976, gen p mean: -0.12277091294527054, mean p set: 0.4479168951511383
loss_pred:0.013851270079612732, decouple_loss:0.0003624996170401573
Iteration: 3448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454812705516815, gen p mean: -0.13167937099933624, mean p set: 0.4460570514202118
loss_pred:0.013891711831092834, decouple_loss:0.0004372359544504434
The modified gen p mean: 0.446496844291687, gen p mean: -0.1279011070728302, mean p set: 0.4470709264278412
The modified gen p mean: 0.44712701439857483, gen p mean: -0.12436718493700027, mean p set: 0.4477066397666931
loss_pred:0.015287728980183601, decouple_loss:0.00046379395644180477
loss_pred:0.014448840171098709, decouple_loss:0.00042223153286613524
Iteration: 3449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451412558555603, gen p mean: -0.13168276846408844, mean p set: 0.44571492075920105
loss_pred:0.014081181026995182, decouple_loss:0.0004205331497360021
The modified gen p mean: 0.44816842675209045, gen p mean: -0.12681463360786438, mean p set: 0.4487445652484894
loss_pred:0.014363836497068405, decouple_loss:0.00045620810124091804
The modified gen p mean: 0.44740405678749084, gen p mean: -0.12653295695781708, mean p set: 0.4479806125164032
loss_pred:0.014105756767094135, decouple_loss:0.00034909576061181724
Iteration: 3450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477729797363281, gen p mean: -0.1257602721452713, mean p set: 0.4483468234539032
loss_pred:0.01392813865095377, decouple_loss:0.00037886318750679493
The modified gen p mean: 0.44685015082359314, gen p mean: -0.12812373042106628, mean p set: 0.44742488861083984
loss_pred:0.015070642344653606, decouple_loss:0.0004920462379232049
The modified gen p mean: 0.4465257525444031, gen p mean: -0.1268356889486313, mean p set: 0.44710099697113037
loss_pred:0.014254254288971424, decouple_loss:0.00042153254617005587
2023-05-02 16:51:47 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12528537213802338, mean p set: 0.4502691626548767
loss_pred:0.016815004870295525, decouple_loss:0.0004174127534497529
The modified gen p mean: 0.4495377242565155, gen p mean: -0.11874599009752274, mean p set: 0.4500633478164673
The modified gen p mean: 0.44982731342315674, gen p mean: -0.11841414123773575, mean p set: 0.45035696029663086
loss_pred:0.01614096760749817, decouple_loss:0.0004939790815114975
loss_pred:0.01642696186900139, decouple_loss:0.0005069129401817918
WV_1_PC_1_EH_0_PS_40, loss: 0.016484616324305534, avg_mse: 0.02579846791923046
current test mse: 0.025798
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790002703666687, gen p mean: -0.12523166835308075, mean p set: 0.44847849011421204
loss_pred:0.014072729274630547, decouple_loss:0.00036660616751760244
The modified gen p mean: 0.4475691318511963, gen p mean: -0.12445859611034393, mean p set: 0.4481431543827057The modified gen p mean: 0.4477296471595764, gen p mean: -0.11919383704662323, mean p set: 0.4483067989349365
loss_pred:0.01415490172803402, decouple_loss:0.0004420207114890218
loss_pred:0.014918800443410873, decouple_loss:0.0005177684361115098
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
NaN value num: 0
Iteration: 3452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533533453941345, gen p mean: -0.11472560465335846, mean p set: 0.45393162965774536
loss_pred:0.015094338916242123, decouple_loss:0.0011542094871401787
The modified gen p mean: 0.4509265124797821, gen p mean: -0.11124203354120255, mean p set: 0.45150119066238403The modified gen p mean: 0.45059457421302795, gen p mean: -0.1114320307970047, mean p set: 0.4511723518371582
loss_pred:0.01529353205114603, decouple_loss:0.0008874324266798794
loss_pred:0.014946761541068554, decouple_loss:0.0008532491629011929
Iteration: 3453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532877504825592, gen p mean: -0.11150304973125458, mean p set: 0.45386558771133423
loss_pred:0.014249776490032673, decouple_loss:0.0006995353614911437
The modified gen p mean: 0.4517119228839874, gen p mean: -0.11294158548116684, mean p set: 0.45228806138038635
loss_pred:0.014704792760312557, decouple_loss:0.0007910735439509153
The modified gen p mean: 0.45053669810295105, gen p mean: -0.11179624497890472, mean p set: 0.451114296913147
loss_pred:0.014835139736533165, decouple_loss:0.0004661263374146074
Iteration: 3454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45145735144615173, gen p mean: -0.108843132853508, mean p set: 0.45203232765197754
loss_pred:0.015228716656565666, decouple_loss:0.0004284854221623391
The modified gen p mean: 0.45171067118644714, gen p mean: -0.11095228046178818, mean p set: 0.45228642225265503
loss_pred:0.014941856265068054, decouple_loss:0.000458584661828354
The modified gen p mean: 0.4519401788711548, gen p mean: -0.10959562659263611, mean p set: 0.4525179862976074
loss_pred:0.01410441379994154, decouple_loss:0.00036451080814003944
Iteration: 3455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534536898136139, gen p mean: -0.107339046895504, mean p set: 0.45403215289115906
loss_pred:0.01440210547298193, decouple_loss:0.0006509108352474868
The modified gen p mean: 0.4518357217311859, gen p mean: -0.10819412767887115, mean p set: 0.45241400599479675
loss_pred:0.01467529870569706, decouple_loss:0.0006164103979244828
The modified gen p mean: 0.4525809586048126, gen p mean: -0.1169753223657608, mean p set: 0.4531596302986145
loss_pred:0.0146601228043437, decouple_loss:0.0008145234314724803
Iteration: 3456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45163869857788086, gen p mean: -0.11563011258840561, mean p set: 0.45221495628356934
loss_pred:0.014958612620830536, decouple_loss:0.0006937023135833442
The modified gen p mean: 0.4511781334877014, gen p mean: -0.11662408709526062, mean p set: 0.4517561197280884
loss_pred:0.01486528106033802, decouple_loss:0.000858012936078012
The modified gen p mean: 0.45304185152053833, gen p mean: -0.11359284073114395, mean p set: 0.45362168550491333
loss_pred:0.014261072501540184, decouple_loss:0.000712888955604285
Iteration: 3457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45210880041122437, gen p mean: -0.11379449814558029, mean p set: 0.4526858329772949
loss_pred:0.014680239371955395, decouple_loss:0.000711640517693013
The modified gen p mean: 0.452486127614975, gen p mean: -0.11005587130784988, mean p set: 0.45306316018104553
loss_pred:0.014660051092505455, decouple_loss:0.0007626447477377951
The modified gen p mean: 0.4519847631454468, gen p mean: -0.1126253753900528, mean p set: 0.45256444811820984
loss_pred:0.014378258027136326, decouple_loss:0.0006949289236217737
Iteration: 3458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508785009384155, gen p mean: -0.11224570125341415, mean p set: 0.45145025849342346
loss_pred:0.01537509635090828, decouple_loss:0.00043743214337155223
The modified gen p mean: 0.4512421190738678, gen p mean: -0.11689156293869019, mean p set: 0.45181983709335327
loss_pred:0.016083890572190285, decouple_loss:0.0003646253899205476
The modified gen p mean: 0.4513019025325775, gen p mean: -0.11806025356054306, mean p set: 0.4518786072731018
loss_pred:0.015017587691545486, decouple_loss:0.0004877318860962987
Iteration: 3459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45231959223747253, gen p mean: -0.11734066158533096, mean p set: 0.45289722084999084
loss_pred:0.014183240942656994, decouple_loss:0.00048772807349450886
The modified gen p mean: 0.4517774283885956, gen p mean: -0.11412700265645981, mean p set: 0.452355295419693
loss_pred:0.014521746896207333, decouple_loss:0.0005558469565585256
The modified gen p mean: 0.4513765871524811, gen p mean: -0.11953946948051453, mean p set: 0.45195239782333374
loss_pred:0.015634853392839432, decouple_loss:0.00043812437797896564
Iteration: 3460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451394647359848, gen p mean: -0.1240665391087532, mean p set: 0.4519711136817932
loss_pred:0.01532580517232418, decouple_loss:0.000692934961989522
The modified gen p mean: 0.45115014910697937, gen p mean: -0.11658840626478195, mean p set: 0.45172953605651855
The modified gen p mean: 0.45226892828941345, gen p mean: -0.1182146742939949, mean p set: 0.4528461992740631
loss_pred:0.014449558220803738, decouple_loss:0.0005884274141862988
loss_pred:0.0143177080899477, decouple_loss:0.0004921812796965241
2023-05-02 16:54:30 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13751403987407684, mean p set: 0.4502691626548767
loss_pred:0.01693587563931942, decouple_loss:0.0005621478194370866
The modified gen p mean: 0.449535995721817, gen p mean: -0.13143396377563477, mean p set: 0.4500633478164673
loss_pred:0.016186902299523354, decouple_loss:0.00042587771895341575
The modified gen p mean: 0.4498300850391388, gen p mean: -0.13073065876960754, mean p set: 0.45035696029663086
loss_pred:0.01644214056432247, decouple_loss:0.0003885067126248032
WV_1_PC_1_EH_0_PS_40, loss: 0.016544580459594727, avg_mse: 0.025907615199685097
current test mse: 0.025908
Iteration: 3461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517687261104584, gen p mean: -0.12838758528232574, mean p set: 0.4523479640483856
loss_pred:0.014424815773963928, decouple_loss:0.0006473165703937411
The modified gen p mean: 0.45141828060150146, gen p mean: -0.12345491349697113, mean p set: 0.4519937038421631
loss_pred:0.014471475034952164, decouple_loss:0.000547719479072839
The modified gen p mean: 0.4506438970565796, gen p mean: -0.123358815908432, mean p set: 0.4512217342853546
loss_pred:0.01427541021257639, decouple_loss:0.00046340294647961855
Iteration: 3462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526062309741974, gen p mean: -0.13227435946464539, mean p set: 0.4531821608543396
loss_pred:0.014567960053682327, decouple_loss:0.00043839492718689144
The modified gen p mean: 0.4514082670211792, gen p mean: -0.12716399133205414, mean p set: 0.45198309421539307The modified gen p mean: 0.45314544439315796, gen p mean: -0.1307275891304016, mean p set: 0.4537212550640106
loss_pred:0.015096639283001423, decouple_loss:0.0005646272329613566loss_pred:0.014574960805475712, decouple_loss:0.0005771643482148647
Iteration: 3463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526137411594391, gen p mean: -0.12442842870950699, mean p set: 0.4531908929347992
loss_pred:0.014124559238553047, decouple_loss:0.0004626527370419353
The modified gen p mean: 0.45252013206481934, gen p mean: -0.12714967131614685, mean p set: 0.4530986547470093
loss_pred:0.014341897331178188, decouple_loss:0.0004659466212615371
The modified gen p mean: 0.4523276388645172, gen p mean: -0.1245139092206955, mean p set: 0.4529043138027191
loss_pred:0.0145449573174119, decouple_loss:0.0006678763893432915
Iteration: 3464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452316552400589, gen p mean: -0.1174633800983429, mean p set: 0.4528920352458954
loss_pred:0.014932628720998764, decouple_loss:0.0004226686432957649
The modified gen p mean: 0.45164012908935547, gen p mean: -0.11936051398515701, mean p set: 0.4522169232368469
loss_pred:0.014671719633042812, decouple_loss:0.00047140353126451373
The modified gen p mean: 0.453165203332901, gen p mean: -0.12042051553726196, mean p set: 0.453741192817688
loss_pred:0.014564471319317818, decouple_loss:0.00047519386862404644
Iteration: 3465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45199716091156006, gen p mean: -0.11278153955936432, mean p set: 0.452574759721756
loss_pred:0.014900731854140759, decouple_loss:0.00044123828411102295
The modified gen p mean: 0.4508218467235565, gen p mean: -0.11882061511278152, mean p set: 0.4513972997665405
loss_pred:0.015104791149497032, decouple_loss:0.0004755740228574723
The modified gen p mean: 0.45319995284080505, gen p mean: -0.12076757848262787, mean p set: 0.453777015209198
loss_pred:0.014221648685634136, decouple_loss:0.0004473846929613501
Iteration: 3466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505661129951477, gen p mean: -0.11021632701158524, mean p set: 0.45114362239837646
loss_pred:0.014145576395094395, decouple_loss:0.0004158273513894528
The modified gen p mean: 0.45182183384895325, gen p mean: -0.11239773780107498, mean p set: 0.4523969888687134
The modified gen p mean: 0.4530050754547119, gen p mean: -0.10841558873653412, mean p set: 0.45358291268348694
loss_pred:0.014658144675195217, decouple_loss:0.00042285973904654384
loss_pred:0.013886368833482265, decouple_loss:0.0005045362049713731
Iteration: 3467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520517587661743, gen p mean: -0.10847079008817673, mean p set: 0.4526279866695404
loss_pred:0.014953791163861752, decouple_loss:0.00041800830513238907
The modified gen p mean: 0.4532824158668518, gen p mean: -0.10896499454975128, mean p set: 0.4538623094558716
The modified gen p mean: 0.45229750871658325, gen p mean: -0.11139845103025436, mean p set: 0.45287367701530457
loss_pred:0.014793483540415764, decouple_loss:0.0004960944061167538
loss_pred:0.014506860636174679, decouple_loss:0.00040271878242492676
Iteration: 3468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525546729564667, gen p mean: -0.1096910685300827, mean p set: 0.4531313478946686
loss_pred:0.014723731204867363, decouple_loss:0.0004036456812173128
The modified gen p mean: 0.45077282190322876, gen p mean: -0.11204733699560165, mean p set: 0.4513482451438904
loss_pred:0.014881478622555733, decouple_loss:0.00040107598761096597
The modified gen p mean: 0.4511098265647888, gen p mean: -0.11539076268672943, mean p set: 0.4516848623752594
loss_pred:0.014647363685071468, decouple_loss:0.00046671502059325576
Iteration: 3469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451831191778183, gen p mean: -0.11191276460886002, mean p set: 0.45240697264671326
loss_pred:0.014154987409710884, decouple_loss:0.00042366821435280144
The modified gen p mean: 0.4502628445625305, gen p mean: -0.11006960272789001, mean p set: 0.4508371949195862
The modified gen p mean: 0.45206862688064575, gen p mean: -0.11314917355775833, mean p set: 0.4526461064815521
loss_pred:0.014760738238692284, decouple_loss:0.00034509002580307424
loss_pred:0.014496343210339546, decouple_loss:0.00048378368956036866
Iteration: 3470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534451961517334, gen p mean: -0.10808131843805313, mean p set: 0.4540221691131592
loss_pred:0.014047915115952492, decouple_loss:0.0003992563870269805
The modified gen p mean: 0.45114198327064514, gen p mean: -0.11006871610879898, mean p set: 0.45171958208084106
The modified gen p mean: 0.45207053422927856, gen p mean: -0.11251186579465866, mean p set: 0.4526466727256775
loss_pred:0.014459237456321716, decouple_loss:0.0003865963371936232
loss_pred:0.014972200617194176, decouple_loss:0.0003221365041099489
2023-05-02 16:56:35 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12533622980117798, mean p set: 0.4502691626548767
loss_pred:0.016948554664850235, decouple_loss:0.0005482295528054237
The modified gen p mean: 0.44953441619873047, gen p mean: -0.11949602514505386, mean p set: 0.4500633478164673
loss_pred:0.016252104192972183, decouple_loss:0.0004342683241702616
The modified gen p mean: 0.44982948899269104, gen p mean: -0.11853929609060287, mean p set: 0.45035696029663086
loss_pred:0.016406511887907982, decouple_loss:0.00038081573438830674
WV_1_PC_1_EH_0_PS_40, loss: 0.016558445990085602, avg_mse: 0.02585604228079319
current test mse: 0.025856
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
NaN value num: 0
Iteration: 3471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505123794078827, gen p mean: -0.11098578572273254, mean p set: 0.45108845829963684
loss_pred:0.015444859862327576, decouple_loss:0.00052025041077286
The modified gen p mean: 0.4514576494693756, gen p mean: -0.11055480688810349, mean p set: 0.4520331025123596
loss_pred:0.015797743573784828, decouple_loss:0.000324133230606094
The modified gen p mean: 0.4508316218852997, gen p mean: -0.11390277743339539, mean p set: 0.4514080286026001
loss_pred:0.015952225774526596, decouple_loss:0.0004451701825018972
Iteration: 3472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019373297691345, gen p mean: -0.12193116545677185, mean p set: 0.4507710039615631
loss_pred:0.01563912071287632, decouple_loss:0.0004420230688992888
The modified gen p mean: 0.4507063925266266, gen p mean: -0.1113249883055687, mean p set: 0.4512825310230255
The modified gen p mean: 0.4508168399333954, gen p mean: -0.11049512028694153, mean p set: 0.4513946771621704
loss_pred:0.01502079889178276, decouple_loss:0.0004069008573424071
loss_pred:0.015476011671125889, decouple_loss:0.00034561764914542437
Iteration: 3473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45280930399894714, gen p mean: -0.12033002823591232, mean p set: 0.45338475704193115
loss_pred:0.015335815958678722, decouple_loss:0.00039869078318588436
The modified gen p mean: 0.4515368342399597, gen p mean: -0.12072357535362244, mean p set: 0.45211273431777954
loss_pred:0.015755660831928253, decouple_loss:0.0003744253481272608
The modified gen p mean: 0.45108523964881897, gen p mean: -0.12269402295351028, mean p set: 0.45166081190109253
loss_pred:0.015352166257798672, decouple_loss:0.00034932809649035335
Iteration: 3474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45279836654663086, gen p mean: -0.1382177174091339, mean p set: 0.45337486267089844
loss_pred:0.015304538421332836, decouple_loss:0.00041446639806963503
The modified gen p mean: 0.45121803879737854, gen p mean: -0.1404796689748764, mean p set: 0.4517945945262909
loss_pred:0.01452383678406477, decouple_loss:0.00036448746686801314
The modified gen p mean: 0.4508739113807678, gen p mean: -0.13241246342658997, mean p set: 0.45145145058631897
loss_pred:0.0156874917447567, decouple_loss:0.0006360776023939252
Iteration: 3475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45053455233573914, gen p mean: -0.15377014875411987, mean p set: 0.4511098861694336
loss_pred:0.018895698711276054, decouple_loss:0.0005578078562393785
The modified gen p mean: 0.4513902962207794, gen p mean: -0.15233658254146576, mean p set: 0.45197105407714844
loss_pred:0.018390623852610588, decouple_loss:0.00041212726500816643
The modified gen p mean: 0.4511069059371948, gen p mean: -0.1575256884098053, mean p set: 0.4516860842704773
loss_pred:0.01849197782576084, decouple_loss:0.0004638253303710371
Iteration: 3476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45220524072647095, gen p mean: -0.13059403002262115, mean p set: 0.45278200507164
loss_pred:0.018684612587094307, decouple_loss:0.0004639579856302589
The modified gen p mean: 0.45234569907188416, gen p mean: -0.13084708154201508, mean p set: 0.4529227614402771
The modified gen p mean: 0.4509793221950531, gen p mean: -0.12963734567165375, mean p set: 0.4515528082847595
loss_pred:0.018836477771401405, decouple_loss:0.0004788688966073096
loss_pred:0.019667981192469597, decouple_loss:0.0004532185266725719
Iteration: 3477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512339234352112, gen p mean: -0.13224777579307556, mean p set: 0.45181164145469666
loss_pred:0.0193000640720129, decouple_loss:0.0006788369501009583
The modified gen p mean: 0.451169490814209, gen p mean: -0.1268099993467331, mean p set: 0.45174819231033325
loss_pred:0.018828468397259712, decouple_loss:0.0005755029851570725
The modified gen p mean: 0.45212191343307495, gen p mean: -0.13141262531280518, mean p set: 0.45269879698753357
loss_pred:0.01763913966715336, decouple_loss:0.00047069002175703645
Iteration: 3478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504735767841339, gen p mean: -0.13729389011859894, mean p set: 0.45105281472206116
loss_pred:0.016512999311089516, decouple_loss:0.0005720398621633649
The modified gen p mean: 0.45095905661582947, gen p mean: -0.1429050713777542, mean p set: 0.4515374004840851
loss_pred:0.018577875569462776, decouple_loss:0.000530802586581558
The modified gen p mean: 0.4511030912399292, gen p mean: -0.13657347857952118, mean p set: 0.4516793489456177
loss_pred:0.01853358931839466, decouple_loss:0.0005426653660833836
Iteration: 3479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45171797275543213, gen p mean: -0.1465681791305542, mean p set: 0.4522937834262848
loss_pred:0.017246773466467857, decouple_loss:0.0003847361949738115
The modified gen p mean: 0.45182350277900696, gen p mean: -0.14819687604904175, mean p set: 0.45239734649658203
loss_pred:0.017809132114052773, decouple_loss:0.00043048421503044665
The modified gen p mean: 0.4508388340473175, gen p mean: -0.14424985647201538, mean p set: 0.45141565799713135
loss_pred:0.018187005072832108, decouple_loss:0.0006948068621568382
Iteration: 3480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45124325156211853, gen p mean: -0.14184904098510742, mean p set: 0.45181748270988464
loss_pred:0.01793663576245308, decouple_loss:0.0006148176034912467
The modified gen p mean: 0.45092758536338806, gen p mean: -0.14691989123821259, mean p set: 0.4515029489994049
The modified gen p mean: 0.4513016939163208, gen p mean: -0.14444543421268463, mean p set: 0.45187801122665405
loss_pred:0.016567520797252655, decouple_loss:0.0005594671820290387
loss_pred:0.018050551414489746, decouple_loss:0.0007313112146221101
2023-05-02 16:59:27 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.170065239071846, mean p set: 0.4502691626548767
loss_pred:0.018492892384529114, decouple_loss:0.0005543630686588585
The modified gen p mean: 0.4495372474193573, gen p mean: -0.16262321174144745, mean p set: 0.4500633478164673
loss_pred:0.017837954685091972, decouple_loss:0.0005417767097242177
The modified gen p mean: 0.4498283565044403, gen p mean: -0.16161403059959412, mean p set: 0.45035696029663086
loss_pred:0.01822349615395069, decouple_loss:0.00046694674529135227
WV_1_PC_1_EH_0_PS_40, loss: 0.01821083202958107, avg_mse: 0.027979161590337753
current test mse: 0.027979
Iteration: 3481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510688781738281, gen p mean: -0.15557797253131866, mean p set: 0.45164790749549866
loss_pred:0.017244691029191017, decouple_loss:0.0006337439408525825
The modified gen p mean: 0.45164820551872253, gen p mean: -0.16138680279254913, mean p set: 0.45222604274749756The modified gen p mean: 0.4509085416793823, gen p mean: -0.15204665064811707, mean p set: 0.45148617029190063
loss_pred:0.01782728172838688, decouple_loss:0.0005455355276353657loss_pred:0.016981273889541626, decouple_loss:0.0005687900120392442
Iteration: 3482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45063936710357666, gen p mean: -0.15430136024951935, mean p set: 0.4512137174606323
The modified gen p mean: 0.45026782155036926, gen p mean: -0.16303516924381256, mean p set: 0.4508439898490906loss_pred:0.015715474262833595, decouple_loss:0.0005592246307060122
loss_pred:0.016114145517349243, decouple_loss:0.0005787629634141922
The modified gen p mean: 0.4513404369354248, gen p mean: -0.1614609658718109, mean p set: 0.4519181549549103
loss_pred:0.015839409083127975, decouple_loss:0.0006976260337978601
Iteration: 3483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503045380115509, gen p mean: -0.14107349514961243, mean p set: 0.45088016986846924
loss_pred:0.016738783568143845, decouple_loss:0.0006306438590399921
The modified gen p mean: 0.44931361079216003, gen p mean: -0.14991270005702972, mean p set: 0.4498913586139679
loss_pred:0.01606229692697525, decouple_loss:0.000535594008397311
The modified gen p mean: 0.4523022174835205, gen p mean: -0.14795273542404175, mean p set: 0.4528789222240448
loss_pred:0.016513392329216003, decouple_loss:0.0005284309736452997
Iteration: 3484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45051008462905884, gen p mean: -0.13522692024707794, mean p set: 0.45108652114868164
loss_pred:0.017703287303447723, decouple_loss:0.0006653449963778257
The modified gen p mean: 0.4522811472415924, gen p mean: -0.13095001876354218, mean p set: 0.4528633952140808
loss_pred:0.016705455258488655, decouple_loss:0.0007048898842185736
The modified gen p mean: 0.4518182873725891, gen p mean: -0.14206206798553467, mean p set: 0.45239561796188354
loss_pred:0.016170987859368324, decouple_loss:0.0006476895068772137
Iteration: 3485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509648382663727, gen p mean: -0.13908672332763672, mean p set: 0.45154067873954773
loss_pred:0.016789747402071953, decouple_loss:0.0007152855396270752
The modified gen p mean: 0.4513998329639435, gen p mean: -0.13603056967258453, mean p set: 0.45197397470474243
loss_pred:0.015245308168232441, decouple_loss:0.0005051677580922842
The modified gen p mean: 0.4509231448173523, gen p mean: -0.13433484733104706, mean p set: 0.4514998197555542
loss_pred:0.01722385734319687, decouple_loss:0.0005392242455855012
Iteration: 3486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080623030662537, gen p mean: -0.14500872790813446, mean p set: 0.4513830542564392
loss_pred:0.016908029094338417, decouple_loss:0.0005658750887960196
The modified gen p mean: 0.45054686069488525, gen p mean: -0.1384342461824417, mean p set: 0.4511229395866394
The modified gen p mean: 0.4501873254776001, gen p mean: -0.1378893256187439, mean p set: 0.45076268911361694
loss_pred:0.01655644364655018, decouple_loss:0.0004957843339070678
loss_pred:0.016863135620951653, decouple_loss:0.0005166365299373865
Iteration: 3487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514580965042114, gen p mean: -0.14297789335250854, mean p set: 0.45203498005867004
The modified gen p mean: 0.4526626169681549, gen p mean: -0.1427823156118393, mean p set: 0.4532400667667389
loss_pred:0.016614222899079323, decouple_loss:0.0006737757939845324
loss_pred:0.016957879066467285, decouple_loss:0.0006196672911755741
The modified gen p mean: 0.4511511027812958, gen p mean: -0.14717113971710205, mean p set: 0.45172742009162903
loss_pred:0.01645343191921711, decouple_loss:0.0006256323540583253
Iteration: 3488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510064721107483, gen p mean: -0.14873751997947693, mean p set: 0.45158541202545166
loss_pred:0.01648182049393654, decouple_loss:0.0006292058969847858
The modified gen p mean: 0.45083317160606384, gen p mean: -0.14712707698345184, mean p set: 0.4514060616493225
loss_pred:0.016734182834625244, decouple_loss:0.0007120001246221364
The modified gen p mean: 0.4504395127296448, gen p mean: -0.15247870981693268, mean p set: 0.4510160982608795
loss_pred:0.016462041065096855, decouple_loss:0.0005533091025426984
Iteration: 3489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45092782378196716, gen p mean: -0.14906862378120422, mean p set: 0.451505571603775
loss_pred:0.016182150691747665, decouple_loss:0.0005488429451361299
The modified gen p mean: 0.4520060122013092, gen p mean: -0.14691518247127533, mean p set: 0.45258012413978577
loss_pred:0.01616186462342739, decouple_loss:0.000513872888404876
The modified gen p mean: 0.45231080055236816, gen p mean: -0.14849193394184113, mean p set: 0.45288771390914917
loss_pred:0.01676448993384838, decouple_loss:0.0005862527759745717
Iteration: 3490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45144447684288025, gen p mean: -0.14844749867916107, mean p set: 0.4520242512226105
loss_pred:0.015487230382859707, decouple_loss:0.00046299141831696033
The modified gen p mean: 0.44994378089904785, gen p mean: -0.1479312628507614, mean p set: 0.45052260160446167
The modified gen p mean: 0.45128875970840454, gen p mean: -0.14427664875984192, mean p set: 0.4518622159957886
loss_pred:0.01583786867558956, decouple_loss:0.0005125888856127858
loss_pred:0.016354724764823914, decouple_loss:0.0005282480269670486
2023-05-02 17:01:33 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.15332750976085663, mean p set: 0.4502691626548767
loss_pred:0.01767069846391678, decouple_loss:0.0005809513386338949
The modified gen p mean: 0.44953158497810364, gen p mean: -0.14533181488513947, mean p set: 0.4500633478164673
loss_pred:0.016817331314086914, decouple_loss:0.0005859126104041934
The modified gen p mean: 0.44982412457466125, gen p mean: -0.14430275559425354, mean p set: 0.45035696029663086
loss_pred:0.01715800352394581, decouple_loss:0.0005050905747339129
WV_1_PC_1_EH_0_PS_40, loss: 0.01724321022629738, avg_mse: 0.026584431529045105
current test mse: 0.026584
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 3491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471603035926819, gen p mean: -0.14841140806674957, mean p set: 0.4477364122867584
loss_pred:0.01529714372009039, decouple_loss:0.0005979987909086049
The modified gen p mean: 0.44806304574012756, gen p mean: -0.13919533789157867, mean p set: 0.44864022731781006
loss_pred:0.015533322468400002, decouple_loss:0.0005087785539217293
The modified gen p mean: 0.4484431743621826, gen p mean: -0.13830150663852692, mean p set: 0.44901901483535767
loss_pred:0.015811150893568993, decouple_loss:0.0007696897955611348
Iteration: 3492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448519766330719, gen p mean: -0.13394217193126678, mean p set: 0.44909510016441345
loss_pred:0.015263310633599758, decouple_loss:0.000580477062612772
The modified gen p mean: 0.44754722714424133, gen p mean: -0.13790255784988403, mean p set: 0.4481230676174164The modified gen p mean: 0.4504048526287079, gen p mean: -0.1456909477710724, mean p set: 0.45098060369491577
loss_pred:0.015306555666029453, decouple_loss:0.0005328350816853344
loss_pred:0.015011906623840332, decouple_loss:0.0006144547369331121
Iteration: 3493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44895628094673157, gen p mean: -0.1327611654996872, mean p set: 0.449531614780426
loss_pred:0.015440018847584724, decouple_loss:0.0005661703762598336
The modified gen p mean: 0.44884762167930603, gen p mean: -0.13227200508117676, mean p set: 0.4494239091873169
loss_pred:0.014413408003747463, decouple_loss:0.0005941331619396806
The modified gen p mean: 0.4488379955291748, gen p mean: -0.1387825757265091, mean p set: 0.4494134187698364
loss_pred:0.014907501637935638, decouple_loss:0.0005949062760919333
Iteration: 3494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807353615760803, gen p mean: -0.1346377283334732, mean p set: 0.448650062084198
loss_pred:0.015361806377768517, decouple_loss:0.000545718998182565
The modified gen p mean: 0.4468100070953369, gen p mean: -0.1368546038866043, mean p set: 0.44738414883613586
loss_pred:0.015799418091773987, decouple_loss:0.0005045855068601668
The modified gen p mean: 0.4487081468105316, gen p mean: -0.14069481194019318, mean p set: 0.4492855668067932
loss_pred:0.014779297634959221, decouple_loss:0.0006214333698153496
Iteration: 3495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473332464694977, gen p mean: -0.14072953164577484, mean p set: 0.4479077458381653
loss_pred:0.014632534235715866, decouple_loss:0.00046386171015910804
The modified gen p mean: 0.4483136832714081, gen p mean: -0.15654319524765015, mean p set: 0.44889357686042786
loss_pred:0.014934157952666283, decouple_loss:0.0005761530483141541
The modified gen p mean: 0.448244571685791, gen p mean: -0.1420254111289978, mean p set: 0.44881969690322876
loss_pred:0.015482925809919834, decouple_loss:0.000507487216964364
Iteration: 3496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485386312007904, gen p mean: -0.16554097831249237, mean p set: 0.4491152763366699
loss_pred:0.014593563973903656, decouple_loss:0.0006186074460856616
The modified gen p mean: 0.447153240442276, gen p mean: -0.15775282680988312, mean p set: 0.4477311074733734
loss_pred:0.015236367471516132, decouple_loss:0.0006163436337374151
The modified gen p mean: 0.4504777491092682, gen p mean: -0.16008007526397705, mean p set: 0.4510541558265686
loss_pred:0.01478218287229538, decouple_loss:0.0008525694138370454
Iteration: 3497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481225609779358, gen p mean: -0.17305700480937958, mean p set: 0.4486970603466034
loss_pred:0.015272879041731358, decouple_loss:0.00046977668534964323
The modified gen p mean: 0.447966992855072, gen p mean: -0.15998439490795135, mean p set: 0.4485420286655426
loss_pred:0.015254024416208267, decouple_loss:0.0005347918486222625
The modified gen p mean: 0.4496456980705261, gen p mean: -0.16225576400756836, mean p set: 0.4502216577529907
loss_pred:0.015134450048208237, decouple_loss:0.0005099500413052738
Iteration: 3498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735562801361084, gen p mean: -0.164128378033638, mean p set: 0.4479316174983978
loss_pred:0.015443365089595318, decouple_loss:0.0006445046165026724
The modified gen p mean: 0.4487578868865967, gen p mean: -0.17088492214679718, mean p set: 0.44932815432548523
The modified gen p mean: 0.4490707218647003, gen p mean: -0.1626768261194229, mean p set: 0.4496456980705261
loss_pred:0.014413269236683846, decouple_loss:0.0008469073218293488
loss_pred:0.014178127981722355, decouple_loss:0.000692160043399781
Iteration: 3499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475197196006775, gen p mean: -0.15350404381752014, mean p set: 0.4480955898761749
loss_pred:0.015075352042913437, decouple_loss:0.00062134291511029
The modified gen p mean: 0.4483393132686615, gen p mean: -0.16178855299949646, mean p set: 0.44891637563705444
loss_pred:0.01457466371357441, decouple_loss:0.0005623514880426228
The modified gen p mean: 0.44693318009376526, gen p mean: -0.15644524991512299, mean p set: 0.4475100636482239
loss_pred:0.014526010490953922, decouple_loss:0.0005957870162092149
Iteration: 3500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480587840080261, gen p mean: -0.14903083443641663, mean p set: 0.44863688945770264
loss_pred:0.014314700849354267, decouple_loss:0.0004770573286805302
The modified gen p mean: 0.4483719766139984, gen p mean: -0.13843221962451935, mean p set: 0.44894805550575256
loss_pred:0.014905476942658424, decouple_loss:0.0004975204356014729
The modified gen p mean: 0.4487794041633606, gen p mean: -0.15037491917610168, mean p set: 0.44935348629951477
loss_pred:0.014798487536609173, decouple_loss:0.00045502596185542643
2023-05-02 17:04:23 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.14916382730007172, mean p set: 0.4502691626548767
loss_pred:0.017343580722808838, decouple_loss:0.0006251141312532127
The modified gen p mean: 0.4495384097099304, gen p mean: -0.14090007543563843, mean p set: 0.4500633478164673
loss_pred:0.01660211570560932, decouple_loss:0.0007375771529041231
The modified gen p mean: 0.4498285949230194, gen p mean: -0.13996171951293945, mean p set: 0.45035696029663086
loss_pred:0.01683124154806137, decouple_loss:0.0007017758907750249
WV_1_PC_1_EH_0_PS_40, loss: 0.016960054636001587, avg_mse: 0.02623130939900875
current test mse: 0.026231
Iteration: 3501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473191797733307, gen p mean: -0.1438799500465393, mean p set: 0.4478953182697296
loss_pred:0.014382785186171532, decouple_loss:0.0006265815463848412
The modified gen p mean: 0.44892755150794983, gen p mean: -0.13852132856845856, mean p set: 0.4495035707950592
loss_pred:0.014104858040809631, decouple_loss:0.0005509768961928785
The modified gen p mean: 0.4488871693611145, gen p mean: -0.13953302800655365, mean p set: 0.4494667053222656
loss_pred:0.013843130320310593, decouple_loss:0.0005509621696546674
Iteration: 3502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814783334732056, gen p mean: -0.14339958131313324, mean p set: 0.44871968030929565
The modified gen p mean: 0.4467000961303711, gen p mean: -0.13969045877456665, mean p set: 0.44727620482444763
loss_pred:0.014218172058463097, decouple_loss:0.0006304348935373127
loss_pred:0.01476143579930067, decouple_loss:0.00062702497234568
The modified gen p mean: 0.44804492592811584, gen p mean: -0.13872654736042023, mean p set: 0.448621928691864
loss_pred:0.014741163700819016, decouple_loss:0.0007582625257782638
Iteration: 3503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448798269033432, gen p mean: -0.14312966167926788, mean p set: 0.44937342405319214
loss_pred:0.014189142733812332, decouple_loss:0.0005086628370918334
The modified gen p mean: 0.44837212562561035, gen p mean: -0.14149777591228485, mean p set: 0.4489465653896332
loss_pred:0.01442989706993103, decouple_loss:0.0005349523853510618
The modified gen p mean: 0.4492639899253845, gen p mean: -0.1350111961364746, mean p set: 0.44984006881713867
loss_pred:0.014840538613498211, decouple_loss:0.0005247759399935603
Iteration: 3504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492935538291931, gen p mean: -0.14348363876342773, mean p set: 0.4498688280582428
loss_pred:0.014264564961194992, decouple_loss:0.0005236561992205679
The modified gen p mean: 0.447862833738327, gen p mean: -0.13902641832828522, mean p set: 0.44843941926956177
loss_pred:0.014236990362405777, decouple_loss:0.0005640019080601633
The modified gen p mean: 0.44765445590019226, gen p mean: -0.13461342453956604, mean p set: 0.44823071360588074
loss_pred:0.014159377664327621, decouple_loss:0.0004964818945154548
Iteration: 3505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475069046020508, gen p mean: -0.14626017212867737, mean p set: 0.4480842351913452
loss_pred:0.014168757013976574, decouple_loss:0.00060262595070526
The modified gen p mean: 0.447922021150589, gen p mean: -0.14597120881080627, mean p set: 0.4484964609146118
loss_pred:0.013984142802655697, decouple_loss:0.0005243091145530343
The modified gen p mean: 0.44822958111763, gen p mean: -0.14356668293476105, mean p set: 0.44880932569503784
loss_pred:0.014526325277984142, decouple_loss:0.0005544520681723952
Iteration: 3506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481179416179657, gen p mean: -0.15347109735012054, mean p set: 0.44869375228881836
loss_pred:0.014397450722754002, decouple_loss:0.0005890028551220894
The modified gen p mean: 0.44862934947013855, gen p mean: -0.14940021932125092, mean p set: 0.4492042660713196
The modified gen p mean: 0.4481448829174042, gen p mean: -0.146965891122818, mean p set: 0.44872117042541504
loss_pred:0.013721047900617123, decouple_loss:0.00044084867113269866
loss_pred:0.014731122180819511, decouple_loss:0.00048496114322915673
Iteration: 3507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476381540298462, gen p mean: -0.1407238095998764, mean p set: 0.4482152760028839
loss_pred:0.014418373815715313, decouple_loss:0.0004608067392837256
The modified gen p mean: 0.44793185591697693, gen p mean: -0.14722661674022675, mean p set: 0.448505699634552
The modified gen p mean: 0.4484442472457886, gen p mean: -0.13634976744651794, mean p set: 0.44902175664901733
loss_pred:0.01425748597830534, decouple_loss:0.0004083019448444247
loss_pred:0.01454203762114048, decouple_loss:0.0004579104424919933
Iteration: 3508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828224182128906, gen p mean: -0.1452939361333847, mean p set: 0.4488562345504761
The modified gen p mean: 0.44806501269340515, gen p mean: -0.14479373395442963, mean p set: 0.4486437141895294loss_pred:0.014264345169067383, decouple_loss:0.0005464599234983325
loss_pred:0.01436337549239397, decouple_loss:0.0006468719220720232
The modified gen p mean: 0.4476563334465027, gen p mean: -0.13599219918251038, mean p set: 0.448231041431427
loss_pred:0.014482238329946995, decouple_loss:0.00042513004154898226
Iteration: 3509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756969809532166, gen p mean: -0.13601863384246826, mean p set: 0.4481446146965027
loss_pred:0.015183752402663231, decouple_loss:0.0005842138198204339
The modified gen p mean: 0.44926905632019043, gen p mean: -0.136021226644516, mean p set: 0.44984567165374756
The modified gen p mean: 0.4483582079410553, gen p mean: -0.13758720457553864, mean p set: 0.4489334523677826
loss_pred:0.0145719600841403, decouple_loss:0.0004352862888481468
loss_pred:0.01404728926718235, decouple_loss:0.0006042025634087622
Iteration: 3510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477744996547699, gen p mean: -0.13283729553222656, mean p set: 0.4483504593372345
loss_pred:0.01407635398209095, decouple_loss:0.0004641351697500795
The modified gen p mean: 0.4483470916748047, gen p mean: -0.13033437728881836, mean p set: 0.44892609119415283
The modified gen p mean: 0.44672471284866333, gen p mean: -0.1310196965932846, mean p set: 0.44730088114738464
loss_pred:0.013991771265864372, decouple_loss:0.0005385157419368625
loss_pred:0.014363503083586693, decouple_loss:0.0004985330742783844
2023-05-02 17:06:30 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13859103620052338, mean p set: 0.4502691626548767
loss_pred:0.01715029962360859, decouple_loss:0.00044082358363084495
The modified gen p mean: 0.44953563809394836, gen p mean: -0.13129490613937378, mean p set: 0.4500633478164673
loss_pred:0.016345113515853882, decouple_loss:0.000465571676613763
The modified gen p mean: 0.4498310685157776, gen p mean: -0.13027025759220123, mean p set: 0.45035696029663086
loss_pred:0.016692090779542923, decouple_loss:0.00042084959568455815
WV_1_PC_1_EH_0_PS_40, loss: 0.01675128936767578, avg_mse: 0.026051318272948265
current test mse: 0.026051
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 3511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470476508140564, gen p mean: -0.13513043522834778, mean p set: 0.4476243555545807
loss_pred:0.01521131582558155, decouple_loss:0.0004285963368602097
The modified gen p mean: 0.4464278519153595, gen p mean: -0.13348503410816193, mean p set: 0.447003036737442
loss_pred:0.015473692677915096, decouple_loss:0.0004946270491927862
The modified gen p mean: 0.4463486075401306, gen p mean: -0.13350242376327515, mean p set: 0.4469238221645355
loss_pred:0.015760336071252823, decouple_loss:0.0005488885217346251
Iteration: 3512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44600510597229004, gen p mean: -0.1331023871898651, mean p set: 0.4465799629688263
loss_pred:0.014964173547923565, decouple_loss:0.0006650559953413904
The modified gen p mean: 0.4464333653450012, gen p mean: -0.13329696655273438, mean p set: 0.4470106363296509The modified gen p mean: 0.44656431674957275, gen p mean: -0.13818864524364471, mean p set: 0.44713932275772095
loss_pred:0.015379379503428936, decouple_loss:0.0004474444140214473loss_pred:0.015178435482084751, decouple_loss:0.0005050231702625751
Iteration: 3513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457024335861206, gen p mean: -0.1300160139799118, mean p set: 0.446274995803833
loss_pred:0.015577216632664204, decouple_loss:0.00044607711606658995
The modified gen p mean: 0.4460850954055786, gen p mean: -0.13230326771736145, mean p set: 0.4466569721698761
loss_pred:0.015295426361262798, decouple_loss:0.0003936199937015772
The modified gen p mean: 0.44672122597694397, gen p mean: -0.13640940189361572, mean p set: 0.44729533791542053
loss_pred:0.014979462139308453, decouple_loss:0.00043574647861532867
Iteration: 3514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705963134765625, gen p mean: -0.13350415229797363, mean p set: 0.4476345181465149
loss_pred:0.015026682056486607, decouple_loss:0.0004927824484184384
The modified gen p mean: 0.446383535861969, gen p mean: -0.1350993812084198, mean p set: 0.44695594906806946
loss_pred:0.014582160860300064, decouple_loss:0.00041583270649425685
The modified gen p mean: 0.44708138704299927, gen p mean: -0.1370043158531189, mean p set: 0.44765836000442505
loss_pred:0.01511507760733366, decouple_loss:0.00043321208795532584
Iteration: 3515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465633034706116, gen p mean: -0.13547660410404205, mean p set: 0.44714006781578064
loss_pred:0.015495763160288334, decouple_loss:0.0007349561783485115
The modified gen p mean: 0.44409599900245667, gen p mean: -0.13236376643180847, mean p set: 0.44466984272003174
loss_pred:0.015593708492815495, decouple_loss:0.0008303166832774878
The modified gen p mean: 0.44695889949798584, gen p mean: -0.13126438856124878, mean p set: 0.4475346803665161
loss_pred:0.016044074669480324, decouple_loss:0.0007375324494205415
Iteration: 3516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44573795795440674, gen p mean: -0.13204720616340637, mean p set: 0.44631072878837585
loss_pred:0.0149458646774292, decouple_loss:0.0005616099806502461
The modified gen p mean: 0.4459008276462555, gen p mean: -0.12943045794963837, mean p set: 0.44647544622421265
The modified gen p mean: 0.444823294878006, gen p mean: -0.13037824630737305, mean p set: 0.4453986883163452
loss_pred:0.01589154452085495, decouple_loss:0.0007089794962666929
loss_pred:0.015787415206432343, decouple_loss:0.0007316996343433857
Iteration: 3517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44586288928985596, gen p mean: -0.13277556002140045, mean p set: 0.4464392364025116
loss_pred:0.015219131484627724, decouple_loss:0.00045374923502095044
The modified gen p mean: 0.44691991806030273, gen p mean: -0.1373637169599533, mean p set: 0.44749611616134644
loss_pred:0.014976920560002327, decouple_loss:0.0004640808328986168
The modified gen p mean: 0.4464085102081299, gen p mean: -0.13329975306987762, mean p set: 0.446982741355896
loss_pred:0.01541141513735056, decouple_loss:0.0005462928093038499
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468682110309601, gen p mean: -0.12440763413906097, mean p set: 0.44744303822517395
loss_pred:0.015216374769806862, decouple_loss:0.0008163803140632808
The modified gen p mean: 0.44537144899368286, gen p mean: -0.12661753594875336, mean p set: 0.4459480941295624
The modified gen p mean: 0.44555962085723877, gen p mean: -0.12529239058494568, mean p set: 0.44613370299339294
loss_pred:0.01506660133600235, decouple_loss:0.0006340187392197549
loss_pred:0.014766531996428967, decouple_loss:0.0006552893901243806
Iteration: 3519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462340772151947, gen p mean: -0.12203584611415863, mean p set: 0.4468083381652832
loss_pred:0.015120741911232471, decouple_loss:0.0007089517894200981
The modified gen p mean: 0.44645899534225464, gen p mean: -0.12817268073558807, mean p set: 0.4470359981060028
loss_pred:0.014849078841507435, decouple_loss:0.0005977685796096921
The modified gen p mean: 0.4465060830116272, gen p mean: -0.12616606056690216, mean p set: 0.4470827281475067
loss_pred:0.014899010770022869, decouple_loss:0.000567703798878938
Iteration: 3520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455987513065338, gen p mean: -0.12791070342063904, mean p set: 0.446174293756485
loss_pred:0.015122747980058193, decouple_loss:0.0005239472957327962
The modified gen p mean: 0.4463234841823578, gen p mean: -0.12481801956892014, mean p set: 0.4468989372253418
The modified gen p mean: 0.44620609283447266, gen p mean: -0.12550117075443268, mean p set: 0.44678211212158203
loss_pred:0.01490629930049181, decouple_loss:0.0004749137151520699
loss_pred:0.014950530603528023, decouple_loss:0.0004897497710771859
2023-05-02 17:09:19 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1277940422296524, mean p set: 0.4502691626548767
loss_pred:0.017011845484375954, decouple_loss:0.0005010983441025019
The modified gen p mean: 0.4495355784893036, gen p mean: -0.12070948630571365, mean p set: 0.4500633478164673
loss_pred:0.016288181766867638, decouple_loss:0.0005085098091512918
The modified gen p mean: 0.4498283863067627, gen p mean: -0.11980884522199631, mean p set: 0.45035696029663086
loss_pred:0.016492580994963646, decouple_loss:0.0004930119612254202
WV_1_PC_1_EH_0_PS_40, loss: 0.016622578725218773, avg_mse: 0.025951823219656944
current test mse: 0.025952
Iteration: 3521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471592903137207, gen p mean: -0.127104252576828, mean p set: 0.44773659110069275
loss_pred:0.014805956743657589, decouple_loss:0.0005272013368085027
The modified gen p mean: 0.4470656216144562, gen p mean: -0.12656764686107635, mean p set: 0.4476405084133148
loss_pred:0.015099678188562393, decouple_loss:0.0004004912334494293
The modified gen p mean: 0.44695374369621277, gen p mean: -0.1278064101934433, mean p set: 0.4475320279598236
loss_pred:0.014471000991761684, decouple_loss:0.0004503504897002131
Iteration: 3522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469476640224457, gen p mean: -0.12803198397159576, mean p set: 0.44752374291419983
loss_pred:0.015675082802772522, decouple_loss:0.0004518306232057512
The modified gen p mean: 0.44650161266326904, gen p mean: -0.13054794073104858, mean p set: 0.44707778096199036The modified gen p mean: 0.44646841287612915, gen p mean: -0.12936055660247803, mean p set: 0.4470418095588684
loss_pred:0.015016439370810986, decouple_loss:0.0005690937396138906
loss_pred:0.014883792959153652, decouple_loss:0.0005663982010446489
Iteration: 3523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661858677864075, gen p mean: -0.13228730857372284, mean p set: 0.44719311594963074
loss_pred:0.01491554081439972, decouple_loss:0.0006197451148182154
The modified gen p mean: 0.44537991285324097, gen p mean: -0.13273440301418304, mean p set: 0.44595643877983093The modified gen p mean: 0.4475559890270233, gen p mean: -0.12647145986557007, mean p set: 0.44812965393066406
loss_pred:0.014917993918061256, decouple_loss:0.0007531023002229631
loss_pred:0.015157999470829964, decouple_loss:0.0005565694882534444
Iteration: 3524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466977119445801, gen p mean: -0.13341134786605835, mean p set: 0.4472745358943939
loss_pred:0.014576727524399757, decouple_loss:0.0007717230473645031
The modified gen p mean: 0.44697368144989014, gen p mean: -0.1308969110250473, mean p set: 0.44754984974861145
loss_pred:0.014891216531395912, decouple_loss:0.0005900305113755167
The modified gen p mean: 0.4457837641239166, gen p mean: -0.13249562680721283, mean p set: 0.4463599622249603
loss_pred:0.015061032958328724, decouple_loss:0.0006964654894545674
Iteration: 3525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470576047897339, gen p mean: -0.123074971139431, mean p set: 0.44763532280921936
loss_pred:0.015506728552281857, decouple_loss:0.000354724790668115
The modified gen p mean: 0.4469716250896454, gen p mean: -0.1249062642455101, mean p set: 0.4475449025630951
loss_pred:0.015261713415384293, decouple_loss:0.00032509403536096215
The modified gen p mean: 0.4458291530609131, gen p mean: -0.1302601844072342, mean p set: 0.44640541076660156
loss_pred:0.015087558887898922, decouple_loss:0.00031269880128093064
Iteration: 3526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446374773979187, gen p mean: -0.12708346545696259, mean p set: 0.44695156812667847
loss_pred:0.01476257760077715, decouple_loss:0.0005501674022525549
The modified gen p mean: 0.44608625769615173, gen p mean: -0.12483073025941849, mean p set: 0.44666188955307007
The modified gen p mean: 0.4457627236843109, gen p mean: -0.13035377860069275, mean p set: 0.4463409185409546
loss_pred:0.01509067602455616, decouple_loss:0.00042050902266055346
loss_pred:0.014774820767343044, decouple_loss:0.0005032406188547611
Iteration: 3527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44507625699043274, gen p mean: -0.12998215854167938, mean p set: 0.4456527829170227
loss_pred:0.014669448137283325, decouple_loss:0.0005999633576720953
The modified gen p mean: 0.447868674993515, gen p mean: -0.1240137442946434, mean p set: 0.4484444558620453
loss_pred:0.015424569137394428, decouple_loss:0.000670925946906209
The modified gen p mean: 0.447532057762146, gen p mean: -0.12893696129322052, mean p set: 0.4481041729450226
loss_pred:0.015553893521428108, decouple_loss:0.0005460756365209818
Iteration: 3528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729161262512207, gen p mean: -0.12539304792881012, mean p set: 0.4478660225868225
loss_pred:0.01565334014594555, decouple_loss:0.00048248269013129175
The modified gen p mean: 0.4466601610183716, gen p mean: -0.12314362823963165, mean p set: 0.44723621010780334
loss_pred:0.014704382978379726, decouple_loss:0.0003406708128750324
The modified gen p mean: 0.44712987542152405, gen p mean: -0.1285860389471054, mean p set: 0.44770827889442444
loss_pred:0.015353936702013016, decouple_loss:0.000419629126554355
Iteration: 3529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44581931829452515, gen p mean: -0.12474092096090317, mean p set: 0.44639402627944946
loss_pred:0.014874621294438839, decouple_loss:0.00045060538104735315
The modified gen p mean: 0.44674015045166016, gen p mean: -0.12380768358707428, mean p set: 0.44731536507606506
loss_pred:0.015086499974131584, decouple_loss:0.00038720626616850495
The modified gen p mean: 0.4455399811267853, gen p mean: -0.12242083251476288, mean p set: 0.44611749053001404
loss_pred:0.01482749730348587, decouple_loss:0.0004009807307738811
Iteration: 3530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462721049785614, gen p mean: -0.12631157040596008, mean p set: 0.4468485414981842
loss_pred:0.01497044786810875, decouple_loss:0.0004378878802526742
The modified gen p mean: 0.4468270242214203, gen p mean: -0.1252567023038864, mean p set: 0.447405070066452
loss_pred:0.014655367471277714, decouple_loss:0.0005295379087328911
The modified gen p mean: 0.4454852342605591, gen p mean: -0.12679408490657806, mean p set: 0.44606199860572815
loss_pred:0.014838996343314648, decouple_loss:0.0005055482615716755
2023-05-02 17:11:27 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12748956680297852, mean p set: 0.4502691626548767
loss_pred:0.01697041466832161, decouple_loss:0.0005350513965822756
The modified gen p mean: 0.4495335817337036, gen p mean: -0.12011540681123734, mean p set: 0.4500633478164673
loss_pred:0.01624971814453602, decouple_loss:0.0004022468929179013
The modified gen p mean: 0.4498277008533478, gen p mean: -0.11939852684736252, mean p set: 0.45035696029663086
loss_pred:0.016526520252227783, decouple_loss:0.0004749965446535498
WV_1_PC_1_EH_0_PS_40, loss: 0.016605757176876068, avg_mse: 0.025949355214834213
current test mse: 0.025949
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
NaN value num: 0
Iteration: 3531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727301597595215, gen p mean: -0.12393058091402054, mean p set: 0.4478487968444824
loss_pred:0.015483980998396873, decouple_loss:0.00042651486000977457
The modified gen p mean: 0.4478224515914917, gen p mean: -0.11683927476406097, mean p set: 0.4483988583087921
loss_pred:0.01525228749960661, decouple_loss:0.0004091103037353605
The modified gen p mean: 0.44858354330062866, gen p mean: -0.11886606365442276, mean p set: 0.4491589367389679
loss_pred:0.016051746904850006, decouple_loss:0.00042606983333826065
Iteration: 3532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483177065849304, gen p mean: -0.11700701713562012, mean p set: 0.4488941431045532
loss_pred:0.015213802456855774, decouple_loss:0.00038522505201399326
The modified gen p mean: 0.44786807894706726, gen p mean: -0.12110786885023117, mean p set: 0.44844523072242737The modified gen p mean: 0.447897344827652, gen p mean: -0.11841534078121185, mean p set: 0.44847577810287476
loss_pred:0.015979096293449402, decouple_loss:0.0003758913662750274
loss_pred:0.01585681550204754, decouple_loss:0.00038462335942313075
Iteration: 3533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859910011291504, gen p mean: -0.12275959551334381, mean p set: 0.44917523860931396
loss_pred:0.015970775857567787, decouple_loss:0.00046498599112965167
The modified gen p mean: 0.44834598898887634, gen p mean: -0.12058377265930176, mean p set: 0.4489196836948395
loss_pred:0.015615618787705898, decouple_loss:0.0003989292017649859
The modified gen p mean: 0.44876882433891296, gen p mean: -0.12206526845693588, mean p set: 0.44934555888175964
loss_pred:0.016068847849965096, decouple_loss:0.0003838302509393543
Iteration: 3534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488111734390259, gen p mean: -0.12198225408792496, mean p set: 0.4493875503540039
loss_pred:0.016146019101142883, decouple_loss:0.00034524110378697515
The modified gen p mean: 0.44805654883384705, gen p mean: -0.12283620238304138, mean p set: 0.44863176345825195
loss_pred:0.016476675868034363, decouple_loss:0.00041966376011259854
The modified gen p mean: 0.4483061730861664, gen p mean: -0.11995841562747955, mean p set: 0.44888144731521606
loss_pred:0.015439239330589771, decouple_loss:0.0003522825427353382
Iteration: 3535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482126533985138, gen p mean: -0.12107951939105988, mean p set: 0.4487886428833008
loss_pred:0.015599201433360577, decouple_loss:0.00038673251401633024
The modified gen p mean: 0.4494882822036743, gen p mean: -0.11911168694496155, mean p set: 0.450064092874527
The modified gen p mean: 0.4473980665206909, gen p mean: -0.1259269267320633, mean p set: 0.44797325134277344
loss_pred:0.016052071005105972, decouple_loss:0.0005416105850599706
loss_pred:0.016261013224720955, decouple_loss:0.0005329254199750721
Iteration: 3536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963791966438293, gen p mean: -0.1227954775094986, mean p set: 0.45021507143974304
loss_pred:0.015513401478528976, decouple_loss:0.0003587394894566387
The modified gen p mean: 0.448482483625412, gen p mean: -0.12455335259437561, mean p set: 0.44906121492385864
The modified gen p mean: 0.44880861043930054, gen p mean: -0.1258954107761383, mean p set: 0.4493860900402069
loss_pred:0.015771841630339622, decouple_loss:0.00045072840293869376
loss_pred:0.015635093674063683, decouple_loss:0.0005764719098806381
Iteration: 3537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486890733242035, gen p mean: -0.1259596198797226, mean p set: 0.4492657780647278
The modified gen p mean: 0.450126588344574, gen p mean: -0.12697722017765045, mean p set: 0.4507031738758087
loss_pred:0.01577720418572426, decouple_loss:0.0003706247953232378
loss_pred:0.015724461525678635, decouple_loss:0.0002922353451140225
The modified gen p mean: 0.44800102710723877, gen p mean: -0.12606197595596313, mean p set: 0.448575496673584
loss_pred:0.016312507912516594, decouple_loss:0.0004153816553298384
Iteration: 3538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449359655380249, gen p mean: -0.12585407495498657, mean p set: 0.4499320983886719
loss_pred:0.01546859834343195, decouple_loss:0.0004570667806547135
The modified gen p mean: 0.44936254620552063, gen p mean: -0.12540248036384583, mean p set: 0.44993606209754944
The modified gen p mean: 0.4479748010635376, gen p mean: -0.13136914372444153, mean p set: 0.44855284690856934
loss_pred:0.015385383740067482, decouple_loss:0.0003819343983195722
loss_pred:0.015605348162353039, decouple_loss:0.0004614993813447654
Iteration: 3539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491274356842041, gen p mean: -0.12398207932710648, mean p set: 0.4497022032737732
loss_pred:0.015900181606411934, decouple_loss:0.000516524538397789
The modified gen p mean: 0.4496130645275116, gen p mean: -0.12388017028570175, mean p set: 0.4501916468143463
loss_pred:0.016537388786673546, decouple_loss:0.00044921066728420556
The modified gen p mean: 0.4486500322818756, gen p mean: -0.12535862624645233, mean p set: 0.4492282271385193
loss_pred:0.015903528779745102, decouple_loss:0.0005295819137245417
Iteration: 3540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886863231658936, gen p mean: -0.1242724061012268, mean p set: 0.44944456219673157
loss_pred:0.01603269949555397, decouple_loss:0.00037918821908533573
The modified gen p mean: 0.448600172996521, gen p mean: -0.13103380799293518, mean p set: 0.4491797089576721
loss_pred:0.015413492918014526, decouple_loss:0.0006381747662089765
The modified gen p mean: 0.4496888220310211, gen p mean: -0.12648595869541168, mean p set: 0.45026108622550964
loss_pred:0.015789996832609177, decouple_loss:0.0004880356427747756
2023-05-02 17:14:12 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13485175371170044, mean p set: 0.4502691626548767
loss_pred:0.017030520364642143, decouple_loss:0.0006445337203331292
The modified gen p mean: 0.4498305916786194, gen p mean: -0.12729978561401367, mean p set: 0.45035696029663086
loss_pred:0.016497863456606865, decouple_loss:0.0006898286519572139
The modified gen p mean: 0.449537068605423, gen p mean: -0.12769585847854614, mean p set: 0.4500633478164673
loss_pred:0.016276083886623383, decouple_loss:0.0004974670591764152
WV_1_PC_1_EH_0_PS_40, loss: 0.016632020473480225, avg_mse: 0.025920288637280464
current test mse: 0.02592
Iteration: 3541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45020440220832825, gen p mean: -0.12697161734104156, mean p set: 0.45078352093696594
loss_pred:0.01499671395868063, decouple_loss:0.0004560417146421969
The modified gen p mean: 0.4495336711406708, gen p mean: -0.1273972988128662, mean p set: 0.4501113295555115
loss_pred:0.01533048041164875, decouple_loss:0.0003757755330298096
The modified gen p mean: 0.4485214352607727, gen p mean: -0.1284494251012802, mean p set: 0.44910046458244324
loss_pred:0.01583406887948513, decouple_loss:0.0006629066774621606
Iteration: 3542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810178875923157, gen p mean: -0.126148521900177, mean p set: 0.44868043065071106
loss_pred:0.015744024887681007, decouple_loss:0.0004473291337490082
The modified gen p mean: 0.4499306380748749, gen p mean: -0.12517112493515015, mean p set: 0.4505065083503723The modified gen p mean: 0.4502558410167694, gen p mean: -0.1273135542869568, mean p set: 0.45083382725715637
loss_pred:0.015055065974593163, decouple_loss:0.00039791545714251697
loss_pred:0.015382086858153343, decouple_loss:0.0007376983412541449
Iteration: 3543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495987892150879, gen p mean: -0.12706772983074188, mean p set: 0.45017367601394653
loss_pred:0.014823827892541885, decouple_loss:0.00042779400246217847
The modified gen p mean: 0.44986391067504883, gen p mean: -0.1246354803442955, mean p set: 0.4504399299621582The modified gen p mean: 0.44920486211776733, gen p mean: -0.12393049895763397, mean p set: 0.4497818946838379
loss_pred:0.014512120746076107, decouple_loss:0.0003629967977758497
loss_pred:0.016056286171078682, decouple_loss:0.0004354214179329574
Iteration: 3544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488445818424225, gen p mean: -0.12753508985042572, mean p set: 0.4494177997112274
loss_pred:0.01551696565002203, decouple_loss:0.00039044959703460336
The modified gen p mean: 0.4497976005077362, gen p mean: -0.12644630670547485, mean p set: 0.4503753185272217
loss_pred:0.014764072373509407, decouple_loss:0.00033953506499528885
The modified gen p mean: 0.45035067200660706, gen p mean: -0.1292528659105301, mean p set: 0.4509304463863373
loss_pred:0.015078098513185978, decouple_loss:0.00041027291445061564
Iteration: 3545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44950559735298157, gen p mean: -0.12296708673238754, mean p set: 0.4500845670700073
loss_pred:0.015085749328136444, decouple_loss:0.0003778662357944995
The modified gen p mean: 0.44738200306892395, gen p mean: -0.132337287068367, mean p set: 0.4479599893093109
loss_pred:0.015905313193798065, decouple_loss:0.0003238714125473052
The modified gen p mean: 0.44835585355758667, gen p mean: -0.13058330118656158, mean p set: 0.44893211126327515
loss_pred:0.015375499613583088, decouple_loss:0.00037040517781861126
Iteration: 3546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754424691200256, gen p mean: -0.12890009582042694, mean p set: 0.44812440872192383
loss_pred:0.015440951101481915, decouple_loss:0.0003974786086473614
The modified gen p mean: 0.4482879936695099, gen p mean: -0.12821370363235474, mean p set: 0.4488662779331207
The modified gen p mean: 0.4481765627861023, gen p mean: -0.12966783344745636, mean p set: 0.4487546980381012
loss_pred:0.015256841666996479, decouple_loss:0.0004003939393442124
loss_pred:0.015540209598839283, decouple_loss:0.0004634507349692285
Iteration: 3547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449072927236557, gen p mean: -0.13094046711921692, mean p set: 0.4496472179889679
loss_pred:0.015956250950694084, decouple_loss:0.000408520718337968
The modified gen p mean: 0.4502340853214264, gen p mean: -0.12854374945163727, mean p set: 0.45080816745758057
The modified gen p mean: 0.44852685928344727, gen p mean: -0.1296425759792328, mean p set: 0.4491029977798462
loss_pred:0.015691902488470078, decouple_loss:0.0003504060150589794
loss_pred:0.016104357317090034, decouple_loss:0.00039729292620904744
Iteration: 3548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969257712364197, gen p mean: -0.12357970327138901, mean p set: 0.45026645064353943
loss_pred:0.01538131944835186, decouple_loss:0.0005252708215266466
The modified gen p mean: 0.45012742280960083, gen p mean: -0.12736622989177704, mean p set: 0.4507019817829132
loss_pred:0.015024852007627487, decouple_loss:0.0006402310100384057
The modified gen p mean: 0.4497253894805908, gen p mean: -0.12622977793216705, mean p set: 0.4502998888492584
loss_pred:0.01473231054842472, decouple_loss:0.0004877572355326265
Iteration: 3549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508955776691437, gen p mean: -0.13098160922527313, mean p set: 0.4514707326889038
loss_pred:0.01506311446428299, decouple_loss:0.00047060323413461447
The modified gen p mean: 0.4475501775741577, gen p mean: -0.1283295452594757, mean p set: 0.4481256306171417
loss_pred:0.01564045622944832, decouple_loss:0.0005947636673226953
The modified gen p mean: 0.44869598746299744, gen p mean: -0.12453778088092804, mean p set: 0.44927293062210083
loss_pred:0.015782317146658897, decouple_loss:0.000401292578317225
Iteration: 3550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977375864982605, gen p mean: -0.1230301633477211, mean p set: 0.4503500759601593
loss_pred:0.014875328168272972, decouple_loss:0.000347268272889778
The modified gen p mean: 0.4489620327949524, gen p mean: -0.12221218645572662, mean p set: 0.44953852891921997
loss_pred:0.015911053866147995, decouple_loss:0.0004311311640776694
The modified gen p mean: 0.44783705472946167, gen p mean: -0.13038277626037598, mean p set: 0.4484170973300934
loss_pred:0.01576598733663559, decouple_loss:0.00044405681546777487
2023-05-02 17:16:19 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13430702686309814, mean p set: 0.4502691626548767
loss_pred:0.016930755227804184, decouple_loss:0.0004191770567558706
The modified gen p mean: 0.4495343267917633, gen p mean: -0.12673059105873108, mean p set: 0.4500633478164673
loss_pred:0.016213009133934975, decouple_loss:0.0005583115271292627
The modified gen p mean: 0.4498286843299866, gen p mean: -0.1262953132390976, mean p set: 0.45035696029663086
loss_pred:0.016437601298093796, decouple_loss:0.0005417292704805732
WV_1_PC_1_EH_0_PS_40, loss: 0.01655244268476963, avg_mse: 0.02578330971300602
current test mse: 0.025783
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
NaN value num: 0
Iteration: 3551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456271827220917, gen p mean: -0.12200672924518585, mean p set: 0.44620171189308167
loss_pred:0.016720982268452644, decouple_loss:0.0004134036134928465
The modified gen p mean: 0.44709664583206177, gen p mean: -0.1265040934085846, mean p set: 0.4476702809333801
loss_pred:0.015866918489336967, decouple_loss:0.0004902681685052812
The modified gen p mean: 0.44603297114372253, gen p mean: -0.13070644438266754, mean p set: 0.4466082453727722
loss_pred:0.016024267300963402, decouple_loss:0.0003922367177437991
Iteration: 3552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473276436328888, gen p mean: -0.12926813960075378, mean p set: 0.4479012191295624
loss_pred:0.016286905854940414, decouple_loss:0.00037062991759739816
The modified gen p mean: 0.4470057785511017, gen p mean: -0.12698359787464142, mean p set: 0.4475829601287842The modified gen p mean: 0.44864165782928467, gen p mean: -0.1275622695684433, mean p set: 0.44921690225601196
loss_pred:0.015010490082204342, decouple_loss:0.000452178530395031
loss_pred:0.01578514464199543, decouple_loss:0.000526989868376404
Iteration: 3553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707190990448, gen p mean: -0.12964047491550446, mean p set: 0.4476500451564789
loss_pred:0.015999823808670044, decouple_loss:0.0005787700647488236
The modified gen p mean: 0.4465889036655426, gen p mean: -0.12975476682186127, mean p set: 0.4471641182899475The modified gen p mean: 0.446521133184433, gen p mean: -0.12448611855506897, mean p set: 0.4470962882041931
loss_pred:0.016005652025341988, decouple_loss:0.00042552431114017963
loss_pred:0.016549907624721527, decouple_loss:0.00060628866776824
Iteration: 3554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461558759212494, gen p mean: -0.1357373297214508, mean p set: 0.44673120975494385
loss_pred:0.016443585976958275, decouple_loss:0.00036227915552444756
The modified gen p mean: 0.44573280215263367, gen p mean: -0.12183737009763718, mean p set: 0.4463099241256714
loss_pred:0.01616750657558441, decouple_loss:0.000395093928091228
The modified gen p mean: 0.44781890511512756, gen p mean: -0.13066715002059937, mean p set: 0.4483919143676758
loss_pred:0.015350504778325558, decouple_loss:0.00033457379322499037
Iteration: 3555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460311233997345, gen p mean: -0.12919390201568604, mean p set: 0.4466065764427185
loss_pred:0.01551213301718235, decouple_loss:0.0003223719249945134
The modified gen p mean: 0.44731560349464417, gen p mean: -0.12828022241592407, mean p set: 0.44789019227027893
loss_pred:0.01578638143837452, decouple_loss:0.000352371484041214
The modified gen p mean: 0.44552093744277954, gen p mean: -0.12702904641628265, mean p set: 0.44609498977661133
loss_pred:0.01624182052910328, decouple_loss:0.00037589599378407
Iteration: 3556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447741836309433, gen p mean: -0.130679652094841, mean p set: 0.4483163356781006
loss_pred:0.015970829874277115, decouple_loss:0.00041029619751498103
The modified gen p mean: 0.4467586874961853, gen p mean: -0.12835483253002167, mean p set: 0.44733667373657227
The modified gen p mean: 0.44767752289772034, gen p mean: -0.13025645911693573, mean p set: 0.4482518434524536
loss_pred:0.0165153369307518, decouple_loss:0.0002957049000542611
loss_pred:0.015976184979081154, decouple_loss:0.0004502188239712268
Iteration: 3557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800716638565063, gen p mean: -0.12732771039009094, mean p set: 0.4485847055912018
loss_pred:0.0160819198936224, decouple_loss:0.00032606732565909624
The modified gen p mean: 0.44532310962677, gen p mean: -0.1301078200340271, mean p set: 0.44589856266975403
loss_pred:0.016158733516931534, decouple_loss:0.0005128451739437878
The modified gen p mean: 0.4478710889816284, gen p mean: -0.12913477420806885, mean p set: 0.4484492540359497
loss_pred:0.015398338437080383, decouple_loss:0.00037495081778615713
Iteration: 3558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44578656554222107, gen p mean: -0.12817588448524475, mean p set: 0.44635969400405884
loss_pred:0.01555424090474844, decouple_loss:0.0004194152425043285
The modified gen p mean: 0.447357714176178, gen p mean: -0.12889686226844788, mean p set: 0.44793352484703064
loss_pred:0.015834635123610497, decouple_loss:0.00034365386818535626
The modified gen p mean: 0.44734323024749756, gen p mean: -0.1292632818222046, mean p set: 0.4479162395000458
loss_pred:0.01611548662185669, decouple_loss:0.00037728765164501965
Iteration: 3559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44516775012016296, gen p mean: -0.1335965096950531, mean p set: 0.4457412362098694
loss_pred:0.016297265887260437, decouple_loss:0.0004981050733476877
The modified gen p mean: 0.44887107610702515, gen p mean: -0.12671709060668945, mean p set: 0.4494474530220032
loss_pred:0.016415918245911598, decouple_loss:0.0005063203279860318
The modified gen p mean: 0.44540727138519287, gen p mean: -0.13002584874629974, mean p set: 0.4459850490093231
loss_pred:0.01632765680551529, decouple_loss:0.0005285869701765478
Iteration: 3560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787129759788513, gen p mean: -0.12431839108467102, mean p set: 0.4484466016292572
loss_pred:0.01624484173953533, decouple_loss:0.0003628260747063905
The modified gen p mean: 0.44687598943710327, gen p mean: -0.12453275918960571, mean p set: 0.44745099544525146
loss_pred:0.016489433124661446, decouple_loss:0.00038887429400347173
The modified gen p mean: 0.44760236144065857, gen p mean: -0.12899543344974518, mean p set: 0.44818219542503357
loss_pred:0.016085699200630188, decouple_loss:0.00043264299165457487
2023-05-02 17:19:07 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13438431918621063, mean p set: 0.4502691626548767
loss_pred:0.01689930446445942, decouple_loss:0.0004620543331839144
The modified gen p mean: 0.4495362639427185, gen p mean: -0.1270376294851303, mean p set: 0.4500633478164673
loss_pred:0.016163043677806854, decouple_loss:0.00042801658855751157
The modified gen p mean: 0.44982773065567017, gen p mean: -0.12651675939559937, mean p set: 0.45035696029663086
loss_pred:0.01635407656431198, decouple_loss:0.00037630353472195566
WV_1_PC_1_EH_0_PS_40, loss: 0.01649324595928192, avg_mse: 0.025724979117512703
current test mse: 0.025725
Iteration: 3561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447039932012558, gen p mean: -0.12673012912273407, mean p set: 0.44761335849761963
loss_pred:0.016517948359251022, decouple_loss:0.0006129263783805072
The modified gen p mean: 0.4462527930736542, gen p mean: -0.12783585488796234, mean p set: 0.44682827591896057
The modified gen p mean: 0.4467504918575287, gen p mean: -0.12412016093730927, mean p set: 0.44732820987701416
loss_pred:0.016871396452188492, decouple_loss:0.0005435624625533819
loss_pred:0.01673150062561035, decouple_loss:0.00042591639794409275
Iteration: 3562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775137305259705, gen p mean: -0.12710769474506378, mean p set: 0.44832971692085266
loss_pred:0.016736257821321487, decouple_loss:0.00046974231372587383
The modified gen p mean: 0.4464733600616455, gen p mean: -0.12580089271068573, mean p set: 0.44704747200012207The modified gen p mean: 0.44806644320487976, gen p mean: -0.12637631595134735, mean p set: 0.44864365458488464
loss_pred:0.015572858974337578, decouple_loss:0.0004091910959687084
loss_pred:0.015460960566997528, decouple_loss:0.000608677277341485
Iteration: 3563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779253005981445, gen p mean: -0.12869592010974884, mean p set: 0.4483678936958313
loss_pred:0.015989776700735092, decouple_loss:0.0004182656412012875
The modified gen p mean: 0.44626158475875854, gen p mean: -0.13345207273960114, mean p set: 0.4468361735343933
loss_pred:0.016608744859695435, decouple_loss:0.0003309051680844277
The modified gen p mean: 0.4463391602039337, gen p mean: -0.12913157045841217, mean p set: 0.44691455364227295
loss_pred:0.015477451495826244, decouple_loss:0.0003186066460330039
Iteration: 3564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459814727306366, gen p mean: -0.1321573555469513, mean p set: 0.4465598464012146
loss_pred:0.01549010444432497, decouple_loss:0.00036098912823945284
The modified gen p mean: 0.4462011754512787, gen p mean: -0.13621269166469574, mean p set: 0.4467763900756836
loss_pred:0.01656883955001831, decouple_loss:0.0004404909850563854
The modified gen p mean: 0.44529953598976135, gen p mean: -0.1337394267320633, mean p set: 0.44587424397468567
loss_pred:0.01684226281940937, decouple_loss:0.0005416861968114972
Iteration: 3565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475667178630829, gen p mean: -0.13000917434692383, mean p set: 0.44814398884773254
loss_pred:0.015636449679732323, decouple_loss:0.00036583791370503604
The modified gen p mean: 0.44748106598854065, gen p mean: -0.13900594413280487, mean p set: 0.4480588138103485
loss_pred:0.016669651493430138, decouple_loss:0.0005224711494520307
The modified gen p mean: 0.44528505206108093, gen p mean: -0.13199007511138916, mean p set: 0.4458599388599396
loss_pred:0.01579173095524311, decouple_loss:0.000381260848371312
Iteration: 3566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457593560218811, gen p mean: -0.1347213238477707, mean p set: 0.4463336765766144
loss_pred:0.01627531833946705, decouple_loss:0.0004918658523820341
The modified gen p mean: 0.44699084758758545, gen p mean: -0.13250614702701569, mean p set: 0.44756653904914856
loss_pred:0.015829065814614296, decouple_loss:0.00042929055052809417
The modified gen p mean: 0.4463236927986145, gen p mean: -0.13368120789527893, mean p set: 0.4468995928764343
loss_pred:0.016177259385585785, decouple_loss:0.0003958728048019111
Iteration: 3567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691500067710876, gen p mean: -0.13082049787044525, mean p set: 0.4474896788597107
loss_pred:0.01565835438668728, decouple_loss:0.000376614072592929
The modified gen p mean: 0.4480150640010834, gen p mean: -0.13300634920597076, mean p set: 0.44859373569488525
loss_pred:0.01601426489651203, decouple_loss:0.00029808777617290616
The modified gen p mean: 0.44653284549713135, gen p mean: -0.13393893837928772, mean p set: 0.4471109211444855
loss_pred:0.016659216955304146, decouple_loss:0.00044710474321618676
Iteration: 3568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799262285232544, gen p mean: -0.13145367801189423, mean p set: 0.4485665559768677
loss_pred:0.016402199864387512, decouple_loss:0.00034857631544582546
The modified gen p mean: 0.446067214012146, gen p mean: -0.1306600272655487, mean p set: 0.4466424882411957
loss_pred:0.016475047916173935, decouple_loss:0.0005195483681745827
The modified gen p mean: 0.4474811255931854, gen p mean: -0.13415440917015076, mean p set: 0.44805923104286194
loss_pred:0.016454432159662247, decouple_loss:0.0005239318707026541
Iteration: 3569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466748535633087, gen p mean: -0.1235695481300354, mean p set: 0.44724923372268677
loss_pred:0.016136331483721733, decouple_loss:0.00031855577253736556
The modified gen p mean: 0.4472556412220001, gen p mean: -0.1271766871213913, mean p set: 0.4478325843811035
loss_pred:0.01665031909942627, decouple_loss:0.0003422541485633701
The modified gen p mean: 0.447782427072525, gen p mean: -0.12696067988872528, mean p set: 0.4483541250228882
loss_pred:0.015948494896292686, decouple_loss:0.0002544560993555933
Iteration: 3570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468453824520111, gen p mean: -0.12769518792629242, mean p set: 0.4474199414253235
loss_pred:0.016718706116080284, decouple_loss:0.0004053795710206032
The modified gen p mean: 0.4453592300415039, gen p mean: -0.13530157506465912, mean p set: 0.4459342360496521
loss_pred:0.016340838745236397, decouple_loss:0.0003087974328082055
The modified gen p mean: 0.4467337727546692, gen p mean: -0.12979871034622192, mean p set: 0.44731420278549194
loss_pred:0.0162302628159523, decouple_loss:0.0003493304830044508
2023-05-02 17:21:14 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1362493485212326, mean p set: 0.4502691626548767
loss_pred:0.016924988478422165, decouple_loss:0.0005597970448434353
The modified gen p mean: 0.4495343565940857, gen p mean: -0.1291598379611969, mean p set: 0.4500633478164673
loss_pred:0.016221163794398308, decouple_loss:0.00043909516534768045
The modified gen p mean: 0.4498310387134552, gen p mean: -0.1285233199596405, mean p set: 0.45035696029663086
loss_pred:0.0164804644882679, decouple_loss:0.0004095332114957273
WV_1_PC_1_EH_0_PS_40, loss: 0.016565680503845215, avg_mse: 0.025830291211605072
current test mse: 0.02583
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
NaN value num: 0
Iteration: 3571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508717954158783, gen p mean: -0.12119089812040329, mean p set: 0.451452374458313
loss_pred:0.014845211058855057, decouple_loss:0.000435686728451401
The modified gen p mean: 0.45121270418167114, gen p mean: -0.11694269627332687, mean p set: 0.4517904222011566
loss_pred:0.01527484878897667, decouple_loss:0.0006569972611032426
The modified gen p mean: 0.451598584651947, gen p mean: -0.11720964312553406, mean p set: 0.4521760940551758
loss_pred:0.01507230382412672, decouple_loss:0.0005471245967783034
Iteration: 3572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526159167289734, gen p mean: -0.12249346822500229, mean p set: 0.4531942903995514
loss_pred:0.01487874798476696, decouple_loss:0.0004253138031344861
The modified gen p mean: 0.45337924361228943, gen p mean: -0.12392359972000122, mean p set: 0.45395946502685547The modified gen p mean: 0.45038843154907227, gen p mean: -0.12688201665878296, mean p set: 0.45096346735954285
loss_pred:0.014148269779980183, decouple_loss:0.00045189299271441996
loss_pred:0.015314344316720963, decouple_loss:0.00044317066203802824
Iteration: 3573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510587155818939, gen p mean: -0.13008442521095276, mean p set: 0.4516349136829376
loss_pred:0.015386716462671757, decouple_loss:0.0005094031221233308
The modified gen p mean: 0.4526214599609375, gen p mean: -0.12524904310703278, mean p set: 0.45320072770118713
loss_pred:0.01441485621035099, decouple_loss:0.0003449753567110747
The modified gen p mean: 0.45273932814598083, gen p mean: -0.13160927593708038, mean p set: 0.4533170461654663
loss_pred:0.014076026156544685, decouple_loss:0.00044813318527303636
Iteration: 3574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45211130380630493, gen p mean: -0.13086971640586853, mean p set: 0.4526892900466919
loss_pred:0.0150044159963727, decouple_loss:0.00036368772271089256
The modified gen p mean: 0.450726181268692, gen p mean: -0.13003307580947876, mean p set: 0.45130228996276855
loss_pred:0.014204910025000572, decouple_loss:0.0004501202201936394
The modified gen p mean: 0.4505894184112549, gen p mean: -0.1307675987482071, mean p set: 0.4511641561985016
loss_pred:0.014028172940015793, decouple_loss:0.00041605817386880517
Iteration: 3575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517101049423218, gen p mean: -0.12655572593212128, mean p set: 0.45229020714759827
loss_pred:0.014669310301542282, decouple_loss:0.0005790441646240652
The modified gen p mean: 0.45261210203170776, gen p mean: -0.1278621405363083, mean p set: 0.45318663120269775
loss_pred:0.015119445510208607, decouple_loss:0.0005846667918376625
The modified gen p mean: 0.45125147700309753, gen p mean: -0.1179608628153801, mean p set: 0.45182904601097107
loss_pred:0.015457847155630589, decouple_loss:0.00036568930954672396
Iteration: 3576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538151025772095, gen p mean: -0.12793710827827454, mean p set: 0.45439326763153076
loss_pred:0.014445638284087181, decouple_loss:0.0005462311091832817
The modified gen p mean: 0.45127710700035095, gen p mean: -0.1280665248632431, mean p set: 0.4518548846244812
loss_pred:0.014951050281524658, decouple_loss:0.0004410016699694097
The modified gen p mean: 0.4521481990814209, gen p mean: -0.13236238062381744, mean p set: 0.4527256488800049
loss_pred:0.014440053142607212, decouple_loss:0.0004714934912044555
Iteration: 3577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504733979701996, gen p mean: -0.11849766969680786, mean p set: 0.4510493874549866
loss_pred:0.01560050155967474, decouple_loss:0.00045150684309192
The modified gen p mean: 0.45207011699676514, gen p mean: -0.1270776093006134, mean p set: 0.45264923572540283
loss_pred:0.014626716263592243, decouple_loss:0.0004647708556149155
The modified gen p mean: 0.4509265124797821, gen p mean: -0.12991730868816376, mean p set: 0.4515043795108795
loss_pred:0.015242409892380238, decouple_loss:0.0005700687179341912
Iteration: 3578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45355620980262756, gen p mean: -0.12921223044395447, mean p set: 0.4541351795196533
loss_pred:0.013761947862803936, decouple_loss:0.0003695232735481113
The modified gen p mean: 0.450868159532547, gen p mean: -0.12788502871990204, mean p set: 0.4514450132846832
The modified gen p mean: 0.45296019315719604, gen p mean: -0.1297742873430252, mean p set: 0.4535389542579651
loss_pred:0.015257584862411022, decouple_loss:0.0004618931852746755
loss_pred:0.014575152657926083, decouple_loss:0.0004212330677546561
Iteration: 3579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497618079185486, gen p mean: -0.12912803888320923, mean p set: 0.4503368139266968
loss_pred:0.01498773880302906, decouple_loss:0.0006809794576838613
The modified gen p mean: 0.4523122012615204, gen p mean: -0.131014883518219, mean p set: 0.4528883397579193
The modified gen p mean: 0.45262017846107483, gen p mean: -0.1268971860408783, mean p set: 0.4531993865966797
loss_pred:0.014010114595293999, decouple_loss:0.00040173015440814197
loss_pred:0.014723400585353374, decouple_loss:0.000488865771330893
Iteration: 3580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45098361372947693, gen p mean: -0.12703940272331238, mean p set: 0.4515630006790161
loss_pred:0.015415390953421593, decouple_loss:0.0005197434220463037
The modified gen p mean: 0.45237064361572266, gen p mean: -0.12923221290111542, mean p set: 0.45294755697250366
The modified gen p mean: 0.45088425278663635, gen p mean: -0.12662531435489655, mean p set: 0.45146000385284424
loss_pred:0.013901052065193653, decouple_loss:0.00045645778300240636
loss_pred:0.01425108127295971, decouple_loss:0.0004125656560063362
2023-05-02 17:23:55 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13713935017585754, mean p set: 0.4502691626548767
loss_pred:0.017096178606152534, decouple_loss:0.0004600585962180048
The modified gen p mean: 0.44953450560569763, gen p mean: -0.1299259066581726, mean p set: 0.4500633478164673
loss_pred:0.016306504607200623, decouple_loss:0.0004145826678723097
The modified gen p mean: 0.4498291015625, gen p mean: -0.12937599420547485, mean p set: 0.45035696029663086
loss_pred:0.01660466566681862, decouple_loss:0.0003663458628579974
WV_1_PC_1_EH_0_PS_40, loss: 0.01668979972600937, avg_mse: 0.02597535401582718
current test mse: 0.025975
Iteration: 3581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520544409751892, gen p mean: -0.12155895680189133, mean p set: 0.4526309072971344
loss_pred:0.014236366376280785, decouple_loss:0.0004421595949679613
The modified gen p mean: 0.45071884989738464, gen p mean: -0.12273000925779343, mean p set: 0.4512959122657776The modified gen p mean: 0.4513234794139862, gen p mean: -0.12103315442800522, mean p set: 0.4519002437591553
loss_pred:0.01396732684224844, decouple_loss:0.00038919009966775775
loss_pred:0.013720092363655567, decouple_loss:0.00038276848499663174
Iteration: 3582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45388364791870117, gen p mean: -0.11880338937044144, mean p set: 0.45446059107780457
loss_pred:0.013567178510129452, decouple_loss:0.000378267141059041
The modified gen p mean: 0.452107310295105, gen p mean: -0.1190020814538002, mean p set: 0.45268580317497253The modified gen p mean: 0.45212841033935547, gen p mean: -0.11925732344388962, mean p set: 0.45270848274230957
loss_pred:0.014681576751172543, decouple_loss:0.0003705254930537194
loss_pred:0.014647811651229858, decouple_loss:0.00034977018367499113
Iteration: 3583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523997902870178, gen p mean: -0.11340717226266861, mean p set: 0.45297735929489136
loss_pred:0.01387983001768589, decouple_loss:0.00042230135295540094
The modified gen p mean: 0.4516005516052246, gen p mean: -0.11276452988386154, mean p set: 0.4521775543689728
loss_pred:0.0151772266253829, decouple_loss:0.00042644585482776165
The modified gen p mean: 0.4521746337413788, gen p mean: -0.11452086269855499, mean p set: 0.45275095105171204
loss_pred:0.01386156864464283, decouple_loss:0.0004736536066047847
Iteration: 3584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521222412586212, gen p mean: -0.11666703224182129, mean p set: 0.45269855856895447
loss_pred:0.014144739136099815, decouple_loss:0.00040005394839681685The modified gen p mean: 0.4521670341491699, gen p mean: -0.11658712476491928, mean p set: 0.4527444541454315
loss_pred:0.014268563129007816, decouple_loss:0.0004279169370420277
The modified gen p mean: 0.45223289728164673, gen p mean: -0.11696235835552216, mean p set: 0.45281070470809937
loss_pred:0.014633683487772942, decouple_loss:0.0003462381719145924
Iteration: 3585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519130289554596, gen p mean: -0.12277870625257492, mean p set: 0.4524921178817749
loss_pred:0.01381363719701767, decouple_loss:0.0003720306558534503
The modified gen p mean: 0.45094481110572815, gen p mean: -0.12128584086894989, mean p set: 0.45152196288108826
loss_pred:0.01516279298812151, decouple_loss:0.0008279986795969307
The modified gen p mean: 0.45272690057754517, gen p mean: -0.11904367059469223, mean p set: 0.4533042907714844
loss_pred:0.014065030962228775, decouple_loss:0.0004834251885768026
Iteration: 3586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520129859447479, gen p mean: -0.12006516754627228, mean p set: 0.4525940418243408
loss_pred:0.014125989750027657, decouple_loss:0.0003193009179085493
The modified gen p mean: 0.4526153802871704, gen p mean: -0.11982737481594086, mean p set: 0.45319366455078125
The modified gen p mean: 0.4542355239391327, gen p mean: -0.11859351396560669, mean p set: 0.4548146724700928
loss_pred:0.01325353141874075, decouple_loss:0.0005031340988352895
loss_pred:0.01419728621840477, decouple_loss:0.0004160469106864184
Iteration: 3587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507496654987335, gen p mean: -0.11656877398490906, mean p set: 0.4513244330883026
loss_pred:0.014783293940126896, decouple_loss:0.0004427316307555884
The modified gen p mean: 0.45123085379600525, gen p mean: -0.11756826937198639, mean p set: 0.45180612802505493
The modified gen p mean: 0.4528447687625885, gen p mean: -0.11444549262523651, mean p set: 0.4534226953983307
loss_pred:0.014719046652317047, decouple_loss:0.0004412118869367987
loss_pred:0.013809101656079292, decouple_loss:0.00042954322998411953
Iteration: 3588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512622356414795, gen p mean: -0.11889351904392242, mean p set: 0.4518386423587799The modified gen p mean: 0.4510866701602936, gen p mean: -0.11364319920539856, mean p set: 0.4516623318195343
loss_pred:0.014987274073064327, decouple_loss:0.0005169016076251864
loss_pred:0.014596180059015751, decouple_loss:0.00042143213795498013
The modified gen p mean: 0.4526650905609131, gen p mean: -0.11765658110380173, mean p set: 0.45324259996414185
loss_pred:0.013986730948090553, decouple_loss:0.0005847127758897841
Iteration: 3589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044130086898804, gen p mean: -0.11596763879060745, mean p set: 0.4510186016559601
loss_pred:0.015127507038414478, decouple_loss:0.0004874822043348104
The modified gen p mean: 0.45141860842704773, gen p mean: -0.11445265263319016, mean p set: 0.4519941210746765
loss_pred:0.014606010168790817, decouple_loss:0.0004370930546429008
The modified gen p mean: 0.4507722854614258, gen p mean: -0.11389167606830597, mean p set: 0.4513503611087799
loss_pred:0.014904567040503025, decouple_loss:0.0004821864713449031
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
NaN value num: 0
Iteration: 3590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504395127296448, gen p mean: -0.12150222063064575, mean p set: 0.45101380348205566
The modified gen p mean: 0.4520375728607178, gen p mean: -0.1216835007071495, mean p set: 0.452614963054657
loss_pred:0.015180363319814205, decouple_loss:0.0005755272577516735
loss_pred:0.014674018137156963, decouple_loss:0.0004607255687005818
The modified gen p mean: 0.45023736357688904, gen p mean: -0.128928542137146, mean p set: 0.45081186294555664
loss_pred:0.01512325368821621, decouple_loss:0.00041408074321225286
2023-05-02 17:26:41 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13505946099758148, mean p set: 0.4502691626548767
loss_pred:0.017000094056129456, decouple_loss:0.0005423145485110581
The modified gen p mean: 0.4495335519313812, gen p mean: -0.12758983671665192, mean p set: 0.4500633478164673
loss_pred:0.016283325850963593, decouple_loss:0.0004775039560627192
The modified gen p mean: 0.44982850551605225, gen p mean: -0.12669585645198822, mean p set: 0.45035696029663086
loss_pred:0.0165701974183321, decouple_loss:0.0005784883978776634
WV_1_PC_1_EH_0_PS_40, loss: 0.016644511371850967, avg_mse: 0.025918757542967796
current test mse: 0.025919
Iteration: 3591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044997334480286, gen p mean: -0.12300745397806168, mean p set: 0.45102712512016296
loss_pred:0.015118509531021118, decouple_loss:0.00071172189200297
The modified gen p mean: 0.4535187780857086, gen p mean: -0.12424114346504211, mean p set: 0.45409834384918213
loss_pred:0.014593703672289848, decouple_loss:0.0006563930655829608
The modified gen p mean: 0.4505345821380615, gen p mean: -0.12086460739374161, mean p set: 0.45110899209976196
loss_pred:0.015184294432401657, decouple_loss:0.000493772211484611
Iteration: 3592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517383277416229, gen p mean: -0.12008000910282135, mean p set: 0.4523157775402069
The modified gen p mean: 0.4502156674861908, gen p mean: -0.12211419641971588, mean p set: 0.45079126954078674loss_pred:0.015217744745314121, decouple_loss:0.0008159737917594612
loss_pred:0.015233544632792473, decouple_loss:0.0006027020863257349
The modified gen p mean: 0.45231372117996216, gen p mean: -0.12202802300453186, mean p set: 0.4528922438621521
loss_pred:0.014564788900315762, decouple_loss:0.000549214193597436
Iteration: 3593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45022961497306824, gen p mean: -0.11597967147827148, mean p set: 0.4508056044578552
loss_pred:0.014998098835349083, decouple_loss:0.0003667783457785845
The modified gen p mean: 0.45196062326431274, gen p mean: -0.1139240562915802, mean p set: 0.4525359272956848
loss_pred:0.014744218438863754, decouple_loss:0.0005334506276994944
The modified gen p mean: 0.451691597700119, gen p mean: -0.11663699150085449, mean p set: 0.45226943492889404
loss_pred:0.01456007082015276, decouple_loss:0.00045610073721036315
Iteration: 3594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494347870349884, gen p mean: -0.11597434431314468, mean p set: 0.4500125050544739
loss_pred:0.015028596855700016, decouple_loss:0.0005483974819071591
The modified gen p mean: 0.4526641368865967, gen p mean: -0.11715065687894821, mean p set: 0.45323994755744934
loss_pred:0.015017806552350521, decouple_loss:0.0004829664248973131
The modified gen p mean: 0.4502866864204407, gen p mean: -0.12209393829107285, mean p set: 0.4508635997772217
loss_pred:0.014865179546177387, decouple_loss:0.0005769431008957326
Iteration: 3595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45155957341194153, gen p mean: -0.1102900505065918, mean p set: 0.4521334171295166
loss_pred:0.014268085360527039, decouple_loss:0.000676516501698643
The modified gen p mean: 0.45223507285118103, gen p mean: -0.1124962642788887, mean p set: 0.4528115391731262
loss_pred:0.015277530066668987, decouple_loss:0.000499135407153517
The modified gen p mean: 0.4507204294204712, gen p mean: -0.10639138519763947, mean p set: 0.45129746198654175
loss_pred:0.015591521747410297, decouple_loss:0.00045099560520611703
Iteration: 3596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501621425151825, gen p mean: -0.11354523152112961, mean p set: 0.4507386088371277
loss_pred:0.014476791955530643, decouple_loss:0.00042805398697964847
The modified gen p mean: 0.4507942795753479, gen p mean: -0.11278192698955536, mean p set: 0.4513719379901886
The modified gen p mean: 0.4512748420238495, gen p mean: -0.10835864394903183, mean p set: 0.4518507122993469
loss_pred:0.014967815950512886, decouple_loss:0.0005598800489678979
loss_pred:0.015411991626024246, decouple_loss:0.00034402095479890704
Iteration: 3597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519001841545105, gen p mean: -0.11265993863344193, mean p set: 0.45247623324394226
loss_pred:0.015189750120043755, decouple_loss:0.00045561528531834483
The modified gen p mean: 0.4528152644634247, gen p mean: -0.11079481244087219, mean p set: 0.45339396595954895
loss_pred:0.01509021781384945, decouple_loss:0.000549055403098464
The modified gen p mean: 0.45317837595939636, gen p mean: -0.11757944524288177, mean p set: 0.45375579595565796
loss_pred:0.01453427691012621, decouple_loss:0.0004327854549046606
Iteration: 3598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519144892692566, gen p mean: -0.11269110441207886, mean p set: 0.4524913430213928
loss_pred:0.01549484021961689, decouple_loss:0.0005071883788332343
The modified gen p mean: 0.4514750838279724, gen p mean: -0.11370427161455154, mean p set: 0.4520528018474579
loss_pred:0.01512765884399414, decouple_loss:0.0005013890913687646
The modified gen p mean: 0.4501437544822693, gen p mean: -0.11291973292827606, mean p set: 0.45072096586227417
loss_pred:0.015024574473500252, decouple_loss:0.0004394093994051218
Iteration: 3599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121490955352783, gen p mean: -0.11005618423223495, mean p set: 0.4517900347709656
loss_pred:0.014092618599534035, decouple_loss:0.0006437081610783935
The modified gen p mean: 0.4516330361366272, gen p mean: -0.11046315729618073, mean p set: 0.4522095024585724
loss_pred:0.014835065230727196, decouple_loss:0.0003674856561701745
The modified gen p mean: 0.4520917236804962, gen p mean: -0.10309688001871109, mean p set: 0.4526708722114563
loss_pred:0.01400712225586176, decouple_loss:0.0005515461089089513
Iteration: 3600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45206955075263977, gen p mean: -0.10800311714410782, mean p set: 0.452647864818573
loss_pred:0.014559170231223106, decouple_loss:0.00045320671051740646
The modified gen p mean: 0.45341116189956665, gen p mean: -0.11520397663116455, mean p set: 0.4539874494075775
The modified gen p mean: 0.45287737250328064, gen p mean: -0.1128414198756218, mean p set: 0.4534553289413452
loss_pred:0.014330198988318443, decouple_loss:0.000688824919052422
loss_pred:0.01438559778034687, decouple_loss:0.0005639690789394081
2023-05-02 17:28:49 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12588530778884888, mean p set: 0.4502691626548767
loss_pred:0.0169785488396883, decouple_loss:0.0004951510345563293
The modified gen p mean: 0.44953760504722595, gen p mean: -0.11855393648147583, mean p set: 0.4500633478164673
loss_pred:0.01633407175540924, decouple_loss:0.0004591892065946013
The modified gen p mean: 0.44983014464378357, gen p mean: -0.11762698739767075, mean p set: 0.45035696029663086
loss_pred:0.016572505235671997, decouple_loss:0.00043084684875793755
WV_1_PC_1_EH_0_PS_40, loss: 0.016651462763547897, avg_mse: 0.025874586775898933
current test mse: 0.025875
Iteration: 3601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505285918712616, gen p mean: -0.11531141400337219, mean p set: 0.4511038064956665
loss_pred:0.014306241646409035, decouple_loss:0.00043845007894560695
The modified gen p mean: 0.4531853199005127, gen p mean: -0.1140577420592308, mean p set: 0.45376312732696533The modified gen p mean: 0.45162004232406616, gen p mean: -0.11047689616680145, mean p set: 0.45219701528549194
loss_pred:0.01430480182170868, decouple_loss:0.00039865137659944594
loss_pred:0.015242005698382854, decouple_loss:0.0003522998886182904
Iteration: 3602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511687457561493, gen p mean: -0.11606772989034653, mean p set: 0.45174357295036316
loss_pred:0.01491468958556652, decouple_loss:0.00034916287404485047
The modified gen p mean: 0.450503945350647, gen p mean: -0.1204209104180336, mean p set: 0.45107758045196533The modified gen p mean: 0.4519251585006714, gen p mean: -0.11590994894504547, mean p set: 0.45250123739242554
loss_pred:0.014548016712069511, decouple_loss:0.0003410229692235589loss_pred:0.014536996372044086, decouple_loss:0.0003773969365283847
Iteration: 3603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505716562271118, gen p mean: -0.11652103811502457, mean p set: 0.45114725828170776
loss_pred:0.014554902911186218, decouple_loss:0.00035196414683014154
The modified gen p mean: 0.4495607316493988, gen p mean: -0.11925926059484482, mean p set: 0.45013684034347534The modified gen p mean: 0.44838178157806396, gen p mean: -0.12116944044828415, mean p set: 0.44895628094673157
loss_pred:0.01502854935824871, decouple_loss:0.0003339265240356326
loss_pred:0.015100105665624142, decouple_loss:0.0003882345336023718
Iteration: 3604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499276578426361, gen p mean: -0.12302310019731522, mean p set: 0.4505026042461395
loss_pred:0.01508929580450058, decouple_loss:0.00033513273228891194
The modified gen p mean: 0.4532731771469116, gen p mean: -0.12179549038410187, mean p set: 0.4538503587245941
loss_pred:0.014159043319523335, decouple_loss:0.00036927915061824024
The modified gen p mean: 0.4499998390674591, gen p mean: -0.12430271506309509, mean p set: 0.4505784809589386
loss_pred:0.01516477670520544, decouple_loss:0.0003311679174657911
Iteration: 3605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45213809609413147, gen p mean: -0.1136079728603363, mean p set: 0.4527163803577423
loss_pred:0.015195774845778942, decouple_loss:0.0003582286590244621
The modified gen p mean: 0.45059874653816223, gen p mean: -0.11278029531240463, mean p set: 0.45117518305778503
loss_pred:0.013917187228798866, decouple_loss:0.0004049261915497482
The modified gen p mean: 0.451649934053421, gen p mean: -0.10959337651729584, mean p set: 0.4522283971309662
loss_pred:0.014642913825809956, decouple_loss:0.00044606890878640115
Iteration: 3606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45263606309890747, gen p mean: -0.11087191104888916, mean p set: 0.453212171792984
The modified gen p mean: 0.4519200921058655, gen p mean: -0.11295562982559204, mean p set: 0.45249712467193604
loss_pred:0.015023521147668362, decouple_loss:0.00039826767169870436
loss_pred:0.014431269839406013, decouple_loss:0.00037114325095899403
The modified gen p mean: 0.4533633887767792, gen p mean: -0.11074957251548767, mean p set: 0.4539388418197632
loss_pred:0.014548356644809246, decouple_loss:0.00038098107324913144
Iteration: 3607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519166648387909, gen p mean: -0.09837944805622101, mean p set: 0.4524938464164734
loss_pred:0.014594093896448612, decouple_loss:0.0006217049085535109
The modified gen p mean: 0.4505891501903534, gen p mean: -0.10715098679065704, mean p set: 0.45116573572158813
The modified gen p mean: 0.44902318716049194, gen p mean: -0.10491065680980682, mean p set: 0.4495995044708252
loss_pred:0.014356255531311035, decouple_loss:0.0004573743208311498
loss_pred:0.015194235369563103, decouple_loss:0.0004480467177927494
Iteration: 3608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931384921073914, gen p mean: -0.10478872805833817, mean p set: 0.44988977909088135
The modified gen p mean: 0.4493575394153595, gen p mean: -0.09844446927309036, mean p set: 0.4499339163303375
loss_pred:0.015103660523891449, decouple_loss:0.00033511692890897393
loss_pred:0.01542673259973526, decouple_loss:0.0003202996158506721
The modified gen p mean: 0.45146632194519043, gen p mean: -0.09574153274297714, mean p set: 0.4520423710346222
loss_pred:0.014200950972735882, decouple_loss:0.0002795658365357667
Iteration: 3609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507463872432709, gen p mean: -0.10332420468330383, mean p set: 0.4513225853443146
The modified gen p mean: 0.45282647013664246, gen p mean: -0.09878315776586533, mean p set: 0.45340198278427124
loss_pred:0.0145459845662117, decouple_loss:0.0003936051216442138
loss_pred:0.014728923328220844, decouple_loss:0.0005458031082525849
The modified gen p mean: 0.45030954480171204, gen p mean: -0.10388829559087753, mean p set: 0.450886607170105
loss_pred:0.014952483586966991, decouple_loss:0.0005374932079575956
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
NaN value num: 0
Iteration: 3610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45093849301338196, gen p mean: -0.11050888150930405, mean p set: 0.45151469111442566
loss_pred:0.015715716406702995, decouple_loss:0.0004923631786368787
The modified gen p mean: 0.4506188631057739, gen p mean: -0.11468551307916641, mean p set: 0.45119625329971313
The modified gen p mean: 0.4501887261867523, gen p mean: -0.10666017234325409, mean p set: 0.4507652819156647
loss_pred:0.016014406457543373, decouple_loss:0.000550731725525111
loss_pred:0.015344247221946716, decouple_loss:0.0005788637790828943
2023-05-02 17:31:31 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11124665290117264, mean p set: 0.4502691626548767
loss_pred:0.016922762617468834, decouple_loss:0.0005812825984321535
The modified gen p mean: 0.4495353698730469, gen p mean: -0.10510749369859695, mean p set: 0.4500633478164673
loss_pred:0.01628759317100048, decouple_loss:0.0004329780349507928
The modified gen p mean: 0.44982895255088806, gen p mean: -0.10409644991159439, mean p set: 0.45035696029663086
loss_pred:0.016564849764108658, decouple_loss:0.0004062750085722655
WV_1_PC_1_EH_0_PS_40, loss: 0.01661541312932968, avg_mse: 0.025833917781710625
current test mse: 0.025834
Iteration: 3611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527994692325592, gen p mean: -0.10201989859342575, mean p set: 0.45337799191474915
loss_pred:0.014444643631577492, decouple_loss:0.00047790512326173484
The modified gen p mean: 0.4497947692871094, gen p mean: -0.1055404543876648, mean p set: 0.45037373900413513The modified gen p mean: 0.4508753716945648, gen p mean: -0.106287881731987, mean p set: 0.45144885778427124
loss_pred:0.01533864438533783, decouple_loss:0.0003767673624679446loss_pred:0.015778159722685814, decouple_loss:0.0004102935781702399
Iteration: 3612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503489136695862, gen p mean: -0.10245200991630554, mean p set: 0.45092687010765076
loss_pred:0.014938240870833397, decouple_loss:0.00034140379284508526
The modified gen p mean: 0.45091864466667175, gen p mean: -0.10095798224210739, mean p set: 0.45149579644203186The modified gen p mean: 0.44998008012771606, gen p mean: -0.09633863717317581, mean p set: 0.4505557417869568
loss_pred:0.015519078820943832, decouple_loss:0.0003368677571415901
loss_pred:0.015224193222820759, decouple_loss:0.0005154887912794948
Iteration: 3613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45265984535217285, gen p mean: -0.10479490458965302, mean p set: 0.45323646068573
loss_pred:0.014479207806289196, decouple_loss:0.00040951944538392127
The modified gen p mean: 0.4508647918701172, gen p mean: -0.10995841026306152, mean p set: 0.45144200325012207
loss_pred:0.015075700357556343, decouple_loss:0.00033136835554614663
The modified gen p mean: 0.4519578516483307, gen p mean: -0.10468119382858276, mean p set: 0.45253270864486694
loss_pred:0.015468514524400234, decouple_loss:0.0003423340094741434
Iteration: 3614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497593343257904, gen p mean: -0.1065090224146843, mean p set: 0.4503386318683624
loss_pred:0.016030127182602882, decouple_loss:0.0006317502120509744
The modified gen p mean: 0.4505566656589508, gen p mean: -0.10600027441978455, mean p set: 0.4511338472366333
loss_pred:0.014995943754911423, decouple_loss:0.0004352041578385979
The modified gen p mean: 0.4494960904121399, gen p mean: -0.10287618637084961, mean p set: 0.4500739574432373
loss_pred:0.014863994903862476, decouple_loss:0.00048093567602336407
Iteration: 3615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44894152879714966, gen p mean: -0.11117344349622726, mean p set: 0.4495201110839844
loss_pred:0.015176111832261086, decouple_loss:0.0003306124417576939
The modified gen p mean: 0.44848716259002686, gen p mean: -0.11111843585968018, mean p set: 0.4490624964237213
loss_pred:0.015595066361129284, decouple_loss:0.00043373293010517955
The modified gen p mean: 0.4484636187553406, gen p mean: -0.11194061487913132, mean p set: 0.44904032349586487
loss_pred:0.01570349559187889, decouple_loss:0.000429545936640352
Iteration: 3616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508381485939026, gen p mean: -0.12121304869651794, mean p set: 0.4514155089855194
loss_pred:0.015018950216472149, decouple_loss:0.00032151429331861436
The modified gen p mean: 0.4487679898738861, gen p mean: -0.11943963170051575, mean p set: 0.4493427276611328
loss_pred:0.01599125936627388, decouple_loss:0.0003726304857991636
The modified gen p mean: 0.44946038722991943, gen p mean: -0.12716741859912872, mean p set: 0.45003804564476013
loss_pred:0.014909272082149982, decouple_loss:0.00035452493466436863
Iteration: 3617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45285674929618835, gen p mean: -0.1135248988866806, mean p set: 0.4534335732460022
loss_pred:0.014169071801006794, decouple_loss:0.0006241962546482682
The modified gen p mean: 0.45241579413414, gen p mean: -0.11387843638658524, mean p set: 0.45299485325813293
The modified gen p mean: 0.4518817365169525, gen p mean: -0.1155657023191452, mean p set: 0.45245808362960815
loss_pred:0.01565786637365818, decouple_loss:0.0006391156348399818
loss_pred:0.014192381873726845, decouple_loss:0.0003992253914475441
Iteration: 3618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507722854614258, gen p mean: -0.11051134765148163, mean p set: 0.45134952664375305
loss_pred:0.016271298751235008, decouple_loss:0.00034587920526973903
The modified gen p mean: 0.4492870271205902, gen p mean: -0.10428795218467712, mean p set: 0.4498651623725891
The modified gen p mean: 0.44862818717956543, gen p mean: -0.1092042550444603, mean p set: 0.4492030143737793
loss_pred:0.01632249355316162, decouple_loss:0.00032568330061621964
loss_pred:0.01617738977074623, decouple_loss:0.0003860086144413799
Iteration: 3619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495795667171478, gen p mean: -0.10976734012365341, mean p set: 0.45015794038772583
loss_pred:0.015717286616563797, decouple_loss:0.00028718088287860155
The modified gen p mean: 0.44929710030555725, gen p mean: -0.10468035936355591, mean p set: 0.4498754143714905
The modified gen p mean: 0.4493978023529053, gen p mean: -0.1051044911146164, mean p set: 0.4499734938144684
loss_pred:0.01599583588540554, decouple_loss:0.0003005736507475376
loss_pred:0.01605847105383873, decouple_loss:0.0003344101132825017
Iteration: 3620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978711009025574, gen p mean: -0.12246474623680115, mean p set: 0.4503653943538666
loss_pred:0.01527758501470089, decouple_loss:0.0004471110587473959
The modified gen p mean: 0.4501568078994751, gen p mean: -0.12262828648090363, mean p set: 0.4507328271865845
The modified gen p mean: 0.44926103949546814, gen p mean: -0.12282740324735641, mean p set: 0.4498375654220581
loss_pred:0.01543388981372118, decouple_loss:0.0004262287693563849
loss_pred:0.015413635410368443, decouple_loss:0.0003988778335042298
2023-05-02 17:33:38 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1259509176015854, mean p set: 0.4502691626548767
loss_pred:0.017274009063839912, decouple_loss:0.0004294386017136276
The modified gen p mean: 0.44953468441963196, gen p mean: -0.11972310394048691, mean p set: 0.4500633478164673
The modified gen p mean: 0.4498288333415985, gen p mean: -0.11899509280920029, mean p set: 0.45035696029663086
loss_pred:0.01654287613928318, decouple_loss:0.0004416520241647959
loss_pred:0.01683901436626911, decouple_loss:0.00037977247848175466
WV_1_PC_1_EH_0_PS_40, loss: 0.016906147822737694, avg_mse: 0.026373714208602905
current test mse: 0.026374
Iteration: 3621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44826623797416687, gen p mean: -0.119815394282341, mean p set: 0.4488401710987091
loss_pred:0.015716008841991425, decouple_loss:0.00043309637112542987
The modified gen p mean: 0.4494781196117401, gen p mean: -0.11807993054389954, mean p set: 0.4500502049922943The modified gen p mean: 0.45026078820228577, gen p mean: -0.11565238237380981, mean p set: 0.4508368670940399
loss_pred:0.01522511150687933, decouple_loss:0.00032420799834653735
loss_pred:0.014632506296038628, decouple_loss:0.0003591670247260481
Iteration: 3622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963231682777405, gen p mean: -0.12728670239448547, mean p set: 0.45020779967308044
loss_pred:0.01522405631840229, decouple_loss:0.0004577802901621908
The modified gen p mean: 0.44922685623168945, gen p mean: -0.12974216043949127, mean p set: 0.44980570673942566The modified gen p mean: 0.45039796829223633, gen p mean: -0.12320998311042786, mean p set: 0.45097532868385315
loss_pred:0.015174414962530136, decouple_loss:0.00032714559347368777
loss_pred:0.015014437027275562, decouple_loss:0.00039182548061944544
Iteration: 3623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500865638256073, gen p mean: -0.13477472960948944, mean p set: 0.450665146112442
loss_pred:0.015006761997938156, decouple_loss:0.00042150577064603567
The modified gen p mean: 0.45046576857566833, gen p mean: -0.1324060708284378, mean p set: 0.45104163885116577The modified gen p mean: 0.4527336359024048, gen p mean: -0.12861031293869019, mean p set: 0.45331335067749023
loss_pred:0.015171308070421219, decouple_loss:0.00034947507083415985loss_pred:0.014432718977332115, decouple_loss:0.00041626827442087233
Iteration: 3624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925057888031006, gen p mean: -0.1251872479915619, mean p set: 0.449828565120697
loss_pred:0.015755902975797653, decouple_loss:0.00042993383249267936
The modified gen p mean: 0.45179283618927, gen p mean: -0.13450351357460022, mean p set: 0.45236724615097046
loss_pred:0.015071425586938858, decouple_loss:0.0004381623584777117
The modified gen p mean: 0.44973045587539673, gen p mean: -0.13109613955020905, mean p set: 0.45030441880226135
loss_pred:0.015537113882601261, decouple_loss:0.000509836187120527
Iteration: 3625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44991472363471985, gen p mean: -0.12268330156803131, mean p set: 0.4504922032356262
loss_pred:0.015528076328337193, decouple_loss:0.0004843799979425967
The modified gen p mean: 0.45100539922714233, gen p mean: -0.1234138235449791, mean p set: 0.4515804052352905
loss_pred:0.014806179329752922, decouple_loss:0.0003894217952620238
The modified gen p mean: 0.45003530383110046, gen p mean: -0.1246224120259285, mean p set: 0.45061448216438293
loss_pred:0.015080088749527931, decouple_loss:0.0004350924864411354
Iteration: 3626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525001049041748, gen p mean: -0.10881607979536057, mean p set: 0.4530760943889618
loss_pred:0.01408382598310709, decouple_loss:0.0005775968311354518
The modified gen p mean: 0.4518745243549347, gen p mean: -0.10747234523296356, mean p set: 0.45245006680488586
loss_pred:0.014728064648807049, decouple_loss:0.00048127849004231393
The modified gen p mean: 0.4498708248138428, gen p mean: -0.1100822240114212, mean p set: 0.4504478871822357
loss_pred:0.015528717078268528, decouple_loss:0.000455728848464787
Iteration: 3627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45321124792099, gen p mean: -0.11003021150827408, mean p set: 0.4537888467311859
loss_pred:0.015374423936009407, decouple_loss:0.0005579944117926061
The modified gen p mean: 0.44842398166656494, gen p mean: -0.11764173209667206, mean p set: 0.44900277256965637
loss_pred:0.016564808785915375, decouple_loss:0.00039349248982034624
The modified gen p mean: 0.45034804940223694, gen p mean: -0.11317963898181915, mean p set: 0.4509235620498657
loss_pred:0.015605106949806213, decouple_loss:0.0004897795733995736
Iteration: 3628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45239490270614624, gen p mean: -0.11698510497808456, mean p set: 0.4529707729816437The modified gen p mean: 0.45032358169555664, gen p mean: -0.11362868547439575, mean p set: 0.45089974999427795
loss_pred:0.014730404131114483, decouple_loss:0.0005335065070539713
loss_pred:0.014888850040733814, decouple_loss:0.0005597948911599815
The modified gen p mean: 0.44996029138565063, gen p mean: -0.11377400904893875, mean p set: 0.4505384862422943
loss_pred:0.015058616176247597, decouple_loss:0.0004326804482843727
Iteration: 3629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892534613609314, gen p mean: -0.12059871852397919, mean p set: 0.4495016634464264
The modified gen p mean: 0.4479871392250061, gen p mean: -0.1164945736527443, mean p set: 0.44856053590774536
loss_pred:0.016275502741336823, decouple_loss:0.0004585788119584322
loss_pred:0.015984859317541122, decouple_loss:0.0003653644525911659
The modified gen p mean: 0.4480845034122467, gen p mean: -0.11795984208583832, mean p set: 0.4486609697341919
loss_pred:0.015822065994143486, decouple_loss:0.0003383280709385872
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
NaN value num: 0
Iteration: 3630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491780996322632, gen p mean: -0.12714621424674988, mean p set: 0.4497537314891815
loss_pred:0.014751192182302475, decouple_loss:0.00040054519195109606
The modified gen p mean: 0.4482789933681488, gen p mean: -0.12771950662136078, mean p set: 0.44885390996932983
The modified gen p mean: 0.4479833245277405, gen p mean: -0.12400442361831665, mean p set: 0.44855889678001404
loss_pred:0.014367537572979927, decouple_loss:0.0004482406657189131
loss_pred:0.015013493597507477, decouple_loss:0.0004539678629953414
2023-05-02 17:36:19 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13153353333473206, mean p set: 0.4502691626548767
loss_pred:0.017081471160054207, decouple_loss:0.0005646675708703697
The modified gen p mean: 0.4495357871055603, gen p mean: -0.12459563463926315, mean p set: 0.4500633478164673
loss_pred:0.016292626038193703, decouple_loss:0.00044364179484546185
The modified gen p mean: 0.44983071088790894, gen p mean: -0.12352476269006729, mean p set: 0.45035696029663086
loss_pred:0.016626622527837753, decouple_loss:0.00035315396962687373
WV_1_PC_1_EH_0_PS_40, loss: 0.016689598560333252, avg_mse: 0.025965262204408646
current test mse: 0.025965
Iteration: 3631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509589374065399, gen p mean: -0.11359899491071701, mean p set: 0.451536625623703
loss_pred:0.015304237604141235, decouple_loss:0.0004209047765471041
The modified gen p mean: 0.4499889016151428, gen p mean: -0.12406305223703384, mean p set: 0.45056405663490295The modified gen p mean: 0.44825661182403564, gen p mean: -0.11719805747270584, mean p set: 0.44883257150650024
loss_pred:0.01553852017968893, decouple_loss:0.00046921579632908106
loss_pred:0.014516598545014858, decouple_loss:0.00043330216431058943
Iteration: 3632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514555037021637, gen p mean: -0.11606717109680176, mean p set: 0.4520305097103119
loss_pred:0.014448135159909725, decouple_loss:0.0004145485581830144
The modified gen p mean: 0.449187695980072, gen p mean: -0.11504898965358734, mean p set: 0.44976580142974854The modified gen p mean: 0.4477701485157013, gen p mean: -0.11728057265281677, mean p set: 0.4483462870121002
loss_pred:0.015537195838987827, decouple_loss:0.00046215069596655667
loss_pred:0.014881263487040997, decouple_loss:0.0003584162623155862
Iteration: 3633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514366388320923, gen p mean: -0.11691280454397202, mean p set: 0.4520123302936554
loss_pred:0.014683200977742672, decouple_loss:0.0004934768076054752
The modified gen p mean: 0.4472406208515167, gen p mean: -0.12239816039800644, mean p set: 0.4478166699409485
loss_pred:0.015587599948048592, decouple_loss:0.0003692904720082879
The modified gen p mean: 0.44919753074645996, gen p mean: -0.11276981234550476, mean p set: 0.44977399706840515
loss_pred:0.01553605031222105, decouple_loss:0.0004170365573372692
Iteration: 3634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001018047332764, gen p mean: -0.11162762343883514, mean p set: 0.4505856931209564
loss_pred:0.015423172153532505, decouple_loss:0.00045111076906323433
The modified gen p mean: 0.44718268513679504, gen p mean: -0.1159823089838028, mean p set: 0.44775813817977905
loss_pred:0.014994687400758266, decouple_loss:0.00037943365168757737
The modified gen p mean: 0.4507560133934021, gen p mean: -0.11618971079587936, mean p set: 0.45133325457572937
loss_pred:0.015295053832232952, decouple_loss:0.0006081043393351138
Iteration: 3635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493362009525299, gen p mean: -0.11450918018817902, mean p set: 0.44991356134414673
loss_pred:0.015522010624408722, decouple_loss:0.00041413839790038764
The modified gen p mean: 0.44998204708099365, gen p mean: -0.11023391038179398, mean p set: 0.4505615830421448
loss_pred:0.014904368668794632, decouple_loss:0.0005607375060208142
The modified gen p mean: 0.44946759939193726, gen p mean: -0.11538050323724747, mean p set: 0.4500448405742645
loss_pred:0.015002449043095112, decouple_loss:0.0005036903312429786
Iteration: 3636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973599910736084, gen p mean: -0.11430317908525467, mean p set: 0.4503127932548523
loss_pred:0.014562858268618584, decouple_loss:0.0003610863641370088
The modified gen p mean: 0.45127153396606445, gen p mean: -0.11750837415456772, mean p set: 0.4518480598926544
loss_pred:0.013910488225519657, decouple_loss:0.00046638850471936166
The modified gen p mean: 0.45153263211250305, gen p mean: -0.12344148010015488, mean p set: 0.4521084129810333
loss_pred:0.015274450182914734, decouple_loss:0.0004980945377610624
Iteration: 3637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45031166076660156, gen p mean: -0.12372569739818573, mean p set: 0.4508877694606781
loss_pred:0.015203018672764301, decouple_loss:0.000556496437638998
The modified gen p mean: 0.4486064910888672, gen p mean: -0.1207302063703537, mean p set: 0.4491817057132721
loss_pred:0.014084008522331715, decouple_loss:0.00035676604602485895
The modified gen p mean: 0.4474561810493469, gen p mean: -0.11953772604465485, mean p set: 0.44803333282470703
loss_pred:0.014624607749283314, decouple_loss:0.00041574047645553946
Iteration: 3638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515933394432068, gen p mean: -0.12881793081760406, mean p set: 0.45216912031173706
loss_pred:0.01502575445920229, decouple_loss:0.00044534614426083863
The modified gen p mean: 0.44720572233200073, gen p mean: -0.1306798756122589, mean p set: 0.44778314232826233
loss_pred:0.015439298935234547, decouple_loss:0.0006084394990466535
The modified gen p mean: 0.4501221477985382, gen p mean: -0.1254289746284485, mean p set: 0.45069968700408936
loss_pred:0.014164869673550129, decouple_loss:0.00046204295358620584
Iteration: 3639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44748231768608093, gen p mean: -0.13238896429538727, mean p set: 0.44805923104286194
loss_pred:0.014587697573006153, decouple_loss:0.0005534375086426735
The modified gen p mean: 0.44831523299217224, gen p mean: -0.1242845207452774, mean p set: 0.44889137148857117
loss_pred:0.015609806403517723, decouple_loss:0.00040566959069110453
The modified gen p mean: 0.4486413300037384, gen p mean: -0.12460371106863022, mean p set: 0.44921693205833435
loss_pred:0.01566329598426819, decouple_loss:0.0004790456732735038
Iteration: 3640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471544325351715, gen p mean: -0.12467741221189499, mean p set: 0.44773074984550476
loss_pred:0.01489314716309309, decouple_loss:0.0003660719667095691
The modified gen p mean: 0.4501122534275055, gen p mean: -0.12272518128156662, mean p set: 0.4506881833076477
The modified gen p mean: 0.45208632946014404, gen p mean: -0.131065234541893, mean p set: 0.4526605010032654
loss_pred:0.014836497604846954, decouple_loss:0.00044845775119028986
loss_pred:0.014431308023631573, decouple_loss:0.0005314509035088122
2023-05-02 17:38:25 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12902027368545532, mean p set: 0.4502691626548767
loss_pred:0.017067017033696175, decouple_loss:0.0004833449493162334
The modified gen p mean: 0.4495340585708618, gen p mean: -0.12300380319356918, mean p set: 0.4500633478164673
loss_pred:0.016309166327118874, decouple_loss:0.0004298033018130809
The modified gen p mean: 0.44982826709747314, gen p mean: -0.12139071524143219, mean p set: 0.45035696029663086
loss_pred:0.016559304669499397, decouple_loss:0.0005580015713348985
WV_1_PC_1_EH_0_PS_40, loss: 0.016669683158397675, avg_mse: 0.025974348187446594
current test mse: 0.025974
Iteration: 3641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44985726475715637, gen p mean: -0.11452063918113708, mean p set: 0.4504333436489105
loss_pred:0.014510896988213062, decouple_loss:0.0005429282900877297
The modified gen p mean: 0.45218324661254883, gen p mean: -0.1228325292468071, mean p set: 0.4527588486671448The modified gen p mean: 0.44904953241348267, gen p mean: -0.11686302721500397, mean p set: 0.44962644577026367
loss_pred:0.014438723213970661, decouple_loss:0.0004061044310219586loss_pred:0.014888165518641472, decouple_loss:0.0006229670252650976
Iteration: 3642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904017448425293, gen p mean: -0.11181184649467468, mean p set: 0.44961604475975037
loss_pred:0.01464046724140644, decouple_loss:0.000369151181075722
The modified gen p mean: 0.4485597014427185, gen p mean: -0.10590394586324692, mean p set: 0.449136883020401The modified gen p mean: 0.44811689853668213, gen p mean: -0.11041676253080368, mean p set: 0.44869256019592285
loss_pred:0.015600389800965786, decouple_loss:0.0003925185010302812
loss_pred:0.014757398515939713, decouple_loss:0.0004784499469678849
Iteration: 3643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496804177761078, gen p mean: -0.11318536847829819, mean p set: 0.45025739073753357
loss_pred:0.015771783888339996, decouple_loss:0.0005383348907344043
The modified gen p mean: 0.4498688280582428, gen p mean: -0.1107410416007042, mean p set: 0.4504449665546417
loss_pred:0.015428039245307446, decouple_loss:0.0003979982284363359
The modified gen p mean: 0.4504450857639313, gen p mean: -0.10780946910381317, mean p set: 0.45102187991142273
loss_pred:0.014968732371926308, decouple_loss:0.0005097182001918554
Iteration: 3644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747036695480347, gen p mean: -0.1093040257692337, mean p set: 0.4480479061603546
loss_pred:0.015226341784000397, decouple_loss:0.00036990275839343667
The modified gen p mean: 0.45016056299209595, gen p mean: -0.10533741116523743, mean p set: 0.45073726773262024
loss_pred:0.01501323189586401, decouple_loss:0.0006911264499649405
The modified gen p mean: 0.4490663409233093, gen p mean: -0.10218697786331177, mean p set: 0.4496413469314575
loss_pred:0.015596636570990086, decouple_loss:0.00039347316487692297
Iteration: 3645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495098292827606, gen p mean: -0.10832933336496353, mean p set: 0.4500843286514282
loss_pred:0.015421171672642231, decouple_loss:0.0003730910539161414
The modified gen p mean: 0.4512738287448883, gen p mean: -0.10678284615278244, mean p set: 0.45185160636901855
loss_pred:0.015582052990794182, decouple_loss:0.00038525357376784086
The modified gen p mean: 0.44803011417388916, gen p mean: -0.10955241322517395, mean p set: 0.4486050307750702
loss_pred:0.015096249058842659, decouple_loss:0.0004206420562695712
Iteration: 3646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495944380760193, gen p mean: -0.10969643294811249, mean p set: 0.45017069578170776
loss_pred:0.014675574377179146, decouple_loss:0.0003932837280444801
The modified gen p mean: 0.44990336894989014, gen p mean: -0.11173035204410553, mean p set: 0.45047977566719055
loss_pred:0.014150415547192097, decouple_loss:0.00038951353053562343
The modified gen p mean: 0.4499970078468323, gen p mean: -0.10928694158792496, mean p set: 0.45057329535484314
loss_pred:0.015307903289794922, decouple_loss:0.00045665682409889996
Iteration: 3647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505585730075836, gen p mean: -0.11242455989122391, mean p set: 0.45113611221313477
The modified gen p mean: 0.4476880431175232, gen p mean: -0.11711752414703369, mean p set: 0.44826605916023254
loss_pred:0.015320220030844212, decouple_loss:0.00039683427894487977
loss_pred:0.01572829857468605, decouple_loss:0.00037822648300789297
The modified gen p mean: 0.44738221168518066, gen p mean: -0.12219133228063583, mean p set: 0.44795873761177063
loss_pred:0.015352552756667137, decouple_loss:0.0004128446744289249
Iteration: 3648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44865167140960693, gen p mean: -0.1136433556675911, mean p set: 0.4492295980453491
loss_pred:0.014971725642681122, decouple_loss:0.0004983242251910269
The modified gen p mean: 0.449624627828598, gen p mean: -0.11884097754955292, mean p set: 0.4502002000808716
The modified gen p mean: 0.4511867165565491, gen p mean: -0.11955481767654419, mean p set: 0.45176324248313904
loss_pred:0.014628149569034576, decouple_loss:0.0003875826660078019
loss_pred:0.013824922032654285, decouple_loss:0.0006074325647205114
Iteration: 3649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45126578211784363, gen p mean: -0.11934542655944824, mean p set: 0.45184415578842163
loss_pred:0.014221844263374805, decouple_loss:0.0005637162830680609
The modified gen p mean: 0.44851386547088623, gen p mean: -0.1167697161436081, mean p set: 0.44909143447875977
The modified gen p mean: 0.4470849931240082, gen p mean: -0.12060575932264328, mean p set: 0.4476604163646698
loss_pred:0.015323443338274956, decouple_loss:0.0004532632592599839
loss_pred:0.015180600807070732, decouple_loss:0.0004930978757329285
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 3650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708871841430664, gen p mean: -0.11713513731956482, mean p set: 0.4476655125617981
The modified gen p mean: 0.44742628931999207, gen p mean: -0.1224466934800148, mean p set: 0.4480014741420746
loss_pred:0.014445087872445583, decouple_loss:0.00037379356217570603
loss_pred:0.01504023652523756, decouple_loss:0.00040582657675258815
The modified gen p mean: 0.44847920536994934, gen p mean: -0.12092027068138123, mean p set: 0.4490565061569214
loss_pred:0.015091626904904842, decouple_loss:0.00037294410867616534
2023-05-02 17:41:09 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1280457228422165, mean p set: 0.4502691626548767
loss_pred:0.01700163260102272, decouple_loss:0.00044886537943966687
The modified gen p mean: 0.4495336711406708, gen p mean: -0.12135456502437592, mean p set: 0.4500633478164673
loss_pred:0.016223745420575142, decouple_loss:0.00048301450442522764
The modified gen p mean: 0.4498305916786194, gen p mean: -0.1205117404460907, mean p set: 0.45035696029663086
loss_pred:0.016533059999346733, decouple_loss:0.00045118623529560864
WV_1_PC_1_EH_0_PS_40, loss: 0.016609197482466698, avg_mse: 0.025906886905431747
current test mse: 0.025907
Iteration: 3651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719481468200684, gen p mean: -0.12420400977134705, mean p set: 0.44777119159698486
loss_pred:0.015316273085772991, decouple_loss:0.0005270276451483369
The modified gen p mean: 0.4476071000099182, gen p mean: -0.12300029397010803, mean p set: 0.448184072971344
loss_pred:0.01540309563279152, decouple_loss:0.000543470261618495
The modified gen p mean: 0.44621142745018005, gen p mean: -0.12428706139326096, mean p set: 0.4467865526676178
loss_pred:0.015691349282860756, decouple_loss:0.0004308342467993498
Iteration: 3652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473707973957062, gen p mean: -0.12316367775201797, mean p set: 0.44794782996177673
loss_pred:0.01574881561100483, decouple_loss:0.0005193973775021732
The modified gen p mean: 0.4473164975643158, gen p mean: -0.12464045733213425, mean p set: 0.4478928744792938The modified gen p mean: 0.44752681255340576, gen p mean: -0.12271951884031296, mean p set: 0.4481014013290405
loss_pred:0.014721858315169811, decouple_loss:0.00045490480260923505loss_pred:0.015690959990024567, decouple_loss:0.0005675791180692613
Iteration: 3653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44826391339302063, gen p mean: -0.12340344488620758, mean p set: 0.4488369822502136
loss_pred:0.015272350050508976, decouple_loss:0.0004534315085038543
The modified gen p mean: 0.44736579060554504, gen p mean: -0.12376689165830612, mean p set: 0.4479406476020813
loss_pred:0.014927279204130173, decouple_loss:0.000531333964318037
The modified gen p mean: 0.4470688998699188, gen p mean: -0.12444222718477249, mean p set: 0.44764459133148193
loss_pred:0.01482814084738493, decouple_loss:0.00031957600731402636
Iteration: 3654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490997791290283, gen p mean: -0.1177460327744484, mean p set: 0.44967639446258545
loss_pred:0.014826895669102669, decouple_loss:0.00034944116487167776
The modified gen p mean: 0.44769740104675293, gen p mean: -0.12250585108995438, mean p set: 0.44827160239219666
loss_pred:0.01606583036482334, decouple_loss:0.00042012849007733166
The modified gen p mean: 0.4488610625267029, gen p mean: -0.12105952203273773, mean p set: 0.4494354724884033
loss_pred:0.015077851712703705, decouple_loss:0.00046576812746934593
Iteration: 3655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44631946086883545, gen p mean: -0.12588313221931458, mean p set: 0.44689464569091797
loss_pred:0.015418834052979946, decouple_loss:0.00045227716327644885
The modified gen p mean: 0.44722557067871094, gen p mean: -0.11750317364931107, mean p set: 0.44780370593070984
The modified gen p mean: 0.4487288296222687, gen p mean: -0.11650659143924713, mean p set: 0.44930681586265564
loss_pred:0.015595374628901482, decouple_loss:0.00038417038740590215
loss_pred:0.015405680984258652, decouple_loss:0.00031925318762660027
Iteration: 3656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483707845211029, gen p mean: -0.11934545636177063, mean p set: 0.4489506781101227
loss_pred:0.01514795608818531, decouple_loss:0.00037102430360391736
The modified gen p mean: 0.4478660821914673, gen p mean: -0.12051521241664886, mean p set: 0.44844329357147217
The modified gen p mean: 0.44808709621429443, gen p mean: -0.11902966350317001, mean p set: 0.4486646354198456
loss_pred:0.01521866675466299, decouple_loss:0.0004741388838738203
loss_pred:0.014722899533808231, decouple_loss:0.0003737305523827672
Iteration: 3657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831737875938416, gen p mean: -0.11814461648464203, mean p set: 0.44889581203460693
loss_pred:0.015420535579323769, decouple_loss:0.0005172716919332743
The modified gen p mean: 0.44754788279533386, gen p mean: -0.11853224039077759, mean p set: 0.44812238216400146
loss_pred:0.01522135641425848, decouple_loss:0.0004190600011497736
The modified gen p mean: 0.4483461380004883, gen p mean: -0.11444538831710815, mean p set: 0.448919415473938
loss_pred:0.015147549100220203, decouple_loss:0.0004357005818746984
Iteration: 3658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476563334465027, gen p mean: -0.12147483974695206, mean p set: 0.4482314884662628
loss_pred:0.014865966513752937, decouple_loss:0.0004398142627906054
The modified gen p mean: 0.4482938349246979, gen p mean: -0.11330343782901764, mean p set: 0.4488692581653595
The modified gen p mean: 0.4481092393398285, gen p mean: -0.11692846566438675, mean p set: 0.4486868679523468
loss_pred:0.014926910400390625, decouple_loss:0.0004091043956577778
loss_pred:0.01473354734480381, decouple_loss:0.0004953754832968116
Iteration: 3659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483659863471985, gen p mean: -0.12151724100112915, mean p set: 0.4489421248435974
loss_pred:0.014699067920446396, decouple_loss:0.00038619711995124817
The modified gen p mean: 0.4481816589832306, gen p mean: -0.11785522103309631, mean p set: 0.4487598240375519
The modified gen p mean: 0.4471026360988617, gen p mean: -0.123076893389225, mean p set: 0.44767823815345764
loss_pred:0.014944839291274548, decouple_loss:0.00034274320933036506
loss_pred:0.014725811779499054, decouple_loss:0.0003950207610614598
Iteration: 3660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452667832374573, gen p mean: -0.1261879801750183, mean p set: 0.44584187865257263
loss_pred:0.015277059748768806, decouple_loss:0.000335592805640772
The modified gen p mean: 0.44746217131614685, gen p mean: -0.11735411733388901, mean p set: 0.4480399191379547
The modified gen p mean: 0.44809362292289734, gen p mean: -0.1242716908454895, mean p set: 0.4486686885356903
loss_pred:0.014300219714641571, decouple_loss:0.00039023623685352504
loss_pred:0.015298867598176003, decouple_loss:0.0005049692699685693
2023-05-02 17:43:16 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.132621631026268, mean p set: 0.4502691626548767
loss_pred:0.016954593360424042, decouple_loss:0.0005770683055743575
The modified gen p mean: 0.4495360255241394, gen p mean: -0.12593165040016174, mean p set: 0.4500633478164673
loss_pred:0.01621674932539463, decouple_loss:0.0004480980278458446
The modified gen p mean: 0.4498288333415985, gen p mean: -0.12506349384784698, mean p set: 0.45035696029663086
loss_pred:0.01646025851368904, decouple_loss:0.00044789351522922516
WV_1_PC_1_EH_0_PS_40, loss: 0.016568418592214584, avg_mse: 0.025857143104076385
current test mse: 0.025857
Iteration: 3661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793224334716797, gen p mean: -0.12353552877902985, mean p set: 0.44850867986679077
loss_pred:0.014728298410773277, decouple_loss:0.0004252552753314376
The modified gen p mean: 0.4462656080722809, gen p mean: -0.1248268261551857, mean p set: 0.4468391239643097The modified gen p mean: 0.4468010663986206, gen p mean: -0.12280980497598648, mean p set: 0.4473777115345001
loss_pred:0.0157078318297863, decouple_loss:0.0003485694178380072loss_pred:0.015062511898577213, decouple_loss:0.00037406905903480947
Iteration: 3662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44927549362182617, gen p mean: -0.12410038709640503, mean p set: 0.44985130429267883
loss_pred:0.014795634895563126, decouple_loss:0.00046416246914304793
The modified gen p mean: 0.4458734393119812, gen p mean: -0.13062603771686554, mean p set: 0.44645223021507263The modified gen p mean: 0.4479376971721649, gen p mean: -0.12506850063800812, mean p set: 0.4485113322734833
loss_pred:0.014915325678884983, decouple_loss:0.0003693513572216034
loss_pred:0.014401487074792385, decouple_loss:0.00032517872750759125
Iteration: 3663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478439390659332, gen p mean: -0.1274261474609375, mean p set: 0.44841864705085754
loss_pred:0.014648007228970528, decouple_loss:0.00037353948573581874
The modified gen p mean: 0.4458644688129425, gen p mean: -0.1262643188238144, mean p set: 0.4464397132396698The modified gen p mean: 0.4470050036907196, gen p mean: -0.12394556403160095, mean p set: 0.4475817382335663
loss_pred:0.01514357142150402, decouple_loss:0.00038839876651763916
loss_pred:0.015061778016388416, decouple_loss:0.0002904987195506692
Iteration: 3664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455731213092804, gen p mean: -0.1314292550086975, mean p set: 0.4461473524570465
loss_pred:0.015222473070025444, decouple_loss:0.00034392584348097444
The modified gen p mean: 0.4489296078681946, gen p mean: -0.1224585473537445, mean p set: 0.4495036005973816
loss_pred:0.015227876603603363, decouple_loss:0.0003396694955881685
The modified gen p mean: 0.44886451959609985, gen p mean: -0.11766025424003601, mean p set: 0.44944167137145996
loss_pred:0.014735895209014416, decouple_loss:0.0005088986945338547
Iteration: 3665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769349694252014, gen p mean: -0.12718762457370758, mean p set: 0.44826918840408325
loss_pred:0.014869855716824532, decouple_loss:0.00039875376387499273
The modified gen p mean: 0.4489402770996094, gen p mean: -0.12519143521785736, mean p set: 0.44951605796813965
loss_pred:0.014733078889548779, decouple_loss:0.00033880246337503195
The modified gen p mean: 0.44812509417533875, gen p mean: -0.13048362731933594, mean p set: 0.44869908690452576
loss_pred:0.01455739513039589, decouple_loss:0.0006419192650355399
Iteration: 3666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715026021003723, gen p mean: -0.12177936732769012, mean p set: 0.4477252662181854
loss_pred:0.015381770208477974, decouple_loss:0.00040778497350402176
The modified gen p mean: 0.4470536410808563, gen p mean: -0.1237746998667717, mean p set: 0.4476326107978821
The modified gen p mean: 0.4458780884742737, gen p mean: -0.12385725229978561, mean p set: 0.44645413756370544
loss_pred:0.014415386132895947, decouple_loss:0.0003341689589433372
loss_pred:0.014843055978417397, decouple_loss:0.00037798352423124015
Iteration: 3667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486404359340668, gen p mean: -0.11772352457046509, mean p set: 0.4492167532444
loss_pred:0.015174618922173977, decouple_loss:0.00038085103733465075
The modified gen p mean: 0.44789350032806396, gen p mean: -0.12418565154075623, mean p set: 0.448468953371048
The modified gen p mean: 0.44789430499076843, gen p mean: -0.1167050302028656, mean p set: 0.44847002625465393
loss_pred:0.015114742331206799, decouple_loss:0.00044668710324913263
loss_pred:0.015017925761640072, decouple_loss:0.0004229076730553061
Iteration: 3668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44845589995384216, gen p mean: -0.11898759752511978, mean p set: 0.4490351974964142
loss_pred:0.014389094896614552, decouple_loss:0.0003098835295531899
The modified gen p mean: 0.4485149681568146, gen p mean: -0.12361298501491547, mean p set: 0.44908660650253296
loss_pred:0.014793958514928818, decouple_loss:0.00047337275464087725
The modified gen p mean: 0.4481627345085144, gen p mean: -0.11335156112909317, mean p set: 0.4487389624118805
loss_pred:0.014987875707447529, decouple_loss:0.00044059212086722255
Iteration: 3669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473726451396942, gen p mean: -0.1203158050775528, mean p set: 0.4479483664035797
loss_pred:0.01449370663613081, decouple_loss:0.0003426201001275331
The modified gen p mean: 0.4474655091762543, gen p mean: -0.1227663904428482, mean p set: 0.4480428397655487
The modified gen p mean: 0.4470651149749756, gen p mean: -0.11645307391881943, mean p set: 0.44764280319213867
loss_pred:0.014894089661538601, decouple_loss:0.00043091937550343573
loss_pred:0.014002607204020023, decouple_loss:0.0003079559246543795
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
NaN value num: 0
Iteration: 3670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45144447684288025, gen p mean: -0.1060958206653595, mean p set: 0.4520217776298523
loss_pred:0.01546375174075365, decouple_loss:0.0004345373890828341
The modified gen p mean: 0.45208975672721863, gen p mean: -0.1131954938173294, mean p set: 0.45266470313072205
The modified gen p mean: 0.4522177278995514, gen p mean: -0.10769245028495789, mean p set: 0.45279279351234436
loss_pred:0.015081494115293026, decouple_loss:0.000395053590182215
loss_pred:0.015923015773296356, decouple_loss:0.0005121865542605519
2023-05-02 17:46:00 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12752962112426758, mean p set: 0.4502691626548767
loss_pred:0.01694183610379696, decouple_loss:0.0005188584327697754
The modified gen p mean: 0.44953563809394836, gen p mean: -0.12099359184503555, mean p set: 0.4500633478164673
loss_pred:0.016142750158905983, decouple_loss:0.00040341814747080207
The modified gen p mean: 0.4498271048069, gen p mean: -0.12049976736307144, mean p set: 0.45035696029663086
loss_pred:0.016390545293688774, decouple_loss:0.0004306338669266552
WV_1_PC_1_EH_0_PS_40, loss: 0.016514260321855545, avg_mse: 0.025832077488303185
current test mse: 0.025832
Iteration: 3671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530942738056183, gen p mean: -0.11363790184259415, mean p set: 0.45367300510406494
loss_pred:0.016325287520885468, decouple_loss:0.00038218512781895697
The modified gen p mean: 0.4519023597240448, gen p mean: -0.11642614752054214, mean p set: 0.45247751474380493The modified gen p mean: 0.45145899057388306, gen p mean: -0.11247226595878601, mean p set: 0.4520357549190521
loss_pred:0.015803275629878044, decouple_loss:0.00041242552106268704loss_pred:0.014948240481317043, decouple_loss:0.0003291995672043413
Iteration: 3672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509594440460205, gen p mean: -0.10963404923677444, mean p set: 0.4515356123447418
loss_pred:0.015551713295280933, decouple_loss:0.00037569654523395
The modified gen p mean: 0.4512348175048828, gen p mean: -0.10778764635324478, mean p set: 0.4518103301525116The modified gen p mean: 0.45122867822647095, gen p mean: -0.11149705201387405, mean p set: 0.4518068730831146
loss_pred:0.01477290503680706, decouple_loss:0.0005268716486170888
loss_pred:0.015180034562945366, decouple_loss:0.0004364949418231845
Iteration: 3673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45096319913864136, gen p mean: -0.11097361892461777, mean p set: 0.45153874158859253
loss_pred:0.014775730669498444, decouple_loss:0.0003834392409771681
The modified gen p mean: 0.4515431523323059, gen p mean: -0.1160721555352211, mean p set: 0.4521217942237854
loss_pred:0.01602168008685112, decouple_loss:0.0004237713001202792
The modified gen p mean: 0.45178136229515076, gen p mean: -0.1199839636683464, mean p set: 0.4523584544658661
loss_pred:0.015573345124721527, decouple_loss:0.00039345683762803674
Iteration: 3674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508824348449707, gen p mean: -0.11451621353626251, mean p set: 0.4514599144458771
loss_pred:0.01540311984717846, decouple_loss:0.00047862459905445576
The modified gen p mean: 0.45301690697669983, gen p mean: -0.1150934025645256, mean p set: 0.45359519124031067
loss_pred:0.014904025010764599, decouple_loss:0.0005278275930322707
The modified gen p mean: 0.45279407501220703, gen p mean: -0.116562120616436, mean p set: 0.45337265729904175
loss_pred:0.014604300260543823, decouple_loss:0.0003984358045272529
Iteration: 3675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513547420501709, gen p mean: -0.11855844408273697, mean p set: 0.45193058252334595
loss_pred:0.014757259748876095, decouple_loss:0.0003223120584152639
The modified gen p mean: 0.45240435004234314, gen p mean: -0.11313344538211823, mean p set: 0.45298269391059875
loss_pred:0.015555210411548615, decouple_loss:0.00046857917914167047
The modified gen p mean: 0.45335203409194946, gen p mean: -0.11230280995368958, mean p set: 0.4539310038089752
loss_pred:0.014868629164993763, decouple_loss:0.0004179824609309435
Iteration: 3676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514223635196686, gen p mean: -0.11474162340164185, mean p set: 0.45199838280677795
loss_pred:0.015543786808848381, decouple_loss:0.00044852978317067027
The modified gen p mean: 0.4523591995239258, gen p mean: -0.12179944664239883, mean p set: 0.45293402671813965
The modified gen p mean: 0.4517461359500885, gen p mean: -0.11942805349826813, mean p set: 0.452322781085968
loss_pred:0.015961740165948868, decouple_loss:0.0003503213811200112
loss_pred:0.01606094464659691, decouple_loss:0.00044877437176182866
Iteration: 3677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518109858036041, gen p mean: -0.1201946884393692, mean p set: 0.4523863196372986
loss_pred:0.01444348692893982, decouple_loss:0.00040365231689065695
The modified gen p mean: 0.4513143002986908, gen p mean: -0.11559183895587921, mean p set: 0.45189085602760315
The modified gen p mean: 0.45082545280456543, gen p mean: -0.12141656130552292, mean p set: 0.4514019787311554
loss_pred:0.015014485456049442, decouple_loss:0.00038707818021066487
loss_pred:0.014437633566558361, decouple_loss:0.0004933434538543224
Iteration: 3678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530814290046692, gen p mean: -0.11424871534109116, mean p set: 0.45365968346595764
The modified gen p mean: 0.45117297768592834, gen p mean: -0.11838017404079437, mean p set: 0.4517495334148407
loss_pred:0.01544860564172268, decouple_loss:0.0004625801811926067
loss_pred:0.015252425335347652, decouple_loss:0.0004562289104796946
The modified gen p mean: 0.45164501667022705, gen p mean: -0.12654981017112732, mean p set: 0.4522242546081543
loss_pred:0.014427289366722107, decouple_loss:0.00035230370122008026
Iteration: 3679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504008889198303, gen p mean: -0.1222730278968811, mean p set: 0.4509764611721039
loss_pred:0.014343923889100552, decouple_loss:0.00044619670370593667
The modified gen p mean: 0.45095449686050415, gen p mean: -0.1173853650689125, mean p set: 0.45153123140335083
loss_pred:0.014092180877923965, decouple_loss:0.0003115462604910135
The modified gen p mean: 0.4508013427257538, gen p mean: -0.11955101788043976, mean p set: 0.45137453079223633
loss_pred:0.01559439953416586, decouple_loss:0.0004147047584410757
Iteration: 3680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515608847141266, gen p mean: -0.12022271007299423, mean p set: 0.45214059948921204
loss_pred:0.015180621296167374, decouple_loss:0.00038057510391809046
The modified gen p mean: 0.45270854234695435, gen p mean: -0.1211983934044838, mean p set: 0.45328596234321594
loss_pred:0.016038967296481133, decouple_loss:0.00041017160401679575
The modified gen p mean: 0.4499788284301758, gen p mean: -0.12253372371196747, mean p set: 0.45055609941482544
loss_pred:0.015599280595779419, decouple_loss:0.0004271055804565549
2023-05-02 17:48:07 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13819456100463867, mean p set: 0.4502691626548767
loss_pred:0.01695023477077484, decouple_loss:0.0005492002819664776
The modified gen p mean: 0.44953426718711853, gen p mean: -0.13135460019111633, mean p set: 0.4500633478164673
loss_pred:0.01625528559088707, decouple_loss:0.00046903235488571227
The modified gen p mean: 0.4498288631439209, gen p mean: -0.130705326795578, mean p set: 0.45035696029663086
loss_pred:0.01644241437315941, decouple_loss:0.0004942436353303492
WV_1_PC_1_EH_0_PS_40, loss: 0.016574520617723465, avg_mse: 0.025892440229654312
current test mse: 0.025892
Iteration: 3681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45158663392066956, gen p mean: -0.12161567062139511, mean p set: 0.45216134190559387
loss_pred:0.015302974730730057, decouple_loss:0.0004316728445701301
The modified gen p mean: 0.45163851976394653, gen p mean: -0.12413010001182556, mean p set: 0.4522145688533783The modified gen p mean: 0.45093604922294617, gen p mean: -0.12630963325500488, mean p set: 0.45151403546333313
loss_pred:0.015819543972611427, decouple_loss:0.000417106639361009
loss_pred:0.014446055516600609, decouple_loss:0.00045930271153338253
Iteration: 3682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978922605514526, gen p mean: -0.12665340304374695, mean p set: 0.45036500692367554
loss_pred:0.013809073716402054, decouple_loss:0.00038570817559957504
The modified gen p mean: 0.4522300362586975, gen p mean: -0.12719817459583282, mean p set: 0.4528064429759979The modified gen p mean: 0.4499199092388153, gen p mean: -0.12183794379234314, mean p set: 0.45049792528152466
loss_pred:0.015155130065977573, decouple_loss:0.0005570995272137225
loss_pred:0.014769360423088074, decouple_loss:0.0005863553378731012
Iteration: 3683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494640827178955, gen p mean: -0.12176993489265442, mean p set: 0.4500395953655243
loss_pred:0.014546237885951996, decouple_loss:0.0002953970688395202
The modified gen p mean: 0.4497924745082855, gen p mean: -0.11602859199047089, mean p set: 0.4503691494464874
loss_pred:0.015031740069389343, decouple_loss:0.0003065976488869637
The modified gen p mean: 0.4517538845539093, gen p mean: -0.12084780633449554, mean p set: 0.4523301124572754
loss_pred:0.015380055643618107, decouple_loss:0.00040875960257835686
Iteration: 3684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523027539253235, gen p mean: -0.11601594090461731, mean p set: 0.4528812766075134
loss_pred:0.01572406105697155, decouple_loss:0.00039963636663742363
The modified gen p mean: 0.45209142565727234, gen p mean: -0.12107188999652863, mean p set: 0.45267003774642944
loss_pred:0.015495325438678265, decouple_loss:0.00048503943253308535
The modified gen p mean: 0.4513125717639923, gen p mean: -0.11991982161998749, mean p set: 0.45189085602760315
loss_pred:0.01455386821180582, decouple_loss:0.000434663612395525
Iteration: 3685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501495063304901, gen p mean: -0.11872991919517517, mean p set: 0.4507259726524353
loss_pred:0.014804132282733917, decouple_loss:0.0004449711414054036
The modified gen p mean: 0.450730562210083, gen p mean: -0.12051785737276077, mean p set: 0.451306015253067
loss_pred:0.01599385030567646, decouple_loss:0.0005172226810827851
The modified gen p mean: 0.4511208236217499, gen p mean: -0.11784245073795319, mean p set: 0.4516959488391876
loss_pred:0.014151864685118198, decouple_loss:0.0004287967167329043
Iteration: 3686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501771628856659, gen p mean: -0.11613941937685013, mean p set: 0.45075303316116333
loss_pred:0.014191768132150173, decouple_loss:0.0002995869144797325
The modified gen p mean: 0.4523260295391083, gen p mean: -0.11815153062343597, mean p set: 0.4529041349887848
The modified gen p mean: 0.4515977203845978, gen p mean: -0.12704616785049438, mean p set: 0.4521753489971161
loss_pred:0.014803030528128147, decouple_loss:0.0003342400013934821
loss_pred:0.015284430235624313, decouple_loss:0.00046159487101249397
Iteration: 3687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534814655780792, gen p mean: -0.11897405982017517, mean p set: 0.45405787229537964
loss_pred:0.015139423310756683, decouple_loss:0.00041097780922427773
The modified gen p mean: 0.4508056938648224, gen p mean: -0.12473691254854202, mean p set: 0.451384037733078
The modified gen p mean: 0.45217758417129517, gen p mean: -0.12227083742618561, mean p set: 0.452752947807312
loss_pred:0.013951646164059639, decouple_loss:0.000498314737342298
loss_pred:0.015580476261675358, decouple_loss:0.0004298245476093143
Iteration: 3688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515853226184845, gen p mean: -0.12911437451839447, mean p set: 0.4521616995334625
loss_pred:0.014956303872168064, decouple_loss:0.0004267732729203999
The modified gen p mean: 0.4512425363063812, gen p mean: -0.1301456093788147, mean p set: 0.45181599259376526
loss_pred:0.014971609227359295, decouple_loss:0.00036607292713597417
The modified gen p mean: 0.4512876868247986, gen p mean: -0.1255054622888565, mean p set: 0.451865553855896
loss_pred:0.015072249807417393, decouple_loss:0.00030632104608230293
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
NaN value num: 0
Iteration: 3689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521217346191406, gen p mean: -0.12990118563175201, mean p set: 0.4527009129524231
loss_pred:0.01435693446546793, decouple_loss:0.0004481733194552362
The modified gen p mean: 0.45099014043807983, gen p mean: -0.12682530283927917, mean p set: 0.451566606760025
The modified gen p mean: 0.45178017020225525, gen p mean: -0.1233946904540062, mean p set: 0.4523571729660034
loss_pred:0.0158400721848011, decouple_loss:0.0004469887353479862
loss_pred:0.014768724329769611, decouple_loss:0.0003275954513810575
Iteration: 3690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510662257671356, gen p mean: -0.12439139187335968, mean p set: 0.4516444504261017
loss_pred:0.015657976269721985, decouple_loss:0.0003753058554138988
The modified gen p mean: 0.45071330666542053, gen p mean: -0.12387653440237045, mean p set: 0.4512914717197418
The modified gen p mean: 0.4537985324859619, gen p mean: -0.12455464154481888, mean p set: 0.45437467098236084
loss_pred:0.015104218386113644, decouple_loss:0.00033040251582860947
loss_pred:0.014452321454882622, decouple_loss:0.0003977164451498538
2023-05-02 17:50:57 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13572989404201508, mean p set: 0.4502691626548767
loss_pred:0.016835058107972145, decouple_loss:0.00036050501512363553
The modified gen p mean: 0.4495336711406708, gen p mean: -0.12834537029266357, mean p set: 0.4500633478164673
loss_pred:0.016251040622591972, decouple_loss:0.0003508153313305229
The modified gen p mean: 0.44982895255088806, gen p mean: -0.1274668425321579, mean p set: 0.45035696029663086
loss_pred:0.016415633261203766, decouple_loss:0.0004062092339154333
WV_1_PC_1_EH_0_PS_40, loss: 0.016519203782081604, avg_mse: 0.025863762944936752
current test mse: 0.025864
Iteration: 3691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45017722249031067, gen p mean: -0.1284046322107315, mean p set: 0.450752317905426
loss_pred:0.014264007098972797, decouple_loss:0.00040473617264069617
The modified gen p mean: 0.45049506425857544, gen p mean: -0.12427278608083725, mean p set: 0.4510722756385803
The modified gen p mean: 0.4508296549320221, gen p mean: -0.12427645921707153, mean p set: 0.45140859484672546
loss_pred:0.015751002356410027, decouple_loss:0.0004415595903992653
loss_pred:0.015480954200029373, decouple_loss:0.00041171189513988793
Iteration: 3692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45207223296165466, gen p mean: -0.12109311670064926, mean p set: 0.4526509940624237
loss_pred:0.015751991420984268, decouple_loss:0.00044286809861660004
The modified gen p mean: 0.45210617780685425, gen p mean: -0.11470694094896317, mean p set: 0.4526849389076233The modified gen p mean: 0.45021581649780273, gen p mean: -0.1251773238182068, mean p set: 0.45079126954078674
loss_pred:0.015245042741298676, decouple_loss:0.00035287102218717337
loss_pred:0.014639835804700851, decouple_loss:0.000369055982446298
Iteration: 3693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45137691497802734, gen p mean: -0.11002098768949509, mean p set: 0.45195385813713074
The modified gen p mean: 0.4498760998249054, gen p mean: -0.11952254921197891, mean p set: 0.45045205950737
loss_pred:0.014216883108019829, decouple_loss:0.0004552532045636326
loss_pred:0.014926712028682232, decouple_loss:0.00043965299846604466
The modified gen p mean: 0.4502059817314148, gen p mean: -0.12202763557434082, mean p set: 0.45078444480895996
loss_pred:0.015033314004540443, decouple_loss:0.0003456211998127401
Iteration: 3694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44964274764060974, gen p mean: -0.11786697804927826, mean p set: 0.4502184987068176
loss_pred:0.014910831116139889, decouple_loss:0.00036641303449869156
The modified gen p mean: 0.44997137784957886, gen p mean: -0.11566624045372009, mean p set: 0.4505482017993927
loss_pred:0.01497906818985939, decouple_loss:0.00033071712823584676
The modified gen p mean: 0.45001569390296936, gen p mean: -0.11656475812196732, mean p set: 0.4505917727947235
loss_pred:0.01440457534044981, decouple_loss:0.000313828990329057
Iteration: 3695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520971477031708, gen p mean: -0.11673291027545929, mean p set: 0.45267269015312195
The modified gen p mean: 0.4489225447177887, gen p mean: -0.11635719984769821, mean p set: 0.4494965374469757
loss_pred:0.014489128254354, decouple_loss:0.00038652090006507933
loss_pred:0.015097455121576786, decouple_loss:0.0003382932918611914
The modified gen p mean: 0.4508032202720642, gen p mean: -0.11855706572532654, mean p set: 0.4513775408267975
loss_pred:0.014374326914548874, decouple_loss:0.00041121983667835593
Iteration: 3696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503704309463501, gen p mean: -0.1135777160525322, mean p set: 0.4509464502334595
loss_pred:0.014541658572852612, decouple_loss:0.00041066596168093383
The modified gen p mean: 0.45006194710731506, gen p mean: -0.11852402985095978, mean p set: 0.4506409764289856
The modified gen p mean: 0.45180660486221313, gen p mean: -0.10804340243339539, mean p set: 0.4523874819278717
loss_pred:0.014498291537165642, decouple_loss:0.0005384550895541906
loss_pred:0.01462225615978241, decouple_loss:0.0004282819863874465
Iteration: 3697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997990131378174, gen p mean: -0.12390808761119843, mean p set: 0.45055627822875977
loss_pred:0.014865489676594734, decouple_loss:0.0004467613762244582
The modified gen p mean: 0.4514463543891907, gen p mean: -0.11497355997562408, mean p set: 0.4520217776298523
The modified gen p mean: 0.45206400752067566, gen p mean: -0.11649169772863388, mean p set: 0.452638179063797
loss_pred:0.014411244541406631, decouple_loss:0.0003420666034799069
loss_pred:0.015341883525252342, decouple_loss:0.0003688304277602583
Iteration: 3698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504956603050232, gen p mean: -0.12764190137386322, mean p set: 0.45107343792915344
loss_pred:0.014612672850489616, decouple_loss:0.00041857719770632684
The modified gen p mean: 0.4498743712902069, gen p mean: -0.125850111246109, mean p set: 0.4504525363445282
The modified gen p mean: 0.4505850374698639, gen p mean: -0.12752985954284668, mean p set: 0.45116284489631653
loss_pred:0.01505234558135271, decouple_loss:0.0004000899789389223
loss_pred:0.014582312665879726, decouple_loss:0.0004112761525902897
Iteration: 3699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45362991094589233, gen p mean: -0.11821958422660828, mean p set: 0.45420756936073303
The modified gen p mean: 0.44986653327941895, gen p mean: -0.12462839484214783, mean p set: 0.45044317841529846
loss_pred:0.01467909850180149, decouple_loss:0.00047308727516792715
loss_pred:0.015052400529384613, decouple_loss:0.000358372664777562
The modified gen p mean: 0.45008283853530884, gen p mean: -0.1255309134721756, mean p set: 0.45065951347351074
loss_pred:0.01465715654194355, decouple_loss:0.00047135676140896976
Iteration: 3700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522755444049835, gen p mean: -0.12197057902812958, mean p set: 0.4528560936450958
loss_pred:0.014881948009133339, decouple_loss:0.00035312832915224135
The modified gen p mean: 0.4504762887954712, gen p mean: -0.12751342356204987, mean p set: 0.45105183124542236
loss_pred:0.015472160652279854, decouple_loss:0.0002997476258315146
The modified gen p mean: 0.4519905149936676, gen p mean: -0.12370643764734268, mean p set: 0.4525681734085083
loss_pred:0.014961314387619495, decouple_loss:0.00033132097451016307
2023-05-02 17:53:03 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13186074793338776, mean p set: 0.4502691626548767
loss_pred:0.016821034252643585, decouple_loss:0.0003722185210790485
The modified gen p mean: 0.44953328371047974, gen p mean: -0.12527069449424744, mean p set: 0.4500633478164673
loss_pred:0.016182679682970047, decouple_loss:0.0004518415662460029
The modified gen p mean: 0.44983017444610596, gen p mean: -0.12472930550575256, mean p set: 0.45035696029663086
loss_pred:0.016417112201452255, decouple_loss:0.0005648177466355264
WV_1_PC_1_EH_0_PS_40, loss: 0.01649675890803337, avg_mse: 0.025744756683707237
current test mse: 0.025745
Iteration: 3701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509150981903076, gen p mean: -0.11716414242982864, mean p set: 0.45149174332618713
loss_pred:0.014416900463402271, decouple_loss:0.00039565490442328155
The modified gen p mean: 0.4522329568862915, gen p mean: -0.11982410401105881, mean p set: 0.45281288027763367The modified gen p mean: 0.45056501030921936, gen p mean: -0.12303785979747772, mean p set: 0.45114099979400635
loss_pred:0.015886498615145683, decouple_loss:0.0004771732783410698
loss_pred:0.014600345864892006, decouple_loss:0.00035830269916914403
Iteration: 3702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508375823497772, gen p mean: -0.11749572306871414, mean p set: 0.45141491293907166
loss_pred:0.01520559098571539, decouple_loss:0.0003962813352700323
The modified gen p mean: 0.45028412342071533, gen p mean: -0.11983583867549896, mean p set: 0.45086002349853516The modified gen p mean: 0.4501210153102875, gen p mean: -0.11635593324899673, mean p set: 0.4506986141204834
loss_pred:0.015144207514822483, decouple_loss:0.00033393845660611987loss_pred:0.015110145322978497, decouple_loss:0.00041477163904346526
Iteration: 3703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504917562007904, gen p mean: -0.11633235216140747, mean p set: 0.4510670304298401
loss_pred:0.01457695197314024, decouple_loss:0.0003307914303150028
The modified gen p mean: 0.4507560729980469, gen p mean: -0.11213135719299316, mean p set: 0.45133084058761597The modified gen p mean: 0.45056426525115967, gen p mean: -0.11525727808475494, mean p set: 0.4511401653289795
loss_pred:0.014638197608292103, decouple_loss:0.00035080895759165287
loss_pred:0.015244581736624241, decouple_loss:0.00035000641946680844
Iteration: 3704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114198327064514, gen p mean: -0.11043740808963776, mean p set: 0.45171812176704407
loss_pred:0.01514831930398941, decouple_loss:0.00034013635013252497
The modified gen p mean: 0.4524104595184326, gen p mean: -0.10679057985544205, mean p set: 0.4529861509799957
loss_pred:0.014782534912228584, decouple_loss:0.0004597206716425717
The modified gen p mean: 0.4534171521663666, gen p mean: -0.10971424728631973, mean p set: 0.453996479511261
loss_pred:0.014392518438398838, decouple_loss:0.000431353400927037
Iteration: 3705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506549835205078, gen p mean: -0.11252656579017639, mean p set: 0.45123252272605896
loss_pred:0.015079698525369167, decouple_loss:0.00033287605037912726
The modified gen p mean: 0.44949379563331604, gen p mean: -0.10815685242414474, mean p set: 0.4500705301761627
loss_pred:0.015270394273102283, decouple_loss:0.0006807355093769729
The modified gen p mean: 0.4499978721141815, gen p mean: -0.11261720210313797, mean p set: 0.4505741000175476
loss_pred:0.015112034045159817, decouple_loss:0.0005594003014266491
Iteration: 3706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508697986602783, gen p mean: -0.10407938808202744, mean p set: 0.45144933462142944
loss_pred:0.014180595986545086, decouple_loss:0.00044821971096098423
The modified gen p mean: 0.45243534445762634, gen p mean: -0.11351136863231659, mean p set: 0.45301249623298645
The modified gen p mean: 0.4507575035095215, gen p mean: -0.11290375143289566, mean p set: 0.45133426785469055
loss_pred:0.014617914333939552, decouple_loss:0.00031535132438875735
loss_pred:0.014997190795838833, decouple_loss:0.000296662183245644
Iteration: 3707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525824189186096, gen p mean: -0.1087426096200943, mean p set: 0.4531611502170563
loss_pred:0.015064714476466179, decouple_loss:0.00036135679692961276
The modified gen p mean: 0.4501924514770508, gen p mean: -0.11667556315660477, mean p set: 0.4507681429386139
loss_pred:0.014344597235321999, decouple_loss:0.0004045619862154126
The modified gen p mean: 0.44987550377845764, gen p mean: -0.1154990866780281, mean p set: 0.4504498541355133
loss_pred:0.01507902517914772, decouple_loss:0.00035088826552964747
Iteration: 3708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44988036155700684, gen p mean: -0.11568308621644974, mean p set: 0.450456827878952
loss_pred:0.01559822540730238, decouple_loss:0.0003260107187088579
The modified gen p mean: 0.452161580324173, gen p mean: -0.11487835645675659, mean p set: 0.4527396559715271
loss_pred:0.014703139662742615, decouple_loss:0.00046175834722816944
The modified gen p mean: 0.45030975341796875, gen p mean: -0.11733251810073853, mean p set: 0.4508858919143677
loss_pred:0.014514959417283535, decouple_loss:0.0002635289856698364
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 3709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44913217425346375, gen p mean: -0.12545675039291382, mean p set: 0.449707955121994
loss_pred:0.014506706967949867, decouple_loss:0.00034975045127794147
The modified gen p mean: 0.45034098625183105, gen p mean: -0.12321468442678452, mean p set: 0.4509190618991852
The modified gen p mean: 0.45007044076919556, gen p mean: -0.12622655928134918, mean p set: 0.45064398646354675
loss_pred:0.014465968124568462, decouple_loss:0.0004919961211271584
loss_pred:0.01316889189183712, decouple_loss:0.0005414751940406859
Iteration: 3710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503503441810608, gen p mean: -0.1289484053850174, mean p set: 0.45092666149139404
loss_pred:0.014116056263446808, decouple_loss:0.0004078522906638682
The modified gen p mean: 0.44852685928344727, gen p mean: -0.1261596381664276, mean p set: 0.4491027593612671
loss_pred:0.014609280042350292, decouple_loss:0.0003027514030691236
The modified gen p mean: 0.4482731819152832, gen p mean: -0.13350750505924225, mean p set: 0.44884857535362244
loss_pred:0.01462315209209919, decouple_loss:0.0003328594611957669
2023-05-02 17:55:51 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13591112196445465, mean p set: 0.4502691626548767
loss_pred:0.016873810440301895, decouple_loss:0.00036142923636361957
The modified gen p mean: 0.44953349232673645, gen p mean: -0.1285926252603531, mean p set: 0.4500633478164673
loss_pred:0.016178768128156662, decouple_loss:0.00035587753518484533
The modified gen p mean: 0.44982871413230896, gen p mean: -0.12765678763389587, mean p set: 0.45035696029663086
loss_pred:0.016460036858916283, decouple_loss:0.00034853865508921444
WV_1_PC_1_EH_0_PS_40, loss: 0.01652197167277336, avg_mse: 0.025785448029637337
current test mse: 0.025785
Iteration: 3711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742366671562195, gen p mean: -0.12570491433143616, mean p set: 0.4479977786540985
loss_pred:0.014126279391348362, decouple_loss:0.00027455808594822884
The modified gen p mean: 0.44983330368995667, gen p mean: -0.12821261584758759, mean p set: 0.450408935546875The modified gen p mean: 0.448212593793869, gen p mean: -0.126603364944458, mean p set: 0.4487907588481903
loss_pred:0.013916798867285252, decouple_loss:0.0003568326646927744
loss_pred:0.01449765358120203, decouple_loss:0.0003801453858613968
Iteration: 3712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45014798641204834, gen p mean: -0.12361975759267807, mean p set: 0.4507233798503876
loss_pred:0.014153830707073212, decouple_loss:0.00038387192762456834
The modified gen p mean: 0.4489161968231201, gen p mean: -0.12331083416938782, mean p set: 0.44949066638946533The modified gen p mean: 0.4477854371070862, gen p mean: -0.1253928542137146, mean p set: 0.44835996627807617
loss_pred:0.014444231055676937, decouple_loss:0.00030319535289891064
loss_pred:0.015263979323208332, decouple_loss:0.0003412970982026309
Iteration: 3713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048603415489197, gen p mean: -0.12375354021787643, mean p set: 0.45106109976768494
loss_pred:0.013295384123921394, decouple_loss:0.0004228670441079885
The modified gen p mean: 0.448827862739563, gen p mean: -0.12428046762943268, mean p set: 0.4494022727012634
loss_pred:0.01497731450945139, decouple_loss:0.00036489765625447035
The modified gen p mean: 0.449308842420578, gen p mean: -0.13113152980804443, mean p set: 0.4498860538005829
loss_pred:0.014768782071769238, decouple_loss:0.00042826091521419585
Iteration: 3714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018988847732544, gen p mean: -0.12276098132133484, mean p set: 0.4507656991481781
loss_pred:0.01382374856621027, decouple_loss:0.00041316193528473377
The modified gen p mean: 0.44881361722946167, gen p mean: -0.12514746189117432, mean p set: 0.44939103722572327
loss_pred:0.014356999658048153, decouple_loss:0.00030760568915866315
The modified gen p mean: 0.45002061128616333, gen p mean: -0.1266975700855255, mean p set: 0.4505973160266876
loss_pred:0.01410435140132904, decouple_loss:0.0003655690234154463
Iteration: 3715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815391302108765, gen p mean: -0.1262698769569397, mean p set: 0.44873154163360596
loss_pred:0.01385325938463211, decouple_loss:0.0003309423627797514
The modified gen p mean: 0.4494950771331787, gen p mean: -0.12330448627471924, mean p set: 0.45007139444351196
loss_pred:0.014732674695551395, decouple_loss:0.00040582995279692113
The modified gen p mean: 0.4494144916534424, gen p mean: -0.11973211169242859, mean p set: 0.4499913156032562
loss_pred:0.013595277443528175, decouple_loss:0.0003325752913951874
Iteration: 3716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486570954322815, gen p mean: -0.1183067113161087, mean p set: 0.4492337107658386
loss_pred:0.013788442127406597, decouple_loss:0.00030301857623271644
The modified gen p mean: 0.4496009647846222, gen p mean: -0.12397341430187225, mean p set: 0.45017769932746887
The modified gen p mean: 0.44890719652175903, gen p mean: -0.13144560158252716, mean p set: 0.4494844079017639
loss_pred:0.01386241801083088, decouple_loss:0.000333964271703735
loss_pred:0.014583893120288849, decouple_loss:0.0002811087470036
Iteration: 3717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493241310119629, gen p mean: -0.12231510877609253, mean p set: 0.4499005675315857
loss_pred:0.014139670878648758, decouple_loss:0.00037272804183885455
The modified gen p mean: 0.4494675099849701, gen p mean: -0.12320374697446823, mean p set: 0.4500423073768616
loss_pred:0.014770261943340302, decouple_loss:0.00040552837890572846
The modified gen p mean: 0.44955602288246155, gen p mean: -0.12489956617355347, mean p set: 0.4501335322856903
loss_pred:0.013642619363963604, decouple_loss:0.00037886027712374926
Iteration: 3718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831377267837524, gen p mean: -0.11856759339570999, mean p set: 0.44889214634895325
loss_pred:0.01418034452944994, decouple_loss:0.0005320573691278696
The modified gen p mean: 0.44923916459083557, gen p mean: -0.12688681483268738, mean p set: 0.4498126208782196
The modified gen p mean: 0.4474325478076935, gen p mean: -0.11937663704156876, mean p set: 0.448009192943573
loss_pred:0.013767505064606667, decouple_loss:0.0004963304963894188
loss_pred:0.013866016641259193, decouple_loss:0.0006127736996859312
Iteration: 3719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497593939304352, gen p mean: -0.12308576703071594, mean p set: 0.4503350555896759
loss_pred:0.014145447872579098, decouple_loss:0.00033245686790905893
The modified gen p mean: 0.44867366552352905, gen p mean: -0.11951576918363571, mean p set: 0.4492511451244354
loss_pred:0.01516677811741829, decouple_loss:0.0003347737656440586
The modified gen p mean: 0.4499715566635132, gen p mean: -0.12244818359613419, mean p set: 0.4505492150783539
loss_pred:0.013538026250898838, decouple_loss:0.0003449979703873396
Iteration: 3720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504440426826477, gen p mean: -0.121157206594944, mean p set: 0.4510194957256317
loss_pred:0.013546209782361984, decouple_loss:0.0003498857549857348
The modified gen p mean: 0.4493207633495331, gen p mean: -0.12700024247169495, mean p set: 0.4498968720436096
The modified gen p mean: 0.4503190815448761, gen p mean: -0.12417267262935638, mean p set: 0.4508989155292511
loss_pred:0.013495196588337421, decouple_loss:0.000375791743863374
loss_pred:0.013396716676652431, decouple_loss:0.0003238813951611519
2023-05-02 17:57:58 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12981392443180084, mean p set: 0.4502691626548767
loss_pred:0.016741128638386726, decouple_loss:0.0002990642678923905
The modified gen p mean: 0.44953519105911255, gen p mean: -0.12287970632314682, mean p set: 0.4500633478164673
loss_pred:0.016119439154863358, decouple_loss:0.000350243499269709
The modified gen p mean: 0.44982844591140747, gen p mean: -0.12221353501081467, mean p set: 0.45035696029663086
loss_pred:0.016375422477722168, decouple_loss:0.0003375433152541518
WV_1_PC_1_EH_0_PS_40, loss: 0.016428444534540176, avg_mse: 0.02569623664021492
current test mse: 0.025696
Iteration: 3721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449055939912796, gen p mean: -0.12803786993026733, mean p set: 0.4496326744556427
loss_pred:0.014014370739459991, decouple_loss:0.00030008688918314874
The modified gen p mean: 0.44835665822029114, gen p mean: -0.12003616243600845, mean p set: 0.4489321708679199The modified gen p mean: 0.4490096867084503, gen p mean: -0.12610162794589996, mean p set: 0.44958579540252686
loss_pred:0.013824035413563251, decouple_loss:0.00036893418291583657
loss_pred:0.014402887783944607, decouple_loss:0.0003475186531431973
Iteration: 3722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710773229599, gen p mean: -0.12396373599767685, mean p set: 0.4476839303970337
loss_pred:0.013931987807154655, decouple_loss:0.0002919250400736928
The modified gen p mean: 0.44714564085006714, gen p mean: -0.12349160760641098, mean p set: 0.4477207064628601The modified gen p mean: 0.44992005825042725, gen p mean: -0.12273123860359192, mean p set: 0.4504936933517456
loss_pred:0.014108264818787575, decouple_loss:0.0002702903002500534
loss_pred:0.013113084249198437, decouple_loss:0.0003230754809919745
Iteration: 3723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44898009300231934, gen p mean: -0.12755537033081055, mean p set: 0.4495563805103302
loss_pred:0.0142847690731287, decouple_loss:0.0003047240315936506
The modified gen p mean: 0.44883543252944946, gen p mean: -0.12321949750185013, mean p set: 0.4494141638278961The modified gen p mean: 0.4501086175441742, gen p mean: -0.1219729408621788, mean p set: 0.4506858289241791
loss_pred:0.014598122797906399, decouple_loss:0.000318730715662241
loss_pred:0.01386416144669056, decouple_loss:0.0003938968002330512
Iteration: 3724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492226541042328, gen p mean: -0.12542225420475006, mean p set: 0.4497992694377899
The modified gen p mean: 0.4493452310562134, gen p mean: -0.1278133988380432, mean p set: 0.4499218463897705
loss_pred:0.013754633255302906, decouple_loss:0.0003548432432580739
loss_pred:0.014096338301897049, decouple_loss:0.0004039430932607502
The modified gen p mean: 0.45024800300598145, gen p mean: -0.12033632397651672, mean p set: 0.4508228898048401
loss_pred:0.013457893393933773, decouple_loss:0.0003125203074887395
Iteration: 3725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506736099720001, gen p mean: -0.11833638697862625, mean p set: 0.4512515664100647
loss_pred:0.013853568583726883, decouple_loss:0.00035945107811130583
The modified gen p mean: 0.44895991683006287, gen p mean: -0.11720328032970428, mean p set: 0.44953563809394836
loss_pred:0.013784204609692097, decouple_loss:0.00031941861379891634
The modified gen p mean: 0.4489090144634247, gen p mean: -0.12744484841823578, mean p set: 0.4494830369949341
loss_pred:0.013790947385132313, decouple_loss:0.00027216767193749547
Iteration: 3726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960206747055054, gen p mean: -0.11932587623596191, mean p set: 0.4501778185367584
The modified gen p mean: 0.447860985994339, gen p mean: -0.12503096461296082, mean p set: 0.44843724370002747
loss_pred:0.014301626943051815, decouple_loss:0.0003884824982378632
loss_pred:0.013921591453254223, decouple_loss:0.0003943179617635906
The modified gen p mean: 0.450184166431427, gen p mean: -0.12330138683319092, mean p set: 0.45076262950897217
loss_pred:0.013335341587662697, decouple_loss:0.0003508488880470395
Iteration: 3727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877439737319946, gen p mean: -0.12167631834745407, mean p set: 0.4493516683578491
loss_pred:0.014874283224344254, decouple_loss:0.0003348905884195119
The modified gen p mean: 0.4505002498626709, gen p mean: -0.12118999660015106, mean p set: 0.4510750472545624
The modified gen p mean: 0.4501248598098755, gen p mean: -0.11950664967298508, mean p set: 0.4507005214691162
loss_pred:0.014084556140005589, decouple_loss:0.00032248441129922867
loss_pred:0.013193394057452679, decouple_loss:0.0002678290766198188
Iteration: 3728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447641521692276, gen p mean: -0.11418416351079941, mean p set: 0.4482172131538391
loss_pred:0.013887561857700348, decouple_loss:0.0003552667039912194
The modified gen p mean: 0.4493468701839447, gen p mean: -0.11987016350030899, mean p set: 0.4499257802963257
loss_pred:0.014147316105663776, decouple_loss:0.0003524449421092868
The modified gen p mean: 0.44981294870376587, gen p mean: -0.11614390462636948, mean p set: 0.4503912329673767
loss_pred:0.012774626724421978, decouple_loss:0.0003385802556294948
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 3729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457574188709259, gen p mean: -0.12266719341278076, mean p set: 0.4463326036930084
loss_pred:0.01414953637868166, decouple_loss:0.0003400104178581387
The modified gen p mean: 0.4470464587211609, gen p mean: -0.12324022501707077, mean p set: 0.44762295484542847
The modified gen p mean: 0.44728243350982666, gen p mean: -0.12203231453895569, mean p set: 0.44785624742507935
loss_pred:0.01443653553724289, decouple_loss:0.0003174429584760219
loss_pred:0.014103117398917675, decouple_loss:0.00036726854159496725
Iteration: 3730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482976496219635, gen p mean: -0.12021449208259583, mean p set: 0.44887736439704895
loss_pred:0.015359812416136265, decouple_loss:0.0003237223136238754
The modified gen p mean: 0.44604209065437317, gen p mean: -0.12136576324701309, mean p set: 0.4466158449649811
loss_pred:0.014214422553777695, decouple_loss:0.00033927446929737926
The modified gen p mean: 0.4464530944824219, gen p mean: -0.12174312770366669, mean p set: 0.44703078269958496
loss_pred:0.01433116290718317, decouple_loss:0.00035153210046701133
2023-05-02 18:00:47 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12460446357727051, mean p set: 0.4502691626548767
loss_pred:0.016735123470425606, decouple_loss:0.00039760113577358425
The modified gen p mean: 0.44953402876853943, gen p mean: -0.11809363216161728, mean p set: 0.4500633478164673
loss_pred:0.016143862158060074, decouple_loss:0.0003176435420755297
The modified gen p mean: 0.44982683658599854, gen p mean: -0.11751049757003784, mean p set: 0.45035696029663086
loss_pred:0.01643364131450653, decouple_loss:0.00035398948239162564
WV_1_PC_1_EH_0_PS_40, loss: 0.016455363482236862, avg_mse: 0.02576487697660923
current test mse: 0.025765
Iteration: 3731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472554326057434, gen p mean: -0.11888284236192703, mean p set: 0.44783279299736023
loss_pred:0.014600544236600399, decouple_loss:0.00040582858491688967
The modified gen p mean: 0.44693508744239807, gen p mean: -0.1232353001832962, mean p set: 0.4475100040435791
loss_pred:0.013921472243964672, decouple_loss:0.0003445419133640826
The modified gen p mean: 0.44743722677230835, gen p mean: -0.11961531639099121, mean p set: 0.4480137526988983
loss_pred:0.01458295714110136, decouple_loss:0.0003064330667257309
Iteration: 3732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714149832725525, gen p mean: -0.12025424838066101, mean p set: 0.44771912693977356
loss_pred:0.014403121545910835, decouple_loss:0.0003612608416005969
The modified gen p mean: 0.44660454988479614, gen p mean: -0.1247594803571701, mean p set: 0.44718244671821594The modified gen p mean: 0.4465152323246002, gen p mean: -0.12059854716062546, mean p set: 0.44709280133247375
loss_pred:0.014351838268339634, decouple_loss:0.0002672683331184089loss_pred:0.014354554004967213, decouple_loss:0.00032343753264285624
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759050011634827, gen p mean: -0.12282007932662964, mean p set: 0.4481663107872009
loss_pred:0.01503063552081585, decouple_loss:0.00037670062738470733
The modified gen p mean: 0.4463464617729187, gen p mean: -0.12320107221603394, mean p set: 0.44692057371139526
loss_pred:0.014340834692120552, decouple_loss:0.00029230600921437144
The modified gen p mean: 0.4463598430156708, gen p mean: -0.12090902775526047, mean p set: 0.44693562388420105
loss_pred:0.014343052171170712, decouple_loss:0.00043344369623810053
Iteration: 3734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475754499435425, gen p mean: -0.12483302503824234, mean p set: 0.44815176725387573
loss_pred:0.014242667704820633, decouple_loss:0.0003927836660295725
The modified gen p mean: 0.4480613172054291, gen p mean: -0.11801908165216446, mean p set: 0.44864004850387573
loss_pred:0.015008769929409027, decouple_loss:0.00047375590656884015
The modified gen p mean: 0.4468218982219696, gen p mean: -0.13086362183094025, mean p set: 0.44739779829978943
loss_pred:0.014422353357076645, decouple_loss:0.0003230344154872
Iteration: 3735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44605720043182373, gen p mean: -0.1266651153564453, mean p set: 0.4466286599636078
loss_pred:0.014410528354346752, decouple_loss:0.00041293553658761084
The modified gen p mean: 0.4486776888370514, gen p mean: -0.12685556709766388, mean p set: 0.4492546021938324
loss_pred:0.014645643532276154, decouple_loss:0.000351915747160092
The modified gen p mean: 0.44692501425743103, gen p mean: -0.12349449098110199, mean p set: 0.44750016927719116
loss_pred:0.015577607788145542, decouple_loss:0.0003760654362849891
Iteration: 3736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469848573207855, gen p mean: -0.12492037564516068, mean p set: 0.4475601017475128
loss_pred:0.014679883606731892, decouple_loss:0.00037126560346223414
The modified gen p mean: 0.4453669786453247, gen p mean: -0.12485501915216446, mean p set: 0.44594070315361023
loss_pred:0.014121036045253277, decouple_loss:0.00041591256740503013
The modified gen p mean: 0.44689252972602844, gen p mean: -0.12650959193706512, mean p set: 0.4474697411060333
loss_pred:0.014373362064361572, decouple_loss:0.0003882877354044467
Iteration: 3737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44621676206588745, gen p mean: -0.12649661302566528, mean p set: 0.44678959250450134
loss_pred:0.014060352928936481, decouple_loss:0.0003338951792102307
The modified gen p mean: 0.4466465711593628, gen p mean: -0.1256610006093979, mean p set: 0.4472208023071289
loss_pred:0.014539910480380058, decouple_loss:0.00032399510382674634
The modified gen p mean: 0.4477217197418213, gen p mean: -0.1285199522972107, mean p set: 0.44829845428466797
loss_pred:0.013946750201284885, decouple_loss:0.0002809312427416444
Iteration: 3738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730088114738464, gen p mean: -0.12321196496486664, mean p set: 0.44787725806236267
loss_pred:0.015057754702866077, decouple_loss:0.00042650316026993096
The modified gen p mean: 0.4474833607673645, gen p mean: -0.132144495844841, mean p set: 0.448056697845459
loss_pred:0.014179547317326069, decouple_loss:0.0003380361304152757
The modified gen p mean: 0.445431113243103, gen p mean: -0.12671323120594025, mean p set: 0.44600710272789
loss_pred:0.014475712552666664, decouple_loss:0.0003182805376127362
Iteration: 3739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469410181045532, gen p mean: -0.12204776704311371, mean p set: 0.447516530752182
loss_pred:0.014797522686421871, decouple_loss:0.00038167746970430017
The modified gen p mean: 0.4465910792350769, gen p mean: -0.12188102304935455, mean p set: 0.4471677839756012
loss_pred:0.014136296696960926, decouple_loss:0.0003468220529612154
The modified gen p mean: 0.4463167190551758, gen p mean: -0.12763278186321259, mean p set: 0.4468908905982971
loss_pred:0.014251381158828735, decouple_loss:0.0003309455933049321
Iteration: 3740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464091658592224, gen p mean: -0.12748311460018158, mean p set: 0.4469849467277527
loss_pred:0.014065204188227654, decouple_loss:0.0004120015655644238
The modified gen p mean: 0.44818219542503357, gen p mean: -0.12356200069189072, mean p set: 0.44875821471214294
loss_pred:0.014878240413963795, decouple_loss:0.000443972647190094
The modified gen p mean: 0.44727131724357605, gen p mean: -0.12674866616725922, mean p set: 0.4478478729724884
loss_pred:0.014055945910513401, decouple_loss:0.00032727085635997355
2023-05-02 18:02:55 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13019046187400818, mean p set: 0.4502691626548767
loss_pred:0.016835719347000122, decouple_loss:0.00040499333408661187
The modified gen p mean: 0.44953617453575134, gen p mean: -0.12415219098329544, mean p set: 0.4500633478164673
loss_pred:0.0161886066198349, decouple_loss:0.0003546850639395416
The modified gen p mean: 0.4498283565044403, gen p mean: -0.1233087033033371, mean p set: 0.45035696029663086
loss_pred:0.016529269516468048, decouple_loss:0.00038265562034212053
WV_1_PC_1_EH_0_PS_40, loss: 0.016536904498934746, avg_mse: 0.025854336097836494
current test mse: 0.025854
Iteration: 3741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719359278678894, gen p mean: -0.1325574517250061, mean p set: 0.44777220487594604
loss_pred:0.01426645927131176, decouple_loss:0.0004316122503951192
The modified gen p mean: 0.4467112421989441, gen p mean: -0.13055521249771118, mean p set: 0.4472857117652893
loss_pred:0.014060656540095806, decouple_loss:0.00034864229382947087
The modified gen p mean: 0.4464561343193054, gen p mean: -0.12890245020389557, mean p set: 0.4470318555831909
loss_pred:0.014180626720190048, decouple_loss:0.0003728295851033181
Iteration: 3742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490714967250824, gen p mean: -0.12759055197238922, mean p set: 0.44964826107025146
loss_pred:0.014525413513183594, decouple_loss:0.0003912262909580022
The modified gen p mean: 0.4465543031692505, gen p mean: -0.12873420119285583, mean p set: 0.4471312463283539The modified gen p mean: 0.4477696120738983, gen p mean: -0.1264614462852478, mean p set: 0.44834670424461365
loss_pred:0.01413656771183014, decouple_loss:0.00041575118666514754
loss_pred:0.014543036930263042, decouple_loss:0.00040244762203656137
Iteration: 3743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468275010585785, gen p mean: -0.12932263314723969, mean p set: 0.44740432500839233
loss_pred:0.014063422568142414, decouple_loss:0.0003275936469435692
The modified gen p mean: 0.44623875617980957, gen p mean: -0.1263808310031891, mean p set: 0.44681257009506226The modified gen p mean: 0.44788089394569397, gen p mean: -0.1257418990135193, mean p set: 0.44845691323280334
loss_pred:0.014429712668061256, decouple_loss:0.0004513282619882375loss_pred:0.013913830742239952, decouple_loss:0.000405002007028088
Iteration: 3744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758108258247375, gen p mean: -0.13044866919517517, mean p set: 0.4481556713581085
loss_pred:0.014297124929726124, decouple_loss:0.0003737886727321893
The modified gen p mean: 0.4491565525531769, gen p mean: -0.1276959478855133, mean p set: 0.44973060488700867
loss_pred:0.014489494264125824, decouple_loss:0.0005300308112055063
The modified gen p mean: 0.447009801864624, gen p mean: -0.13084784150123596, mean p set: 0.4475838840007782
loss_pred:0.014299320988357067, decouple_loss:0.0004571219615172595
Iteration: 3745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776883721351624, gen p mean: -0.1243823915719986, mean p set: 0.44834285974502563
loss_pred:0.014517251402139664, decouple_loss:0.00033259738120250404
The modified gen p mean: 0.44679564237594604, gen p mean: -0.12563414871692657, mean p set: 0.4473719894886017
loss_pred:0.014760902151465416, decouple_loss:0.00032175661181099713
The modified gen p mean: 0.4465391933917999, gen p mean: -0.1275775134563446, mean p set: 0.4471190571784973
loss_pred:0.013847854919731617, decouple_loss:0.00031077759922482073
Iteration: 3746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470829367637634, gen p mean: -0.12001647055149078, mean p set: 0.44765836000442505
loss_pred:0.015187744051218033, decouple_loss:0.00048288688412867486
The modified gen p mean: 0.44867220520973206, gen p mean: -0.12536810338497162, mean p set: 0.44924843311309814
loss_pred:0.014493467286229134, decouple_loss:0.0004901533247902989
The modified gen p mean: 0.4473889470100403, gen p mean: -0.12645407021045685, mean p set: 0.447966605424881
loss_pred:0.01409606821835041, decouple_loss:0.00048718054313212633
Iteration: 3747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44542962312698364, gen p mean: -0.12495485693216324, mean p set: 0.4460061490535736
loss_pred:0.014325786381959915, decouple_loss:0.0004028649418614805
The modified gen p mean: 0.44795262813568115, gen p mean: -0.12165870517492294, mean p set: 0.4485260546207428
loss_pred:0.014410571195185184, decouple_loss:0.0004570218443404883
The modified gen p mean: 0.4464150071144104, gen p mean: -0.12525013089179993, mean p set: 0.4469926357269287
loss_pred:0.014494137838482857, decouple_loss:0.0005336523172445595
Iteration: 3748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481791853904724, gen p mean: -0.12154652178287506, mean p set: 0.44875115156173706
loss_pred:0.014806837774813175, decouple_loss:0.0006434383685700595
The modified gen p mean: 0.44834399223327637, gen p mean: -0.1208946704864502, mean p set: 0.44892388582229614
loss_pred:0.014844882301986217, decouple_loss:0.0005883517442271113
The modified gen p mean: 0.44687822461128235, gen p mean: -0.12083068490028381, mean p set: 0.44745346903800964
loss_pred:0.015081419609487057, decouple_loss:0.00042504514567553997
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 3749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934508204460144, gen p mean: -0.12064339965581894, mean p set: 0.44992080330848694
The modified gen p mean: 0.4484003782272339, gen p mean: -0.12227920442819595, mean p set: 0.44897738099098206
loss_pred:0.014989176765084267, decouple_loss:0.0004701067809946835
loss_pred:0.013653469271957874, decouple_loss:0.0004679196572396904
The modified gen p mean: 0.44849103689193726, gen p mean: -0.12251773476600647, mean p set: 0.4490686058998108
loss_pred:0.014688769355416298, decouple_loss:0.0003938404843211174
Iteration: 3750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477510452270508, gen p mean: -0.118862085044384, mean p set: 0.44832542538642883
loss_pred:0.014580631628632545, decouple_loss:0.00040448474464938045
The modified gen p mean: 0.4487091302871704, gen p mean: -0.12220356613397598, mean p set: 0.4492858350276947
loss_pred:0.01368145551532507, decouple_loss:0.0003421880246605724
The modified gen p mean: 0.4487241208553314, gen p mean: -0.12482818961143494, mean p set: 0.44930025935173035
loss_pred:0.01392222661525011, decouple_loss:0.00033429573522880673
2023-05-02 18:05:53 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12853603065013885, mean p set: 0.4502691626548767
loss_pred:0.016826173290610313, decouple_loss:0.0004052465665154159
The modified gen p mean: 0.44953879714012146, gen p mean: -0.12222277373075485, mean p set: 0.4500633478164673
loss_pred:0.01608448103070259, decouple_loss:0.0005061399424448609
The modified gen p mean: 0.4498257637023926, gen p mean: -0.12154711782932281, mean p set: 0.45035696029663086
loss_pred:0.016438405960798264, decouple_loss:0.0005006697028875351
WV_1_PC_1_EH_0_PS_40, loss: 0.01647322252392769, avg_mse: 0.025828005746006966
current test mse: 0.025828
Iteration: 3751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491352438926697, gen p mean: -0.11565767973661423, mean p set: 0.44971105456352234
loss_pred:0.01403008121997118, decouple_loss:0.00035692061646841466
The modified gen p mean: 0.44872555136680603, gen p mean: -0.1197289451956749, mean p set: 0.44930222630500793The modified gen p mean: 0.4488603472709656, gen p mean: -0.12406022101640701, mean p set: 0.44943690299987793
loss_pred:0.014139212667942047, decouple_loss:0.0003258300421293825
loss_pred:0.013920209370553493, decouple_loss:0.0005126629839651287
Iteration: 3752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772884249687195, gen p mean: -0.12228191643953323, mean p set: 0.44830384850502014
loss_pred:0.013628662563860416, decouple_loss:0.0003619421913754195
The modified gen p mean: 0.4490862786769867, gen p mean: -0.12585055828094482, mean p set: 0.44965940713882446The modified gen p mean: 0.44738346338272095, gen p mean: -0.12683387100696564, mean p set: 0.4479579031467438
loss_pred:0.013555147685110569, decouple_loss:0.0002931081398855895
loss_pred:0.014243914745748043, decouple_loss:0.0005157016566954553
Iteration: 3753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448881059885025, gen p mean: -0.12583470344543457, mean p set: 0.44945937395095825
loss_pred:0.01322908978909254, decouple_loss:0.000275949394563213
The modified gen p mean: 0.4484807848930359, gen p mean: -0.1196901947259903, mean p set: 0.44905519485473633The modified gen p mean: 0.4496327340602875, gen p mean: -0.1266489326953888, mean p set: 0.450207382440567
loss_pred:0.014334547333419323, decouple_loss:0.0004081177175976336loss_pred:0.013697832822799683, decouple_loss:0.00030998222064226866
Iteration: 3754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498734474182129, gen p mean: -0.12704236805438995, mean p set: 0.4504498541355133
loss_pred:0.013780241832137108, decouple_loss:0.00027779670199379325
The modified gen p mean: 0.4479907155036926, gen p mean: -0.1199992299079895, mean p set: 0.4485659599304199
loss_pred:0.014390988275408745, decouple_loss:0.00042171592940576375
The modified gen p mean: 0.4485742151737213, gen p mean: -0.1283777356147766, mean p set: 0.449150025844574
loss_pred:0.01388176716864109, decouple_loss:0.00033694939338602126
Iteration: 3755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868189096450806, gen p mean: -0.12227091193199158, mean p set: 0.4492567181587219
loss_pred:0.014230781234800816, decouple_loss:0.0003791750641539693
The modified gen p mean: 0.4482613503932953, gen p mean: -0.12928836047649384, mean p set: 0.44883859157562256
loss_pred:0.013605165295302868, decouple_loss:0.0003244170220568776
The modified gen p mean: 0.4491298198699951, gen p mean: -0.12647727131843567, mean p set: 0.4497077465057373
loss_pred:0.014112541452050209, decouple_loss:0.00035628434852696955
Iteration: 3756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858691096305847, gen p mean: -0.12468832731246948, mean p set: 0.44916436076164246
loss_pred:0.013913829810917377, decouple_loss:0.00034410442458465695
The modified gen p mean: 0.4488542675971985, gen p mean: -0.12380751967430115, mean p set: 0.449429988861084
loss_pred:0.014674719423055649, decouple_loss:0.00036703466321341693
The modified gen p mean: 0.44735032320022583, gen p mean: -0.12986579537391663, mean p set: 0.4479256868362427
loss_pred:0.013923261314630508, decouple_loss:0.00033185933716595173
Iteration: 3757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848915934562683, gen p mean: -0.1279015839099884, mean p set: 0.4490663409233093
loss_pred:0.013763593509793282, decouple_loss:0.0003392927465029061
The modified gen p mean: 0.4490443766117096, gen p mean: -0.12050312012434006, mean p set: 0.4496217370033264
loss_pred:0.013602356426417828, decouple_loss:0.0003121819463558495
The modified gen p mean: 0.4496162533760071, gen p mean: -0.128137469291687, mean p set: 0.45019209384918213
loss_pred:0.014727125875651836, decouple_loss:0.00042307525291107595
Iteration: 3758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706273078918457, gen p mean: -0.12618643045425415, mean p set: 0.4476362466812134
loss_pred:0.014987836591899395, decouple_loss:0.00040819632704369724
The modified gen p mean: 0.44777360558509827, gen p mean: -0.12469528615474701, mean p set: 0.44834965467453003
loss_pred:0.014708880335092545, decouple_loss:0.000511285790707916
The modified gen p mean: 0.4486645758152008, gen p mean: -0.12611927092075348, mean p set: 0.4492400586605072
loss_pred:0.014870623126626015, decouple_loss:0.00030849254108034074
Iteration: 3759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483307898044586, gen p mean: -0.12182289361953735, mean p set: 0.4489034116268158
loss_pred:0.014017300680279732, decouple_loss:0.0003920800518244505
The modified gen p mean: 0.4479893147945404, gen p mean: -0.12111322581768036, mean p set: 0.44856372475624084
loss_pred:0.01391040813177824, decouple_loss:0.00042067101458087564
The modified gen p mean: 0.448086678981781, gen p mean: -0.12147796899080276, mean p set: 0.44866296648979187
loss_pred:0.014504620805382729, decouple_loss:0.0004332988755777478
Iteration: 3760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861868023872375, gen p mean: -0.11324068158864975, mean p set: 0.44919553399086
loss_pred:0.014125901274383068, decouple_loss:0.00048448448069393635
The modified gen p mean: 0.4480757713317871, gen p mean: -0.12533840537071228, mean p set: 0.4486553370952606
loss_pred:0.014375799335539341, decouple_loss:0.00035998522071167827
The modified gen p mean: 0.4493522644042969, gen p mean: -0.12115788459777832, mean p set: 0.44993188977241516
loss_pred:0.014100957661867142, decouple_loss:0.00038284165202639997
2023-05-02 18:08:01 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12177862972021103, mean p set: 0.4502691626548767
loss_pred:0.01676524430513382, decouple_loss:0.00040320673724636436
The modified gen p mean: 0.44953295588493347, gen p mean: -0.11641830950975418, mean p set: 0.4500633478164673
The modified gen p mean: 0.44982701539993286, gen p mean: -0.11597353965044022, mean p set: 0.45035696029663086
loss_pred:0.016070453450083733, decouple_loss:0.00039641704643145204
loss_pred:0.016411704942584038, decouple_loss:0.00038670518551953137
WV_1_PC_1_EH_0_PS_40, loss: 0.016435574740171432, avg_mse: 0.025753431022167206
current test mse: 0.025753
Iteration: 3761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493478536605835, gen p mean: -0.12043865025043488, mean p set: 0.4499247372150421
loss_pred:0.013493089005351067, decouple_loss:0.0002931755152530968
The modified gen p mean: 0.4478425085544586, gen p mean: -0.11357075721025467, mean p set: 0.44841691851615906The modified gen p mean: 0.4483078718185425, gen p mean: -0.1142156571149826, mean p set: 0.4488828480243683
loss_pred:0.013701588846743107, decouple_loss:0.00036869471659883857
loss_pred:0.01448946911841631, decouple_loss:0.0003671158629003912
Iteration: 3762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484477639198303, gen p mean: -0.11534108966588974, mean p set: 0.4490225911140442
loss_pred:0.014343743212521076, decouple_loss:0.00045827211579307914
The modified gen p mean: 0.44806575775146484, gen p mean: -0.11549501866102219, mean p set: 0.4486420452594757
The modified gen p mean: 0.44831544160842896, gen p mean: -0.11827066540718079, mean p set: 0.4488929510116577
loss_pred:0.01469258964061737, decouple_loss:0.0004582093097269535
loss_pred:0.014297626912593842, decouple_loss:0.0005008552689105272
Iteration: 3763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761452078819275, gen p mean: -0.11124039441347122, mean p set: 0.4481886029243469
loss_pred:0.013915454968810081, decouple_loss:0.00035096699139103293
The modified gen p mean: 0.4490746259689331, gen p mean: -0.12063545733690262, mean p set: 0.4496510326862335
loss_pred:0.01411702111363411, decouple_loss:0.00035500945523381233
The modified gen p mean: 0.44724348187446594, gen p mean: -0.11556648463010788, mean p set: 0.4478180706501007
loss_pred:0.014709940180182457, decouple_loss:0.00046078587183728814
Iteration: 3764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478498697280884, gen p mean: -0.12322717905044556, mean p set: 0.4484257698059082
loss_pred:0.01432476844638586, decouple_loss:0.0003994794387836009
The modified gen p mean: 0.4478917121887207, gen p mean: -0.12427222728729248, mean p set: 0.448469340801239
loss_pred:0.013875391334295273, decouple_loss:0.0003682585374917835
The modified gen p mean: 0.4475116729736328, gen p mean: -0.11498157680034637, mean p set: 0.4480898678302765
loss_pred:0.014316782355308533, decouple_loss:0.00037182148662395775
Iteration: 3765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44875451922416687, gen p mean: -0.1183466985821724, mean p set: 0.44932955503463745
loss_pred:0.014390924945473671, decouple_loss:0.0004253660445101559
The modified gen p mean: 0.44855451583862305, gen p mean: -0.11698973178863525, mean p set: 0.44913092255592346
loss_pred:0.01399285439401865, decouple_loss:0.00037989261909388006
The modified gen p mean: 0.4477347731590271, gen p mean: -0.11738327145576477, mean p set: 0.4483124613761902
loss_pred:0.01359037309885025, decouple_loss:0.0002667864318937063
Iteration: 3766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790971279144287, gen p mean: -0.1213243156671524, mean p set: 0.4484882652759552
loss_pred:0.013710212893784046, decouple_loss:0.0004891636781394482
The modified gen p mean: 0.44842442870140076, gen p mean: -0.12325809895992279, mean p set: 0.44900044798851013
The modified gen p mean: 0.4478254020214081, gen p mean: -0.11738385260105133, mean p set: 0.44840162992477417
loss_pred:0.01365557312965393, decouple_loss:0.0004038303450215608
loss_pred:0.013593068346381187, decouple_loss:0.0002972442307509482
Iteration: 3767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475916922092438, gen p mean: -0.11452479660511017, mean p set: 0.4481671154499054
loss_pred:0.013727364130318165, decouple_loss:0.0003787258465308696
The modified gen p mean: 0.4475180208683014, gen p mean: -0.11854879558086395, mean p set: 0.4480970501899719
The modified gen p mean: 0.44825348258018494, gen p mean: -0.12254679203033447, mean p set: 0.4488309919834137
loss_pred:0.013814728707075119, decouple_loss:0.00048379210056737065
loss_pred:0.014550280757248402, decouple_loss:0.0005037609953433275
Iteration: 3768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500995874404907, gen p mean: -0.1225312352180481, mean p set: 0.4506753385066986
loss_pred:0.01377307903021574, decouple_loss:0.000315599754685536
The modified gen p mean: 0.4483112394809723, gen p mean: -0.1260107457637787, mean p set: 0.4488871097564697
The modified gen p mean: 0.4486793279647827, gen p mean: -0.12280360609292984, mean p set: 0.44925642013549805
loss_pred:0.013778298161923885, decouple_loss:0.0003574201837182045
loss_pred:0.014446351677179337, decouple_loss:0.00042272277642041445
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 3769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471154808998108, gen p mean: -0.12256922572851181, mean p set: 0.4476914703845978
loss_pred:0.014347766526043415, decouple_loss:0.0003029152285307646
The modified gen p mean: 0.4464268684387207, gen p mean: -0.12703819572925568, mean p set: 0.44700247049331665
The modified gen p mean: 0.44866615533828735, gen p mean: -0.11051914840936661, mean p set: 0.44924309849739075
loss_pred:0.014876171015202999, decouple_loss:0.0002589841024018824
loss_pred:0.014236481860280037, decouple_loss:0.0003136972663924098
Iteration: 3770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741377234458923, gen p mean: -0.11873479187488556, mean p set: 0.44798827171325684
loss_pred:0.01373106986284256, decouple_loss:0.0004090016009286046
The modified gen p mean: 0.44798991084098816, gen p mean: -0.11794164031744003, mean p set: 0.4485653042793274
The modified gen p mean: 0.4478975534439087, gen p mean: -0.12726648151874542, mean p set: 0.4484758675098419
loss_pred:0.013675401918590069, decouple_loss:0.0003462327877059579
loss_pred:0.01423327624797821, decouple_loss:0.0003282488032709807
2023-05-02 18:10:46 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12666384875774384, mean p set: 0.4502691626548767
loss_pred:0.016749724745750427, decouple_loss:0.00034163787495344877
The modified gen p mean: 0.449535071849823, gen p mean: -0.1207333505153656, mean p set: 0.4500633478164673
loss_pred:0.01607711985707283, decouple_loss:0.0003727330476976931
The modified gen p mean: 0.449828565120697, gen p mean: -0.12014175951480865, mean p set: 0.45035696029663086
loss_pred:0.016405995935201645, decouple_loss:0.0003585248487070203
WV_1_PC_1_EH_0_PS_40, loss: 0.016428828239440918, avg_mse: 0.02576989121735096
current test mse: 0.02577
Iteration: 3771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484405815601349, gen p mean: -0.12015321850776672, mean p set: 0.4490176737308502
loss_pred:0.013907385990023613, decouple_loss:0.00033252997673116624
The modified gen p mean: 0.4471426010131836, gen p mean: -0.12335383892059326, mean p set: 0.44772061705589294The modified gen p mean: 0.44879886507987976, gen p mean: -0.11414985358715057, mean p set: 0.44937291741371155
loss_pred:0.014182533137500286, decouple_loss:0.0003394243831280619loss_pred:0.014065640978515148, decouple_loss:0.00033917423570528626
Iteration: 3772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477861523628235, gen p mean: -0.12101472169160843, mean p set: 0.44836175441741943
loss_pred:0.014214116148650646, decouple_loss:0.00036870758049190044
The modified gen p mean: 0.4470002353191376, gen p mean: -0.11892690509557724, mean p set: 0.4475743770599365The modified gen p mean: 0.44734999537467957, gen p mean: -0.1186278760433197, mean p set: 0.4479270875453949
loss_pred:0.01540557574480772, decouple_loss:0.00027196668088436127
loss_pred:0.013907580636441708, decouple_loss:0.0003211449075024575
Iteration: 3773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44672006368637085, gen p mean: -0.12311084568500519, mean p set: 0.44729676842689514
loss_pred:0.014369157142937183, decouple_loss:0.0002933992072939873
The modified gen p mean: 0.44619008898735046, gen p mean: -0.11538030207157135, mean p set: 0.44676467776298523
loss_pred:0.013787339441478252, decouple_loss:0.0003680018417071551
The modified gen p mean: 0.44753608107566833, gen p mean: -0.11527831107378006, mean p set: 0.4481112062931061
loss_pred:0.014883561991155148, decouple_loss:0.0003196223406121135
Iteration: 3774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653287529945374, gen p mean: -0.11356847733259201, mean p set: 0.447108656167984
loss_pred:0.013481693342328072, decouple_loss:0.00037525661173276603
The modified gen p mean: 0.4466817080974579, gen p mean: -0.12299774587154388, mean p set: 0.44725939631462097
loss_pred:0.014532671310007572, decouple_loss:0.0003430831420700997
The modified gen p mean: 0.44674596190452576, gen p mean: -0.12542006373405457, mean p set: 0.4473215639591217
loss_pred:0.014594083651900291, decouple_loss:0.00044487763079814613
Iteration: 3775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479047656059265, gen p mean: -0.12087541818618774, mean p set: 0.4484791159629822
loss_pred:0.014116749167442322, decouple_loss:0.00036882495624013245
The modified gen p mean: 0.44698846340179443, gen p mean: -0.12493646144866943, mean p set: 0.44756677746772766
loss_pred:0.014303214848041534, decouple_loss:0.00040346270543523133
The modified gen p mean: 0.4469509422779083, gen p mean: -0.11773290485143661, mean p set: 0.4475267231464386
loss_pred:0.014321454800665379, decouple_loss:0.0003743750276044011
Iteration: 3776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478970170021057, gen p mean: -0.11736197024583817, mean p set: 0.44847285747528076
loss_pred:0.013831332325935364, decouple_loss:0.00039813952753320336
The modified gen p mean: 0.4461759030818939, gen p mean: -0.11536319553852081, mean p set: 0.44675159454345703
The modified gen p mean: 0.44804006814956665, gen p mean: -0.12239757925271988, mean p set: 0.4486168920993805
loss_pred:0.014837086200714111, decouple_loss:0.00040898588486015797
loss_pred:0.014008183032274246, decouple_loss:0.0003500215243548155
Iteration: 3777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480929970741272, gen p mean: -0.11497481912374496, mean p set: 0.4486709535121918
loss_pred:0.013536155223846436, decouple_loss:0.00027705312822945416
The modified gen p mean: 0.4461984634399414, gen p mean: -0.12377320230007172, mean p set: 0.44677630066871643
The modified gen p mean: 0.4464208483695984, gen p mean: -0.11736177653074265, mean p set: 0.4469953179359436
loss_pred:0.014790309593081474, decouple_loss:0.00031481223413720727
loss_pred:0.014157703146338463, decouple_loss:0.00036815559724345803
Iteration: 3778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469982385635376, gen p mean: -0.11710576713085175, mean p set: 0.44756919145584106
loss_pred:0.01513676531612873, decouple_loss:0.0003886594495270401
The modified gen p mean: 0.44721460342407227, gen p mean: -0.11900820583105087, mean p set: 0.44779151678085327
loss_pred:0.0139989098533988, decouple_loss:0.00030777501524426043
The modified gen p mean: 0.4468262493610382, gen p mean: -0.11721616983413696, mean p set: 0.4474024176597595
loss_pred:0.014035305939614773, decouple_loss:0.0003497233847156167
Iteration: 3779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473685920238495, gen p mean: -0.12341447174549103, mean p set: 0.4479469656944275
loss_pred:0.014246723614633083, decouple_loss:0.0004016969178337604
The modified gen p mean: 0.44660618901252747, gen p mean: -0.11846384406089783, mean p set: 0.4471812844276428
loss_pred:0.014519997872412205, decouple_loss:0.0003116269363090396
The modified gen p mean: 0.44780439138412476, gen p mean: -0.1135326623916626, mean p set: 0.4483778774738312
loss_pred:0.013937747105956078, decouple_loss:0.0003013339883182198
Iteration: 3780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472261667251587, gen p mean: -0.12465203553438187, mean p set: 0.4478025436401367
loss_pred:0.013995631597936153, decouple_loss:0.0003830509667750448
The modified gen p mean: 0.44707927107810974, gen p mean: -0.12334338575601578, mean p set: 0.44765228033065796
The modified gen p mean: 0.44780492782592773, gen p mean: -0.11390229314565659, mean p set: 0.4483802020549774
loss_pred:0.01431470550596714, decouple_loss:0.00031567923724651337
loss_pred:0.013701409101486206, decouple_loss:0.00033968171919696033
2023-05-02 18:12:53 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12385938316583633, mean p set: 0.4502691626548767
loss_pred:0.016758330166339874, decouple_loss:0.0004120437952224165
The modified gen p mean: 0.449532687664032, gen p mean: -0.11785046011209488, mean p set: 0.4500633478164673
loss_pred:0.016036057844758034, decouple_loss:0.0003645314136520028
The modified gen p mean: 0.44982901215553284, gen p mean: -0.11712531745433807, mean p set: 0.45035696029663086
loss_pred:0.016434088349342346, decouple_loss:0.0003664131509140134
WV_1_PC_1_EH_0_PS_40, loss: 0.016428541392087936, avg_mse: 0.025742651894688606
current test mse: 0.025743
Iteration: 3781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733041524887085, gen p mean: -0.12171176075935364, mean p set: 0.44790735840797424
loss_pred:0.014112859964370728, decouple_loss:0.00035999069223180413
The modified gen p mean: 0.448291152715683, gen p mean: -0.11428266763687134, mean p set: 0.4488696753978729The modified gen p mean: 0.4476940631866455, gen p mean: -0.12298691272735596, mean p set: 0.44827136397361755
loss_pred:0.013528283685445786, decouple_loss:0.0003478712460491806
loss_pred:0.013911153189837933, decouple_loss:0.0004021504719275981
Iteration: 3782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447358101606369, gen p mean: -0.12262017279863358, mean p set: 0.44793838262557983
loss_pred:0.013997035101056099, decouple_loss:0.00041945339762605727
The modified gen p mean: 0.44731539487838745, gen p mean: -0.11633817106485367, mean p set: 0.4478895962238312The modified gen p mean: 0.4486071765422821, gen p mean: -0.11815465241670609, mean p set: 0.449184387922287
loss_pred:0.013619118370115757, decouple_loss:0.00030663239886052907loss_pred:0.013819369487464428, decouple_loss:0.0003275817434769124
Iteration: 3783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488203525543213, gen p mean: -0.11532581597566605, mean p set: 0.4493965804576874
loss_pred:0.013503842987120152, decouple_loss:0.0004947831621393561
The modified gen p mean: 0.44681891798973083, gen p mean: -0.11878799647092819, mean p set: 0.44739410281181335
loss_pred:0.014976576901972294, decouple_loss:0.00044714895193465054
The modified gen p mean: 0.4470185935497284, gen p mean: -0.12572310864925385, mean p set: 0.44759422540664673
loss_pred:0.0140800466760993, decouple_loss:0.00047708101919852197
Iteration: 3784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44645342230796814, gen p mean: -0.12091129273176193, mean p set: 0.4470299780368805
loss_pred:0.014670380391180515, decouple_loss:0.00033138899016194046
The modified gen p mean: 0.44806772470474243, gen p mean: -0.11434385180473328, mean p set: 0.4486429989337921
loss_pred:0.014078650623559952, decouple_loss:0.0003869726788252592
The modified gen p mean: 0.4483867883682251, gen p mean: -0.1224990040063858, mean p set: 0.4489628076553345
loss_pred:0.013835272751748562, decouple_loss:0.00032639416167512536
Iteration: 3785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466228783130646, gen p mean: -0.12861797213554382, mean p set: 0.4471994936466217
loss_pred:0.014464374631643295, decouple_loss:0.00029934808844700456
The modified gen p mean: 0.44767412543296814, gen p mean: -0.128465473651886, mean p set: 0.44824886322021484
loss_pred:0.013814810663461685, decouple_loss:0.0004762309545185417
The modified gen p mean: 0.446828156709671, gen p mean: -0.1224777102470398, mean p set: 0.4474049210548401
loss_pred:0.014198391698300838, decouple_loss:0.00036968360655009747
Iteration: 3786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717681407928467, gen p mean: -0.12601138651371002, mean p set: 0.4477514624595642
loss_pred:0.013767843134701252, decouple_loss:0.0004361319588497281
The modified gen p mean: 0.4477499723434448, gen p mean: -0.1250680685043335, mean p set: 0.44832685589790344
loss_pred:0.013916642405092716, decouple_loss:0.00037721265107393265
The modified gen p mean: 0.44716280698776245, gen p mean: -0.13097579777240753, mean p set: 0.4477385878562927
loss_pred:0.014264708384871483, decouple_loss:0.00041317474097013474
Iteration: 3787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820287823677063, gen p mean: -0.12130787968635559, mean p set: 0.44877946376800537
loss_pred:0.013473848812282085, decouple_loss:0.00048255265573970973
The modified gen p mean: 0.4474339485168457, gen p mean: -0.1273157000541687, mean p set: 0.44800853729248047
The modified gen p mean: 0.4476584792137146, gen p mean: -0.12704335153102875, mean p set: 0.4482361972332001
loss_pred:0.014268675819039345, decouple_loss:0.0003071250976063311
loss_pred:0.013972326181828976, decouple_loss:0.0004861602792516351
Iteration: 3788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486861526966095, gen p mean: -0.1292983740568161, mean p set: 0.44926023483276367
loss_pred:0.013919461518526077, decouple_loss:0.0003686236450448632
The modified gen p mean: 0.4479532837867737, gen p mean: -0.12932351231575012, mean p set: 0.4485274851322174
The modified gen p mean: 0.44737479090690613, gen p mean: -0.12949083745479584, mean p set: 0.44795170426368713
loss_pred:0.014010145328938961, decouple_loss:0.00033553497632965446
loss_pred:0.014092540368437767, decouple_loss:0.00040305950096808374
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
NaN value num: 0
Iteration: 3789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909587502479553, gen p mean: -0.12075306475162506, mean p set: 0.4496713876724243
loss_pred:0.014380445703864098, decouple_loss:0.00036800417001359165
The modified gen p mean: 0.4495794475078583, gen p mean: -0.12360256910324097, mean p set: 0.4501529335975647
The modified gen p mean: 0.45175883173942566, gen p mean: -0.12006355822086334, mean p set: 0.4523356258869171
loss_pred:0.014232168905436993, decouple_loss:0.0005689330864697695
loss_pred:0.014421678148210049, decouple_loss:0.0002592890232335776
Iteration: 3790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45017683506011963, gen p mean: -0.12173895537853241, mean p set: 0.45075175166130066
loss_pred:0.015434802509844303, decouple_loss:0.0004560520756058395
The modified gen p mean: 0.4512574076652527, gen p mean: -0.12422268837690353, mean p set: 0.45183131098747253
The modified gen p mean: 0.44982844591140747, gen p mean: -0.11253203451633453, mean p set: 0.4504052996635437
loss_pred:0.013803635723888874, decouple_loss:0.0004073286836501211
loss_pred:0.014835169538855553, decouple_loss:0.0004127600113861263
2023-05-02 18:15:39 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12824004888534546, mean p set: 0.4502691626548767
loss_pred:0.0167242344468832, decouple_loss:0.00043269494199194014
The modified gen p mean: 0.4495338201522827, gen p mean: -0.12186530232429504, mean p set: 0.4500633478164673
loss_pred:0.015994062647223473, decouple_loss:0.00041688751662150025
The modified gen p mean: 0.44982826709747314, gen p mean: -0.12137173861265182, mean p set: 0.45035696029663086
loss_pred:0.016328655183315277, decouple_loss:0.00035257881972938776
WV_1_PC_1_EH_0_PS_40, loss: 0.01636902056634426, avg_mse: 0.025606729090213776
current test mse: 0.025607
Iteration: 3791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450522780418396, gen p mean: -0.11699289828538895, mean p set: 0.45110228657722473
loss_pred:0.01515659224241972, decouple_loss:0.0004624275316018611
The modified gen p mean: 0.450070321559906, gen p mean: -0.10787729173898697, mean p set: 0.4506444036960602The modified gen p mean: 0.44892585277557373, gen p mean: -0.11726714670658112, mean p set: 0.4495031237602234
loss_pred:0.014527791179716587, decouple_loss:0.0003667395212687552
loss_pred:0.013640299439430237, decouple_loss:0.0005460212705656886
Iteration: 3792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520524740219116, gen p mean: -0.11051226407289505, mean p set: 0.45262953639030457
loss_pred:0.014627921395003796, decouple_loss:0.0003440513974055648
The modified gen p mean: 0.4514959752559662, gen p mean: -0.1098623126745224, mean p set: 0.45207199454307556The modified gen p mean: 0.4499932825565338, gen p mean: -0.11191261559724808, mean p set: 0.4505689740180969
loss_pred:0.014819049276411533, decouple_loss:0.0004012766876257956
loss_pred:0.014446715824306011, decouple_loss:0.000295982084935531
Iteration: 3793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509361982345581, gen p mean: -0.11087270081043243, mean p set: 0.45151498913764954
loss_pred:0.015162158757448196, decouple_loss:0.0003235262120142579
The modified gen p mean: 0.45085781812667847, gen p mean: -0.10626870393753052, mean p set: 0.4514326751232147
loss_pred:0.014042063616216183, decouple_loss:0.0005812293384224176
The modified gen p mean: 0.45039132237434387, gen p mean: -0.10560942441225052, mean p set: 0.4509684145450592
loss_pred:0.014515344984829426, decouple_loss:0.0005501622217707336
Iteration: 3794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886723160743713, gen p mean: -0.1066875010728836, mean p set: 0.44944292306900024
loss_pred:0.013808565214276314, decouple_loss:0.00044318876462057233
The modified gen p mean: 0.4482898414134979, gen p mean: -0.10295751690864563, mean p set: 0.4488658010959625
loss_pred:0.014099063351750374, decouple_loss:0.0003908105136360973
The modified gen p mean: 0.4499882459640503, gen p mean: -0.10314524918794632, mean p set: 0.4505685865879059
loss_pred:0.01534594688564539, decouple_loss:0.00044986174907535315
Iteration: 3795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490061104297638, gen p mean: -0.10168202221393585, mean p set: 0.4495818316936493
loss_pred:0.014442317187786102, decouple_loss:0.0003980542242061347
The modified gen p mean: 0.45057743787765503, gen p mean: -0.10884252190589905, mean p set: 0.45115405321121216
loss_pred:0.01457649003714323, decouple_loss:0.00042752103763632476
The modified gen p mean: 0.4505878984928131, gen p mean: -0.10375887900590897, mean p set: 0.45116233825683594
loss_pred:0.014414490200579166, decouple_loss:0.0003063314943574369
Iteration: 3796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44964200258255005, gen p mean: -0.11066053807735443, mean p set: 0.4502204656600952
loss_pred:0.013843327760696411, decouple_loss:0.0005280376062728465
The modified gen p mean: 0.4482869803905487, gen p mean: -0.10510624200105667, mean p set: 0.44886115193367004
loss_pred:0.013928456231951714, decouple_loss:0.0005912669003009796
The modified gen p mean: 0.4510257840156555, gen p mean: -0.10497201234102249, mean p set: 0.4516029953956604
loss_pred:0.014332521706819534, decouple_loss:0.0005224939668551087
Iteration: 3797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901391863822937, gen p mean: -0.11601664125919342, mean p set: 0.449592649936676
loss_pred:0.013774036429822445, decouple_loss:0.0005363133386708796
The modified gen p mean: 0.4498346447944641, gen p mean: -0.10885842144489288, mean p set: 0.4504128098487854
The modified gen p mean: 0.45096880197525024, gen p mean: -0.10792563110589981, mean p set: 0.4515463411808014
loss_pred:0.014112524688243866, decouple_loss:0.0005499920807778835
loss_pred:0.014227468520402908, decouple_loss:0.0004950223956257105
Iteration: 3798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121586322784424, gen p mean: -0.10880401730537415, mean p set: 0.45179483294487
loss_pred:0.01424655131995678, decouple_loss:0.00037316925590857863
The modified gen p mean: 0.4502749741077423, gen p mean: -0.10732926428318024, mean p set: 0.4508519768714905
loss_pred:0.013598807156085968, decouple_loss:0.00029328360687941313
The modified gen p mean: 0.44942760467529297, gen p mean: -0.10891993343830109, mean p set: 0.4500047266483307
loss_pred:0.01421426609158516, decouple_loss:0.00033328859717585146
Iteration: 3799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497896730899811, gen p mean: -0.11458459496498108, mean p set: 0.45036759972572327
loss_pred:0.014381594955921173, decouple_loss:0.00040631304727867246
The modified gen p mean: 0.4502359628677368, gen p mean: -0.1180294081568718, mean p set: 0.45081138610839844
loss_pred:0.014318691566586494, decouple_loss:0.0004328144423197955
The modified gen p mean: 0.4504204988479614, gen p mean: -0.11325126886367798, mean p set: 0.450996994972229
loss_pred:0.01481493841856718, decouple_loss:0.0005759970517829061
Iteration: 3800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518365263938904, gen p mean: -0.11377164721488953, mean p set: 0.45241379737854004
loss_pred:0.014345885254442692, decouple_loss:0.0006580202607437968
The modified gen p mean: 0.45012202858924866, gen p mean: -0.11173784732818604, mean p set: 0.4506988525390625
loss_pred:0.014031272381544113, decouple_loss:0.0005942920688539743
The modified gen p mean: 0.4498729109764099, gen p mean: -0.11414805799722672, mean p set: 0.45045042037963867
loss_pred:0.014478110708296299, decouple_loss:0.0003093637933488935
2023-05-02 18:17:46 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12732331454753876, mean p set: 0.4502691626548767
loss_pred:0.016755592077970505, decouple_loss:0.00040426073246635497
The modified gen p mean: 0.4495314359664917, gen p mean: -0.12148990482091904, mean p set: 0.4500633478164673
loss_pred:0.016083447262644768, decouple_loss:0.0004863808280788362
The modified gen p mean: 0.4498283863067627, gen p mean: -0.12074197083711624, mean p set: 0.45035696029663086
loss_pred:0.016391780227422714, decouple_loss:0.00042247428791597486
WV_1_PC_1_EH_0_PS_40, loss: 0.016432158648967743, avg_mse: 0.025734953582286835
current test mse: 0.025735
Iteration: 3801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010969042778015, gen p mean: -0.11993763595819473, mean p set: 0.45068684220314026
loss_pred:0.014088775031268597, decouple_loss:0.000540723092854023
The modified gen p mean: 0.44885435700416565, gen p mean: -0.11326886713504791, mean p set: 0.44943130016326904The modified gen p mean: 0.4498067796230316, gen p mean: -0.11033117026090622, mean p set: 0.45038288831710815
loss_pred:0.014342491514980793, decouple_loss:0.0007428245153278112loss_pred:0.014787843450903893, decouple_loss:0.00052916124695912
Iteration: 3802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502362608909607, gen p mean: -0.11416149139404297, mean p set: 0.45081067085266113
loss_pred:0.014268532395362854, decouple_loss:0.00040289846947416663
The modified gen p mean: 0.4489923417568207, gen p mean: -0.12443568557500839, mean p set: 0.44956985116004944The modified gen p mean: 0.44994255900382996, gen p mean: -0.11519670486450195, mean p set: 0.45051753520965576
loss_pred:0.014153452590107918, decouple_loss:0.0003579677431844175
loss_pred:0.014406290836632252, decouple_loss:0.00044699193676933646
Iteration: 3803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44991981983184814, gen p mean: -0.11409023404121399, mean p set: 0.4504949152469635
loss_pred:0.014268641360104084, decouple_loss:0.0005791637813672423
The modified gen p mean: 0.4491467773914337, gen p mean: -0.11802075058221817, mean p set: 0.4497208595275879The modified gen p mean: 0.44945138692855835, gen p mean: -0.11379639059305191, mean p set: 0.4500291645526886
loss_pred:0.01456373929977417, decouple_loss:0.00037912570405751467
loss_pred:0.014149140566587448, decouple_loss:0.0005131296929903328
Iteration: 3804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449781596660614, gen p mean: -0.11696940660476685, mean p set: 0.4503568708896637
loss_pred:0.013784638606011868, decouple_loss:0.0005742298089899123
The modified gen p mean: 0.45011159777641296, gen p mean: -0.11715899407863617, mean p set: 0.4506879150867462
loss_pred:0.014091353863477707, decouple_loss:0.00035502007813192904
The modified gen p mean: 0.44917115569114685, gen p mean: -0.11682473123073578, mean p set: 0.4497469365596771
loss_pred:0.01412195060402155, decouple_loss:0.0004758488794323057
Iteration: 3805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506606459617615, gen p mean: -0.11441821604967117, mean p set: 0.45123711228370667
loss_pred:0.015372260473668575, decouple_loss:0.0004149370070081204
The modified gen p mean: 0.4506344497203827, gen p mean: -0.11225229501724243, mean p set: 0.4512108564376831
loss_pred:0.014079813845455647, decouple_loss:0.0003958515590056777
The modified gen p mean: 0.4497171938419342, gen p mean: -0.1127830222249031, mean p set: 0.45029497146606445
loss_pred:0.014362203888595104, decouple_loss:0.00036485522286966443
Iteration: 3806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010244846343994, gen p mean: -0.10736909508705139, mean p set: 0.4506790041923523
loss_pred:0.014282741583883762, decouple_loss:0.0003800984122790396
The modified gen p mean: 0.44892239570617676, gen p mean: -0.11527357995510101, mean p set: 0.4494975507259369
The modified gen p mean: 0.449317067861557, gen p mean: -0.11759068816900253, mean p set: 0.4498935639858246
loss_pred:0.014093980193138123, decouple_loss:0.0005317274481058121
loss_pred:0.014219882898032665, decouple_loss:0.0004843455972149968
Iteration: 3807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45017433166503906, gen p mean: -0.1093631237745285, mean p set: 0.45075103640556335
loss_pred:0.0142654525116086, decouple_loss:0.00030711526051163673
The modified gen p mean: 0.44970107078552246, gen p mean: -0.11741036176681519, mean p set: 0.45027947425842285
loss_pred:0.014010969549417496, decouple_loss:0.000334090058458969
The modified gen p mean: 0.4517350494861603, gen p mean: -0.10976728051900864, mean p set: 0.4523118734359741
loss_pred:0.014523766934871674, decouple_loss:0.0003089048550464213
Iteration: 3808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449724942445755, gen p mean: -0.11954296380281448, mean p set: 0.45029953122138977
loss_pred:0.01416018046438694, decouple_loss:0.00034814042737707496
The modified gen p mean: 0.44920551776885986, gen p mean: -0.11247208714485168, mean p set: 0.4497842490673065
loss_pred:0.013851834461092949, decouple_loss:0.0003621692303568125
The modified gen p mean: 0.4504046142101288, gen p mean: -0.11012540757656097, mean p set: 0.45098140835762024
loss_pred:0.01436531450599432, decouple_loss:0.0004989337176084518
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 3809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470407962799072, gen p mean: -0.11876793950796127, mean p set: 0.4476131498813629
The modified gen p mean: 0.4475615918636322, gen p mean: -0.12045196443796158, mean p set: 0.4481387734413147
loss_pred:0.013801577500998974, decouple_loss:0.0003818512777797878
loss_pred:0.014455779455602169, decouple_loss:0.0003467509523034096
The modified gen p mean: 0.44726479053497314, gen p mean: -0.1183587834239006, mean p set: 0.4478406012058258
loss_pred:0.014943482354283333, decouple_loss:0.00029127931338734925
Iteration: 3810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476158320903778, gen p mean: -0.12168444693088531, mean p set: 0.44819164276123047
loss_pred:0.014200861565768719, decouple_loss:0.0004258929402567446
The modified gen p mean: 0.4470316469669342, gen p mean: -0.11422498524188995, mean p set: 0.44760891795158386
loss_pred:0.015196855179965496, decouple_loss:0.00045604867045767605
The modified gen p mean: 0.4476405382156372, gen p mean: -0.1173488199710846, mean p set: 0.44821682572364807
loss_pred:0.015012655407190323, decouple_loss:0.00040386361069977283
2023-05-02 18:20:33 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12790629267692566, mean p set: 0.4502691626548767
loss_pred:0.016838964074850082, decouple_loss:0.00042512043728493154
The modified gen p mean: 0.4495372772216797, gen p mean: -0.12127136439085007, mean p set: 0.4500633478164673
loss_pred:0.016144610941410065, decouple_loss:0.0003999156760983169
The modified gen p mean: 0.44982874393463135, gen p mean: -0.12063242495059967, mean p set: 0.45035696029663086
loss_pred:0.016447309404611588, decouple_loss:0.00033475892269052565
WV_1_PC_1_EH_0_PS_40, loss: 0.016496291384100914, avg_mse: 0.02581356093287468
current test mse: 0.025814
Iteration: 3811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477747678756714, gen p mean: -0.12214944511651993, mean p set: 0.4483511745929718
loss_pred:0.014393365010619164, decouple_loss:0.0003515065764077008
The modified gen p mean: 0.44735458493232727, gen p mean: -0.12458064407110214, mean p set: 0.44792893528938293
loss_pred:0.01505736168473959, decouple_loss:0.0003406173491384834
The modified gen p mean: 0.44763126969337463, gen p mean: -0.12028709799051285, mean p set: 0.4482089579105377
loss_pred:0.014769384637475014, decouple_loss:0.00037011256790719926
Iteration: 3812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460775852203369, gen p mean: -0.1243402287364006, mean p set: 0.44665300846099854
loss_pred:0.014666253700852394, decouple_loss:0.00042796030174940825
The modified gen p mean: 0.4477439820766449, gen p mean: -0.1250636726617813, mean p set: 0.44831904768943787The modified gen p mean: 0.44816896319389343, gen p mean: -0.12097471207380295, mean p set: 0.4487457573413849
loss_pred:0.014818273484706879, decouple_loss:0.0004920309875160456
loss_pred:0.014814849942922592, decouple_loss:0.0005109172780066729
Iteration: 3813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696640968322754, gen p mean: -0.12753751873970032, mean p set: 0.44754406809806824
loss_pred:0.014399886131286621, decouple_loss:0.0004290882789064199
The modified gen p mean: 0.44812771677970886, gen p mean: -0.12212810665369034, mean p set: 0.44870179891586304
loss_pred:0.01489342749118805, decouple_loss:0.0004760992305818945
The modified gen p mean: 0.44733113050460815, gen p mean: -0.12970475852489471, mean p set: 0.4479069411754608
loss_pred:0.014921552501618862, decouple_loss:0.0004044553788844496
Iteration: 3814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821348786354065, gen p mean: -0.12773780524730682, mean p set: 0.44879069924354553
The modified gen p mean: 0.44751670956611633, gen p mean: -0.12800726294517517, mean p set: 0.4480917155742645
loss_pred:0.014001772738993168, decouple_loss:0.0004999443772248924
loss_pred:0.014972423203289509, decouple_loss:0.00045462336856871843
The modified gen p mean: 0.4476628303527832, gen p mean: -0.12566077709197998, mean p set: 0.44823944568634033
loss_pred:0.014563219621777534, decouple_loss:0.00031422064057551324
Iteration: 3815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477103054523468, gen p mean: -0.12639519572257996, mean p set: 0.4482864737510681
loss_pred:0.014407712034881115, decouple_loss:0.0005019842064939439
The modified gen p mean: 0.4471714198589325, gen p mean: -0.12334610521793365, mean p set: 0.4477475583553314
loss_pred:0.013985298573970795, decouple_loss:0.00031818734714761376
The modified gen p mean: 0.44746729731559753, gen p mean: -0.12659777700901031, mean p set: 0.4480433166027069
loss_pred:0.013606187887489796, decouple_loss:0.00039585039485245943
Iteration: 3816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472448527812958, gen p mean: -0.12248405069112778, mean p set: 0.4478210508823395
loss_pred:0.014686055481433868, decouple_loss:0.0003742026165127754
The modified gen p mean: 0.4472886323928833, gen p mean: -0.12759119272232056, mean p set: 0.4478645324707031
The modified gen p mean: 0.44757142663002014, gen p mean: -0.12446297705173492, mean p set: 0.44814959168434143
loss_pred:0.014031722210347652, decouple_loss:0.00032298360019922256
loss_pred:0.01420131791383028, decouple_loss:0.0004782135074492544
Iteration: 3817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660159945487976, gen p mean: -0.12406844645738602, mean p set: 0.4471800923347473
loss_pred:0.014830460771918297, decouple_loss:0.00045112462248653173
The modified gen p mean: 0.44671928882598877, gen p mean: -0.123307965695858, mean p set: 0.4472944438457489
The modified gen p mean: 0.4472482204437256, gen p mean: -0.12236598134040833, mean p set: 0.4478244483470917
loss_pred:0.014291596598923206, decouple_loss:0.000304874760331586
loss_pred:0.014299112372100353, decouple_loss:0.00036928095505572855
Iteration: 3818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471442401409149, gen p mean: -0.1230655312538147, mean p set: 0.44771865010261536
loss_pred:0.013916878029704094, decouple_loss:0.0004549189761746675
The modified gen p mean: 0.44712698459625244, gen p mean: -0.12114904820919037, mean p set: 0.44770246744155884
The modified gen p mean: 0.448750376701355, gen p mean: -0.12170117348432541, mean p set: 0.4493274986743927
loss_pred:0.014211398549377918, decouple_loss:0.0004306111659388989
loss_pred:0.014517472125589848, decouple_loss:0.0005957419634796679
Iteration: 3819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447660893201828, gen p mean: -0.12103258073329926, mean p set: 0.4482399523258209
loss_pred:0.014836410991847515, decouple_loss:0.0005688415258191526
The modified gen p mean: 0.4470409154891968, gen p mean: -0.12286017090082169, mean p set: 0.44761648774147034
loss_pred:0.014006285928189754, decouple_loss:0.0004348397196736187
The modified gen p mean: 0.4486341178417206, gen p mean: -0.11472097039222717, mean p set: 0.4492107927799225
loss_pred:0.014597086235880852, decouple_loss:0.0004019751795567572
Iteration: 3820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44648465514183044, gen p mean: -0.121064692735672, mean p set: 0.44706112146377563
loss_pred:0.014599055051803589, decouple_loss:0.0003987663076259196
The modified gen p mean: 0.4482429623603821, gen p mean: -0.11760254949331284, mean p set: 0.4488186836242676
The modified gen p mean: 0.44687435030937195, gen p mean: -0.1203288659453392, mean p set: 0.44745007157325745
loss_pred:0.014462760649621487, decouple_loss:0.00045156985288485885
loss_pred:0.013852257281541824, decouple_loss:0.00039623549673706293
2023-05-02 18:22:40 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12465144693851471, mean p set: 0.4502691626548767
loss_pred:0.0168154276907444, decouple_loss:0.0003291372850071639
The modified gen p mean: 0.44953569769859314, gen p mean: -0.11868108063936234, mean p set: 0.4500633478164673
The modified gen p mean: 0.4498309791088104, gen p mean: -0.11799710243940353, mean p set: 0.45035696029663086
loss_pred:0.016079815104603767, decouple_loss:0.00037812135997228324
loss_pred:0.01642010174691677, decouple_loss:0.0003649380523711443
WV_1_PC_1_EH_0_PS_40, loss: 0.016456319019198418, avg_mse: 0.02576139196753502
current test mse: 0.025761
Iteration: 3821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460281431674957, gen p mean: -0.11667463183403015, mean p set: 0.44660380482673645
loss_pred:0.014784585684537888, decouple_loss:0.0003581617493182421
The modified gen p mean: 0.4476555585861206, gen p mean: -0.12001169472932816, mean p set: 0.4482308626174927The modified gen p mean: 0.44727736711502075, gen p mean: -0.11607284098863602, mean p set: 0.44785353541374207
loss_pred:0.014398436062037945, decouple_loss:0.0002973813971038908
loss_pred:0.014338619075715542, decouple_loss:0.00024710578145459294
Iteration: 3822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477059543132782, gen p mean: -0.12655574083328247, mean p set: 0.44828295707702637
loss_pred:0.014809500426054, decouple_loss:0.0004529099096544087
The modified gen p mean: 0.44881272315979004, gen p mean: -0.11517903953790665, mean p set: 0.4493890404701233The modified gen p mean: 0.4474945664405823, gen p mean: -0.12369384616613388, mean p set: 0.44806867837905884
loss_pred:0.014223617501556873, decouple_loss:0.00042547014891169965
loss_pred:0.014546350575983524, decouple_loss:0.0005383053212426603
Iteration: 3823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846680760383606, gen p mean: -0.12144091725349426, mean p set: 0.44904205203056335
loss_pred:0.014148730784654617, decouple_loss:0.0005158436251804233
The modified gen p mean: 0.44674360752105713, gen p mean: -0.11554031819105148, mean p set: 0.44731831550598145
loss_pred:0.014785483479499817, decouple_loss:0.0003508745285216719
The modified gen p mean: 0.4482874572277069, gen p mean: -0.11991162598133087, mean p set: 0.4488621652126312
loss_pred:0.014717395417392254, decouple_loss:0.0003441827720962465
Iteration: 3824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473537504673004, gen p mean: -0.12538602948188782, mean p set: 0.4479289650917053
loss_pred:0.014844109304249287, decouple_loss:0.0003759521641768515
The modified gen p mean: 0.44716930389404297, gen p mean: -0.12123207002878189, mean p set: 0.4477413594722748
loss_pred:0.014472849667072296, decouple_loss:0.0003745683643501252
The modified gen p mean: 0.44788309931755066, gen p mean: -0.12384115904569626, mean p set: 0.44846081733703613
loss_pred:0.014007137157022953, decouple_loss:0.0003833763475995511
Iteration: 3825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764867424964905, gen p mean: -0.1265849471092224, mean p set: 0.4482249617576599
loss_pred:0.014148026704788208, decouple_loss:0.0004903921508230269
The modified gen p mean: 0.4477837383747101, gen p mean: -0.11426755040884018, mean p set: 0.4483618438243866
loss_pred:0.014229065738618374, decouple_loss:0.0003417793777771294
The modified gen p mean: 0.4471700191497803, gen p mean: -0.12472476810216904, mean p set: 0.4477456510066986
loss_pred:0.014702217653393745, decouple_loss:0.0003415897663217038
Iteration: 3826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480704367160797, gen p mean: -0.11555055528879166, mean p set: 0.4486466944217682
loss_pred:0.01444848719984293, decouple_loss:0.000316757766995579
The modified gen p mean: 0.4479815661907196, gen p mean: -0.12291709333658218, mean p set: 0.44855615496635437
The modified gen p mean: 0.44820070266723633, gen p mean: -0.11931151151657104, mean p set: 0.44877755641937256
loss_pred:0.014273477718234062, decouple_loss:0.0005134862149134278
loss_pred:0.01471820380538702, decouple_loss:0.00026234271354041994
Iteration: 3827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468523859977722, gen p mean: -0.12629373371601105, mean p set: 0.44742754101753235
loss_pred:0.01384864840656519, decouple_loss:0.0003155320300720632
The modified gen p mean: 0.4489133954048157, gen p mean: -0.11894339323043823, mean p set: 0.4494889974594116
loss_pred:0.013703351840376854, decouple_loss:0.0003316864022053778
The modified gen p mean: 0.4474332928657532, gen p mean: -0.125459223985672, mean p set: 0.4480080008506775
loss_pred:0.014627090655267239, decouple_loss:0.00031191849848255515
Iteration: 3828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474427103996277, gen p mean: -0.12351511418819427, mean p set: 0.44802039861679077
loss_pred:0.013943037018179893, decouple_loss:0.0002800891816150397
The modified gen p mean: 0.44744789600372314, gen p mean: -0.12201159447431564, mean p set: 0.4480248689651489
loss_pred:0.014135666191577911, decouple_loss:0.0003233189636375755
The modified gen p mean: 0.44819265604019165, gen p mean: -0.12175225466489792, mean p set: 0.4487678110599518
loss_pred:0.014223294332623482, decouple_loss:0.0003698358777910471
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
NaN value num: 0
Iteration: 3829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904643297195435, gen p mean: -0.12163897603750229, mean p set: 0.4496227502822876
loss_pred:0.013348929584026337, decouple_loss:0.00036988002830184996
The modified gen p mean: 0.44943177700042725, gen p mean: -0.1109091117978096, mean p set: 0.4500081539154053
The modified gen p mean: 0.44962456822395325, gen p mean: -0.11553005129098892, mean p set: 0.45020246505737305
loss_pred:0.01487841084599495, decouple_loss:0.0004576064820867032
loss_pred:0.014611382968723774, decouple_loss:0.0005140691064298153
Iteration: 3830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45142224431037903, gen p mean: -0.10956695675849915, mean p set: 0.45200085639953613
loss_pred:0.01437292993068695, decouple_loss:0.0005226793582551181
The modified gen p mean: 0.44962719082832336, gen p mean: -0.114199697971344, mean p set: 0.45020341873168945
loss_pred:0.014833730645477772, decouple_loss:0.0004302453307900578
The modified gen p mean: 0.4492102265357971, gen p mean: -0.11349403858184814, mean p set: 0.4497832953929901
loss_pred:0.014882303774356842, decouple_loss:0.0004266047035343945
2023-05-02 18:25:31 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1274569183588028, mean p set: 0.4502691626548767
loss_pred:0.016834959387779236, decouple_loss:0.000434172892710194
The modified gen p mean: 0.44953376054763794, gen p mean: -0.12166246026754379, mean p set: 0.4500633478164673
loss_pred:0.01606789603829384, decouple_loss:0.00035745452623814344
The modified gen p mean: 0.44982603192329407, gen p mean: -0.12113470584154129, mean p set: 0.45035696029663086
loss_pred:0.016285499557852745, decouple_loss:0.0003494752454571426
WV_1_PC_1_EH_0_PS_40, loss: 0.01641513779759407, avg_mse: 0.02570803090929985
current test mse: 0.025708
Iteration: 3831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492371380329132, gen p mean: -0.1211215928196907, mean p set: 0.4498123526573181
loss_pred:0.01448504813015461, decouple_loss:0.00032201086287386715
The modified gen p mean: 0.451488733291626, gen p mean: -0.11355771869421005, mean p set: 0.45206427574157715
The modified gen p mean: 0.4492824673652649, gen p mean: -0.11498096585273743, mean p set: 0.4498610198497772
loss_pred:0.014811367727816105, decouple_loss:0.0003614249581005424
loss_pred:0.014892930164933205, decouple_loss:0.0003653430030681193
Iteration: 3832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496658444404602, gen p mean: -0.11881721764802933, mean p set: 0.4502403438091278
loss_pred:0.01374038401991129, decouple_loss:0.00046808700426481664
The modified gen p mean: 0.44955313205718994, gen p mean: -0.12452033162117004, mean p set: 0.4501286447048187The modified gen p mean: 0.4520775079727173, gen p mean: -0.11503930389881134, mean p set: 0.45265159010887146
loss_pred:0.01303175836801529, decouple_loss:0.00041010373388417065
loss_pred:0.01419792976230383, decouple_loss:0.0007275707321241498
Iteration: 3833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495839774608612, gen p mean: -0.12800002098083496, mean p set: 0.4501604735851288
loss_pred:0.013681820593774319, decouple_loss:0.0003778040991164744
The modified gen p mean: 0.45116859674453735, gen p mean: -0.11823417246341705, mean p set: 0.45174553990364075
The modified gen p mean: 0.45070308446884155, gen p mean: -0.11983782798051834, mean p set: 0.4512771964073181
loss_pred:0.014695661142468452, decouple_loss:0.0005146986804902554
loss_pred:0.014677309431135654, decouple_loss:0.00040588900446891785
Iteration: 3834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010122656822205, gen p mean: -0.11960283666849136, mean p set: 0.45067763328552246
loss_pred:0.014347686432301998, decouple_loss:0.0003265551058575511
The modified gen p mean: 0.4499354064464569, gen p mean: -0.11837863177061081, mean p set: 0.45051491260528564
loss_pred:0.013903629034757614, decouple_loss:0.0005178548162803054
The modified gen p mean: 0.44924643635749817, gen p mean: -0.11298133432865143, mean p set: 0.44982221722602844
loss_pred:0.014927614480257034, decouple_loss:0.00038808005047030747
Iteration: 3835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45036348700523376, gen p mean: -0.11857465654611588, mean p set: 0.45093992352485657
loss_pred:0.015005992725491524, decouple_loss:0.00036984574398957193
The modified gen p mean: 0.44981473684310913, gen p mean: -0.11532027274370193, mean p set: 0.45039013028144836
loss_pred:0.014621121808886528, decouple_loss:0.0004212729400023818
The modified gen p mean: 0.44970041513442993, gen p mean: -0.12537895143032074, mean p set: 0.450275719165802
loss_pred:0.013185227289795876, decouple_loss:0.0003465272893663496
Iteration: 3836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900190830230713, gen p mean: -0.12288717180490494, mean p set: 0.44958019256591797
loss_pred:0.013669496402144432, decouple_loss:0.0003391440841369331
The modified gen p mean: 0.44943341612815857, gen p mean: -0.1136990636587143, mean p set: 0.4500085711479187
loss_pred:0.014945633709430695, decouple_loss:0.00037093268474563956
The modified gen p mean: 0.4510258436203003, gen p mean: -0.111942358314991, mean p set: 0.4516032636165619
loss_pred:0.014225511811673641, decouple_loss:0.0005103106959722936
Iteration: 3837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449131041765213, gen p mean: -0.11496028304100037, mean p set: 0.44970813393592834
loss_pred:0.014154980890452862, decouple_loss:0.0003586886159610003
The modified gen p mean: 0.45109912753105164, gen p mean: -0.11389416456222534, mean p set: 0.451677143573761
loss_pred:0.01480445172637701, decouple_loss:0.000392722460674122
The modified gen p mean: 0.44901803135871887, gen p mean: -0.10847409069538116, mean p set: 0.4495929181575775
loss_pred:0.014457318931818008, decouple_loss:0.0003279244410805404
Iteration: 3838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449093222618103, gen p mean: -0.11721114814281464, mean p set: 0.4496690630912781
loss_pred:0.013811755925416946, decouple_loss:0.0004699256969615817
The modified gen p mean: 0.44915643334388733, gen p mean: -0.108247309923172, mean p set: 0.4497336745262146
loss_pred:0.01435042079538107, decouple_loss:0.0005532057257369161
The modified gen p mean: 0.44920772314071655, gen p mean: -0.11401910334825516, mean p set: 0.44978389143943787
loss_pred:0.013412530533969402, decouple_loss:0.00048225672799162567
Iteration: 3839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502265155315399, gen p mean: -0.1140480637550354, mean p set: 0.45080122351646423
loss_pred:0.014772841706871986, decouple_loss:0.00040040662861429155
The modified gen p mean: 0.4488625228404999, gen p mean: -0.11213261634111404, mean p set: 0.4494384825229645
loss_pred:0.013655237853527069, decouple_loss:0.0003973129787482321
The modified gen p mean: 0.45052918791770935, gen p mean: -0.110649473965168, mean p set: 0.4511072635650635
loss_pred:0.014541145414113998, decouple_loss:0.000433089560829103
Iteration: 3840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489969313144684, gen p mean: -0.10872981697320938, mean p set: 0.44957494735717773
loss_pred:0.0134640634059906, decouple_loss:0.0003409411874599755
The modified gen p mean: 0.44936540722846985, gen p mean: -0.1152089536190033, mean p set: 0.44994187355041504
The modified gen p mean: 0.4494911730289459, gen p mean: -0.10530198365449905, mean p set: 0.45006775856018066
loss_pred:0.01372452825307846, decouple_loss:0.00030796267674304545
loss_pred:0.014231912791728973, decouple_loss:0.00030318807694129646
2023-05-02 18:27:37 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12135861068964005, mean p set: 0.4502691626548767
loss_pred:0.01689353957772255, decouple_loss:0.0004256795218680054
The modified gen p mean: 0.44953563809394836, gen p mean: -0.11535998433828354, mean p set: 0.4500633478164673
loss_pred:0.01613820716738701, decouple_loss:0.0004641616833396256
The modified gen p mean: 0.4498277008533478, gen p mean: -0.1149507537484169, mean p set: 0.45035696029663086
loss_pred:0.01633508689701557, decouple_loss:0.0004758522263728082
WV_1_PC_1_EH_0_PS_40, loss: 0.01647837460041046, avg_mse: 0.02578256092965603
current test mse: 0.025783
Iteration: 3841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517650306224823, gen p mean: -0.10213115811347961, mean p set: 0.4523402154445648
loss_pred:0.015025983564555645, decouple_loss:0.00036190389073453844
The modified gen p mean: 0.44980722665786743, gen p mean: -0.10687658190727234, mean p set: 0.4503854513168335The modified gen p mean: 0.449785977602005, gen p mean: -0.10950157791376114, mean p set: 0.4503614008426666
loss_pred:0.013427621684968472, decouple_loss:0.00030670934938825667loss_pred:0.014378957450389862, decouple_loss:0.00040242585237137973
Iteration: 3842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496864974498749, gen p mean: -0.11107537895441055, mean p set: 0.4502619802951813The modified gen p mean: 0.45040079951286316, gen p mean: -0.10460459440946579, mean p set: 0.4509774148464203
loss_pred:0.014528490602970123, decouple_loss:0.00039626299985684454
loss_pred:0.014662327244877815, decouple_loss:0.0003156951570417732
The modified gen p mean: 0.4493864178657532, gen p mean: -0.1039670780301094, mean p set: 0.44996196031570435
loss_pred:0.015023631043732166, decouple_loss:0.0004041713837068528
Iteration: 3843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45112261176109314, gen p mean: -0.10653109848499298, mean p set: 0.45169880986213684
loss_pred:0.014432436786592007, decouple_loss:0.0003587652463465929
The modified gen p mean: 0.45007839798927307, gen p mean: -0.11215759813785553, mean p set: 0.45065566897392273
loss_pred:0.01430589985102415, decouple_loss:0.0003180823114234954
The modified gen p mean: 0.4489341378211975, gen p mean: -0.10512689501047134, mean p set: 0.44950950145721436
loss_pred:0.014442451298236847, decouple_loss:0.00031852468964643776
Iteration: 3844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890719652175903, gen p mean: -0.1072194054722786, mean p set: 0.44948339462280273
loss_pred:0.013998406939208508, decouple_loss:0.0003964051138609648
The modified gen p mean: 0.4510447084903717, gen p mean: -0.10647029429674149, mean p set: 0.4516216814517975
loss_pred:0.01473819836974144, decouple_loss:0.00029033140162937343
The modified gen p mean: 0.44979825615882874, gen p mean: -0.10950425267219543, mean p set: 0.4503765404224396
loss_pred:0.01456886250525713, decouple_loss:0.0004382784536574036
Iteration: 3845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493367671966553, gen p mean: -0.11044259369373322, mean p set: 0.44991159439086914
loss_pred:0.013645054772496223, decouple_loss:0.0002861933608073741
The modified gen p mean: 0.44999930262565613, gen p mean: -0.11003991216421127, mean p set: 0.4505756199359894
loss_pred:0.014752219431102276, decouple_loss:0.0004171327454969287
The modified gen p mean: 0.4517548084259033, gen p mean: -0.10907557606697083, mean p set: 0.45233187079429626
loss_pred:0.015004015527665615, decouple_loss:0.00034915388096123934
Iteration: 3846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514971673488617, gen p mean: -0.10079336166381836, mean p set: 0.45207321643829346
loss_pred:0.014754589647054672, decouple_loss:0.00038087766733951867
The modified gen p mean: 0.4490361213684082, gen p mean: -0.11429473012685776, mean p set: 0.44961148500442505
The modified gen p mean: 0.4524993300437927, gen p mean: -0.11331645399332047, mean p set: 0.4530782699584961
loss_pred:0.01405355054885149, decouple_loss:0.00037455104757100344
loss_pred:0.0144368140026927, decouple_loss:0.0006989933317527175
Iteration: 3847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513041377067566, gen p mean: -0.10169916599988937, mean p set: 0.4518806040287018
loss_pred:0.014229944907128811, decouple_loss:0.00041365617653355
The modified gen p mean: 0.4512999355792999, gen p mean: -0.11055469512939453, mean p set: 0.45187583565711975
The modified gen p mean: 0.4489833414554596, gen p mean: -0.11641969531774521, mean p set: 0.4495577812194824
loss_pred:0.01457737572491169, decouple_loss:0.0005322452052496374
loss_pred:0.01429690606892109, decouple_loss:0.00039659542380832136
Iteration: 3848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45014381408691406, gen p mean: -0.11085231602191925, mean p set: 0.45071735978126526
loss_pred:0.013486615382134914, decouple_loss:0.00039321277290582657
The modified gen p mean: 0.4511743187904358, gen p mean: -0.11146596819162369, mean p set: 0.45175236463546753
loss_pred:0.014716885052621365, decouple_loss:0.00035366209340281785
The modified gen p mean: 0.4497831463813782, gen p mean: -0.11800425499677658, mean p set: 0.4503604471683502
loss_pred:0.013293729163706303, decouple_loss:0.0003507401270326227
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
NaN value num: 0
Iteration: 3849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532403349876404, gen p mean: -0.1044754832983017, mean p set: 0.4538169205188751
loss_pred:0.014352286234498024, decouple_loss:0.0005224354681558907
The modified gen p mean: 0.4534446895122528, gen p mean: -0.1054190918803215, mean p set: 0.4540198743343353
The modified gen p mean: 0.4537295699119568, gen p mean: -0.10298357158899307, mean p set: 0.4543079137802124
loss_pred:0.014916430227458477, decouple_loss:0.0004706874897237867
loss_pred:0.015609287656843662, decouple_loss:0.0003586816310416907
Iteration: 3850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45180457830429077, gen p mean: -0.10299532860517502, mean p set: 0.452383428812027
loss_pred:0.015268586575984955, decouple_loss:0.0004214028303977102
The modified gen p mean: 0.45085304975509644, gen p mean: -0.10289827734231949, mean p set: 0.4514295160770416
loss_pred:0.015350177884101868, decouple_loss:0.0004613939090631902
The modified gen p mean: 0.4544859826564789, gen p mean: -0.10493521392345428, mean p set: 0.45506227016448975
loss_pred:0.015153818763792515, decouple_loss:0.0003787153400480747
2023-05-02 18:30:20 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1200919821858406, mean p set: 0.4502691626548767
loss_pred:0.016893010586500168, decouple_loss:0.00042604253394529223
The modified gen p mean: 0.44953086972236633, gen p mean: -0.11394708603620529, mean p set: 0.4500633478164673
loss_pred:0.01612476073205471, decouple_loss:0.0004087153647560626
The modified gen p mean: 0.44982993602752686, gen p mean: -0.11364680528640747, mean p set: 0.45035696029663086
loss_pred:0.01639108918607235, decouple_loss:0.0003760354302357882
WV_1_PC_1_EH_0_PS_40, loss: 0.016489800065755844, avg_mse: 0.025789564475417137
current test mse: 0.02579
Iteration: 3851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45182427763938904, gen p mean: -0.10491498559713364, mean p set: 0.4524010717868805
loss_pred:0.01572788879275322, decouple_loss:0.0003549476678017527
The modified gen p mean: 0.45098868012428284, gen p mean: -0.10512464493513107, mean p set: 0.45156678557395935
loss_pred:0.015584251843392849, decouple_loss:0.0003702054964378476
The modified gen p mean: 0.4531608819961548, gen p mean: -0.10298516601324081, mean p set: 0.4537392258644104
loss_pred:0.015331021510064602, decouple_loss:0.0003653785097412765
Iteration: 3852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45295974612236023, gen p mean: -0.11005540192127228, mean p set: 0.4535352885723114The modified gen p mean: 0.4515687823295593, gen p mean: -0.10619302839040756, mean p set: 0.45214447379112244
loss_pred:0.014798938296735287, decouple_loss:0.0003882022574543953
loss_pred:0.014965969137847424, decouple_loss:0.0003735691134352237
The modified gen p mean: 0.4536001682281494, gen p mean: -0.10654424130916595, mean p set: 0.45417800545692444
loss_pred:0.015064775943756104, decouple_loss:0.0003939088201150298
Iteration: 3853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45358210802078247, gen p mean: -0.11141198128461838, mean p set: 0.4541594386100769
loss_pred:0.014751041308045387, decouple_loss:0.000320373015711084
The modified gen p mean: 0.4529397189617157, gen p mean: -0.10723807662725449, mean p set: 0.45351678133010864The modified gen p mean: 0.45151278376579285, gen p mean: -0.10927055776119232, mean p set: 0.45208826661109924
loss_pred:0.014801852405071259, decouple_loss:0.00034039063029922545
loss_pred:0.014685397036373615, decouple_loss:0.0005163911264389753
Iteration: 3854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451934278011322, gen p mean: -0.10904238373041153, mean p set: 0.45251336693763733
loss_pred:0.01574443094432354, decouple_loss:0.00038747116923332214
The modified gen p mean: 0.45175349712371826, gen p mean: -0.10336237400770187, mean p set: 0.45232921838760376
loss_pred:0.014949114061892033, decouple_loss:0.00035027097328566015
The modified gen p mean: 0.4519057273864746, gen p mean: -0.11118452996015549, mean p set: 0.45248425006866455
loss_pred:0.015343572944402695, decouple_loss:0.00036821284447796643
Iteration: 3855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45221030712127686, gen p mean: -0.11400029808282852, mean p set: 0.45278772711753845
loss_pred:0.015901746228337288, decouple_loss:0.0005035506910644472
The modified gen p mean: 0.4522256553173065, gen p mean: -0.10960972309112549, mean p set: 0.45280152559280396
loss_pred:0.01534199994057417, decouple_loss:0.0003843085723929107
The modified gen p mean: 0.4538527727127075, gen p mean: -0.11696013808250427, mean p set: 0.454429566860199
loss_pred:0.01459379494190216, decouple_loss:0.0005091626080684364
Iteration: 3856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45280730724334717, gen p mean: -0.1138957068324089, mean p set: 0.4533842206001282
loss_pred:0.015247608534991741, decouple_loss:0.0004887563991360366
The modified gen p mean: 0.45145851373672485, gen p mean: -0.11356467008590698, mean p set: 0.45203670859336853
loss_pred:0.015697017312049866, decouple_loss:0.0004058389749843627
The modified gen p mean: 0.4534752666950226, gen p mean: -0.1139698177576065, mean p set: 0.45405256748199463
loss_pred:0.015380997210741043, decouple_loss:0.0006119200261309743
Iteration: 3857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4542683959007263, gen p mean: -0.11900956928730011, mean p set: 0.45484670996665955
loss_pred:0.014774053357541561, decouple_loss:0.0003573998110368848
The modified gen p mean: 0.4511841833591461, gen p mean: -0.11500463634729385, mean p set: 0.45176076889038086
loss_pred:0.014296596869826317, decouple_loss:0.0004169657768215984
The modified gen p mean: 0.4518375098705292, gen p mean: -0.10743754357099533, mean p set: 0.4524155259132385
loss_pred:0.014626876451075077, decouple_loss:0.00029279181035235524
Iteration: 3858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45245179533958435, gen p mean: -0.11632303148508072, mean p set: 0.4530290365219116
loss_pred:0.014823266305029392, decouple_loss:0.00039869683678261936
The modified gen p mean: 0.4518203139305115, gen p mean: -0.11288918554782867, mean p set: 0.452399343252182
loss_pred:0.01487665344029665, decouple_loss:0.0003836016112472862
The modified gen p mean: 0.4526428282260895, gen p mean: -0.11386533826589584, mean p set: 0.4532190263271332
loss_pred:0.014779123477637768, decouple_loss:0.0004829152312595397
Iteration: 3859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516688883304596, gen p mean: -0.11211603879928589, mean p set: 0.4522446393966675
loss_pred:0.0150520671159029, decouple_loss:0.00043052900582551956
The modified gen p mean: 0.4516907334327698, gen p mean: -0.10592910647392273, mean p set: 0.4522660970687866
loss_pred:0.0157554242759943, decouple_loss:0.0006354271317832172
The modified gen p mean: 0.4524061381816864, gen p mean: -0.11213193833827972, mean p set: 0.45298275351524353
loss_pred:0.015358625911176205, decouple_loss:0.0006660775979980826
Iteration: 3860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45319971442222595, gen p mean: -0.1110924631357193, mean p set: 0.45377665758132935
loss_pred:0.01449781097471714, decouple_loss:0.0003261849342379719
The modified gen p mean: 0.45163336396217346, gen p mean: -0.11150877922773361, mean p set: 0.45221033692359924
loss_pred:0.014480323530733585, decouple_loss:0.00037973691360093653
The modified gen p mean: 0.4524848163127899, gen p mean: -0.1142365112900734, mean p set: 0.45306292176246643
loss_pred:0.015525403432548046, decouple_loss:0.00032664622995071113
2023-05-02 18:32:25 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12697461247444153, mean p set: 0.4502691626548767
loss_pred:0.01688089407980442, decouple_loss:0.0003527454973664135
The modified gen p mean: 0.4495331943035126, gen p mean: -0.12062813341617584, mean p set: 0.4500633478164673
loss_pred:0.016165774315595627, decouple_loss:0.00034064316423609853
The modified gen p mean: 0.4498297870159149, gen p mean: -0.1205022931098938, mean p set: 0.45035696029663086
loss_pred:0.016458660364151, decouple_loss:0.0003671376034617424
WV_1_PC_1_EH_0_PS_40, loss: 0.01651945151388645, avg_mse: 0.025831852108240128
current test mse: 0.025832
Iteration: 3861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45261502265930176, gen p mean: -0.10968208312988281, mean p set: 0.4531923532485962
loss_pred:0.015333674848079681, decouple_loss:0.00030935765244066715
The modified gen p mean: 0.45326587557792664, gen p mean: -0.10716947168111801, mean p set: 0.4538425803184509
loss_pred:0.015205374918878078, decouple_loss:0.00031590068829245865
The modified gen p mean: 0.454649418592453, gen p mean: -0.11200979351997375, mean p set: 0.45522719621658325
loss_pred:0.015011383220553398, decouple_loss:0.00028668626327998936
Iteration: 3862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45025497674942017, gen p mean: -0.10545433312654495, mean p set: 0.4508306682109833
loss_pred:0.015502111054956913, decouple_loss:0.0004256388056091964
The modified gen p mean: 0.45441633462905884, gen p mean: -0.1121145486831665, mean p set: 0.4549979567527771The modified gen p mean: 0.45214492082595825, gen p mean: -0.10788167268037796, mean p set: 0.45272231101989746
loss_pred:0.01503016147762537, decouple_loss:0.000315717828925699loss_pred:0.015164565294981003, decouple_loss:0.0004587491857819259
Iteration: 3863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45216304063796997, gen p mean: -0.10877259075641632, mean p set: 0.45273926854133606
loss_pred:0.014675740152597427, decouple_loss:0.0003754214267246425
The modified gen p mean: 0.4516153335571289, gen p mean: -0.10622062534093857, mean p set: 0.45219212770462036The modified gen p mean: 0.45429638028144836, gen p mean: -0.11022074520587921, mean p set: 0.4548746943473816
loss_pred:0.01489998959004879, decouple_loss:0.0005204498884268105
loss_pred:0.014892954379320145, decouple_loss:0.00043557555181905627
Iteration: 3864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530651867389679, gen p mean: -0.10833698511123657, mean p set: 0.4536438286304474
loss_pred:0.01541843544691801, decouple_loss:0.0003916742280125618
The modified gen p mean: 0.45222651958465576, gen p mean: -0.10831926017999649, mean p set: 0.4528021812438965
loss_pred:0.015293755568563938, decouple_loss:0.0003697048232425004
The modified gen p mean: 0.4510094225406647, gen p mean: -0.10368403792381287, mean p set: 0.45158764719963074
loss_pred:0.015160609968006611, decouple_loss:0.0003277068608440459
Iteration: 3865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45146557688713074, gen p mean: -0.10299596190452576, mean p set: 0.4520424008369446
loss_pred:0.015493676997721195, decouple_loss:0.0005817948840558529
The modified gen p mean: 0.4535481333732605, gen p mean: -0.10709210485219955, mean p set: 0.45412477850914
loss_pred:0.014784951694309711, decouple_loss:0.00042786452104337513
The modified gen p mean: 0.4525408148765564, gen p mean: -0.1087346076965332, mean p set: 0.453119158744812
loss_pred:0.015193838626146317, decouple_loss:0.00039758929051458836
Iteration: 3866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527435600757599, gen p mean: -0.11321121454238892, mean p set: 0.45331934094429016
loss_pred:0.014408019371330738, decouple_loss:0.0005092432256788015
The modified gen p mean: 0.4523420035839081, gen p mean: -0.11080639064311981, mean p set: 0.4529195725917816
loss_pred:0.01506749913096428, decouple_loss:0.0002649015514180064
The modified gen p mean: 0.4530481696128845, gen p mean: -0.10761412978172302, mean p set: 0.45362505316734314
loss_pred:0.01513663399964571, decouple_loss:0.0005832685856148601
Iteration: 3867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517182409763336, gen p mean: -0.10686042904853821, mean p set: 0.4522961974143982
loss_pred:0.01543101854622364, decouple_loss:0.0004090477304998785
The modified gen p mean: 0.4517967998981476, gen p mean: -0.10633010417222977, mean p set: 0.4523732364177704
loss_pred:0.015454741194844246, decouple_loss:0.0003865442704409361
The modified gen p mean: 0.4525792598724365, gen p mean: -0.11096253991127014, mean p set: 0.4531553387641907
loss_pred:0.015197713859379292, decouple_loss:0.00038463552482426167
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 3868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781187176704407, gen p mean: -0.12110798060894012, mean p set: 0.44838783144950867
loss_pred:0.015192082151770592, decouple_loss:0.00035449062124826014
The modified gen p mean: 0.4461720287799835, gen p mean: -0.11781659722328186, mean p set: 0.446748286485672
loss_pred:0.015437749214470387, decouple_loss:0.0003928921651095152
The modified gen p mean: 0.4460108280181885, gen p mean: -0.1217094138264656, mean p set: 0.4465861916542053
loss_pred:0.014851818792521954, decouple_loss:0.00035078052314929664
Iteration: 3869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467136859893799, gen p mean: -0.11497630178928375, mean p set: 0.44729292392730713
loss_pred:0.015176549553871155, decouple_loss:0.0003484484914224595
The modified gen p mean: 0.4471202790737152, gen p mean: -0.1225135326385498, mean p set: 0.44769522547721863
loss_pred:0.015035451389849186, decouple_loss:0.00034573418088257313
The modified gen p mean: 0.44745129346847534, gen p mean: -0.12536808848381042, mean p set: 0.44802701473236084
loss_pred:0.013634104281663895, decouple_loss:0.00041297735879197717
Iteration: 3870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776955246925354, gen p mean: -0.11920629441738129, mean p set: 0.44834378361701965
loss_pred:0.014385618269443512, decouple_loss:0.00034839430009014904
The modified gen p mean: 0.44763341546058655, gen p mean: -0.12136895209550858, mean p set: 0.448209285736084
loss_pred:0.014575805515050888, decouple_loss:0.00038391374982893467
The modified gen p mean: 0.44664114713668823, gen p mean: -0.11928881704807281, mean p set: 0.44721704721450806
loss_pred:0.014488199725747108, decouple_loss:0.00043144330265931785
2023-05-02 18:35:15 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.126570925116539, mean p set: 0.4502691626548767
loss_pred:0.016876183450222015, decouple_loss:0.0005100473063066602
The modified gen p mean: 0.4495340883731842, gen p mean: -0.12048175185918808, mean p set: 0.4500633478164673
loss_pred:0.016154374927282333, decouple_loss:0.0003888681821990758
The modified gen p mean: 0.44983071088790894, gen p mean: -0.1202884316444397, mean p set: 0.45035696029663086
loss_pred:0.01642998494207859, decouple_loss:0.0003466870402917266
WV_1_PC_1_EH_0_PS_40, loss: 0.01650760881602764, avg_mse: 0.0258595310151577
current test mse: 0.02586
Iteration: 3871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44635632634162903, gen p mean: -0.11956150829792023, mean p set: 0.4469318985939026
loss_pred:0.015278944745659828, decouple_loss:0.0003251818707212806
The modified gen p mean: 0.44845515489578247, gen p mean: -0.12067640572786331, mean p set: 0.4490286707878113
loss_pred:0.015249361284077168, decouple_loss:0.0004012612334918231
The modified gen p mean: 0.4470381736755371, gen p mean: -0.12101877480745316, mean p set: 0.4476129114627838
loss_pred:0.015374730341136456, decouple_loss:0.0005811942974105477
Iteration: 3872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447181761264801, gen p mean: -0.11879739910364151, mean p set: 0.4477542042732239
loss_pred:0.015138059854507446, decouple_loss:0.0003822872822638601
The modified gen p mean: 0.4470129907131195, gen p mean: -0.12686003744602203, mean p set: 0.44758957624435425The modified gen p mean: 0.4473574459552765, gen p mean: -0.12612953782081604, mean p set: 0.4479331374168396
loss_pred:0.014920798130333424, decouple_loss:0.0003164658264722675
loss_pred:0.01483172457665205, decouple_loss:0.00034385695471428335
Iteration: 3873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465169906616211, gen p mean: -0.13058976829051971, mean p set: 0.4470905363559723
loss_pred:0.014599151909351349, decouple_loss:0.00036353591713123024
The modified gen p mean: 0.4468235969543457, gen p mean: -0.12876613438129425, mean p set: 0.44739776849746704
The modified gen p mean: 0.44487982988357544, gen p mean: -0.1325821876525879, mean p set: 0.4454576373100281
loss_pred:0.014602497220039368, decouple_loss:0.000355963537003845
loss_pred:0.014916599728167057, decouple_loss:0.00032704477780498564
Iteration: 3874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743287563323975, gen p mean: -0.12110716104507446, mean p set: 0.448009192943573
loss_pred:0.014954607002437115, decouple_loss:0.0003337836533319205
The modified gen p mean: 0.446453332901001, gen p mean: -0.12847676873207092, mean p set: 0.4470267593860626
loss_pred:0.014755407348275185, decouple_loss:0.0003062845498789102
The modified gen p mean: 0.4469180405139923, gen p mean: -0.12943238019943237, mean p set: 0.4474954903125763
loss_pred:0.015220556408166885, decouple_loss:0.00041484105167910457
Iteration: 3875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44658443331718445, gen p mean: -0.12908652424812317, mean p set: 0.44716206192970276
loss_pred:0.015008348971605301, decouple_loss:0.0003739604726433754
The modified gen p mean: 0.4463917315006256, gen p mean: -0.1358102262020111, mean p set: 0.44696754217147827
loss_pred:0.013827655464410782, decouple_loss:0.00041541687096469104
The modified gen p mean: 0.44712594151496887, gen p mean: -0.12969811260700226, mean p set: 0.4477007985115051
loss_pred:0.014840053394436836, decouple_loss:0.00038751435931771994
Iteration: 3876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44540292024612427, gen p mean: -0.14047136902809143, mean p set: 0.44598105549812317
loss_pred:0.014397649094462395, decouple_loss:0.00034590717405080795
The modified gen p mean: 0.4457860589027405, gen p mean: -0.1337880790233612, mean p set: 0.44635844230651855
loss_pred:0.014700246043503284, decouple_loss:0.00037807031185366213
The modified gen p mean: 0.4466041028499603, gen p mean: -0.13388803601264954, mean p set: 0.44717955589294434
loss_pred:0.014442211017012596, decouple_loss:0.0003358557587489486
Iteration: 3877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44622889161109924, gen p mean: -0.13483808934688568, mean p set: 0.44680383801460266
loss_pred:0.014587034471333027, decouple_loss:0.00041521136881783605
The modified gen p mean: 0.44717729091644287, gen p mean: -0.1362188756465912, mean p set: 0.44775307178497314
loss_pred:0.013567237183451653, decouple_loss:0.00031877291621640325
The modified gen p mean: 0.4468678832054138, gen p mean: -0.1300370842218399, mean p set: 0.44744551181793213
loss_pred:0.014399957843124866, decouple_loss:0.00031629123259335756
Iteration: 3878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473172128200531, gen p mean: -0.12844756245613098, mean p set: 0.4478902518749237
loss_pred:0.015004316344857216, decouple_loss:0.0004083185049239546
The modified gen p mean: 0.4461314380168915, gen p mean: -0.1330081969499588, mean p set: 0.4467063546180725
loss_pred:0.014870541170239449, decouple_loss:0.0003552183334250003
The modified gen p mean: 0.44636091589927673, gen p mean: -0.12576013803482056, mean p set: 0.44694095849990845
loss_pred:0.015372021123766899, decouple_loss:0.00031023009796626866
Iteration: 3879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818657636642456, gen p mean: -0.12818543612957, mean p set: 0.44876447319984436
loss_pred:0.01422958541661501, decouple_loss:0.00039660558104515076
The modified gen p mean: 0.4471058249473572, gen p mean: -0.12829047441482544, mean p set: 0.4476804733276367
loss_pred:0.015258881263434887, decouple_loss:0.00027648056857287884
The modified gen p mean: 0.4454849660396576, gen p mean: -0.1281725913286209, mean p set: 0.4460590183734894
loss_pred:0.014740264043211937, decouple_loss:0.0003562131314538419
Iteration: 3880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44635599851608276, gen p mean: -0.13240942358970642, mean p set: 0.44692835211753845
loss_pred:0.014221805147826672, decouple_loss:0.00030907426844350994
The modified gen p mean: 0.4458792209625244, gen p mean: -0.13122263550758362, mean p set: 0.446456640958786
loss_pred:0.014499430544674397, decouple_loss:0.0003547605301719159
The modified gen p mean: 0.44575709104537964, gen p mean: -0.12612448632717133, mean p set: 0.4463306665420532
loss_pred:0.014773507602512836, decouple_loss:0.000411100045312196
2023-05-02 18:37:21 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1281411349773407, mean p set: 0.4502691626548767
loss_pred:0.01699662208557129, decouple_loss:0.00030475982930511236
The modified gen p mean: 0.4498278796672821, gen p mean: -0.12198065966367722, mean p set: 0.45035696029663086
The modified gen p mean: 0.44953402876853943, gen p mean: -0.1222202256321907, mean p set: 0.4500633478164673
loss_pred:0.016490060836076736, decouple_loss:0.0002970165805891156
loss_pred:0.01612122915685177, decouple_loss:0.00031289036269299686
WV_1_PC_1_EH_0_PS_40, loss: 0.016551215201616287, avg_mse: 0.02587265521287918
current test mse: 0.025873
Iteration: 3881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800689816474915, gen p mean: -0.12756773829460144, mean p set: 0.44858217239379883
The modified gen p mean: 0.44632717967033386, gen p mean: -0.12278711795806885, mean p set: 0.44690370559692383
loss_pred:0.014347097836434841, decouple_loss:0.0002973985392600298
loss_pred:0.01464349776506424, decouple_loss:0.0003439282882027328
The modified gen p mean: 0.4480418264865875, gen p mean: -0.12338884174823761, mean p set: 0.44861549139022827
loss_pred:0.014618671499192715, decouple_loss:0.00025983285740949214
Iteration: 3882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44570913910865784, gen p mean: -0.12457340210676193, mean p set: 0.4462839961051941
loss_pred:0.014419849961996078, decouple_loss:0.0002749522391241044
The modified gen p mean: 0.44762134552001953, gen p mean: -0.12467848509550095, mean p set: 0.4481981694698334The modified gen p mean: 0.446587473154068, gen p mean: -0.12261338531970978, mean p set: 0.44716131687164307
loss_pred:0.014887413010001183, decouple_loss:0.000244268449023366loss_pred:0.01502836775034666, decouple_loss:0.0002772715815808624
Iteration: 3883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774097204208374, gen p mean: -0.12031958252191544, mean p set: 0.44831427931785583
The modified gen p mean: 0.444917768239975, gen p mean: -0.12875626981258392, mean p set: 0.44549062848091125
loss_pred:0.014659124426543713, decouple_loss:0.00029400529456324875
loss_pred:0.014373824000358582, decouple_loss:0.000339471735060215
The modified gen p mean: 0.44620347023010254, gen p mean: -0.12257909029722214, mean p set: 0.4467789828777313
loss_pred:0.014706256799399853, decouple_loss:0.00038368618697859347
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485016167163849, gen p mean: -0.1223057359457016, mean p set: 0.44907715916633606
loss_pred:0.014164654538035393, decouple_loss:0.00032318723970092833
The modified gen p mean: 0.44893839955329895, gen p mean: -0.1257735639810562, mean p set: 0.4495137631893158
loss_pred:0.014270852319896221, decouple_loss:0.0003523798077367246
The modified gen p mean: 0.4468415081501007, gen p mean: -0.12090328335762024, mean p set: 0.44741740822792053
loss_pred:0.015369324013590813, decouple_loss:0.0002994836831931025
Iteration: 3885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713759422302246, gen p mean: -0.12198959290981293, mean p set: 0.44771286845207214
loss_pred:0.014272615313529968, decouple_loss:0.0003232476592529565
The modified gen p mean: 0.4468807280063629, gen p mean: -0.12244544923305511, mean p set: 0.4474574029445648
The modified gen p mean: 0.4483064115047455, gen p mean: -0.12335234880447388, mean p set: 0.448881059885025
loss_pred:0.0146131357178092, decouple_loss:0.0003281543613411486
loss_pred:0.014467213302850723, decouple_loss:0.0002719585027080029
Iteration: 3886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465061128139496, gen p mean: -0.12649564445018768, mean p set: 0.44708412885665894
loss_pred:0.014621051959693432, decouple_loss:0.0003525202046148479
The modified gen p mean: 0.4473579525947571, gen p mean: -0.12324979156255722, mean p set: 0.44793781638145447
loss_pred:0.01500334870070219, decouple_loss:0.000332029681885615
The modified gen p mean: 0.4475053548812866, gen p mean: -0.1284460872411728, mean p set: 0.44808200001716614
loss_pred:0.013667290098965168, decouple_loss:0.00033062970032915473
Iteration: 3887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477677345275879, gen p mean: -0.12341823428869247, mean p set: 0.4483422338962555
loss_pred:0.014424294233322144, decouple_loss:0.0003023546887561679
The modified gen p mean: 0.44652819633483887, gen p mean: -0.12071242183446884, mean p set: 0.44710773229599
The modified gen p mean: 0.4477803409099579, gen p mean: -0.12214021384716034, mean p set: 0.4483581483364105
loss_pred:0.01458523515611887, decouple_loss:0.0003729574382305145
loss_pred:0.013773513957858086, decouple_loss:0.0002915994555223733
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 3888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487334191799164, gen p mean: -0.12201488763093948, mean p set: 0.44930922985076904
loss_pred:0.01432617474347353, decouple_loss:0.00034784729359671474
The modified gen p mean: 0.4501044750213623, gen p mean: -0.11772089451551437, mean p set: 0.450682133436203
The modified gen p mean: 0.44988423585891724, gen p mean: -0.11468257009983063, mean p set: 0.45046207308769226
loss_pred:0.014498163014650345, decouple_loss:0.00036281978827901185
loss_pred:0.014221741817891598, decouple_loss:0.0003586098609957844
Iteration: 3889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493023157119751, gen p mean: -0.1206320971250534, mean p set: 0.44987955689430237
The modified gen p mean: 0.44901394844055176, gen p mean: -0.11895682662725449, mean p set: 0.44958946108818054
loss_pred:0.014461971819400787, decouple_loss:0.00030236621387302876
loss_pred:0.014301660470664501, decouple_loss:0.0003425097675062716
The modified gen p mean: 0.4483020603656769, gen p mean: -0.11135666072368622, mean p set: 0.44888070225715637
loss_pred:0.013921307399868965, decouple_loss:0.00028859160374850035
Iteration: 3890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476305842399597, gen p mean: -0.1257457733154297, mean p set: 0.44820713996887207
loss_pred:0.014953304082155228, decouple_loss:0.0003210069553460926
The modified gen p mean: 0.4487849771976471, gen p mean: -0.12736265361309052, mean p set: 0.44936034083366394
loss_pred:0.014287938363850117, decouple_loss:0.0002746832906268537
The modified gen p mean: 0.44969630241394043, gen p mean: -0.12421556562185287, mean p set: 0.4502703547477722
loss_pred:0.014667883515357971, decouple_loss:0.000320128834573552
2023-05-02 18:40:14 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1317582130432129, mean p set: 0.4502691626548767
loss_pred:0.016882363706827164, decouple_loss:0.000345112377544865
The modified gen p mean: 0.4495350122451782, gen p mean: -0.12582583725452423, mean p set: 0.4500633478164673
loss_pred:0.016075512394309044, decouple_loss:0.0003015757247339934
The modified gen p mean: 0.4498306214809418, gen p mean: -0.1255156397819519, mean p set: 0.45035696029663086
loss_pred:0.016439193859696388, decouple_loss:0.0003660392831079662
WV_1_PC_1_EH_0_PS_40, loss: 0.01648256927728653, avg_mse: 0.025841860100626945
current test mse: 0.025842
Iteration: 3891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729194045066833, gen p mean: -0.1337144374847412, mean p set: 0.4478663504123688
loss_pred:0.014173317700624466, decouple_loss:0.00048319692723453045
The modified gen p mean: 0.4480007290840149, gen p mean: -0.12376005947589874, mean p set: 0.4485769271850586
loss_pred:0.013975568115711212, decouple_loss:0.00031989996205084026
The modified gen p mean: 0.4498075246810913, gen p mean: -0.12487654387950897, mean p set: 0.4503842294216156
loss_pred:0.014599102549254894, decouple_loss:0.00037189325666986406
Iteration: 3892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44805845618247986, gen p mean: -0.12484454363584518, mean p set: 0.448634535074234
loss_pred:0.014256570488214493, decouple_loss:0.0003191294090356678
The modified gen p mean: 0.44801297783851624, gen p mean: -0.11775898933410645, mean p set: 0.4485895335674286The modified gen p mean: 0.4489222764968872, gen p mean: -0.12902648746967316, mean p set: 0.44949984550476074
loss_pred:0.013821244239807129, decouple_loss:0.0004161859687883407
loss_pred:0.014447574503719807, decouple_loss:0.0003746791335288435
Iteration: 3893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477730393409729, gen p mean: -0.12406175583600998, mean p set: 0.4483490288257599
loss_pred:0.014106548391282558, decouple_loss:0.0002656827855389565
The modified gen p mean: 0.44843193888664246, gen p mean: -0.1245129406452179, mean p set: 0.44900989532470703The modified gen p mean: 0.4484500586986542, gen p mean: -0.12901659309864044, mean p set: 0.44902855157852173
loss_pred:0.014313462190330029, decouple_loss:0.0002596908307168633
loss_pred:0.014755652286112309, decouple_loss:0.000392734567867592
Iteration: 3894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486033320426941, gen p mean: -0.12766484916210175, mean p set: 0.44917967915534973
loss_pred:0.014154916629195213, decouple_loss:0.00031169020803645253
The modified gen p mean: 0.44846197962760925, gen p mean: -0.13360586762428284, mean p set: 0.44904085993766785
loss_pred:0.013964705169200897, decouple_loss:0.0003622752847149968
The modified gen p mean: 0.4490374028682709, gen p mean: -0.12803789973258972, mean p set: 0.4496126174926758
loss_pred:0.01384808961302042, decouple_loss:0.00035589226172305644
Iteration: 3895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492626488208771, gen p mean: -0.13430598378181458, mean p set: 0.44983842968940735
loss_pred:0.01464606262743473, decouple_loss:0.00031912754639051855
The modified gen p mean: 0.44965454936027527, gen p mean: -0.12356016784906387, mean p set: 0.45022737979888916
loss_pred:0.014559851959347725, decouple_loss:0.0002694985014386475
The modified gen p mean: 0.44871217012405396, gen p mean: -0.12724488973617554, mean p set: 0.449288934469223
loss_pred:0.014367085881531239, decouple_loss:0.00027402315754443407
Iteration: 3896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500587582588196, gen p mean: -0.12211418896913528, mean p set: 0.4506332576274872
The modified gen p mean: 0.4474802315235138, gen p mean: -0.12513287365436554, mean p set: 0.448056697845459
loss_pred:0.01371553260833025, decouple_loss:0.00038596047670580447
loss_pred:0.013785206712782383, decouple_loss:0.0002693927090149373
The modified gen p mean: 0.44906917214393616, gen p mean: -0.12745361030101776, mean p set: 0.44964301586151123
loss_pred:0.014783482067286968, decouple_loss:0.00033053982770070434
Iteration: 3897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477981925010681, gen p mean: -0.12091769278049469, mean p set: 0.44837456941604614
loss_pred:0.01421546470373869, decouple_loss:0.0002718849864322692
The modified gen p mean: 0.4491783678531647, gen p mean: -0.12552735209465027, mean p set: 0.44975459575653076
The modified gen p mean: 0.44874510169029236, gen p mean: -0.12447246164083481, mean p set: 0.44932347536087036
loss_pred:0.014039469882845879, decouple_loss:0.00031230627791956067
loss_pred:0.014006994664669037, decouple_loss:0.00028251175535842776
Iteration: 3898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877126812934875, gen p mean: -0.12976275384426117, mean p set: 0.4493459463119507
loss_pred:0.014790328219532967, decouple_loss:0.0003780619881581515
The modified gen p mean: 0.4480411112308502, gen p mean: -0.12260473519563675, mean p set: 0.44861605763435364
The modified gen p mean: 0.4492650330066681, gen p mean: -0.1253177970647812, mean p set: 0.4498407244682312
loss_pred:0.014159766025841236, decouple_loss:0.00029668162460438907
loss_pred:0.014190299436450005, decouple_loss:0.00026673843967728317
Iteration: 3899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489823281764984, gen p mean: -0.12848733365535736, mean p set: 0.4495595097541809
loss_pred:0.014207201078534126, decouple_loss:0.0002842333051376045
The modified gen p mean: 0.4463929235935211, gen p mean: -0.131755992770195, mean p set: 0.4469698667526245
The modified gen p mean: 0.44837120175361633, gen p mean: -0.12393124401569366, mean p set: 0.448943167924881
loss_pred:0.01401804480701685, decouple_loss:0.00029961756081320345
loss_pred:0.01418660394847393, decouple_loss:0.00027191199478693306
Iteration: 3900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494277536869049, gen p mean: -0.1346062570810318, mean p set: 0.4500042200088501
loss_pred:0.014539852738380432, decouple_loss:0.0002593914687167853
The modified gen p mean: 0.44838613271713257, gen p mean: -0.13454630970954895, mean p set: 0.44896194338798523
loss_pred:0.014565948396921158, decouple_loss:0.00038006994873285294
The modified gen p mean: 0.44937804341316223, gen p mean: -0.12495806813240051, mean p set: 0.4499533474445343
loss_pred:0.014142458327114582, decouple_loss:0.000295688136247918
2023-05-02 18:42:19 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1344771534204483, mean p set: 0.4502691626548767
loss_pred:0.01686001382768154, decouple_loss:0.00035869411658495665
The modified gen p mean: 0.44953417778015137, gen p mean: -0.12847013771533966, mean p set: 0.4500633478164673
loss_pred:0.01614047959446907, decouple_loss:0.00029700915911234915
The modified gen p mean: 0.44982877373695374, gen p mean: -0.12812131643295288, mean p set: 0.45035696029663086
loss_pred:0.01644793152809143, decouple_loss:0.000326957437209785
WV_1_PC_1_EH_0_PS_40, loss: 0.016499187797307968, avg_mse: 0.02584434486925602
current test mse: 0.025844
Iteration: 3901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855985045433044, gen p mean: -0.13072600960731506, mean p set: 0.449137419462204
loss_pred:0.014238880015909672, decouple_loss:0.00031345270690508187
The modified gen p mean: 0.44929251074790955, gen p mean: -0.12580989301204681, mean p set: 0.4498685300350189The modified gen p mean: 0.4486492872238159, gen p mean: -0.1314576119184494, mean p set: 0.4492279887199402
loss_pred:0.014633393846452236, decouple_loss:0.00030085534672252834
loss_pred:0.013733511790633202, decouple_loss:0.0002576794649939984
Iteration: 3902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488816261291504, gen p mean: -0.12953263521194458, mean p set: 0.44945788383483887
loss_pred:0.013819155283272266, decouple_loss:0.00024079682771116495
The modified gen p mean: 0.4480155110359192, gen p mean: -0.12360669672489166, mean p set: 0.4485909342765808The modified gen p mean: 0.44652482867240906, gen p mean: -0.1338602751493454, mean p set: 0.44710251688957214
loss_pred:0.014765994623303413, decouple_loss:0.00030723033705726266loss_pred:0.014080286026000977, decouple_loss:0.0003233291790820658
Iteration: 3903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45005324482917786, gen p mean: -0.12167615443468094, mean p set: 0.45063140988349915
loss_pred:0.014048514887690544, decouple_loss:0.00037927753874100745
The modified gen p mean: 0.44829171895980835, gen p mean: -0.13063040375709534, mean p set: 0.4488680362701416
loss_pred:0.01367026474326849, decouple_loss:0.0004228105244692415
The modified gen p mean: 0.4478702247142792, gen p mean: -0.1197001039981842, mean p set: 0.44844722747802734
loss_pred:0.014484589919447899, decouple_loss:0.0004894102457910776
Iteration: 3904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486616849899292, gen p mean: -0.11608555912971497, mean p set: 0.4492368996143341
loss_pred:0.014154043048620224, decouple_loss:0.00032943609403446317
The modified gen p mean: 0.4494860768318176, gen p mean: -0.1258167326450348, mean p set: 0.4500616788864136
loss_pred:0.014194217510521412, decouple_loss:0.00035780516918748617
The modified gen p mean: 0.44779229164123535, gen p mean: -0.12037834525108337, mean p set: 0.4483669102191925
loss_pred:0.014026961289346218, decouple_loss:0.0002677511365618557
Iteration: 3905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715195894241333, gen p mean: -0.11900629848241806, mean p set: 0.4477255642414093
loss_pred:0.01369741652160883, decouple_loss:0.0003089961828663945
The modified gen p mean: 0.44911015033721924, gen p mean: -0.12387179583311081, mean p set: 0.449687123298645
loss_pred:0.014742569997906685, decouple_loss:0.00039632676634937525
The modified gen p mean: 0.44972142577171326, gen p mean: -0.1180858165025711, mean p set: 0.45029905438423157
loss_pred:0.014277522452175617, decouple_loss:0.00035285050398670137
Iteration: 3906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493480920791626, gen p mean: -0.11391231417655945, mean p set: 0.4499235153198242
loss_pred:0.014480837620794773, decouple_loss:0.00032403881778009236
The modified gen p mean: 0.4503098726272583, gen p mean: -0.1169343888759613, mean p set: 0.4508882462978363
loss_pred:0.014115520752966404, decouple_loss:0.0003622019139584154
The modified gen p mean: 0.4490220844745636, gen p mean: -0.12462350726127625, mean p set: 0.4495994448661804
loss_pred:0.014361623674631119, decouple_loss:0.00041080641676671803
Iteration: 3907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763290882110596, gen p mean: -0.12089290469884872, mean p set: 0.44820865988731384
loss_pred:0.014253380708396435, decouple_loss:0.0002383080864092335
The modified gen p mean: 0.4484092891216278, gen p mean: -0.12333554774522781, mean p set: 0.44898566603660583
loss_pred:0.013937893323600292, decouple_loss:0.0003082937328144908
The modified gen p mean: 0.44754621386528015, gen p mean: -0.12232071161270142, mean p set: 0.4481198489665985
loss_pred:0.013872534036636353, decouple_loss:0.0003399717970751226
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
NaN value num: 0
Iteration: 3908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44486862421035767, gen p mean: -0.12063778936862946, mean p set: 0.4454438388347626
loss_pred:0.016472911462187767, decouple_loss:0.0004981581587344408
The modified gen p mean: 0.44801509380340576, gen p mean: -0.125505268573761, mean p set: 0.44859054684638977
The modified gen p mean: 0.44789350032806396, gen p mean: -0.11845811456441879, mean p set: 0.44847017526626587
loss_pred:0.01639441028237343, decouple_loss:0.00031986465910449624
loss_pred:0.015289472416043282, decouple_loss:0.0003510593087412417
Iteration: 3909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813165068626404, gen p mean: -0.11847476661205292, mean p set: 0.44870737195014954
loss_pred:0.015206069685518742, decouple_loss:0.000299399602226913
The modified gen p mean: 0.44830265641212463, gen p mean: -0.1245960146188736, mean p set: 0.4488775134086609
loss_pred:0.016204407438635826, decouple_loss:0.0003108955279458314
The modified gen p mean: 0.44740113615989685, gen p mean: -0.11968248337507248, mean p set: 0.4479779005050659
loss_pred:0.01678587682545185, decouple_loss:0.00044171963236294687
Iteration: 3910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761329889297485, gen p mean: -0.11656905710697174, mean p set: 0.4481930732727051
loss_pred:0.016048572957515717, decouple_loss:0.00034917378798127174
The modified gen p mean: 0.4470239579677582, gen p mean: -0.11626243591308594, mean p set: 0.4476010203361511
The modified gen p mean: 0.4468080997467041, gen p mean: -0.11708038300275803, mean p set: 0.44738152623176575
loss_pred:0.015296673402190208, decouple_loss:0.00029755846480838954
loss_pred:0.01629382185637951, decouple_loss:0.0003217660414520651
2023-05-02 18:45:09 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12257521599531174, mean p set: 0.4502691626548767
loss_pred:0.016834642738103867, decouple_loss:0.0005291132256388664
The modified gen p mean: 0.449535071849823, gen p mean: -0.11675518751144409, mean p set: 0.4500633478164673
loss_pred:0.015991266816854477, decouple_loss:0.00038304313784465194
The modified gen p mean: 0.4498277008533478, gen p mean: -0.11625368893146515, mean p set: 0.45035696029663086
loss_pred:0.016326341778039932, decouple_loss:0.00037673304905183613
WV_1_PC_1_EH_0_PS_40, loss: 0.016405565664172173, avg_mse: 0.025653095915913582
current test mse: 0.025653
Iteration: 3911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470471143722534, gen p mean: -0.11790966242551804, mean p set: 0.4476243257522583
loss_pred:0.01652873307466507, decouple_loss:0.00039160597953014076
The modified gen p mean: 0.4479169249534607, gen p mean: -0.11652395874261856, mean p set: 0.44849109649658203The modified gen p mean: 0.44802650809288025, gen p mean: -0.11685391515493393, mean p set: 0.44860225915908813
loss_pred:0.01577441766858101, decouple_loss:0.00045628813677467406loss_pred:0.015255488455295563, decouple_loss:0.00045376853086054325
Iteration: 3912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44748425483703613, gen p mean: -0.12161517143249512, mean p set: 0.44805940985679626
loss_pred:0.015580151230096817, decouple_loss:0.0004708495398517698
The modified gen p mean: 0.4466298222541809, gen p mean: -0.1215948611497879, mean p set: 0.4472050368785858The modified gen p mean: 0.447955846786499, gen p mean: -0.11892305314540863, mean p set: 0.44853606820106506
loss_pred:0.016050515696406364, decouple_loss:0.00036904538865201175
loss_pred:0.015936685726046562, decouple_loss:0.00029659768915735185
Iteration: 3913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448110967874527, gen p mean: -0.12028370052576065, mean p set: 0.448689341545105
loss_pred:0.015045961365103722, decouple_loss:0.0003258477954659611
The modified gen p mean: 0.444707989692688, gen p mean: -0.1240956112742424, mean p set: 0.4452835023403168
loss_pred:0.015981249511241913, decouple_loss:0.00032126513542607427
The modified gen p mean: 0.4482850432395935, gen p mean: -0.12069348990917206, mean p set: 0.44885969161987305
loss_pred:0.01548664178699255, decouple_loss:0.000330426380969584
Iteration: 3914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468725621700287, gen p mean: -0.125631183385849, mean p set: 0.44744715094566345
loss_pred:0.01619110070168972, decouple_loss:0.0004866034141741693
The modified gen p mean: 0.4475829303264618, gen p mean: -0.12466426193714142, mean p set: 0.4481572210788727
loss_pred:0.015833230689167976, decouple_loss:0.00047269411152228713
The modified gen p mean: 0.44733312726020813, gen p mean: -0.12416652590036392, mean p set: 0.44790738821029663
loss_pred:0.014918426051735878, decouple_loss:0.000388682063203305
Iteration: 3915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687893986701965, gen p mean: -0.12868095934391022, mean p set: 0.4474547207355499
loss_pred:0.01561747957020998, decouple_loss:0.000717430782970041
The modified gen p mean: 0.4482598304748535, gen p mean: -0.13618288934230804, mean p set: 0.44883349537849426
loss_pred:0.015321623533964157, decouple_loss:0.00045589703950099647
The modified gen p mean: 0.44679024815559387, gen p mean: -0.12814606726169586, mean p set: 0.4473651349544525
loss_pred:0.015135315246880054, decouple_loss:0.0004213657521177083
Iteration: 3916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483919143676758, gen p mean: -0.1311962753534317, mean p set: 0.4489684998989105
loss_pred:0.014886652119457722, decouple_loss:0.00028646906139329076
The modified gen p mean: 0.44751355051994324, gen p mean: -0.13143208622932434, mean p set: 0.4480881989002228
loss_pred:0.01468412484973669, decouple_loss:0.00028186148847453296
The modified gen p mean: 0.44677042961120605, gen p mean: -0.13363896310329437, mean p set: 0.44734519720077515
loss_pred:0.01618240214884281, decouple_loss:0.00026017671916633844
Iteration: 3917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472317695617676, gen p mean: -0.1323811113834381, mean p set: 0.44780823588371277
loss_pred:0.014960126020014286, decouple_loss:0.0004499001952353865
The modified gen p mean: 0.447017639875412, gen p mean: -0.1370636373758316, mean p set: 0.4475955367088318
The modified gen p mean: 0.4472044110298157, gen p mean: -0.13544932007789612, mean p set: 0.44777825474739075
loss_pred:0.01444912701845169, decouple_loss:0.0003389395715203136
loss_pred:0.015813814476132393, decouple_loss:0.0004785337659996003
Iteration: 3918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743025302886963, gen p mean: -0.13279297947883606, mean p set: 0.4480046033859253
loss_pred:0.015444827266037464, decouple_loss:0.0004923669039271772
The modified gen p mean: 0.44711601734161377, gen p mean: -0.13300371170043945, mean p set: 0.4476911425590515
loss_pred:0.015094680711627007, decouple_loss:0.00042766580008901656
The modified gen p mean: 0.4470997750759125, gen p mean: -0.14172598719596863, mean p set: 0.4476792514324188
loss_pred:0.01607469469308853, decouple_loss:0.00038730917731299996
Iteration: 3919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472050666809082, gen p mean: -0.13559584319591522, mean p set: 0.4477783739566803
loss_pred:0.01612566038966179, decouple_loss:0.00031474477145820856
The modified gen p mean: 0.44608503580093384, gen p mean: -0.13406158983707428, mean p set: 0.4466627538204193
loss_pred:0.016196707263588905, decouple_loss:0.00042674949509091675
The modified gen p mean: 0.4467231035232544, gen p mean: -0.13572187721729279, mean p set: 0.4472973346710205
loss_pred:0.01545098889619112, decouple_loss:0.00041127545409835875
Iteration: 3920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735342264175415, gen p mean: -0.13003334403038025, mean p set: 0.4479292929172516
loss_pred:0.015568803064525127, decouple_loss:0.0005592027446255088
The modified gen p mean: 0.44664040207862854, gen p mean: -0.12932254374027252, mean p set: 0.4472196698188782
The modified gen p mean: 0.44671493768692017, gen p mean: -0.1317463368177414, mean p set: 0.4472928047180176
loss_pred:0.01570754498243332, decouple_loss:0.0004539161454886198
loss_pred:0.016082914546132088, decouple_loss:0.000400749035179615
2023-05-02 18:47:18 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13320526480674744, mean p set: 0.4502691626548767
loss_pred:0.016845213249325752, decouple_loss:0.0003535859868861735
The modified gen p mean: 0.4495354890823364, gen p mean: -0.1276378333568573, mean p set: 0.4500633478164673
loss_pred:0.01610429771244526, decouple_loss:0.00037116496241651475
The modified gen p mean: 0.44982627034187317, gen p mean: -0.12726590037345886, mean p set: 0.45035696029663086
loss_pred:0.016360096633434296, decouple_loss:0.00042430259054526687
WV_1_PC_1_EH_0_PS_40, loss: 0.01645568758249283, avg_mse: 0.025762174278497696
current test mse: 0.025762
Iteration: 3921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44441500306129456, gen p mean: -0.12919571995735168, mean p set: 0.4449867010116577
loss_pred:0.016174152493476868, decouple_loss:0.00045395208871923387
The modified gen p mean: 0.4443683326244354, gen p mean: -0.12825845181941986, mean p set: 0.4449447691440582The modified gen p mean: 0.4471535384654999, gen p mean: -0.1246788427233696, mean p set: 0.44772669672966003
loss_pred:0.016157537698745728, decouple_loss:0.0003992048732470721
loss_pred:0.015070226043462753, decouple_loss:0.00044280150905251503
Iteration: 3922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479030668735504, gen p mean: -0.12388458102941513, mean p set: 0.44847550988197327
loss_pred:0.015349890105426311, decouple_loss:0.0004172507324256003
The modified gen p mean: 0.447951078414917, gen p mean: -0.12608136236667633, mean p set: 0.44852742552757263
The modified gen p mean: 0.44655659794807434, gen p mean: -0.12729571759700775, mean p set: 0.4471317529678345
loss_pred:0.016402557492256165, decouple_loss:0.0005268778768368065
loss_pred:0.01626383513212204, decouple_loss:0.0004894878948107362
Iteration: 3923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459307789802551, gen p mean: -0.13058240711688995, mean p set: 0.44650891423225403
loss_pred:0.015664968639612198, decouple_loss:0.0005060137482360005
The modified gen p mean: 0.448150634765625, gen p mean: -0.12747660279273987, mean p set: 0.4487268626689911
loss_pred:0.015745721757411957, decouple_loss:0.0004919410566799343
The modified gen p mean: 0.4473409652709961, gen p mean: -0.1291649490594864, mean p set: 0.44791650772094727
loss_pred:0.015911374241113663, decouple_loss:0.00046260582166723907
Iteration: 3924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471646249294281, gen p mean: -0.13102711737155914, mean p set: 0.447741836309433
loss_pred:0.015895763412117958, decouple_loss:0.00036778993671759963
The modified gen p mean: 0.4454442262649536, gen p mean: -0.13074271380901337, mean p set: 0.44602203369140625
loss_pred:0.015881424769759178, decouple_loss:0.0003653314779512584
The modified gen p mean: 0.4468200206756592, gen p mean: -0.1305013746023178, mean p set: 0.4473983943462372
loss_pred:0.014898744411766529, decouple_loss:0.0003204152744729072
Iteration: 3925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676822423934937, gen p mean: -0.1308787316083908, mean p set: 0.4473438560962677
loss_pred:0.01574581302702427, decouple_loss:0.0003190975694451481
The modified gen p mean: 0.4465245008468628, gen p mean: -0.12962859869003296, mean p set: 0.44710254669189453
loss_pred:0.016296420246362686, decouple_loss:0.00037248051376082003
The modified gen p mean: 0.44838711619377136, gen p mean: -0.12877100706100464, mean p set: 0.4489658772945404
loss_pred:0.01584477163851261, decouple_loss:0.00035497909993864596
Iteration: 3926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708532094955444, gen p mean: -0.1288071721792221, mean p set: 0.44765937328338623
loss_pred:0.01478365994989872, decouple_loss:0.0005646590143442154
The modified gen p mean: 0.44640666246414185, gen p mean: -0.1284598857164383, mean p set: 0.4469830095767975
The modified gen p mean: 0.44761332869529724, gen p mean: -0.12423891574144363, mean p set: 0.4481865465641022
loss_pred:0.015936659649014473, decouple_loss:0.0005218168371357024
loss_pred:0.014605890028178692, decouple_loss:0.0004495240282267332
Iteration: 3927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477841258049011, gen p mean: -0.12820254266262054, mean p set: 0.4483644366264343
loss_pred:0.014869997277855873, decouple_loss:0.00040006160270422697
The modified gen p mean: 0.44734036922454834, gen p mean: -0.13270729780197144, mean p set: 0.44791924953460693
loss_pred:0.015464712865650654, decouple_loss:0.00035807836684398353
The modified gen p mean: 0.44730162620544434, gen p mean: -0.12411540001630783, mean p set: 0.4478755593299866
loss_pred:0.015019502490758896, decouple_loss:0.0004180834803264588
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
NaN value num: 0
Iteration: 3928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077234506607056, gen p mean: -0.12360867857933044, mean p set: 0.45134806632995605
loss_pred:0.015600849874317646, decouple_loss:0.00034397319541312754
The modified gen p mean: 0.4508014917373657, gen p mean: -0.12694142758846283, mean p set: 0.45137593150138855
The modified gen p mean: 0.4485260546207428, gen p mean: -0.12509022653102875, mean p set: 0.4491001069545746
loss_pred:0.016539480537176132, decouple_loss:0.0004517170018516481
loss_pred:0.015223246067762375, decouple_loss:0.00039821513928472996
Iteration: 3929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500277638435364, gen p mean: -0.13006435334682465, mean p set: 0.45060214400291443
loss_pred:0.015217571519315243, decouple_loss:0.0005231848335824907
The modified gen p mean: 0.45051494240760803, gen p mean: -0.12844257056713104, mean p set: 0.451090544462204
loss_pred:0.014432506635785103, decouple_loss:0.0006354186334647238
The modified gen p mean: 0.4491446912288666, gen p mean: -0.12480256706476212, mean p set: 0.4497242569923401
loss_pred:0.015749629586935043, decouple_loss:0.000489255238790065
Iteration: 3930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502370059490204, gen p mean: -0.1223156750202179, mean p set: 0.4508116841316223
loss_pred:0.015789547935128212, decouple_loss:0.0003953866835217923
The modified gen p mean: 0.44967323541641235, gen p mean: -0.1248907595872879, mean p set: 0.4502485692501068
loss_pred:0.015690848231315613, decouple_loss:0.000558599247597158
The modified gen p mean: 0.4504251778125763, gen p mean: -0.12902632355690002, mean p set: 0.45100319385528564
loss_pred:0.01527894102036953, decouple_loss:0.0006171389250084758
2023-05-02 18:50:03 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.137385755777359, mean p set: 0.4502691626548767
loss_pred:0.01691446267068386, decouple_loss:0.0003926253702957183
The modified gen p mean: 0.4495338797569275, gen p mean: -0.13149742782115936, mean p set: 0.4500633478164673
loss_pred:0.016141599044203758, decouple_loss:0.0005228428635746241
The modified gen p mean: 0.4498271942138672, gen p mean: -0.13103370368480682, mean p set: 0.45035696029663086
loss_pred:0.016283655539155006, decouple_loss:0.00041247313492931426
WV_1_PC_1_EH_0_PS_40, loss: 0.016468705609440804, avg_mse: 0.025858625769615173
current test mse: 0.025859
Iteration: 3931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44905298948287964, gen p mean: -0.12425506114959717, mean p set: 0.44962990283966064
loss_pred:0.015958374366164207, decouple_loss:0.0004691511276178062
The modified gen p mean: 0.44852492213249207, gen p mean: -0.12629562616348267, mean p set: 0.44910016655921936
loss_pred:0.015469962731003761, decouple_loss:0.00036416976945474744
The modified gen p mean: 0.4490094780921936, gen p mean: -0.126924067735672, mean p set: 0.44958674907684326
loss_pred:0.01605888456106186, decouple_loss:0.0003722453548107296
Iteration: 3932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486691653728485, gen p mean: -0.13052895665168762, mean p set: 0.44924622774124146
loss_pred:0.01512692030519247, decouple_loss:0.0004285394970793277
The modified gen p mean: 0.4501195251941681, gen p mean: -0.1319463551044464, mean p set: 0.45069611072540283The modified gen p mean: 0.45062410831451416, gen p mean: -0.13007469475269318, mean p set: 0.45120275020599365
loss_pred:0.01517848577350378, decouple_loss:0.000560058921109885
loss_pred:0.015093355439603329, decouple_loss:0.0006167255924083292
Iteration: 3933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097196102142334, gen p mean: -0.12675142288208008, mean p set: 0.45154935121536255
loss_pred:0.01626061089336872, decouple_loss:0.00045327754924073815
The modified gen p mean: 0.4506155848503113, gen p mean: -0.1302410364151001, mean p set: 0.45119279623031616
loss_pred:0.01499742828309536, decouple_loss:0.0003922486794181168
The modified gen p mean: 0.4486953020095825, gen p mean: -0.13040313124656677, mean p set: 0.4492696523666382
loss_pred:0.014873113483190536, decouple_loss:0.0003362175193615258
Iteration: 3934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473312497138977, gen p mean: -0.12646837532520294, mean p set: 0.4479064345359802
loss_pred:0.01525820977985859, decouple_loss:0.0003519260499160737
The modified gen p mean: 0.4507472515106201, gen p mean: -0.13021358847618103, mean p set: 0.4513210952281952
loss_pred:0.01527845673263073, decouple_loss:0.00033740722574293613
The modified gen p mean: 0.45069941878318787, gen p mean: -0.12960664927959442, mean p set: 0.4512770175933838
loss_pred:0.015382331795990467, decouple_loss:0.0003409764321986586
Iteration: 3935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513412117958069, gen p mean: -0.12844932079315186, mean p set: 0.45191389322280884
The modified gen p mean: 0.4497794508934021, gen p mean: -0.1333535760641098, mean p set: 0.45035505294799805
loss_pred:0.015154230408370495, decouple_loss:0.00030862184939906
loss_pred:0.015561616979539394, decouple_loss:0.00029113353230059147
The modified gen p mean: 0.44913604855537415, gen p mean: -0.1288621425628662, mean p set: 0.449710875749588
loss_pred:0.016175296157598495, decouple_loss:0.0003928851801902056
Iteration: 3936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502415955066681, gen p mean: -0.13007968664169312, mean p set: 0.45081907510757446The modified gen p mean: 0.4508233368396759, gen p mean: -0.12595003843307495, mean p set: 0.4514020085334778
loss_pred:0.0153494318947196, decouple_loss:0.0003655977488961071
loss_pred:0.015513252466917038, decouple_loss:0.0004492150619626045
The modified gen p mean: 0.450152188539505, gen p mean: -0.12888801097869873, mean p set: 0.4507302939891815
loss_pred:0.015917805954813957, decouple_loss:0.00043203140376135707
Iteration: 3937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490581154823303, gen p mean: -0.1314387172460556, mean p set: 0.4496335983276367
loss_pred:0.015006540343165398, decouple_loss:0.00038267075433395803
The modified gen p mean: 0.44972050189971924, gen p mean: -0.13158783316612244, mean p set: 0.4502963423728943
The modified gen p mean: 0.4492761790752411, gen p mean: -0.12623925507068634, mean p set: 0.4498521387577057
loss_pred:0.014900093898177147, decouple_loss:0.00042533804662525654
loss_pred:0.015474392101168633, decouple_loss:0.00028538619517348707
Iteration: 3938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044293999671936, gen p mean: -0.12941086292266846, mean p set: 0.4510233402252197
loss_pred:0.01584860496222973, decouple_loss:0.00058458506828174
The modified gen p mean: 0.45009851455688477, gen p mean: -0.13098113238811493, mean p set: 0.4506766200065613
The modified gen p mean: 0.44966185092926025, gen p mean: -0.12432754039764404, mean p set: 0.450238436460495
loss_pred:0.015576005913317204, decouple_loss:0.0005245266947895288
loss_pred:0.014821361750364304, decouple_loss:0.0004228035104461014
Iteration: 3939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474804699420929, gen p mean: -0.12795434892177582, mean p set: 0.4480571150779724
loss_pred:0.015044345520436764, decouple_loss:0.00031828382634557784
The modified gen p mean: 0.4502013325691223, gen p mean: -0.1264861822128296, mean p set: 0.4507790505886078
loss_pred:0.015914663672447205, decouple_loss:0.000515300314873457
The modified gen p mean: 0.4500308036804199, gen p mean: -0.12510661780834198, mean p set: 0.45060789585113525
loss_pred:0.01597127690911293, decouple_loss:0.0004907314432784915
Iteration: 3940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975990056991577, gen p mean: -0.12777967751026154, mean p set: 0.4503363370895386
loss_pred:0.015726834535598755, decouple_loss:0.00034856691490858793
The modified gen p mean: 0.45013004541397095, gen p mean: -0.12742994725704193, mean p set: 0.4507073163986206
loss_pred:0.015820812433958054, decouple_loss:0.000357781071215868
The modified gen p mean: 0.4505331516265869, gen p mean: -0.130257710814476, mean p set: 0.451107382774353
loss_pred:0.014844008721411228, decouple_loss:0.00035959805245511234
2023-05-02 18:52:10 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13752156496047974, mean p set: 0.4502691626548767
loss_pred:0.016933733597397804, decouple_loss:0.0007500084466300905
The modified gen p mean: 0.4495333433151245, gen p mean: -0.1318073570728302, mean p set: 0.4500633478164673
loss_pred:0.016138166189193726, decouple_loss:0.0006139424513094127
The modified gen p mean: 0.44983112812042236, gen p mean: -0.13127483427524567, mean p set: 0.45035696029663086
loss_pred:0.016318580135703087, decouple_loss:0.0005468946183100343
WV_1_PC_1_EH_0_PS_40, loss: 0.016495341435074806, avg_mse: 0.025848450139164925
current test mse: 0.025848
Iteration: 3941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44922903180122375, gen p mean: -0.12564131617546082, mean p set: 0.4498059153556824
loss_pred:0.0156962089240551, decouple_loss:0.0003262002719566226
The modified gen p mean: 0.449781596660614, gen p mean: -0.12388283014297485, mean p set: 0.4503605365753174
loss_pred:0.014581025578081608, decouple_loss:0.00043382271542213857
The modified gen p mean: 0.44879505038261414, gen p mean: -0.1261676549911499, mean p set: 0.4493708908557892
loss_pred:0.01602822169661522, decouple_loss:0.00041112813050858676
Iteration: 3942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45083147287368774, gen p mean: -0.13162152469158173, mean p set: 0.45140841603279114
loss_pred:0.015385827049612999, decouple_loss:0.0003841231809929013
The modified gen p mean: 0.45036792755126953, gen p mean: -0.12715159356594086, mean p set: 0.4509435296058655The modified gen p mean: 0.44853249192237854, gen p mean: -0.13189706206321716, mean p set: 0.44910821318626404
loss_pred:0.01534171774983406, decouple_loss:0.0003906162455677986
loss_pred:0.015357431955635548, decouple_loss:0.0006182956858538091
Iteration: 3943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502669870853424, gen p mean: -0.12221140414476395, mean p set: 0.45084407925605774
loss_pred:0.015780799090862274, decouple_loss:0.0003775488876271993
The modified gen p mean: 0.4485316574573517, gen p mean: -0.13033133745193481, mean p set: 0.4491093158721924
loss_pred:0.01553451456129551, decouple_loss:0.00041928834980353713
The modified gen p mean: 0.44893282651901245, gen p mean: -0.1265670210123062, mean p set: 0.4495084881782532
loss_pred:0.015322647988796234, decouple_loss:0.00035768235102295876
Iteration: 3944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502590000629425, gen p mean: -0.12450898438692093, mean p set: 0.4508344829082489
loss_pred:0.01509171538054943, decouple_loss:0.0005107590695843101
The modified gen p mean: 0.450631320476532, gen p mean: -0.12813346087932587, mean p set: 0.451210081577301
loss_pred:0.015096398070454597, decouple_loss:0.0004671688366215676
The modified gen p mean: 0.45008307695388794, gen p mean: -0.1283615082502365, mean p set: 0.45066148042678833
loss_pred:0.015043351799249649, decouple_loss:0.0004300315340515226
Iteration: 3945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45111629366874695, gen p mean: -0.12723882496356964, mean p set: 0.451691210269928
loss_pred:0.015040894038975239, decouple_loss:0.0004715624381788075
The modified gen p mean: 0.4492112398147583, gen p mean: -0.12632782757282257, mean p set: 0.44978588819503784
loss_pred:0.015507603995501995, decouple_loss:0.00035409381962381303
The modified gen p mean: 0.45056846737861633, gen p mean: -0.1300269067287445, mean p set: 0.4511445164680481
loss_pred:0.015330042690038681, decouple_loss:0.00044789587263949215
Iteration: 3946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45088276267051697, gen p mean: -0.1292782425880432, mean p set: 0.4514552056789398
loss_pred:0.015457470901310444, decouple_loss:0.000339382269885391
The modified gen p mean: 0.4503544867038727, gen p mean: -0.133917436003685, mean p set: 0.4509302079677582
loss_pred:0.015237395651638508, decouple_loss:0.0004325399931985885
The modified gen p mean: 0.45054662227630615, gen p mean: -0.13407467305660248, mean p set: 0.45112112164497375
loss_pred:0.014698031358420849, decouple_loss:0.00037200580118224025
Iteration: 3947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496794641017914, gen p mean: -0.1348416954278946, mean p set: 0.45025497674942017
loss_pred:0.015050306916236877, decouple_loss:0.00030911248177289963
The modified gen p mean: 0.45073986053466797, gen p mean: -0.13430504500865936, mean p set: 0.4513164758682251
loss_pred:0.01531260460615158, decouple_loss:0.0004036284517496824
The modified gen p mean: 0.4497450590133667, gen p mean: -0.13788819313049316, mean p set: 0.4503205716609955
loss_pred:0.015541025437414646, decouple_loss:0.000436522503150627
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
NaN value num: 0
Iteration: 3948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44970569014549255, gen p mean: -0.13895338773727417, mean p set: 0.45028162002563477
The modified gen p mean: 0.44959935545921326, gen p mean: -0.13739484548568726, mean p set: 0.4501752555370331
loss_pred:0.015335566364228725, decouple_loss:0.00041091081220656633
loss_pred:0.01447903923690319, decouple_loss:0.00031274979119189084
The modified gen p mean: 0.4517422914505005, gen p mean: -0.13651558756828308, mean p set: 0.4523191750049591
loss_pred:0.014906219206750393, decouple_loss:0.00047883359366096556
Iteration: 3949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514123797416687, gen p mean: -0.14156892895698547, mean p set: 0.4519873261451721
loss_pred:0.01506859716027975, decouple_loss:0.000429985549999401
The modified gen p mean: 0.4511851668357849, gen p mean: -0.13945940136909485, mean p set: 0.4517599642276764
The modified gen p mean: 0.4493432343006134, gen p mean: -0.13918034732341766, mean p set: 0.4499163329601288
loss_pred:0.014103739522397518, decouple_loss:0.00034144154051318765
loss_pred:0.015628356486558914, decouple_loss:0.0003096016589552164
Iteration: 3950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45072615146636963, gen p mean: -0.13895556330680847, mean p set: 0.45130327343940735
loss_pred:0.014051467180252075, decouple_loss:0.0004587813455145806
The modified gen p mean: 0.44937533140182495, gen p mean: -0.14516547322273254, mean p set: 0.449952095746994
loss_pred:0.014268736355006695, decouple_loss:0.0003547715023159981
The modified gen p mean: 0.44882380962371826, gen p mean: -0.13824115693569183, mean p set: 0.44940266013145447
loss_pred:0.014346678741276264, decouple_loss:0.0003740950778592378
2023-05-02 18:54:56 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1456596702337265, mean p set: 0.4502691626548767
loss_pred:0.0169384703040123, decouple_loss:0.00039161101449280977
The modified gen p mean: 0.4495343565940857, gen p mean: -0.13949652016162872, mean p set: 0.4500633478164673
The modified gen p mean: 0.4498290717601776, gen p mean: -0.13877291977405548, mean p set: 0.45035696029663086
loss_pred:0.016155879944562912, decouple_loss:0.0004155099159106612
loss_pred:0.016306718811392784, decouple_loss:0.00044730526860803366
WV_1_PC_1_EH_0_PS_40, loss: 0.016487929970026016, avg_mse: 0.025818467140197754
current test mse: 0.025818
Iteration: 3951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498252868652344, gen p mean: -0.14133940637111664, mean p set: 0.45039960741996765
loss_pred:0.014946606941521168, decouple_loss:0.00037262437399476767
The modified gen p mean: 0.45157158374786377, gen p mean: -0.13365888595581055, mean p set: 0.4521452486515045The modified gen p mean: 0.4513542652130127, gen p mean: -0.13482798635959625, mean p set: 0.4519321024417877
loss_pred:0.014178757555782795, decouple_loss:0.000440656061982736
loss_pred:0.01405471470206976, decouple_loss:0.00040808180347085
Iteration: 3952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511277377605438, gen p mean: -0.13224247097969055, mean p set: 0.4517051577568054
loss_pred:0.014447635971009731, decouple_loss:0.0004751263768412173
The modified gen p mean: 0.44959214329719543, gen p mean: -0.14183436334133148, mean p set: 0.4501676559448242The modified gen p mean: 0.4494083523750305, gen p mean: -0.13762617111206055, mean p set: 0.44998836517333984
loss_pred:0.014572864398360252, decouple_loss:0.0003200300852768123
loss_pred:0.014524077996611595, decouple_loss:0.00029470608569681644
Iteration: 3953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491581320762634, gen p mean: -0.13135163486003876, mean p set: 0.4497356712818146
loss_pred:0.014036287553608418, decouple_loss:0.0003079960006289184
The modified gen p mean: 0.45118099451065063, gen p mean: -0.12824860215187073, mean p set: 0.45175832509994507
loss_pred:0.014300791546702385, decouple_loss:0.000329255242832005
The modified gen p mean: 0.45131903886795044, gen p mean: -0.1334434151649475, mean p set: 0.4518939256668091
loss_pred:0.014209221117198467, decouple_loss:0.00043558553443290293
Iteration: 3954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45125412940979004, gen p mean: -0.12961499392986298, mean p set: 0.4518289566040039
loss_pred:0.013599718920886517, decouple_loss:0.0003103025956079364
The modified gen p mean: 0.4501768946647644, gen p mean: -0.13066785037517548, mean p set: 0.45075374841690063
loss_pred:0.014700043946504593, decouple_loss:0.00038993117050267756
The modified gen p mean: 0.4497152864933014, gen p mean: -0.13221359252929688, mean p set: 0.45029211044311523
loss_pred:0.01444281730800867, decouple_loss:0.00032428986742161214
Iteration: 3955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510851800441742, gen p mean: -0.12758667767047882, mean p set: 0.4516620337963104
loss_pred:0.0144962752237916, decouple_loss:0.000432737753726542
The modified gen p mean: 0.4496486186981201, gen p mean: -0.1368194818496704, mean p set: 0.45022377371788025
loss_pred:0.014382374472916126, decouple_loss:0.000573864090256393
The modified gen p mean: 0.4492928981781006, gen p mean: -0.12758582830429077, mean p set: 0.4498729407787323
loss_pred:0.015237749554216862, decouple_loss:0.00043966295197606087
Iteration: 3956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45268166065216064, gen p mean: -0.12968489527702332, mean p set: 0.45326003432273865
loss_pred:0.01400011871010065, decouple_loss:0.00037824627361260355
The modified gen p mean: 0.44899696111679077, gen p mean: -0.1286018043756485, mean p set: 0.4495701789855957
loss_pred:0.014844482764601707, decouple_loss:0.00029898833599872887
The modified gen p mean: 0.4498971700668335, gen p mean: -0.13100408017635345, mean p set: 0.4504731595516205
loss_pred:0.014409753493964672, decouple_loss:0.0002994125534314662
Iteration: 3957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514000713825226, gen p mean: -0.12570926547050476, mean p set: 0.45197638869285583
loss_pred:0.013820404186844826, decouple_loss:0.00038760644383728504
The modified gen p mean: 0.4527859687805176, gen p mean: -0.13174954056739807, mean p set: 0.4533640444278717
loss_pred:0.01401941105723381, decouple_loss:0.0005728943506255746
The modified gen p mean: 0.4506542384624481, gen p mean: -0.12748503684997559, mean p set: 0.4512324035167694
loss_pred:0.014602309092879295, decouple_loss:0.00034664402483031154
Iteration: 3958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527565836906433, gen p mean: -0.13003428280353546, mean p set: 0.45333418250083923
loss_pred:0.013746120035648346, decouple_loss:0.00037021838943473995
The modified gen p mean: 0.44756633043289185, gen p mean: -0.14106303453445435, mean p set: 0.448142409324646
loss_pred:0.014680423773825169, decouple_loss:0.0003623564844019711
The modified gen p mean: 0.4497695565223694, gen p mean: -0.13587068021297455, mean p set: 0.4503476321697235
loss_pred:0.014091508463025093, decouple_loss:0.00031768748885951936
Iteration: 3959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449691504240036, gen p mean: -0.13490793108940125, mean p set: 0.45026808977127075
loss_pred:0.01471016276627779, decouple_loss:0.0003489293740130961
The modified gen p mean: 0.4510614275932312, gen p mean: -0.1327965408563614, mean p set: 0.4516368806362152
loss_pred:0.014775452204048634, decouple_loss:0.0003127679228782654
The modified gen p mean: 0.45039188861846924, gen p mean: -0.1382599025964737, mean p set: 0.4509674608707428
loss_pred:0.014075538143515587, decouple_loss:0.00026873985189013183
Iteration: 3960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520530700683594, gen p mean: -0.13227520883083344, mean p set: 0.45262959599494934
loss_pred:0.013809401541948318, decouple_loss:0.0003764581342693418
The modified gen p mean: 0.4489533305168152, gen p mean: -0.1373230218887329, mean p set: 0.44953182339668274
The modified gen p mean: 0.451402485370636, gen p mean: -0.13262176513671875, mean p set: 0.45198073983192444
loss_pred:0.01441458985209465, decouple_loss:0.00040483707562088966
loss_pred:0.014185904525220394, decouple_loss:0.0004014885926153511
2023-05-02 18:57:03 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.14180180430412292, mean p set: 0.4502691626548767
loss_pred:0.016867568716406822, decouple_loss:0.00044361388427205384
The modified gen p mean: 0.449537456035614, gen p mean: -0.1356774866580963, mean p set: 0.4500633478164673
loss_pred:0.016153445467352867, decouple_loss:0.00048582907766103745
The modified gen p mean: 0.4498313069343567, gen p mean: -0.13480161130428314, mean p set: 0.45035696029663086
loss_pred:0.016312487423419952, decouple_loss:0.0004379119782242924
WV_1_PC_1_EH_0_PS_40, loss: 0.016467289999127388, avg_mse: 0.025815190747380257
current test mse: 0.025815
Iteration: 3961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500637948513031, gen p mean: -0.1315295696258545, mean p set: 0.4506407380104065
loss_pred:0.014400281012058258, decouple_loss:0.00040408261702395976
The modified gen p mean: 0.4480460584163666, gen p mean: -0.13825908303260803, mean p set: 0.44862014055252075
loss_pred:0.014278738759458065, decouple_loss:0.0003439685679040849
The modified gen p mean: 0.4489421844482422, gen p mean: -0.13304868340492249, mean p set: 0.44951876997947693
loss_pred:0.014284387230873108, decouple_loss:0.0004111191665288061
Iteration: 3962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45124489068984985, gen p mean: -0.13216453790664673, mean p set: 0.4518211781978607
loss_pred:0.014807093888521194, decouple_loss:0.000558415602426976
The modified gen p mean: 0.45137953758239746, gen p mean: -0.13070309162139893, mean p set: 0.45195427536964417The modified gen p mean: 0.45145362615585327, gen p mean: -0.13256292045116425, mean p set: 0.4520314931869507
loss_pred:0.013927783817052841, decouple_loss:0.00038193530053831637
loss_pred:0.01399328000843525, decouple_loss:0.0003356773522682488
Iteration: 3963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510509669780731, gen p mean: -0.1348622590303421, mean p set: 0.45162567496299744
The modified gen p mean: 0.45030125975608826, gen p mean: -0.13623838126659393, mean p set: 0.45087674260139465
loss_pred:0.014655371196568012, decouple_loss:0.00045578571734949946
loss_pred:0.015076507814228535, decouple_loss:0.00047822564374655485
The modified gen p mean: 0.45274069905281067, gen p mean: -0.13477638363838196, mean p set: 0.4533170461654663
loss_pred:0.013946115039288998, decouple_loss:0.00043974723666906357
Iteration: 3964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45102551579475403, gen p mean: -0.13727949559688568, mean p set: 0.4516025483608246
loss_pred:0.014619847759604454, decouple_loss:0.0003721006214618683
The modified gen p mean: 0.44987064599990845, gen p mean: -0.14326204359531403, mean p set: 0.4504474103450775
loss_pred:0.014203925617039204, decouple_loss:0.0003546411753632128
The modified gen p mean: 0.44875428080558777, gen p mean: -0.14201202988624573, mean p set: 0.4493304491043091
loss_pred:0.014399530366063118, decouple_loss:0.00030073398374952376
Iteration: 3965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45151203870773315, gen p mean: -0.13507460057735443, mean p set: 0.45208731293678284
loss_pred:0.014016125351190567, decouple_loss:0.0003498431178741157
The modified gen p mean: 0.4511406421661377, gen p mean: -0.13143792748451233, mean p set: 0.4517160654067993
loss_pred:0.01452128030359745, decouple_loss:0.0002987415646202862
The modified gen p mean: 0.4492928385734558, gen p mean: -0.133395716547966, mean p set: 0.4498688280582428
loss_pred:0.014307666569948196, decouple_loss:0.0002925729495473206
Iteration: 3966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492560029029846, gen p mean: -0.12985743582248688, mean p set: 0.4498332440853119
loss_pred:0.014358959160745144, decouple_loss:0.00041349182720296085
The modified gen p mean: 0.45085740089416504, gen p mean: -0.13009819388389587, mean p set: 0.4514331519603729
The modified gen p mean: 0.4504880905151367, gen p mean: -0.13647140562534332, mean p set: 0.4510645270347595
loss_pred:0.0140331219881773, decouple_loss:0.0005624726181849837
loss_pred:0.013906005769968033, decouple_loss:0.00036515670944936574
Iteration: 3967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486498236656189, gen p mean: -0.13859353959560394, mean p set: 0.44922778010368347
loss_pred:0.014397055841982365, decouple_loss:0.0005683518247678876
The modified gen p mean: 0.449650377035141, gen p mean: -0.13103926181793213, mean p set: 0.45022279024124146
The modified gen p mean: 0.45188388228416443, gen p mean: -0.1288108229637146, mean p set: 0.4524591267108917
loss_pred:0.014278113842010498, decouple_loss:0.0005218514706939459
loss_pred:0.014106125570833683, decouple_loss:0.0004959134384989738
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
NaN value num: 0
Iteration: 3968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473966360092163, gen p mean: -0.13630326092243195, mean p set: 0.447974294424057
loss_pred:0.015463098883628845, decouple_loss:0.00033491270733065903
The modified gen p mean: 0.4478299617767334, gen p mean: -0.13542520999908447, mean p set: 0.44840285181999207
The modified gen p mean: 0.44804099202156067, gen p mean: -0.14172405004501343, mean p set: 0.44861429929733276
loss_pred:0.015255050733685493, decouple_loss:0.0003277409414295107
loss_pred:0.015405927784740925, decouple_loss:0.00044448592234402895
Iteration: 3969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860678911209106, gen p mean: -0.1266002357006073, mean p set: 0.4491809606552124
loss_pred:0.014641583897173405, decouple_loss:0.0003634276508819312
The modified gen p mean: 0.4492042362689972, gen p mean: -0.1271415650844574, mean p set: 0.4497813284397125
loss_pred:0.014763781800866127, decouple_loss:0.0004624362918548286
The modified gen p mean: 0.44719842076301575, gen p mean: -0.13782623410224915, mean p set: 0.4477744400501251
loss_pred:0.015689892694354057, decouple_loss:0.0004431308771017939
Iteration: 3970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448209673166275, gen p mean: -0.13843955099582672, mean p set: 0.44878458976745605
loss_pred:0.01472395844757557, decouple_loss:0.0003624830860644579
The modified gen p mean: 0.4478987157344818, gen p mean: -0.1308196485042572, mean p set: 0.4484792649745941
The modified gen p mean: 0.4476911425590515, gen p mean: -0.1326838582754135, mean p set: 0.44826775789260864
loss_pred:0.015991421416401863, decouple_loss:0.00027923958259634674
loss_pred:0.01656125858426094, decouple_loss:0.00035374797880649567
2023-05-02 18:59:54 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13552558422088623, mean p set: 0.4502691626548767
loss_pred:0.016806649044156075, decouple_loss:0.0004094220057595521
The modified gen p mean: 0.4495331346988678, gen p mean: -0.12881727516651154, mean p set: 0.4500633478164673
loss_pred:0.016042737290263176, decouple_loss:0.00037609634455293417
The modified gen p mean: 0.4498283863067627, gen p mean: -0.12818239629268646, mean p set: 0.45035696029663086
loss_pred:0.016294440254569054, decouple_loss:0.0003448484349064529
WV_1_PC_1_EH_0_PS_40, loss: 0.016400117427110672, avg_mse: 0.025677548721432686
current test mse: 0.025678
Iteration: 3971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480525255203247, gen p mean: -0.12403963506221771, mean p set: 0.44862788915634155
loss_pred:0.014703411608934402, decouple_loss:0.00034911668626591563
The modified gen p mean: 0.44637346267700195, gen p mean: -0.12806189060211182, mean p set: 0.44695067405700684
loss_pred:0.016304204240441322, decouple_loss:0.0005216200370341539
The modified gen p mean: 0.44682881236076355, gen p mean: -0.12626071274280548, mean p set: 0.4474024772644043
loss_pred:0.015464861877262592, decouple_loss:0.0004598399391397834
Iteration: 3972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485277235507965, gen p mean: -0.12263134121894836, mean p set: 0.4491044282913208
loss_pred:0.014672527089715004, decouple_loss:0.00036847800947725773
The modified gen p mean: 0.44716140627861023, gen p mean: -0.1294006109237671, mean p set: 0.4477371573448181The modified gen p mean: 0.44778165221214294, gen p mean: -0.12724409997463226, mean p set: 0.44835713505744934
loss_pred:0.015246416442096233, decouple_loss:0.0004353218828327954
loss_pred:0.015102009288966656, decouple_loss:0.00039307327824644744
Iteration: 3973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482554495334625, gen p mean: -0.13110482692718506, mean p set: 0.448832243680954
loss_pred:0.016727080568671227, decouple_loss:0.00040355243254452944
The modified gen p mean: 0.44974908232688904, gen p mean: -0.1255163997411728, mean p set: 0.45032617449760437
loss_pred:0.014961770735681057, decouple_loss:0.0003021234006155282
The modified gen p mean: 0.4473787844181061, gen p mean: -0.13265860080718994, mean p set: 0.4479536712169647
loss_pred:0.015915170311927795, decouple_loss:0.0003770870389416814
Iteration: 3974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44899412989616394, gen p mean: -0.12987086176872253, mean p set: 0.44957301020622253
loss_pred:0.014583269134163857, decouple_loss:0.0002649128728080541
The modified gen p mean: 0.44846460223197937, gen p mean: -0.13038747012615204, mean p set: 0.44904273748397827
loss_pred:0.014997332356870174, decouple_loss:0.00031663369736634195
The modified gen p mean: 0.44731763005256653, gen p mean: -0.13460128009319305, mean p set: 0.44789421558380127
loss_pred:0.015367614105343819, decouple_loss:0.0002962127618957311
Iteration: 3975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468120038509369, gen p mean: -0.1337975263595581, mean p set: 0.44738876819610596
loss_pred:0.016492998227477074, decouple_loss:0.0004624626017175615
The modified gen p mean: 0.44765251874923706, gen p mean: -0.13290926814079285, mean p set: 0.4482274651527405
loss_pred:0.01608886569738388, decouple_loss:0.00041962930117733777
The modified gen p mean: 0.44957563281059265, gen p mean: -0.1339053064584732, mean p set: 0.45015189051628113
loss_pred:0.014989426359534264, decouple_loss:0.0002888238232117146
Iteration: 3976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722384214401245, gen p mean: -0.13049224019050598, mean p set: 0.44779905676841736
loss_pred:0.01575063169002533, decouple_loss:0.00048508672625757754
The modified gen p mean: 0.44650688767433167, gen p mean: -0.1414957046508789, mean p set: 0.44708430767059326
The modified gen p mean: 0.44703730940818787, gen p mean: -0.1306396871805191, mean p set: 0.44761213660240173
loss_pred:0.015762558206915855, decouple_loss:0.00033695765887387097
loss_pred:0.015775391831994057, decouple_loss:0.0003918647416867316
Iteration: 3977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472528100013733, gen p mean: -0.13390463590621948, mean p set: 0.4478277862071991
loss_pred:0.015910224989056587, decouple_loss:0.00031136313918977976
The modified gen p mean: 0.4490527808666229, gen p mean: -0.13077737390995026, mean p set: 0.4496292173862457
loss_pred:0.01480431854724884, decouple_loss:0.00033739631180651486
The modified gen p mean: 0.4470762014389038, gen p mean: -0.1287984400987625, mean p set: 0.44765329360961914
loss_pred:0.015546266920864582, decouple_loss:0.0003086113138124347
Iteration: 3978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44870060682296753, gen p mean: -0.12587139010429382, mean p set: 0.44927728176116943
The modified gen p mean: 0.4490625262260437, gen p mean: -0.1280929446220398, mean p set: 0.44964075088500977loss_pred:0.015009447000920773, decouple_loss:0.00045770019642077386
loss_pred:0.014737359248101711, decouple_loss:0.00037792755756527185
The modified gen p mean: 0.44740599393844604, gen p mean: -0.12572994828224182, mean p set: 0.4479839503765106
loss_pred:0.015527432784438133, decouple_loss:0.0003951549297198653
Iteration: 3979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820636510849, gen p mean: -0.12889893352985382, mean p set: 0.4487842917442322
The modified gen p mean: 0.45009228587150574, gen p mean: -0.12692101299762726, mean p set: 0.450667142868042
loss_pred:0.01565251313149929, decouple_loss:0.00042256544111296535
loss_pred:0.015194355510175228, decouple_loss:0.0002994611277244985
The modified gen p mean: 0.447033554315567, gen p mean: -0.1280229240655899, mean p set: 0.4476097822189331
loss_pred:0.015500996261835098, decouple_loss:0.00029214503592811525
Iteration: 3980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473208487033844, gen p mean: -0.12427010387182236, mean p set: 0.44789883494377136
The modified gen p mean: 0.4468873143196106, gen p mean: -0.13068732619285583, mean p set: 0.4474656283855438
loss_pred:0.015768742188811302, decouple_loss:0.00028598966309800744
loss_pred:0.015056505799293518, decouple_loss:0.00048269075341522694
The modified gen p mean: 0.4492967128753662, gen p mean: -0.12675444781780243, mean p set: 0.4498717188835144
loss_pred:0.014974912628531456, decouple_loss:0.0002958849654532969
2023-05-02 19:02:00 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13085053861141205, mean p set: 0.4502691626548767
loss_pred:0.016918012872338295, decouple_loss:0.0003819198755081743
The modified gen p mean: 0.44953370094299316, gen p mean: -0.1241917535662651, mean p set: 0.4500633478164673
loss_pred:0.016139451414346695, decouple_loss:0.0003689891309477389
The modified gen p mean: 0.44982877373695374, gen p mean: -0.12388838827610016, mean p set: 0.45035696029663086
loss_pred:0.016398485749959946, decouple_loss:0.00033726985566318035
WV_1_PC_1_EH_0_PS_40, loss: 0.016503453254699707, avg_mse: 0.02581924758851528
current test mse: 0.025819
Iteration: 3981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469492733478546, gen p mean: -0.12690897285938263, mean p set: 0.4475262761116028
loss_pred:0.01629129983484745, decouple_loss:0.0004369929083622992
The modified gen p mean: 0.44802170991897583, gen p mean: -0.12731684744358063, mean p set: 0.44859588146209717
loss_pred:0.015899846330285072, decouple_loss:0.0003141018678434193
The modified gen p mean: 0.4490910768508911, gen p mean: -0.1220543384552002, mean p set: 0.44966837763786316
loss_pred:0.014918653294444084, decouple_loss:0.0002859439991880208
Iteration: 3982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479844570159912, gen p mean: -0.12273310869932175, mean p set: 0.44855955243110657
loss_pred:0.015428679063916206, decouple_loss:0.0003483968321233988
The modified gen p mean: 0.4468129575252533, gen p mean: -0.12886036932468414, mean p set: 0.4473898112773895The modified gen p mean: 0.44822219014167786, gen p mean: -0.12534694373607635, mean p set: 0.44879916310310364
loss_pred:0.015143896453082561, decouple_loss:0.0003365246520843357
loss_pred:0.0150523129850626, decouple_loss:0.0003523318446241319
Iteration: 3983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496321380138397, gen p mean: -0.12513098120689392, mean p set: 0.45020791888237
loss_pred:0.014774458482861519, decouple_loss:0.00031702869455330074
The modified gen p mean: 0.44681426882743835, gen p mean: -0.12427418678998947, mean p set: 0.447390615940094
loss_pred:0.016738180071115494, decouple_loss:0.00042370674782432616
The modified gen p mean: 0.4464550316333771, gen p mean: -0.13220424950122833, mean p set: 0.4470324218273163
loss_pred:0.01571003347635269, decouple_loss:0.00033606842043809593
Iteration: 3984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823116064071655, gen p mean: -0.12240719050168991, mean p set: 0.44880858063697815
loss_pred:0.015483464114367962, decouple_loss:0.0003506010980345309
The modified gen p mean: 0.44687870144844055, gen p mean: -0.12595556676387787, mean p set: 0.44745421409606934
loss_pred:0.014965864829719067, decouple_loss:0.00031154780299402773
The modified gen p mean: 0.44908657670021057, gen p mean: -0.12292739748954773, mean p set: 0.4496642053127289
loss_pred:0.014371603727340698, decouple_loss:0.00036407308652997017
Iteration: 3985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841670989990234, gen p mean: -0.13440118730068207, mean p set: 0.44899317622184753
loss_pred:0.014781704172492027, decouple_loss:0.00037767135654576123
The modified gen p mean: 0.447624534368515, gen p mean: -0.1255214661359787, mean p set: 0.44820311665534973
loss_pred:0.014919591136276722, decouple_loss:0.0003254729090258479
The modified gen p mean: 0.4468938112258911, gen p mean: -0.12715600430965424, mean p set: 0.44746968150138855
loss_pred:0.015160197392106056, decouple_loss:0.0002564745373092592
Iteration: 3986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889914989471436, gen p mean: -0.1361481249332428, mean p set: 0.4494765102863312
loss_pred:0.014591795392334461, decouple_loss:0.00026832520961761475
The modified gen p mean: 0.4474145770072937, gen p mean: -0.12787117063999176, mean p set: 0.44798994064331055
loss_pred:0.01579327881336212, decouple_loss:0.0003863285237457603
The modified gen p mean: 0.4477746784687042, gen p mean: -0.12817727029323578, mean p set: 0.44834980368614197
loss_pred:0.016308389604091644, decouple_loss:0.0002991410729009658
Iteration: 3987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763344526290894, gen p mean: -0.13574758172035217, mean p set: 0.44820842146873474
loss_pred:0.015468047931790352, decouple_loss:0.00030788296135142446
The modified gen p mean: 0.44860562682151794, gen p mean: -0.13473942875862122, mean p set: 0.4491821527481079
The modified gen p mean: 0.4470783472061157, gen p mean: -0.13708922266960144, mean p set: 0.4476519823074341
loss_pred:0.014614379033446312, decouple_loss:0.00029233854729682207
loss_pred:0.014931311830878258, decouple_loss:0.00031802456942386925
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
NaN value num: 0
Iteration: 3988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477161467075348, gen p mean: -0.12694652378559113, mean p set: 0.44828951358795166
loss_pred:0.01548726111650467, decouple_loss:0.0004575221100822091
The modified gen p mean: 0.44612014293670654, gen p mean: -0.13205371797084808, mean p set: 0.4466968774795532
The modified gen p mean: 0.4457020163536072, gen p mean: -0.1389443725347519, mean p set: 0.4462752044200897
loss_pred:0.01629842072725296, decouple_loss:0.00039368303259834647
loss_pred:0.015920300036668777, decouple_loss:0.00034384342143312097
Iteration: 3989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448188453912735, gen p mean: -0.1282145380973816, mean p set: 0.44876134395599365
loss_pred:0.016495373100042343, decouple_loss:0.0002895958023145795
The modified gen p mean: 0.4466695189476013, gen p mean: -0.13074198365211487, mean p set: 0.44724777340888977
loss_pred:0.015491852536797523, decouple_loss:0.0003991783887613565
The modified gen p mean: 0.44619065523147583, gen p mean: -0.13375622034072876, mean p set: 0.4467630088329315
loss_pred:0.016429226845502853, decouple_loss:0.0003590532287489623
Iteration: 3990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767239689826965, gen p mean: -0.13424651324748993, mean p set: 0.448250949382782
loss_pred:0.016357073560357094, decouple_loss:0.00030012422939762473
The modified gen p mean: 0.44669008255004883, gen p mean: -0.13248024880886078, mean p set: 0.44726744294166565
loss_pred:0.01590878888964653, decouple_loss:0.00030886050080880523
The modified gen p mean: 0.446787029504776, gen p mean: -0.13452108204364777, mean p set: 0.4473620653152466
loss_pred:0.016714591532945633, decouple_loss:0.0003305745776742697
2023-05-02 19:04:58 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1392390877008438, mean p set: 0.4502691626548767
loss_pred:0.01681201532483101, decouple_loss:0.0004165862046647817
The modified gen p mean: 0.4495351314544678, gen p mean: -0.13281364738941193, mean p set: 0.4500633478164673
loss_pred:0.01607753150165081, decouple_loss:0.00037900306051597
The modified gen p mean: 0.4498295485973358, gen p mean: -0.1327694058418274, mean p set: 0.45035696029663086
loss_pred:0.016309237107634544, decouple_loss:0.0003366651071701199
WV_1_PC_1_EH_0_PS_40, loss: 0.016418464481830597, avg_mse: 0.025669118389487267
current test mse: 0.025669
Iteration: 3991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44704651832580566, gen p mean: -0.12758801877498627, mean p set: 0.44762495160102844
loss_pred:0.015390767715871334, decouple_loss:0.0003397641412448138
The modified gen p mean: 0.4458374083042145, gen p mean: -0.13731826841831207, mean p set: 0.44641000032424927The modified gen p mean: 0.4459078311920166, gen p mean: -0.13147209584712982, mean p set: 0.44648540019989014
loss_pred:0.015584108419716358, decouple_loss:0.0004229846235830337
loss_pred:0.016892923042178154, decouple_loss:0.000362970371497795
Iteration: 3992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767487049102783, gen p mean: -0.13458307087421417, mean p set: 0.44824743270874023
loss_pred:0.016499284654855728, decouple_loss:0.00029281340539455414
The modified gen p mean: 0.44724366068840027, gen p mean: -0.13684076070785522, mean p set: 0.4478208124637604The modified gen p mean: 0.4479196071624756, gen p mean: -0.13007524609565735, mean p set: 0.4484969973564148
loss_pred:0.016435211524367332, decouple_loss:0.0003551095142029226
loss_pred:0.01662077009677887, decouple_loss:0.00039166543865576386
Iteration: 3993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474166929721832, gen p mean: -0.13544470071792603, mean p set: 0.44799190759658813
loss_pred:0.015102776698768139, decouple_loss:0.00033702090149745345
The modified gen p mean: 0.44691383838653564, gen p mean: -0.13283580541610718, mean p set: 0.4474903643131256
loss_pred:0.015970084816217422, decouple_loss:0.00030618353048339486
The modified gen p mean: 0.446185827255249, gen p mean: -0.13934122025966644, mean p set: 0.4467627704143524
loss_pred:0.016161566600203514, decouple_loss:0.0003092022961936891
Iteration: 3994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839224219322205, gen p mean: -0.13397838175296783, mean p set: 0.4489694833755493
loss_pred:0.01615925133228302, decouple_loss:0.00034093917929567397
The modified gen p mean: 0.44613024592399597, gen p mean: -0.13187812268733978, mean p set: 0.44670480489730835
loss_pred:0.01572422869503498, decouple_loss:0.0002742410288192332
The modified gen p mean: 0.4467276632785797, gen p mean: -0.13633817434310913, mean p set: 0.44730156660079956
loss_pred:0.016189763322472572, decouple_loss:0.000315990240778774
Iteration: 3995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462674856185913, gen p mean: -0.1336451917886734, mean p set: 0.44684502482414246
loss_pred:0.014988800510764122, decouple_loss:0.0002633466792758554
The modified gen p mean: 0.44616955518722534, gen p mean: -0.13103725016117096, mean p set: 0.446742981672287
loss_pred:0.016105467453598976, decouple_loss:0.00033749599242582917
The modified gen p mean: 0.4462719261646271, gen p mean: -0.13609257340431213, mean p set: 0.4468485414981842
loss_pred:0.015106095932424068, decouple_loss:0.0003229880821891129
Iteration: 3996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722822308540344, gen p mean: -0.12337499856948853, mean p set: 0.4478082060813904
loss_pred:0.01557081751525402, decouple_loss:0.0004187317390460521
The modified gen p mean: 0.4464934766292572, gen p mean: -0.13244609534740448, mean p set: 0.44707152247428894
loss_pred:0.015507335774600506, decouple_loss:0.0002952090871986002
The modified gen p mean: 0.44767895340919495, gen p mean: -0.13226006925106049, mean p set: 0.4482557475566864
loss_pred:0.015895579010248184, decouple_loss:0.0003380769048817456
Iteration: 3997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487670958042145, gen p mean: -0.1326165646314621, mean p set: 0.44934335350990295
loss_pred:0.016292158514261246, decouple_loss:0.0003383609000593424
The modified gen p mean: 0.44769489765167236, gen p mean: -0.12730775773525238, mean p set: 0.44826972484588623
loss_pred:0.014959140680730343, decouple_loss:0.0003241814556531608
The modified gen p mean: 0.4461958408355713, gen p mean: -0.13283994793891907, mean p set: 0.4467707574367523
loss_pred:0.01603562757372856, decouple_loss:0.000287956150714308
Iteration: 3998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808635115623474, gen p mean: -0.12772125005722046, mean p set: 0.4486643373966217
loss_pred:0.01648641936480999, decouple_loss:0.0003789655165746808
The modified gen p mean: 0.4460860788822174, gen p mean: -0.13128595054149628, mean p set: 0.44666171073913574
loss_pred:0.015741631388664246, decouple_loss:0.00043764669680967927
The modified gen p mean: 0.44605374336242676, gen p mean: -0.13830626010894775, mean p set: 0.44662904739379883
loss_pred:0.01571502536535263, decouple_loss:0.0004772499669343233
Iteration: 3999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488104283809662, gen p mean: -0.12809528410434723, mean p set: 0.449388325214386
loss_pred:0.015809426084160805, decouple_loss:0.0003973033162765205
The modified gen p mean: 0.4469006359577179, gen p mean: -0.13793666660785675, mean p set: 0.4474782347679138
loss_pred:0.01608472503721714, decouple_loss:0.0003719837695825845
The modified gen p mean: 0.44659140706062317, gen p mean: -0.12802754342556, mean p set: 0.4471668004989624
loss_pred:0.015925060957670212, decouple_loss:0.00037331567727960646
Iteration: 4000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819918274879456, gen p mean: -0.13063065707683563, mean p set: 0.44877323508262634
loss_pred:0.01523711159825325, decouple_loss:0.00038677992415614426
The modified gen p mean: 0.44625115394592285, gen p mean: -0.13708524405956268, mean p set: 0.44682982563972473
loss_pred:0.016058700159192085, decouple_loss:0.0003327543381601572
The modified gen p mean: 0.44862890243530273, gen p mean: -0.132175475358963, mean p set: 0.4492022693157196
loss_pred:0.015823332592844963, decouple_loss:0.00046472312533296645
2023-05-02 19:07:04 itr: 4000
training loss: [0.01607534 0.01525645 0.01584657]
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_4000.ckpt
2023-05-02 19:07:09 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.14350338280200958, mean p set: 0.4502691626548767
loss_pred:0.016836203634738922, decouple_loss:0.0004305514448788017
The modified gen p mean: 0.44953563809394836, gen p mean: -0.13743756711483002, mean p set: 0.4500633478164673
loss_pred:0.016083326190710068, decouple_loss:0.0004775088746100664
The modified gen p mean: 0.4498255252838135, gen p mean: -0.13751620054244995, mean p set: 0.45035696029663086
loss_pred:0.01641703024506569, decouple_loss:0.0003993289137724787
WV_1_PC_1_EH_0_PS_40, loss: 0.01646731048822403, avg_mse: 0.02574080601334572
current test mse: 0.025741
Iteration: 4001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459805190563202, gen p mean: -0.13829122483730316, mean p set: 0.446553498506546
loss_pred:0.015770910307765007, decouple_loss:0.00029438617639243603
The modified gen p mean: 0.44682756066322327, gen p mean: -0.13066555559635162, mean p set: 0.4474022090435028
loss_pred:0.0159520972520113, decouple_loss:0.0004399303870741278
The modified gen p mean: 0.4469924867153168, gen p mean: -0.13900157809257507, mean p set: 0.44756606221199036
loss_pred:0.015545717440545559, decouple_loss:0.0004541083180811256
Iteration: 4002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682931900024414, gen p mean: -0.1381540298461914, mean p set: 0.4474048614501953
loss_pred:0.016052303835749626, decouple_loss:0.0003990506229456514
The modified gen p mean: 0.44865283370018005, gen p mean: -0.13365374505519867, mean p set: 0.4492294192314148The modified gen p mean: 0.44606125354766846, gen p mean: -0.1403346061706543, mean p set: 0.4466361403465271
loss_pred:0.015875734388828278, decouple_loss:0.0004203819262329489loss_pred:0.015642404556274414, decouple_loss:0.00047032261500135064
Iteration: 4003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680678844451904, gen p mean: -0.1301586776971817, mean p set: 0.44737857580184937
The modified gen p mean: 0.4474385380744934, gen p mean: -0.13979734480381012, mean p set: 0.44801223278045654
loss_pred:0.016010707244277, decouple_loss:0.0003985198272857815
loss_pred:0.01636675000190735, decouple_loss:0.000350517948390916
The modified gen p mean: 0.44742482900619507, gen p mean: -0.1346907913684845, mean p set: 0.448001891374588
loss_pred:0.016681337729096413, decouple_loss:0.00032539453241042793
Iteration: 4004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849395751953125, gen p mean: -0.12799513339996338, mean p set: 0.44906821846961975
loss_pred:0.015085913240909576, decouple_loss:0.00038955133641138673
The modified gen p mean: 0.4466384947299957, gen p mean: -0.13332517445087433, mean p set: 0.4472139775753021
loss_pred:0.015273069031536579, decouple_loss:0.0005368110141716897
The modified gen p mean: 0.4482533037662506, gen p mean: -0.13619095087051392, mean p set: 0.44882747530937195
loss_pred:0.016057666391134262, decouple_loss:0.00032440261566080153
Iteration: 4005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44684797525405884, gen p mean: -0.12699875235557556, mean p set: 0.4474250078201294
loss_pred:0.015962157398462296, decouple_loss:0.0004291122895665467
The modified gen p mean: 0.44698894023895264, gen p mean: -0.1362193375825882, mean p set: 0.44756564497947693
loss_pred:0.015146184712648392, decouple_loss:0.0003981060581281781
The modified gen p mean: 0.4475383460521698, gen p mean: -0.13505616784095764, mean p set: 0.44811415672302246
loss_pred:0.01628384366631508, decouple_loss:0.00038316138670779765
Iteration: 4006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481397867202759, gen p mean: -0.12545514106750488, mean p set: 0.4487190544605255
loss_pred:0.015689870342612267, decouple_loss:0.00042258514440618455
The modified gen p mean: 0.44624844193458557, gen p mean: -0.13284766674041748, mean p set: 0.4468248784542084
The modified gen p mean: 0.4467623829841614, gen p mean: -0.13419240713119507, mean p set: 0.4473387897014618
loss_pred:0.01553182303905487, decouple_loss:0.00046124367509037256
loss_pred:0.01578683592379093, decouple_loss:0.0004549454024527222
Iteration: 4007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482567608356476, gen p mean: -0.12565775215625763, mean p set: 0.44883307814598083
loss_pred:0.016047731041908264, decouple_loss:0.000471951556392014
The modified gen p mean: 0.44608035683631897, gen p mean: -0.13469843566417694, mean p set: 0.4466526508331299
loss_pred:0.015505589544773102, decouple_loss:0.000446287274826318
The modified gen p mean: 0.44722452759742737, gen p mean: -0.13109348714351654, mean p set: 0.44780007004737854
loss_pred:0.01562155969440937, decouple_loss:0.000389140157494694
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 4008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44833284616470337, gen p mean: -0.13613863289356232, mean p set: 0.4489077031612396
The modified gen p mean: 0.44868355989456177, gen p mean: -0.13763052225112915, mean p set: 0.44926151633262634
loss_pred:0.014368985779583454, decouple_loss:0.0003585718513932079
loss_pred:0.014672509394586086, decouple_loss:0.00034881176543422043
The modified gen p mean: 0.4475196301937103, gen p mean: -0.1344243437051773, mean p set: 0.448095440864563
loss_pred:0.014563712291419506, decouple_loss:0.0003948046360164881
Iteration: 4009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480206072330475, gen p mean: -0.13758210837841034, mean p set: 0.44859638810157776
loss_pred:0.015632903203368187, decouple_loss:0.0003865090839099139
The modified gen p mean: 0.4476219117641449, gen p mean: -0.13240782916545868, mean p set: 0.44819650053977966
The modified gen p mean: 0.4476882815361023, gen p mean: -0.13123685121536255, mean p set: 0.44826412200927734
loss_pred:0.014338642358779907, decouple_loss:0.00041603847057558596
loss_pred:0.015123464167118073, decouple_loss:0.0003918138681910932
Iteration: 4010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490698277950287, gen p mean: -0.13272427022457123, mean p set: 0.4496433436870575
loss_pred:0.014818744733929634, decouple_loss:0.0005334764719009399
The modified gen p mean: 0.4471953809261322, gen p mean: -0.13788391649723053, mean p set: 0.44776955246925354
The modified gen p mean: 0.44770580530166626, gen p mean: -0.1337847113609314, mean p set: 0.44828298687934875
loss_pred:0.014959477819502354, decouple_loss:0.0005472624325193465
loss_pred:0.015266881324350834, decouple_loss:0.00035269628278911114
2023-05-02 19:09:58 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13413886725902557, mean p set: 0.4502691626548767
loss_pred:0.016833612695336342, decouple_loss:0.00034508114913478494
The modified gen p mean: 0.4495345950126648, gen p mean: -0.127580925822258, mean p set: 0.4500633478164673
loss_pred:0.016032833606004715, decouple_loss:0.0003590518026612699
The modified gen p mean: 0.4498317837715149, gen p mean: -0.12708121538162231, mean p set: 0.45035696029663086
loss_pred:0.01630990393459797, decouple_loss:0.00031792392837814987
WV_1_PC_1_EH_0_PS_40, loss: 0.016409151256084442, avg_mse: 0.025708384811878204
current test mse: 0.025708
Iteration: 4011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486677944660187, gen p mean: -0.13043919205665588, mean p set: 0.4492427408695221
loss_pred:0.014659461565315723, decouple_loss:0.00037198211066424847
The modified gen p mean: 0.4471854567527771, gen p mean: -0.1329185515642166, mean p set: 0.4477587640285492
loss_pred:0.014881745912134647, decouple_loss:0.0004112089518457651
The modified gen p mean: 0.44778937101364136, gen p mean: -0.1322939544916153, mean p set: 0.44836533069610596
loss_pred:0.015081078745424747, decouple_loss:0.00034060253528878093
Iteration: 4012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474504292011261, gen p mean: -0.13672706484794617, mean p set: 0.44802939891815186
loss_pred:0.015079477801918983, decouple_loss:0.0003469598013907671
The modified gen p mean: 0.44835424423217773, gen p mean: -0.13010434806346893, mean p set: 0.44892874360084534The modified gen p mean: 0.44813215732574463, gen p mean: -0.12662848830223083, mean p set: 0.4487065374851227
loss_pred:0.014590740203857422, decouple_loss:0.00037564209196716547
loss_pred:0.014424532651901245, decouple_loss:0.00043763330904766917
Iteration: 4013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802364706993103, gen p mean: -0.1321958750486374, mean p set: 0.44859760999679565
loss_pred:0.01559577789157629, decouple_loss:0.0004663100407924503
The modified gen p mean: 0.447531133890152, gen p mean: -0.13679896295070648, mean p set: 0.44810721278190613
loss_pred:0.014740828424692154, decouple_loss:0.00031852390384301543
The modified gen p mean: 0.44753918051719666, gen p mean: -0.1330481767654419, mean p set: 0.4481166899204254
loss_pred:0.015293225646018982, decouple_loss:0.0003532689588610083
Iteration: 4014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447620689868927, gen p mean: -0.1355062574148178, mean p set: 0.44819343090057373
loss_pred:0.014769071713089943, decouple_loss:0.0004903934895992279
The modified gen p mean: 0.44790542125701904, gen p mean: -0.13101336359977722, mean p set: 0.4484822154045105
loss_pred:0.014702556654810905, decouple_loss:0.0003107771335635334
The modified gen p mean: 0.44801583886146545, gen p mean: -0.13169531524181366, mean p set: 0.44859370589256287
loss_pred:0.014691541902720928, decouple_loss:0.0004169813182670623
Iteration: 4015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477556347846985, gen p mean: -0.13022638857364655, mean p set: 0.4483332633972168
loss_pred:0.014898602850735188, decouple_loss:0.00033141710446216166
The modified gen p mean: 0.4476996958255768, gen p mean: -0.1362360566854477, mean p set: 0.4482753276824951
loss_pred:0.015160187147557735, decouple_loss:0.0003126101801171899
The modified gen p mean: 0.44796544313430786, gen p mean: -0.13293896615505219, mean p set: 0.44854387640953064
loss_pred:0.014917740598320961, decouple_loss:0.0003772873315028846
Iteration: 4016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770580530166626, gen p mean: -0.13321292400360107, mean p set: 0.44828253984451294
loss_pred:0.014824997633695602, decouple_loss:0.00031558109913021326
The modified gen p mean: 0.4477660059928894, gen p mean: -0.13353773951530457, mean p set: 0.448341965675354
loss_pred:0.015058305114507675, decouple_loss:0.00044501552474685013
The modified gen p mean: 0.4479730725288391, gen p mean: -0.1279183030128479, mean p set: 0.4485490918159485
loss_pred:0.015430929139256477, decouple_loss:0.0003703980764839798
Iteration: 4017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476753771305084, gen p mean: -0.1273365616798401, mean p set: 0.4482516348361969
loss_pred:0.015009884722530842, decouple_loss:0.0006160014891065657
The modified gen p mean: 0.4474068582057953, gen p mean: -0.12975989282131195, mean p set: 0.4479837417602539
loss_pred:0.015021434985101223, decouple_loss:0.0003822016005869955
The modified gen p mean: 0.4473240077495575, gen p mean: -0.12834960222244263, mean p set: 0.4478999972343445
loss_pred:0.014752170071005821, decouple_loss:0.0005492776399478316
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448091596364975, gen p mean: -0.12563936412334442, mean p set: 0.4486706554889679
loss_pred:0.01421481091529131, decouple_loss:0.00042750590364448726
The modified gen p mean: 0.44785910844802856, gen p mean: -0.12678828835487366, mean p set: 0.44843557476997375
The modified gen p mean: 0.44870898127555847, gen p mean: -0.12337704747915268, mean p set: 0.44928398728370667
loss_pred:0.014679230749607086, decouple_loss:0.00043762719724327326
loss_pred:0.0149659039452672, decouple_loss:0.0004468736005946994
Iteration: 4019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474203884601593, gen p mean: -0.11996439099311829, mean p set: 0.4479960799217224
loss_pred:0.014837749302387238, decouple_loss:0.000314059347147122
The modified gen p mean: 0.44782325625419617, gen p mean: -0.11998935043811798, mean p set: 0.44839832186698914
The modified gen p mean: 0.44832104444503784, gen p mean: -0.11761026829481125, mean p set: 0.44889721274375916
loss_pred:0.014258412644267082, decouple_loss:0.0003510665846988559
loss_pred:0.014314436353743076, decouple_loss:0.0002831509045790881
Iteration: 4020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763725996017456, gen p mean: -0.12619386613368988, mean p set: 0.4482157230377197
loss_pred:0.014895717613399029, decouple_loss:0.00042652859701775014
The modified gen p mean: 0.44762474298477173, gen p mean: -0.12331952154636383, mean p set: 0.448201984167099
loss_pred:0.014317874796688557, decouple_loss:0.0003959720197599381
The modified gen p mean: 0.44796717166900635, gen p mean: -0.12216547131538391, mean p set: 0.44854554533958435
loss_pred:0.013971878215670586, decouple_loss:0.00036335576442070305
2023-05-02 19:12:04 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.126751109957695, mean p set: 0.4502691626548767
loss_pred:0.016854235902428627, decouple_loss:0.0004796700377482921
The modified gen p mean: 0.44953563809394836, gen p mean: -0.1205955222249031, mean p set: 0.4500633478164673The modified gen p mean: 0.44982945919036865, gen p mean: -0.12001022696495056, mean p set: 0.45035696029663086
loss_pred:0.016050927340984344, decouple_loss:0.00043507464579306543loss_pred:0.016392869874835014, decouple_loss:0.00041778181912377477
WV_1_PC_1_EH_0_PS_40, loss: 0.01645488850772381, avg_mse: 0.02575959637761116
current test mse: 0.02576
Iteration: 4021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478527903556824, gen p mean: -0.11861851811408997, mean p set: 0.44843021035194397
loss_pred:0.014284748584032059, decouple_loss:0.00045434903586283326
The modified gen p mean: 0.44703105092048645, gen p mean: -0.12532715499401093, mean p set: 0.4476061165332794
loss_pred:0.014733328483998775, decouple_loss:0.0003809383779298514
The modified gen p mean: 0.4480356276035309, gen p mean: -0.1264573633670807, mean p set: 0.4486139416694641
loss_pred:0.014563084580004215, decouple_loss:0.0004190156178083271
Iteration: 4022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473510980606079, gen p mean: -0.12507805228233337, mean p set: 0.44792643189430237
The modified gen p mean: 0.4485901892185211, gen p mean: -0.12544682621955872, mean p set: 0.4491655230522156loss_pred:0.01483498141169548, decouple_loss:0.00026547032757662237
loss_pred:0.014465154148638248, decouple_loss:0.0003997005696874112
The modified gen p mean: 0.44790273904800415, gen p mean: -0.1306527853012085, mean p set: 0.44847777485847473
loss_pred:0.01439893338829279, decouple_loss:0.00025805612676776946
Iteration: 4023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790220260620117, gen p mean: -0.13169746100902557, mean p set: 0.44847962260246277
loss_pred:0.015291818417608738, decouple_loss:0.0004402278864290565
The modified gen p mean: 0.44819512963294983, gen p mean: -0.12968093156814575, mean p set: 0.448775053024292The modified gen p mean: 0.44781070947647095, gen p mean: -0.12895314395427704, mean p set: 0.44838589429855347
loss_pred:0.015343480743467808, decouple_loss:0.00047284248284995556
loss_pred:0.015035548247396946, decouple_loss:0.0005362946540117264
Iteration: 4024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822925329208374, gen p mean: -0.1287212073802948, mean p set: 0.4488089084625244
The modified gen p mean: 0.447886198759079, gen p mean: -0.1307389736175537, mean p set: 0.44846177101135254
loss_pred:0.014905797317624092, decouple_loss:0.0004768853832501918
loss_pred:0.014577615074813366, decouple_loss:0.0005122444126754999
The modified gen p mean: 0.448255330324173, gen p mean: -0.13121455907821655, mean p set: 0.4488312005996704
loss_pred:0.014034438878297806, decouple_loss:0.0005688219098374248
Iteration: 4025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471036195755005, gen p mean: -0.13644181191921234, mean p set: 0.4476796090602875
The modified gen p mean: 0.44740384817123413, gen p mean: -0.1310555338859558, mean p set: 0.44797900319099426
loss_pred:0.01486297883093357, decouple_loss:0.0004164895508438349
loss_pred:0.014730891212821007, decouple_loss:0.0003518806188367307
The modified gen p mean: 0.44773614406585693, gen p mean: -0.12859320640563965, mean p set: 0.4483139216899872
loss_pred:0.014287649653851986, decouple_loss:0.0003457748971413821
Iteration: 4026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780972599983215, gen p mean: -0.1349630355834961, mean p set: 0.44838467240333557
loss_pred:0.01424036268144846, decouple_loss:0.0004259284760337323
The modified gen p mean: 0.44778066873550415, gen p mean: -0.1329616904258728, mean p set: 0.4483576714992523
loss_pred:0.015104943886399269, decouple_loss:0.00038450531428679824
The modified gen p mean: 0.448464572429657, gen p mean: -0.12979629635810852, mean p set: 0.44904080033302307
loss_pred:0.014024397358298302, decouple_loss:0.00036310957511886954
Iteration: 4027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732317328453064, gen p mean: -0.12529906630516052, mean p set: 0.44789719581604004
loss_pred:0.014414716511964798, decouple_loss:0.0004456791211850941
The modified gen p mean: 0.448019415140152, gen p mean: -0.12924198806285858, mean p set: 0.4485950171947479
loss_pred:0.015120278112590313, decouple_loss:0.0005229230155237019
The modified gen p mean: 0.4474213719367981, gen p mean: -0.12702248990535736, mean p set: 0.44799885153770447
loss_pred:0.014051305130124092, decouple_loss:0.0005014738999307156
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
NaN value num: 0
Iteration: 4028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45076340436935425, gen p mean: -0.11857642978429794, mean p set: 0.45133963227272034The modified gen p mean: 0.4520571529865265, gen p mean: -0.11863671243190765, mean p set: 0.4526323080062866
loss_pred:0.015101853758096695, decouple_loss:0.00047776696737855673
loss_pred:0.014774653129279613, decouple_loss:0.0004180967225693166
The modified gen p mean: 0.4520939290523529, gen p mean: -0.1131926029920578, mean p set: 0.45267021656036377
loss_pred:0.01503999624401331, decouple_loss:0.0003964141942560673
Iteration: 4029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45372867584228516, gen p mean: -0.11780588328838348, mean p set: 0.4543078541755676
loss_pred:0.014863915741443634, decouple_loss:0.00042353663593530655
The modified gen p mean: 0.451225221157074, gen p mean: -0.12245386838912964, mean p set: 0.4518008232116699
loss_pred:0.01463464554399252, decouple_loss:0.00031820088042877614
The modified gen p mean: 0.45301344990730286, gen p mean: -0.11943618953227997, mean p set: 0.45359036326408386
loss_pred:0.015520086511969566, decouple_loss:0.00032289838418364525
Iteration: 4030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019832253456116, gen p mean: -0.12698909640312195, mean p set: 0.45077502727508545
loss_pred:0.015159592032432556, decouple_loss:0.0004030657873954624
The modified gen p mean: 0.45243459939956665, gen p mean: -0.1265391856431961, mean p set: 0.4530124366283417
loss_pred:0.014813604764640331, decouple_loss:0.0003801453276537359
The modified gen p mean: 0.45479315519332886, gen p mean: -0.12441329658031464, mean p set: 0.45536860823631287
loss_pred:0.014392423443496227, decouple_loss:0.00042868999298661947
2023-05-02 19:14:51 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1375369429588318, mean p set: 0.4502691626548767
loss_pred:0.016824690625071526, decouple_loss:0.0004504494136199355
The modified gen p mean: 0.4495347738265991, gen p mean: -0.13089525699615479, mean p set: 0.4500633478164673
loss_pred:0.015964815393090248, decouple_loss:0.00041301417513750494
The modified gen p mean: 0.44982975721359253, gen p mean: -0.13018383085727692, mean p set: 0.45035696029663086
loss_pred:0.016346639022231102, decouple_loss:0.000407112151151523
WV_1_PC_1_EH_0_PS_40, loss: 0.016399892047047615, avg_mse: 0.02572028338909149
current test mse: 0.02572
Iteration: 4031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512248933315277, gen p mean: -0.12498301267623901, mean p set: 0.45180368423461914
loss_pred:0.01498469989746809, decouple_loss:0.0005321406060829759
The modified gen p mean: 0.4500024914741516, gen p mean: -0.1317274421453476, mean p set: 0.4505777657032013The modified gen p mean: 0.4508192837238312, gen p mean: -0.12969860434532166, mean p set: 0.451394259929657
loss_pred:0.014838291332125664, decouple_loss:0.0003727686998900026
loss_pred:0.014827122911810875, decouple_loss:0.00037927553057670593
Iteration: 4032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501558244228363, gen p mean: -0.13069835305213928, mean p set: 0.45073044300079346
loss_pred:0.015160984359681606, decouple_loss:0.0003463938774075359
The modified gen p mean: 0.4526095986366272, gen p mean: -0.13100582361221313, mean p set: 0.4531856179237366The modified gen p mean: 0.45293310284614563, gen p mean: -0.12923285365104675, mean p set: 0.45351067185401917
loss_pred:0.0146333584561944, decouple_loss:0.00043810252100229263
loss_pred:0.014783663675189018, decouple_loss:0.0004848606185987592
Iteration: 4033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495958983898163, gen p mean: -0.13357995450496674, mean p set: 0.45016953349113464
loss_pred:0.015030216425657272, decouple_loss:0.0004877688188571483
The modified gen p mean: 0.45222920179367065, gen p mean: -0.12909498810768127, mean p set: 0.4528070092201233
loss_pred:0.014900317415595055, decouple_loss:0.00047780381282791495
The modified gen p mean: 0.45158320665359497, gen p mean: -0.12704209983348846, mean p set: 0.45215752720832825
loss_pred:0.014712967909872532, decouple_loss:0.00047723756870254874
Iteration: 4034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452484667301178, gen p mean: -0.1298370510339737, mean p set: 0.45306456089019775
loss_pred:0.014595109969377518, decouple_loss:0.0004605274589266628
The modified gen p mean: 0.4519702196121216, gen p mean: -0.12474514544010162, mean p set: 0.45254912972450256
loss_pred:0.014730365015566349, decouple_loss:0.00038479853537864983
The modified gen p mean: 0.4494796395301819, gen p mean: -0.13212935626506805, mean p set: 0.45005518198013306
loss_pred:0.014622724615037441, decouple_loss:0.00043286202708259225
Iteration: 4035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507787525653839, gen p mean: -0.1330443024635315, mean p set: 0.4513516426086426
loss_pred:0.014746636152267456, decouple_loss:0.0003181556239724159
The modified gen p mean: 0.4521157741546631, gen p mean: -0.13464097678661346, mean p set: 0.45269668102264404
loss_pred:0.01457308977842331, decouple_loss:0.00045278164907358587
The modified gen p mean: 0.4506089389324188, gen p mean: -0.13550740480422974, mean p set: 0.4511864483356476
loss_pred:0.015258111990988255, decouple_loss:0.0003895858535543084
Iteration: 4036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45240241289138794, gen p mean: -0.1289624273777008, mean p set: 0.452976793050766
loss_pred:0.014646332710981369, decouple_loss:0.0005253564449958503
The modified gen p mean: 0.4523666203022003, gen p mean: -0.1265067756175995, mean p set: 0.45294633507728577
loss_pred:0.015038549900054932, decouple_loss:0.0005705091170966625
The modified gen p mean: 0.45088449120521545, gen p mean: -0.13297854363918304, mean p set: 0.4514629542827606
loss_pred:0.014695732854306698, decouple_loss:0.00035869693965651095
Iteration: 4037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529605209827423, gen p mean: -0.13779905438423157, mean p set: 0.45353925228118896
loss_pred:0.014864740893244743, decouple_loss:0.0004801965260412544
The modified gen p mean: 0.45144978165626526, gen p mean: -0.14032042026519775, mean p set: 0.45203009247779846
loss_pred:0.01432788372039795, decouple_loss:0.00031728195608593524
The modified gen p mean: 0.45158565044403076, gen p mean: -0.13974148035049438, mean p set: 0.4521603584289551
loss_pred:0.014547862112522125, decouple_loss:0.00034906031214632094
Iteration: 4038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45270851254463196, gen p mean: -0.1406874805688858, mean p set: 0.45328548550605774
loss_pred:0.01448010466992855, decouple_loss:0.0003928926889784634
The modified gen p mean: 0.4524921774864197, gen p mean: -0.14256642758846283, mean p set: 0.453070729970932
The modified gen p mean: 0.4509963393211365, gen p mean: -0.13780468702316284, mean p set: 0.45157214999198914
loss_pred:0.014629499986767769, decouple_loss:0.0004711119399871677
loss_pred:0.0151438619941473, decouple_loss:0.0005395905463956296
Iteration: 4039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527372121810913, gen p mean: -0.13394847512245178, mean p set: 0.4533127248287201
loss_pred:0.01468910276889801, decouple_loss:0.0003481988387648016
The modified gen p mean: 0.4524995684623718, gen p mean: -0.13535813987255096, mean p set: 0.4530753493309021
loss_pred:0.014373863115906715, decouple_loss:0.00043803470907732844
The modified gen p mean: 0.45194023847579956, gen p mean: -0.13239355385303497, mean p set: 0.452517032623291
loss_pred:0.014842941425740719, decouple_loss:0.00043075295980088413
Iteration: 4040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528626799583435, gen p mean: -0.13056236505508423, mean p set: 0.4534425735473633
loss_pred:0.014776498079299927, decouple_loss:0.0004391777911223471
The modified gen p mean: 0.4515434801578522, gen p mean: -0.13504917919635773, mean p set: 0.45211559534072876
loss_pred:0.014684579335153103, decouple_loss:0.0003446280607022345
The modified gen p mean: 0.4523715376853943, gen p mean: -0.14012715220451355, mean p set: 0.4529498815536499
loss_pred:0.014762470498681068, decouple_loss:0.0003421230358071625
2023-05-02 19:16:58 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.14341022074222565, mean p set: 0.4502691626548767
loss_pred:0.016846181824803352, decouple_loss:0.00038618454709649086
The modified gen p mean: 0.44953709840774536, gen p mean: -0.1375894695520401, mean p set: 0.4500633478164673
loss_pred:0.016081707552075386, decouple_loss:0.0004289174685254693
The modified gen p mean: 0.4498286843299866, gen p mean: -0.13676312565803528, mean p set: 0.45035696029663086
loss_pred:0.016368482261896133, decouple_loss:0.00041170892654918134
WV_1_PC_1_EH_0_PS_40, loss: 0.016452571377158165, avg_mse: 0.025824718177318573
current test mse: 0.025825
Iteration: 4041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925758242607117, gen p mean: -0.13608287274837494, mean p set: 0.4498353600502014
loss_pred:0.014786184765398502, decouple_loss:0.0005280373152345419
The modified gen p mean: 0.4513159394264221, gen p mean: -0.13500374555587769, mean p set: 0.45189061760902405The modified gen p mean: 0.45556673407554626, gen p mean: -0.1329059600830078, mean p set: 0.45614469051361084
loss_pred:0.014747539535164833, decouple_loss:0.0006326964357867837loss_pred:0.014837327413260937, decouple_loss:0.00046548518002964556
Iteration: 4042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450277715921402, gen p mean: -0.135134756565094, mean p set: 0.45085322856903076
loss_pred:0.015297533944249153, decouple_loss:0.0003377757966518402
The modified gen p mean: 0.45067930221557617, gen p mean: -0.12922240793704987, mean p set: 0.45125651359558105The modified gen p mean: 0.4522877335548401, gen p mean: -0.13045664131641388, mean p set: 0.4528656601905823
loss_pred:0.014500726945698261, decouple_loss:0.00048620824236422777
loss_pred:0.014736995100975037, decouple_loss:0.0003565168590284884
Iteration: 4043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45239850878715515, gen p mean: -0.13188207149505615, mean p set: 0.4529772400856018
loss_pred:0.014523664489388466, decouple_loss:0.0003342013224028051
The modified gen p mean: 0.4512263834476471, gen p mean: -0.12718458473682404, mean p set: 0.4518042206764221The modified gen p mean: 0.45172688364982605, gen p mean: -0.13509024679660797, mean p set: 0.4523029327392578
loss_pred:0.014511026442050934, decouple_loss:0.0003419869753997773
loss_pred:0.01461055874824524, decouple_loss:0.0002746206591837108
Iteration: 4044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45276692509651184, gen p mean: -0.126469686627388, mean p set: 0.45334672927856445
loss_pred:0.014868957921862602, decouple_loss:0.0002828400756698102
The modified gen p mean: 0.4516918957233429, gen p mean: -0.12600553035736084, mean p set: 0.45227131247520447
loss_pred:0.01492803543806076, decouple_loss:0.00037843440077267587
The modified gen p mean: 0.4546370208263397, gen p mean: -0.12585338950157166, mean p set: 0.4552163779735565
loss_pred:0.014898864552378654, decouple_loss:0.0004334098193794489
Iteration: 4045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45119956135749817, gen p mean: -0.13371701538562775, mean p set: 0.451773464679718
loss_pred:0.014804007485508919, decouple_loss:0.0003126472292933613
The modified gen p mean: 0.4529096186161041, gen p mean: -0.1229957714676857, mean p set: 0.45348870754241943
loss_pred:0.01496302243322134, decouple_loss:0.0003967445227317512
The modified gen p mean: 0.4538098871707916, gen p mean: -0.12842074036598206, mean p set: 0.4543859660625458
loss_pred:0.014072127640247345, decouple_loss:0.00037675476050935686
Iteration: 4046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509105980396271, gen p mean: -0.13073675334453583, mean p set: 0.45148760080337524
loss_pred:0.014569134451448917, decouple_loss:0.00034229274024255574
The modified gen p mean: 0.45194077491760254, gen p mean: -0.125853031873703, mean p set: 0.45251479744911194
The modified gen p mean: 0.4526726305484772, gen p mean: -0.12298249453306198, mean p set: 0.4532485604286194
loss_pred:0.014542673714458942, decouple_loss:0.00030484230956062675
loss_pred:0.015010416507720947, decouple_loss:0.0003984992508776486
Iteration: 4047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45229464769363403, gen p mean: -0.12524153292179108, mean p set: 0.452870637178421
loss_pred:0.015524107031524181, decouple_loss:0.00030950058135204017
The modified gen p mean: 0.4533712565898895, gen p mean: -0.12314840406179428, mean p set: 0.4539449214935303
loss_pred:0.01484586764127016, decouple_loss:0.0004252060898579657
The modified gen p mean: 0.45133325457572937, gen p mean: -0.1253349632024765, mean p set: 0.45190730690956116
loss_pred:0.014877508394420147, decouple_loss:0.00032738535082899034
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 4048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476771652698517, gen p mean: -0.14370638132095337, mean p set: 0.4482541084289551
loss_pred:0.014980672858655453, decouple_loss:0.00031870833481661975
The modified gen p mean: 0.4467451572418213, gen p mean: -0.1373911052942276, mean p set: 0.4473235309123993
The modified gen p mean: 0.44622763991355896, gen p mean: -0.14155007898807526, mean p set: 0.4468037486076355
loss_pred:0.014659654349088669, decouple_loss:0.00034362298902124166
loss_pred:0.015151961706578732, decouple_loss:0.00032463407842442393
Iteration: 4049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799691438674927, gen p mean: -0.13881029188632965, mean p set: 0.4485742151737213
loss_pred:0.014639887027442455, decouple_loss:0.0003340464027132839
The modified gen p mean: 0.4474165737628937, gen p mean: -0.1367298811674118, mean p set: 0.44799429178237915
The modified gen p mean: 0.44721460342407227, gen p mean: -0.14592863619327545, mean p set: 0.4477926790714264
loss_pred:0.014177646487951279, decouple_loss:0.0003647735284175724
loss_pred:0.014940069057047367, decouple_loss:0.00032574502984061837
Iteration: 4050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785869121551514, gen p mean: -0.1427305042743683, mean p set: 0.44843369722366333
loss_pred:0.01455709245055914, decouple_loss:0.0003193326701875776
The modified gen p mean: 0.44772887229919434, gen p mean: -0.14678166806697845, mean p set: 0.44830334186553955
loss_pred:0.014454413205385208, decouple_loss:0.0003037281858269125
The modified gen p mean: 0.4465978145599365, gen p mean: -0.14202123880386353, mean p set: 0.4471730887889862
loss_pred:0.01484842598438263, decouple_loss:0.0002759105118457228
2023-05-02 19:19:58 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13968302309513092, mean p set: 0.4502691626548767
loss_pred:0.016876375302672386, decouple_loss:0.0004064650274813175
The modified gen p mean: 0.44953569769859314, gen p mean: -0.13340792059898376, mean p set: 0.4500633478164673
loss_pred:0.016092931851744652, decouple_loss:0.000445018318714574
The modified gen p mean: 0.4498291015625, gen p mean: -0.13269905745983124, mean p set: 0.45035696029663086
loss_pred:0.01634647138416767, decouple_loss:0.00038181140553206205
WV_1_PC_1_EH_0_PS_40, loss: 0.0164591483771801, avg_mse: 0.02582957036793232
current test mse: 0.02583
Iteration: 4051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763052463531494, gen p mean: -0.13107188045978546, mean p set: 0.44820424914360046
loss_pred:0.01493743248283863, decouple_loss:0.00030115371919237077
The modified gen p mean: 0.4461725950241089, gen p mean: -0.13543705642223358, mean p set: 0.4467467665672302
loss_pred:0.014520185999572277, decouple_loss:0.0002779509231913835
The modified gen p mean: 0.4474431574344635, gen p mean: -0.1344754844903946, mean p set: 0.4480171501636505
loss_pred:0.015094578266143799, decouple_loss:0.00035935186315327883
Iteration: 4052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475352168083191, gen p mean: -0.1354168802499771, mean p set: 0.44811320304870605
The modified gen p mean: 0.4472445249557495, gen p mean: -0.1303022801876068, mean p set: 0.44781988859176636
loss_pred:0.014766311272978783, decouple_loss:0.00031616483465768397
loss_pred:0.015299350023269653, decouple_loss:0.00032006658148020506
The modified gen p mean: 0.44806328415870667, gen p mean: -0.13133250176906586, mean p set: 0.4486377537250519
loss_pred:0.014590907841920853, decouple_loss:0.00031625686096958816
Iteration: 4053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718948006629944, gen p mean: -0.12228702753782272, mean p set: 0.4477651119232178
loss_pred:0.014830593019723892, decouple_loss:0.0003696082276292145
The modified gen p mean: 0.44824182987213135, gen p mean: -0.12765513360500336, mean p set: 0.4488171935081482
loss_pred:0.01426891889423132, decouple_loss:0.00031960493652150035
The modified gen p mean: 0.4475172460079193, gen p mean: -0.12225278466939926, mean p set: 0.4480930268764496
loss_pred:0.015016121789813042, decouple_loss:0.00032040459336712956
Iteration: 4054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44596970081329346, gen p mean: -0.1259123831987381, mean p set: 0.4465450048446655
loss_pred:0.014517306350171566, decouple_loss:0.00035317399306222796
The modified gen p mean: 0.4465808570384979, gen p mean: -0.12565478682518005, mean p set: 0.44715774059295654
loss_pred:0.014515353366732597, decouple_loss:0.00026269431691616774
The modified gen p mean: 0.44783157110214233, gen p mean: -0.12479081749916077, mean p set: 0.44840726256370544
loss_pred:0.014792446978390217, decouple_loss:0.0002976860268972814
Iteration: 4055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822391867637634, gen p mean: -0.1191757321357727, mean p set: 0.4487995207309723
loss_pred:0.014918691478669643, decouple_loss:0.00030155599233694375
The modified gen p mean: 0.44723930954933167, gen p mean: -0.12870760262012482, mean p set: 0.4478101134300232
loss_pred:0.014573158696293831, decouple_loss:0.00025454317801631987
The modified gen p mean: 0.44777143001556396, gen p mean: -0.12249913811683655, mean p set: 0.4483456313610077
loss_pred:0.014532671310007572, decouple_loss:0.00028248585294932127
Iteration: 4056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803282618522644, gen p mean: -0.1292213499546051, mean p set: 0.44860827922821045
loss_pred:0.014193257316946983, decouple_loss:0.00032610318157821894
The modified gen p mean: 0.44753000140190125, gen p mean: -0.13496777415275574, mean p set: 0.44810402393341064
The modified gen p mean: 0.4470711946487427, gen p mean: -0.1243743747472763, mean p set: 0.44764673709869385
loss_pred:0.014239855110645294, decouple_loss:0.00029794161673635244
loss_pred:0.014703185297548771, decouple_loss:0.00032284442568197846
Iteration: 4057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447964608669281, gen p mean: -0.13111430406570435, mean p set: 0.4485393166542053
loss_pred:0.013967841863632202, decouple_loss:0.00033980427542701364
The modified gen p mean: 0.44655659794807434, gen p mean: -0.12973029911518097, mean p set: 0.44713273644447327
loss_pred:0.014582985080778599, decouple_loss:0.00032460596412420273
The modified gen p mean: 0.4471786916255951, gen p mean: -0.1333186775445938, mean p set: 0.44775745272636414
loss_pred:0.014448165893554688, decouple_loss:0.0003387706819921732
Iteration: 4058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722408056259155, gen p mean: -0.13430330157279968, mean p set: 0.44780153036117554
loss_pred:0.015301955863833427, decouple_loss:0.000396032992284745
The modified gen p mean: 0.4457589089870453, gen p mean: -0.13360713422298431, mean p set: 0.446336567401886
The modified gen p mean: 0.4475659430027008, gen p mean: -0.133609801530838, mean p set: 0.4481382668018341
loss_pred:0.014608031138777733, decouple_loss:0.0003430101496633142
loss_pred:0.014353310689330101, decouple_loss:0.00035431020660325885
Iteration: 4059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465358257293701, gen p mean: -0.13402441143989563, mean p set: 0.4471103250980377
The modified gen p mean: 0.44709664583206177, gen p mean: -0.12779942154884338, mean p set: 0.4476746618747711loss_pred:0.015079831704497337, decouple_loss:0.00036795323831029236
loss_pred:0.014649479649960995, decouple_loss:0.000315244949888438
The modified gen p mean: 0.4477696716785431, gen p mean: -0.12793602049350739, mean p set: 0.44834527373313904
loss_pred:0.015004422515630722, decouple_loss:0.0002950463385786861
Iteration: 4060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759729504585266, gen p mean: -0.13147775828838348, mean p set: 0.44817250967025757
loss_pred:0.014486978761851788, decouple_loss:0.00033212098060175776
The modified gen p mean: 0.4472392797470093, gen p mean: -0.13448752462863922, mean p set: 0.44781628251075745
The modified gen p mean: 0.4466683268547058, gen p mean: -0.1342722624540329, mean p set: 0.447241872549057
loss_pred:0.014822668395936489, decouple_loss:0.00034609230351634324
loss_pred:0.014964502304792404, decouple_loss:0.0002867150178644806
2023-05-02 19:22:04 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13341771066188812, mean p set: 0.4502691626548767
loss_pred:0.016938041895627975, decouple_loss:0.00033075801911763847
The modified gen p mean: 0.4495357871055603, gen p mean: -0.12697508931159973, mean p set: 0.4500633478164673
loss_pred:0.016018496826291084, decouple_loss:0.0003709364973474294
The modified gen p mean: 0.4498293101787567, gen p mean: -0.12603917717933655, mean p set: 0.45035696029663086
loss_pred:0.016328180208802223, decouple_loss:0.00036003850982524455
WV_1_PC_1_EH_0_PS_40, loss: 0.016445936635136604, avg_mse: 0.025844454765319824
current test mse: 0.025844
Iteration: 4061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660139083862305, gen p mean: -0.1260242462158203, mean p set: 0.447177916765213
loss_pred:0.014300977811217308, decouple_loss:0.00029575463850051165
The modified gen p mean: 0.44609832763671875, gen p mean: -0.13360480964183807, mean p set: 0.44667288661003113
loss_pred:0.014244163408875465, decouple_loss:0.0003039341827388853
The modified gen p mean: 0.4477505385875702, gen p mean: -0.12887011468410492, mean p set: 0.44832614064216614
loss_pred:0.013637183234095573, decouple_loss:0.0003391115751583129
Iteration: 4062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479493498802185, gen p mean: -0.12653625011444092, mean p set: 0.44852498173713684
loss_pred:0.014803833328187466, decouple_loss:0.000266785646090284
The modified gen p mean: 0.4463316798210144, gen p mean: -0.12358734756708145, mean p set: 0.4469052851200104The modified gen p mean: 0.4477483332157135, gen p mean: -0.12468676269054413, mean p set: 0.44832247495651245
loss_pred:0.014169068075716496, decouple_loss:0.00034152655280195177loss_pred:0.01512057427316904, decouple_loss:0.0002997593837790191
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454800486564636, gen p mean: -0.12196034938097, mean p set: 0.4460587203502655
loss_pred:0.014137099497020245, decouple_loss:0.0003541901533026248
The modified gen p mean: 0.4473744332790375, gen p mean: -0.12373564392328262, mean p set: 0.4479508101940155
loss_pred:0.014643827453255653, decouple_loss:0.00029837986221536994
The modified gen p mean: 0.4473522901535034, gen p mean: -0.12359611690044403, mean p set: 0.44792816042900085
loss_pred:0.014127317816019058, decouple_loss:0.00033914015511982143
Iteration: 4064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481016993522644, gen p mean: -0.12552011013031006, mean p set: 0.4486773908138275
loss_pred:0.014260387979447842, decouple_loss:0.00038212453364394605
The modified gen p mean: 0.4459426999092102, gen p mean: -0.12376140803098679, mean p set: 0.44651728868484497
loss_pred:0.014396573416888714, decouple_loss:0.00035728196962736547
The modified gen p mean: 0.44799908995628357, gen p mean: -0.12785844504833221, mean p set: 0.44857946038246155
loss_pred:0.014136468060314655, decouple_loss:0.00030666819657199085
Iteration: 4065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481876492500305, gen p mean: -0.13240735232830048, mean p set: 0.44875964522361755
loss_pred:0.014491305686533451, decouple_loss:0.00026963819982483983
The modified gen p mean: 0.4472441077232361, gen p mean: -0.12905731797218323, mean p set: 0.447822630405426
loss_pred:0.014111459255218506, decouple_loss:0.0002690814435482025
The modified gen p mean: 0.4469181001186371, gen p mean: -0.12804122269153595, mean p set: 0.4474954903125763
loss_pred:0.01496086921542883, decouple_loss:0.00028692552587017417
Iteration: 4066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465900957584381, gen p mean: -0.12854662537574768, mean p set: 0.4471621811389923
loss_pred:0.01447279378771782, decouple_loss:0.0003061148163396865
The modified gen p mean: 0.4478971064090729, gen p mean: -0.1308351308107376, mean p set: 0.4484725892543793
loss_pred:0.013894004747271538, decouple_loss:0.0003011037188116461
The modified gen p mean: 0.44855326414108276, gen p mean: -0.12860679626464844, mean p set: 0.4491317868232727
loss_pred:0.014019708149135113, decouple_loss:0.0002644756168592721
Iteration: 4067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471592903137207, gen p mean: -0.13174879550933838, mean p set: 0.44773492217063904
loss_pred:0.01425581518560648, decouple_loss:0.00023345707450062037
The modified gen p mean: 0.44853460788726807, gen p mean: -0.13112863898277283, mean p set: 0.449113667011261
loss_pred:0.014491315931081772, decouple_loss:0.000365280982805416
The modified gen p mean: 0.44802120327949524, gen p mean: -0.1290951818227768, mean p set: 0.4485970735549927
loss_pred:0.01380950678139925, decouple_loss:0.0002862755209207535
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 4068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44842633605003357, gen p mean: -0.13272008299827576, mean p set: 0.4489997327327728The modified gen p mean: 0.44767895340919495, gen p mean: -0.12764044106006622, mean p set: 0.44825538992881775
loss_pred:0.014827200211584568, decouple_loss:0.00028824477340094745
loss_pred:0.014517107978463173, decouple_loss:0.0003235563635826111
The modified gen p mean: 0.44794556498527527, gen p mean: -0.12902912497520447, mean p set: 0.44852176308631897
loss_pred:0.01543876901268959, decouple_loss:0.0002882324915844947
Iteration: 4069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493611752986908, gen p mean: -0.12743902206420898, mean p set: 0.4499371349811554
loss_pred:0.014599593356251717, decouple_loss:0.0003375863889232278
The modified gen p mean: 0.44731590151786804, gen p mean: -0.1246759369969368, mean p set: 0.44789284467697144
loss_pred:0.014570005238056183, decouple_loss:0.00031196424970403314
The modified gen p mean: 0.4477255046367645, gen p mean: -0.12288378179073334, mean p set: 0.4483044445514679
loss_pred:0.015251743607223034, decouple_loss:0.000324453430948779
Iteration: 4070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45028674602508545, gen p mean: -0.12976223230361938, mean p set: 0.4508599638938904
loss_pred:0.014600041322410107, decouple_loss:0.0002787316043395549
The modified gen p mean: 0.4471147060394287, gen p mean: -0.12658977508544922, mean p set: 0.447688490152359
loss_pred:0.01472033467143774, decouple_loss:0.0002861674875020981
The modified gen p mean: 0.4483756721019745, gen p mean: -0.125067338347435, mean p set: 0.44895321130752563
loss_pred:0.014424236491322517, decouple_loss:0.0004217685491312295
2023-05-02 19:24:51 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12876459956169128, mean p set: 0.4502691626548767
loss_pred:0.016787905246019363, decouple_loss:0.0004436991293914616
The modified gen p mean: 0.4495343565940857, gen p mean: -0.12258438020944595, mean p set: 0.4500633478164673
loss_pred:0.01597290299832821, decouple_loss:0.0004110231529921293
The modified gen p mean: 0.44983041286468506, gen p mean: -0.12205571681261063, mean p set: 0.45035696029663086
loss_pred:0.016330543905496597, decouple_loss:0.00037256305222399533
WV_1_PC_1_EH_0_PS_40, loss: 0.016384240239858627, avg_mse: 0.025706298649311066
current test mse: 0.025706
Iteration: 4071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750723242759705, gen p mean: -0.1246790960431099, mean p set: 0.4480845034122467
loss_pred:0.015223444439470768, decouple_loss:0.0004157322400715202
The modified gen p mean: 0.44909608364105225, gen p mean: -0.12672147154808044, mean p set: 0.4496730864048004
loss_pred:0.015118836425244808, decouple_loss:0.00045869097812101245
The modified gen p mean: 0.44815194606781006, gen p mean: -0.12036116421222687, mean p set: 0.44872695207595825
loss_pred:0.014923164620995522, decouple_loss:0.0005347965634427965
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486449360847473, gen p mean: -0.12298722565174103, mean p set: 0.44922152161598206
The modified gen p mean: 0.44826024770736694, gen p mean: -0.12487778067588806, mean p set: 0.4488394856452942
loss_pred:0.015152446925640106, decouple_loss:0.00026150228222832084
loss_pred:0.014885048381984234, decouple_loss:0.00033291373983956873
The modified gen p mean: 0.44747036695480347, gen p mean: -0.12666581571102142, mean p set: 0.44804567098617554
loss_pred:0.014217843301594257, decouple_loss:0.00026676763081923127
Iteration: 4073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731763005256653, gen p mean: -0.1271457076072693, mean p set: 0.44789400696754456
The modified gen p mean: 0.44729864597320557, gen p mean: -0.12870606780052185, mean p set: 0.4478755593299866
loss_pred:0.015215959399938583, decouple_loss:0.00034334571682848036
loss_pred:0.014232014305889606, decouple_loss:0.0002471532206982374
The modified gen p mean: 0.4477505385875702, gen p mean: -0.12941649556159973, mean p set: 0.44832760095596313
loss_pred:0.014514472335577011, decouple_loss:0.00036143610486760736
Iteration: 4074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44961321353912354, gen p mean: -0.13037952780723572, mean p set: 0.4501863420009613
loss_pred:0.014870003797113895, decouple_loss:0.0004316049162298441
The modified gen p mean: 0.4471842348575592, gen p mean: -0.13021783530712128, mean p set: 0.4477599561214447
loss_pred:0.014454797841608524, decouple_loss:0.0002654246927704662
The modified gen p mean: 0.4479312002658844, gen p mean: -0.12615637481212616, mean p set: 0.4485079050064087
loss_pred:0.014109122566878796, decouple_loss:0.00030318365315906703
Iteration: 4075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724300503730774, gen p mean: -0.13157585263252258, mean p set: 0.4478192627429962
loss_pred:0.0137775968760252, decouple_loss:0.0002811291196849197
The modified gen p mean: 0.4471012353897095, gen p mean: -0.12605223059654236, mean p set: 0.4476771950721741
loss_pred:0.015982085838913918, decouple_loss:0.00047083062236197293
The modified gen p mean: 0.4481845200061798, gen p mean: -0.12689892947673798, mean p set: 0.4487592875957489
loss_pred:0.015725480392575264, decouple_loss:0.00034911526017822325
Iteration: 4076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476812481880188, gen p mean: -0.12587369978427887, mean p set: 0.4482552707195282
loss_pred:0.015106826089322567, decouple_loss:0.0003493604017421603
The modified gen p mean: 0.44762200117111206, gen p mean: -0.12655971944332123, mean p set: 0.44819530844688416
loss_pred:0.014980455860495567, decouple_loss:0.00037187262205407023
The modified gen p mean: 0.4483162760734558, gen p mean: -0.12517820298671722, mean p set: 0.448894202709198
loss_pred:0.015445374883711338, decouple_loss:0.000342865678248927
Iteration: 4077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470105469226837, gen p mean: -0.12905755639076233, mean p set: 0.44758591055870056
loss_pred:0.014141995459794998, decouple_loss:0.0004013543657492846
The modified gen p mean: 0.44758719205856323, gen p mean: -0.12933342158794403, mean p set: 0.44816285371780396
The modified gen p mean: 0.4483453333377838, gen p mean: -0.1257108896970749, mean p set: 0.44892382621765137
loss_pred:0.013824205845594406, decouple_loss:0.0003731682663783431
loss_pred:0.014477156102657318, decouple_loss:0.0003044198965653777
Iteration: 4078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494131803512573, gen p mean: -0.12478821724653244, mean p set: 0.4499906599521637
loss_pred:0.014626532793045044, decouple_loss:0.00023901977692730725
The modified gen p mean: 0.447452187538147, gen p mean: -0.12602713704109192, mean p set: 0.4480244815349579
loss_pred:0.014674472622573376, decouple_loss:0.00030807600705884397
The modified gen p mean: 0.4480322301387787, gen p mean: -0.12958092987537384, mean p set: 0.44860783219337463
loss_pred:0.014321715570986271, decouple_loss:0.0002635996206663549
Iteration: 4079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477640688419342, gen p mean: -0.1270054131746292, mean p set: 0.44833654165267944
loss_pred:0.014567764475941658, decouple_loss:0.00030705370591022074
The modified gen p mean: 0.44763562083244324, gen p mean: -0.12640570104122162, mean p set: 0.44820985198020935
loss_pred:0.015036730095744133, decouple_loss:0.00034337118268013
The modified gen p mean: 0.4479573965072632, gen p mean: -0.12306800484657288, mean p set: 0.4485322833061218
loss_pred:0.014360112138092518, decouple_loss:0.00028971899882890284
Iteration: 4080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815894961357117, gen p mean: -0.12258704751729965, mean p set: 0.4487335979938507
loss_pred:0.01467878744006157, decouple_loss:0.0003164306399412453
The modified gen p mean: 0.4484913647174835, gen p mean: -0.12482268363237381, mean p set: 0.4490683674812317
loss_pred:0.014226722531020641, decouple_loss:0.0002648032095748931
The modified gen p mean: 0.448067307472229, gen p mean: -0.12503856420516968, mean p set: 0.4486456513404846
loss_pred:0.014968231320381165, decouple_loss:0.0002949996560346335
2023-05-02 19:26:58 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12659156322479248, mean p set: 0.4502691626548767
loss_pred:0.016888724640011787, decouple_loss:0.0003227975685149431
The modified gen p mean: 0.44953492283821106, gen p mean: -0.12074659764766693, mean p set: 0.4500633478164673
loss_pred:0.015967726707458496, decouple_loss:0.00030958751449361444
The modified gen p mean: 0.44982898235321045, gen p mean: -0.11992298066616058, mean p set: 0.45035696029663086
loss_pred:0.016306981444358826, decouple_loss:0.00030556105775758624
WV_1_PC_1_EH_0_PS_40, loss: 0.0164034441113472, avg_mse: 0.02573859505355358
current test mse: 0.025739
Iteration: 4081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479985535144806, gen p mean: -0.12417729943990707, mean p set: 0.44857507944107056
loss_pred:0.014297409914433956, decouple_loss:0.0002496734377928078
The modified gen p mean: 0.4483141303062439, gen p mean: -0.1223444789648056, mean p set: 0.4488913416862488
loss_pred:0.015468422323465347, decouple_loss:0.0002747988037299365
The modified gen p mean: 0.44851353764533997, gen p mean: -0.12399812787771225, mean p set: 0.44908908009529114
loss_pred:0.014924372546374798, decouple_loss:0.0003208346024621278
Iteration: 4082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728174805641174, gen p mean: -0.12473779916763306, mean p set: 0.4478580951690674
The modified gen p mean: 0.44741570949554443, gen p mean: -0.12557047605514526, mean p set: 0.44798803329467773
loss_pred:0.014316298998892307, decouple_loss:0.0002827447606250644
loss_pred:0.014417166821658611, decouple_loss:0.0002958285913337022
The modified gen p mean: 0.4470541179180145, gen p mean: -0.12079601734876633, mean p set: 0.44762876629829407
loss_pred:0.01590409129858017, decouple_loss:0.0002860078529920429
Iteration: 4083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486100673675537, gen p mean: -0.12534943222999573, mean p set: 0.44918495416641235
loss_pred:0.014463323168456554, decouple_loss:0.00024591595865786076
The modified gen p mean: 0.4490916132926941, gen p mean: -0.12969829142093658, mean p set: 0.4496676027774811The modified gen p mean: 0.4483180344104767, gen p mean: -0.1250726580619812, mean p set: 0.4488926827907562
loss_pred:0.015205010771751404, decouple_loss:0.0002882791741285473
loss_pred:0.014925937168300152, decouple_loss:0.00029989046743139625
Iteration: 4084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819340109825134, gen p mean: -0.12156948447227478, mean p set: 0.44876912236213684
loss_pred:0.014955147169530392, decouple_loss:0.00037117578904144466
The modified gen p mean: 0.44753095507621765, gen p mean: -0.1289328932762146, mean p set: 0.4481090009212494
loss_pred:0.014631138183176517, decouple_loss:0.0003635604225564748
The modified gen p mean: 0.4474239945411682, gen p mean: -0.12586763501167297, mean p set: 0.44799840450286865
loss_pred:0.015196609310805798, decouple_loss:0.0002876943035516888
Iteration: 4085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823557138442993, gen p mean: -0.1279071867465973, mean p set: 0.44880983233451843
loss_pred:0.015515947714447975, decouple_loss:0.0003160574415232986
The modified gen p mean: 0.4498622715473175, gen p mean: -0.12861798703670502, mean p set: 0.45043665170669556
loss_pred:0.014929630793631077, decouple_loss:0.00030392897315323353
The modified gen p mean: 0.4478442668914795, gen p mean: -0.12763841450214386, mean p set: 0.4484177529811859
loss_pred:0.014800655655562878, decouple_loss:0.0003003407910000533
Iteration: 4086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481353461742401, gen p mean: -0.12250884622335434, mean p set: 0.44871145486831665
loss_pred:0.015575885772705078, decouple_loss:0.0002681264595594257
The modified gen p mean: 0.4485107362270355, gen p mean: -0.12388835847377777, mean p set: 0.4490887224674225
loss_pred:0.014172513037919998, decouple_loss:0.0003947299555875361
The modified gen p mean: 0.4480424225330353, gen p mean: -0.1286672055721283, mean p set: 0.44861847162246704
loss_pred:0.014158438891172409, decouple_loss:0.00028552464209496975
Iteration: 4087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728171825408936, gen p mean: -0.1198154091835022, mean p set: 0.44785773754119873
loss_pred:0.014609175734221935, decouple_loss:0.00030308336135931313
The modified gen p mean: 0.44812092185020447, gen p mean: -0.12210500985383987, mean p set: 0.44869568943977356
loss_pred:0.014677220955491066, decouple_loss:0.0003074337146244943
The modified gen p mean: 0.4485672116279602, gen p mean: -0.1210232749581337, mean p set: 0.4491422176361084
loss_pred:0.014770983718335629, decouple_loss:0.00035739311715587974
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 4088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44924014806747437, gen p mean: -0.12128956615924835, mean p set: 0.44981372356414795
The modified gen p mean: 0.44762909412384033, gen p mean: -0.1143777146935463, mean p set: 0.4482038617134094
loss_pred:0.014128997921943665, decouple_loss:0.00028882312471978366
loss_pred:0.014485959894955158, decouple_loss:0.0003055958659388125
The modified gen p mean: 0.44837963581085205, gen p mean: -0.12473545968532562, mean p set: 0.44895440340042114
loss_pred:0.01424343790858984, decouple_loss:0.0002853453916031867
Iteration: 4089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481016993522644, gen p mean: -0.12377297133207321, mean p set: 0.4486764669418335
loss_pred:0.01418248750269413, decouple_loss:0.0003586270322557539
The modified gen p mean: 0.44893723726272583, gen p mean: -0.12188110500574112, mean p set: 0.44951245188713074
loss_pred:0.014103307388722897, decouple_loss:0.0004994873306713998
The modified gen p mean: 0.44859856367111206, gen p mean: -0.1222279891371727, mean p set: 0.44917428493499756
loss_pred:0.014342070557177067, decouple_loss:0.00031903167837299407
Iteration: 4090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479200541973114, gen p mean: -0.12356451153755188, mean p set: 0.4484924077987671
loss_pred:0.014684360474348068, decouple_loss:0.00029343622736632824
The modified gen p mean: 0.44910764694213867, gen p mean: -0.12504377961158752, mean p set: 0.449685275554657
loss_pred:0.0147658446803689, decouple_loss:0.0003080037422478199
The modified gen p mean: 0.4479500949382782, gen p mean: -0.1253833770751953, mean p set: 0.4485251009464264
loss_pred:0.014964314177632332, decouple_loss:0.00031646789284422994
2023-05-02 19:30:01 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12637078762054443, mean p set: 0.4502691626548767
loss_pred:0.01685870811343193, decouple_loss:0.0003910065279342234
The modified gen p mean: 0.4495343565940857, gen p mean: -0.12081023305654526, mean p set: 0.4500633478164673
loss_pred:0.015926651656627655, decouple_loss:0.0003754835342988372
The modified gen p mean: 0.44982635974884033, gen p mean: -0.11976584792137146, mean p set: 0.45035696029663086
loss_pred:0.016262667253613472, decouple_loss:0.00038030496216379106
WV_1_PC_1_EH_0_PS_40, loss: 0.016368456184864044, avg_mse: 0.025663521140813828
current test mse: 0.025664
Iteration: 4091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853922724723816, gen p mean: -0.12594401836395264, mean p set: 0.4491156041622162
loss_pred:0.014705172739923, decouple_loss:0.0004247069009579718
The modified gen p mean: 0.448849618434906, gen p mean: -0.11923292279243469, mean p set: 0.4494262933731079The modified gen p mean: 0.44946467876434326, gen p mean: -0.1273805797100067, mean p set: 0.45003825426101685
loss_pred:0.01506735011935234, decouple_loss:0.00028238428058102727
loss_pred:0.01445776503533125, decouple_loss:0.0003786174056585878
Iteration: 4092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479624927043915, gen p mean: -0.12365888804197311, mean p set: 0.44853806495666504
loss_pred:0.014086530543863773, decouple_loss:0.0003209991264156997
The modified gen p mean: 0.446562796831131, gen p mean: -0.12594999372959137, mean p set: 0.44714176654815674The modified gen p mean: 0.44830629229545593, gen p mean: -0.12468241155147552, mean p set: 0.4488835632801056
loss_pred:0.014697225764393806, decouple_loss:0.00038163125282153487loss_pred:0.013857785612344742, decouple_loss:0.0003115971339866519
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471610486507416, gen p mean: -0.12438427656888962, mean p set: 0.4477364122867584
loss_pred:0.014683033339679241, decouple_loss:0.00026409848942421377
The modified gen p mean: 0.4486237168312073, gen p mean: -0.12196074426174164, mean p set: 0.4492001235485077The modified gen p mean: 0.448610782623291, gen p mean: -0.12434780597686768, mean p set: 0.4491857588291168
loss_pred:0.014300254173576832, decouple_loss:0.0003321210388094187
loss_pred:0.01444184873253107, decouple_loss:0.0004045981040690094
Iteration: 4094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767314195632935, gen p mean: -0.12107356637716293, mean p set: 0.4482443630695343
loss_pred:0.014989777468144894, decouple_loss:0.00041730518569238484
The modified gen p mean: 0.44625774025917053, gen p mean: -0.12544938921928406, mean p set: 0.44683340191841125
loss_pred:0.01464102417230606, decouple_loss:0.0003251144371461123
The modified gen p mean: 0.44709861278533936, gen p mean: -0.12329959124326706, mean p set: 0.4476754069328308
loss_pred:0.014572130516171455, decouple_loss:0.0003790220071095973
Iteration: 4095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488893449306488, gen p mean: -0.1243261843919754, mean p set: 0.4494645595550537
loss_pred:0.014436598867177963, decouple_loss:0.0003267809224780649
The modified gen p mean: 0.44823509454727173, gen p mean: -0.12109514325857162, mean p set: 0.4488137364387512
loss_pred:0.01484127901494503, decouple_loss:0.0004616923979483545
The modified gen p mean: 0.44829627871513367, gen p mean: -0.12718328833580017, mean p set: 0.44887199997901917
loss_pred:0.014535161666572094, decouple_loss:0.00038920610677450895
Iteration: 4096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765377044677734, gen p mean: -0.12446166574954987, mean p set: 0.4482291042804718
loss_pred:0.014569844119250774, decouple_loss:0.0002905921428464353
The modified gen p mean: 0.4481153190135956, gen p mean: -0.12545245885849, mean p set: 0.4486922323703766
loss_pred:0.014887901954352856, decouple_loss:0.0003330526815261692
The modified gen p mean: 0.4486750662326813, gen p mean: -0.12621501088142395, mean p set: 0.44925105571746826
loss_pred:0.01455872505903244, decouple_loss:0.00034130990388803184
Iteration: 4097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486727714538574, gen p mean: -0.1264081448316574, mean p set: 0.44924765825271606
loss_pred:0.014143267646431923, decouple_loss:0.0003692526661325246
The modified gen p mean: 0.4485274851322174, gen p mean: -0.1253279447555542, mean p set: 0.44910410046577454
loss_pred:0.014746875502169132, decouple_loss:0.00044108537258580327
The modified gen p mean: 0.4486800730228424, gen p mean: -0.12553203105926514, mean p set: 0.4492553174495697
loss_pred:0.014452141709625721, decouple_loss:0.0004454924783203751
Iteration: 4098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480423629283905, gen p mean: -0.1250130981206894, mean p set: 0.44861912727355957
loss_pred:0.014614693820476532, decouple_loss:0.00037602477823384106
The modified gen p mean: 0.4486881196498871, gen p mean: -0.12659108638763428, mean p set: 0.44926580786705017
loss_pred:0.014102202840149403, decouple_loss:0.0004083058447577059
The modified gen p mean: 0.4484134316444397, gen p mean: -0.12950977683067322, mean p set: 0.44898921251296997
loss_pred:0.014074527658522129, decouple_loss:0.000395859096897766
Iteration: 4099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864848256111145, gen p mean: -0.12726792693138123, mean p set: 0.4492258131504059
loss_pred:0.014245560392737389, decouple_loss:0.0003986964584328234
The modified gen p mean: 0.4485328197479248, gen p mean: -0.12865674495697021, mean p set: 0.44910916686058044
loss_pred:0.014599846675992012, decouple_loss:0.0003912029496859759
The modified gen p mean: 0.44729459285736084, gen p mean: -0.11919628828763962, mean p set: 0.447873055934906
loss_pred:0.014338109642267227, decouple_loss:0.0004941503866575658
Iteration: 4100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485941231250763, gen p mean: -0.12662601470947266, mean p set: 0.44916975498199463
loss_pred:0.014833294786512852, decouple_loss:0.0003170647833030671
The modified gen p mean: 0.44785359501838684, gen p mean: -0.12767311930656433, mean p set: 0.4484313726425171
loss_pred:0.014767684042453766, decouple_loss:0.0003620629431679845
The modified gen p mean: 0.4494538903236389, gen p mean: -0.12794162333011627, mean p set: 0.450029194355011
loss_pred:0.014813074842095375, decouple_loss:0.00044137888471595943
2023-05-02 19:32:08 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.1289663016796112, mean p set: 0.4502691626548767
loss_pred:0.016829879954457283, decouple_loss:0.00041294199763797224
The modified gen p mean: 0.4495340883731842, gen p mean: -0.12348844110965729, mean p set: 0.4500633478164673
loss_pred:0.016001226380467415, decouple_loss:0.0004481798387132585
The modified gen p mean: 0.44982901215553284, gen p mean: -0.12245765328407288, mean p set: 0.45035696029663086
loss_pred:0.016291676089167595, decouple_loss:0.00032800284679979086
WV_1_PC_1_EH_0_PS_40, loss: 0.016394080594182014, avg_mse: 0.025707149878144264
current test mse: 0.025707
Iteration: 4101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727933406829834, gen p mean: -0.12776407599449158, mean p set: 0.44785305857658386
loss_pred:0.014514190144836903, decouple_loss:0.00032586921588517725
The modified gen p mean: 0.4477871358394623, gen p mean: -0.1238955408334732, mean p set: 0.4483604431152344
loss_pred:0.014934015460312366, decouple_loss:0.00031455577118322253
The modified gen p mean: 0.44742193818092346, gen p mean: -0.12434503436088562, mean p set: 0.4479973018169403
loss_pred:0.014387546107172966, decouple_loss:0.00038346051587723196
Iteration: 4102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799312949180603, gen p mean: -0.12704487144947052, mean p set: 0.44856706261634827
loss_pred:0.014520442113280296, decouple_loss:0.00039117434062063694
The modified gen p mean: 0.4490506649017334, gen p mean: -0.12877467274665833, mean p set: 0.4496248662471771
loss_pred:0.01449796836823225, decouple_loss:0.0005424087285064161
The modified gen p mean: 0.4484647214412689, gen p mean: -0.12587344646453857, mean p set: 0.4490397274494171
loss_pred:0.014638115651905537, decouple_loss:0.00036596509744413197
Iteration: 4103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849443435668945, gen p mean: -0.12857694923877716, mean p set: 0.44906941056251526
loss_pred:0.014387311413884163, decouple_loss:0.00031645107083022594
The modified gen p mean: 0.44937369227409363, gen p mean: -0.12357281893491745, mean p set: 0.44995051622390747
loss_pred:0.01456812396645546, decouple_loss:0.00029095986974425614
The modified gen p mean: 0.4481371343135834, gen p mean: -0.1232471838593483, mean p set: 0.44871124625205994
loss_pred:0.014339420944452286, decouple_loss:0.0003090952814090997
Iteration: 4104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484790563583374, gen p mean: -0.1255432367324829, mean p set: 0.4490547776222229
loss_pred:0.014319225214421749, decouple_loss:0.0003695530176628381
The modified gen p mean: 0.4478992521762848, gen p mean: -0.12685534358024597, mean p set: 0.4484765827655792
loss_pred:0.014406459406018257, decouple_loss:0.0005105820018798113
The modified gen p mean: 0.44733569025993347, gen p mean: -0.12688808143138885, mean p set: 0.4479115903377533
loss_pred:0.014498746022582054, decouple_loss:0.0003169981937389821
Iteration: 4105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481108486652374, gen p mean: -0.1255643516778946, mean p set: 0.4486883282661438
loss_pred:0.014472395181655884, decouple_loss:0.00035652960650622845
The modified gen p mean: 0.4486318528652191, gen p mean: -0.12443812191486359, mean p set: 0.4492073655128479
The modified gen p mean: 0.4477590322494507, gen p mean: -0.12394516170024872, mean p set: 0.4483354985713959
loss_pred:0.013934909366071224, decouple_loss:0.0003330610052216798
loss_pred:0.014595870859920979, decouple_loss:0.0004424910293892026
Iteration: 4106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873046875, gen p mean: -0.1289130449295044, mean p set: 0.44930675625801086
loss_pred:0.01427180040627718, decouple_loss:0.00034249183954671025
The modified gen p mean: 0.44798266887664795, gen p mean: -0.12477650493383408, mean p set: 0.44855865836143494
The modified gen p mean: 0.44749024510383606, gen p mean: -0.11986822634935379, mean p set: 0.4480650722980499
loss_pred:0.01451021060347557, decouple_loss:0.000290554016828537
loss_pred:0.014187082648277283, decouple_loss:0.00036691618151962757
Iteration: 4107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447463721036911, gen p mean: -0.12296940386295319, mean p set: 0.44804278016090393
loss_pred:0.014903214760124683, decouple_loss:0.00043014055700041354
The modified gen p mean: 0.44854119420051575, gen p mean: -0.12283895909786224, mean p set: 0.44911760091781616
The modified gen p mean: 0.448797345161438, gen p mean: -0.1244380995631218, mean p set: 0.44937053322792053
loss_pred:0.014501498080790043, decouple_loss:0.0002674089337233454
loss_pred:0.01465577818453312, decouple_loss:0.0002679825120139867
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
NaN value num: 0
Iteration: 4108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473494589328766, gen p mean: -0.11899828910827637, mean p set: 0.4479246735572815
loss_pred:0.01613900065422058, decouple_loss:0.0003261055680923164
The modified gen p mean: 0.4475094974040985, gen p mean: -0.1201016902923584, mean p set: 0.44808605313301086
The modified gen p mean: 0.448223352432251, gen p mean: -0.11326880753040314, mean p set: 0.448795348405838
loss_pred:0.016252737492322922, decouple_loss:0.0005429690354503691
loss_pred:0.01561697293072939, decouple_loss:0.00038391081034205854
Iteration: 4109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469147026538849, gen p mean: -0.120112843811512, mean p set: 0.4474906623363495
loss_pred:0.015108794905245304, decouple_loss:0.00035581906558945775
The modified gen p mean: 0.446769118309021, gen p mean: -0.11886000633239746, mean p set: 0.4473411440849304
The modified gen p mean: 0.4486396908760071, gen p mean: -0.12021032720804214, mean p set: 0.4492153227329254
loss_pred:0.01563858985900879, decouple_loss:0.00035135677899233997
loss_pred:0.016289642080664635, decouple_loss:0.0003650842700153589
Iteration: 4110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466116726398468, gen p mean: -0.11854598671197891, mean p set: 0.4471881687641144
loss_pred:0.016203030943870544, decouple_loss:0.0004310928052291274
The modified gen p mean: 0.4480462670326233, gen p mean: -0.11735640466213226, mean p set: 0.44862115383148193
loss_pred:0.01621612347662449, decouple_loss:0.00033487583277747035
The modified gen p mean: 0.4487854838371277, gen p mean: -0.11474967002868652, mean p set: 0.4493623375892639
loss_pred:0.015807613730430603, decouple_loss:0.00042203874909318984
2023-05-02 19:35:04 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12406395375728607, mean p set: 0.4502691626548767
loss_pred:0.016779044643044472, decouple_loss:0.00043632485903799534
The modified gen p mean: 0.4495323896408081, gen p mean: -0.11847561597824097, mean p set: 0.4500633478164673
loss_pred:0.01596382074058056, decouple_loss:0.00033471835195086896
The modified gen p mean: 0.44982871413230896, gen p mean: -0.11741432547569275, mean p set: 0.45035696029663086
loss_pred:0.016271548345685005, decouple_loss:0.00034363745362497866
WV_1_PC_1_EH_0_PS_40, loss: 0.01635671779513359, avg_mse: 0.025643285363912582
current test mse: 0.025643
Iteration: 4111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464520215988159, gen p mean: -0.12221329659223557, mean p set: 0.447025865316391
loss_pred:0.015601606108248234, decouple_loss:0.00033249345142394304
The modified gen p mean: 0.44713956117630005, gen p mean: -0.11898962408304214, mean p set: 0.44771403074264526The modified gen p mean: 0.4470743238925934, gen p mean: -0.11969811469316483, mean p set: 0.44764822721481323
loss_pred:0.016066230833530426, decouple_loss:0.0003330553008709103loss_pred:0.01612689718604088, decouple_loss:0.0004129746521357447
Iteration: 4112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469880163669586, gen p mean: -0.11897433549165726, mean p set: 0.44756677746772766
loss_pred:0.01597241684794426, decouple_loss:0.00034462896292097867
The modified gen p mean: 0.4479716420173645, gen p mean: -0.11574874818325043, mean p set: 0.44854697585105896The modified gen p mean: 0.4482892155647278, gen p mean: -0.11023411154747009, mean p set: 0.44886404275894165
loss_pred:0.015820369124412537, decouple_loss:0.0004858045431319624loss_pred:0.01596228778362274, decouple_loss:0.00042777389171533287
Iteration: 4113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711101055145264, gen p mean: -0.12308654934167862, mean p set: 0.4476872384548187
loss_pred:0.016035575419664383, decouple_loss:0.00036896622623316944
The modified gen p mean: 0.4473589062690735, gen p mean: -0.12030285596847534, mean p set: 0.4479345977306366
loss_pred:0.01607039012014866, decouple_loss:0.00033754564356058836
The modified gen p mean: 0.44733482599258423, gen p mean: -0.12396842241287231, mean p set: 0.4479101598262787
loss_pred:0.01642955280840397, decouple_loss:0.0003523386549204588
Iteration: 4114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466593861579895, gen p mean: -0.12734737992286682, mean p set: 0.4472349286079407
loss_pred:0.016080452129244804, decouple_loss:0.00033559344592504203
The modified gen p mean: 0.44737905263900757, gen p mean: -0.12258757650852203, mean p set: 0.4479564428329468
loss_pred:0.016155168414115906, decouple_loss:0.0003185111272614449
The modified gen p mean: 0.446403831243515, gen p mean: -0.12868492305278778, mean p set: 0.44697946310043335
loss_pred:0.016159718856215477, decouple_loss:0.0002971220819745213
Iteration: 4115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770801067352295, gen p mean: -0.1208566278219223, mean p set: 0.4482869803905487
loss_pred:0.01590798981487751, decouple_loss:0.0002632125106174499
The modified gen p mean: 0.4476182460784912, gen p mean: -0.12622983753681183, mean p set: 0.44819167256355286
loss_pred:0.016001824289560318, decouple_loss:0.00036011828342452645
The modified gen p mean: 0.4463990032672882, gen p mean: -0.12640242278575897, mean p set: 0.4469749927520752
loss_pred:0.016029706224799156, decouple_loss:0.0003544341598171741
Iteration: 4116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473634660243988, gen p mean: -0.1312040388584137, mean p set: 0.4479401111602783
loss_pred:0.016144737601280212, decouple_loss:0.00036953273229300976
The modified gen p mean: 0.4460422694683075, gen p mean: -0.13052082061767578, mean p set: 0.44661614298820496
The modified gen p mean: 0.4460684359073639, gen p mean: -0.1316044181585312, mean p set: 0.4466463625431061
loss_pred:0.016867054626345634, decouple_loss:0.00033731074654497206
loss_pred:0.016616662964224815, decouple_loss:0.0003619877970777452
Iteration: 4117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698867201805115, gen p mean: -0.1329808384180069, mean p set: 0.4475629925727844
loss_pred:0.015894116833806038, decouple_loss:0.0002984133316203952
The modified gen p mean: 0.4472178816795349, gen p mean: -0.13255247473716736, mean p set: 0.44779476523399353
loss_pred:0.01503550261259079, decouple_loss:0.00034877093276008964
The modified gen p mean: 0.4474996328353882, gen p mean: -0.13646744191646576, mean p set: 0.4480704367160797
loss_pred:0.015920406207442284, decouple_loss:0.000394591101212427
Iteration: 4118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480569362640381, gen p mean: -0.1297590583562851, mean p set: 0.44863274693489075
loss_pred:0.015676621347665787, decouple_loss:0.0002717727911658585
The modified gen p mean: 0.4470842480659485, gen p mean: -0.1329287439584732, mean p set: 0.4476608335971832
The modified gen p mean: 0.4455457925796509, gen p mean: -0.13222278654575348, mean p set: 0.44612136483192444
loss_pred:0.014950157143175602, decouple_loss:0.0003342595009598881
loss_pred:0.016564717516303062, decouple_loss:0.00034246829454787076
Iteration: 4119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44703006744384766, gen p mean: -0.13567304611206055, mean p set: 0.44760507345199585
loss_pred:0.015010259114205837, decouple_loss:0.00028763615409843624
The modified gen p mean: 0.4483862817287445, gen p mean: -0.13424229621887207, mean p set: 0.448962926864624
The modified gen p mean: 0.4480017125606537, gen p mean: -0.13152308762073517, mean p set: 0.44857820868492126
loss_pred:0.016213303431868553, decouple_loss:0.00034934954601339996
loss_pred:0.01592767797410488, decouple_loss:0.0002697943418752402
Iteration: 4120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819504022598267, gen p mean: -0.12280173599720001, mean p set: 0.44877323508262634
loss_pred:0.01567484438419342, decouple_loss:0.0003138607426080853
The modified gen p mean: 0.4482422471046448, gen p mean: -0.13069218397140503, mean p set: 0.44881540536880493
The modified gen p mean: 0.44696563482284546, gen p mean: -0.13158974051475525, mean p set: 0.4475422501564026
loss_pred:0.0161286611109972, decouple_loss:0.0002841254754457623
loss_pred:0.01605556346476078, decouple_loss:0.00031145327375270426
2023-05-02 19:37:11 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13366107642650604, mean p set: 0.4502691626548767
loss_pred:0.016811862587928772, decouple_loss:0.0003696175990626216
The modified gen p mean: 0.4495367705821991, gen p mean: -0.12783123552799225, mean p set: 0.4500633478164673
loss_pred:0.016036465764045715, decouple_loss:0.0003962090995628387
The modified gen p mean: 0.44982704520225525, gen p mean: -0.12646910548210144, mean p set: 0.45035696029663086
loss_pred:0.01633797399699688, decouple_loss:0.000368095759768039
WV_1_PC_1_EH_0_PS_40, loss: 0.016414333134889603, avg_mse: 0.02570990100502968
current test mse: 0.02571
Iteration: 4121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482863247394562, gen p mean: -0.13147345185279846, mean p set: 0.4488610029220581
loss_pred:0.01645098440349102, decouple_loss:0.0003194797318428755
The modified gen p mean: 0.4457835257053375, gen p mean: -0.1277896612882614, mean p set: 0.44635701179504395
loss_pred:0.016168951988220215, decouple_loss:0.00040773965884000063
The modified gen p mean: 0.4468684494495392, gen p mean: -0.1296747922897339, mean p set: 0.44744452834129333
loss_pred:0.01564747840166092, decouple_loss:0.00031707799644209445
Iteration: 4122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473375678062439, gen p mean: -0.1273994743824005, mean p set: 0.44791483879089355
The modified gen p mean: 0.4466031491756439, gen p mean: -0.1304951310157776, mean p set: 0.44717782735824585
loss_pred:0.01630339026451111, decouple_loss:0.00027716136537492275
loss_pred:0.015578117221593857, decouple_loss:0.00037541252095252275
The modified gen p mean: 0.4475683867931366, gen p mean: -0.12643252313137054, mean p set: 0.4481455683708191
loss_pred:0.015856435522437096, decouple_loss:0.0003545866347849369
Iteration: 4123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447491854429245, gen p mean: -0.12726692855358124, mean p set: 0.4480665326118469
loss_pred:0.015334981493651867, decouple_loss:0.0003541660262271762
The modified gen p mean: 0.44642001390457153, gen p mean: -0.12669865787029266, mean p set: 0.4469953775405884
loss_pred:0.01646295376121998, decouple_loss:0.0002744282828643918
The modified gen p mean: 0.44698235392570496, gen p mean: -0.1313910037279129, mean p set: 0.4475582540035248
loss_pred:0.0166570246219635, decouple_loss:0.0002767156111076474
Iteration: 4124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482167959213257, gen p mean: -0.11977118253707886, mean p set: 0.44879260659217834
loss_pred:0.015894576907157898, decouple_loss:0.000319083861541003
The modified gen p mean: 0.44809257984161377, gen p mean: -0.1253831833600998, mean p set: 0.44866740703582764
loss_pred:0.015524972230196, decouple_loss:0.00026892541791312397
The modified gen p mean: 0.44919705390930176, gen p mean: -0.12593623995780945, mean p set: 0.44977301359176636
loss_pred:0.015609395690262318, decouple_loss:0.0002566202310845256
Iteration: 4125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465813636779785, gen p mean: -0.13257946074008942, mean p set: 0.4471576511859894
loss_pred:0.01576065644621849, decouple_loss:0.0003088010416831821
The modified gen p mean: 0.44727542996406555, gen p mean: -0.13413412868976593, mean p set: 0.4478538930416107
loss_pred:0.015755079686641693, decouple_loss:0.00028636373463086784
The modified gen p mean: 0.44745880365371704, gen p mean: -0.12916016578674316, mean p set: 0.4480341970920563
loss_pred:0.01660175994038582, decouple_loss:0.0003598668263293803
Iteration: 4126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688519835472107, gen p mean: -0.12869490683078766, mean p set: 0.4474611282348633
loss_pred:0.015283125452697277, decouple_loss:0.00036489320336841047
The modified gen p mean: 0.4460945427417755, gen p mean: -0.1305249184370041, mean p set: 0.4466691315174103
loss_pred:0.016079319640994072, decouple_loss:0.00031195420888252556
The modified gen p mean: 0.44547533988952637, gen p mean: -0.12977449595928192, mean p set: 0.4460543990135193
loss_pred:0.016256939619779587, decouple_loss:0.000296090409392491
Iteration: 4127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489927291870117, gen p mean: -0.12662909924983978, mean p set: 0.44956785440444946
loss_pred:0.015858110040426254, decouple_loss:0.00028797294362448156
The modified gen p mean: 0.44717833399772644, gen p mean: -0.13238370418548584, mean p set: 0.4477544128894806
loss_pred:0.016327636316418648, decouple_loss:0.0002842643007170409
The modified gen p mean: 0.44714465737342834, gen p mean: -0.13355109095573425, mean p set: 0.4477194845676422
loss_pred:0.015878381207585335, decouple_loss:0.0003455774567555636
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
NaN value num: 0
Iteration: 4128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496387541294098, gen p mean: -0.1281949132680893, mean p set: 0.45021387934684753
loss_pred:0.01498985942453146, decouple_loss:0.0002609030343592167
The modified gen p mean: 0.4493737816810608, gen p mean: -0.12927767634391785, mean p set: 0.449949711561203
The modified gen p mean: 0.4513791799545288, gen p mean: -0.12308686226606369, mean p set: 0.45195919275283813
loss_pred:0.014738130383193493, decouple_loss:0.0003319041570648551
loss_pred:0.014970572665333748, decouple_loss:0.0003652611339930445
Iteration: 4129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518858790397644, gen p mean: -0.12119977921247482, mean p set: 0.4524637460708618
loss_pred:0.015516530722379684, decouple_loss:0.0003499031881801784
The modified gen p mean: 0.44987791776657104, gen p mean: -0.12761130928993225, mean p set: 0.4504547715187073
loss_pred:0.016531284898519516, decouple_loss:0.00028820455190725625
The modified gen p mean: 0.4527818262577057, gen p mean: -0.12038717418909073, mean p set: 0.45335903763771057
loss_pred:0.014729986898601055, decouple_loss:0.00034332473296672106
Iteration: 4130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493544101715088, gen p mean: -0.12576590478420258, mean p set: 0.44993001222610474
loss_pred:0.014719353057444096, decouple_loss:0.0003121774934697896
The modified gen p mean: 0.44879093766212463, gen p mean: -0.12571369111537933, mean p set: 0.4493626356124878
loss_pred:0.015057368203997612, decouple_loss:0.0003152875287923962
The modified gen p mean: 0.4487150311470032, gen p mean: -0.1278993934392929, mean p set: 0.44929152727127075
loss_pred:0.015223909169435501, decouple_loss:0.00036075772368349135
2023-05-02 19:39:57 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13334861397743225, mean p set: 0.4502691626548767
loss_pred:0.016800038516521454, decouple_loss:0.0003493562981020659
The modified gen p mean: 0.44953516125679016, gen p mean: -0.1275177001953125, mean p set: 0.4500633478164673
loss_pred:0.016032570973038673, decouple_loss:0.00037867852370254695
The modified gen p mean: 0.44982585310935974, gen p mean: -0.1261751800775528, mean p set: 0.45035696029663086
loss_pred:0.016277723014354706, decouple_loss:0.00031266541918739676
WV_1_PC_1_EH_0_PS_40, loss: 0.01638745702803135, avg_mse: 0.02570912055671215
current test mse: 0.025709
Iteration: 4131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44981104135513306, gen p mean: -0.12296614050865173, mean p set: 0.4503864049911499
loss_pred:0.015841953456401825, decouple_loss:0.00032459571957588196
The modified gen p mean: 0.44974637031555176, gen p mean: -0.12408464401960373, mean p set: 0.4503243863582611The modified gen p mean: 0.4492361545562744, gen p mean: -0.12446834146976471, mean p set: 0.4498138427734375
loss_pred:0.014759759418666363, decouple_loss:0.00029731306130997837
loss_pred:0.014817357994616032, decouple_loss:0.00034694024361670017
Iteration: 4132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497597813606262, gen p mean: -0.12720242142677307, mean p set: 0.45034095644950867
loss_pred:0.015400230884552002, decouple_loss:0.0003733353514689952
The modified gen p mean: 0.44913819432258606, gen p mean: -0.1251734346151352, mean p set: 0.4497171640396118The modified gen p mean: 0.4513315260410309, gen p mean: -0.1219886764883995, mean p set: 0.45191019773483276
loss_pred:0.014644244685769081, decouple_loss:0.00038467292324639857loss_pred:0.015110699459910393, decouple_loss:0.000314468692522496
Iteration: 4133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519380033016205, gen p mean: -0.12512025237083435, mean p set: 0.452515572309494
loss_pred:0.015398516319692135, decouple_loss:0.0004043304070364684
The modified gen p mean: 0.451545774936676, gen p mean: -0.12222952395677567, mean p set: 0.4521242678165436
loss_pred:0.015402870252728462, decouple_loss:0.0002961962600238621
The modified gen p mean: 0.45224177837371826, gen p mean: -0.1242813691496849, mean p set: 0.45281848311424255
loss_pred:0.015220516361296177, decouple_loss:0.00032703124452382326
Iteration: 4134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45219650864601135, gen p mean: -0.12224899977445602, mean p set: 0.4527750313282013
loss_pred:0.014627082273364067, decouple_loss:0.00034859662991948426
The modified gen p mean: 0.45201748609542847, gen p mean: -0.12695179879665375, mean p set: 0.4525927007198334
loss_pred:0.01433167140930891, decouple_loss:0.000286733265966177
The modified gen p mean: 0.45130494236946106, gen p mean: -0.12171348929405212, mean p set: 0.45188307762145996
loss_pred:0.01545370277017355, decouple_loss:0.0003052930987905711
Iteration: 4135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45221075415611267, gen p mean: -0.12157648056745529, mean p set: 0.4527881443500519
loss_pred:0.015138841234147549, decouple_loss:0.00039504634332843125
The modified gen p mean: 0.4516656994819641, gen p mean: -0.12152683734893799, mean p set: 0.4522422254085541
The modified gen p mean: 0.45216670632362366, gen p mean: -0.11993414163589478, mean p set: 0.452744722366333
loss_pred:0.015085858292877674, decouple_loss:0.00034210458397865295
loss_pred:0.014522474259138107, decouple_loss:0.00038629237678833306
Iteration: 4136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45217281579971313, gen p mean: -0.11594165116548538, mean p set: 0.45275044441223145
loss_pred:0.015001737512648106, decouple_loss:0.00026003606035374105
The modified gen p mean: 0.4501611590385437, gen p mean: -0.12243501842021942, mean p set: 0.450737327337265
loss_pred:0.014856354333460331, decouple_loss:0.00025630288291722536
The modified gen p mean: 0.45033887028694153, gen p mean: -0.12039202451705933, mean p set: 0.4509148597717285
loss_pred:0.014224499464035034, decouple_loss:0.00029437619377858937
Iteration: 4137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939568638801575, gen p mean: -0.12410394102334976, mean p set: 0.44997072219848633
loss_pred:0.015191396698355675, decouple_loss:0.00029414010350592434
The modified gen p mean: 0.45230838656425476, gen p mean: -0.11939429491758347, mean p set: 0.45288676023483276
loss_pred:0.015434912405908108, decouple_loss:0.0003516944998409599
The modified gen p mean: 0.4493275582790375, gen p mean: -0.12186410278081894, mean p set: 0.4499017596244812
loss_pred:0.015950050204992294, decouple_loss:0.00029178778640925884
Iteration: 4138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45161741971969604, gen p mean: -0.12211094051599503, mean p set: 0.4521923363208771
loss_pred:0.015043114311993122, decouple_loss:0.0004405564977787435
The modified gen p mean: 0.44889727234840393, gen p mean: -0.1274450272321701, mean p set: 0.4494739770889282
loss_pred:0.015619688667356968, decouple_loss:0.00038413720903918147
The modified gen p mean: 0.45114001631736755, gen p mean: -0.11780849099159241, mean p set: 0.45171716809272766
loss_pred:0.0153285451233387, decouple_loss:0.00036346929846331477
Iteration: 4139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502049684524536, gen p mean: -0.12123093008995056, mean p set: 0.4507834315299988
loss_pred:0.014493612572550774, decouple_loss:0.0003191698342561722
The modified gen p mean: 0.4519484341144562, gen p mean: -0.12333086133003235, mean p set: 0.4525245130062103
The modified gen p mean: 0.4518560469150543, gen p mean: -0.1217024102807045, mean p set: 0.4524324834346771
loss_pred:0.01432422548532486, decouple_loss:0.0003095719439443201
loss_pred:0.01478535309433937, decouple_loss:0.0002974556409753859
Iteration: 4140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931352138519287, gen p mean: -0.12286274880170822, mean p set: 0.44989094138145447
loss_pred:0.014759908430278301, decouple_loss:0.0002503079595044255
The modified gen p mean: 0.4485725462436676, gen p mean: -0.12744837999343872, mean p set: 0.44915124773979187
loss_pred:0.01499243825674057, decouple_loss:0.00033578331931494176
The modified gen p mean: 0.4496699869632721, gen p mean: -0.12596085667610168, mean p set: 0.4502466022968292
loss_pred:0.015395342372357845, decouple_loss:0.0003186871181242168
2023-05-02 19:42:04 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1361217498779297, mean p set: 0.4502691626548767
loss_pred:0.016810327768325806, decouple_loss:0.0004289622593205422
The modified gen p mean: 0.4495331645011902, gen p mean: -0.12999393045902252, mean p set: 0.4500633478164673
loss_pred:0.016079183667898178, decouple_loss:0.00041832320857793093
The modified gen p mean: 0.4498279094696045, gen p mean: -0.12913453578948975, mean p set: 0.45035696029663086
loss_pred:0.0163468848913908, decouple_loss:0.0003480407758615911
WV_1_PC_1_EH_0_PS_40, loss: 0.016432054340839386, avg_mse: 0.025736618787050247
current test mse: 0.025737
Iteration: 4141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501211643218994, gen p mean: -0.12485647946596146, mean p set: 0.4506973326206207
loss_pred:0.01515891682356596, decouple_loss:0.00030191242694854736
The modified gen p mean: 0.4521239101886749, gen p mean: -0.12104891240596771, mean p set: 0.45270055532455444
loss_pred:0.015178457833826542, decouple_loss:0.00035130794276483357
The modified gen p mean: 0.44889745116233826, gen p mean: -0.12556269764900208, mean p set: 0.4494730830192566
loss_pred:0.015540849417448044, decouple_loss:0.00032476853812113404
Iteration: 4142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516005516052246, gen p mean: -0.12057355046272278, mean p set: 0.45218008756637573
loss_pred:0.015399402007460594, decouple_loss:0.00035286368802189827
The modified gen p mean: 0.45159095525741577, gen p mean: -0.1263999491930008, mean p set: 0.4521697759628296The modified gen p mean: 0.4497438967227936, gen p mean: -0.1260855495929718, mean p set: 0.4503213167190552
loss_pred:0.014959815889596939, decouple_loss:0.0003177248581778258loss_pred:0.014564966782927513, decouple_loss:0.0002714580041356385
Iteration: 4143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499206244945526, gen p mean: -0.12311039119958878, mean p set: 0.4504959285259247
loss_pred:0.015187790617346764, decouple_loss:0.0002923975989688188
The modified gen p mean: 0.45217037200927734, gen p mean: -0.1180473268032074, mean p set: 0.45274588465690613The modified gen p mean: 0.4513232707977295, gen p mean: -0.12657533586025238, mean p set: 0.4519013464450836
loss_pred:0.014517326839268208, decouple_loss:0.000302404718240723
loss_pred:0.014868426136672497, decouple_loss:0.0002964089799206704
Iteration: 4144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486561119556427, gen p mean: -0.12853960692882538, mean p set: 0.4492310881614685
loss_pred:0.015111161395907402, decouple_loss:0.0003087016521021724
The modified gen p mean: 0.4501817524433136, gen p mean: -0.12688001990318298, mean p set: 0.4507574439048767
loss_pred:0.015429643914103508, decouple_loss:0.00028662921977229416
The modified gen p mean: 0.45193418860435486, gen p mean: -0.11904997378587723, mean p set: 0.4525114893913269
loss_pred:0.015434948727488518, decouple_loss:0.00029823361546732485
Iteration: 4145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077088475227356, gen p mean: -0.12321720272302628, mean p set: 0.4513484537601471
loss_pred:0.014470698311924934, decouple_loss:0.0003504203341435641
The modified gen p mean: 0.45003727078437805, gen p mean: -0.12219704687595367, mean p set: 0.4506123960018158
loss_pred:0.01498485542833805, decouple_loss:0.0003291927860118449
The modified gen p mean: 0.4497889578342438, gen p mean: -0.11831177026033401, mean p set: 0.45036324858665466
loss_pred:0.014551828615367413, decouple_loss:0.0003906694473698735
Iteration: 4146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518207013607025, gen p mean: -0.11519864201545715, mean p set: 0.4524017870426178
loss_pred:0.014806332997977734, decouple_loss:0.0003196864854544401
The modified gen p mean: 0.44900986552238464, gen p mean: -0.12123916298151016, mean p set: 0.4495861530303955
loss_pred:0.015182333067059517, decouple_loss:0.00030817437800578773
The modified gen p mean: 0.4516148865222931, gen p mean: -0.12367821484804153, mean p set: 0.45219019055366516
loss_pred:0.014814678579568863, decouple_loss:0.0002846037095878273
Iteration: 4147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501665532588959, gen p mean: -0.12399288266897202, mean p set: 0.45074281096458435
loss_pred:0.015067153610289097, decouple_loss:0.00028797370032407343
The modified gen p mean: 0.4498387277126312, gen p mean: -0.12251278012990952, mean p set: 0.4504155218601227
loss_pred:0.01618157885968685, decouple_loss:0.00030949365464039147
The modified gen p mean: 0.45177385210990906, gen p mean: -0.1198153868317604, mean p set: 0.4523504674434662
loss_pred:0.015512450598180294, decouple_loss:0.00031225456041283906
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
NaN value num: 0
Iteration: 4148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497981667518616, gen p mean: -0.12207818031311035, mean p set: 0.4503738284111023
loss_pred:0.01529786828905344, decouple_loss:0.00031365820905193686
The modified gen p mean: 0.44895365834236145, gen p mean: -0.1269456446170807, mean p set: 0.4495299160480499
loss_pred:0.01615757867693901, decouple_loss:0.00029298680601641536
The modified gen p mean: 0.4502827227115631, gen p mean: -0.12639954686164856, mean p set: 0.45085832476615906
loss_pred:0.01544436439871788, decouple_loss:0.00027251840219832957
Iteration: 4149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496043920516968, gen p mean: -0.12512198090553284, mean p set: 0.4501812756061554
loss_pred:0.01639263518154621, decouple_loss:0.0003122184716630727
The modified gen p mean: 0.44839584827423096, gen p mean: -0.1263783723115921, mean p set: 0.44897153973579407
loss_pred:0.016199445351958275, decouple_loss:0.00045504432637244463
The modified gen p mean: 0.4486059248447418, gen p mean: -0.1253305971622467, mean p set: 0.4491855800151825
loss_pred:0.015926724299788475, decouple_loss:0.0003137778548989445
Iteration: 4150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496206045150757, gen p mean: -0.12273301929235458, mean p set: 0.4501986801624298
loss_pred:0.015652284026145935, decouple_loss:0.000254492973908782
The modified gen p mean: 0.44947466254234314, gen p mean: -0.12575149536132812, mean p set: 0.4500521421432495
loss_pred:0.015350139699876308, decouple_loss:0.0002895799116231501
The modified gen p mean: 0.4480714499950409, gen p mean: -0.12898825109004974, mean p set: 0.44864723086357117
loss_pred:0.016422750428318977, decouple_loss:0.0003189017588738352
2023-05-02 19:44:50 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13185864686965942, mean p set: 0.4502691626548767
loss_pred:0.01683514192700386, decouple_loss:0.0002815373882185668
The modified gen p mean: 0.4495367109775543, gen p mean: -0.12584726512432098, mean p set: 0.4500633478164673
loss_pred:0.016077475622296333, decouple_loss:0.0003382884606253356
The modified gen p mean: 0.44982922077178955, gen p mean: -0.12466715276241302, mean p set: 0.45035696029663086
loss_pred:0.016385409981012344, decouple_loss:0.0002896010410040617
WV_1_PC_1_EH_0_PS_40, loss: 0.01644783467054367, avg_mse: 0.025792594999074936
current test mse: 0.025793
Iteration: 4151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487166404724121, gen p mean: -0.1264030784368515, mean p set: 0.44929149746894836
loss_pred:0.016395892947912216, decouple_loss:0.00028555578319355845
The modified gen p mean: 0.44815948605537415, gen p mean: -0.12351839989423752, mean p set: 0.4487350583076477
loss_pred:0.01576591655611992, decouple_loss:0.0002728755061980337
The modified gen p mean: 0.4488412141799927, gen p mean: -0.12351255863904953, mean p set: 0.4494204819202423
loss_pred:0.016585372388362885, decouple_loss:0.00024570035748183727
Iteration: 4152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44936394691467285, gen p mean: -0.12262250483036041, mean p set: 0.4499370753765106
The modified gen p mean: 0.44975343346595764, gen p mean: -0.12367090582847595, mean p set: 0.45033130049705505
loss_pred:0.016024159267544746, decouple_loss:0.00028531416319310665
loss_pred:0.015675431117415428, decouple_loss:0.0003655565087683499
The modified gen p mean: 0.44835764169692993, gen p mean: -0.12495914846658707, mean p set: 0.4489312171936035
loss_pred:0.01618061028420925, decouple_loss:0.00033415979123674333
Iteration: 4153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487816095352173, gen p mean: -0.12898923456668854, mean p set: 0.4493584930896759
loss_pred:0.016528813168406487, decouple_loss:0.00023053573386278003
The modified gen p mean: 0.4497843384742737, gen p mean: -0.13157038390636444, mean p set: 0.45035961270332336The modified gen p mean: 0.4486008286476135, gen p mean: -0.12262849509716034, mean p set: 0.449175626039505
loss_pred:0.016115523874759674, decouple_loss:0.00033139990409836173
loss_pred:0.015586656518280506, decouple_loss:0.00032000188366509974
Iteration: 4154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844698905944824, gen p mean: -0.12391405552625656, mean p set: 0.44902318716049194
loss_pred:0.015759607776999474, decouple_loss:0.0003248081193305552
The modified gen p mean: 0.44890305399894714, gen p mean: -0.12668117880821228, mean p set: 0.4494764804840088
loss_pred:0.016032544896006584, decouple_loss:0.00026840242207981646
The modified gen p mean: 0.4481753706932068, gen p mean: -0.12574322521686554, mean p set: 0.44875091314315796
loss_pred:0.015530229546129704, decouple_loss:0.0002539185807108879
Iteration: 4155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44920358061790466, gen p mean: -0.12357298284769058, mean p set: 0.4497784972190857
loss_pred:0.017057262361049652, decouple_loss:0.00026996826636604965
The modified gen p mean: 0.4501873850822449, gen p mean: -0.12534283101558685, mean p set: 0.4507625102996826
loss_pred:0.015907898545265198, decouple_loss:0.000301902909995988
The modified gen p mean: 0.4500732719898224, gen p mean: -0.12230568379163742, mean p set: 0.4506526291370392
loss_pred:0.016176896169781685, decouple_loss:0.0003024175821337849
Iteration: 4156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44980689883232117, gen p mean: -0.12425660341978073, mean p set: 0.450385719537735
loss_pred:0.01551683247089386, decouple_loss:0.0003589647531043738
The modified gen p mean: 0.4495365619659424, gen p mean: -0.1270570605993271, mean p set: 0.450113981962204
loss_pred:0.01629464328289032, decouple_loss:0.0003422148583922535
The modified gen p mean: 0.44912970066070557, gen p mean: -0.12730443477630615, mean p set: 0.4497062563896179
loss_pred:0.015630492940545082, decouple_loss:0.00028475868748500943
Iteration: 4157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496215283870697, gen p mean: -0.12374470382928848, mean p set: 0.45019885897636414
loss_pred:0.015921151265501976, decouple_loss:0.0004636832163669169
The modified gen p mean: 0.44804829359054565, gen p mean: -0.12819208204746246, mean p set: 0.4486234188079834
loss_pred:0.01606997288763523, decouple_loss:0.000440029805758968
The modified gen p mean: 0.44781357049942017, gen p mean: -0.1282515823841095, mean p set: 0.4483890235424042
loss_pred:0.016058310866355896, decouple_loss:0.0003572871792130172
Iteration: 4158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495580792427063, gen p mean: -0.126430481672287, mean p set: 0.4501313269138336
loss_pred:0.015265666879713535, decouple_loss:0.0002956269891001284
The modified gen p mean: 0.4491181969642639, gen p mean: -0.13352113962173462, mean p set: 0.44969442486763
loss_pred:0.01633269153535366, decouple_loss:0.00038001296343281865
The modified gen p mean: 0.4486823081970215, gen p mean: -0.1277930587530136, mean p set: 0.44925686717033386
loss_pred:0.01595177873969078, decouple_loss:0.0002854666381608695
Iteration: 4159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495237469673157, gen p mean: -0.12460561096668243, mean p set: 0.45009905099868774
The modified gen p mean: 0.4490983784198761, gen p mean: -0.12144187837839127, mean p set: 0.44967401027679443
loss_pred:0.015536307357251644, decouple_loss:0.00040437511052004993
loss_pred:0.015276292338967323, decouple_loss:0.0003210701106581837
The modified gen p mean: 0.44897353649139404, gen p mean: -0.13070718944072723, mean p set: 0.4495510160923004
loss_pred:0.016706373542547226, decouple_loss:0.0003450153744779527
Iteration: 4160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44911423325538635, gen p mean: -0.12841692566871643, mean p set: 0.4496876895427704
loss_pred:0.01598478853702545, decouple_loss:0.0003461022861301899
The modified gen p mean: 0.4493832290172577, gen p mean: -0.12560784816741943, mean p set: 0.4499610364437103
loss_pred:0.016215814277529716, decouple_loss:0.000311782379867509
The modified gen p mean: 0.4488596022129059, gen p mean: -0.12265456467866898, mean p set: 0.44943687319755554
loss_pred:0.01595144160091877, decouple_loss:0.00029446539701893926
2023-05-02 19:46:56 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13222846388816833, mean p set: 0.4502691626548767
loss_pred:0.01684090495109558, decouple_loss:0.0003504144260659814
The modified gen p mean: 0.4495316445827484, gen p mean: -0.12624074518680573, mean p set: 0.4500633478164673
loss_pred:0.016116926446557045, decouple_loss:0.0004206231387797743
The modified gen p mean: 0.4498275816440582, gen p mean: -0.12521159648895264, mean p set: 0.45035696029663086
loss_pred:0.016291534528136253, decouple_loss:0.00034595385659486055
WV_1_PC_1_EH_0_PS_40, loss: 0.01643507182598114, avg_mse: 0.02572644129395485
current test mse: 0.025726
Iteration: 4161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493815004825592, gen p mean: -0.12242460995912552, mean p set: 0.44995957612991333
loss_pred:0.015414441004395485, decouple_loss:0.00038617104291915894
The modified gen p mean: 0.44965460896492004, gen p mean: -0.12535212934017181, mean p set: 0.4502294957637787
loss_pred:0.016267336905002594, decouple_loss:0.00034550720010884106
The modified gen p mean: 0.4495984613895416, gen p mean: -0.12493487447500229, mean p set: 0.45017439126968384
loss_pred:0.016359249129891396, decouple_loss:0.000465258868644014
Iteration: 4162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44908738136291504, gen p mean: -0.1293947547674179, mean p set: 0.44966015219688416
loss_pred:0.015821274369955063, decouple_loss:0.00038987991865724325
The modified gen p mean: 0.4495653808116913, gen p mean: -0.12846429646015167, mean p set: 0.4501429796218872The modified gen p mean: 0.44884708523750305, gen p mean: -0.13113652169704437, mean p set: 0.4494244158267975
loss_pred:0.015530861914157867, decouple_loss:0.00031418626895174384
loss_pred:0.015104435384273529, decouple_loss:0.000290245603537187
Iteration: 4163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44949665665626526, gen p mean: -0.12995997071266174, mean p set: 0.4500735104084015
loss_pred:0.015764467418193817, decouple_loss:0.00030683286604471505
The modified gen p mean: 0.44964340329170227, gen p mean: -0.1320401132106781, mean p set: 0.4502195417881012The modified gen p mean: 0.45003482699394226, gen p mean: -0.12567593157291412, mean p set: 0.45061272382736206
loss_pred:0.015716025605797768, decouple_loss:0.0003170942945871502
loss_pred:0.016100985929369926, decouple_loss:0.0003097192384302616
Iteration: 4164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486767053604126, gen p mean: -0.12464863806962967, mean p set: 0.44925227761268616
loss_pred:0.015574805438518524, decouple_loss:0.0002880581305362284
The modified gen p mean: 0.4485452175140381, gen p mean: -0.12775585055351257, mean p set: 0.4491247832775116
loss_pred:0.016172712668776512, decouple_loss:0.0003481554740574211
The modified gen p mean: 0.44809770584106445, gen p mean: -0.12548589706420898, mean p set: 0.44867777824401855
loss_pred:0.01597253419458866, decouple_loss:0.0002997835399582982
Iteration: 4165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44857513904571533, gen p mean: -0.1320650577545166, mean p set: 0.4491483271121979
loss_pred:0.015961293131113052, decouple_loss:0.0003432544181123376
The modified gen p mean: 0.44989830255508423, gen p mean: -0.12156734615564346, mean p set: 0.4504740536212921
loss_pred:0.015124192461371422, decouple_loss:0.00034048091038130224
The modified gen p mean: 0.44863197207450867, gen p mean: -0.12780652940273285, mean p set: 0.44920605421066284
loss_pred:0.016169192269444466, decouple_loss:0.00030142205650918186
Iteration: 4166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44926169514656067, gen p mean: -0.1283862143754959, mean p set: 0.44983765482902527
The modified gen p mean: 0.4486793875694275, gen p mean: -0.12796196341514587, mean p set: 0.44925400614738464
loss_pred:0.015122082084417343, decouple_loss:0.0002891050826292485
loss_pred:0.015650546178221703, decouple_loss:0.00033378298394382
The modified gen p mean: 0.44986164569854736, gen p mean: -0.12442068755626678, mean p set: 0.45043838024139404
loss_pred:0.015209407545626163, decouple_loss:0.00034606154076755047
Iteration: 4167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44843074679374695, gen p mean: -0.12232986837625504, mean p set: 0.4490078091621399
loss_pred:0.016141533851623535, decouple_loss:0.0004093307361472398
The modified gen p mean: 0.4493688642978668, gen p mean: -0.12714017927646637, mean p set: 0.4499465525150299
loss_pred:0.015113343484699726, decouple_loss:0.0003645512042567134
The modified gen p mean: 0.4496316909790039, gen p mean: -0.1293075978755951, mean p set: 0.45020923018455505
loss_pred:0.015624391846358776, decouple_loss:0.0003071477694902569
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 4168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474160671234131, gen p mean: -0.12823113799095154, mean p set: 0.4479900598526001
loss_pred:0.015562225133180618, decouple_loss:0.00035205489257350564
The modified gen p mean: 0.44686073064804077, gen p mean: -0.13616950809955597, mean p set: 0.44743674993515015
The modified gen p mean: 0.44580671191215515, gen p mean: -0.1291532963514328, mean p set: 0.44638508558273315
loss_pred:0.014915581792593002, decouple_loss:0.00045707161189056933
loss_pred:0.014798497781157494, decouple_loss:0.00039796161581762135
Iteration: 4169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466526508331299, gen p mean: -0.13880498707294464, mean p set: 0.44722431898117065
loss_pred:0.01482596155256033, decouple_loss:0.00028530220151878893
The modified gen p mean: 0.44701656699180603, gen p mean: -0.12953829765319824, mean p set: 0.4475901126861572
The modified gen p mean: 0.44775357842445374, gen p mean: -0.1332211196422577, mean p set: 0.4483300447463989
loss_pred:0.015242471359670162, decouple_loss:0.0003072392428293824
loss_pred:0.015171889215707779, decouple_loss:0.0003252074238844216
Iteration: 4170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44589343667030334, gen p mean: -0.13335804641246796, mean p set: 0.4464685022830963
loss_pred:0.015577329322695732, decouple_loss:0.0004019776824861765
The modified gen p mean: 0.44716182351112366, gen p mean: -0.13165467977523804, mean p set: 0.44773682951927185
The modified gen p mean: 0.44639086723327637, gen p mean: -0.13105876743793488, mean p set: 0.44696730375289917
loss_pred:0.014508144930005074, decouple_loss:0.0003126198425889015
loss_pred:0.014655510894954205, decouple_loss:0.0003452231176197529
2023-05-02 19:49:43 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13345010578632355, mean p set: 0.4502691626548767
loss_pred:0.016741348430514336, decouple_loss:0.00036992275272496045
The modified gen p mean: 0.44953453540802, gen p mean: -0.12735538184642792, mean p set: 0.4500633478164673
loss_pred:0.015992185100913048, decouple_loss:0.000393992115277797
The modified gen p mean: 0.44983047246932983, gen p mean: -0.12641143798828125, mean p set: 0.45035696029663086
loss_pred:0.016172155737876892, decouple_loss:0.0004246972966939211
WV_1_PC_1_EH_0_PS_40, loss: 0.016321707516908646, avg_mse: 0.025538044050335884
current test mse: 0.025538
At step 4170, Best test: 0.025538
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 4171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44549310207366943, gen p mean: -0.1274198293685913, mean p set: 0.4460710883140564
loss_pred:0.014611990191042423, decouple_loss:0.00048780388897284865
The modified gen p mean: 0.4464323818683624, gen p mean: -0.12936383485794067, mean p set: 0.44700896739959717
loss_pred:0.014796770177781582, decouple_loss:0.00036919955164194107
The modified gen p mean: 0.4456457495689392, gen p mean: -0.13033507764339447, mean p set: 0.44622352719306946
loss_pred:0.0152655728161335, decouple_loss:0.0004890633863396943
Iteration: 4172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446879118680954, gen p mean: -0.12471102923154831, mean p set: 0.44745591282844543
loss_pred:0.015000393614172935, decouple_loss:0.00041377011802978814
The modified gen p mean: 0.44621214270591736, gen p mean: -0.12857350707054138, mean p set: 0.44678789377212524The modified gen p mean: 0.4471452534198761, gen p mean: -0.13386745750904083, mean p set: 0.4477214217185974
loss_pred:0.014405002817511559, decouple_loss:0.0004396673757582903loss_pred:0.014874915592372417, decouple_loss:0.000351215829141438
Iteration: 4173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468970000743866, gen p mean: -0.1308320015668869, mean p set: 0.4474724233150482
loss_pred:0.015127373859286308, decouple_loss:0.00039799557998776436
The modified gen p mean: 0.4476214051246643, gen p mean: -0.12420253455638885, mean p set: 0.44819650053977966
loss_pred:0.014498768374323845, decouple_loss:0.00032269436633214355
The modified gen p mean: 0.4457171857357025, gen p mean: -0.12554706633090973, mean p set: 0.4462953209877014
loss_pred:0.014283561147749424, decouple_loss:0.00032841801294125617
Iteration: 4174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468815326690674, gen p mean: -0.12767651677131653, mean p set: 0.44745466113090515
loss_pred:0.014578576199710369, decouple_loss:0.0004114504554308951
The modified gen p mean: 0.4472678005695343, gen p mean: -0.12794150412082672, mean p set: 0.4478432536125183
loss_pred:0.015183588489890099, decouple_loss:0.00037931904080323875
The modified gen p mean: 0.44763943552970886, gen p mean: -0.11812885105609894, mean p set: 0.44821488857269287
loss_pred:0.014933119527995586, decouple_loss:0.00029644754249602556
Iteration: 4175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44650912284851074, gen p mean: -0.11746034026145935, mean p set: 0.4470832645893097
loss_pred:0.01478899922221899, decouple_loss:0.0003923123294953257
The modified gen p mean: 0.4464450478553772, gen p mean: -0.11880676448345184, mean p set: 0.4470199644565582
loss_pred:0.014723590575158596, decouple_loss:0.00035521102836355567
The modified gen p mean: 0.44687509536743164, gen p mean: -0.11614544689655304, mean p set: 0.44745174050331116
loss_pred:0.014964604750275612, decouple_loss:0.0003422493173275143
Iteration: 4176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785770773887634, gen p mean: -0.11913979053497314, mean p set: 0.4484312832355499
loss_pred:0.015031162649393082, decouple_loss:0.00039968726923689246
The modified gen p mean: 0.4474378824234009, gen p mean: -0.12075018137693405, mean p set: 0.4480128884315491
The modified gen p mean: 0.4469479024410248, gen p mean: -0.11985673755407333, mean p set: 0.44752398133277893
loss_pred:0.01586698740720749, decouple_loss:0.0004273362283129245
loss_pred:0.014468793757259846, decouple_loss:0.0004128594882786274
Iteration: 4177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465586841106415, gen p mean: -0.12441650778055191, mean p set: 0.4471304714679718
loss_pred:0.015111580491065979, decouple_loss:0.000437483744462952
The modified gen p mean: 0.44652384519577026, gen p mean: -0.1197933703660965, mean p set: 0.44709739089012146
loss_pred:0.015594013035297394, decouple_loss:0.0004273628583177924
The modified gen p mean: 0.44747400283813477, gen p mean: -0.1259206384420395, mean p set: 0.4480500817298889
loss_pred:0.014152470976114273, decouple_loss:0.00035798587487079203
Iteration: 4178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461509883403778, gen p mean: -0.12373414635658264, mean p set: 0.44672611355781555
The modified gen p mean: 0.44642534852027893, gen p mean: -0.12177258729934692, mean p set: 0.4469989240169525loss_pred:0.015502268448472023, decouple_loss:0.0002916109806392342
loss_pred:0.014832055196166039, decouple_loss:0.0002981922880280763
The modified gen p mean: 0.4464883804321289, gen p mean: -0.12646456062793732, mean p set: 0.44706523418426514
loss_pred:0.014733748510479927, decouple_loss:0.0003344729484524578
Iteration: 4179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44657114148139954, gen p mean: -0.127737358212471, mean p set: 0.44714680314064026
The modified gen p mean: 0.4473089873790741, gen p mean: -0.12357180565595627, mean p set: 0.447883665561676
loss_pred:0.014852851629257202, decouple_loss:0.00036501383874565363
loss_pred:0.015501124784350395, decouple_loss:0.0003998013853561133
The modified gen p mean: 0.44659423828125, gen p mean: -0.12384409457445145, mean p set: 0.44716861844062805
loss_pred:0.014712090604007244, decouple_loss:0.0003687779535539448
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466276168823242, gen p mean: -0.12103421241044998, mean p set: 0.4472024440765381
loss_pred:0.014914029277861118, decouple_loss:0.0005689846584573388
The modified gen p mean: 0.4469619691371918, gen p mean: -0.1254463791847229, mean p set: 0.4475388824939728
The modified gen p mean: 0.44556546211242676, gen p mean: -0.126668781042099, mean p set: 0.4461430609226227
loss_pred:0.013733472675085068, decouple_loss:0.0006028340430930257
loss_pred:0.015611143782734871, decouple_loss:0.0006749025778844953
2023-05-02 19:51:52 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1301884800195694, mean p set: 0.4502691626548767
loss_pred:0.016827354207634926, decouple_loss:0.000441231532022357
The modified gen p mean: 0.4495369791984558, gen p mean: -0.1243734136223793, mean p set: 0.4500633478164673
loss_pred:0.016008464619517326, decouple_loss:0.0005006591673009098
The modified gen p mean: 0.44982704520225525, gen p mean: -0.1234680712223053, mean p set: 0.45035696029663086
loss_pred:0.016255700960755348, decouple_loss:0.0004624251741915941
WV_1_PC_1_EH_0_PS_40, loss: 0.016387246549129486, avg_mse: 0.025633836165070534
current test mse: 0.025634
Iteration: 4181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462910592556, gen p mean: -0.12388133257627487, mean p set: 0.4468649923801422
The modified gen p mean: 0.4461701810359955, gen p mean: -0.12713873386383057, mean p set: 0.44674646854400635
loss_pred:0.014950455166399479, decouple_loss:0.0004384123894851655
loss_pred:0.014304754324257374, decouple_loss:0.00043350530904717743
The modified gen p mean: 0.44736191630363464, gen p mean: -0.12519346177577972, mean p set: 0.4479365348815918
loss_pred:0.015413523651659489, decouple_loss:0.00034096953459084034
Iteration: 4182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464120864868164, gen p mean: -0.12615010142326355, mean p set: 0.4469858705997467
loss_pred:0.015102171339094639, decouple_loss:0.00046486870269291103
The modified gen p mean: 0.44598281383514404, gen p mean: -0.12519223988056183, mean p set: 0.4465586841106415The modified gen p mean: 0.4469188451766968, gen p mean: -0.12657684087753296, mean p set: 0.44749605655670166
loss_pred:0.015150278806686401, decouple_loss:0.0003767366870306432loss_pred:0.015221763402223587, decouple_loss:0.00029863431700505316
Iteration: 4183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447104275226593, gen p mean: -0.12369687855243683, mean p set: 0.44768035411834717
loss_pred:0.015038852579891682, decouple_loss:0.0005622438620775938
The modified gen p mean: 0.4466767907142639, gen p mean: -0.13088315725326538, mean p set: 0.44725584983825684The modified gen p mean: 0.4473760724067688, gen p mean: -0.12726977467536926, mean p set: 0.4479503035545349
loss_pred:0.014493581838905811, decouple_loss:0.000519465422257781
loss_pred:0.013995588757097721, decouple_loss:0.0004165999125689268
Iteration: 4184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460252523422241, gen p mean: -0.12417681515216827, mean p set: 0.44659891724586487
loss_pred:0.015014391392469406, decouple_loss:0.0003102172340732068
The modified gen p mean: 0.44752082228660583, gen p mean: -0.12039249390363693, mean p set: 0.4480966627597809
loss_pred:0.014932344667613506, decouple_loss:0.0005463060224428773
The modified gen p mean: 0.44625476002693176, gen p mean: -0.12525027990341187, mean p set: 0.4468272626399994
loss_pred:0.015306442975997925, decouple_loss:0.00039332429878413677
Iteration: 4185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471246302127838, gen p mean: -0.1281275600194931, mean p set: 0.4476989209651947
loss_pred:0.015087182633578777, decouple_loss:0.0002770160208456218
The modified gen p mean: 0.4471524655818939, gen p mean: -0.12451711297035217, mean p set: 0.44772863388061523
loss_pred:0.014727993868291378, decouple_loss:0.0004085873661097139
The modified gen p mean: 0.44668737053871155, gen p mean: -0.12804356217384338, mean p set: 0.44726207852363586
loss_pred:0.014721203595399857, decouple_loss:0.0003062768082600087
Iteration: 4186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461333155632019, gen p mean: -0.12308413535356522, mean p set: 0.446708619594574
loss_pred:0.014807290397584438, decouple_loss:0.00033860752591863275
The modified gen p mean: 0.4475097954273224, gen p mean: -0.12638060748577118, mean p set: 0.4480864405632019
loss_pred:0.014648177661001682, decouple_loss:0.0005493024364113808
The modified gen p mean: 0.44698911905288696, gen p mean: -0.12826620042324066, mean p set: 0.44756782054901123
loss_pred:0.0143816489726305, decouple_loss:0.0003707421419676393
Iteration: 4187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464057683944702, gen p mean: -0.12653760612010956, mean p set: 0.44698208570480347
loss_pred:0.015734639018774033, decouple_loss:0.00038708961801603436
The modified gen p mean: 0.44645655155181885, gen p mean: -0.12424451112747192, mean p set: 0.44702792167663574
The modified gen p mean: 0.4461628496646881, gen p mean: -0.1291341483592987, mean p set: 0.4467359483242035
loss_pred:0.014715371653437614, decouple_loss:0.0003558765456546098
loss_pred:0.014955510385334492, decouple_loss:0.0008434654446318746
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 4188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059627294540405, gen p mean: -0.11823825538158417, mean p set: 0.451172411441803
loss_pred:0.014685865491628647, decouple_loss:0.0006500263116322458
The modified gen p mean: 0.448905885219574, gen p mean: -0.13025791943073273, mean p set: 0.4494836926460266
The modified gen p mean: 0.4493531882762909, gen p mean: -0.12304341793060303, mean p set: 0.4499305486679077
loss_pred:0.014684607274830341, decouple_loss:0.0003465364861767739
loss_pred:0.014317669905722141, decouple_loss:0.00031425280030816793
Iteration: 4189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859543442726135, gen p mean: -0.12136008590459824, mean p set: 0.4491713047027588
loss_pred:0.0151639049872756, decouple_loss:0.0003507122164592147
The modified gen p mean: 0.44918572902679443, gen p mean: -0.11764133721590042, mean p set: 0.4497624933719635
loss_pred:0.014753984287381172, decouple_loss:0.00030526245245710015
The modified gen p mean: 0.4495212137699127, gen p mean: -0.125420942902565, mean p set: 0.4500974118709564
loss_pred:0.014331121928989887, decouple_loss:0.0003067981742788106
Iteration: 4190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449388712644577, gen p mean: -0.11924352496862411, mean p set: 0.44996556639671326
loss_pred:0.014354400336742401, decouple_loss:0.00047702458687126637
The modified gen p mean: 0.450967013835907, gen p mean: -0.11675302684307098, mean p set: 0.4515393376350403
The modified gen p mean: 0.4486998915672302, gen p mean: -0.11946726590394974, mean p set: 0.44927287101745605
loss_pred:0.014723310247063637, decouple_loss:0.00035725024645216763
loss_pred:0.015062655322253704, decouple_loss:0.0003816923126578331
2023-05-02 19:54:54 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12977929413318634, mean p set: 0.4502691626548767
loss_pred:0.016803622245788574, decouple_loss:0.00032249061041511595
The modified gen p mean: 0.44953376054763794, gen p mean: -0.12386997044086456, mean p set: 0.4500633478164673
loss_pred:0.016006268560886383, decouple_loss:0.0003246732521802187
The modified gen p mean: 0.44982871413230896, gen p mean: -0.12269877642393112, mean p set: 0.45035696029663086
loss_pred:0.016404731199145317, decouple_loss:0.0002932161733042449
WV_1_PC_1_EH_0_PS_40, loss: 0.016420548781752586, avg_mse: 0.02576223947107792
current test mse: 0.025762
Iteration: 4191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771647453308105, gen p mean: -0.12764181196689606, mean p set: 0.44829061627388
loss_pred:0.014593688771128654, decouple_loss:0.00037842465098947287
The modified gen p mean: 0.44944044947624207, gen p mean: -0.11916859447956085, mean p set: 0.4500153958797455The modified gen p mean: 0.44893839955329895, gen p mean: -0.11949113011360168, mean p set: 0.4495154023170471
loss_pred:0.013987156562507153, decouple_loss:0.0003636376350186765
loss_pred:0.014148296788334846, decouple_loss:0.0003691358433570713
Iteration: 4192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478284418582916, gen p mean: -0.12100502103567123, mean p set: 0.4484051764011383
loss_pred:0.014468413777649403, decouple_loss:0.0003884781035594642
The modified gen p mean: 0.44746899604797363, gen p mean: -0.1313457041978836, mean p set: 0.4480412006378174The modified gen p mean: 0.4477507770061493, gen p mean: -0.13221630454063416, mean p set: 0.44832560420036316
loss_pred:0.014845769852399826, decouple_loss:0.0003222015220671892loss_pred:0.014462992548942566, decouple_loss:0.0002953865041490644
Iteration: 4193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44880518317222595, gen p mean: -0.12302665412425995, mean p set: 0.4493807256221771
loss_pred:0.014364521019160748, decouple_loss:0.00027422551647759974
The modified gen p mean: 0.44852566719055176, gen p mean: -0.11956624686717987, mean p set: 0.44910016655921936The modified gen p mean: 0.4477824568748474, gen p mean: -0.1275179535150528, mean p set: 0.4483579099178314
loss_pred:0.015102416276931763, decouple_loss:0.00033590570092201233
loss_pred:0.013854758813977242, decouple_loss:0.00025881524197757244
Iteration: 4194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488346576690674, gen p mean: -0.11988822370767593, mean p set: 0.44941237568855286
loss_pred:0.014766473323106766, decouple_loss:0.00027602436603046954
The modified gen p mean: 0.44793325662612915, gen p mean: -0.12971386313438416, mean p set: 0.44850850105285645
loss_pred:0.01403865311294794, decouple_loss:0.0002688195672817528
The modified gen p mean: 0.4492028057575226, gen p mean: -0.1196499764919281, mean p set: 0.44977647066116333
loss_pred:0.014394765719771385, decouple_loss:0.0002744194061961025
Iteration: 4195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477691054344177, gen p mean: -0.1246330514550209, mean p set: 0.44834738969802856
loss_pred:0.014257693663239479, decouple_loss:0.00035880215000361204
The modified gen p mean: 0.4487776756286621, gen p mean: -0.1274309754371643, mean p set: 0.4493550956249237
loss_pred:0.014463473111391068, decouple_loss:0.00032955367350950837
The modified gen p mean: 0.448660671710968, gen p mean: -0.12819138169288635, mean p set: 0.449236124753952
loss_pred:0.014621890150010586, decouple_loss:0.00027920075808651745
Iteration: 4196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494674801826477, gen p mean: -0.12266770750284195, mean p set: 0.45004376769065857
loss_pred:0.01334568951278925, decouple_loss:0.00026798283215612173
The modified gen p mean: 0.4482995569705963, gen p mean: -0.12019870430231094, mean p set: 0.4488753378391266
The modified gen p mean: 0.44813692569732666, gen p mean: -0.12436553835868835, mean p set: 0.4487136900424957
loss_pred:0.014718301594257355, decouple_loss:0.0004444184887688607
loss_pred:0.014987689442932606, decouple_loss:0.0003717161016538739
Iteration: 4197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44912227988243103, gen p mean: -0.12472347170114517, mean p set: 0.4496983587741852
loss_pred:0.014828018844127655, decouple_loss:0.0003774223441723734
The modified gen p mean: 0.4484323561191559, gen p mean: -0.13121913373470306, mean p set: 0.4490082263946533
The modified gen p mean: 0.44982635974884033, gen p mean: -0.1270960420370102, mean p set: 0.4504038989543915
loss_pred:0.014458010904490948, decouple_loss:0.0003674447943922132
loss_pred:0.014296822249889374, decouple_loss:0.00035901274532079697
Iteration: 4198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933637976646423, gen p mean: -0.13178549706935883, mean p set: 0.44991445541381836
loss_pred:0.014679210260510445, decouple_loss:0.0003038936119992286
The modified gen p mean: 0.44906356930732727, gen p mean: -0.12073124945163727, mean p set: 0.44964277744293213
The modified gen p mean: 0.4486938714981079, gen p mean: -0.12629082798957825, mean p set: 0.4492739737033844
loss_pred:0.01468878984451294, decouple_loss:0.00030055653769522905
loss_pred:0.014831596985459328, decouple_loss:0.00028677782393060625
Iteration: 4199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448916494846344, gen p mean: -0.11918627470731735, mean p set: 0.4494929015636444
loss_pred:0.014654778875410557, decouple_loss:0.00025045863003470004
The modified gen p mean: 0.4479145407676697, gen p mean: -0.12795162200927734, mean p set: 0.44848892092704773
The modified gen p mean: 0.4480011463165283, gen p mean: -0.12494046986103058, mean p set: 0.4485754370689392
loss_pred:0.014851771295070648, decouple_loss:0.00037129269912838936
loss_pred:0.014936770312488079, decouple_loss:0.0003031507949344814
Iteration: 4200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485238790512085, gen p mean: -0.12730929255485535, mean p set: 0.44910159707069397
loss_pred:0.014524335041642189, decouple_loss:0.00034941930789500475
The modified gen p mean: 0.4492835998535156, gen p mean: -0.12051255255937576, mean p set: 0.44986000657081604
The modified gen p mean: 0.4492149353027344, gen p mean: -0.12316993623971939, mean p set: 0.4497894048690796
loss_pred:0.014304366894066334, decouple_loss:0.0002696668670978397
loss_pred:0.01451702881604433, decouple_loss:0.00031533074798062444
2023-05-02 19:57:02 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.130854994058609, mean p set: 0.4502691626548767
loss_pred:0.01679311692714691, decouple_loss:0.0002745461242739111
The modified gen p mean: 0.4495352804660797, gen p mean: -0.12507861852645874, mean p set: 0.4500633478164673
loss_pred:0.01604178175330162, decouple_loss:0.00044100714148953557
The modified gen p mean: 0.44982752203941345, gen p mean: -0.12392715364694595, mean p set: 0.45035696029663086
loss_pred:0.016319051384925842, decouple_loss:0.00039821743848733604
WV_1_PC_1_EH_0_PS_40, loss: 0.016403213143348694, avg_mse: 0.02573850005865097
current test mse: 0.025738
Iteration: 4201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487592875957489, gen p mean: -0.12840916216373444, mean p set: 0.44933852553367615
The modified gen p mean: 0.44935429096221924, gen p mean: -0.12701985239982605, mean p set: 0.4499303698539734
loss_pred:0.014327224344015121, decouple_loss:0.000326566951116547
loss_pred:0.015020138584077358, decouple_loss:0.00028178145294077694
The modified gen p mean: 0.44842085242271423, gen p mean: -0.12147781997919083, mean p set: 0.4489958584308624
loss_pred:0.014539487659931183, decouple_loss:0.0004247018659953028
Iteration: 4202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500128924846649, gen p mean: -0.12601928412914276, mean p set: 0.45059165358543396
loss_pred:0.014581832103431225, decouple_loss:0.0003175158053636551
The modified gen p mean: 0.44900715351104736, gen p mean: -0.1232011467218399, mean p set: 0.4495806396007538
The modified gen p mean: 0.4484178423881531, gen p mean: -0.12152737379074097, mean p set: 0.44899484515190125
loss_pred:0.013778772205114365, decouple_loss:0.0002993445086758584
loss_pred:0.015397262759506702, decouple_loss:0.0002761953219305724
Iteration: 4203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787031412124634, gen p mean: -0.12483957409858704, mean p set: 0.4484458863735199
loss_pred:0.014448940753936768, decouple_loss:0.00044200828415341675
The modified gen p mean: 0.4482470750808716, gen p mean: -0.11933384090662003, mean p set: 0.4488248825073242
loss_pred:0.014689364470541477, decouple_loss:0.0003912420361302793
The modified gen p mean: 0.449970543384552, gen p mean: -0.11643070727586746, mean p set: 0.45054665207862854
loss_pred:0.014306670986115932, decouple_loss:0.0003424169553909451
Iteration: 4204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494582414627075, gen p mean: -0.11918439716100693, mean p set: 0.45003435015678406
loss_pred:0.01421066839247942, decouple_loss:0.00036499224370345473
The modified gen p mean: 0.4483967125415802, gen p mean: -0.11945517361164093, mean p set: 0.44897210597991943
loss_pred:0.014577235095202923, decouple_loss:0.00036276946775615215
The modified gen p mean: 0.4481768012046814, gen p mean: -0.12557856738567352, mean p set: 0.4487546384334564
loss_pred:0.014843217097222805, decouple_loss:0.00043270146124996245
Iteration: 4205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973427057266235, gen p mean: -0.11609819531440735, mean p set: 0.450310081243515
loss_pred:0.01457330770790577, decouple_loss:0.0002946203458122909
The modified gen p mean: 0.44813355803489685, gen p mean: -0.12422238290309906, mean p set: 0.44871246814727783
loss_pred:0.01483405102044344, decouple_loss:0.0002889214374590665
The modified gen p mean: 0.4497317671775818, gen p mean: -0.11856009066104889, mean p set: 0.4503089487552643
loss_pred:0.013935361988842487, decouple_loss:0.000384817918529734
Iteration: 4206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499436616897583, gen p mean: -0.11769051104784012, mean p set: 0.450520396232605
loss_pred:0.014199458993971348, decouple_loss:0.00048463520943187177
The modified gen p mean: 0.44891035556793213, gen p mean: -0.11778439581394196, mean p set: 0.4494885504245758
loss_pred:0.015139245428144932, decouple_loss:0.00039482099236920476
The modified gen p mean: 0.44897517561912537, gen p mean: -0.12258017063140869, mean p set: 0.4495515525341034
loss_pred:0.014587150886654854, decouple_loss:0.00029898257344029844
Iteration: 4207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491419792175293, gen p mean: -0.11855513602495193, mean p set: 0.44971972703933716
loss_pred:0.014288007281720638, decouple_loss:0.0004300196887925267
The modified gen p mean: 0.4484395384788513, gen p mean: -0.11527971923351288, mean p set: 0.44901344180107117
loss_pred:0.01455041766166687, decouple_loss:0.00036152664688415825
The modified gen p mean: 0.44784796237945557, gen p mean: -0.12147738039493561, mean p set: 0.44842392206192017
loss_pred:0.014236507005989552, decouple_loss:0.0002889757161028683
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
NaN value num: 0
Iteration: 4208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45172739028930664, gen p mean: -0.11661789566278458, mean p set: 0.45230305194854736
The modified gen p mean: 0.4511753022670746, gen p mean: -0.11760934442281723, mean p set: 0.45174965262413025
loss_pred:0.014801635406911373, decouple_loss:0.00042514814413152635
loss_pred:0.014158112928271294, decouple_loss:0.0003355030785314739
The modified gen p mean: 0.44890376925468445, gen p mean: -0.11605678498744965, mean p set: 0.44948139786720276
loss_pred:0.015479913912713528, decouple_loss:0.0005750745185650885
Iteration: 4209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975990056991577, gen p mean: -0.11534778773784637, mean p set: 0.4503360688686371
loss_pred:0.014914251863956451, decouple_loss:0.0003449697105679661
The modified gen p mean: 0.4510537385940552, gen p mean: -0.11482581496238708, mean p set: 0.45162826776504517
The modified gen p mean: 0.45190757513046265, gen p mean: -0.11167910695075989, mean p set: 0.4524841606616974
loss_pred:0.013493594713509083, decouple_loss:0.0003642887168098241
loss_pred:0.014723862521350384, decouple_loss:0.0003498846781440079
Iteration: 4210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45178672671318054, gen p mean: -0.11256929486989975, mean p set: 0.4523622393608093
loss_pred:0.01463437918573618, decouple_loss:0.00048219109885394573
The modified gen p mean: 0.45108431577682495, gen p mean: -0.11641182750463486, mean p set: 0.451659619808197
loss_pred:0.01389937661588192, decouple_loss:0.0003687984135467559
The modified gen p mean: 0.45013901591300964, gen p mean: -0.11040587723255157, mean p set: 0.4507162272930145
loss_pred:0.01458433922380209, decouple_loss:0.0003760934923775494
2023-05-02 19:59:48 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12498931586742401, mean p set: 0.4502691626548767
loss_pred:0.01675471104681492, decouple_loss:0.0005940396804362535
The modified gen p mean: 0.4495357573032379, gen p mean: -0.11926715821027756, mean p set: 0.4500633478164673
loss_pred:0.015988245606422424, decouple_loss:0.0005065954173915088
The modified gen p mean: 0.44982901215553284, gen p mean: -0.11811092495918274, mean p set: 0.45035696029663086
loss_pred:0.016251737251877785, decouple_loss:0.00042654445860534906
WV_1_PC_1_EH_0_PS_40, loss: 0.016357017681002617, avg_mse: 0.025615694001317024
current test mse: 0.025616
Iteration: 4211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44974756240844727, gen p mean: -0.11272052675485611, mean p set: 0.45032238960266113
loss_pred:0.015062895603477955, decouple_loss:0.0004410342371556908
The modified gen p mean: 0.45013362169265747, gen p mean: -0.11168832331895828, mean p set: 0.4507116973400116The modified gen p mean: 0.4510941207408905, gen p mean: -0.11264892667531967, mean p set: 0.4516703188419342
loss_pred:0.015193271450698376, decouple_loss:0.00035248170024715364
loss_pred:0.015183959156274796, decouple_loss:0.00037908635567873716
Iteration: 4212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45105302333831787, gen p mean: -0.10979591310024261, mean p set: 0.4516293406486511
loss_pred:0.014275189489126205, decouple_loss:0.000313904311042279
The modified gen p mean: 0.4491168260574341, gen p mean: -0.10930100828409195, mean p set: 0.44969022274017334The modified gen p mean: 0.45028549432754517, gen p mean: -0.11573528498411179, mean p set: 0.45086219906806946
loss_pred:0.01432704832404852, decouple_loss:0.00028145083342678845loss_pred:0.014902188442647457, decouple_loss:0.0003510506940074265
Iteration: 4213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45028993487358093, gen p mean: -0.1146710216999054, mean p set: 0.45086607336997986
The modified gen p mean: 0.4500868618488312, gen p mean: -0.1155557930469513, mean p set: 0.450663298368454
loss_pred:0.015078526921570301, decouple_loss:0.0003615941386669874
loss_pred:0.014920922927558422, decouple_loss:0.00034086580853909254
The modified gen p mean: 0.44802364706993103, gen p mean: -0.11292746663093567, mean p set: 0.4485994875431061
loss_pred:0.014857111498713493, decouple_loss:0.00046241888776421547
Iteration: 4214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45215049386024475, gen p mean: -0.10971400886774063, mean p set: 0.45272788405418396
loss_pred:0.015131186693906784, decouple_loss:0.0004452055145520717
The modified gen p mean: 0.4480888843536377, gen p mean: -0.10702723264694214, mean p set: 0.4486648738384247
loss_pred:0.015080287121236324, decouple_loss:0.0003259541990701109
The modified gen p mean: 0.45014411211013794, gen p mean: -0.11277948319911957, mean p set: 0.45071932673454285
loss_pred:0.014298833906650543, decouple_loss:0.0003573097928892821
Iteration: 4215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507399797439575, gen p mean: -0.11030419915914536, mean p set: 0.4513179361820221
loss_pred:0.013820342719554901, decouple_loss:0.0003032234380953014
The modified gen p mean: 0.4506399631500244, gen p mean: -0.11676212400197983, mean p set: 0.4512156844139099
loss_pred:0.01426159217953682, decouple_loss:0.00030402553966268897
The modified gen p mean: 0.4516865313053131, gen p mean: -0.10730522125959396, mean p set: 0.4522624611854553
loss_pred:0.01452054176479578, decouple_loss:0.0003227354900445789
Iteration: 4216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518458843231201, gen p mean: -0.11477679759263992, mean p set: 0.4524208605289459
loss_pred:0.015297540463507175, decouple_loss:0.0004491870931815356
The modified gen p mean: 0.4505697190761566, gen p mean: -0.10957696288824081, mean p set: 0.4511450529098511
The modified gen p mean: 0.44981762766838074, gen p mean: -0.11621538549661636, mean p set: 0.4503934979438782
loss_pred:0.014581182040274143, decouple_loss:0.0004446206730790436
loss_pred:0.014151470735669136, decouple_loss:0.0004082001687493175
Iteration: 4217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505428969860077, gen p mean: -0.11539530754089355, mean p set: 0.45111945271492004
loss_pred:0.014396238140761852, decouple_loss:0.00039049124461598694
The modified gen p mean: 0.4503611624240875, gen p mean: -0.115046925842762, mean p set: 0.4509385824203491
The modified gen p mean: 0.450587660074234, gen p mean: -0.11369417607784271, mean p set: 0.4511634409427643
loss_pred:0.014434481970965862, decouple_loss:0.0005322322249412537
loss_pred:0.014782579615712166, decouple_loss:0.0006423235754482448
Iteration: 4218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491642713546753, gen p mean: -0.1126098707318306, mean p set: 0.44973814487457275
loss_pred:0.015377272851765156, decouple_loss:0.0006902869208715856
The modified gen p mean: 0.44975998997688293, gen p mean: -0.11270861327648163, mean p set: 0.4503384232521057
loss_pred:0.013955483213067055, decouple_loss:0.000407479761634022
The modified gen p mean: 0.45090529322624207, gen p mean: -0.12045706808567047, mean p set: 0.4514824450016022
loss_pred:0.014121786691248417, decouple_loss:0.0005089653423056006
Iteration: 4219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451321542263031, gen p mean: -0.11941594630479813, mean p set: 0.45189934968948364
loss_pred:0.01381542906165123, decouple_loss:0.0005831131711602211
The modified gen p mean: 0.4513697624206543, gen p mean: -0.12255021929740906, mean p set: 0.4519474506378174
The modified gen p mean: 0.4507982134819031, gen p mean: -0.1181604340672493, mean p set: 0.4513757526874542
loss_pred:0.014103947207331657, decouple_loss:0.0006271458696573973
loss_pred:0.01349045243114233, decouple_loss:0.0006414176896214485
Iteration: 4220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450367271900177, gen p mean: -0.11769439280033112, mean p set: 0.45094114542007446
loss_pred:0.01426454447209835, decouple_loss:0.0007345487829297781
The modified gen p mean: 0.4509006440639496, gen p mean: -0.11457345634698868, mean p set: 0.4514772295951843
loss_pred:0.01437632367014885, decouple_loss:0.0006273475592024624
The modified gen p mean: 0.4518539309501648, gen p mean: -0.11694934964179993, mean p set: 0.4524308443069458
loss_pred:0.014163478277623653, decouple_loss:0.0005632814136333764
2023-05-02 20:01:56 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13095642626285553, mean p set: 0.4502691626548767
loss_pred:0.016809236258268356, decouple_loss:0.0004848935641348362
The modified gen p mean: 0.4495357275009155, gen p mean: -0.12516357004642487, mean p set: 0.4500633478164673
loss_pred:0.01619718223810196, decouple_loss:0.0004620541585609317
The modified gen p mean: 0.44982844591140747, gen p mean: -0.12384098768234253, mean p set: 0.45035696029663086
loss_pred:0.01629387028515339, decouple_loss:0.00045675275032408535
WV_1_PC_1_EH_0_PS_40, loss: 0.01645682565867901, avg_mse: 0.025729244574904442
current test mse: 0.025729
Iteration: 4221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44887495040893555, gen p mean: -0.11977770924568176, mean p set: 0.44945064187049866
The modified gen p mean: 0.44864651560783386, gen p mean: -0.11223387718200684, mean p set: 0.44922199845314026loss_pred:0.015008964575827122, decouple_loss:0.00047270176582969725
loss_pred:0.015224217437207699, decouple_loss:0.0005000443779863417
The modified gen p mean: 0.4512495994567871, gen p mean: -0.12001191079616547, mean p set: 0.451826274394989
loss_pred:0.014350940473377705, decouple_loss:0.0003076754801440984
Iteration: 4222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44825777411460876, gen p mean: -0.11917312443256378, mean p set: 0.448832631111145
loss_pred:0.015357729978859425, decouple_loss:0.00043313787318766117
The modified gen p mean: 0.44906705617904663, gen p mean: -0.11723040044307709, mean p set: 0.4496423602104187The modified gen p mean: 0.4480499029159546, gen p mean: -0.11805263161659241, mean p set: 0.4486250877380371
loss_pred:0.01506535243242979, decouple_loss:0.00046357177780009806
loss_pred:0.015565034933388233, decouple_loss:0.0004050535790156573
Iteration: 4223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505964517593384, gen p mean: -0.11716904491186142, mean p set: 0.4511736333370209
loss_pred:0.014161809347569942, decouple_loss:0.0004253294609952718
The modified gen p mean: 0.45053887367248535, gen p mean: -0.12075041234493256, mean p set: 0.4511139988899231The modified gen p mean: 0.4483911693096161, gen p mean: -0.10899236798286438, mean p set: 0.4489688575267792
loss_pred:0.014593098312616348, decouple_loss:0.000553641642909497loss_pred:0.01541012804955244, decouple_loss:0.0002878773375414312
Iteration: 4224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049959421157837, gen p mean: -0.11571348458528519, mean p set: 0.4510786831378937
loss_pred:0.013989787548780441, decouple_loss:0.00037974605220369995
The modified gen p mean: 0.45115357637405396, gen p mean: -0.1183878481388092, mean p set: 0.45173394680023193
loss_pred:0.014189363457262516, decouple_loss:0.0003140665066894144
The modified gen p mean: 0.4510602355003357, gen p mean: -0.11837232857942581, mean p set: 0.45163747668266296
loss_pred:0.01402782741934061, decouple_loss:0.00034893956035375595
Iteration: 4225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493712782859802, gen p mean: -0.11335854232311249, mean p set: 0.44994789361953735
loss_pred:0.015492050908505917, decouple_loss:0.000698526157066226
The modified gen p mean: 0.45043984055519104, gen p mean: -0.11799779534339905, mean p set: 0.45101502537727356
loss_pred:0.01450324896723032, decouple_loss:0.0005206199130043387
The modified gen p mean: 0.4512234330177307, gen p mean: -0.11366161704063416, mean p set: 0.4517979323863983
loss_pred:0.013801631517708302, decouple_loss:0.00042838670196942985
Iteration: 4226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503656327724457, gen p mean: -0.11088639497756958, mean p set: 0.4509407579898834
loss_pred:0.013451658189296722, decouple_loss:0.000408552325097844
The modified gen p mean: 0.4493006467819214, gen p mean: -0.11349665373563766, mean p set: 0.44987818598747253
loss_pred:0.015358981676399708, decouple_loss:0.00056094751926139
The modified gen p mean: 0.4503989517688751, gen p mean: -0.11085034161806107, mean p set: 0.45097577571868896
loss_pred:0.014446343295276165, decouple_loss:0.0006805741577409208
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
NaN value num: 0
Iteration: 4227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44689512252807617, gen p mean: -0.12473747134208679, mean p set: 0.44747358560562134
loss_pred:0.01610257849097252, decouple_loss:0.00035976580693386495
The modified gen p mean: 0.44799941778182983, gen p mean: -0.1145067811012268, mean p set: 0.44857561588287354
The modified gen p mean: 0.4459853768348694, gen p mean: -0.12231379747390747, mean p set: 0.4465617835521698
loss_pred:0.015228264965116978, decouple_loss:0.0004932993906550109
loss_pred:0.015533475205302238, decouple_loss:0.0005354054155759513
Iteration: 4228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477735757827759, gen p mean: -0.11855608969926834, mean p set: 0.4483503997325897
loss_pred:0.01553457323461771, decouple_loss:0.00037230216548778117
The modified gen p mean: 0.44817090034484863, gen p mean: -0.11690864711999893, mean p set: 0.44874683022499084
loss_pred:0.015515454113483429, decouple_loss:0.0004083042440470308
The modified gen p mean: 0.44694167375564575, gen p mean: -0.12106233835220337, mean p set: 0.4475182592868805
loss_pred:0.016379259526729584, decouple_loss:0.0004372276889625937
Iteration: 4229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44554978609085083, gen p mean: -0.1163940578699112, mean p set: 0.4461243748664856
loss_pred:0.01545074675232172, decouple_loss:0.0003700836095958948
The modified gen p mean: 0.447214275598526, gen p mean: -0.11220928281545639, mean p set: 0.4477900266647339
loss_pred:0.01550876721739769, decouple_loss:0.00042473047506064177
The modified gen p mean: 0.44716739654541016, gen p mean: -0.11286638677120209, mean p set: 0.44774138927459717
loss_pred:0.016758330166339874, decouple_loss:0.00048124956083483994
Iteration: 4230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472441077232361, gen p mean: -0.11909683048725128, mean p set: 0.4478198289871216
loss_pred:0.015376657247543335, decouple_loss:0.00046257482608780265
The modified gen p mean: 0.4478593170642853, gen p mean: -0.11802509427070618, mean p set: 0.4484359920024872
loss_pred:0.015393944457173347, decouple_loss:0.0005775123718194664
The modified gen p mean: 0.44688913226127625, gen p mean: -0.12815237045288086, mean p set: 0.44746658205986023
loss_pred:0.016434216871857643, decouple_loss:0.0004398987512104213
2023-05-02 20:04:44 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12619119882583618, mean p set: 0.4502691626548767
loss_pred:0.016711914911866188, decouple_loss:0.0006800239789299667
The modified gen p mean: 0.44953596591949463, gen p mean: -0.11986622214317322, mean p set: 0.4500633478164673
loss_pred:0.016141006723046303, decouple_loss:0.0005463011912070215
The modified gen p mean: 0.449828177690506, gen p mean: -0.11885184794664383, mean p set: 0.45035696029663086
loss_pred:0.01628999412059784, decouple_loss:0.0005601250450126827
WV_1_PC_1_EH_0_PS_40, loss: 0.016410747542977333, avg_mse: 0.025645386427640915
current test mse: 0.025645
Iteration: 4231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609376788139343, gen p mean: -0.1192554384469986, mean p set: 0.4466714859008789
loss_pred:0.015429253689944744, decouple_loss:0.0005551211652345955
The modified gen p mean: 0.4476291835308075, gen p mean: -0.12200703471899033, mean p set: 0.4482041299343109The modified gen p mean: 0.44700536131858826, gen p mean: -0.12159418314695358, mean p set: 0.4475840926170349
loss_pred:0.014896358363330364, decouple_loss:0.0005176002159714699loss_pred:0.015292011201381683, decouple_loss:0.0005028988234698772
Iteration: 4232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446275532245636, gen p mean: -0.1299983412027359, mean p set: 0.446853369474411
loss_pred:0.016294870525598526, decouple_loss:0.0003268733562435955
The modified gen p mean: 0.4464757442474365, gen p mean: -0.12040442228317261, mean p set: 0.44704926013946533The modified gen p mean: 0.4477049708366394, gen p mean: -0.12250170111656189, mean p set: 0.44828227162361145
loss_pred:0.01648561842739582, decouple_loss:0.00041400210466235876
loss_pred:0.01619010977447033, decouple_loss:0.00034258223604410887
Iteration: 4233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669926166534424, gen p mean: -0.12296439707279205, mean p set: 0.44727540016174316
loss_pred:0.015354274772107601, decouple_loss:0.00030825502471998334
The modified gen p mean: 0.4468590021133423, gen p mean: -0.12217359989881516, mean p set: 0.44743436574935913
loss_pred:0.015187299810349941, decouple_loss:0.0003607331309467554
The modified gen p mean: 0.4458581507205963, gen p mean: -0.12605303525924683, mean p set: 0.4464368224143982
loss_pred:0.016020573675632477, decouple_loss:0.0005210750969126821
Iteration: 4234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476132094860077, gen p mean: -0.12299218773841858, mean p set: 0.44818708300590515
loss_pred:0.01564493216574192, decouple_loss:0.0008107732865028083
The modified gen p mean: 0.44751203060150146, gen p mean: -0.12423709779977798, mean p set: 0.4480871260166168
loss_pred:0.015207557007670403, decouple_loss:0.0004434573638718575
The modified gen p mean: 0.44770386815071106, gen p mean: -0.1315409392118454, mean p set: 0.4482823610305786
loss_pred:0.01576441526412964, decouple_loss:0.00046369395568035543
Iteration: 4235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465462565422058, gen p mean: -0.12603454291820526, mean p set: 0.44712120294570923
loss_pred:0.016309820115566254, decouple_loss:0.0003953163104597479
The modified gen p mean: 0.44660434126853943, gen p mean: -0.1237398236989975, mean p set: 0.44717922806739807
loss_pred:0.015721788629889488, decouple_loss:0.00036110050859861076
The modified gen p mean: 0.44727903604507446, gen p mean: -0.13359731435775757, mean p set: 0.4478553533554077
loss_pred:0.016336863860487938, decouple_loss:0.000511939637362957
Iteration: 4236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44636422395706177, gen p mean: -0.1244979277253151, mean p set: 0.4469434916973114
loss_pred:0.016155390068888664, decouple_loss:0.0004458476905710995
The modified gen p mean: 0.44663533568382263, gen p mean: -0.12542718648910522, mean p set: 0.44721341133117676
loss_pred:0.015335436910390854, decouple_loss:0.0003636089968495071
The modified gen p mean: 0.4463927745819092, gen p mean: -0.12069127708673477, mean p set: 0.4469677805900574
loss_pred:0.016148924827575684, decouple_loss:0.0003996848245151341
Iteration: 4237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479096233844757, gen p mean: -0.11658816039562225, mean p set: 0.44848719239234924
loss_pred:0.015026852488517761, decouple_loss:0.00041124247945845127
The modified gen p mean: 0.446880966424942, gen p mean: -0.12106029689311981, mean p set: 0.4474555552005768
loss_pred:0.01610531285405159, decouple_loss:0.00044873901060782373
The modified gen p mean: 0.446323961019516, gen p mean: -0.12093896418809891, mean p set: 0.44690072536468506
loss_pred:0.015083125792443752, decouple_loss:0.00045057572424411774
Iteration: 4238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455220103263855, gen p mean: -0.12490186840295792, mean p set: 0.446098268032074
loss_pred:0.016022302210330963, decouple_loss:0.0004454034205991775
The modified gen p mean: 0.44539475440979004, gen p mean: -0.1260037124156952, mean p set: 0.4459685981273651
loss_pred:0.015725530683994293, decouple_loss:0.0004638574318960309
The modified gen p mean: 0.44677963852882385, gen p mean: -0.12334433943033218, mean p set: 0.44735562801361084
loss_pred:0.015252389945089817, decouple_loss:0.00039955045212991536
Iteration: 4239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772008061408997, gen p mean: -0.12704156339168549, mean p set: 0.44829463958740234
loss_pred:0.01614498160779476, decouple_loss:0.0003842537698801607
The modified gen p mean: 0.4469219744205475, gen p mean: -0.12568221986293793, mean p set: 0.4474962055683136
loss_pred:0.01586087979376316, decouple_loss:0.0004152561887167394
The modified gen p mean: 0.4478454291820526, gen p mean: -0.12316112220287323, mean p set: 0.44842231273651123
loss_pred:0.01554623432457447, decouple_loss:0.00048188891378231347
Iteration: 4240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483387768268585, gen p mean: -0.12135531008243561, mean p set: 0.448914498090744
loss_pred:0.015164072625339031, decouple_loss:0.00029092648765072227
The modified gen p mean: 0.44857820868492126, gen p mean: -0.12281475216150284, mean p set: 0.44915181398391724
The modified gen p mean: 0.4463670253753662, gen p mean: -0.13121452927589417, mean p set: 0.4469445049762726
loss_pred:0.015383741818368435, decouple_loss:0.0004017300670966506
loss_pred:0.01585569977760315, decouple_loss:0.0004196226364001632
2023-05-02 20:06:50 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12963220477104187, mean p set: 0.4502691626548767
loss_pred:0.016773052513599396, decouple_loss:0.00034677577787078917
The modified gen p mean: 0.4495331645011902, gen p mean: -0.12327120453119278, mean p set: 0.4500633478164673
loss_pred:0.016099363565444946, decouple_loss:0.00043163757072761655
The modified gen p mean: 0.4498290717601776, gen p mean: -0.12247597426176071, mean p set: 0.45035696029663086
loss_pred:0.01635339856147766, decouple_loss:0.00041777576552703977
WV_1_PC_1_EH_0_PS_40, loss: 0.016428543254733086, avg_mse: 0.02574235200881958
current test mse: 0.025742
Iteration: 4241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473186135292053, gen p mean: -0.12497130781412125, mean p set: 0.44789573550224304
loss_pred:0.015384619124233723, decouple_loss:0.0005437990766949952
The modified gen p mean: 0.44716501235961914, gen p mean: -0.1236700639128685, mean p set: 0.4477398097515106The modified gen p mean: 0.44791853427886963, gen p mean: -0.12392345815896988, mean p set: 0.44849371910095215
loss_pred:0.015913240611553192, decouple_loss:0.0002820492081809789
loss_pred:0.015098093077540398, decouple_loss:0.0003485546330921352
Iteration: 4242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728970527648926, gen p mean: -0.12495076656341553, mean p set: 0.4478640854358673
loss_pred:0.01609589159488678, decouple_loss:0.0005231855902820826
The modified gen p mean: 0.44751492142677307, gen p mean: -0.12541233003139496, mean p set: 0.4480923116207123The modified gen p mean: 0.44677314162254333, gen p mean: -0.12798693776130676, mean p set: 0.4473479390144348
loss_pred:0.015405120328068733, decouple_loss:0.0002699020260479301loss_pred:0.01595022715628147, decouple_loss:0.0006837054970674217
Iteration: 4243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463430643081665, gen p mean: -0.1218549832701683, mean p set: 0.4469192922115326
The modified gen p mean: 0.44601869583129883, gen p mean: -0.12518459558486938, mean p set: 0.4465934634208679
loss_pred:0.01675545796751976, decouple_loss:0.0006407320615835488
loss_pred:0.015157663263380527, decouple_loss:0.0005956420791335404
The modified gen p mean: 0.4476063847541809, gen p mean: -0.1239909902215004, mean p set: 0.4481818377971649
loss_pred:0.0157600287348032, decouple_loss:0.0005069634062238038
Iteration: 4244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480594992637634, gen p mean: -0.12717239558696747, mean p set: 0.44863349199295044
loss_pred:0.015379732474684715, decouple_loss:0.0005524828447960317
The modified gen p mean: 0.4461996853351593, gen p mean: -0.12175330519676208, mean p set: 0.44677734375
loss_pred:0.015604858286678791, decouple_loss:0.00042529049096629024
The modified gen p mean: 0.4471881687641144, gen p mean: -0.12507836520671844, mean p set: 0.44776445627212524
loss_pred:0.01606929674744606, decouple_loss:0.00038142866105772555
Iteration: 4245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44600337743759155, gen p mean: -0.1229892447590828, mean p set: 0.4465792179107666
loss_pred:0.01581255905330181, decouple_loss:0.0004171762557234615
The modified gen p mean: 0.44684290885925293, gen p mean: -0.1221117302775383, mean p set: 0.4474189281463623
loss_pred:0.01604144088923931, decouple_loss:0.0004363801854196936
The modified gen p mean: 0.4477537274360657, gen p mean: -0.12391559034585953, mean p set: 0.4483303725719452
loss_pred:0.015337075106799603, decouple_loss:0.000530916906427592
Iteration: 4246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781407713890076, gen p mean: -0.12528233230113983, mean p set: 0.44839179515838623
loss_pred:0.015012795105576515, decouple_loss:0.00031228133593685925
The modified gen p mean: 0.4470287561416626, gen p mean: -0.12555469572544098, mean p set: 0.4476066827774048
loss_pred:0.015510824508965015, decouple_loss:0.0004800012684427202
The modified gen p mean: 0.44664454460144043, gen p mean: -0.12545578181743622, mean p set: 0.44722142815589905
loss_pred:0.016344543546438217, decouple_loss:0.0006351566407829523
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
NaN value num: 0
Iteration: 4247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45027944445610046, gen p mean: -0.1182180643081665, mean p set: 0.4508568048477173
The modified gen p mean: 0.45079198479652405, gen p mean: -0.12270151078701019, mean p set: 0.45136934518814087
loss_pred:0.014936637133359909, decouple_loss:0.00038795702857896686loss_pred:0.01515569444745779, decouple_loss:0.00040073017589747906
The modified gen p mean: 0.4492231607437134, gen p mean: -0.11752674728631973, mean p set: 0.44980117678642273
loss_pred:0.015240436419844627, decouple_loss:0.00034628715366125107
Iteration: 4248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977453351020813, gen p mean: -0.11944304406642914, mean p set: 0.450351357460022
loss_pred:0.01512207929044962, decouple_loss:0.0004115776682738215
The modified gen p mean: 0.450629860162735, gen p mean: -0.1194605678319931, mean p set: 0.45120492577552795
loss_pred:0.015456427820026875, decouple_loss:0.00037023250479251146
The modified gen p mean: 0.4496940076351166, gen p mean: -0.1246473416686058, mean p set: 0.4502711296081543
loss_pred:0.014176135882735252, decouple_loss:0.0004822287883143872
Iteration: 4249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504452347755432, gen p mean: -0.12139497697353363, mean p set: 0.45102033019065857
loss_pred:0.014521367847919464, decouple_loss:0.000532383332028985
The modified gen p mean: 0.4504733085632324, gen p mean: -0.12436758726835251, mean p set: 0.45105046033859253
loss_pred:0.015034995041787624, decouple_loss:0.000529884418938309
The modified gen p mean: 0.45066776871681213, gen p mean: -0.1246359795331955, mean p set: 0.4512425363063812
loss_pred:0.014540313743054867, decouple_loss:0.00046407952322624624
Iteration: 4250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490380585193634, gen p mean: -0.11984525620937347, mean p set: 0.4496149718761444
loss_pred:0.014776823110878468, decouple_loss:0.0003407190088182688
The modified gen p mean: 0.45046064257621765, gen p mean: -0.11538829654455185, mean p set: 0.4510340988636017
loss_pred:0.01503546442836523, decouple_loss:0.00048582168528810143
The modified gen p mean: 0.45004138350486755, gen p mean: -0.11850515007972717, mean p set: 0.45061591267585754
loss_pred:0.014474843628704548, decouple_loss:0.00037131289718672633
2023-05-02 20:09:37 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13293671607971191, mean p set: 0.4502691626548767
loss_pred:0.016796579584479332, decouple_loss:0.000432645931141451
The modified gen p mean: 0.4495365023612976, gen p mean: -0.12672173976898193, mean p set: 0.4500633478164673
loss_pred:0.01615910232067108, decouple_loss:0.00042429540189914405
The modified gen p mean: 0.4498273730278015, gen p mean: -0.12571285665035248, mean p set: 0.45035696029663086
loss_pred:0.01638849265873432, decouple_loss:0.0004640613915398717
WV_1_PC_1_EH_0_PS_40, loss: 0.016470076516270638, avg_mse: 0.02575705386698246
current test mse: 0.025757
Iteration: 4251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448972225189209, gen p mean: -0.11684297770261765, mean p set: 0.4495503306388855
loss_pred:0.014488393440842628, decouple_loss:0.0004448429972399026
The modified gen p mean: 0.4494757056236267, gen p mean: -0.12051825225353241, mean p set: 0.45005232095718384
The modified gen p mean: 0.44965821504592896, gen p mean: -0.11438145488500595, mean p set: 0.4502323865890503
loss_pred:0.014813392423093319, decouple_loss:0.00034399726428091526
loss_pred:0.01492979470640421, decouple_loss:0.0004253110964782536
Iteration: 4252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492940306663513, gen p mean: -0.12103115767240524, mean p set: 0.44986993074417114
loss_pred:0.015304148197174072, decouple_loss:0.00045431958278641105
The modified gen p mean: 0.4507184624671936, gen p mean: -0.11929328739643097, mean p set: 0.45129671692848206The modified gen p mean: 0.4506079852581024, gen p mean: -0.12361785769462585, mean p set: 0.4511845111846924
loss_pred:0.014542010612785816, decouple_loss:0.00037707891897298396
loss_pred:0.014162528328597546, decouple_loss:0.0005624978803098202
Iteration: 4253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489726424217224, gen p mean: -0.12139758467674255, mean p set: 0.4495491087436676
loss_pred:0.014659447595477104, decouple_loss:0.00044100804370827973
The modified gen p mean: 0.4511474072933197, gen p mean: -0.12226196378469467, mean p set: 0.4517212510108948The modified gen p mean: 0.45023494958877563, gen p mean: -0.12061844021081924, mean p set: 0.45081210136413574
loss_pred:0.014436304569244385, decouple_loss:0.00043312498019076884
loss_pred:0.014315467327833176, decouple_loss:0.0004383031337056309
Iteration: 4254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45076751708984375, gen p mean: -0.11875993013381958, mean p set: 0.4513426423072815
loss_pred:0.014989151619374752, decouple_loss:0.0003463821194600314
The modified gen p mean: 0.45055118203163147, gen p mean: -0.1228993684053421, mean p set: 0.4511294364929199
loss_pred:0.015140192583203316, decouple_loss:0.00040957031887955964
The modified gen p mean: 0.45069655776023865, gen p mean: -0.1281556487083435, mean p set: 0.45127591490745544
loss_pred:0.014943870715796947, decouple_loss:0.00044708471978083253
Iteration: 4255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997644424438477, gen p mean: -0.13001973927021027, mean p set: 0.4505513310432434
loss_pred:0.013979041948914528, decouple_loss:0.00044145743595436215
The modified gen p mean: 0.44907212257385254, gen p mean: -0.12923265993595123, mean p set: 0.4496467411518097
loss_pred:0.015692343935370445, decouple_loss:0.0003452352830208838
The modified gen p mean: 0.44972631335258484, gen p mean: -0.12449001520872116, mean p set: 0.4503003656864166
loss_pred:0.014811906032264233, decouple_loss:0.0004428377142176032
Iteration: 4256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997915625572205, gen p mean: -0.12813813984394073, mean p set: 0.4505578577518463
loss_pred:0.014458495192229748, decouple_loss:0.00047785413335077465
The modified gen p mean: 0.44813528656959534, gen p mean: -0.12707079946994781, mean p set: 0.4487132728099823
The modified gen p mean: 0.4499140977859497, gen p mean: -0.13205382227897644, mean p set: 0.4504863917827606
loss_pred:0.014843528158962727, decouple_loss:0.0002712613786570728
loss_pred:0.01492314226925373, decouple_loss:0.00036904262378811836
Iteration: 4257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503208100795746, gen p mean: -0.12778832018375397, mean p set: 0.4508983790874481
loss_pred:0.014836814254522324, decouple_loss:0.00025170802837237716
The modified gen p mean: 0.45033255219459534, gen p mean: -0.1263735443353653, mean p set: 0.45090827345848083
loss_pred:0.015709517523646355, decouple_loss:0.0004040254862047732
The modified gen p mean: 0.44902950525283813, gen p mean: -0.1281857192516327, mean p set: 0.44960469007492065
loss_pred:0.015060990117490292, decouple_loss:0.0003507263900246471
Iteration: 4258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982069730758667, gen p mean: -0.1271929144859314, mean p set: 0.450395792722702
loss_pred:0.015025378204882145, decouple_loss:0.00029949838062748313
The modified gen p mean: 0.44978052377700806, gen p mean: -0.12618955969810486, mean p set: 0.4503557085990906
The modified gen p mean: 0.45088160037994385, gen p mean: -0.1286892294883728, mean p set: 0.45145899057388306
loss_pred:0.01470226887613535, decouple_loss:0.0005833042087033391
loss_pred:0.015169763937592506, decouple_loss:0.0003796889795921743
Iteration: 4259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44979873299598694, gen p mean: -0.11767374724149704, mean p set: 0.45037728548049927
loss_pred:0.015159585513174534, decouple_loss:0.0003290498862043023
The modified gen p mean: 0.44963735342025757, gen p mean: -0.12299595773220062, mean p set: 0.4502144455909729
loss_pred:0.014285674318671227, decouple_loss:0.0003674072213470936
The modified gen p mean: 0.44971516728401184, gen p mean: -0.12437422573566437, mean p set: 0.45028993487358093
loss_pred:0.014676162041723728, decouple_loss:0.0003838612756226212
Iteration: 4260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45022982358932495, gen p mean: -0.12422594428062439, mean p set: 0.45080649852752686
loss_pred:0.014403622597455978, decouple_loss:0.0005912274355068803
The modified gen p mean: 0.4508667588233948, gen p mean: -0.1260501891374588, mean p set: 0.4514424204826355
loss_pred:0.013732434250414371, decouple_loss:0.00042854671482928097
The modified gen p mean: 0.4507245123386383, gen p mean: -0.12398768216371536, mean p set: 0.4513028562068939
loss_pred:0.014847315847873688, decouple_loss:0.00039802436367608607
2023-05-02 20:11:45 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13333164155483246, mean p set: 0.4502691626548767
loss_pred:0.016847198829054832, decouple_loss:0.0004619595129042864
The modified gen p mean: 0.44953498244285583, gen p mean: -0.12726990878582, mean p set: 0.4500633478164673
loss_pred:0.01619865745306015, decouple_loss:0.00044443487422540784
The modified gen p mean: 0.449827641248703, gen p mean: -0.12610387802124023, mean p set: 0.45035696029663086
loss_pred:0.016428828239440918, decouple_loss:0.0004182281845714897
WV_1_PC_1_EH_0_PS_40, loss: 0.01651364006102085, avg_mse: 0.025873230770230293
current test mse: 0.025873
Iteration: 4261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505641758441925, gen p mean: -0.11992279440164566, mean p set: 0.45113804936408997
loss_pred:0.01433072704821825, decouple_loss:0.0004355737764853984
The modified gen p mean: 0.4498513638973236, gen p mean: -0.11638185381889343, mean p set: 0.45042750239372253The modified gen p mean: 0.4499237537384033, gen p mean: -0.12012422829866409, mean p set: 0.45049992203712463
loss_pred:0.014940095134079456, decouple_loss:0.0004134488699492067
loss_pred:0.014381425455212593, decouple_loss:0.00047345826169475913
Iteration: 4262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45073941349983215, gen p mean: -0.11188942939043045, mean p set: 0.4513128101825714
loss_pred:0.014726761728525162, decouple_loss:0.000411783839808777
The modified gen p mean: 0.45051896572113037, gen p mean: -0.11562522500753403, mean p set: 0.4510977864265442The modified gen p mean: 0.44977161288261414, gen p mean: -0.11355409026145935, mean p set: 0.45034709572792053
loss_pred:0.01442473754286766, decouple_loss:0.00028811025549657643
loss_pred:0.015207718126475811, decouple_loss:0.00043068223749287426
Iteration: 4263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44921526312828064, gen p mean: -0.1061508059501648, mean p set: 0.4497903883457184
loss_pred:0.015025907196104527, decouple_loss:0.00037426382186822593
The modified gen p mean: 0.45032498240470886, gen p mean: -0.10631583631038666, mean p set: 0.45090147852897644
loss_pred:0.015105819329619408, decouple_loss:0.00037486603832803667
The modified gen p mean: 0.4492329955101013, gen p mean: -0.10854135453701019, mean p set: 0.44980788230895996
loss_pred:0.015007146634161472, decouple_loss:0.0003250331792514771
Iteration: 4264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44871869683265686, gen p mean: -0.10784441977739334, mean p set: 0.4492945969104767
loss_pred:0.014536227099597454, decouple_loss:0.0003681612724903971
The modified gen p mean: 0.4517265558242798, gen p mean: -0.1059160828590393, mean p set: 0.45230039954185486
loss_pred:0.014885210432112217, decouple_loss:0.00040176970651373267
The modified gen p mean: 0.4504650831222534, gen p mean: -0.10986200720071793, mean p set: 0.4510418474674225
loss_pred:0.014450167305767536, decouple_loss:0.00047457608161494136
Iteration: 4265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506628215312958, gen p mean: -0.11281143128871918, mean p set: 0.4512394070625305
loss_pred:0.015343002043664455, decouple_loss:0.0004156536015216261
The modified gen p mean: 0.4504182040691376, gen p mean: -0.11158324033021927, mean p set: 0.4509945213794708
loss_pred:0.014544865116477013, decouple_loss:0.00031879020389169455
The modified gen p mean: 0.4501068890094757, gen p mean: -0.11461637914180756, mean p set: 0.4506819546222687
loss_pred:0.013979662209749222, decouple_loss:0.0003768022288568318
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
NaN value num: 0
Iteration: 4266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451497346162796, gen p mean: -0.11842033267021179, mean p set: 0.4520733654499054
loss_pred:0.014273381792008877, decouple_loss:0.00041669741040095687
The modified gen p mean: 0.45309755206108093, gen p mean: -0.11404730379581451, mean p set: 0.45367616415023804
The modified gen p mean: 0.4521470367908478, gen p mean: -0.11931770294904709, mean p set: 0.4527246057987213
loss_pred:0.014795882627367973, decouple_loss:0.00031075719743967056
loss_pred:0.014386577531695366, decouple_loss:0.0005247739609330893
Iteration: 4267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45118823647499084, gen p mean: -0.12177234888076782, mean p set: 0.45176488161087036
loss_pred:0.01420410443097353, decouple_loss:0.0003097637672908604
The modified gen p mean: 0.45106449723243713, gen p mean: -0.12064477056264877, mean p set: 0.45164093375205994
The modified gen p mean: 0.45174428820610046, gen p mean: -0.12194233387708664, mean p set: 0.4523225724697113
loss_pred:0.013710719533264637, decouple_loss:0.0004164747952017933
loss_pred:0.014050930738449097, decouple_loss:0.0005202553002163768
Iteration: 4268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525340497493744, gen p mean: -0.12266300618648529, mean p set: 0.45310890674591064
loss_pred:0.014007039368152618, decouple_loss:0.00045322225196287036
The modified gen p mean: 0.4516085684299469, gen p mean: -0.1227831318974495, mean p set: 0.45218244194984436
loss_pred:0.014270874671638012, decouple_loss:0.00037185283144935966
The modified gen p mean: 0.45328500866889954, gen p mean: -0.12343055009841919, mean p set: 0.4538613259792328
loss_pred:0.014146802015602589, decouple_loss:0.0003664429241325706
Iteration: 4269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496331810951233, gen p mean: -0.12442859262228012, mean p set: 0.4502086043357849
loss_pred:0.014127585105597973, decouple_loss:0.00038077475619502366
The modified gen p mean: 0.4502103924751282, gen p mean: -0.1267770528793335, mean p set: 0.450788289308548
loss_pred:0.014108081348240376, decouple_loss:0.00038987674633972347
The modified gen p mean: 0.4501347243785858, gen p mean: -0.12478391081094742, mean p set: 0.4507088363170624
loss_pred:0.014481055550277233, decouple_loss:0.00033806212013587356
Iteration: 4270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45046842098236084, gen p mean: -0.12009380012750626, mean p set: 0.45104846358299255
loss_pred:0.013731811195611954, decouple_loss:0.0004100210207980126
The modified gen p mean: 0.4505891501903534, gen p mean: -0.11458015441894531, mean p set: 0.45116788148880005
loss_pred:0.0147233996540308, decouple_loss:0.00048464088467881083
The modified gen p mean: 0.449528306722641, gen p mean: -0.11999863386154175, mean p set: 0.45010724663734436
loss_pred:0.01423196867108345, decouple_loss:0.00033788473228923976
2023-05-02 20:14:32 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1282748579978943, mean p set: 0.4502691626548767
loss_pred:0.016812385991215706, decouple_loss:0.0005127870244905353
The modified gen p mean: 0.4495345950126648, gen p mean: -0.12220745533704758, mean p set: 0.4500633478164673
loss_pred:0.016165340319275856, decouple_loss:0.0005456420476548374
The modified gen p mean: 0.44982919096946716, gen p mean: -0.12083999812602997, mean p set: 0.45035696029663086
loss_pred:0.01641266606748104, decouple_loss:0.0005325874080881476
WV_1_PC_1_EH_0_PS_40, loss: 0.01648998260498047, avg_mse: 0.025813138112425804
current test mse: 0.025813
Iteration: 4271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45181986689567566, gen p mean: -0.1154329925775528, mean p set: 0.45239993929862976
loss_pred:0.014120062813162804, decouple_loss:0.0006680015940219164
The modified gen p mean: 0.4497688114643097, gen p mean: -0.11463025212287903, mean p set: 0.45034632086753845
loss_pred:0.014293971471488476, decouple_loss:0.00036511046346277
The modified gen p mean: 0.45241278409957886, gen p mean: -0.1129777729511261, mean p set: 0.4529889225959778
loss_pred:0.013781104236841202, decouple_loss:0.0005127917393110693
Iteration: 4272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507274031639099, gen p mean: -0.11124657094478607, mean p set: 0.45130568742752075
The modified gen p mean: 0.4510074555873871, gen p mean: -0.1096993088722229, mean p set: 0.4515817165374756
loss_pred:0.014017055742442608, decouple_loss:0.00042429176392033696
loss_pred:0.01439119502902031, decouple_loss:0.0004963939427398145
The modified gen p mean: 0.45067262649536133, gen p mean: -0.10722536593675613, mean p set: 0.45124995708465576
loss_pred:0.013871345669031143, decouple_loss:0.00037807042826898396
Iteration: 4273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037055015563965, gen p mean: -0.10876291245222092, mean p set: 0.45094895362854004
loss_pred:0.014074805192649364, decouple_loss:0.00034842488821595907
The modified gen p mean: 0.45031943917274475, gen p mean: -0.11031056940555573, mean p set: 0.4508955478668213
loss_pred:0.013833530247211456, decouple_loss:0.0003698879445437342
The modified gen p mean: 0.45058929920196533, gen p mean: -0.10860735177993774, mean p set: 0.45116758346557617
loss_pred:0.014493514783680439, decouple_loss:0.00036857236409559846
Iteration: 4274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509274959564209, gen p mean: -0.10199723392724991, mean p set: 0.45150282979011536
loss_pred:0.014114771969616413, decouple_loss:0.0005840716767124832
The modified gen p mean: 0.45173415541648865, gen p mean: -0.10479973256587982, mean p set: 0.4523092210292816
loss_pred:0.013903044164180756, decouple_loss:0.00038959100493229926
The modified gen p mean: 0.44985172152519226, gen p mean: -0.10654748231172562, mean p set: 0.45042940974235535
loss_pred:0.01444730069488287, decouple_loss:0.00036052719224244356
Iteration: 4275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491851031780243, gen p mean: -0.10411489754915237, mean p set: 0.4497600495815277
loss_pred:0.014155269600450993, decouple_loss:0.00045630967360921204
The modified gen p mean: 0.4507109224796295, gen p mean: -0.10350091755390167, mean p set: 0.45128652453422546
loss_pred:0.014298489317297935, decouple_loss:0.0007929239654913545
The modified gen p mean: 0.4527292251586914, gen p mean: -0.10372591763734818, mean p set: 0.4533045291900635
loss_pred:0.013689075596630573, decouple_loss:0.00039499695412814617
Iteration: 4276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511031210422516, gen p mean: -0.10218504071235657, mean p set: 0.4516802132129669
loss_pred:0.013584942556917667, decouple_loss:0.0004894868470728397
The modified gen p mean: 0.4513629376888275, gen p mean: -0.09992039203643799, mean p set: 0.4519391357898712
loss_pred:0.013700705021619797, decouple_loss:0.0004345063935033977
The modified gen p mean: 0.45048460364341736, gen p mean: -0.10141780972480774, mean p set: 0.4510599374771118
loss_pred:0.014048258773982525, decouple_loss:0.00036205927608534694
Iteration: 4277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498615860939026, gen p mean: -0.10538525134325027, mean p set: 0.45044055581092834
loss_pred:0.014418341219425201, decouple_loss:0.0003906668280251324
The modified gen p mean: 0.4518459439277649, gen p mean: -0.10289805382490158, mean p set: 0.4524218738079071
loss_pred:0.014217768795788288, decouple_loss:0.00031027826480567455
The modified gen p mean: 0.4503501057624817, gen p mean: -0.1118195652961731, mean p set: 0.4509281814098358
loss_pred:0.014286010526120663, decouple_loss:0.0003205368702765554
Iteration: 4278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968381524086, gen p mean: -0.1050214022397995, mean p set: 0.45026299357414246
loss_pred:0.014230762608349323, decouple_loss:0.0003567783860489726
The modified gen p mean: 0.4517175853252411, gen p mean: -0.10240741819143295, mean p set: 0.45229440927505493
The modified gen p mean: 0.44998982548713684, gen p mean: -0.10756074637174606, mean p set: 0.4505651295185089
loss_pred:0.014631887897849083, decouple_loss:0.00042247684905305505
loss_pred:0.013975867070257664, decouple_loss:0.00038377955206669867
Iteration: 4279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097723603248596, gen p mean: -0.10924351215362549, mean p set: 0.45155444741249084
loss_pred:0.014197377488017082, decouple_loss:0.0003244932449888438
The modified gen p mean: 0.45112088322639465, gen p mean: -0.10329735279083252, mean p set: 0.45169830322265625
loss_pred:0.013789965771138668, decouple_loss:0.00032775214640423656
The modified gen p mean: 0.45122674107551575, gen p mean: -0.10391685366630554, mean p set: 0.4518023431301117
loss_pred:0.013767686672508717, decouple_loss:0.00038908293936401606
Iteration: 4280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513738751411438, gen p mean: -0.10666360706090927, mean p set: 0.4519527554512024
loss_pred:0.013918569311499596, decouple_loss:0.0003220092039555311
The modified gen p mean: 0.4516303241252899, gen p mean: -0.11269573867321014, mean p set: 0.45220664143562317
loss_pred:0.013749722391366959, decouple_loss:0.0003731271135620773
The modified gen p mean: 0.4524565041065216, gen p mean: -0.10818687826395035, mean p set: 0.45303553342819214
loss_pred:0.013789542019367218, decouple_loss:0.0002972696674987674
2023-05-02 20:16:40 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1257825642824173, mean p set: 0.4502691626548767
loss_pred:0.016803545877337456, decouple_loss:0.0003356988599989563
The modified gen p mean: 0.4495362937450409, gen p mean: -0.11936017125844955, mean p set: 0.4500633478164673
loss_pred:0.016135726124048233, decouple_loss:0.00032885055406950414
The modified gen p mean: 0.4498290717601776, gen p mean: -0.11820515990257263, mean p set: 0.45035696029663086
loss_pred:0.016312191262841225, decouple_loss:0.0003520522150211036
WV_1_PC_1_EH_0_PS_40, loss: 0.016434097662568092, avg_mse: 0.02574433945119381
current test mse: 0.025744
Iteration: 4281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45277804136276245, gen p mean: -0.11099914461374283, mean p set: 0.45335304737091064
loss_pred:0.014563246630132198, decouple_loss:0.00031608648714609444
The modified gen p mean: 0.45076364278793335, gen p mean: -0.11434736102819443, mean p set: 0.45134058594703674The modified gen p mean: 0.4509422779083252, gen p mean: -0.11123127490282059, mean p set: 0.4515168070793152
loss_pred:0.013787366449832916, decouple_loss:0.00036796112544834614loss_pred:0.014075832441449165, decouple_loss:0.0002692148264031857
Iteration: 4282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517943263053894, gen p mean: -0.1097395047545433, mean p set: 0.4523712396621704
loss_pred:0.014461306855082512, decouple_loss:0.0004145872953813523
The modified gen p mean: 0.4511963725090027, gen p mean: -0.11322832107543945, mean p set: 0.45177337527275085The modified gen p mean: 0.45200708508491516, gen p mean: -0.11176904290914536, mean p set: 0.4525846242904663
loss_pred:0.014144985005259514, decouple_loss:0.0002922613057307899
loss_pred:0.014381040818989277, decouple_loss:0.0002907936868723482
Iteration: 4283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451783150434494, gen p mean: -0.11218657344579697, mean p set: 0.45235851407051086
loss_pred:0.014208896085619926, decouple_loss:0.00044088909635320306
The modified gen p mean: 0.45179444551467896, gen p mean: -0.11377041041851044, mean p set: 0.4523715376853943The modified gen p mean: 0.45117002725601196, gen p mean: -0.11483829468488693, mean p set: 0.4517459571361542
loss_pred:0.013631684705615044, decouple_loss:0.00048312361468560994
loss_pred:0.014249667525291443, decouple_loss:0.00040891164098866284
Iteration: 4284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45036134123802185, gen p mean: -0.1109619140625, mean p set: 0.45093876123428345
loss_pred:0.01422519888728857, decouple_loss:0.00046993387513794005
The modified gen p mean: 0.4519352316856384, gen p mean: -0.11107579618692398, mean p set: 0.45251214504241943
loss_pred:0.014066238887608051, decouple_loss:0.000285463931504637
The modified gen p mean: 0.45211249589920044, gen p mean: -0.11460011452436447, mean p set: 0.45268896222114563
loss_pred:0.013372687622904778, decouple_loss:0.0003548635868355632
Iteration: 4285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505218267440796, gen p mean: -0.11773673444986343, mean p set: 0.45109736919403076
loss_pred:0.013687980361282825, decouple_loss:0.00034612734452821314
The modified gen p mean: 0.4519173800945282, gen p mean: -0.1112699881196022, mean p set: 0.4524940252304077
loss_pred:0.013622906059026718, decouple_loss:0.0003935304703190923
The modified gen p mean: 0.4517264664173126, gen p mean: -0.1141873374581337, mean p set: 0.4523046314716339
loss_pred:0.014297766610980034, decouple_loss:0.0003263289690949023
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
NaN value num: 0
Iteration: 4286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44880640506744385, gen p mean: -0.12022510915994644, mean p set: 0.44938161969184875
loss_pred:0.014241866767406464, decouple_loss:0.0003076313005294651
The modified gen p mean: 0.45012158155441284, gen p mean: -0.11814256757497787, mean p set: 0.45070016384124756
The modified gen p mean: 0.4489520788192749, gen p mean: -0.116400346159935, mean p set: 0.44952985644340515
loss_pred:0.014301937073469162, decouple_loss:0.0002769959392026067
loss_pred:0.014592142775654793, decouple_loss:0.00032599770929664373
Iteration: 4287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487682282924652, gen p mean: -0.12040438503026962, mean p set: 0.4493407607078552
loss_pred:0.015081054531037807, decouple_loss:0.0003413482627365738
The modified gen p mean: 0.44990020990371704, gen p mean: -0.12292500585317612, mean p set: 0.450480192899704
The modified gen p mean: 0.44896262884140015, gen p mean: -0.12093351781368256, mean p set: 0.4495418667793274
loss_pred:0.014937242493033409, decouple_loss:0.000394565548049286
loss_pred:0.01485143881291151, decouple_loss:0.0003616850299295038
Iteration: 4288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500988721847534, gen p mean: -0.118589386343956, mean p set: 0.45067599415779114
loss_pred:0.014202181249856949, decouple_loss:0.0003497649449855089
The modified gen p mean: 0.4509682059288025, gen p mean: -0.11716485023498535, mean p set: 0.4515438675880432
The modified gen p mean: 0.44954246282577515, gen p mean: -0.1109355092048645, mean p set: 0.4501173794269562
loss_pred:0.015638859942555428, decouple_loss:0.0003693652106449008
loss_pred:0.014898672699928284, decouple_loss:0.000315425539156422
Iteration: 4289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853466749191284, gen p mean: -0.10765130817890167, mean p set: 0.44911229610443115
loss_pred:0.01444795448333025, decouple_loss:0.0004063839733134955
The modified gen p mean: 0.45073261857032776, gen p mean: -0.11184918135404587, mean p set: 0.45131051540374756
The modified gen p mean: 0.44917193055152893, gen p mean: -0.1087215393781662, mean p set: 0.4497474730014801
loss_pred:0.015720011666417122, decouple_loss:0.00036488627665676177
loss_pred:0.014558321796357632, decouple_loss:0.00038169274921528995
Iteration: 4290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499797523021698, gen p mean: -0.11618095636367798, mean p set: 0.4505566358566284
loss_pred:0.014149446971714497, decouple_loss:0.0003247646091040224
The modified gen p mean: 0.44931164383888245, gen p mean: -0.11548326164484024, mean p set: 0.44988682866096497
loss_pred:0.014870068989694118, decouple_loss:0.00030086381593719125
The modified gen p mean: 0.4495318830013275, gen p mean: -0.11387369781732559, mean p set: 0.45010754466056824
loss_pred:0.014584207907319069, decouple_loss:0.0003438917628955096
2023-05-02 20:19:31 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12479061633348465, mean p set: 0.4502691626548767
loss_pred:0.016773194074630737, decouple_loss:0.000448600942036137
The modified gen p mean: 0.44953453540802, gen p mean: -0.11859005689620972, mean p set: 0.4500633478164673
loss_pred:0.016148867085576057, decouple_loss:0.00040210699080489576
The modified gen p mean: 0.44982773065567017, gen p mean: -0.11761964112520218, mean p set: 0.45035696029663086
loss_pred:0.01634381152689457, decouple_loss:0.00044709467329084873
WV_1_PC_1_EH_0_PS_40, loss: 0.016443587839603424, avg_mse: 0.02578112483024597
current test mse: 0.025781
Iteration: 4291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495741128921509, gen p mean: -0.11850113421678543, mean p set: 0.45015186071395874
loss_pred:0.015500158071517944, decouple_loss:0.0003117849410045892
The modified gen p mean: 0.44792670011520386, gen p mean: -0.11620685458183289, mean p set: 0.44850265979766846The modified gen p mean: 0.4502367377281189, gen p mean: -0.11978673189878464, mean p set: 0.450813353061676
loss_pred:0.014287632890045643, decouple_loss:0.00029237568378448486loss_pred:0.014202788472175598, decouple_loss:0.0003343289718031883
Iteration: 4292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024988055229187, gen p mean: -0.11947975307703018, mean p set: 0.45082634687423706
loss_pred:0.013985822908580303, decouple_loss:0.00032810919219627976
The modified gen p mean: 0.44877487421035767, gen p mean: -0.1247546449303627, mean p set: 0.449349045753479
The modified gen p mean: 0.44947299361228943, gen p mean: -0.12257810682058334, mean p set: 0.4500495493412018
loss_pred:0.015062941238284111, decouple_loss:0.00045455372310243547
loss_pred:0.014787277206778526, decouple_loss:0.00029255804838612676
Iteration: 4293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479924440383911, gen p mean: -0.12380222976207733, mean p set: 0.4485691785812378
loss_pred:0.014029298909008503, decouple_loss:0.0003379720728844404
The modified gen p mean: 0.44787630438804626, gen p mean: -0.12369294464588165, mean p set: 0.4484533667564392
loss_pred:0.015022526495158672, decouple_loss:0.0004078831698279828
The modified gen p mean: 0.45019957423210144, gen p mean: -0.12921097874641418, mean p set: 0.4507721960544586
loss_pred:0.014182357117533684, decouple_loss:0.0003422008885536343
Iteration: 4294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930383563041687, gen p mean: -0.1212582141160965, mean p set: 0.4498787224292755
loss_pred:0.013608639128506184, decouple_loss:0.00042248901445418596
The modified gen p mean: 0.4476347267627716, gen p mean: -0.1252518743276596, mean p set: 0.44821181893348694
loss_pred:0.01427498273551464, decouple_loss:0.000361351907486096
The modified gen p mean: 0.44915223121643066, gen p mean: -0.11920078098773956, mean p set: 0.44972777366638184
loss_pred:0.01433314848691225, decouple_loss:0.0003470119263511151
Iteration: 4295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495079219341278, gen p mean: -0.12393879145383835, mean p set: 0.4500848054885864
loss_pred:0.015213833190500736, decouple_loss:0.0003648173587862402
The modified gen p mean: 0.45000386238098145, gen p mean: -0.12128735333681107, mean p set: 0.45058029890060425
loss_pred:0.014835610054433346, decouple_loss:0.00041153267375193536
The modified gen p mean: 0.45032596588134766, gen p mean: -0.12305007874965668, mean p set: 0.45089972019195557
loss_pred:0.014639322645962238, decouple_loss:0.00042158731957897544
Iteration: 4296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492945671081543, gen p mean: -0.12453369796276093, mean p set: 0.4498702585697174
loss_pred:0.01500716246664524, decouple_loss:0.0002696360170375556
The modified gen p mean: 0.4499872922897339, gen p mean: -0.12471497803926468, mean p set: 0.4505636692047119
loss_pred:0.014426047913730145, decouple_loss:0.0003166651586070657
The modified gen p mean: 0.450216144323349, gen p mean: -0.12910354137420654, mean p set: 0.45079004764556885
loss_pred:0.014358408749103546, decouple_loss:0.0002819988294504583
Iteration: 4297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44949641823768616, gen p mean: -0.12866544723510742, mean p set: 0.4500705897808075
loss_pred:0.013734923675656319, decouple_loss:0.00044704769970849156
The modified gen p mean: 0.4482068419456482, gen p mean: -0.12614524364471436, mean p set: 0.4487801790237427
loss_pred:0.014009356498718262, decouple_loss:0.00040679782978259027
The modified gen p mean: 0.44858792424201965, gen p mean: -0.12771235406398773, mean p set: 0.44916728138923645
loss_pred:0.013682516291737556, decouple_loss:0.000577626982703805
Iteration: 4298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499013423919678, gen p mean: -0.12715059518814087, mean p set: 0.4504770338535309
loss_pred:0.014080253429710865, decouple_loss:0.0003640315553639084
The modified gen p mean: 0.44906389713287354, gen p mean: -0.12685567140579224, mean p set: 0.44963738322257996
loss_pred:0.014690900221467018, decouple_loss:0.0003062845498789102
The modified gen p mean: 0.44824522733688354, gen p mean: -0.1242947056889534, mean p set: 0.4488218426704407
loss_pred:0.015411545522511005, decouple_loss:0.0003392494982108474
Iteration: 4299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44845423102378845, gen p mean: -0.12353548407554626, mean p set: 0.4490301311016083
loss_pred:0.01414909865707159, decouple_loss:0.0002818203065544367
The modified gen p mean: 0.44978487491607666, gen p mean: -0.12544238567352295, mean p set: 0.4503614604473114
loss_pred:0.014165421947836876, decouple_loss:0.00031682103872299194
The modified gen p mean: 0.4475319981575012, gen p mean: -0.12932942807674408, mean p set: 0.4481101632118225
loss_pred:0.014001288451254368, decouple_loss:0.00037628045538440347
Iteration: 4300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492615759372711, gen p mean: -0.12216611951589584, mean p set: 0.44983911514282227
loss_pred:0.014318141154944897, decouple_loss:0.00028706545708701015
The modified gen p mean: 0.4490465819835663, gen p mean: -0.12212339043617249, mean p set: 0.4496253430843353
loss_pred:0.013932693749666214, decouple_loss:0.00032868230482563376
The modified gen p mean: 0.44920435547828674, gen p mean: -0.1237538754940033, mean p set: 0.4497811496257782
loss_pred:0.015211016871035099, decouple_loss:0.0002792447339743376
2023-05-02 20:21:38 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13158054649829865, mean p set: 0.4502691626548767
loss_pred:0.016717076301574707, decouple_loss:0.00035699238651432097
The modified gen p mean: 0.4495345652103424, gen p mean: -0.12541355192661285, mean p set: 0.4500633478164673
loss_pred:0.01613042503595352, decouple_loss:0.0004691420472227037
The modified gen p mean: 0.44982877373695374, gen p mean: -0.12419362366199493, mean p set: 0.45035696029663086
loss_pred:0.0163258109241724, decouple_loss:0.0004132599278818816
WV_1_PC_1_EH_0_PS_40, loss: 0.016411758959293365, avg_mse: 0.025767454877495766
current test mse: 0.025767
Iteration: 4301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448905348777771, gen p mean: -0.12168090790510178, mean p set: 0.44948363304138184
loss_pred:0.014301290735602379, decouple_loss:0.0005166544578969479
The modified gen p mean: 0.4490995407104492, gen p mean: -0.12738251686096191, mean p set: 0.44967490434646606The modified gen p mean: 0.44983789324760437, gen p mean: -0.11977573484182358, mean p set: 0.45041564106941223
loss_pred:0.013689479790627956, decouple_loss:0.0003090550017077476
loss_pred:0.014257103204727173, decouple_loss:0.0003181230858899653
Iteration: 4302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498828053474426, gen p mean: -0.12621428072452545, mean p set: 0.4504591226577759
loss_pred:0.014204797334969044, decouple_loss:0.0003326662990730256
The modified gen p mean: 0.4489840269088745, gen p mean: -0.12128029763698578, mean p set: 0.4495590031147003The modified gen p mean: 0.4477434754371643, gen p mean: -0.12225847691297531, mean p set: 0.44831863045692444
loss_pred:0.01428923662751913, decouple_loss:0.00034457698347978294
loss_pred:0.015132760629057884, decouple_loss:0.0004447971878107637
Iteration: 4303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489811658859253, gen p mean: -0.12005311250686646, mean p set: 0.4495586156845093
loss_pred:0.015118412673473358, decouple_loss:0.0004440855118446052
The modified gen p mean: 0.4475904703140259, gen p mean: -0.12249287962913513, mean p set: 0.44816452264785767
loss_pred:0.014860588125884533, decouple_loss:0.000315265788231045
The modified gen p mean: 0.4484538435935974, gen p mean: -0.12248250842094421, mean p set: 0.44902974367141724
loss_pred:0.01453110296279192, decouple_loss:0.0004080918151885271
Iteration: 4304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495130777359009, gen p mean: -0.12348286062479019, mean p set: 0.4500916600227356
loss_pred:0.014046948403120041, decouple_loss:0.000374419178115204
The modified gen p mean: 0.44953253865242004, gen p mean: -0.12781156599521637, mean p set: 0.4501064419746399
loss_pred:0.013964656740427017, decouple_loss:0.00039683954673819244
The modified gen p mean: 0.44978371262550354, gen p mean: -0.11835986375808716, mean p set: 0.450359970331192
loss_pred:0.013872137293219566, decouple_loss:0.00041329910163767636
Iteration: 4305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481453597545624, gen p mean: -0.1230413019657135, mean p set: 0.4487202763557434
loss_pred:0.013717679306864738, decouple_loss:0.00042361809755675495
The modified gen p mean: 0.45061376690864563, gen p mean: -0.11799263209104538, mean p set: 0.4511880874633789
loss_pred:0.014764332212507725, decouple_loss:0.0003721416578628123
The modified gen p mean: 0.4478726089000702, gen p mean: -0.12399804592132568, mean p set: 0.44845086336135864
loss_pred:0.014920777641236782, decouple_loss:0.000407502637244761
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
NaN value num: 0
Iteration: 4306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516943097114563, gen p mean: -0.10744387656450272, mean p set: 0.45227164030075073
loss_pred:0.015592983923852444, decouple_loss:0.0003881853772327304
The modified gen p mean: 0.45196908712387085, gen p mean: -0.11249394714832306, mean p set: 0.45254963636398315
The modified gen p mean: 0.4501171410083771, gen p mean: -0.1201137974858284, mean p set: 0.4506944417953491
loss_pred:0.015482691116631031, decouple_loss:0.00039387462311424315
loss_pred:0.015372809022665024, decouple_loss:0.00028834756813012064
Iteration: 4307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518641233444214, gen p mean: -0.11359347403049469, mean p set: 0.4524429440498352
loss_pred:0.01390696782618761, decouple_loss:0.0003324747667647898
The modified gen p mean: 0.4517049193382263, gen p mean: -0.10913588106632233, mean p set: 0.452282190322876
loss_pred:0.014227601699531078, decouple_loss:0.0003863495367113501
The modified gen p mean: 0.45365098118782043, gen p mean: -0.11545515805482864, mean p set: 0.45422741770744324
loss_pred:0.014878520742058754, decouple_loss:0.00039393172482959926
Iteration: 4308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953951239585876, gen p mean: -0.1192862018942833, mean p set: 0.45011797547340393
loss_pred:0.013958939351141453, decouple_loss:0.000425876205554232
The modified gen p mean: 0.4509015679359436, gen p mean: -0.11530228704214096, mean p set: 0.45147937536239624
loss_pred:0.014377758838236332, decouple_loss:0.0004926613182760775
The modified gen p mean: 0.4531938135623932, gen p mean: -0.11663711816072464, mean p set: 0.4537713825702667
loss_pred:0.014720302075147629, decouple_loss:0.0004081303777638823
Iteration: 4309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45329976081848145, gen p mean: -0.11531147360801697, mean p set: 0.4538773000240326
loss_pred:0.015794787555933, decouple_loss:0.0004372797266114503
The modified gen p mean: 0.4503189027309418, gen p mean: -0.1163993775844574, mean p set: 0.4508957266807556
loss_pred:0.014256341382861137, decouple_loss:0.0003564700891729444
The modified gen p mean: 0.4518570303916931, gen p mean: -0.11726522445678711, mean p set: 0.4524341821670532
loss_pred:0.01409205049276352, decouple_loss:0.00036449666367843747
Iteration: 4310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45030632615089417, gen p mean: -0.11976786702871323, mean p set: 0.4508844316005707
loss_pred:0.013899794779717922, decouple_loss:0.0003478935977909714
The modified gen p mean: 0.45229285955429077, gen p mean: -0.11420316249132156, mean p set: 0.45286890864372253
loss_pred:0.016185395419597626, decouple_loss:0.00034443457843735814
The modified gen p mean: 0.4532482922077179, gen p mean: -0.11868948489427567, mean p set: 0.4538283348083496
loss_pred:0.01565426215529442, decouple_loss:0.00033669936237856746
2023-05-02 20:24:37 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13446342945098877, mean p set: 0.4502691626548767
loss_pred:0.016775131225585938, decouple_loss:0.0004273096565157175
The modified gen p mean: 0.4495319128036499, gen p mean: -0.12828019261360168, mean p set: 0.4500633478164673
loss_pred:0.016116051003336906, decouple_loss:0.00033878907561302185
The modified gen p mean: 0.4498286247253418, gen p mean: -0.12696652114391327, mean p set: 0.45035696029663086
loss_pred:0.016281932592391968, decouple_loss:0.0003823897277470678
WV_1_PC_1_EH_0_PS_40, loss: 0.016410179436206818, avg_mse: 0.025728706270456314
current test mse: 0.025729
Iteration: 4311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520241916179657, gen p mean: -0.11547572910785675, mean p set: 0.45259830355644226
loss_pred:0.014927149750292301, decouple_loss:0.0004152962937951088
The modified gen p mean: 0.45306283235549927, gen p mean: -0.1207672730088234, mean p set: 0.45363950729370117The modified gen p mean: 0.4513549208641052, gen p mean: -0.12530171871185303, mean p set: 0.4519317150115967
loss_pred:0.01447333861142397, decouple_loss:0.0005865070852451026
loss_pred:0.016007665544748306, decouple_loss:0.00047315252595581114
Iteration: 4312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45310431718826294, gen p mean: -0.12751547992229462, mean p set: 0.4536832273006439
loss_pred:0.014285523444414139, decouple_loss:0.0005575896939262748
The modified gen p mean: 0.45487180352211, gen p mean: -0.1226697564125061, mean p set: 0.45544660091400146The modified gen p mean: 0.45045673847198486, gen p mean: -0.12199797481298447, mean p set: 0.4510316848754883
loss_pred:0.014493593946099281, decouple_loss:0.0003603831573855132
loss_pred:0.014130300842225552, decouple_loss:0.0003719071683008224
Iteration: 4313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539532959461212, gen p mean: -0.12053722888231277, mean p set: 0.4545283913612366
loss_pred:0.013649379834532738, decouple_loss:0.0003134988946840167
The modified gen p mean: 0.4526340067386627, gen p mean: -0.12269125133752823, mean p set: 0.4532114863395691
loss_pred:0.01464500930160284, decouple_loss:0.00040602110675536096
The modified gen p mean: 0.4528227746486664, gen p mean: -0.12391820549964905, mean p set: 0.4534010887145996
loss_pred:0.014834635891020298, decouple_loss:0.0003790767805185169
Iteration: 4314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452481210231781, gen p mean: -0.12127374857664108, mean p set: 0.4530578553676605
loss_pred:0.01608256995677948, decouple_loss:0.0004028426483273506
The modified gen p mean: 0.4495084881782532, gen p mean: -0.12592729926109314, mean p set: 0.4500868618488312
loss_pred:0.01367949414998293, decouple_loss:0.0003904887125827372
The modified gen p mean: 0.45297548174858093, gen p mean: -0.12498470395803452, mean p set: 0.4535527229309082
loss_pred:0.015940800309181213, decouple_loss:0.0003929620434064418
Iteration: 4315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45309004187583923, gen p mean: -0.11656015366315842, mean p set: 0.45366615056991577
loss_pred:0.01573025994002819, decouple_loss:0.0004062598163727671
The modified gen p mean: 0.4511841833591461, gen p mean: -0.11794836819171906, mean p set: 0.45175933837890625
loss_pred:0.013828575611114502, decouple_loss:0.00043640006333589554
The modified gen p mean: 0.45297878980636597, gen p mean: -0.12210135161876678, mean p set: 0.45355919003486633
loss_pred:0.016058247536420822, decouple_loss:0.0004854192666243762
Iteration: 4316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45230281352996826, gen p mean: -0.11321994662284851, mean p set: 0.45287883281707764
loss_pred:0.013680106028914452, decouple_loss:0.00038340844912454486
The modified gen p mean: 0.45202863216400146, gen p mean: -0.11730024218559265, mean p set: 0.4526059925556183
loss_pred:0.015756944194436073, decouple_loss:0.0005642413161695004
The modified gen p mean: 0.45283928513526917, gen p mean: -0.11186075210571289, mean p set: 0.4534182846546173
loss_pred:0.015446260571479797, decouple_loss:0.0003594805020838976
Iteration: 4317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44950205087661743, gen p mean: -0.10942000150680542, mean p set: 0.4500764310359955
loss_pred:0.01491363625973463, decouple_loss:0.0004068022535648197
The modified gen p mean: 0.45075586438179016, gen p mean: -0.10880185663700104, mean p set: 0.4513308107852936
loss_pred:0.014538736082613468, decouple_loss:0.0004092425515409559
The modified gen p mean: 0.4517969489097595, gen p mean: -0.11087264865636826, mean p set: 0.4523768723011017
loss_pred:0.013693191111087799, decouple_loss:0.0003511777031235397
Iteration: 4318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4547654092311859, gen p mean: -0.11101911962032318, mean p set: 0.45534548163414
loss_pred:0.013994740322232246, decouple_loss:0.0004038164624944329
The modified gen p mean: 0.4527735710144043, gen p mean: -0.11632704734802246, mean p set: 0.4533534646034241
loss_pred:0.01468562614172697, decouple_loss:0.000340725906426087
The modified gen p mean: 0.4505111575126648, gen p mean: -0.10752388089895248, mean p set: 0.4510881304740906
loss_pred:0.0144459567964077, decouple_loss:0.00046477699652314186
Iteration: 4319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498416781425476, gen p mean: -0.11226166784763336, mean p set: 0.4504196047782898
loss_pred:0.0136302150785923, decouple_loss:0.0004424458311405033
The modified gen p mean: 0.4503263831138611, gen p mean: -0.10945314913988113, mean p set: 0.45090195536613464
The modified gen p mean: 0.449786514043808, gen p mean: -0.10954314470291138, mean p set: 0.4503626525402069
loss_pred:0.01446868572384119, decouple_loss:0.00035627209581434727
loss_pred:0.014345641247928143, decouple_loss:0.00033695102320052683
Iteration: 4320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520743191242218, gen p mean: -0.11447375267744064, mean p set: 0.452653169631958
loss_pred:0.015406731516122818, decouple_loss:0.00040597555926069617
The modified gen p mean: 0.4501554071903229, gen p mean: -0.1136488988995552, mean p set: 0.4507310390472412
loss_pred:0.014838741160929203, decouple_loss:0.0004657699028030038
The modified gen p mean: 0.4533490240573883, gen p mean: -0.11735270172357559, mean p set: 0.4539260268211365
loss_pred:0.014025812037289143, decouple_loss:0.0004898051265627146
2023-05-02 20:26:43 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13136595487594604, mean p set: 0.4502691626548767
loss_pred:0.016808636486530304, decouple_loss:0.00039214568096213043
The modified gen p mean: 0.44953468441963196, gen p mean: -0.12552855908870697, mean p set: 0.4500633478164673
loss_pred:0.01621134579181671, decouple_loss:0.0004909817944280803
The modified gen p mean: 0.4498296082019806, gen p mean: -0.1239703893661499, mean p set: 0.45035696029663086
loss_pred:0.016369102522730827, decouple_loss:0.00046028450015001
WV_1_PC_1_EH_0_PS_40, loss: 0.016485419124364853, avg_mse: 0.02580595202744007
current test mse: 0.025806
Iteration: 4321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45143944025039673, gen p mean: -0.11326712369918823, mean p set: 0.4520170986652374
loss_pred:0.015376036055386066, decouple_loss:0.00039687735261395574
The modified gen p mean: 0.45291242003440857, gen p mean: -0.11580728739500046, mean p set: 0.453487753868103The modified gen p mean: 0.450046569108963, gen p mean: -0.11845555901527405, mean p set: 0.4506206214427948
loss_pred:0.014755802229046822, decouple_loss:0.0003807957982644439
loss_pred:0.013638763688504696, decouple_loss:0.0004901416832581162
Iteration: 4322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45299261808395386, gen p mean: -0.12513430416584015, mean p set: 0.4535693824291229
loss_pred:0.014050936326384544, decouple_loss:0.0003362352726981044
The modified gen p mean: 0.45180466771125793, gen p mean: -0.11807993054389954, mean p set: 0.45238202810287476The modified gen p mean: 0.4534032344818115, gen p mean: -0.11852910369634628, mean p set: 0.45397984981536865
loss_pred:0.013662654906511307, decouple_loss:0.0002867032017093152
loss_pred:0.013583702966570854, decouple_loss:0.0002864807902369648
Iteration: 4323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511098563671112, gen p mean: -0.11600133031606674, mean p set: 0.45168498158454895
loss_pred:0.014783442951738834, decouple_loss:0.0003382367722224444
The modified gen p mean: 0.4507857859134674, gen p mean: -0.11920256912708282, mean p set: 0.45136159658432007
loss_pred:0.014059486798942089, decouple_loss:0.0002826829149853438
The modified gen p mean: 0.451360821723938, gen p mean: -0.12256883829832077, mean p set: 0.451936274766922
loss_pred:0.01491394080221653, decouple_loss:0.0003161852655466646
Iteration: 4324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536597728729248, gen p mean: -0.11720297485589981, mean p set: 0.4542378783226013
loss_pred:0.014912961982190609, decouple_loss:0.0003576854942366481
The modified gen p mean: 0.45062246918678284, gen p mean: -0.11361835151910782, mean p set: 0.4511997699737549
loss_pred:0.01437348872423172, decouple_loss:0.000399676151573658
The modified gen p mean: 0.45103883743286133, gen p mean: -0.11775191128253937, mean p set: 0.45161619782447815
loss_pred:0.015565132722258568, decouple_loss:0.0003751543699763715
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 4325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784533977508545, gen p mean: -0.12274672836065292, mean p set: 0.44842052459716797
loss_pred:0.014586052857339382, decouple_loss:0.00033044576412066817
The modified gen p mean: 0.4476892650127411, gen p mean: -0.12461640685796738, mean p set: 0.4482676684856415
loss_pred:0.014408309943974018, decouple_loss:0.00030976490234024823
The modified gen p mean: 0.44701918959617615, gen p mean: -0.12279799580574036, mean p set: 0.4475933611392975
loss_pred:0.014857483096420765, decouple_loss:0.0003388598561286926
Iteration: 4326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44899508357048035, gen p mean: -0.11637016385793686, mean p set: 0.4495725929737091
loss_pred:0.014428176917135715, decouple_loss:0.0002914068754762411
The modified gen p mean: 0.4486088156700134, gen p mean: -0.12331691384315491, mean p set: 0.44918543100357056
The modified gen p mean: 0.447946161031723, gen p mean: -0.12242536246776581, mean p set: 0.4485217034816742
loss_pred:0.01418371219187975, decouple_loss:0.0003716328938025981
loss_pred:0.014324955642223358, decouple_loss:0.0003291239554528147
Iteration: 4327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477917551994324, gen p mean: -0.12226662039756775, mean p set: 0.44836780428886414
loss_pred:0.01592385023832321, decouple_loss:0.0003487714275252074
The modified gen p mean: 0.44694894552230835, gen p mean: -0.12399134039878845, mean p set: 0.4475235044956207
The modified gen p mean: 0.44693025946617126, gen p mean: -0.12348255515098572, mean p set: 0.4475088119506836
loss_pred:0.014563929289579391, decouple_loss:0.00038398982724174857
loss_pred:0.014518676325678825, decouple_loss:0.00031488871900364757
Iteration: 4328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472305178642273, gen p mean: -0.13316187262535095, mean p set: 0.44780364632606506
loss_pred:0.014843305572867393, decouple_loss:0.00032540917163714767
The modified gen p mean: 0.44938522577285767, gen p mean: -0.11919485032558441, mean p set: 0.4499603509902954
The modified gen p mean: 0.44717708230018616, gen p mean: -0.12712374329566956, mean p set: 0.44775503873825073
loss_pred:0.013989124447107315, decouple_loss:0.0004403651983011514
loss_pred:0.01441792119294405, decouple_loss:0.00034300790866836905
Iteration: 4329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489823281764984, gen p mean: -0.12276317179203033, mean p set: 0.4495594799518585
loss_pred:0.01406745333224535, decouple_loss:0.0003498023725114763
The modified gen p mean: 0.4476005733013153, gen p mean: -0.12954461574554443, mean p set: 0.4481755197048187
The modified gen p mean: 0.44703930616378784, gen p mean: -0.1225212961435318, mean p set: 0.4476158618927002
loss_pred:0.014251699671149254, decouple_loss:0.000363819592166692
loss_pred:0.015035235323011875, decouple_loss:0.000316884892527014
Iteration: 4330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673919677734375, gen p mean: -0.12994390726089478, mean p set: 0.4473148286342621
loss_pred:0.014323342591524124, decouple_loss:0.00035572799970395863
The modified gen p mean: 0.44708359241485596, gen p mean: -0.12593992054462433, mean p set: 0.4476613700389862
The modified gen p mean: 0.44737714529037476, gen p mean: -0.12071981281042099, mean p set: 0.4479523003101349
loss_pred:0.014295848086476326, decouple_loss:0.0003372158098500222
loss_pred:0.01482704933732748, decouple_loss:0.0003793246578425169
2023-05-02 20:29:32 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12896202504634857, mean p set: 0.4502691626548767
loss_pred:0.016635991632938385, decouple_loss:0.000398708856664598
The modified gen p mean: 0.4495353102684021, gen p mean: -0.12303246557712555, mean p set: 0.4500633478164673
loss_pred:0.01607053168118, decouple_loss:0.00040942037594504654
The modified gen p mean: 0.44982799887657166, gen p mean: -0.12153500318527222, mean p set: 0.45035696029663086
loss_pred:0.016323961317539215, decouple_loss:0.00034399275318719447
WV_1_PC_1_EH_0_PS_40, loss: 0.016362696886062622, avg_mse: 0.025584260001778603
current test mse: 0.025584
Iteration: 4331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478825330734253, gen p mean: -0.1268991380929947, mean p set: 0.44845813512802124
loss_pred:0.01383455190807581, decouple_loss:0.0003620987699832767
The modified gen p mean: 0.44710445404052734, gen p mean: -0.12391266226768494, mean p set: 0.44768205285072327The modified gen p mean: 0.4480151832103729, gen p mean: -0.1253836303949356, mean p set: 0.44859078526496887
loss_pred:0.015766480937600136, decouple_loss:0.0005235126009210944loss_pred:0.013951975852251053, decouple_loss:0.0003300288808532059
Iteration: 4332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478750228881836, gen p mean: -0.12078212946653366, mean p set: 0.44845467805862427
loss_pred:0.013850315473973751, decouple_loss:0.0003844159364234656
The modified gen p mean: 0.4477561116218567, gen p mean: -0.12209227681159973, mean p set: 0.4483305513858795The modified gen p mean: 0.4475911259651184, gen p mean: -0.1287156492471695, mean p set: 0.44816869497299194
loss_pred:0.015061971731483936, decouple_loss:0.0003846057807095349
loss_pred:0.01498350314795971, decouple_loss:0.0003858889394905418
Iteration: 4333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731491804122925, gen p mean: -0.11988724768161774, mean p set: 0.4478912055492401
The modified gen p mean: 0.44853946566581726, gen p mean: -0.11937753111124039, mean p set: 0.4491148293018341
loss_pred:0.015209021046757698, decouple_loss:0.0003524727653712034
loss_pred:0.014117196202278137, decouple_loss:0.0003183436347171664
The modified gen p mean: 0.44801920652389526, gen p mean: -0.12685905396938324, mean p set: 0.4485950767993927
loss_pred:0.01443928387016058, decouple_loss:0.0003680272784549743
Iteration: 4334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755858182907104, gen p mean: -0.12657274305820465, mean p set: 0.44813597202301025
loss_pred:0.014752437360584736, decouple_loss:0.0002890833420678973
The modified gen p mean: 0.4464416801929474, gen p mean: -0.12294892966747284, mean p set: 0.44701725244522095
loss_pred:0.014650917612016201, decouple_loss:0.0003155805170536041
The modified gen p mean: 0.4487331807613373, gen p mean: -0.1309496909379959, mean p set: 0.449308842420578
loss_pred:0.013605968095362186, decouple_loss:0.00039295453461818397
Iteration: 4335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740527868270874, gen p mean: -0.12362225353717804, mean p set: 0.44798195362091064
loss_pred:0.014142537489533424, decouple_loss:0.0003523963678162545
The modified gen p mean: 0.4480546712875366, gen p mean: -0.12816409766674042, mean p set: 0.44863179326057434
loss_pred:0.014016779139637947, decouple_loss:0.0004103037645108998
The modified gen p mean: 0.4474828243255615, gen p mean: -0.12744061648845673, mean p set: 0.44805845618247986
loss_pred:0.014413351193070412, decouple_loss:0.0004004607617389411
Iteration: 4336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470604360103607, gen p mean: -0.12542666494846344, mean p set: 0.4476364552974701
loss_pred:0.01458907499909401, decouple_loss:0.0003651517617981881
The modified gen p mean: 0.44743940234184265, gen p mean: -0.1250918060541153, mean p set: 0.4480154812335968
loss_pred:0.014030310325324535, decouple_loss:0.0003757494268938899
The modified gen p mean: 0.44670337438583374, gen p mean: -0.1267734169960022, mean p set: 0.4472792148590088
loss_pred:0.014494807459414005, decouple_loss:0.0003472291864454746
Iteration: 4337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495266377925873, gen p mean: -0.1259838044643402, mean p set: 0.45010778307914734
loss_pred:0.01397326122969389, decouple_loss:0.00042145364568568766
The modified gen p mean: 0.4471076726913452, gen p mean: -0.12480946630239487, mean p set: 0.4476836025714874
loss_pred:0.013506965711712837, decouple_loss:0.0004102948878426105
The modified gen p mean: 0.4472161531448364, gen p mean: -0.13017264008522034, mean p set: 0.4477936327457428
loss_pred:0.01408317033201456, decouple_loss:0.0003069280064664781
Iteration: 4338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485335648059845, gen p mean: -0.12247811257839203, mean p set: 0.4491144120693207
loss_pred:0.014633060432970524, decouple_loss:0.00033178384182974696
The modified gen p mean: 0.44757184386253357, gen p mean: -0.1266009509563446, mean p set: 0.44814783334732056
loss_pred:0.014365382492542267, decouple_loss:0.00037058963789604604
The modified gen p mean: 0.448064386844635, gen p mean: -0.1286718100309372, mean p set: 0.4486410617828369
loss_pred:0.014084306545555592, decouple_loss:0.0003908222424797714
Iteration: 4339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465904235839844, gen p mean: -0.12566454708576202, mean p set: 0.4471684396266937
loss_pred:0.014773004688322544, decouple_loss:0.0003928574442397803
The modified gen p mean: 0.447593092918396, gen p mean: -0.125779390335083, mean p set: 0.4481693506240845
loss_pred:0.014324554242193699, decouple_loss:0.00040066358633339405
The modified gen p mean: 0.44766780734062195, gen p mean: -0.12153741717338562, mean p set: 0.44824254512786865
loss_pred:0.014786976389586926, decouple_loss:0.0004626269801519811
Iteration: 4340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475506544113159, gen p mean: -0.12377473711967468, mean p set: 0.44812917709350586
loss_pred:0.014612511731684208, decouple_loss:0.0003552124835550785
The modified gen p mean: 0.4480285942554474, gen p mean: -0.12076079100370407, mean p set: 0.44860655069351196
loss_pred:0.01393998321145773, decouple_loss:0.00034494162537157536
The modified gen p mean: 0.447294682264328, gen p mean: -0.12112725526094437, mean p set: 0.4478708505630493
loss_pred:0.013781736604869366, decouple_loss:0.0003667273267637938
2023-05-02 20:31:38 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12803691625595093, mean p set: 0.4502691626548767
loss_pred:0.01676453836262226, decouple_loss:0.00041520531522110105
The modified gen p mean: 0.449533611536026, gen p mean: -0.12155819684267044, mean p set: 0.4500633478164673
loss_pred:0.016061415895819664, decouple_loss:0.0003370532358530909
The modified gen p mean: 0.4498307704925537, gen p mean: -0.1203996017575264, mean p set: 0.45035696029663086
loss_pred:0.01629282720386982, decouple_loss:0.00039766172994859517
WV_1_PC_1_EH_0_PS_40, loss: 0.016392095014452934, avg_mse: 0.025638330727815628
current test mse: 0.025638
Iteration: 4341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484849274158478, gen p mean: -0.12102492898702621, mean p set: 0.44905948638916016
loss_pred:0.014633005484938622, decouple_loss:0.0004366115899756551
The modified gen p mean: 0.4472552239894867, gen p mean: -0.12408103048801422, mean p set: 0.44783204793930054The modified gen p mean: 0.4468044340610504, gen p mean: -0.12758655846118927, mean p set: 0.4473792016506195
loss_pred:0.014375981874763966, decouple_loss:0.0005226313951425254loss_pred:0.014410765841603279, decouple_loss:0.0004247656324878335
Iteration: 4342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476504623889923, gen p mean: -0.1175253614783287, mean p set: 0.44822585582733154
The modified gen p mean: 0.44779330492019653, gen p mean: -0.12041216343641281, mean p set: 0.4483700692653656
loss_pred:0.014569837599992752, decouple_loss:0.0004936233162879944
loss_pred:0.013821283355355263, decouple_loss:0.00042979686986654997
The modified gen p mean: 0.44696202874183655, gen p mean: -0.12709537148475647, mean p set: 0.44753962755203247
loss_pred:0.014330486766994, decouple_loss:0.00041647086618468165
Iteration: 4343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482018053531647, gen p mean: -0.11966978758573532, mean p set: 0.4487749934196472
loss_pred:0.014558386988937855, decouple_loss:0.0004522604576777667
The modified gen p mean: 0.44770991802215576, gen p mean: -0.12017615139484406, mean p set: 0.4482842683792114
loss_pred:0.014675116166472435, decouple_loss:0.00045899173710495234
The modified gen p mean: 0.4479905664920807, gen p mean: -0.11884916573762894, mean p set: 0.44856393337249756
loss_pred:0.01488325372338295, decouple_loss:0.0004330111260060221
Iteration: 4344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844260811805725, gen p mean: -0.12218934297561646, mean p set: 0.4490176737308502
loss_pred:0.014307388104498386, decouple_loss:0.0003616301401052624
The modified gen p mean: 0.44748541712760925, gen p mean: -0.12159284204244614, mean p set: 0.4480615258216858
loss_pred:0.013817308470606804, decouple_loss:0.0005440191016532481
The modified gen p mean: 0.4476411044597626, gen p mean: -0.12660595774650574, mean p set: 0.44821614027023315
loss_pred:0.01458966638892889, decouple_loss:0.00041772075928747654
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
NaN value num: 0
Iteration: 4345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890251755714417, gen p mean: -0.12871679663658142, mean p set: 0.4494785666465759
loss_pred:0.017274675890803337, decouple_loss:0.000494580075610429
The modified gen p mean: 0.44860127568244934, gen p mean: -0.123881995677948, mean p set: 0.44917601346969604
loss_pred:0.017167098820209503, decouple_loss:0.0004063747182954103
The modified gen p mean: 0.44755756855010986, gen p mean: -0.12428571283817291, mean p set: 0.4481346309185028
loss_pred:0.017341412603855133, decouple_loss:0.00039505757740698755
Iteration: 4346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786036014556885, gen p mean: -0.12726205587387085, mean p set: 0.4484367072582245
loss_pred:0.01677500270307064, decouple_loss:0.0003647698031272739
The modified gen p mean: 0.448652982711792, gen p mean: -0.12752968072891235, mean p set: 0.4492320418357849
loss_pred:0.01598442532122135, decouple_loss:0.0003229105786886066
The modified gen p mean: 0.4486006498336792, gen p mean: -0.12830333411693573, mean p set: 0.44917726516723633
loss_pred:0.016203831881284714, decouple_loss:0.0003145661612506956
Iteration: 4347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45007389783859253, gen p mean: -0.13316312432289124, mean p set: 0.45065340399742126
loss_pred:0.016050072386860847, decouple_loss:0.0004377803998067975
The modified gen p mean: 0.4468756318092346, gen p mean: -0.13307730853557587, mean p set: 0.44745081663131714
loss_pred:0.01657996140420437, decouple_loss:0.0003248169959988445
The modified gen p mean: 0.44901055097579956, gen p mean: -0.1261097937822342, mean p set: 0.4495871365070343
loss_pred:0.016068875789642334, decouple_loss:0.00034715532092377543
Iteration: 4348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489157795906067, gen p mean: -0.12987351417541504, mean p set: 0.44949114322662354
loss_pred:0.01593167334794998, decouple_loss:0.0003842930600512773
The modified gen p mean: 0.4486751854419708, gen p mean: -0.12855036556720734, mean p set: 0.44925177097320557
loss_pred:0.01619696244597435, decouple_loss:0.0003544167266227305
The modified gen p mean: 0.44790223240852356, gen p mean: -0.13518214225769043, mean p set: 0.44847843050956726
loss_pred:0.01660820096731186, decouple_loss:0.0004063954984303564
Iteration: 4349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44928810000419617, gen p mean: -0.12976735830307007, mean p set: 0.4498618543148041
loss_pred:0.014976948499679565, decouple_loss:0.0003802179417107254
The modified gen p mean: 0.4490032494068146, gen p mean: -0.1312267929315567, mean p set: 0.44958263635635376
loss_pred:0.015439825132489204, decouple_loss:0.0005003312835469842
The modified gen p mean: 0.44921404123306274, gen p mean: -0.1321403682231903, mean p set: 0.449788898229599
loss_pred:0.016104139387607574, decouple_loss:0.0004188238235656172
Iteration: 4350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489608407020569, gen p mean: -0.13527344167232513, mean p set: 0.44953596591949463
loss_pred:0.015467570163309574, decouple_loss:0.00030831433832645416
The modified gen p mean: 0.4473605155944824, gen p mean: -0.1325695663690567, mean p set: 0.4479367434978485
loss_pred:0.016180135309696198, decouple_loss:0.00041487874113954604
The modified gen p mean: 0.4493390619754791, gen p mean: -0.13274018466472626, mean p set: 0.4499170780181885
loss_pred:0.015056570991873741, decouple_loss:0.00030003313440829515
2023-05-02 20:34:28 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13834542036056519, mean p set: 0.4502691626548767
loss_pred:0.016700448468327522, decouple_loss:0.0004820710455533117
The modified gen p mean: 0.4495357871055603, gen p mean: -0.13216722011566162, mean p set: 0.4500633478164673
loss_pred:0.01609494350850582, decouple_loss:0.0003772038617171347
The modified gen p mean: 0.44982922077178955, gen p mean: -0.13110889494419098, mean p set: 0.45035696029663086
loss_pred:0.016232477501034737, decouple_loss:0.00038197016692720354
WV_1_PC_1_EH_0_PS_40, loss: 0.01636331155896187, avg_mse: 0.025615260004997253
current test mse: 0.025615
Iteration: 4351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481872618198395, gen p mean: -0.13879899680614471, mean p set: 0.4487626254558563
loss_pred:0.016268813982605934, decouple_loss:0.00036844174610450864
The modified gen p mean: 0.45064496994018555, gen p mean: -0.13375942409038544, mean p set: 0.451217383146286The modified gen p mean: 0.4483124613761902, gen p mean: -0.13495606184005737, mean p set: 0.44888877868652344
loss_pred:0.015660058706998825, decouple_loss:0.0004944499814882874loss_pred:0.016315042972564697, decouple_loss:0.000349436973920092
Iteration: 4352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493390619754791, gen p mean: -0.1312246024608612, mean p set: 0.44991692900657654
loss_pred:0.01650705188512802, decouple_loss:0.0002963704464491457
The modified gen p mean: 0.44861534237861633, gen p mean: -0.12691065669059753, mean p set: 0.4491897523403168The modified gen p mean: 0.4484570622444153, gen p mean: -0.12355271726846695, mean p set: 0.4490341246128082
loss_pred:0.01545675192028284, decouple_loss:0.00037941703340038657loss_pred:0.015653327107429504, decouple_loss:0.00032612355425953865
Iteration: 4353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686126708984375, gen p mean: -0.13083204627037048, mean p set: 0.4474412202835083
loss_pred:0.016308698803186417, decouple_loss:0.00031550315907225013
The modified gen p mean: 0.44742023944854736, gen p mean: -0.12979869544506073, mean p set: 0.4479937255382538
loss_pred:0.01635029911994934, decouple_loss:0.0003204771492164582
The modified gen p mean: 0.450287401676178, gen p mean: -0.13223540782928467, mean p set: 0.4508638381958008
loss_pred:0.014662469737231731, decouple_loss:0.00038505843258462846
Iteration: 4354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474925398826599, gen p mean: -0.1349727064371109, mean p set: 0.4480692446231842
loss_pred:0.016133945435285568, decouple_loss:0.00035990128526464105
The modified gen p mean: 0.4494911730289459, gen p mean: -0.1315355747938156, mean p set: 0.4500678777694702
loss_pred:0.015514574944972992, decouple_loss:0.00033270701533183455
The modified gen p mean: 0.4491257071495056, gen p mean: -0.12881876528263092, mean p set: 0.44970032572746277
loss_pred:0.0158780999481678, decouple_loss:0.0003064865304622799
Iteration: 4355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493928551673889, gen p mean: -0.1333443820476532, mean p set: 0.44996798038482666
loss_pred:0.016599588096141815, decouple_loss:0.00048497330863028765
The modified gen p mean: 0.45008882880210876, gen p mean: -0.12903542816638947, mean p set: 0.4506652057170868
loss_pred:0.014981883578002453, decouple_loss:0.00030209386022761464
The modified gen p mean: 0.44980165362358093, gen p mean: -0.1266707330942154, mean p set: 0.45037850737571716
loss_pred:0.015797339379787445, decouple_loss:0.00038488866994157434
Iteration: 4356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776296615600586, gen p mean: -0.12670306861400604, mean p set: 0.44833892583847046
loss_pred:0.017248086631298065, decouple_loss:0.0004573536280076951
The modified gen p mean: 0.44953179359436035, gen p mean: -0.13025519251823425, mean p set: 0.45010536909103394
loss_pred:0.016189072281122208, decouple_loss:0.0004234338703099638
The modified gen p mean: 0.44803282618522644, gen p mean: -0.12346072494983673, mean p set: 0.44860872626304626
loss_pred:0.01563131809234619, decouple_loss:0.0004776927235070616
Iteration: 4357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488525688648224, gen p mean: -0.11630275100469589, mean p set: 0.4494294226169586
loss_pred:0.016707589849829674, decouple_loss:0.0003618447808548808
The modified gen p mean: 0.4472113251686096, gen p mean: -0.12457749992609024, mean p set: 0.44778892397880554
loss_pred:0.016349351033568382, decouple_loss:0.00034938822500407696
The modified gen p mean: 0.4502215087413788, gen p mean: -0.1262395977973938, mean p set: 0.45080211758613586
loss_pred:0.016152264550328255, decouple_loss:0.0004897431354038417
Iteration: 4358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483104348182678, gen p mean: -0.127030611038208, mean p set: 0.4488857388496399
loss_pred:0.01627282053232193, decouple_loss:0.0004971338785253465
The modified gen p mean: 0.44992268085479736, gen p mean: -0.11927331238985062, mean p set: 0.4505000710487366
loss_pred:0.016079502180218697, decouple_loss:0.0004712624358944595
The modified gen p mean: 0.449007511138916, gen p mean: -0.12612858414649963, mean p set: 0.4495847821235657
loss_pred:0.01574176922440529, decouple_loss:0.00045311026042327285
Iteration: 4359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44944822788238525, gen p mean: -0.12042416632175446, mean p set: 0.45002496242523193
loss_pred:0.015490920282900333, decouple_loss:0.0003831876383628696
The modified gen p mean: 0.44971582293510437, gen p mean: -0.12447144836187363, mean p set: 0.45029157400131226
loss_pred:0.01573598012328148, decouple_loss:0.0004216190427541733
The modified gen p mean: 0.44779980182647705, gen p mean: -0.1222216859459877, mean p set: 0.44837674498558044
loss_pred:0.015253870747983456, decouple_loss:0.0003932155086658895
Iteration: 4360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44847145676612854, gen p mean: -0.11878636479377747, mean p set: 0.44904592633247375
loss_pred:0.016730578616261482, decouple_loss:0.0005690492689609528
The modified gen p mean: 0.4496912956237793, gen p mean: -0.12429791688919067, mean p set: 0.4502682387828827
The modified gen p mean: 0.446904718875885, gen p mean: -0.12932419776916504, mean p set: 0.4474814832210541
loss_pred:0.016092926263809204, decouple_loss:0.0003581214987207204
loss_pred:0.016388071700930595, decouple_loss:0.0004140196251682937
2023-05-02 20:36:34 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1345130205154419, mean p set: 0.4502691626548767
loss_pred:0.016693338751792908, decouple_loss:0.0003720223030541092
The modified gen p mean: 0.4495355784893036, gen p mean: -0.12826552987098694, mean p set: 0.4500633478164673
loss_pred:0.01616026647388935, decouple_loss:0.0004845565417781472
The modified gen p mean: 0.4498289227485657, gen p mean: -0.12675686180591583, mean p set: 0.45035696029663086
loss_pred:0.01624726690351963, decouple_loss:0.00048449571477249265
WV_1_PC_1_EH_0_PS_40, loss: 0.016389308497309685, avg_mse: 0.025697894394397736
current test mse: 0.025698
Iteration: 4361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906091690063477, gen p mean: -0.12699903547763824, mean p set: 0.44963809847831726
loss_pred:0.015132435597479343, decouple_loss:0.000437318958574906
The modified gen p mean: 0.44900304079055786, gen p mean: -0.12293719500303268, mean p set: 0.449579656124115
loss_pred:0.015614558942615986, decouple_loss:0.0004521590890362859
The modified gen p mean: 0.44948655366897583, gen p mean: -0.12731660902500153, mean p set: 0.45006415247917175
loss_pred:0.016337130218744278, decouple_loss:0.0004851445264648646
Iteration: 4362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484248757362366, gen p mean: -0.13294021785259247, mean p set: 0.4489997923374176
loss_pred:0.01608853042125702, decouple_loss:0.0005152541561983526
The modified gen p mean: 0.44944828748703003, gen p mean: -0.12136085331439972, mean p set: 0.45002689957618713The modified gen p mean: 0.44864338636398315, gen p mean: -0.1261921525001526, mean p set: 0.4492203891277313
loss_pred:0.01633594185113907, decouple_loss:0.0005492433556355536
loss_pred:0.01612621173262596, decouple_loss:0.0005188986542634666
Iteration: 4363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492564797401428, gen p mean: -0.13207212090492249, mean p set: 0.449830561876297
loss_pred:0.01603483408689499, decouple_loss:0.00043073215056210756
The modified gen p mean: 0.4477124512195587, gen p mean: -0.13287615776062012, mean p set: 0.4482865631580353
loss_pred:0.016820795834064484, decouple_loss:0.0003272979229222983
The modified gen p mean: 0.45008793473243713, gen p mean: -0.13129007816314697, mean p set: 0.45066434144973755
loss_pred:0.016243651509284973, decouple_loss:0.0003365690354257822
Iteration: 4364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473530352115631, gen p mean: -0.13554780185222626, mean p set: 0.4479283094406128
loss_pred:0.016717882826924324, decouple_loss:0.00039097407716326416
The modified gen p mean: 0.4483306109905243, gen p mean: -0.13441425561904907, mean p set: 0.4489073157310486
loss_pred:0.016024533659219742, decouple_loss:0.00031929538818076253
The modified gen p mean: 0.4485796093940735, gen p mean: -0.12635217607021332, mean p set: 0.44915536046028137
loss_pred:0.015672611072659492, decouple_loss:0.00037796972901560366
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
NaN value num: 0
Iteration: 4365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497184455394745, gen p mean: -0.12605683505535126, mean p set: 0.4502951502799988
loss_pred:0.014960355125367641, decouple_loss:0.00040864464244805276
The modified gen p mean: 0.45162415504455566, gen p mean: -0.12148714810609818, mean p set: 0.452203631401062
loss_pred:0.014915342442691326, decouple_loss:0.00029187879408709705
The modified gen p mean: 0.4504355490207672, gen p mean: -0.12420389801263809, mean p set: 0.45101073384284973
loss_pred:0.015394411981105804, decouple_loss:0.0003461293235886842
Iteration: 4366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45303988456726074, gen p mean: -0.12239037454128265, mean p set: 0.45361581444740295
loss_pred:0.014636843465268612, decouple_loss:0.00025725874002091587
The modified gen p mean: 0.4511460065841675, gen p mean: -0.12916335463523865, mean p set: 0.45172062516212463
loss_pred:0.015478672459721565, decouple_loss:0.00026436959160491824
The modified gen p mean: 0.45097774267196655, gen p mean: -0.12339591234922409, mean p set: 0.4515514075756073
loss_pred:0.015455471351742744, decouple_loss:0.000398653675802052
Iteration: 4367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497850239276886, gen p mean: -0.1244276911020279, mean p set: 0.4503602981567383
loss_pred:0.014935770072042942, decouple_loss:0.0003343150019645691
The modified gen p mean: 0.4492625892162323, gen p mean: -0.12704068422317505, mean p set: 0.4498387575149536
The modified gen p mean: 0.45168793201446533, gen p mean: -0.12391574680805206, mean p set: 0.452263742685318
loss_pred:0.01559126004576683, decouple_loss:0.000347606313880533
loss_pred:0.014479724690318108, decouple_loss:0.00034933170536533
Iteration: 4368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45269498229026794, gen p mean: -0.12712137401103973, mean p set: 0.4532740116119385
loss_pred:0.014550814405083656, decouple_loss:0.0003278573276475072
The modified gen p mean: 0.4503435492515564, gen p mean: -0.126657173037529, mean p set: 0.4509196877479553
The modified gen p mean: 0.4523729979991913, gen p mean: -0.12180963903665543, mean p set: 0.45294854044914246
loss_pred:0.015139036811888218, decouple_loss:0.000342714338330552
loss_pred:0.014281653799116611, decouple_loss:0.00035062339156866074
Iteration: 4369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45329102873802185, gen p mean: -0.12495429813861847, mean p set: 0.453868567943573
loss_pred:0.014435038901865482, decouple_loss:0.0003496327844914049
The modified gen p mean: 0.45108675956726074, gen p mean: -0.12777122855186462, mean p set: 0.4516623318195343
loss_pred:0.014346682466566563, decouple_loss:0.00032447156263515353
The modified gen p mean: 0.45132365822792053, gen p mean: -0.13298548758029938, mean p set: 0.45190224051475525
loss_pred:0.015382994897663593, decouple_loss:0.0005165611510165036
Iteration: 4370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536074995994568, gen p mean: -0.12318716943264008, mean p set: 0.45418456196784973
loss_pred:0.014697937294840813, decouple_loss:0.0002504055155441165
The modified gen p mean: 0.45121321082115173, gen p mean: -0.12194906920194626, mean p set: 0.4517904818058014
loss_pred:0.015702061355113983, decouple_loss:0.00031302994466386735
The modified gen p mean: 0.44936326146125793, gen p mean: -0.12661075592041016, mean p set: 0.44993916153907776
loss_pred:0.014550984837114811, decouple_loss:0.00027926499024033546
2023-05-02 20:39:23 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13805148005485535, mean p set: 0.4502691626548767
loss_pred:0.01677357219159603, decouple_loss:0.00028407704667188227
The modified gen p mean: 0.4495348036289215, gen p mean: -0.1318673938512802, mean p set: 0.4500633478164673
loss_pred:0.016168681904673576, decouple_loss:0.0003214724420104176
The modified gen p mean: 0.44982773065567017, gen p mean: -0.13036894798278809, mean p set: 0.45035696029663086
loss_pred:0.01622823253273964, decouple_loss:0.0003290523309260607
WV_1_PC_1_EH_0_PS_40, loss: 0.01640573889017105, avg_mse: 0.02574252523481846
current test mse: 0.025743
Iteration: 4371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996997714042664, gen p mean: -0.12889443337917328, mean p set: 0.45054367184638977
loss_pred:0.01439137663692236, decouple_loss:0.00040808937046676874
The modified gen p mean: 0.44950106739997864, gen p mean: -0.12787380814552307, mean p set: 0.45007672905921936The modified gen p mean: 0.45141270756721497, gen p mean: -0.1305023580789566, mean p set: 0.45199474692344666
loss_pred:0.015055909752845764, decouple_loss:0.0003903819597326219
loss_pred:0.014261807315051556, decouple_loss:0.00031483371276408434
Iteration: 4372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502425789833069, gen p mean: -0.1293078064918518, mean p set: 0.45082080364227295
loss_pred:0.014583631418645382, decouple_loss:0.00034295092336833477
The modified gen p mean: 0.4491913914680481, gen p mean: -0.13082772493362427, mean p set: 0.4497682452201843The modified gen p mean: 0.45195209980010986, gen p mean: -0.12633059918880463, mean p set: 0.4525294005870819
loss_pred:0.01499166153371334, decouple_loss:0.0003740958054549992
loss_pred:0.014736420474946499, decouple_loss:0.0003293743066024035
Iteration: 4373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968000054359436, gen p mean: -0.13466820120811462, mean p set: 0.4502543807029724
loss_pred:0.015467599965631962, decouple_loss:0.00039143828325904906
The modified gen p mean: 0.4493076503276825, gen p mean: -0.13278087973594666, mean p set: 0.4498836398124695
loss_pred:0.014822011813521385, decouple_loss:0.00042441647383384407
The modified gen p mean: 0.4507714509963989, gen p mean: -0.12881678342819214, mean p set: 0.4513498842716217
loss_pred:0.014618336223065853, decouple_loss:0.00027730310102924705
Iteration: 4374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450987845659256, gen p mean: -0.13295267522335052, mean p set: 0.4515630006790161
loss_pred:0.014549663290381432, decouple_loss:0.0003492948890198022
The modified gen p mean: 0.45019859075546265, gen p mean: -0.13051246106624603, mean p set: 0.4507746696472168
loss_pred:0.015472923405468464, decouple_loss:0.0003056182758882642
The modified gen p mean: 0.45077601075172424, gen p mean: -0.1378457397222519, mean p set: 0.45135000348091125
loss_pred:0.015037034638226032, decouple_loss:0.0002847562136594206
Iteration: 4375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524160325527191, gen p mean: -0.13335686922073364, mean p set: 0.4529906213283539
loss_pred:0.01449198741465807, decouple_loss:0.00027267984114587307
The modified gen p mean: 0.45162394642829895, gen p mean: -0.13202768564224243, mean p set: 0.45220157504081726
loss_pred:0.014255814254283905, decouple_loss:0.00032868082053028047
The modified gen p mean: 0.44985613226890564, gen p mean: -0.13603202998638153, mean p set: 0.4504365921020508
loss_pred:0.014081563800573349, decouple_loss:0.00026061455719172955
Iteration: 4376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45040562748908997, gen p mean: -0.13401584327220917, mean p set: 0.4509834945201874
loss_pred:0.014839759096503258, decouple_loss:0.00030577569850720465
The modified gen p mean: 0.44952768087387085, gen p mean: -0.13548068702220917, mean p set: 0.45010536909103394
loss_pred:0.014590071514248848, decouple_loss:0.0002976495889015496
The modified gen p mean: 0.4507528245449066, gen p mean: -0.13616298139095306, mean p set: 0.4513280689716339
loss_pred:0.0143850427120924, decouple_loss:0.00031610162113793194
Iteration: 4377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45109352469444275, gen p mean: -0.12762032449245453, mean p set: 0.45166799426078796
loss_pred:0.014899558387696743, decouple_loss:0.0002850746677722782
The modified gen p mean: 0.451695054769516, gen p mean: -0.12788401544094086, mean p set: 0.4522706866264343
loss_pred:0.01521665696054697, decouple_loss:0.00030637954478152096
The modified gen p mean: 0.45166733860969543, gen p mean: -0.13026770949363708, mean p set: 0.4522424042224884
loss_pred:0.014693006873130798, decouple_loss:0.0003640142676886171
Iteration: 4378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502022862434387, gen p mean: -0.12317293882369995, mean p set: 0.450778603553772
loss_pred:0.015570584684610367, decouple_loss:0.000313623488182202
The modified gen p mean: 0.4517059028148651, gen p mean: -0.12363942712545395, mean p set: 0.45228299498558044
loss_pred:0.014632626436650753, decouple_loss:0.0002757196198217571
The modified gen p mean: 0.44930317997932434, gen p mean: -0.12859420478343964, mean p set: 0.44987794756889343
loss_pred:0.015242134220898151, decouple_loss:0.00032587526948191226
Iteration: 4379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958534836769104, gen p mean: -0.11969421058893204, mean p set: 0.4501630365848541
loss_pred:0.014072570018470287, decouple_loss:0.00039636268047615886
The modified gen p mean: 0.4510805606842041, gen p mean: -0.1257266104221344, mean p set: 0.4516597390174866
The modified gen p mean: 0.45074382424354553, gen p mean: -0.12032529711723328, mean p set: 0.4513210654258728
loss_pred:0.01431421097368002, decouple_loss:0.00038515942287631333
loss_pred:0.015092134475708008, decouple_loss:0.0002908768074121326
Iteration: 4380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45184099674224854, gen p mean: -0.118858203291893, mean p set: 0.45241761207580566
loss_pred:0.014575354754924774, decouple_loss:0.00024303860845975578
The modified gen p mean: 0.4508955776691437, gen p mean: -0.12296649813652039, mean p set: 0.45147088170051575
loss_pred:0.014558817259967327, decouple_loss:0.00025477592134848237
The modified gen p mean: 0.4502198398113251, gen p mean: -0.1217915415763855, mean p set: 0.45079872012138367
loss_pred:0.015485641546547413, decouple_loss:0.00031609716825187206
2023-05-02 20:41:30 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1322375386953354, mean p set: 0.4502691626548767
loss_pred:0.016693072393536568, decouple_loss:0.0003456133999861777
The modified gen p mean: 0.4495323896408081, gen p mean: -0.12597739696502686, mean p set: 0.4500633478164673
loss_pred:0.016125228255987167, decouple_loss:0.0003743564011529088
The modified gen p mean: 0.4498280882835388, gen p mean: -0.12461475282907486, mean p set: 0.45035696029663086
loss_pred:0.016283955425024033, decouple_loss:0.0003396655374672264
WV_1_PC_1_EH_0_PS_40, loss: 0.01638507843017578, avg_mse: 0.025637712329626083
current test mse: 0.025638
Iteration: 4381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513300061225891, gen p mean: -0.12060452997684479, mean p set: 0.451905757188797
loss_pred:0.014954529702663422, decouple_loss:0.00035351168480701745
The modified gen p mean: 0.4519397020339966, gen p mean: -0.12004595249891281, mean p set: 0.45251601934432983
loss_pred:0.014917033724486828, decouple_loss:0.0002717311435844749
The modified gen p mean: 0.4493999183177948, gen p mean: -0.12499463558197021, mean p set: 0.449973464012146
loss_pred:0.014945403672754765, decouple_loss:0.00032492639729753137
Iteration: 4382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504077732563019, gen p mean: -0.1265304535627365, mean p set: 0.4509831368923187
The modified gen p mean: 0.44983330368995667, gen p mean: -0.12503254413604736, mean p set: 0.4504096210002899loss_pred:0.015569382347166538, decouple_loss:0.00036055382224731147
loss_pred:0.015406881459057331, decouple_loss:0.0003564906073734164
The modified gen p mean: 0.45171797275543213, gen p mean: -0.1288040429353714, mean p set: 0.4522954225540161
loss_pred:0.014319327659904957, decouple_loss:0.0002494160726200789
Iteration: 4383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45157158374786377, gen p mean: -0.1332802027463913, mean p set: 0.4521483778953552
loss_pred:0.015254543162882328, decouple_loss:0.00027410060283727944
The modified gen p mean: 0.44971609115600586, gen p mean: -0.12499294430017471, mean p set: 0.45029133558273315
loss_pred:0.015629559755325317, decouple_loss:0.0002971415233332664
The modified gen p mean: 0.4520103633403778, gen p mean: -0.1263049691915512, mean p set: 0.4525899887084961
loss_pred:0.014442493207752705, decouple_loss:0.00030317765776999295
Iteration: 4384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45156329870224, gen p mean: -0.13144700229167938, mean p set: 0.4521428644657135
loss_pred:0.014036399312317371, decouple_loss:0.0002894900680985302
The modified gen p mean: 0.45144614577293396, gen p mean: -0.12569113075733185, mean p set: 0.4520223140716553
loss_pred:0.014876122586429119, decouple_loss:0.0004094185132998973
The modified gen p mean: 0.45099732279777527, gen p mean: -0.12707367539405823, mean p set: 0.4515727162361145
loss_pred:0.014336738735437393, decouple_loss:0.0002734930021688342
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
NaN value num: 0
Iteration: 4385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502145051956177, gen p mean: -0.12694613635540009, mean p set: 0.4507887363433838
The modified gen p mean: 0.4496329128742218, gen p mean: -0.13689549267292023, mean p set: 0.45020797848701477
loss_pred:0.014195507392287254, decouple_loss:0.0003200668725185096
loss_pred:0.015240446664392948, decouple_loss:0.00036527824704535306
The modified gen p mean: 0.4497500956058502, gen p mean: -0.12395719438791275, mean p set: 0.45032599568367004
loss_pred:0.014745838940143585, decouple_loss:0.00030249819974415004
Iteration: 4386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45152878761291504, gen p mean: -0.13052476942539215, mean p set: 0.4521060883998871
loss_pred:0.014917244203388691, decouple_loss:0.00043537974124774337
The modified gen p mean: 0.448639452457428, gen p mean: -0.13211454451084137, mean p set: 0.44921332597732544
The modified gen p mean: 0.4511687159538269, gen p mean: -0.12951679527759552, mean p set: 0.4517436623573303
loss_pred:0.015143988654017448, decouple_loss:0.00038372440030798316
loss_pred:0.015465755946934223, decouple_loss:0.0003025315818376839
Iteration: 4387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525553286075592, gen p mean: -0.12487900257110596, mean p set: 0.4531312584877014
loss_pred:0.015188510529696941, decouple_loss:0.0007283596787601709
The modified gen p mean: 0.44907984137535095, gen p mean: -0.1292267143726349, mean p set: 0.4496527314186096
The modified gen p mean: 0.4486715495586395, gen p mean: -0.13104867935180664, mean p set: 0.44924721121788025
loss_pred:0.015159021131694317, decouple_loss:0.0004902101354673505
loss_pred:0.014275933615863323, decouple_loss:0.0004977463977411389
Iteration: 4388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494377374649048, gen p mean: -0.12572327256202698, mean p set: 0.4500143229961395
loss_pred:0.014937009662389755, decouple_loss:0.0004309630021452904
The modified gen p mean: 0.4495934844017029, gen p mean: -0.1300639808177948, mean p set: 0.45016786456108093
loss_pred:0.015369039960205555, decouple_loss:0.0004892183933407068
The modified gen p mean: 0.44982627034187317, gen p mean: -0.12234363704919815, mean p set: 0.45040273666381836
loss_pred:0.01476492453366518, decouple_loss:0.0005869438755325973
Iteration: 4389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501197040081024, gen p mean: -0.12852995097637177, mean p set: 0.450695663690567
loss_pred:0.014879059046506882, decouple_loss:0.00033858520328067243
The modified gen p mean: 0.45029810070991516, gen p mean: -0.12458246946334839, mean p set: 0.45087239146232605
loss_pred:0.015083998441696167, decouple_loss:0.00035048575955443084
The modified gen p mean: 0.45145663619041443, gen p mean: -0.12466565519571304, mean p set: 0.4520338773727417
loss_pred:0.015040961094200611, decouple_loss:0.0005225092172622681
Iteration: 4390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836828112602234, gen p mean: -0.13592450320720673, mean p set: 0.44894298911094666
loss_pred:0.014085596427321434, decouple_loss:0.00034396207774989307
The modified gen p mean: 0.4520735740661621, gen p mean: -0.12079330533742905, mean p set: 0.45265257358551025
loss_pred:0.014878795482218266, decouple_loss:0.0003651010920293629
The modified gen p mean: 0.45039188861846924, gen p mean: -0.13039684295654297, mean p set: 0.45096808671951294
loss_pred:0.014176561497151852, decouple_loss:0.0003198086633346975
2023-05-02 20:44:15 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13959649205207825, mean p set: 0.4502691626548767
loss_pred:0.016903039067983627, decouple_loss:0.0003767830494325608
The modified gen p mean: 0.4495337903499603, gen p mean: -0.13285622000694275, mean p set: 0.4500633478164673
loss_pred:0.016181865707039833, decouple_loss:0.0005328137194737792
The modified gen p mean: 0.4498308002948761, gen p mean: -0.13203370571136475, mean p set: 0.45035696029663086
loss_pred:0.016406001523137093, decouple_loss:0.0005165034090168774
WV_1_PC_1_EH_0_PS_40, loss: 0.01652073860168457, avg_mse: 0.02585713192820549
current test mse: 0.025857
Iteration: 4391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973963499069214, gen p mean: -0.12541136145591736, mean p set: 0.45031604170799255
loss_pred:0.015039138495922089, decouple_loss:0.0008055627695284784
The modified gen p mean: 0.45348218083381653, gen p mean: -0.1248646080493927, mean p set: 0.45406150817871094The modified gen p mean: 0.45049136877059937, gen p mean: -0.13069979846477509, mean p set: 0.4510722756385803
loss_pred:0.014336492866277695, decouple_loss:0.000476192421047017loss_pred:0.014299983158707619, decouple_loss:0.0004780791059602052
Iteration: 4392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44940558075904846, gen p mean: -0.12826545536518097, mean p set: 0.4499790072441101
loss_pred:0.014989200979471207, decouple_loss:0.0006807230529375374
The modified gen p mean: 0.449593186378479, gen p mean: -0.12389208376407623, mean p set: 0.4501686692237854The modified gen p mean: 0.4492416977882385, gen p mean: -0.1329500675201416, mean p set: 0.44981902837753296
loss_pred:0.014810380525887012, decouple_loss:0.000595014775171876loss_pred:0.014563123695552349, decouple_loss:0.00046224246034398675
Iteration: 4393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45051002502441406, gen p mean: -0.1311095803976059, mean p set: 0.4510878920555115
loss_pred:0.015302280895411968, decouple_loss:0.0004247408651281148
The modified gen p mean: 0.44913914799690247, gen p mean: -0.1301727592945099, mean p set: 0.4497148096561432
loss_pred:0.014495531097054482, decouple_loss:0.00044473979505710304
The modified gen p mean: 0.4516211748123169, gen p mean: -0.12328395247459412, mean p set: 0.45219725370407104
loss_pred:0.014205126091837883, decouple_loss:0.00047435882152058184
Iteration: 4394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452949196100235, gen p mean: -0.1270158588886261, mean p set: 0.45352625846862793
loss_pred:0.01464482769370079, decouple_loss:0.0006048628711141646
The modified gen p mean: 0.4500325620174408, gen p mean: -0.1365949958562851, mean p set: 0.4506070911884308
loss_pred:0.01501183956861496, decouple_loss:0.0005244679632596672
The modified gen p mean: 0.448829710483551, gen p mean: -0.13468234241008759, mean p set: 0.4494048058986664
loss_pred:0.013865021988749504, decouple_loss:0.0003799415426328778
Iteration: 4395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484652578830719, gen p mean: -0.13387204706668854, mean p set: 0.44903984665870667
loss_pred:0.014904945157468319, decouple_loss:0.0005411860765889287
The modified gen p mean: 0.4506089687347412, gen p mean: -0.1274448186159134, mean p set: 0.4511836767196655
loss_pred:0.015555220656096935, decouple_loss:0.0005413737380877137
The modified gen p mean: 0.449248343706131, gen p mean: -0.1261577308177948, mean p set: 0.44982537627220154
loss_pred:0.01506245881319046, decouple_loss:0.00038818141911178827
Iteration: 4396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962501525878906, gen p mean: -0.12709657847881317, mean p set: 0.45020267367362976
loss_pred:0.015313317999243736, decouple_loss:0.0005323697114363313
The modified gen p mean: 0.449714720249176, gen p mean: -0.12895193696022034, mean p set: 0.4502916932106018
loss_pred:0.015153177082538605, decouple_loss:0.00043377382098697126
The modified gen p mean: 0.4490870535373688, gen p mean: -0.12550611793994904, mean p set: 0.44966429471969604
loss_pred:0.015147325582802296, decouple_loss:0.0004993631737306714
Iteration: 4397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524679183959961, gen p mean: -0.12279683351516724, mean p set: 0.45304545760154724
loss_pred:0.014596019871532917, decouple_loss:0.00040861970046535134
The modified gen p mean: 0.45288142561912537, gen p mean: -0.12012595683336258, mean p set: 0.4534589648246765
loss_pred:0.014699278399348259, decouple_loss:0.0004222777206450701
The modified gen p mean: 0.45306792855262756, gen p mean: -0.11900834739208221, mean p set: 0.45364704728126526
loss_pred:0.01437424961477518, decouple_loss:0.00043606036342680454
Iteration: 4398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522598385810852, gen p mean: -0.11878743767738342, mean p set: 0.4528343677520752
loss_pred:0.014343191869556904, decouple_loss:0.00031570231658406556
The modified gen p mean: 0.45003581047058105, gen p mean: -0.12084874510765076, mean p set: 0.45061424374580383
loss_pred:0.014564125798642635, decouple_loss:0.0003660662623587996
The modified gen p mean: 0.4487417936325073, gen p mean: -0.12563714385032654, mean p set: 0.4493206739425659
loss_pred:0.014173231087625027, decouple_loss:0.0004124198167119175
Iteration: 4399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496089220046997, gen p mean: -0.12410616129636765, mean p set: 0.45018163323402405
loss_pred:0.014800501987338066, decouple_loss:0.00034384947502985597
The modified gen p mean: 0.44859930872917175, gen p mean: -0.12764833867549896, mean p set: 0.44917213916778564
loss_pred:0.01410282775759697, decouple_loss:0.00029573027859441936
The modified gen p mean: 0.44970864057540894, gen p mean: -0.12341689318418503, mean p set: 0.45028528571128845
loss_pred:0.014282339252531528, decouple_loss:0.00048605180927552283
Iteration: 4400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499806761741638, gen p mean: -0.12304102629423141, mean p set: 0.4505581855773926
loss_pred:0.014957723207771778, decouple_loss:0.00043667672434821725
The modified gen p mean: 0.44988173246383667, gen p mean: -0.12204929441213608, mean p set: 0.45045459270477295
The modified gen p mean: 0.4529016613960266, gen p mean: -0.1222216859459877, mean p set: 0.4534813165664673
loss_pred:0.01403852179646492, decouple_loss:0.0004089456342626363
loss_pred:0.015140311792492867, decouple_loss:0.0006011531804688275
2023-05-02 20:46:22 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13554276525974274, mean p set: 0.4502691626548767
loss_pred:0.016852691769599915, decouple_loss:0.0006110832327976823
The modified gen p mean: 0.44953563809394836, gen p mean: -0.12872008979320526, mean p set: 0.4500633478164673
loss_pred:0.01616610959172249, decouple_loss:0.0005644162301905453
The modified gen p mean: 0.4498320519924164, gen p mean: -0.1277000904083252, mean p set: 0.45035696029663086
loss_pred:0.016422675922513008, decouple_loss:0.0004635354853235185
WV_1_PC_1_EH_0_PS_40, loss: 0.016507809981703758, avg_mse: 0.02585403434932232
current test mse: 0.025854
Iteration: 4401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471687078475952, gen p mean: -0.12994353473186493, mean p set: 0.4477446675300598
loss_pred:0.01437348686158657, decouple_loss:0.0004244532319717109
The modified gen p mean: 0.4494423270225525, gen p mean: -0.1181424930691719, mean p set: 0.4500192403793335The modified gen p mean: 0.4527234137058258, gen p mean: -0.11815176159143448, mean p set: 0.45330190658569336
loss_pred:0.014796612784266472, decouple_loss:0.0003667517739813775loss_pred:0.01442607119679451, decouple_loss:0.0006805978482589126
Iteration: 4402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45264193415641785, gen p mean: -0.12148285657167435, mean p set: 0.4532198905944824
loss_pred:0.01504530105739832, decouple_loss:0.0003713543701451272
The modified gen p mean: 0.44880715012550354, gen p mean: -0.12826938927173615, mean p set: 0.4493838846683502The modified gen p mean: 0.44975367188453674, gen p mean: -0.12349800765514374, mean p set: 0.4503326416015625
loss_pred:0.015199054963886738, decouple_loss:0.00035824879887513816
loss_pred:0.015608210116624832, decouple_loss:0.0004906537942588329
Iteration: 4403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45132976770401, gen p mean: -0.1222129613161087, mean p set: 0.451905757188797
loss_pred:0.014467883855104446, decouple_loss:0.0004539930378086865
The modified gen p mean: 0.45012807846069336, gen p mean: -0.11748809367418289, mean p set: 0.4507025480270386The modified gen p mean: 0.44966450333595276, gen p mean: -0.12479144334793091, mean p set: 0.4502440094947815
loss_pred:0.015232131816446781, decouple_loss:0.0004239958943799138
loss_pred:0.015413072891533375, decouple_loss:0.00043149793054908514
Iteration: 4404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510957896709442, gen p mean: -0.12087470293045044, mean p set: 0.4516725242137909
loss_pred:0.015214117243885994, decouple_loss:0.0004539001383818686
The modified gen p mean: 0.44998639822006226, gen p mean: -0.11821122467517853, mean p set: 0.4505661725997925
loss_pred:0.01418006606400013, decouple_loss:0.0004483133088797331
The modified gen p mean: 0.4526192843914032, gen p mean: -0.11518312990665436, mean p set: 0.4531964957714081
loss_pred:0.01464708149433136, decouple_loss:0.000728089245967567
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 4405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44985902309417725, gen p mean: -0.11648926138877869, mean p set: 0.4504365622997284
The modified gen p mean: 0.44681861996650696, gen p mean: -0.11777529120445251, mean p set: 0.447394996881485
loss_pred:0.0134048480540514, decouple_loss:0.0005142992013134062
loss_pred:0.014162331819534302, decouple_loss:0.00037611808511428535
The modified gen p mean: 0.4486302435398102, gen p mean: -0.12382656335830688, mean p set: 0.44920656085014343
loss_pred:0.014399939216673374, decouple_loss:0.00045110899372957647
Iteration: 4406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44659990072250366, gen p mean: -0.12662014365196228, mean p set: 0.447174608707428
loss_pred:0.014678515493869781, decouple_loss:0.00035517895594239235
The modified gen p mean: 0.44965967535972595, gen p mean: -0.11174974590539932, mean p set: 0.4502353370189667
loss_pred:0.013761618174612522, decouple_loss:0.00031180563382804394
The modified gen p mean: 0.4483061730861664, gen p mean: -0.1191273108124733, mean p set: 0.4488815367221832
loss_pred:0.015231974422931671, decouple_loss:0.0004078441415913403
Iteration: 4407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474599063396454, gen p mean: -0.11720994859933853, mean p set: 0.44803765416145325
loss_pred:0.014360525645315647, decouple_loss:0.00043591309804469347
The modified gen p mean: 0.4515604078769684, gen p mean: -0.1178756132721901, mean p set: 0.4521370232105255
loss_pred:0.014050286263227463, decouple_loss:0.0004338109865784645
The modified gen p mean: 0.4475640058517456, gen p mean: -0.11611032485961914, mean p set: 0.44814345240592957
loss_pred:0.014800197444856167, decouple_loss:0.0004444123769644648
Iteration: 4408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466931223869324, gen p mean: -0.12447591125965118, mean p set: 0.4472704529762268
loss_pred:0.014296584762632847, decouple_loss:0.0003146591770928353
The modified gen p mean: 0.44875311851501465, gen p mean: -0.12506312131881714, mean p set: 0.4493279755115509
loss_pred:0.013296287506818771, decouple_loss:0.0005345726967789233
The modified gen p mean: 0.44879597425460815, gen p mean: -0.1263904869556427, mean p set: 0.4493709206581116
loss_pred:0.014317922294139862, decouple_loss:0.00041061948286369443
Iteration: 4409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480948746204376, gen p mean: -0.13319766521453857, mean p set: 0.44867387413978577
loss_pred:0.014198300428688526, decouple_loss:0.00037859988515265286
The modified gen p mean: 0.4490653872489929, gen p mean: -0.13003505766391754, mean p set: 0.4496400058269501
loss_pred:0.013824882917106152, decouple_loss:0.0005413732142187655
The modified gen p mean: 0.44852903485298157, gen p mean: -0.12852078676223755, mean p set: 0.44910797476768494
loss_pred:0.013613911345601082, decouple_loss:0.000444448203779757
Iteration: 4410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925984740257263, gen p mean: -0.12947550415992737, mean p set: 0.4498351216316223
loss_pred:0.013825185596942902, decouple_loss:0.0004047245311085135
The modified gen p mean: 0.4478861391544342, gen p mean: -0.12849587202072144, mean p set: 0.44846272468566895
loss_pred:0.013123827986419201, decouple_loss:0.000355865980964154
The modified gen p mean: 0.44965890049934387, gen p mean: -0.13509225845336914, mean p set: 0.45023879408836365
loss_pred:0.01436514314264059, decouple_loss:0.0004305325273890048
2023-05-02 20:49:09 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.14083236455917358, mean p set: 0.4502691626548767
loss_pred:0.016828201711177826, decouple_loss:0.00040218859794549644
The modified gen p mean: 0.449533611536026, gen p mean: -0.13392305374145508, mean p set: 0.4500633478164673
loss_pred:0.016121791675686836, decouple_loss:0.00046651254524476826
The modified gen p mean: 0.44982436299324036, gen p mean: -0.13297802209854126, mean p set: 0.45035696029663086
loss_pred:0.016356976702809334, decouple_loss:0.00037816111580468714
WV_1_PC_1_EH_0_PS_40, loss: 0.01645643822848797, avg_mse: 0.025775793939828873
current test mse: 0.025776
Iteration: 4411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485302269458771, gen p mean: -0.12874452769756317, mean p set: 0.44910773634910583
loss_pred:0.013505139388144016, decouple_loss:0.00032105110585689545
The modified gen p mean: 0.44717323780059814, gen p mean: -0.12900808453559875, mean p set: 0.447748064994812The modified gen p mean: 0.4489772319793701, gen p mean: -0.12511597573757172, mean p set: 0.449554443359375
loss_pred:0.01402684673666954, decouple_loss:0.0002897105587180704
loss_pred:0.01394239254295826, decouple_loss:0.0003955953288823366
Iteration: 4412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447858065366745, gen p mean: -0.13502806425094604, mean p set: 0.44843384623527527
loss_pred:0.01419680193066597, decouple_loss:0.0006256034248508513
The modified gen p mean: 0.4472545087337494, gen p mean: -0.12940289080142975, mean p set: 0.44782793521881104The modified gen p mean: 0.4473286271095276, gen p mean: -0.1385539174079895, mean p set: 0.4479064643383026
loss_pred:0.014573042280972004, decouple_loss:0.00031697703525424004
loss_pred:0.014170253649353981, decouple_loss:0.00039441813714802265
Iteration: 4413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801995158195496, gen p mean: -0.13140268623828888, mean p set: 0.44859644770622253
loss_pred:0.014030282385647297, decouple_loss:0.0003626741236075759
The modified gen p mean: 0.45009711384773254, gen p mean: -0.12573839724063873, mean p set: 0.45067334175109863
loss_pred:0.013566304929554462, decouple_loss:0.0004322682216297835
The modified gen p mean: 0.44732001423835754, gen p mean: -0.12995193898677826, mean p set: 0.4478965699672699
loss_pred:0.0142592778429389, decouple_loss:0.00044493633322417736
Iteration: 4414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482806622982025, gen p mean: -0.12981431186199188, mean p set: 0.44885799288749695
loss_pred:0.013817274942994118, decouple_loss:0.00030835549114272
The modified gen p mean: 0.4488081634044647, gen p mean: -0.12420009821653366, mean p set: 0.4493841528892517
loss_pred:0.014051778241991997, decouple_loss:0.0003024846955668181
The modified gen p mean: 0.44797956943511963, gen p mean: -0.12525257468223572, mean p set: 0.4485572874546051
loss_pred:0.014297938905656338, decouple_loss:0.00046664293040521443
Iteration: 4415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506551921367645, gen p mean: -0.12347707897424698, mean p set: 0.45123034715652466
loss_pred:0.013534881174564362, decouple_loss:0.00039592167013324797
The modified gen p mean: 0.4471603035926819, gen p mean: -0.11936318129301071, mean p set: 0.4477371871471405
loss_pred:0.014102923683822155, decouple_loss:0.0002859060768969357
The modified gen p mean: 0.4499407112598419, gen p mean: -0.12114798277616501, mean p set: 0.4505176842212677
loss_pred:0.01335055474191904, decouple_loss:0.00035579074756242335
Iteration: 4416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846391677856445, gen p mean: -0.12617596983909607, mean p set: 0.44904303550720215
loss_pred:0.014576001092791557, decouple_loss:0.0002873906632885337
The modified gen p mean: 0.44831985235214233, gen p mean: -0.12230397760868073, mean p set: 0.44889771938323975
loss_pred:0.014979944564402103, decouple_loss:0.00034367284388281405
The modified gen p mean: 0.4481024444103241, gen p mean: -0.13158604502677917, mean p set: 0.44867774844169617
loss_pred:0.014222296886146069, decouple_loss:0.00037450945819728076
Iteration: 4417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487094581127167, gen p mean: -0.11650779843330383, mean p set: 0.4492860734462738
loss_pred:0.013866553083062172, decouple_loss:0.0003425691102165729
The modified gen p mean: 0.44809940457344055, gen p mean: -0.12307322025299072, mean p set: 0.44867458939552307
loss_pred:0.014634456485509872, decouple_loss:0.0005089099868200719
The modified gen p mean: 0.4490295648574829, gen p mean: -0.13102152943611145, mean p set: 0.4496042728424072
loss_pred:0.012808491475880146, decouple_loss:0.0004045112000312656
Iteration: 4418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489845335483551, gen p mean: -0.12427432090044022, mean p set: 0.4495624303817749
loss_pred:0.013456026092171669, decouple_loss:0.0005000266246497631
The modified gen p mean: 0.44826939702033997, gen p mean: -0.1267952173948288, mean p set: 0.44884639978408813
loss_pred:0.0138896144926548, decouple_loss:0.00045441172551363707
The modified gen p mean: 0.4488440155982971, gen p mean: -0.12843631207942963, mean p set: 0.4494233727455139
loss_pred:0.01424894668161869, decouple_loss:0.00047547597205266356
Iteration: 4419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756263494491577, gen p mean: -0.126547709107399, mean p set: 0.4481402039527893
loss_pred:0.013968233950436115, decouple_loss:0.0003570032713469118
The modified gen p mean: 0.44775789976119995, gen p mean: -0.12582053244113922, mean p set: 0.44833314418792725
loss_pred:0.014479209668934345, decouple_loss:0.0003319603274576366
The modified gen p mean: 0.44717398285865784, gen p mean: -0.1284349113702774, mean p set: 0.4477499723434448
loss_pred:0.013936815783381462, decouple_loss:0.00039636314613744617
Iteration: 4420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447017639875412, gen p mean: -0.1369333565235138, mean p set: 0.4475933015346527
loss_pred:0.01425733882933855, decouple_loss:0.0004441144410520792
The modified gen p mean: 0.44733649492263794, gen p mean: -0.12391962856054306, mean p set: 0.4479128420352936
loss_pred:0.013816428370773792, decouple_loss:0.00041091107414104044
The modified gen p mean: 0.4486601650714874, gen p mean: -0.12955112755298615, mean p set: 0.44923779368400574
loss_pred:0.014261608012020588, decouple_loss:0.0004044619563501328
2023-05-02 20:51:15 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13775956630706787, mean p set: 0.4502691626548767
loss_pred:0.016758600249886513, decouple_loss:0.0003640554496087134
The modified gen p mean: 0.4495350122451782, gen p mean: -0.13131596148014069, mean p set: 0.4500633478164673
loss_pred:0.016005652025341988, decouple_loss:0.00031870653037913144
The modified gen p mean: 0.44982606172561646, gen p mean: -0.13025149703025818, mean p set: 0.45035696029663086
loss_pred:0.016312891617417336, decouple_loss:0.00033632523263804615
WV_1_PC_1_EH_0_PS_40, loss: 0.016376033425331116, avg_mse: 0.02568897418677807
current test mse: 0.025689
Iteration: 4421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472869336605072, gen p mean: -0.1279517412185669, mean p set: 0.44786569476127625
loss_pred:0.013727487064898014, decouple_loss:0.00040938498568721116
The modified gen p mean: 0.44829845428466797, gen p mean: -0.12920770049095154, mean p set: 0.44887375831604004The modified gen p mean: 0.44970500469207764, gen p mean: -0.13079528510570526, mean p set: 0.4502794146537781
loss_pred:0.013937398791313171, decouple_loss:0.000429789099143818
loss_pred:0.014727490022778511, decouple_loss:0.00036387881846167147
Iteration: 4422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476020336151123, gen p mean: -0.12611545622348785, mean p set: 0.4481779932975769
The modified gen p mean: 0.4488412141799927, gen p mean: -0.13709883391857147, mean p set: 0.4494149386882782
loss_pred:0.014670751988887787, decouple_loss:0.0003136851009912789
loss_pred:0.01415569894015789, decouple_loss:0.00036583570181392133
The modified gen p mean: 0.4474026560783386, gen p mean: -0.1328122317790985, mean p set: 0.4479774832725525
loss_pred:0.013621644116938114, decouple_loss:0.0002915706718340516
Iteration: 4423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962364435195923, gen p mean: -0.13858634233474731, mean p set: 0.45020073652267456
loss_pred:0.013194589875638485, decouple_loss:0.00033725021057762206
The modified gen p mean: 0.4477606415748596, gen p mean: -0.1332494616508484, mean p set: 0.4483363628387451
loss_pred:0.014205608516931534, decouple_loss:0.00039479712722823024
The modified gen p mean: 0.44859907031059265, gen p mean: -0.13042625784873962, mean p set: 0.449176549911499
loss_pred:0.01394228171557188, decouple_loss:0.00038537898217327893
Iteration: 4424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495121240615845, gen p mean: -0.13674181699752808, mean p set: 0.45009157061576843
loss_pred:0.013018058612942696, decouple_loss:0.0003394903033040464
The modified gen p mean: 0.44745251536369324, gen p mean: -0.12930160760879517, mean p set: 0.4480287730693817
loss_pred:0.014728112146258354, decouple_loss:0.00032604040461592376
The modified gen p mean: 0.4489095211029053, gen p mean: -0.13948465883731842, mean p set: 0.4494871497154236
loss_pred:0.01257916446775198, decouple_loss:0.00044892728328704834
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
NaN value num: 0
Iteration: 4425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449499249458313, gen p mean: -0.1306575983762741, mean p set: 0.4500750005245209
loss_pred:0.014643741771578789, decouple_loss:0.0004053320153616369
The modified gen p mean: 0.4494178295135498, gen p mean: -0.13180045783519745, mean p set: 0.4499933123588562
loss_pred:0.014302672818303108, decouple_loss:0.00040180401992984116
The modified gen p mean: 0.44988197088241577, gen p mean: -0.12570452690124512, mean p set: 0.45045775175094604
loss_pred:0.014245307072997093, decouple_loss:0.00034128662082366645
Iteration: 4426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44974157214164734, gen p mean: -0.12760159373283386, mean p set: 0.45031872391700745
loss_pred:0.01448084320873022, decouple_loss:0.00037897087167948484
The modified gen p mean: 0.44975563883781433, gen p mean: -0.1317564994096756, mean p set: 0.45033547282218933
loss_pred:0.014878230169415474, decouple_loss:0.0004093407478649169
The modified gen p mean: 0.44926074147224426, gen p mean: -0.12837661802768707, mean p set: 0.44983693957328796
loss_pred:0.014434686861932278, decouple_loss:0.0002652397088240832
Iteration: 4427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502667486667633, gen p mean: -0.12010014057159424, mean p set: 0.4508443772792816
loss_pred:0.014535008929669857, decouple_loss:0.0004345775814726949
The modified gen p mean: 0.44995421171188354, gen p mean: -0.12234080582857132, mean p set: 0.45053014159202576
loss_pred:0.014182470738887787, decouple_loss:0.0003483493346720934
The modified gen p mean: 0.44982442259788513, gen p mean: -0.12359577417373657, mean p set: 0.45040175318717957
loss_pred:0.014234136790037155, decouple_loss:0.0003407086187507957
Iteration: 4428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487995505332947, gen p mean: -0.12278691679239273, mean p set: 0.44937488436698914
loss_pred:0.014227555133402348, decouple_loss:0.00040638475911691785
The modified gen p mean: 0.4481455683708191, gen p mean: -0.11825460940599442, mean p set: 0.4487225413322449
loss_pred:0.01436032634228468, decouple_loss:0.0003013186505995691
The modified gen p mean: 0.44813454151153564, gen p mean: -0.11529593169689178, mean p set: 0.44870832562446594
loss_pred:0.014933872036635876, decouple_loss:0.0004016486927866936
Iteration: 4429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45007774233818054, gen p mean: -0.11862543225288391, mean p set: 0.4506531357765198
loss_pred:0.014602928422391415, decouple_loss:0.00034766545286402106
The modified gen p mean: 0.4504694640636444, gen p mean: -0.1231996938586235, mean p set: 0.45104461908340454
The modified gen p mean: 0.450123131275177, gen p mean: -0.12350571900606155, mean p set: 0.4507039785385132
loss_pred:0.014429649338126183, decouple_loss:0.00042913726065307856
loss_pred:0.014413180761039257, decouple_loss:0.00039016493246890604
Iteration: 4430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494718015193939, gen p mean: -0.12119200825691223, mean p set: 0.45005032420158386
loss_pred:0.013991129584610462, decouple_loss:0.0005619642906822264
The modified gen p mean: 0.44970712065696716, gen p mean: -0.11685249954462051, mean p set: 0.4502848982810974
The modified gen p mean: 0.44988739490509033, gen p mean: -0.11656427383422852, mean p set: 0.45046308636665344
loss_pred:0.01440126821398735, decouple_loss:0.0004410577239468694
loss_pred:0.014545300975441933, decouple_loss:0.0004550542216747999
2023-05-02 20:54:00 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1361372470855713, mean p set: 0.4502691626548767
loss_pred:0.016778672114014626, decouple_loss:0.00036505504976958036
The modified gen p mean: 0.44953736662864685, gen p mean: -0.12989383935928345, mean p set: 0.4500633478164673
loss_pred:0.016022320836782455, decouple_loss:0.0004338169237598777
The modified gen p mean: 0.44982877373695374, gen p mean: -0.12930108606815338, mean p set: 0.45035696029663086
loss_pred:0.01627202332019806, decouple_loss:0.0003827369073405862
WV_1_PC_1_EH_0_PS_40, loss: 0.016377365216612816, avg_mse: 0.025643834844231606
current test mse: 0.025644
Iteration: 4431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45066362619400024, gen p mean: -0.12499942630529404, mean p set: 0.4512398838996887
loss_pred:0.014791978523135185, decouple_loss:0.00040215696208178997
The modified gen p mean: 0.4510868191719055, gen p mean: -0.11914977431297302, mean p set: 0.451661616563797The modified gen p mean: 0.45009925961494446, gen p mean: -0.1261925995349884, mean p set: 0.45067667961120605
loss_pred:0.015009379014372826, decouple_loss:0.0004511336737778038
loss_pred:0.014072170481085777, decouple_loss:0.000358523684553802
Iteration: 4432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493057429790497, gen p mean: -0.1320912390947342, mean p set: 0.4498820900917053
loss_pred:0.014077537693083286, decouple_loss:0.0004902236396446824
The modified gen p mean: 0.4508327841758728, gen p mean: -0.12076177448034286, mean p set: 0.4514070451259613The modified gen p mean: 0.4502141773700714, gen p mean: -0.12818710505962372, mean p set: 0.45079106092453003
loss_pred:0.01503821462392807, decouple_loss:0.00047422427451238036
loss_pred:0.014152707532048225, decouple_loss:0.0003968211240135133
Iteration: 4433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45118072628974915, gen p mean: -0.12277606874704361, mean p set: 0.45175716280937195
loss_pred:0.014342540875077248, decouple_loss:0.00034297723323106766
The modified gen p mean: 0.4502406418323517, gen p mean: -0.12515857815742493, mean p set: 0.4508165121078491
loss_pred:0.01411454938352108, decouple_loss:0.0005655253771692514
The modified gen p mean: 0.44850587844848633, gen p mean: -0.13063696026802063, mean p set: 0.44908347725868225
loss_pred:0.014279300346970558, decouple_loss:0.0005137260886840522
Iteration: 4434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487380385398865, gen p mean: -0.1294221132993698, mean p set: 0.44931429624557495
loss_pred:0.015030496753752232, decouple_loss:0.00039569224463775754
The modified gen p mean: 0.4488788843154907, gen p mean: -0.1331218183040619, mean p set: 0.44945380091667175
loss_pred:0.014372394420206547, decouple_loss:0.00037724070716649294
The modified gen p mean: 0.4497692286968231, gen p mean: -0.13787201046943665, mean p set: 0.4503445625305176
loss_pred:0.014861258678138256, decouple_loss:0.0003824397863354534
Iteration: 4435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500499963760376, gen p mean: -0.12835560739040375, mean p set: 0.4506239891052246
loss_pred:0.014050609432160854, decouple_loss:0.0004902990185655653
The modified gen p mean: 0.4504159688949585, gen p mean: -0.12806640565395355, mean p set: 0.45099109411239624
loss_pred:0.014353281818330288, decouple_loss:0.0003245395782869309
The modified gen p mean: 0.45071613788604736, gen p mean: -0.12926483154296875, mean p set: 0.4512932300567627
loss_pred:0.01430846843868494, decouple_loss:0.0005551812355406582
Iteration: 4436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487971365451813, gen p mean: -0.12780539691448212, mean p set: 0.44937294721603394
loss_pred:0.014070779085159302, decouple_loss:0.0005155367543920875
The modified gen p mean: 0.45006901025772095, gen p mean: -0.12027940899133682, mean p set: 0.45064401626586914
loss_pred:0.014588691294193268, decouple_loss:0.0004909884883090854
The modified gen p mean: 0.4487314522266388, gen p mean: -0.1221093013882637, mean p set: 0.44931018352508545
loss_pred:0.014740780927240849, decouple_loss:0.0003951082471758127
Iteration: 4437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504024088382721, gen p mean: -0.12170110642910004, mean p set: 0.4509795904159546
loss_pred:0.014434232376515865, decouple_loss:0.00029329373501241207
The modified gen p mean: 0.4485205113887787, gen p mean: -0.12200088053941727, mean p set: 0.44909584522247314
loss_pred:0.014111172407865524, decouple_loss:0.00030650015105493367
The modified gen p mean: 0.44988903403282166, gen p mean: -0.12237540632486343, mean p set: 0.4504653811454773
loss_pred:0.014264331199228764, decouple_loss:0.00027167933876626194
Iteration: 4438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44826045632362366, gen p mean: -0.11776917427778244, mean p set: 0.4488380551338196
loss_pred:0.01408115029335022, decouple_loss:0.0003319203096907586
The modified gen p mean: 0.45071521401405334, gen p mean: -0.11648432165384293, mean p set: 0.4512903094291687
loss_pred:0.01425916701555252, decouple_loss:0.00038295023841783404
The modified gen p mean: 0.44978344440460205, gen p mean: -0.12331437319517136, mean p set: 0.4503578245639801
loss_pred:0.014974136836826801, decouple_loss:0.0005247321678325534
Iteration: 4439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450937956571579, gen p mean: -0.1147555336356163, mean p set: 0.45151427388191223
loss_pred:0.0146635128185153, decouple_loss:0.0006285320851020515
The modified gen p mean: 0.4510846436023712, gen p mean: -0.1163257285952568, mean p set: 0.4516618549823761
The modified gen p mean: 0.44891631603240967, gen p mean: -0.11933094263076782, mean p set: 0.449493408203125
loss_pred:0.014310265891253948, decouple_loss:0.0005061636329628527
loss_pred:0.014614971354603767, decouple_loss:0.0005686614895239472
Iteration: 4440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501791298389435, gen p mean: -0.11289555579423904, mean p set: 0.4507562518119812
loss_pred:0.014637399464845657, decouple_loss:0.0004435488663148135
The modified gen p mean: 0.4500415623188019, gen p mean: -0.11784520745277405, mean p set: 0.45061951875686646
loss_pred:0.014286014251410961, decouple_loss:0.0003469620714895427
The modified gen p mean: 0.4507424831390381, gen p mean: -0.11365557461977005, mean p set: 0.4513188898563385
loss_pred:0.014514727517962456, decouple_loss:0.0004110760346520692
2023-05-02 20:56:07 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1304481327533722, mean p set: 0.4502691626548767
loss_pred:0.01683926396071911, decouple_loss:0.0004990171291865408
The modified gen p mean: 0.4495370090007782, gen p mean: -0.12451927363872528, mean p set: 0.4500633478164673
loss_pred:0.016055306419730186, decouple_loss:0.00041492286254651845
The modified gen p mean: 0.4498274624347687, gen p mean: -0.12365264445543289, mean p set: 0.45035696029663086
loss_pred:0.01634145714342594, decouple_loss:0.0003794553631450981
WV_1_PC_1_EH_0_PS_40, loss: 0.016433564946055412, avg_mse: 0.025746487081050873
current test mse: 0.025746
Iteration: 4441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876980781555176, gen p mean: -0.1235504075884819, mean p set: 0.4493492543697357
loss_pred:0.014705528505146503, decouple_loss:0.00038481736555695534
The modified gen p mean: 0.45085084438323975, gen p mean: -0.11226128041744232, mean p set: 0.4514269232749939
loss_pred:0.01501437183469534, decouple_loss:0.0004681020509451628
The modified gen p mean: 0.4493617117404938, gen p mean: -0.12125933915376663, mean p set: 0.44993993639945984
loss_pred:0.015349830500781536, decouple_loss:0.0004323356261011213
Iteration: 4442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44850218296051025, gen p mean: -0.12186253070831299, mean p set: 0.4490794241428375
loss_pred:0.01451856829226017, decouple_loss:0.0004965715343132615
The modified gen p mean: 0.4484233260154724, gen p mean: -0.11781743913888931, mean p set: 0.4490005075931549The modified gen p mean: 0.45001593232154846, gen p mean: -0.1173713356256485, mean p set: 0.4505939483642578
loss_pred:0.014256964437663555, decouple_loss:0.0004278919077478349
loss_pred:0.014420048333704472, decouple_loss:0.000508319993969053
Iteration: 4443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45005321502685547, gen p mean: -0.12152759730815887, mean p set: 0.4506286382675171
loss_pred:0.014031732454895973, decouple_loss:0.0006447259802371264
The modified gen p mean: 0.4500974416732788, gen p mean: -0.12108366191387177, mean p set: 0.45067429542541504
loss_pred:0.014202535152435303, decouple_loss:0.000717443588655442
The modified gen p mean: 0.4502406418323517, gen p mean: -0.11976628005504608, mean p set: 0.45081597566604614
loss_pred:0.01466366183012724, decouple_loss:0.0005860019591636956
Iteration: 4444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485090970993042, gen p mean: -0.12348771095275879, mean p set: 0.44908758997917175The modified gen p mean: 0.44819214940071106, gen p mean: -0.1236938089132309, mean p set: 0.4487698972225189
loss_pred:0.014776026830077171, decouple_loss:0.0003934047417715192
loss_pred:0.014392532408237457, decouple_loss:0.0004726442857645452
The modified gen p mean: 0.4500071108341217, gen p mean: -0.12494172900915146, mean p set: 0.45058220624923706
loss_pred:0.014280576258897781, decouple_loss:0.0003738570085261017
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
NaN value num: 0
Iteration: 4445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010754466056824, gen p mean: -0.12349983304738998, mean p set: 0.4506807327270508
loss_pred:0.014348285272717476, decouple_loss:0.0003577263851184398
The modified gen p mean: 0.4478393495082855, gen p mean: -0.1306985765695572, mean p set: 0.44841381907463074
loss_pred:0.014418348670005798, decouple_loss:0.0005757845938205719
The modified gen p mean: 0.4503561854362488, gen p mean: -0.12381765991449356, mean p set: 0.45093685388565063
loss_pred:0.014985951595008373, decouple_loss:0.0003764349385164678
Iteration: 4446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496854543685913, gen p mean: -0.12879256904125214, mean p set: 0.45026326179504395
loss_pred:0.014722066931426525, decouple_loss:0.0005310506676323712
The modified gen p mean: 0.44995343685150146, gen p mean: -0.12819352746009827, mean p set: 0.4505334198474884
The modified gen p mean: 0.450513631105423, gen p mean: -0.12722358107566833, mean p set: 0.4510902166366577
loss_pred:0.014606957323849201, decouple_loss:0.0007419027970172465
loss_pred:0.01421293243765831, decouple_loss:0.000575375568587333
Iteration: 4447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510001540184021, gen p mean: -0.12859036028385162, mean p set: 0.45157620310783386
loss_pred:0.01453997753560543, decouple_loss:0.00040422173333354294
The modified gen p mean: 0.4503649175167084, gen p mean: -0.13217376172542572, mean p set: 0.4509415924549103
loss_pred:0.014263644814491272, decouple_loss:0.00039972085505723953
The modified gen p mean: 0.4515908360481262, gen p mean: -0.13472279906272888, mean p set: 0.4521687626838684
loss_pred:0.014800737611949444, decouple_loss:0.0005498971440829337
Iteration: 4448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496455788612366, gen p mean: -0.1277214139699936, mean p set: 0.4502235949039459
loss_pred:0.014569011516869068, decouple_loss:0.000415291462559253
The modified gen p mean: 0.44970008730888367, gen p mean: -0.12881064414978027, mean p set: 0.45027294754981995
loss_pred:0.014834599569439888, decouple_loss:0.0004321166197769344
The modified gen p mean: 0.4512963891029358, gen p mean: -0.1306736320257187, mean p set: 0.45187318325042725
