/scratch/09012/haoli1/ERA5/dataset/era5_train_01012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
train_data_files nums: 125
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477747082710266, gen p mean: 0.00014674586418550462, mean p set: 0.4483511745929718
loss_pred:0.16805243492126465, decouple_loss:0.06531131267547607
The modified gen p mean: 0.4460287392139435, gen p mean: -6.114914867794141e-05, mean p set: 0.44660380482673645
loss_pred:0.1583823710680008, decouple_loss:0.06675942987203598
The modified gen p mean: 0.44765588641166687, gen p mean: 0.00012766881263814867, mean p set: 0.4482308626174927
loss_pred:0.17094357311725616, decouple_loss:0.06544418632984161
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44704049825668335, gen p mean: -0.0013229968026280403, mean p set: 0.44761648774147034
loss_pred:0.17704562842845917, decouple_loss:0.2032182812690735
The modified gen p mean: 0.4472883939743042, gen p mean: -0.0014169893693178892, mean p set: 0.4478645324707031
loss_pred:0.17655766010284424, decouple_loss:0.20051831007003784
The modified gen p mean: 0.44798004627227783, gen p mean: -0.0013593800831586123, mean p set: 0.44855615496635437
loss_pred:0.17308127880096436, decouple_loss:0.20565833151340485
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464852809906006, gen p mean: 0.00039234006544575095, mean p set: 0.44706112146377563
The modified gen p mean: 0.44770678877830505, gen p mean: 0.00040429600630886853, mean p set: 0.44828295707702637
loss_pred:0.16187874972820282, decouple_loss:0.29410383105278015
loss_pred:0.1680591106414795, decouple_loss:0.2977965772151947
The modified gen p mean: 0.4489131271839142, gen p mean: 0.0004221718409098685, mean p set: 0.4494889974594116
loss_pred:0.1613798439502716, decouple_loss:0.2967571020126343
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474485516548157, gen p mean: -0.0008182573947124183, mean p set: 0.4480248689651489
loss_pred:0.15249542891979218, decouple_loss:0.4617758095264435
The modified gen p mean: 0.44703754782676697, gen p mean: -0.0008878681692294776, mean p set: 0.4476131498813629
loss_pred:0.15749754011631012, decouple_loss:0.4588160812854767
The modified gen p mean: 0.44671905040740967, gen p mean: -0.0008980431593954563, mean p set: 0.4472944438457489
loss_pred:0.15219713747501373, decouple_loss:0.457125723361969
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819176197052, gen p mean: -0.00025915875448845327, mean p set: 0.4487678110599518
loss_pred:0.1402958184480667, decouple_loss:0.44091448187828064
The modified gen p mean: 0.44735315442085266, gen p mean: -0.00030069155036471784, mean p set: 0.4479289650917053
loss_pred:0.1464952975511551, decouple_loss:0.4401947855949402
The modified gen p mean: 0.4481251835823059, gen p mean: -0.0002556346298661083, mean p set: 0.44870179891586304
loss_pred:0.1348891407251358, decouple_loss:0.43899857997894287
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724521040916443, gen p mean: -0.003182546701282263, mean p set: 0.4478210508823395
loss_pred:0.14103011786937714, decouple_loss:0.32945576310157776
The modified gen p mean: 0.4480706453323364, gen p mean: -0.0033600570168346167, mean p set: 0.4486466944217682
loss_pred:0.13439618051052094, decouple_loss:0.33151692152023315
The modified gen p mean: 0.4482422471046448, gen p mean: -0.003185626585036516, mean p set: 0.4488186836242676
loss_pred:0.14458200335502625, decouple_loss:0.3255767226219177
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482859969139099, gen p mean: -0.001417502062395215, mean p set: 0.4488621652126312
loss_pred:0.13935835659503937, decouple_loss:0.46587786078453064
The modified gen p mean: 0.4475739598274231, gen p mean: -0.001398685504682362, mean p set: 0.44814959168434143
loss_pred:0.13326849043369293, decouple_loss:0.4705451726913452
The modified gen p mean: 0.4473308324813843, gen p mean: -0.0013760917354375124, mean p set: 0.4479069411754608
loss_pred:0.13927778601646423, decouple_loss:0.4708411395549774
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44712620973587036, gen p mean: -0.002063919324427843, mean p set: 0.44770246744155884
loss_pred:0.132638618350029, decouple_loss:0.4254431426525116
The modified gen p mean: 0.4481695890426636, gen p mean: -0.0020640576258301735, mean p set: 0.4487457573413849
loss_pred:0.1307757943868637, decouple_loss:0.42403939366340637
The modified gen p mean: 0.44703298807144165, gen p mean: -0.002039831131696701, mean p set: 0.44760891795158386
loss_pred:0.12288039177656174, decouple_loss:0.42730197310447693
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744494557380676, gen p mean: -0.0008162300800904632, mean p set: 0.44802039861679077
loss_pred:0.13178229331970215, decouple_loss:0.34014344215393066
The modified gen p mean: 0.4475628137588501, gen p mean: -0.0008042491972446442, mean p set: 0.4481387734413147
loss_pred:0.13872475922107697, decouple_loss:0.33496275544166565
The modified gen p mean: 0.44685134291648865, gen p mean: -0.0007926019607111812, mean p set: 0.44742754101753235
loss_pred:0.13958042860031128, decouple_loss:0.3321394920349121
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735315442085266, gen p mean: -0.0010839286260306835, mean p set: 0.44792893528938293
loss_pred:0.1333521157503128, decouple_loss:0.29048529267311096
The modified gen p mean: 0.4466046094894409, gen p mean: -0.0010786275379359722, mean p set: 0.4471800923347473
loss_pred:0.13178467750549316, decouple_loss:0.29223620891571045
The modified gen p mean: 0.44764086604118347, gen p mean: -0.0010935683967545629, mean p set: 0.44821682572364807
loss_pred:0.12840288877487183, decouple_loss:0.2907807230949402
2023-05-06 18:41:35 testing...
The modified gen p mean: 0.44948726892471313, gen p mean: -0.0011789518175646663, mean p set: 0.4500633478164673
loss_pred:0.12807098031044006, decouple_loss:0.2940625250339508
The modified gen p mean: 0.44978058338165283, gen p mean: -0.0012037955457344651, mean p set: 0.45035696029663086
loss_pred:0.12992097437381744, decouple_loss:0.2938973307609558
The modified gen p mean: 0.44974079728126526, gen p mean: -0.0011654814006760716, mean p set: 0.4502691626548767
loss_pred:0.13201896846294403, decouple_loss:0.2938881516456604
WV_1_PC_1_EH_0_PS_40_6, loss: 0.14470110833644867, avg_mse: 0.12768112123012543
current test mse: 0.127681
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881314039230347, gen p mean: -0.0011983962031081319, mean p set: 0.4493890404701233
The modified gen p mean: 0.448466032743454, gen p mean: -0.0011832733871415257, mean p set: 0.44904205203056335
loss_pred:0.12547984719276428, decouple_loss:0.2903231680393219
loss_pred:0.13465023040771484, decouple_loss:0.2916853725910187
The modified gen p mean: 0.44746747612953186, gen p mean: -0.0011886563152074814, mean p set: 0.4480433166027069
loss_pred:0.13175874948501587, decouple_loss:0.29075589776039124
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474322497844696, gen p mean: -0.0018361281836405396, mean p set: 0.4480080008506775
loss_pred:0.13255786895751953, decouple_loss:0.2541350722312927
The modified gen p mean: 0.44717174768447876, gen p mean: -0.0018370919860899448, mean p set: 0.4477475583553314
loss_pred:0.12627536058425903, decouple_loss:0.24844056367874146
The modified gen p mean: 0.44674262404441833, gen p mean: -0.0018117375439032912, mean p set: 0.44731831550598145
loss_pred:0.11857222020626068, decouple_loss:0.25477710366249084
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471655488014221, gen p mean: -0.0022168047726154327, mean p set: 0.4477413594722748
loss_pred:0.128218412399292, decouple_loss:0.2345973253250122
The modified gen p mean: 0.4477105140686035, gen p mean: -0.0021900306455790997, mean p set: 0.4482864737510681
loss_pred:0.12799027562141418, decouple_loss:0.23462091386318207
The modified gen p mean: 0.4487510025501251, gen p mean: -0.0022463847417384386, mean p set: 0.4493274986743927
loss_pred:0.1340884119272232, decouple_loss:0.23500658571720123
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447663277387619, gen p mean: -0.003910819999873638, mean p set: 0.44823944568634033
loss_pred:0.12860597670078278, decouple_loss:0.2020706832408905
The modified gen p mean: 0.4476490318775177, gen p mean: -0.0038294789846986532, mean p set: 0.4482249617576599
loss_pred:0.13054585456848145, decouple_loss:0.20633257925510406
The modified gen p mean: 0.4472484290599823, gen p mean: -0.003836019430309534, mean p set: 0.4478244483470917
loss_pred:0.13167063891887665, decouple_loss:0.20284460484981537
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696834683418274, gen p mean: -0.003926402423530817, mean p set: 0.44754406809806824
loss_pred:0.1333126723766327, decouple_loss:0.21229946613311768
The modified gen p mean: 0.4476641118526459, gen p mean: -0.003913153428584337, mean p set: 0.4482399523258209
loss_pred:0.1284579485654831, decouple_loss:0.2121770679950714
The modified gen p mean: 0.44820138812065125, gen p mean: -0.003916848450899124, mean p set: 0.44877755641937256
loss_pred:0.12442553788423538, decouple_loss:0.21207460761070251
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474928677082062, gen p mean: -0.005166354589164257, mean p set: 0.44806867837905884
loss_pred:0.1285821944475174, decouple_loss:0.21692702174186707
The modified gen p mean: 0.4475160241127014, gen p mean: -0.005050892475992441, mean p set: 0.4480917155742645
loss_pred:0.12444519996643066, decouple_loss:0.22092916071414948
The modified gen p mean: 0.4482143223285675, gen p mean: -0.005195474252104759, mean p set: 0.44879069924354553
loss_pred:0.12424933165311813, decouple_loss:0.2166380137205124
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714242219924927, gen p mean: -0.008416706696152687, mean p set: 0.44771865010261536
loss_pred:0.12839198112487793, decouple_loss:0.1964682936668396
The modified gen p mean: 0.4468745291233063, gen p mean: -0.008100034669041634, mean p set: 0.44745007157325745
loss_pred:0.1263628751039505, decouple_loss:0.19814258813858032
The modified gen p mean: 0.447785347700119, gen p mean: -0.008264790289103985, mean p set: 0.4483618438243866
loss_pred:0.11057694256305695, decouple_loss:0.2033095359802246
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716987013816833, gen p mean: -0.007308122236281633, mean p set: 0.4477456510066986
loss_pred:0.12076609581708908, decouple_loss:0.18242990970611572
The modified gen p mean: 0.44774314761161804, gen p mean: -0.007147500291466713, mean p set: 0.44831904768943787
loss_pred:0.12624357640743256, decouple_loss:0.17820537090301514
The modified gen p mean: 0.4476325809955597, gen p mean: -0.007001325022429228, mean p set: 0.4482089579105377
loss_pred:0.11876892298460007, decouple_loss:0.18593640625476837
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44607746601104736, gen p mean: -0.009176606312394142, mean p set: 0.44665300846099854
loss_pred:0.11445152014493942, decouple_loss:0.16414423286914825
The modified gen p mean: 0.44726458191871643, gen p mean: -0.009218050166964531, mean p set: 0.4478406012058258
loss_pred:0.12106503546237946, decouple_loss:0.16344349086284637
The modified gen p mean: 0.4486345946788788, gen p mean: -0.00922668818384409, mean p set: 0.4492107927799225
loss_pred:0.1170894131064415, decouple_loss:0.16351090371608734
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788461923599243, gen p mean: -0.010381625033915043, mean p set: 0.44846081733703613
loss_pred:0.12265577167272568, decouple_loss:0.15351271629333496
The modified gen p mean: 0.4472777247428894, gen p mean: -0.010511843487620354, mean p set: 0.44785353541374207
loss_pred:0.114860400557518, decouple_loss:0.15454617142677307
The modified gen p mean: 0.4476161599159241, gen p mean: -0.010801142081618309, mean p set: 0.44819164276123047
loss_pred:0.11789989471435547, decouple_loss:0.1595548391342163
2023-05-06 18:45:33 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.0133156543597579, mean p set: 0.4502691626548767
loss_pred:0.11680828034877777, decouple_loss:0.17155718803405762
The modified gen p mean: 0.44948679208755493, gen p mean: -0.013563539832830429, mean p set: 0.4500633478164673
loss_pred:0.11345145106315613, decouple_loss:0.16990259289741516
The modified gen p mean: 0.44978082180023193, gen p mean: -0.013725223019719124, mean p set: 0.45035696029663086
loss_pred:0.11512100696563721, decouple_loss:0.17250436544418335
WV_1_PC_1_EH_0_PS_40_6, loss: 0.12369298189878464, avg_mse: 0.11286105215549469
current test mse: 0.112861
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475758969783783, gen p mean: -0.013514931313693523, mean p set: 0.448152095079422
The modified gen p mean: 0.4462999999523163, gen p mean: -0.01408317405730486, mean p set: 0.4468752145767212
loss_pred:0.11362803727388382, decouple_loss:0.17279772460460663
loss_pred:0.10927146673202515, decouple_loss:0.17335179448127747
The modified gen p mean: 0.44729891419410706, gen p mean: -0.013329013250768185, mean p set: 0.4478749930858612
loss_pred:0.11286678910255432, decouple_loss:0.1749836802482605
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489576518535614, gen p mean: -0.022094601765275, mean p set: 0.44953420758247375
The modified gen p mean: 0.4460628628730774, gen p mean: -0.021284056827425957, mean p set: 0.44663766026496887
loss_pred:0.10851861536502838, decouple_loss:0.18745894730091095
loss_pred:0.10647527873516083, decouple_loss:0.18206840753555298
The modified gen p mean: 0.4476184546947479, gen p mean: -0.021451391279697418, mean p set: 0.4481947124004364
loss_pred:0.10715567320585251, decouple_loss:0.1829368621110916
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732198119163513, gen p mean: -0.011716321110725403, mean p set: 0.4478980302810669
loss_pred:0.10966724157333374, decouple_loss:0.27085110545158386
The modified gen p mean: 0.44699355959892273, gen p mean: -0.01168875303119421, mean p set: 0.447569340467453
loss_pred:0.11247732490301132, decouple_loss:0.2769770920276642
The modified gen p mean: 0.44729840755462646, gen p mean: -0.011698342859745026, mean p set: 0.4478742182254791
loss_pred:0.10586582869291306, decouple_loss:0.2771475315093994
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44666028022766113, gen p mean: -0.014457152225077152, mean p set: 0.44723597168922424
loss_pred:0.10521817207336426, decouple_loss:0.20609202980995178
The modified gen p mean: 0.44671526551246643, gen p mean: -0.014503327198326588, mean p set: 0.44729119539260864
loss_pred:0.11158148944377899, decouple_loss:0.20006711781024933
The modified gen p mean: 0.44719958305358887, gen p mean: -0.014722807332873344, mean p set: 0.44777578115463257
loss_pred:0.1079552099108696, decouple_loss:0.20379476249217987
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474542438983917, gen p mean: -0.02100975625216961, mean p set: 0.44803011417388916
loss_pred:0.09976959973573685, decouple_loss:0.19341391324996948
The modified gen p mean: 0.4477681517601013, gen p mean: -0.02128499746322632, mean p set: 0.44834375381469727
loss_pred:0.09913291782140732, decouple_loss:0.19529801607131958
The modified gen p mean: 0.4479530155658722, gen p mean: -0.02159779891371727, mean p set: 0.4485294818878174
loss_pred:0.10505645722150803, decouple_loss:0.1956874430179596
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839203357696533, gen p mean: -0.032905977219343185, mean p set: 0.44896718859672546
loss_pred:0.10079135745763779, decouple_loss:0.18254882097244263
The modified gen p mean: 0.44704005122184753, gen p mean: -0.031840477138757706, mean p set: 0.4476166069507599
loss_pred:0.10746537894010544, decouple_loss:0.18153296411037445
The modified gen p mean: 0.4476315975189209, gen p mean: -0.03170905262231827, mean p set: 0.44820722937583923
loss_pred:0.10751040279865265, decouple_loss:0.18359670042991638
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661614298820496, gen p mean: -0.030490877106785774, mean p set: 0.44719216227531433
The modified gen p mean: 0.44779783487319946, gen p mean: -0.0304144024848938, mean p set: 0.448373407125473
loss_pred:0.09880911558866501, decouple_loss:0.16864506900310516
loss_pred:0.10599518567323685, decouple_loss:0.1672879457473755
The modified gen p mean: 0.4462607800960541, gen p mean: -0.031030312180519104, mean p set: 0.4468367099761963
loss_pred:0.09586663544178009, decouple_loss:0.17040027678012848
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44636255502700806, gen p mean: -0.046195074915885925, mean p set: 0.4469371736049652
The modified gen p mean: 0.44711652398109436, gen p mean: -0.04638484865427017, mean p set: 0.44769227504730225
loss_pred:0.0927511677145958, decouple_loss:0.1684056967496872
loss_pred:0.09644505381584167, decouple_loss:0.1689014881849289
The modified gen p mean: 0.44612663984298706, gen p mean: -0.04560291767120361, mean p set: 0.44670340418815613
loss_pred:0.09819335490465164, decouple_loss:0.1694565713405609
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758471846580505, gen p mean: -0.03512074053287506, mean p set: 0.448160856962204
loss_pred:0.09641891717910767, decouple_loss:0.16458143293857574
The modified gen p mean: 0.44730785489082336, gen p mean: -0.03514786809682846, mean p set: 0.44788476824760437
loss_pred:0.09441874176263809, decouple_loss:0.16063292324543
The modified gen p mean: 0.4464246928691864, gen p mean: -0.035460542887449265, mean p set: 0.44699984788894653
loss_pred:0.09115168452262878, decouple_loss:0.1605043262243271
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474946856498718, gen p mean: -0.04118259623646736, mean p set: 0.44807007908821106
loss_pred:0.08906283229589462, decouple_loss:0.15562127530574799
The modified gen p mean: 0.44704461097717285, gen p mean: -0.040424689650535583, mean p set: 0.44762122631073
loss_pred:0.09371866285800934, decouple_loss:0.15138503909111023
The modified gen p mean: 0.44718852639198303, gen p mean: -0.0401766337454319, mean p set: 0.4477635622024536
loss_pred:0.09145523607730865, decouple_loss:0.1525009572505951
2023-05-06 18:50:40 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.040893323719501495, mean p set: 0.4502691626548767
loss_pred:0.09547388553619385, decouple_loss:0.1387472152709961
The modified gen p mean: 0.4494868516921997, gen p mean: -0.040831439197063446, mean p set: 0.4500633478164673
The modified gen p mean: 0.44978025555610657, gen p mean: -0.041500914841890335, mean p set: 0.45035696029663086
loss_pred:0.0928090438246727, decouple_loss:0.13870014250278473
loss_pred:0.09454607218503952, decouple_loss:0.1408924013376236
WV_1_PC_1_EH_0_PS_40_6, loss: 0.10124866664409637, avg_mse: 0.09223399311304092
current test mse: 0.092234
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454842507839203, gen p mean: -0.042056623846292496, mean p set: 0.44606053829193115
loss_pred:0.09114345163106918, decouple_loss:0.14411300420761108
The modified gen p mean: 0.4468534290790558, gen p mean: -0.04116511717438698, mean p set: 0.44742920994758606
loss_pred:0.09428495168685913, decouple_loss:0.14368413388729095
The modified gen p mean: 0.44933298230171204, gen p mean: -0.040984317660331726, mean p set: 0.44990822672843933
loss_pred:0.09121530503034592, decouple_loss:0.144168421626091
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751182198524475, gen p mean: -0.04354419559240341, mean p set: 0.44808676838874817
The modified gen p mean: 0.4464383125305176, gen p mean: -0.043886858969926834, mean p set: 0.44701457023620605
loss_pred:0.08621089160442352, decouple_loss:0.13447001576423645
loss_pred:0.08647970110177994, decouple_loss:0.1374531388282776
The modified gen p mean: 0.4474351704120636, gen p mean: -0.044415369629859924, mean p set: 0.4480101466178894
loss_pred:0.08461672067642212, decouple_loss:0.13288390636444092
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455886483192444, gen p mean: -0.04809695854783058, mean p set: 0.4461626410484314
loss_pred:0.08745287358760834, decouple_loss:0.12227270752191544
The modified gen p mean: 0.4471428692340851, gen p mean: -0.04592236876487732, mean p set: 0.4477180242538452
loss_pred:0.08607081323862076, decouple_loss:0.12353132665157318
The modified gen p mean: 0.446939617395401, gen p mean: -0.04600862041115761, mean p set: 0.4475148916244507
loss_pred:0.0937168076634407, decouple_loss:0.12188855558633804
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468920826911926, gen p mean: -0.047733407467603683, mean p set: 0.44746798276901245
loss_pred:0.08298458158969879, decouple_loss:0.11716064810752869
The modified gen p mean: 0.4471642076969147, gen p mean: -0.04722972959280014, mean p set: 0.4477405250072479
loss_pred:0.09070843458175659, decouple_loss:0.11536961793899536
The modified gen p mean: 0.4476276636123657, gen p mean: -0.04720695689320564, mean p set: 0.44820359349250793
loss_pred:0.09301521629095078, decouple_loss:0.1159348115324974
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44684290885925293, gen p mean: -0.049147333949804306, mean p set: 0.4474208950996399
loss_pred:0.08476150780916214, decouple_loss:0.11434756219387054
The modified gen p mean: 0.44729870557785034, gen p mean: -0.05033859238028526, mean p set: 0.4478749632835388
loss_pred:0.08605433255434036, decouple_loss:0.11393480747938156
The modified gen p mean: 0.44722551107406616, gen p mean: -0.050291839987039566, mean p set: 0.44780099391937256
loss_pred:0.08158532530069351, decouple_loss:0.11320046335458755
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472189247608185, gen p mean: -0.05572625622153282, mean p set: 0.44779494404792786
loss_pred:0.08249707520008087, decouple_loss:0.11171165853738785
The modified gen p mean: 0.4472546875476837, gen p mean: -0.05559081584215164, mean p set: 0.44783106446266174
loss_pred:0.08222251385450363, decouple_loss:0.11094961315393448
The modified gen p mean: 0.4483122229576111, gen p mean: -0.05505089834332466, mean p set: 0.4488895833492279
loss_pred:0.07980300486087799, decouple_loss:0.11083164066076279
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465162456035614, gen p mean: -0.05642428621649742, mean p set: 0.44709208607673645
loss_pred:0.08542029559612274, decouple_loss:0.10354621708393097
The modified gen p mean: 0.4470535218715668, gen p mean: -0.05816950649023056, mean p set: 0.44762900471687317
loss_pred:0.07918741554021835, decouple_loss:0.10497654229402542
The modified gen p mean: 0.4460638463497162, gen p mean: -0.05793922394514084, mean p set: 0.4466399550437927
loss_pred:0.07714036107063293, decouple_loss:0.10458498448133469
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468991458415985, gen p mean: -0.05957593768835068, mean p set: 0.4474751055240631
loss_pred:0.08095961064100266, decouple_loss:0.10209525376558304
The modified gen p mean: 0.4458591938018799, gen p mean: -0.0589219331741333, mean p set: 0.4464336037635803
loss_pred:0.07555993646383286, decouple_loss:0.09998515993356705
The modified gen p mean: 0.44609472155570984, gen p mean: -0.058990661054849625, mean p set: 0.4466695487499237
loss_pred:0.07883782684803009, decouple_loss:0.10096094757318497
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470788836479187, gen p mean: -0.06297322362661362, mean p set: 0.44765612483024597
loss_pred:0.08077634125947952, decouple_loss:0.09925215691328049
The modified gen p mean: 0.447483092546463, gen p mean: -0.06388361752033234, mean p set: 0.44805875420570374
loss_pred:0.07931935042142868, decouple_loss:0.10263663530349731
The modified gen p mean: 0.4468541145324707, gen p mean: -0.060767821967601776, mean p set: 0.44742998480796814
loss_pred:0.07884074747562408, decouple_loss:0.10090494155883789
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696956872940063, gen p mean: -0.058080609887838364, mean p set: 0.447546124458313
The modified gen p mean: 0.44837331771850586, gen p mean: -0.05982591584324837, mean p set: 0.4489504396915436
loss_pred:0.07670347392559052, decouple_loss:0.10383959859609604
loss_pred:0.07780413329601288, decouple_loss:0.1053987666964531
The modified gen p mean: 0.4471403658390045, gen p mean: -0.06025795638561249, mean p set: 0.4477160573005676
loss_pred:0.07902853190898895, decouple_loss:0.10224621742963791
2023-05-06 18:54:33 testing...
The modified gen p mean: 0.44978880882263184, gen p mean: -0.06519491225481033, mean p set: 0.4502691626548767
loss_pred:0.08142918348312378, decouple_loss:0.09893681108951569
The modified gen p mean: 0.4494859576225281, gen p mean: -0.06572017818689346, mean p set: 0.4500633478164673
loss_pred:0.07956511527299881, decouple_loss:0.09937936067581177
The modified gen p mean: 0.4497787654399872, gen p mean: -0.06603527814149857, mean p set: 0.45035696029663086
loss_pred:0.08102043718099594, decouple_loss:0.09905032813549042
WV_1_PC_1_EH_0_PS_40_6, loss: 0.08562768995761871, avg_mse: 0.07905598729848862
current test mse: 0.079056
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45292845368385315, gen p mean: -0.06546968221664429, mean p set: 0.4535035192966461
loss_pred:0.07784441858530045, decouple_loss:0.10822039097547531
The modified gen p mean: 0.4527861773967743, gen p mean: -0.0656493678689003, mean p set: 0.45336446166038513
loss_pred:0.07731419801712036, decouple_loss:0.10596895962953568
The modified gen p mean: 0.45352452993392944, gen p mean: -0.06660933792591095, mean p set: 0.4541010856628418
loss_pred:0.07599051296710968, decouple_loss:0.10816854983568192
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524149000644684, gen p mean: -0.06994988769292831, mean p set: 0.45299461483955383
loss_pred:0.07741687446832657, decouple_loss:0.10205157846212387
The modified gen p mean: 0.45245400071144104, gen p mean: -0.07168877869844437, mean p set: 0.4530305862426758
loss_pred:0.07692141085863113, decouple_loss:0.10532205551862717
The modified gen p mean: 0.45433947443962097, gen p mean: -0.07005631923675537, mean p set: 0.45491892099380493
loss_pred:0.07757843285799026, decouple_loss:0.10393871366977692
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45365026593208313, gen p mean: -0.07005710899829865, mean p set: 0.4542261064052582
loss_pred:0.07899782061576843, decouple_loss:0.10348282009363174
The modified gen p mean: 0.45235398411750793, gen p mean: -0.07104593515396118, mean p set: 0.45293015241622925
loss_pred:0.07691964507102966, decouple_loss:0.10482407361268997
The modified gen p mean: 0.4529303014278412, gen p mean: -0.07056712359189987, mean p set: 0.4535074532032013
loss_pred:0.07459500432014465, decouple_loss:0.10368333756923676
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4544954299926758, gen p mean: -0.07418910413980484, mean p set: 0.45507341623306274
loss_pred:0.0746883824467659, decouple_loss:0.09873485565185547
The modified gen p mean: 0.45290353894233704, gen p mean: -0.07517336308956146, mean p set: 0.453481525182724
loss_pred:0.07737015187740326, decouple_loss:0.09995262324810028
The modified gen p mean: 0.45380115509033203, gen p mean: -0.07437879592180252, mean p set: 0.4543784260749817
loss_pred:0.08180877566337585, decouple_loss:0.10036926716566086
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452675998210907, gen p mean: -0.07636786997318268, mean p set: 0.45325344800949097
loss_pred:0.07304096221923828, decouple_loss:0.09445574134588242
The modified gen p mean: 0.45299309492111206, gen p mean: -0.07634647190570831, mean p set: 0.4535713493824005
loss_pred:0.07470806688070297, decouple_loss:0.09562551230192184
The modified gen p mean: 0.4532497823238373, gen p mean: -0.07852617651224136, mean p set: 0.4538280665874481
loss_pred:0.07872305810451508, decouple_loss:0.09709089994430542
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450591117143631, gen p mean: -0.08071539551019669, mean p set: 0.451170951128006
The modified gen p mean: 0.45246973633766174, gen p mean: -0.08080802857875824, mean p set: 0.453046590089798
loss_pred:0.07578469812870026, decouple_loss:0.09191136062145233
loss_pred:0.07559313625097275, decouple_loss:0.09101060032844543
The modified gen p mean: 0.45179545879364014, gen p mean: -0.08188413083553314, mean p set: 0.45237207412719727
loss_pred:0.0744156762957573, decouple_loss:0.09186290204524994
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45382654666900635, gen p mean: -0.08626271784305573, mean p set: 0.4544040560722351
The modified gen p mean: 0.45295190811157227, gen p mean: -0.08861410617828369, mean p set: 0.453529417514801
loss_pred:0.07773704081773758, decouple_loss:0.08727047592401505
loss_pred:0.07486417889595032, decouple_loss:0.08668173104524612
The modified gen p mean: 0.45287078619003296, gen p mean: -0.08731478452682495, mean p set: 0.4534461498260498
loss_pred:0.07469070702791214, decouple_loss:0.08714055269956589
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522811472415924, gen p mean: -0.08965542912483215, mean p set: 0.4528588652610779
The modified gen p mean: 0.4530765116214752, gen p mean: -0.09126731008291245, mean p set: 0.4536536633968353
loss_pred:0.07406634837388992, decouple_loss:0.08352861553430557
loss_pred:0.07074056565761566, decouple_loss:0.08784975856542587
The modified gen p mean: 0.4533507525920868, gen p mean: -0.09128092229366302, mean p set: 0.45392709970474243
loss_pred:0.07526972889900208, decouple_loss:0.08994966745376587
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45265668630599976, gen p mean: -0.09358526766300201, mean p set: 0.45323580503463745
loss_pred:0.07563598453998566, decouple_loss:0.08505746722221375
The modified gen p mean: 0.452332079410553, gen p mean: -0.09457527101039886, mean p set: 0.4529087543487549
loss_pred:0.0758591815829277, decouple_loss:0.0816027894616127
The modified gen p mean: 0.4528665244579315, gen p mean: -0.09268324077129364, mean p set: 0.4534422755241394
loss_pred:0.0710437223315239, decouple_loss:0.07939790189266205
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531205892562866, gen p mean: -0.09587238729000092, mean p set: 0.4536985456943512
loss_pred:0.07039911299943924, decouple_loss:0.08025338500738144
The modified gen p mean: 0.4528743326663971, gen p mean: -0.0960705503821373, mean p set: 0.45345136523246765
loss_pred:0.07138637453317642, decouple_loss:0.0802932158112526
The modified gen p mean: 0.45333433151245117, gen p mean: -0.0976908802986145, mean p set: 0.4539128243923187
loss_pred:0.07559296488761902, decouple_loss:0.07980947941541672
2023-05-06 18:59:38 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.09674964845180511, mean p set: 0.4502691626548767
loss_pred:0.07723671942949295, decouple_loss:0.08504355698823929
The modified gen p mean: 0.44977787137031555, gen p mean: -0.09742507338523865, mean p set: 0.45035696029663086The modified gen p mean: 0.4494889974594116, gen p mean: -0.09731350094079971, mean p set: 0.4500633478164673
loss_pred:0.07627051323652267, decouple_loss:0.08851395547389984
loss_pred:0.0753169059753418, decouple_loss:0.08480919897556305
WV_1_PC_1_EH_0_PS_40_6, loss: 0.08058082312345505, avg_mse: 0.07582689821720123
current test mse: 0.075827
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45346295833587646, gen p mean: -0.09891919791698456, mean p set: 0.4540416896343231
loss_pred:0.07261911034584045, decouple_loss:0.07705916464328766
The modified gen p mean: 0.4523756504058838, gen p mean: -0.09870313853025436, mean p set: 0.45295077562332153
loss_pred:0.07264786213636398, decouple_loss:0.07721234858036041
The modified gen p mean: 0.4542694389820099, gen p mean: -0.09766872227191925, mean p set: 0.45484453439712524
loss_pred:0.06973273307085037, decouple_loss:0.0809088721871376
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534263014793396, gen p mean: -0.09967490285634995, mean p set: 0.4540044963359833
loss_pred:0.0741162821650505, decouple_loss:0.078272745013237
The modified gen p mean: 0.4527735710144043, gen p mean: -0.09998925030231476, mean p set: 0.4533534049987793
loss_pred:0.0696764886379242, decouple_loss:0.07420436292886734
The modified gen p mean: 0.4527646601200104, gen p mean: -0.1000235378742218, mean p set: 0.4533441960811615
loss_pred:0.07368829846382141, decouple_loss:0.0792512372136116
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501672089099884, gen p mean: -0.10122262686491013, mean p set: 0.45074325799942017
loss_pred:0.07059884071350098, decouple_loss:0.07680875808000565
The modified gen p mean: 0.45209819078445435, gen p mean: -0.10211477428674698, mean p set: 0.4526754915714264
loss_pred:0.07483488321304321, decouple_loss:0.07525280117988586
The modified gen p mean: 0.4531140923500061, gen p mean: -0.10126339644193649, mean p set: 0.45369112491607666
loss_pred:0.06982170045375824, decouple_loss:0.07613733410835266
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45420747995376587, gen p mean: -0.10342497378587723, mean p set: 0.4547848105430603
loss_pred:0.07085095345973969, decouple_loss:0.07480084151029587
The modified gen p mean: 0.4530383050441742, gen p mean: -0.10418811440467834, mean p set: 0.45361828804016113
loss_pred:0.07117830961942673, decouple_loss:0.07232119143009186
The modified gen p mean: 0.45229730010032654, gen p mean: -0.10439105331897736, mean p set: 0.4528715908527374
loss_pred:0.07068341970443726, decouple_loss:0.07272201031446457
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45206156373023987, gen p mean: -0.10791032761335373, mean p set: 0.45264074206352234
The modified gen p mean: 0.4523163437843323, gen p mean: -0.10753142088651657, mean p set: 0.4528941214084625loss_pred:0.07277657836675644, decouple_loss:0.0706203505396843
loss_pred:0.07118283212184906, decouple_loss:0.07306820899248123
The modified gen p mean: 0.4536750614643097, gen p mean: -0.10857772827148438, mean p set: 0.45425495505332947
loss_pred:0.07219519466161728, decouple_loss:0.0718088150024414
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501766562461853, gen p mean: -0.11350518465042114, mean p set: 0.4507507383823395
The modified gen p mean: 0.4532594680786133, gen p mean: -0.11247364431619644, mean p set: 0.45383745431900024
loss_pred:0.07139776647090912, decouple_loss:0.0691591203212738
loss_pred:0.07120122015476227, decouple_loss:0.06846173852682114
The modified gen p mean: 0.4537774622440338, gen p mean: -0.1118038147687912, mean p set: 0.45435431599617004
loss_pred:0.06800936907529831, decouple_loss:0.0710509791970253
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45338931679725647, gen p mean: -0.1173965111374855, mean p set: 0.45396625995635986
loss_pred:0.07591806352138519, decouple_loss:0.06997483968734741
The modified gen p mean: 0.4531930685043335, gen p mean: -0.11559658497571945, mean p set: 0.4537711441516876
loss_pred:0.06908318400382996, decouple_loss:0.06884049624204636
The modified gen p mean: 0.4539204239845276, gen p mean: -0.11717656254768372, mean p set: 0.4544958472251892
loss_pred:0.07347129285335541, decouple_loss:0.06931328028440475
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45293527841567993, gen p mean: -0.11699698120355606, mean p set: 0.45351284742355347
loss_pred:0.07056910544633865, decouple_loss:0.06687015295028687
The modified gen p mean: 0.4540306627750397, gen p mean: -0.11546271294355392, mean p set: 0.45460760593414307
loss_pred:0.07135797291994095, decouple_loss:0.06528995931148529
The modified gen p mean: 0.45226356387138367, gen p mean: -0.11643204092979431, mean p set: 0.4528396725654602
loss_pred:0.07015638798475266, decouple_loss:0.06522071361541748
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45341265201568604, gen p mean: -0.11755134165287018, mean p set: 0.453988641500473
loss_pred:0.0689285546541214, decouple_loss:0.065508171916008
The modified gen p mean: 0.4533228278160095, gen p mean: -0.12110714614391327, mean p set: 0.4538998007774353
loss_pred:0.0676693245768547, decouple_loss:0.06542304158210754
The modified gen p mean: 0.45173120498657227, gen p mean: -0.11901960521936417, mean p set: 0.45230671763420105
loss_pred:0.07108815014362335, decouple_loss:0.0641159862279892
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866710901260376, gen p mean: -0.12160059064626694, mean p set: 0.44924843311309814
loss_pred:0.06941144913434982, decouple_loss:0.07018422335386276
The modified gen p mean: 0.4490741193294525, gen p mean: -0.1221688836812973, mean p set: 0.44964826107025146
loss_pred:0.06814374029636383, decouple_loss:0.06984933465719223
The modified gen p mean: 0.44708552956581116, gen p mean: -0.12215926498174667, mean p set: 0.44765836000442505
loss_pred:0.07039707899093628, decouple_loss:0.07488641142845154
2023-05-06 19:06:03 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1205533966422081, mean p set: 0.4502691626548767
loss_pred:0.07403785735368729, decouple_loss:0.06980402767658234
The modified gen p mean: 0.4497828781604767, gen p mean: -0.12121128290891647, mean p set: 0.45035696029663086
The modified gen p mean: 0.4494854509830475, gen p mean: -0.12060225009918213, mean p set: 0.4500633478164673
loss_pred:0.07243520766496658, decouple_loss:0.07190238684415817
loss_pred:0.07181151211261749, decouple_loss:0.06833948940038681
WV_1_PC_1_EH_0_PS_40_6, loss: 0.07626229524612427, avg_mse: 0.07271580398082733
current test mse: 0.072716
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477701485157013, gen p mean: -0.12021221965551376, mean p set: 0.44834285974502563
loss_pred:0.07056603580713272, decouple_loss:0.07063913345336914
The modified gen p mean: 0.4457595646381378, gen p mean: -0.12200280278921127, mean p set: 0.4463326036930084
loss_pred:0.06667720526456833, decouple_loss:0.07091855257749557
The modified gen p mean: 0.44759196043014526, gen p mean: -0.12131840735673904, mean p set: 0.4481663107872009
loss_pred:0.07511663436889648, decouple_loss:0.07037267088890076
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44536396861076355, gen p mean: -0.12135206907987595, mean p set: 0.44594070315361023
loss_pred:0.07048657536506653, decouple_loss:0.06667628884315491
The modified gen p mean: 0.446315199136734, gen p mean: -0.12331798672676086, mean p set: 0.4468908905982971
loss_pred:0.06709756702184677, decouple_loss:0.06640329957008362
The modified gen p mean: 0.4463452696800232, gen p mean: -0.11971920728683472, mean p set: 0.44692057371139526
loss_pred:0.0713222473859787, decouple_loss:0.06798285245895386
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468953609466553, gen p mean: -0.12070934474468231, mean p set: 0.4474697411060333
loss_pred:0.07180395722389221, decouple_loss:0.06607434898614883
The modified gen p mean: 0.44834885001182556, gen p mean: -0.12223297357559204, mean p set: 0.44892388582229614
loss_pred:0.07085014879703522, decouple_loss:0.06665326654911041
The modified gen p mean: 0.4465392827987671, gen p mean: -0.12188607454299927, mean p set: 0.4471190571784973
loss_pred:0.06980409473180771, decouple_loss:0.06406573951244354
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472999572753906, gen p mean: -0.12136642634868622, mean p set: 0.44787725806236267
The modified gen p mean: 0.44818180799484253, gen p mean: -0.1213255524635315, mean p set: 0.44875821471214294
loss_pred:0.07287157326936722, decouple_loss:0.06237324699759483
loss_pred:0.0684385672211647, decouple_loss:0.0633755549788475
The modified gen p mean: 0.44727492332458496, gen p mean: -0.12337029725313187, mean p set: 0.4478478729724884
loss_pred:0.06849239766597748, decouple_loss:0.06269852817058563
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44704657793045044, gen p mean: -0.12214995175600052, mean p set: 0.44762295484542847
loss_pred:0.07111296057701111, decouple_loss:0.06251659244298935
The modified gen p mean: 0.4464104175567627, gen p mean: -0.123868428170681, mean p set: 0.4469849467277527
loss_pred:0.06583921611309052, decouple_loss:0.06263864040374756
The modified gen p mean: 0.4473915100097656, gen p mean: -0.12396196275949478, mean p set: 0.447966605424881
loss_pred:0.06573770195245743, decouple_loss:0.06433255225419998
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471961259841919, gen p mean: -0.12469108402729034, mean p set: 0.44777220487594604
loss_pred:0.07399122416973114, decouple_loss:0.06109890714287758
The modified gen p mean: 0.44624054431915283, gen p mean: -0.12396734207868576, mean p set: 0.44681257009506226
loss_pred:0.07028353959321976, decouple_loss:0.06051899492740631
The modified gen p mean: 0.4462123513221741, gen p mean: -0.1260395348072052, mean p set: 0.44678959250450134
loss_pred:0.06706211715936661, decouple_loss:0.06038639694452286
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743725657463074, gen p mean: -0.12852562963962555, mean p set: 0.4480137526988983
loss_pred:0.06910140067338943, decouple_loss:0.060388609766960144
The modified gen p mean: 0.44651806354522705, gen p mean: -0.1271916776895523, mean p set: 0.44709280133247375
loss_pred:0.06999912858009338, decouple_loss:0.06063922494649887
The modified gen p mean: 0.44660553336143494, gen p mean: -0.12754695117473602, mean p set: 0.44718244671821594
loss_pred:0.06885705888271332, decouple_loss:0.06063244491815567
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777393341064453, gen p mean: -0.1281241923570633, mean p set: 0.44834670424461365
loss_pred:0.07115259766578674, decouple_loss:0.0584016889333725
The modified gen p mean: 0.4469423294067383, gen p mean: -0.12981365621089935, mean p set: 0.447516530752182
loss_pred:0.07110173255205154, decouple_loss:0.058899566531181335
The modified gen p mean: 0.44682395458221436, gen p mean: -0.13029585778713226, mean p set: 0.44739779829978943
loss_pred:0.07011937350034714, decouple_loss:0.060469456017017365
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491506814956665, gen p mean: -0.13079673051834106, mean p set: 0.44973060488700867
loss_pred:0.06546454131603241, decouple_loss:0.06068040058016777
The modified gen p mean: 0.44692397117614746, gen p mean: -0.1263737976551056, mean p set: 0.44750016927719116
loss_pred:0.07152637094259262, decouple_loss:0.057302411645650864
The modified gen p mean: 0.446931928396225, gen p mean: -0.1287333369255066, mean p set: 0.4475100040435791
loss_pred:0.06549294292926788, decouple_loss:0.05658179521560669
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44543007016181946, gen p mean: -0.12860894203186035, mean p set: 0.4460061490535736
loss_pred:0.0671103298664093, decouple_loss:0.0558660663664341
The modified gen p mean: 0.4472576975822449, gen p mean: -0.13015210628509521, mean p set: 0.44783279299736023
loss_pred:0.06535694003105164, decouple_loss:0.05806029215455055
The modified gen p mean: 0.446875661611557, gen p mean: -0.12727442383766174, mean p set: 0.44745346903800964
loss_pred:0.0700242817401886, decouple_loss:0.05535079166293144
2023-05-06 19:09:57 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12599055469036102, mean p set: 0.4502691626548767
loss_pred:0.07167211920022964, decouple_loss:0.058053210377693176
The modified gen p mean: 0.4494880139827728, gen p mean: -0.12556269764900208, mean p set: 0.4500633478164673
loss_pred:0.06900293380022049, decouple_loss:0.05729132145643234
The modified gen p mean: 0.4497845768928528, gen p mean: -0.12630164623260498, mean p set: 0.45035696029663086
loss_pred:0.06948181241750717, decouple_loss:0.05704681947827339
WV_1_PC_1_EH_0_PS_40_6, loss: 0.07292547821998596, avg_mse: 0.07034634053707123
current test mse: 0.070346
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467966556549072, gen p mean: -0.12538662552833557, mean p set: 0.4473719894886017
loss_pred:0.06894618272781372, decouple_loss:0.05579543113708496
The modified gen p mean: 0.44787752628326416, gen p mean: -0.1264260709285736, mean p set: 0.44845691323280334
loss_pred:0.06617467850446701, decouple_loss:0.0571700744330883
The modified gen p mean: 0.4467085301876068, gen p mean: -0.12563906610012054, mean p set: 0.4472857117652893
loss_pred:0.06496331095695496, decouple_loss:0.05543394759297371
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44645267724990845, gen p mean: -0.1254577338695526, mean p set: 0.44703078269958496
loss_pred:0.06787654012441635, decouple_loss:0.055739372968673706
The modified gen p mean: 0.44641706347465515, gen p mean: -0.1266343742609024, mean p set: 0.4469926357269287
loss_pred:0.06715120375156403, decouple_loss:0.05303121358156204
The modified gen p mean: 0.4475752115249634, gen p mean: -0.12840668857097626, mean p set: 0.44815176725387573
loss_pred:0.06850145012140274, decouple_loss:0.05631362646818161
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479517340660095, gen p mean: -0.1275808960199356, mean p set: 0.4485260546207428
loss_pred:0.06678403168916702, decouple_loss:0.05262111872434616
The modified gen p mean: 0.44698673486709595, gen p mean: -0.1279476433992386, mean p set: 0.4475601017475128
loss_pred:0.06632740050554276, decouple_loss:0.05307810381054878
The modified gen p mean: 0.4471447169780731, gen p mean: -0.12733307480812073, mean p set: 0.44771912693977356
loss_pred:0.06676872819662094, decouple_loss:0.054369281977415085
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817298650741577, gen p mean: -0.1253584325313568, mean p set: 0.44875115156173706
The modified gen p mean: 0.44727814197540283, gen p mean: -0.12505657970905304, mean p set: 0.44785624742507935
loss_pred:0.0670059397816658, decouple_loss:0.05410752817988396
loss_pred:0.06348475813865662, decouple_loss:0.05168663710355759
The modified gen p mean: 0.44683125615119934, gen p mean: -0.12417642772197723, mean p set: 0.44740432500839233
loss_pred:0.06469669193029404, decouple_loss:0.05273810029029846
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728848338127136, gen p mean: -0.1278645396232605, mean p set: 0.44786328077316284
loss_pred:0.06521983444690704, decouple_loss:0.051928915083408356
The modified gen p mean: 0.44747933745384216, gen p mean: -0.12879502773284912, mean p set: 0.448056697845459
loss_pred:0.06897801160812378, decouple_loss:0.05280696973204613
The modified gen p mean: 0.4470095634460449, gen p mean: -0.1266709566116333, mean p set: 0.4475838840007782
loss_pred:0.07094968110322952, decouple_loss:0.0518622025847435
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44655513763427734, gen p mean: -0.12871640920639038, mean p set: 0.4471312463283539
loss_pred:0.06410663574934006, decouple_loss:0.052650488913059235
The modified gen p mean: 0.44664692878723145, gen p mean: -0.1267477124929428, mean p set: 0.4472208023071289
loss_pred:0.06440701335668564, decouple_loss:0.05213070288300514
The modified gen p mean: 0.44867393374443054, gen p mean: -0.13080789148807526, mean p set: 0.4492546021938324
loss_pred:0.06653912365436554, decouple_loss:0.051589492708444595
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477214813232422, gen p mean: -0.12636542320251465, mean p set: 0.44829845428466797
The modified gen p mean: 0.4465899169445038, gen p mean: -0.12585698068141937, mean p set: 0.4471677839756012
loss_pred:0.06662029772996902, decouple_loss:0.0507015660405159
loss_pred:0.06565438210964203, decouple_loss:0.05418093875050545
The modified gen p mean: 0.44635894894599915, gen p mean: -0.12492138147354126, mean p set: 0.44693562388420105
loss_pred:0.06706278771162033, decouple_loss:0.052354734390974045
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483000338077545, gen p mean: -0.13215193152427673, mean p set: 0.44887736439704895
The modified gen p mean: 0.44604259729385376, gen p mean: -0.12885455787181854, mean p set: 0.4466158449649811
loss_pred:0.06624788790941238, decouple_loss:0.05120954290032387
loss_pred:0.06784502416849136, decouple_loss:0.0517163909971714
The modified gen p mean: 0.44542989134788513, gen p mean: -0.13002125918865204, mean p set: 0.44600710272789
loss_pred:0.06647176295518875, decouple_loss:0.05012521892786026
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757890701293945, gen p mean: -0.12464911490678787, mean p set: 0.4481556713581085
loss_pred:0.06668660789728165, decouple_loss:0.05105474591255188
The modified gen p mean: 0.44645702838897705, gen p mean: -0.12124612182378769, mean p set: 0.4470318555831909
loss_pred:0.06290393322706223, decouple_loss:0.05321275815367699
The modified gen p mean: 0.44806405901908875, gen p mean: -0.12513168156147003, mean p set: 0.44864004850387573
loss_pred:0.0681179091334343, decouple_loss:0.05566132068634033
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506751596927643, gen p mean: -0.1257261037826538, mean p set: 0.4512515664100647
The modified gen p mean: 0.4476400911808014, gen p mean: -0.12662827968597412, mean p set: 0.4482172131538391
loss_pred:0.06634025275707245, decouple_loss:0.054626934230327606
loss_pred:0.06405748426914215, decouple_loss:0.051241859793663025
The modified gen p mean: 0.44882479310035706, gen p mean: -0.12861956655979156, mean p set: 0.4494022727012634
loss_pred:0.06900744140148163, decouple_loss:0.050180695950984955
2023-05-06 19:15:15 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12738895416259766, mean p set: 0.4502691626548767
loss_pred:0.07020336389541626, decouple_loss:0.05432410165667534
The modified gen p mean: 0.4497801959514618, gen p mean: -0.12780845165252686, mean p set: 0.45035696029663086
The modified gen p mean: 0.44948840141296387, gen p mean: -0.12728251516819, mean p set: 0.4500633478164673
loss_pred:0.06703981757164001, decouple_loss:0.052011892199516296
loss_pred:0.06738071888685226, decouple_loss:0.05139440298080444
WV_1_PC_1_EH_0_PS_40_6, loss: 0.07083680480718613, avg_mse: 0.0688403770327568
current test mse: 0.06884
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448835551738739, gen p mean: -0.12897053360939026, mean p set: 0.4494141638278961
loss_pred:0.0663071945309639, decouple_loss:0.05158090591430664
The modified gen p mean: 0.4504948556423187, gen p mean: -0.12721563875675201, mean p set: 0.4510750472545624
loss_pred:0.06442058831453323, decouple_loss:0.050700195133686066
The modified gen p mean: 0.44714662432670593, gen p mean: -0.12650950253009796, mean p set: 0.4477207064628601
loss_pred:0.06532211601734161, decouple_loss:0.0523855984210968
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481578469276428, gen p mean: -0.1257632076740265, mean p set: 0.44873154163360596
The modified gen p mean: 0.4492359757423401, gen p mean: -0.12476781010627747, mean p set: 0.4498126208782196loss_pred:0.06855791807174683, decouple_loss:0.05308667570352554
loss_pred:0.0694233626127243, decouple_loss:0.05381578579545021
The modified gen p mean: 0.4489137828350067, gen p mean: -0.1258077770471573, mean p set: 0.44949066638946533
loss_pred:0.0664062350988388, decouple_loss:0.05446448549628258
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934776425361633, gen p mean: -0.1255692094564438, mean p set: 0.4499218463897705
loss_pred:0.06868867576122284, decouple_loss:0.050451524555683136
The modified gen p mean: 0.4493265748023987, gen p mean: -0.12375451624393463, mean p set: 0.4499005675315857
loss_pred:0.06356099992990494, decouple_loss:0.04829417169094086
The modified gen p mean: 0.4498351812362671, gen p mean: -0.12396883219480515, mean p set: 0.450408935546875
loss_pred:0.06749728322029114, decouple_loss:0.05038410797715187
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503403306007385, gen p mean: -0.1262480467557907, mean p set: 0.4509190618991852
loss_pred:0.06696182489395142, decouple_loss:0.051255933940410614
The modified gen p mean: 0.44955873489379883, gen p mean: -0.12843908369541168, mean p set: 0.4501335322856903
loss_pred:0.06694302707910538, decouple_loss:0.05277371034026146
The modified gen p mean: 0.44865429401397705, gen p mean: -0.1252255141735077, mean p set: 0.4492337107658386
loss_pred:0.06531181931495667, decouple_loss:0.0497225858271122
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489811658859253, gen p mean: -0.127425417304039, mean p set: 0.4495563805103302
The modified gen p mean: 0.45032355189323425, gen p mean: -0.12830160558223724, mean p set: 0.4508989155292511
loss_pred:0.07037805020809174, decouple_loss:0.04955068975687027
loss_pred:0.06723354756832123, decouple_loss:0.05033622682094574
The modified gen p mean: 0.44941744208335876, gen p mean: -0.12821321189403534, mean p set: 0.4499913156032562
loss_pred:0.06529238820075989, decouple_loss:0.05248338729143143
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786232709884644, gen p mean: -0.133409783244133, mean p set: 0.44843724370002747
The modified gen p mean: 0.4486753046512604, gen p mean: -0.1296616792678833, mean p set: 0.4492511451244354
loss_pred:0.06647609919309616, decouple_loss:0.04925021156668663
loss_pred:0.06706901639699936, decouple_loss:0.049664903432130814
The modified gen p mean: 0.4488174021244049, gen p mean: -0.1318308562040329, mean p set: 0.44939103722572327
loss_pred:0.06793256849050522, decouple_loss:0.053272392600774765
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494656026363373, gen p mean: -0.12613633275032043, mean p set: 0.4500423073768616
The modified gen p mean: 0.4493500292301178, gen p mean: -0.13255470991134644, mean p set: 0.4499257802963257
loss_pred:0.06693413108587265, decouple_loss:0.04822278395295143
loss_pred:0.0676276758313179, decouple_loss:0.04711363464593887
The modified gen p mean: 0.44949519634246826, gen p mean: -0.12781061232089996, mean p set: 0.45007139444351196
loss_pred:0.06511366367340088, decouple_loss:0.04880999028682709
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778263568878174, gen p mean: -0.12397275865077972, mean p set: 0.44835996627807617
loss_pred:0.06546922028064728, decouple_loss:0.05073881149291992
The modified gen p mean: 0.45048579573631287, gen p mean: -0.12866881489753723, mean p set: 0.45106109976768494
loss_pred:0.06395968049764633, decouple_loss:0.04974278062582016
The modified gen p mean: 0.44922205805778503, gen p mean: -0.12650665640830994, mean p set: 0.4497992694377899
loss_pred:0.06821116805076599, decouple_loss:0.050271712243556976
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975918531417847, gen p mean: -0.12479577958583832, mean p set: 0.4503350555896759
The modified gen p mean: 0.44981318712234497, gen p mean: -0.12926198542118073, mean p set: 0.4503912329673767
loss_pred:0.06272007524967194, decouple_loss:0.049590472131967545
loss_pred:0.06463946402072906, decouple_loss:0.05090681463479996
The modified gen p mean: 0.4502459764480591, gen p mean: -0.13178768754005432, mean p set: 0.4508228898048401
loss_pred:0.06288144737482071, decouple_loss:0.04897307604551315
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44932031631469727, gen p mean: -0.1377020627260208, mean p set: 0.4498968720436096
loss_pred:0.06500759720802307, decouple_loss:0.051429420709609985
The modified gen p mean: 0.44743233919143677, gen p mean: -0.13626761734485626, mean p set: 0.448009192943573
loss_pred:0.060073576867580414, decouple_loss:0.0490158274769783
The modified gen p mean: 0.4496012330055237, gen p mean: -0.1372125893831253, mean p set: 0.45017769932746887
loss_pred:0.0619245283305645, decouple_loss:0.04951421916484833
2023-05-06 19:19:11 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13586968183517456, mean p set: 0.4502691626548767
loss_pred:0.06834407150745392, decouple_loss:0.049883823841810226
The modified gen p mean: 0.4494871199131012, gen p mean: -0.13637670874595642, mean p set: 0.4500633478164673
loss_pred:0.06516319513320923, decouple_loss:0.04884401708841324
The modified gen p mean: 0.44978034496307373, gen p mean: -0.13725818693637848, mean p set: 0.45035696029663086
loss_pred:0.06443902105093002, decouple_loss:0.04905172064900398
WV_1_PC_1_EH_0_PS_40_6, loss: 0.0684451013803482, avg_mse: 0.06677107512950897
current test mse: 0.066771
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487766921520233, gen p mean: -0.1365298330783844, mean p set: 0.4493516683578491
loss_pred:0.06705326586961746, decouple_loss:0.048774354159832
The modified gen p mean: 0.4483144283294678, gen p mean: -0.13679355382919312, mean p set: 0.44889214634895325
loss_pred:0.062147438526153564, decouple_loss:0.04868452996015549
The modified gen p mean: 0.45014432072639465, gen p mean: -0.13696101307868958, mean p set: 0.4507233798503876
loss_pred:0.06300928443670273, decouple_loss:0.05018654465675354
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821614027023315, gen p mean: -0.13270960748195648, mean p set: 0.4487907588481903
loss_pred:0.06120437756180763, decouple_loss:0.04728825017809868
The modified gen p mean: 0.44835707545280457, gen p mean: -0.13185885548591614, mean p set: 0.4489321708679199
loss_pred:0.0636414885520935, decouple_loss:0.047467004507780075
The modified gen p mean: 0.4489072561264038, gen p mean: -0.13293428719043732, mean p set: 0.4494830369949341
loss_pred:0.06646239757537842, decouple_loss:0.04749646410346031
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45035237073898315, gen p mean: -0.130374938249588, mean p set: 0.45092666149139404
loss_pred:0.06421303004026413, decouple_loss:0.04884158447384834
The modified gen p mean: 0.4493086040019989, gen p mean: -0.13088004291057587, mean p set: 0.4498860538005829
loss_pred:0.0687999576330185, decouple_loss:0.04724578559398651
The modified gen p mean: 0.44900768995285034, gen p mean: -0.13064855337142944, mean p set: 0.44958579540252686
loss_pred:0.06528886407613754, decouple_loss:0.050233710557222366
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474242031574249, gen p mean: -0.1422601342201233, mean p set: 0.4479977786540985
loss_pred:0.05978022515773773, decouple_loss:0.045861467719078064
The modified gen p mean: 0.45044249296188354, gen p mean: -0.14895029366016388, mean p set: 0.4510194957256317
loss_pred:0.06156560033559799, decouple_loss:0.046537335962057114
The modified gen p mean: 0.4501219093799591, gen p mean: -0.14332494139671326, mean p set: 0.4507005214691162
loss_pred:0.06474705785512924, decouple_loss:0.04738451912999153
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499146342277527, gen p mean: -0.1531359702348709, mean p set: 0.4504936933517456
loss_pred:0.06156306341290474, decouple_loss:0.04722001031041145
The modified gen p mean: 0.45011106133461, gen p mean: -0.14636114239692688, mean p set: 0.4506858289241791
loss_pred:0.06430979818105698, decouple_loss:0.04769841209053993
The modified gen p mean: 0.4501899480819702, gen p mean: -0.1479310244321823, mean p set: 0.4507656991481781
loss_pred:0.06385940313339233, decouple_loss:0.04681523144245148
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997039437294006, gen p mean: -0.1439589411020279, mean p set: 0.4505492150783539
loss_pred:0.06300292909145355, decouple_loss:0.04590655863285065
The modified gen p mean: 0.44905486702919006, gen p mean: -0.1402418464422226, mean p set: 0.4496326744556427
loss_pred:0.0665709376335144, decouple_loss:0.04577809199690819
The modified gen p mean: 0.45018601417541504, gen p mean: -0.138057142496109, mean p set: 0.45076262950897217
loss_pred:0.06476552039384842, decouple_loss:0.04721991717815399
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448957234621048, gen p mean: -0.1448746919631958, mean p set: 0.44953563809394836
loss_pred:0.06187628209590912, decouple_loss:0.046746253967285156
The modified gen p mean: 0.4500197172164917, gen p mean: -0.14458532631397247, mean p set: 0.4505973160266876
loss_pred:0.06724293529987335, decouple_loss:0.047141753137111664
The modified gen p mean: 0.44960319995880127, gen p mean: -0.14439035952091217, mean p set: 0.4501778185367584
loss_pred:0.0610286183655262, decouple_loss:0.04657534137368202
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491299092769623, gen p mean: -0.15987175703048706, mean p set: 0.449707955121994
loss_pred:0.06300875544548035, decouple_loss:0.048992764204740524
The modified gen p mean: 0.44890671968460083, gen p mean: -0.15733423829078674, mean p set: 0.4494844079017639
loss_pred:0.06696950644254684, decouple_loss:0.044121019542217255
The modified gen p mean: 0.4485276937484741, gen p mean: -0.1570761799812317, mean p set: 0.4491027593612671
loss_pred:0.0606686994433403, decouple_loss:0.0440942719578743
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471115171909332, gen p mean: -0.16240587830543518, mean p set: 0.4476839303970337
loss_pred:0.06218339875340462, decouple_loss:0.046975430101156235
The modified gen p mean: 0.45006948709487915, gen p mean: -0.16297730803489685, mean p set: 0.45064398646354675
loss_pred:0.06156162545084953, decouple_loss:0.046407006680965424
The modified gen p mean: 0.44827133417129517, gen p mean: -0.1638811081647873, mean p set: 0.44884857535362244
loss_pred:0.06421337276697159, decouple_loss:0.04490549489855766
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
NaN value num: 0
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476063549518585, gen p mean: -0.15994566679000854, mean p set: 0.44818219542503357The modified gen p mean: 0.44632595777511597, gen p mean: -0.15722529590129852, mean p set: 0.4468995928764343
loss_pred:0.06701301783323288, decouple_loss:0.05104377865791321
loss_pred:0.0633295401930809, decouple_loss:0.04905087873339653
The modified gen p mean: 0.4452957808971405, gen p mean: -0.15559068322181702, mean p set: 0.44587424397468567
loss_pred:0.06740123778581619, decouple_loss:0.047786954790353775
2023-05-06 19:24:52 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.15579688549041748, mean p set: 0.4502691626548767
loss_pred:0.06618130952119827, decouple_loss:0.04750910773873329
The modified gen p mean: 0.44948452711105347, gen p mean: -0.1555914282798767, mean p set: 0.4500633478164673
loss_pred:0.06339894980192184, decouple_loss:0.045812834054231644
The modified gen p mean: 0.44978225231170654, gen p mean: -0.15669739246368408, mean p set: 0.45035696029663086
loss_pred:0.06258182972669601, decouple_loss:0.045931894332170486
WV_1_PC_1_EH_0_PS_40_6, loss: 0.06637492775917053, avg_mse: 0.0651090145111084
current test mse: 0.065109
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464736580848694, gen p mean: -0.16093817353248596, mean p set: 0.44704747200012207
loss_pred:0.06319458037614822, decouple_loss:0.049486372619867325
The modified gen p mean: 0.44887256622314453, gen p mean: -0.15116514265537262, mean p set: 0.4494474530220032
loss_pred:0.06447969377040863, decouple_loss:0.05156945809721947
The modified gen p mean: 0.44535863399505615, gen p mean: -0.15867242217063904, mean p set: 0.4459342360496521
loss_pred:0.06283386051654816, decouple_loss:0.0470760241150856
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801878929138184, gen p mean: -0.15648628771305084, mean p set: 0.44859373569488525
The modified gen p mean: 0.4457606077194214, gen p mean: -0.153724804520607, mean p set: 0.4463336765766144
loss_pred:0.06455224752426147, decouple_loss:0.052431732416152954
loss_pred:0.06804756820201874, decouple_loss:0.04974814131855965
The modified gen p mean: 0.4477420151233673, gen p mean: -0.15013951063156128, mean p set: 0.4483163356781006
loss_pred:0.06391823291778564, decouple_loss:0.051985569298267365
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44606947898864746, gen p mean: -0.1527678370475769, mean p set: 0.4466424882411957
loss_pred:0.0651049092411995, decouple_loss:0.047839608043432236
The modified gen p mean: 0.4477759003639221, gen p mean: -0.1564062088727951, mean p set: 0.4483541250228882
loss_pred:0.06264740973711014, decouple_loss:0.05220742151141167
The modified gen p mean: 0.4463389217853546, gen p mean: -0.15183113515377045, mean p set: 0.44691455364227295
loss_pred:0.06351227313280106, decouple_loss:0.049076661467552185
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44709303975105286, gen p mean: -0.1649576872587204, mean p set: 0.4476702809333801
loss_pred:0.0638473704457283, decouple_loss:0.04892672225832939
The modified gen p mean: 0.4462602734565735, gen p mean: -0.16448819637298584, mean p set: 0.4468361735343933
loss_pred:0.06170719861984253, decouple_loss:0.047217220067977905
The modified gen p mean: 0.4473385512828827, gen p mean: -0.15966659784317017, mean p set: 0.4479162395000458
loss_pred:0.06314852088689804, decouple_loss:0.048880644142627716
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767525792121887, gen p mean: -0.17206747829914093, mean p set: 0.4482518434524536
The modified gen p mean: 0.4474823772907257, gen p mean: -0.17487111687660217, mean p set: 0.44805923104286194
loss_pred:0.06311802566051483, decouple_loss:0.049510590732097626
loss_pred:0.06388702988624573, decouple_loss:0.047059617936611176
The modified gen p mean: 0.4469863772392273, gen p mean: -0.1716730147600174, mean p set: 0.44756653904914856
loss_pred:0.06136588007211685, decouple_loss:0.04663130268454552
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44684091210365295, gen p mean: -0.17072521150112152, mean p set: 0.4474199414253235
loss_pred:0.06469835340976715, decouple_loss:0.04770711809396744
The modified gen p mean: 0.4467531144618988, gen p mean: -0.16823609173297882, mean p set: 0.44732820987701416
loss_pred:0.06398046016693115, decouple_loss:0.0491027906537056
The modified gen p mean: 0.44787338376045227, gen p mean: -0.1735886037349701, mean p set: 0.4484466016292572
loss_pred:0.06406605243682861, decouple_loss:0.04589663818478584
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725507497787476, gen p mean: -0.17209748923778534, mean p set: 0.4478325843811035
loss_pred:0.06542788445949554, decouple_loss:0.044195204973220825
The modified gen p mean: 0.4453246295452118, gen p mean: -0.17095141112804413, mean p set: 0.44589856266975403
loss_pred:0.0653725415468216, decouple_loss:0.04823300614953041
The modified gen p mean: 0.44603461027145386, gen p mean: -0.1706627458333969, mean p set: 0.4466082453727722
loss_pred:0.06277940422296524, decouple_loss:0.04607081785798073
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676026701927185, gen p mean: -0.1688040792942047, mean p set: 0.44733667373657227
loss_pred:0.06316614896059036, decouple_loss:0.048415474593639374
The modified gen p mean: 0.44625264406204224, gen p mean: -0.17089946568012238, mean p set: 0.44682827591896057
loss_pred:0.06383562088012695, decouple_loss:0.04753272607922554
The modified gen p mean: 0.4455181360244751, gen p mean: -0.1750563234090805, mean p set: 0.44609498977661133
loss_pred:0.05845385044813156, decouple_loss:0.04619289189577103
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44748032093048096, gen p mean: -0.17142470180988312, mean p set: 0.4480588138103485
loss_pred:0.06269510090351105, decouple_loss:0.04680419713258743
The modified gen p mean: 0.4480113983154297, gen p mean: -0.1700190007686615, mean p set: 0.4485847055912018
loss_pred:0.061899032443761826, decouple_loss:0.04580274969339371
The modified gen p mean: 0.44598060846328735, gen p mean: -0.17075024545192719, mean p set: 0.4465598464012146
loss_pred:0.06319811195135117, decouple_loss:0.04827618598937988
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806575775146484, gen p mean: -0.17448270320892334, mean p set: 0.44864365458488464
loss_pred:0.06293776631355286, decouple_loss:0.04667724296450615
The modified gen p mean: 0.44691821932792664, gen p mean: -0.17102137207984924, mean p set: 0.4474896788597107
loss_pred:0.060438983142375946, decouple_loss:0.04703528434038162
The modified gen p mean: 0.4470750689506531, gen p mean: -0.17146101593971252, mean p set: 0.4476500451564789
loss_pred:0.06485050916671753, decouple_loss:0.04554539918899536
2023-05-06 19:28:48 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.16497480869293213, mean p set: 0.4502691626548767
loss_pred:0.06400231271982193, decouple_loss:0.046569690108299255
The modified gen p mean: 0.4497819244861603, gen p mean: -0.16571374237537384, mean p set: 0.45035696029663086
The modified gen p mean: 0.4494858682155609, gen p mean: -0.1649707406759262, mean p set: 0.4500633478164673
loss_pred:0.06125268340110779, decouple_loss:0.04653898626565933
loss_pred:0.06218026950955391, decouple_loss:0.04613428935408592
WV_1_PC_1_EH_0_PS_40_6, loss: 0.06479914486408234, avg_mse: 0.06375351548194885
current test mse: 0.063754
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687986373901367, gen p mean: -0.16325490176677704, mean p set: 0.44745099544525146
loss_pred:0.06359568238258362, decouple_loss:0.04532347992062569
The modified gen p mean: 0.44732606410980225, gen p mean: -0.16506217420101166, mean p set: 0.4479012191295624
loss_pred:0.06113402172923088, decouple_loss:0.04510674253106117
The modified gen p mean: 0.44798851013183594, gen p mean: -0.1641252040863037, mean p set: 0.4485665559768677
loss_pred:0.06070466712117195, decouple_loss:0.045435983687639236
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477536082267761, gen p mean: -0.18048813939094543, mean p set: 0.44832971692085266
loss_pred:0.06256149709224701, decouple_loss:0.04511198028922081
The modified gen p mean: 0.4465869665145874, gen p mean: -0.1738220900297165, mean p set: 0.4471641182899475
loss_pred:0.06249629333615303, decouple_loss:0.04698095843195915
The modified gen p mean: 0.44701141119003296, gen p mean: -0.17558681964874268, mean p set: 0.4475829601287842
loss_pred:0.0587770901620388, decouple_loss:0.045460887253284454
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756829738616943, gen p mean: -0.19047795236110687, mean p set: 0.44814398884773254
loss_pred:0.05820827931165695, decouple_loss:0.04611685872077942
The modified gen p mean: 0.4454066753387451, gen p mean: -0.18737530708312988, mean p set: 0.4459850490093231
loss_pred:0.05934034287929535, decouple_loss:0.04510330781340599
The modified gen p mean: 0.4473125636577606, gen p mean: -0.1851276308298111, mean p set: 0.44789019227027893
loss_pred:0.06012804061174393, decouple_loss:0.04708518460392952
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478139877319336, gen p mean: -0.18610432744026184, mean p set: 0.4483919143676758
loss_pred:0.0610063299536705, decouple_loss:0.046977028250694275
The modified gen p mean: 0.44779032468795776, gen p mean: -0.19417303800582886, mean p set: 0.4483678936958313
loss_pred:0.05905938148498535, decouple_loss:0.04657603055238724
The modified gen p mean: 0.44863730669021606, gen p mean: -0.18733569979667664, mean p set: 0.44921690225601196
loss_pred:0.061158791184425354, decouple_loss:0.04721349850296974
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447870135307312, gen p mean: -0.1840236485004425, mean p set: 0.4484492540359497
loss_pred:0.06142858788371086, decouple_loss:0.04532284289598465
The modified gen p mean: 0.4473589062690735, gen p mean: -0.1826399713754654, mean p set: 0.44793352484703064
loss_pred:0.0596296600997448, decouple_loss:0.045299071818590164
The modified gen p mean: 0.446519672870636, gen p mean: -0.1828671097755432, mean p set: 0.4470962882041931
loss_pred:0.06285744160413742, decouple_loss:0.04644046723842621
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461526572704315, gen p mean: -0.18210487067699432, mean p set: 0.44673120975494385
loss_pred:0.062436193227767944, decouple_loss:0.045304857194423676
The modified gen p mean: 0.44653525948524475, gen p mean: -0.18263323605060577, mean p set: 0.4471109211444855
loss_pred:0.06435637176036835, decouple_loss:0.04515739530324936
The modified gen p mean: 0.4470336437225342, gen p mean: -0.17964912950992584, mean p set: 0.44761335849761963
loss_pred:0.0632065162062645, decouple_loss:0.04475798085331917
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667738676071167, gen p mean: -0.18312616646289825, mean p set: 0.44724923372268677
loss_pred:0.05923387035727501, decouple_loss:0.04542330652475357
The modified gen p mean: 0.44563496112823486, gen p mean: -0.18512529134750366, mean p set: 0.44620171189308167
loss_pred:0.06176163628697395, decouple_loss:0.0447814054787159
The modified gen p mean: 0.445735901594162, gen p mean: -0.18428535759449005, mean p set: 0.4463099241256714
loss_pred:0.06038035824894905, decouple_loss:0.04556836932897568
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457816481590271, gen p mean: -0.19445858895778656, mean p set: 0.44635969400405884
loss_pred:0.06031006574630737, decouple_loss:0.04515693709254265
The modified gen p mean: 0.44516587257385254, gen p mean: -0.19686651229858398, mean p set: 0.4457412362098694
loss_pred:0.0577036552131176, decouple_loss:0.04478604719042778
The modified gen p mean: 0.44603100419044495, gen p mean: -0.19382236897945404, mean p set: 0.4466065764427185
loss_pred:0.06005452573299408, decouple_loss:0.044131968170404434
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44674092531204224, gen p mean: -0.19231998920440674, mean p set: 0.44731420278549194
loss_pred:0.060078222304582596, decouple_loss:0.046332381665706635
The modified gen p mean: 0.4461991488933563, gen p mean: -0.19232909381389618, mean p set: 0.4467763900756836
loss_pred:0.06238460913300514, decouple_loss:0.04434031993150711
The modified gen p mean: 0.4452851414680481, gen p mean: -0.1940992772579193, mean p set: 0.4458599388599396
loss_pred:0.05625572428107262, decouple_loss:0.04432222619652748
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935253262519836, gen p mean: -0.18112996220588684, mean p set: 0.4499305486679077
The modified gen p mean: 0.45001593232154846, gen p mean: -0.18229003250598907, mean p set: 0.45059165358543396
loss_pred:0.05667499452829361, decouple_loss:0.04428889602422714
loss_pred:0.06018614396452904, decouple_loss:0.0432777963578701
The modified gen p mean: 0.4481362998485565, gen p mean: -0.18287064135074615, mean p set: 0.44871246814727783
loss_pred:0.06045595183968544, decouple_loss:0.047953929752111435
2023-05-06 19:34:12 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.18323533236980438, mean p set: 0.4502691626548767
loss_pred:0.061975620687007904, decouple_loss:0.04489988088607788
The modified gen p mean: 0.4494825005531311, gen p mean: -0.18179310858249664, mean p set: 0.4500633478164673
loss_pred:0.060196489095687866, decouple_loss:0.04424940049648285
The modified gen p mean: 0.44978219270706177, gen p mean: -0.1839277744293213, mean p set: 0.45035696029663086
loss_pred:0.058906398713588715, decouple_loss:0.044221993535757065
WV_1_PC_1_EH_0_PS_40_6, loss: 0.0625823587179184, avg_mse: 0.06156231090426445
current test mse: 0.061562
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996964931488037, gen p mean: -0.17900636792182922, mean p set: 0.45054665207862854
loss_pred:0.062420282512903214, decouple_loss:0.046975865960121155
The modified gen p mean: 0.44839754700660706, gen p mean: -0.18032199144363403, mean p set: 0.44897210597991943
loss_pred:0.061180271208286285, decouple_loss:0.04846641421318054
The modified gen p mean: 0.44852206110954285, gen p mean: -0.18512621521949768, mean p set: 0.44910159707069397
loss_pred:0.06151781976222992, decouple_loss:0.04522249847650528
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771093130111694, gen p mean: -0.18845099210739136, mean p set: 0.44829061627388
loss_pred:0.05879003182053566, decouple_loss:0.045466456562280655
The modified gen p mean: 0.4487648010253906, gen p mean: -0.1907382607460022, mean p set: 0.44933852553367615
loss_pred:0.05867806822061539, decouple_loss:0.04897427186369896
The modified gen p mean: 0.44843870401382446, gen p mean: -0.18370848894119263, mean p set: 0.44901344180107117
loss_pred:0.060065820813179016, decouple_loss:0.04628802090883255
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478692412376404, gen p mean: -0.18725767731666565, mean p set: 0.4484458863735199
loss_pred:0.05925242230296135, decouple_loss:0.04620688781142235
The modified gen p mean: 0.4484318494796753, gen p mean: -0.18885405361652374, mean p set: 0.4490082263946533
loss_pred:0.05966716632246971, decouple_loss:0.04580939561128616
The modified gen p mean: 0.44973552227020264, gen p mean: -0.19214899837970734, mean p set: 0.450310081243515
loss_pred:0.06079366058111191, decouple_loss:0.0473054014146328
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44897395372390747, gen p mean: -0.18116126954555511, mean p set: 0.4495515525341034
loss_pred:0.056156329810619354, decouple_loss:0.04423365369439125
The modified gen p mean: 0.4498195946216583, gen p mean: -0.17761152982711792, mean p set: 0.4504038989543915
loss_pred:0.05787786841392517, decouple_loss:0.044134654104709625
The modified gen p mean: 0.4509654939174652, gen p mean: -0.17237120866775513, mean p set: 0.4515393376350403
loss_pred:0.06109356880187988, decouple_loss:0.04698467627167702
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486593008041382, gen p mean: -0.1781766712665558, mean p set: 0.449236124753952
loss_pred:0.05667705088853836, decouple_loss:0.042347103357315063
The modified gen p mean: 0.449146568775177, gen p mean: -0.17404194176197052, mean p set: 0.44971972703933716
loss_pred:0.056503426283597946, decouple_loss:0.04422144964337349
The modified gen p mean: 0.44783467054367065, gen p mean: -0.17132142186164856, mean p set: 0.4484051764011383
loss_pred:0.05900345370173454, decouple_loss:0.04627229645848274
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493394196033478, gen p mean: -0.17993709444999695, mean p set: 0.44991445541381836
loss_pred:0.057751238346099854, decouple_loss:0.0420917347073555
The modified gen p mean: 0.4481428265571594, gen p mean: -0.17502017319202423, mean p set: 0.4487136900424957
loss_pred:0.06320859491825104, decouple_loss:0.045305509120225906
The modified gen p mean: 0.4477823078632355, gen p mean: -0.17698810994625092, mean p set: 0.4483579099178314
loss_pred:0.05745559185743332, decouple_loss:0.04469829425215721
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44928181171417236, gen p mean: -0.18882448971271515, mean p set: 0.44986000657081604
loss_pred:0.05983695760369301, decouple_loss:0.04499994218349457
The modified gen p mean: 0.44891640543937683, gen p mean: -0.19126850366592407, mean p set: 0.4494885504245758
loss_pred:0.05813596025109291, decouple_loss:0.04494834691286087
The modified gen p mean: 0.4499468505382538, gen p mean: -0.18490153551101685, mean p set: 0.450520396232605
loss_pred:0.05954398959875107, decouple_loss:0.04628229886293411
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479143023490906, gen p mean: -0.20307964086532593, mean p set: 0.44848892092704773The modified gen p mean: 0.44883379340171814, gen p mean: -0.20056071877479553, mean p set: 0.44941237568855286
loss_pred:0.06133846193552017, decouple_loss:0.04593272507190704
loss_pred:0.05910069867968559, decouple_loss:0.04507983848452568
The modified gen p mean: 0.44918572902679443, gen p mean: -0.20252257585525513, mean p set: 0.4497624933719635
loss_pred:0.06021828204393387, decouple_loss:0.044956743717193604
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830116629600525, gen p mean: -0.19733336567878723, mean p set: 0.4488753378391266
The modified gen p mean: 0.4494606852531433, gen p mean: -0.2029094249010086, mean p set: 0.45003435015678406
loss_pred:0.06005682051181793, decouple_loss:0.045115791261196136
loss_pred:0.05531881004571915, decouple_loss:0.04481719806790352
The modified gen p mean: 0.44973301887512207, gen p mean: -0.20243526995182037, mean p set: 0.4503089487552643
loss_pred:0.05607323721051216, decouple_loss:0.04525376111268997
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485255777835846, gen p mean: -0.18415778875350952, mean p set: 0.44910016655921936
loss_pred:0.0575786791741848, decouple_loss:0.04347418248653412
The modified gen p mean: 0.4493910074234009, gen p mean: -0.18894697725772858, mean p set: 0.44996556639671326
loss_pred:0.05941520258784294, decouple_loss:0.04545047879219055
The modified gen p mean: 0.4493548572063446, gen p mean: -0.1889568418264389, mean p set: 0.4499303698539734
loss_pred:0.06086999177932739, decouple_loss:0.04521607980132103
2023-05-06 19:38:08 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.18167565762996674, mean p set: 0.4502691626548767
loss_pred:0.06056792661547661, decouple_loss:0.04863179475069046
The modified gen p mean: 0.44977879524230957, gen p mean: -0.1836567521095276, mean p set: 0.45035696029663086
The modified gen p mean: 0.4494815468788147, gen p mean: -0.18077494204044342, mean p set: 0.4500633478164673
loss_pred:0.05749574303627014, decouple_loss:0.045447200536727905
loss_pred:0.058634378015995026, decouple_loss:0.04695095866918564
WV_1_PC_1_EH_0_PS_40_6, loss: 0.06124984845519066, avg_mse: 0.06018506735563278
current test mse: 0.060185
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906187057495117, gen p mean: -0.1828356683254242, mean p set: 0.44964277744293213
loss_pred:0.05718032643198967, decouple_loss:0.04688597097992897
The modified gen p mean: 0.44877079129219055, gen p mean: -0.18117327988147736, mean p set: 0.4493550956249237
loss_pred:0.05938887596130371, decouple_loss:0.04478716105222702
The modified gen p mean: 0.4479353129863739, gen p mean: -0.1847466379404068, mean p set: 0.44850850105285645
loss_pred:0.05637860298156738, decouple_loss:0.046041347086429596
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491223990917206, gen p mean: -0.18799307942390442, mean p set: 0.4496983587741852
loss_pred:0.06086708605289459, decouple_loss:0.042986851185560226
The modified gen p mean: 0.4489181935787201, gen p mean: -0.188311368227005, mean p set: 0.4494929015636444
loss_pred:0.05481415614485741, decouple_loss:0.04397791251540184
The modified gen p mean: 0.4489399194717407, gen p mean: -0.19319641590118408, mean p set: 0.4495154023170471
loss_pred:0.05586771294474602, decouple_loss:0.04541686549782753
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951972365379333, gen p mean: -0.20144721865653992, mean p set: 0.4500974118709564
loss_pred:0.05847352370619774, decouple_loss:0.04252491146326065
The modified gen p mean: 0.4489094316959381, gen p mean: -0.20461274683475494, mean p set: 0.4494836926460266
loss_pred:0.05706055089831352, decouple_loss:0.044100210070610046
The modified gen p mean: 0.44880354404449463, gen p mean: -0.19841380417346954, mean p set: 0.4493807256221771
loss_pred:0.05777876451611519, decouple_loss:0.04332135617733002
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494401812553406, gen p mean: -0.21078510582447052, mean p set: 0.4500153958797455
The modified gen p mean: 0.45059752464294434, gen p mean: -0.20182780921459198, mean p set: 0.451172411441803
loss_pred:0.05370744690299034, decouple_loss:0.04412490129470825
loss_pred:0.05953501537442207, decouple_loss:0.042540136724710464
The modified gen p mean: 0.44921553134918213, gen p mean: -0.2123657464981079, mean p set: 0.4497894048690796
loss_pred:0.05615055561065674, decouple_loss:0.04460408538579941
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824716448783875, gen p mean: -0.2022530734539032, mean p set: 0.4488248825073242
loss_pred:0.058046843856573105, decouple_loss:0.04430820047855377
The modified gen p mean: 0.44946929812431335, gen p mean: -0.20829400420188904, mean p set: 0.45004376769065857
loss_pred:0.05337652564048767, decouple_loss:0.04309481754899025
The modified gen p mean: 0.44817841053009033, gen p mean: -0.2000434249639511, mean p set: 0.4487546384334564
loss_pred:0.060295332223176956, decouple_loss:0.044538576155900955
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486987888813019, gen p mean: -0.19549651443958282, mean p set: 0.4492739737033844
The modified gen p mean: 0.44775164127349854, gen p mean: -0.19643904268741608, mean p set: 0.44832560420036316loss_pred:0.05695320665836334, decouple_loss:0.04138796776533127
loss_pred:0.05870062857866287, decouple_loss:0.04485553130507469
The modified gen p mean: 0.4485943019390106, gen p mean: -0.19928045570850372, mean p set: 0.4491713047027588
loss_pred:0.05681522190570831, decouple_loss:0.041020333766937256
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477762281894684, gen p mean: -0.20026567578315735, mean p set: 0.44834738969802856
loss_pred:0.055452000349760056, decouple_loss:0.04285254329442978
The modified gen p mean: 0.44869592785835266, gen p mean: -0.19591566920280457, mean p set: 0.44927287101745605
loss_pred:0.0595884807407856, decouple_loss:0.04237457364797592
The modified gen p mean: 0.44919753074645996, gen p mean: -0.19544413685798645, mean p set: 0.44977647066116333
loss_pred:0.058202434331178665, decouple_loss:0.04218308627605438
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799157977104187, gen p mean: -0.19606173038482666, mean p set: 0.4485754370689392
loss_pred:0.05901380628347397, decouple_loss:0.04047742486000061
The modified gen p mean: 0.4478541314601898, gen p mean: -0.2042243331670761, mean p set: 0.44842392206192017
loss_pred:0.05539364367723465, decouple_loss:0.04135216027498245
The modified gen p mean: 0.4484175145626068, gen p mean: -0.20441079139709473, mean p set: 0.44899484515190125
loss_pred:0.05717800557613373, decouple_loss:0.04206932336091995
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490032196044922, gen p mean: -0.20812059938907623, mean p set: 0.4495806396007538
loss_pred:0.054001178592443466, decouple_loss:0.04159393161535263
The modified gen p mean: 0.4484214186668396, gen p mean: -0.20712529122829437, mean p set: 0.4489958584308624
loss_pred:0.05556338652968407, decouple_loss:0.041054729372262955
The modified gen p mean: 0.4474668502807617, gen p mean: -0.20847025513648987, mean p set: 0.4480412006378174
loss_pred:0.05709679797291756, decouple_loss:0.04337305948138237
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
NaN value num: 0
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968193769454956, gen p mean: -0.2068832963705063, mean p set: 0.45026326179504395
The modified gen p mean: 0.4507662057876587, gen p mean: -0.2069028615951538, mean p set: 0.4513396918773651
loss_pred:0.060387540608644485, decouple_loss:0.047883324325084686
loss_pred:0.05965246632695198, decouple_loss:0.044863998889923096
The modified gen p mean: 0.45148155093193054, gen p mean: -0.20531514286994934, mean p set: 0.45205825567245483
loss_pred:0.060148630291223526, decouple_loss:0.04810700938105583
2023-05-06 19:43:38 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.21070648729801178, mean p set: 0.4502691626548767
loss_pred:0.05887758731842041, decouple_loss:0.04389822855591774
The modified gen p mean: 0.44949156045913696, gen p mean: -0.20893307030200958, mean p set: 0.4500633478164673The modified gen p mean: 0.4497804045677185, gen p mean: -0.21240226924419403, mean p set: 0.45035696029663086
loss_pred:0.05640903487801552, decouple_loss:0.04187048226594925
loss_pred:0.056086041033267975, decouple_loss:0.04127787426114082
WV_1_PC_1_EH_0_PS_40_6, loss: 0.05924166366457939, avg_mse: 0.05887360870838165
current test mse: 0.058874
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478398859500885, gen p mean: -0.2118157297372818, mean p set: 0.44841381907463074
loss_pred:0.05553187057375908, decouple_loss:0.04361037537455559
The modified gen p mean: 0.4496970474720001, gen p mean: -0.21206480264663696, mean p set: 0.45027294754981995
loss_pred:0.0581781379878521, decouple_loss:0.046318698674440384
The modified gen p mean: 0.45201021432876587, gen p mean: -0.2119576334953308, mean p set: 0.45258763432502747
loss_pred:0.06238821521401405, decouple_loss:0.05314738303422928
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44843247532844543, gen p mean: -0.2185150384902954, mean p set: 0.44900739192962646
loss_pred:0.055725280195474625, decouple_loss:0.045832619071006775
The modified gen p mean: 0.4516177177429199, gen p mean: -0.2208186388015747, mean p set: 0.4521893560886383
loss_pred:0.06233111023902893, decouple_loss:0.05168674513697624
The modified gen p mean: 0.45035889744758606, gen p mean: -0.21843817830085754, mean p set: 0.45093685388565063
loss_pred:0.05561616271734238, decouple_loss:0.049319956451654434
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487154483795166, gen p mean: -0.22206251323223114, mean p set: 0.44929447770118713
loss_pred:0.05637705326080322, decouple_loss:0.045477092266082764
The modified gen p mean: 0.44968169927597046, gen p mean: -0.22351859509944916, mean p set: 0.4502636790275574
loss_pred:0.05497966706752777, decouple_loss:0.04664894938468933
The modified gen p mean: 0.44800156354904175, gen p mean: -0.22432710230350494, mean p set: 0.4485791027545929
loss_pred:0.05818406119942665, decouple_loss:0.04388285428285599
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449867844581604, gen p mean: -0.2237394005060196, mean p set: 0.45044276118278503
loss_pred:0.0561317577958107, decouple_loss:0.04669438675045967
The modified gen p mean: 0.4499593675136566, gen p mean: -0.2217155545949936, mean p set: 0.4505334198474884
loss_pred:0.05723021551966667, decouple_loss:0.04729383438825607
The modified gen p mean: 0.4482266306877136, gen p mean: -0.2250167280435562, mean p set: 0.44880905747413635
loss_pred:0.05632089078426361, decouple_loss:0.045811668038368225
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44912654161453247, gen p mean: -0.2236405611038208, mean p set: 0.4497029781341553
The modified gen p mean: 0.4494381248950958, gen p mean: -0.21758204698562622, mean p set: 0.45001283288002014
loss_pred:0.056243035942316055, decouple_loss:0.04491674154996872
loss_pred:0.057522207498550415, decouple_loss:0.04720710217952728
The modified gen p mean: 0.4486539661884308, gen p mean: -0.22432346642017365, mean p set: 0.44922852516174316
loss_pred:0.055641330778598785, decouple_loss:0.045794595032930374
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830140471458435, gen p mean: -0.2181554138660431, mean p set: 0.44887110590934753
loss_pred:0.05585414543747902, decouple_loss:0.043762367218732834
The modified gen p mean: 0.4520488679409027, gen p mean: -0.22244399785995483, mean p set: 0.45262959599494934
loss_pred:0.05648717284202576, decouple_loss:0.04713420197367668
The modified gen p mean: 0.4509834945201874, gen p mean: -0.21541312336921692, mean p set: 0.45155924558639526
loss_pred:0.05753035843372345, decouple_loss:0.045191679149866104
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824281334877014, gen p mean: -0.21675707399845123, mean p set: 0.44882118701934814
loss_pred:0.0565420500934124, decouple_loss:0.04558783024549484
The modified gen p mean: 0.44791361689567566, gen p mean: -0.2125941812992096, mean p set: 0.44848257303237915
loss_pred:0.055652931332588196, decouple_loss:0.044848788529634476
The modified gen p mean: 0.45062878727912903, gen p mean: -0.21517038345336914, mean p set: 0.4512050449848175
loss_pred:0.0580594427883625, decouple_loss:0.0484309084713459
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45192500948905945, gen p mean: -0.22696346044540405, mean p set: 0.45250096917152405
loss_pred:0.05923779681324959, decouple_loss:0.049219224601984024
The modified gen p mean: 0.4510015547275543, gen p mean: -0.2205599695444107, mean p set: 0.45157620310783386
loss_pred:0.05572304129600525, decouple_loss:0.0457259826362133
The modified gen p mean: 0.44938936829566956, gen p mean: -0.21969333291053772, mean p set: 0.449969619512558
loss_pred:0.05874462425708771, decouple_loss:0.04619839787483215
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502854645252228, gen p mean: -0.22904035449028015, mean p set: 0.45085906982421875
The modified gen p mean: 0.4515458047389984, gen p mean: -0.23754873871803284, mean p set: 0.4521230459213257
loss_pred:0.056360140442848206, decouple_loss:0.0461747907102108
loss_pred:0.05881442502140999, decouple_loss:0.047065094113349915
The modified gen p mean: 0.4485814869403839, gen p mean: -0.22509780526161194, mean p set: 0.4491605758666992
loss_pred:0.055959057062864304, decouple_loss:0.045077480375766754
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818732142448425, gen p mean: -0.23105798661708832, mean p set: 0.4487653374671936
The modified gen p mean: 0.4505106806755066, gen p mean: -0.2359967678785324, mean p set: 0.4510902166366577
loss_pred:0.057292141020298004, decouple_loss:0.0447726733982563
loss_pred:0.056224554777145386, decouple_loss:0.0450933463871479
The modified gen p mean: 0.44849908351898193, gen p mean: -0.23034770786762238, mean p set: 0.44907721877098083
loss_pred:0.05533802509307861, decouple_loss:0.04548401013016701
2023-05-06 19:47:37 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.23446175456047058, mean p set: 0.4502691626548767
loss_pred:0.0593525730073452, decouple_loss:0.04827818647027016
The modified gen p mean: 0.44978398084640503, gen p mean: -0.2320731282234192, mean p set: 0.45035696029663086
loss_pred:0.05623641982674599, decouple_loss:0.048560064285993576
The modified gen p mean: 0.44948625564575195, gen p mean: -0.23285844922065735, mean p set: 0.4500633478164673
loss_pred:0.05761731043457985, decouple_loss:0.0480307936668396
WV_1_PC_1_EH_0_PS_40_6, loss: 0.060149919241666794, avg_mse: 0.05992336571216583
current test mse: 0.059923
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515919089317322, gen p mean: -0.23793883621692657, mean p set: 0.4521687626838684
loss_pred:0.05750454217195511, decouple_loss:0.046192511916160583
The modified gen p mean: 0.44899553060531616, gen p mean: -0.23082754015922546, mean p set: 0.44957149028778076
loss_pred:0.057078588753938675, decouple_loss:0.04569479078054428
The modified gen p mean: 0.44825831055641174, gen p mean: -0.2289365530014038, mean p set: 0.44883993268013
loss_pred:0.05229216068983078, decouple_loss:0.044747933745384216
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059242844581604, gen p mean: -0.24025671184062958, mean p set: 0.4511696398258209
loss_pred:0.05741805210709572, decouple_loss:0.04913846030831337
The modified gen p mean: 0.4475579559803009, gen p mean: -0.23199589550495148, mean p set: 0.44812753796577454
loss_pred:0.0549151748418808, decouple_loss:0.04662300646305084
The modified gen p mean: 0.4509999454021454, gen p mean: -0.23675888776779175, mean p set: 0.4515781104564667
loss_pred:0.05662922188639641, decouple_loss:0.04752444475889206
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451083779335022, gen p mean: -0.2386365383863449, mean p set: 0.4516487121582031
loss_pred:0.054323483258485794, decouple_loss:0.04470793530344963
The modified gen p mean: 0.45177921652793884, gen p mean: -0.2445404976606369, mean p set: 0.45235374569892883
loss_pred:0.05474793538451195, decouple_loss:0.046708859503269196
The modified gen p mean: 0.4508020281791687, gen p mean: -0.24381203949451447, mean p set: 0.45137983560562134
loss_pred:0.05775652080774307, decouple_loss:0.046322137117385864
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514479637145996, gen p mean: -0.24153661727905273, mean p set: 0.4520282447338104
loss_pred:0.056387390941381454, decouple_loss:0.04491085186600685
The modified gen p mean: 0.44964340329170227, gen p mean: -0.23739895224571228, mean p set: 0.4502235949039459
loss_pred:0.05403097718954086, decouple_loss:0.04501872882246971
The modified gen p mean: 0.4513099789619446, gen p mean: -0.24805879592895508, mean p set: 0.45188701152801514
loss_pred:0.054173391312360764, decouple_loss:0.04545364901423454
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501037299633026, gen p mean: -0.2507263123989105, mean p set: 0.4506807327270508
The modified gen p mean: 0.4511248767375946, gen p mean: -0.246941938996315, mean p set: 0.4517004191875458loss_pred:0.05495592951774597, decouple_loss:0.046480029821395874
loss_pred:0.05552902817726135, decouple_loss:0.045343365520238876
The modified gen p mean: 0.4485504627227783, gen p mean: -0.24735678732395172, mean p set: 0.4491298198699951
loss_pred:0.05330219119787216, decouple_loss:0.04345637932419777
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508403539657593, gen p mean: -0.25595715641975403, mean p set: 0.4514223337173462
loss_pred:0.05551080405712128, decouple_loss:0.047061119228601456
The modified gen p mean: 0.4498187005519867, gen p mean: -0.24949882924556732, mean p set: 0.450398713350296
loss_pred:0.05389048531651497, decouple_loss:0.047079697251319885
The modified gen p mean: 0.4500218629837036, gen p mean: -0.25216588377952576, mean p set: 0.45059797167778015
loss_pred:0.05472002923488617, decouple_loss:0.04995092377066612
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890618324279785, gen p mean: -0.24940133094787598, mean p set: 0.4494839310646057
loss_pred:0.05456067994236946, decouple_loss:0.047200482338666916
The modified gen p mean: 0.4503614902496338, gen p mean: -0.25646060705184937, mean p set: 0.4509415924549103
loss_pred:0.054418664425611496, decouple_loss:0.04720090702176094
The modified gen p mean: 0.4477132260799408, gen p mean: -0.24969685077667236, mean p set: 0.4482796788215637
loss_pred:0.05504671856760979, decouple_loss:0.04625415802001953
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505082070827484, gen p mean: -0.24766632914543152, mean p set: 0.45108291506767273
loss_pred:0.0527351088821888, decouple_loss:0.04389192536473274
The modified gen p mean: 0.4500545263290405, gen p mean: -0.24491170048713684, mean p set: 0.4506383240222931
loss_pred:0.054032910615205765, decouple_loss:0.04684622213244438
The modified gen p mean: 0.4512908160686493, gen p mean: -0.25072649121284485, mean p set: 0.45187318325042725
loss_pred:0.05522916465997696, decouple_loss:0.04655730351805687
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506221413612366, gen p mean: -0.2568902373313904, mean p set: 0.4511985182762146The modified gen p mean: 0.4501580595970154, gen p mean: -0.24613513052463531, mean p set: 0.45073628425598145
loss_pred:0.05540609359741211, decouple_loss:0.048901475965976715
loss_pred:0.05358076095581055, decouple_loss:0.04397555813193321
The modified gen p mean: 0.44798439741134644, gen p mean: -0.24406647682189941, mean p set: 0.44856342673301697
loss_pred:0.05611256882548332, decouple_loss:0.04394935443997383
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713088870048523, gen p mean: -0.25228890776634216, mean p set: 0.4477007985115051
loss_pred:0.0551537424325943, decouple_loss:0.04832148179411888
The modified gen p mean: 0.4468434154987335, gen p mean: -0.2489798665046692, mean p set: 0.44741740822792053
The modified gen p mean: 0.4473561942577362, gen p mean: -0.2504512369632721, mean p set: 0.4479331374168396
loss_pred:0.05753057077527046, decouple_loss:0.046320799738168716
loss_pred:0.057033441960811615, decouple_loss:0.04708825796842575
2023-05-06 19:52:40 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.24821944534778595, mean p set: 0.4502691626548767
loss_pred:0.057709306478500366, decouple_loss:0.04634165018796921
The modified gen p mean: 0.4494916796684265, gen p mean: -0.24392683804035187, mean p set: 0.4500633478164673
loss_pred:0.055834148079156876, decouple_loss:0.046657588332891464
The modified gen p mean: 0.44978636503219604, gen p mean: -0.24570241570472717, mean p set: 0.45035696029663086
loss_pred:0.0554586686193943, decouple_loss:0.047617316246032715
WV_1_PC_1_EH_0_PS_40_6, loss: 0.05867765098810196, avg_mse: 0.05855874344706535
current test mse: 0.058559
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484560787677765, gen p mean: -0.23897573351860046, mean p set: 0.4490286707878113
loss_pred:0.054701026529073715, decouple_loss:0.04673825204372406
The modified gen p mean: 0.4466373324394226, gen p mean: -0.24485741555690765, mean p set: 0.44721704721450806
loss_pred:0.052541933953762054, decouple_loss:0.047035712748765945
The modified gen p mean: 0.446878045797348, gen p mean: -0.2447466403245926, mean p set: 0.4474574029445648
loss_pred:0.054563652724027634, decouple_loss:0.04545978084206581
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687435030937195, gen p mean: -0.23976781964302063, mean p set: 0.44744551181793213
The modified gen p mean: 0.4461289346218109, gen p mean: -0.23601001501083374, mean p set: 0.4467063546180725
loss_pred:0.05218304321169853, decouple_loss:0.04656321555376053
loss_pred:0.05517806112766266, decouple_loss:0.04698418080806732
The modified gen p mean: 0.4457615911960602, gen p mean: -0.24059288203716278, mean p set: 0.4463306665420532
loss_pred:0.054942987859249115, decouple_loss:0.0467873141169548
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44636034965515137, gen p mean: -0.23693910241127014, mean p set: 0.44694095849990845
loss_pred:0.05621950700879097, decouple_loss:0.04595920443534851
The modified gen p mean: 0.44651105999946594, gen p mean: -0.23973512649536133, mean p set: 0.4470905363559723
loss_pred:0.05567536503076553, decouple_loss:0.04649411886930466
The modified gen p mean: 0.44777044653892517, gen p mean: -0.24426738917827606, mean p set: 0.4483422338962555
loss_pred:0.05400318652391434, decouple_loss:0.04572272673249245
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463283121585846, gen p mean: -0.23465947806835175, mean p set: 0.44690370559692383
The modified gen p mean: 0.4477662444114685, gen p mean: -0.23595409095287323, mean p set: 0.44834378361701965
loss_pred:0.051799140870571136, decouple_loss:0.044949255883693695
loss_pred:0.052141863852739334, decouple_loss:0.045024845749139786
The modified gen p mean: 0.44736769795417786, gen p mean: -0.23933851718902588, mean p set: 0.44793781638145447
loss_pred:0.057743947952985764, decouple_loss:0.046359870582818985
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44540542364120483, gen p mean: -0.23588506877422333, mean p set: 0.44598105549812317
loss_pred:0.05593514069914818, decouple_loss:0.04428672790527344
The modified gen p mean: 0.44763094186782837, gen p mean: -0.23776599764823914, mean p set: 0.448209285736084
loss_pred:0.05322359502315521, decouple_loss:0.04340413212776184
The modified gen p mean: 0.4449155330657959, gen p mean: -0.23796017467975616, mean p set: 0.44549062848091125
loss_pred:0.05601954087615013, decouple_loss:0.045137397944927216
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44622671604156494, gen p mean: -0.23017852008342743, mean p set: 0.44680383801460266
loss_pred:0.05199294537305832, decouple_loss:0.04402148351073265
The modified gen p mean: 0.44818657636642456, gen p mean: -0.2318722903728485, mean p set: 0.44876447319984436
loss_pred:0.05133488401770592, decouple_loss:0.04300984740257263
The modified gen p mean: 0.4478684067726135, gen p mean: -0.23571538925170898, mean p set: 0.44844114780426025
loss_pred:0.05255749076604843, decouple_loss:0.042951636016368866
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465324282646179, gen p mean: -0.23408813774585724, mean p set: 0.44710773229599
loss_pred:0.05337544530630112, decouple_loss:0.04254071041941643
The modified gen p mean: 0.4464435279369354, gen p mean: -0.23316313326358795, mean p set: 0.4470267593860626
loss_pred:0.05498168617486954, decouple_loss:0.04411128908395767
The modified gen p mean: 0.4470369219779968, gen p mean: -0.2342747002840042, mean p set: 0.4476129114627838
loss_pred:0.056149229407310486, decouple_loss:0.04489166662096977
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454874098300934, gen p mean: -0.2422165423631668, mean p set: 0.4460590183734894
loss_pred:0.05315476283431053, decouple_loss:0.04476116970181465
The modified gen p mean: 0.4465861916542053, gen p mean: -0.2406560778617859, mean p set: 0.44716206192970276
loss_pred:0.054825667291879654, decouple_loss:0.04637444019317627
The modified gen p mean: 0.44681820273399353, gen p mean: -0.2402782291173935, mean p set: 0.44739776849746704
loss_pred:0.054367806762456894, decouple_loss:0.04533892124891281
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778549671173096, gen p mean: -0.23920513689517975, mean p set: 0.4483581483364105
loss_pred:0.0505618117749691, decouple_loss:0.04339104890823364
The modified gen p mean: 0.446609228849411, gen p mean: -0.2380971610546112, mean p set: 0.44717955589294434
loss_pred:0.05422782525420189, decouple_loss:0.044468268752098083
The modified gen p mean: 0.4473113715648651, gen p mean: -0.24090999364852905, mean p set: 0.4478902518749237
loss_pred:0.05455339699983597, decouple_loss:0.045015349984169006
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44658374786376953, gen p mean: -0.240196093916893, mean p set: 0.44716131687164307
loss_pred:0.05372551456093788, decouple_loss:0.04344912990927696
The modified gen p mean: 0.4476241171360016, gen p mean: -0.24246156215667725, mean p set: 0.4481981694698334
loss_pred:0.05584913492202759, decouple_loss:0.044615522027015686
The modified gen p mean: 0.4471203684806824, gen p mean: -0.2373294085264206, mean p set: 0.44769522547721863
loss_pred:0.05427264794707298, decouple_loss:0.04465914145112038
2023-05-06 19:56:36 testing...
The modified gen p mean: 0.44947800040245056, gen p mean: -0.23866026103496552, mean p set: 0.4500633478164673
loss_pred:0.054180439561605453, decouple_loss:0.04335080832242966
The modified gen p mean: 0.4497888386249542, gen p mean: -0.24107614159584045, mean p set: 0.4502691626548767
loss_pred:0.05627669394016266, decouple_loss:0.044391877949237823
The modified gen p mean: 0.4497789740562439, gen p mean: -0.23748977482318878, mean p set: 0.45035696029663086
loss_pred:0.05399216711521149, decouple_loss:0.04421491548418999
WV_1_PC_1_EH_0_PS_40_6, loss: 0.05701572820544243, avg_mse: 0.0568513423204422
current test mse: 0.056851
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717732071876526, gen p mean: -0.23559722304344177, mean p set: 0.4477542042732239
loss_pred:0.0530250109732151, decouple_loss:0.042707592248916626
The modified gen p mean: 0.44692569971084595, gen p mean: -0.24333849549293518, mean p set: 0.4474954903125763
loss_pred:0.05205974727869034, decouple_loss:0.04383255913853645
The modified gen p mean: 0.4467122256755829, gen p mean: -0.236429363489151, mean p set: 0.44729292392730713
loss_pred:0.05341988801956177, decouple_loss:0.0420890636742115
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474494457244873, gen p mean: -0.23803164064884186, mean p set: 0.44802701473236084
The modified gen p mean: 0.4477376639842987, gen p mean: -0.24297559261322021, mean p set: 0.44831427931785583
loss_pred:0.051813069730997086, decouple_loss:0.04390748217701912
loss_pred:0.0525130033493042, decouple_loss:0.04260765388607979
The modified gen p mean: 0.44635093212127686, gen p mean: -0.2359587401151657, mean p set: 0.4469318985939026
loss_pred:0.05297018215060234, decouple_loss:0.0454755499958992
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457082152366638, gen p mean: -0.23252572119235992, mean p set: 0.4462839961051941
loss_pred:0.05135698616504669, decouple_loss:0.045595016330480576
The modified gen p mean: 0.4480052590370178, gen p mean: -0.2335895448923111, mean p set: 0.44858217239379883
loss_pred:0.051105424761772156, decouple_loss:0.04482931271195412
The modified gen p mean: 0.44830623269081116, gen p mean: -0.23691235482692719, mean p set: 0.448881059885025
loss_pred:0.05167488381266594, decouple_loss:0.04630415141582489
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462064206600189, gen p mean: -0.23386423289775848, mean p set: 0.4467789828777313
loss_pred:0.05404725298285484, decouple_loss:0.043069757521152496
The modified gen p mean: 0.4480404555797577, gen p mean: -0.2337205559015274, mean p set: 0.44861549139022827
loss_pred:0.05145230516791344, decouple_loss:0.04238075017929077
The modified gen p mean: 0.4463534355163574, gen p mean: -0.23030641674995422, mean p set: 0.44692835211753845
loss_pred:0.05455208197236061, decouple_loss:0.04231874644756317
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44638174772262573, gen p mean: -0.23213528096675873, mean p set: 0.44696754217147827
loss_pred:0.051417674869298935, decouple_loss:0.04230248183012009
The modified gen p mean: 0.4448854327201843, gen p mean: -0.23303063213825226, mean p set: 0.4454576373100281
loss_pred:0.054936692118644714, decouple_loss:0.042469218373298645
The modified gen p mean: 0.4474368989467621, gen p mean: -0.23020915687084198, mean p set: 0.448009192943573
loss_pred:0.050803057849407196, decouple_loss:0.04193124920129776
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893208146095276, gen p mean: -0.23513463139533997, mean p set: 0.4495137631893158
loss_pred:0.053768616169691086, decouple_loss:0.0414394736289978
The modified gen p mean: 0.44578465819358826, gen p mean: -0.23066455125808716, mean p set: 0.44635844230651855
loss_pred:0.05388955399394035, decouple_loss:0.04259822517633438
The modified gen p mean: 0.44651302695274353, gen p mean: -0.2355736792087555, mean p set: 0.44708412885665894
loss_pred:0.0528743676841259, decouple_loss:0.04247361049056053
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470974802970886, gen p mean: -0.23980098962783813, mean p set: 0.4476804733276367
loss_pred:0.054140605032444, decouple_loss:0.045994196087121964
The modified gen p mean: 0.44750964641571045, gen p mean: -0.2321632206439972, mean p set: 0.44808200001716614
loss_pred:0.0498867966234684, decouple_loss:0.04077794402837753
The modified gen p mean: 0.4471316933631897, gen p mean: -0.23017722368240356, mean p set: 0.44771286845207214
loss_pred:0.05220944061875343, decouple_loss:0.04140650853514671
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781529903411865, gen p mean: -0.23348468542099, mean p set: 0.44838783144950867
loss_pred:0.05120350047945976, decouple_loss:0.039328329265117645
The modified gen p mean: 0.4460100829601288, gen p mean: -0.2421095371246338, mean p set: 0.4465861916542053
loss_pred:0.0521576851606369, decouple_loss:0.04148571938276291
The modified gen p mean: 0.44701308012008667, gen p mean: -0.23782102763652802, mean p set: 0.44758957624435425
loss_pred:0.05311613529920578, decouple_loss:0.0417376272380352
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44850021600723267, gen p mean: -0.23909272253513336, mean p set: 0.44907715916633606
The modified gen p mean: 0.4471796751022339, gen p mean: -0.23603715002536774, mean p set: 0.44775307178497314
loss_pred:0.05067368224263191, decouple_loss:0.0412251316010952
loss_pred:0.04882839322090149, decouple_loss:0.04114949330687523
The modified gen p mean: 0.4461611211299896, gen p mean: -0.23544704914093018, mean p set: 0.446748286485672
loss_pred:0.052630290389060974, decouple_loss:0.04223313927650452
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
NaN value num: 0
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962364435195923, gen p mean: -0.2418520450592041, mean p set: 0.4502009153366089The modified gen p mean: 0.4493497312068939, gen p mean: -0.24245335161685944, mean p set: 0.44992515444755554
loss_pred:0.05706037953495979, decouple_loss:0.04422103613615036
loss_pred:0.0543285608291626, decouple_loss:0.04408860579133034
The modified gen p mean: 0.45143923163414, gen p mean: -0.2427048534154892, mean p set: 0.4520154595375061
loss_pred:0.05646958947181702, decouple_loss:0.04463140293955803
2023-05-06 20:02:03 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.2576116621494293, mean p set: 0.4502691626548767
loss_pred:0.05580444261431694, decouple_loss:0.04268306493759155
The modified gen p mean: 0.44948455691337585, gen p mean: -0.2539612948894501, mean p set: 0.4500633478164673
loss_pred:0.05335540696978569, decouple_loss:0.04164288938045502
The modified gen p mean: 0.44978123903274536, gen p mean: -0.25285646319389343, mean p set: 0.45035696029663086
loss_pred:0.053477123379707336, decouple_loss:0.04140906408429146
WV_1_PC_1_EH_0_PS_40_6, loss: 0.05630790814757347, avg_mse: 0.05637639760971069
current test mse: 0.056376
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45054176449775696, gen p mean: -0.25841352343559265, mean p set: 0.4511202275753021
loss_pred:0.05713779106736183, decouple_loss:0.04510195553302765
The modified gen p mean: 0.45026177167892456, gen p mean: -0.2581585645675659, mean p set: 0.4508419334888458
loss_pred:0.056817539036273956, decouple_loss:0.04502684623003006
The modified gen p mean: 0.45023006200790405, gen p mean: -0.2546754479408264, mean p set: 0.4508068561553955
loss_pred:0.05516412481665611, decouple_loss:0.045064207166433334
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497716426849365, gen p mean: -0.2654382288455963, mean p set: 0.45034801959991455
loss_pred:0.055057138204574585, decouple_loss:0.04581841081380844
The modified gen p mean: 0.45105162262916565, gen p mean: -0.26103678345680237, mean p set: 0.45163068175315857
loss_pred:0.05424881726503372, decouple_loss:0.045433562248945236
The modified gen p mean: 0.4517376720905304, gen p mean: -0.2606389820575714, mean p set: 0.45231279730796814
loss_pred:0.057569801807403564, decouple_loss:0.04555583745241165
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451874315738678, gen p mean: -0.25548115372657776, mean p set: 0.4524562954902649
The modified gen p mean: 0.449334055185318, gen p mean: -0.253383606672287, mean p set: 0.44991254806518555
loss_pred:0.05376920849084854, decouple_loss:0.04427716135978699
loss_pred:0.05419725924730301, decouple_loss:0.04379379004240036
The modified gen p mean: 0.4513343870639801, gen p mean: -0.25261813402175903, mean p set: 0.4519175887107849
loss_pred:0.054120223969221115, decouple_loss:0.044200971722602844
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497298002243042, gen p mean: -0.2412365823984146, mean p set: 0.45030614733695984
loss_pred:0.05380512401461601, decouple_loss:0.044512178748846054
The modified gen p mean: 0.44996505975723267, gen p mean: -0.23874135315418243, mean p set: 0.4505466818809509
loss_pred:0.055506497621536255, decouple_loss:0.04527554288506508
The modified gen p mean: 0.4495548605918884, gen p mean: -0.2413865625858307, mean p set: 0.45013299584388733
loss_pred:0.05367158353328705, decouple_loss:0.04430229589343071
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508618414402008, gen p mean: -0.22886691987514496, mean p set: 0.45144689083099365
The modified gen p mean: 0.45003026723861694, gen p mean: -0.2302502542734146, mean p set: 0.45060768723487854
loss_pred:0.05365092307329178, decouple_loss:0.04531238228082657
loss_pred:0.053463518619537354, decouple_loss:0.045668862760066986
The modified gen p mean: 0.4507417380809784, gen p mean: -0.2246578484773636, mean p set: 0.45132210850715637
loss_pred:0.05553242191672325, decouple_loss:0.04631764441728592
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45139291882514954, gen p mean: -0.23606009781360626, mean p set: 0.4519709050655365
loss_pred:0.0558735691010952, decouple_loss:0.04384482279419899
The modified gen p mean: 0.44931814074516296, gen p mean: -0.23559342324733734, mean p set: 0.449899822473526
loss_pred:0.053663160651922226, decouple_loss:0.04255993291735649
The modified gen p mean: 0.4495978057384491, gen p mean: -0.23454393446445465, mean p set: 0.450173020362854
loss_pred:0.05521119385957718, decouple_loss:0.04302383214235306
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114025473594666, gen p mean: -0.24096699059009552, mean p set: 0.4517151117324829
loss_pred:0.052802227437496185, decouple_loss:0.04282895103096962
The modified gen p mean: 0.45245060324668884, gen p mean: -0.24455487728118896, mean p set: 0.45303085446357727
loss_pred:0.053377486765384674, decouple_loss:0.04274798184633255
The modified gen p mean: 0.450867623090744, gen p mean: -0.24186740815639496, mean p set: 0.45143812894821167
loss_pred:0.0539371632039547, decouple_loss:0.043090008199214935
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45178356766700745, gen p mean: -0.24961091578006744, mean p set: 0.452357679605484
loss_pred:0.050860464572906494, decouple_loss:0.0427858941257
The modified gen p mean: 0.4511162042617798, gen p mean: -0.2556992769241333, mean p set: 0.4516952931880951
loss_pred:0.05481543391942978, decouple_loss:0.043192293494939804
The modified gen p mean: 0.4517796039581299, gen p mean: -0.25256219506263733, mean p set: 0.4523555636405945
loss_pred:0.05122896656394005, decouple_loss:0.04353412985801697
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45224571228027344, gen p mean: -0.2501378357410431, mean p set: 0.45281848311424255
The modified gen p mean: 0.45072370767593384, gen p mean: -0.24343696236610413, mean p set: 0.45130112767219543
loss_pred:0.05139203742146492, decouple_loss:0.04250031337141991
loss_pred:0.052378129214048386, decouple_loss:0.042682453989982605
The modified gen p mean: 0.44973188638687134, gen p mean: -0.2498074471950531, mean p set: 0.45031243562698364
loss_pred:0.05186055600643158, decouple_loss:0.04199255630373955
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45000648498535156, gen p mean: -0.24423275887966156, mean p set: 0.45058155059814453
loss_pred:0.05182066187262535, decouple_loss:0.0421639084815979
The modified gen p mean: 0.45221564173698425, gen p mean: -0.24565750360488892, mean p set: 0.4527982771396637
loss_pred:0.05736065283417702, decouple_loss:0.04345526918768883
The modified gen p mean: 0.45071521401405334, gen p mean: -0.2420099824666977, mean p set: 0.4512922167778015
loss_pred:0.05365942046046257, decouple_loss:0.043856363743543625
2023-05-06 20:06:01 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.24788691103458405, mean p set: 0.4502691626548767
loss_pred:0.056295860558748245, decouple_loss:0.04487556219100952
The modified gen p mean: 0.44949278235435486, gen p mean: -0.2432466447353363, mean p set: 0.4500633478164673
The modified gen p mean: 0.44978877902030945, gen p mean: -0.24353353679180145, mean p set: 0.45035696029663086
loss_pred:0.05393635481595993, decouple_loss:0.0449068509042263
loss_pred:0.05387398600578308, decouple_loss:0.045284099876880646
WV_1_PC_1_EH_0_PS_40_6, loss: 0.056953176856040955, avg_mse: 0.05793698877096176
current test mse: 0.057937
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514364004135132, gen p mean: -0.24062684178352356, mean p set: 0.45201170444488525
loss_pred:0.0517277717590332, decouple_loss:0.04381992295384407
The modified gen p mean: 0.44962990283966064, gen p mean: -0.24080723524093628, mean p set: 0.4502132534980774
loss_pred:0.05312057584524155, decouple_loss:0.04286467656493187
The modified gen p mean: 0.44994768500328064, gen p mean: -0.2443111389875412, mean p set: 0.45052459836006165
loss_pred:0.05188703536987305, decouple_loss:0.04179157689213753
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121151208877563, gen p mean: -0.2401149421930313, mean p set: 0.45178699493408203
loss_pred:0.05406789854168892, decouple_loss:0.04280746355652809
The modified gen p mean: 0.45070987939834595, gen p mean: -0.24456463754177094, mean p set: 0.4512876868247986
loss_pred:0.05294737592339516, decouple_loss:0.04384883493185043
The modified gen p mean: 0.4495198428630829, gen p mean: -0.24240624904632568, mean p set: 0.4500918984413147
loss_pred:0.05207839235663414, decouple_loss:0.04226754605770111
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507465064525604, gen p mean: -0.24257062375545502, mean p set: 0.45133206248283386
loss_pred:0.05284232646226883, decouple_loss:0.044333573430776596
The modified gen p mean: 0.44962266087532043, gen p mean: -0.2481526881456375, mean p set: 0.4501960873603821
loss_pred:0.052900709211826324, decouple_loss:0.0427381657063961
The modified gen p mean: 0.4511863589286804, gen p mean: -0.24757321178913116, mean p set: 0.4517611861228943
loss_pred:0.053021661937236786, decouple_loss:0.04414518550038338
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492306113243103, gen p mean: -0.24635514616966248, mean p set: 0.4498090147972107
loss_pred:0.053332142531871796, decouple_loss:0.041826508939266205
The modified gen p mean: 0.4504985511302948, gen p mean: -0.2437535524368286, mean p set: 0.4510760009288788
loss_pred:0.05397236347198486, decouple_loss:0.040451161563396454
The modified gen p mean: 0.4501730501651764, gen p mean: -0.24526922404766083, mean p set: 0.45074760913848877
loss_pred:0.05137016996741295, decouple_loss:0.042096879333257675
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500001072883606, gen p mean: -0.24633952975273132, mean p set: 0.45058050751686096
loss_pred:0.05312435328960419, decouple_loss:0.041835885494947433
The modified gen p mean: 0.45182663202285767, gen p mean: -0.24207711219787598, mean p set: 0.4524042010307312
loss_pred:0.05072173476219177, decouple_loss:0.04202234372496605
The modified gen p mean: 0.450736939907074, gen p mean: -0.24101942777633667, mean p set: 0.45131561160087585
loss_pred:0.05136725306510925, decouple_loss:0.04173211008310318
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45259472727775574, gen p mean: -0.2452680766582489, mean p set: 0.45317062735557556
loss_pred:0.05234137922525406, decouple_loss:0.040829285979270935
The modified gen p mean: 0.45201241970062256, gen p mean: -0.24138039350509644, mean p set: 0.45258599519729614
loss_pred:0.05649841949343681, decouple_loss:0.04043764993548393
The modified gen p mean: 0.45163729786872864, gen p mean: -0.24780729413032532, mean p set: 0.4522075653076172
loss_pred:0.05213385075330734, decouple_loss:0.0418425053358078
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45074328780174255, gen p mean: -0.24846796691417694, mean p set: 0.451321005821228
loss_pred:0.05022839456796646, decouple_loss:0.042468734085559845
The modified gen p mean: 0.45028698444366455, gen p mean: -0.25521406531333923, mean p set: 0.45086249709129333
loss_pred:0.052938200533390045, decouple_loss:0.040954746305942535
The modified gen p mean: 0.45063403248786926, gen p mean: -0.2529640793800354, mean p set: 0.4512137174606323
loss_pred:0.05320747569203377, decouple_loss:0.040287502110004425
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45066261291503906, gen p mean: -0.2579820454120636, mean p set: 0.4512418508529663
loss_pred:0.05156278610229492, decouple_loss:0.040046725422143936
The modified gen p mean: 0.4508725702762604, gen p mean: -0.25825533270835876, mean p set: 0.4514442980289459
loss_pred:0.05107073113322258, decouple_loss:0.03949194401502609
The modified gen p mean: 0.45068562030792236, gen p mean: -0.2557051479816437, mean p set: 0.4512638449668884
loss_pred:0.05182405561208725, decouple_loss:0.038842663168907166
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519987106323242, gen p mean: -0.2624804377555847, mean p set: 0.45257672667503357
loss_pred:0.04996534436941147, decouple_loss:0.040287986397743225
The modified gen p mean: 0.45131030678749084, gen p mean: -0.2577105462551117, mean p set: 0.45189735293388367
loss_pred:0.05463920906186104, decouple_loss:0.040454406291246414
The modified gen p mean: 0.45165178179740906, gen p mean: -0.2561647593975067, mean p set: 0.4522300362586975
loss_pred:0.05276868864893913, decouple_loss:0.03953814134001732
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
NaN value num: 0
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451213002204895, gen p mean: -0.2588485777378082, mean p set: 0.4517904818058014
loss_pred:0.052198611199855804, decouple_loss:0.04125605523586273
The modified gen p mean: 0.449582040309906, gen p mean: -0.25728654861450195, mean p set: 0.4501630365848541
The modified gen p mean: 0.45098698139190674, gen p mean: -0.2609637677669525, mean p set: 0.4515630006790161
loss_pred:0.05010702833533287, decouple_loss:0.043204791843891144
loss_pred:0.049879129976034164, decouple_loss:0.04027703404426575
2023-05-06 20:10:43 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.26102155447006226, mean p set: 0.4502691626548767
loss_pred:0.055039238184690475, decouple_loss:0.04270772263407707
The modified gen p mean: 0.44949251413345337, gen p mean: -0.25671643018722534, mean p set: 0.4500633478164673
loss_pred:0.05323650315403938, decouple_loss:0.041844990104436874
The modified gen p mean: 0.4497735798358917, gen p mean: -0.2579585313796997, mean p set: 0.45035696029663086
loss_pred:0.052947748452425, decouple_loss:0.042524371296167374
WV_1_PC_1_EH_0_PS_40_6, loss: 0.05585911497473717, avg_mse: 0.05728080868721008
current test mse: 0.057281
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496743679046631, gen p mean: -0.2587994635105133, mean p set: 0.4502543807029724
loss_pred:0.054329127073287964, decouple_loss:0.039870575070381165
The modified gen p mean: 0.44952884316444397, gen p mean: -0.2571639120578766, mean p set: 0.45010536909103394
loss_pred:0.0487043634057045, decouple_loss:0.03865671902894974
The modified gen p mean: 0.44918984174728394, gen p mean: -0.25501570105552673, mean p set: 0.4497682452201843
loss_pred:0.05113782733678818, decouple_loss:0.039320193231105804
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507747292518616, gen p mean: -0.25613337755203247, mean p set: 0.45135000348091125
loss_pred:0.05075235292315483, decouple_loss:0.03988642618060112
The modified gen p mean: 0.45114150643348694, gen p mean: -0.2563677430152893, mean p set: 0.45172062516212463
loss_pred:0.05348299816250801, decouple_loss:0.039676375687122345
The modified gen p mean: 0.45169997215270996, gen p mean: -0.25283899903297424, mean p set: 0.45228299498558044
loss_pred:0.049711182713508606, decouple_loss:0.04078497737646103
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498670697212219, gen p mean: -0.25484809279441833, mean p set: 0.4504365921020508
The modified gen p mean: 0.45144015550613403, gen p mean: -0.2506411373615265, mean p set: 0.4520223140716553
loss_pred:0.049257323145866394, decouple_loss:0.041025109589099884
loss_pred:0.050673481076955795, decouple_loss:0.040102165192365646
The modified gen p mean: 0.4504106342792511, gen p mean: -0.2520817816257477, mean p set: 0.4509831368923187
loss_pred:0.05431433394551277, decouple_loss:0.04116131365299225
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513207674026489, gen p mean: -0.25707945227622986, mean p set: 0.45190224051475525
loss_pred:0.05429425090551376, decouple_loss:0.04097240790724754
The modified gen p mean: 0.4519379436969757, gen p mean: -0.2569957971572876, mean p set: 0.45251601934432983
loss_pred:0.05162489414215088, decouple_loss:0.0398714616894722
The modified gen p mean: 0.45304080843925476, gen p mean: -0.2609916627407074, mean p set: 0.45361581444740295
loss_pred:0.05235140025615692, decouple_loss:0.0409054234623909
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45202022790908813, gen p mean: -0.26199114322662354, mean p set: 0.4525899887084961
loss_pred:0.05080762505531311, decouple_loss:0.03981572017073631
The modified gen p mean: 0.44950395822525024, gen p mean: -0.2671928107738495, mean p set: 0.45007672905921936
loss_pred:0.048651061952114105, decouple_loss:0.03856421262025833
The modified gen p mean: 0.45172610878944397, gen p mean: -0.2708609998226166, mean p set: 0.4522954225540161
loss_pred:0.048722557723522186, decouple_loss:0.039780378341674805
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45168548822402954, gen p mean: -0.2692700922489166, mean p set: 0.452263742685318
loss_pred:0.04947745054960251, decouple_loss:0.039755336940288544
The modified gen p mean: 0.45021942257881165, gen p mean: -0.26949557662010193, mean p set: 0.45079872012138367
loss_pred:0.053382422775030136, decouple_loss:0.03919244557619095
The modified gen p mean: 0.4516214430332184, gen p mean: -0.27055367827415466, mean p set: 0.452203631401062
loss_pred:0.051523737609386444, decouple_loss:0.039829038083553314
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107796788215637, gen p mean: -0.2898646295070648, mean p set: 0.4516623318195343
loss_pred:0.048026714473962784, decouple_loss:0.03948923572897911
The modified gen p mean: 0.4507772922515869, gen p mean: -0.2884257137775421, mean p set: 0.4513498842716217
loss_pred:0.04802685230970383, decouple_loss:0.04092337191104889
The modified gen p mean: 0.4492954611778259, gen p mean: -0.28517821431159973, mean p set: 0.44987794756889343
loss_pred:0.051949549466371536, decouple_loss:0.04175938293337822
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493582248687744, gen p mean: -0.2948879301548004, mean p set: 0.44993916153907776
loss_pred:0.04982183501124382, decouple_loss:0.04014604166150093
The modified gen p mean: 0.45157378911972046, gen p mean: -0.306231826543808, mean p set: 0.4521483778953552
loss_pred:0.053389254957437515, decouple_loss:0.04068184271454811
The modified gen p mean: 0.4518378973007202, gen p mean: -0.3029015362262726, mean p set: 0.45241761207580566
loss_pred:0.049661535769701004, decouple_loss:0.04054573178291321
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503355920314789, gen p mean: -0.28839245438575745, mean p set: 0.4509196877479553
loss_pred:0.053210534155368805, decouple_loss:0.04000046104192734
The modified gen p mean: 0.4516679048538208, gen p mean: -0.2887957692146301, mean p set: 0.4522424042224884
loss_pred:0.049543414264917374, decouple_loss:0.03957188129425049
The modified gen p mean: 0.4515700340270996, gen p mean: -0.2899705171585083, mean p set: 0.4521428644657135
loss_pred:0.047785624861717224, decouple_loss:0.0387006439268589
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089465379714966, gen p mean: -0.26045164465904236, mean p set: 0.45147088170051575
loss_pred:0.050512365996837616, decouple_loss:0.04122476279735565
The modified gen p mean: 0.44997110962867737, gen p mean: -0.26496487855911255, mean p set: 0.45054367184638977
loss_pred:0.048264794051647186, decouple_loss:0.03945999965071678
The modified gen p mean: 0.4526906907558441, gen p mean: -0.2644694149494171, mean p set: 0.4532740116119385
loss_pred:0.04884923994541168, decouple_loss:0.041226230561733246
2023-05-06 20:14:43 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.2531929612159729, mean p set: 0.4502691626548767
loss_pred:0.05415290594100952, decouple_loss:0.04286637902259827
The modified gen p mean: 0.44977593421936035, gen p mean: -0.24973899126052856, mean p set: 0.45035696029663086
The modified gen p mean: 0.44948622584342957, gen p mean: -0.24953167140483856, mean p set: 0.4500633478164673
loss_pred:0.052142348140478134, decouple_loss:0.04215369373559952
loss_pred:0.052576906979084015, decouple_loss:0.04232771322131157
WV_1_PC_1_EH_0_PS_40_6, loss: 0.055079855024814606, avg_mse: 0.056622181087732315
current test mse: 0.056622
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517013728618622, gen p mean: -0.2522760331630707, mean p set: 0.4522706866264343
The modified gen p mean: 0.45241931080818176, gen p mean: -0.25042274594306946, mean p set: 0.4529906213283539
loss_pred:0.050220318138599396, decouple_loss:0.041780877858400345
loss_pred:0.0499839223921299, decouple_loss:0.0411515086889267
The modified gen p mean: 0.4504365921020508, gen p mean: -0.2464333325624466, mean p set: 0.45101073384284973
loss_pred:0.052275463938713074, decouple_loss:0.04138382896780968
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019710063934326, gen p mean: -0.26114410161972046, mean p set: 0.4507746696472168
loss_pred:0.050844691693782806, decouple_loss:0.040776949375867844
The modified gen p mean: 0.45020341873168945, gen p mean: -0.2664833068847656, mean p set: 0.450778603553772
loss_pred:0.04989330470561981, decouple_loss:0.04042015224695206
The modified gen p mean: 0.45132923126220703, gen p mean: -0.2627372145652771, mean p set: 0.451905757188797
loss_pred:0.05067482218146324, decouple_loss:0.039570607244968414
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516335129737854, gen p mean: -0.28380444645881653, mean p set: 0.45220157504081726
loss_pred:0.04921352490782738, decouple_loss:0.039672158658504486
The modified gen p mean: 0.44930383563041687, gen p mean: -0.2849254906177521, mean p set: 0.4498836398124695
loss_pred:0.05111042782664299, decouple_loss:0.040774282068014145
The modified gen p mean: 0.44927552342414856, gen p mean: -0.2827468812465668, mean p set: 0.4498387575149536
loss_pred:0.0521036759018898, decouple_loss:0.040978867560625076
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45360496640205383, gen p mean: -0.299683153629303, mean p set: 0.45418456196784973
loss_pred:0.04924808442592621, decouple_loss:0.04248207062482834
The modified gen p mean: 0.4498250484466553, gen p mean: -0.297974169254303, mean p set: 0.4504096210002899
loss_pred:0.052187930792570114, decouple_loss:0.042103059589862823
The modified gen p mean: 0.4497164189815521, gen p mean: -0.30112478137016296, mean p set: 0.4502951502799988
loss_pred:0.047698233276605606, decouple_loss:0.041040290147066116
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45237669348716736, gen p mean: -0.29768624901771545, mean p set: 0.45294854044914246
loss_pred:0.05033692345023155, decouple_loss:0.043587878346443176
The modified gen p mean: 0.4509977698326111, gen p mean: -0.3012181520462036, mean p set: 0.4515727162361145
loss_pred:0.04853691905736923, decouple_loss:0.04053961858153343
The modified gen p mean: 0.4507550001144409, gen p mean: -0.2964223027229309, mean p set: 0.4513280689716339
loss_pred:0.050500594079494476, decouple_loss:0.042053353041410446
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45040905475616455, gen p mean: -0.28846022486686707, mean p set: 0.4509834945201874
loss_pred:0.04846912622451782, decouple_loss:0.04040202498435974
The modified gen p mean: 0.4532860517501831, gen p mean: -0.2872236371040344, mean p set: 0.453868567943573
loss_pred:0.05026673898100853, decouple_loss:0.04270438477396965
The modified gen p mean: 0.4497164785861969, gen p mean: -0.28522658348083496, mean p set: 0.45029133558273315
loss_pred:0.051069483160972595, decouple_loss:0.04037843272089958
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507342576980591, gen p mean: -0.2750328779220581, mean p set: 0.4513210654258728
loss_pred:0.050313711166381836, decouple_loss:0.040874775499105453
The modified gen p mean: 0.450242817401886, gen p mean: -0.2732938528060913, mean p set: 0.45082080364227295
loss_pred:0.04951757192611694, decouple_loss:0.042439937591552734
The modified gen p mean: 0.4510855972766876, gen p mean: -0.26980406045913696, mean p set: 0.4516597390174866
loss_pred:0.05089285969734192, decouple_loss:0.039843931794166565
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44940608739852905, gen p mean: -0.26701274514198303, mean p set: 0.449973464012146
loss_pred:0.05179116502404213, decouple_loss:0.0405205637216568
The modified gen p mean: 0.45108911395072937, gen p mean: -0.26915884017944336, mean p set: 0.45166799426078796
loss_pred:0.048691798001527786, decouple_loss:0.04098741337656975
The modified gen p mean: 0.4514244496822357, gen p mean: -0.265922874212265, mean p set: 0.45199474692344666
loss_pred:0.05072590708732605, decouple_loss:0.04070248082280159
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45196038484573364, gen p mean: -0.26830387115478516, mean p set: 0.4525294005870819
loss_pred:0.04793138429522514, decouple_loss:0.039245475083589554
The modified gen p mean: 0.4509696960449219, gen p mean: -0.2669549882411957, mean p set: 0.4515514075756073
loss_pred:0.051219452172517776, decouple_loss:0.04029858112335205
The modified gen p mean: 0.4497753381729126, gen p mean: -0.2702186107635498, mean p set: 0.4503602981567383
loss_pred:0.04775134474039078, decouple_loss:0.039797186851501465
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012000_3_24hr.npz
NaN value num: 0
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45110008120536804, gen p mean: -0.2776157557964325, mean p set: 0.451678067445755
The modified gen p mean: 0.4507380723953247, gen p mean: -0.2783662974834442, mean p set: 0.4513090252876282
loss_pred:0.05041187256574631, decouple_loss:0.04197246581315994
loss_pred:0.05079812556505203, decouple_loss:0.040216993540525436
The modified gen p mean: 0.4514763653278351, gen p mean: -0.2772256135940552, mean p set: 0.4520588517189026
loss_pred:0.04690971598029137, decouple_loss:0.040608737617731094
2023-05-06 20:19:31 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.28218382596969604, mean p set: 0.4502691626548767
loss_pred:0.053486552089452744, decouple_loss:0.04137914627790451
The modified gen p mean: 0.44977718591690063, gen p mean: -0.2798428535461426, mean p set: 0.45035696029663086
The modified gen p mean: 0.4494830369949341, gen p mean: -0.2803896963596344, mean p set: 0.4500633478164673
loss_pred:0.05175530165433884, decouple_loss:0.040845390409231186
loss_pred:0.05171293765306473, decouple_loss:0.04122514650225639
WV_1_PC_1_EH_0_PS_40_6, loss: 0.05437576025724411, avg_mse: 0.05593391880393028
current test mse: 0.055934
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514990746974945, gen p mean: -0.27936339378356934, mean p set: 0.45207884907722473
loss_pred:0.04881851747632027, decouple_loss:0.042935267090797424
The modified gen p mean: 0.4512188136577606, gen p mean: -0.27880391478538513, mean p set: 0.4517979919910431
loss_pred:0.05169947072863579, decouple_loss:0.04088426008820534
The modified gen p mean: 0.45069462060928345, gen p mean: -0.2775294780731201, mean p set: 0.4512752294540405
loss_pred:0.05043039843440056, decouple_loss:0.04237325116991997
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45026716589927673, gen p mean: -0.2774372100830078, mean p set: 0.4508480429649353
loss_pred:0.05090833455324173, decouple_loss:0.04027336835861206
The modified gen p mean: 0.4509539008140564, gen p mean: -0.2807873487472534, mean p set: 0.4515273869037628
loss_pred:0.04944123327732086, decouple_loss:0.03972403705120087
The modified gen p mean: 0.45136943459510803, gen p mean: -0.28029271960258484, mean p set: 0.4519437551498413
loss_pred:0.05027426406741142, decouple_loss:0.042293768376111984
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45249319076538086, gen p mean: -0.27991795539855957, mean p set: 0.4530660808086395
loss_pred:0.04775780439376831, decouple_loss:0.04252847284078598
The modified gen p mean: 0.4512495994567871, gen p mean: -0.2816905379295349, mean p set: 0.4518270194530487
loss_pred:0.05128483474254608, decouple_loss:0.041198406368494034
The modified gen p mean: 0.4509009122848511, gen p mean: -0.2787911891937256, mean p set: 0.4514729082584381
loss_pred:0.049780599772930145, decouple_loss:0.04280085861682892
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515562653541565, gen p mean: -0.27885618805885315, mean p set: 0.45213139057159424
loss_pred:0.05049628019332886, decouple_loss:0.043389953672885895
The modified gen p mean: 0.4507448971271515, gen p mean: -0.2856098711490631, mean p set: 0.45132210850715637
loss_pred:0.04838906228542328, decouple_loss:0.04295429587364197
The modified gen p mean: 0.4524705410003662, gen p mean: -0.2871585190296173, mean p set: 0.4530589282512665
loss_pred:0.049621254205703735, decouple_loss:0.043143630027770996
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45142796635627747, gen p mean: -0.28376808762550354, mean p set: 0.45199984312057495
The modified gen p mean: 0.45107394456863403, gen p mean: -0.2793004810810089, mean p set: 0.45164594054222107
loss_pred:0.04783206433057785, decouple_loss:0.04065551236271858
loss_pred:0.04659511148929596, decouple_loss:0.04130730777978897
The modified gen p mean: 0.45054030418395996, gen p mean: -0.2887934148311615, mean p set: 0.451120525598526
loss_pred:0.048244934529066086, decouple_loss:0.04014913737773895
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108699798583984, gen p mean: -0.2930893003940582, mean p set: 0.4516679346561432
loss_pred:0.04539027065038681, decouple_loss:0.04193861037492752
The modified gen p mean: 0.4526560604572296, gen p mean: -0.2995727062225342, mean p set: 0.4532293379306793
loss_pred:0.048935215920209885, decouple_loss:0.04277418553829193
The modified gen p mean: 0.4521925151348114, gen p mean: -0.29591676592826843, mean p set: 0.4527673125267029
loss_pred:0.04526707902550697, decouple_loss:0.04075494781136513
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089831948280334, gen p mean: -0.3002638816833496, mean p set: 0.4514724314212799
loss_pred:0.04923495650291443, decouple_loss:0.04080629721283913
The modified gen p mean: 0.4505635201931, gen p mean: -0.30140233039855957, mean p set: 0.4511375427246094
loss_pred:0.050312891602516174, decouple_loss:0.041872646659612656
The modified gen p mean: 0.4509671926498413, gen p mean: -0.30303436517715454, mean p set: 0.45155051350593567
loss_pred:0.04787720367312431, decouple_loss:0.041893910616636276
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516666531562805, gen p mean: -0.30732566118240356, mean p set: 0.45223382115364075
loss_pred:0.050202637910842896, decouple_loss:0.041535068303346634
The modified gen p mean: 0.4520385265350342, gen p mean: -0.3066752254962921, mean p set: 0.45262184739112854
loss_pred:0.04979843273758888, decouple_loss:0.04181770235300064
The modified gen p mean: 0.4498092830181122, gen p mean: -0.3025573492050171, mean p set: 0.4503815174102783
loss_pred:0.05015149340033531, decouple_loss:0.0415320098400116
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077407360076904, gen p mean: -0.30441519618034363, mean p set: 0.4513603150844574
loss_pred:0.05045885220170021, decouple_loss:0.042026735842227936
The modified gen p mean: 0.450199156999588, gen p mean: -0.303935706615448, mean p set: 0.4507789611816406
loss_pred:0.04740355163812637, decouple_loss:0.04158470407128334
The modified gen p mean: 0.4516015946865082, gen p mean: -0.30220356583595276, mean p set: 0.45217278599739075
loss_pred:0.05030311644077301, decouple_loss:0.041272830218076706
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511651396751404, gen p mean: -0.27747905254364014, mean p set: 0.4517427384853363
loss_pred:0.0505768358707428, decouple_loss:0.04375537857413292
The modified gen p mean: 0.4511583149433136, gen p mean: -0.2870619297027588, mean p set: 0.45173123478889465
loss_pred:0.05006592348217964, decouple_loss:0.041771791875362396
The modified gen p mean: 0.45117366313934326, gen p mean: -0.2829725444316864, mean p set: 0.451747864484787
loss_pred:0.05068834125995636, decouple_loss:0.04086983948945999
2023-05-06 20:23:30 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.2799699604511261, mean p set: 0.4502691626548767
loss_pred:0.05376521497964859, decouple_loss:0.04491511732339859
The modified gen p mean: 0.4494848847389221, gen p mean: -0.2745765149593353, mean p set: 0.4500633478164673
loss_pred:0.05084412917494774, decouple_loss:0.04413537308573723
The modified gen p mean: 0.44977521896362305, gen p mean: -0.2740404009819031, mean p set: 0.45035696029663086
loss_pred:0.050908882170915604, decouple_loss:0.044559139758348465
WV_1_PC_1_EH_0_PS_40_6, loss: 0.054066237062215805, avg_mse: 0.055470895022153854
current test mse: 0.055471
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518543779850006, gen p mean: -0.2689055800437927, mean p set: 0.45243194699287415
loss_pred:0.04813219606876373, decouple_loss:0.043016575276851654
The modified gen p mean: 0.4504898190498352, gen p mean: -0.2730700671672821, mean p set: 0.45107266306877136
loss_pred:0.04735863581299782, decouple_loss:0.04335431009531021
The modified gen p mean: 0.45111358165740967, gen p mean: -0.265347421169281, mean p set: 0.45167696475982666
loss_pred:0.050102874636650085, decouple_loss:0.04483327642083168
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45021069049835205, gen p mean: -0.2831592559814453, mean p set: 0.45078444480895996
The modified gen p mean: 0.45163026452064514, gen p mean: -0.2814585268497467, mean p set: 0.4522053301334381
loss_pred:0.04866985231637955, decouple_loss:0.04147953540086746
loss_pred:0.048217881470918655, decouple_loss:0.04309701919555664
The modified gen p mean: 0.4498414993286133, gen p mean: -0.2753734886646271, mean p set: 0.45041581988334656
loss_pred:0.04906440153717995, decouple_loss:0.04257827624678612
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45069512724876404, gen p mean: -0.29963555932044983, mean p set: 0.45127397775650024
The modified gen p mean: 0.45116353034973145, gen p mean: -0.30092474818229675, mean p set: 0.451744019985199
loss_pred:0.049465760588645935, decouple_loss:0.04296550899744034
loss_pred:0.0478132888674736, decouple_loss:0.04179553687572479
The modified gen p mean: 0.451718270778656, gen p mean: -0.2985747754573822, mean p set: 0.4522944986820221
loss_pred:0.04513833299279213, decouple_loss:0.04050751402974129
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45254984498023987, gen p mean: -0.2962815463542938, mean p set: 0.4531283378601074
loss_pred:0.04765528067946434, decouple_loss:0.04097242280840874
The modified gen p mean: 0.45060211420059204, gen p mean: -0.2948751449584961, mean p set: 0.4511760473251343
loss_pred:0.04846077784895897, decouple_loss:0.04144580662250519
The modified gen p mean: 0.4505690336227417, gen p mean: -0.2970212399959564, mean p set: 0.4511381685733795
loss_pred:0.049677036702632904, decouple_loss:0.041495632380247116
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45177674293518066, gen p mean: -0.3004798889160156, mean p set: 0.4523492455482483
loss_pred:0.05078177899122238, decouple_loss:0.04349358752369881
The modified gen p mean: 0.45138126611709595, gen p mean: -0.2971910536289215, mean p set: 0.45195576548576355
loss_pred:0.04897413030266762, decouple_loss:0.04117954894900322
The modified gen p mean: 0.4505707621574402, gen p mean: -0.2950325012207031, mean p set: 0.4511476457118988
loss_pred:0.04942365363240242, decouple_loss:0.042079053819179535
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521063268184662, gen p mean: -0.30992716550827026, mean p set: 0.45267629623413086
loss_pred:0.0481368824839592, decouple_loss:0.04201681911945343
The modified gen p mean: 0.45229098200798035, gen p mean: -0.31029874086380005, mean p set: 0.45286762714385986
loss_pred:0.047402266412973404, decouple_loss:0.042036108672618866
The modified gen p mean: 0.45201000571250916, gen p mean: -0.30587083101272583, mean p set: 0.4525812566280365
loss_pred:0.04768095910549164, decouple_loss:0.04105145111680031
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499135911464691, gen p mean: -0.305176317691803, mean p set: 0.45048749446868896
The modified gen p mean: 0.45042890310287476, gen p mean: -0.31023815274238586, mean p set: 0.4510006308555603
loss_pred:0.047536808997392654, decouple_loss:0.04101992025971413
loss_pred:0.04645712301135063, decouple_loss:0.04092259705066681
The modified gen p mean: 0.4516477584838867, gen p mean: -0.30674228072166443, mean p set: 0.45222827792167664
loss_pred:0.04842967540025711, decouple_loss:0.04176218807697296
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519531726837158, gen p mean: -0.29820308089256287, mean p set: 0.4525204300880432
loss_pred:0.047193076461553574, decouple_loss:0.04035436734557152
The modified gen p mean: 0.4511534869670868, gen p mean: -0.2987878918647766, mean p set: 0.4517285227775574
loss_pred:0.046541549265384674, decouple_loss:0.04038521647453308
The modified gen p mean: 0.4515770971775055, gen p mean: -0.300009161233902, mean p set: 0.4521510899066925
loss_pred:0.04623004049062729, decouple_loss:0.04053680971264839
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
NaN value num: 0
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490754008293152, gen p mean: -0.3016928732395172, mean p set: 0.44966015219688416
The modified gen p mean: 0.44839346408843994, gen p mean: -0.30157244205474854, mean p set: 0.44897153973579407
loss_pred:0.05193081870675087, decouple_loss:0.04361766576766968
loss_pred:0.0526670478284359, decouple_loss:0.04353544861078262
The modified gen p mean: 0.4496423602104187, gen p mean: -0.30578187108039856, mean p set: 0.4502195417881012
loss_pred:0.05458108335733414, decouple_loss:0.043852996081113815
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481673240661621, gen p mean: -0.30533692240715027, mean p set: 0.4487350583076477
loss_pred:0.04978855699300766, decouple_loss:0.04439712315797806
The modified gen p mean: 0.44860562682151794, gen p mean: -0.30604568123817444, mean p set: 0.449175626039505
loss_pred:0.04952305182814598, decouple_loss:0.0450526624917984
The modified gen p mean: 0.44985249638557434, gen p mean: -0.30162474513053894, mean p set: 0.45043838024139404
loss_pred:0.0490335114300251, decouple_loss:0.044740065932273865
2023-05-06 20:28:18 testing...
The modified gen p mean: 0.4494703710079193, gen p mean: -0.30528929829597473, mean p set: 0.4500633478164673
loss_pred:0.05018070340156555, decouple_loss:0.04443833604454994
The modified gen p mean: 0.4497881829738617, gen p mean: -0.30742841958999634, mean p set: 0.45035696029663086
loss_pred:0.05000114068388939, decouple_loss:0.044578224420547485
The modified gen p mean: 0.4497888386249542, gen p mean: -0.3102727234363556, mean p set: 0.4502691626548767
loss_pred:0.05215323716402054, decouple_loss:0.044917382299900055
WV_1_PC_1_EH_0_PS_40_6, loss: 0.053010594099760056, avg_mse: 0.054127682000398636
current test mse: 0.054128
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44897210597991943, gen p mean: -0.31202417612075806, mean p set: 0.4495510160923004
loss_pred:0.05277155712246895, decouple_loss:0.0442727766931057
The modified gen p mean: 0.449611634016037, gen p mean: -0.30886852741241455, mean p set: 0.4501812756061554
loss_pred:0.05225135385990143, decouple_loss:0.04502008482813835
The modified gen p mean: 0.4480753242969513, gen p mean: -0.3123427629470825, mean p set: 0.44864723086357117
loss_pred:0.051245033740997314, decouple_loss:0.046103402972221375
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890615344047546, gen p mean: -0.3127462565898895, mean p set: 0.4494764804840088
loss_pred:0.050806768238544464, decouple_loss:0.044611599296331406
The modified gen p mean: 0.44938403367996216, gen p mean: -0.3114977478981018, mean p set: 0.4499610364437103
loss_pred:0.05048901587724686, decouple_loss:0.04412470757961273
The modified gen p mean: 0.4495161175727844, gen p mean: -0.31383880972862244, mean p set: 0.45009905099868774
loss_pred:0.04964408278465271, decouple_loss:0.0438433475792408
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497974216938019, gen p mean: -0.31868085265159607, mean p set: 0.4503738284111023
loss_pred:0.04963845759630203, decouple_loss:0.04248396307229996
The modified gen p mean: 0.44863295555114746, gen p mean: -0.32270681858062744, mean p set: 0.44920605421066284
loss_pred:0.0508129820227623, decouple_loss:0.046129874885082245
The modified gen p mean: 0.4496540129184723, gen p mean: -0.3213513195514679, mean p set: 0.4502294957637787
loss_pred:0.05180129408836365, decouple_loss:0.04291582852602005
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486890137195587, gen p mean: -0.3236238956451416, mean p set: 0.44925686717033386
loss_pred:0.05034152418375015, decouple_loss:0.04437180235981941
The modified gen p mean: 0.44936326146125793, gen p mean: -0.32316094636917114, mean p set: 0.4499370753765106
loss_pred:0.05001489445567131, decouple_loss:0.04256712272763252
The modified gen p mean: 0.4502822756767273, gen p mean: -0.32754483819007874, mean p set: 0.45085832476615906
loss_pred:0.05077129229903221, decouple_loss:0.043023522943258286
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835636019706726, gen p mean: -0.3201831579208374, mean p set: 0.4489312171936035
loss_pred:0.049392104148864746, decouple_loss:0.04380028322339058
The modified gen p mean: 0.4495542049407959, gen p mean: -0.32659873366355896, mean p set: 0.4501313269138336
loss_pred:0.04980427399277687, decouple_loss:0.04452260211110115
The modified gen p mean: 0.44868484139442444, gen p mean: -0.32380592823028564, mean p set: 0.44925400614738464
loss_pred:0.05084619298577309, decouple_loss:0.04237942397594452
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44843369722366333, gen p mean: -0.31127220392227173, mean p set: 0.4490078091621399
loss_pred:0.05021427199244499, decouple_loss:0.041594069451093674
The modified gen p mean: 0.4480460584163666, gen p mean: -0.3126598298549652, mean p set: 0.4486234188079834
loss_pred:0.05083347111940384, decouple_loss:0.04206005111336708
The modified gen p mean: 0.44989439845085144, gen p mean: -0.31351375579833984, mean p set: 0.4504740536212921
loss_pred:0.04841333255171776, decouple_loss:0.04210617393255234
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497864246368408, gen p mean: -0.30017465353012085, mean p set: 0.45035961270332336
loss_pred:0.05117060989141464, decouple_loss:0.0410008579492569
The modified gen p mean: 0.44845154881477356, gen p mean: -0.29947444796562195, mean p set: 0.44902318716049194
loss_pred:0.05028299242258072, decouple_loss:0.04289035126566887
The modified gen p mean: 0.4492047131061554, gen p mean: -0.2992529571056366, mean p set: 0.4497784972190857
loss_pred:0.05153581500053406, decouple_loss:0.041804175823926926
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485478699207306, gen p mean: -0.29448166489601135, mean p set: 0.4491247832775116
The modified gen p mean: 0.44912782311439514, gen p mean: -0.292257696390152, mean p set: 0.4497062563896179
loss_pred:0.0511079803109169, decouple_loss:0.04247737303376198
loss_pred:0.048570167273283005, decouple_loss:0.042261041700839996
The modified gen p mean: 0.44953295588493347, gen p mean: -0.29217785596847534, mean p set: 0.450113981962204
loss_pred:0.05313371494412422, decouple_loss:0.04219493642449379
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939282536506653, gen p mean: -0.29677334427833557, mean p set: 0.44995957612991333
The modified gen p mean: 0.4491167664527893, gen p mean: -0.2967434525489807, mean p set: 0.44969442486763
loss_pred:0.04878067970275879, decouple_loss:0.04124531149864197
loss_pred:0.05100969597697258, decouple_loss:0.04139573499560356
The modified gen p mean: 0.44871610403060913, gen p mean: -0.2955612242221832, mean p set: 0.44929149746894836
loss_pred:0.05105723813176155, decouple_loss:0.04243443161249161
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44867876172065735, gen p mean: -0.29973214864730835, mean p set: 0.44925227761268616
loss_pred:0.048406150192022324, decouple_loss:0.04141106456518173
The modified gen p mean: 0.4490915834903717, gen p mean: -0.3036510646343231, mean p set: 0.44967401027679443
loss_pred:0.04911860078573227, decouple_loss:0.04048371687531471
The modified gen p mean: 0.450194388628006, gen p mean: -0.2997974753379822, mean p set: 0.4507625102996826
loss_pred:0.05169648677110672, decouple_loss:0.0418468713760376
2023-05-06 20:32:13 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.3053908348083496, mean p set: 0.4502691626548767
loss_pred:0.050993163138628006, decouple_loss:0.041219159960746765
The modified gen p mean: 0.44948577880859375, gen p mean: -0.30323782563209534, mean p set: 0.4500633478164673
loss_pred:0.04936147481203079, decouple_loss:0.040275800973176956
The modified gen p mean: 0.4497714340686798, gen p mean: -0.30478090047836304, mean p set: 0.45035696029663086
loss_pred:0.049455676227808, decouple_loss:0.04072562977671623
WV_1_PC_1_EH_0_PS_40_6, loss: 0.05197378247976303, avg_mse: 0.053664207458496094
current test mse: 0.053664
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496210217475891, gen p mean: -0.3080541491508484, mean p set: 0.4501986801624298
loss_pred:0.04810749739408493, decouple_loss:0.04084786772727966
The modified gen p mean: 0.44950011372566223, gen p mean: -0.30912482738494873, mean p set: 0.4500735104084015
loss_pred:0.048466574400663376, decouple_loss:0.04236864298582077
The modified gen p mean: 0.44961419701576233, gen p mean: -0.3027786910533905, mean p set: 0.45019885897636414
loss_pred:0.0512113943696022, decouple_loss:0.04216022416949272
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489597976207733, gen p mean: -0.31660136580467224, mean p set: 0.4495299160480499
The modified gen p mean: 0.4486084580421448, gen p mean: -0.3129003047943115, mean p set: 0.4491855800151825
loss_pred:0.05056677386164665, decouple_loss:0.04174940660595894
loss_pred:0.04936708137392998, decouple_loss:0.042042799293994904
The modified gen p mean: 0.44959568977355957, gen p mean: -0.31493741273880005, mean p set: 0.45017439126968384
loss_pred:0.05311521142721176, decouple_loss:0.041292704641819
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44980764389038086, gen p mean: -0.32021698355674744, mean p set: 0.450385719537735
loss_pred:0.047569211572408676, decouple_loss:0.040861885994672775
The modified gen p mean: 0.4494726061820984, gen p mean: -0.3214316666126251, mean p set: 0.4500521421432495
loss_pred:0.048614319413900375, decouple_loss:0.03947508707642555
The modified gen p mean: 0.4480949640274048, gen p mean: -0.3165939450263977, mean p set: 0.44867777824401855
loss_pred:0.0488114170730114, decouple_loss:0.03998735174536705
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44936811923980713, gen p mean: -0.3194543123245239, mean p set: 0.4499465525150299
loss_pred:0.04790376126766205, decouple_loss:0.03947713226079941
The modified gen p mean: 0.4500788152217865, gen p mean: -0.3202572464942932, mean p set: 0.4506526291370392
loss_pred:0.05125856027007103, decouple_loss:0.03978341072797775
The modified gen p mean: 0.44884565472602844, gen p mean: -0.31849542260169983, mean p set: 0.4494244158267975
loss_pred:0.047656573355197906, decouple_loss:0.04056853428483009
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495672583580017, gen p mean: -0.3178309202194214, mean p set: 0.4501429796218872
loss_pred:0.0482613705098629, decouple_loss:0.03975336626172066
The modified gen p mean: 0.4485715329647064, gen p mean: -0.31348782777786255, mean p set: 0.4491483271121979
loss_pred:0.04913249611854553, decouple_loss:0.041275881230831146
The modified gen p mean: 0.4488416314125061, gen p mean: -0.31415125727653503, mean p set: 0.4494204819202423
loss_pred:0.050236817449331284, decouple_loss:0.040431469678878784
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963571429252625, gen p mean: -0.31158992648124695, mean p set: 0.45020923018455505
loss_pred:0.0493893101811409, decouple_loss:0.04040548950433731
The modified gen p mean: 0.4478102922439575, gen p mean: -0.3081984519958496, mean p set: 0.4483890235424042
loss_pred:0.048865627497434616, decouple_loss:0.03986124321818352
The modified gen p mean: 0.44885513186454773, gen p mean: -0.30446726083755493, mean p set: 0.44943687319755554
loss_pred:0.048526208847761154, decouple_loss:0.03994125872850418
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449110746383667, gen p mean: -0.3097299635410309, mean p set: 0.4496876895427704
loss_pred:0.0494990274310112, decouple_loss:0.039321206510066986
The modified gen p mean: 0.449260413646698, gen p mean: -0.30733585357666016, mean p set: 0.44983765482902527
loss_pred:0.04613631218671799, decouple_loss:0.0387536995112896
The modified gen p mean: 0.44975563883781433, gen p mean: -0.3150590658187866, mean p set: 0.45033130049705505
loss_pred:0.04893312603235245, decouple_loss:0.03963897004723549
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45003560185432434, gen p mean: -0.315957248210907, mean p set: 0.45061272382736206
The modified gen p mean: 0.4481677711009979, gen p mean: -0.3109782636165619, mean p set: 0.44875091314315796loss_pred:0.05153069272637367, decouple_loss:0.039464257657527924
loss_pred:0.04741624742746353, decouple_loss:0.039716385304927826
The modified gen p mean: 0.44878047704696655, gen p mean: -0.3150750994682312, mean p set: 0.4493584930896759
loss_pred:0.0498674213886261, decouple_loss:0.04015154018998146
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
NaN value num: 0
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45354872941970825, gen p mean: -0.3102085292339325, mean p set: 0.4541240334510803
The modified gen p mean: 0.4518545866012573, gen p mean: -0.31276029348373413, mean p set: 0.452427476644516
loss_pred:0.05011572688817978, decouple_loss:0.043397456407547
loss_pred:0.047719284892082214, decouple_loss:0.04184623807668686
The modified gen p mean: 0.4501817524433136, gen p mean: -0.309549480676651, mean p set: 0.4507599174976349
loss_pred:0.046369779855012894, decouple_loss:0.04313550516963005
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45313429832458496, gen p mean: -0.30468669533729553, mean p set: 0.45371225476264954
loss_pred:0.046165283769369125, decouple_loss:0.04438408836722374
The modified gen p mean: 0.45180433988571167, gen p mean: -0.3031150698661804, mean p set: 0.4523839056491852
loss_pred:0.04750168323516846, decouple_loss:0.04317038878798485
The modified gen p mean: 0.4517812728881836, gen p mean: -0.30412164330482483, mean p set: 0.4523538649082184
loss_pred:0.0475241020321846, decouple_loss:0.041445061564445496
2023-05-06 20:37:07 testing...
The modified gen p mean: 0.4494858384132385, gen p mean: -0.303333580493927, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888386249542, gen p mean: -0.30668210983276367, mean p set: 0.4502691626548767
loss_pred:0.0480005145072937, decouple_loss:0.04086689278483391
loss_pred:0.05002797394990921, decouple_loss:0.04214891418814659
The modified gen p mean: 0.44977861642837524, gen p mean: -0.30394718050956726, mean p set: 0.45035696029663086
loss_pred:0.04799852520227432, decouple_loss:0.04119959473609924
WV_1_PC_1_EH_0_PS_40_6, loss: 0.050745926797389984, avg_mse: 0.05237216129899025
current test mse: 0.052372
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45141980051994324, gen p mean: -0.3003053367137909, mean p set: 0.45199844241142273
loss_pred:0.047268345952034, decouple_loss:0.04309134557843208
The modified gen p mean: 0.45059341192245483, gen p mean: -0.29645779728889465, mean p set: 0.45117396116256714
loss_pred:0.04662676155567169, decouple_loss:0.04523754492402077
The modified gen p mean: 0.4524060785770416, gen p mean: -0.29882681369781494, mean p set: 0.45299163460731506
loss_pred:0.04493257403373718, decouple_loss:0.04453275725245476
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45363056659698486, gen p mean: -0.3068873882293701, mean p set: 0.4542112350463867
The modified gen p mean: 0.45285364985466003, gen p mean: -0.3027655780315399, mean p set: 0.4534248113632202
loss_pred:0.049367889761924744, decouple_loss:0.04341458901762962
loss_pred:0.04783376678824425, decouple_loss:0.044850774109363556
The modified gen p mean: 0.45226433873176575, gen p mean: -0.3024273216724396, mean p set: 0.4528374671936035
loss_pred:0.04726339504122734, decouple_loss:0.04338480159640312
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45245322585105896, gen p mean: -0.30993422865867615, mean p set: 0.45302614569664
loss_pred:0.04782864451408386, decouple_loss:0.04238417372107506
The modified gen p mean: 0.4534190893173218, gen p mean: -0.3062015473842621, mean p set: 0.45400142669677734
loss_pred:0.04493776708841324, decouple_loss:0.04206621274352074
The modified gen p mean: 0.45347076654434204, gen p mean: -0.30605483055114746, mean p set: 0.4540506899356842
loss_pred:0.04681016877293587, decouple_loss:0.04359201341867447
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45118170976638794, gen p mean: -0.31503918766975403, mean p set: 0.4517534077167511
loss_pred:0.047282230108976364, decouple_loss:0.04330570623278618
The modified gen p mean: 0.45100662112236023, gen p mean: -0.3118197023868561, mean p set: 0.4515807330608368
loss_pred:0.047200899571180344, decouple_loss:0.044087860733270645
The modified gen p mean: 0.4515748620033264, gen p mean: -0.31284981966018677, mean p set: 0.4521428048610687
loss_pred:0.04709218069911003, decouple_loss:0.04304267093539238
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45120903849601746, gen p mean: -0.3183443248271942, mean p set: 0.45178741216659546
loss_pred:0.04793574661016464, decouple_loss:0.0428890734910965
The modified gen p mean: 0.4534907341003418, gen p mean: -0.3138710856437683, mean p set: 0.45406821370124817
loss_pred:0.046526238322257996, decouple_loss:0.04229544848203659
The modified gen p mean: 0.4518165588378906, gen p mean: -0.3111269176006317, mean p set: 0.45238205790519714
loss_pred:0.0467679537832737, decouple_loss:0.042137451469898224
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037904381752014, gen p mean: -0.32260578870773315, mean p set: 0.450962096452713
loss_pred:0.04602917283773422, decouple_loss:0.0425310917198658
The modified gen p mean: 0.4517185688018799, gen p mean: -0.32346782088279724, mean p set: 0.4522990584373474
loss_pred:0.0470384880900383, decouple_loss:0.043109238147735596
The modified gen p mean: 0.45263203978538513, gen p mean: -0.3221144676208496, mean p set: 0.4532091021537781
loss_pred:0.047912243753671646, decouple_loss:0.04363999515771866
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45109111070632935, gen p mean: -0.33338844776153564, mean p set: 0.4516587555408478
loss_pred:0.04515216499567032, decouple_loss:0.042362280189991
The modified gen p mean: 0.4512006938457489, gen p mean: -0.33291420340538025, mean p set: 0.4517782926559448
loss_pred:0.04751984402537346, decouple_loss:0.04229319840669632
The modified gen p mean: 0.45372986793518066, gen p mean: -0.3318510055541992, mean p set: 0.4543021321296692
loss_pred:0.045634061098098755, decouple_loss:0.041504181921482086
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532140791416168, gen p mean: -0.3305076062679291, mean p set: 0.45378997921943665
loss_pred:0.044447168707847595, decouple_loss:0.04087305814027786
The modified gen p mean: 0.45271065831184387, gen p mean: -0.332865446805954, mean p set: 0.4532904326915741
loss_pred:0.0466870442032814, decouple_loss:0.04073646664619446
The modified gen p mean: 0.45280271768569946, gen p mean: -0.3335633873939514, mean p set: 0.4533679187297821
loss_pred:0.04669536277651787, decouple_loss:0.04114649444818497
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45061492919921875, gen p mean: -0.32482898235321045, mean p set: 0.4511880576610565
loss_pred:0.04713904857635498, decouple_loss:0.04123184457421303
The modified gen p mean: 0.45204639434814453, gen p mean: -0.3265649974346161, mean p set: 0.4526262879371643
loss_pred:0.04530533775687218, decouple_loss:0.04159379377961159
The modified gen p mean: 0.45341330766677856, gen p mean: -0.32544851303100586, mean p set: 0.4539869725704193
loss_pred:0.046060483902692795, decouple_loss:0.04054246097803116
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499324858188629, gen p mean: -0.32233521342277527, mean p set: 0.4505046308040619
loss_pred:0.04348510503768921, decouple_loss:0.040984854102134705
The modified gen p mean: 0.4519471526145935, gen p mean: -0.3213575482368469, mean p set: 0.4525293707847595
loss_pred:0.04630199447274208, decouple_loss:0.04162091016769409
The modified gen p mean: 0.4540594816207886, gen p mean: -0.3176599144935608, mean p set: 0.45464667677879333
loss_pred:0.04861714690923691, decouple_loss:0.04124438390135765
2023-05-06 20:41:04 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.33150532841682434, mean p set: 0.4502691626548767
loss_pred:0.05136992782354355, decouple_loss:0.04314063861966133
The modified gen p mean: 0.4494924247264862, gen p mean: -0.3273111879825592, mean p set: 0.4500633478164673
loss_pred:0.048783205449581146, decouple_loss:0.04276735335588455
The modified gen p mean: 0.44977182149887085, gen p mean: -0.3260541558265686, mean p set: 0.45035696029663086
loss_pred:0.04856356605887413, decouple_loss:0.043092645704746246
WV_1_PC_1_EH_0_PS_40_6, loss: 0.051722243428230286, avg_mse: 0.05400349199771881
current test mse: 0.054003
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45095574855804443, gen p mean: -0.3262346386909485, mean p set: 0.4515247046947479
loss_pred:0.0460062101483345, decouple_loss:0.04198628291487694
The modified gen p mean: 0.4511537551879883, gen p mean: -0.3257809579372406, mean p set: 0.45174646377563477
loss_pred:0.04687827080488205, decouple_loss:0.04077760502696037
The modified gen p mean: 0.45267966389656067, gen p mean: -0.32367292046546936, mean p set: 0.4532560408115387
loss_pred:0.046606943011283875, decouple_loss:0.041025321930646896
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45340263843536377, gen p mean: -0.33567097783088684, mean p set: 0.45397165417671204
loss_pred:0.04464486613869667, decouple_loss:0.04049210250377655
The modified gen p mean: 0.4528844952583313, gen p mean: -0.3334220349788666, mean p set: 0.4534684121608734
loss_pred:0.04518140107393265, decouple_loss:0.04076901078224182
The modified gen p mean: 0.4505229890346527, gen p mean: -0.33378830552101135, mean p set: 0.4511021673679352
loss_pred:0.04600629583001137, decouple_loss:0.04093916714191437
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524697959423065, gen p mean: -0.33212774991989136, mean p set: 0.453043133020401
loss_pred:0.04547133669257164, decouple_loss:0.039473503828048706
The modified gen p mean: 0.4520634114742279, gen p mean: -0.3340175151824951, mean p set: 0.45263591408729553
loss_pred:0.04520684480667114, decouple_loss:0.038995202630758286
The modified gen p mean: 0.4523915648460388, gen p mean: -0.3364908695220947, mean p set: 0.4529651403427124
loss_pred:0.04518691450357437, decouple_loss:0.03937486931681633
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978904724121094, gen p mean: -0.33052000403404236, mean p set: 0.4503670632839203
loss_pred:0.04317672178149223, decouple_loss:0.039314474910497665
The modified gen p mean: 0.45216232538223267, gen p mean: -0.3266875147819519, mean p set: 0.4527439475059509
loss_pred:0.04453054815530777, decouple_loss:0.039739735424518585
The modified gen p mean: 0.45339375734329224, gen p mean: -0.3282164931297302, mean p set: 0.4539780914783478
loss_pred:0.045214805752038956, decouple_loss:0.03856082260608673
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523966610431671, gen p mean: -0.32684171199798584, mean p set: 0.45297572016716003
loss_pred:0.045777563005685806, decouple_loss:0.03891371935606003
The modified gen p mean: 0.4528787136077881, gen p mean: -0.3291871249675751, mean p set: 0.4534578025341034
loss_pred:0.04562612250447273, decouple_loss:0.03824172168970108
The modified gen p mean: 0.4535561203956604, gen p mean: -0.3297572135925293, mean p set: 0.4541327655315399
loss_pred:0.048277124762535095, decouple_loss:0.03973527252674103
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452667236328125, gen p mean: -0.3362482786178589, mean p set: 0.45324504375457764
loss_pred:0.04584207758307457, decouple_loss:0.037780411541461945
The modified gen p mean: 0.45293325185775757, gen p mean: -0.336306631565094, mean p set: 0.4535069465637207
loss_pred:0.043922483921051025, decouple_loss:0.03771035000681877
The modified gen p mean: 0.450631320476532, gen p mean: -0.3419434130191803, mean p set: 0.45120686292648315
loss_pred:0.04470054432749748, decouple_loss:0.03859362378716469
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521743059158325, gen p mean: -0.347779780626297, mean p set: 0.4527541399002075
loss_pred:0.04733789712190628, decouple_loss:0.03888491913676262
The modified gen p mean: 0.4526025652885437, gen p mean: -0.34700050950050354, mean p set: 0.45317909121513367
loss_pred:0.04524980112910271, decouple_loss:0.03820551931858063
The modified gen p mean: 0.45201385021209717, gen p mean: -0.3466450870037079, mean p set: 0.45258408784866333
loss_pred:0.047151509672403336, decouple_loss:0.03884919360280037
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
NaN value num: 0
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519067406654358, gen p mean: -0.3498687148094177, mean p set: 0.4524822235107422The modified gen p mean: 0.4495011866092682, gen p mean: -0.3566056489944458, mean p set: 0.4500787556171417
loss_pred:0.04797143116593361, decouple_loss:0.039095114916563034
loss_pred:0.047805044800043106, decouple_loss:0.03963053598999977
The modified gen p mean: 0.4496917724609375, gen p mean: -0.35143595933914185, mean p set: 0.45026499032974243
loss_pred:0.04621865972876549, decouple_loss:0.0400548130273819
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901877641677856, gen p mean: -0.3490775525569916, mean p set: 0.4496016502380371
The modified gen p mean: 0.4513624608516693, gen p mean: -0.34132903814315796, mean p set: 0.45194050669670105
loss_pred:0.04705268517136574, decouple_loss:0.03995177522301674
loss_pred:0.048683904111385345, decouple_loss:0.040769971907138824
The modified gen p mean: 0.4500172436237335, gen p mean: -0.34948474168777466, mean p set: 0.4505888819694519
loss_pred:0.04970821365714073, decouple_loss:0.04161960259079933
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491383135318756, gen p mean: -0.3416151702404022, mean p set: 0.4497094452381134
loss_pred:0.04823610186576843, decouple_loss:0.041547711938619614
The modified gen p mean: 0.4488835632801056, gen p mean: -0.33833733201026917, mean p set: 0.4494609236717224
loss_pred:0.04930533096194267, decouple_loss:0.04011015221476555
The modified gen p mean: 0.45164254307746887, gen p mean: -0.3500596284866333, mean p set: 0.45222410559654236
loss_pred:0.04815696179866791, decouple_loss:0.04013575240969658
2023-05-06 20:45:47 testing...
The modified gen p mean: 0.44948455691337585, gen p mean: -0.34244784712791443, mean p set: 0.4500633478164673
loss_pred:0.048579901456832886, decouple_loss:0.040596865117549896
The modified gen p mean: 0.4497888386249542, gen p mean: -0.34745287895202637, mean p set: 0.4502691626548767
loss_pred:0.050996191799640656, decouple_loss:0.041773442178964615
The modified gen p mean: 0.44977879524230957, gen p mean: -0.3406686782836914, mean p set: 0.45035696029663086
loss_pred:0.047735780477523804, decouple_loss:0.04118464142084122
WV_1_PC_1_EH_0_PS_40_6, loss: 0.0511632077395916, avg_mse: 0.053279370069503784
current test mse: 0.053279
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496520459651947, gen p mean: -0.34208035469055176, mean p set: 0.450222373008728
loss_pred:0.04706357419490814, decouple_loss:0.04185229912400246
The modified gen p mean: 0.4510137736797333, gen p mean: -0.342723548412323, mean p set: 0.4515989124774933
loss_pred:0.04791828244924545, decouple_loss:0.03834953531622887
The modified gen p mean: 0.4523857533931732, gen p mean: -0.3405660092830658, mean p set: 0.4529705345630646
loss_pred:0.04774557426571846, decouple_loss:0.0401642844080925
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904395937919617, gen p mean: -0.32571080327033997, mean p set: 0.44961294531822205
loss_pred:0.04895281791687012, decouple_loss:0.0409185029566288
The modified gen p mean: 0.44947782158851624, gen p mean: -0.3259202241897583, mean p set: 0.45004913210868835
loss_pred:0.04788457229733467, decouple_loss:0.04134737700223923
The modified gen p mean: 0.4508889317512512, gen p mean: -0.3254280090332031, mean p set: 0.45147207379341125
loss_pred:0.04812059551477432, decouple_loss:0.043220795691013336
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835957884788513, gen p mean: -0.33118173480033875, mean p set: 0.4489399194717407
The modified gen p mean: 0.4509776532649994, gen p mean: -0.3254883587360382, mean p set: 0.4515543580055237
loss_pred:0.04510870948433876, decouple_loss:0.04141075164079666
loss_pred:0.04876524582505226, decouple_loss:0.04356871917843819
The modified gen p mean: 0.45104122161865234, gen p mean: -0.32744094729423523, mean p set: 0.45162320137023926
loss_pred:0.049835413694381714, decouple_loss:0.04061438888311386
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822272658348083, gen p mean: -0.34017032384872437, mean p set: 0.44880592823028564
loss_pred:0.04616227746009827, decouple_loss:0.040811408311128616
The modified gen p mean: 0.4504341781139374, gen p mean: -0.3420048952102661, mean p set: 0.45101216435432434
loss_pred:0.045173902064561844, decouple_loss:0.039404917508363724
The modified gen p mean: 0.44973224401474, gen p mean: -0.3386792242527008, mean p set: 0.45030519366264343
loss_pred:0.04528346285223961, decouple_loss:0.04111099615693092
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507855772972107, gen p mean: -0.3408881425857544, mean p set: 0.4513741731643677
loss_pred:0.04681345820426941, decouple_loss:0.04165364056825638
The modified gen p mean: 0.4489361047744751, gen p mean: -0.3478797376155853, mean p set: 0.4495096802711487
loss_pred:0.047078896313905716, decouple_loss:0.04184165596961975
The modified gen p mean: 0.4509184658527374, gen p mean: -0.34855276346206665, mean p set: 0.45149263739585876
loss_pred:0.046561140567064285, decouple_loss:0.03956448286771774
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504941999912262, gen p mean: -0.3475554883480072, mean p set: 0.45106494426727295
loss_pred:0.04793129488825798, decouple_loss:0.04053894057869911
The modified gen p mean: 0.4501502215862274, gen p mean: -0.3390440344810486, mean p set: 0.4507306218147278
loss_pred:0.046726346015930176, decouple_loss:0.04212210327386856
The modified gen p mean: 0.44817450642585754, gen p mean: -0.34043392539024353, mean p set: 0.4487481415271759
loss_pred:0.04566267132759094, decouple_loss:0.042532630264759064
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448516845703125, gen p mean: -0.32931840419769287, mean p set: 0.4490891993045807
loss_pred:0.04808889701962471, decouple_loss:0.04068433493375778
The modified gen p mean: 0.449033260345459, gen p mean: -0.3328043520450592, mean p set: 0.4496089518070221
loss_pred:0.048316746950149536, decouple_loss:0.041138701140880585
The modified gen p mean: 0.45039451122283936, gen p mean: -0.3325274884700775, mean p set: 0.45097601413726807
loss_pred:0.048035815358161926, decouple_loss:0.03980039432644844
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489884376525879, gen p mean: -0.31753259897232056, mean p set: 0.4495715796947479
loss_pred:0.047748956829309464, decouple_loss:0.04021140933036804
The modified gen p mean: 0.448723167181015, gen p mean: -0.3218463659286499, mean p set: 0.44929495453834534
loss_pred:0.04470108076930046, decouple_loss:0.040695082396268845
The modified gen p mean: 0.4498575031757355, gen p mean: -0.33399152755737305, mean p set: 0.45042943954467773
loss_pred:0.046424925327301025, decouple_loss:0.03907478228211403
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879958033561707, gen p mean: -0.3331378400325775, mean p set: 0.44938743114471436
loss_pred:0.044785451143980026, decouple_loss:0.04270569607615471
The modified gen p mean: 0.45067885518074036, gen p mean: -0.3289037048816681, mean p set: 0.45125457644462585
loss_pred:0.04653431102633476, decouple_loss:0.04132668301463127
The modified gen p mean: 0.45039093494415283, gen p mean: -0.33032357692718506, mean p set: 0.450965940952301
loss_pred:0.048663049936294556, decouple_loss:0.0445106215775013
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969359040260315, gen p mean: -0.33986690640449524, mean p set: 0.4502660930156708
loss_pred:0.048690345138311386, decouple_loss:0.03988504037261009
The modified gen p mean: 0.45163393020629883, gen p mean: -0.33338963985443115, mean p set: 0.45220720767974854
loss_pred:0.04678139090538025, decouple_loss:0.04134704917669296
The modified gen p mean: 0.4483219385147095, gen p mean: -0.3394126296043396, mean p set: 0.4489029347896576
loss_pred:0.044517599046230316, decouple_loss:0.040245916694402695
2023-05-06 20:49:44 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.3439595103263855, mean p set: 0.4502691626548767
loss_pred:0.050958726555109024, decouple_loss:0.042274463921785355
The modified gen p mean: 0.44978511333465576, gen p mean: -0.3366999924182892, mean p set: 0.45035696029663086
The modified gen p mean: 0.4494958817958832, gen p mean: -0.33903968334198, mean p set: 0.4500633478164673
loss_pred:0.04794277250766754, decouple_loss:0.042410191148519516
loss_pred:0.0479460284113884, decouple_loss:0.04173367843031883
WV_1_PC_1_EH_0_PS_40_6, loss: 0.0510561466217041, avg_mse: 0.05286054685711861
current test mse: 0.052861
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531552195549011, gen p mean: -0.3334939181804657, mean p set: 0.45373791456222534
loss_pred:0.04846164211630821, decouple_loss:0.04079405218362808
The modified gen p mean: 0.4497566223144531, gen p mean: -0.33603066205978394, mean p set: 0.4503369629383087
loss_pred:0.046641573309898376, decouple_loss:0.04047746583819389
The modified gen p mean: 0.44899749755859375, gen p mean: -0.3420403003692627, mean p set: 0.4495759904384613
loss_pred:0.048759326338768005, decouple_loss:0.03993434086441994
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45070111751556396, gen p mean: -0.32458704710006714, mean p set: 0.45127683877944946
loss_pred:0.04490766301751137, decouple_loss:0.03911802917718887
The modified gen p mean: 0.45278486609458923, gen p mean: -0.3252044916152954, mean p set: 0.4533670246601105
loss_pred:0.047245848923921585, decouple_loss:0.039628900587558746
The modified gen p mean: 0.45008817315101624, gen p mean: -0.33094412088394165, mean p set: 0.45067140460014343
loss_pred:0.04645686224102974, decouple_loss:0.039592284709215164
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511273503303528, gen p mean: -0.3168441951274872, mean p set: 0.4517059326171875
loss_pred:0.04954802617430687, decouple_loss:0.041372496634721756
The modified gen p mean: 0.4527319073677063, gen p mean: -0.32127708196640015, mean p set: 0.45330584049224854
loss_pred:0.04773002862930298, decouple_loss:0.040689900517463684
The modified gen p mean: 0.4494863748550415, gen p mean: -0.3208470046520233, mean p set: 0.45005717873573303
loss_pred:0.047074172645807266, decouple_loss:0.03871104121208191
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44920608401298523, gen p mean: -0.3234369158744812, mean p set: 0.4497845768928528
loss_pred:0.047576989978551865, decouple_loss:0.03835685923695564
The modified gen p mean: 0.44910019636154175, gen p mean: -0.31561750173568726, mean p set: 0.4496786296367645
loss_pred:0.044774893671274185, decouple_loss:0.039328496903181076
The modified gen p mean: 0.4483458697795868, gen p mean: -0.3154247999191284, mean p set: 0.44892165064811707
loss_pred:0.04609307274222374, decouple_loss:0.040539175271987915
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855621457099915, gen p mean: -0.3182918429374695, mean p set: 0.4491318166255951
The modified gen p mean: 0.4488004148006439, gen p mean: -0.3162391781806946, mean p set: 0.4493706524372101
loss_pred:0.044684749096632004, decouple_loss:0.038530491292476654
loss_pred:0.044429194182157516, decouple_loss:0.038327597081661224
The modified gen p mean: 0.4509056508541107, gen p mean: -0.31280815601348877, mean p set: 0.45148617029190063
loss_pred:0.04594201594591141, decouple_loss:0.037597618997097015
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504028856754303, gen p mean: -0.3228020668029785, mean p set: 0.45097923278808594
loss_pred:0.04379671439528465, decouple_loss:0.03804078325629234
The modified gen p mean: 0.44857102632522583, gen p mean: -0.32264262437820435, mean p set: 0.44914600253105164
loss_pred:0.045838963240385056, decouple_loss:0.03939787670969963
The modified gen p mean: 0.44916993379592896, gen p mean: -0.3219364285469055, mean p set: 0.4497406780719757
loss_pred:0.044168125838041306, decouple_loss:0.03817596659064293
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501509666442871, gen p mean: -0.3316110074520111, mean p set: 0.4507175385951996
The modified gen p mean: 0.44962310791015625, gen p mean: -0.33849701285362244, mean p set: 0.4501922130584717loss_pred:0.044835202395915985, decouple_loss:0.039638761430978775
loss_pred:0.0464128814637661, decouple_loss:0.03792719170451164
The modified gen p mean: 0.4494111239910126, gen p mean: -0.32910481095314026, mean p set: 0.44999220967292786
loss_pred:0.045485321432352066, decouple_loss:0.03828854113817215
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
NaN value num: 0
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503451883792877, gen p mean: -0.3458428382873535, mean p set: 0.45091211795806885
loss_pred:0.0462869331240654, decouple_loss:0.038344334810972214
The modified gen p mean: 0.45121464133262634, gen p mean: -0.34819215536117554, mean p set: 0.45178547501564026
The modified gen p mean: 0.4513920545578003, gen p mean: -0.34118741750717163, mean p set: 0.451975017786026
loss_pred:0.04446592181921005, decouple_loss:0.03925871104001999
loss_pred:0.04512821510434151, decouple_loss:0.040302127599716187
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499557614326477, gen p mean: -0.35448065400123596, mean p set: 0.45052674412727356
loss_pred:0.04500831291079521, decouple_loss:0.04011767357587814
The modified gen p mean: 0.4484623074531555, gen p mean: -0.3485485911369324, mean p set: 0.4490357041358948
loss_pred:0.04494447261095047, decouple_loss:0.03980817273259163
The modified gen p mean: 0.4515186846256256, gen p mean: -0.3541703522205353, mean p set: 0.452089786529541
loss_pred:0.04451264441013336, decouple_loss:0.04097766429185867
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45260658860206604, gen p mean: -0.3381408452987671, mean p set: 0.45318490266799927
loss_pred:0.04589684680104256, decouple_loss:0.0392913818359375
The modified gen p mean: 0.4519782066345215, gen p mean: -0.3454776108264923, mean p set: 0.4525558054447174
loss_pred:0.04460472986102104, decouple_loss:0.039630960673093796
The modified gen p mean: 0.4521641135215759, gen p mean: -0.3414335250854492, mean p set: 0.45273545384407043
loss_pred:0.04454934597015381, decouple_loss:0.04089922830462456
2023-05-06 20:54:30 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.34478747844696045, mean p set: 0.4502691626548767
loss_pred:0.04856466129422188, decouple_loss:0.04101705551147461
The modified gen p mean: 0.44949424266815186, gen p mean: -0.34222719073295593, mean p set: 0.4500633478164673
loss_pred:0.046465110033750534, decouple_loss:0.04021555557847023
The modified gen p mean: 0.4497861862182617, gen p mean: -0.3408046066761017, mean p set: 0.45035696029663086
loss_pred:0.04645182192325592, decouple_loss:0.04098835960030556
WV_1_PC_1_EH_0_PS_40_6, loss: 0.04919755086302757, avg_mse: 0.05135262757539749
current test mse: 0.051353
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503595530986786, gen p mean: -0.34089794754981995, mean p set: 0.4509369134902954
loss_pred:0.045649442821741104, decouple_loss:0.03886592760682106
The modified gen p mean: 0.4530649185180664, gen p mean: -0.342660516500473, mean p set: 0.4536430835723877
loss_pred:0.04664090648293495, decouple_loss:0.0398854985833168
The modified gen p mean: 0.45361191034317017, gen p mean: -0.3380667269229889, mean p set: 0.4541929364204407
loss_pred:0.04540199413895607, decouple_loss:0.03974047303199768
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451237291097641, gen p mean: -0.35152673721313477, mean p set: 0.4518203139305115
loss_pred:0.04337348788976669, decouple_loss:0.038143452256917953
The modified gen p mean: 0.4511941969394684, gen p mean: -0.35130560398101807, mean p set: 0.45177412033081055
loss_pred:0.043681371957063675, decouple_loss:0.04092191532254219
The modified gen p mean: 0.4526224434375763, gen p mean: -0.3502879738807678, mean p set: 0.45320096611976624
loss_pred:0.044661179184913635, decouple_loss:0.03937062248587608
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507669508457184, gen p mean: -0.36072149872779846, mean p set: 0.45133697986602783
loss_pred:0.045367706567049026, decouple_loss:0.03784112259745598
The modified gen p mean: 0.4511541426181793, gen p mean: -0.36384424567222595, mean p set: 0.4517350196838379
loss_pred:0.043173786252737045, decouple_loss:0.03707375004887581
The modified gen p mean: 0.4516378343105316, gen p mean: -0.36808648705482483, mean p set: 0.45221275091171265
loss_pred:0.04531724005937576, decouple_loss:0.03785236179828644
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508783221244812, gen p mean: -0.3635525405406952, mean p set: 0.4514558017253876
The modified gen p mean: 0.4506629407405853, gen p mean: -0.3639107048511505, mean p set: 0.45124614238739014
loss_pred:0.045052558183670044, decouple_loss:0.03879525884985924
loss_pred:0.04483115300536156, decouple_loss:0.039203573018312454
The modified gen p mean: 0.4504460394382477, gen p mean: -0.3632395267486572, mean p set: 0.4510199725627899
loss_pred:0.0451255664229393, decouple_loss:0.03916742280125618
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45117080211639404, gen p mean: -0.3627576529979706, mean p set: 0.451738178730011
The modified gen p mean: 0.4496484100818634, gen p mean: -0.36041712760925293, mean p set: 0.45022767782211304loss_pred:0.043347228318452835, decouple_loss:0.03804035484790802
loss_pred:0.045102208852767944, decouple_loss:0.03907950222492218
The modified gen p mean: 0.4521217942237854, gen p mean: -0.3627568483352661, mean p set: 0.45269572734832764
loss_pred:0.04343900829553604, decouple_loss:0.03881021961569786
Traceback (most recent call last):
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 350, in <module>
    train_wrapper(model)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 278, in train_wrapper
    trainer.train(model, ims, real_input_flag, args, itr)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/trainer.py", line 25, in train
    cost = model.train(ims, real_input_flag)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/models/model_factory_multiGPU.py", line 68, in train
    loss.mean().backward()
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/_tensor.py", line 396, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/autograd/__init__.py", line 173, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: CUDA out of memory. Tried to allocate 1.50 GiB (GPU 0; 39.42 GiB total capacity; 34.87 GiB already allocated; 1.48 GiB free; 36.18 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF