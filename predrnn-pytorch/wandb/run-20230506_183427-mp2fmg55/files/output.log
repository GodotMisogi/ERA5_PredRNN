
load model: /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_0_PC_1_EH_0_PS_40_6/model_2000.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
train_data_files nums: 125
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500598609447479, gen p mean: -0.7166632413864136, mean p set: 0.45054012537002563
The modified gen p mean: 0.44996151328086853, gen p mean: -0.7173186540603638, mean p set: 0.450441837310791
loss_pred:0.027277357876300812, decouple_loss:0.013827941380441189
loss_pred:0.026753755286335945, decouple_loss:0.0141232805326581
The modified gen p mean: 0.4492179751396179, gen p mean: -0.7182131409645081, mean p set: 0.4496982991695404
loss_pred:0.026199694722890854, decouple_loss:0.014228949323296547
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024293661117554, gen p mean: -0.6738952994346619, mean p set: 0.45072323083877563
The modified gen p mean: 0.45142999291419983, gen p mean: -0.6757153868675232, mean p set: 0.45191025733947754
The modified gen p mean: 0.4504571557044983, gen p mean: -0.6687994003295898, mean p set: 0.450937420129776
loss_pred:0.12247506529092789, decouple_loss:0.1660425066947937
loss_pred:0.11853441596031189, decouple_loss:0.16172419488430023
loss_pred:0.1201736256480217, decouple_loss:0.16540545225143433
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214036107063293, gen p mean: -0.5032997131347656, mean p set: 0.45262065529823303
The modified gen p mean: 0.45292118191719055, gen p mean: -0.49479374289512634, mean p set: 0.45340150594711304
The modified gen p mean: 0.45108312368392944, gen p mean: -0.4978964626789093, mean p set: 0.45156341791152954
loss_pred:0.04627776890993118, decouple_loss:0.1445557028055191
loss_pred:0.046267829835414886, decouple_loss:0.14807789027690887
loss_pred:0.04645848274230957, decouple_loss:0.14452803134918213
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45263898372650146, gen p mean: -0.6145926117897034, mean p set: 0.45311927795410156
The modified gen p mean: 0.45090562105178833, gen p mean: -0.6139571070671082, mean p set: 0.4513859152793884
The modified gen p mean: 0.4497902989387512, gen p mean: -0.6129127740859985, mean p set: 0.4502705931663513
loss_pred:0.05260181054472923, decouple_loss:0.16406556963920593
loss_pred:0.053659770637750626, decouple_loss:0.16806213557720184
loss_pred:0.053511202335357666, decouple_loss:0.17147433757781982
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504399001598358, gen p mean: -0.619834303855896, mean p set: 0.4509201943874359
The modified gen p mean: 0.44920673966407776, gen p mean: -0.6292280554771423, mean p set: 0.44968703389167786
The modified gen p mean: 0.4520683288574219, gen p mean: -0.6211603879928589, mean p set: 0.4525485932826996
loss_pred:0.05149232596158981, decouple_loss:0.10981238633394241
loss_pred:0.050347648561000824, decouple_loss:0.10986912250518799
loss_pred:0.05193483456969261, decouple_loss:0.10792568325996399
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049917697906494, gen p mean: -0.5315744876861572, mean p set: 0.45097947120666504
The modified gen p mean: 0.4504377841949463, gen p mean: -0.529098629951477, mean p set: 0.4509181082248688
The modified gen p mean: 0.45261842012405396, gen p mean: -0.5264514088630676, mean p set: 0.45309871435165405
loss_pred:0.046110283583402634, decouple_loss:0.10322241485118866
loss_pred:0.04566464200615883, decouple_loss:0.10219612717628479
loss_pred:0.04592741280794144, decouple_loss:0.10187642276287079
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513232409954071, gen p mean: -0.5353136658668518, mean p set: 0.4518035352230072
The modified gen p mean: 0.45020055770874023, gen p mean: -0.535040557384491, mean p set: 0.45068085193634033
The modified gen p mean: 0.45019471645355225, gen p mean: -0.5352081060409546, mean p set: 0.45067504048347473
loss_pred:0.04343918338418007, decouple_loss:0.09482859820127487
loss_pred:0.0409601628780365, decouple_loss:0.09603351354598999
loss_pred:0.04182853177189827, decouple_loss:0.09432598948478699
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45041683316230774, gen p mean: -0.5309995412826538, mean p set: 0.4508971571922302
The modified gen p mean: 0.4517694413661957, gen p mean: -0.5275809168815613, mean p set: 0.4522497057914734
The modified gen p mean: 0.4504302144050598, gen p mean: -0.5304780602455139, mean p set: 0.4509105384349823
loss_pred:0.04042966663837433, decouple_loss:0.09216214716434479
loss_pred:0.04179790988564491, decouple_loss:0.09424059092998505
loss_pred:0.0412742905318737, decouple_loss:0.09316591918468475
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915419816970825, gen p mean: -0.5292794108390808, mean p set: 0.44963446259498596
The modified gen p mean: 0.4525906443595886, gen p mean: -0.5214827060699463, mean p set: 0.4530709385871887
The modified gen p mean: 0.4496538043022156, gen p mean: -0.5208587646484375, mean p set: 0.4501340985298157
loss_pred:0.04139089584350586, decouple_loss:0.0836305245757103
loss_pred:0.04201352596282959, decouple_loss:0.08304869383573532
loss_pred:0.04218071699142456, decouple_loss:0.08301007002592087
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494568109512329, gen p mean: -0.5185307860374451, mean p set: 0.449937105178833
The modified gen p mean: 0.449970006942749, gen p mean: -0.5255042910575867, mean p set: 0.4504503011703491
The modified gen p mean: 0.44935160875320435, gen p mean: -0.5214276909828186, mean p set: 0.44983193278312683
loss_pred:0.040663838386535645, decouple_loss:0.07913997024297714loss_pred:0.03887186944484711, decouple_loss:0.07892408221960068
loss_pred:0.04142411798238754, decouple_loss:0.07982996106147766
2023-05-06 18:41:09 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.5348270535469055, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5295653343200684, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5315146446228027, mean p set: 0.4500633478164673
loss_pred:0.04333283379673958, decouple_loss:0.07774706184864044
loss_pred:0.041204191744327545, decouple_loss:0.07631175965070724
loss_pred:0.04139268025755882, decouple_loss:0.07527671009302139
WV_0_PC_1_EH_0_PS_40_6, loss: 0.045798830687999725, avg_mse: 0.04732656851410866
current test mse: 0.047327
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518848955631256, gen p mean: -0.5288553833961487, mean p set: 0.4523652195930481
The modified gen p mean: 0.450580358505249, gen p mean: -0.5374417304992676, mean p set: 0.4510606527328491
loss_pred:0.04182925447821617, decouple_loss:0.07515087723731995
loss_pred:0.039326172322034836, decouple_loss:0.07746464759111404
The modified gen p mean: 0.4503708481788635, gen p mean: -0.5347186326980591, mean p set: 0.4508511424064636
loss_pred:0.03894975036382675, decouple_loss:0.0765083059668541
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45054343342781067, gen p mean: -0.5551609992980957, mean p set: 0.4510236978530884The modified gen p mean: 0.4501752555370331, gen p mean: -0.565732479095459, mean p set: 0.4506555497646332
The modified gen p mean: 0.4500761032104492, gen p mean: -0.5580698251724243, mean p set: 0.4505563974380493
loss_pred:0.03801021724939346, decouple_loss:0.0725833848118782
loss_pred:0.0381762832403183, decouple_loss:0.06973055005073547
loss_pred:0.0401502288877964, decouple_loss:0.07014790922403336
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45299434661865234, gen p mean: -0.5789380073547363, mean p set: 0.45347464084625244
The modified gen p mean: 0.45007869601249695, gen p mean: -0.579062283039093, mean p set: 0.45055902004241943
The modified gen p mean: 0.45138290524482727, gen p mean: -0.5746454000473022, mean p set: 0.45186319947242737
loss_pred:0.038199570029973984, decouple_loss:0.06717699766159058
loss_pred:0.038349684327840805, decouple_loss:0.06637518852949142
loss_pred:0.038456398993730545, decouple_loss:0.06725896894931793
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515954256057739, gen p mean: -0.5794102549552917, mean p set: 0.45207569003105164
The modified gen p mean: 0.4514337480068207, gen p mean: -0.577411949634552, mean p set: 0.4519140422344208
The modified gen p mean: 0.45068982243537903, gen p mean: -0.5815828442573547, mean p set: 0.4511701166629791
loss_pred:0.03634538874030113, decouple_loss:0.06355831027030945loss_pred:0.03744099661707878, decouple_loss:0.06214090809226036
loss_pred:0.035753894597291946, decouple_loss:0.0648500919342041
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507702589035034, gen p mean: -0.5757908225059509, mean p set: 0.4512505531311035
The modified gen p mean: 0.4494049847126007, gen p mean: -0.5757820010185242, mean p set: 0.4498852789402008
loss_pred:0.03670451045036316, decouple_loss:0.06266605854034424
loss_pred:0.03731086105108261, decouple_loss:0.06269989162683487
The modified gen p mean: 0.4500267803668976, gen p mean: -0.5751997828483582, mean p set: 0.4505070447921753
loss_pred:0.03696158528327942, decouple_loss:0.0619502067565918
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526252746582031, gen p mean: -0.6041260957717896, mean p set: 0.4531055688858032
The modified gen p mean: 0.450313001871109, gen p mean: -0.5971279740333557, mean p set: 0.4507932960987091
The modified gen p mean: 0.45139604806900024, gen p mean: -0.6064993739128113, mean p set: 0.45187634229660034
loss_pred:0.03553643822669983, decouple_loss:0.05919567123055458
loss_pred:0.033450882881879807, decouple_loss:0.058399345725774765
loss_pred:0.03440168499946594, decouple_loss:0.060982972383499146
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45000267028808594, gen p mean: -0.6074469089508057, mean p set: 0.4504829943180084
The modified gen p mean: 0.44951653480529785, gen p mean: -0.6073153614997864, mean p set: 0.44999685883522034
The modified gen p mean: 0.4519236981868744, gen p mean: -0.614941418170929, mean p set: 0.4524039626121521
loss_pred:0.032369017601013184, decouple_loss:0.05572660267353058
loss_pred:0.033633504062891006, decouple_loss:0.056028805673122406
loss_pred:0.03418929502367973, decouple_loss:0.05879589915275574
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502231180667877, gen p mean: -0.6025166511535645, mean p set: 0.4507034122943878
The modified gen p mean: 0.45062196254730225, gen p mean: -0.5999976992607117, mean p set: 0.45110225677490234
The modified gen p mean: 0.4532553255558014, gen p mean: -0.6027011871337891, mean p set: 0.4537356197834015
loss_pred:0.03309917449951172, decouple_loss:0.053564686328172684
loss_pred:0.0329320915043354, decouple_loss:0.05467676371335983
loss_pred:0.03446711599826813, decouple_loss:0.054824285209178925
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960251450538635, gen p mean: -0.5883479714393616, mean p set: 0.45008277893066406
The modified gen p mean: 0.45270371437072754, gen p mean: -0.5946828126907349, mean p set: 0.45318400859832764
The modified gen p mean: 0.45077088475227356, gen p mean: -0.5932555198669434, mean p set: 0.45125120878219604
loss_pred:0.033655375242233276, decouple_loss:0.0520048514008522
loss_pred:0.034109849482774734, decouple_loss:0.05256040021777153
loss_pred:0.03366973251104355, decouple_loss:0.0510886125266552
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
NaN value num: 0
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475889503955841, gen p mean: -0.5868179798126221, mean p set: 0.4480692446231842
The modified gen p mean: 0.45018404722213745, gen p mean: -0.6030662655830383, mean p set: 0.45066434144973755
The modified gen p mean: 0.44958388805389404, gen p mean: -0.5901720523834229, mean p set: 0.45006415247917175
loss_pred:0.036270871758461, decouple_loss:0.051740292459726334
loss_pred:0.03768443688750267, decouple_loss:0.048356834799051285
loss_pred:0.036001309752464294, decouple_loss:0.04914792254567146
2023-05-06 18:45:55 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6068233251571655, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5985792279243469, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.600909411907196, mean p set: 0.4500633478164673
loss_pred:0.03511912003159523, decouple_loss:0.04946388676762581
loss_pred:0.0334603525698185, decouple_loss:0.04884358495473862
loss_pred:0.034049466252326965, decouple_loss:0.048333313316106796
WV_0_PC_1_EH_0_PS_40_6, loss: 0.036653660237789154, avg_mse: 0.03981352224946022
current test mse: 0.039814
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489491581916809, gen p mean: -0.6084626317024231, mean p set: 0.4494294226169586
The modified gen p mean: 0.4497879147529602, gen p mean: -0.6123680472373962, mean p set: 0.4502682387828827
loss_pred:0.036190565675497055, decouple_loss:0.0481083020567894
loss_pred:0.03515950217843056, decouple_loss:0.04988725855946541
The modified gen p mean: 0.44905567169189453, gen p mean: -0.6036003828048706, mean p set: 0.44953596591949463
loss_pred:0.035335760563611984, decouple_loss:0.04858918488025665
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44954660534858704, gen p mean: -0.6308937668800354, mean p set: 0.45002689957618713
The modified gen p mean: 0.4469609260559082, gen p mean: -0.6214510798454285, mean p set: 0.4474412202835083
loss_pred:0.03513924032449722, decouple_loss:0.047679636627435684
loss_pred:0.03518097102642059, decouple_loss:0.04814595729112625
The modified gen p mean: 0.4503217935562134, gen p mean: -0.6337009072303772, mean p set: 0.45080211758613586
loss_pred:0.034510038793087006, decouple_loss:0.049466799944639206
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479564130306244, gen p mean: -0.6248154044151306, mean p set: 0.4484367072582245
The modified gen p mean: 0.44901084899902344, gen p mean: -0.6358476877212524, mean p set: 0.44949114322662354
The modified gen p mean: 0.45001980662345886, gen p mean: -0.6361695528030396, mean p set: 0.4505000710487366
loss_pred:0.03450588136911392, decouple_loss:0.04570205882191658
loss_pred:0.03389196842908859, decouple_loss:0.04615502431988716
loss_pred:0.03446495905518532, decouple_loss:0.04515354707837105
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495875835418701, gen p mean: -0.6301670074462891, mean p set: 0.4500678777694702
The modified gen p mean: 0.4476543366909027, gen p mean: -0.6165446043014526, mean p set: 0.4481346309185028
loss_pred:0.03395073860883713, decouple_loss:0.044454317539930344
loss_pred:0.034741733223199844, decouple_loss:0.04274195432662964
The modified gen p mean: 0.4486970007419586, gen p mean: -0.627666711807251, mean p set: 0.44917726516723633
loss_pred:0.03311534598469734, decouple_loss:0.04319388419389725
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915780425071716, gen p mean: -0.6243104338645935, mean p set: 0.44963809847831726
The modified gen p mean: 0.4501849412918091, gen p mean: -0.6234586834907532, mean p set: 0.4506652057170868
loss_pred:0.03320172429084778, decouple_loss:0.04257650673389435
The modified gen p mean: 0.4507370591163635, gen p mean: -0.6331048607826233, mean p set: 0.451217383146286
loss_pred:0.03237505257129669, decouple_loss:0.041689664125442505
loss_pred:0.03280464932322502, decouple_loss:0.04293688386678696
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484270215034485, gen p mean: -0.615073561668396, mean p set: 0.4489073157310486
The modified gen p mean: 0.44730865955352783, gen p mean: -0.6092386841773987, mean p set: 0.44778892397880554
The modified gen p mean: 0.44948768615722656, gen p mean: -0.6163082718849182, mean p set: 0.44996798038482666
loss_pred:0.03351424261927605, decouple_loss:0.03882674500346184
loss_pred:0.03362191841006279, decouple_loss:0.03954717516899109
loss_pred:0.034138232469558716, decouple_loss:0.03849610313773155
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799813628196716, gen p mean: -0.6051618456840515, mean p set: 0.44847843050956726
The modified gen p mean: 0.4491044878959656, gen p mean: -0.6191196441650391, mean p set: 0.4495847821235657
The modified gen p mean: 0.4487400949001312, gen p mean: -0.6079757213592529, mean p set: 0.4492203891277313
loss_pred:0.0332249216735363, decouple_loss:0.03878963366150856
loss_pred:0.03261498734354973, decouple_loss:0.040018230676651
loss_pred:0.03261116147041321, decouple_loss:0.039942171424627304
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491068422794342, gen p mean: -0.619979977607727, mean p set: 0.4495871365070343
The modified gen p mean: 0.44789645075798035, gen p mean: -0.6189180612564087, mean p set: 0.44837674498558044
The modified gen p mean: 0.4493502676486969, gen p mean: -0.6231023669242859, mean p set: 0.449830561876297
loss_pred:0.03358517959713936, decouple_loss:0.038900088518857956
loss_pred:0.031342536211013794, decouple_loss:0.03970573842525482
loss_pred:0.032664794474840164, decouple_loss:0.03956194967031479
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840848445892334, gen p mean: -0.6317198276519775, mean p set: 0.44888877868652344
The modified gen p mean: 0.44981124997138977, gen p mean: -0.6381953954696655, mean p set: 0.45029157400131226
The modified gen p mean: 0.4493815302848816, gen p mean: -0.6404995322227478, mean p set: 0.4498618543148041
loss_pred:0.03292595595121384, decouple_loss:0.038286928087472916loss_pred:0.031931132078170776, decouple_loss:0.03746606782078743
loss_pred:0.0313388966023922, decouple_loss:0.03831057250499725
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494367837905884, gen p mean: -0.6363840103149414, mean p set: 0.4499170780181885
The modified gen p mean: 0.4487517476081848, gen p mean: -0.6319072842597961, mean p set: 0.4492320418357849
The modified gen p mean: 0.44856566190719604, gen p mean: -0.6345915198326111, mean p set: 0.44904592633247375
loss_pred:0.031730905175209045, decouple_loss:0.03663037344813347
loss_pred:0.030877873301506042, decouple_loss:0.035850949585437775
loss_pred:0.033229995518922806, decouple_loss:0.037565506994724274
2023-05-06 18:49:33 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.644324004650116, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6345952153205872, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6375938057899475, mean p set: 0.4500633478164673
loss_pred:0.032292578369379044, decouple_loss:0.03703730180859566
loss_pred:0.030602846294641495, decouple_loss:0.03598961979150772
loss_pred:0.031288906931877136, decouple_loss:0.03592141345143318
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03321058303117752, avg_mse: 0.03726824373006821
current test mse: 0.037268
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491023123264313, gen p mean: -0.6390492916107178, mean p set: 0.44958263635635376
The modified gen p mean: 0.44812843203544617, gen p mean: -0.6368820667266846, mean p set: 0.44860872626304626
loss_pred:0.031744640320539474, decouple_loss:0.03519020602107048
loss_pred:0.030428145080804825, decouple_loss:0.03486255556344986
The modified gen p mean: 0.44922003149986267, gen p mean: -0.6429234743118286, mean p set: 0.44970032572746277
loss_pred:0.031440410763025284, decouple_loss:0.035138122737407684
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503835141658783, gen p mean: -0.6464396119117737, mean p set: 0.4508638381958008
The modified gen p mean: 0.4495446979999542, gen p mean: -0.6471890807151794, mean p set: 0.45002496242523193
The modified gen p mean: 0.4482823312282562, gen p mean: -0.6394402980804443, mean p set: 0.4487626254558563
loss_pred:0.030048726126551628, decouple_loss:0.03377658128738403
loss_pred:0.03187192231416702, decouple_loss:0.033556967973709106
loss_pred:0.030713530257344246, decouple_loss:0.03369995951652527
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474564790725708, gen p mean: -0.6256253123283386, mean p set: 0.4479367434978485
The modified gen p mean: 0.4475134015083313, gen p mean: -0.6284902095794678, mean p set: 0.4479937255382538
The modified gen p mean: 0.44785863161087036, gen p mean: -0.6186457872390747, mean p set: 0.44833892583847046
loss_pred:0.030709603801369667, decouple_loss:0.03328380733728409
loss_pred:0.03140649199485779, decouple_loss:0.03340865671634674
loss_pred:0.03223526105284691, decouple_loss:0.032735127955675125
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943657517433167, gen p mean: -0.6158362627029419, mean p set: 0.44991692900657654
The modified gen p mean: 0.4478062689304352, gen p mean: -0.6121416687965393, mean p set: 0.4482865631580353
The modified gen p mean: 0.44962504506111145, gen p mean: -0.6248032450675964, mean p set: 0.45010536909103394
loss_pred:0.033242903649806976, decouple_loss:0.03169296309351921
loss_pred:0.03213348612189293, decouple_loss:0.03195447847247124
loss_pred:0.032251760363578796, decouple_loss:0.031467072665691376
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447001188993454, gen p mean: -0.6146895289421082, mean p set: 0.4474814832210541
The modified gen p mean: 0.4493086040019989, gen p mean: -0.6129048466682434, mean p set: 0.449788898229599
The modified gen p mean: 0.45017313957214355, gen p mean: -0.6313429474830627, mean p set: 0.45065340399742126
loss_pred:0.03141812980175018, decouple_loss:0.03121250867843628
loss_pred:0.03202540799975395, decouple_loss:0.030573735013604164
loss_pred:0.030844565480947495, decouple_loss:0.032809779047966
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44899824261665344, gen p mean: -0.6304858326911926, mean p set: 0.4494785666465759
The modified gen p mean: 0.4490993618965149, gen p mean: -0.6386919021606445, mean p set: 0.449579656124115
The modified gen p mean: 0.4474480152130127, gen p mean: -0.6378753185272217, mean p set: 0.4479283094406128
loss_pred:0.032283805310726166, decouple_loss:0.02828248217701912
loss_pred:0.03165208920836449, decouple_loss:0.027961784973740578
loss_pred:0.03112778253853321, decouple_loss:0.029019128531217575
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484054148197174, gen p mean: -0.6480840444564819, mean p set: 0.4488857388496399
The modified gen p mean: 0.44697052240371704, gen p mean: -0.6468465924263, mean p set: 0.44745081663131714
The modified gen p mean: 0.44877147674560547, gen p mean: -0.6590890884399414, mean p set: 0.44925177097320557
loss_pred:0.031294625252485275, decouple_loss:0.02820933237671852
loss_pred:0.031026119366288185, decouple_loss:0.028427854180336
loss_pred:0.03142287954688072, decouple_loss:0.030993115156888962
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44989821314811707, gen p mean: -0.649335503578186, mean p set: 0.45037850737571716
The modified gen p mean: 0.44869574904441833, gen p mean: -0.6473745703697205, mean p set: 0.44917601346969604
The modified gen p mean: 0.44855383038520813, gen p mean: -0.6422131061553955, mean p set: 0.4490341246128082
loss_pred:0.03068941831588745, decouple_loss:0.028647946193814278
loss_pred:0.031855568289756775, decouple_loss:0.029257962480187416
loss_pred:0.0295012965798378, decouple_loss:0.028927819803357124
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486750662326813, gen p mean: -0.6538245677947998, mean p set: 0.44915536046028137
The modified gen p mean: 0.4487094581127167, gen p mean: -0.6562354564666748, mean p set: 0.4491897523403168
The modified gen p mean: 0.4485195279121399, gen p mean: -0.6563185453414917, mean p set: 0.4489997923374176
loss_pred:0.03138574957847595, decouple_loss:0.027915360406041145
loss_pred:0.030749069526791573, decouple_loss:0.028338057920336723
loss_pred:0.030622271820902824, decouple_loss:0.027644528076052666
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
NaN value num: 0
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488801956176758, gen p mean: -0.6705607175827026, mean p set: 0.44936051964759827
The modified gen p mean: 0.45057055354118347, gen p mean: -0.6584768295288086, mean p set: 0.45105084776878357
The modified gen p mean: 0.4519200325012207, gen p mean: -0.6673221588134766, mean p set: 0.4524003565311432
loss_pred:0.030213601887226105, decouple_loss:0.03464892879128456
loss_pred:0.029681481420993805, decouple_loss:0.03361732140183449
loss_pred:0.02946658432483673, decouple_loss:0.03212461248040199
2023-05-06 18:54:39 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.661504864692688, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6508939266204834, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6543907523155212, mean p set: 0.4500633478164673
loss_pred:0.030388779938220978, decouple_loss:0.0291915126144886
loss_pred:0.028843842446804047, decouple_loss:0.02790883742272854
loss_pred:0.029284367337822914, decouple_loss:0.027747290208935738
WV_0_PC_1_EH_0_PS_40_6, loss: 0.030919790267944336, avg_mse: 0.03522956371307373
current test mse: 0.03523
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44871675968170166, gen p mean: -0.6584709286689758, mean p set: 0.44919705390930176
The modified gen p mean: 0.4495847821235657, gen p mean: -0.657450258731842, mean p set: 0.45006507635116577
loss_pred:0.029238944873213768, decouple_loss:0.03013460896909237
loss_pred:0.03012312948703766, decouple_loss:0.029617592692375183
The modified gen p mean: 0.4506303369998932, gen p mean: -0.6501547694206238, mean p set: 0.4511106312274933
loss_pred:0.029624400660395622, decouple_loss:0.032740190625190735
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523296058177948, gen p mean: -0.6425509452819824, mean p set: 0.4528099000453949
The modified gen p mean: 0.4497251510620117, gen p mean: -0.6457602381706238, mean p set: 0.4502054452896118
The modified gen p mean: 0.4501352906227112, gen p mean: -0.6458244323730469, mean p set: 0.45061561465263367
loss_pred:0.02847074344754219, decouple_loss:0.029408873990178108
loss_pred:0.028988001868128777, decouple_loss:0.028514347970485687
loss_pred:0.028296057134866714, decouple_loss:0.028348546475172043
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481624960899353, gen p mean: -0.6440807580947876, mean p set: 0.448642760515213
The modified gen p mean: 0.44792619347572327, gen p mean: -0.6357042193412781, mean p set: 0.44840651750564575
The modified gen p mean: 0.44793641567230225, gen p mean: -0.6461279392242432, mean p set: 0.44841670989990234
loss_pred:0.029776625335216522, decouple_loss:0.028066610917448997
loss_pred:0.029614411294460297, decouple_loss:0.02846732921898365
loss_pred:0.028610924258828163, decouple_loss:0.02878035418689251
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495719373226166, gen p mean: -0.6724109649658203, mean p set: 0.45005226135253906
The modified gen p mean: 0.4494689106941223, gen p mean: -0.6751691699028015, mean p set: 0.4499492049217224
The modified gen p mean: 0.4485178291797638, gen p mean: -0.669015109539032, mean p set: 0.4489981234073639
loss_pred:0.029388893395662308, decouple_loss:0.026352567598223686
loss_pred:0.02797781676054001, decouple_loss:0.02690298669040203
loss_pred:0.02860555239021778, decouple_loss:0.0274818055331707
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012331008911133, gen p mean: -0.6680518984794617, mean p set: 0.4506036043167114
The modified gen p mean: 0.45036041736602783, gen p mean: -0.6718518733978271, mean p set: 0.45084071159362793
The modified gen p mean: 0.450179785490036, gen p mean: -0.6703103184700012, mean p set: 0.4506600499153137
loss_pred:0.02909889817237854, decouple_loss:0.025568177923560143
loss_pred:0.02779218927025795, decouple_loss:0.02488168701529503
loss_pred:0.028784532099962234, decouple_loss:0.024969087913632393
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713103771209717, gen p mean: -0.6547922492027283, mean p set: 0.4476113021373749
The modified gen p mean: 0.44886693358421326, gen p mean: -0.6602343320846558, mean p set: 0.44934722781181335
The modified gen p mean: 0.44791144132614136, gen p mean: -0.6499516367912292, mean p set: 0.4483916759490967
loss_pred:0.029228901490569115, decouple_loss:0.025738000869750977
loss_pred:0.028441665694117546, decouple_loss:0.02551712468266487
loss_pred:0.02869325876235962, decouple_loss:0.02446594461798668
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512498378753662, gen p mean: -0.6594433784484863, mean p set: 0.4517301619052887
The modified gen p mean: 0.44817906618118286, gen p mean: -0.6664175987243652, mean p set: 0.44865939021110535
The modified gen p mean: 0.45044204592704773, gen p mean: -0.6543954014778137, mean p set: 0.4509223401546478
loss_pred:0.027923069894313812, decouple_loss:0.025973176583647728
loss_pred:0.0284628514200449, decouple_loss:0.025833239778876305
loss_pred:0.027682647109031677, decouple_loss:0.025989457964897156
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477386474609375, gen p mean: -0.6633914113044739, mean p set: 0.4482189118862152
The modified gen p mean: 0.44977957010269165, gen p mean: -0.674838125705719, mean p set: 0.45025986433029175
The modified gen p mean: 0.44996973872184753, gen p mean: -0.6745803952217102, mean p set: 0.45045000314712524
loss_pred:0.02942810393869877, decouple_loss:0.02381524257361889
loss_pred:0.028450671583414078, decouple_loss:0.024034738540649414
loss_pred:0.02873930148780346, decouple_loss:0.02357584238052368
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503643810749054, gen p mean: -0.680184543132782, mean p set: 0.4508446753025055
The modified gen p mean: 0.4481627643108368, gen p mean: -0.683336615562439, mean p set: 0.4486430585384369
The modified gen p mean: 0.44891878962516785, gen p mean: -0.6881355047225952, mean p set: 0.44939908385276794
loss_pred:0.02769533544778824, decouple_loss:0.0243791863322258loss_pred:0.027842462062835693, decouple_loss:0.024813788011670113
loss_pred:0.027189895510673523, decouple_loss:0.0238196924328804
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496050179004669, gen p mean: -0.6866781711578369, mean p set: 0.450085312128067
The modified gen p mean: 0.45041823387145996, gen p mean: -0.6792359948158264, mean p set: 0.45089852809906006
The modified gen p mean: 0.44997620582580566, gen p mean: -0.6877073645591736, mean p set: 0.45045650005340576
loss_pred:0.0278954915702343, decouple_loss:0.024312568828463554
loss_pred:0.028544656932353973, decouple_loss:0.024274662137031555
loss_pred:0.027817700058221817, decouple_loss:0.02366405725479126
2023-05-06 18:58:16 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6632986068725586, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6770815253257751, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.668667733669281, mean p set: 0.4500633478164673
loss_pred:0.02855851873755455, decouple_loss:0.025201816111803055
loss_pred:0.030071118846535683, decouple_loss:0.025732452049851418
loss_pred:0.02901182509958744, decouple_loss:0.024799002334475517
WV_0_PC_1_EH_0_PS_40_6, loss: 0.030476044863462448, avg_mse: 0.03534891456365585
current test mse: 0.035349
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763854146003723, gen p mean: -0.6710323095321655, mean p set: 0.44811883568763733
The modified gen p mean: 0.4495965242385864, gen p mean: -0.6729151606559753, mean p set: 0.45007678866386414
loss_pred:0.027963997796177864, decouple_loss:0.023660730570554733
loss_pred:0.02900681272149086, decouple_loss:0.022510794922709465
The modified gen p mean: 0.4498252868652344, gen p mean: -0.6670500636100769, mean p set: 0.4503055810928345
loss_pred:0.02840181067585945, decouple_loss:0.023038338869810104
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906988739967346, gen p mean: -0.6649782657623291, mean p set: 0.44955018162727356
The modified gen p mean: 0.450557142496109, gen p mean: -0.6590247750282288, mean p set: 0.4510374367237091
The modified gen p mean: 0.45015621185302734, gen p mean: -0.6624692678451538, mean p set: 0.45063650608062744
loss_pred:0.028161892667412758, decouple_loss:0.022109344601631165
loss_pred:0.027719205245375633, decouple_loss:0.02286549098789692
loss_pred:0.02845918945968151, decouple_loss:0.02181260660290718
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449848473072052, gen p mean: -0.6759746670722961, mean p set: 0.4503287672996521
The modified gen p mean: 0.44890153408050537, gen p mean: -0.6722838878631592, mean p set: 0.44938188791275024
The modified gen p mean: 0.4504495859146118, gen p mean: -0.665845513343811, mean p set: 0.4509299099445343
loss_pred:0.028559621423482895, decouple_loss:0.022561410441994667
loss_pred:0.0273305531591177, decouple_loss:0.02222687378525734
loss_pred:0.02758624777197838, decouple_loss:0.02273668721318245
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44883424043655396, gen p mean: -0.6809670329093933, mean p set: 0.44931453466415405
The modified gen p mean: 0.44855108857154846, gen p mean: -0.6842806339263916, mean p set: 0.44903138279914856
The modified gen p mean: 0.4492427706718445, gen p mean: -0.684100866317749, mean p set: 0.4497230648994446
loss_pred:0.02805432677268982, decouple_loss:0.022563237696886063loss_pred:0.02836613357067108, decouple_loss:0.02188653126358986
loss_pred:0.028067270293831825, decouple_loss:0.021613527089357376
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44882020354270935, gen p mean: -0.695305585861206, mean p set: 0.44930049777030945
The modified gen p mean: 0.4496047794818878, gen p mean: -0.6883960366249084, mean p set: 0.4500850439071655
The modified gen p mean: 0.45065709948539734, gen p mean: -0.6899109482765198, mean p set: 0.45113739371299744
loss_pred:0.027422895655035973, decouple_loss:0.022207820788025856
loss_pred:0.02801589109003544, decouple_loss:0.020962204784154892
loss_pred:0.027265703305602074, decouple_loss:0.02193843573331833
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812336564064026, gen p mean: -0.67791348695755, mean p set: 0.44860365986824036
The modified gen p mean: 0.4481504261493683, gen p mean: -0.6879299283027649, mean p set: 0.448630690574646
The modified gen p mean: 0.45028096437454224, gen p mean: -0.6839597225189209, mean p set: 0.45076125860214233
loss_pred:0.027079198509454727, decouple_loss:0.020914075896143913loss_pred:0.027658306062221527, decouple_loss:0.022233985364437103
loss_pred:0.02725416049361229, decouple_loss:0.020910732448101044
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44952043890953064, gen p mean: -0.677322268486023, mean p set: 0.45000073313713074
The modified gen p mean: 0.4484577775001526, gen p mean: -0.6865021586418152, mean p set: 0.4489381015300751
The modified gen p mean: 0.4493057429790497, gen p mean: -0.687275230884552, mean p set: 0.4497860372066498
loss_pred:0.02752561867237091, decouple_loss:0.02059684321284294
loss_pred:0.027605829760432243, decouple_loss:0.020438238978385925
loss_pred:0.028040887787938118, decouple_loss:0.019887439906597137
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488838016986847, gen p mean: -0.6768666505813599, mean p set: 0.4493641257286072
The modified gen p mean: 0.4509778916835785, gen p mean: -0.6813064813613892, mean p set: 0.451458215713501
The modified gen p mean: 0.4502688944339752, gen p mean: -0.6747378706932068, mean p set: 0.4507491886615753
loss_pred:0.02655963785946369, decouple_loss:0.02191178686916828
loss_pred:0.027211898937821388, decouple_loss:0.021442836150527
loss_pred:0.027443334460258484, decouple_loss:0.0226682648062706
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779255986213684, gen p mean: -0.6795037388801575, mean p set: 0.44827285408973694
The modified gen p mean: 0.45000165700912476, gen p mean: -0.6836275458335876, mean p set: 0.45048198103904724
The modified gen p mean: 0.449876070022583, gen p mean: -0.6836901307106018, mean p set: 0.4503563344478607
loss_pred:0.02801322378218174, decouple_loss:0.02026558108627796
loss_pred:0.027145175263285637, decouple_loss:0.020003609359264374
loss_pred:0.02661803923547268, decouple_loss:0.019599640741944313
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
NaN value num: 0
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516427218914032, gen p mean: -0.6887447834014893, mean p set: 0.4521230459213257
The modified gen p mean: 0.4480988383293152, gen p mean: -0.6752724647521973, mean p set: 0.4485791027545929
The modified gen p mean: 0.45107895135879517, gen p mean: -0.690582811832428, mean p set: 0.45155924558639526
loss_pred:0.028707977384328842, decouple_loss:0.02174403704702854
loss_pred:0.02813173085451126, decouple_loss:0.02311762236058712
loss_pred:0.027750952169299126, decouple_loss:0.021835969761013985
2023-05-06 19:03:21 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6834333539009094, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6687501072883606, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.674752414226532, mean p set: 0.4500633478164673
loss_pred:0.02945789508521557, decouple_loss:0.022567376494407654
loss_pred:0.02796570025384426, decouple_loss:0.022369304671883583
loss_pred:0.02828771434724331, decouple_loss:0.021941455081105232
WV_0_PC_1_EH_0_PS_40_6, loss: 0.029685070738196373, avg_mse: 0.0345483236014843
current test mse: 0.034548
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874826073646545, gen p mean: -0.6807704567909241, mean p set: 0.44922852516174316
The modified gen p mean: 0.45011767745018005, gen p mean: -0.6762537956237793, mean p set: 0.45059797167778015
loss_pred:0.027672668918967247, decouple_loss:0.02121732197701931
loss_pred:0.027971366420388222, decouple_loss:0.02122117020189762
The modified gen p mean: 0.4506893754005432, gen p mean: -0.6955434083938599, mean p set: 0.4511696398258209
loss_pred:0.027656005695462227, decouple_loss:0.02361167035996914
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512201249599457, gen p mean: -0.6820358037948608, mean p set: 0.4517004191875458
The modified gen p mean: 0.451168417930603, gen p mean: -0.686972975730896, mean p set: 0.4516487121582031
The modified gen p mean: 0.450859397649765, gen p mean: -0.6774619221687317, mean p set: 0.4513396918773651
loss_pred:0.02791881561279297, decouple_loss:0.02097449079155922
loss_pred:0.0279696062207222, decouple_loss:0.02108054794371128
loss_pred:0.02724914625287056, decouple_loss:0.0203047264367342
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839081168174744, gen p mean: -0.690685510635376, mean p set: 0.44887110590934753
The modified gen p mean: 0.4507181942462921, gen p mean: -0.7083876132965088, mean p set: 0.4511985182762146
The modified gen p mean: 0.4477993845939636, gen p mean: -0.6873095631599426, mean p set: 0.4482796788215637
loss_pred:0.02755805477499962, decouple_loss:0.020900821313261986
loss_pred:0.027128098532557487, decouple_loss:0.02157258242368698
loss_pred:0.027697516605257988, decouple_loss:0.0197525043040514
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486495554447174, gen p mean: -0.6893775463104248, mean p set: 0.4491298198699951
The modified gen p mean: 0.45214927196502686, gen p mean: -0.7014576196670532, mean p set: 0.45262959599494934
The modified gen p mean: 0.45202067494392395, gen p mean: -0.7135059237480164, mean p set: 0.45250096917152405
loss_pred:0.027563709765672684, decouple_loss:0.01950242556631565
loss_pred:0.02666059322655201, decouple_loss:0.02024405263364315
loss_pred:0.027782943099737167, decouple_loss:0.020683130249381065
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45187345147132874, gen p mean: -0.6989279389381409, mean p set: 0.45235374569892883
The modified gen p mean: 0.4509420394897461, gen p mean: -0.6988245844841003, mean p set: 0.4514223337173462
The modified gen p mean: 0.44793349504470825, gen p mean: -0.6906824707984924, mean p set: 0.44841381907463074
loss_pred:0.026824498549103737, decouple_loss:0.01988617144525051
loss_pred:0.02715967409312725, decouple_loss:0.020396580919623375
loss_pred:0.026658708229660988, decouple_loss:0.01985945552587509
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499624967575073, gen p mean: -0.6857268810272217, mean p set: 0.45044276118278503
The modified gen p mean: 0.45210736989974976, gen p mean: -0.7090272903442383, mean p set: 0.45258763432502747
The modified gen p mean: 0.4476472735404968, gen p mean: -0.6820436716079712, mean p set: 0.44812753796577454
loss_pred:0.02731754072010517, decouple_loss:0.019346708431839943loss_pred:0.026761572808027267, decouple_loss:0.019431840628385544
loss_pred:0.027848217636346817, decouple_loss:0.019135423004627228
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953253865242004, gen p mean: -0.6942756175994873, mean p set: 0.45001283288002014
The modified gen p mean: 0.44909119606018066, gen p mean: -0.6915366649627686, mean p set: 0.44957149028778076
The modified gen p mean: 0.44922271370887756, gen p mean: -0.6948285698890686, mean p set: 0.4497029781341553
loss_pred:0.027022341266274452, decouple_loss:0.01864609681069851
loss_pred:0.02815256081521511, decouple_loss:0.018652750179171562
loss_pred:0.026686418801546097, decouple_loss:0.018705599009990692
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517090320587158, gen p mean: -0.711819052696228, mean p set: 0.4521893560886383
The modified gen p mean: 0.44834089279174805, gen p mean: -0.6968620419502258, mean p set: 0.44882118701934814
The modified gen p mean: 0.4502004384994507, gen p mean: -0.6916218996047974, mean p set: 0.4506807327270508
loss_pred:0.027124708518385887, decouple_loss:0.01931067742407322
loss_pred:0.027290716767311096, decouple_loss:0.01880073733627796
loss_pred:0.027177205309271812, decouple_loss:0.019117573276162148
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507247507572174, gen p mean: -0.7128781676292419, mean p set: 0.4512050449848175
The modified gen p mean: 0.4516884386539459, gen p mean: -0.7137269377708435, mean p set: 0.4521687626838684
The modified gen p mean: 0.4482850432395935, gen p mean: -0.6938609480857849, mean p set: 0.4487653374671936
loss_pred:0.027041932567954063, decouple_loss:0.019189229235053062
loss_pred:0.02780136838555336, decouple_loss:0.01940060965716839
loss_pred:0.027395380660891533, decouple_loss:0.0180132407695055
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490036070346832, gen p mean: -0.6920067071914673, mean p set: 0.4494839310646057
The modified gen p mean: 0.44859692454338074, gen p mean: -0.695356011390686, mean p set: 0.44907721877098083
The modified gen p mean: 0.4483596086502075, gen p mean: -0.6895852088928223, mean p set: 0.44883993268013
loss_pred:0.026775840669870377, decouple_loss:0.018323637545108795
loss_pred:0.027435647323727608, decouple_loss:0.01756845973432064
loss_pred:0.02663675881922245, decouple_loss:0.018193064257502556
2023-05-06 19:06:58 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6863541603088379, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.67296302318573, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6784778833389282, mean p set: 0.4500633478164673
loss_pred:0.02913323976099491, decouple_loss:0.02101166918873787
loss_pred:0.027556676417589188, decouple_loss:0.02051991969347
loss_pred:0.027988897636532784, decouple_loss:0.02049541100859642
WV_0_PC_1_EH_0_PS_40_6, loss: 0.029260054230690002, avg_mse: 0.03415496647357941
current test mse: 0.034155
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45045655965805054, gen p mean: -0.681007444858551, mean p set: 0.45093685388565063
The modified gen p mean: 0.4497833847999573, gen p mean: -0.6794127821922302, mean p set: 0.4502636790275574
loss_pred:0.027491668239235878, decouple_loss:0.018146246671676636
loss_pred:0.026465656235814095, decouple_loss:0.01792154274880886
The modified gen p mean: 0.4500531256198883, gen p mean: -0.6808396577835083, mean p set: 0.4505334198474884
loss_pred:0.027482271194458008, decouple_loss:0.018217377364635468
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45140671730041504, gen p mean: -0.6870613694190979, mean p set: 0.45188701152801514
The modified gen p mean: 0.44852709770202637, gen p mean: -0.683839738368988, mean p set: 0.44900739192962646
The modified gen p mean: 0.4494893550872803, gen p mean: -0.6772686839103699, mean p set: 0.449969619512558
loss_pred:0.02732965350151062, decouple_loss:0.017340052872896194loss_pred:0.026152517646551132, decouple_loss:0.01776101253926754
loss_pred:0.02778446301817894, decouple_loss:0.01764255203306675
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488142132759094, gen p mean: -0.7000064253807068, mean p set: 0.44929447770118713
The modified gen p mean: 0.4504612982273102, gen p mean: -0.7067704200744629, mean p set: 0.4509415924549103
The modified gen p mean: 0.45139288902282715, gen p mean: -0.7062634825706482, mean p set: 0.45187318325042725
loss_pred:0.027306869626045227, decouple_loss:0.0164825227111578
loss_pred:0.026950741186738014, decouple_loss:0.017656393349170685
loss_pred:0.02671956829726696, decouple_loss:0.017250703647732735
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450158029794693, gen p mean: -0.7066402435302734, mean p set: 0.4506383240222931
The modified gen p mean: 0.45037874579429626, gen p mean: -0.7085674405097961, mean p set: 0.45085906982421875
The modified gen p mean: 0.44979265332221985, gen p mean: -0.7081919312477112, mean p set: 0.45027294754981995
loss_pred:0.026886530220508575, decouple_loss:0.016912080347537994
loss_pred:0.027183450758457184, decouple_loss:0.0170542374253273
loss_pred:0.02735796943306923, decouple_loss:0.01649922877550125
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45109590888023376, gen p mean: -0.7151357531547546, mean p set: 0.45157620310783386
The modified gen p mean: 0.45025599002838135, gen p mean: -0.7042025923728943, mean p set: 0.45073628425598145
The modified gen p mean: 0.45060259103775024, gen p mean: -0.7085855007171631, mean p set: 0.45108291506767273
loss_pred:0.02748202160000801, decouple_loss:0.01753944344818592
loss_pred:0.02691337652504444, decouple_loss:0.01727486215531826
loss_pred:0.026987558230757713, decouple_loss:0.0164086502045393
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978296756744385, gen p mean: -0.6895631551742554, mean p set: 0.45026326179504395
The modified gen p mean: 0.4515479803085327, gen p mean: -0.6937862038612366, mean p set: 0.4520282447338104
loss_pred:0.02751292660832405, decouple_loss:0.016693348065018654
loss_pred:0.02695196308195591, decouple_loss:0.016592945903539658
The modified gen p mean: 0.45157793164253235, gen p mean: -0.7019363045692444, mean p set: 0.45205825567245483
loss_pred:0.02712678723037243, decouple_loss:0.017082247883081436
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506099224090576, gen p mean: -0.6913530826568604, mean p set: 0.4510902166366577
The modified gen p mean: 0.45089951157569885, gen p mean: -0.7043951153755188, mean p set: 0.45137983560562134
The modified gen p mean: 0.4480831027030945, gen p mean: -0.6846177577972412, mean p set: 0.44856342673301697
loss_pred:0.026828249916434288, decouple_loss:0.015728745609521866
loss_pred:0.026267673820257187, decouple_loss:0.01727275922894478
loss_pred:0.02665167674422264, decouple_loss:0.016402028501033783
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510978162288666, gen p mean: -0.7017273306846619, mean p set: 0.4515781104564667
The modified gen p mean: 0.4499184191226959, gen p mean: -0.6942031979560852, mean p set: 0.450398713350296
The modified gen p mean: 0.4486803114414215, gen p mean: -0.6927432417869568, mean p set: 0.4491605758666992
loss_pred:0.026906723156571388, decouple_loss:0.016406867653131485
loss_pred:0.026687318459153175, decouple_loss:0.016056237742304802
loss_pred:0.026575643569231033, decouple_loss:0.015661969780921936
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832876324653625, gen p mean: -0.6908554434776306, mean p set: 0.44880905747413635
The modified gen p mean: 0.4497433304786682, gen p mean: -0.7005013823509216, mean p set: 0.4502235949039459
The modified gen p mean: 0.44800230860710144, gen p mean: -0.6939585208892822, mean p set: 0.44848257303237915
loss_pred:0.02694127894937992, decouple_loss:0.01611778885126114
loss_pred:0.026885638013482094, decouple_loss:0.016062460839748383
loss_pred:0.026278823614120483, decouple_loss:0.01652611419558525
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
NaN value num: 0
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44986605644226074, gen p mean: -0.7036523818969727, mean p set: 0.45034632086753845
The modified gen p mean: 0.4520137310028076, gen p mean: -0.7059978246688843, mean p set: 0.4524940252304077
The modified gen p mean: 0.4510365128517151, gen p mean: -0.7018245458602905, mean p set: 0.4515168070793152
loss_pred:0.025960803031921387, decouple_loss:0.02127564139664173
loss_pred:0.027501970529556274, decouple_loss:0.018169762566685677
loss_pred:0.027156569063663483, decouple_loss:0.018648477271199226
2023-05-06 19:12:08 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7175952792167664, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7035748958587646, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7094919681549072, mean p set: 0.4500633478164673
loss_pred:0.029105255380272865, decouple_loss:0.01840442419052124
loss_pred:0.027527524158358574, decouple_loss:0.017854396253824234
loss_pred:0.027975812554359436, decouple_loss:0.017803562805056572
WV_0_PC_1_EH_0_PS_40_6, loss: 0.029103904962539673, avg_mse: 0.03415815532207489
current test mse: 0.034158
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500848352909088, gen p mean: -0.7125338315963745, mean p set: 0.4505651295185089
The modified gen p mean: 0.4514724612236023, gen p mean: -0.7123703956604004, mean p set: 0.4519527554512024
loss_pred:0.026971952989697456, decouple_loss:0.01777717098593712
loss_pred:0.026117973029613495, decouple_loss:0.018602849915623665
The modified gen p mean: 0.45262861251831055, gen p mean: -0.7109177708625793, mean p set: 0.45310890674591064
loss_pred:0.0266946442425251, decouple_loss:0.018214192241430283
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514588415622711, gen p mean: -0.7078012824058533, mean p set: 0.4519391357898712
The modified gen p mean: 0.45046862959861755, gen p mean: -0.7065656185150146, mean p set: 0.45094895362854004
The modified gen p mean: 0.45057961344718933, gen p mean: -0.7041292190551758, mean p set: 0.4510599374771118
loss_pred:0.025394538417458534, decouple_loss:0.01912001706659794
loss_pred:0.0272670891135931, decouple_loss:0.017650505527853966
loss_pred:0.02719847485423088, decouple_loss:0.01847199723124504
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45287275314331055, gen p mean: -0.7013267874717712, mean p set: 0.45335304737091064
The modified gen p mean: 0.45080626010894775, gen p mean: -0.7030620574951172, mean p set: 0.45128652453422546
The modified gen p mean: 0.44996029138565063, gen p mean: -0.7067080140113831, mean p set: 0.45044055581092834
loss_pred:0.028160834684967995, decouple_loss:0.01842604950070381
loss_pred:0.02678922563791275, decouple_loss:0.017897311598062515
loss_pred:0.02778434567153454, decouple_loss:0.01676875539124012
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502285420894623, gen p mean: -0.7057880163192749, mean p set: 0.4507088363170624
The modified gen p mean: 0.45191967487335205, gen p mean: -0.7023381590843201, mean p set: 0.45239993929862976
The modified gen p mean: 0.45282426476478577, gen p mean: -0.7084782719612122, mean p set: 0.4533045291900635
loss_pred:0.026777368038892746, decouple_loss:0.016669778153300285
loss_pred:0.02725948393344879, decouple_loss:0.016606131568551064
loss_pred:0.026429085060954094, decouple_loss:0.017197560518980026
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082542300224304, gen p mean: -0.7051067352294922, mean p set: 0.45130568742752075
The modified gen p mean: 0.45255526900291443, gen p mean: -0.7099295258522034, mean p set: 0.45303553342819214
The modified gen p mean: 0.45107415318489075, gen p mean: -0.7028861045837402, mean p set: 0.45155444741249084
loss_pred:0.026776714250445366, decouple_loss:0.016303634271025658
loss_pred:0.02647222764790058, decouple_loss:0.017015838995575905
loss_pred:0.026537783443927765, decouple_loss:0.0173910241574049
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45086026191711426, gen p mean: -0.6969356536865234, mean p set: 0.45134058594703674
The modified gen p mean: 0.45126569271087646, gen p mean: -0.6974092721939087, mean p set: 0.4517459571361542
The modified gen p mean: 0.4525086283683777, gen p mean: -0.7019017338752747, mean p set: 0.4529889225959778
loss_pred:0.026255469769239426, decouple_loss:0.016858652234077454
loss_pred:0.026282288134098053, decouple_loss:0.01698421873152256
loss_pred:0.02597048133611679, decouple_loss:0.01885204017162323
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45187821984291077, gen p mean: -0.6826083064079285, mean p set: 0.45235851407051086
The modified gen p mean: 0.4504152834415436, gen p mean: -0.6886855363845825, mean p set: 0.4508955478668213
The modified gen p mean: 0.4522443115711212, gen p mean: -0.6907088756561279, mean p set: 0.4527246057987213
loss_pred:0.026533083990216255, decouple_loss:0.017057888209819794
loss_pred:0.02767440490424633, decouple_loss:0.016290539875626564
loss_pred:0.025870323181152344, decouple_loss:0.016483647748827934
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44927978515625, gen p mean: -0.6858846545219421, mean p set: 0.4497600495815277
The modified gen p mean: 0.45170214772224426, gen p mean: -0.6902425289154053, mean p set: 0.45218244194984436
The modified gen p mean: 0.4511013925075531, gen p mean: -0.6832889318466187, mean p set: 0.4515817165374756
loss_pred:0.0275845006108284, decouple_loss:0.015862636268138885
loss_pred:0.027520310133695602, decouple_loss:0.01601620949804783
loss_pred:0.0275032389909029, decouple_loss:0.01598270796239376
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518912136554718, gen p mean: -0.7111235857009888, mean p set: 0.4523715376853943
The modified gen p mean: 0.4518422484397888, gen p mean: -0.7102434635162354, mean p set: 0.4523225724697113
The modified gen p mean: 0.4506170451641083, gen p mean: -0.7083442807197571, mean p set: 0.45109736919403076
loss_pred:0.02593899890780449, decouple_loss:0.01811092346906662
loss_pred:0.02561289630830288, decouple_loss:0.017082994803786278
loss_pred:0.02636871673166752, decouple_loss:0.015727631747722626
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497283101081848, gen p mean: -0.7155486941337585, mean p set: 0.4502086043357849
The modified gen p mean: 0.4531958997249603, gen p mean: -0.7063051462173462, mean p set: 0.45367616415023804
The modified gen p mean: 0.451941579580307, gen p mean: -0.7128311991691589, mean p set: 0.4524218738079071
loss_pred:0.026389267295598984, decouple_loss:0.01586192473769188
loss_pred:0.027443230152130127, decouple_loss:0.015890581533312798
loss_pred:0.025981908664107323, decouple_loss:0.015809031203389168
2023-05-06 19:15:45 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7139644622802734, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.701049268245697, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.706613302230835, mean p set: 0.4500633478164673
loss_pred:0.02915128506720066, decouple_loss:0.017588840797543526
loss_pred:0.027599196881055832, decouple_loss:0.017258210107684135
loss_pred:0.02803041785955429, decouple_loss:0.016926860436797142
WV_0_PC_1_EH_0_PS_40_6, loss: 0.029123200103640556, avg_mse: 0.034442927688360214
current test mse: 0.034443
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45056819915771484, gen p mean: -0.7074910402297974, mean p set: 0.45104846358299255
The modified gen p mean: 0.4503079950809479, gen p mean: -0.7112146615982056, mean p set: 0.450788289308548
loss_pred:0.026605812832713127, decouple_loss:0.014902094379067421
loss_pred:0.0265954677015543, decouple_loss:0.01592603512108326
The modified gen p mean: 0.44962698221206665, gen p mean: -0.7083936333656311, mean p set: 0.45010724663734436
loss_pred:0.02655326947569847, decouple_loss:0.014587979763746262
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45220863819122314, gen p mean: -0.7064694762229919, mean p set: 0.45268896222114563
The modified gen p mean: 0.4518289268016815, gen p mean: -0.7033294439315796, mean p set: 0.4523092210292816
The modified gen p mean: 0.4511999487876892, gen p mean: -0.6984468698501587, mean p set: 0.4516802132129669
loss_pred:0.025782674551010132, decouple_loss:0.016821935772895813
loss_pred:0.026592861860990524, decouple_loss:0.015364240854978561
loss_pred:0.025694089010357857, decouple_loss:0.014758522622287273
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511606693267822, gen p mean: -0.6926695704460144, mean p set: 0.45164093375205994
The modified gen p mean: 0.4518909454345703, gen p mean: -0.6881987452507019, mean p set: 0.4523712396621704
The modified gen p mean: 0.4512845575809479, gen p mean: -0.6907489895820618, mean p set: 0.45176488161087036
loss_pred:0.025926603004336357, decouple_loss:0.014576039277017117
loss_pred:0.027912648394703865, decouple_loss:0.015183115378022194
loss_pred:0.02663792483508587, decouple_loss:0.014860943891108036
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533810317516327, gen p mean: -0.6923869848251343, mean p set: 0.4538613259792328
The modified gen p mean: 0.45121803879737854, gen p mean: -0.6887436509132385, mean p set: 0.45169830322265625
The modified gen p mean: 0.45076966285705566, gen p mean: -0.69306880235672, mean p set: 0.45124995708465576
loss_pred:0.026302849873900414, decouple_loss:0.01569221355021loss_pred:0.026534568518400192, decouple_loss:0.014341292902827263
loss_pred:0.026679586619138718, decouple_loss:0.015569125302135944
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518243670463562, gen p mean: -0.7031667828559875, mean p set: 0.4523046314716339
The modified gen p mean: 0.45068755745887756, gen p mean: -0.7028773427009583, mean p set: 0.45116788148880005
The modified gen p mean: 0.4521043300628662, gen p mean: -0.7028368711471558, mean p set: 0.4525846242904663
loss_pred:0.026593154296278954, decouple_loss:0.015212028287351131
loss_pred:0.0266874972730875, decouple_loss:0.015422539785504341
loss_pred:0.026393258944153786, decouple_loss:0.014827773906290531
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45129311084747314, gen p mean: -0.701074481010437, mean p set: 0.45177337527275085
The modified gen p mean: 0.44978272914886475, gen p mean: -0.7079254984855652, mean p set: 0.45026299357414246
The modified gen p mean: 0.45045849680900574, gen p mean: -0.7080333828926086, mean p set: 0.45093876123428345
loss_pred:0.026907017454504967, decouple_loss:0.015819359570741653
loss_pred:0.027238663285970688, decouple_loss:0.015641601756215096
loss_pred:0.02611996978521347, decouple_loss:0.015077069401741028
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44994911551475525, gen p mean: -0.7031353116035461, mean p set: 0.45042940974235535
The modified gen p mean: 0.45172634720802307, gen p mean: -0.7028970718383789, mean p set: 0.45220664143562317
loss_pred:0.027409052476286888, decouple_loss:0.015320554375648499
loss_pred:0.02592373825609684, decouple_loss:0.015647780150175095
The modified gen p mean: 0.45068731904029846, gen p mean: -0.7024575471878052, mean p set: 0.45116758346557617
loss_pred:0.026386898010969162, decouple_loss:0.015553721226751804
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515931010246277, gen p mean: -0.6997602581977844, mean p set: 0.4520733654499054
The modified gen p mean: 0.45181411504745483, gen p mean: -0.6954845190048218, mean p set: 0.45229440927505493
The modified gen p mean: 0.4513220489025116, gen p mean: -0.7021282315254211, mean p set: 0.4518023431301117
loss_pred:0.027909282594919205, decouple_loss:0.015086215920746326
loss_pred:0.02671104110777378, decouple_loss:0.014654126949608326
loss_pred:0.025571271777153015, decouple_loss:0.01512870378792286
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504478871822357, gen p mean: -0.7071241736412048, mean p set: 0.4509281814098358
The modified gen p mean: 0.45203185081481934, gen p mean: -0.6948524713516235, mean p set: 0.45251214504241943
The modified gen p mean: 0.45102256536483765, gen p mean: -0.6950653195381165, mean p set: 0.45150282979011536
loss_pred:0.0269012451171875, decouple_loss:0.013909125700592995loss_pred:0.02695927768945694, decouple_loss:0.015068767592310905
loss_pred:0.026196211576461792, decouple_loss:0.014504547230899334
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
NaN value num: 0
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45277976989746094, gen p mean: -0.7074762582778931, mean p set: 0.45326003432273865
The modified gen p mean: 0.4499928653240204, gen p mean: -0.7175224423408508, mean p set: 0.4504731595516205
The modified gen p mean: 0.45214930176734924, gen p mean: -0.7064882516860962, mean p set: 0.45262959599494934
loss_pred:0.027239155024290085, decouple_loss:0.017267711460590363
loss_pred:0.02594158798456192, decouple_loss:0.016382379457354546
loss_pred:0.026155106723308563, decouple_loss:0.016644956544041634
2023-05-06 19:21:27 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7128241062164307, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.699153482913971, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.704788327217102, mean p set: 0.4500633478164673
loss_pred:0.028781529515981674, decouple_loss:0.017094241455197334
loss_pred:0.027208583429455757, decouple_loss:0.01682894304394722
loss_pred:0.02770286239683628, decouple_loss:0.0165912676602602
WV_0_PC_1_EH_0_PS_40_6, loss: 0.0287395678460598, avg_mse: 0.03389625623822212
current test mse: 0.033896
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45149609446525574, gen p mean: -0.709233283996582, mean p set: 0.45197638869285583
The modified gen p mean: 0.4512357711791992, gen p mean: -0.7079952955245972, mean p set: 0.4517160654067993
loss_pred:0.02561631053686142, decouple_loss:0.01558329164981842
loss_pred:0.02649243175983429, decouple_loss:0.015473345294594765
The modified gen p mean: 0.45127806067466736, gen p mean: -0.7112550735473633, mean p set: 0.45175832509994507
loss_pred:0.02662528306245804, decouple_loss:0.01597226969897747
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451978862285614, gen p mean: -0.7084092497825623, mean p set: 0.4524591267108917
The modified gen p mean: 0.44996708631515503, gen p mean: -0.7130544185638428, mean p set: 0.4504474103450775
loss_pred:0.02595951035618782, decouple_loss:0.01502202544361353
loss_pred:0.026392465457320213, decouple_loss:0.015737099573016167
The modified gen p mean: 0.4518388509750366, gen p mean: -0.7048405408859253, mean p set: 0.4523191750049591
loss_pred:0.026963813230395317, decouple_loss:0.015265662223100662
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512248933315277, gen p mean: -0.6911503076553345, mean p set: 0.4517051577568054
The modified gen p mean: 0.45118170976638794, gen p mean: -0.6898932456970215, mean p set: 0.4516620337963104
The modified gen p mean: 0.4490899443626404, gen p mean: -0.6991211175918579, mean p set: 0.4495701789855957
loss_pred:0.025561347603797913, decouple_loss:0.015304923057556152
loss_pred:0.02546301856637001, decouple_loss:0.015169602818787098
loss_pred:0.02710188925266266, decouple_loss:0.014927657321095467
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45145177841186523, gen p mean: -0.698289155960083, mean p set: 0.4519321024417877
The modified gen p mean: 0.4494718015193939, gen p mean: -0.6910003423690796, mean p set: 0.449952095746994
The modified gen p mean: 0.4511565864086151, gen p mean: -0.7024920582771301, mean p set: 0.4516368806362152
loss_pred:0.02625495381653309, decouple_loss:0.015282868407666683
loss_pred:0.025623269379138947, decouple_loss:0.015135243535041809
loss_pred:0.027576712891459465, decouple_loss:0.01569112204015255
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44950807094573975, gen p mean: -0.700589656829834, mean p set: 0.44998836517333984
The modified gen p mean: 0.45160701870918274, gen p mean: -0.7056124806404114, mean p set: 0.45208731293678284
loss_pred:0.026380326598882675, decouple_loss:0.014714852906763554
loss_pred:0.02644765004515648, decouple_loss:0.014810879714787006
The modified gen p mean: 0.4528837502002716, gen p mean: -0.7058969736099243, mean p set: 0.4533640444278717
loss_pred:0.025761831551790237, decouple_loss:0.014445153996348381
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45150044560432434, gen p mean: -0.6969896554946899, mean p set: 0.45198073983192444
The modified gen p mean: 0.45058420300483704, gen p mean: -0.7064160704612732, mean p set: 0.4510645270347595
The modified gen p mean: 0.4511454105377197, gen p mean: -0.7062526941299438, mean p set: 0.45162567496299744
loss_pred:0.026132624596357346, decouple_loss:0.015262581408023834
loss_pred:0.026450902223587036, decouple_loss:0.014792947098612785
loss_pred:0.027405565604567528, decouple_loss:0.015366817824542522
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492553770542145, gen p mean: -0.6914287805557251, mean p set: 0.4497356712818146
The modified gen p mean: 0.4509528577327728, gen p mean: -0.7010684609413147, mean p set: 0.4514331519603729
The modified gen p mean: 0.44974344968795776, gen p mean: -0.712282657623291, mean p set: 0.45022377371788025
loss_pred:0.025539398193359375, decouple_loss:0.014503251761198044
loss_pred:0.025570407509803772, decouple_loss:0.014266532845795155
loss_pred:0.026164213195443153, decouple_loss:0.014554779045283794
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493926763534546, gen p mean: -0.7033113241195679, mean p set: 0.4498729407787323
The modified gen p mean: 0.45147398114204407, gen p mean: -0.7086901068687439, mean p set: 0.45195427536964417
The modified gen p mean: 0.45285388827323914, gen p mean: -0.7079285979270935, mean p set: 0.45333418250083923
loss_pred:0.02684870921075344, decouple_loss:0.013779286295175552
loss_pred:0.02497471682727337, decouple_loss:0.01410958357155323
loss_pred:0.02527252957224846, decouple_loss:0.014257039874792099
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082300901412964, gen p mean: -0.7117139101028442, mean p set: 0.45130327343940735
The modified gen p mean: 0.4513408839702606, gen p mean: -0.705768346786499, mean p set: 0.4518211781978607
The modified gen p mean: 0.44974252581596375, gen p mean: -0.7157126665115356, mean p set: 0.45022279024124146
loss_pred:0.02575995959341526, decouple_loss:0.01436967309564352
loss_pred:0.026451556012034416, decouple_loss:0.014192716218531132
loss_pred:0.026333758607506752, decouple_loss:0.014152844436466694
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448747456073761, gen p mean: -0.7101651430130005, mean p set: 0.44922778010368347
The modified gen p mean: 0.4507521092891693, gen p mean: -0.7022204995155334, mean p set: 0.4512324035167694
The modified gen p mean: 0.44969499111175537, gen p mean: -0.6968191266059875, mean p set: 0.4501752555370331
loss_pred:0.02637426368892193, decouple_loss:0.014306529425084591
loss_pred:0.025497442111372948, decouple_loss:0.014109156094491482
loss_pred:0.026510711759328842, decouple_loss:0.014602327719330788
2023-05-06 19:25:03 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.709820032119751, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6967158913612366, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.7016710638999939, mean p set: 0.4500633478164673
loss_pred:0.0287758968770504, decouple_loss:0.016348889097571373
loss_pred:0.02727321721613407, decouple_loss:0.0157361701130867
loss_pred:0.02771736867725849, decouple_loss:0.01578325778245926
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028719967231154442, avg_mse: 0.03396618738770485
current test mse: 0.033966
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943609833717346, gen p mean: -0.7056133151054382, mean p set: 0.4499163329601288
The modified gen p mean: 0.44978782534599304, gen p mean: -0.7155296206474304, mean p set: 0.45026808977127075
loss_pred:0.027273572981357574, decouple_loss:0.01325918547809124
loss_pred:0.026660600677132607, decouple_loss:0.013627486303448677
The modified gen p mean: 0.4516649544239044, gen p mean: -0.7079039812088013, mean p set: 0.4521452486515045
loss_pred:0.025870218873023987, decouple_loss:0.01343573909252882
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496873617172241, gen p mean: -0.7242028117179871, mean p set: 0.4501676559448242
The modified gen p mean: 0.44980132579803467, gen p mean: -0.7200368046760559, mean p set: 0.45028162002563477
The modified gen p mean: 0.4515511989593506, gen p mean: -0.7176947593688965, mean p set: 0.4520314931869507
loss_pred:0.02647671476006508, decouple_loss:0.013893825002014637
loss_pred:0.026798179373145103, decouple_loss:0.013795183040201664
loss_pred:0.025724710896611214, decouple_loss:0.013761942274868488
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813987612724304, gen p mean: -0.7178122997283936, mean p set: 0.44862014055252075
The modified gen p mean: 0.448850154876709, gen p mean: -0.7186896204948425, mean p set: 0.4493304491043091
The modified gen p mean: 0.451507031917572, gen p mean: -0.7218000888824463, mean p set: 0.4519873261451721
loss_pred:0.026094790548086166, decouple_loss:0.013317523524165154
loss_pred:0.02620192989706993, decouple_loss:0.013391227461397648
loss_pred:0.02688547782599926, decouple_loss:0.013497141189873219
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493529200553894, gen p mean: -0.6965830326080322, mean p set: 0.4498332440853119
The modified gen p mean: 0.4493885636329651, gen p mean: -0.7140950560569763, mean p set: 0.4498688280582428
loss_pred:0.025819776579737663, decouple_loss:0.013709857128560543
loss_pred:0.02604076825082302, decouple_loss:0.013093416579067707
The modified gen p mean: 0.4498673677444458, gen p mean: -0.7019803524017334, mean p set: 0.4503476321697235
loss_pred:0.025291426107287407, decouple_loss:0.01376982219517231
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512796998023987, gen p mean: -0.7005883455276489, mean p set: 0.4517599642276764
The modified gen p mean: 0.4501604437828064, gen p mean: -0.6999205350875854, mean p set: 0.4506407380104065
loss_pred:0.025011951103806496, decouple_loss:0.013696571812033653
loss_pred:0.0255441814661026, decouple_loss:0.013917584903538227
The modified gen p mean: 0.4502734839916229, gen p mean: -0.7135199308395386, mean p set: 0.45075374841690063
loss_pred:0.026854360476136208, decouple_loss:0.013310812413692474
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504871964454651, gen p mean: -0.7149088978767395, mean p set: 0.4509674608707428
The modified gen p mean: 0.44903847575187683, gen p mean: -0.7083145976066589, mean p set: 0.44951876997947693
The modified gen p mean: 0.44892239570617676, gen p mean: -0.7130451202392578, mean p set: 0.44940266013145447
loss_pred:0.02601548656821251, decouple_loss:0.013429076410830021
loss_pred:0.02533957175910473, decouple_loss:0.013675256632268429
loss_pred:0.025352517142891884, decouple_loss:0.013192791491746902
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511222541332245, gen p mean: -0.7211990356445312, mean p set: 0.4516025483608246
The modified gen p mean: 0.4476620852947235, gen p mean: -0.7131127715110779, mean p set: 0.448142409324646
The modified gen p mean: 0.44981178641319275, gen p mean: -0.7078427672386169, mean p set: 0.45029211044311523
loss_pred:0.026869777590036392, decouple_loss:0.013527391478419304
loss_pred:0.026279432699084282, decouple_loss:0.013226702809333801
loss_pred:0.026385683566331863, decouple_loss:0.01279212161898613
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44905155897140503, gen p mean: -0.7046488523483276, mean p set: 0.44953182339668274
The modified gen p mean: 0.44991931319236755, gen p mean: -0.7141290903091431, mean p set: 0.45039960741996765
The modified gen p mean: 0.4513486921787262, gen p mean: -0.7045289278030396, mean p set: 0.4518289566040039
loss_pred:0.026505334302783012, decouple_loss:0.013594897463917732
loss_pred:0.02540424093604088, decouple_loss:0.012863396666944027
loss_pred:0.024820348247885704, decouple_loss:0.012796694412827492
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514136016368866, gen p mean: -0.7051922082901001, mean p set: 0.4518939256668091
The modified gen p mean: 0.45039644837379456, gen p mean: -0.7141115665435791, mean p set: 0.45087674260139465
The modified gen p mean: 0.4528367221355438, gen p mean: -0.7088410258293152, mean p set: 0.4533170461654663
loss_pred:0.02591468207538128, decouple_loss:0.01399668212980032
loss_pred:0.0271664559841156, decouple_loss:0.01330780703574419
loss_pred:0.025182809680700302, decouple_loss:0.01349928043782711
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
NaN value num: 0
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468706250190735, gen p mean: -0.7075936794281006, mean p set: 0.4473509192466736
The modified gen p mean: 0.44762352108955383, gen p mean: -0.7063149809837341, mean p set: 0.44810381531715393
The modified gen p mean: 0.4491763710975647, gen p mean: -0.7158291339874268, mean p set: 0.4496566355228424
loss_pred:0.029660630971193314, decouple_loss:0.014527141116559505
loss_pred:0.029489757493138313, decouple_loss:0.013646210543811321
loss_pred:0.029899008572101593, decouple_loss:0.014611473307013512
2023-05-06 19:30:08 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7307139039039612, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7169062495231628, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7226238250732422, mean p set: 0.4500633478164673
loss_pred:0.028678447008132935, decouple_loss:0.015128453262150288
loss_pred:0.027088021859526634, decouple_loss:0.014758999459445477
loss_pred:0.027486693114042282, decouple_loss:0.014837924391031265
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028496477752923965, avg_mse: 0.03370504826307297
current test mse: 0.033705
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484081268310547, gen p mean: -0.7400916814804077, mean p set: 0.4488883912563324The modified gen p mean: 0.44786545634269714, gen p mean: -0.7314003109931946, mean p set: 0.44834578037261963
loss_pred:0.028985997661948204, decouple_loss:0.01656442880630493
loss_pred:0.02808203734457493, decouple_loss:0.013979424722492695
The modified gen p mean: 0.4472668766975403, gen p mean: -0.7389782071113586, mean p set: 0.447747141122818
loss_pred:0.028303055092692375, decouple_loss:0.01615726202726364
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470927119255066, gen p mean: -0.7304288148880005, mean p set: 0.4475730061531067
The modified gen p mean: 0.4475644826889038, gen p mean: -0.7294051647186279, mean p set: 0.4480447769165039
The modified gen p mean: 0.4480510652065277, gen p mean: -0.7391806840896606, mean p set: 0.4485313296318054
loss_pred:0.028553908690810204, decouple_loss:0.014295878820121288
loss_pred:0.02791508473455906, decouple_loss:0.013541383668780327
loss_pred:0.027979999780654907, decouple_loss:0.013407069258391857
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678249955177307, gen p mean: -0.729688823223114, mean p set: 0.44726279377937317
The modified gen p mean: 0.44686856865882874, gen p mean: -0.7276841402053833, mean p set: 0.44734886288642883
loss_pred:0.029810355976223946, decouple_loss:0.013926832005381584
loss_pred:0.028706105425953865, decouple_loss:0.014681731350719929
The modified gen p mean: 0.4475669860839844, gen p mean: -0.7295229434967041, mean p set: 0.4480472505092621
loss_pred:0.02861577272415161, decouple_loss:0.015145080164074898
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827577471733093, gen p mean: -0.7248098254203796, mean p set: 0.44875606894493103
The modified gen p mean: 0.4465080201625824, gen p mean: -0.729174792766571, mean p set: 0.4469883143901825
The modified gen p mean: 0.4482971429824829, gen p mean: -0.7253350615501404, mean p set: 0.4487774670124054
loss_pred:0.028897497802972794, decouple_loss:0.013606698252260685loss_pred:0.027722997590899467, decouple_loss:0.013564946129918098
loss_pred:0.027508607134222984, decouple_loss:0.013511216267943382
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481431543827057, gen p mean: -0.7240331768989563, mean p set: 0.4486234486103058
The modified gen p mean: 0.44708481431007385, gen p mean: -0.7317769527435303, mean p set: 0.44756510853767395
The modified gen p mean: 0.44664105772972107, gen p mean: -0.723509669303894, mean p set: 0.44712138175964355
loss_pred:0.0277522224932909, decouple_loss:0.014472541399300098loss_pred:0.028516869992017746, decouple_loss:0.013676360249519348
loss_pred:0.029335325583815575, decouple_loss:0.014547545462846756
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474089741706848, gen p mean: -0.7209656834602356, mean p set: 0.4478892683982849
The modified gen p mean: 0.4474189877510071, gen p mean: -0.7206766605377197, mean p set: 0.44789931178092957
loss_pred:0.027949832379817963, decouple_loss:0.013588395901024342
loss_pred:0.028012847527861595, decouple_loss:0.013288293033838272
The modified gen p mean: 0.44692352414131165, gen p mean: -0.7331966161727905, mean p set: 0.44740378856658936
loss_pred:0.028467411175370216, decouple_loss:0.013978448696434498
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800689816474915, gen p mean: -0.7338835597038269, mean p set: 0.44848722219467163
The modified gen p mean: 0.44580337405204773, gen p mean: -0.7366454005241394, mean p set: 0.44628363847732544
The modified gen p mean: 0.4472569525241852, gen p mean: -0.740874171257019, mean p set: 0.4477372169494629
loss_pred:0.02756100334227085, decouple_loss:0.013521883636713028
loss_pred:0.02852586843073368, decouple_loss:0.013700379990041256
loss_pred:0.02862647734582424, decouple_loss:0.01341496966779232
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457154870033264, gen p mean: -0.7373765707015991, mean p set: 0.4461957514286041
The modified gen p mean: 0.4479660093784332, gen p mean: -0.7375943660736084, mean p set: 0.44844627380371094
The modified gen p mean: 0.44769012928009033, gen p mean: -0.7320868968963623, mean p set: 0.44817039370536804
loss_pred:0.028086796402931213, decouple_loss:0.01343870535492897
loss_pred:0.028383225202560425, decouple_loss:0.013277897611260414
loss_pred:0.027762597426772118, decouple_loss:0.013309775851666927
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661030173301697, gen p mean: -0.7307331562042236, mean p set: 0.4470905661582947
The modified gen p mean: 0.44856980443000793, gen p mean: -0.7307991981506348, mean p set: 0.44905006885528564
The modified gen p mean: 0.4465142488479614, gen p mean: -0.7350043058395386, mean p set: 0.4469945430755615
loss_pred:0.02890263870358467, decouple_loss:0.012935170903801918
loss_pred:0.02791769988834858, decouple_loss:0.012953932397067547
loss_pred:0.02867128886282444, decouple_loss:0.012870825827121735
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44652819633483887, gen p mean: -0.7218114733695984, mean p set: 0.44700849056243896
The modified gen p mean: 0.44676363468170166, gen p mean: -0.7228367924690247, mean p set: 0.44724392890930176
The modified gen p mean: 0.44609692692756653, gen p mean: -0.7155587673187256, mean p set: 0.446577250957489
loss_pred:0.028705831617116928, decouple_loss:0.0134686678647995
loss_pred:0.028836116194725037, decouple_loss:0.013150667771697044
loss_pred:0.028005067259073257, decouple_loss:0.013377894647419453
2023-05-06 19:33:44 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7128955721855164, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6994922757148743, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7050256133079529, mean p set: 0.4500633478164673
loss_pred:0.028399398550391197, decouple_loss:0.014672095887362957
loss_pred:0.02700069174170494, decouple_loss:0.01438035350292921
loss_pred:0.02736395224928856, decouple_loss:0.014132289215922356
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028307761996984482, avg_mse: 0.033490367233753204
current test mse: 0.03349
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827449321746826, gen p mean: -0.7114379405975342, mean p set: 0.44875475764274597
The modified gen p mean: 0.4469072222709656, gen p mean: -0.7084383368492126, mean p set: 0.4473875164985657
loss_pred:0.02829224057495594, decouple_loss:0.012656073085963726
loss_pred:0.02967650070786476, decouple_loss:0.013536777347326279
The modified gen p mean: 0.4488506615161896, gen p mean: -0.7218366265296936, mean p set: 0.4493309259414673
loss_pred:0.028194213286042213, decouple_loss:0.014841229654848576
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492040276527405, gen p mean: -0.7058843970298767, mean p set: 0.4496842920780182
The modified gen p mean: 0.4486321806907654, gen p mean: -0.7069819569587708, mean p set: 0.4491124749183655
The modified gen p mean: 0.45010483264923096, gen p mean: -0.7095088958740234, mean p set: 0.45058512687683105
loss_pred:0.02751358412206173, decouple_loss:0.013035318814218044
loss_pred:0.028218358755111694, decouple_loss:0.012724014930427074
loss_pred:0.02818671613931656, decouple_loss:0.01322399266064167
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485849440097809, gen p mean: -0.7240630388259888, mean p set: 0.449065238237381
The modified gen p mean: 0.4462997615337372, gen p mean: -0.7076306939125061, mean p set: 0.4467800557613373
The modified gen p mean: 0.44732263684272766, gen p mean: -0.7096401453018188, mean p set: 0.44780290126800537
loss_pred:0.02858211100101471, decouple_loss:0.014192519709467888
loss_pred:0.02911493368446827, decouple_loss:0.012831614352762699
loss_pred:0.028951294720172882, decouple_loss:0.012733949348330498
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779494404792786, gen p mean: -0.7107523679733276, mean p set: 0.44827520847320557
The modified gen p mean: 0.4476662278175354, gen p mean: -0.7061197757720947, mean p set: 0.4481465220451355
loss_pred:0.028738215565681458, decouple_loss:0.013189878314733505
loss_pred:0.02781977504491806, decouple_loss:0.013166418299078941
The modified gen p mean: 0.44672462344169617, gen p mean: -0.7097178101539612, mean p set: 0.44720491766929626
loss_pred:0.02926839143037796, decouple_loss:0.013389728032052517
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477561116218567, gen p mean: -0.7276695370674133, mean p set: 0.4482364058494568
The modified gen p mean: 0.4470256268978119, gen p mean: -0.7103161811828613, mean p set: 0.4475059509277344
The modified gen p mean: 0.44650036096572876, gen p mean: -0.7087451815605164, mean p set: 0.44698062539100647
loss_pred:0.028083642944693565, decouple_loss:0.013707447797060013loss_pred:0.028674466535449028, decouple_loss:0.012726233340799809
loss_pred:0.02884002774953842, decouple_loss:0.013381997123360634
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656431674957275, gen p mean: -0.714747965335846, mean p set: 0.44704464077949524
The modified gen p mean: 0.44688674807548523, gen p mean: -0.7063432931900024, mean p set: 0.44736701250076294
The modified gen p mean: 0.4473632276058197, gen p mean: -0.7061764001846313, mean p set: 0.4478435218334198
loss_pred:0.027491815388202667, decouple_loss:0.01338556781411171
loss_pred:0.02897217869758606, decouple_loss:0.012357528321444988
loss_pred:0.028433814644813538, decouple_loss:0.012746119871735573
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475695490837097, gen p mean: -0.7013662457466125, mean p set: 0.4480498135089874
The modified gen p mean: 0.447181761264801, gen p mean: -0.708057165145874, mean p set: 0.4476620852947235
The modified gen p mean: 0.4474196434020996, gen p mean: -0.7032914161682129, mean p set: 0.4478999078273773
loss_pred:0.028801318258047104, decouple_loss:0.012388783507049084
loss_pred:0.02847488410770893, decouple_loss:0.012699429877102375
loss_pred:0.028961097821593285, decouple_loss:0.011966060847043991
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494776129722595, gen p mean: -0.7194378972053528, mean p set: 0.449957937002182
The modified gen p mean: 0.44842782616615295, gen p mean: -0.715053379535675, mean p set: 0.44890812039375305
The modified gen p mean: 0.4471374452114105, gen p mean: -0.7124561071395874, mean p set: 0.4476177394390106
loss_pred:0.02768608182668686, decouple_loss:0.012944678775966167
loss_pred:0.02725945971906185, decouple_loss:0.013370404951274395
loss_pred:0.028326869010925293, decouple_loss:0.01249048300087452
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448119193315506, gen p mean: -0.7273232340812683, mean p set: 0.4485994875431061
The modified gen p mean: 0.44640520215034485, gen p mean: -0.7085459232330322, mean p set: 0.44688549637794495
The modified gen p mean: 0.44708749651908875, gen p mean: -0.7127264142036438, mean p set: 0.44756776094436646
loss_pred:0.028140535578131676, decouple_loss:0.013690912164747715
loss_pred:0.03025360405445099, decouple_loss:0.012558343820273876
loss_pred:0.028309769928455353, decouple_loss:0.012543989345431328
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
NaN value num: 0
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524232745170593, gen p mean: -0.6866661310195923, mean p set: 0.4529035687446594
The modified gen p mean: 0.44912242889404297, gen p mean: -0.6882602572441101, mean p set: 0.4496026933193207
The modified gen p mean: 0.4516293406486511, gen p mean: -0.6972504258155823, mean p set: 0.45210960507392883
loss_pred:0.02969425916671753, decouple_loss:0.014306040480732918
loss_pred:0.027439380064606667, decouple_loss:0.01367133017629385
loss_pred:0.0299430750310421, decouple_loss:0.013173772022128105
2023-05-06 19:39:18 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6992075443267822, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.712752640247345, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7043624520301819, mean p set: 0.4500633478164673
loss_pred:0.026979755610227585, decouple_loss:0.014153416268527508
loss_pred:0.028275830671191216, decouple_loss:0.014270024374127388
loss_pred:0.027349505573511124, decouple_loss:0.01407039538025856
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028243262320756912, avg_mse: 0.03342084214091301
current test mse: 0.033421
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45240479707717896, gen p mean: -0.6976879239082336, mean p set: 0.45288509130477905The modified gen p mean: 0.45281991362571716, gen p mean: -0.6905522346496582, mean p set: 0.4533001780509949
loss_pred:0.02760937809944153, decouple_loss:0.01415056362748146
loss_pred:0.029326073825359344, decouple_loss:0.014084731228649616
The modified gen p mean: 0.45305564999580383, gen p mean: -0.6900253295898438, mean p set: 0.4535359740257263
loss_pred:0.029212547466158867, decouple_loss:0.014000958763062954
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525221884250641, gen p mean: -0.6912831664085388, mean p set: 0.4530024528503418
The modified gen p mean: 0.45154717564582825, gen p mean: -0.6825201511383057, mean p set: 0.45202744007110596
The modified gen p mean: 0.45212918519973755, gen p mean: -0.686834990978241, mean p set: 0.45260950922966003
loss_pred:0.0289018414914608, decouple_loss:0.013621595688164234loss_pred:0.0283246710896492, decouple_loss:0.013400119729340076
loss_pred:0.029177570715546608, decouple_loss:0.01329861767590046
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018839836120605, gen p mean: -0.690143883228302, mean p set: 0.45066869258880615
The modified gen p mean: 0.45063936710357666, gen p mean: -0.7035147547721863, mean p set: 0.45111966133117676
loss_pred:0.02958105318248272, decouple_loss:0.012886635027825832
loss_pred:0.02881941758096218, decouple_loss:0.013018729165196419
The modified gen p mean: 0.4530668556690216, gen p mean: -0.7005040645599365, mean p set: 0.4535471498966217
loss_pred:0.028165465220808983, decouple_loss:0.013169320300221443
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45134252309799194, gen p mean: -0.6889763474464417, mean p set: 0.45182281732559204
The modified gen p mean: 0.44985446333885193, gen p mean: -0.6892701387405396, mean p set: 0.450334757566452
The modified gen p mean: 0.45186758041381836, gen p mean: -0.6938201189041138, mean p set: 0.45234790444374084
loss_pred:0.028541268780827522, decouple_loss:0.013092463836073875
loss_pred:0.029212580993771553, decouple_loss:0.01344436313956976
loss_pred:0.028274498879909515, decouple_loss:0.01341286301612854
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530324935913086, gen p mean: -0.6997048258781433, mean p set: 0.4535127878189087
The modified gen p mean: 0.45097616314888, gen p mean: -0.7064501643180847, mean p set: 0.4514564573764801
loss_pred:0.029018817469477654, decouple_loss:0.012941236607730389
loss_pred:0.02860316075384617, decouple_loss:0.013003048487007618
The modified gen p mean: 0.44991931319236755, gen p mean: -0.7067736983299255, mean p set: 0.45039960741996765
loss_pred:0.02879788726568222, decouple_loss:0.013544276356697083
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451688677072525, gen p mean: -0.7107544541358948, mean p set: 0.4521689713001251
The modified gen p mean: 0.45236605405807495, gen p mean: -0.7154316902160645, mean p set: 0.45284631848335266
The modified gen p mean: 0.4515398442745209, gen p mean: -0.7154093384742737, mean p set: 0.4520201086997986
loss_pred:0.028694504871964455, decouple_loss:0.013866555877029896
loss_pred:0.027954354882240295, decouple_loss:0.013724807649850845
loss_pred:0.02800573781132698, decouple_loss:0.01290211547166109
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498312473297119, gen p mean: -0.7171072363853455, mean p set: 0.4503115713596344
The modified gen p mean: 0.4527330696582794, gen p mean: -0.7079858183860779, mean p set: 0.45321333408355713
The modified gen p mean: 0.4525023102760315, gen p mean: -0.7059447169303894, mean p set: 0.4529826045036316
loss_pred:0.027971163392066956, decouple_loss:0.01370957214385271
loss_pred:0.028332533314824104, decouple_loss:0.013512170873582363
loss_pred:0.028430847451090813, decouple_loss:0.013231025077402592
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502890408039093, gen p mean: -0.7035448551177979, mean p set: 0.450769305229187
The modified gen p mean: 0.45016443729400635, gen p mean: -0.6996416449546814, mean p set: 0.45064473152160645
The modified gen p mean: 0.4520719647407532, gen p mean: -0.7064303755760193, mean p set: 0.45255225896835327
loss_pred:0.029438717290759087, decouple_loss:0.013995976187288761
loss_pred:0.02831893041729927, decouple_loss:0.013557558879256248
loss_pred:0.026822304353117943, decouple_loss:0.014082355424761772
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511301815509796, gen p mean: -0.7069446444511414, mean p set: 0.4516104459762573
The modified gen p mean: 0.4522389769554138, gen p mean: -0.7022622227668762, mean p set: 0.45271924138069153
The modified gen p mean: 0.4516649544239044, gen p mean: -0.6980639100074768, mean p set: 0.4521452486515045
loss_pred:0.02783236838877201, decouple_loss:0.012426534667611122loss_pred:0.02845846302807331, decouple_loss:0.012648862786591053
loss_pred:0.02849472314119339, decouple_loss:0.012395469471812248
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45230579376220703, gen p mean: -0.708550214767456, mean p set: 0.45278608798980713
The modified gen p mean: 0.4531138837337494, gen p mean: -0.7085697650909424, mean p set: 0.4535941779613495
The modified gen p mean: 0.45236918330192566, gen p mean: -0.717799723148346, mean p set: 0.45284944772720337
loss_pred:0.02999061532318592, decouple_loss:0.01292018499225378
loss_pred:0.02883613295853138, decouple_loss:0.01306213065981865
loss_pred:0.028770020231604576, decouple_loss:0.013781757093966007
2023-05-06 19:42:57 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7324717044830322, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.718548595905304, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7236875891685486, mean p set: 0.4500633478164673
loss_pred:0.02843557670712471, decouple_loss:0.015148092992603779
loss_pred:0.027010807767510414, decouple_loss:0.014690542593598366
loss_pred:0.027251506224274635, decouple_loss:0.014703100547194481
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028308328241109848, avg_mse: 0.033321790397167206
current test mse: 0.033322
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533770680427551, gen p mean: -0.7099781036376953, mean p set: 0.45385733246803284
The modified gen p mean: 0.4519554674625397, gen p mean: -0.7080731391906738, mean p set: 0.45243576169013977
loss_pred:0.02910347282886505, decouple_loss:0.013122625648975372
loss_pred:0.029002824798226357, decouple_loss:0.012792332097887993
The modified gen p mean: 0.4513815641403198, gen p mean: -0.7064303755760193, mean p set: 0.4518618583679199
loss_pred:0.028098976239562035, decouple_loss:0.013224581256508827
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45062482357025146, gen p mean: -0.7088121771812439, mean p set: 0.4511050879955292
The modified gen p mean: 0.44984734058380127, gen p mean: -0.69950270652771, mean p set: 0.45032763481140137
The modified gen p mean: 0.4526446461677551, gen p mean: -0.7023128271102905, mean p set: 0.4531249403953552
loss_pred:0.029125796630978584, decouple_loss:0.012924185022711754
loss_pred:0.02901899628341198, decouple_loss:0.013235596008598804
loss_pred:0.02892628312110901, decouple_loss:0.012908079661428928
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45221346616744995, gen p mean: -0.6918331384658813, mean p set: 0.45269373059272766
The modified gen p mean: 0.45179077982902527, gen p mean: -0.7023763060569763, mean p set: 0.45227110385894775
The modified gen p mean: 0.4518081247806549, gen p mean: -0.6981834173202515, mean p set: 0.4522883892059326
loss_pred:0.028291935101151466, decouple_loss:0.012812640517950058
loss_pred:0.028389781713485718, decouple_loss:0.012794806621968746
loss_pred:0.028061242774128914, decouple_loss:0.012961110100150108
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497220814228058, gen p mean: -0.7085180878639221, mean p set: 0.4502023756504059
The modified gen p mean: 0.45204871892929077, gen p mean: -0.6952930688858032, mean p set: 0.4525289833545685
The modified gen p mean: 0.4519249200820923, gen p mean: -0.7125106453895569, mean p set: 0.45240524411201477
loss_pred:0.02774987556040287, decouple_loss:0.013020569458603859
loss_pred:0.028825916349887848, decouple_loss:0.01303221844136715
loss_pred:0.028080575168132782, decouple_loss:0.012909076176583767
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515971839427948, gen p mean: -0.7045963406562805, mean p set: 0.4520774781703949
The modified gen p mean: 0.45259809494018555, gen p mean: -0.719456672668457, mean p set: 0.45307838916778564
The modified gen p mean: 0.45225998759269714, gen p mean: -0.7066174745559692, mean p set: 0.45274025201797485
loss_pred:0.028287803754210472, decouple_loss:0.0126279816031456
loss_pred:0.02757030539214611, decouple_loss:0.012586360797286034
loss_pred:0.0282440222799778, decouple_loss:0.012811437249183655
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037195086479187, gen p mean: -0.7144325375556946, mean p set: 0.4508522152900696
The modified gen p mean: 0.45107221603393555, gen p mean: -0.7110019326210022, mean p set: 0.45155251026153564
The modified gen p mean: 0.4527319073677063, gen p mean: -0.7069311738014221, mean p set: 0.453212171792984
loss_pred:0.028835609555244446, decouple_loss:0.013138769194483757
loss_pred:0.02853032387793064, decouple_loss:0.012704004533588886
loss_pred:0.02869640663266182, decouple_loss:0.012678003869950771
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507010281085968, gen p mean: -0.7269904613494873, mean p set: 0.4511813521385193
The modified gen p mean: 0.4519454538822174, gen p mean: -0.7068676948547363, mean p set: 0.4524257183074951
loss_pred:0.027716871351003647, decouple_loss:0.01294601522386074
loss_pred:0.029398638755083084, decouple_loss:0.012290861457586288
The modified gen p mean: 0.45109426975250244, gen p mean: -0.7185251712799072, mean p set: 0.45157456398010254
loss_pred:0.028113720938563347, decouple_loss:0.012571034952998161
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498354196548462, gen p mean: -0.7234760522842407, mean p set: 0.4503157436847687
The modified gen p mean: 0.4511075019836426, gen p mean: -0.7188930511474609, mean p set: 0.45158782601356506
The modified gen p mean: 0.45123711228370667, gen p mean: -0.713864803314209, mean p set: 0.45171743631362915
loss_pred:0.0282275527715683, decouple_loss:0.012178870849311352
loss_pred:0.027887625619769096, decouple_loss:0.012353593483567238
loss_pred:0.02820209227502346, decouple_loss:0.012465406209230423
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513130486011505, gen p mean: -0.7226139307022095, mean p set: 0.4517933130264282
The modified gen p mean: 0.4503428041934967, gen p mean: -0.7185491919517517, mean p set: 0.4508230984210968
The modified gen p mean: 0.45213136076927185, gen p mean: -0.7297431230545044, mean p set: 0.45261165499687195
loss_pred:0.028194822371006012, decouple_loss:0.012535180896520615
loss_pred:0.02912420593202114, decouple_loss:0.012765929102897644
loss_pred:0.026559825986623764, decouple_loss:0.012750601395964622
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501243233680725, gen p mean: -0.7239450812339783, mean p set: 0.4506046175956726
The modified gen p mean: 0.4508246183395386, gen p mean: -0.7350701689720154, mean p set: 0.45130491256713867
The modified gen p mean: 0.44919705390930176, gen p mean: -0.7217806577682495, mean p set: 0.44967731833457947
loss_pred:0.027709754183888435, decouple_loss:0.014244843274354935
loss_pred:0.027031049132347107, decouple_loss:0.013978458940982819
loss_pred:0.028374316170811653, decouple_loss:0.01367875188589096
2023-05-06 19:47:43 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7316249012947083, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7173013687133789, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7231472134590149, mean p set: 0.4500633478164673
loss_pred:0.028386881574988365, decouple_loss:0.014476523734629154
loss_pred:0.026872968301177025, decouple_loss:0.013912019319832325
loss_pred:0.02721409499645233, decouple_loss:0.014012162573635578
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028197994455695152, avg_mse: 0.03344797343015671
current test mse: 0.033448
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492708742618561, gen p mean: -0.7103111147880554, mean p set: 0.4497511684894562
The modified gen p mean: 0.4501873850822449, gen p mean: -0.7260882258415222, mean p set: 0.45066767930984497
loss_pred:0.02816104143857956, decouple_loss:0.014240051619708538
loss_pred:0.028550049290060997, decouple_loss:0.013551931828260422
The modified gen p mean: 0.44911807775497437, gen p mean: -0.7171927690505981, mean p set: 0.44959837198257446
loss_pred:0.028356442227959633, decouple_loss:0.013461604714393616
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476586580276489, gen p mean: -0.7075085639953613, mean p set: 0.44813892245292664
The modified gen p mean: 0.449287086725235, gen p mean: -0.7075386643409729, mean p set: 0.4497673809528351
The modified gen p mean: 0.4490286111831665, gen p mean: -0.7103283405303955, mean p set: 0.4495089054107666
loss_pred:0.028690872713923454, decouple_loss:0.01363177690654993
loss_pred:0.027554109692573547, decouple_loss:0.013549134135246277
loss_pred:0.02779524028301239, decouple_loss:0.013239081017673016
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498368203639984, gen p mean: -0.7070997357368469, mean p set: 0.4503171145915985
The modified gen p mean: 0.45090633630752563, gen p mean: -0.7109904885292053, mean p set: 0.45138660073280334
The modified gen p mean: 0.44901034235954285, gen p mean: -0.7176055908203125, mean p set: 0.44949063658714294
loss_pred:0.027157334610819817, decouple_loss:0.012515350244939327
loss_pred:0.02746482379734516, decouple_loss:0.013051090762019157
loss_pred:0.027016373351216316, decouple_loss:0.01335627119988203
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488268494606018, gen p mean: -0.7122577428817749, mean p set: 0.4493071436882019
The modified gen p mean: 0.4501386880874634, gen p mean: -0.7237401604652405, mean p set: 0.4506189823150635
The modified gen p mean: 0.44863173365592957, gen p mean: -0.7089799642562866, mean p set: 0.4491119980812073
loss_pred:0.027171416208148003, decouple_loss:0.013196122832596302loss_pred:0.028038758784532547, decouple_loss:0.013082138262689114
loss_pred:0.028141867369413376, decouple_loss:0.013148347847163677
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449203222990036, gen p mean: -0.7074226140975952, mean p set: 0.4496835172176361
The modified gen p mean: 0.44822660088539124, gen p mean: -0.7114152312278748, mean p set: 0.44870686531066895
The modified gen p mean: 0.44893956184387207, gen p mean: -0.716251015663147, mean p set: 0.4494198262691498
loss_pred:0.028757108375430107, decouple_loss:0.012463478371500969loss_pred:0.027209989726543427, decouple_loss:0.012280912138521671
loss_pred:0.027931520715355873, decouple_loss:0.012893181294202805
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484655559062958, gen p mean: -0.7074262499809265, mean p set: 0.4489458501338959
The modified gen p mean: 0.4489181935787201, gen p mean: -0.7082574367523193, mean p set: 0.4493984878063202
The modified gen p mean: 0.4488588571548462, gen p mean: -0.7114908695220947, mean p set: 0.4493391215801239
loss_pred:0.027383312582969666, decouple_loss:0.012840519659221172
loss_pred:0.02815503627061844, decouple_loss:0.012692286632955074
loss_pred:0.027628805488348007, decouple_loss:0.012235259637236595
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44926688075065613, gen p mean: -0.7150564789772034, mean p set: 0.4497471749782562
The modified gen p mean: 0.44797298312187195, gen p mean: -0.704727292060852, mean p set: 0.44845327734947205
The modified gen p mean: 0.44919630885124207, gen p mean: -0.7165278792381287, mean p set: 0.4496765732765198
loss_pred:0.02600119076669216, decouple_loss:0.013014997355639935
loss_pred:0.026683645322918892, decouple_loss:0.012725123204290867
loss_pred:0.027437403798103333, decouple_loss:0.012803710997104645
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874081015586853, gen p mean: -0.7139409184455872, mean p set: 0.449221134185791
The modified gen p mean: 0.44969239830970764, gen p mean: -0.7146568894386292, mean p set: 0.45017269253730774
The modified gen p mean: 0.4500710964202881, gen p mean: -0.7276127338409424, mean p set: 0.4505513906478882
loss_pred:0.02731086127460003, decouple_loss:0.0125190494582057
loss_pred:0.026965754106640816, decouple_loss:0.012406461872160435
loss_pred:0.027173232287168503, decouple_loss:0.013317392207682133
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803234934806824, gen p mean: -0.7081656455993652, mean p set: 0.44851261377334595
The modified gen p mean: 0.44886115193367004, gen p mean: -0.7117618322372437, mean p set: 0.44934147596359253
The modified gen p mean: 0.4502295255661011, gen p mean: -0.7214406132698059, mean p set: 0.45070981979370117
loss_pred:0.026120254769921303, decouple_loss:0.011987773701548576
loss_pred:0.028167979791760445, decouple_loss:0.012100199237465858
loss_pred:0.02724781446158886, decouple_loss:0.012744400650262833
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500034749507904, gen p mean: -0.7195850014686584, mean p set: 0.4504837691783905
The modified gen p mean: 0.4494743347167969, gen p mean: -0.7285693287849426, mean p set: 0.44995465874671936
The modified gen p mean: 0.4506630599498749, gen p mean: -0.7125882506370544, mean p set: 0.451143354177475
loss_pred:0.027610264718532562, decouple_loss:0.012846661731600761
loss_pred:0.027002008631825447, decouple_loss:0.012185618281364441
loss_pred:0.027857225388288498, decouple_loss:0.012056564912199974
2023-05-06 19:51:19 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7341668009757996, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7202894687652588, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.7264672517776489, mean p set: 0.4500633478164673
loss_pred:0.028302976861596107, decouple_loss:0.013245136477053165
loss_pred:0.026787694543600082, decouple_loss:0.01261921413242817
loss_pred:0.027108855545520782, decouple_loss:0.012559212744235992
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028040235862135887, avg_mse: 0.033127374947071075
current test mse: 0.033127
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497798681259155, gen p mean: -0.7267175912857056, mean p set: 0.45026013255119324
The modified gen p mean: 0.4492749869823456, gen p mean: -0.7295964360237122, mean p set: 0.4497552812099457
loss_pred:0.027628188952803612, decouple_loss:0.01227484829723835
loss_pred:0.026947742328047752, decouple_loss:0.011803536675870419
The modified gen p mean: 0.4496731460094452, gen p mean: -0.7167071104049683, mean p set: 0.4501534700393677
loss_pred:0.027431199327111244, decouple_loss:0.012121590785682201
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903799891471863, gen p mean: -0.7095885276794434, mean p set: 0.4495182931423187
The modified gen p mean: 0.44965091347694397, gen p mean: -0.7146254181861877, mean p set: 0.45013123750686646
The modified gen p mean: 0.44918423891067505, gen p mean: -0.7132956385612488, mean p set: 0.4496645927429199
loss_pred:0.02766004577279091, decouple_loss:0.012520642951130867
loss_pred:0.027352746576070786, decouple_loss:0.011546800844371319
loss_pred:0.027520133182406425, decouple_loss:0.011449025943875313
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496931731700897, gen p mean: -0.7002224922180176, mean p set: 0.4501734673976898
The modified gen p mean: 0.44943392276763916, gen p mean: -0.6975098848342896, mean p set: 0.44991418719291687
The modified gen p mean: 0.45058590173721313, gen p mean: -0.7022566795349121, mean p set: 0.45106619596481323
loss_pred:0.027422606945037842, decouple_loss:0.011568615213036537
loss_pred:0.02725355327129364, decouple_loss:0.012036311440169811
loss_pred:0.026340695098042488, decouple_loss:0.011341148987412453
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501102566719055, gen p mean: -0.6956882476806641, mean p set: 0.4505905210971832
The modified gen p mean: 0.44948598742485046, gen p mean: -0.6966274976730347, mean p set: 0.44996631145477295
The modified gen p mean: 0.448393851518631, gen p mean: -0.6952983736991882, mean p set: 0.4488740861415863
loss_pred:0.027514174580574036, decouple_loss:0.011919345706701279
loss_pred:0.0267762653529644, decouple_loss:0.012284602969884872
loss_pred:0.027477916330099106, decouple_loss:0.011780662462115288
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502960443496704, gen p mean: -0.7103835940361023, mean p set: 0.4507763385772705
The modified gen p mean: 0.44837287068367004, gen p mean: -0.7004083395004272, mean p set: 0.44885316491127014
The modified gen p mean: 0.45080986618995667, gen p mean: -0.6989593505859375, mean p set: 0.45129016041755676
loss_pred:0.026929259300231934, decouple_loss:0.012111862190067768
loss_pred:0.027778254821896553, decouple_loss:0.011693797074258327
loss_pred:0.027624011039733887, decouple_loss:0.011451019905507565
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485131502151489, gen p mean: -0.7051395177841187, mean p set: 0.448993444442749
The modified gen p mean: 0.44858768582344055, gen p mean: -0.7057897448539734, mean p set: 0.44906798005104065
The modified gen p mean: 0.44965627789497375, gen p mean: -0.7105298042297363, mean p set: 0.45013657212257385
loss_pred:0.02729443833231926, decouple_loss:0.011502813547849655
loss_pred:0.02759936824440956, decouple_loss:0.012010338716208935
loss_pred:0.027388764545321465, decouple_loss:0.01156751997768879
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860759377479553, gen p mean: -0.7047776579856873, mean p set: 0.44908788800239563
The modified gen p mean: 0.44836917519569397, gen p mean: -0.7051175236701965, mean p set: 0.44884949922561646
The modified gen p mean: 0.4493621587753296, gen p mean: -0.7042566537857056, mean p set: 0.4498424530029297
loss_pred:0.02789360284805298, decouple_loss:0.01133092399686575
loss_pred:0.028096124529838562, decouple_loss:0.012192920781672001
loss_pred:0.02753988280892372, decouple_loss:0.011647896841168404
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503858983516693, gen p mean: -0.7152384519577026, mean p set: 0.4508661925792694
The modified gen p mean: 0.4497874081134796, gen p mean: -0.7071956396102905, mean p set: 0.4502677023410797
The modified gen p mean: 0.4480297267436981, gen p mean: -0.6997585296630859, mean p set: 0.44850999116897583
loss_pred:0.027312863618135452, decouple_loss:0.012418270111083984
loss_pred:0.027405116707086563, decouple_loss:0.011558850295841694
loss_pred:0.027572359889745712, decouple_loss:0.011979836039245129
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492380619049072, gen p mean: -0.7057360410690308, mean p set: 0.4497183561325073
The modified gen p mean: 0.4480578601360321, gen p mean: -0.7012137174606323, mean p set: 0.4485381245613098
The modified gen p mean: 0.4492861032485962, gen p mean: -0.7054096460342407, mean p set: 0.4497663974761963
loss_pred:0.028152769431471825, decouple_loss:0.012031509540975094loss_pred:0.027910824865102768, decouple_loss:0.011654029600322247
loss_pred:0.02672654204070568, decouple_loss:0.011457784101366997
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502430558204651, gen p mean: -0.7017082571983337, mean p set: 0.4507233798503876
The modified gen p mean: 0.4498547315597534, gen p mean: -0.7086884379386902, mean p set: 0.4503350555896759
The modified gen p mean: 0.4494415819644928, gen p mean: -0.7074315547943115, mean p set: 0.4499218463897705
loss_pred:0.02588769793510437, decouple_loss:0.012672645039856434
loss_pred:0.026473263278603554, decouple_loss:0.011756022460758686
loss_pred:0.026866866275668144, decouple_loss:0.012146839872002602
2023-05-06 19:55:46 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.711113452911377, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6983876824378967, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7036306858062744, mean p set: 0.4500633478164673
loss_pred:0.02787124179303646, decouple_loss:0.012459545396268368
loss_pred:0.026455892249941826, decouple_loss:0.011899436824023724
loss_pred:0.02683558687567711, decouple_loss:0.011911360546946526
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027658745646476746, avg_mse: 0.03272225707769394
current test mse: 0.032722
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472404718399048, gen p mean: -0.6950883865356445, mean p set: 0.4477207064628601
The modified gen p mean: 0.450771301984787, gen p mean: -0.69696044921875, mean p set: 0.4512515664100647
loss_pred:0.026330912485718727, decouple_loss:0.01156298816204071
loss_pred:0.026369880884885788, decouple_loss:0.011982184834778309
The modified gen p mean: 0.45016369223594666, gen p mean: -0.6951541900634766, mean p set: 0.45064398646354675
loss_pred:0.02505931816995144, decouple_loss:0.011916442774236202
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45020556449890137, gen p mean: -0.6960161924362183, mean p set: 0.4506858289241791
The modified gen p mean: 0.4500688910484314, gen p mean: -0.6992648243904114, mean p set: 0.4505492150783539
The modified gen p mean: 0.4494057595729828, gen p mean: -0.7042793035507202, mean p set: 0.4498860538005829
loss_pred:0.026093484833836555, decouple_loss:0.012266810052096844loss_pred:0.02551107108592987, decouple_loss:0.012078219093382359
loss_pred:0.02727065421640873, decouple_loss:0.011826316826045513
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836828112602234, gen p mean: -0.703783392906189, mean p set: 0.44884857535362244
The modified gen p mean: 0.4505947530269623, gen p mean: -0.7033036351203918, mean p set: 0.4510750472545624
The modified gen p mean: 0.44959110021591187, gen p mean: -0.7078055143356323, mean p set: 0.45007139444351196
loss_pred:0.026674073189496994, decouple_loss:0.011396989226341248
loss_pred:0.026593461632728577, decouple_loss:0.011829105205833912
loss_pred:0.026339242234826088, decouple_loss:0.01239978987723589
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504186511039734, gen p mean: -0.7128515839576721, mean p set: 0.4508989155292511
The modified gen p mean: 0.4499109387397766, gen p mean: -0.7014517188072205, mean p set: 0.4503912329673767
The modified gen p mean: 0.4487708508968353, gen p mean: -0.7057219743728638, mean p set: 0.4492511451244354
loss_pred:0.025600653141736984, decouple_loss:0.011764203198254108
loss_pred:0.024795250967144966, decouple_loss:0.011430512182414532
loss_pred:0.027494048699736595, decouple_loss:0.011693337932229042
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44905534386634827, gen p mean: -0.7196442484855652, mean p set: 0.44953563809394836
The modified gen p mean: 0.4487534165382385, gen p mean: -0.7055550217628479, mean p set: 0.4492337107658386
loss_pred:0.02659958228468895, decouple_loss:0.01201482955366373
loss_pred:0.02609110251069069, decouple_loss:0.011776236817240715
The modified gen p mean: 0.4494454860687256, gen p mean: -0.7052857279777527, mean p set: 0.4499257802963257
loss_pred:0.02709483727812767, decouple_loss:0.011261229403316975
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44956204295158386, gen p mean: -0.7225133776664734, mean p set: 0.4500423073768616
The modified gen p mean: 0.4483104944229126, gen p mean: -0.7182197570800781, mean p set: 0.4487907588481903
The modified gen p mean: 0.4484518766403198, gen p mean: -0.7111881971359253, mean p set: 0.4489321708679199
loss_pred:0.026904158294200897, decouple_loss:0.011390690691769123
loss_pred:0.02669544890522957, decouple_loss:0.011393771506845951
loss_pred:0.026222147047519684, decouple_loss:0.011302907019853592
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472036361694336, gen p mean: -0.7117698788642883, mean p set: 0.4476839303970337
The modified gen p mean: 0.4494165778160095, gen p mean: -0.7156404852867126, mean p set: 0.4498968720436096
The modified gen p mean: 0.4502202570438385, gen p mean: -0.7269490361213684, mean p set: 0.4507005214691162
loss_pred:0.026316342875361443, decouple_loss:0.011201820336282253
loss_pred:0.026052458211779594, decouple_loss:0.01160364504903555
loss_pred:0.025878967717289925, decouple_loss:0.010916381143033504
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499286413192749, gen p mean: -0.7063523530960083, mean p set: 0.450408935546875
The modified gen p mean: 0.44951102137565613, gen p mean: -0.720360279083252, mean p set: 0.4499913156032562
The modified gen p mean: 0.44892197847366333, gen p mean: -0.7075007557868958, mean p set: 0.4494022727012634
loss_pred:0.02582521364092827, decouple_loss:0.011248853988945484loss_pred:0.02576359361410141, decouple_loss:0.010953573510050774
loss_pred:0.028075316920876503, decouple_loss:0.010572033002972603
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044639706611633, gen p mean: -0.7194246053695679, mean p set: 0.45092666149139404
The modified gen p mean: 0.45011699199676514, gen p mean: -0.7114902138710022, mean p set: 0.4505973160266876
The modified gen p mean: 0.447736918926239, gen p mean: -0.7115970849990845, mean p set: 0.4482172131538391
loss_pred:0.025839736685156822, decouple_loss:0.01110394299030304
loss_pred:0.02688107267022133, decouple_loss:0.011205889284610748
loss_pred:0.026400567963719368, decouple_loss:0.011145890690386295
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449653297662735, gen p mean: -0.7068623304367065, mean p set: 0.4501335322856903
The modified gen p mean: 0.4502854347229004, gen p mean: -0.7093805074691772, mean p set: 0.4507656991481781
The modified gen p mean: 0.4490760564804077, gen p mean: -0.7141831517219543, mean p set: 0.4495563805103302
loss_pred:0.02589319832623005, decouple_loss:0.011418627575039864loss_pred:0.025786077603697777, decouple_loss:0.01089175883680582
loss_pred:0.026928719133138657, decouple_loss:0.01144347619265318
2023-05-06 19:59:22 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7188818454742432, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7066391110420227, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7115299701690674, mean p set: 0.4500633478164673
loss_pred:0.027761807665228844, decouple_loss:0.011845679953694344
loss_pred:0.026394717395305634, decouple_loss:0.01116012129932642
loss_pred:0.026673968881368637, decouple_loss:0.011262083426117897
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027514629065990448, avg_mse: 0.03258097171783447
current test mse: 0.032581
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489338994026184, gen p mean: -0.7058568596839905, mean p set: 0.4494141638278961
The modified gen p mean: 0.449152410030365, gen p mean: -0.7102861404418945, mean p set: 0.4496326744556427
loss_pred:0.02741696685552597, decouple_loss:0.010545015335083008
loss_pred:0.026794733479619026, decouple_loss:0.011024375446140766
The modified gen p mean: 0.4478796720504761, gen p mean: -0.7035925388336182, mean p set: 0.44835996627807617
loss_pred:0.027356334030628204, decouple_loss:0.01129202451556921
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492276608943939, gen p mean: -0.7046552300453186, mean p set: 0.449707955121994
The modified gen p mean: 0.4496975243091583, gen p mean: -0.7110188007354736, mean p set: 0.4501778185367584
The modified gen p mean: 0.44969743490219116, gen p mean: -0.7089962959289551, mean p set: 0.45017769932746887
loss_pred:0.026351260021328926, decouple_loss:0.011065362952649593
loss_pred:0.025789937004446983, decouple_loss:0.011641733348369598
loss_pred:0.025303484871983528, decouple_loss:0.011068259365856647
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504387676715851, gen p mean: -0.7139955759048462, mean p set: 0.4509190618991852
The modified gen p mean: 0.4475174844264984, gen p mean: -0.7156853675842285, mean p set: 0.4479977786540985
The modified gen p mean: 0.449002742767334, gen p mean: -0.711804211139679, mean p set: 0.4494830369949341
loss_pred:0.02601480856537819, decouple_loss:0.010906697250902653
loss_pred:0.026993993669748306, decouple_loss:0.010873361490666866
loss_pred:0.02660352922976017, decouple_loss:0.010761176235973835
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500133991241455, gen p mean: -0.7262084484100342, mean p set: 0.4504936933517456
The modified gen p mean: 0.4490104019641876, gen p mean: -0.7278178334236145, mean p set: 0.44949066638946533
The modified gen p mean: 0.44910547137260437, gen p mean: -0.7255557775497437, mean p set: 0.44958579540252686
loss_pred:0.025020699948072433, decouple_loss:0.010866308584809303
loss_pred:0.027094010263681412, decouple_loss:0.011011870577931404
loss_pred:0.026981564238667488, decouple_loss:0.01093575730919838
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45034259557724, gen p mean: -0.7319302558898926, mean p set: 0.4508228898048401
The modified gen p mean: 0.44795697927474976, gen p mean: -0.7288177609443665, mean p set: 0.44843724370002747
The modified gen p mean: 0.44825124740600586, gen p mean: -0.7261936068534851, mean p set: 0.44873154163360596
loss_pred:0.025993486866354942, decouple_loss:0.011011517606675625
loss_pred:0.025129515677690506, decouple_loss:0.01078509446233511
loss_pred:0.026140600442886353, decouple_loss:0.010664474219083786
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494202733039856, gen p mean: -0.7332760095596313, mean p set: 0.4499005675315857
The modified gen p mean: 0.45028233528137207, gen p mean: -0.723720371723175, mean p set: 0.45076262950897217
The modified gen p mean: 0.448622465133667, gen p mean: -0.7299527525901794, mean p set: 0.4491027593612671
loss_pred:0.025428391993045807, decouple_loss:0.011005453765392303
loss_pred:0.02554680034518242, decouple_loss:0.011268661357462406
loss_pred:0.02649816684424877, decouple_loss:0.01063444558531046
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45058080554008484, gen p mean: -0.7174860239028931, mean p set: 0.45106109976768494
The modified gen p mean: 0.4475288689136505, gen p mean: -0.7246121168136597, mean p set: 0.448009192943573
The modified gen p mean: 0.44841182231903076, gen p mean: -0.7234758138656616, mean p set: 0.44889214634895325
loss_pred:0.025003857910633087, decouple_loss:0.010657211765646935
loss_pred:0.025599446147680283, decouple_loss:0.010813089087605476
loss_pred:0.026418279856443405, decouple_loss:0.01052189152687788
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493323266506195, gen p mean: -0.7248244881629944, mean p set: 0.4498126208782196
The modified gen p mean: 0.450539231300354, gen p mean: -0.7198683619499207, mean p set: 0.4510194957256317
The modified gen p mean: 0.44891074299812317, gen p mean: -0.715029776096344, mean p set: 0.44939103722572327
loss_pred:0.026523897424340248, decouple_loss:0.010869946330785751
loss_pred:0.02537766844034195, decouple_loss:0.01034663338214159
loss_pred:0.02599436044692993, decouple_loss:0.01106724701821804
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931894540786743, gen p mean: -0.7084702849388123, mean p set: 0.4497992694377899The modified gen p mean: 0.4490041136741638, gen p mean: -0.7217939496040344, mean p set: 0.4494844079017639
The modified gen p mean: 0.448871374130249, gen p mean: -0.7179384231567383, mean p set: 0.4493516683578491
loss_pred:0.02566087245941162, decouple_loss:0.010807329788804054
loss_pred:0.026674427092075348, decouple_loss:0.01087766420096159
loss_pred:0.027293676510453224, decouple_loss:0.010997802019119263
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474874436855316, gen p mean: -0.7082427740097046, mean p set: 0.4479677379131317
The modified gen p mean: 0.4484160542488098, gen p mean: -0.7045930624008179, mean p set: 0.4488963484764099
The modified gen p mean: 0.4473456144332886, gen p mean: -0.704361081123352, mean p set: 0.44782590866088867
loss_pred:0.02676291950047016, decouple_loss:0.011564132757484913
loss_pred:0.027790166437625885, decouple_loss:0.010888383723795414
loss_pred:0.025276534259319305, decouple_loss:0.010543652810156345
2023-05-06 20:04:14 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7246145606040955, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7122349739074707, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7169758081436157, mean p set: 0.4500633478164673
loss_pred:0.02769828960299492, decouple_loss:0.011633910238742828
loss_pred:0.026348581537604332, decouple_loss:0.011006577871739864
loss_pred:0.02667812816798687, decouple_loss:0.011120295152068138
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027471013367176056, avg_mse: 0.032590724527835846
current test mse: 0.032591
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481850862503052, gen p mean: -0.7127216458320618, mean p set: 0.44866541028022766
The modified gen p mean: 0.44876590371131897, gen p mean: -0.7140961289405823, mean p set: 0.44924619793891907
loss_pred:0.026942739263176918, decouple_loss:0.010850759223103523
loss_pred:0.026547260582447052, decouple_loss:0.010970240458846092
The modified gen p mean: 0.4460190236568451, gen p mean: -0.7086446285247803, mean p set: 0.4464992880821228
loss_pred:0.027817877009510994, decouple_loss:0.010820643976330757
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482777714729309, gen p mean: -0.7293115854263306, mean p set: 0.4487580358982086
The modified gen p mean: 0.44937464594841003, gen p mean: -0.729101836681366, mean p set: 0.44985491037368774
The modified gen p mean: 0.4469315707683563, gen p mean: -0.7257306575775146, mean p set: 0.44741183519363403
loss_pred:0.025514498353004456, decouple_loss:0.010899826884269714
loss_pred:0.026957903057336807, decouple_loss:0.010648698545992374
loss_pred:0.02606421895325184, decouple_loss:0.01085084117949009
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910064339637756, gen p mean: -0.7282727360725403, mean p set: 0.4495809078216553
The modified gen p mean: 0.4482327401638031, gen p mean: -0.7310773134231567, mean p set: 0.4487130343914032
The modified gen p mean: 0.4500364065170288, gen p mean: -0.7247785925865173, mean p set: 0.4505167305469513
loss_pred:0.026847869157791138, decouple_loss:0.010631265118718147
loss_pred:0.026191294193267822, decouple_loss:0.012093737721443176
loss_pred:0.02673131413757801, decouple_loss:0.010433676652610302
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464013874530792, gen p mean: -0.727594256401062, mean p set: 0.4468816816806793
The modified gen p mean: 0.4464573562145233, gen p mean: -0.7119565606117249, mean p set: 0.4469376802444458
loss_pred:0.027151737362146378, decouple_loss:0.013886158354580402
loss_pred:0.026892712339758873, decouple_loss:0.010481876321136951
The modified gen p mean: 0.44661128520965576, gen p mean: -0.7127484083175659, mean p set: 0.44709157943725586
loss_pred:0.0260294359177351, decouple_loss:0.010431346483528614
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482394754886627, gen p mean: -0.7298321723937988, mean p set: 0.4487197697162628
The modified gen p mean: 0.44736942648887634, gen p mean: -0.710288405418396, mean p set: 0.44784975051879883
The modified gen p mean: 0.4490028917789459, gen p mean: -0.7160773277282715, mean p set: 0.44948315620422363
loss_pred:0.025553548708558083, decouple_loss:0.01092865876853466
loss_pred:0.02660718560218811, decouple_loss:0.01367049477994442
loss_pred:0.02661094255745411, decouple_loss:0.010345367714762688
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488295614719391, gen p mean: -0.7316972017288208, mean p set: 0.4493098258972168
The modified gen p mean: 0.4481538236141205, gen p mean: -0.7217289209365845, mean p set: 0.44863414764404297
loss_pred:0.025632180273532867, decouple_loss:0.012227361090481281
loss_pred:0.025750232860445976, decouple_loss:0.010639269836246967
The modified gen p mean: 0.44790494441986084, gen p mean: -0.7200649976730347, mean p set: 0.44838523864746094
loss_pred:0.027320777997374535, decouple_loss:0.0109014343470335
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775640964508057, gen p mean: -0.7230699062347412, mean p set: 0.44823670387268066
The modified gen p mean: 0.44701385498046875, gen p mean: -0.7361677885055542, mean p set: 0.44749414920806885
loss_pred:0.026102855801582336, decouple_loss:0.010959455743432045
loss_pred:0.026642266660928726, decouple_loss:0.012627242133021355
The modified gen p mean: 0.447195440530777, gen p mean: -0.720836877822876, mean p set: 0.4476757347583771
loss_pred:0.02595212683081627, decouple_loss:0.010440938174724579
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44921791553497314, gen p mean: -0.7234331369400024, mean p set: 0.44969815015792847
The modified gen p mean: 0.44831985235214233, gen p mean: -0.725119411945343, mean p set: 0.44880014657974243
The modified gen p mean: 0.4479371905326843, gen p mean: -0.7190350890159607, mean p set: 0.44841745495796204
loss_pred:0.026684237644076347, decouple_loss:0.010354243218898773
loss_pred:0.02529493160545826, decouple_loss:0.010457816533744335
loss_pred:0.025583401322364807, decouple_loss:0.010424729436635971
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485984742641449, gen p mean: -0.7317483425140381, mean p set: 0.449078768491745
The modified gen p mean: 0.4468691051006317, gen p mean: -0.723106861114502, mean p set: 0.4473493695259094
The modified gen p mean: 0.44783085584640503, gen p mean: -0.7196083068847656, mean p set: 0.4483111500740051
loss_pred:0.026189807802438736, decouple_loss:0.010835863649845123
loss_pred:0.02658127434551716, decouple_loss:0.010724926367402077
loss_pred:0.026927173137664795, decouple_loss:0.011951074004173279
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472804069519043, gen p mean: -0.7274243831634521, mean p set: 0.447760671377182
The modified gen p mean: 0.4472601115703583, gen p mean: -0.7437292337417603, mean p set: 0.4477404057979584
loss_pred:0.02686508558690548, decouple_loss:0.010257404297590256
loss_pred:0.02636471949517727, decouple_loss:0.012157456018030643
The modified gen p mean: 0.4492894113063812, gen p mean: -0.7295438647270203, mean p set: 0.44976967573165894
loss_pred:0.026085032150149345, decouple_loss:0.010713248513638973
2023-05-06 20:07:51 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7381821870803833, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7255645394325256, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7307641506195068, mean p set: 0.4500633478164673
loss_pred:0.027801912277936935, decouple_loss:0.011058734729886055
loss_pred:0.02635733224451542, decouple_loss:0.010675683617591858
loss_pred:0.026659993454813957, decouple_loss:0.010575806722044945
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027478251606225967, avg_mse: 0.03261043131351471
current test mse: 0.03261
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471632242202759, gen p mean: -0.7295028567314148, mean p set: 0.4476434886455536
The modified gen p mean: 0.4473118782043457, gen p mean: -0.7306144833564758, mean p set: 0.4477921724319458
loss_pred:0.026015741750597954, decouple_loss:0.010479510761797428
loss_pred:0.025957981124520302, decouple_loss:0.01073612179607153
The modified gen p mean: 0.4476581811904907, gen p mean: -0.7252727150917053, mean p set: 0.4481384754180908
loss_pred:0.025458786636590958, decouple_loss:0.010602018795907497
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478943645954132, gen p mean: -0.7316141724586487, mean p set: 0.4483746588230133
The modified gen p mean: 0.4488774240016937, gen p mean: -0.7259955406188965, mean p set: 0.4493577182292938
loss_pred:0.02672738768160343, decouple_loss:0.012078768573701382
The modified gen p mean: 0.44693100452423096, gen p mean: -0.7286539077758789, mean p set: 0.44741132855415344
loss_pred:0.025336723774671555, decouple_loss:0.011507383547723293
loss_pred:0.026688234880566597, decouple_loss:0.012673324905335903
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794389605522156, gen p mean: -0.7148780822753906, mean p set: 0.44842419028282166
The modified gen p mean: 0.449720174074173, gen p mean: -0.7153233289718628, mean p set: 0.45020049810409546
The modified gen p mean: 0.4491988718509674, gen p mean: -0.7163881063461304, mean p set: 0.4496791362762451
loss_pred:0.02591545321047306, decouple_loss:0.010777777060866356
loss_pred:0.026650920510292053, decouple_loss:0.010144766420125961
loss_pred:0.0261975284665823, decouple_loss:0.01062608603388071
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474087059497833, gen p mean: -0.7130181193351746, mean p set: 0.4478890001773834
The modified gen p mean: 0.4493301808834076, gen p mean: -0.7162476181983948, mean p set: 0.4498105049133301
The modified gen p mean: 0.4473854601383209, gen p mean: -0.7150782942771912, mean p set: 0.44786572456359863
loss_pred:0.026356451213359833, decouple_loss:0.010514950379729271
loss_pred:0.026241693645715714, decouple_loss:0.010168002918362617
loss_pred:0.02554042637348175, decouple_loss:0.010640568099915981
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501919448375702, gen p mean: -0.7179962992668152, mean p set: 0.4506722390651703
The modified gen p mean: 0.4476604163646698, gen p mean: -0.7263518571853638, mean p set: 0.4481406807899475
loss_pred:0.026716329157352448, decouple_loss:0.010107232257723808
loss_pred:0.025978730991482735, decouple_loss:0.011708135716617107
The modified gen p mean: 0.4480293095111847, gen p mean: -0.73463374376297, mean p set: 0.4485096037387848
loss_pred:0.026410240679979324, decouple_loss:0.012274193577468395
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889628887176514, gen p mean: -0.7217968702316284, mean p set: 0.4493766129016876
The modified gen p mean: 0.44902482628822327, gen p mean: -0.7231033444404602, mean p set: 0.44950512051582336
The modified gen p mean: 0.44704607129096985, gen p mean: -0.7222376465797424, mean p set: 0.44752633571624756
loss_pred:0.027057932689785957, decouple_loss:0.010384584777057171
loss_pred:0.026083653792738914, decouple_loss:0.009788981638848782
loss_pred:0.025081302970647812, decouple_loss:0.009943829849362373
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858017563819885, gen p mean: -0.717342734336853, mean p set: 0.44906049966812134
The modified gen p mean: 0.4492303431034088, gen p mean: -0.7218596339225769, mean p set: 0.4497106075286865
loss_pred:0.025932684540748596, decouple_loss:0.009928110986948013
loss_pred:0.026125585660338402, decouple_loss:0.01036914810538292
The modified gen p mean: 0.4487685561180115, gen p mean: -0.7172210216522217, mean p set: 0.44924888014793396
loss_pred:0.026869894936680794, decouple_loss:0.010733594186604023
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705814123153687, gen p mean: -0.7082866430282593, mean p set: 0.44753846526145935
The modified gen p mean: 0.44750961661338806, gen p mean: -0.7104766964912415, mean p set: 0.44798991084098816
The modified gen p mean: 0.4461825489997864, gen p mean: -0.7041828632354736, mean p set: 0.4466628134250641
loss_pred:0.026577439159154892, decouple_loss:0.01017986424267292
loss_pred:0.02531818114221096, decouple_loss:0.009789123199880123
loss_pred:0.027215085923671722, decouple_loss:0.010392538271844387
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488517940044403, gen p mean: -0.70536208152771, mean p set: 0.4493320882320404
The modified gen p mean: 0.4487161636352539, gen p mean: -0.7105663418769836, mean p set: 0.4491964280605316
The modified gen p mean: 0.44830477237701416, gen p mean: -0.7197100520133972, mean p set: 0.44878509640693665
loss_pred:0.025313086807727814, decouple_loss:0.01008536946028471
loss_pred:0.026389576494693756, decouple_loss:0.010722404345870018
loss_pred:0.026281196624040604, decouple_loss:0.012075240723788738
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012000_3_24hr.npz
NaN value num: 0
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45174798369407654, gen p mean: -0.698321521282196, mean p set: 0.45222827792167664
The modified gen p mean: 0.4521959722042084, gen p mean: -0.7195246815681458, mean p set: 0.45267629623413086
The modified gen p mean: 0.4511978030204773, gen p mean: -0.722417414188385, mean p set: 0.451678067445755
loss_pred:0.025611447170376778, decouple_loss:0.01178405899554491
loss_pred:0.026022374629974365, decouple_loss:0.012522447854280472
loss_pred:0.025431249290704727, decouple_loss:0.011657644994556904
2023-05-06 20:12:11 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7246115207672119, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7125789523124695, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7172766923904419, mean p set: 0.4500633478164673
loss_pred:0.027696626260876656, decouple_loss:0.011077383533120155
loss_pred:0.026236794888973236, decouple_loss:0.010713321156799793
loss_pred:0.02648940309882164, decouple_loss:0.010551147162914276
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027346638962626457, avg_mse: 0.032373398542404175
current test mse: 0.032373
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214155316352844, gen p mean: -0.7156540751457214, mean p set: 0.45262184739112854
The modified gen p mean: 0.4512637257575989, gen p mean: -0.7097799777984619, mean p set: 0.451744019985199
loss_pred:0.0260813906788826, decouple_loss:0.011804698966443539
loss_pred:0.02601492404937744, decouple_loss:0.011728120967745781
The modified gen p mean: 0.45195165276527405, gen p mean: -0.7106714248657227, mean p set: 0.45243194699287415
loss_pred:0.02559971995651722, decouple_loss:0.011686962097883224
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520401358604431, gen p mean: -0.7148155570030212, mean p set: 0.4525204300880432
The modified gen p mean: 0.451262503862381, gen p mean: -0.7215877771377563, mean p set: 0.4517427384853363
The modified gen p mean: 0.4527490735054016, gen p mean: -0.7131235599517822, mean p set: 0.4532293379306793
loss_pred:0.027165669947862625, decouple_loss:0.01137517113238573loss_pred:0.026515468955039978, decouple_loss:0.01158299669623375
loss_pred:0.02586459182202816, decouple_loss:0.011831344105303288
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45000723004341125, gen p mean: -0.721405565738678, mean p set: 0.45048749446868896
The modified gen p mean: 0.4521009922027588, gen p mean: -0.721065104007721, mean p set: 0.4525812566280365
The modified gen p mean: 0.45175352692604065, gen p mean: -0.7250205874443054, mean p set: 0.45223382115364075
loss_pred:0.02622203342616558, decouple_loss:0.011164434254169464
loss_pred:0.02698841691017151, decouple_loss:0.011239198036491871
loss_pred:0.026440467685461044, decouple_loss:0.011518304236233234
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506673812866211, gen p mean: -0.7255949974060059, mean p set: 0.4511476457118988
The modified gen p mean: 0.4515785276889801, gen p mean: -0.7365157604217529, mean p set: 0.4520588517189026
The modified gen p mean: 0.45264801383018494, gen p mean: -0.7248100638389587, mean p set: 0.4531283378601074
loss_pred:0.026497146114706993, decouple_loss:0.011613983660936356
loss_pred:0.024405354633927345, decouple_loss:0.011386019177734852
loss_pred:0.025572286918759346, decouple_loss:0.011030549183487892
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521741271018982, gen p mean: -0.7089295387268066, mean p set: 0.4526544511318207
The modified gen p mean: 0.4508418142795563, gen p mean: -0.7327203750610352, mean p set: 0.45132210850715637
The modified gen p mean: 0.45079493522644043, gen p mean: -0.7313299775123596, mean p set: 0.4512752294540405
loss_pred:0.026068130508065224, decouple_loss:0.010997303761541843
loss_pred:0.026339532807469368, decouple_loss:0.01145389024168253
loss_pred:0.026310665532946587, decouple_loss:0.011689961887896061
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44993558526039124, gen p mean: -0.7131779193878174, mean p set: 0.45041581988334656
The modified gen p mean: 0.4512481987476349, gen p mean: -0.7184044718742371, mean p set: 0.4517285227775574
The modified gen p mean: 0.45107024908065796, gen p mean: -0.7033692002296448, mean p set: 0.45155051350593567
loss_pred:0.024839799851179123, decouple_loss:0.011625303886830807loss_pred:0.026659641414880753, decouple_loss:0.011266080662608147
loss_pred:0.02518116496503353, decouple_loss:0.01145130954682827
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45159855484962463, gen p mean: -0.725524365901947, mean p set: 0.45207884907722473
The modified gen p mean: 0.4505923390388489, gen p mean: -0.7246295809745789, mean p set: 0.45107266306877136
The modified gen p mean: 0.4513467252254486, gen p mean: -0.7215298414230347, mean p set: 0.4518270194530487
loss_pred:0.02514820173382759, decouple_loss:0.011753697879612446
loss_pred:0.02582935057580471, decouple_loss:0.011333650909364223
loss_pred:0.026464926078915596, decouple_loss:0.011416934430599213
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147550106048584, gen p mean: -0.7244362235069275, mean p set: 0.45195576548576355
The modified gen p mean: 0.45257866382598877, gen p mean: -0.7141930460929871, mean p set: 0.4530589282512665
The modified gen p mean: 0.4513177275657654, gen p mean: -0.7279192805290222, mean p set: 0.4517979919910431
loss_pred:0.02632853575050831, decouple_loss:0.011227580718696117
loss_pred:0.026007255539298058, decouple_loss:0.011857236735522747
loss_pred:0.026175038889050484, decouple_loss:0.011376367881894112
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508287012577057, gen p mean: -0.7136964201927185, mean p set: 0.4513090252876282
The modified gen p mean: 0.4516707956790924, gen p mean: -0.7157388925552368, mean p set: 0.4521510899066925
The modified gen p mean: 0.45116567611694336, gen p mean: -0.7302103042602539, mean p set: 0.45164594054222107
loss_pred:0.025542009621858597, decouple_loss:0.011658999137580395loss_pred:0.025565288960933685, decouple_loss:0.011235992424190044
loss_pred:0.024149782955646515, decouple_loss:0.011140144430100918
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45151954889297485, gen p mean: -0.7367094159126282, mean p set: 0.45199984312057495
The modified gen p mean: 0.4506579041481018, gen p mean: -0.7331650853157043, mean p set: 0.4511381685733795
loss_pred:0.02540636621415615, decouple_loss:0.011993726715445518
loss_pred:0.027244362980127335, decouple_loss:0.011823700740933418
The modified gen p mean: 0.4519599378108978, gen p mean: -0.7222871780395508, mean p set: 0.4524402320384979
loss_pred:0.025551900267601013, decouple_loss:0.01250220276415348
2023-05-06 20:15:48 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7391536831855774, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.726748526096344, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7315752506256104, mean p set: 0.4500633478164673
loss_pred:0.028562946245074272, decouple_loss:0.012970097362995148
loss_pred:0.0270000658929348, decouple_loss:0.012548292055726051
loss_pred:0.027360977604985237, decouple_loss:0.012374741956591606
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028272882103919983, avg_mse: 0.03349938243627548
current test mse: 0.033499
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509925842285156, gen p mean: -0.7369968891143799, mean p set: 0.4514729082584381
The modified gen p mean: 0.45030415058135986, gen p mean: -0.7238085269927979, mean p set: 0.45078444480895996
loss_pred:0.026137497276067734, decouple_loss:0.01194614265114069
loss_pred:0.026477087289094925, decouple_loss:0.011275866068899632
The modified gen p mean: 0.4511876404285431, gen p mean: -0.7389578223228455, mean p set: 0.4516679346561432
loss_pred:0.02467590570449829, decouple_loss:0.011803608387708664
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45069578289985657, gen p mean: -0.7294157147407532, mean p set: 0.4511760473251343
The modified gen p mean: 0.4512675702571869, gen p mean: -0.7315472364425659, mean p set: 0.451747864484787
The modified gen p mean: 0.4518689811229706, gen p mean: -0.716962993144989, mean p set: 0.4523492455482483
loss_pred:0.02648591622710228, decouple_loss:0.011894871480762959
loss_pred:0.026349686086177826, decouple_loss:0.01159970834851265
loss_pred:0.02545846626162529, decouple_loss:0.012060971930623055
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45079365372657776, gen p mean: -0.7347333431243896, mean p set: 0.45127397775650024
The modified gen p mean: 0.45065727829933167, gen p mean: -0.7307457327842712, mean p set: 0.4511375427246094
The modified gen p mean: 0.4514634311199188, gen p mean: -0.7202749848365784, mean p set: 0.4519437551498413
loss_pred:0.02704251930117607, decouple_loss:0.01292845606803894
loss_pred:0.02648100256919861, decouple_loss:0.012413183227181435
loss_pred:0.02563432790338993, decouple_loss:0.013098609633743763
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451725035905838, gen p mean: -0.7157302498817444, mean p set: 0.4522053301334381
The modified gen p mean: 0.4506402015686035, gen p mean: -0.7148017883300781, mean p set: 0.451120525598526
loss_pred:0.026446223258972168, decouple_loss:0.012594719417393208
loss_pred:0.025810610502958298, decouple_loss:0.012112130410969257
The modified gen p mean: 0.4510470926761627, gen p mean: -0.7114132642745972, mean p set: 0.4515273869037628
loss_pred:0.02593872882425785, decouple_loss:0.012105613946914673
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502986967563629, gen p mean: -0.7146933078765869, mean p set: 0.4507789611816406
The modified gen p mean: 0.45169246196746826, gen p mean: -0.7259483933448792, mean p set: 0.45217278599739075
The modified gen p mean: 0.45119667053222656, gen p mean: -0.7170697450637817, mean p set: 0.45167696475982666
loss_pred:0.02532259188592434, decouple_loss:0.011571471579372883
loss_pred:0.02668236568570137, decouple_loss:0.011621799319982529
loss_pred:0.02692762389779091, decouple_loss:0.012333540245890617
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503677487373352, gen p mean: -0.7299769520759583, mean p set: 0.4508480429649353
The modified gen p mean: 0.4509921967983246, gen p mean: -0.7308664321899414, mean p set: 0.4514724314212799
loss_pred:0.027056297287344933, decouple_loss:0.012499003671109676
loss_pred:0.02629506215453148, decouple_loss:0.012733387760818005
The modified gen p mean: 0.45165109634399414, gen p mean: -0.7226186394691467, mean p set: 0.45213139057159424
loss_pred:0.02668340876698494, decouple_loss:0.012224921025335789
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508800506591797, gen p mean: -0.7307689785957336, mean p set: 0.4513603150844574
The modified gen p mean: 0.45258578658103943, gen p mean: -0.7266881465911865, mean p set: 0.4530660808086395
The modified gen p mean: 0.45238736271858215, gen p mean: -0.7193290591239929, mean p set: 0.45286762714385986
loss_pred:0.026981230825185776, decouple_loss:0.012586232274770737
loss_pred:0.02555040828883648, decouple_loss:0.012237800285220146
loss_pred:0.02502383664250374, decouple_loss:0.012562517076730728
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505203664302826, gen p mean: -0.7126532196998596, mean p set: 0.4510006308555603
The modified gen p mean: 0.4518141746520996, gen p mean: -0.724785566329956, mean p set: 0.4522944986820221
The modified gen p mean: 0.4499012231826782, gen p mean: -0.7109792232513428, mean p set: 0.4503815174102783
loss_pred:0.02560141496360302, decouple_loss:0.011739872395992279
loss_pred:0.025090692564845085, decouple_loss:0.01175933051854372
loss_pred:0.026521893218159676, decouple_loss:0.011985329911112785
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
NaN value num: 0
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511845111846924, gen p mean: -0.7193517088890076, mean p set: 0.4516648054122925
The modified gen p mean: 0.4494902491569519, gen p mean: -0.7136180996894836, mean p set: 0.4499705135822296
The modified gen p mean: 0.45249879360198975, gen p mean: -0.7235822081565857, mean p set: 0.45297905802726746
loss_pred:0.02750556170940399, decouple_loss:0.012921992689371109
loss_pred:0.029358429834246635, decouple_loss:0.013176366686820984
loss_pred:0.025993214920163155, decouple_loss:0.012747987173497677
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512278139591217, gen p mean: -0.7324603796005249, mean p set: 0.4517081081867218
The modified gen p mean: 0.4508698880672455, gen p mean: -0.7301710247993469, mean p set: 0.4513501822948456
The modified gen p mean: 0.45077523589134216, gen p mean: -0.7219138741493225, mean p set: 0.4512555003166199
loss_pred:0.027942955493927002, decouple_loss:0.012594388797879219
loss_pred:0.027946198359131813, decouple_loss:0.012498486787080765
loss_pred:0.02829110063612461, decouple_loss:0.012546662241220474
2023-05-06 20:20:21 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7368378043174744, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7243824005126953, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7299098372459412, mean p set: 0.4500633478164673
loss_pred:0.028792502358555794, decouple_loss:0.013298870995640755
loss_pred:0.027142809703946114, decouple_loss:0.013118348084390163
loss_pred:0.027482129633426666, decouple_loss:0.012994041666388512
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028462668880820274, avg_mse: 0.033751923590898514
current test mse: 0.033752
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452468603849411, gen p mean: -0.7497074604034424, mean p set: 0.4529488980770111
The modified gen p mean: 0.4484054744243622, gen p mean: -0.7235590815544128, mean p set: 0.4488857686519623
loss_pred:0.027368538081645966, decouple_loss:0.012707221321761608
loss_pred:0.02844485454261303, decouple_loss:0.012598021887242794
The modified gen p mean: 0.4515188932418823, gen p mean: -0.7454156279563904, mean p set: 0.4519991874694824
loss_pred:0.028343897312879562, decouple_loss:0.012602285481989384
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501558840274811, gen p mean: -0.7358251214027405, mean p set: 0.4506361782550812
The modified gen p mean: 0.45089441537857056, gen p mean: -0.7419239282608032, mean p set: 0.45137470960617065
The modified gen p mean: 0.4490574598312378, gen p mean: -0.7359435558319092, mean p set: 0.4495377540588379
loss_pred:0.027715101838111877, decouple_loss:0.012315653264522552
loss_pred:0.028736498206853867, decouple_loss:0.011937919072806835
loss_pred:0.027100354433059692, decouple_loss:0.012375734746456146
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45074793696403503, gen p mean: -0.722665548324585, mean p set: 0.45122823119163513
The modified gen p mean: 0.448230504989624, gen p mean: -0.7181196808815002, mean p set: 0.4487107992172241
The modified gen p mean: 0.4518306851387024, gen p mean: -0.7340664863586426, mean p set: 0.4523109793663025
loss_pred:0.02777564525604248, decouple_loss:0.012905890122056007loss_pred:0.028772441670298576, decouple_loss:0.012571125291287899
loss_pred:0.027651892974972725, decouple_loss:0.01272017601877451
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514182507991791, gen p mean: -0.727441132068634, mean p set: 0.4518985152244568
The modified gen p mean: 0.4500799775123596, gen p mean: -0.7157335877418518, mean p set: 0.45056024193763733
The modified gen p mean: 0.4496780037879944, gen p mean: -0.7176810503005981, mean p set: 0.4501582682132721
loss_pred:0.02618752047419548, decouple_loss:0.012706211768090725
loss_pred:0.027572736144065857, decouple_loss:0.013003821484744549
loss_pred:0.02681492455303669, decouple_loss:0.011962165124714375
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495660960674286, gen p mean: -0.7183585166931152, mean p set: 0.4500464200973511
The modified gen p mean: 0.44927510619163513, gen p mean: -0.7204334735870361, mean p set: 0.4497554302215576
The modified gen p mean: 0.4486974775791168, gen p mean: -0.7192044258117676, mean p set: 0.4491777718067169
loss_pred:0.02629297971725464, decouple_loss:0.012760250829160213
loss_pred:0.0269436277449131, decouple_loss:0.01185522135347128
loss_pred:0.026705801486968994, decouple_loss:0.012054120190441608
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45008787512779236, gen p mean: -0.7278838157653809, mean p set: 0.45056816935539246
The modified gen p mean: 0.45277726650238037, gen p mean: -0.7450461983680725, mean p set: 0.45325756072998047
The modified gen p mean: 0.45285531878471375, gen p mean: -0.7414101958274841, mean p set: 0.45333564281463623
loss_pred:0.026545457541942596, decouple_loss:0.012179123237729073loss_pred:0.027207693085074425, decouple_loss:0.011958030052483082
loss_pred:0.025602620095014572, decouple_loss:0.012358207255601883
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935181736946106, gen p mean: -0.7208542823791504, mean p set: 0.44983211159706116
The modified gen p mean: 0.44968530535697937, gen p mean: -0.7254091501235962, mean p set: 0.45016559958457947
loss_pred:0.026390183717012405, decouple_loss:0.011609739623963833
loss_pred:0.025939444079995155, decouple_loss:0.0119077293202281
The modified gen p mean: 0.4507392644882202, gen p mean: -0.7265804409980774, mean p set: 0.4512195587158203
loss_pred:0.027612091973423958, decouple_loss:0.011483273468911648
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45143282413482666, gen p mean: -0.7199161648750305, mean p set: 0.45191308856010437
The modified gen p mean: 0.45174968242645264, gen p mean: -0.7324530482292175, mean p set: 0.45222997665405273
The modified gen p mean: 0.4513772428035736, gen p mean: -0.7224881649017334, mean p set: 0.4518575668334961
loss_pred:0.02601473592221737, decouple_loss:0.011632193811237812
loss_pred:0.027105014771223068, decouple_loss:0.012024261988699436
loss_pred:0.027401013299822807, decouple_loss:0.011891895905137062
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45149004459381104, gen p mean: -0.7132138013839722, mean p set: 0.45197030901908875
The modified gen p mean: 0.4512171745300293, gen p mean: -0.7152026295661926, mean p set: 0.451697438955307
The modified gen p mean: 0.4507633149623871, gen p mean: -0.7094094753265381, mean p set: 0.4512436091899872
loss_pred:0.026955876499414444, decouple_loss:0.011588847264647484
loss_pred:0.027714336290955544, decouple_loss:0.011433274485170841
loss_pred:0.027073349803686142, decouple_loss:0.0116787850856781
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45324620604515076, gen p mean: -0.7190660238265991, mean p set: 0.45372650027275085
The modified gen p mean: 0.4513542950153351, gen p mean: -0.7154228091239929, mean p set: 0.4518345892429352
The modified gen p mean: 0.4483364522457123, gen p mean: -0.7009775638580322, mean p set: 0.44881677627563477
loss_pred:0.025327321141958237, decouple_loss:0.012007949873805046
loss_pred:0.02702336572110653, decouple_loss:0.011783028021454811
loss_pred:0.027266040444374084, decouple_loss:0.011784850619733334
2023-05-06 20:23:58 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7164051532745361, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7041494250297546, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7091188430786133, mean p set: 0.4500633478164673
loss_pred:0.027857528999447823, decouple_loss:0.012461507692933083
loss_pred:0.02643141895532608, decouple_loss:0.012442609295248985
loss_pred:0.026902394369244576, decouple_loss:0.012286134995520115
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027683619409799576, avg_mse: 0.03288990631699562
current test mse: 0.03289
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45093390345573425, gen p mean: -0.7140734791755676, mean p set: 0.45141419768333435
The modified gen p mean: 0.4517655074596405, gen p mean: -0.7141293287277222, mean p set: 0.4522458016872406
loss_pred:0.027267366647720337, decouple_loss:0.011129951104521751
loss_pred:0.028034986928105354, decouple_loss:0.011495884507894516
The modified gen p mean: 0.44978851079940796, gen p mean: -0.7084070444107056, mean p set: 0.45026880502700806
loss_pred:0.026786811649799347, decouple_loss:0.011162272654473782
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45090603828430176, gen p mean: -0.7244366407394409, mean p set: 0.45138633251190186
The modified gen p mean: 0.4509352147579193, gen p mean: -0.7111659646034241, mean p set: 0.4514155387878418
The modified gen p mean: 0.45035213232040405, gen p mean: -0.7139604091644287, mean p set: 0.45083242654800415
loss_pred:0.025813205167651176, decouple_loss:0.01094296108931303
loss_pred:0.026629218831658363, decouple_loss:0.011090898886322975
loss_pred:0.026180244982242584, decouple_loss:0.0108924126252532
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450303316116333, gen p mean: -0.7091042399406433, mean p set: 0.4507836401462555
The modified gen p mean: 0.4487243890762329, gen p mean: -0.7081027626991272, mean p set: 0.4492046535015106
The modified gen p mean: 0.45017117261886597, gen p mean: -0.7158335447311401, mean p set: 0.4506514370441437
loss_pred:0.027387602254748344, decouple_loss:0.010784676298499107
loss_pred:0.02763877436518669, decouple_loss:0.011042112484574318
loss_pred:0.026068659499287605, decouple_loss:0.011050303466618061
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496941566467285, gen p mean: -0.7140131592750549, mean p set: 0.4501744508743286
The modified gen p mean: 0.4508529603481293, gen p mean: -0.7256538271903992, mean p set: 0.451333224773407
loss_pred:0.026330800727009773, decouple_loss:0.011054296046495438
loss_pred:0.02544730342924595, decouple_loss:0.010580390691757202
The modified gen p mean: 0.4497639238834381, gen p mean: -0.7211058139801025, mean p set: 0.4502442479133606
loss_pred:0.026469409465789795, decouple_loss:0.011252843774855137
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501718282699585, gen p mean: -0.7137792110443115, mean p set: 0.4506521224975586
The modified gen p mean: 0.4502318203449249, gen p mean: -0.7148900628089905, mean p set: 0.4507121443748474
loss_pred:0.026255114004015923, decouple_loss:0.010530981235206127
loss_pred:0.026035629212856293, decouple_loss:0.01030358113348484
The modified gen p mean: 0.44866201281547546, gen p mean: -0.708143413066864, mean p set: 0.44914230704307556
loss_pred:0.02634406089782715, decouple_loss:0.010471159592270851
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804269075393677, gen p mean: -0.7146231532096863, mean p set: 0.44852298498153687
The modified gen p mean: 0.45244041085243225, gen p mean: -0.7304219007492065, mean p set: 0.45292070508003235
The modified gen p mean: 0.4499867856502533, gen p mean: -0.7219047546386719, mean p set: 0.4504671096801758
loss_pred:0.02731330320239067, decouple_loss:0.01043730415403843
loss_pred:0.02807546593248844, decouple_loss:0.011174478568136692
loss_pred:0.026615368202328682, decouple_loss:0.01077146828174591
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503583312034607, gen p mean: -0.728219747543335, mean p set: 0.450838565826416
The modified gen p mean: 0.45070233941078186, gen p mean: -0.7372784614562988, mean p set: 0.45118266344070435
loss_pred:0.027882693335413933, decouple_loss:0.01061928179115057
loss_pred:0.02711043506860733, decouple_loss:0.010469560511410236
The modified gen p mean: 0.45195168256759644, gen p mean: -0.7437551617622375, mean p set: 0.45243194699287415
loss_pred:0.027852900326251984, decouple_loss:0.011238034814596176
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498998820781708, gen p mean: -0.7306467890739441, mean p set: 0.4503801465034485
The modified gen p mean: 0.4506523609161377, gen p mean: -0.740612804889679, mean p set: 0.4511326253414154
The modified gen p mean: 0.4526841342449188, gen p mean: -0.7406560182571411, mean p set: 0.4531644284725189
loss_pred:0.026043428108096123, decouple_loss:0.010510770604014397
loss_pred:0.027479715645313263, decouple_loss:0.010399717837572098
loss_pred:0.02513790875673294, decouple_loss:0.010861687362194061
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
NaN value num: 0
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513115882873535, gen p mean: -0.7188029885292053, mean p set: 0.4517918825149536
The modified gen p mean: 0.4515306353569031, gen p mean: -0.7380621433258057, mean p set: 0.4520109295845032
The modified gen p mean: 0.45232534408569336, gen p mean: -0.7297986149787903, mean p set: 0.45280560851097107
loss_pred:0.025507118552923203, decouple_loss:0.011792797595262527
loss_pred:0.024971524253487587, decouple_loss:0.011338140815496445
loss_pred:0.025617264211177826, decouple_loss:0.01157667487859726
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506045877933502, gen p mean: -0.7221060991287231, mean p set: 0.45108485221862793
The modified gen p mean: 0.4509733021259308, gen p mean: -0.7148377299308777, mean p set: 0.4514535665512085
The modified gen p mean: 0.45118024945259094, gen p mean: -0.7160483002662659, mean p set: 0.45166051387786865
loss_pred:0.02620920166373253, decouple_loss:0.011411851271986961
loss_pred:0.0255126915872097, decouple_loss:0.011608636006712914
loss_pred:0.025408877059817314, decouple_loss:0.011527630500495434
2023-05-06 20:28:16 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7217328548431396, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7097458243370056, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7143047451972961, mean p set: 0.4500633478164673
loss_pred:0.027928287163376808, decouple_loss:0.011985044926404953
loss_pred:0.026528170332312584, decouple_loss:0.011699794791638851
loss_pred:0.026905616745352745, decouple_loss:0.011473674327135086
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02770666591823101, avg_mse: 0.033067889511585236
current test mse: 0.033068
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521282911300659, gen p mean: -0.7263412475585938, mean p set: 0.45260855555534363
The modified gen p mean: 0.452853798866272, gen p mean: -0.7168797850608826, mean p set: 0.4533340632915497
loss_pred:0.024982472881674767, decouple_loss:0.01061704196035862
loss_pred:0.02582036517560482, decouple_loss:0.010468236170709133
The modified gen p mean: 0.45263397693634033, gen p mean: -0.7013119459152222, mean p set: 0.45311427116394043
loss_pred:0.025205489248037338, decouple_loss:0.011532516218721867
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516836404800415, gen p mean: -0.7147727608680725, mean p set: 0.4521639347076416
The modified gen p mean: 0.450872540473938, gen p mean: -0.7158551216125488, mean p set: 0.4513528347015381
The modified gen p mean: 0.4507342576980591, gen p mean: -0.7257513403892517, mean p set: 0.4512145519256592
loss_pred:0.02588360384106636, decouple_loss:0.01117927860468626
loss_pred:0.02693030796945095, decouple_loss:0.01113391574472189
loss_pred:0.0264090895652771, decouple_loss:0.010738378390669823
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45032015442848206, gen p mean: -0.7157477140426636, mean p set: 0.45080041885375977
The modified gen p mean: 0.4516717195510864, gen p mean: -0.7306283116340637, mean p set: 0.4521520435810089
The modified gen p mean: 0.45276185870170593, gen p mean: -0.7227725982666016, mean p set: 0.45324212312698364
loss_pred:0.02629973739385605, decouple_loss:0.011120964772999287
loss_pred:0.02499401941895485, decouple_loss:0.010960433632135391
loss_pred:0.024441609159111977, decouple_loss:0.01070176251232624
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45261350274086, gen p mean: -0.7260581254959106, mean p set: 0.4530937969684601
The modified gen p mean: 0.4501611888408661, gen p mean: -0.7286267280578613, mean p set: 0.4506414532661438
The modified gen p mean: 0.455077588558197, gen p mean: -0.7290681004524231, mean p set: 0.4555578827857971
loss_pred:0.02564135566353798, decouple_loss:0.010936444625258446
loss_pred:0.025750864297151566, decouple_loss:0.011114907450973988
loss_pred:0.026389142498373985, decouple_loss:0.01093712542206049
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519517719745636, gen p mean: -0.7126891016960144, mean p set: 0.4524320662021637
The modified gen p mean: 0.450425922870636, gen p mean: -0.7282941341400146, mean p set: 0.4509062170982361
loss_pred:0.025073882192373276, decouple_loss:0.010904964059591293
loss_pred:0.026203947141766548, decouple_loss:0.010610858909785748
The modified gen p mean: 0.4508156180381775, gen p mean: -0.7326214909553528, mean p set: 0.4512959122657776
loss_pred:0.02493090182542801, decouple_loss:0.011435359716415405
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514251947402954, gen p mean: -0.7217583060264587, mean p set: 0.4519054889678955
The modified gen p mean: 0.4516910910606384, gen p mean: -0.7357259392738342, mean p set: 0.4521713852882385
The modified gen p mean: 0.45117953419685364, gen p mean: -0.7223532199859619, mean p set: 0.45165982842445374
loss_pred:0.025313232094049454, decouple_loss:0.010632368735969067
loss_pred:0.025031613186001778, decouple_loss:0.01069832593202591
loss_pred:0.026134688407182693, decouple_loss:0.010482290759682655
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511748254299164, gen p mean: -0.741220235824585, mean p set: 0.4516550898551941
The modified gen p mean: 0.45129072666168213, gen p mean: -0.7188481688499451, mean p set: 0.45177099108695984
The modified gen p mean: 0.4500043988227844, gen p mean: -0.7349843382835388, mean p set: 0.4504847228527069
loss_pred:0.025701645761728287, decouple_loss:0.010599209927022457
loss_pred:0.025552326813340187, decouple_loss:0.011249969713389874
loss_pred:0.026027124375104904, decouple_loss:0.01041547954082489
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511377513408661, gen p mean: -0.746786892414093, mean p set: 0.4516180753707886
The modified gen p mean: 0.4524647891521454, gen p mean: -0.7265692949295044, mean p set: 0.45294511318206787
The modified gen p mean: 0.4500288963317871, gen p mean: -0.7310912609100342, mean p set: 0.4505091905593872
loss_pred:0.02510380558669567, decouple_loss:0.010836942121386528
loss_pred:0.024225356057286263, decouple_loss:0.01028508972376585
loss_pred:0.026410186663269997, decouple_loss:0.010621663182973862
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45255064964294434, gen p mean: -0.7115482091903687, mean p set: 0.4530309736728668
The modified gen p mean: 0.4524706304073334, gen p mean: -0.7162570357322693, mean p set: 0.45295095443725586
The modified gen p mean: 0.45258569717407227, gen p mean: -0.7146013975143433, mean p set: 0.45306602120399475
loss_pred:0.025533970445394516, decouple_loss:0.010879709385335445
loss_pred:0.024782218039035797, decouple_loss:0.01078400295227766
loss_pred:0.025571871548891068, decouple_loss:0.01056906022131443
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45206841826438904, gen p mean: -0.7219306826591492, mean p set: 0.45254871249198914
The modified gen p mean: 0.4496479630470276, gen p mean: -0.7082840800285339, mean p set: 0.4501282274723053
The modified gen p mean: 0.4532754719257355, gen p mean: -0.7207881808280945, mean p set: 0.45375576615333557
loss_pred:0.026321712881326675, decouple_loss:0.010531280189752579
loss_pred:0.026598092168569565, decouple_loss:0.010592350736260414
loss_pred:0.025036532431840897, decouple_loss:0.01062165480107069
2023-05-06 20:31:56 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7287423014640808, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.715978741645813, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7210139036178589, mean p set: 0.4500633478164673
loss_pred:0.02817363664507866, decouple_loss:0.012279186397790909
loss_pred:0.02664056606590748, decouple_loss:0.011699841357767582
loss_pred:0.027054576203227043, decouple_loss:0.011543892323970795
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027881642803549767, avg_mse: 0.033364295959472656
current test mse: 0.033364
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975897669792175, gen p mean: -0.7247254252433777, mean p set: 0.45023927092552185
loss_pred:0.026247886940836906, decouple_loss:0.010555570013821125
The modified gen p mean: 0.4495428800582886, gen p mean: -0.7159249782562256, mean p set: 0.4500231444835663
loss_pred:0.026693033054471016, decouple_loss:0.01038806326687336
The modified gen p mean: 0.4525909721851349, gen p mean: -0.71987384557724, mean p set: 0.4530712962150574
loss_pred:0.02466149441897869, decouple_loss:0.010403606109321117
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520549774169922, gen p mean: -0.7293347716331482, mean p set: 0.4525352716445923
The modified gen p mean: 0.45268040895462036, gen p mean: -0.7338454723358154, mean p set: 0.45316070318222046
The modified gen p mean: 0.4519859254360199, gen p mean: -0.7355396151542664, mean p set: 0.45246621966362
loss_pred:0.026598656550049782, decouple_loss:0.010305570438504219
loss_pred:0.02495233342051506, decouple_loss:0.010716467164456844
loss_pred:0.024748211726546288, decouple_loss:0.010811103507876396
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45209187269210815, gen p mean: -0.7223882079124451, mean p set: 0.45257216691970825
The modified gen p mean: 0.45114395022392273, gen p mean: -0.735009491443634, mean p set: 0.4516242742538452
The modified gen p mean: 0.45100846886634827, gen p mean: -0.7327719330787659, mean p set: 0.45148876309394836
loss_pred:0.025473186746239662, decouple_loss:0.010079261846840382loss_pred:0.025218145921826363, decouple_loss:0.009996920824050903
loss_pred:0.025782568380236626, decouple_loss:0.009838616475462914
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539457857608795, gen p mean: -0.7346214056015015, mean p set: 0.4544260501861572
The modified gen p mean: 0.44949817657470703, gen p mean: -0.7347062230110168, mean p set: 0.44997847080230713
The modified gen p mean: 0.44926100969314575, gen p mean: -0.7335348725318909, mean p set: 0.44974127411842346
loss_pred:0.02589423954486847, decouple_loss:0.010233876295387745
loss_pred:0.025915388017892838, decouple_loss:0.010334384627640247
loss_pred:0.025572922080755234, decouple_loss:0.010546010918915272
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45280057191848755, gen p mean: -0.7291480898857117, mean p set: 0.45328083634376526
The modified gen p mean: 0.45269447565078735, gen p mean: -0.7274581789970398, mean p set: 0.45317476987838745
The modified gen p mean: 0.45326367020606995, gen p mean: -0.7299500107765198, mean p set: 0.45374393463134766
loss_pred:0.025212520733475685, decouple_loss:0.01023921649903059
loss_pred:0.025031255558133125, decouple_loss:0.010437306016683578
loss_pred:0.025049731135368347, decouple_loss:0.010249737650156021
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45204970240592957, gen p mean: -0.7217187881469727, mean p set: 0.45252999663352966
The modified gen p mean: 0.4509032070636749, gen p mean: -0.7364241480827332, mean p set: 0.4513835310935974
The modified gen p mean: 0.4535921514034271, gen p mean: -0.7254365682601929, mean p set: 0.4540724456310272
loss_pred:0.02519829198718071, decouple_loss:0.010368768125772476
loss_pred:0.025543684139847755, decouple_loss:0.010406559333205223
loss_pred:0.025503115728497505, decouple_loss:0.009798048064112663
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44911253452301025, gen p mean: -0.7325642108917236, mean p set: 0.44959282875061035
The modified gen p mean: 0.4512356221675873, gen p mean: -0.7267656326293945, mean p set: 0.4517159163951874
The modified gen p mean: 0.451753169298172, gen p mean: -0.7260996699333191, mean p set: 0.4522334337234497
loss_pred:0.025782380253076553, decouple_loss:0.01036046165972948
loss_pred:0.026618989184498787, decouple_loss:0.010290862061083317
loss_pred:0.02559060789644718, decouple_loss:0.010021542198956013
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44988805055618286, gen p mean: -0.7404999732971191, mean p set: 0.45036831498146057
The modified gen p mean: 0.4493340849876404, gen p mean: -0.7343250513076782, mean p set: 0.4498143792152405
The modified gen p mean: 0.4507772922515869, gen p mean: -0.7407935857772827, mean p set: 0.4512575566768646
loss_pred:0.028108272701501846, decouple_loss:0.011882240884006023
loss_pred:0.02770378254354, decouple_loss:0.012045707553625107
loss_pred:0.027287332341074944, decouple_loss:0.011540696956217289
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44966641068458557, gen p mean: -0.7514312863349915, mean p set: 0.45014673471450806
The modified gen p mean: 0.4495854079723358, gen p mean: -0.7397472262382507, mean p set: 0.45006564259529114
The modified gen p mean: 0.4505954086780548, gen p mean: -0.7504190802574158, mean p set: 0.4510757029056549
loss_pred:0.026978911831974983, decouple_loss:0.01168823055922985
loss_pred:0.027537034824490547, decouple_loss:0.011499934829771519
loss_pred:0.028403034433722496, decouple_loss:0.011747630313038826
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450135201215744, gen p mean: -0.7515106201171875, mean p set: 0.4506154954433441
The modified gen p mean: 0.4489690959453583, gen p mean: -0.7424432039260864, mean p set: 0.44944941997528076
The modified gen p mean: 0.4506218135356903, gen p mean: -0.7498506903648376, mean p set: 0.451102077960968
loss_pred:0.02735469490289688, decouple_loss:0.011287027969956398
loss_pred:0.027206163853406906, decouple_loss:0.010990810580551624
loss_pred:0.026512326672673225, decouple_loss:0.011319058015942574
2023-05-06 20:36:29 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7416420578956604, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7272986173629761, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7331236600875854, mean p set: 0.4500633478164673
loss_pred:0.027659529820084572, decouple_loss:0.011203434318304062
loss_pred:0.02636699378490448, decouple_loss:0.011025715619325638
loss_pred:0.026780275627970695, decouple_loss:0.010903988964855671
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027487820014357567, avg_mse: 0.03276796266436577
current test mse: 0.032768
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502818286418915, gen p mean: -0.7302928566932678, mean p set: 0.4507621228694916
The modified gen p mean: 0.4502379894256592, gen p mean: -0.7357092499732971, mean p set: 0.4507182538509369
loss_pred:0.02828834392130375, decouple_loss:0.011258832179009914
loss_pred:0.027490245178341866, decouple_loss:0.011181952431797981
The modified gen p mean: 0.4492562413215637, gen p mean: -0.7277394533157349, mean p set: 0.44973650574684143
loss_pred:0.027397148311138153, decouple_loss:0.010868731886148453
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487124979496002, gen p mean: -0.7432715892791748, mean p set: 0.4491928219795227
The modified gen p mean: 0.4494032561779022, gen p mean: -0.7426307797431946, mean p set: 0.44988352060317993
The modified gen p mean: 0.4492187201976776, gen p mean: -0.7339152097702026, mean p set: 0.4496990144252777
loss_pred:0.02666211873292923, decouple_loss:0.01100317295640707
loss_pred:0.026373406872153282, decouple_loss:0.011029300279915333
loss_pred:0.028353147208690643, decouple_loss:0.010943946428596973
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508281350135803, gen p mean: -0.7417170405387878, mean p set: 0.4513084292411804
The modified gen p mean: 0.449324369430542, gen p mean: -0.7514104247093201, mean p set: 0.4498046338558197
loss_pred:0.02767959050834179, decouple_loss:0.01089476142078638
loss_pred:0.02761085517704487, decouple_loss:0.011524219065904617
The modified gen p mean: 0.4501695930957794, gen p mean: -0.7442229986190796, mean p set: 0.4506498873233795
loss_pred:0.027713226154446602, decouple_loss:0.011062880977988243
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947320222854614, gen p mean: -0.7325290441513062, mean p set: 0.44995349645614624
The modified gen p mean: 0.4504680335521698, gen p mean: -0.7400009036064148, mean p set: 0.4509483277797699
The modified gen p mean: 0.45014554262161255, gen p mean: -0.7379943132400513, mean p set: 0.45062586665153503
loss_pred:0.028722023591399193, decouple_loss:0.011115128174424171loss_pred:0.027131212875247, decouple_loss:0.011218804866075516
loss_pred:0.02686947211623192, decouple_loss:0.011011501774191856
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44940632581710815, gen p mean: -0.7386515736579895, mean p set: 0.44988662004470825
The modified gen p mean: 0.450380802154541, gen p mean: -0.7364882230758667, mean p set: 0.4508611261844635
The modified gen p mean: 0.4497264325618744, gen p mean: -0.7400924563407898, mean p set: 0.4502067267894745
loss_pred:0.027819553390145302, decouple_loss:0.010425565764307976loss_pred:0.026364892721176147, decouple_loss:0.010765619575977325
loss_pred:0.02677660435438156, decouple_loss:0.010748827829957008
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496549367904663, gen p mean: -0.7327823042869568, mean p set: 0.450135201215744
The modified gen p mean: 0.4498622715473175, gen p mean: -0.7386861443519592, mean p set: 0.4503425657749176
The modified gen p mean: 0.4481290280818939, gen p mean: -0.7390275001525879, mean p set: 0.448609322309494
loss_pred:0.027113353833556175, decouple_loss:0.010321059264242649
loss_pred:0.02669680304825306, decouple_loss:0.010329844430088997
loss_pred:0.0274941548705101, decouple_loss:0.0106549933552742
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503428041934967, gen p mean: -0.7362126708030701, mean p set: 0.4508230984210968
The modified gen p mean: 0.4507172703742981, gen p mean: -0.7384222745895386, mean p set: 0.4511975646018982
The modified gen p mean: 0.4487113654613495, gen p mean: -0.7361598610877991, mean p set: 0.4491916298866272
loss_pred:0.026768898591399193, decouple_loss:0.01061007659882307loss_pred:0.0271802619099617, decouple_loss:0.010361547581851482
loss_pred:0.026749683544039726, decouple_loss:0.010395819321274757
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496612548828125, gen p mean: -0.7383973002433777, mean p set: 0.4501415491104126
The modified gen p mean: 0.4482152760028839, gen p mean: -0.7300346493721008, mean p set: 0.4486955404281616
The modified gen p mean: 0.4491356611251831, gen p mean: -0.7184197306632996, mean p set: 0.4496159553527832
loss_pred:0.027094056829810143, decouple_loss:0.0106696467846632
loss_pred:0.02743063122034073, decouple_loss:0.010053385980427265
loss_pred:0.027317941188812256, decouple_loss:0.010442450642585754
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449248343706131, gen p mean: -0.7248237729072571, mean p set: 0.44972866773605347
The modified gen p mean: 0.449557900428772, gen p mean: -0.7299179434776306, mean p set: 0.4500381648540497
The modified gen p mean: 0.4493539035320282, gen p mean: -0.729661226272583, mean p set: 0.4498342275619507
loss_pred:0.026581542566418648, decouple_loss:0.010090749710798264loss_pred:0.027149677276611328, decouple_loss:0.010461166501045227
loss_pred:0.02695736661553383, decouple_loss:0.010210689157247543
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487245976924896, gen p mean: -0.7314609289169312, mean p set: 0.4492048919200897
The modified gen p mean: 0.45025718212127686, gen p mean: -0.7464138269424438, mean p set: 0.45073747634887695
The modified gen p mean: 0.4491085708141327, gen p mean: -0.73227459192276, mean p set: 0.4495888352394104
loss_pred:0.02620425820350647, decouple_loss:0.01015355996787548
loss_pred:0.027709409594535828, decouple_loss:0.010522217489778996
loss_pred:0.026922989636659622, decouple_loss:0.010115053504705429
2023-05-06 20:40:06 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7425258755683899, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.729972243309021, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7353768348693848, mean p set: 0.4500633478164673
loss_pred:0.027502695098519325, decouple_loss:0.010353594087064266
loss_pred:0.026099257171154022, decouple_loss:0.010372430086135864
loss_pred:0.026378650218248367, decouple_loss:0.010295138694345951
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027177220210433006, avg_mse: 0.03226420283317566
current test mse: 0.032264
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494397044181824, gen p mean: -0.7376067042350769, mean p set: 0.4499199688434601
The modified gen p mean: 0.45019665360450745, gen p mean: -0.7292084097862244, mean p set: 0.45067691802978516
loss_pred:0.026707511395215988, decouple_loss:0.009649161249399185
loss_pred:0.027603743597865105, decouple_loss:0.010406672023236752
The modified gen p mean: 0.44990208745002747, gen p mean: -0.7339693903923035, mean p set: 0.45038241147994995
loss_pred:0.027138859033584595, decouple_loss:0.010004431940615177
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493504762649536, gen p mean: -0.7303546071052551, mean p set: 0.4498307704925537
The modified gen p mean: 0.4486853778362274, gen p mean: -0.7427355647087097, mean p set: 0.4491656422615051
The modified gen p mean: 0.4497753381729126, gen p mean: -0.7406789660453796, mean p set: 0.4502556622028351
loss_pred:0.02733176201581955, decouple_loss:0.009889245964586735
loss_pred:0.027186259627342224, decouple_loss:0.009524327702820301
loss_pred:0.02755817212164402, decouple_loss:0.009989583864808083
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499345123767853, gen p mean: -0.7417004704475403, mean p set: 0.4504148066043854
The modified gen p mean: 0.4512348771095276, gen p mean: -0.7467882633209229, mean p set: 0.4517151713371277
The modified gen p mean: 0.4501035213470459, gen p mean: -0.7504006028175354, mean p set: 0.450583815574646
loss_pred:0.02743801847100258, decouple_loss:0.009396295994520187
loss_pred:0.026880091056227684, decouple_loss:0.009921915829181671
loss_pred:0.027422713115811348, decouple_loss:0.009932953864336014
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45068731904029846, gen p mean: -0.7387513518333435, mean p set: 0.45116761326789856
The modified gen p mean: 0.4507904052734375, gen p mean: -0.7334932684898376, mean p set: 0.45127072930336
loss_pred:0.027858590707182884, decouple_loss:0.009759919717907906
loss_pred:0.02750002220273018, decouple_loss:0.00962047092616558
The modified gen p mean: 0.4505215585231781, gen p mean: -0.7350614070892334, mean p set: 0.4510018229484558
loss_pred:0.02857738547027111, decouple_loss:0.00994654931128025
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489012062549591, gen p mean: -0.7176390886306763, mean p set: 0.4493815302848816
The modified gen p mean: 0.44861218333244324, gen p mean: -0.7280016541481018, mean p set: 0.4490925073623657
The modified gen p mean: 0.4493504762649536, gen p mean: -0.7234378457069397, mean p set: 0.4498307406902313
loss_pred:0.027199100703001022, decouple_loss:0.009989295154809952
loss_pred:0.027546310797333717, decouple_loss:0.009709042496979237
loss_pred:0.025960125029087067, decouple_loss:0.009954601526260376
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45008423924446106, gen p mean: -0.7230929136276245, mean p set: 0.45056453347206116
The modified gen p mean: 0.44969967007637024, gen p mean: -0.734542727470398, mean p set: 0.45017993450164795
The modified gen p mean: 0.4501516819000244, gen p mean: -0.7279701828956604, mean p set: 0.4506319463253021
loss_pred:0.028108647093176842, decouple_loss:0.00962186511605978
loss_pred:0.02647084929049015, decouple_loss:0.00953975785523653
loss_pred:0.027222199365496635, decouple_loss:0.009612075053155422
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044735074043274, gen p mean: -0.7384988069534302, mean p set: 0.45092761516571045
The modified gen p mean: 0.4498020112514496, gen p mean: -0.7394479513168335, mean p set: 0.4502823054790497
The modified gen p mean: 0.44904807209968567, gen p mean: -0.7350249886512756, mean p set: 0.44952836632728577
loss_pred:0.02692030370235443, decouple_loss:0.009731280617415905loss_pred:0.026573719456791878, decouple_loss:0.009472169913351536
loss_pred:0.02638149820268154, decouple_loss:0.009462220594286919
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
NaN value num: 0
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860783219337463, gen p mean: -0.7451932430267334, mean p set: 0.44908812642097473
The modified gen p mean: 0.45199519395828247, gen p mean: -0.737875759601593, mean p set: 0.45247551798820496
The modified gen p mean: 0.4485863745212555, gen p mean: -0.7434906959533691, mean p set: 0.4490666687488556
loss_pred:0.02548838220536709, decouple_loss:0.011360086500644684
loss_pred:0.025948654860258102, decouple_loss:0.010913645848631859
loss_pred:0.02569148689508438, decouple_loss:0.011046111583709717
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45141148567199707, gen p mean: -0.7438493967056274, mean p set: 0.4518917500972748
The modified gen p mean: 0.44945916533470154, gen p mean: -0.7432823777198792, mean p set: 0.44993945956230164
The modified gen p mean: 0.4493011236190796, gen p mean: -0.7318863272666931, mean p set: 0.4497814178466797
loss_pred:0.025330139324069023, decouple_loss:0.011313581839203835
loss_pred:0.025443369522690773, decouple_loss:0.010288775898516178
loss_pred:0.02694620192050934, decouple_loss:0.01058053970336914
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982656836509705, gen p mean: -0.7315759062767029, mean p set: 0.45030689239501953
The modified gen p mean: 0.4503028988838196, gen p mean: -0.7300441861152649, mean p set: 0.4507831633090973
The modified gen p mean: 0.4510818123817444, gen p mean: -0.7408165335655212, mean p set: 0.45156213641166687
loss_pred:0.026034722104668617, decouple_loss:0.010093534365296364
loss_pred:0.026533547788858414, decouple_loss:0.010435040108859539
loss_pred:0.02683151327073574, decouple_loss:0.011153874918818474
2023-05-06 20:44:28 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7315133213996887, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7439312934875488, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7364029288291931, mean p set: 0.4500633478164673
loss_pred:0.026218192651867867, decouple_loss:0.010743888095021248
loss_pred:0.02746030129492283, decouple_loss:0.010874914936721325
loss_pred:0.02640349045395851, decouple_loss:0.010633571073412895
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02723153494298458, avg_mse: 0.03238433226943016
current test mse: 0.032384
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500269293785095, gen p mean: -0.733435332775116, mean p set: 0.4505072236061096
loss_pred:0.025547919794917107, decouple_loss:0.009903698228299618
The modified gen p mean: 0.44863754510879517, gen p mean: -0.7380064725875854, mean p set: 0.44911783933639526
The modified gen p mean: 0.4477842450141907, gen p mean: -0.7404415607452393, mean p set: 0.4482645094394684
loss_pred:0.026083486154675484, decouple_loss:0.010687809437513351
loss_pred:0.027500754222273827, decouple_loss:0.010741419158875942
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904351234436035, gen p mean: -0.7392511367797852, mean p set: 0.44952380657196045
The modified gen p mean: 0.4504455626010895, gen p mean: -0.7346066236495972, mean p set: 0.4509258568286896
loss_pred:0.026039782911539078, decouple_loss:0.010169289074838161
loss_pred:0.026318997144699097, decouple_loss:0.010765240527689457
The modified gen p mean: 0.4517676532268524, gen p mean: -0.7384982705116272, mean p set: 0.4522479474544525
loss_pred:0.025617780163884163, decouple_loss:0.010784106329083443
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104700326919556, gen p mean: -0.7236754298210144, mean p set: 0.45152729749679565
The modified gen p mean: 0.4500461518764496, gen p mean: -0.7370226979255676, mean p set: 0.4505264163017273
The modified gen p mean: 0.45092499256134033, gen p mean: -0.7338857054710388, mean p set: 0.45140528678894043
loss_pred:0.02561754174530506, decouple_loss:0.010298163630068302
loss_pred:0.02491942048072815, decouple_loss:0.010378161445260048
loss_pred:0.02499586157500744, decouple_loss:0.01047026738524437
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997966289520264, gen p mean: -0.740913450717926, mean p set: 0.45045995712280273
The modified gen p mean: 0.448527067899704, gen p mean: -0.7308905124664307, mean p set: 0.44900739192962646
The modified gen p mean: 0.4505285620689392, gen p mean: -0.7257083058357239, mean p set: 0.4510088264942169
loss_pred:0.025515398010611534, decouple_loss:0.010471893474459648
loss_pred:0.026710137724876404, decouple_loss:0.010147878900170326
loss_pred:0.02555355615913868, decouple_loss:0.010031397454440594
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45248982310295105, gen p mean: -0.7386401295661926, mean p set: 0.45297008752822876
The modified gen p mean: 0.44969338178634644, gen p mean: -0.7397194504737854, mean p set: 0.45017367601394653
The modified gen p mean: 0.44910693168640137, gen p mean: -0.7422481179237366, mean p set: 0.44958722591400146
loss_pred:0.025352688506245613, decouple_loss:0.010076676495373249
loss_pred:0.025730043649673462, decouple_loss:0.01049141213297844
loss_pred:0.02606739103794098, decouple_loss:0.010425449348986149
Iteration: 306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514411389827728, gen p mean: -0.7428537607192993, mean p set: 0.4519214332103729
The modified gen p mean: 0.4505431652069092, gen p mean: -0.7425992488861084, mean p set: 0.4510234594345093
The modified gen p mean: 0.4528353810310364, gen p mean: -0.7392765283584595, mean p set: 0.4533156752586365
loss_pred:0.024748794734477997, decouple_loss:0.010129287838935852
loss_pred:0.027069706469774246, decouple_loss:0.01022342313081026
loss_pred:0.026352806016802788, decouple_loss:0.01011779997497797
Iteration: 307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975754618644714, gen p mean: -0.7451339364051819, mean p set: 0.45023781061172485
The modified gen p mean: 0.44928374886512756, gen p mean: -0.7381955981254578, mean p set: 0.44976404309272766
The modified gen p mean: 0.4485812485218048, gen p mean: -0.7327829599380493, mean p set: 0.4490615427494049
loss_pred:0.02603279799222946, decouple_loss:0.010364988818764687
loss_pred:0.026101822033524513, decouple_loss:0.00971204973757267
loss_pred:0.027191344648599625, decouple_loss:0.010107936337590218
Iteration: 308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45216304063796997, gen p mean: -0.7343593835830688, mean p set: 0.45264333486557007
The modified gen p mean: 0.44978219270706177, gen p mean: -0.7395967245101929, mean p set: 0.45026248693466187
The modified gen p mean: 0.4501246511936188, gen p mean: -0.7320367097854614, mean p set: 0.45060494542121887
loss_pred:0.02531932108104229, decouple_loss:0.00968274287879467
loss_pred:0.026331055909395218, decouple_loss:0.009789600968360901
loss_pred:0.026768717914819717, decouple_loss:0.009720852598547935
Iteration: 309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513234794139862, gen p mean: -0.7342936396598816, mean p set: 0.4518038034439087
The modified gen p mean: 0.45017823576927185, gen p mean: -0.7421708106994629, mean p set: 0.45065850019454956
The modified gen p mean: 0.4504621624946594, gen p mean: -0.74253249168396, mean p set: 0.4509424567222595
loss_pred:0.02468441240489483, decouple_loss:0.00990897137671709
loss_pred:0.02517164684832096, decouple_loss:0.0100779440253973
loss_pred:0.025517042726278305, decouple_loss:0.010121872648596764
Iteration: 310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45227620005607605, gen p mean: -0.7345193028450012, mean p set: 0.45275649428367615
The modified gen p mean: 0.44890162348747253, gen p mean: -0.737648069858551, mean p set: 0.449381947517395
The modified gen p mean: 0.4490277171134949, gen p mean: -0.7321856617927551, mean p set: 0.4495079815387726
loss_pred:0.025485800579190254, decouple_loss:0.009752352721989155
loss_pred:0.026247670873999596, decouple_loss:0.01000705175101757
loss_pred:0.02595623768866062, decouple_loss:0.010141869075596333
2023-05-06 20:48:06 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7456760406494141, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7327143549919128, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.737656831741333, mean p set: 0.4500633478164673
loss_pred:0.027646400034427643, decouple_loss:0.010952693410217762
loss_pred:0.0263665858656168, decouple_loss:0.01085236482322216
loss_pred:0.026531429961323738, decouple_loss:0.010900196619331837
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027393227443099022, avg_mse: 0.032683033496141434
current test mse: 0.032683
Iteration: 311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451458603143692, gen p mean: -0.7412911653518677, mean p set: 0.45193883776664734
The modified gen p mean: 0.4500935971736908, gen p mean: -0.7492003440856934, mean p set: 0.4505738615989685
loss_pred:0.0253345537930727, decouple_loss:0.010125388391315937
loss_pred:0.025266259908676147, decouple_loss:0.009996311739087105
The modified gen p mean: 0.44915926456451416, gen p mean: -0.7337229251861572, mean p set: 0.44963955879211426
loss_pred:0.026353776454925537, decouple_loss:0.01005822978913784
Iteration: 312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513724744319916, gen p mean: -0.737592875957489, mean p set: 0.4518527686595917
The modified gen p mean: 0.4493713080883026, gen p mean: -0.7420586943626404, mean p set: 0.4498515725135803
loss_pred:0.025179484859108925, decouple_loss:0.009845993481576443
loss_pred:0.025118496268987656, decouple_loss:0.010135193355381489
The modified gen p mean: 0.4502885341644287, gen p mean: -0.7417263984680176, mean p set: 0.4507688283920288
loss_pred:0.026284480467438698, decouple_loss:0.009855381213128567
Iteration: 313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514055550098419, gen p mean: -0.7446354031562805, mean p set: 0.451885849237442
The modified gen p mean: 0.44761791825294495, gen p mean: -0.7452595233917236, mean p set: 0.44809824228286743
The modified gen p mean: 0.4500126540660858, gen p mean: -0.7461000680923462, mean p set: 0.4504929184913635
loss_pred:0.0251665897667408, decouple_loss:0.00971037708222866loss_pred:0.025935115292668343, decouple_loss:0.00996706448495388
loss_pred:0.02581433393061161, decouple_loss:0.009794851765036583
Iteration: 314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893309473991394, gen p mean: -0.7365037202835083, mean p set: 0.44941338896751404
The modified gen p mean: 0.4478793740272522, gen p mean: -0.7311940789222717, mean p set: 0.4483596682548523
The modified gen p mean: 0.4494997560977936, gen p mean: -0.7340438365936279, mean p set: 0.4499800503253937
loss_pred:0.025258829817175865, decouple_loss:0.010036290623247623
loss_pred:0.026975130662322044, decouple_loss:0.009617013856768608
loss_pred:0.026524290442466736, decouple_loss:0.009754655882716179
Iteration: 315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900238513946533, gen p mean: -0.7389887571334839, mean p set: 0.4494827091693878
The modified gen p mean: 0.4497230052947998, gen p mean: -0.734329104423523, mean p set: 0.4502033293247223
loss_pred:0.026227552443742752, decouple_loss:0.009866413660347462
loss_pred:0.025402884930372238, decouple_loss:0.009850136004388332
The modified gen p mean: 0.45181918144226074, gen p mean: -0.7421523332595825, mean p set: 0.4522995054721832
loss_pred:0.02514510601758957, decouple_loss:0.010050675831735134
Iteration: 316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497659504413605, gen p mean: -0.741288423538208, mean p set: 0.45024624466896057
The modified gen p mean: 0.45140236616134644, gen p mean: -0.7469215989112854, mean p set: 0.4518826901912689
The modified gen p mean: 0.4490102231502533, gen p mean: -0.7359969615936279, mean p set: 0.4494905471801758
loss_pred:0.025416502729058266, decouple_loss:0.009608156979084015
loss_pred:0.02599441073834896, decouple_loss:0.009596792981028557
loss_pred:0.025774337351322174, decouple_loss:0.009615026414394379
Iteration: 317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501556158065796, gen p mean: -0.7499732971191406, mean p set: 0.4506358802318573
The modified gen p mean: 0.4499203860759735, gen p mean: -0.7395694851875305, mean p set: 0.4504006803035736
The modified gen p mean: 0.4521656334400177, gen p mean: -0.7438781261444092, mean p set: 0.4526459276676178
loss_pred:0.025906188413500786, decouple_loss:0.009178170002996922loss_pred:0.02612880803644657, decouple_loss:0.009218616411089897
loss_pred:0.02524719201028347, decouple_loss:0.009774822741746902
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
NaN value num: 0
Iteration: 318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44905751943588257, gen p mean: -0.7408528923988342, mean p set: 0.4495377540588379
The modified gen p mean: 0.4515826106071472, gen p mean: -0.7448318004608154, mean p set: 0.4520629048347473
The modified gen p mean: 0.4496529698371887, gen p mean: -0.7501657009124756, mean p set: 0.4501332640647888
loss_pred:0.02591884322464466, decouple_loss:0.009561650454998016
loss_pred:0.02666449546813965, decouple_loss:0.009633759036660194
loss_pred:0.02677578665316105, decouple_loss:0.009493105113506317
Iteration: 319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502444267272949, gen p mean: -0.7370296716690063, mean p set: 0.450724720954895
The modified gen p mean: 0.4490417540073395, gen p mean: -0.7372117042541504, mean p set: 0.4495220482349396
The modified gen p mean: 0.44961437582969666, gen p mean: -0.7450054883956909, mean p set: 0.45009464025497437
loss_pred:0.026699261739850044, decouple_loss:0.009789200499653816
loss_pred:0.025516722351312637, decouple_loss:0.010369332507252693
loss_pred:0.02629055082798004, decouple_loss:0.00964406318962574
Iteration: 320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452358216047287, gen p mean: -0.7279918789863586, mean p set: 0.4528384804725647
The modified gen p mean: 0.44947129487991333, gen p mean: -0.7321971654891968, mean p set: 0.4499515891075134
The modified gen p mean: 0.45109039545059204, gen p mean: -0.7351731657981873, mean p set: 0.45157068967819214
loss_pred:0.025311635807156563, decouple_loss:0.010263297706842422
loss_pred:0.026423389092087746, decouple_loss:0.009587815031409264
loss_pred:0.02587597444653511, decouple_loss:0.010032504796981812
2023-05-06 20:52:23 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7491568326950073, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7362818121910095, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7411961555480957, mean p set: 0.4500633478164673
loss_pred:0.027586784213781357, decouple_loss:0.010862456634640694
loss_pred:0.02620527520775795, decouple_loss:0.010566947981715202
loss_pred:0.02659750171005726, decouple_loss:0.010670394636690617
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02733151614665985, avg_mse: 0.032692596316337585
current test mse: 0.032693
Iteration: 321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795286655426025, gen p mean: -0.7461491823196411, mean p set: 0.44843316078186035
The modified gen p mean: 0.44808679819107056, gen p mean: -0.7455833554267883, mean p set: 0.44856709241867065
loss_pred:0.026755334809422493, decouple_loss:0.009301507845520973
loss_pred:0.026927556842565536, decouple_loss:0.00989809725433588
The modified gen p mean: 0.45214828848838806, gen p mean: -0.736084520816803, mean p set: 0.45262858271598816
loss_pred:0.026374924927949905, decouple_loss:0.010029025375843048
Iteration: 322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45263221859931946, gen p mean: -0.7525442838668823, mean p set: 0.45311251282691956
The modified gen p mean: 0.4529041349887848, gen p mean: -0.7441529631614685, mean p set: 0.4533843994140625
The modified gen p mean: 0.45065250992774963, gen p mean: -0.7537125945091248, mean p set: 0.45113280415534973
loss_pred:0.02483498491346836, decouple_loss:0.010441632941365242
loss_pred:0.02697213552892208, decouple_loss:0.009799391962587833
loss_pred:0.024854732677340508, decouple_loss:0.009899483993649483
Iteration: 323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45277470350265503, gen p mean: -0.741680383682251, mean p set: 0.4532550275325775
The modified gen p mean: 0.4521077275276184, gen p mean: -0.7478818297386169, mean p set: 0.4525880217552185
loss_pred:0.025332506746053696, decouple_loss:0.010324078612029552
loss_pred:0.02540259249508381, decouple_loss:0.00949882436543703
The modified gen p mean: 0.4525482952594757, gen p mean: -0.743133544921875, mean p set: 0.4530285596847534
loss_pred:0.025875015184283257, decouple_loss:0.010111525654792786
Iteration: 324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128703117370605, gen p mean: -0.7313246130943298, mean p set: 0.45176732540130615
The modified gen p mean: 0.4534391462802887, gen p mean: -0.724664032459259, mean p set: 0.4539194405078888
loss_pred:0.026539547368884087, decouple_loss:0.01004453469067812
loss_pred:0.025268271565437317, decouple_loss:0.009814077988266945
The modified gen p mean: 0.4522474408149719, gen p mean: -0.7276092171669006, mean p set: 0.452727735042572
loss_pred:0.024990106001496315, decouple_loss:0.009572050534188747
Iteration: 325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451628714799881, gen p mean: -0.72549968957901, mean p set: 0.45210903882980347
The modified gen p mean: 0.4501210153102875, gen p mean: -0.7273633480072021, mean p set: 0.45060133934020996
loss_pred:0.02596926875412464, decouple_loss:0.009549974463880062
loss_pred:0.02483842521905899, decouple_loss:0.009747810661792755
The modified gen p mean: 0.449347585439682, gen p mean: -0.7280850410461426, mean p set: 0.4498278796672821
loss_pred:0.026875119656324387, decouple_loss:0.009550939314067364
Iteration: 326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45149967074394226, gen p mean: -0.7290112972259521, mean p set: 0.45197993516921997
The modified gen p mean: 0.4496348202228546, gen p mean: -0.7378638982772827, mean p set: 0.4501151144504547
The modified gen p mean: 0.44904935359954834, gen p mean: -0.7299515604972839, mean p set: 0.44952961802482605
loss_pred:0.026166807860136032, decouple_loss:0.009341087192296982
loss_pred:0.026546349748969078, decouple_loss:0.00940961204469204
loss_pred:0.02666829526424408, decouple_loss:0.009487411938607693
Iteration: 327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538688063621521, gen p mean: -0.7364157438278198, mean p set: 0.4543490707874298
The modified gen p mean: 0.44893988966941833, gen p mean: -0.7372351884841919, mean p set: 0.44942015409469604
The modified gen p mean: 0.4484826624393463, gen p mean: -0.7434636950492859, mean p set: 0.4489629566669464
loss_pred:0.02502276375889778, decouple_loss:0.009825636632740498
loss_pred:0.02612648904323578, decouple_loss:0.009599193930625916
loss_pred:0.026569319888949394, decouple_loss:0.00992752518504858
Iteration: 328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513629674911499, gen p mean: -0.7338199615478516, mean p set: 0.4518432915210724
The modified gen p mean: 0.44970130920410156, gen p mean: -0.729671835899353, mean p set: 0.45018160343170166
The modified gen p mean: 0.44802626967430115, gen p mean: -0.7356056571006775, mean p set: 0.44850653409957886
loss_pred:0.02544480934739113, decouple_loss:0.009836137294769287
loss_pred:0.026637254282832146, decouple_loss:0.009493875317275524
loss_pred:0.02637113444507122, decouple_loss:0.009400363080203533
Iteration: 329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45138779282569885, gen p mean: -0.7428191900253296, mean p set: 0.45186808705329895
The modified gen p mean: 0.45147180557250977, gen p mean: -0.7314577698707581, mean p set: 0.45195209980010986
The modified gen p mean: 0.4536969065666199, gen p mean: -0.7316271066665649, mean p set: 0.45417720079421997
loss_pred:0.02593318745493889, decouple_loss:0.009721040725708008
loss_pred:0.024643126875162125, decouple_loss:0.009923571720719337
loss_pred:0.02714882232248783, decouple_loss:0.009743193164467812
Iteration: 330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44916781783103943, gen p mean: -0.7412022352218628, mean p set: 0.44964808225631714
The modified gen p mean: 0.4511868953704834, gen p mean: -0.7375049591064453, mean p set: 0.4516671597957611
The modified gen p mean: 0.4479731619358063, gen p mean: -0.7436342835426331, mean p set: 0.448453426361084
loss_pred:0.026830194517970085, decouple_loss:0.009621278382837772
loss_pred:0.026672309264540672, decouple_loss:0.009851953946053982
loss_pred:0.026720460504293442, decouple_loss:0.009427607990801334
2023-05-06 20:56:00 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7475138306617737, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7344529628753662, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7395761013031006, mean p set: 0.4500633478164673
loss_pred:0.027591373771429062, decouple_loss:0.010763013735413551
loss_pred:0.02617712691426277, decouple_loss:0.010365977883338928
loss_pred:0.02659470960497856, decouple_loss:0.010539839044213295
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027315549552440643, avg_mse: 0.032671067863702774
current test mse: 0.032671
Iteration: 331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45189160108566284, gen p mean: -0.732967734336853, mean p set: 0.45237189531326294
The modified gen p mean: 0.45214441418647766, gen p mean: -0.7406920194625854, mean p set: 0.45262470841407776
loss_pred:0.02552301436662674, decouple_loss:0.009835241362452507
loss_pred:0.02556263655424118, decouple_loss:0.009204615838825703
The modified gen p mean: 0.45334023237228394, gen p mean: -0.7382774353027344, mean p set: 0.4538205564022064
loss_pred:0.027066513895988464, decouple_loss:0.009604758583009243
Iteration: 332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536886215209961, gen p mean: -0.727241575717926, mean p set: 0.4541688859462738
The modified gen p mean: 0.45051145553588867, gen p mean: -0.729516327381134, mean p set: 0.4509917199611664
The modified gen p mean: 0.4518738090991974, gen p mean: -0.7334131002426147, mean p set: 0.4523541033267975
loss_pred:0.025431102141737938, decouple_loss:0.00981456320732832loss_pred:0.025301124900579453, decouple_loss:0.009457138366997242
loss_pred:0.025588510558009148, decouple_loss:0.009204168803989887
Iteration: 333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45039981603622437, gen p mean: -0.7321217060089111, mean p set: 0.45088011026382446
The modified gen p mean: 0.45027536153793335, gen p mean: -0.7329339981079102, mean p set: 0.45075568556785583
The modified gen p mean: 0.45353665947914124, gen p mean: -0.7346501350402832, mean p set: 0.4540169835090637
loss_pred:0.02524592913687229, decouple_loss:0.009348920546472073
loss_pred:0.025570707395672798, decouple_loss:0.009349914267659187
loss_pred:0.0251899603754282, decouple_loss:0.00958876684308052
Iteration: 334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527862071990967, gen p mean: -0.7335268259048462, mean p set: 0.4532664716243744
The modified gen p mean: 0.4527755677700043, gen p mean: -0.7281509041786194, mean p set: 0.45325586199760437
The modified gen p mean: 0.4490250051021576, gen p mean: -0.7391427755355835, mean p set: 0.4495052993297577
loss_pred:0.02538062259554863, decouple_loss:0.009474324993789196loss_pred:0.02567637339234352, decouple_loss:0.009740754030644894
loss_pred:0.026327908039093018, decouple_loss:0.009295700117945671
Iteration: 335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503602981567383, gen p mean: -0.732736349105835, mean p set: 0.4508405923843384
The modified gen p mean: 0.44776785373687744, gen p mean: -0.7309949398040771, mean p set: 0.4482481777667999
The modified gen p mean: 0.4502812325954437, gen p mean: -0.7274608612060547, mean p set: 0.4507615268230438
loss_pred:0.02504718489944935, decouple_loss:0.009473178535699844
loss_pred:0.026634501293301582, decouple_loss:0.009492923505604267
loss_pred:0.026516051962971687, decouple_loss:0.009552774019539356
Iteration: 336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505225718021393, gen p mean: -0.7330935597419739, mean p set: 0.4510028660297394
The modified gen p mean: 0.4519825875759125, gen p mean: -0.7304656505584717, mean p set: 0.4524628818035126
The modified gen p mean: 0.4511649012565613, gen p mean: -0.7293995022773743, mean p set: 0.45164522528648376
loss_pred:0.024705689400434494, decouple_loss:0.008908123709261417
loss_pred:0.025595951825380325, decouple_loss:0.009270595386624336
loss_pred:0.0261396374553442, decouple_loss:0.009324449114501476
Iteration: 337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835197925567627, gen p mean: -0.7510161995887756, mean p set: 0.44883227348327637
The modified gen p mean: 0.45114830136299133, gen p mean: -0.7490506768226624, mean p set: 0.45162856578826904
The modified gen p mean: 0.4494574964046478, gen p mean: -0.7468807101249695, mean p set: 0.4499378204345703
loss_pred:0.02660803683102131, decouple_loss:0.009387844242155552
loss_pred:0.024379940703511238, decouple_loss:0.009575516916811466
loss_pred:0.02583150938153267, decouple_loss:0.009177817031741142
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
NaN value num: 0
Iteration: 338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509755074977875, gen p mean: -0.7446573972702026, mean p set: 0.4514558017253876
The modified gen p mean: 0.45084869861602783, gen p mean: -0.7455205321311951, mean p set: 0.45132896304130554
The modified gen p mean: 0.45225515961647034, gen p mean: -0.7567883729934692, mean p set: 0.45273545384407043
loss_pred:0.026977553963661194, decouple_loss:0.010263380594551563
loss_pred:0.026516204699873924, decouple_loss:0.010566724464297295
loss_pred:0.02664441242814064, decouple_loss:0.01017297524958849
Iteration: 339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507658779621124, gen p mean: -0.7528400421142578, mean p set: 0.45124614238739014
The modified gen p mean: 0.45077332854270935, gen p mean: -0.7509897947311401, mean p set: 0.45125362277030945
The modified gen p mean: 0.45134761929512024, gen p mean: -0.7509717345237732, mean p set: 0.45182791352272034
loss_pred:0.026704242452979088, decouple_loss:0.010447296313941479
loss_pred:0.02595704235136509, decouple_loss:0.009906974621117115
loss_pred:0.026760265231132507, decouple_loss:0.010126806795597076
Iteration: 340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45272067189216614, gen p mean: -0.7465283870697021, mean p set: 0.45320096611976624
The modified gen p mean: 0.45004647970199585, gen p mean: -0.7442352175712585, mean p set: 0.45052674412727356
The modified gen p mean: 0.45052701234817505, gen p mean: -0.7426592707633972, mean p set: 0.45100730657577515
loss_pred:0.026276148855686188, decouple_loss:0.010579891502857208loss_pred:0.02679317072033882, decouple_loss:0.010046490468084812
loss_pred:0.027113810181617737, decouple_loss:0.010344509966671467
2023-05-06 21:00:20 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7591692805290222, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7457247376441956, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7507071495056152, mean p set: 0.4500633478164673
loss_pred:0.027674086391925812, decouple_loss:0.010606472380459309
loss_pred:0.0262578334659338, decouple_loss:0.010608493350446224
loss_pred:0.026615984737873077, decouple_loss:0.01058194413781166
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027379250153899193, avg_mse: 0.03267485648393631
current test mse: 0.032675
Iteration: 341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521658420562744, gen p mean: -0.7498867511749268, mean p set: 0.4526461362838745
The modified gen p mean: 0.44923752546310425, gen p mean: -0.7440161108970642, mean p set: 0.44971778988838196
loss_pred:0.025219233706593513, decouple_loss:0.010395734570920467
loss_pred:0.02587754838168621, decouple_loss:0.01006369013339281
The modified gen p mean: 0.45221543312072754, gen p mean: -0.7519007325172424, mean p set: 0.45269572734832764
loss_pred:0.024864738807082176, decouple_loss:0.010318689048290253
Iteration: 342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45158591866493225, gen p mean: -0.7439724206924438, mean p set: 0.45206621289253235
The modified gen p mean: 0.4514923393726349, gen p mean: -0.7480800747871399, mean p set: 0.4519725739955902
The modified gen p mean: 0.4497973322868347, gen p mean: -0.7429459691047668, mean p set: 0.4502776563167572
loss_pred:0.026465626433491707, decouple_loss:0.009543835185468197
loss_pred:0.02680886723101139, decouple_loss:0.00960372295230627
loss_pred:0.02599560283124447, decouple_loss:0.009920290671288967
Iteration: 343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45173242688179016, gen p mean: -0.7447360754013062, mean p set: 0.45221275091171265
The modified gen p mean: 0.4512546956539154, gen p mean: -0.7503453493118286, mean p set: 0.4517350196838379
The modified gen p mean: 0.4496880769729614, gen p mean: -0.7426839470863342, mean p set: 0.4501683712005615
loss_pred:0.026435641571879387, decouple_loss:0.00989203155040741
loss_pred:0.025671854615211487, decouple_loss:0.00996437855064869
loss_pred:0.026996461674571037, decouple_loss:0.009689563885331154
Iteration: 344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532161355018616, gen p mean: -0.7424526214599609, mean p set: 0.4536963999271393
The modified gen p mean: 0.4512578845024109, gen p mean: -0.7483057379722595, mean p set: 0.451738178730011
The modified gen p mean: 0.4505396783351898, gen p mean: -0.7350220084190369, mean p set: 0.4510199725627899
loss_pred:0.02653994783759117, decouple_loss:0.010327189229428768
loss_pred:0.026309167966246605, decouple_loss:0.009767899289727211
loss_pred:0.026969052851200104, decouple_loss:0.009523533284664154
Iteration: 345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516095221042633, gen p mean: -0.7399353384971619, mean p set: 0.452089786529541
The modified gen p mean: 0.4487006664276123, gen p mean: -0.7277838587760925, mean p set: 0.44918093085289
loss_pred:0.02480214275419712, decouple_loss:0.00947065744549036
loss_pred:0.026363860815763474, decouple_loss:0.010838625021278858
The modified gen p mean: 0.44925418496131897, gen p mean: -0.7321347594261169, mean p set: 0.4497344493865967
loss_pred:0.025876415893435478, decouple_loss:0.009879824705421925
Iteration: 346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854339957237244, gen p mean: -0.7254858613014221, mean p set: 0.44902369379997253
The modified gen p mean: 0.44855546951293945, gen p mean: -0.7240801453590393, mean p set: 0.4490357041358948
The modified gen p mean: 0.45270460844039917, gen p mean: -0.7316092252731323, mean p set: 0.45318490266799927
loss_pred:0.026546532288193703, decouple_loss:0.010175705887377262
loss_pred:0.025998441502451897, decouple_loss:0.010376348160207272
loss_pred:0.026831595227122307, decouple_loss:0.009969647973775864
Iteration: 347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44974735379219055, gen p mean: -0.7225936651229858, mean p set: 0.45022767782211304
The modified gen p mean: 0.45051953196525574, gen p mean: -0.7237316370010376, mean p set: 0.45099982619285583
loss_pred:0.027136875316500664, decouple_loss:0.009646675549447536
The modified gen p mean: 0.4514947235584259, gen p mean: -0.7341546416282654, mean p set: 0.451975017786026
loss_pred:0.026386676356196404, decouple_loss:0.00959861185401678
loss_pred:0.025829991325736046, decouple_loss:0.009330358356237411
Iteration: 348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513400197029114, gen p mean: -0.7268280386924744, mean p set: 0.4518203139305115
The modified gen p mean: 0.45129385590553284, gen p mean: -0.7355366945266724, mean p set: 0.45177412033081055
The modified gen p mean: 0.4531627595424652, gen p mean: -0.73699551820755, mean p set: 0.4536430835723877
loss_pred:0.026226164773106575, decouple_loss:0.009662847965955734
loss_pred:0.025238174945116043, decouple_loss:0.010361460037529469
loss_pred:0.027098529040813446, decouple_loss:0.010355993174016476
Iteration: 349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489477574825287, gen p mean: -0.7334269285202026, mean p set: 0.4494280517101288
The modified gen p mean: 0.4512452185153961, gen p mean: -0.7414264678955078, mean p set: 0.4517255127429962
The modified gen p mean: 0.45213818550109863, gen p mean: -0.7389527559280396, mean p set: 0.45261847972869873
loss_pred:0.025278568267822266, decouple_loss:0.009631127119064331
loss_pred:0.0255691260099411, decouple_loss:0.00969106238335371
loss_pred:0.026168406009674072, decouple_loss:0.009580050595104694
Iteration: 350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488845467567444, gen p mean: -0.7373751401901245, mean p set: 0.4493648409843445
The modified gen p mean: 0.4515613615512848, gen p mean: -0.7466276288032532, mean p set: 0.4520416855812073
The modified gen p mean: 0.4508567154407501, gen p mean: -0.7382965087890625, mean p set: 0.45133697986602783
loss_pred:0.02602127194404602, decouple_loss:0.009608627296984196
loss_pred:0.026216208934783936, decouple_loss:0.009812548756599426
loss_pred:0.026604780927300453, decouple_loss:0.009286291897296906
2023-05-06 21:03:57 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7513161301612854, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7384641766548157, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7431498169898987, mean p set: 0.4500633478164673
loss_pred:0.027630148455500603, decouple_loss:0.010625619441270828
loss_pred:0.026238663122057915, decouple_loss:0.010435821488499641
loss_pred:0.02655271254479885, decouple_loss:0.010312855243682861
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027330078184604645, avg_mse: 0.032685499638319016
current test mse: 0.032686
Iteration: 351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45266130566596985, gen p mean: -0.7452541589736938, mean p set: 0.45314162969589233
The modified gen p mean: 0.45043182373046875, gen p mean: -0.7407162189483643, mean p set: 0.45091211795806885
loss_pred:0.02630889043211937, decouple_loss:0.009669178165495396
loss_pred:0.026767611503601074, decouple_loss:0.009532424621284008
The modified gen p mean: 0.44911542534828186, gen p mean: -0.7371407151222229, mean p set: 0.44959568977355957
loss_pred:0.026052817702293396, decouple_loss:0.00908446591347456
Iteration: 352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45142248272895813, gen p mean: -0.7460083365440369, mean p set: 0.4519027769565582
The modified gen p mean: 0.45080551505088806, gen p mean: -0.7449601292610168, mean p set: 0.45128580927848816
The modified gen p mean: 0.4515460431575775, gen p mean: -0.7506036162376404, mean p set: 0.4520263373851776
loss_pred:0.024820467457175255, decouple_loss:0.009197400882840157
loss_pred:0.025942733511328697, decouple_loss:0.009161485359072685
loss_pred:0.025450021028518677, decouple_loss:0.009055174887180328
Iteration: 353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45371267199516296, gen p mean: -0.7512638568878174, mean p set: 0.4541929364204407
The modified gen p mean: 0.4496833384037018, gen p mean: -0.737707793712616, mean p set: 0.4501636028289795
The modified gen p mean: 0.45059874653816223, gen p mean: -0.7450926303863525, mean p set: 0.45107904076576233
loss_pred:0.02611870877444744, decouple_loss:0.009523254819214344
loss_pred:0.026468731462955475, decouple_loss:0.009902331046760082
loss_pred:0.025674214586615562, decouple_loss:0.00919280480593443
Iteration: 354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45130518078804016, gen p mean: -0.7478617429733276, mean p set: 0.45178547501564026
The modified gen p mean: 0.4499387741088867, gen p mean: -0.7372238039970398, mean p set: 0.4504190683364868
The modified gen p mean: 0.4497767388820648, gen p mean: -0.7402000427246094, mean p set: 0.4502570331096649
loss_pred:0.025212522596120834, decouple_loss:0.009065127931535244
loss_pred:0.027116654440760612, decouple_loss:0.00943179614841938
loss_pred:0.02665898948907852, decouple_loss:0.009429731406271458
Iteration: 355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520755410194397, gen p mean: -0.7350772619247437, mean p set: 0.4525558054447174
The modified gen p mean: 0.4496021568775177, gen p mean: -0.7240152955055237, mean p set: 0.450082391500473
loss_pred:0.02546519972383976, decouple_loss:0.009578749537467957
loss_pred:0.026060519739985466, decouple_loss:0.00914702471345663
The modified gen p mean: 0.4493904411792755, gen p mean: -0.7292088866233826, mean p set: 0.4498707354068756
loss_pred:0.025817297399044037, decouple_loss:0.00945517048239708
Iteration: 356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449407160282135, gen p mean: -0.7302067279815674, mean p set: 0.4498874545097351
The modified gen p mean: 0.45051443576812744, gen p mean: -0.7325671315193176, mean p set: 0.45099470019340515
The modified gen p mean: 0.4504566192626953, gen p mean: -0.7327014803886414, mean p set: 0.4509369134902954
loss_pred:0.025386329740285873, decouple_loss:0.00936330109834671
loss_pred:0.026566848158836365, decouple_loss:0.009310448542237282
loss_pred:0.02676200680434704, decouple_loss:0.009085281752049923
Iteration: 357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45236364006996155, gen p mean: -0.7412529587745667, mean p set: 0.45284390449523926
The modified gen p mean: 0.4491100013256073, gen p mean: -0.7430163025856018, mean p set: 0.4495902955532074
The modified gen p mean: 0.4518240690231323, gen p mean: -0.7479915618896484, mean p set: 0.4523043632507324
loss_pred:0.026747478172183037, decouple_loss:0.009285960346460342
loss_pred:0.02539975941181183, decouple_loss:0.008922027423977852
loss_pred:0.025136686861515045, decouple_loss:0.009754786267876625
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465106725692749, gen p mean: -0.7457723021507263, mean p set: 0.446990966796875
The modified gen p mean: 0.44788697361946106, gen p mean: -0.7522602081298828, mean p set: 0.44836726784706116
The modified gen p mean: 0.4483340084552765, gen p mean: -0.7551867365837097, mean p set: 0.4488143026828766
loss_pred:0.02543349750339985, decouple_loss:0.009284820407629013
loss_pred:0.025912588462233543, decouple_loss:0.009788509458303452
loss_pred:0.02624211087822914, decouple_loss:0.010365561582148075
Iteration: 359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483461380004883, gen p mean: -0.7459672093391418, mean p set: 0.4488264322280884
The modified gen p mean: 0.45018258690834045, gen p mean: -0.7404357194900513, mean p set: 0.45066288113594055
The modified gen p mean: 0.4476674795150757, gen p mean: -0.7399218678474426, mean p set: 0.4481477439403534
loss_pred:0.0255894735455513, decouple_loss:0.009459962137043476
loss_pred:0.026502566412091255, decouple_loss:0.009292869828641415
loss_pred:0.026813309639692307, decouple_loss:0.00944666750729084
Iteration: 360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487915635108948, gen p mean: -0.7290756106376648, mean p set: 0.4492718279361725
The modified gen p mean: 0.4473828375339508, gen p mean: -0.7284353971481323, mean p set: 0.4478631317615509
loss_pred:0.025929918512701988, decouple_loss:0.00997569877654314
loss_pred:0.025812450796365738, decouple_loss:0.009737563319504261
The modified gen p mean: 0.4486162066459656, gen p mean: -0.7297267317771912, mean p set: 0.4490965008735657
loss_pred:0.026358135044574738, decouple_loss:0.009210898540914059
2023-05-06 21:08:28 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.73490309715271, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7235267162322998, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7278375625610352, mean p set: 0.4500633478164673
loss_pred:0.02749808505177498, decouple_loss:0.009619870223104954
loss_pred:0.02610226906836033, decouple_loss:0.009566284716129303
loss_pred:0.02647758089005947, decouple_loss:0.009646367281675339
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02717318758368492, avg_mse: 0.03258050978183746
current test mse: 0.032581
Iteration: 361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44748514890670776, gen p mean: -0.7271167635917664, mean p set: 0.44796544313430786
loss_pred:0.026071904227137566, decouple_loss:0.009279848076403141
The modified gen p mean: 0.44806262850761414, gen p mean: -0.729483425617218, mean p set: 0.44854292273521423
loss_pred:0.025928732007741928, decouple_loss:0.009278192184865475
The modified gen p mean: 0.44732072949409485, gen p mean: -0.7240787744522095, mean p set: 0.44780102372169495
loss_pred:0.02671227604150772, decouple_loss:0.009670651517808437
Iteration: 362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481760859489441, gen p mean: -0.7364991903305054, mean p set: 0.4486563205718994
The modified gen p mean: 0.44837528467178345, gen p mean: -0.7355414032936096, mean p set: 0.44885557889938354
The modified gen p mean: 0.4483143091201782, gen p mean: -0.7352438569068909, mean p set: 0.44879457354545593
loss_pred:0.026175590232014656, decouple_loss:0.009100959636271
loss_pred:0.025714820250868797, decouple_loss:0.009459972381591797
loss_pred:0.026359722018241882, decouple_loss:0.00928516499698162
Iteration: 363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487621486186981, gen p mean: -0.7353805303573608, mean p set: 0.4492424428462982
The modified gen p mean: 0.4463944435119629, gen p mean: -0.7304533123970032, mean p set: 0.4468747675418854
The modified gen p mean: 0.4488388001918793, gen p mean: -0.7411860823631287, mean p set: 0.449319064617157
loss_pred:0.02552245557308197, decouple_loss:0.009201343171298504
loss_pred:0.026310013607144356, decouple_loss:0.009364448487758636
loss_pred:0.026197010651230812, decouple_loss:0.008872566744685173
Iteration: 364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761234521865845, gen p mean: -0.7410379648208618, mean p set: 0.44809263944625854
The modified gen p mean: 0.4475422203540802, gen p mean: -0.7418292760848999, mean p set: 0.4480225145816803
The modified gen p mean: 0.4494085907936096, gen p mean: -0.7417793869972229, mean p set: 0.44988885521888733
loss_pred:0.0259667057543993, decouple_loss:0.009082910604774952
loss_pred:0.026560598984360695, decouple_loss:0.00918284896761179
loss_pred:0.0264937411993742, decouple_loss:0.008844885975122452
Iteration: 365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487471878528595, gen p mean: -0.7441204786300659, mean p set: 0.4492274820804596
The modified gen p mean: 0.44923385977745056, gen p mean: -0.744699239730835, mean p set: 0.44971415400505066
The modified gen p mean: 0.447750449180603, gen p mean: -0.7455608248710632, mean p set: 0.4482307732105255
loss_pred:0.026021551340818405, decouple_loss:0.00916803814470768
loss_pred:0.02629847824573517, decouple_loss:0.009680988267064095
loss_pred:0.025429653003811836, decouple_loss:0.009137616492807865
Iteration: 366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448636531829834, gen p mean: -0.7362902760505676, mean p set: 0.4491168260574341
The modified gen p mean: 0.4483553469181061, gen p mean: -0.7363797426223755, mean p set: 0.44883567094802856
The modified gen p mean: 0.44615504145622253, gen p mean: -0.7295424342155457, mean p set: 0.44663533568382263
loss_pred:0.026648234575986862, decouple_loss:0.009216184727847576
loss_pred:0.02673780359327793, decouple_loss:0.009066072292625904
loss_pred:0.02569114789366722, decouple_loss:0.009509259834885597
Iteration: 367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828712940216064, gen p mean: -0.7228573560714722, mean p set: 0.44876742362976074
The modified gen p mean: 0.4496217966079712, gen p mean: -0.7251496315002441, mean p set: 0.4501021206378937
The modified gen p mean: 0.44865864515304565, gen p mean: -0.7226991653442383, mean p set: 0.44913890957832336
loss_pred:0.02616298384964466, decouple_loss:0.009511448442935944
loss_pred:0.025554444640874863, decouple_loss:0.009341474622488022
loss_pred:0.025200877338647842, decouple_loss:0.008994999341666698
Iteration: 368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477931559085846, gen p mean: -0.7250956892967224, mean p set: 0.4482734203338623
The modified gen p mean: 0.4502047300338745, gen p mean: -0.726656973361969, mean p set: 0.450685054063797
The modified gen p mean: 0.4482864737510681, gen p mean: -0.7293645739555359, mean p set: 0.4487667679786682
loss_pred:0.026228690519928932, decouple_loss:0.009121540933847427loss_pred:0.025238199159502983, decouple_loss:0.008882496505975723
loss_pred:0.02578350156545639, decouple_loss:0.008830759674310684
Iteration: 369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707104563713074, gen p mean: -0.7281270027160645, mean p set: 0.44755133986473083
The modified gen p mean: 0.44850486516952515, gen p mean: -0.7265010476112366, mean p set: 0.44898515939712524
The modified gen p mean: 0.44847527146339417, gen p mean: -0.7302525043487549, mean p set: 0.44895556569099426
loss_pred:0.025099962949752808, decouple_loss:0.008874001912772655
loss_pred:0.02552799880504608, decouple_loss:0.008687174879014492
loss_pred:0.02655852399766445, decouple_loss:0.009303195402026176
Iteration: 370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482540488243103, gen p mean: -0.7277803421020508, mean p set: 0.4487343728542328
The modified gen p mean: 0.4490843415260315, gen p mean: -0.730338454246521, mean p set: 0.4495646357536316
The modified gen p mean: 0.44727644324302673, gen p mean: -0.7307520508766174, mean p set: 0.44775673747062683
loss_pred:0.02707792818546295, decouple_loss:0.008836881257593632
loss_pred:0.02584158070385456, decouple_loss:0.008580818772315979
loss_pred:0.025430887937545776, decouple_loss:0.009106325916945934
2023-05-06 21:12:06 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7402065992355347, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.728958010673523, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7334381937980652, mean p set: 0.4500633478164673
loss_pred:0.027287818491458893, decouple_loss:0.009474118240177631
loss_pred:0.025966670364141464, decouple_loss:0.009130973368883133
loss_pred:0.026304660364985466, decouple_loss:0.009096061810851097
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026981404051184654, avg_mse: 0.0322774276137352
current test mse: 0.032277
Iteration: 371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818660616874695, gen p mean: -0.7377039194107056, mean p set: 0.44866693019866943The modified gen p mean: 0.44872063398361206, gen p mean: -0.7345936894416809, mean p set: 0.44920095801353455
loss_pred:0.025776730850338936, decouple_loss:0.008936192840337753
loss_pred:0.02598668448626995, decouple_loss:0.008638626895844936
The modified gen p mean: 0.44648703932762146, gen p mean: -0.72686767578125, mean p set: 0.44696733355522156
loss_pred:0.025147994980216026, decouple_loss:0.008707570843398571
Iteration: 372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478696584701538, gen p mean: -0.7403813600540161, mean p set: 0.4483499228954315
The modified gen p mean: 0.4482608139514923, gen p mean: -0.739143431186676, mean p set: 0.4487411379814148
The modified gen p mean: 0.4508858025074005, gen p mean: -0.7344104647636414, mean p set: 0.4513660967350006
loss_pred:0.024845758453011513, decouple_loss:0.009389734826982021
loss_pred:0.02522573620080948, decouple_loss:0.009326910600066185
loss_pred:0.026386700570583344, decouple_loss:0.008665312081575394
Iteration: 373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810235500335693, gen p mean: -0.7418609261512756, mean p set: 0.4485826790332794
The modified gen p mean: 0.4465603828430176, gen p mean: -0.7307023406028748, mean p set: 0.44704070687294006
loss_pred:0.025434503331780434, decouple_loss:0.008779027499258518
loss_pred:0.025027787312865257, decouple_loss:0.009159782901406288
The modified gen p mean: 0.4480462074279785, gen p mean: -0.7360018491744995, mean p set: 0.4485265016555786
loss_pred:0.02492445334792137, decouple_loss:0.00916439387947321
Iteration: 374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467921853065491, gen p mean: -0.7344111800193787, mean p set: 0.4472724497318268
The modified gen p mean: 0.44796425104141235, gen p mean: -0.7341219782829285, mean p set: 0.44844454526901245
The modified gen p mean: 0.44756534695625305, gen p mean: -0.7264416813850403, mean p set: 0.44804564118385315
loss_pred:0.02512286975979805, decouple_loss:0.008665213361382484loss_pred:0.026019953191280365, decouple_loss:0.009072763845324516
loss_pred:0.02567727491259575, decouple_loss:0.009105467237532139
Iteration: 375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481053054332733, gen p mean: -0.7214710712432861, mean p set: 0.4485855996608734
The modified gen p mean: 0.4475911259651184, gen p mean: -0.7231999635696411, mean p set: 0.4480714499950409
The modified gen p mean: 0.44782358407974243, gen p mean: -0.7197832465171814, mean p set: 0.44830387830734253
loss_pred:0.0261637382209301, decouple_loss:0.008966710418462753
loss_pred:0.0245779100805521, decouple_loss:0.00884191133081913
loss_pred:0.026831338182091713, decouple_loss:0.009320313110947609
Iteration: 376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447777658700943, gen p mean: -0.7299078702926636, mean p set: 0.4482579529285431
The modified gen p mean: 0.4484059810638428, gen p mean: -0.731249213218689, mean p set: 0.4488862454891205
The modified gen p mean: 0.44935527443885803, gen p mean: -0.7236748337745667, mean p set: 0.44983553886413574
loss_pred:0.025600643828511238, decouple_loss:0.008638080209493637
loss_pred:0.026276126503944397, decouple_loss:0.00885335449129343
loss_pred:0.02545618824660778, decouple_loss:0.008956379257142544
Iteration: 377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44871821999549866, gen p mean: -0.7438355684280396, mean p set: 0.44919851422309875
The modified gen p mean: 0.4487585425376892, gen p mean: -0.7416009902954102, mean p set: 0.4492388665676117
loss_pred:0.026075171306729317, decouple_loss:0.008611125871539116
The modified gen p mean: 0.4479285776615143, gen p mean: -0.7408937811851501, mean p set: 0.448408842086792
loss_pred:0.024891972541809082, decouple_loss:0.00886549986898899
loss_pred:0.026109877973794937, decouple_loss:0.00905254390090704
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
NaN value num: 0
Iteration: 378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513819217681885, gen p mean: -0.7439843416213989, mean p set: 0.4518622159957886
The modified gen p mean: 0.4514378607273102, gen p mean: -0.7417049407958984, mean p set: 0.4519181549549103
The modified gen p mean: 0.4512057602405548, gen p mean: -0.741607129573822, mean p set: 0.4516860842704773
loss_pred:0.027114013209939003, decouple_loss:0.009250568225979805loss_pred:0.025249099358916283, decouple_loss:0.009529377333819866
loss_pred:0.026695523411035538, decouple_loss:0.009404156357049942
Iteration: 379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45163241028785706, gen p mean: -0.7382805943489075, mean p set: 0.45211273431777954
The modified gen p mean: 0.4515528380870819, gen p mean: -0.7403498291969299, mean p set: 0.4520331025123596
The modified gen p mean: 0.4509257674217224, gen p mean: -0.7340514659881592, mean p set: 0.4514060616493225
loss_pred:0.027845317497849464, decouple_loss:0.009717374108731747loss_pred:0.028021596372127533, decouple_loss:0.009423431940376759
loss_pred:0.02825102023780346, decouple_loss:0.009582512080669403
Iteration: 380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510059058666229, gen p mean: -0.7473366856575012, mean p set: 0.45148617029190063
The modified gen p mean: 0.451057106256485, gen p mean: -0.7422590851783752, mean p set: 0.4515374004840851
The modified gen p mean: 0.45191532373428345, gen p mean: -0.7442647218704224, mean p set: 0.45239561796188354
loss_pred:0.027530765160918236, decouple_loss:0.009186085313558578loss_pred:0.02647572197020054, decouple_loss:0.009535311721265316
loss_pred:0.026068076491355896, decouple_loss:0.00928155891597271
2023-05-06 21:16:35 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7586443424224854, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7460305690765381, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7511592507362366, mean p set: 0.4500633478164673
loss_pred:0.027424881234765053, decouple_loss:0.010211065411567688
loss_pred:0.02606099471449852, decouple_loss:0.009799742139875889
loss_pred:0.02627977542579174, decouple_loss:0.009886027313768864
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027086831629276276, avg_mse: 0.032395463436841965
current test mse: 0.032395
Iteration: 381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506426751613617, gen p mean: -0.751028835773468, mean p set: 0.4511229395866394
The modified gen p mean: 0.4523986279964447, gen p mean: -0.7483831644058228, mean p set: 0.4528789222240448
loss_pred:0.026929911226034164, decouple_loss:0.00956313218921423
loss_pred:0.02557418681681156, decouple_loss:0.009006505832076073
The modified gen p mean: 0.45060813426971436, gen p mean: -0.7539271116256714, mean p set: 0.45108845829963684
loss_pred:0.026371529325842857, decouple_loss:0.009626107290387154
Iteration: 382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511990249156952, gen p mean: -0.7537343502044678, mean p set: 0.4516793489456177
The modified gen p mean: 0.4509027898311615, gen p mean: -0.7747172117233276, mean p set: 0.4513830542564392
loss_pred:0.027780190110206604, decouple_loss:0.009377636946737766
loss_pred:0.027777958661317825, decouple_loss:0.00997775886207819
The modified gen p mean: 0.4502906799316406, gen p mean: -0.7687047123908997, mean p set: 0.4507710039615631
loss_pred:0.027613960206508636, decouple_loss:0.009558085352182388
Iteration: 383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45106038451194763, gen p mean: -0.7735311388969421, mean p set: 0.45154067873954773
The modified gen p mean: 0.4494110643863678, gen p mean: -0.7448989152908325, mean p set: 0.4498913586139679
The modified gen p mean: 0.450927734375, gen p mean: -0.7506184577941895, mean p set: 0.4514080286026001
loss_pred:0.027701852843165398, decouple_loss:0.009642756544053555
loss_pred:0.025111541152000427, decouple_loss:0.009392095729708672
loss_pred:0.027950169518589973, decouple_loss:0.009236271493136883
Iteration: 384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518135190010071, gen p mean: -0.7448017001152039, mean p set: 0.4522937834262848
The modified gen p mean: 0.45093539357185364, gen p mean: -0.7530490756034851, mean p set: 0.45141565799713135
The modified gen p mean: 0.45209985971450806, gen p mean: -0.7550179362297058, mean p set: 0.45258012413978577
loss_pred:0.024684559553861618, decouple_loss:0.009529044851660728
loss_pred:0.027679258957505226, decouple_loss:0.009596041403710842
loss_pred:0.026978423818945885, decouple_loss:0.00967648345977068
Iteration: 385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506296217441559, gen p mean: -0.7499680519104004, mean p set: 0.4511098861694336
The modified gen p mean: 0.45126789808273315, gen p mean: -0.7448258399963379, mean p set: 0.45174819231033325
The modified gen p mean: 0.45149075984954834, gen p mean: -0.7436770796775818, mean p set: 0.45197105407714844
loss_pred:0.027749085798859596, decouple_loss:0.009590566158294678
loss_pred:0.02701307274401188, decouple_loss:0.009557080455124378
loss_pred:0.026388823986053467, decouple_loss:0.009114684537053108
Iteration: 386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527598023414612, gen p mean: -0.747100830078125, mean p set: 0.4532400667667389
The modified gen p mean: 0.4510725140571594, gen p mean: -0.7478370666503906, mean p set: 0.4515528082847595
The modified gen p mean: 0.4524074196815491, gen p mean: -0.742388129234314, mean p set: 0.45288771390914917
loss_pred:0.028018711134791374, decouple_loss:0.009597971104085445
loss_pred:0.028096651658415794, decouple_loss:0.009314191527664661
loss_pred:0.028417732566595078, decouple_loss:0.009624308906495571
Iteration: 387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517457187175751, gen p mean: -0.7416790723800659, mean p set: 0.45222604274749756
The modified gen p mean: 0.45118048787117004, gen p mean: -0.7387233972549438, mean p set: 0.45166081190109253
The modified gen p mean: 0.4509143531322479, gen p mean: -0.7545931339263916, mean p set: 0.4513946771621704
loss_pred:0.025941239669919014, decouple_loss:0.00948038324713707loss_pred:0.028112661093473434, decouple_loss:0.009679575450718403
loss_pred:0.02617684379220009, decouple_loss:0.0092351995408535
Iteration: 388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507334530353546, gen p mean: -0.7468547821044922, mean p set: 0.4512137174606323
The modified gen p mean: 0.4512471556663513, gen p mean: -0.7581778764724731, mean p set: 0.45172742009162903
The modified gen p mean: 0.4528945982456207, gen p mean: -0.7471479773521423, mean p set: 0.45337486267089844
loss_pred:0.025141283869743347, decouple_loss:0.00961344689130783
loss_pred:0.027339288964867592, decouple_loss:0.009914159774780273
loss_pred:0.02567455917596817, decouple_loss:0.009408305399119854
Iteration: 389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45149368047714233, gen p mean: -0.7432945370674133, mean p set: 0.45197397470474243
The modified gen p mean: 0.452442467212677, gen p mean: -0.7487601041793823, mean p set: 0.4529227614402771
The modified gen p mean: 0.4515439569950104, gen p mean: -0.7403738498687744, mean p set: 0.4520242512226105
loss_pred:0.024238334968686104, decouple_loss:0.009211942553520203
loss_pred:0.026811856776475906, decouple_loss:0.00910637155175209
loss_pred:0.02560528926551342, decouple_loss:0.00908962357789278
Iteration: 390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45290446281433105, gen p mean: -0.7499913573265076, mean p set: 0.45338475704193115
The modified gen p mean: 0.4500422775745392, gen p mean: -0.7325206398963928, mean p set: 0.45052260160446167
The modified gen p mean: 0.4510195255279541, gen p mean: -0.7429555058479309, mean p set: 0.4514998197555542
loss_pred:0.02693990059196949, decouple_loss:0.009156961925327778
loss_pred:0.02573731169104576, decouple_loss:0.009127587080001831
loss_pred:0.028004614636301994, decouple_loss:0.009182365611195564
2023-05-06 21:20:11 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.746269941329956, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7338623404502869, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7386673092842102, mean p set: 0.4500633478164673
loss_pred:0.02753625623881817, decouple_loss:0.010403520427644253
loss_pred:0.026058686897158623, decouple_loss:0.010128969326615334
loss_pred:0.026337942108511925, decouple_loss:0.01000771764665842
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027153298258781433, avg_mse: 0.03256915509700775
current test mse: 0.032569
Iteration: 391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45230168104171753, gen p mean: -0.7377526164054871, mean p set: 0.45278200507164
The modified gen p mean: 0.45097115635871887, gen p mean: -0.7350503206253052, mean p set: 0.45145145058631897
loss_pred:0.026278186589479446, decouple_loss:0.009164812043309212
loss_pred:0.026275841519236565, decouple_loss:0.009055908769369125
The modified gen p mean: 0.45139768719673157, gen p mean: -0.7408081889152527, mean p set: 0.45187801122665405
loss_pred:0.027571028098464012, decouple_loss:0.009537204168736935
Iteration: 392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45039990544319153, gen p mean: -0.7424981594085693, mean p set: 0.45088016986846924
The modified gen p mean: 0.4503636956214905, gen p mean: -0.7375949621200562, mean p set: 0.4508439898490906
loss_pred:0.02619699388742447, decouple_loss:0.00890274066478014
loss_pred:0.024617064744234085, decouple_loss:0.008727977983653545
The modified gen p mean: 0.4508022367954254, gen p mean: -0.7469249963760376, mean p set: 0.4512825310230255
loss_pred:0.02542438544332981, decouple_loss:0.008942149579524994
Iteration: 393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45116761326789856, gen p mean: -0.7454977631568909, mean p set: 0.45164790749549866
The modified gen p mean: 0.45028239488601685, gen p mean: -0.7534940838813782, mean p set: 0.45076268911361694
The modified gen p mean: 0.45057252049446106, gen p mean: -0.7528036236763, mean p set: 0.45105281472206116
loss_pred:0.02750566229224205, decouple_loss:0.009047770872712135loss_pred:0.026434121653437614, decouple_loss:0.008529032580554485
loss_pred:0.02443316951394081, decouple_loss:0.008692500181496143
Iteration: 394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45221853256225586, gen p mean: -0.7593541145324707, mean p set: 0.45269879698753357
The modified gen p mean: 0.4510252773761749, gen p mean: -0.75214684009552, mean p set: 0.451505571603775
The modified gen p mean: 0.45191705226898193, gen p mean: -0.7555671334266663, mean p set: 0.45239734649658203
loss_pred:0.025561893358826637, decouple_loss:0.008919598534703255
loss_pred:0.026486309245228767, decouple_loss:0.008596240542829037
loss_pred:0.025166388601064682, decouple_loss:0.008725794963538647
Iteration: 395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523831307888031, gen p mean: -0.7426576614379883, mean p set: 0.4528633952140808
The modified gen p mean: 0.45133718848228455, gen p mean: -0.738774836063385, mean p set: 0.45181748270988464
The modified gen p mean: 0.45060622692108154, gen p mean: -0.7411912083625793, mean p set: 0.45108652114868164
loss_pred:0.026038406416773796, decouple_loss:0.008557303808629513
loss_pred:0.027503175660967827, decouple_loss:0.008579855784773827
loss_pred:0.028067052364349365, decouple_loss:0.009219932369887829
Iteration: 396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45053577423095703, gen p mean: -0.7454720139503479, mean p set: 0.4510160982608795
The modified gen p mean: 0.45133134722709656, gen p mean: -0.7404287457466125, mean p set: 0.45181164145469666
The modified gen p mean: 0.45155468583106995, gen p mean: -0.7435162663459778, mean p set: 0.45203498005867004
loss_pred:0.027199208736419678, decouple_loss:0.009098322130739689
loss_pred:0.02772008255124092, decouple_loss:0.009162131696939468
loss_pred:0.02730734460055828, decouple_loss:0.009579693898558617
Iteration: 397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45110514760017395, gen p mean: -0.7364907264709473, mean p set: 0.45158541202545166
The modified gen p mean: 0.4510226249694824, gen p mean: -0.7338321805000305, mean p set: 0.4515029489994049
The modified gen p mean: 0.4513143002986908, gen p mean: -0.7326481938362122, mean p set: 0.4517945945262909
loss_pred:0.02700313925743103, decouple_loss:0.008782890625298023
loss_pred:0.024928361177444458, decouple_loss:0.008616168051958084
loss_pred:0.02473561279475689, decouple_loss:0.008621909655630589
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
NaN value num: 0
Iteration: 398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082083344459534, gen p mean: -0.7191079258918762, mean p set: 0.45130112767219543
The modified gen p mean: 0.45096656680107117, gen p mean: -0.7328633666038513, mean p set: 0.45144689083099365
The modified gen p mean: 0.45036160945892334, gen p mean: -0.7295698523521423, mean p set: 0.4508419334888458
loss_pred:0.027806567028164864, decouple_loss:0.008423996157944202
loss_pred:0.02716023102402687, decouple_loss:0.008505492471158504
loss_pred:0.026564843952655792, decouple_loss:0.008839686401188374
Iteration: 399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519760310649872, gen p mean: -0.7256622314453125, mean p set: 0.4524562954902649
The modified gen p mean: 0.45210567116737366, gen p mean: -0.7198226451873779, mean p set: 0.45258599519729614
The modified gen p mean: 0.4496927261352539, gen p mean: -0.7299736142158508, mean p set: 0.450173020362854
loss_pred:0.02560282126069069, decouple_loss:0.00889997836202383
loss_pred:0.027877436950802803, decouple_loss:0.008870642632246017
loss_pred:0.027174295857548714, decouple_loss:0.008957705460488796
Iteration: 400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45085176825523376, gen p mean: -0.7335575819015503, mean p set: 0.45133206248283386
The modified gen p mean: 0.4508418142795563, gen p mean: -0.7294092774391174, mean p set: 0.45132210850715637
The modified gen p mean: 0.45010024309158325, gen p mean: -0.7417179346084595, mean p set: 0.45058050751686096
loss_pred:0.0270089004188776, decouple_loss:0.008815492503345013
loss_pred:0.027429288253188133, decouple_loss:0.00892835296690464
loss_pred:0.02761152945458889, decouple_loss:0.008802374824881554
2023-05-06 21:25:06 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7638227939605713, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7518232464790344, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7563403248786926, mean p set: 0.4500633478164673
loss_pred:0.027532588690519333, decouple_loss:0.009982424788177013
loss_pred:0.026041926816105843, decouple_loss:0.009633918292820454
loss_pred:0.026375381276011467, decouple_loss:0.00976780615746975
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027139704674482346, avg_mse: 0.032621610909700394
current test mse: 0.032622
Iteration: 401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44986769556999207, gen p mean: -0.754079282283783, mean p set: 0.45034801959991455
The modified gen p mean: 0.4507615566253662, gen p mean: -0.7454657554626465, mean p set: 0.4512418508529663
loss_pred:0.027128607034683228, decouple_loss:0.008427007123827934
loss_pred:0.02634069137275219, decouple_loss:0.008361763320863247
The modified gen p mean: 0.4497205913066864, gen p mean: -0.7559201717376709, mean p set: 0.4502009153366089
loss_pred:0.027046015486121178, decouple_loss:0.008386180736124516
Iteration: 402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517272710800171, gen p mean: -0.7629510164260864, mean p set: 0.4522075653076172
The modified gen p mean: 0.45006638765335083, gen p mean: -0.7603901624679565, mean p set: 0.4505466818809509
The modified gen p mean: 0.45115041732788086, gen p mean: -0.7591209411621094, mean p set: 0.45163068175315857
loss_pred:0.02565603330731392, decouple_loss:0.008542179130017757
loss_pred:0.027558647096157074, decouple_loss:0.008870517835021019
loss_pred:0.02635769359767437, decouple_loss:0.0089074382558465
Iteration: 403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494194984436035, gen p mean: -0.757871150970459, mean p set: 0.449899822473526
The modified gen p mean: 0.4508119225502014, gen p mean: -0.7585170865058899, mean p set: 0.4512922167778015
The modified gen p mean: 0.4514372646808624, gen p mean: -0.7533910274505615, mean p set: 0.4519175887107849
loss_pred:0.026563895866274834, decouple_loss:0.008528908714652061
loss_pred:0.027511168271303177, decouple_loss:0.008787811733782291
loss_pred:0.0263152327388525, decouple_loss:0.008577825501561165
Iteration: 404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45269036293029785, gen p mean: -0.7466768622398376, mean p set: 0.45317062735557556
The modified gen p mean: 0.44965270161628723, gen p mean: -0.7560070157051086, mean p set: 0.45013299584388733
The modified gen p mean: 0.4512347877025604, gen p mean: -0.7445360422134399, mean p set: 0.4517151117324829
loss_pred:0.02726956456899643, decouple_loss:0.008413000032305717
loss_pred:0.026787810027599335, decouple_loss:0.008762966841459274
loss_pred:0.026340924203395844, decouple_loss:0.00854361243546009
Iteration: 405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449611634016037, gen p mean: -0.7478693723678589, mean p set: 0.4500918984413147
The modified gen p mean: 0.4508074223995209, gen p mean: -0.752582848072052, mean p set: 0.4512876868247986
The modified gen p mean: 0.45026731491088867, gen p mean: -0.7493219375610352, mean p set: 0.45074760913848877
loss_pred:0.026804331690073013, decouple_loss:0.008772425353527069
loss_pred:0.027652272954583168, decouple_loss:0.008627129718661308
loss_pred:0.02727321907877922, decouple_loss:0.008368892595171928
Iteration: 406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45141705870628357, gen p mean: -0.7387532591819763, mean p set: 0.45189735293388367
The modified gen p mean: 0.4518752694129944, gen p mean: -0.7420681715011597, mean p set: 0.4523555636405945
loss_pred:0.028110787272453308, decouple_loss:0.008433888666331768
loss_pred:0.02525455132126808, decouple_loss:0.008213252760469913
The modified gen p mean: 0.4505957067012787, gen p mean: -0.7435252070426941, mean p set: 0.4510760009288788
loss_pred:0.02641383558511734, decouple_loss:0.008029051125049591
Iteration: 407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514906108379364, gen p mean: -0.7416405081748962, mean p set: 0.4519709050655365
The modified gen p mean: 0.44943225383758545, gen p mean: -0.7407242655754089, mean p set: 0.44991254806518555
The modified gen p mean: 0.44983214139938354, gen p mean: -0.7428091168403625, mean p set: 0.45031243562698364
loss_pred:0.026479145511984825, decouple_loss:0.008451143279671669
loss_pred:0.026493582874536514, decouple_loss:0.008424951694905758
loss_pred:0.026206297799944878, decouple_loss:0.008179478347301483
Iteration: 408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45083531737327576, gen p mean: -0.734454333782196, mean p set: 0.45131561160087585
The modified gen p mean: 0.451535165309906, gen p mean: -0.7286632657051086, mean p set: 0.4520154595375061
The modified gen p mean: 0.45255059003829956, gen p mean: -0.7363559603691101, mean p set: 0.45303085446357727
loss_pred:0.025875313207507133, decouple_loss:0.008307778276503086
loss_pred:0.027219045907258987, decouple_loss:0.008150220848619938
loss_pred:0.026045015081763268, decouple_loss:0.00822135154157877
Iteration: 409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513067305088043, gen p mean: -0.7333648204803467, mean p set: 0.45178699493408203
The modified gen p mean: 0.449715793132782, gen p mean: -0.7400873899459839, mean p set: 0.4501960873603821
The modified gen p mean: 0.45183250308036804, gen p mean: -0.7346265912055969, mean p set: 0.45231279730796814
loss_pred:0.027628637850284576, decouple_loss:0.008012096397578716
loss_pred:0.026915188878774643, decouple_loss:0.008119474165141582
loss_pred:0.027779527008533478, decouple_loss:0.008308006450533867
Iteration: 410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506399631500244, gen p mean: -0.7504264712333679, mean p set: 0.4511202275753021
The modified gen p mean: 0.45153141021728516, gen p mean: -0.7391195893287659, mean p set: 0.45201170444488525
The modified gen p mean: 0.4493287205696106, gen p mean: -0.7479875087738037, mean p set: 0.4498090147972107
loss_pred:0.026582900434732437, decouple_loss:0.008077754639089108
loss_pred:0.02528919279575348, decouple_loss:0.008074136450886726
loss_pred:0.027507411316037178, decouple_loss:0.008243289776146412
2023-05-06 21:28:44 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7574378848075867, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.745503842830658, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7500284910202026, mean p set: 0.4500633478164673
loss_pred:0.02734708972275257, decouple_loss:0.009705902077257633
loss_pred:0.02591712214052677, decouple_loss:0.009427732788026333
loss_pred:0.026244984939694405, decouple_loss:0.00964058842509985
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026982635259628296, avg_mse: 0.03237980604171753
current test mse: 0.03238
Iteration: 411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45233818888664246, gen p mean: -0.7446792125701904, mean p set: 0.45281848311424255
The modified gen p mean: 0.45209649205207825, gen p mean: -0.7468458414077759, mean p set: 0.45257672667503357
loss_pred:0.025108477100729942, decouple_loss:0.008273405022919178
loss_pred:0.025030475109815598, decouple_loss:0.008255643770098686
The modified gen p mean: 0.4518773853778839, gen p mean: -0.7437358498573303, mean p set: 0.452357679605484
loss_pred:0.025231044739484787, decouple_loss:0.008054518140852451
Iteration: 412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512808918952942, gen p mean: -0.7489154934883118, mean p set: 0.4517611861228943
The modified gen p mean: 0.4501013159751892, gen p mean: -0.750191330909729, mean p set: 0.45058155059814453
The modified gen p mean: 0.44944486021995544, gen p mean: -0.7503454685211182, mean p set: 0.44992515444755554
loss_pred:0.026294102892279625, decouple_loss:0.008371733129024506
loss_pred:0.027449732646346092, decouple_loss:0.007928316481411457
loss_pred:0.026980889961123466, decouple_loss:0.008168479427695274
Iteration: 413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45038220286369324, gen p mean: -0.7575902342796326, mean p set: 0.45086249709129333
The modified gen p mean: 0.4500442445278168, gen p mean: -0.7545208930969238, mean p set: 0.45052459836006165
The modified gen p mean: 0.45073339343070984, gen p mean: -0.7506929636001587, mean p set: 0.4512137174606323
loss_pred:0.02619931660592556, decouple_loss:0.008028319105505943
loss_pred:0.026323307305574417, decouple_loss:0.00785689428448677
loss_pred:0.027135420590639114, decouple_loss:0.008140896447002888
Iteration: 414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012742280960083, gen p mean: -0.7490789890289307, mean p set: 0.45060768723487854
The modified gen p mean: 0.4523179531097412, gen p mean: -0.7390215396881104, mean p set: 0.4527982771396637
loss_pred:0.02671511471271515, decouple_loss:0.0077543375082314014
loss_pred:0.027575895190238953, decouple_loss:0.008305941708385944
The modified gen p mean: 0.45095786452293396, gen p mean: -0.7395346164703369, mean p set: 0.45143812894821167
loss_pred:0.027074551209807396, decouple_loss:0.007879607379436493
Iteration: 415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45078352093696594, gen p mean: -0.740694522857666, mean p set: 0.4512638449668884
The modified gen p mean: 0.4503265619277954, gen p mean: -0.7493194341659546, mean p set: 0.4508068561553955
The modified gen p mean: 0.4517497420310974, gen p mean: -0.7327382564544678, mean p set: 0.4522300362586975
loss_pred:0.02630097232758999, decouple_loss:0.007987134158611298
loss_pred:0.027370687574148178, decouple_loss:0.007998351007699966
loss_pred:0.02777308225631714, decouple_loss:0.007817067205905914
Iteration: 416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451214998960495, gen p mean: -0.7488061189651489, mean p set: 0.4516952931880951
The modified gen p mean: 0.45096397399902344, gen p mean: -0.7464187741279602, mean p set: 0.4514442980289459
The modified gen p mean: 0.4497329592704773, gen p mean: -0.7532713413238525, mean p set: 0.4502132534980774
loss_pred:0.02542194537818432, decouple_loss:0.008099823258817196
loss_pred:0.026071494445204735, decouple_loss:0.008196891285479069
loss_pred:0.026634862646460533, decouple_loss:0.008057570084929466
Iteration: 417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519239366054535, gen p mean: -0.7520192265510559, mean p set: 0.4524042010307312
The modified gen p mean: 0.44982588291168213, gen p mean: -0.7588427662849426, mean p set: 0.45030614733695984
The modified gen p mean: 0.4508407413959503, gen p mean: -0.7524595856666565, mean p set: 0.451321005821228
loss_pred:0.024995239451527596, decouple_loss:0.007766135036945343
loss_pred:0.026830624788999557, decouple_loss:0.007683226373046637
loss_pred:0.02593291737139225, decouple_loss:0.008146129548549652
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
NaN value num: 0
Iteration: 418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495129883289337, gen p mean: -0.7604420185089111, mean p set: 0.4499933123588562
The modified gen p mean: 0.4503362476825714, gen p mean: -0.751381516456604, mean p set: 0.4508165121078491
The modified gen p mean: 0.44889456033706665, gen p mean: -0.7642219066619873, mean p set: 0.44937488436698914
loss_pred:0.025997793301939964, decouple_loss:0.009171190671622753
loss_pred:0.02559206448495388, decouple_loss:0.00916146021336317
loss_pred:0.026119478046894073, decouple_loss:0.009464753791689873
Iteration: 419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502236843109131, gen p mean: -0.768803596496582, mean p set: 0.4507039785385132
The modified gen p mean: 0.4501728415489197, gen p mean: -0.758388876914978, mean p set: 0.4506531357765198
The modified gen p mean: 0.4509466588497162, gen p mean: -0.7589881420135498, mean p set: 0.4514269232749939
loss_pred:0.025650912895798683, decouple_loss:0.00883620698004961
loss_pred:0.026011643931269646, decouple_loss:0.00868307240307331
loss_pred:0.026079045608639717, decouple_loss:0.00901869684457779
Iteration: 420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860729575157166, gen p mean: -0.7526920437812805, mean p set: 0.44908758997917175
The modified gen p mean: 0.4498642385005951, gen p mean: -0.7610104084014893, mean p set: 0.4503445625305176
loss_pred:0.027028484269976616, decouple_loss:0.0089699886739254
loss_pred:0.0260283462703228, decouple_loss:0.009080382995307446
The modified gen p mean: 0.45033565163612366, gen p mean: -0.7562012076377869, mean p set: 0.45081597566604614
loss_pred:0.02547045797109604, decouple_loss:0.009210743941366673
2023-05-06 21:33:37 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7562271952629089, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7438249588012695, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7486897706985474, mean p set: 0.4500633478164673
loss_pred:0.02747153490781784, decouple_loss:0.009864558465778828
loss_pred:0.02595529519021511, decouple_loss:0.009524485096335411
loss_pred:0.026384374126791954, decouple_loss:0.009751916863024235
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027089416980743408, avg_mse: 0.032551929354667664
current test mse: 0.032552
Iteration: 421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45056435465812683, gen p mean: -0.7583158612251282, mean p set: 0.45104461908340454
The modified gen p mean: 0.4493566155433655, gen p mean: -0.7493306994438171, mean p set: 0.44983693957328796
loss_pred:0.02597290650010109, decouple_loss:0.00864396058022976
loss_pred:0.026312123984098434, decouple_loss:0.009319230914115906
The modified gen p mean: 0.44992145895957947, gen p mean: -0.7527514100074768, mean p set: 0.45040175318717957
loss_pred:0.025616072118282318, decouple_loss:0.009131958708167076
Iteration: 422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44957005977630615, gen p mean: -0.7467723488807678, mean p set: 0.45005032420158386
The modified gen p mean: 0.45103394985198975, gen p mean: -0.7463427186012268, mean p set: 0.45151427388191223
The modified gen p mean: 0.4495946764945984, gen p mean: -0.7494770288467407, mean p set: 0.4500750005245209
loss_pred:0.02531605213880539, decouple_loss:0.008838668465614319
loss_pred:0.026814037933945656, decouple_loss:0.00881288107484579
loss_pred:0.025967534631490707, decouple_loss:0.008364597335457802
Iteration: 423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013922452926636, gen p mean: -0.7451727390289307, mean p set: 0.45061951875686646
The modified gen p mean: 0.4485991299152374, gen p mean: -0.7479975819587708, mean p set: 0.4490794241428375
loss_pred:0.025647364556789398, decouple_loss:0.00827129278331995
loss_pred:0.025989724323153496, decouple_loss:0.0085294833406806
The modified gen p mean: 0.44985517859458923, gen p mean: -0.7530708909034729, mean p set: 0.45033547282218933
loss_pred:0.026069490239024162, decouple_loss:0.008830259554088116
Iteration: 424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499850869178772, gen p mean: -0.7456066012382507, mean p set: 0.4504653811454773
The modified gen p mean: 0.4501436650753021, gen p mean: -0.7510542273521423, mean p set: 0.4506239891052246
The modified gen p mean: 0.450148344039917, gen p mean: -0.747733473777771, mean p set: 0.4506286382675171
loss_pred:0.02492358162999153, decouple_loss:0.008050964213907719
loss_pred:0.025196336209774017, decouple_loss:0.00844397209584713
loss_pred:0.025016851723194122, decouple_loss:0.008432114496827126
Iteration: 425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945964217185974, gen p mean: -0.7463643550872803, mean p set: 0.44993993639945984
The modified gen p mean: 0.45004984736442566, gen p mean: -0.751309335231781, mean p set: 0.45053014159202576
The modified gen p mean: 0.45075955986976624, gen p mean: -0.7510225772857666, mean p set: 0.4512398838996887
loss_pred:0.02610940858721733, decouple_loss:0.008343314751982689
loss_pred:0.025166405364871025, decouple_loss:0.008447139523923397
loss_pred:0.026487624272704124, decouple_loss:0.008547748439013958
Iteration: 426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019635558128357, gen p mean: -0.7544756531715393, mean p set: 0.45067667961120605
The modified gen p mean: 0.4504992961883545, gen p mean: -0.7524250745773315, mean p set: 0.4509795904159546
The modified gen p mean: 0.4503107964992523, gen p mean: -0.7548526525497437, mean p set: 0.45079106092453003
loss_pred:0.025017399340867996, decouple_loss:0.00819836650043726
loss_pred:0.02562483586370945, decouple_loss:0.008429618552327156
loss_pred:0.025001531466841698, decouple_loss:0.00837186723947525
Iteration: 427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45016369223594666, gen p mean: -0.7552881836891174, mean p set: 0.45064401626586914
The modified gen p mean: 0.44997742772102356, gen p mean: -0.751331090927124, mean p set: 0.45045775175094604
The modified gen p mean: 0.4509267508983612, gen p mean: -0.7546777129173279, mean p set: 0.4514070451259613
loss_pred:0.02558712847530842, decouple_loss:0.008926352486014366
loss_pred:0.024848712608218193, decouple_loss:0.008255266584455967
loss_pred:0.02634834311902523, decouple_loss:0.008763350546360016
Iteration: 428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490130841732025, gen p mean: -0.7575061917304993, mean p set: 0.449493408203125
The modified gen p mean: 0.45010191202163696, gen p mean: -0.766253650188446, mean p set: 0.45058220624923706
The modified gen p mean: 0.4485202133655548, gen p mean: -0.7580519914627075, mean p set: 0.4490005075931549
loss_pred:0.026007868349552155, decouple_loss:0.008257653564214706
loss_pred:0.025912238284945488, decouple_loss:0.008203957229852676
loss_pred:0.02581917867064476, decouple_loss:0.008613522164523602
Iteration: 429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508129060268402, gen p mean: -0.76058429479599, mean p set: 0.4512932300567627
The modified gen p mean: 0.4488926827907562, gen p mean: -0.7533745765686035, mean p set: 0.44937294721603394
The modified gen p mean: 0.45051082968711853, gen p mean: -0.7612445950508118, mean p set: 0.45099109411239624
loss_pred:0.025306038558483124, decouple_loss:0.008440176025032997
loss_pred:0.024735771119594574, decouple_loss:0.008415132761001587
loss_pred:0.025569528341293335, decouple_loss:0.008248930796980858
Iteration: 430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44987753033638, gen p mean: -0.7504775524139404, mean p set: 0.4503578245639801
The modified gen p mean: 0.44822800159454346, gen p mean: -0.7334290146827698, mean p set: 0.44870832562446594
The modified gen p mean: 0.4501136243343353, gen p mean: -0.732038676738739, mean p set: 0.4505939483642578
loss_pred:0.026887618005275726, decouple_loss:0.008627462200820446loss_pred:0.02640160359442234, decouple_loss:0.008707468397915363
loss_pred:0.025828083977103233, decouple_loss:0.008922260254621506
2023-05-06 21:37:16 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7472962737083435, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7348428964614868, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7396278977394104, mean p set: 0.4500633478164673
loss_pred:0.027522780001163483, decouple_loss:0.009824058972299099
loss_pred:0.02604980394244194, decouple_loss:0.009403985925018787
loss_pred:0.026430288329720497, decouple_loss:0.00958445854485035
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02714783512055874, avg_mse: 0.0327279232442379
current test mse: 0.032728
Iteration: 431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44883400201797485, gen p mean: -0.7323503494262695, mean p set: 0.44931429624557495
The modified gen p mean: 0.45036405324935913, gen p mean: -0.7418738603591919, mean p set: 0.4508443772792816
loss_pred:0.02702218107879162, decouple_loss:0.008471773006021976
loss_pred:0.025295663625001907, decouple_loss:0.008506175130605698
The modified gen p mean: 0.44897353649139404, gen p mean: -0.7342157959938049, mean p set: 0.44945380091667175
loss_pred:0.02565901167690754, decouple_loss:0.008040167391300201
Iteration: 432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502759873867035, gen p mean: -0.7415444850921631, mean p set: 0.4507562518119812
The modified gen p mean: 0.44824227690696716, gen p mean: -0.7500898838043213, mean p set: 0.4487225413322449
The modified gen p mean: 0.4483577311038971, gen p mean: -0.7433368563652039, mean p set: 0.4488380551338196
loss_pred:0.02522178180515766, decouple_loss:0.008326798677444458
loss_pred:0.02571992203593254, decouple_loss:0.008698659017682076
loss_pred:0.026005730032920837, decouple_loss:0.008671200834214687
Iteration: 433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45127689838409424, gen p mean: -0.7592237591743469, mean p set: 0.45175716280937195
The modified gen p mean: 0.451181560754776, gen p mean: -0.7631226181983948, mean p set: 0.4516618549823761
The modified gen p mean: 0.4511813521385193, gen p mean: -0.7592226266860962, mean p set: 0.451661616563797
loss_pred:0.02604411169886589, decouple_loss:0.00843464583158493
loss_pred:0.025837410241365433, decouple_loss:0.008287832140922546
loss_pred:0.02613142319023609, decouple_loss:0.008141422644257545
Iteration: 434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861555099487305, gen p mean: -0.7539772987365723, mean p set: 0.44909584522247314
The modified gen p mean: 0.4498046040534973, gen p mean: -0.7503222823143005, mean p set: 0.4502848982810974
The modified gen p mean: 0.44998282194137573, gen p mean: -0.7633082270622253, mean p set: 0.45046308636665344
loss_pred:0.025675920769572258, decouple_loss:0.008489397354424loss_pred:0.02547445148229599, decouple_loss:0.007802443113178015
loss_pred:0.02534366585314274, decouple_loss:0.008404740132391453
Iteration: 435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508385956287384, gen p mean: -0.7553281188011169, mean p set: 0.4513188898563385
The modified gen p mean: 0.44983839988708496, gen p mean: -0.7529004216194153, mean p set: 0.45031872391700745
The modified gen p mean: 0.44882988929748535, gen p mean: -0.7445412278175354, mean p set: 0.44931018352508545
loss_pred:0.02587245963513851, decouple_loss:0.007801824249327183
loss_pred:0.025672346353530884, decouple_loss:0.00808776542544365
loss_pred:0.026229742914438248, decouple_loss:0.008443113416433334
Iteration: 436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019397139549255, gen p mean: -0.7405112981796265, mean p set: 0.45067429542541504
The modified gen p mean: 0.4488689601421356, gen p mean: -0.748762309551239, mean p set: 0.4493492543697357
The modified gen p mean: 0.450810045003891, gen p mean: -0.7397972941398621, mean p set: 0.4512903094291687
loss_pred:0.025720732286572456, decouple_loss:0.008157813921570778
loss_pred:0.0262701865285635, decouple_loss:0.008329580537974834
loss_pred:0.026452338322997093, decouple_loss:0.008275773376226425
Iteration: 437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494018256664276, gen p mean: -0.7542005777359009, mean p set: 0.4498820900917053
The modified gen p mean: 0.44860315322875977, gen p mean: -0.7530454993247986, mean p set: 0.44908347725868225
The modified gen p mean: 0.4482896029949188, gen p mean: -0.7490977644920349, mean p set: 0.4487698972225189
loss_pred:0.025578415021300316, decouple_loss:0.0083593325689435loss_pred:0.025212183594703674, decouple_loss:0.008163489401340485
loss_pred:0.026666367426514626, decouple_loss:0.008873607032001019
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705289602279663, gen p mean: -0.7450124621391296, mean p set: 0.44753316044807434
The modified gen p mean: 0.44723808765411377, gen p mean: -0.7444916367530823, mean p set: 0.4477183520793915
The modified gen p mean: 0.44696342945098877, gen p mean: -0.7461849451065063, mean p set: 0.44744372367858887
loss_pred:0.028411926701664925, decouple_loss:0.009115509688854218
loss_pred:0.027041830122470856, decouple_loss:0.009554731659591198
loss_pred:0.027889231219887733, decouple_loss:0.009405352175235748
Iteration: 439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484513998031616, gen p mean: -0.7482414245605469, mean p set: 0.4489316940307617
The modified gen p mean: 0.44941359758377075, gen p mean: -0.7510047554969788, mean p set: 0.44989389181137085
The modified gen p mean: 0.4476337432861328, gen p mean: -0.7501693367958069, mean p set: 0.4481140077114105
loss_pred:0.02647775039076805, decouple_loss:0.008612209931015968loss_pred:0.0260394886136055, decouple_loss:0.008303389884531498
loss_pred:0.02619422972202301, decouple_loss:0.009043211117386818
Iteration: 440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798144698143005, gen p mean: -0.7389023900032043, mean p set: 0.44846174120903015
The modified gen p mean: 0.4483170807361603, gen p mean: -0.7460464835166931, mean p set: 0.448797345161438
The modified gen p mean: 0.44849368929862976, gen p mean: -0.7404502630233765, mean p set: 0.44897395372390747
loss_pred:0.026536855846643448, decouple_loss:0.00861123576760292
loss_pred:0.027270641177892685, decouple_loss:0.00869798194617033
loss_pred:0.026941366493701935, decouple_loss:0.00879311840981245
2023-05-06 21:41:37 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7467547059059143, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7345245480537415, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7395613193511963, mean p set: 0.4500633478164673
loss_pred:0.027292722836136818, decouple_loss:0.00945256371051073
loss_pred:0.025904756039381027, decouple_loss:0.009059344418346882
loss_pred:0.026226330548524857, decouple_loss:0.00902664102613926
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026933578774333, avg_mse: 0.03233202546834946
current test mse: 0.032332
Iteration: 441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474845826625824, gen p mean: -0.7306685447692871, mean p set: 0.4479648470878601
The modified gen p mean: 0.4473802447319031, gen p mean: -0.7290297746658325, mean p set: 0.4478605389595032
loss_pred:0.026902608573436737, decouple_loss:0.00872749276459217
loss_pred:0.02788364514708519, decouple_loss:0.008491459302604198
The modified gen p mean: 0.44651761651039124, gen p mean: -0.7304447889328003, mean p set: 0.44699788093566895
loss_pred:0.02683825045824051, decouple_loss:0.009421226568520069
Iteration: 442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481349587440491, gen p mean: -0.7482354044914246, mean p set: 0.44861525297164917
The modified gen p mean: 0.4464671313762665, gen p mean: -0.7377544641494751, mean p set: 0.4469473958015442
The modified gen p mean: 0.44765305519104004, gen p mean: -0.7457985877990723, mean p set: 0.44813334941864014
loss_pred:0.027441279962658882, decouple_loss:0.008627309463918209
loss_pred:0.027255162596702576, decouple_loss:0.009196719154715538
loss_pred:0.02653939090669155, decouple_loss:0.008538230322301388
Iteration: 443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690871238708496, gen p mean: -0.7470221519470215, mean p set: 0.44738900661468506
The modified gen p mean: 0.4480169117450714, gen p mean: -0.7511602640151978, mean p set: 0.4484971761703491
The modified gen p mean: 0.44759413599967957, gen p mean: -0.7505381107330322, mean p set: 0.44807443022727966
loss_pred:0.02611725777387619, decouple_loss:0.008884280920028687
loss_pred:0.025626705959439278, decouple_loss:0.008581433445215225
loss_pred:0.025685809552669525, decouple_loss:0.008361165411770344
Iteration: 444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477772116661072, gen p mean: -0.7490418553352356, mean p set: 0.4482575058937073
The modified gen p mean: 0.44689786434173584, gen p mean: -0.7411065101623535, mean p set: 0.44737815856933594
loss_pred:0.02706299163401127, decouple_loss:0.00833975337445736
loss_pred:0.02664710395038128, decouple_loss:0.008082578890025616
The modified gen p mean: 0.44629180431365967, gen p mean: -0.7401579022407532, mean p set: 0.44677209854125977
loss_pred:0.026840122416615486, decouple_loss:0.00884182658046484
Iteration: 445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466645419597626, gen p mean: -0.7475594878196716, mean p set: 0.44714486598968506
The modified gen p mean: 0.4490155577659607, gen p mean: -0.7508919835090637, mean p set: 0.4494958221912384
The modified gen p mean: 0.44655951857566833, gen p mean: -0.7381738424301147, mean p set: 0.44703981280326843
loss_pred:0.025987844914197922, decouple_loss:0.008680528961122036
loss_pred:0.026279408484697342, decouple_loss:0.008587625809013844
loss_pred:0.027177724987268448, decouple_loss:0.008621983230113983
Iteration: 446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468691945075989, gen p mean: -0.7281556129455566, mean p set: 0.4473494589328766The modified gen p mean: 0.4477654695510864, gen p mean: -0.7407252192497253, mean p set: 0.4482457637786865
The modified gen p mean: 0.4483056962490082, gen p mean: -0.7416417598724365, mean p set: 0.4487859904766083
loss_pred:0.028427833691239357, decouple_loss:0.008770497515797615
loss_pred:0.026155302301049232, decouple_loss:0.008315457962453365
loss_pred:0.02628128044307232, decouple_loss:0.008449041284620762
Iteration: 447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476301968097687, gen p mean: -0.7301338315010071, mean p set: 0.4481104910373688
The modified gen p mean: 0.4466789960861206, gen p mean: -0.721149206161499, mean p set: 0.4471592903137207
loss_pred:0.025650974363088608, decouple_loss:0.00802194606512785
The modified gen p mean: 0.4482465088367462, gen p mean: -0.7252373099327087, mean p set: 0.4487267732620239
loss_pred:0.026098746806383133, decouple_loss:0.008600604720413685
loss_pred:0.026568779721856117, decouple_loss:0.008547555655241013
Iteration: 448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688501954078674, gen p mean: -0.7154300808906555, mean p set: 0.44736534357070923
The modified gen p mean: 0.44851794838905334, gen p mean: -0.7218462824821472, mean p set: 0.44899824261665344
The modified gen p mean: 0.4476257264614105, gen p mean: -0.7187668681144714, mean p set: 0.4481060206890106
loss_pred:0.02636207453906536, decouple_loss:0.00833961647003889
loss_pred:0.027068931609392166, decouple_loss:0.008904460817575455
loss_pred:0.027353676036000252, decouple_loss:0.008472482673823833
Iteration: 449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755107164382935, gen p mean: -0.7199546694755554, mean p set: 0.44803139567375183
The modified gen p mean: 0.4472801983356476, gen p mean: -0.7223295569419861, mean p set: 0.4477604627609253
The modified gen p mean: 0.4466681480407715, gen p mean: -0.7253316044807434, mean p set: 0.4471484422683716
loss_pred:0.026904787868261337, decouple_loss:0.00824893917888403
loss_pred:0.026438195258378983, decouple_loss:0.008616384118795395
loss_pred:0.026364268735051155, decouple_loss:0.008833615109324455
Iteration: 450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687673449516296, gen p mean: -0.7372825741767883, mean p set: 0.4473569989204407
The modified gen p mean: 0.44703513383865356, gen p mean: -0.7348803281784058, mean p set: 0.44751542806625366
loss_pred:0.02586616575717926, decouple_loss:0.008307531476020813
loss_pred:0.02615223452448845, decouple_loss:0.00832792092114687
The modified gen p mean: 0.4480094909667969, gen p mean: -0.7383082509040833, mean p set: 0.4484897553920746
loss_pred:0.026544759050011635, decouple_loss:0.00836113654077053
2023-05-06 21:45:14 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7491958737373352, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7384228706359863, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7421871423721313, mean p set: 0.4500633478164673
loss_pred:0.02728799730539322, decouple_loss:0.008815157227218151
loss_pred:0.02582361176609993, decouple_loss:0.008336802944540977
loss_pred:0.02627544477581978, decouple_loss:0.008500761352479458
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026889896020293236, avg_mse: 0.032359540462493896
current test mse: 0.03236
Iteration: 451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468015134334564, gen p mean: -0.7355939149856567, mean p set: 0.44728177785873413
The modified gen p mean: 0.446621298789978, gen p mean: -0.7295737862586975, mean p set: 0.4471015930175781
loss_pred:0.027114711701869965, decouple_loss:0.008963990025222301
loss_pred:0.028295431286096573, decouple_loss:0.00821109302341938
The modified gen p mean: 0.44960805773735046, gen p mean: -0.7436055541038513, mean p set: 0.4500883221626282
loss_pred:0.025658296421170235, decouple_loss:0.008217503316700459
Iteration: 452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754254817962646, gen p mean: -0.7298907041549683, mean p set: 0.44802284240722656
The modified gen p mean: 0.4469279646873474, gen p mean: -0.7253158688545227, mean p set: 0.4474082589149475
The modified gen p mean: 0.4492480754852295, gen p mean: -0.7342540621757507, mean p set: 0.4497283697128296
loss_pred:0.026982463896274567, decouple_loss:0.008085999637842178
loss_pred:0.0278302151709795, decouple_loss:0.008210613392293453
loss_pred:0.025815486907958984, decouple_loss:0.008212722837924957
Iteration: 453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475826025009155, gen p mean: -0.7318848967552185, mean p set: 0.4480628967285156
The modified gen p mean: 0.44716107845306396, gen p mean: -0.7243587374687195, mean p set: 0.4476413428783417
The modified gen p mean: 0.4469491243362427, gen p mean: -0.7284080386161804, mean p set: 0.4474294185638428
loss_pred:0.026697367429733276, decouple_loss:0.008310786448419094
loss_pred:0.02671903185546398, decouple_loss:0.00794619508087635
loss_pred:0.02541947551071644, decouple_loss:0.008010933175683022
Iteration: 454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486178159713745, gen p mean: -0.7451565861701965, mean p set: 0.449098140001297
The modified gen p mean: 0.44842371344566345, gen p mean: -0.7389896512031555, mean p set: 0.44890403747558594
The modified gen p mean: 0.4475051760673523, gen p mean: -0.7360581755638123, mean p set: 0.44798544049263
loss_pred:0.025885432958602905, decouple_loss:0.008039033971726894loss_pred:0.027018725872039795, decouple_loss:0.008447115309536457
loss_pred:0.026822663843631744, decouple_loss:0.00819008145481348
Iteration: 455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772204756736755, gen p mean: -0.7371891140937805, mean p set: 0.44820234179496765
The modified gen p mean: 0.4470483064651489, gen p mean: -0.7414495348930359, mean p set: 0.44752857089042664
loss_pred:0.02667493373155594, decouple_loss:0.008581199683248997
loss_pred:0.02672717161476612, decouple_loss:0.00835123099386692
The modified gen p mean: 0.44634178280830383, gen p mean: -0.7314225435256958, mean p set: 0.4468221068382263
loss_pred:0.026346778497099876, decouple_loss:0.008868897333741188
Iteration: 456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468589127063751, gen p mean: -0.7296273112297058, mean p set: 0.44733917713165283
The modified gen p mean: 0.4469186067581177, gen p mean: -0.7301409244537354, mean p set: 0.4473989009857178
The modified gen p mean: 0.4466017484664917, gen p mean: -0.7318129539489746, mean p set: 0.4470820426940918
loss_pred:0.026552025228738785, decouple_loss:0.008089347742497921
loss_pred:0.027458347380161285, decouple_loss:0.008141443133354187
loss_pred:0.025813614949584007, decouple_loss:0.008352330885827541
Iteration: 457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464806616306305, gen p mean: -0.7368994355201721, mean p set: 0.4469609558582306
The modified gen p mean: 0.4463586211204529, gen p mean: -0.7284376621246338, mean p set: 0.4468388855457306
The modified gen p mean: 0.4473516047000885, gen p mean: -0.7338060140609741, mean p set: 0.4478318989276886
loss_pred:0.026033947244286537, decouple_loss:0.008175677619874477
loss_pred:0.02657315880060196, decouple_loss:0.008421785198152065
loss_pred:0.027514727786183357, decouple_loss:0.008429835550487041
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
NaN value num: 0
Iteration: 458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489613473415375, gen p mean: -0.74453204870224, mean p set: 0.4494416415691376
The modified gen p mean: 0.44767841696739197, gen p mean: -0.7508620023727417, mean p set: 0.44815871119499207
The modified gen p mean: 0.4479679763317108, gen p mean: -0.7480628490447998, mean p set: 0.4484483003616333
loss_pred:0.02741938643157482, decouple_loss:0.009083614684641361
loss_pred:0.02734294719994068, decouple_loss:0.00872848555445671
loss_pred:0.027839040383696556, decouple_loss:0.008712269365787506
Iteration: 459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476569592952728, gen p mean: -0.7514775395393372, mean p set: 0.4481372833251953
The modified gen p mean: 0.447792649269104, gen p mean: -0.7498883605003357, mean p set: 0.4482729434967041
The modified gen p mean: 0.44815874099731445, gen p mean: -0.7555239200592041, mean p set: 0.44863903522491455
loss_pred:0.02717001736164093, decouple_loss:0.009209742769598961loss_pred:0.02854061685502529, decouple_loss:0.00863494910299778
loss_pred:0.02709916979074478, decouple_loss:0.008562264032661915
Iteration: 460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470137655735016, gen p mean: -0.741047203540802, mean p set: 0.4474940896034241
The modified gen p mean: 0.4475163221359253, gen p mean: -0.7530947327613831, mean p set: 0.447996586561203
The modified gen p mean: 0.44846928119659424, gen p mean: -0.7453311085700989, mean p set: 0.44894954562187195
loss_pred:0.027895990759134293, decouple_loss:0.008853014558553696
loss_pred:0.027479618787765503, decouple_loss:0.00847008265554905
loss_pred:0.02705146186053753, decouple_loss:0.008572111837565899
2023-05-06 21:49:41 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7470636367797852, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.758395254611969, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7513102293014526, mean p set: 0.4500633478164673
loss_pred:0.025729600340127945, decouple_loss:0.008813593536615372
loss_pred:0.027100106701254845, decouple_loss:0.009309518150985241
loss_pred:0.026034429669380188, decouple_loss:0.009012702852487564
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026740308851003647, avg_mse: 0.032058656215667725
current test mse: 0.032059
Iteration: 461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901153445243835, gen p mean: -0.7597521543502808, mean p set: 0.44949179887771606
The modified gen p mean: 0.4469982385635376, gen p mean: -0.7534131407737732, mean p set: 0.4474784731864929
loss_pred:0.02709891088306904, decouple_loss:0.008911509066820145
loss_pred:0.02728099375963211, decouple_loss:0.008473120629787445
The modified gen p mean: 0.44849756360054016, gen p mean: -0.7537928223609924, mean p set: 0.44897785782814026
loss_pred:0.02702096477150917, decouple_loss:0.008796109817922115
Iteration: 462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729775190353394, gen p mean: -0.7620323300361633, mean p set: 0.44777801632881165
The modified gen p mean: 0.44850581884384155, gen p mean: -0.7612475752830505, mean p set: 0.44898611307144165
The modified gen p mean: 0.4474272131919861, gen p mean: -0.7614473104476929, mean p set: 0.4479075074195862
loss_pred:0.027075372636318207, decouple_loss:0.008340745232999325
loss_pred:0.02761763706803322, decouple_loss:0.008632561191916466
loss_pred:0.027439462020993233, decouple_loss:0.008529170416295528
Iteration: 463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448513001203537, gen p mean: -0.7678548097610474, mean p set: 0.4489932656288147
The modified gen p mean: 0.44838833808898926, gen p mean: -0.7580578923225403, mean p set: 0.44886863231658936
The modified gen p mean: 0.4480712413787842, gen p mean: -0.7671738266944885, mean p set: 0.44855156540870667
loss_pred:0.026868708431720734, decouple_loss:0.008368540555238724
loss_pred:0.02681400440633297, decouple_loss:0.008493447676301003
loss_pred:0.026364902034401894, decouple_loss:0.008274112828075886
Iteration: 464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744303822517395, gen p mean: -0.7447156310081482, mean p set: 0.44792336225509644
The modified gen p mean: 0.44760873913764954, gen p mean: -0.7543225884437561, mean p set: 0.44808903336524963
The modified gen p mean: 0.4482515752315521, gen p mean: -0.7476946115493774, mean p set: 0.4487318992614746
loss_pred:0.0270281620323658, decouple_loss:0.008475678972899914
loss_pred:0.026819556951522827, decouple_loss:0.00795232318341732
loss_pred:0.027726300060749054, decouple_loss:0.008260738104581833
Iteration: 465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488697052001953, gen p mean: -0.7463911175727844, mean p set: 0.449349969625473
The modified gen p mean: 0.44793978333473206, gen p mean: -0.7386114001274109, mean p set: 0.44842007756233215
loss_pred:0.025992263108491898, decouple_loss:0.008512354455888271
loss_pred:0.027310047298669815, decouple_loss:0.008267736993730068
The modified gen p mean: 0.4482339322566986, gen p mean: -0.7404237985610962, mean p set: 0.4487142562866211
loss_pred:0.02759585529565811, decouple_loss:0.008313300088047981
Iteration: 466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478950500488281, gen p mean: -0.7498012781143188, mean p set: 0.4483753740787506
The modified gen p mean: 0.4475323259830475, gen p mean: -0.7413321733474731, mean p set: 0.4480125904083252
The modified gen p mean: 0.4488667845726013, gen p mean: -0.7422254085540771, mean p set: 0.4493470788002014
loss_pred:0.02706076204776764, decouple_loss:0.008086459711194038loss_pred:0.025498565286397934, decouple_loss:0.008452747017145157
loss_pred:0.026913262903690338, decouple_loss:0.008368798531591892
Iteration: 467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767722487449646, gen p mean: -0.7572988867759705, mean p set: 0.44815748929977417
The modified gen p mean: 0.4473279118537903, gen p mean: -0.7548667192459106, mean p set: 0.4478082060813904
The modified gen p mean: 0.44805869460105896, gen p mean: -0.7527812123298645, mean p set: 0.44853898882865906
loss_pred:0.0273741427809, decouple_loss:0.008536062203347683
loss_pred:0.026895247399806976, decouple_loss:0.007875791750848293
loss_pred:0.02704770304262638, decouple_loss:0.008128007873892784
Iteration: 468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765704870224, gen p mean: -0.7647770047187805, mean p set: 0.4481373429298401
The modified gen p mean: 0.4473387598991394, gen p mean: -0.7512413859367371, mean p set: 0.4478190541267395
The modified gen p mean: 0.4489119350910187, gen p mean: -0.7600260376930237, mean p set: 0.4493922293186188
loss_pred:0.025785474106669426, decouple_loss:0.008120445534586906
loss_pred:0.027433333918452263, decouple_loss:0.0083139194175601
loss_pred:0.026746969670057297, decouple_loss:0.008193464018404484
Iteration: 469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475019872188568, gen p mean: -0.7522826790809631, mean p set: 0.4479822516441345
The modified gen p mean: 0.44846978783607483, gen p mean: -0.7494267821311951, mean p set: 0.44895002245903015
The modified gen p mean: 0.4476719796657562, gen p mean: -0.7568902373313904, mean p set: 0.4481523036956787
loss_pred:0.027231454849243164, decouple_loss:0.008096102625131607
loss_pred:0.027270028367638588, decouple_loss:0.008419650606811047
loss_pred:0.026616303250193596, decouple_loss:0.007891576737165451
Iteration: 470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795748591423035, gen p mean: -0.7424710392951965, mean p set: 0.44843775033950806
The modified gen p mean: 0.44755542278289795, gen p mean: -0.7548766136169434, mean p set: 0.44803571701049805
The modified gen p mean: 0.44819241762161255, gen p mean: -0.7389581203460693, mean p set: 0.44867268204689026
loss_pred:0.026986634358763695, decouple_loss:0.008241484872996807
loss_pred:0.026065539568662643, decouple_loss:0.008102602325379848
loss_pred:0.026953328400850296, decouple_loss:0.008362647145986557
2023-05-06 21:53:17 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7540102005004883, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7425426244735718, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7467901706695557, mean p set: 0.4500633478164673
loss_pred:0.027152618393301964, decouple_loss:0.008773431181907654
loss_pred:0.025850389152765274, decouple_loss:0.008552175015211105
loss_pred:0.02613009698688984, decouple_loss:0.008591286838054657
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026809651404619217, avg_mse: 0.03230171278119087
current test mse: 0.032302
Iteration: 471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774752855300903, gen p mean: -0.7478379607200623, mean p set: 0.4482278525829315
The modified gen p mean: 0.4480228126049042, gen p mean: -0.7409502267837524, mean p set: 0.4485030770301819
loss_pred:0.027013707906007767, decouple_loss:0.008105004206299782
loss_pred:0.02674633078277111, decouple_loss:0.008242814801633358
The modified gen p mean: 0.44839394092559814, gen p mean: -0.7462557554244995, mean p set: 0.44887417554855347
loss_pred:0.02615596540272236, decouple_loss:0.0077820937149226665
Iteration: 472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846266508102417, gen p mean: -0.7479751110076904, mean p set: 0.44894295930862427
The modified gen p mean: 0.4472518265247345, gen p mean: -0.7462419271469116, mean p set: 0.4477321207523346
The modified gen p mean: 0.4483610987663269, gen p mean: -0.7395827770233154, mean p set: 0.4488413631916046
loss_pred:0.02607356756925583, decouple_loss:0.00806170329451561
loss_pred:0.027836157009005547, decouple_loss:0.007690069265663624
loss_pred:0.027055852115154266, decouple_loss:0.007947000674903393
Iteration: 473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478349983692169, gen p mean: -0.7479988932609558, mean p set: 0.4483153223991394
The modified gen p mean: 0.44800907373428345, gen p mean: -0.7501522302627563, mean p set: 0.44848933815956116
The modified gen p mean: 0.44836854934692383, gen p mean: -0.7425066828727722, mean p set: 0.4488488733768463
loss_pred:0.02674158848822117, decouple_loss:0.008450465276837349
loss_pred:0.027015604078769684, decouple_loss:0.00857029389590025
loss_pred:0.027677344158291817, decouple_loss:0.00816962867975235
Iteration: 474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823214411735535, gen p mean: -0.749975323677063, mean p set: 0.44871240854263306
The modified gen p mean: 0.44846218824386597, gen p mean: -0.752699077129364, mean p set: 0.44894248247146606
The modified gen p mean: 0.44756460189819336, gen p mean: -0.7413626909255981, mean p set: 0.44804492592811584
loss_pred:0.027117013931274414, decouple_loss:0.00820752140134573
loss_pred:0.027721451595425606, decouple_loss:0.00831790640950203
loss_pred:0.02683182805776596, decouple_loss:0.008049331605434418
Iteration: 475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737720489501953, gen p mean: -0.7563491463661194, mean p set: 0.44785749912261963
The modified gen p mean: 0.44865739345550537, gen p mean: -0.7570750117301941, mean p set: 0.4491376578807831
loss_pred:0.027021663263440132, decouple_loss:0.0081186443567276
loss_pred:0.027913983911275864, decouple_loss:0.008380291983485222
The modified gen p mean: 0.44797036051750183, gen p mean: -0.7515966296195984, mean p set: 0.44845062494277954
loss_pred:0.026618069037795067, decouple_loss:0.007897314615547657
Iteration: 476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726303219795227, gen p mean: -0.7507979869842529, mean p set: 0.44774329662323
The modified gen p mean: 0.4474294185638428, gen p mean: -0.7590254545211792, mean p set: 0.4479096829891205
The modified gen p mean: 0.447767436504364, gen p mean: -0.7554453611373901, mean p set: 0.4482477605342865
loss_pred:0.027180029079318047, decouple_loss:0.008242852054536343
loss_pred:0.027437875047326088, decouple_loss:0.00808801781386137
loss_pred:0.02691981941461563, decouple_loss:0.008213484659790993
Iteration: 477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793790578842163, gen p mean: -0.7632641792297363, mean p set: 0.44841820001602173
The modified gen p mean: 0.4483512341976166, gen p mean: -0.7533208727836609, mean p set: 0.44883155822753906
The modified gen p mean: 0.4477936625480652, gen p mean: -0.7604159712791443, mean p set: 0.4482739567756653
loss_pred:0.027850061655044556, decouple_loss:0.007796437945216894loss_pred:0.025893086567521095, decouple_loss:0.008070791140198708
loss_pred:0.027140647172927856, decouple_loss:0.007678171154111624
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819068908691406, gen p mean: -0.7533408403396606, mean p set: 0.4486709535121918
The modified gen p mean: 0.44745805859565735, gen p mean: -0.7610306739807129, mean p set: 0.44793838262557983
The modified gen p mean: 0.4485373795032501, gen p mean: -0.744441568851471, mean p set: 0.4490176737308502
loss_pred:0.02613910287618637, decouple_loss:0.009507200680673122
loss_pred:0.02658199891448021, decouple_loss:0.00860587228089571
loss_pred:0.02526131086051464, decouple_loss:0.008851042948663235
Iteration: 479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776856899261475, gen p mean: -0.765480101108551, mean p set: 0.44824886322021484
The modified gen p mean: 0.44877997040748596, gen p mean: -0.7512551546096802, mean p set: 0.44926023483276367
The modified gen p mean: 0.44717198610305786, gen p mean: -0.7541096210479736, mean p set: 0.44765228033065796
loss_pred:0.026129845529794693, decouple_loss:0.008648916147649288
loss_pred:0.026525845751166344, decouple_loss:0.008079836145043373
loss_pred:0.026327569037675858, decouple_loss:0.008738764561712742
Iteration: 480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44652217626571655, gen p mean: -0.7577614188194275, mean p set: 0.44700247049331665
The modified gen p mean: 0.4465497136116028, gen p mean: -0.7522263526916504, mean p set: 0.4470299780368805
The modified gen p mean: 0.44788146018981934, gen p mean: -0.767154335975647, mean p set: 0.44836175441741943
loss_pred:0.026634950190782547, decouple_loss:0.00879362691193819loss_pred:0.026617158204317093, decouple_loss:0.008422509767115116
loss_pred:0.026000991463661194, decouple_loss:0.008837581612169743
2023-05-06 21:57:45 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7663586735725403, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7537686824798584, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.758284866809845, mean p set: 0.4500633478164673
loss_pred:0.027019508183002472, decouple_loss:0.008866597898304462
loss_pred:0.025797206908464432, decouple_loss:0.008700442500412464
loss_pred:0.02603635936975479, decouple_loss:0.008624929003417492
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026720892637968063, avg_mse: 0.032192256301641464
current test mse: 0.032192
Iteration: 481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480850398540497, gen p mean: -0.7567644715309143, mean p set: 0.4485653042793274
The modified gen p mean: 0.4474093019962311, gen p mean: -0.7549644112586975, mean p set: 0.4478895962238312
loss_pred:0.02537495829164982, decouple_loss:0.008906387723982334
loss_pred:0.025624707341194153, decouple_loss:0.00871971994638443
The modified gen p mean: 0.446719229221344, gen p mean: -0.7657747864723206, mean p set: 0.4471994936466217
loss_pred:0.026345474645495415, decouple_loss:0.008529871702194214
Iteration: 482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470941126346588, gen p mean: -0.7521565556526184, mean p set: 0.4475743770599365
The modified gen p mean: 0.44628435373306274, gen p mean: -0.7494938373565674, mean p set: 0.44676467776298523
The modified gen p mean: 0.44708889722824097, gen p mean: -0.7533114552497864, mean p set: 0.44756919145584106
loss_pred:0.027224073186516762, decouple_loss:0.008523541502654552
loss_pred:0.02527327835559845, decouple_loss:0.008629239164292812
loss_pred:0.027335241436958313, decouple_loss:0.008510504849255085
Iteration: 483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876283407211304, gen p mean: -0.7487744688987732, mean p set: 0.44924309849739075
The modified gen p mean: 0.4487041234970093, gen p mean: -0.7472925186157227, mean p set: 0.449184387922287
The modified gen p mean: 0.44747141003608704, gen p mean: -0.7607341408729553, mean p set: 0.44795170426368713
loss_pred:0.026850933209061623, decouple_loss:0.008648569695651531loss_pred:0.026018943637609482, decouple_loss:0.008186111226677895
loss_pred:0.026543058454990387, decouple_loss:0.008352480828762054
Iteration: 484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470864534378052, gen p mean: -0.7576814889907837, mean p set: 0.44756677746772766
The modified gen p mean: 0.44848257303237915, gen p mean: -0.7510873079299927, mean p set: 0.4489628076553345
The modified gen p mean: 0.44691380858421326, gen p mean: -0.7460334897041321, mean p set: 0.44739410281181335
loss_pred:0.026224859058856964, decouple_loss:0.00871866475790739
loss_pred:0.026111621409654617, decouple_loss:0.008297099731862545
loss_pred:0.027118107303977013, decouple_loss:0.00843634270131588
Iteration: 485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742703437805176, gen p mean: -0.7437511086463928, mean p set: 0.44790735840797424
The modified gen p mean: 0.44711393117904663, gen p mean: -0.7548694014549255, mean p set: 0.44759422540664673
The modified gen p mean: 0.4465150237083435, gen p mean: -0.7372466325759888, mean p set: 0.4469953179359436
loss_pred:0.025395171716809273, decouple_loss:0.008513600565493107loss_pred:0.026298021897673607, decouple_loss:0.008183160796761513
loss_pred:0.02568047121167183, decouple_loss:0.008157464675605297
Iteration: 486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489162862300873, gen p mean: -0.7418344020843506, mean p set: 0.4493965804576874
The modified gen p mean: 0.4479955732822418, gen p mean: -0.7633939981460571, mean p set: 0.4484758675098419
The modified gen p mean: 0.44692462682724, gen p mean: -0.7495874762535095, mean p set: 0.4474049210548401
loss_pred:0.025834033265709877, decouple_loss:0.007734272163361311
loss_pred:0.025908907875418663, decouple_loss:0.008211955428123474
loss_pred:0.02634204365313053, decouple_loss:0.00785622838884592
Iteration: 487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477558732032776, gen p mean: -0.7538050413131714, mean p set: 0.4482361972332001
The modified gen p mean: 0.44627127051353455, gen p mean: -0.7482879757881165, mean p set: 0.44675159454345703
The modified gen p mean: 0.4482991695404053, gen p mean: -0.7567708492279053, mean p set: 0.44877946376800537
loss_pred:0.026100607588887215, decouple_loss:0.008004991337656975
loss_pred:0.02675711177289486, decouple_loss:0.008115210570394993
loss_pred:0.024797458201646805, decouple_loss:0.008338000625371933
Iteration: 488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478999078273773, gen p mean: -0.750186026096344, mean p set: 0.4483802020549774
The modified gen p mean: 0.44629597663879395, gen p mean: -0.7576671242713928, mean p set: 0.44677630066871643
The modified gen p mean: 0.4479925334453583, gen p mean: -0.7523006200790405, mean p set: 0.44847285747528076
loss_pred:0.0261238943785429, decouple_loss:0.008012374863028526
loss_pred:0.026547664776444435, decouple_loss:0.008013295941054821
loss_pred:0.026155047118663788, decouple_loss:0.007837085984647274
Iteration: 489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468412697315216, gen p mean: -0.761959969997406, mean p set: 0.4473215639591217
The modified gen p mean: 0.4474468231201172, gen p mean: -0.7502608895301819, mean p set: 0.4479270875453949
The modified gen p mean: 0.4470463991165161, gen p mean: -0.7576767802238464, mean p set: 0.4475267231464386
loss_pred:0.026020120829343796, decouple_loss:0.007973122410476208
loss_pred:0.02516902983188629, decouple_loss:0.007495656609535217
loss_pred:0.026172632351517677, decouple_loss:0.007918973453342915
Iteration: 490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467009902000427, gen p mean: -0.7467692494392395, mean p set: 0.4471812844276428
The modified gen p mean: 0.4483893811702728, gen p mean: -0.739867091178894, mean p set: 0.4488696753978729
The modified gen p mean: 0.44784659147262573, gen p mean: -0.7473687529563904, mean p set: 0.44832685589790344
loss_pred:0.025683606043457985, decouple_loss:0.007906553335487843loss_pred:0.02611703984439373, decouple_loss:0.008119405247271061
loss_pred:0.025939656421542168, decouple_loss:0.00816510058939457
2023-05-06 22:01:21 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7605844736099243, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7487205266952515, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7534077167510986, mean p set: 0.4500633478164673
loss_pred:0.026872972026467323, decouple_loss:0.008087891153991222
loss_pred:0.025457413867115974, decouple_loss:0.007884899154305458
loss_pred:0.02577957510948181, decouple_loss:0.007935076020658016
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026435118168592453, avg_mse: 0.03174254670739174
current test mse: 0.031743
Iteration: 491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448162704706192, gen p mean: -0.7465780377388, mean p set: 0.4486429989337921
The modified gen p mean: 0.44752824306488037, gen p mean: -0.751056969165802, mean p set: 0.44800853729248047
loss_pred:0.026390165090560913, decouple_loss:0.007999218069016933
loss_pred:0.025715136900544167, decouple_loss:0.007882755249738693
The modified gen p mean: 0.4481365978717804, gen p mean: -0.7528261542320251, mean p set: 0.4486168920993805
loss_pred:0.025894440710544586, decouple_loss:0.007702475413680077
Iteration: 492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799885153770447, gen p mean: -0.77083820104599, mean p set: 0.4484791159629822
The modified gen p mean: 0.44724032282829285, gen p mean: -0.7667975425720215, mean p set: 0.44772061705589294
The modified gen p mean: 0.4480471909046173, gen p mean: -0.7517562508583069, mean p set: 0.4485274851322174
loss_pred:0.02553638629615307, decouple_loss:0.008057588711380959
loss_pred:0.026181219145655632, decouple_loss:0.00807869341224432
loss_pred:0.026584796607494354, decouple_loss:0.007668298669159412
Iteration: 493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472111463546753, gen p mean: -0.7544928193092346, mean p set: 0.4476914703845978
The modified gen p mean: 0.44750797748565674, gen p mean: -0.7585252523422241, mean p set: 0.44798827171325684
The modified gen p mean: 0.4472711682319641, gen p mean: -0.7581799626350403, mean p set: 0.4477514624595642
loss_pred:0.024941790848970413, decouple_loss:0.007602909579873085loss_pred:0.026121405884623528, decouple_loss:0.007471476681530476
loss_pred:0.025035254657268524, decouple_loss:0.007603263016790152
Iteration: 494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725826382637024, gen p mean: -0.7588794827461243, mean p set: 0.4477385878562927
The modified gen p mean: 0.44889262318611145, gen p mean: -0.7456868290901184, mean p set: 0.44937291741371155
The modified gen p mean: 0.44677913188934326, gen p mean: -0.7574824690818787, mean p set: 0.44725939631462097
loss_pred:0.02545802854001522, decouple_loss:0.007899895310401917
loss_pred:0.025876464322209358, decouple_loss:0.007668903097510338
loss_pred:0.025774909183382988, decouple_loss:0.007875210605561733
Iteration: 495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469221830368042, gen p mean: -0.7354860305786133, mean p set: 0.4474024176597595
The modified gen p mean: 0.44779109954833984, gen p mean: -0.7531449198722839, mean p set: 0.44827136397361755
The modified gen p mean: 0.4474667012691498, gen p mean: -0.7434160709381104, mean p set: 0.4479469656944275
loss_pred:0.02593494951725006, decouple_loss:0.007822995074093342
loss_pred:0.025635328143835068, decouple_loss:0.007932105101644993
loss_pred:0.025677120313048363, decouple_loss:0.007849309593439102
Iteration: 496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466283917427063, gen p mean: -0.7419453859329224, mean p set: 0.447108656167984
The modified gen p mean: 0.447630912065506, gen p mean: -0.747448742389679, mean p set: 0.4481112062931061
The modified gen p mean: 0.44681647419929504, gen p mean: -0.7529581785202026, mean p set: 0.44729676842689514
loss_pred:0.02526327595114708, decouple_loss:0.007635403890162706
loss_pred:0.026853609830141068, decouple_loss:0.007804012857377529
loss_pred:0.02589564211666584, decouple_loss:0.007606047205626965
Iteration: 497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473112225532532, gen p mean: -0.747588038444519, mean p set: 0.44779151678085327
The modified gen p mean: 0.4478975534439087, gen p mean: -0.7533305287361145, mean p set: 0.4483778774738312
The modified gen p mean: 0.4473222494125366, gen p mean: -0.7685661911964417, mean p set: 0.4478025436401367
loss_pred:0.02611630968749523, decouple_loss:0.00755029171705246
loss_pred:0.025919128209352493, decouple_loss:0.007504887413233519
loss_pred:0.025272348895668983, decouple_loss:0.0077458396553993225
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470362365245819, gen p mean: -0.7552421689033508, mean p set: 0.447516530752182
The modified gen p mean: 0.44697317481040955, gen p mean: -0.7560670375823975, mean p set: 0.44745346903800964
The modified gen p mean: 0.4473969638347626, gen p mean: -0.7591901421546936, mean p set: 0.44787725806236267
loss_pred:0.026492426171898842, decouple_loss:0.008172817528247833
loss_pred:0.02627258375287056, decouple_loss:0.008005203679203987
loss_pred:0.02681455761194229, decouple_loss:0.007926617749035358
Iteration: 499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480457603931427, gen p mean: -0.7680256366729736, mean p set: 0.4485260546207428
The modified gen p mean: 0.4454604387283325, gen p mean: -0.7660341858863831, mean p set: 0.44594070315361023
loss_pred:0.02663452737033367, decouple_loss:0.008115221746265888
loss_pred:0.025045469403266907, decouple_loss:0.00826528575271368
The modified gen p mean: 0.4464106261730194, gen p mean: -0.7711924314498901, mean p set: 0.4468908905982971
loss_pred:0.02552028000354767, decouple_loss:0.007920501753687859
Iteration: 500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447671502828598, gen p mean: -0.7679601311683655, mean p set: 0.44815176725387573
The modified gen p mean: 0.4487742781639099, gen p mean: -0.7672461271286011, mean p set: 0.4492546021938324
The modified gen p mean: 0.448159784078598, gen p mean: -0.7664762139320374, mean p set: 0.44864004850387573
loss_pred:0.02523030899465084, decouple_loss:0.008389009162783623loss_pred:0.025335950776934624, decouple_loss:0.008126913569867611
loss_pred:0.026443740352988243, decouple_loss:0.008065951988101006
2023-05-06 22:05:42 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7619038820266724, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7499893307685852, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7549930214881897, mean p set: 0.4500633478164673
loss_pred:0.026795286685228348, decouple_loss:0.0082660261541605
loss_pred:0.025532128289341927, decouple_loss:0.008166949264705181
loss_pred:0.025714224204421043, decouple_loss:0.00790216401219368
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026419466361403465, avg_mse: 0.031726736575365067
current test mse: 0.031727
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465515911579132, gen p mean: -0.757109522819519, mean p set: 0.4470318555831909
The modified gen p mean: 0.44644027948379517, gen p mean: -0.7631121277809143, mean p set: 0.44692057371139526
loss_pred:0.025491053238511086, decouple_loss:0.008499455638229847
loss_pred:0.026076212525367737, decouple_loss:0.008104651235044003
The modified gen p mean: 0.44786643981933594, gen p mean: -0.758165717124939, mean p set: 0.44834670424461365
loss_pred:0.026134276762604713, decouple_loss:0.007788552902638912
Iteration: 502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469894468784332, gen p mean: -0.7559083700180054, mean p set: 0.4474697411060333
The modified gen p mean: 0.4470798075199127, gen p mean: -0.7575688362121582, mean p set: 0.4475601017475128
The modified gen p mean: 0.446135550737381, gen p mean: -0.7467912435531616, mean p set: 0.4466158449649811
loss_pred:0.025386203080415726, decouple_loss:0.007916693575680256
loss_pred:0.02614082396030426, decouple_loss:0.008000708185136318
loss_pred:0.02520442195236683, decouple_loss:0.008001325652003288
Iteration: 503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465123116970062, gen p mean: -0.751937747001648, mean p set: 0.4469926357269287
The modified gen p mean: 0.4475334584712982, gen p mean: -0.7548867464065552, mean p set: 0.4480137526988983
The modified gen p mean: 0.4466874897480011, gen p mean: -0.7528124451637268, mean p set: 0.4471677839756012
loss_pred:0.026396289467811584, decouple_loss:0.007842506282031536
loss_pred:0.025487534701824188, decouple_loss:0.007736858446151018
loss_pred:0.02547507733106613, decouple_loss:0.0076698982156813145
Iteration: 504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876816868782043, gen p mean: -0.759612500667572, mean p set: 0.44924843311309814
The modified gen p mean: 0.44735249876976013, gen p mean: -0.7599109411239624, mean p set: 0.44783279299736023
The modified gen p mean: 0.44670215249061584, gen p mean: -0.7588306665420532, mean p set: 0.44718244671821594
loss_pred:0.02539488673210144, decouple_loss:0.00775832450017333
loss_pred:0.025541258975863457, decouple_loss:0.008089372888207436
loss_pred:0.025217343121767044, decouple_loss:0.0075276386924088
Iteration: 505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446504682302475, gen p mean: -0.7536576986312866, mean p set: 0.4469849467277527
The modified gen p mean: 0.4455268383026123, gen p mean: -0.7496335506439209, mean p set: 0.44600710272789
The modified gen p mean: 0.44737595319747925, gen p mean: -0.7566566467285156, mean p set: 0.44785624742507935
loss_pred:0.024995869025588036, decouple_loss:0.007724944967776537
loss_pred:0.026256194338202477, decouple_loss:0.007441990543156862
loss_pred:0.02504018135368824, decouple_loss:0.007765577174723148
Iteration: 506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469240605831146, gen p mean: -0.7530756592750549, mean p set: 0.44740432500839233
The modified gen p mean: 0.4474863111972809, gen p mean: -0.752541720867157, mean p set: 0.447966605424881
loss_pred:0.025079835206270218, decouple_loss:0.007666931487619877
loss_pred:0.025019166991114616, decouple_loss:0.0074894484132528305
The modified gen p mean: 0.4478625953197479, gen p mean: -0.7555456757545471, mean p set: 0.44834285974502563
loss_pred:0.026009855791926384, decouple_loss:0.008127774111926556
Iteration: 507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717806577682495, gen p mean: -0.7484405636787415, mean p set: 0.44765836000442505
The modified gen p mean: 0.44655051827430725, gen p mean: -0.7446188926696777, mean p set: 0.44703078269958496
The modified gen p mean: 0.4472388029098511, gen p mean: -0.7495887875556946, mean p set: 0.44771912693977356
loss_pred:0.025787636637687683, decouple_loss:0.007763313595205545
loss_pred:0.02614031732082367, decouple_loss:0.007840083912014961
loss_pred:0.02577095665037632, decouple_loss:0.007594291586428881
Iteration: 508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467405080795288, gen p mean: -0.7487870454788208, mean p set: 0.4472208023071289
The modified gen p mean: 0.44827088713645935, gen p mean: -0.7512376308441162, mean p set: 0.44875115156173706
The modified gen p mean: 0.4475764334201813, gen p mean: -0.754521369934082, mean p set: 0.448056697845459
loss_pred:0.02520739659667015, decouple_loss:0.008062298409640789
loss_pred:0.026412971317768097, decouple_loss:0.008025598712265491
loss_pred:0.02571369707584381, decouple_loss:0.00837903842329979
Iteration: 509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44630926847457886, gen p mean: -0.7502099275588989, mean p set: 0.44678959250450134
The modified gen p mean: 0.44768601655960083, gen p mean: -0.7450879216194153, mean p set: 0.4481663107872009
The modified gen p mean: 0.4471035897731781, gen p mean: -0.753873348236084, mean p set: 0.4475838840007782
loss_pred:0.02492871694266796, decouple_loss:0.008049828931689262
loss_pred:0.026240680366754532, decouple_loss:0.007820256985723972
loss_pred:0.025494886562228203, decouple_loss:0.00781835988163948
Iteration: 510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729194045066833, gen p mean: -0.7495083808898926, mean p set: 0.44777220487594604
The modified gen p mean: 0.4470297396183014, gen p mean: -0.7546014785766602, mean p set: 0.4475100040435791
The modified gen p mean: 0.44925034046173096, gen p mean: -0.7581291198730469, mean p set: 0.44973060488700867
loss_pred:0.025416916236281395, decouple_loss:0.007661489304155111
loss_pred:0.02478804625570774, decouple_loss:0.007331453263759613
loss_pred:0.025100814178586006, decouple_loss:0.007762325461953878
2023-05-06 22:09:18 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.760126531124115, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7494000196456909, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7536581158638, mean p set: 0.4500633478164673
loss_pred:0.02700033411383629, decouple_loss:0.007786817383021116
loss_pred:0.02576562762260437, decouple_loss:0.007733239326626062
loss_pred:0.025867415592074394, decouple_loss:0.0075211478397250175
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02659514546394348, avg_mse: 0.032168563455343246
current test mse: 0.032169
Iteration: 511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446891725063324, gen p mean: -0.7555325031280518, mean p set: 0.4473719894886017
The modified gen p mean: 0.4461483955383301, gen p mean: -0.7564079165458679, mean p set: 0.4466286599636078
loss_pred:0.025917084887623787, decouple_loss:0.007334195543080568
loss_pred:0.02485201694071293, decouple_loss:0.007442860398441553
The modified gen p mean: 0.4469175338745117, gen p mean: -0.7621795535087585, mean p set: 0.44739779829978943
loss_pred:0.025337858125567436, decouple_loss:0.007477352395653725
Iteration: 512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767534732818604, gen p mean: -0.7558192610740662, mean p set: 0.4481556713581085
The modified gen p mean: 0.44844359159469604, gen p mean: -0.7562180161476135, mean p set: 0.44892388582229614
The modified gen p mean: 0.4470198452472687, gen p mean: -0.7489420771598816, mean p set: 0.44750016927719116
loss_pred:0.02544325590133667, decouple_loss:0.00758904404938221
loss_pred:0.026955390349030495, decouple_loss:0.0077605051919817924
loss_pred:0.02644229866564274, decouple_loss:0.007615275215357542
Iteration: 513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839704036712646, gen p mean: -0.7533484697341919, mean p set: 0.44887736439704895
The modified gen p mean: 0.4468054175376892, gen p mean: -0.7520704865455627, mean p set: 0.4472857117652893
The modified gen p mean: 0.4466509521007538, gen p mean: -0.7587457895278931, mean p set: 0.4471312463283539
loss_pred:0.025777673348784447, decouple_loss:0.007323171943426132
loss_pred:0.025026433169841766, decouple_loss:0.007532734889537096
loss_pred:0.025050010532140732, decouple_loss:0.0074639166705310345
Iteration: 514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473675787448883, gen p mean: -0.7578069567680359, mean p set: 0.4478478729724884
The modified gen p mean: 0.44661250710487366, gen p mean: -0.7523563504219055, mean p set: 0.44709280133247375
loss_pred:0.02507493644952774, decouple_loss:0.007204046938568354
loss_pred:0.02520054019987583, decouple_loss:0.0075159999541938305
The modified gen p mean: 0.44797664880752563, gen p mean: -0.7569929361343384, mean p set: 0.44845691323280334
loss_pred:0.02611088939011097, decouple_loss:0.007602990604937077
Iteration: 515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455258548259735, gen p mean: -0.7585829496383667, mean p set: 0.4460061490535736
The modified gen p mean: 0.4466387629508972, gen p mean: -0.7589807510375977, mean p set: 0.4471190571784973
loss_pred:0.025323478505015373, decouple_loss:0.007508981041610241
loss_pred:0.024790260940790176, decouple_loss:0.007099824491888285
The modified gen p mean: 0.44645529985427856, gen p mean: -0.7630131840705872, mean p set: 0.44693562388420105
loss_pred:0.024879317730665207, decouple_loss:0.007468880154192448
Iteration: 516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738298654556274, gen p mean: -0.7569113969802856, mean p set: 0.44786328077316284
The modified gen p mean: 0.44916796684265137, gen p mean: -0.7599453926086426, mean p set: 0.44964826107025146
loss_pred:0.024599384516477585, decouple_loss:0.0071120006032288074
loss_pred:0.02495589479804039, decouple_loss:0.007280405145138502
The modified gen p mean: 0.44714266061782837, gen p mean: -0.7554647922515869, mean p set: 0.44762295484542847
loss_pred:0.02525760605931282, decouple_loss:0.007339072413742542
Iteration: 517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458523094654083, gen p mean: -0.7550962567329407, mean p set: 0.4463326036930084
The modified gen p mean: 0.44633230566978455, gen p mean: -0.7511488199234009, mean p set: 0.44681257009506226
The modified gen p mean: 0.44781818985939026, gen p mean: -0.7548162341117859, mean p set: 0.44829845428466797
loss_pred:0.024984780699014664, decouple_loss:0.007371199782937765loss_pred:0.024494903162121773, decouple_loss:0.007166368421167135
loss_pred:0.02487850748002529, decouple_loss:0.00700450548902154
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
NaN value num: 0
Iteration: 518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795945286750793, gen p mean: -0.7516794800758362, mean p set: 0.44843971729278564
The modified gen p mean: 0.4463266134262085, gen p mean: -0.7518849968910217, mean p set: 0.4468069076538086
The modified gen p mean: 0.44738316535949707, gen p mean: -0.7593528032302856, mean p set: 0.44786348938941956
loss_pred:0.025826891884207726, decouple_loss:0.007493053562939167
loss_pred:0.026658503338694572, decouple_loss:0.007950863800942898
loss_pred:0.027309758588671684, decouple_loss:0.007933847606182098
Iteration: 519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886574149131775, gen p mean: -0.7569921016693115, mean p set: 0.44934606552124023
The modified gen p mean: 0.4485021233558655, gen p mean: -0.7553794384002686, mean p set: 0.4489823877811432
The modified gen p mean: 0.44698894023895264, gen p mean: -0.7521165013313293, mean p set: 0.4474692642688751
loss_pred:0.027660826221108437, decouple_loss:0.008060479536652565
loss_pred:0.026695752516388893, decouple_loss:0.0075744385831058025
loss_pred:0.02815656177699566, decouple_loss:0.007377002853900194
Iteration: 520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797372817993164, gen p mean: -0.7558547258377075, mean p set: 0.4484540522098541
The modified gen p mean: 0.44778120517730713, gen p mean: -0.7521392107009888, mean p set: 0.4482615292072296
The modified gen p mean: 0.4475124478340149, gen p mean: -0.7563064694404602, mean p set: 0.447992742061615
loss_pred:0.026341015473008156, decouple_loss:0.00763985700905323
loss_pred:0.02721453085541725, decouple_loss:0.0075630126520991325
loss_pred:0.028047606348991394, decouple_loss:0.007940222509205341
2023-05-06 22:13:54 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7630017399787903, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7517209649085999, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7564915418624878, mean p set: 0.4500633478164673
loss_pred:0.02694803476333618, decouple_loss:0.008318155072629452
loss_pred:0.02560841105878353, decouple_loss:0.008055736310780048
loss_pred:0.025821754708886147, decouple_loss:0.008063595741987228
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026533357799053192, avg_mse: 0.032017938792705536
current test mse: 0.032018
Iteration: 521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499262869358063, gen p mean: -0.7701684236526489, mean p set: 0.45040658116340637
The modified gen p mean: 0.4475911557674408, gen p mean: -0.7560028433799744, mean p set: 0.4480714499950409
loss_pred:0.026599515229463577, decouple_loss:0.008249182254076004
loss_pred:0.02679792046546936, decouple_loss:0.007669331040233374
The modified gen p mean: 0.4479115903377533, gen p mean: -0.7580852508544922, mean p set: 0.448391854763031
loss_pred:0.02753032185137272, decouple_loss:0.007840747945010662
Iteration: 522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677734375, gen p mean: -0.7615044713020325, mean p set: 0.4472576081752777
The modified gen p mean: 0.4469698369503021, gen p mean: -0.7636205554008484, mean p set: 0.44745010137557983
The modified gen p mean: 0.44771096110343933, gen p mean: -0.7699851989746094, mean p set: 0.44819125533103943
loss_pred:0.02613529935479164, decouple_loss:0.00777317862957716
loss_pred:0.02879025787115097, decouple_loss:0.007630506996065378
loss_pred:0.025249848142266273, decouple_loss:0.008070556446909904
Iteration: 523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465520977973938, gen p mean: -0.7564025521278381, mean p set: 0.4470323920249939
The modified gen p mean: 0.4474947154521942, gen p mean: -0.7570327520370483, mean p set: 0.4479750096797943
The modified gen p mean: 0.44953829050064087, gen p mean: -0.7718520760536194, mean p set: 0.4500185549259186
loss_pred:0.026985665783286095, decouple_loss:0.007534557953476906
loss_pred:0.02766459621489048, decouple_loss:0.0074284877628088
loss_pred:0.02646639570593834, decouple_loss:0.007955184206366539
Iteration: 524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757428765296936, gen p mean: -0.7614672780036926, mean p set: 0.44805458188056946
The modified gen p mean: 0.44763636589050293, gen p mean: -0.7526692152023315, mean p set: 0.448116660118103
The modified gen p mean: 0.4476429224014282, gen p mean: -0.7602235078811646, mean p set: 0.4481232166290283
loss_pred:0.025433199480175972, decouple_loss:0.007564316038042307
loss_pred:0.028011390939354897, decouple_loss:0.007394015323370695
loss_pred:0.0257942583411932, decouple_loss:0.007478972431272268
Iteration: 525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806918501853943, gen p mean: -0.759590208530426, mean p set: 0.4485495090484619
The modified gen p mean: 0.44669774174690247, gen p mean: -0.7558944225311279, mean p set: 0.44717806577682495
loss_pred:0.028511911630630493, decouple_loss:0.00748955924063921
loss_pred:0.027261829003691673, decouple_loss:0.00709537323564291
The modified gen p mean: 0.44706299901008606, gen p mean: -0.7546173930168152, mean p set: 0.44754326343536377
loss_pred:0.02697901986539364, decouple_loss:0.007226247806102037
Iteration: 526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479468762874603, gen p mean: -0.759085476398468, mean p set: 0.4484272003173828
The modified gen p mean: 0.4468787610530853, gen p mean: -0.7628763914108276, mean p set: 0.4473590552806854
loss_pred:0.027994172647595406, decouple_loss:0.00774502893909812
loss_pred:0.026245083659887314, decouple_loss:0.007648501545190811
The modified gen p mean: 0.4472706615924835, gen p mean: -0.7621011137962341, mean p set: 0.4477509558200836
loss_pred:0.028728563338518143, decouple_loss:0.007356835529208183
Iteration: 527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478965699672699, gen p mean: -0.7510755658149719, mean p set: 0.44837686419487
The modified gen p mean: 0.446316123008728, gen p mean: -0.7436985969543457, mean p set: 0.4467964172363281
The modified gen p mean: 0.44763433933258057, gen p mean: -0.7437537908554077, mean p set: 0.44811463356018066
loss_pred:0.027664421126246452, decouple_loss:0.007599874399602413
loss_pred:0.026544561609625816, decouple_loss:0.007842164486646652
loss_pred:0.028017602860927582, decouple_loss:0.007379813119769096
Iteration: 528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462946653366089, gen p mean: -0.7494893074035645, mean p set: 0.446774959564209
The modified gen p mean: 0.44862696528434753, gen p mean: -0.7643983364105225, mean p set: 0.44910722970962524
The modified gen p mean: 0.44722703099250793, gen p mean: -0.7544752359390259, mean p set: 0.44770732522010803
loss_pred:0.026298338547348976, decouple_loss:0.008036725223064423loss_pred:0.026778731495141983, decouple_loss:0.00745858158916235
loss_pred:0.02573561482131481, decouple_loss:0.0078359954059124
Iteration: 529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465983510017395, gen p mean: -0.754012942314148, mean p set: 0.4470786452293396
The modified gen p mean: 0.44697925448417664, gen p mean: -0.7602530121803284, mean p set: 0.4474595785140991
The modified gen p mean: 0.44859182834625244, gen p mean: -0.7568165063858032, mean p set: 0.44907209277153015
loss_pred:0.0251359473913908, decouple_loss:0.007595354691147804loss_pred:0.027215393260121346, decouple_loss:0.007069870829582214
loss_pred:0.02687953971326351, decouple_loss:0.007406352087855339
Iteration: 530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465072751045227, gen p mean: -0.7427034378051758, mean p set: 0.4469875395298004
The modified gen p mean: 0.4469059705734253, gen p mean: -0.7533964514732361, mean p set: 0.447386234998703
The modified gen p mean: 0.44695374369621277, gen p mean: -0.7536136507987976, mean p set: 0.44743403792381287
loss_pred:0.02684532105922699, decouple_loss:0.007616908755153418
loss_pred:0.026295555755496025, decouple_loss:0.007478594314306974
loss_pred:0.028320657089352608, decouple_loss:0.007312283851206303
2023-05-06 22:17:31 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7559927105903625, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7447624206542969, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7492637634277344, mean p set: 0.4500633478164673
loss_pred:0.02694200538098812, decouple_loss:0.007886353880167007
loss_pred:0.02566477656364441, decouple_loss:0.007687598932534456
loss_pred:0.025876836851239204, decouple_loss:0.007658552378416061
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026548415422439575, avg_mse: 0.03211088106036186
current test mse: 0.032111
Iteration: 531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478977620601654, gen p mean: -0.7535741329193115, mean p set: 0.4483780562877655
The modified gen p mean: 0.44661226868629456, gen p mean: -0.7481514811515808, mean p set: 0.44709256291389465
loss_pred:0.02623203955590725, decouple_loss:0.007661640178412199
loss_pred:0.02662583999335766, decouple_loss:0.007079190108925104
The modified gen p mean: 0.4466244876384735, gen p mean: -0.752585232257843, mean p set: 0.447104811668396
loss_pred:0.025777151808142662, decouple_loss:0.007089419290423393
Iteration: 532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860216975212097, gen p mean: -0.7531285285949707, mean p set: 0.44908249378204346
The modified gen p mean: 0.44730210304260254, gen p mean: -0.7454420328140259, mean p set: 0.44778236746788025
The modified gen p mean: 0.44684481620788574, gen p mean: -0.750216543674469, mean p set: 0.44732505083084106
loss_pred:0.026475844904780388, decouple_loss:0.007944260723888874
loss_pred:0.02691332995891571, decouple_loss:0.007197161670774221
loss_pred:0.026534080505371094, decouple_loss:0.0073317294009029865
Iteration: 533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468751847743988, gen p mean: -0.7479044198989868, mean p set: 0.4473554790019989
The modified gen p mean: 0.44634950160980225, gen p mean: -0.7474271655082703, mean p set: 0.44682982563972473
The modified gen p mean: 0.44866013526916504, gen p mean: -0.7505426406860352, mean p set: 0.44914042949676514
loss_pred:0.025324881076812744, decouple_loss:0.007223877124488354
loss_pred:0.02519364468753338, decouple_loss:0.007090735714882612
loss_pred:0.02739953063428402, decouple_loss:0.0073425015434622765
Iteration: 534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474639296531677, gen p mean: -0.7499522566795349, mean p set: 0.4479442238807678
The modified gen p mean: 0.4490973949432373, gen p mean: -0.7531819343566895, mean p set: 0.4495777189731598
The modified gen p mean: 0.44926369190216064, gen p mean: -0.7572857141494751, mean p set: 0.44974398612976074
loss_pred:0.025828491896390915, decouple_loss:0.0071230558678507805
loss_pred:0.02760930173099041, decouple_loss:0.007548692170530558
loss_pred:0.026379354298114777, decouple_loss:0.007877519354224205
Iteration: 535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480290412902832, gen p mean: -0.7501956820487976, mean p set: 0.4485093653202057
The modified gen p mean: 0.44776150584220886, gen p mean: -0.7529702186584473, mean p set: 0.4482417702674866
The modified gen p mean: 0.44768568873405457, gen p mean: -0.7474921941757202, mean p set: 0.44816598296165466
loss_pred:0.027918104082345963, decouple_loss:0.007171210367232561
loss_pred:0.02679852768778801, decouple_loss:0.007379141170531511
loss_pred:0.027926333248615265, decouple_loss:0.0071041034534573555
Iteration: 536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469502866268158, gen p mean: -0.7495669722557068, mean p set: 0.4474305510520935
The modified gen p mean: 0.4479251205921173, gen p mean: -0.7585048675537109, mean p set: 0.4484054148197174
loss_pred:0.02648375928401947, decouple_loss:0.007460465654730797
loss_pred:0.02758621796965599, decouple_loss:0.0074600037187337875
The modified gen p mean: 0.4468501806259155, gen p mean: -0.7532685995101929, mean p set: 0.4473304748535156
loss_pred:0.026690201833844185, decouple_loss:0.007310820743441582
Iteration: 537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793370366096497, gen p mean: -0.7608943581581116, mean p set: 0.44841399788856506
The modified gen p mean: 0.4478081166744232, gen p mean: -0.7651854753494263, mean p set: 0.4482884109020233
The modified gen p mean: 0.4474125802516937, gen p mean: -0.7564094066619873, mean p set: 0.4478928744792938
loss_pred:0.02718382515013218, decouple_loss:0.007150689605623484
loss_pred:0.02570396475493908, decouple_loss:0.007500628009438515
loss_pred:0.02729315496981144, decouple_loss:0.006989717483520508
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463063180446625, gen p mean: -0.7619844675064087, mean p set: 0.44678664207458496
The modified gen p mean: 0.44726693630218506, gen p mean: -0.7670527100563049, mean p set: 0.44774720072746277
The modified gen p mean: 0.4481313228607178, gen p mean: -0.7699275612831116, mean p set: 0.4486115872859955
loss_pred:0.02593694068491459, decouple_loss:0.008091800846159458
loss_pred:0.027165135368704796, decouple_loss:0.007713938131928444
loss_pred:0.02615065686404705, decouple_loss:0.007720951922237873
Iteration: 539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471006393432617, gen p mean: -0.7584362030029297, mean p set: 0.44758090376853943
The modified gen p mean: 0.44752684235572815, gen p mean: -0.7619400024414062, mean p set: 0.44800713658332825
The modified gen p mean: 0.4485894441604614, gen p mean: -0.7679792642593384, mean p set: 0.4490697383880615
loss_pred:0.02689543180167675, decouple_loss:0.007806889247149229
loss_pred:0.026546213775873184, decouple_loss:0.007925739511847496
loss_pred:0.025510193780064583, decouple_loss:0.008366377092897892
Iteration: 540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785475730895996, gen p mean: -0.7530587911605835, mean p set: 0.44833505153656006
The modified gen p mean: 0.44698387384414673, gen p mean: -0.7449018359184265, mean p set: 0.4474641680717468
The modified gen p mean: 0.4476320147514343, gen p mean: -0.758998692035675, mean p set: 0.4481123387813568
loss_pred:0.026691313832998276, decouple_loss:0.00877794623374939
loss_pred:0.027997156605124474, decouple_loss:0.007993004284799099
loss_pred:0.025586530566215515, decouple_loss:0.008010750636458397
2023-05-06 22:22:09 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7659161686897278, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7535189390182495, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7580908536911011, mean p set: 0.4500633478164673
loss_pred:0.026838064193725586, decouple_loss:0.007800317369401455
loss_pred:0.025578361004590988, decouple_loss:0.007797550410032272
loss_pred:0.025835860520601273, decouple_loss:0.007692020386457443
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026472261175513268, avg_mse: 0.03201950713992119
current test mse: 0.03202
Iteration: 541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477413594722748, gen p mean: -0.7562112808227539, mean p set: 0.4482216238975525
The modified gen p mean: 0.4462769329547882, gen p mean: -0.7609795928001404, mean p set: 0.4467572569847107
loss_pred:0.027453461661934853, decouple_loss:0.0075417812913656235
loss_pred:0.025417283177375793, decouple_loss:0.007637770380824804
The modified gen p mean: 0.44758734107017517, gen p mean: -0.7456470727920532, mean p set: 0.44806763529777527
loss_pred:0.02689388580620289, decouple_loss:0.008328523486852646
Iteration: 542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745901226997375, gen p mean: -0.7596708536148071, mean p set: 0.44793930649757385
The modified gen p mean: 0.4471185505390167, gen p mean: -0.7585683465003967, mean p set: 0.4475988745689392
The modified gen p mean: 0.44719043374061584, gen p mean: -0.7699163556098938, mean p set: 0.44767072796821594
loss_pred:0.026419932022690773, decouple_loss:0.007750501856207848loss_pred:0.026846032589673996, decouple_loss:0.0075965626165270805
loss_pred:0.026955310255289078, decouple_loss:0.0076768225990235806
Iteration: 543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654354453086853, gen p mean: -0.766145646572113, mean p set: 0.44702383875846863The modified gen p mean: 0.44719043374061584, gen p mean: -0.7577331066131592, mean p set: 0.44767072796821594
loss_pred:0.027593739330768585, decouple_loss:0.00788484513759613loss_pred:0.026019912213087082, decouple_loss:0.007648829836398363
The modified gen p mean: 0.4474899470806122, gen p mean: -0.767092227935791, mean p set: 0.4479702413082123
loss_pred:0.025701720267534256, decouple_loss:0.00849955528974533
Iteration: 544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772130250930786, gen p mean: -0.7637024521827698, mean p set: 0.44820162653923035
The modified gen p mean: 0.44858667254447937, gen p mean: -0.7668782472610474, mean p set: 0.4490669369697571
The modified gen p mean: 0.44735559821128845, gen p mean: -0.7648451328277588, mean p set: 0.44783589243888855
loss_pred:0.027482908219099045, decouple_loss:0.007419410161674023
loss_pred:0.026000218465924263, decouple_loss:0.007816847413778305
loss_pred:0.02574756368994713, decouple_loss:0.007568945176899433
Iteration: 545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691622257232666, gen p mean: -0.7532123327255249, mean p set: 0.44739648699760437
The modified gen p mean: 0.4475241005420685, gen p mean: -0.7667421698570251, mean p set: 0.4480043649673462
The modified gen p mean: 0.44779273867607117, gen p mean: -0.7695205211639404, mean p set: 0.4482730031013489
loss_pred:0.027530910447239876, decouple_loss:0.007735864259302616
loss_pred:0.026898279786109924, decouple_loss:0.007316851057112217
loss_pred:0.025836555287241936, decouple_loss:0.007413314189761877
Iteration: 546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471842646598816, gen p mean: -0.7656933069229126, mean p set: 0.4476645588874817
The modified gen p mean: 0.44759684801101685, gen p mean: -0.7677916288375854, mean p set: 0.44807714223861694
loss_pred:0.02695584110915661, decouple_loss:0.007369644939899445
loss_pred:0.026247788220643997, decouple_loss:0.007655493449419737
The modified gen p mean: 0.44744566082954407, gen p mean: -0.7684220671653748, mean p set: 0.44792598485946655
loss_pred:0.026252491399645805, decouple_loss:0.007459504064172506
Iteration: 547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478148818016052, gen p mean: -0.7592610716819763, mean p set: 0.4482952058315277
The modified gen p mean: 0.44733738899230957, gen p mean: -0.752703845500946, mean p set: 0.44781771302223206
The modified gen p mean: 0.4473910927772522, gen p mean: -0.7580420970916748, mean p set: 0.4478713572025299
loss_pred:0.026486314833164215, decouple_loss:0.0075528426095843315
loss_pred:0.02692287042737007, decouple_loss:0.007900271564722061
loss_pred:0.02764676697552204, decouple_loss:0.007618794683367014
Iteration: 548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479087293148041, gen p mean: -0.7566322684288025, mean p set: 0.4483889639377594
The modified gen p mean: 0.4483296573162079, gen p mean: -0.7599416971206665, mean p set: 0.4488099217414856
The modified gen p mean: 0.44729742407798767, gen p mean: -0.7488886713981628, mean p set: 0.44777771830558777
loss_pred:0.02602308802306652, decouple_loss:0.007395198103040457
loss_pred:0.02749749645590782, decouple_loss:0.007443387061357498
loss_pred:0.026650331914424896, decouple_loss:0.007613501511514187
Iteration: 549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476644992828369, gen p mean: -0.7462755441665649, mean p set: 0.4481448233127594
The modified gen p mean: 0.44800665974617004, gen p mean: -0.7585449814796448, mean p set: 0.44848695397377014
The modified gen p mean: 0.4480352997779846, gen p mean: -0.762749433517456, mean p set: 0.4485156238079071
loss_pred:0.02653232030570507, decouple_loss:0.00754191679880023loss_pred:0.026546230539679527, decouple_loss:0.007421815302222967
loss_pred:0.024742279201745987, decouple_loss:0.00745035894215107
Iteration: 550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779056310653687, gen p mean: -0.7575224041938782, mean p set: 0.4482708275318146
The modified gen p mean: 0.4473235309123993, gen p mean: -0.7593536376953125, mean p set: 0.4478038251399994
The modified gen p mean: 0.4472975432872772, gen p mean: -0.7597625255584717, mean p set: 0.4477778375148773
loss_pred:0.026206711307168007, decouple_loss:0.007635726593434811loss_pred:0.027342095971107483, decouple_loss:0.00737080629914999
loss_pred:0.02529924176633358, decouple_loss:0.007227237801998854
2023-05-06 22:25:46 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.759338915348053, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7470957040786743, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7516884803771973, mean p set: 0.4500633478164673
loss_pred:0.026487288996577263, decouple_loss:0.0074120028875768185
loss_pred:0.025267237797379494, decouple_loss:0.007391379214823246
loss_pred:0.025523170828819275, decouple_loss:0.007218626327812672
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02612626552581787, avg_mse: 0.03149346262216568
current test mse: 0.031493
Iteration: 551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476095139980316, gen p mean: -0.7590652108192444, mean p set: 0.4480897784233093
The modified gen p mean: 0.4471528232097626, gen p mean: -0.7550565600395203, mean p set: 0.44763314723968506
loss_pred:0.026179784908890724, decouple_loss:0.007546081207692623
loss_pred:0.02684873342514038, decouple_loss:0.007509155198931694
The modified gen p mean: 0.44701895117759705, gen p mean: -0.7422405481338501, mean p set: 0.44749921560287476
loss_pred:0.02727825939655304, decouple_loss:0.007340324576944113
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475800395011902, gen p mean: -0.7478747963905334, mean p set: 0.4480603337287903
The modified gen p mean: 0.4477626085281372, gen p mean: -0.7467104196548462, mean p set: 0.4482428729534149
The modified gen p mean: 0.4469631612300873, gen p mean: -0.7561109066009521, mean p set: 0.447443425655365
loss_pred:0.02628055401146412, decouple_loss:0.007287451531738043
loss_pred:0.025989187881350517, decouple_loss:0.007423239294439554
loss_pred:0.026094801723957062, decouple_loss:0.007100320421159267
Iteration: 553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475264549255371, gen p mean: -0.7571462988853455, mean p set: 0.4480067491531372
The modified gen p mean: 0.44776326417922974, gen p mean: -0.7547591924667358, mean p set: 0.44824355840682983
The modified gen p mean: 0.44677072763442993, gen p mean: -0.7543458342552185, mean p set: 0.44725102186203003
loss_pred:0.026628706604242325, decouple_loss:0.0073714531026780605
loss_pred:0.02649589627981186, decouple_loss:0.007152669597417116
loss_pred:0.0256912000477314, decouple_loss:0.00704922154545784
Iteration: 554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44601359963417053, gen p mean: -0.7580547332763672, mean p set: 0.44649389386177063
The modified gen p mean: 0.44707900285720825, gen p mean: -0.7509840726852417, mean p set: 0.44755926728248596
The modified gen p mean: 0.4471803307533264, gen p mean: -0.7521430850028992, mean p set: 0.4476606547832489
loss_pred:0.025152945891022682, decouple_loss:0.00696687214076519
loss_pred:0.02708241529762745, decouple_loss:0.0074317315593361855
loss_pred:0.027106115594506264, decouple_loss:0.007051315624266863
Iteration: 555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476197361946106, gen p mean: -0.7531370520591736, mean p set: 0.4481000304222107
The modified gen p mean: 0.447537362575531, gen p mean: -0.7618604302406311, mean p set: 0.4480176270008087
loss_pred:0.02643628790974617, decouple_loss:0.007116334512829781
loss_pred:0.026499243453145027, decouple_loss:0.007318662013858557
The modified gen p mean: 0.44665277004241943, gen p mean: -0.7640042304992676, mean p set: 0.44713303446769714
loss_pred:0.02533796988427639, decouple_loss:0.006893533281981945
Iteration: 556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723114371299744, gen p mean: -0.7523007392883301, mean p set: 0.44771143794059753
The modified gen p mean: 0.4476643204689026, gen p mean: -0.7683642506599426, mean p set: 0.4481445848941803
loss_pred:0.02667505294084549, decouple_loss:0.007041594944894314
loss_pred:0.025896798819303513, decouple_loss:0.006811307277530432
The modified gen p mean: 0.44720014929771423, gen p mean: -0.764878511428833, mean p set: 0.44768041372299194
loss_pred:0.025305170565843582, decouple_loss:0.007098955102264881
Iteration: 557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681575894355774, gen p mean: -0.7658851742744446, mean p set: 0.44729599356651306
The modified gen p mean: 0.44814151525497437, gen p mean: -0.7665500044822693, mean p set: 0.4486217796802521
The modified gen p mean: 0.44755586981773376, gen p mean: -0.7670204043388367, mean p set: 0.4480361342430115
loss_pred:0.02534441463649273, decouple_loss:0.006903426721692085
loss_pred:0.02614435739815235, decouple_loss:0.006930898409336805
loss_pred:0.026802577078342438, decouple_loss:0.00720474636182189
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44623613357543945, gen p mean: -0.7602245211601257, mean p set: 0.44671642780303955
The modified gen p mean: 0.4468082785606384, gen p mean: -0.7794991135597229, mean p set: 0.4472885727882385
The modified gen p mean: 0.44713956117630005, gen p mean: -0.7616186738014221, mean p set: 0.44761988520622253
loss_pred:0.02618585154414177, decouple_loss:0.008179980330169201
loss_pred:0.02583611197769642, decouple_loss:0.006975107826292515
loss_pred:0.025940554216504097, decouple_loss:0.007132330443710089
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930770993232727, gen p mean: -0.7688963413238525, mean p set: 0.449787974357605
The modified gen p mean: 0.4473239481449127, gen p mean: -0.7654577493667603, mean p set: 0.44780421257019043
The modified gen p mean: 0.44861432909965515, gen p mean: -0.7591871619224548, mean p set: 0.44909462332725525
loss_pred:0.02556542679667473, decouple_loss:0.007579137105494738
loss_pred:0.025676747784018517, decouple_loss:0.007012852467596531
loss_pred:0.025636233389377594, decouple_loss:0.0074346475303173065
Iteration: 560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468348026275635, gen p mean: -0.7769886255264282, mean p set: 0.4473150670528412
The modified gen p mean: 0.448018342256546, gen p mean: -0.7719226479530334, mean p set: 0.4484986364841461
The modified gen p mean: 0.4480317533016205, gen p mean: -0.7656239867210388, mean p set: 0.4485120475292206
loss_pred:0.02538369782269001, decouple_loss:0.007898268289864063
loss_pred:0.025596920400857925, decouple_loss:0.007256286218762398
loss_pred:0.026856372132897377, decouple_loss:0.0072608329355716705
2023-05-06 22:30:28 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7704416513442993, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7586522102355957, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7633140683174133, mean p set: 0.4500633478164673
loss_pred:0.026503849774599075, decouple_loss:0.007201761938631535
loss_pred:0.025349562987685204, decouple_loss:0.0069931913167238235
loss_pred:0.025547843426465988, decouple_loss:0.006918813101947308
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026152316480875015, avg_mse: 0.03154626861214638
current test mse: 0.031546
Iteration: 561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753408432006836, gen p mean: -0.7567864060401917, mean p set: 0.44801437854766846
The modified gen p mean: 0.4470822811126709, gen p mean: -0.7705090045928955, mean p set: 0.447562575340271
loss_pred:0.025749873369932175, decouple_loss:0.007137122564017773
loss_pred:0.025716682896018028, decouple_loss:0.006918027531355619
The modified gen p mean: 0.4474954903125763, gen p mean: -0.7655835151672363, mean p set: 0.4479758143424988
loss_pred:0.02508077397942543, decouple_loss:0.006933133117854595
Iteration: 562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773584604263306, gen p mean: -0.7780336737632751, mean p set: 0.44821611046791077
The modified gen p mean: 0.44697925448417664, gen p mean: -0.7690293788909912, mean p set: 0.44745954871177673
The modified gen p mean: 0.4471273124217987, gen p mean: -0.772774338722229, mean p set: 0.4476076066493988
loss_pred:0.025827646255493164, decouple_loss:0.007513693533837795
loss_pred:0.02550024539232254, decouple_loss:0.00690096290782094
loss_pred:0.02537151798605919, decouple_loss:0.007345626130700111
Iteration: 563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487951695919037, gen p mean: -0.7632176876068115, mean p set: 0.4492754638195038
The modified gen p mean: 0.4471665322780609, gen p mean: -0.778774082660675, mean p set: 0.447646826505661
The modified gen p mean: 0.4473932087421417, gen p mean: -0.776982843875885, mean p set: 0.4478735327720642
loss_pred:0.02599404752254486, decouple_loss:0.007133945357054472
loss_pred:0.025655783712863922, decouple_loss:0.007145309820771217
loss_pred:0.02556883543729782, decouple_loss:0.007011820562183857
Iteration: 564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461550712585449, gen p mean: -0.7715415954589844, mean p set: 0.4466353952884674
The modified gen p mean: 0.4474140405654907, gen p mean: -0.7709417939186096, mean p set: 0.44789430499076843
The modified gen p mean: 0.44679683446884155, gen p mean: -0.7727928757667542, mean p set: 0.44727712869644165
loss_pred:0.02578010782599449, decouple_loss:0.007074462249875069
loss_pred:0.025640089064836502, decouple_loss:0.006728408392518759
loss_pred:0.02522115223109722, decouple_loss:0.00695075374096632
Iteration: 565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478420615196228, gen p mean: -0.7674417495727539, mean p set: 0.4483223557472229
The modified gen p mean: 0.44719722867012024, gen p mean: -0.7617522478103638, mean p set: 0.44767752289772034
The modified gen p mean: 0.44982996582984924, gen p mean: -0.7648489475250244, mean p set: 0.45031026005744934
loss_pred:0.02523212879896164, decouple_loss:0.006715424824506044
loss_pred:0.02516154572367668, decouple_loss:0.006580541376024485
loss_pred:0.026098240166902542, decouple_loss:0.0072248708456754684
Iteration: 566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485139846801758, gen p mean: -0.7639548778533936, mean p set: 0.4489942789077759
The modified gen p mean: 0.4483109414577484, gen p mean: -0.7612767815589905, mean p set: 0.4487912356853485
The modified gen p mean: 0.44854748249053955, gen p mean: -0.7524741888046265, mean p set: 0.44902777671813965
loss_pred:0.02632397785782814, decouple_loss:0.007139288354665041
loss_pred:0.026476697996258736, decouple_loss:0.006975424475967884
loss_pred:0.026213400065898895, decouple_loss:0.007130460347980261
Iteration: 567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472886323928833, gen p mean: -0.7599683403968811, mean p set: 0.4477689266204834
The modified gen p mean: 0.446424663066864, gen p mean: -0.7621824145317078, mean p set: 0.4469049572944641
The modified gen p mean: 0.44778165221214294, gen p mean: -0.7600181698799133, mean p set: 0.44826194643974304
loss_pred:0.025958765298128128, decouple_loss:0.0067466264590620995
loss_pred:0.025771459564566612, decouple_loss:0.007201859261840582
loss_pred:0.0261769350618124, decouple_loss:0.007013292517513037
Iteration: 568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454862177371979, gen p mean: -0.7541619539260864, mean p set: 0.445966511964798
The modified gen p mean: 0.4483204185962677, gen p mean: -0.7574146389961243, mean p set: 0.4488007128238678
The modified gen p mean: 0.4483659267425537, gen p mean: -0.7628822922706604, mean p set: 0.4488462209701538
loss_pred:0.026275422424077988, decouple_loss:0.007188013754785061
loss_pred:0.02593831531703472, decouple_loss:0.0066919573582708836
loss_pred:0.025462938472628593, decouple_loss:0.007096976973116398
Iteration: 569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475298225879669, gen p mean: -0.755811870098114, mean p set: 0.44801008701324463
The modified gen p mean: 0.44661805033683777, gen p mean: -0.7557991147041321, mean p set: 0.44709834456443787
The modified gen p mean: 0.4476143717765808, gen p mean: -0.7576389312744141, mean p set: 0.4480946362018585
loss_pred:0.025286007672548294, decouple_loss:0.00689021497964859
loss_pred:0.02549605816602707, decouple_loss:0.006839309819042683
loss_pred:0.025244934484362602, decouple_loss:0.006770962383598089
Iteration: 570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688746333122253, gen p mean: -0.7433070540428162, mean p set: 0.44736772775650024
The modified gen p mean: 0.44608765840530396, gen p mean: -0.747643232345581, mean p set: 0.44656795263290405
The modified gen p mean: 0.44727861881256104, gen p mean: -0.7644359469413757, mean p set: 0.44775891304016113
loss_pred:0.025773556903004646, decouple_loss:0.006940414663404226
loss_pred:0.02599213644862175, decouple_loss:0.007100772112607956
loss_pred:0.02568456344306469, decouple_loss:0.007790626026690006
2023-05-06 22:34:05 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7560892701148987, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7438716888427734, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.748319149017334, mean p set: 0.4500633478164673
loss_pred:0.026495344936847687, decouple_loss:0.007215852849185467
loss_pred:0.02524634823203087, decouple_loss:0.007090795319527388
loss_pred:0.02545180916786194, decouple_loss:0.007021857891231775
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02608664333820343, avg_mse: 0.0315062515437603
current test mse: 0.031506
Iteration: 571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474327862262726, gen p mean: -0.7513542771339417, mean p set: 0.4479130506515503
The modified gen p mean: 0.44760459661483765, gen p mean: -0.7585561871528625, mean p set: 0.44808489084243774
loss_pred:0.02568606659770012, decouple_loss:0.006979713682085276
loss_pred:0.025231298059225082, decouple_loss:0.00690279109403491
The modified gen p mean: 0.4469814896583557, gen p mean: -0.760648250579834, mean p set: 0.4474617540836334
loss_pred:0.025425173342227936, decouple_loss:0.007026004139333963
Iteration: 572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476727545261383, gen p mean: -0.760623574256897, mean p set: 0.4481530487537384
The modified gen p mean: 0.44784674048423767, gen p mean: -0.7626962065696716, mean p set: 0.44832706451416016
loss_pred:0.025200815871357918, decouple_loss:0.006738589610904455
loss_pred:0.02525399439036846, decouple_loss:0.006839720066636801
The modified gen p mean: 0.4493890106678009, gen p mean: -0.7573882341384888, mean p set: 0.449869304895401
loss_pred:0.026500487700104713, decouple_loss:0.006714173126965761
Iteration: 573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494333267211914, gen p mean: -0.7568702697753906, mean p set: 0.4499136209487915
The modified gen p mean: 0.44779470562934875, gen p mean: -0.758735716342926, mean p set: 0.44827497005462646
The modified gen p mean: 0.4487041234970093, gen p mean: -0.7610095143318176, mean p set: 0.449184387922287
loss_pred:0.025646844878792763, decouple_loss:0.007065572310239077
loss_pred:0.025207407772541046, decouple_loss:0.00700273597612977
loss_pred:0.025523727759718895, decouple_loss:0.007366758305579424
Iteration: 574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44614720344543457, gen p mean: -0.7601779103279114, mean p set: 0.4466274678707123
The modified gen p mean: 0.44909849762916565, gen p mean: -0.7675984501838684, mean p set: 0.44957879185676575
loss_pred:0.0259585902094841, decouple_loss:0.0068954965099692345
loss_pred:0.02510615810751915, decouple_loss:0.007054739631712437
The modified gen p mean: 0.44852009415626526, gen p mean: -0.7660074830055237, mean p set: 0.44900041818618774
loss_pred:0.02490486577153206, decouple_loss:0.006767778657376766
Iteration: 575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821038842201233, gen p mean: -0.7718086242675781, mean p set: 0.44869065284729004
The modified gen p mean: 0.44803327322006226, gen p mean: -0.7591313123703003, mean p set: 0.44851356744766235
The modified gen p mean: 0.44558775424957275, gen p mean: -0.7613322138786316, mean p set: 0.44606801867485046
loss_pred:0.02626281976699829, decouple_loss:0.006769861094653606loss_pred:0.024939000606536865, decouple_loss:0.006816680543124676
loss_pred:0.025737712159752846, decouple_loss:0.00703519769012928
Iteration: 576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692888855934143, gen p mean: -0.7710311412811279, mean p set: 0.44740915298461914
The modified gen p mean: 0.4476068913936615, gen p mean: -0.776055097579956, mean p set: 0.448087215423584
The modified gen p mean: 0.4478175938129425, gen p mean: -0.7796159982681274, mean p set: 0.4482978880405426
loss_pred:0.025584327057003975, decouple_loss:0.006801261100918055
loss_pred:0.025374742224812508, decouple_loss:0.006942501291632652
loss_pred:0.025676922872662544, decouple_loss:0.007303148042410612
Iteration: 577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727686047554016, gen p mean: -0.769567608833313, mean p set: 0.44775715470314026
The modified gen p mean: 0.44736161828041077, gen p mean: -0.7644680738449097, mean p set: 0.44784191250801086
The modified gen p mean: 0.4461553692817688, gen p mean: -0.763942301273346, mean p set: 0.4466356933116913
loss_pred:0.025376131758093834, decouple_loss:0.006912937853485346
loss_pred:0.025318773463368416, decouple_loss:0.0067887082695961
loss_pred:0.025561880320310593, decouple_loss:0.006757836788892746
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475928544998169, gen p mean: -0.7636900544166565, mean p set: 0.448073148727417
The modified gen p mean: 0.4473477303981781, gen p mean: -0.7664082050323486, mean p set: 0.4478280544281006
The modified gen p mean: 0.44577547907829285, gen p mean: -0.7470425963401794, mean p set: 0.44625577330589294
loss_pred:0.024972762912511826, decouple_loss:0.007299833931028843
loss_pred:0.026365051046013832, decouple_loss:0.007309648673981428
loss_pred:0.025735851377248764, decouple_loss:0.007483326364308596
Iteration: 579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710493087768555, gen p mean: -0.7574957013130188, mean p set: 0.44758522510528564
The modified gen p mean: 0.44751569628715515, gen p mean: -0.7539383769035339, mean p set: 0.44799599051475525
The modified gen p mean: 0.44620752334594727, gen p mean: -0.7567033171653748, mean p set: 0.44668781757354736
loss_pred:0.02529050037264824, decouple_loss:0.006968903820961714
loss_pred:0.024803761392831802, decouple_loss:0.007320785894989967
loss_pred:0.026267332956194878, decouple_loss:0.007047043181955814
Iteration: 580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44704753160476685, gen p mean: -0.7694225311279297, mean p set: 0.44752782583236694
The modified gen p mean: 0.44734594225883484, gen p mean: -0.7645246982574463, mean p set: 0.44782623648643494
The modified gen p mean: 0.445931613445282, gen p mean: -0.7636407017707825, mean p set: 0.4464118480682373
loss_pred:0.025406040251255035, decouple_loss:0.0071758427657186985loss_pred:0.0261711273342371, decouple_loss:0.006843159906566143
loss_pred:0.026249350979924202, decouple_loss:0.0068887402303516865
2023-05-06 22:38:34 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.771990180015564, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7593894600868225, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7642685770988464, mean p set: 0.4500633478164673
loss_pred:0.026276929304003716, decouple_loss:0.007123445626348257
loss_pred:0.02519616112112999, decouple_loss:0.007152386475354433
loss_pred:0.025328325107693672, decouple_loss:0.0070376149378716946
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025955697521567345, avg_mse: 0.031320326030254364
current test mse: 0.03132
Iteration: 581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667911529541016, gen p mean: -0.76429283618927, mean p set: 0.44715940952301025
The modified gen p mean: 0.4461468756198883, gen p mean: -0.7642132043838501, mean p set: 0.4466271698474884
loss_pred:0.02601049467921257, decouple_loss:0.007085924968123436
loss_pred:0.025711970403790474, decouple_loss:0.0067215533927083015
The modified gen p mean: 0.4468764066696167, gen p mean: -0.7740877866744995, mean p set: 0.4473566710948944
loss_pred:0.025287991389632225, decouple_loss:0.006994908209890127
Iteration: 582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473292827606201, gen p mean: -0.7707093954086304, mean p set: 0.4478095471858978
The modified gen p mean: 0.44739651679992676, gen p mean: -0.7681180238723755, mean p set: 0.44787678122520447
The modified gen p mean: 0.4464486241340637, gen p mean: -0.785275936126709, mean p set: 0.4469289183616638
loss_pred:0.024947458878159523, decouple_loss:0.007031974848359823
loss_pred:0.02581194043159485, decouple_loss:0.007052341476082802
loss_pred:0.024791428819298744, decouple_loss:0.00705291610211134
Iteration: 583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452894926071167, gen p mean: -0.7659443616867065, mean p set: 0.4457697868347168
The modified gen p mean: 0.44879674911499023, gen p mean: -0.7847489714622498, mean p set: 0.44927704334259033
The modified gen p mean: 0.44662079215049744, gen p mean: -0.7770651578903198, mean p set: 0.4471011161804199
loss_pred:0.02548936754465103, decouple_loss:0.007538343779742718
loss_pred:0.02472011186182499, decouple_loss:0.007239020429551601
loss_pred:0.025171704590320587, decouple_loss:0.00720475148409605
Iteration: 584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810670614242554, gen p mean: -0.7731537222862244, mean p set: 0.44858697056770325
The modified gen p mean: 0.44677528738975525, gen p mean: -0.7645449042320251, mean p set: 0.44725558161735535
The modified gen p mean: 0.4480065703392029, gen p mean: -0.7681759595870972, mean p set: 0.448486864566803
loss_pred:0.025145575404167175, decouple_loss:0.00700550340116024
loss_pred:0.025354336947202682, decouple_loss:0.006931174546480179
loss_pred:0.025913560763001442, decouple_loss:0.0072945537976920605
Iteration: 585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478110074996948, gen p mean: -0.756796658039093, mean p set: 0.4482913017272949
The modified gen p mean: 0.44904765486717224, gen p mean: -0.7681795954704285, mean p set: 0.44952791929244995
loss_pred:0.025281965732574463, decouple_loss:0.007096213288605213
loss_pred:0.024904631078243256, decouple_loss:0.007302706595510244
The modified gen p mean: 0.4474707841873169, gen p mean: -0.7497000694274902, mean p set: 0.447951078414917
loss_pred:0.025255275890231133, decouple_loss:0.007106877863407135
Iteration: 586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472636580467224, gen p mean: -0.7463154792785645, mean p set: 0.4477439522743225
The modified gen p mean: 0.4481782019138336, gen p mean: -0.7577651739120483, mean p set: 0.4486584961414337
The modified gen p mean: 0.44883668422698975, gen p mean: -0.7643612623214722, mean p set: 0.44931700825691223
loss_pred:0.025089377537369728, decouple_loss:0.006838527508080006
loss_pred:0.024914279580116272, decouple_loss:0.007013241294771433
loss_pred:0.02499885857105255, decouple_loss:0.007260904181748629
Iteration: 587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482031464576721, gen p mean: -0.7550792694091797, mean p set: 0.44868341088294983
The modified gen p mean: 0.4462599754333496, gen p mean: -0.7504797577857971, mean p set: 0.4467402696609497
The modified gen p mean: 0.4472138285636902, gen p mean: -0.7484842538833618, mean p set: 0.4476941227912903
loss_pred:0.02511400356888771, decouple_loss:0.007137599401175976
loss_pred:0.026111412793397903, decouple_loss:0.007022715639322996
loss_pred:0.02588988095521927, decouple_loss:0.006951333489269018
Iteration: 588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760069251060486, gen p mean: -0.7532175779342651, mean p set: 0.44808098673820496
The modified gen p mean: 0.44568493962287903, gen p mean: -0.7501912117004395, mean p set: 0.4461652636528015
The modified gen p mean: 0.44632503390312195, gen p mean: -0.7513864040374756, mean p set: 0.44680535793304443
loss_pred:0.025549791753292084, decouple_loss:0.0069088563323020935
loss_pred:0.025536436587572098, decouple_loss:0.007117660250514746
loss_pred:0.024813514202833176, decouple_loss:0.0068329693749547005
Iteration: 589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44885823130607605, gen p mean: -0.7712353467941284, mean p set: 0.44933852553367615
The modified gen p mean: 0.44817233085632324, gen p mean: -0.7686470150947571, mean p set: 0.44865259528160095
The modified gen p mean: 0.44525769352912903, gen p mean: -0.7619452476501465, mean p set: 0.44573795795440674
loss_pred:0.024665875360369682, decouple_loss:0.006972537375986576loss_pred:0.025957277044653893, decouple_loss:0.007426126394420862
loss_pred:0.024873623624444008, decouple_loss:0.007148583419620991
Iteration: 590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44627130031585693, gen p mean: -0.7580180764198303, mean p set: 0.44675159454345703
The modified gen p mean: 0.44603100419044495, gen p mean: -0.7557448148727417, mean p set: 0.44651132822036743
The modified gen p mean: 0.448574036359787, gen p mean: -0.772793710231781, mean p set: 0.4490543007850647
loss_pred:0.025044141337275505, decouple_loss:0.006970336195081472
loss_pred:0.02632187306880951, decouple_loss:0.006917462218552828
loss_pred:0.02604266069829464, decouple_loss:0.007847234606742859
2023-05-06 22:42:11 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7596747875213623, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7475389242172241, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.752321183681488, mean p set: 0.4500633478164673
loss_pred:0.026309184730052948, decouple_loss:0.00719933956861496
loss_pred:0.025135597214102745, decouple_loss:0.007225400768220425
loss_pred:0.02533223107457161, decouple_loss:0.007070604711771011
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025950593873858452, avg_mse: 0.031338877975940704
current test mse: 0.031339
Iteration: 591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609495997428894, gen p mean: -0.7599779367446899, mean p set: 0.4465752840042114
The modified gen p mean: 0.4463035464286804, gen p mean: -0.7543011903762817, mean p set: 0.4467838406562805
loss_pred:0.025639638304710388, decouple_loss:0.006958120036870241
loss_pred:0.024990718811750412, decouple_loss:0.006727938540279865
The modified gen p mean: 0.4456796944141388, gen p mean: -0.751745879650116, mean p set: 0.4461599588394165
loss_pred:0.02493949420750141, decouple_loss:0.007156001403927803
Iteration: 592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479667544364929, gen p mean: -0.7651921510696411, mean p set: 0.4484470784664154
The modified gen p mean: 0.4466908872127533, gen p mean: -0.7646734118461609, mean p set: 0.4471711814403534
The modified gen p mean: 0.44664016366004944, gen p mean: -0.7622540593147278, mean p set: 0.44712045788764954
loss_pred:0.02517697401344776, decouple_loss:0.006591841112822294
loss_pred:0.025411417707800865, decouple_loss:0.006882259156554937
loss_pred:0.025240492075681686, decouple_loss:0.006969771347939968
Iteration: 593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44641295075416565, gen p mean: -0.7639731168746948, mean p set: 0.44689324498176575
The modified gen p mean: 0.44599369168281555, gen p mean: -0.7577958106994629, mean p set: 0.44647401571273804
The modified gen p mean: 0.4458253085613251, gen p mean: -0.7651102542877197, mean p set: 0.44630563259124756
loss_pred:0.02671068161725998, decouple_loss:0.00650660740211606
loss_pred:0.025747695937752724, decouple_loss:0.00678604282438755
loss_pred:0.02483977936208248, decouple_loss:0.0063439966179430485
Iteration: 594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474453330039978, gen p mean: -0.7682192325592041, mean p set: 0.4479255974292755
The modified gen p mean: 0.44859594106674194, gen p mean: -0.7855216860771179, mean p set: 0.44907623529434204
The modified gen p mean: 0.4483022689819336, gen p mean: -0.7795135378837585, mean p set: 0.4487825632095337
loss_pred:0.026016779243946075, decouple_loss:0.00669488962739706
loss_pred:0.02613031677901745, decouple_loss:0.007752910256385803
loss_pred:0.025147832930088043, decouple_loss:0.0073231179267168045
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44582653045654297, gen p mean: -0.7574372291564941, mean p set: 0.44630685448646545
The modified gen p mean: 0.44625362753868103, gen p mean: -0.7627182006835938, mean p set: 0.44673389196395874
The modified gen p mean: 0.4467659592628479, gen p mean: -0.7578011751174927, mean p set: 0.447246253490448
loss_pred:0.02593419700860977, decouple_loss:0.006845058873295784
loss_pred:0.02529270574450493, decouple_loss:0.006669621914625168
loss_pred:0.025311309844255447, decouple_loss:0.006556251551955938
Iteration: 596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44647496938705444, gen p mean: -0.7645859718322754, mean p set: 0.44695523381233215
The modified gen p mean: 0.44691959023475647, gen p mean: -0.7590366005897522, mean p set: 0.4473998546600342
The modified gen p mean: 0.4467124044895172, gen p mean: -0.7512412071228027, mean p set: 0.4471926689147949
loss_pred:0.024623675271868706, decouple_loss:0.006766569335013628
loss_pred:0.025455942377448082, decouple_loss:0.006535966880619526
loss_pred:0.026108870282769203, decouple_loss:0.006824152544140816
Iteration: 597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746023416519165, gen p mean: -0.7642145752906799, mean p set: 0.44794052839279175
The modified gen p mean: 0.44646894931793213, gen p mean: -0.7754872441291809, mean p set: 0.44694921374320984
The modified gen p mean: 0.4468236267566681, gen p mean: -0.7636498808860779, mean p set: 0.4473038911819458
loss_pred:0.024755947291851044, decouple_loss:0.007090539671480656
loss_pred:0.02524731680750847, decouple_loss:0.006570953875780106
loss_pred:0.024975169450044632, decouple_loss:0.006915469188243151
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
NaN value num: 0
Iteration: 598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45206934213638306, gen p mean: -0.7512478828430176, mean p set: 0.45254963636398315
The modified gen p mean: 0.45113590359687805, gen p mean: -0.7583414912223816, mean p set: 0.45161619782447815
The modified gen p mean: 0.4498823583126068, gen p mean: -0.7557346820831299, mean p set: 0.4503626525402069
loss_pred:0.026473665609955788, decouple_loss:0.008186059072613716
loss_pred:0.02500571869313717, decouple_loss:0.008477432653307915
loss_pred:0.026418033987283707, decouple_loss:0.008287936449050903
Iteration: 599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451896607875824, gen p mean: -0.7610795497894287, mean p set: 0.4523768723011017
The modified gen p mean: 0.45315924286842346, gen p mean: -0.7646631598472595, mean p set: 0.45363950729370117
loss_pred:0.024470718577504158, decouple_loss:0.00830367673188448
The modified gen p mean: 0.45190173387527466, gen p mean: -0.7608535289764404, mean p set: 0.45238202810287476
loss_pred:0.025972377508878708, decouple_loss:0.008311410434544086
loss_pred:0.024268539622426033, decouple_loss:0.00832268688827753
Iteration: 600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45211803913116455, gen p mean: -0.744247317314148, mean p set: 0.45259830355644226
The modified gen p mean: 0.4502141773700714, gen p mean: -0.7500278353691101, mean p set: 0.4506944417953491
The modified gen p mean: 0.4499393105506897, gen p mean: -0.7519083023071289, mean p set: 0.4504196047782898
loss_pred:0.02602243237197399, decouple_loss:0.00842791423201561
loss_pred:0.025660274550318718, decouple_loss:0.008011547848582268
loss_pred:0.023572616279125214, decouple_loss:0.00838723685592413
2023-05-06 22:46:32 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7538648843765259, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7418233752250671, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7465057373046875, mean p set: 0.4500633478164673
loss_pred:0.026767494156956673, decouple_loss:0.008005280047655106
loss_pred:0.025440167635679245, decouple_loss:0.008004238829016685
loss_pred:0.025768417865037918, decouple_loss:0.007914893329143524
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026390766724944115, avg_mse: 0.03204923868179321
current test mse: 0.032049
Iteration: 601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530789256095886, gen p mean: -0.7533038854598999, mean p set: 0.45355919003486633
The modified gen p mean: 0.4548651874065399, gen p mean: -0.7553678154945374, mean p set: 0.45534548163414
loss_pred:0.026901699602603912, decouple_loss:0.008141757920384407
loss_pred:0.024384567514061928, decouple_loss:0.008196832612156868
The modified gen p mean: 0.4505513906478882, gen p mean: -0.7485818266868591, mean p set: 0.4510316848754883
loss_pred:0.025061309337615967, decouple_loss:0.007842415943741798
Iteration: 602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501403868198395, gen p mean: -0.7388458251953125, mean p set: 0.4506206214427948
The modified gen p mean: 0.4540480971336365, gen p mean: -0.7475534677505493, mean p set: 0.4545283913612366
The modified gen p mean: 0.452873170375824, gen p mean: -0.7347548007965088, mean p set: 0.4533534646034241
loss_pred:0.023530222475528717, decouple_loss:0.007863945327699184
loss_pred:0.024054069072008133, decouple_loss:0.007886093109846115
loss_pred:0.025882376357913017, decouple_loss:0.007915566675364971
Iteration: 603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514513611793518, gen p mean: -0.7427571415901184, mean p set: 0.4519317150115967
The modified gen p mean: 0.4496065676212311, gen p mean: -0.7443581223487854, mean p set: 0.4500868618488312
The modified gen p mean: 0.4508812725543976, gen p mean: -0.7410879731178284, mean p set: 0.45136159658432007
loss_pred:0.02702540159225464, decouple_loss:0.007788221817463636
loss_pred:0.023056162521243095, decouple_loss:0.007834810763597488
loss_pred:0.024994993582367897, decouple_loss:0.007926749996840954
Iteration: 604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529207944869995, gen p mean: -0.7453411817550659, mean p set: 0.4534010887145996
The modified gen p mean: 0.4521256983280182, gen p mean: -0.7517572641372681, mean p set: 0.4526059925556183
The modified gen p mean: 0.45127904415130615, gen p mean: -0.7603297829627991, mean p set: 0.45175933837890625
loss_pred:0.025348741561174393, decouple_loss:0.008147405460476875
loss_pred:0.026650791987776756, decouple_loss:0.008000517264008522
loss_pred:0.024215908721089363, decouple_loss:0.007831967435777187
Iteration: 605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45179131627082825, gen p mean: -0.761818528175354, mean p set: 0.45227164030075073
The modified gen p mean: 0.4537471532821655, gen p mean: -0.7617252469062805, mean p set: 0.45422741770744324
The modified gen p mean: 0.4518018662929535, gen p mean: -0.7613038420677185, mean p set: 0.452282190322876
loss_pred:0.025339147076010704, decouple_loss:0.007855365052819252loss_pred:0.027328137308359146, decouple_loss:0.007991592399775982
loss_pred:0.02536662667989731, decouple_loss:0.008192651905119419
Iteration: 606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495961666107178, gen p mean: -0.7659761905670166, mean p set: 0.4500764310359955
The modified gen p mean: 0.454966276884079, gen p mean: -0.7851417660713196, mean p set: 0.45544660091400146
The modified gen p mean: 0.45042169094085693, gen p mean: -0.7762527465820312, mean p set: 0.45090195536613464
loss_pred:0.02507459558546543, decouple_loss:0.007860553450882435
loss_pred:0.02505544200539589, decouple_loss:0.0080023892223835
loss_pred:0.025155995041131973, decouple_loss:0.00791554432362318
Iteration: 607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45238861441612244, gen p mean: -0.7857924699783325, mean p set: 0.45286890864372253
The modified gen p mean: 0.4529380202293396, gen p mean: -0.785277247428894, mean p set: 0.4534182846546173
The modified gen p mean: 0.45195385813713074, gen p mean: -0.7804882526397705, mean p set: 0.4524341821670532
loss_pred:0.027642935514450073, decouple_loss:0.007835433818399906
loss_pred:0.027023326605558395, decouple_loss:0.007912361063063145
loss_pred:0.02468562126159668, decouple_loss:0.008125890977680683
Iteration: 608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530724883079529, gen p mean: -0.7814782857894897, mean p set: 0.4535527229309082
The modified gen p mean: 0.4502507746219635, gen p mean: -0.7729063630104065, mean p set: 0.4507310390472412
The modified gen p mean: 0.4533970355987549, gen p mean: -0.7794133424758911, mean p set: 0.4538773000240326
loss_pred:0.027177298441529274, decouple_loss:0.008213468827307224
loss_pred:0.025458188727498055, decouple_loss:0.007696636952459812
loss_pred:0.027360690757632256, decouple_loss:0.00785992294549942
Iteration: 609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508505165576935, gen p mean: -0.7621200680732727, mean p set: 0.4513308107852936
The modified gen p mean: 0.4504154622554779, gen p mean: -0.7590875625610352, mean p set: 0.4508957266807556
The modified gen p mean: 0.4507195055484772, gen p mean: -0.7589784860610962, mean p set: 0.4511997699737549
loss_pred:0.02499302662909031, decouple_loss:0.007936274632811546
loss_pred:0.02454281784594059, decouple_loss:0.007964429445564747
loss_pred:0.02463621273636818, decouple_loss:0.008109934628009796
Iteration: 610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963768124580383, gen p mean: -0.7655742764472961, mean p set: 0.45011797547340393
The modified gen p mean: 0.4521728754043579, gen p mean: -0.7603745460510254, mean p set: 0.452653169631958
The modified gen p mean: 0.45300745964050293, gen p mean: -0.7690197229385376, mean p set: 0.453487753868103
loss_pred:0.023343004286289215, decouple_loss:0.007839414291083813
loss_pred:0.026519399136304855, decouple_loss:0.007891587913036346
loss_pred:0.0253167562186718, decouple_loss:0.007778121158480644
2023-05-06 22:50:11 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7721174359321594, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.759249210357666, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7641847133636475, mean p set: 0.4500633478164673
loss_pred:0.02673010155558586, decouple_loss:0.008919171057641506
loss_pred:0.025270791724324226, decouple_loss:0.008361244574189186
loss_pred:0.025621457025408745, decouple_loss:0.008416499942541122
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02630239725112915, avg_mse: 0.03183639794588089
current test mse: 0.031836
Iteration: 611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504041075706482, gen p mean: -0.7681435942649841, mean p set: 0.4508844316005707
The modified gen p mean: 0.45099908113479614, gen p mean: -0.7655816078186035, mean p set: 0.45147937536239624
loss_pred:0.02377266064286232, decouple_loss:0.0076629663817584515
loss_pred:0.02464364655315876, decouple_loss:0.007791395299136639
The modified gen p mean: 0.4533480405807495, gen p mean: -0.7680901885032654, mean p set: 0.4538283348083496
loss_pred:0.026294292882084846, decouple_loss:0.007823309861123562
Iteration: 612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4541676640510559, gen p mean: -0.7738383412361145, mean p set: 0.454647958278656
The modified gen p mean: 0.4527312219142914, gen p mean: -0.7655956149101257, mean p set: 0.4532114863395691
loss_pred:0.02472132071852684, decouple_loss:0.007469007279723883
loss_pred:0.025469239801168442, decouple_loss:0.007636408321559429
The modified gen p mean: 0.45329105854034424, gen p mean: -0.7789936065673828, mean p set: 0.4537713825702667
loss_pred:0.025545837357640266, decouple_loss:0.007861877791583538
Iteration: 613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45318588614463806, gen p mean: -0.7724334597587585, mean p set: 0.45366615056991577
The modified gen p mean: 0.45120471715927124, gen p mean: -0.7685103416442871, mean p set: 0.45168498158454895
loss_pred:0.027148772031068802, decouple_loss:0.007495710626244545
The modified gen p mean: 0.4519626498222351, gen p mean: -0.773379921913147, mean p set: 0.4524429440498352
loss_pred:0.02599531039595604, decouple_loss:0.007723748683929443
loss_pred:0.02459920570254326, decouple_loss:0.007811334915459156
Iteration: 614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525775909423828, gen p mean: -0.7774755954742432, mean p set: 0.4530578553676605
The modified gen p mean: 0.4515368342399597, gen p mean: -0.7631944417953491, mean p set: 0.4520170986652374
The modified gen p mean: 0.45320290327072144, gen p mean: -0.7677491307258606, mean p set: 0.4536832273006439
loss_pred:0.02680458500981331, decouple_loss:0.0077000390738248825loss_pred:0.02599441632628441, decouple_loss:0.007631555199623108
loss_pred:0.024624235928058624, decouple_loss:0.007973692379891872
Iteration: 615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45349958539009094, gen p mean: -0.772729754447937, mean p set: 0.45397984981536865
The modified gen p mean: 0.4523985683917999, gen p mean: -0.7753304839134216, mean p set: 0.45287883281707764
The modified gen p mean: 0.4514559805393219, gen p mean: -0.7576311826705933, mean p set: 0.451936274766922
loss_pred:0.02392842434346676, decouple_loss:0.0078030964359641075
loss_pred:0.023702377453446388, decouple_loss:0.007557811215519905
loss_pred:0.025738071650266647, decouple_loss:0.0074173989705741405
Iteration: 616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534457325935364, gen p mean: -0.7522826194763184, mean p set: 0.4539260268211365
The modified gen p mean: 0.4537576138973236, gen p mean: -0.761685848236084, mean p set: 0.4542378783226013
The modified gen p mean: 0.4506078064441681, gen p mean: -0.7503083348274231, mean p set: 0.4510881304740906
loss_pred:0.02543477527797222, decouple_loss:0.0073328386060893536loss_pred:0.02443438395857811, decouple_loss:0.007432215381413698
loss_pred:0.025034159421920776, decouple_loss:0.007686893921345472
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
NaN value num: 0
Iteration: 617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505919814109802, gen p mean: -0.7620816230773926, mean p set: 0.4510722756385803
The modified gen p mean: 0.45271623134613037, gen p mean: -0.7429771423339844, mean p set: 0.4531964957714081
The modified gen p mean: 0.4495389461517334, gen p mean: -0.7486279606819153, mean p set: 0.4500192403793335
loss_pred:0.02654234506189823, decouple_loss:0.008049129508435726
loss_pred:0.02715020254254341, decouple_loss:0.007907760329544544
loss_pred:0.02620384469628334, decouple_loss:0.008081863634288311
Iteration: 618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846272468566895, gen p mean: -0.780383288860321, mean p set: 0.44894298911094666
The modified gen p mean: 0.4488403797149658, gen p mean: -0.7768009305000305, mean p set: 0.4493206739425659
The modified gen p mean: 0.4500858783721924, gen p mean: -0.7699255347251892, mean p set: 0.4505661725997925
loss_pred:0.025194689631462097, decouple_loss:0.007747957017272711
loss_pred:0.026191091164946556, decouple_loss:0.007793772965669632
loss_pred:0.025450220331549644, decouple_loss:0.007671239320188761
Iteration: 619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873303174972534, gen p mean: -0.77266925573349, mean p set: 0.44921332597732544
The modified gen p mean: 0.4501268267631531, gen p mean: -0.7787032723426819, mean p set: 0.4506070911884308
The modified gen p mean: 0.44980499148368835, gen p mean: -0.7753767967224121, mean p set: 0.45028528571128845
loss_pred:0.027251236140727997, decouple_loss:0.00812703650444746
loss_pred:0.02714349515736103, decouple_loss:0.007729403208941221
loss_pred:0.02583308145403862, decouple_loss:0.00758375646546483
Iteration: 620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44983574748039246, gen p mean: -0.7647667527198792, mean p set: 0.45031604170799255
The modified gen p mean: 0.44933873414993286, gen p mean: -0.7880671620368958, mean p set: 0.44981902837753296
The modified gen p mean: 0.44984573125839233, gen p mean: -0.769162654876709, mean p set: 0.45032599568367004
loss_pred:0.026729831472039223, decouple_loss:0.007755213417112827
loss_pred:0.02563241869211197, decouple_loss:0.007536894641816616
loss_pred:0.025587301701307297, decouple_loss:0.007479904219508171
2023-05-06 22:55:09 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7817762494087219, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.76917564868927, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7740247845649719, mean p set: 0.4500633478164673
loss_pred:0.027111152186989784, decouple_loss:0.00843966193497181
loss_pred:0.025699567049741745, decouple_loss:0.00813192781060934
loss_pred:0.026018815115094185, decouple_loss:0.008080949075520039
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026687389239668846, avg_mse: 0.03254065290093422
current test mse: 0.032541
Iteration: 621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45273956656455994, gen p mean: -0.7688401937484741, mean p set: 0.4532198905944824
The modified gen p mean: 0.45217227935791016, gen p mean: -0.7891671061515808, mean p set: 0.45265257358551025
loss_pred:0.02640242502093315, decouple_loss:0.008166112937033176
loss_pred:0.026152849197387695, decouple_loss:0.008765370585024357
The modified gen p mean: 0.4489035904407501, gen p mean: -0.7686702609062195, mean p set: 0.4493838846683502
loss_pred:0.02674144320189953, decouple_loss:0.00803452730178833
Iteration: 622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44970133900642395, gen p mean: -0.7592059969902039, mean p set: 0.45018163323402405
The modified gen p mean: 0.4506075978279114, gen p mean: -0.7656448483467102, mean p set: 0.4510878920555115
The modified gen p mean: 0.4497637450695038, gen p mean: -0.7731979489326477, mean p set: 0.4502440094947815
loss_pred:0.025722015649080276, decouple_loss:0.007819960825145245
loss_pred:0.026787666603922844, decouple_loss:0.007669974584132433
loss_pred:0.027257919311523438, decouple_loss:0.007748068310320377
Iteration: 623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45039212703704834, gen p mean: -0.7698732614517212, mean p set: 0.45087239146232605
The modified gen p mean: 0.44997432827949524, gen p mean: -0.7725965976715088, mean p set: 0.45045459270477295
The modified gen p mean: 0.4530010223388672, gen p mean: -0.7675281167030334, mean p set: 0.4534813165664673
loss_pred:0.02613210864365101, decouple_loss:0.007707450073212385
loss_pred:0.025035155937075615, decouple_loss:0.007332345936447382
loss_pred:0.02660614252090454, decouple_loss:0.0080418037250638
Iteration: 624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45022231340408325, gen p mean: -0.7623192667961121, mean p set: 0.4507025480270386
The modified gen p mean: 0.44876691699028015, gen p mean: -0.7717826962471008, mean p set: 0.44924721121788025
loss_pred:0.027142295613884926, decouple_loss:0.007897879928350449
loss_pred:0.026194270700216293, decouple_loss:0.0076441154815256596
The modified gen p mean: 0.45282161235809326, gen p mean: -0.7800498008728027, mean p set: 0.45330190658569336
loss_pred:0.025569096207618713, decouple_loss:0.008108180947601795
Iteration: 625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514254629611969, gen p mean: -0.7794992923736572, mean p set: 0.451905757188797
The modified gen p mean: 0.44972240924835205, gen p mean: -0.7677258849143982, mean p set: 0.45020267367362976
The modified gen p mean: 0.4496884047985077, gen p mean: -0.769723653793335, mean p set: 0.4501686692237854
loss_pred:0.025734098628163338, decouple_loss:0.008054153993725777
loss_pred:0.02726728841662407, decouple_loss:0.008112546056509018
loss_pred:0.02587120234966278, decouple_loss:0.00783458724617958
Iteration: 626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44949871301651, gen p mean: -0.7580882906913757, mean p set: 0.4499790072441101
The modified gen p mean: 0.4503084123134613, gen p mean: -0.7733310461044312, mean p set: 0.4507887363433838
The modified gen p mean: 0.44953402876853943, gen p mean: -0.7668679356575012, mean p set: 0.4500143229961395
loss_pred:0.026337549090385437, decouple_loss:0.00814427062869072
loss_pred:0.025373036041855812, decouple_loss:0.00848311185836792
loss_pred:0.026061993092298508, decouple_loss:0.008212806656956673
Iteration: 627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498523473739624, gen p mean: -0.7724577188491821, mean p set: 0.4503326416015625
The modified gen p mean: 0.4500778615474701, gen p mean: -0.7626234292984009, mean p set: 0.4505581855773926
The modified gen p mean: 0.44918400049209595, gen p mean: -0.7672101855278015, mean p set: 0.44966429471969604
loss_pred:0.02702079899609089, decouple_loss:0.008517197333276272
loss_pred:0.02577804960310459, decouple_loss:0.00844231341034174
loss_pred:0.026959726586937904, decouple_loss:0.008541559800505638
Iteration: 628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451625794172287, gen p mean: -0.7749627828598022, mean p set: 0.4521060883998871
The modified gen p mean: 0.4491724371910095, gen p mean: -0.7600743770599365, mean p set: 0.4496527314186096
loss_pred:0.026316657662391663, decouple_loss:0.008364741690456867
loss_pred:0.026186181232333183, decouple_loss:0.007773577701300383
The modified gen p mean: 0.4507034122943878, gen p mean: -0.7692258954048157, mean p set: 0.4511836767196655
loss_pred:0.027081696316599846, decouple_loss:0.008012961596250534
Iteration: 629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45304596424102783, gen p mean: -0.7780581116676331, mean p set: 0.45352625846862793
The modified gen p mean: 0.44726434350013733, gen p mean: -0.7863278388977051, mean p set: 0.4477446675300598
The modified gen p mean: 0.44934508204460144, gen p mean: -0.7660866975784302, mean p set: 0.44982537627220154
loss_pred:0.02571173943579197, decouple_loss:0.008434907533228397
loss_pred:0.025335820391774178, decouple_loss:0.008480912074446678
loss_pred:0.026274871081113815, decouple_loss:0.008023720234632492
Iteration: 630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497276842594147, gen p mean: -0.7651881575584412, mean p set: 0.45020797848701477
The modified gen p mean: 0.44869181513786316, gen p mean: -0.7727949023246765, mean p set: 0.44917213916778564
The modified gen p mean: 0.4496876001358032, gen p mean: -0.7628203630447388, mean p set: 0.45016786456108093
loss_pred:0.026244105771183968, decouple_loss:0.008557231165468693
loss_pred:0.025784557685256004, decouple_loss:0.008098775520920753
loss_pred:0.026912136003375053, decouple_loss:0.008018759079277515
2023-05-06 22:58:47 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7713878750801086, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7577991485595703, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7629015445709229, mean p set: 0.4500633478164673
loss_pred:0.02681693434715271, decouple_loss:0.008944492787122726
loss_pred:0.025553449988365173, decouple_loss:0.008621251210570335
loss_pred:0.025737255811691284, decouple_loss:0.008617478422820568
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026472268626093864, avg_mse: 0.03209783509373665
current test mse: 0.032098
Iteration: 631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892454147338867, gen p mean: -0.7703851461410522, mean p set: 0.4494048058986664
The modified gen p mean: 0.45048776268959045, gen p mean: -0.7676926255226135, mean p set: 0.45096808671951294
loss_pred:0.02503434382379055, decouple_loss:0.007916729897260666
loss_pred:0.025462089106440544, decouple_loss:0.007983556017279625
The modified gen p mean: 0.4535812437534332, gen p mean: -0.7698467373847961, mean p set: 0.45406150817871094
loss_pred:0.025245679542422295, decouple_loss:0.00842365063726902
Iteration: 632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492344856262207, gen p mean: -0.7583542466163635, mean p set: 0.4497148096561432
The modified gen p mean: 0.451553612947464, gen p mean: -0.7754736542701721, mean p set: 0.4520338773727417
loss_pred:0.026100696995854378, decouple_loss:0.007691114209592342
loss_pred:0.025977637618780136, decouple_loss:0.008720076642930508
The modified gen p mean: 0.45297864079475403, gen p mean: -0.7763609290122986, mean p set: 0.4534589648246765
loss_pred:0.025350727140903473, decouple_loss:0.008742212317883968
Iteration: 633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526509642601013, gen p mean: -0.7629934549331665, mean p set: 0.4531312584877014
The modified gen p mean: 0.44855958223342896, gen p mean: -0.7801480889320374, mean p set: 0.44903984665870667
The modified gen p mean: 0.4501339793205261, gen p mean: -0.7653037309646606, mean p set: 0.45061424374580383
loss_pred:0.026149770244956017, decouple_loss:0.008330549113452435
loss_pred:0.02545188181102276, decouple_loss:0.00782046653330326
loss_pred:0.025529321283102036, decouple_loss:0.0076668462716042995
Iteration: 634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498114287853241, gen p mean: -0.7617699503898621, mean p set: 0.4502916932106018
The modified gen p mean: 0.45316675305366516, gen p mean: -0.7727771997451782, mean p set: 0.45364704728126526
The modified gen p mean: 0.45171695947647095, gen p mean: -0.7753633260726929, mean p set: 0.45219725370407104
loss_pred:0.026834353804588318, decouple_loss:0.007621704135090113
loss_pred:0.025485936552286148, decouple_loss:0.007890008389949799
loss_pred:0.025463063269853592, decouple_loss:0.008111383765935898
Iteration: 635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992244243621826, gen p mean: -0.7592291831970215, mean p set: 0.45040273666381836
The modified gen p mean: 0.4511922299861908, gen p mean: -0.7629808187484741, mean p set: 0.4516725242137909
The modified gen p mean: 0.45126333832740784, gen p mean: -0.7618745565414429, mean p set: 0.4517436623573303
loss_pred:0.026138227432966232, decouple_loss:0.0077979410998523235
loss_pred:0.026279743760824203, decouple_loss:0.007689240854233503
loss_pred:0.02648727037012577, decouple_loss:0.008187949657440186
Iteration: 636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502153694629669, gen p mean: -0.7541284561157227, mean p set: 0.450695663690567The modified gen p mean: 0.4523540735244751, gen p mean: -0.7755040526390076, mean p set: 0.4528343677520752
loss_pred:0.025767875835299492, decouple_loss:0.008007876574993134loss_pred:0.026212651282548904, decouple_loss:0.00779345165938139
The modified gen p mean: 0.45256519317626953, gen p mean: -0.7621062994003296, mean p set: 0.45304545760154724
loss_pred:0.025798335671424866, decouple_loss:0.008316385559737682
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483889937400818, gen p mean: -0.7745227813720703, mean p set: 0.4488692879676819
The modified gen p mean: 0.44857344031333923, gen p mean: -0.7720671892166138, mean p set: 0.44905373454093933
The modified gen p mean: 0.4474695920944214, gen p mean: -0.765194296836853, mean p set: 0.4479498863220215
loss_pred:0.02642511948943138, decouple_loss:0.008236759342253208
loss_pred:0.02514018677175045, decouple_loss:0.00831273291260004
loss_pred:0.02573397010564804, decouple_loss:0.008219849318265915
Iteration: 638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477780759334564, gen p mean: -0.7579836249351501, mean p set: 0.44825834035873413
The modified gen p mean: 0.4474526643753052, gen p mean: -0.7583541870117188, mean p set: 0.4479329288005829
loss_pred:0.02565106377005577, decouple_loss:0.007994726300239563
loss_pred:0.025164050981402397, decouple_loss:0.007974181324243546
The modified gen p mean: 0.4473004639148712, gen p mean: -0.7605833411216736, mean p set: 0.4477807283401489
loss_pred:0.0259697288274765, decouple_loss:0.007975449785590172
Iteration: 639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728949666023254, gen p mean: -0.753771960735321, mean p set: 0.44776979088783264
The modified gen p mean: 0.4485163986682892, gen p mean: -0.7540151476860046, mean p set: 0.4489966928958893
The modified gen p mean: 0.4484991729259491, gen p mean: -0.7553725838661194, mean p set: 0.4489794969558716
loss_pred:0.02489989995956421, decouple_loss:0.007936942391097546
loss_pred:0.02642769180238247, decouple_loss:0.007698446046561003
loss_pred:0.02557593397796154, decouple_loss:0.0076311188749969006
Iteration: 640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745561480522156, gen p mean: -0.7493911385536194, mean p set: 0.44793590903282166
The modified gen p mean: 0.4481067955493927, gen p mean: -0.7645186185836792, mean p set: 0.4485870599746704
The modified gen p mean: 0.44817665219306946, gen p mean: -0.7554392218589783, mean p set: 0.44865697622299194
loss_pred:0.026248658075928688, decouple_loss:0.008098718710243702
loss_pred:0.02472224086523056, decouple_loss:0.007770259864628315
loss_pred:0.026202291250228882, decouple_loss:0.007984963245689869
2023-05-06 23:03:50 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7638855576515198, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7506341338157654, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7561300992965698, mean p set: 0.4500633478164673
loss_pred:0.027117175981402397, decouple_loss:0.00810579676181078
loss_pred:0.025645362213253975, decouple_loss:0.007723678834736347
loss_pred:0.02604880928993225, decouple_loss:0.00764808664098382
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026661744341254234, avg_mse: 0.0321839414536953
current test mse: 0.032184
Iteration: 641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812414050102234, gen p mean: -0.7522786259651184, mean p set: 0.4486044645309448
The modified gen p mean: 0.44736239314079285, gen p mean: -0.7525081038475037, mean p set: 0.44784268736839294
loss_pred:0.025169016793370247, decouple_loss:0.007516645826399326
loss_pred:0.027270803228020668, decouple_loss:0.007488104049116373
The modified gen p mean: 0.4493151009082794, gen p mean: -0.7559964656829834, mean p set: 0.4497953951358795
loss_pred:0.025966208428144455, decouple_loss:0.008038896135985851
Iteration: 642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906172156333923, gen p mean: -0.7548649311065674, mean p set: 0.4495420455932617
The modified gen p mean: 0.4487769305706024, gen p mean: -0.7511484622955322, mean p set: 0.4492571949958801
The modified gen p mean: 0.44736185669898987, gen p mean: -0.7482031583786011, mean p set: 0.44784215092658997
loss_pred:0.025878911837935448, decouple_loss:0.0080867325887084loss_pred:0.025198539718985558, decouple_loss:0.008004658855497837
loss_pred:0.02612510323524475, decouple_loss:0.008001496084034443
Iteration: 643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725486636161804, gen p mean: -0.737001359462738, mean p set: 0.44773516058921814
The modified gen p mean: 0.44814610481262207, gen p mean: -0.7475559115409851, mean p set: 0.4486263692378998
loss_pred:0.026332523673772812, decouple_loss:0.008131757378578186
The modified gen p mean: 0.4472711682319641, gen p mean: -0.7470607757568359, mean p set: 0.4477514326572418
loss_pred:0.026051567867398262, decouple_loss:0.00795820727944374
loss_pred:0.02609299123287201, decouple_loss:0.007972023449838161
Iteration: 644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490264058113098, gen p mean: -0.7468051314353943, mean p set: 0.4495067000389099
The modified gen p mean: 0.4475186765193939, gen p mean: -0.746659517288208, mean p set: 0.4479990005493164
loss_pred:0.024447239935398102, decouple_loss:0.007889303378760815
loss_pred:0.02450440637767315, decouple_loss:0.007752844598144293
The modified gen p mean: 0.4473142623901367, gen p mean: -0.7351646423339844, mean p set: 0.4477945566177368
loss_pred:0.02634073980152607, decouple_loss:0.008092005737125874
Iteration: 645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872990250587463, gen p mean: -0.7563421130180359, mean p set: 0.44921019673347473
The modified gen p mean: 0.4480278193950653, gen p mean: -0.7461186647415161, mean p set: 0.4485081434249878
The modified gen p mean: 0.44812270998954773, gen p mean: -0.748824417591095, mean p set: 0.44860297441482544
loss_pred:0.02459307760000229, decouple_loss:0.008127874694764614
loss_pred:0.026135947555303574, decouple_loss:0.007899431511759758
loss_pred:0.024617940187454224, decouple_loss:0.007680349983274937
Iteration: 646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493856132030487, gen p mean: -0.748907208442688, mean p set: 0.4498658776283264
The modified gen p mean: 0.4485977590084076, gen p mean: -0.7517040371894836, mean p set: 0.4490780532360077
The modified gen p mean: 0.4477311670780182, gen p mean: -0.7457338571548462, mean p set: 0.4482114315032959
loss_pred:0.025471126660704613, decouple_loss:0.00749689107760787
loss_pred:0.025629686191678047, decouple_loss:0.007562282029539347
loss_pred:0.024858420714735985, decouple_loss:0.007382233627140522
Iteration: 647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483235776424408, gen p mean: -0.7499478459358215, mean p set: 0.4488038718700409
The modified gen p mean: 0.447090744972229, gen p mean: -0.7422409057617188, mean p set: 0.4475710391998291
The modified gen p mean: 0.448378324508667, gen p mean: -0.7468833923339844, mean p set: 0.4488586187362671
loss_pred:0.02451374940574169, decouple_loss:0.007595575414597988
loss_pred:0.024827444925904274, decouple_loss:0.007443308364599943
loss_pred:0.02517959475517273, decouple_loss:0.007330665830522776
Iteration: 648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483753740787506, gen p mean: -0.7411273121833801, mean p set: 0.4488556683063507
The modified gen p mean: 0.44808006286621094, gen p mean: -0.7443404793739319, mean p set: 0.44856035709381104
The modified gen p mean: 0.44763848185539246, gen p mean: -0.7474341988563538, mean p set: 0.44811877608299255
loss_pred:0.025813372805714607, decouple_loss:0.00740684662014246
loss_pred:0.025282278656959534, decouple_loss:0.007600812707096338
loss_pred:0.024768147617578506, decouple_loss:0.007461716886609793
Iteration: 649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481548070907593, gen p mean: -0.744871973991394, mean p set: 0.4486351013183594
The modified gen p mean: 0.44711461663246155, gen p mean: -0.7476206421852112, mean p set: 0.44759488105773926
loss_pred:0.02508092299103737, decouple_loss:0.007246752735227346
loss_pred:0.025804979726672173, decouple_loss:0.00755260419100523
The modified gen p mean: 0.44834771752357483, gen p mean: -0.7513324618339539, mean p set: 0.4488280117511749
loss_pred:0.024989549070596695, decouple_loss:0.007202652748674154
Iteration: 650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480271339416504, gen p mean: -0.7610604763031006, mean p set: 0.4485073983669281
The modified gen p mean: 0.4483779966831207, gen p mean: -0.7573990821838379, mean p set: 0.4488582909107208
The modified gen p mean: 0.446613073348999, gen p mean: -0.7535674571990967, mean p set: 0.4470933675765991
loss_pred:0.02507876791059971, decouple_loss:0.007664938922971487loss_pred:0.025439903140068054, decouple_loss:0.007410996127873659
loss_pred:0.0250997357070446, decouple_loss:0.007516853976994753
2023-05-06 23:07:28 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.764870285987854, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7528126239776611, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.757703959941864, mean p set: 0.4500633478164673
loss_pred:0.026424754410982132, decouple_loss:0.00762718403711915
loss_pred:0.025123421102762222, decouple_loss:0.007369441911578178
loss_pred:0.025371355935931206, decouple_loss:0.007337961345911026
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026012089103460312, avg_mse: 0.03152381628751755
current test mse: 0.031524
Iteration: 651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446932315826416, gen p mean: -0.7529587149620056, mean p set: 0.4474125802516937
The modified gen p mean: 0.44755682349205017, gen p mean: -0.7567110061645508, mean p set: 0.44803711771965027
loss_pred:0.02444062940776348, decouple_loss:0.007145412266254425
loss_pred:0.025917455554008484, decouple_loss:0.007387381047010422
The modified gen p mean: 0.4479518234729767, gen p mean: -0.7629466652870178, mean p set: 0.44843214750289917
loss_pred:0.024523071944713593, decouple_loss:0.007167295087128878
Iteration: 652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762122631073, gen p mean: -0.7487803101539612, mean p set: 0.4481014907360077
The modified gen p mean: 0.4479582905769348, gen p mean: -0.7495308518409729, mean p set: 0.4484385848045349
The modified gen p mean: 0.4486527442932129, gen p mean: -0.7555366158485413, mean p set: 0.449133038520813
loss_pred:0.024940533563494682, decouple_loss:0.00771413603797555loss_pred:0.02526482380926609, decouple_loss:0.00744589464738965
loss_pred:0.02524314448237419, decouple_loss:0.006918164435774088
Iteration: 653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729694724082947, gen p mean: -0.7521194815635681, mean p set: 0.44777724146842957
The modified gen p mean: 0.44750353693962097, gen p mean: -0.7498568892478943, mean p set: 0.44798383116722107
loss_pred:0.026207420974969864, decouple_loss:0.0074473787099123
loss_pred:0.026481086388230324, decouple_loss:0.0074447086080908775
The modified gen p mean: 0.44723644852638245, gen p mean: -0.741948127746582, mean p set: 0.44771671295166016
loss_pred:0.026331357657909393, decouple_loss:0.007549175526946783
Iteration: 654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476816654205322, gen p mean: -0.7521723508834839, mean p set: 0.44816192984580994
The modified gen p mean: 0.4484996497631073, gen p mean: -0.7642145156860352, mean p set: 0.4489799737930298
The modified gen p mean: 0.44822418689727783, gen p mean: -0.755551815032959, mean p set: 0.4487045109272003
loss_pred:0.024610033258795738, decouple_loss:0.007392453495413065
loss_pred:0.024771984666585922, decouple_loss:0.006943271029740572
loss_pred:0.025073526427149773, decouple_loss:0.007217695936560631
Iteration: 655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764864444732666, gen p mean: -0.7499095797538757, mean p set: 0.44812890887260437
The modified gen p mean: 0.448429673910141, gen p mean: -0.7615192532539368, mean p set: 0.4489099383354187
loss_pred:0.025363167747855186, decouple_loss:0.007145320065319538
loss_pred:0.024395771324634552, decouple_loss:0.0071961404755711555
The modified gen p mean: 0.4477725923061371, gen p mean: -0.7597447633743286, mean p set: 0.4482528567314148
loss_pred:0.024326421320438385, decouple_loss:0.007081037387251854
Iteration: 656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846054911613464, gen p mean: -0.764976978302002, mean p set: 0.44894084334373474
The modified gen p mean: 0.44715479016304016, gen p mean: -0.7616941928863525, mean p set: 0.44763508439064026
The modified gen p mean: 0.44796133041381836, gen p mean: -0.7588009834289551, mean p set: 0.44844159483909607
loss_pred:0.024565447121858597, decouple_loss:0.007276666816323996
loss_pred:0.02485112100839615, decouple_loss:0.00714515196159482
loss_pred:0.024504510685801506, decouple_loss:0.007181345950812101
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
NaN value num: 0
Iteration: 657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519352614879608, gen p mean: -0.7586343288421631, mean p set: 0.4524155259132385
The modified gen p mean: 0.45230743288993835, gen p mean: -0.7478371858596802, mean p set: 0.45278772711753845
The modified gen p mean: 0.45178577303886414, gen p mean: -0.750995397567749, mean p set: 0.4522660970687866
loss_pred:0.027404069900512695, decouple_loss:0.008128773421049118
loss_pred:0.027455635368824005, decouple_loss:0.00857746135443449
loss_pred:0.02589074894785881, decouple_loss:0.008159076794981956
Iteration: 658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531635642051697, gen p mean: -0.7547639012336731, mean p set: 0.4536438286304474
The modified gen p mean: 0.45224201679229736, gen p mean: -0.7679378390312195, mean p set: 0.45272231101989746
loss_pred:0.02653433568775654, decouple_loss:0.008259628899395466
loss_pred:0.025070959702134132, decouple_loss:0.0077879647724330425
The modified gen p mean: 0.4524392783641815, gen p mean: -0.7652999758720398, mean p set: 0.4529195725917816
loss_pred:0.0259433351457119, decouple_loss:0.007566223386675119
Iteration: 659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45225897431373596, gen p mean: -0.7777672410011292, mean p set: 0.45273926854133606
The modified gen p mean: 0.45184892416000366, gen p mean: -0.7693908214569092, mean p set: 0.45232921838760376
The modified gen p mean: 0.45474690198898315, gen p mean: -0.7674475312232971, mean p set: 0.45522719621658325
loss_pred:0.025298312306404114, decouple_loss:0.007544306106865406
loss_pred:0.025784537196159363, decouple_loss:0.007381033152341843
loss_pred:0.026548204943537712, decouple_loss:0.007636409718543291
Iteration: 660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45160800218582153, gen p mean: -0.769662618637085, mean p set: 0.45208826661109924
The modified gen p mean: 0.45303651690483093, gen p mean: -0.7698943614959717, mean p set: 0.45351678133010864
The modified gen p mean: 0.4527120292186737, gen p mean: -0.7758047580718994, mean p set: 0.4531923532485962
loss_pred:0.02435874752700329, decouple_loss:0.007447719108313322
loss_pred:0.025842266157269478, decouple_loss:0.007536350283771753
loss_pred:0.025595493614673615, decouple_loss:0.007324799429625273
2023-05-06 23:12:01 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7716644406318665, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7594659328460693, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7638049721717834, mean p set: 0.4500633478164673
loss_pred:0.026645883917808533, decouple_loss:0.008018496446311474
loss_pred:0.025210680440068245, decouple_loss:0.007792458403855562
loss_pred:0.02555188164114952, decouple_loss:0.0077423397451639175
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026195373386144638, avg_mse: 0.031867559999227524
current test mse: 0.031868
Iteration: 661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4543944299221039, gen p mean: -0.7578439712524414, mean p set: 0.4548746943473816
The modified gen p mean: 0.45200395584106445, gen p mean: -0.7656258940696716, mean p set: 0.45248425006866455
loss_pred:0.025887006893754005, decouple_loss:0.007601133082062006
loss_pred:0.025837376713752747, decouple_loss:0.0070802317932248116
The modified gen p mean: 0.4536791443824768, gen p mean: -0.757931113243103, mean p set: 0.4541594386100769
loss_pred:0.02580682933330536, decouple_loss:0.0077836764976382256
Iteration: 662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535723030567169, gen p mean: -0.761157214641571, mean p set: 0.45405256748199463
The modified gen p mean: 0.453336626291275, gen p mean: -0.7599684000015259, mean p set: 0.4538169205188751
loss_pred:0.026055091992020607, decouple_loss:0.007819033227860928
loss_pred:0.024716749787330627, decouple_loss:0.007368017453700304
The modified gen p mean: 0.4536444842815399, gen p mean: -0.754330575466156, mean p set: 0.45412477850914
loss_pred:0.025936441496014595, decouple_loss:0.007514210417866707
Iteration: 663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519031345844269, gen p mean: -0.7506692409515381, mean p set: 0.452383428812027
The modified gen p mean: 0.451764315366745, gen p mean: -0.7494917511940002, mean p set: 0.4522446393966675
loss_pred:0.026313165202736855, decouple_loss:0.007460727356374264
The modified gen p mean: 0.4526750147342682, gen p mean: -0.7502673864364624, mean p set: 0.4531553387641907loss_pred:0.026442065834999084, decouple_loss:0.007409889250993729
loss_pred:0.025371767580509186, decouple_loss:0.007010024506598711
Iteration: 664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45232123136520386, gen p mean: -0.750435471534729, mean p set: 0.45280152559280396
The modified gen p mean: 0.4525024890899658, gen p mean: -0.7516317963600159, mean p set: 0.45298275351524353
The modified gen p mean: 0.4538275897502899, gen p mean: -0.7598780393600464, mean p set: 0.4543079137802124
loss_pred:0.02617753855884075, decouple_loss:0.007918182760477066
loss_pred:0.026192443445324898, decouple_loss:0.007808064576238394
loss_pred:0.025836512446403503, decouple_loss:0.00707259913906455
Iteration: 665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519207775592804, gen p mean: -0.7515352964401245, mean p set: 0.4524010717868805
The modified gen p mean: 0.4527387320995331, gen p mean: -0.7646927833557129, mean p set: 0.4532190263271332
The modified gen p mean: 0.4516642093658447, gen p mean: -0.7560882568359375, mean p set: 0.45214447379112244
loss_pred:0.026356259360909462, decouple_loss:0.00794745609164238
loss_pred:0.025244439020752907, decouple_loss:0.007515627890825272
loss_pred:0.026382479816675186, decouple_loss:0.007325341459363699
Iteration: 666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523218870162964, gen p mean: -0.7620474100112915, mean p set: 0.4528021812438965
The modified gen p mean: 0.45436644554138184, gen p mean: -0.7604751586914062, mean p set: 0.45484670996665955
loss_pred:0.02665659971535206, decouple_loss:0.007549349684268236
loss_pred:0.02560446783900261, decouple_loss:0.007621526252478361
The modified gen p mean: 0.4515621066093445, gen p mean: -0.755025327205658, mean p set: 0.4520424008369446
loss_pred:0.026450594887137413, decouple_loss:0.007567571941763163
Iteration: 667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45173004269599915, gen p mean: -0.7653091549873352, mean p set: 0.45221033692359924
The modified gen p mean: 0.4533623158931732, gen p mean: -0.7657294273376465, mean p set: 0.4538425803184509
The modified gen p mean: 0.45458194613456726, gen p mean: -0.7579994201660156, mean p set: 0.45506227016448975
loss_pred:0.02481638826429844, decouple_loss:0.007167469244450331
loss_pred:0.026584189385175705, decouple_loss:0.006928971502929926
loss_pred:0.025639690458774567, decouple_loss:0.007192753721028566
Iteration: 668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530549943447113, gen p mean: -0.7706563472747803, mean p set: 0.4535352885723114
The modified gen p mean: 0.4518159031867981, gen p mean: -0.7673457264900208, mean p set: 0.4522961974143982
The modified gen p mean: 0.4528390169143677, gen p mean: -0.7702727317810059, mean p set: 0.45331934094429016
loss_pred:0.025379041209816933, decouple_loss:0.008040515705943108
loss_pred:0.026284988969564438, decouple_loss:0.007053378503769636
loss_pred:0.02554961107671261, decouple_loss:0.007821549661457539
Iteration: 669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539492726325989, gen p mean: -0.7669954299926758, mean p set: 0.454429566860199
The modified gen p mean: 0.4526388645172119, gen p mean: -0.7678843140602112, mean p set: 0.453119158744812
The modified gen p mean: 0.45329636335372925, gen p mean: -0.7762907147407532, mean p set: 0.45377665758132935
loss_pred:0.0253060944378376, decouple_loss:0.007181401364505291
loss_pred:0.026123395189642906, decouple_loss:0.007491410709917545
loss_pred:0.024918876588344574, decouple_loss:0.007335407193750143
Iteration: 670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45258259773254395, gen p mean: -0.7698907852172852, mean p set: 0.45306292176246643
The modified gen p mean: 0.4519190192222595, gen p mean: -0.7616040706634521, mean p set: 0.452399343252182
The modified gen p mean: 0.45290395617485046, gen p mean: -0.7626255750656128, mean p set: 0.4533842206001282
loss_pred:0.026179157197475433, decouple_loss:0.007518857717514038
loss_pred:0.02551235444843769, decouple_loss:0.007074391003698111
loss_pred:0.026423830538988113, decouple_loss:0.007078693713992834
2023-05-06 23:15:39 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7714112401008606, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.758186936378479, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7630853652954102, mean p set: 0.4500633478164673
loss_pred:0.02671429142355919, decouple_loss:0.007941332645714283
loss_pred:0.02533874474465847, decouple_loss:0.007826057262718678
loss_pred:0.02567139081656933, decouple_loss:0.007803662214428186
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02630099467933178, avg_mse: 0.03212154656648636
current test mse: 0.032122
Iteration: 671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503503441810608, gen p mean: -0.7586987614631653, mean p set: 0.4508306682109833
The modified gen p mean: 0.45171183347702026, gen p mean: -0.7678471803665161, mean p set: 0.45219212770462036
loss_pred:0.025920672342181206, decouple_loss:0.0072007267735898495
loss_pred:0.025046594440937042, decouple_loss:0.007147802505642176
The modified gen p mean: 0.4515564441680908, gen p mean: -0.7555562853813171, mean p set: 0.45203670859336853
loss_pred:0.026208287104964256, decouple_loss:0.007273961324244738
Iteration: 672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45353958010673523, gen p mean: -0.7648367881774902, mean p set: 0.4540198743343353
The modified gen p mean: 0.4545176923274994, gen p mean: -0.7640340924263, mean p set: 0.4549979567527771
The modified gen p mean: 0.45094922184944153, gen p mean: -0.7585981488227844, mean p set: 0.4514295160770416
loss_pred:0.02547643519937992, decouple_loss:0.006868204101920128
loss_pred:0.025951821357011795, decouple_loss:0.0071118297055363655
loss_pred:0.025544974952936172, decouple_loss:0.0070718396455049515
Iteration: 673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525487720966339, gen p mean: -0.7574250102043152, mean p set: 0.4530290365219116
The modified gen p mean: 0.45108649134635925, gen p mean: -0.7615794539451599, mean p set: 0.45156678557395935
The modified gen p mean: 0.4518929421901703, gen p mean: -0.7518221735954285, mean p set: 0.4523732364177704
loss_pred:0.025028830394148827, decouple_loss:0.006819721776992083
loss_pred:0.026253558695316315, decouple_loss:0.007200901862233877
loss_pred:0.026507150381803513, decouple_loss:0.007023606449365616
Iteration: 674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128047466278076, gen p mean: -0.7650657296180725, mean p set: 0.45176076889038086
The modified gen p mean: 0.45314475893974304, gen p mean: -0.7574127316474915, mean p set: 0.45362505316734314
loss_pred:0.023654336109757423, decouple_loss:0.006723826751112938
loss_pred:0.026257194578647614, decouple_loss:0.007003116887062788
The modified gen p mean: 0.45203307271003723, gen p mean: -0.7594111561775208, mean p set: 0.45251336693763733
loss_pred:0.026773491874337196, decouple_loss:0.007350732106715441
Iteration: 675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45369771122932434, gen p mean: -0.7713106870651245, mean p set: 0.45417800545692444
The modified gen p mean: 0.4532589316368103, gen p mean: -0.7708429098129272, mean p set: 0.4537392258644104
The modified gen p mean: 0.451107382774353, gen p mean: -0.7649621367454529, mean p set: 0.45158764719963074
loss_pred:0.025710415095090866, decouple_loss:0.006991511210799217
loss_pred:0.025992387905716896, decouple_loss:0.006963349878787994
loss_pred:0.025792822241783142, decouple_loss:0.0068051484413445
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
NaN value num: 0
Iteration: 676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45159292221069336, gen p mean: -0.777407705783844, mean p set: 0.45207321643829346
The modified gen p mean: 0.4514003098011017, gen p mean: -0.7769683599472046, mean p set: 0.4518806040287018
The modified gen p mean: 0.44972312450408936, gen p mean: -0.7759931683540344, mean p set: 0.45020341873168945
loss_pred:0.025050243362784386, decouple_loss:0.007546421140432358
loss_pred:0.02539295330643654, decouple_loss:0.007177453953772783
loss_pred:0.025804271921515465, decouple_loss:0.007385720498859882
Iteration: 677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493807256221771, gen p mean: -0.772812008857727, mean p set: 0.4498610198497772
The modified gen p mean: 0.44943132996559143, gen p mean: -0.7740522623062134, mean p set: 0.44991159439086914
The modified gen p mean: 0.44990983605384827, gen p mean: -0.7716702818870544, mean p set: 0.45039013028144836
loss_pred:0.025589846074581146, decouple_loss:0.007015042472630739
loss_pred:0.023797987028956413, decouple_loss:0.007285127881914377
loss_pred:0.025307560339570045, decouple_loss:0.007166650146245956
Iteration: 678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121848583221436, gen p mean: -0.7719519138336182, mean p set: 0.45169880986213684The modified gen p mean: 0.44946160912513733, gen p mean: -0.7782799601554871, mean p set: 0.44994187355041504
The modified gen p mean: 0.4495282769203186, gen p mean: -0.7655941247940063, mean p set: 0.4500085711479187
loss_pred:0.024192754179239273, decouple_loss:0.007401314098387957
loss_pred:0.024761220440268517, decouple_loss:0.007056912407279015
loss_pred:0.024868030101060867, decouple_loss:0.006964683532714844
Iteration: 679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934192299842834, gen p mean: -0.7541818618774414, mean p set: 0.44982221722602844
The modified gen p mean: 0.4518599212169647, gen p mean: -0.7677973508834839, mean p set: 0.4523402154445648
The modified gen p mean: 0.449905127286911, gen p mean: -0.7600896954536438, mean p set: 0.4503854513168335
loss_pred:0.025414537638425827, decouple_loss:0.007288648281246424
loss_pred:0.026124464347958565, decouple_loss:0.007068015169352293
loss_pred:0.023316286504268646, decouple_loss:0.007009892258793116
Iteration: 680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495278596878052, gen p mean: -0.7735751867294312, mean p set: 0.4500081539154053
The modified gen p mean: 0.450175404548645, gen p mean: -0.7748522162437439, mean p set: 0.45065566897392273
The modified gen p mean: 0.45032092928886414, gen p mean: -0.7741987705230713, mean p set: 0.45080122351646423
loss_pred:0.024877207353711128, decouple_loss:0.006918430328369141
loss_pred:0.024913078173995018, decouple_loss:0.007067470345646143
loss_pred:0.025268517434597015, decouple_loss:0.007166105788201094
2023-05-06 23:20:52 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7817791104316711, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.768915593624115, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7741336226463318, mean p set: 0.4500633478164673
loss_pred:0.026639997959136963, decouple_loss:0.007841185666620731
loss_pred:0.0252255629748106, decouple_loss:0.0076062120497226715
loss_pred:0.025514157488942146, decouple_loss:0.0075357151217758656
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026176292449235916, avg_mse: 0.03187887743115425
current test mse: 0.031879
Iteration: 681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492534101009369, gen p mean: -0.7688670754432678, mean p set: 0.4497336745262146
The modified gen p mean: 0.4504595994949341, gen p mean: -0.7789778709411621, mean p set: 0.45093992352485657
loss_pred:0.024542076513171196, decouple_loss:0.006931081879884005
loss_pred:0.025659000501036644, decouple_loss:0.006818360183387995
The modified gen p mean: 0.45139554142951965, gen p mean: -0.7783670425415039, mean p set: 0.45187583565711975
loss_pred:0.025684934109449387, decouple_loss:0.007025357335805893
Iteration: 682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900307059288025, gen p mean: -0.7665194272994995, mean p set: 0.44948339462280273
The modified gen p mean: 0.450796902179718, gen p mean: -0.7720590829849243, mean p set: 0.4512771964073181
The modified gen p mean: 0.44964835047721863, gen p mean: -0.7770119905471802, mean p set: 0.4501286447048187
loss_pred:0.024248452857136726, decouple_loss:0.0069582643918693066
loss_pred:0.02509486861526966, decouple_loss:0.00736740417778492
loss_pred:0.023351415991783142, decouple_loss:0.007428557146340609
Iteration: 683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948169589042664, gen p mean: -0.7604419589042664, mean p set: 0.44996196031570435
The modified gen p mean: 0.44902917742729187, gen p mean: -0.7618411779403687, mean p set: 0.44950950145721436
The modified gen p mean: 0.4498801827430725, gen p mean: -0.7742189168930054, mean p set: 0.4503604471683502
loss_pred:0.025250203907489777, decouple_loss:0.007095702923834324
loss_pred:0.02506682649254799, decouple_loss:0.0070815603248775005
loss_pred:0.02375231310725212, decouple_loss:0.0070943390019237995
Iteration: 684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45009535551071167, gen p mean: -0.7623733878135681, mean p set: 0.4505756199359894
The modified gen p mean: 0.45003461837768555, gen p mean: -0.7780356407165527, mean p set: 0.45051491260528564
The modified gen p mean: 0.4497954249382019, gen p mean: -0.7775889039039612, mean p set: 0.450275719165802
loss_pred:0.025805838406085968, decouple_loss:0.00708615081384778
loss_pred:0.02410418912768364, decouple_loss:0.007187856826931238
loss_pred:0.022642644122242928, decouple_loss:0.007241006009280682
Iteration: 685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44913122057914734, gen p mean: -0.7728168368339539, mean p set: 0.44961148500442505
The modified gen p mean: 0.4489581882953644, gen p mean: -0.7684813141822815, mean p set: 0.4494384825229645
The modified gen p mean: 0.45126524567604065, gen p mean: -0.770755410194397, mean p set: 0.45174553990364075
loss_pred:0.023885447531938553, decouple_loss:0.006752304267138243
loss_pred:0.0234378669410944, decouple_loss:0.007059953641146421
loss_pred:0.025533532723784447, decouple_loss:0.007418839260935783
Iteration: 686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504971206188202, gen p mean: -0.7660245299339294, mean p set: 0.4509774148464203
The modified gen p mean: 0.4490774869918823, gen p mean: -0.7692455053329468, mean p set: 0.4495577812194824
The modified gen p mean: 0.45152056217193604, gen p mean: -0.7666647434234619, mean p set: 0.45200085639953613
loss_pred:0.02520045079290867, decouple_loss:0.006918339058756828
loss_pred:0.024385780096054077, decouple_loss:0.006828530691564083
loss_pred:0.024499647319316864, decouple_loss:0.006897378712892532
Iteration: 687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023706555366516, gen p mean: -0.7631839513778687, mean p set: 0.45071735978126526
The modified gen p mean: 0.4493030309677124, gen p mean: -0.7604647278785706, mean p set: 0.4497832953929901
The modified gen p mean: 0.44988110661506653, gen p mean: -0.7709524035453796, mean p set: 0.4503614008426666
loss_pred:0.023760749027132988, decouple_loss:0.006814192980527878
loss_pred:0.025087039917707443, decouple_loss:0.00683109974488616
loss_pred:0.024824580177664757, decouple_loss:0.006789491977542639
Iteration: 688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958746433258057, gen p mean: -0.7571596503257751, mean p set: 0.45006775856018066
The modified gen p mean: 0.4511414170265198, gen p mean: -0.7652630805969238, mean p set: 0.4516216814517975
The modified gen p mean: 0.4511968493461609, gen p mean: -0.7624021172523499, mean p set: 0.451677143573761
loss_pred:0.023992221802473068, decouple_loss:0.006628342438489199
loss_pred:0.02530376985669136, decouple_loss:0.006762860342860222
loss_pred:0.024495579302310944, decouple_loss:0.006961193401366472
Iteration: 689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452597975730896, gen p mean: -0.7572306990623474, mean p set: 0.4530782699584961
The modified gen p mean: 0.44930359721183777, gen p mean: -0.7640560269355774, mean p set: 0.44978389143943787
The modified gen p mean: 0.45185157656669617, gen p mean: -0.7686084508895874, mean p set: 0.45233187079429626
loss_pred:0.025378884747624397, decouple_loss:0.006960600148886442
loss_pred:0.02333684265613556, decouple_loss:0.006792259868234396
loss_pred:0.025378169491887093, decouple_loss:0.006729982327669859
Iteration: 690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972214102745056, gen p mean: -0.7692897915840149, mean p set: 0.45020246505737305
The modified gen p mean: 0.4496802091598511, gen p mean: -0.7780494689941406, mean p set: 0.4501604735851288
The modified gen p mean: 0.4497600495815277, gen p mean: -0.7734105587005615, mean p set: 0.4502403438091278
loss_pred:0.024848047643899918, decouple_loss:0.006602171808481216
loss_pred:0.023537427186965942, decouple_loss:0.006984335836023092
loss_pred:0.024129046127200127, decouple_loss:0.006985046900808811
2023-05-06 23:24:31 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7812345623970032, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7694060802459717, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7735668420791626, mean p set: 0.4500633478164673
loss_pred:0.02655564248561859, decouple_loss:0.0076940106227993965
loss_pred:0.02522769756615162, decouple_loss:0.007495879661291838
loss_pred:0.02555590681731701, decouple_loss:0.007318930234760046
WV_0_PC_1_EH_0_PS_40_6, loss: 0.0261548962444067, avg_mse: 0.03195564076304436
current test mse: 0.031956
Iteration: 691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493320882320404, gen p mean: -0.7794672250747681, mean p set: 0.4498123526573181
loss_pred:0.024614347144961357, decouple_loss:0.006461049430072308
The modified gen p mean: 0.44922783970832825, gen p mean: -0.7821947336196899, mean p set: 0.44970813393592834
loss_pred:0.024168409407138824, decouple_loss:0.006830122787505388
The modified gen p mean: 0.45019733905792236, gen p mean: -0.7730824947357178, mean p set: 0.45067763328552246
loss_pred:0.024804355576634407, decouple_loss:0.006981896236538887
Iteration: 692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909989833831787, gen p mean: -0.7827447056770325, mean p set: 0.44958019256591797
The modified gen p mean: 0.45158398151397705, gen p mean: -0.7748982906341553, mean p set: 0.45206427574157715
The modified gen p mean: 0.4491126239299774, gen p mean: -0.7716895341873169, mean p set: 0.4495929181575775
loss_pred:0.023469476029276848, decouple_loss:0.006826033815741539
loss_pred:0.02524656243622303, decouple_loss:0.006761698983609676
loss_pred:0.024345634505152702, decouple_loss:0.0066740321926772594
Iteration: 693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512721002101898, gen p mean: -0.7648124694824219, mean p set: 0.45175236463546753
The modified gen p mean: 0.4498962461948395, gen p mean: -0.7759948372840881, mean p set: 0.4503765404224396
The modified gen p mean: 0.4511229991912842, gen p mean: -0.7755682468414307, mean p set: 0.4516032636165619
loss_pred:0.0255899615585804, decouple_loss:0.006921953987330198
loss_pred:0.024740925058722496, decouple_loss:0.006783125922083855
loss_pred:0.02397787757217884, decouple_loss:0.007164755370467901
Iteration: 694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490946829319, gen p mean: -0.7703458666801453, mean p set: 0.44957494735717773
The modified gen p mean: 0.4506269693374634, gen p mean: -0.778770923614502, mean p set: 0.4511072635650635
The modified gen p mean: 0.45217129588127136, gen p mean: -0.770320475101471, mean p set: 0.45265159010887146
loss_pred:0.02281239442527294, decouple_loss:0.006770995445549488
loss_pred:0.024861706420779228, decouple_loss:0.006620681378990412
loss_pred:0.024835245683789253, decouple_loss:0.006999014411121607
Iteration: 695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497816562652588, gen p mean: -0.7792397141456604, mean p set: 0.4502619802951813The modified gen p mean: 0.449188768863678, gen p mean: -0.7874193787574768, mean p set: 0.4496690630912781
loss_pred:0.023809578269720078, decouple_loss:0.006436485797166824
loss_pred:0.024568699300289154, decouple_loss:0.006388659123331308
The modified gen p mean: 0.4491424560546875, gen p mean: -0.7826310396194458, mean p set: 0.4496227502822876
loss_pred:0.022836297750473022, decouple_loss:0.006566107273101807
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
NaN value num: 0
Iteration: 696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452044278383255, gen p mean: -0.7720997333526611, mean p set: 0.4525245428085327
The modified gen p mean: 0.4514700770378113, gen p mean: -0.7721436619758606, mean p set: 0.45195040106773376
The modified gen p mean: 0.4532153904438019, gen p mean: -0.77974534034729, mean p set: 0.453695684671402
loss_pred:0.02467222325503826, decouple_loss:0.007319307420402765
loss_pred:0.02486296556890011, decouple_loss:0.006993470713496208
loss_pred:0.02407481148838997, decouple_loss:0.007339338771998882
Iteration: 697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45112621784210205, gen p mean: -0.7774524092674255, mean p set: 0.45160651206970215
The modified gen p mean: 0.4539720416069031, gen p mean: -0.7792693376541138, mean p set: 0.45445236563682556
loss_pred:0.026300756260752678, decouple_loss:0.007033616304397583
loss_pred:0.025324882939457893, decouple_loss:0.006873580627143383
The modified gen p mean: 0.4507308900356293, gen p mean: -0.7627452611923218, mean p set: 0.45121118426322937
loss_pred:0.02567683719098568, decouple_loss:0.007442455738782883
Iteration: 698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511578381061554, gen p mean: -0.7834779024124146, mean p set: 0.4516381621360779
The modified gen p mean: 0.4515658915042877, gen p mean: -0.7822152376174927, mean p set: 0.45204612612724304
The modified gen p mean: 0.4532765746116638, gen p mean: -0.7779245972633362, mean p set: 0.4537568688392639
loss_pred:0.02582804672420025, decouple_loss:0.0068449899554252625
loss_pred:0.024313820526003838, decouple_loss:0.006670464761555195
loss_pred:0.02458232268691063, decouple_loss:0.0068050771951675415
Iteration: 699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525543451309204, gen p mean: -0.7660003304481506, mean p set: 0.4530346095561981
The modified gen p mean: 0.45111456513404846, gen p mean: -0.769865870475769, mean p set: 0.45159485936164856
The modified gen p mean: 0.4511788487434387, gen p mean: -0.7612402439117432, mean p set: 0.4516591429710388
loss_pred:0.02498120814561844, decouple_loss:0.006850273814052343
loss_pred:0.024342786520719528, decouple_loss:0.006574837025254965
loss_pred:0.02480827271938324, decouple_loss:0.007142968010157347
Iteration: 700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45021769404411316, gen p mean: -0.7570993900299072, mean p set: 0.45069798827171326The modified gen p mean: 0.45270445942878723, gen p mean: -0.7617197036743164, mean p set: 0.45318475365638733
The modified gen p mean: 0.4532906711101532, gen p mean: -0.7637521028518677, mean p set: 0.4537709653377533
loss_pred:0.024235954508185387, decouple_loss:0.006590945180505514
loss_pred:0.02378731034696102, decouple_loss:0.006682477425783873
loss_pred:0.025517022237181664, decouple_loss:0.006921292748302221
2023-05-06 23:29:09 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.7718555927276611, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7597834467887878, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7636614441871643, mean p set: 0.4500633478164673
loss_pred:0.026521584019064903, decouple_loss:0.007752330508083105
loss_pred:0.025121482089161873, decouple_loss:0.007463204674422741
loss_pred:0.025436295196413994, decouple_loss:0.0074741896241903305
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02607128396630287, avg_mse: 0.03185127303004265
current test mse: 0.031851
Iteration: 701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538593888282776, gen p mean: -0.7671076059341431, mean p set: 0.4543396830558777
loss_pred:0.02511713281273842, decouple_loss:0.006726427935063839
The modified gen p mean: 0.45070749521255493, gen p mean: -0.7552511692047119, mean p set: 0.45118778944015503
loss_pred:0.02499086782336235, decouple_loss:0.006930713541805744
The modified gen p mean: 0.4534396529197693, gen p mean: -0.7643485069274902, mean p set: 0.4539199471473694
loss_pred:0.023761920630931854, decouple_loss:0.006413792725652456
Iteration: 702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510784447193146, gen p mean: -0.771325409412384, mean p set: 0.4515587389469147
The modified gen p mean: 0.45244091749191284, gen p mean: -0.761480450630188, mean p set: 0.45292118191719055
The modified gen p mean: 0.44989460706710815, gen p mean: -0.7637367844581604, mean p set: 0.45037490129470825
loss_pred:0.025564901530742645, decouple_loss:0.0069513083435595036
loss_pred:0.026334702968597412, decouple_loss:0.007097279652953148
loss_pred:0.026201069355010986, decouple_loss:0.007140173576772213
Iteration: 703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451603502035141, gen p mean: -0.7766560912132263, mean p set: 0.4520838260650635
The modified gen p mean: 0.45239225029945374, gen p mean: -0.7807045578956604, mean p set: 0.45287254452705383
The modified gen p mean: 0.45226433873176575, gen p mean: -0.7803521156311035, mean p set: 0.45274466276168823
loss_pred:0.025512779131531715, decouple_loss:0.00683969259262085loss_pred:0.025837501510977745, decouple_loss:0.007109656929969788
loss_pred:0.026130983605980873, decouple_loss:0.006851589772850275
Iteration: 704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45145928859710693, gen p mean: -0.7683854103088379, mean p set: 0.45193958282470703The modified gen p mean: 0.4512234926223755, gen p mean: -0.778927206993103, mean p set: 0.4517037868499756
The modified gen p mean: 0.4522682726383209, gen p mean: -0.7731972932815552, mean p set: 0.4527485966682434
loss_pred:0.024979492649435997, decouple_loss:0.006925791967660189
loss_pred:0.026149583980441093, decouple_loss:0.006762436591088772
loss_pred:0.025336435064673424, decouple_loss:0.006742453668266535
Iteration: 705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45161208510398865, gen p mean: -0.7697442770004272, mean p set: 0.45209240913391113
The modified gen p mean: 0.45160067081451416, gen p mean: -0.7595860958099365, mean p set: 0.45208099484443665
The modified gen p mean: 0.45174500346183777, gen p mean: -0.7643726468086243, mean p set: 0.45222529768943787
loss_pred:0.02495965175330639, decouple_loss:0.006668623071163893
loss_pred:0.025905253365635872, decouple_loss:0.006849522236734629
loss_pred:0.026507554575800896, decouple_loss:0.007051934488117695
Iteration: 706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45079344511032104, gen p mean: -0.7671372890472412, mean p set: 0.45127376914024353
The modified gen p mean: 0.4522475302219391, gen p mean: -0.764336884021759, mean p set: 0.4527277946472168
The modified gen p mean: 0.4502146244049072, gen p mean: -0.7676111459732056, mean p set: 0.4506949186325073
loss_pred:0.026592830196022987, decouple_loss:0.006794357672333717
loss_pred:0.026499567553400993, decouple_loss:0.006816650740802288
loss_pred:0.02669229730963707, decouple_loss:0.006699834950268269
Iteration: 707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513789713382721, gen p mean: -0.7746912240982056, mean p set: 0.4518592655658722
The modified gen p mean: 0.4519716203212738, gen p mean: -0.772518515586853, mean p set: 0.4524519443511963
The modified gen p mean: 0.4513148069381714, gen p mean: -0.7837535738945007, mean p set: 0.4517951011657715
loss_pred:0.026331702247262, decouple_loss:0.006755243521183729
loss_pred:0.026071598753333092, decouple_loss:0.006699110381305218
loss_pred:0.026003696024417877, decouple_loss:0.007007081527262926
Iteration: 708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45175790786743164, gen p mean: -0.7859271764755249, mean p set: 0.45223820209503174
The modified gen p mean: 0.4501608610153198, gen p mean: -0.7843670845031738, mean p set: 0.45064112544059753
loss_pred:0.02522498369216919, decouple_loss:0.006561913061887026
loss_pred:0.02599775232374668, decouple_loss:0.006347091402858496
The modified gen p mean: 0.4522639214992523, gen p mean: -0.7820388078689575, mean p set: 0.45274418592453003
loss_pred:0.02402345836162567, decouple_loss:0.006633272394537926
Iteration: 709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516028165817261, gen p mean: -0.7838570475578308, mean p set: 0.4520830810070038
The modified gen p mean: 0.4512425363063812, gen p mean: -0.795293927192688, mean p set: 0.4517228305339813
The modified gen p mean: 0.4520164132118225, gen p mean: -0.7768048644065857, mean p set: 0.4524966776371002
loss_pred:0.026361428201198578, decouple_loss:0.0066839177161455154
loss_pred:0.025831330567598343, decouple_loss:0.006754765287041664
loss_pred:0.026394905522465706, decouple_loss:0.006563446018844843
Iteration: 710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505658447742462, gen p mean: -0.787888765335083, mean p set: 0.4510461390018463
The modified gen p mean: 0.4514193832874298, gen p mean: -0.7742323279380798, mean p set: 0.4518997073173523
The modified gen p mean: 0.45178744196891785, gen p mean: -0.7876915335655212, mean p set: 0.45226770639419556
loss_pred:0.02623976767063141, decouple_loss:0.0066263130865991116
loss_pred:0.02631690725684166, decouple_loss:0.006383582018315792
loss_pred:0.024425843730568886, decouple_loss:0.006540350150316954
2023-05-06 23:32:47 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7859728336334229, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7732920050621033, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7779328227043152, mean p set: 0.4500633478164673
loss_pred:0.026670807972550392, decouple_loss:0.007559869904071093
loss_pred:0.025255510583519936, decouple_loss:0.007294309791177511
loss_pred:0.025675997138023376, decouple_loss:0.007351892068982124
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02623753994703293, avg_mse: 0.03210773319005966
current test mse: 0.032108
Iteration: 711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505062401294708, gen p mean: -0.7747412919998169, mean p set: 0.45098650455474854
The modified gen p mean: 0.4525368809700012, gen p mean: -0.7852047085762024, mean p set: 0.45301714539527893
loss_pred:0.02415303699672222, decouple_loss:0.006503610406070948
loss_pred:0.025827303528785706, decouple_loss:0.006650480907410383
The modified gen p mean: 0.4511440396308899, gen p mean: -0.7848149538040161, mean p set: 0.45162433385849
loss_pred:0.026373786851763725, decouple_loss:0.0065852063708007336
Iteration: 712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45206692814826965, gen p mean: -0.7692695260047913, mean p set: 0.45254722237586975
The modified gen p mean: 0.4514380693435669, gen p mean: -0.7656148076057434, mean p set: 0.451918363571167
loss_pred:0.024382280185818672, decouple_loss:0.006677890196442604
loss_pred:0.024706585332751274, decouple_loss:0.007091776467859745
The modified gen p mean: 0.45154112577438354, gen p mean: -0.7649547457695007, mean p set: 0.45202142000198364
loss_pred:0.025930341333150864, decouple_loss:0.006586973089724779
Iteration: 713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506746828556061, gen p mean: -0.7669597864151001, mean p set: 0.4511549472808838
The modified gen p mean: 0.4514394998550415, gen p mean: -0.7540037631988525, mean p set: 0.4519197940826416
loss_pred:0.02616169862449169, decouple_loss:0.006516791880130768
loss_pred:0.025486459955573082, decouple_loss:0.006742684170603752
The modified gen p mean: 0.4506472647190094, gen p mean: -0.7581405639648438, mean p set: 0.4511275291442871
loss_pred:0.025853212922811508, decouple_loss:0.006894863676279783
Iteration: 714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450717568397522, gen p mean: -0.7626169919967651, mean p set: 0.45119786262512207
The modified gen p mean: 0.4507941007614136, gen p mean: -0.7583522796630859, mean p set: 0.45127442479133606
The modified gen p mean: 0.4506503641605377, gen p mean: -0.7636919021606445, mean p set: 0.4511306881904602
loss_pred:0.025580396875739098, decouple_loss:0.006682116072624922
loss_pred:0.025333816185593605, decouple_loss:0.006800862494856119
loss_pred:0.02485531195998192, decouple_loss:0.006207872182130814
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
NaN value num: 0
Iteration: 715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470100402832031, gen p mean: -0.7813719511032104, mean p set: 0.4474903643131256
The modified gen p mean: 0.4463682174682617, gen p mean: -0.7817762494087219, mean p set: 0.4468485414981842
The modified gen p mean: 0.4466865062713623, gen p mean: -0.7659314274787903, mean p set: 0.4471668004989624
loss_pred:0.026143737137317657, decouple_loss:0.007583939004689455
loss_pred:0.027188872918486595, decouple_loss:0.007381817791610956
loss_pred:0.026537280529737473, decouple_loss:0.007647268008440733
Iteration: 716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480167329311371, gen p mean: -0.7923427224159241, mean p set: 0.4484969973564148
The modified gen p mean: 0.4477671682834625, gen p mean: -0.7910820841789246, mean p set: 0.44824743270874023
The modified gen p mean: 0.4462626874446869, gen p mean: -0.7922431826591492, mean p set: 0.446742981672287
loss_pred:0.027998371049761772, decouple_loss:0.00747658172622323
loss_pred:0.028045235201716423, decouple_loss:0.007229954469949007
loss_pred:0.0269742663949728, decouple_loss:0.007389134261757135
Iteration: 717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44636473059654236, gen p mean: -0.8020305037498474, mean p set: 0.44684502482414246
The modified gen p mean: 0.44780921936035156, gen p mean: -0.7897936701774597, mean p set: 0.44828951358795166
The modified gen p mean: 0.44618138670921326, gen p mean: -0.8041670322418213, mean p set: 0.44666171073913574
loss_pred:0.026172341778874397, decouple_loss:0.0071362704038619995
loss_pred:0.026024136692285538, decouple_loss:0.007186159957200289
loss_pred:0.026392880827188492, decouple_loss:0.007208073977380991
Iteration: 718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468817412853241, gen p mean: -0.7945642471313477, mean p set: 0.4473620653152466
The modified gen p mean: 0.44634950160980225, gen p mean: -0.7929688692092896, mean p set: 0.44682982563972473
The modified gen p mean: 0.4475215971469879, gen p mean: -0.7970388531684875, mean p set: 0.448001891374588
loss_pred:0.026991793885827065, decouple_loss:0.007420603651553392
loss_pred:0.026886869221925735, decouple_loss:0.007339999079704285
loss_pred:0.027572834864258766, decouple_loss:0.007244721986353397
Iteration: 719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477754831314087, gen p mean: -0.7953287363052368, mean p set: 0.4482557475566864The modified gen p mean: 0.44714465737342834, gen p mean: -0.796023964881897, mean p set: 0.44762495160102844
The modified gen p mean: 0.4460051655769348, gen p mean: -0.7857242226600647, mean p set: 0.44648540019989014
loss_pred:0.02610202692449093, decouple_loss:0.007202608045190573loss_pred:0.026768885552883148, decouple_loss:0.007060435600578785
loss_pred:0.026846889406442642, decouple_loss:0.00694211246445775
Iteration: 720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829297065734863, gen p mean: -0.780997097492218, mean p set: 0.44877323508262634
The modified gen p mean: 0.44763389229774475, gen p mean: -0.7886185646057129, mean p set: 0.44811415672302246
The modified gen p mean: 0.4461723566055298, gen p mean: -0.7848088145256042, mean p set: 0.4466526508331299
loss_pred:0.027008332312107086, decouple_loss:0.006967863067984581
loss_pred:0.027098407968878746, decouple_loss:0.007192880380898714
loss_pred:0.02579067461192608, decouple_loss:0.007046499755233526
2023-05-06 23:37:12 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.789273202419281, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7772445678710938, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7817639708518982, mean p set: 0.4500633478164673
loss_pred:0.026393992826342583, decouple_loss:0.007368111051619053
loss_pred:0.02514057606458664, decouple_loss:0.0071192411705851555
loss_pred:0.025491228327155113, decouple_loss:0.0071728709153831005
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026036269962787628, avg_mse: 0.03179613873362541
current test mse: 0.031796
Iteration: 721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463445842266083, gen p mean: -0.7923560738563538, mean p set: 0.4468248784542084
The modified gen p mean: 0.4482387900352478, gen p mean: -0.784505307674408, mean p set: 0.4487190544605255
loss_pred:0.025647273287177086, decouple_loss:0.006914015859365463
loss_pred:0.02765137329697609, decouple_loss:0.007004959974437952
The modified gen p mean: 0.44622448086738586, gen p mean: -0.7886773347854614, mean p set: 0.44670480489730835
loss_pred:0.026022400707006454, decouple_loss:0.006735681090503931
Iteration: 722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468212425708771, gen p mean: -0.7815807461738586, mean p set: 0.44730156660079956
The modified gen p mean: 0.44614875316619873, gen p mean: -0.7824980020523071, mean p set: 0.44662904739379883
The modified gen p mean: 0.44628268480300903, gen p mean: -0.7822152376174927, mean p set: 0.4467630088329315
loss_pred:0.026841530576348305, decouple_loss:0.0067235492169857025
loss_pred:0.026739876717329025, decouple_loss:0.006884467322379351
loss_pred:0.026282215490937233, decouple_loss:0.006809748709201813
Iteration: 723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487219452857971, gen p mean: -0.7798053622245789, mean p set: 0.4492022693157196
The modified gen p mean: 0.4462904930114746, gen p mean: -0.780478835105896, mean p set: 0.4467707574367523
The modified gen p mean: 0.4473405182361603, gen p mean: -0.7819029092788696, mean p set: 0.4478208124637604
loss_pred:0.027298692613840103, decouple_loss:0.0070272344164550304
loss_pred:0.026693245396018028, decouple_loss:0.006951121147722006
loss_pred:0.027029551565647125, decouple_loss:0.006850133184343576
Iteration: 724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468585252761841, gen p mean: -0.7832208871841431, mean p set: 0.4473387897014618
The modified gen p mean: 0.4473278820514679, gen p mean: -0.7614765167236328, mean p set: 0.4478082060813904
The modified gen p mean: 0.4461558759212494, gen p mean: -0.773915708065033, mean p set: 0.4466361403465271
loss_pred:0.026037897914648056, decouple_loss:0.007025163620710373loss_pred:0.025700019672513008, decouple_loss:0.00696193054318428
loss_pred:0.026042969897389412, decouple_loss:0.0069265649653971195
Iteration: 725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44689828157424927, gen p mean: -0.770246684551239, mean p set: 0.44737857580184937
The modified gen p mean: 0.4477706551551819, gen p mean: -0.7732484340667725, mean p set: 0.448250949382782
The modified gen p mean: 0.44753193855285645, gen p mean: -0.7762938737869263, mean p set: 0.44801223278045654
loss_pred:0.027172580361366272, decouple_loss:0.007190847769379616
loss_pred:0.026966208592057228, decouple_loss:0.006977963726967573
loss_pred:0.02673410065472126, decouple_loss:0.007005114108324051
Iteration: 726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477894604206085, gen p mean: -0.7771844267845154, mean p set: 0.44826972484588623
The modified gen p mean: 0.4489080309867859, gen p mean: -0.7679809331893921, mean p set: 0.449388325214386
The modified gen p mean: 0.4467674791812897, gen p mean: -0.7735424041748047, mean p set: 0.44724777340888977
loss_pred:0.025398658588528633, decouple_loss:0.006975269410759211
loss_pred:0.0271307285875082, decouple_loss:0.006882199551910162
loss_pred:0.025551719591021538, decouple_loss:0.0069519937969744205
Iteration: 727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44592970609664917, gen p mean: -0.7738670706748962, mean p set: 0.44641000032424927
The modified gen p mean: 0.44858792424201965, gen p mean: -0.7642059326171875, mean p set: 0.44906821846961975
The modified gen p mean: 0.44621655344963074, gen p mean: -0.7650270462036133, mean p set: 0.4466968774795532
loss_pred:0.026177816092967987, decouple_loss:0.006556895095854998
loss_pred:0.026091448962688446, decouple_loss:0.006861694622784853
loss_pred:0.026211222633719444, decouple_loss:0.006894048769026995
Iteration: 728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44834721088409424, gen p mean: -0.7685872316360474, mean p set: 0.44882747530937195
The modified gen p mean: 0.44828104972839355, gen p mean: -0.7657451629638672, mean p set: 0.44876134395599365
loss_pred:0.027109995484352112, decouple_loss:0.006895218510180712
loss_pred:0.02817462757229805, decouple_loss:0.006808952894061804
The modified gen p mean: 0.445794939994812, gen p mean: -0.7739295959472656, mean p set: 0.4462752044200897
loss_pred:0.0263441801071167, decouple_loss:0.006660754792392254
Iteration: 729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467337131500244, gen p mean: -0.777999758720398, mean p set: 0.4472139775753021
The modified gen p mean: 0.44751158356666565, gen p mean: -0.7780306935310364, mean p set: 0.44799190759658813
The modified gen p mean: 0.4469245970249176, gen p mean: -0.7709800601005554, mean p set: 0.4474048614501953
loss_pred:0.025651196017861366, decouple_loss:0.00697339978069067
loss_pred:0.02541278675198555, decouple_loss:0.0068664830178022385
loss_pred:0.02587866224348545, decouple_loss:0.006730273831635714
Iteration: 730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460732042789459, gen p mean: -0.7746734619140625, mean p set: 0.446553498506546The modified gen p mean: 0.4484891891479492, gen p mean: -0.779567539691925, mean p set: 0.4489694833755493
The modified gen p mean: 0.4481840431690216, gen p mean: -0.7726625800132751, mean p set: 0.4486643373966217
loss_pred:0.02555181086063385, decouple_loss:0.00666882423684001loss_pred:0.02700154110789299, decouple_loss:0.006773460190743208
loss_pred:0.027510100975632668, decouple_loss:0.006674422882497311
2023-05-06 23:40:52 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7769038081169128, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7657013535499573, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7699427008628845, mean p set: 0.4500633478164673
loss_pred:0.026359813287854195, decouple_loss:0.00700298510491848
loss_pred:0.02497253566980362, decouple_loss:0.006832393817603588
loss_pred:0.02536103129386902, decouple_loss:0.0067744567058980465
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025907959789037704, avg_mse: 0.031704310327768326
current test mse: 0.031704
Iteration: 731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470854103565216, gen p mean: -0.7758417129516602, mean p set: 0.44756564497947693
The modified gen p mean: 0.4469218850135803, gen p mean: -0.7648395299911499, mean p set: 0.4474022090435028
loss_pred:0.02491798810660839, decouple_loss:0.00655394559726119
loss_pred:0.026568448171019554, decouple_loss:0.006642855238169432
The modified gen p mean: 0.4469979405403137, gen p mean: -0.7750419974327087, mean p set: 0.4474782347679138
loss_pred:0.02542956918478012, decouple_loss:0.006499679293483496
Iteration: 732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731980562210083, gen p mean: -0.7777513861656189, mean p set: 0.44780007004737854
The modified gen p mean: 0.44678717851638794, gen p mean: -0.7733024954795837, mean p set: 0.44726744294166565
loss_pred:0.02610800229012966, decouple_loss:0.006592533551156521
loss_pred:0.026016175746917725, decouple_loss:0.00669934693723917
The modified gen p mean: 0.4462824761867523, gen p mean: -0.7696127891540527, mean p set: 0.4467627704143524
loss_pred:0.025631746277213097, decouple_loss:0.006265332922339439
Iteration: 733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487491548061371, gen p mean: -0.7712845802307129, mean p set: 0.4492294192314148
The modified gen p mean: 0.44659125804901123, gen p mean: -0.7750269174575806, mean p set: 0.44707152247428894
loss_pred:0.026899946853518486, decouple_loss:0.006361525040119886
The modified gen p mean: 0.44708579778671265, gen p mean: -0.7755562663078308, mean p set: 0.44756606221199036
loss_pred:0.025625135749578476, decouple_loss:0.006391970440745354
loss_pred:0.025448942556977272, decouple_loss:0.006426896434277296
Iteration: 734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886308908462524, gen p mean: -0.7762647867202759, mean p set: 0.44934335350990295
The modified gen p mean: 0.4469447135925293, gen p mean: -0.7718645930290222, mean p set: 0.4474250078201294
loss_pred:0.02740469202399254, decouple_loss:0.006842975039035082
The modified gen p mean: 0.4483528137207031, gen p mean: -0.7703782320022583, mean p set: 0.44883307814598083
loss_pred:0.026906544342637062, decouple_loss:0.006571405567228794
loss_pred:0.027487561106681824, decouple_loss:0.006649441085755825
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
NaN value num: 0
Iteration: 735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515189230442047, gen p mean: -0.7868834137916565, mean p set: 0.4519991874694824
The modified gen p mean: 0.4535503685474396, gen p mean: -0.7947713136672974, mean p set: 0.45403069257736206
The modified gen p mean: 0.45354729890823364, gen p mean: -0.7809179425239563, mean p set: 0.45402759313583374
loss_pred:0.0246242955327034, decouple_loss:0.007525469176471233
loss_pred:0.025203736498951912, decouple_loss:0.0074896253645420074
loss_pred:0.024357404559850693, decouple_loss:0.007457613479346037
Iteration: 736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516531229019165, gen p mean: -0.7800776362419128, mean p set: 0.4521334171295166
The modified gen p mean: 0.45159703493118286, gen p mean: -0.7871911525726318, mean p set: 0.45207729935646057
loss_pred:0.025158118456602097, decouple_loss:0.007486218120902777
loss_pred:0.025155792012810707, decouple_loss:0.007374516222625971
The modified gen p mean: 0.45244100689888, gen p mean: -0.7773456573486328, mean p set: 0.4529213011264801
loss_pred:0.025352993980050087, decouple_loss:0.007366400212049484
Iteration: 737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529211223125458, gen p mean: -0.7836998105049133, mean p set: 0.4534013867378235
The modified gen p mean: 0.4509446620941162, gen p mean: -0.7743290662765503, mean p set: 0.4514249265193939
The modified gen p mean: 0.4525918662548065, gen p mean: -0.7865796685218811, mean p set: 0.4530721604824066
loss_pred:0.023947520181536674, decouple_loss:0.007062592543661594
loss_pred:0.024721037596464157, decouple_loss:0.00671810656785965
loss_pred:0.024847300723195076, decouple_loss:0.007354260887950659
Iteration: 738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517376720905304, gen p mean: -0.7749666571617126, mean p set: 0.4522179961204529
The modified gen p mean: 0.45137616991996765, gen p mean: -0.7676594257354736, mean p set: 0.45185646414756775
loss_pred:0.026710230857133865, decouple_loss:0.007187731564044952
loss_pred:0.025314703583717346, decouple_loss:0.006665858440101147
The modified gen p mean: 0.4518401622772217, gen p mean: -0.7813917398452759, mean p set: 0.4523204565048218
loss_pred:0.024873370304703712, decouple_loss:0.007088495884090662
Iteration: 739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452161580324173, gen p mean: -0.7642775774002075, mean p set: 0.45264187455177307
The modified gen p mean: 0.45119157433509827, gen p mean: -0.7638828158378601, mean p set: 0.45167189836502075
The modified gen p mean: 0.4513547420501709, gen p mean: -0.7689164876937866, mean p set: 0.4518350064754486
loss_pred:0.02455371618270874, decouple_loss:0.006793526466935873
loss_pred:0.02506115846335888, decouple_loss:0.006555382162332535
loss_pred:0.024660885334014893, decouple_loss:0.00659294193610549
Iteration: 740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45161670446395874, gen p mean: -0.7703486084938049, mean p set: 0.45209699869155884
The modified gen p mean: 0.45173218846321106, gen p mean: -0.7650521993637085, mean p set: 0.45221248269081116
loss_pred:0.026470718905329704, decouple_loss:0.006828326266258955
loss_pred:0.024191737174987793, decouple_loss:0.0065219830721616745
The modified gen p mean: 0.45130518078804016, gen p mean: -0.7639609575271606, mean p set: 0.45178544521331787
loss_pred:0.02544112503528595, decouple_loss:0.006560776382684708
2023-05-06 23:45:29 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7730244994163513, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7609246969223022, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7651700377464294, mean p set: 0.4500633478164673
loss_pred:0.026503266766667366, decouple_loss:0.00765990512445569
loss_pred:0.02521578036248684, decouple_loss:0.0074997553601861
loss_pred:0.025523817166686058, decouple_loss:0.007465819828212261
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02612471394240856, avg_mse: 0.032104600220918655
current test mse: 0.032105
Iteration: 741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525035321712494, gen p mean: -0.7681668400764465, mean p set: 0.4529838562011719
loss_pred:0.02528848685324192, decouple_loss:0.00677885627374053
The modified gen p mean: 0.45139172673225403, gen p mean: -0.7694558501243591, mean p set: 0.4518720209598541
loss_pred:0.025197360664606094, decouple_loss:0.006592839024960995
The modified gen p mean: 0.45204538106918335, gen p mean: -0.7727130055427551, mean p set: 0.45252567529678345
loss_pred:0.025006093084812164, decouple_loss:0.006658326834440231
Iteration: 742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037102699279785, gen p mean: -0.779062032699585, mean p set: 0.45085132122039795
The modified gen p mean: 0.4531554579734802, gen p mean: -0.7769069671630859, mean p set: 0.4536357522010803
loss_pred:0.025458429008722305, decouple_loss:0.00675953971222043
loss_pred:0.024560993537306786, decouple_loss:0.006899214815348387
The modified gen p mean: 0.45240339636802673, gen p mean: -0.7807477116584778, mean p set: 0.45288369059562683
loss_pred:0.024509185925126076, decouple_loss:0.006924719549715519
Iteration: 743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523914158344269, gen p mean: -0.7755230665206909, mean p set: 0.452871710062027
The modified gen p mean: 0.45415034890174866, gen p mean: -0.7770938277244568, mean p set: 0.45463061332702637
loss_pred:0.02494058944284916, decouple_loss:0.006544043775647879
loss_pred:0.02410569041967392, decouple_loss:0.006829914171248674
The modified gen p mean: 0.45156797766685486, gen p mean: -0.7870452404022217, mean p set: 0.45204824209213257
loss_pred:0.02425803616642952, decouple_loss:0.0069225556217134
Iteration: 744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45391517877578735, gen p mean: -0.7764332294464111, mean p set: 0.45439544320106506
The modified gen p mean: 0.4535592198371887, gen p mean: -0.779714047908783, mean p set: 0.45403948426246643
The modified gen p mean: 0.45227837562561035, gen p mean: -0.7861718535423279, mean p set: 0.45275866985321045
loss_pred:0.02339225821197033, decouple_loss:0.00676156347617507
loss_pred:0.02386966347694397, decouple_loss:0.006487607024610043
loss_pred:0.024834418669342995, decouple_loss:0.006809988059103489
Iteration: 745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45087969303131104, gen p mean: -0.77564537525177, mean p set: 0.45135995745658875
The modified gen p mean: 0.45169565081596375, gen p mean: -0.7744767069816589, mean p set: 0.45217597484588623
The modified gen p mean: 0.4512805640697479, gen p mean: -0.7770910859107971, mean p set: 0.45176082849502563
loss_pred:0.025498932227492332, decouple_loss:0.006460350006818771loss_pred:0.024421170353889465, decouple_loss:0.0064406851306557655
loss_pred:0.023782741278409958, decouple_loss:0.0068146544508636
Iteration: 746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45155516266822815, gen p mean: -0.773367166519165, mean p set: 0.45203545689582825
The modified gen p mean: 0.45107153058052063, gen p mean: -0.7723035216331482, mean p set: 0.4515518248081207
The modified gen p mean: 0.4517289102077484, gen p mean: -0.7820594906806946, mean p set: 0.4522091746330261
loss_pred:0.025741562247276306, decouple_loss:0.0063266693614423275
loss_pred:0.024042226374149323, decouple_loss:0.006253391969949007
loss_pred:0.026107506826519966, decouple_loss:0.006432733498513699
Iteration: 747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520740807056427, gen p mean: -0.7720668911933899, mean p set: 0.4525543749332428
The modified gen p mean: 0.4516083300113678, gen p mean: -0.7751820683479309, mean p set: 0.4520886242389679
The modified gen p mean: 0.45184358954429626, gen p mean: -0.7779613733291626, mean p set: 0.45232388377189636
loss_pred:0.02523217163980007, decouple_loss:0.0062170266173779964
loss_pred:0.025923721492290497, decouple_loss:0.006467910949140787
loss_pred:0.02462206408381462, decouple_loss:0.006555739790201187
Iteration: 748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515923857688904, gen p mean: -0.7845534086227417, mean p set: 0.4520726501941681
The modified gen p mean: 0.45387494564056396, gen p mean: -0.773651123046875, mean p set: 0.45435523986816406
The modified gen p mean: 0.45282846689224243, gen p mean: -0.7732003331184387, mean p set: 0.45330876111984253
loss_pred:0.02446523681282997, decouple_loss:0.006281584035605192loss_pred:0.02568228356540203, decouple_loss:0.006189378909766674
loss_pred:0.02355111576616764, decouple_loss:0.006373667158186436
Iteration: 749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525831937789917, gen p mean: -0.7826363444328308, mean p set: 0.4530635178089142
The modified gen p mean: 0.45200249552726746, gen p mean: -0.7795817255973816, mean p set: 0.45248281955718994
The modified gen p mean: 0.4518677890300751, gen p mean: -0.7777970433235168, mean p set: 0.45234808325767517
loss_pred:0.0243374016135931, decouple_loss:0.006489059422165155
loss_pred:0.02500993199646473, decouple_loss:0.0063083842396736145
loss_pred:0.025051720440387726, decouple_loss:0.006475654896348715
Iteration: 750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45356112718582153, gen p mean: -0.7772553563117981, mean p set: 0.45404139161109924
The modified gen p mean: 0.4518062174320221, gen p mean: -0.7819792032241821, mean p set: 0.4522865414619446
loss_pred:0.02414672262966633, decouple_loss:0.00646861270070076The modified gen p mean: 0.45340868830680847, gen p mean: -0.7808091640472412, mean p set: 0.4538889527320862
loss_pred:0.024371160194277763, decouple_loss:0.006438131909817457
loss_pred:0.02357635460793972, decouple_loss:0.006441203877329826
2023-05-06 23:49:06 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7859565019607544, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.773070216178894, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7781513929367065, mean p set: 0.4500633478164673
loss_pred:0.026624418795108795, decouple_loss:0.007526461035013199
loss_pred:0.025305651128292084, decouple_loss:0.007476306054741144
loss_pred:0.02558060921728611, decouple_loss:0.007298995275050402
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02620859071612358, avg_mse: 0.03231234848499298
current test mse: 0.032312
Iteration: 751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451862633228302, gen p mean: -0.7848617434501648, mean p set: 0.4523428976535797
The modified gen p mean: 0.45025843381881714, gen p mean: -0.7898265719413757, mean p set: 0.45073869824409485
loss_pred:0.025184104219079018, decouple_loss:0.006284333765506744
loss_pred:0.024510415270924568, decouple_loss:0.006620429921895266
The modified gen p mean: 0.4523889422416687, gen p mean: -0.7871466279029846, mean p set: 0.4528692364692688
loss_pred:0.024825796484947205, decouple_loss:0.006451995112001896
Iteration: 752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510282874107361, gen p mean: -0.7859818935394287, mean p set: 0.4515085816383362
The modified gen p mean: 0.4523482322692871, gen p mean: -0.7844191789627075, mean p set: 0.4528285562992096
loss_pred:0.024271285161376, decouple_loss:0.006466364488005638
loss_pred:0.025012947618961334, decouple_loss:0.006319650448858738
The modified gen p mean: 0.45235347747802734, gen p mean: -0.7869324088096619, mean p set: 0.45283377170562744
loss_pred:0.024395616725087166, decouple_loss:0.006042382679879665
Iteration: 753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45232877135276794, gen p mean: -0.7869705557823181, mean p set: 0.45280906558036804
The modified gen p mean: 0.45097583532333374, gen p mean: -0.7813923358917236, mean p set: 0.45145612955093384
loss_pred:0.02487107552587986, decouple_loss:0.00633445056155324
loss_pred:0.02455292083323002, decouple_loss:0.0064297630451619625
The modified gen p mean: 0.4518778324127197, gen p mean: -0.7967560887336731, mean p set: 0.4523581564426422
loss_pred:0.02443142794072628, decouple_loss:0.006508445832878351
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840681552886963, gen p mean: -0.7796452045440674, mean p set: 0.4488871097564697
The modified gen p mean: 0.44877612590789795, gen p mean: -0.7752724289894104, mean p set: 0.44925642013549805
The modified gen p mean: 0.44761672616004944, gen p mean: -0.781551718711853, mean p set: 0.4480970501899719
loss_pred:0.02600681781768799, decouple_loss:0.007419269531965256
loss_pred:0.025213511660695076, decouple_loss:0.007163388188928366
loss_pred:0.02573886327445507, decouple_loss:0.007278465200215578
Iteration: 755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478321373462677, gen p mean: -0.7812338471412659, mean p set: 0.4483124613761902
The modified gen p mean: 0.4487597942352295, gen p mean: -0.7710445523262024, mean p set: 0.4492400586605072
The modified gen p mean: 0.4485422968864441, gen p mean: -0.7710410356521606, mean p set: 0.4490225911140442
loss_pred:0.02461288869380951, decouple_loss:0.006694701500236988
loss_pred:0.02593236044049263, decouple_loss:0.006847693119198084
loss_pred:0.025579361245036125, decouple_loss:0.007069263607263565
Iteration: 756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476868510246277, gen p mean: -0.7683581113815308, mean p set: 0.4481671154499054
The modified gen p mean: 0.4492274522781372, gen p mean: -0.7695267796516418, mean p set: 0.4497077465057373
The modified gen p mean: 0.44808343052864075, gen p mean: -0.7804005146026611, mean p set: 0.44856372475624084
loss_pred:0.025659624487161636, decouple_loss:0.006755640730261803
loss_pred:0.025183536112308502, decouple_loss:0.006728706415742636
loss_pred:0.02534756436944008, decouple_loss:0.0068736630491912365
Iteration: 757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491707384586334, gen p mean: -0.7701292634010315, mean p set: 0.4496510326862335
The modified gen p mean: 0.44884926080703735, gen p mean: -0.7762871384620667, mean p set: 0.44932955503463745
The modified gen p mean: 0.4485883414745331, gen p mean: -0.7762576937675476, mean p set: 0.4490686058998108
loss_pred:0.025451498106122017, decouple_loss:0.006853461731225252
loss_pred:0.025913288816809654, decouple_loss:0.0067770457826554775
loss_pred:0.026031332090497017, decouple_loss:0.006723362952470779
Iteration: 758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44897910952568054, gen p mean: -0.7728609442710876, mean p set: 0.44945937395095825
The modified gen p mean: 0.4480079710483551, gen p mean: -0.7713780999183655, mean p set: 0.4484882652759552
The modified gen p mean: 0.4479890465736389, gen p mean: -0.7602955102920532, mean p set: 0.448469340801239
loss_pred:0.024462124332785606, decouple_loss:0.006677286699414253
loss_pred:0.025286812335252762, decouple_loss:0.006699380464851856
loss_pred:0.02544851414859295, decouple_loss:0.006898101884871721
Iteration: 759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488055109977722, gen p mean: -0.7793305516242981, mean p set: 0.4492858350276947
The modified gen p mean: 0.44782358407974243, gen p mean: -0.7797167897224426, mean p set: 0.44830384850502014
The modified gen p mean: 0.44857487082481384, gen p mean: -0.7784556150436401, mean p set: 0.44905519485473633
loss_pred:0.0249240230768919, decouple_loss:0.006348433904349804
loss_pred:0.024198368191719055, decouple_loss:0.006396465003490448
loss_pred:0.025602327659726143, decouple_loss:0.007130421232432127
Iteration: 760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480856955051422, gen p mean: -0.7874616980552673, mean p set: 0.4485659599304199The modified gen p mean: 0.4474776089191437, gen p mean: -0.7759077548980713, mean p set: 0.4479579031467438
The modified gen p mean: 0.44917911291122437, gen p mean: -0.7854993939399719, mean p set: 0.44965940713882446
loss_pred:0.025143500417470932, decouple_loss:0.0066382247023284435
loss_pred:0.025121795013546944, decouple_loss:0.006575603038072586
loss_pred:0.02458346076309681, decouple_loss:0.006696169264614582
2023-05-06 23:53:26 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7783564329147339, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7909646034240723, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7832995057106018, mean p set: 0.4500633478164673
loss_pred:0.024829823523759842, decouple_loss:0.006611999589949846
loss_pred:0.026077739894390106, decouple_loss:0.006824911572039127
loss_pred:0.025065476074814796, decouple_loss:0.006477429531514645
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02565625309944153, avg_mse: 0.031414907425642014
current test mse: 0.031415
Iteration: 761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484025537967682, gen p mean: -0.7853342294692993, mean p set: 0.4488828480243683
The modified gen p mean: 0.4477083384990692, gen p mean: -0.7834830284118652, mean p set: 0.4481886029243469
loss_pred:0.025492370128631592, decouple_loss:0.007029441185295582
loss_pred:0.024575574323534966, decouple_loss:0.006588472984731197
The modified gen p mean: 0.4479213058948517, gen p mean: -0.7814109921455383, mean p set: 0.44840162992477417
loss_pred:0.02492152340710163, decouple_loss:0.006395737174898386
Iteration: 762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487764537334442, gen p mean: -0.7745875120162964, mean p set: 0.4492567181587219
The modified gen p mean: 0.44858604669570923, gen p mean: -0.7842618823051453, mean p set: 0.4490663409233093
The modified gen p mean: 0.4486697316169739, gen p mean: -0.7857453227043152, mean p set: 0.449150025844574
loss_pred:0.02516697160899639, decouple_loss:0.006710364483296871loss_pred:0.02512187883257866, decouple_loss:0.006824964191764593
loss_pred:0.02511972188949585, decouple_loss:0.006602995563298464
Iteration: 763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44895660877227783, gen p mean: -0.7782483696937561, mean p set: 0.44943690299987793
The modified gen p mean: 0.4485201835632324, gen p mean: -0.7866630554199219, mean p set: 0.44900044798851013
The modified gen p mean: 0.4476096034049988, gen p mean: -0.7717247009277344, mean p set: 0.4480898678302765
loss_pred:0.024515425786376, decouple_loss:0.006544535979628563
loss_pred:0.02469586580991745, decouple_loss:0.006457548588514328
loss_pred:0.025129560381174088, decouple_loss:0.006376749370247126
Iteration: 764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945159554481506, gen p mean: -0.7746946215629578, mean p set: 0.44993188977241516
The modified gen p mean: 0.4487152397632599, gen p mean: -0.7797490954399109, mean p set: 0.44919553399086
The modified gen p mean: 0.4481750428676605, gen p mean: -0.7748368382453918, mean p set: 0.4486553370952606
loss_pred:0.02488086372613907, decouple_loss:0.006530409213155508
loss_pred:0.02541278675198555, decouple_loss:0.006568505894392729
loss_pred:0.025174381211400032, decouple_loss:0.0064449189230799675
Iteration: 765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481826722621918, gen p mean: -0.7807846069335938, mean p set: 0.44866296648979187
The modified gen p mean: 0.44849711656570435, gen p mean: -0.7814072966575623, mean p set: 0.44897738099098206
The modified gen p mean: 0.4478693902492523, gen p mean: -0.7773081660270691, mean p set: 0.44834965467453003
loss_pred:0.025632310658693314, decouple_loss:0.006943385116755962
loss_pred:0.024754855781793594, decouple_loss:0.0061325570568442345
loss_pred:0.025528501719236374, decouple_loss:0.006845064926892519
Iteration: 766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479455053806305, gen p mean: -0.7723453640937805, mean p set: 0.4484257698059082
The modified gen p mean: 0.44793662428855896, gen p mean: -0.7792438268661499, mean p set: 0.44841691851615906
The modified gen p mean: 0.44944050908088684, gen p mean: -0.7661662697792053, mean p set: 0.44992080330848694
loss_pred:0.02419559843838215, decouple_loss:0.006630237214267254
loss_pred:0.024709129706025124, decouple_loss:0.006192166358232498
loss_pred:0.02602366916835308, decouple_loss:0.0066019389778375626
Iteration: 767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501950442790985, gen p mean: -0.7746899724006653, mean p set: 0.4506753385066986
The modified gen p mean: 0.44744542241096497, gen p mean: -0.7672228217124939, mean p set: 0.4479256868362427
The modified gen p mean: 0.44881996512413025, gen p mean: -0.7786580920219421, mean p set: 0.44930025935173035
loss_pred:0.02519654855132103, decouple_loss:0.006819656118750572
loss_pred:0.02509584277868271, decouple_loss:0.0067354184575378895
loss_pred:0.02461298368871212, decouple_loss:0.006387526169419289
Iteration: 768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971179962158203, gen p mean: -0.7663363814353943, mean p set: 0.45019209384918213
The modified gen p mean: 0.4484231472015381, gen p mean: -0.769992470741272, mean p set: 0.4489034116268158
The modified gen p mean: 0.448650598526001, gen p mean: -0.7668787837028503, mean p set: 0.44913092255592346
loss_pred:0.025533242151141167, decouple_loss:0.00635647214949131
loss_pred:0.024613885208964348, decouple_loss:0.006181924603879452
loss_pred:0.024852894246578217, decouple_loss:0.006142270751297474
Iteration: 769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499695599079132, gen p mean: -0.76975417137146, mean p set: 0.4504498541355133
The modified gen p mean: 0.4494444727897644, gen p mean: -0.7763612270355225, mean p set: 0.4499247372150421
The modified gen p mean: 0.44868409633636475, gen p mean: -0.779354989528656, mean p set: 0.44916436076164246
loss_pred:0.0254483874887228, decouple_loss:0.006511547602713108
loss_pred:0.02432231605052948, decouple_loss:0.006377446465194225
loss_pred:0.024530963972210884, decouple_loss:0.006206669379025698
Iteration: 770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44923079013824463, gen p mean: -0.7733197808265686, mean p set: 0.44971105456352234The modified gen p mean: 0.4484126567840576, gen p mean: -0.7669873237609863, mean p set: 0.4488929510116577
The modified gen p mean: 0.4489496946334839, gen p mean: -0.7605839967727661, mean p set: 0.449429988861084
loss_pred:0.025158828124403954, decouple_loss:0.0063394540920853615loss_pred:0.02505112998187542, decouple_loss:0.006252777297049761
loss_pred:0.025400206446647644, decouple_loss:0.006381877698004246
2023-05-06 23:57:06 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7849350571632385, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7735791206359863, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7775506377220154, mean p set: 0.4500633478164673
loss_pred:0.02611931972205639, decouple_loss:0.006582576781511307
loss_pred:0.024962665513157845, decouple_loss:0.006310692522674799
loss_pred:0.025221258401870728, decouple_loss:0.006338651292026043
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02575494721531868, avg_mse: 0.03168382868170738
current test mse: 0.031684
Iteration: 771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497270882129669, gen p mean: -0.7766826748847961, mean p set: 0.450207382440567
The modified gen p mean: 0.4473377764225006, gen p mean: -0.775854766368866, mean p set: 0.4478180706501007
loss_pred:0.024739181622862816, decouple_loss:0.006281027104705572
loss_pred:0.02566562592983246, decouple_loss:0.006945078261196613
The modified gen p mean: 0.4483506977558136, gen p mean: -0.7751467227935791, mean p set: 0.4488309919834137
loss_pred:0.025970177724957466, decouple_loss:0.006489561405032873
Iteration: 772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44882193207740784, gen p mean: -0.7754281163215637, mean p set: 0.44930222630500793
The modified gen p mean: 0.4471559524536133, gen p mean: -0.7782444953918457, mean p set: 0.4476362466812134
The modified gen p mean: 0.4491414427757263, gen p mean: -0.7830357551574707, mean p set: 0.4496217370033264
loss_pred:0.025504445657134056, decouple_loss:0.006198647432029247
loss_pred:0.026108013466000557, decouple_loss:0.006778868846595287
loss_pred:0.025104040279984474, decouple_loss:0.006102084182202816
Iteration: 773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835829734802246, gen p mean: -0.7820529937744141, mean p set: 0.44883859157562256
The modified gen p mean: 0.448161780834198, gen p mean: -0.7792865633964539, mean p set: 0.4486420452594757
The modified gen p mean: 0.44784510135650635, gen p mean: -0.778505802154541, mean p set: 0.44832542538642883
loss_pred:0.025006329640746117, decouple_loss:0.0065273321233689785
loss_pred:0.02564864791929722, decouple_loss:0.006271660327911377
loss_pred:0.024965988472104073, decouple_loss:0.006906062364578247
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475484788417816, gen p mean: -0.7788953185081482, mean p set: 0.4480287730693817
The modified gen p mean: 0.44755735993385315, gen p mean: -0.7814415097236633, mean p set: 0.44803765416145325
The modified gen p mean: 0.4471129775047302, gen p mean: -0.7750352025032043, mean p set: 0.4475933015346527
loss_pred:0.02502131648361683, decouple_loss:0.006419255398213863
loss_pred:0.0255083329975605, decouple_loss:0.006676191464066505
loss_pred:0.026277102530002594, decouple_loss:0.006403345614671707
Iteration: 775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474162757396698, gen p mean: -0.7794813513755798, mean p set: 0.4478965699672699
The modified gen p mean: 0.4488476812839508, gen p mean: -0.7963078022003174, mean p set: 0.4493279755115509
The modified gen p mean: 0.4476977288722992, gen p mean: -0.7791582942008972, mean p set: 0.4481779932975769
loss_pred:0.025011809542775154, decouple_loss:0.006395150441676378
loss_pred:0.023053836077451706, decouple_loss:0.006677940953522921
loss_pred:0.026001401245594025, decouple_loss:0.006346878129988909
Iteration: 776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738537073135376, gen p mean: -0.7783576250076294, mean p set: 0.44786569476127625
The modified gen p mean: 0.44979915022850037, gen p mean: -0.7773709893226624, mean p set: 0.4502794146537781
The modified gen p mean: 0.4472678005695343, gen p mean: -0.7753700613975525, mean p set: 0.447748064994812
loss_pred:0.024668468162417412, decouple_loss:0.006273722741752863
loss_pred:0.025288408622145653, decouple_loss:0.006353431381285191
loss_pred:0.024464119225740433, decouple_loss:0.006064801011234522
Iteration: 777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447256863117218, gen p mean: -0.7743706107139587, mean p set: 0.4477371871471405
The modified gen p mean: 0.4489346742630005, gen p mean: -0.775728166103363, mean p set: 0.4494149386882782
The modified gen p mean: 0.4499562680721283, gen p mean: -0.7747592329978943, mean p set: 0.4504365622997284
loss_pred:0.024836940690875053, decouple_loss:0.006210669409483671
loss_pred:0.02459978498518467, decouple_loss:0.006561465561389923
loss_pred:0.02367592044174671, decouple_loss:0.0066044628620147705
Iteration: 778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798243045806885, gen p mean: -0.7888601422309875, mean p set: 0.44846272468566895
The modified gen p mean: 0.4490741789340973, gen p mean: -0.775797963142395, mean p set: 0.449554443359375
The modified gen p mean: 0.4489430785179138, gen p mean: -0.7735039591789246, mean p set: 0.4494233727455139
loss_pred:0.023231586441397667, decouple_loss:0.006846483331173658
loss_pred:0.025075525045394897, decouple_loss:0.006864944007247686
loss_pred:0.02536989003419876, decouple_loss:0.00686162244528532
Iteration: 779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490068554878235, gen p mean: -0.7974212169647217, mean p set: 0.4494871497154236
The modified gen p mean: 0.4481935501098633, gen p mean: -0.7768009901046753, mean p set: 0.44867387413978577
The modified gen p mean: 0.448903888463974, gen p mean: -0.7744542956352234, mean p set: 0.4493841528892517
loss_pred:0.022763730958104134, decouple_loss:0.0067592402920126915
loss_pred:0.024615278467535973, decouple_loss:0.0066727143712341785
loss_pred:0.02504761330783367, decouple_loss:0.006503846496343613
Iteration: 780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766318798065186, gen p mean: -0.7787238955497742, mean p set: 0.44814345240592957
The modified gen p mean: 0.44841745495796204, gen p mean: -0.7785177826881409, mean p set: 0.44889771938323975
The modified gen p mean: 0.4490821361541748, gen p mean: -0.780440628528595, mean p set: 0.4495624303817749
loss_pred:0.02577398344874382, decouple_loss:0.006810016930103302
loss_pred:0.025924136862158775, decouple_loss:0.006764214485883713
loss_pred:0.024885382503271103, decouple_loss:0.006913496181368828
2023-05-07 00:01:43 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7878840565681458, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7753209471702576, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7796176671981812, mean p set: 0.4500633478164673
loss_pred:0.026459556072950363, decouple_loss:0.006981549318879843
loss_pred:0.02516845427453518, decouple_loss:0.006757073104381561
loss_pred:0.025394616648554802, decouple_loss:0.00667893560603261
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026014503091573715, avg_mse: 0.0319879986345768
current test mse: 0.031988
Iteration: 781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469147324562073, gen p mean: -0.784339964389801, mean p set: 0.447394996881485
The modified gen p mean: 0.44912394881248474, gen p mean: -0.8020275831222534, mean p set: 0.4496042728424072
loss_pred:0.024080460891127586, decouple_loss:0.006699801422655582
loss_pred:0.023140924051404, decouple_loss:0.006786649581044912
The modified gen p mean: 0.44915971159935, gen p mean: -0.7941704988479614, mean p set: 0.4496400058269501
loss_pred:0.024712424725294113, decouple_loss:0.0068344371393322945
Iteration: 782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486274719238281, gen p mean: -0.7817142605781555, mean p set: 0.44910773634910583
The modified gen p mean: 0.4486277103424072, gen p mean: -0.7814922332763672, mean p set: 0.44910797476768494
The modified gen p mean: 0.44669434428215027, gen p mean: -0.7622257471084595, mean p set: 0.447174608707428
loss_pred:0.02383122779428959, decouple_loss:0.006522022187709808
loss_pred:0.02383861504495144, decouple_loss:0.00668435450643301
loss_pred:0.02610648050904274, decouple_loss:0.006978882011026144
Iteration: 783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856274127960205, gen p mean: -0.7727029323577881, mean p set: 0.44904303550720215
The modified gen p mean: 0.4488057494163513, gen p mean: -0.7700252532958984, mean p set: 0.4492860734462738
loss_pred:0.025126492604613304, decouple_loss:0.006734192371368408
loss_pred:0.025027841329574585, decouple_loss:0.006998835597187281
The modified gen p mean: 0.44819745421409607, gen p mean: -0.7683079838752747, mean p set: 0.44867774844169617
loss_pred:0.02497047372162342, decouple_loss:0.007030120585113764
Iteration: 784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478529095649719, gen p mean: -0.7750821709632874, mean p set: 0.44833314418792725
The modified gen p mean: 0.4507500231266022, gen p mean: -0.7775037884712219, mean p set: 0.45123034715652466
The modified gen p mean: 0.4488906264305115, gen p mean: -0.776620090007782, mean p set: 0.4493709206581116
loss_pred:0.02558547630906105, decouple_loss:0.0067189279943704605
loss_pred:0.024331970140337944, decouple_loss:0.006990162190049887
loss_pred:0.02484198845922947, decouple_loss:0.007071115076541901
Iteration: 785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44961124658584595, gen p mean: -0.7827917337417603, mean p set: 0.45009157061576843
The modified gen p mean: 0.44875746965408325, gen p mean: -0.7787390947341919, mean p set: 0.44923779368400574
The modified gen p mean: 0.44840124249458313, gen p mean: -0.7763758301734924, mean p set: 0.4488815367221832
loss_pred:0.023961082100868225, decouple_loss:0.00685619143769145
loss_pred:0.02582034096121788, decouple_loss:0.006839611101895571
loss_pred:0.026486782357096672, decouple_loss:0.007087698671966791
Iteration: 786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836610555648804, gen p mean: -0.7804485559463501, mean p set: 0.44884639978408813
The modified gen p mean: 0.4474261701107025, gen p mean: -0.7684193849563599, mean p set: 0.4479064643383026
The modified gen p mean: 0.44839346408843994, gen p mean: -0.7760288715362549, mean p set: 0.44887375831604004
loss_pred:0.02399503067135811, decouple_loss:0.007007027510553598
loss_pred:0.02513911761343479, decouple_loss:0.007360631600022316
loss_pred:0.026437127962708473, decouple_loss:0.006988472770899534
Iteration: 787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487262964248657, gen p mean: -0.776692807674408, mean p set: 0.44920656085014343
The modified gen p mean: 0.4467901289463043, gen p mean: -0.770098865032196, mean p set: 0.4472704529762268
The modified gen p mean: 0.4474325478076935, gen p mean: -0.7749832272529602, mean p set: 0.4479128420352936
loss_pred:0.024306941777467728, decouple_loss:0.0067334906198084354
loss_pred:0.025547504425048828, decouple_loss:0.00712659303098917
loss_pred:0.024138040840625763, decouple_loss:0.006824104581028223
Iteration: 788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493548572063446, gen p mean: -0.7840666174888611, mean p set: 0.4498351216316223
The modified gen p mean: 0.4473476707935333, gen p mean: -0.7726913094520569, mean p set: 0.44782793521881104
loss_pred:0.02398507669568062, decouple_loss:0.007155105471611023
The modified gen p mean: 0.44975852966308594, gen p mean: -0.7749367356300354, mean p set: 0.45023879408836365loss_pred:0.02494247630238533, decouple_loss:0.006804044358432293
loss_pred:0.02493785135447979, decouple_loss:0.0072473869659006596
Iteration: 789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497550427913666, gen p mean: -0.7798092365264893, mean p set: 0.4502353370189667
The modified gen p mean: 0.4500373601913452, gen p mean: -0.7822190523147583, mean p set: 0.4505176842212677
loss_pred:0.024343237280845642, decouple_loss:0.0071169245056807995
loss_pred:0.02368774823844433, decouple_loss:0.006713598966598511
The modified gen p mean: 0.44972047209739685, gen p mean: -0.796040952205658, mean p set: 0.45020073652267456
loss_pred:0.023420868441462517, decouple_loss:0.00704444944858551
Iteration: 790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479535222053528, gen p mean: -0.7837931513786316, mean p set: 0.44843384623527527
The modified gen p mean: 0.44837772846221924, gen p mean: -0.7850959300994873, mean p set: 0.44885799288749695
The modified gen p mean: 0.44811615347862244, gen p mean: -0.7782936096191406, mean p set: 0.44859644770622253
loss_pred:0.025281835347414017, decouple_loss:0.006647597067058086
loss_pred:0.024981234222650528, decouple_loss:0.006675351411104202
loss_pred:0.024294039234519005, decouple_loss:0.006550275720655918
2023-05-07 00:05:22 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7877731323242188, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7754470705986023, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7795556783676147, mean p set: 0.4500633478164673
loss_pred:0.026000361889600754, decouple_loss:0.007127098739147186
loss_pred:0.024688158184289932, decouple_loss:0.006983616389334202
loss_pred:0.02502201311290264, decouple_loss:0.006737846881151199
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025584321469068527, avg_mse: 0.031309280544519424
current test mse: 0.031309
Iteration: 791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472696781158447, gen p mean: -0.7819061875343323, mean p set: 0.4477499723434448
The modified gen p mean: 0.4478560984134674, gen p mean: -0.7792453765869141, mean p set: 0.4483363628387451
loss_pred:0.025271814316511154, decouple_loss:0.0067815035581588745
loss_pred:0.02490495890378952, decouple_loss:0.00672932667657733
The modified gen p mean: 0.448194295167923, gen p mean: -0.7829976677894592, mean p set: 0.44867458939552307
loss_pred:0.0255621075630188, decouple_loss:0.006900988984853029
Iteration: 792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474972188472748, gen p mean: -0.7777295708656311, mean p set: 0.4479774832725525
The modified gen p mean: 0.451656699180603, gen p mean: -0.7863853573799133, mean p set: 0.4521370232105255
The modified gen p mean: 0.448076993227005, gen p mean: -0.779798686504364, mean p set: 0.4485572874546051
loss_pred:0.024413496255874634, decouple_loss:0.006649371236562729
loss_pred:0.024401118978857994, decouple_loss:0.006929573602974415
loss_pred:0.025289958342909813, decouple_loss:0.0066886721178889275
Iteration: 793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501930773258209, gen p mean: -0.7795637845993042, mean p set: 0.45067334175109863
The modified gen p mean: 0.4476599097251892, gen p mean: -0.7839663624763489, mean p set: 0.4481402039527893
The modified gen p mean: 0.4486962854862213, gen p mean: -0.7836921215057373, mean p set: 0.449176549911499
loss_pred:0.024154867976903915, decouple_loss:0.006530940532684326
loss_pred:0.02456650324165821, decouple_loss:0.0061700367368757725
loss_pred:0.025089941918849945, decouple_loss:0.006608760450035334
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
NaN value num: 0
Iteration: 794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517834484577179, gen p mean: -0.7878730297088623, mean p set: 0.452263742685318
The modified gen p mean: 0.4510710537433624, gen p mean: -0.7866619229316711, mean p set: 0.4515514075756073
The modified gen p mean: 0.4508478045463562, gen p mean: -0.7872076630592346, mean p set: 0.4513280689716339
loss_pred:0.025708595290780067, decouple_loss:0.006812691688537598
loss_pred:0.02426893450319767, decouple_loss:0.007059161551296711
loss_pred:0.02435547113418579, decouple_loss:0.006803448311984539
Iteration: 795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499562680721283, gen p mean: -0.7934986352920532, mean p set: 0.4504365921020508
The modified gen p mean: 0.44981104135513306, gen p mean: -0.7789567112922668, mean p set: 0.45029133558273315
The modified gen p mean: 0.4508407711982727, gen p mean: -0.7943790555000305, mean p set: 0.4513210654258728
loss_pred:0.025655701756477356, decouple_loss:0.006924858316779137
loss_pred:0.02433694526553154, decouple_loss:0.007027544546872377
loss_pred:0.02535325475037098, decouple_loss:0.006878727115690708
Iteration: 796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504394233226776, gen p mean: -0.7797141671180725, mean p set: 0.4509196877479553
The modified gen p mean: 0.4520491063594818, gen p mean: -0.7885794043540955, mean p set: 0.4525294005870819
The modified gen p mean: 0.450869619846344, gen p mean: -0.791309654712677, mean p set: 0.4513498842716217
loss_pred:0.02549682930111885, decouple_loss:0.0067011951468884945
loss_pred:0.024436654523015022, decouple_loss:0.00667691882699728
loss_pred:0.024161580950021744, decouple_loss:0.0068869334645569324
Iteration: 797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45034050941467285, gen p mean: -0.7711196541786194, mean p set: 0.45082080364227295
The modified gen p mean: 0.4494931697845459, gen p mean: -0.7711833119392395, mean p set: 0.449973464012146
The modified gen p mean: 0.44928792119026184, gen p mean: -0.7742699980735779, mean p set: 0.4497682452201843
loss_pred:0.023965874686837196, decouple_loss:0.0069270976819098
loss_pred:0.02521999180316925, decouple_loss:0.006790812127292156
loss_pred:0.024999430403113365, decouple_loss:0.006886180955916643
Iteration: 798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499293267726898, gen p mean: -0.7642796039581299, mean p set: 0.4504096210002899
The modified gen p mean: 0.4515420198440552, gen p mean: -0.7733736038208008, mean p set: 0.4520223140716553
The modified gen p mean: 0.45203572511672974, gen p mean: -0.7759172916412354, mean p set: 0.45251601934432983
loss_pred:0.025169309228658676, decouple_loss:0.006760320160537958
loss_pred:0.02475138008594513, decouple_loss:0.006581314839422703
loss_pred:0.024338096380233765, decouple_loss:0.006737080868333578
Iteration: 799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502983093261719, gen p mean: -0.7688401341438293, mean p set: 0.450778603553772
The modified gen p mean: 0.45193731784820557, gen p mean: -0.7781803607940674, mean p set: 0.45241761207580566
The modified gen p mean: 0.45246824622154236, gen p mean: -0.7714484930038452, mean p set: 0.45294854044914246
loss_pred:0.024995772168040276, decouple_loss:0.006406074855476618
loss_pred:0.024625003337860107, decouple_loss:0.006294887978583574
loss_pred:0.024069398641586304, decouple_loss:0.006814018357545137
Iteration: 800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45313552021980286, gen p mean: -0.7788923382759094, mean p set: 0.45361581444740295
The modified gen p mean: 0.4494033455848694, gen p mean: -0.769585907459259, mean p set: 0.4498836398124695
The modified gen p mean: 0.4493584632873535, gen p mean: -0.7692344188690186, mean p set: 0.4498387575149536
loss_pred:0.024379469454288483, decouple_loss:0.006516099441796541
loss_pred:0.02480022795498371, decouple_loss:0.0063585564494132996
loss_pred:0.025371519848704338, decouple_loss:0.006839586887508631
2023-05-07 00:09:47 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7779112458229065, mean p set: 0.4502691626548767
The modified gen p mean: 0.4498766362667084, gen p mean: -0.7665461897850037, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7701335549354553, mean p set: 0.4500633478164673
loss_pred:0.026037001982331276, decouple_loss:0.007029606495052576
loss_pred:0.024714240804314613, decouple_loss:0.006749369204044342
loss_pred:0.02504657581448555, decouple_loss:0.006822388153523207
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025609297677874565, avg_mse: 0.031430184841156006
current test mse: 0.03143
Iteration: 801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45031842589378357, gen p mean: -0.7751972675323486, mean p set: 0.45079872012138367
The modified gen p mean: 0.4533882737159729, gen p mean: -0.7757560014724731, mean p set: 0.453868567943573
loss_pred:0.025861376896500587, decouple_loss:0.0064205024391412735
loss_pred:0.02436259761452675, decouple_loss:0.006415355484932661
The modified gen p mean: 0.44959643483161926, gen p mean: -0.7729055881500244, mean p set: 0.45007672905921936
loss_pred:0.024584781378507614, decouple_loss:0.006299109198153019
Iteration: 802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451815128326416, gen p mean: -0.770976185798645, mean p set: 0.4522954225540161
The modified gen p mean: 0.452109694480896, gen p mean: -0.7753742933273315, mean p set: 0.4525899887084961
The modified gen p mean: 0.45142194628715515, gen p mean: -0.7739558815956116, mean p set: 0.45190224051475525
loss_pred:0.02424609288573265, decouple_loss:0.006528617348521948
loss_pred:0.024098403751850128, decouple_loss:0.006301627494394779
loss_pred:0.025298841297626495, decouple_loss:0.006368608679622412
Iteration: 803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493976831436157, gen p mean: -0.760182797908783, mean p set: 0.44987794756889343
The modified gen p mean: 0.44945889711380005, gen p mean: -0.7654518485069275, mean p set: 0.44993916153907776
The modified gen p mean: 0.453704297542572, gen p mean: -0.7625561952590942, mean p set: 0.45418456196784973
loss_pred:0.02504153363406658, decouple_loss:0.006547408644109964
loss_pred:0.02429918572306633, decouple_loss:0.0066835652105510235
loss_pred:0.024650616571307182, decouple_loss:0.006515192333608866
Iteration: 804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45086970925331116, gen p mean: -0.7710533142089844, mean p set: 0.45135000348091125
The modified gen p mean: 0.450502872467041, gen p mean: -0.7668673396110535, mean p set: 0.4509831368923187
The modified gen p mean: 0.4513101875782013, gen p mean: -0.7762224674224854, mean p set: 0.4517904818058014
loss_pred:0.024175044149160385, decouple_loss:0.006397099234163761
loss_pred:0.025270793586969376, decouple_loss:0.006287561263889074
loss_pred:0.025446834042668343, decouple_loss:0.006257080473005772
Iteration: 805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45172128081321716, gen p mean: -0.7776986360549927, mean p set: 0.45220157504081726
The modified gen p mean: 0.4498800039291382, gen p mean: -0.7719008922576904, mean p set: 0.4503602981567383
The modified gen p mean: 0.44968271255493164, gen p mean: -0.7764679789543152, mean p set: 0.4501630365848541
loss_pred:0.0240765530616045, decouple_loss:0.006378761492669582
loss_pred:0.024453135207295418, decouple_loss:0.006306102033704519
loss_pred:0.02382081001996994, decouple_loss:0.006428093649446964
Iteration: 806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514254331588745, gen p mean: -0.7870438694953918, mean p set: 0.451905757188797
The modified gen p mean: 0.45151445269584656, gen p mean: -0.7821482419967651, mean p set: 0.45199474692344666
The modified gen p mean: 0.45118770003318787, gen p mean: -0.7818824052810669, mean p set: 0.45166799426078796
loss_pred:0.024541661143302917, decouple_loss:0.006177409086376429
loss_pred:0.023852255195379257, decouple_loss:0.006047210190445185
loss_pred:0.02450582943856716, decouple_loss:0.006200267001986504
Iteration: 807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497741162776947, gen p mean: -0.777923047542572, mean p set: 0.4502543807029724
The modified gen p mean: 0.45108267664909363, gen p mean: -0.7837653160095215, mean p set: 0.4515630006790161
The modified gen p mean: 0.4511820375919342, gen p mean: -0.7839100956916809, mean p set: 0.4516623318195343
loss_pred:0.024076372385025024, decouple_loss:0.006049261894077063loss_pred:0.025555063039064407, decouple_loss:0.006012776400893927
loss_pred:0.02388492412865162, decouple_loss:0.006061966996639967
Iteration: 808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500633776187897, gen p mean: -0.7821312546730042, mean p set: 0.45054367184638977
The modified gen p mean: 0.45053043961524963, gen p mean: -0.7845879793167114, mean p set: 0.45101073384284973
The modified gen p mean: 0.4517233073711395, gen p mean: -0.789764404296875, mean p set: 0.452203631401062
loss_pred:0.023651503026485443, decouple_loss:0.0057449182495474815
loss_pred:0.025350399315357208, decouple_loss:0.0059890965931117535
loss_pred:0.02495800144970417, decouple_loss:0.0057762376964092255
Iteration: 809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516625702381134, gen p mean: -0.7871856689453125, mean p set: 0.4521428644657135
The modified gen p mean: 0.4516680836677551, gen p mean: -0.7899830341339111, mean p set: 0.4521483778953552
The modified gen p mean: 0.4510924220085144, gen p mean: -0.7935733199119568, mean p set: 0.4515727162361145
loss_pred:0.023444702848792076, decouple_loss:0.005678678397089243
loss_pred:0.025161022320389748, decouple_loss:0.006005979608744383
loss_pred:0.024088580161333084, decouple_loss:0.0057300967164337635
Iteration: 810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45117947459220886, gen p mean: -0.7881441712379456, mean p set: 0.4516597390174866
The modified gen p mean: 0.4498148262500763, gen p mean: -0.7891296148300171, mean p set: 0.4502951502799988
loss_pred:0.023916669189929962, decouple_loss:0.005861418321728706
loss_pred:0.023709159344434738, decouple_loss:0.005700149107724428
The modified gen p mean: 0.45179039239883423, gen p mean: -0.791792094707489, mean p set: 0.4522706866264343
loss_pred:0.024941502138972282, decouple_loss:0.00575505243614316
2023-05-07 00:13:24 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.787446916103363, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.77542644739151, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7795723080635071, mean p set: 0.4500633478164673
loss_pred:0.026049990206956863, decouple_loss:0.006538696587085724
loss_pred:0.024662014096975327, decouple_loss:0.006418111268430948
loss_pred:0.02492436394095421, decouple_loss:0.006364081520587206
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025534138083457947, avg_mse: 0.03137964755296707
current test mse: 0.03138
Iteration: 811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45124033093452454, gen p mean: -0.7863630652427673, mean p set: 0.45172062516212463
The modified gen p mean: 0.4527937173843384, gen p mean: -0.7781363129615784, mean p set: 0.4532740116119385
loss_pred:0.025183353573083878, decouple_loss:0.005801547318696976
loss_pred:0.024021241813898087, decouple_loss:0.005929346662014723
The modified gen p mean: 0.45180270075798035, gen p mean: -0.7908270359039307, mean p set: 0.45228299498558044
loss_pred:0.0243830606341362, decouple_loss:0.005918608512729406
Iteration: 812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45251035690307617, gen p mean: -0.7861274480819702, mean p set: 0.4529906213283539
The modified gen p mean: 0.4502943754196167, gen p mean: -0.7844405174255371, mean p set: 0.4507746696472168
The modified gen p mean: 0.4517621397972107, gen p mean: -0.793870210647583, mean p set: 0.4522424042224884
loss_pred:0.023899195715785027, decouple_loss:0.005967519711703062
loss_pred:0.02552979066967964, decouple_loss:0.005883056204766035
loss_pred:0.02400832064449787, decouple_loss:0.005873656831681728
Iteration: 813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962507486343384, gen p mean: -0.7888013124465942, mean p set: 0.45010536909103394
The modified gen p mean: 0.4505032002925873, gen p mean: -0.7871846556663513, mean p set: 0.4509834945201874
The modified gen p mean: 0.45099058747291565, gen p mean: -0.7892600297927856, mean p set: 0.45147088170051575
loss_pred:0.023937644436955452, decouple_loss:0.005790902301669121
loss_pred:0.024379460141062737, decouple_loss:0.006133911199867725
loss_pred:0.023609723895788193, decouple_loss:0.006047308444976807
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
NaN value num: 0
Iteration: 814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45162829756736755, gen p mean: -0.7868924140930176, mean p set: 0.45210859179496765
The modified gen p mean: 0.4501095116138458, gen p mean: -0.7964985370635986, mean p set: 0.4505898058414459
The modified gen p mean: 0.4512511193752289, gen p mean: -0.7920618653297424, mean p set: 0.451731413602829
loss_pred:0.025022339075803757, decouple_loss:0.006826946511864662
loss_pred:0.026518741622567177, decouple_loss:0.006770072504878044
loss_pred:0.024734416976571083, decouple_loss:0.006462385877966881
Iteration: 815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45069777965545654, gen p mean: -0.7818113565444946, mean p set: 0.45117807388305664
The modified gen p mean: 0.4506705701351166, gen p mean: -0.7834643721580505, mean p set: 0.4511508643627167
The modified gen p mean: 0.4510691463947296, gen p mean: -0.7946143746376038, mean p set: 0.4515494108200073
loss_pred:0.025200342759490013, decouple_loss:0.00616836454719305
loss_pred:0.024383321404457092, decouple_loss:0.006440145429223776
loss_pred:0.02435259334743023, decouple_loss:0.006588797550648451
Iteration: 816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851183891296387, gen p mean: -0.7811944484710693, mean p set: 0.44899213314056396
The modified gen p mean: 0.4508024752140045, gen p mean: -0.7896193265914917, mean p set: 0.4512827396392822
The modified gen p mean: 0.45201247930526733, gen p mean: -0.7978941202163696, mean p set: 0.45249274373054504
loss_pred:0.024838579818606377, decouple_loss:0.006319195497781038loss_pred:0.02447926625609398, decouple_loss:0.006870557554066181
loss_pred:0.02555057592689991, decouple_loss:0.0066232457756996155
Iteration: 817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511418342590332, gen p mean: -0.7893181443214417, mean p set: 0.4516221284866333
The modified gen p mean: 0.4499053955078125, gen p mean: -0.7873435616493225, mean p set: 0.4503856897354126
loss_pred:0.024389250203967094, decouple_loss:0.006747104227542877
loss_pred:0.02518988586962223, decouple_loss:0.006453163921833038
The modified gen p mean: 0.45129847526550293, gen p mean: -0.7889109253883362, mean p set: 0.4517787992954254
loss_pred:0.02420782670378685, decouple_loss:0.006457580719143152
Iteration: 818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496452510356903, gen p mean: -0.7869811058044434, mean p set: 0.4501255452632904
The modified gen p mean: 0.4494178593158722, gen p mean: -0.7996647357940674, mean p set: 0.4498981535434723
The modified gen p mean: 0.4515998661518097, gen p mean: -0.7990124821662903, mean p set: 0.4520801901817322
loss_pred:0.023697709664702415, decouple_loss:0.006197432056069374
loss_pred:0.024017130956053734, decouple_loss:0.006318607833236456
loss_pred:0.024203110486268997, decouple_loss:0.006212402135133743
Iteration: 819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519338011741638, gen p mean: -0.7935468554496765, mean p set: 0.4524140954017639
The modified gen p mean: 0.451202392578125, gen p mean: -0.7819527983665466, mean p set: 0.4516826570034027
The modified gen p mean: 0.4511520564556122, gen p mean: -0.791305422782898, mean p set: 0.4516323506832123
loss_pred:0.02555466815829277, decouple_loss:0.005998949520289898loss_pred:0.02429998107254505, decouple_loss:0.0063926964066922665
loss_pred:0.024523159489035606, decouple_loss:0.006562706548720598
Iteration: 820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503430426120758, gen p mean: -0.7858021855354309, mean p set: 0.45082327723503113
The modified gen p mean: 0.45144620537757874, gen p mean: -0.8017421960830688, mean p set: 0.4519265294075012
The modified gen p mean: 0.4524276554584503, gen p mean: -0.7976268529891968, mean p set: 0.452907919883728
loss_pred:0.024708230048418045, decouple_loss:0.006474971771240234
loss_pred:0.025176409631967545, decouple_loss:0.007201382424682379
loss_pred:0.024782324209809303, decouple_loss:0.006799771450459957
2023-05-07 00:17:57 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7927435636520386, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7806273698806763, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7847387790679932, mean p set: 0.4500633478164673
loss_pred:0.025892348960042, decouple_loss:0.0069099185056984425
loss_pred:0.024654656648635864, decouple_loss:0.006985262501984835
loss_pred:0.024904990568757057, decouple_loss:0.006825523916631937
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02549601159989834, avg_mse: 0.03135155513882637
current test mse: 0.031352
Iteration: 821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513040781021118, gen p mean: -0.791452169418335, mean p set: 0.4517843425273895
The modified gen p mean: 0.44942525029182434, gen p mean: -0.7805994749069214, mean p set: 0.44990551471710205
loss_pred:0.026857517659664154, decouple_loss:0.006563963368535042
loss_pred:0.023969219997525215, decouple_loss:0.006176114082336426
The modified gen p mean: 0.4515032470226288, gen p mean: -0.7843332886695862, mean p set: 0.4519835412502289
loss_pred:0.024003269150853157, decouple_loss:0.006410370580852032
Iteration: 822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45360514521598816, gen p mean: -0.7960255742073059, mean p set: 0.45408543944358826
The modified gen p mean: 0.45245257019996643, gen p mean: -0.7931440472602844, mean p set: 0.45293283462524414
The modified gen p mean: 0.45090222358703613, gen p mean: -0.7840796709060669, mean p set: 0.45138245820999146
loss_pred:0.02424437925219536, decouple_loss:0.006262204144150019
loss_pred:0.02465401031076908, decouple_loss:0.0062183174304664135
loss_pred:0.02474542334675789, decouple_loss:0.006014139857143164
Iteration: 823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514826536178589, gen p mean: -0.7858708500862122, mean p set: 0.4519629180431366
The modified gen p mean: 0.44933658838272095, gen p mean: -0.7804040908813477, mean p set: 0.44981685280799866
The modified gen p mean: 0.45188799500465393, gen p mean: -0.7907987236976624, mean p set: 0.45236828923225403
loss_pred:0.023894252255558968, decouple_loss:0.006457086186856031
loss_pred:0.02373916283249855, decouple_loss:0.006177987437695265
loss_pred:0.026596693322062492, decouple_loss:0.006384635344147682
Iteration: 824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523078501224518, gen p mean: -0.7835108637809753, mean p set: 0.45278817415237427
The modified gen p mean: 0.4503227770328522, gen p mean: -0.7781606316566467, mean p set: 0.45080307126045227
The modified gen p mean: 0.45071613788604736, gen p mean: -0.7934983372688293, mean p set: 0.4511964023113251
loss_pred:0.024418577551841736, decouple_loss:0.006082067731767893loss_pred:0.026402611285448074, decouple_loss:0.006193541921675205
loss_pred:0.02430897019803524, decouple_loss:0.006237905006855726
Iteration: 825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498218894004822, gen p mean: -0.7740463614463806, mean p set: 0.4503021836280823
The modified gen p mean: 0.4505951404571533, gen p mean: -0.778576135635376, mean p set: 0.4510754346847534
The modified gen p mean: 0.45097991824150085, gen p mean: -0.7705994248390198, mean p set: 0.45146021246910095
loss_pred:0.02414664626121521, decouple_loss:0.0060313381254673
loss_pred:0.0235342588275671, decouple_loss:0.006000252906233072
loss_pred:0.02424868382513523, decouple_loss:0.0060631646774709225
Iteration: 826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107385516166687, gen p mean: -0.7767682671546936, mean p set: 0.4515541195869446
The modified gen p mean: 0.4520045518875122, gen p mean: -0.7894501686096191, mean p set: 0.4524848163127899
The modified gen p mean: 0.45069530606269836, gen p mean: -0.7819205522537231, mean p set: 0.45117560029029846
loss_pred:0.02372201718389988, decouple_loss:0.006385828368365765
loss_pred:0.0243547186255455, decouple_loss:0.006726454012095928
loss_pred:0.023353328928351402, decouple_loss:0.006133883725851774
Iteration: 827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483845829963684, gen p mean: -0.7792485356330872, mean p set: 0.4488649070262909
The modified gen p mean: 0.45340844988822937, gen p mean: -0.7965006232261658, mean p set: 0.45388877391815186
The modified gen p mean: 0.451077401638031, gen p mean: -0.7865628600120544, mean p set: 0.4515576958656311
loss_pred:0.02411770261824131, decouple_loss:0.006751334294676781
loss_pred:0.024538861587643623, decouple_loss:0.00667712464928627
loss_pred:0.024646224454045296, decouple_loss:0.006101030856370926
Iteration: 828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519680440425873, gen p mean: -0.7825422883033752, mean p set: 0.4524483382701874
The modified gen p mean: 0.4511569142341614, gen p mean: -0.7964231967926025, mean p set: 0.45163723826408386
The modified gen p mean: 0.45078417658805847, gen p mean: -0.7831866145133972, mean p set: 0.45126447081565857
loss_pred:0.025809163227677345, decouple_loss:0.0062877824530005455
loss_pred:0.024841394275426865, decouple_loss:0.00657364958897233
loss_pred:0.02486405149102211, decouple_loss:0.006159329321235418
Iteration: 829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45052945613861084, gen p mean: -0.7833450436592102, mean p set: 0.4510097801685333
The modified gen p mean: 0.4503142237663269, gen p mean: -0.7773273587226868, mean p set: 0.450794517993927
The modified gen p mean: 0.44991496205329895, gen p mean: -0.78583824634552, mean p set: 0.45039525628089905
loss_pred:0.024495502933859825, decouple_loss:0.0062250737100839615
loss_pred:0.02480768784880638, decouple_loss:0.006712090689688921
loss_pred:0.0250119399279356, decouple_loss:0.0061410460621118546
Iteration: 830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514698386192322, gen p mean: -0.7825684547424316, mean p set: 0.4519501030445099
The modified gen p mean: 0.4507061541080475, gen p mean: -0.7855237126350403, mean p set: 0.4511864483356476
The modified gen p mean: 0.44912320375442505, gen p mean: -0.7721405029296875, mean p set: 0.44960349798202515
loss_pred:0.024399882182478905, decouple_loss:0.006361931562423706
loss_pred:0.02491871640086174, decouple_loss:0.006174257956445217
loss_pred:0.024127161130309105, decouple_loss:0.006058532744646072
2023-05-07 00:21:36 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7851767539978027, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7728050351142883, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7767956256866455, mean p set: 0.4500633478164673
loss_pred:0.02636267989873886, decouple_loss:0.006904957816004753
loss_pred:0.02501824125647545, decouple_loss:0.0067397779785096645
loss_pred:0.02535795420408249, decouple_loss:0.006605587899684906
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025917131453752518, avg_mse: 0.032043565064668655
current test mse: 0.032044
Iteration: 831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45093315839767456, gen p mean: -0.7649922966957092, mean p set: 0.45141345262527466
The modified gen p mean: 0.45307889580726624, gen p mean: -0.7875910401344299, mean p set: 0.45355916023254395
loss_pred:0.025570441037416458, decouple_loss:0.00594740267843008
loss_pred:0.024693917483091354, decouple_loss:0.006201228126883507
The modified gen p mean: 0.45256802439689636, gen p mean: -0.7875921130180359, mean p set: 0.45304831862449646
loss_pred:0.025120744481682777, decouple_loss:0.006462693680077791
Iteration: 832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516259729862213, gen p mean: -0.7764420509338379, mean p set: 0.452106237411499
The modified gen p mean: 0.45186030864715576, gen p mean: -0.7742952108383179, mean p set: 0.45234063267707825
loss_pred:0.024494031444191933, decouple_loss:0.006423055659979582
loss_pred:0.02551511861383915, decouple_loss:0.006189931184053421
The modified gen p mean: 0.4502854347229004, gen p mean: -0.7931965589523315, mean p set: 0.4507656991481781
loss_pred:0.025257017463445663, decouple_loss:0.006403111852705479
Iteration: 833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44956016540527344, gen p mean: -0.7665179371833801, mean p set: 0.45004045963287354
The modified gen p mean: 0.45151910185813904, gen p mean: -0.7814006805419922, mean p set: 0.45199936628341675
The modified gen p mean: 0.45139601826667786, gen p mean: -0.7698319554328918, mean p set: 0.45187628269195557
loss_pred:0.02428102307021618, decouple_loss:0.006262883078306913
loss_pred:0.025790922343730927, decouple_loss:0.006454199552536011
loss_pred:0.024654824286699295, decouple_loss:0.006827999837696552
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476472735404968, gen p mean: -0.76873779296875, mean p set: 0.4481275677680969
The modified gen p mean: 0.4470824897289276, gen p mean: -0.7721811532974243, mean p set: 0.4475627839565277
The modified gen p mean: 0.4480898678302765, gen p mean: -0.7707456946372986, mean p set: 0.448570191860199
loss_pred:0.024091172963380814, decouple_loss:0.007727468851953745
loss_pred:0.02597670443356037, decouple_loss:0.007322598714381456
loss_pred:0.025625819340348244, decouple_loss:0.0071850912645459175
Iteration: 835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478108584880829, gen p mean: -0.7712039351463318, mean p set: 0.44829118251800537
The modified gen p mean: 0.4460422694683075, gen p mean: -0.7692422270774841, mean p set: 0.4465225338935852
The modified gen p mean: 0.44654273986816406, gen p mean: -0.7687709927558899, mean p set: 0.44702303409576416
loss_pred:0.025844352319836617, decouple_loss:0.006764070596545935
loss_pred:0.02545871026813984, decouple_loss:0.00710632000118494
loss_pred:0.025477461516857147, decouple_loss:0.0070858001708984375
Iteration: 836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653892517089844, gen p mean: -0.7751074433326721, mean p set: 0.44701918959617615
The modified gen p mean: 0.44670340418815613, gen p mean: -0.7690333127975464, mean p set: 0.4471836984157562
The modified gen p mean: 0.4484224021434784, gen p mean: -0.7844706177711487, mean p set: 0.4489026963710785
loss_pred:0.02525627799332142, decouple_loss:0.0068391673266887665loss_pred:0.02515573799610138, decouple_loss:0.006980253849178553
loss_pred:0.024478299543261528, decouple_loss:0.0071322135627269745
Iteration: 837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469147026538849, gen p mean: -0.775568425655365, mean p set: 0.447394996881485
The modified gen p mean: 0.4458525478839874, gen p mean: -0.7718075513839722, mean p set: 0.4463328719139099
The modified gen p mean: 0.44676193594932556, gen p mean: -0.7719159722328186, mean p set: 0.44724223017692566
loss_pred:0.0254328902810812, decouple_loss:0.006943035870790482
loss_pred:0.02516537345945835, decouple_loss:0.006904496345669031
loss_pred:0.02516672946512699, decouple_loss:0.006905154790729284
Iteration: 838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676217436790466, gen p mean: -0.7791483402252197, mean p set: 0.44724246859550476
The modified gen p mean: 0.44735148549079895, gen p mean: -0.7795505523681641, mean p set: 0.44783177971839905
The modified gen p mean: 0.4468006491661072, gen p mean: -0.7752470374107361, mean p set: 0.4472809433937073
loss_pred:0.024963118135929108, decouple_loss:0.006746124941855669
loss_pred:0.025824440643191338, decouple_loss:0.006892709527164698
loss_pred:0.025403790175914764, decouple_loss:0.00681320670992136
Iteration: 839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724735617637634, gen p mean: -0.7876535654067993, mean p set: 0.44772762060165405
The modified gen p mean: 0.4460238814353943, gen p mean: -0.7821785807609558, mean p set: 0.446504145860672
The modified gen p mean: 0.44719481468200684, gen p mean: -0.78460294008255, mean p set: 0.44767507910728455
loss_pred:0.0237147007137537, decouple_loss:0.006972211878746748
loss_pred:0.025274677202105522, decouple_loss:0.007028673309832811
loss_pred:0.023745939135551453, decouple_loss:0.007231842260807753
Iteration: 840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609978795051575, gen p mean: -0.7817632555961609, mean p set: 0.44658011198043823
The modified gen p mean: 0.4469868242740631, gen p mean: -0.7909801602363586, mean p set: 0.4474670886993408
The modified gen p mean: 0.4468706548213959, gen p mean: -0.7810078859329224, mean p set: 0.44735097885131836
loss_pred:0.025790484622120857, decouple_loss:0.006911266595125198
loss_pred:0.02441953308880329, decouple_loss:0.006873362231999636
loss_pred:0.024556273594498634, decouple_loss:0.006772579625248909
2023-05-07 00:26:11 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7997982501983643, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7872892618179321, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7918883562088013, mean p set: 0.4500633478164673
loss_pred:0.025903932750225067, decouple_loss:0.007228259928524494
loss_pred:0.024645313620567322, decouple_loss:0.006857850588858128
loss_pred:0.02496013231575489, decouple_loss:0.006880834233015776
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025519242510199547, avg_mse: 0.03129458427429199
current test mse: 0.031295
Iteration: 841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785258173942566, gen p mean: -0.7939085364341736, mean p set: 0.44833290576934814
The modified gen p mean: 0.44771742820739746, gen p mean: -0.7965674996376038, mean p set: 0.44819772243499756
loss_pred:0.024901391938328743, decouple_loss:0.006864591035991907
loss_pred:0.026107924059033394, decouple_loss:0.006976222153753042
The modified gen p mean: 0.44808536767959595, gen p mean: -0.8043243288993835, mean p set: 0.44856566190719604
loss_pred:0.02438117377460003, decouple_loss:0.006986042018979788
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802191853523254, gen p mean: -0.7987843751907349, mean p set: 0.44850221276283264
The modified gen p mean: 0.4461709260940552, gen p mean: -0.789686381816864, mean p set: 0.4466512203216553
loss_pred:0.02478250116109848, decouple_loss:0.006729510612785816
loss_pred:0.02602899819612503, decouple_loss:0.006560856476426125
The modified gen p mean: 0.4471958875656128, gen p mean: -0.7918556332588196, mean p set: 0.4476762115955353
loss_pred:0.024254119023680687, decouple_loss:0.006534249056130648
Iteration: 843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461408257484436, gen p mean: -0.7871508002281189, mean p set: 0.4466211497783661
The modified gen p mean: 0.4470779299736023, gen p mean: -0.7844876646995544, mean p set: 0.4475582242012024
The modified gen p mean: 0.4459840953350067, gen p mean: -0.7863535284996033, mean p set: 0.4464643895626068
loss_pred:0.025036536157131195, decouple_loss:0.006656804587692022
loss_pred:0.024031884968280792, decouple_loss:0.006986093707382679
loss_pred:0.02537984773516655, decouple_loss:0.006522254087030888
Iteration: 844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758936762809753, gen p mean: -0.7835913300514221, mean p set: 0.44806966185569763
The modified gen p mean: 0.4471133351325989, gen p mean: -0.7873541116714478, mean p set: 0.447593629360199
The modified gen p mean: 0.4462994635105133, gen p mean: -0.7792798280715942, mean p set: 0.4467797577381134
loss_pred:0.024450376629829407, decouple_loss:0.0066762398928403854
loss_pred:0.02426227368414402, decouple_loss:0.006621937733143568
loss_pred:0.02461041882634163, decouple_loss:0.00690538389608264
Iteration: 845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473232924938202, gen p mean: -0.782270610332489, mean p set: 0.4478035867214203
The modified gen p mean: 0.4473578929901123, gen p mean: -0.783798336982727, mean p set: 0.4478381872177124
The modified gen p mean: 0.44644370675086975, gen p mean: -0.7732239365577698, mean p set: 0.44692397117614746
loss_pred:0.02474304288625717, decouple_loss:0.00671433936804533
loss_pred:0.02445957250893116, decouple_loss:0.006621529348194599
loss_pred:0.024920688942074776, decouple_loss:0.0066018239594995975
Iteration: 846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470162093639374, gen p mean: -0.7663311958312988, mean p set: 0.4474965035915375
The modified gen p mean: 0.4460639953613281, gen p mean: -0.7685592770576477, mean p set: 0.4465442895889282
The modified gen p mean: 0.4472261667251587, gen p mean: -0.7671347260475159, mean p set: 0.4477064609527588
loss_pred:0.024288848042488098, decouple_loss:0.006500705145299435
loss_pred:0.024788178503513336, decouple_loss:0.006613525096327066
loss_pred:0.024517560377717018, decouple_loss:0.006424154620617628
Iteration: 847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473389685153961, gen p mean: -0.7801752090454102, mean p set: 0.44781920313835144
The modified gen p mean: 0.4468885660171509, gen p mean: -0.7666042447090149, mean p set: 0.447368860244751
The modified gen p mean: 0.4469716250896454, gen p mean: -0.7654316425323486, mean p set: 0.4474518895149231
loss_pred:0.024948541074991226, decouple_loss:0.0068061170168221
loss_pred:0.024967536330223083, decouple_loss:0.006471066735684872
loss_pred:0.02506139874458313, decouple_loss:0.006932381074875593
Iteration: 848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44603610038757324, gen p mean: -0.7670913338661194, mean p set: 0.44651639461517334
The modified gen p mean: 0.4471054971218109, gen p mean: -0.7713570594787598, mean p set: 0.447585791349411
The modified gen p mean: 0.4488254487514496, gen p mean: -0.7833607792854309, mean p set: 0.44930580258369446
loss_pred:0.02507854253053665, decouple_loss:0.006454429589211941
loss_pred:0.024368077516555786, decouple_loss:0.006131091620773077
loss_pred:0.02425917610526085, decouple_loss:0.006692996248602867
Iteration: 849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683948159217834, gen p mean: -0.768403947353363, mean p set: 0.44731974601745605
The modified gen p mean: 0.44709211587905884, gen p mean: -0.7819331884384155, mean p set: 0.4475724399089813
The modified gen p mean: 0.44798219203948975, gen p mean: -0.7814183235168457, mean p set: 0.44846251606941223
loss_pred:0.024122776463627815, decouple_loss:0.006411032285541296
loss_pred:0.023570852354168892, decouple_loss:0.006490016356110573
loss_pred:0.023870721459388733, decouple_loss:0.006449345964938402
Iteration: 850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469093978404999, gen p mean: -0.7692779898643494, mean p set: 0.44738972187042236
The modified gen p mean: 0.4469561278820038, gen p mean: -0.7817559242248535, mean p set: 0.4474363923072815
The modified gen p mean: 0.4468631148338318, gen p mean: -0.7653481960296631, mean p set: 0.4473433792591095
loss_pred:0.02448652684688568, decouple_loss:0.0066594830714166164
loss_pred:0.025103455409407616, decouple_loss:0.006501395720988512
loss_pred:0.024672726169228554, decouple_loss:0.006258527282625437
2023-05-07 00:29:50 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7743921279907227, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7623593807220459, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7668372988700867, mean p set: 0.4500633478164673
loss_pred:0.025608841329813004, decouple_loss:0.006740774028003216
loss_pred:0.024423938244581223, decouple_loss:0.0065684569999575615
loss_pred:0.02465471625328064, decouple_loss:0.006535378284752369
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025226576253771782, avg_mse: 0.030992478132247925
current test mse: 0.030992
Iteration: 851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478234350681305, gen p mean: -0.782586395740509, mean p set: 0.4483036994934082
The modified gen p mean: 0.4465855360031128, gen p mean: -0.7648544311523438, mean p set: 0.4470658302307129
loss_pred:0.02357807569205761, decouple_loss:0.006502540782094002
loss_pred:0.025393228977918625, decouple_loss:0.006351872812956572
The modified gen p mean: 0.4470537006855011, gen p mean: -0.767300546169281, mean p set: 0.4475339949131012
loss_pred:0.02449985034763813, decouple_loss:0.0065023391507565975
Iteration: 852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44670695066452026, gen p mean: -0.7696241736412048, mean p set: 0.44718724489212036
The modified gen p mean: 0.4471782445907593, gen p mean: -0.7693328857421875, mean p set: 0.4476585388183594
The modified gen p mean: 0.4469614624977112, gen p mean: -0.7648603916168213, mean p set: 0.4474417567253113
loss_pred:0.02526896446943283, decouple_loss:0.006282726302742958
loss_pred:0.024506324902176857, decouple_loss:0.006128143519163132
loss_pred:0.02444770559668541, decouple_loss:0.006270270328968763
Iteration: 853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44625112414360046, gen p mean: -0.7660550475120544, mean p set: 0.44673141837120056
The modified gen p mean: 0.4465208947658539, gen p mean: -0.7670014500617981, mean p set: 0.44700121879577637
The modified gen p mean: 0.447511225938797, gen p mean: -0.7836382389068604, mean p set: 0.4479915201663971
loss_pred:0.02518731914460659, decouple_loss:0.0060970596969127655
loss_pred:0.024422310292720795, decouple_loss:0.006494758650660515
loss_pred:0.02406362257897854, decouple_loss:0.00633736839517951
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
NaN value num: 0
Iteration: 854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516770541667938, gen p mean: -0.766386866569519, mean p set: 0.4521573483943939
The modified gen p mean: 0.45160794258117676, gen p mean: -0.7727857232093811, mean p set: 0.45208823680877686
The modified gen p mean: 0.4500552713871002, gen p mean: -0.7683135271072388, mean p set: 0.45053553581237793
loss_pred:0.02448670007288456, decouple_loss:0.007353810127824545
loss_pred:0.025797812268137932, decouple_loss:0.007622757460922003
loss_pred:0.02551010064780712, decouple_loss:0.007267396431416273
Iteration: 855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214134454727173, gen p mean: -0.7697626948356628, mean p set: 0.4526216387748718
The modified gen p mean: 0.45230716466903687, gen p mean: -0.7646153569221497, mean p set: 0.4527874290943146
The modified gen p mean: 0.45215368270874023, gen p mean: -0.7604507207870483, mean p set: 0.4526340067386627
loss_pred:0.02531532570719719, decouple_loss:0.007466133218258619
loss_pred:0.025779422372579575, decouple_loss:0.007409775163978338
loss_pred:0.025135254487395287, decouple_loss:0.007765543181449175
Iteration: 856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45201826095581055, gen p mean: -0.7750025391578674, mean p set: 0.45249855518341064
The modified gen p mean: 0.44973111152648926, gen p mean: -0.7703469395637512, mean p set: 0.45021140575408936
The modified gen p mean: 0.45159995555877686, gen p mean: -0.7684202790260315, mean p set: 0.45208021998405457
loss_pred:0.02496558241546154, decouple_loss:0.007180504500865936
loss_pred:0.02542089857161045, decouple_loss:0.0070393141359090805
loss_pred:0.023826539516448975, decouple_loss:0.0069215986877679825
Iteration: 857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45156458020210266, gen p mean: -0.7667304277420044, mean p set: 0.45204487442970276
The modified gen p mean: 0.4521905481815338, gen p mean: -0.7690337896347046, mean p set: 0.4526708424091339
The modified gen p mean: 0.4522381126880646, gen p mean: -0.7700886726379395, mean p set: 0.4527184069156647
loss_pred:0.02432394213974476, decouple_loss:0.006715752184391022
loss_pred:0.025086229667067528, decouple_loss:0.006988524459302425
loss_pred:0.02516597881913185, decouple_loss:0.0070775714702904224
Iteration: 858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515107572078705, gen p mean: -0.7762775421142578, mean p set: 0.4519910514354706
The modified gen p mean: 0.45163705945014954, gen p mean: -0.7719792127609253, mean p set: 0.45211732387542725
The modified gen p mean: 0.45109444856643677, gen p mean: -0.7673768997192383, mean p set: 0.45157474279403687
loss_pred:0.024486906826496124, decouple_loss:0.006835428532212973
loss_pred:0.024941066280007362, decouple_loss:0.006549757905304432
loss_pred:0.024573884904384613, decouple_loss:0.00655798614025116
Iteration: 859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505494236946106, gen p mean: -0.7720116972923279, mean p set: 0.4510296881198883
The modified gen p mean: 0.4515424966812134, gen p mean: -0.7685540318489075, mean p set: 0.4520227611064911
The modified gen p mean: 0.45213308930397034, gen p mean: -0.7700139880180359, mean p set: 0.45261338353157043
loss_pred:0.02558886632323265, decouple_loss:0.006843547336757183
loss_pred:0.024561738595366478, decouple_loss:0.00688612274825573
loss_pred:0.025103896856307983, decouple_loss:0.006687595508992672
Iteration: 860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452006995677948, gen p mean: -0.76203852891922, mean p set: 0.4524872899055481
The modified gen p mean: 0.4508665204048157, gen p mean: -0.7630631923675537, mean p set: 0.45134681463241577
The modified gen p mean: 0.4515102803707123, gen p mean: -0.756186842918396, mean p set: 0.4519905745983124
loss_pred:0.024392414838075638, decouple_loss:0.0066602230072021484
loss_pred:0.024123819544911385, decouple_loss:0.006750097963958979
loss_pred:0.024498378857970238, decouple_loss:0.006725845392793417
2023-05-07 00:34:07 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.766390860080719, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7549686431884766, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7590875029563904, mean p set: 0.4500633478164673
loss_pred:0.025690549984574318, decouple_loss:0.007363202515989542
loss_pred:0.02456723153591156, decouple_loss:0.007197130471467972
loss_pred:0.024778157472610474, decouple_loss:0.007037160452455282
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025371938943862915, avg_mse: 0.031200489029288292
current test mse: 0.0312
Iteration: 861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45138177275657654, gen p mean: -0.7588816285133362, mean p set: 0.45186206698417664
The modified gen p mean: 0.4520340859889984, gen p mean: -0.7544177174568176, mean p set: 0.4525144100189209
loss_pred:0.02507714368402958, decouple_loss:0.0064448160119354725
loss_pred:0.02462676167488098, decouple_loss:0.006760311312973499
The modified gen p mean: 0.4496256113052368, gen p mean: -0.7575314044952393, mean p set: 0.4501059055328369
loss_pred:0.025151800364255905, decouple_loss:0.006750420201569796
Iteration: 862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45161575078964233, gen p mean: -0.765483021736145, mean p set: 0.45209604501724243
The modified gen p mean: 0.450133353471756, gen p mean: -0.7656252384185791, mean p set: 0.45061367750167847
The modified gen p mean: 0.45300528407096863, gen p mean: -0.7726447582244873, mean p set: 0.4534855782985687
loss_pred:0.02484232932329178, decouple_loss:0.0066906968131661415
loss_pred:0.025035953149199486, decouple_loss:0.00644933246076107
loss_pred:0.024939855560660362, decouple_loss:0.006715668365359306
Iteration: 863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519518315792084, gen p mean: -0.7842746376991272, mean p set: 0.45243212580680847
The modified gen p mean: 0.4510997235774994, gen p mean: -0.772086501121521, mean p set: 0.4515799880027771
The modified gen p mean: 0.4513913691043854, gen p mean: -0.7735084295272827, mean p set: 0.4518716335296631
loss_pred:0.023997116833925247, decouple_loss:0.0067040035501122475
loss_pred:0.024730155244469643, decouple_loss:0.006571833975613117
loss_pred:0.024549562484025955, decouple_loss:0.006827739533036947
Iteration: 864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45000511407852173, gen p mean: -0.7806583046913147, mean p set: 0.4504854083061218
The modified gen p mean: 0.4518471956253052, gen p mean: -0.786592960357666, mean p set: 0.4523274898529053
The modified gen p mean: 0.4515676498413086, gen p mean: -0.7861909866333008, mean p set: 0.4520479440689087
loss_pred:0.02537311427295208, decouple_loss:0.006496435031294823
loss_pred:0.02448728308081627, decouple_loss:0.006360189989209175
loss_pred:0.023700974881649017, decouple_loss:0.006309008225798607
Iteration: 865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214730501174927, gen p mean: -0.7735733389854431, mean p set: 0.452627569437027
The modified gen p mean: 0.45171889662742615, gen p mean: -0.771844208240509, mean p set: 0.45219916105270386
The modified gen p mean: 0.4494275152683258, gen p mean: -0.7737602591514587, mean p set: 0.4499078094959259
loss_pred:0.02503320202231407, decouple_loss:0.006852718070149422
loss_pred:0.02492634393274784, decouple_loss:0.0065244343131780624
loss_pred:0.025245225057005882, decouple_loss:0.0063284593634307384
Iteration: 866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527052342891693, gen p mean: -0.7850033640861511, mean p set: 0.4531855285167694
The modified gen p mean: 0.4513651728630066, gen p mean: -0.7864736914634705, mean p set: 0.4518454968929291
The modified gen p mean: 0.45138242840766907, gen p mean: -0.7757663726806641, mean p set: 0.4518626928329468
loss_pred:0.024693971499800682, decouple_loss:0.006443942431360483
loss_pred:0.0245654359459877, decouple_loss:0.006509395781904459
loss_pred:0.024279825389385223, decouple_loss:0.006167567800730467
Iteration: 867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45157450437545776, gen p mean: -0.7824171185493469, mean p set: 0.45205479860305786
The modified gen p mean: 0.4520275294780731, gen p mean: -0.791475236415863, mean p set: 0.4525078237056732
The modified gen p mean: 0.4520479142665863, gen p mean: -0.7867655158042908, mean p set: 0.4525282084941864
loss_pred:0.023610424250364304, decouple_loss:0.006156911142170429
loss_pred:0.024556146934628487, decouple_loss:0.006336068268865347
loss_pred:0.023353110998868942, decouple_loss:0.006416784133762121
Iteration: 868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511058032512665, gen p mean: -0.7825722098350525, mean p set: 0.4515860676765442
The modified gen p mean: 0.451847106218338, gen p mean: -0.7720293402671814, mean p set: 0.4523273706436157
loss_pred:0.023664604872465134, decouple_loss:0.006172890309244394
loss_pred:0.024483196437358856, decouple_loss:0.006481147836893797
The modified gen p mean: 0.4515809118747711, gen p mean: -0.7824670076370239, mean p set: 0.4520612061023712
loss_pred:0.024529555812478065, decouple_loss:0.0062285433523356915
Iteration: 869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525078535079956, gen p mean: -0.7755252718925476, mean p set: 0.4529881477355957
The modified gen p mean: 0.45196521282196045, gen p mean: -0.7846078872680664, mean p set: 0.45244550704956055
The modified gen p mean: 0.45209887623786926, gen p mean: -0.7836954593658447, mean p set: 0.452579140663147
loss_pred:0.02462705783545971, decouple_loss:0.006693726405501366
loss_pred:0.023486942052841187, decouple_loss:0.006163592915982008
loss_pred:0.02522001974284649, decouple_loss:0.006213150918483734
Iteration: 870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505527913570404, gen p mean: -0.7840867042541504, mean p set: 0.4510330855846405
The modified gen p mean: 0.4512491226196289, gen p mean: -0.7825926542282104, mean p set: 0.451729416847229
The modified gen p mean: 0.45136353373527527, gen p mean: -0.7809250950813293, mean p set: 0.45184382796287537
loss_pred:0.02453429438173771, decouple_loss:0.006047978065907955
loss_pred:0.024835839867591858, decouple_loss:0.006077935919165611
loss_pred:0.023568762466311455, decouple_loss:0.00624836003407836
2023-05-07 00:37:43 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7983958125114441, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7851254343986511, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.789562463760376, mean p set: 0.4500633478164673
loss_pred:0.025874275714159012, decouple_loss:0.007024830207228661
loss_pred:0.024551456794142723, decouple_loss:0.006910289172083139
loss_pred:0.024853141978383064, decouple_loss:0.006735203322023153
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02543746493756771, avg_mse: 0.03138970956206322
current test mse: 0.03139
Iteration: 871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505445659160614, gen p mean: -0.7898378372192383, mean p set: 0.4510248601436615
The modified gen p mean: 0.45116686820983887, gen p mean: -0.7834965586662292, mean p set: 0.45164716243743896
loss_pred:0.0247616246342659, decouple_loss:0.0063824220560491085
loss_pred:0.024289296939969063, decouple_loss:0.006162258330732584
The modified gen p mean: 0.4512441158294678, gen p mean: -0.7819401025772095, mean p set: 0.45172441005706787
loss_pred:0.025108976289629936, decouple_loss:0.006311475764960051
Iteration: 872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214715600013733, gen p mean: -0.7975355386734009, mean p set: 0.45262742042541504
The modified gen p mean: 0.4511953592300415, gen p mean: -0.7842639684677124, mean p set: 0.4516755938529968
The modified gen p mean: 0.4515194892883301, gen p mean: -0.7832962870597839, mean p set: 0.45199981331825256
loss_pred:0.02437477372586727, decouple_loss:0.00614906707778573
loss_pred:0.0241143386811018, decouple_loss:0.0061112092807888985
loss_pred:0.023756952956318855, decouple_loss:0.006021073088049889
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
NaN value num: 0
Iteration: 873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45173466205596924, gen p mean: -0.8011555671691895, mean p set: 0.45221495628356934
The modified gen p mean: 0.45310264825820923, gen p mean: -0.8010728359222412, mean p set: 0.45358291268348694
The modified gen p mean: 0.4518750011920929, gen p mean: -0.7872862219810486, mean p set: 0.452355295419693
loss_pred:0.02304396778345108, decouple_loss:0.0066755604930222034
loss_pred:0.024036383256316185, decouple_loss:0.006296027451753616
loss_pred:0.024653378874063492, decouple_loss:0.006150440312922001
Iteration: 874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532967507839203, gen p mean: -0.8030134439468384, mean p set: 0.453777015209198
The modified gen p mean: 0.45147210359573364, gen p mean: -0.7822697758674622, mean p set: 0.45195239782333374
The modified gen p mean: 0.4520944654941559, gen p mean: -0.7824837565422058, mean p set: 0.452574759721756
loss_pred:0.02400648407638073, decouple_loss:0.006440572440624237
loss_pred:0.0247521810233593, decouple_loss:0.006276019383221865
loss_pred:0.024095237255096436, decouple_loss:0.006348719820380211
Iteration: 875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45265108346939087, gen p mean: -0.7669525742530823, mean p set: 0.4531313478946686
The modified gen p mean: 0.45338529348373413, gen p mean: -0.7735322713851929, mean p set: 0.45386558771133423
The modified gen p mean: 0.45241695642471313, gen p mean: -0.7699404358863831, mean p set: 0.45289722084999084
loss_pred:0.024413559585809708, decouple_loss:0.005974729545414448
loss_pred:0.023165728896856308, decouple_loss:0.00613267021253705
loss_pred:0.02380373887717724, decouple_loss:0.005902136210352182
Iteration: 876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514908194541931, gen p mean: -0.7699771523475647, mean p set: 0.4519711136817932
The modified gen p mean: 0.45239338278770447, gen p mean: -0.7898176312446594, mean p set: 0.45287367701530457
The modified gen p mean: 0.4513983428478241, gen p mean: -0.7649711966514587, mean p set: 0.4518786072731018
loss_pred:0.02371436171233654, decouple_loss:0.005995655432343483
loss_pred:0.025465089827775955, decouple_loss:0.006399882957339287
loss_pred:0.025218673050403595, decouple_loss:0.006321675144135952
Iteration: 877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518676996231079, gen p mean: -0.7867576479911804, mean p set: 0.4523479640483856
The modified gen p mean: 0.4521476924419403, gen p mean: -0.772299587726593, mean p set: 0.4526279866695404
The modified gen p mean: 0.4532409906387329, gen p mean: -0.7939261198043823, mean p set: 0.4537212550640106
loss_pred:0.02390749379992485, decouple_loss:0.006134417839348316
loss_pred:0.0253337100148201, decouple_loss:0.006109981797635555
loss_pred:0.024327224120497704, decouple_loss:0.006285030394792557
Iteration: 878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45193371176719666, gen p mean: -0.7705810070037842, mean p set: 0.45241400599479675
The modified gen p mean: 0.4518061578273773, gen p mean: -0.7764807939529419, mean p set: 0.45228642225265503
The modified gen p mean: 0.4512392580509186, gen p mean: -0.7753793001174927, mean p set: 0.45171958208084106
loss_pred:0.024166185408830643, decouple_loss:0.006110369693487883
loss_pred:0.02427954226732254, decouple_loss:0.006164880469441414
loss_pred:0.024289406836032867, decouple_loss:0.005996132269501686
Iteration: 879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522055387496948, gen p mean: -0.7873120903968811, mean p set: 0.4526858329772949
The modified gen p mean: 0.452045738697052, gen p mean: -0.7902339696884155, mean p set: 0.4525260329246521
The modified gen p mean: 0.4521658420562744, gen p mean: -0.7834365963935852, mean p set: 0.4526461064815521
loss_pred:0.024784132838249207, decouple_loss:0.006246435455977917
loss_pred:0.02511005289852619, decouple_loss:0.006288152653723955
loss_pred:0.024547291919589043, decouple_loss:0.006304011680185795
Iteration: 880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506340026855469, gen p mean: -0.7760694026947021, mean p set: 0.451114296913147
The modified gen p mean: 0.4533820152282715, gen p mean: -0.7887126803398132, mean p set: 0.4538623094558716
The modified gen p mean: 0.4520377218723297, gen p mean: -0.7828464508056641, mean p set: 0.4525179862976074
loss_pred:0.02535576932132244, decouple_loss:0.006087788846343756
loss_pred:0.02508651278913021, decouple_loss:0.006526471581310034
loss_pred:0.023871056735515594, decouple_loss:0.006063365843147039
2023-05-07 00:42:05 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7778226137161255, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7646834850311279, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7693006992340088, mean p set: 0.4500633478164673
loss_pred:0.026325123384594917, decouple_loss:0.006978536490350962
loss_pred:0.025048386305570602, decouple_loss:0.0068662129342556
loss_pred:0.02525213547050953, decouple_loss:0.006876711267977953
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02588724158704281, avg_mse: 0.03205578774213791
current test mse: 0.032056
Iteration: 881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45133957266807556, gen p mean: -0.7633866667747498, mean p set: 0.45181983709335327
loss_pred:0.025620989501476288, decouple_loss:0.006527820136398077
The modified gen p mean: 0.4535418450832367, gen p mean: -0.7776079177856445, mean p set: 0.4540221691131592
loss_pred:0.0235412809997797, decouple_loss:0.006475774105638266
The modified gen p mean: 0.45355185866355896, gen p mean: -0.7758231163024902, mean p set: 0.45403215289115906
loss_pred:0.023590389639139175, decouple_loss:0.006290077231824398
Iteration: 882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45124927163124084, gen p mean: -0.7550649046897888, mean p set: 0.45172953605651855
The modified gen p mean: 0.45208415389060974, gen p mean: -0.7627764344215393, mean p set: 0.45256444811820984
The modified gen p mean: 0.4532608985900879, gen p mean: -0.7616698741912842, mean p set: 0.453741192817688
loss_pred:0.0245224516838789, decouple_loss:0.00649783993139863
loss_pred:0.024411408230662346, decouple_loss:0.006208247970789671
loss_pred:0.024951867759227753, decouple_loss:0.0066900611855089664
Iteration: 883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521664083003998, gen p mean: -0.757920503616333, mean p set: 0.4526466727256775
The modified gen p mean: 0.4526793658733368, gen p mean: -0.7740563750267029, mean p set: 0.4531596302986145
The modified gen p mean: 0.45035693049430847, gen p mean: -0.7526432275772095, mean p set: 0.4508371949195862
loss_pred:0.024078920483589172, decouple_loss:0.006929360330104828loss_pred:0.025005847215652466, decouple_loss:0.006636482197791338
loss_pred:0.024883747100830078, decouple_loss:0.006772963330149651
Iteration: 884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527105987071991, gen p mean: -0.7643866539001465, mean p set: 0.4531908929347992
The modified gen p mean: 0.4523658752441406, gen p mean: -0.7668049335479736, mean p set: 0.4528461992740631
The modified gen p mean: 0.45155203342437744, gen p mean: -0.7640615701675415, mean p set: 0.45203232765197754
loss_pred:0.02431649900972843, decouple_loss:0.007569243665784597
loss_pred:0.02515316568315029, decouple_loss:0.007641298230737448
loss_pred:0.026085546240210533, decouple_loss:0.007836747914552689
Iteration: 885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506920278072357, gen p mean: -0.7772229313850403, mean p set: 0.4511723518371582
The modified gen p mean: 0.45127588510513306, gen p mean: -0.7796590924263, mean p set: 0.4517561197280884
The modified gen p mean: 0.45091700553894043, gen p mean: -0.785267174243927, mean p set: 0.4513972997665405
loss_pred:0.02527928538620472, decouple_loss:0.006798402406275272
loss_pred:0.025520358234643936, decouple_loss:0.007133644074201584
loss_pred:0.024588096886873245, decouple_loss:0.006762290373444557
Iteration: 886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507414400577545, gen p mean: -0.7790907025337219, mean p set: 0.4512217342853546
The modified gen p mean: 0.45066335797309875, gen p mean: -0.7786622047424316, mean p set: 0.45114362239837646
The modified gen p mean: 0.45086798071861267, gen p mean: -0.7829256653785706, mean p set: 0.4513482451438904
loss_pred:0.024043021723628044, decouple_loss:0.007493758574128151
loss_pred:0.02352566085755825, decouple_loss:0.007594847120344639
loss_pred:0.024405349045991898, decouple_loss:0.00749688595533371
Iteration: 887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524117708206177, gen p mean: -0.7851420044898987, mean p set: 0.4528920352458954
The modified gen p mean: 0.45261839032173157, gen p mean: -0.7930482625961304, mean p set: 0.4530986547470093
The modified gen p mean: 0.4531414210796356, gen p mean: -0.7843033671379089, mean p set: 0.45362168550491333
loss_pred:0.024964183568954468, decouple_loss:0.008168430998921394
loss_pred:0.023817984387278557, decouple_loss:0.008254572749137878
loss_pred:0.023353582248091698, decouple_loss:0.008335595950484276
Iteration: 888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45180779695510864, gen p mean: -0.7799357771873474, mean p set: 0.45228806138038635
The modified gen p mean: 0.4512045681476593, gen p mean: -0.7692075967788696, mean p set: 0.4516848623752594
The modified gen p mean: 0.450969934463501, gen p mean: -0.7709917426109314, mean p set: 0.45145025849342346
loss_pred:0.024473216384649277, decouple_loss:0.007496804930269718
loss_pred:0.025125771760940552, decouple_loss:0.007448931690305471
loss_pred:0.025506174191832542, decouple_loss:0.007429241202771664
Iteration: 889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45191672444343567, gen p mean: -0.7675634622573853, mean p set: 0.4523969888687134
The modified gen p mean: 0.4524240493774414, gen p mean: -0.7677453756332397, mean p set: 0.4529043138027191
The modified gen p mean: 0.45258283615112305, gen p mean: -0.7687599062919617, mean p set: 0.45306316018104553
loss_pred:0.024244213476777077, decouple_loss:0.007875006645917892
loss_pred:0.02382619120180607, decouple_loss:0.007891329005360603
loss_pred:0.024555407464504242, decouple_loss:0.007653709501028061
Iteration: 890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534513056278229, gen p mean: -0.7681097388267517, mean p set: 0.45393162965774536
The modified gen p mean: 0.45150279998779297, gen p mean: -0.7578102946281433, mean p set: 0.45198309421539307
The modified gen p mean: 0.4510209262371063, gen p mean: -0.7539469003677368, mean p set: 0.45150119066238403
loss_pred:0.02461433596909046, decouple_loss:0.008590532466769218
loss_pred:0.024856889620423317, decouple_loss:0.00809852872043848
loss_pred:0.025691913440823555, decouple_loss:0.008234035223722458
2023-05-07 00:45:44 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7638446688652039, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7559128999710083, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7523434162139893, mean p set: 0.45035696029663086
loss_pred:0.026617413386702538, decouple_loss:0.008529783226549625
loss_pred:0.025597110390663147, decouple_loss:0.008155989460647106
loss_pred:0.025394883006811142, decouple_loss:0.008122391067445278
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026283271610736847, avg_mse: 0.03253250941634178
current test mse: 0.032533
Iteration: 891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517366290092468, gen p mean: -0.752737820148468, mean p set: 0.4522169232368469
loss_pred:0.025082796812057495, decouple_loss:0.0074094668962061405
The modified gen p mean: 0.4515134394168854, gen p mean: -0.7578960061073303, mean p set: 0.4519937038421631
loss_pred:0.02460089698433876, decouple_loss:0.007348619867116213
The modified gen p mean: 0.45192667841911316, gen p mean: -0.7554202675819397, mean p set: 0.45240697264671326
loss_pred:0.0240603256970644, decouple_loss:0.007273654453456402
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479460120201111, gen p mean: -0.7753255367279053, mean p set: 0.44842633605003357
The modified gen p mean: 0.44530782103538513, gen p mean: -0.7630524039268494, mean p set: 0.44578808546066284
The modified gen p mean: 0.44632676243782043, gen p mean: -0.7675301432609558, mean p set: 0.44680705666542053
loss_pred:0.025342216715216637, decouple_loss:0.008259163238108158
loss_pred:0.025430740788578987, decouple_loss:0.008212274871766567
loss_pred:0.02491871640086174, decouple_loss:0.008245534263551235
Iteration: 893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466151297092438, gen p mean: -0.7852174043655396, mean p set: 0.44709545373916626
The modified gen p mean: 0.44671717286109924, gen p mean: -0.787592351436615, mean p set: 0.44719746708869934
loss_pred:0.025268608704209328, decouple_loss:0.008380242623388767
loss_pred:0.026653684675693512, decouple_loss:0.008206633850932121
The modified gen p mean: 0.4461234509944916, gen p mean: -0.7794306874275208, mean p set: 0.4466037154197693
loss_pred:0.026333635672926903, decouple_loss:0.008291678503155708
Iteration: 894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466664791107178, gen p mean: -0.7887544631958008, mean p set: 0.4471467435359955
The modified gen p mean: 0.44698435068130493, gen p mean: -0.7881563901901245, mean p set: 0.44746461510658264
loss_pred:0.024721398949623108, decouple_loss:0.008008163422346115
loss_pred:0.0247646514326334, decouple_loss:0.007918983697891235
The modified gen p mean: 0.4466697871685028, gen p mean: -0.7889779806137085, mean p set: 0.4471500515937805
loss_pred:0.025285642594099045, decouple_loss:0.00817339401692152
Iteration: 895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468703269958496, gen p mean: -0.7830914258956909, mean p set: 0.4473506212234497
The modified gen p mean: 0.4467034935951233, gen p mean: -0.788864016532898, mean p set: 0.447183758020401
The modified gen p mean: 0.44715139269828796, gen p mean: -0.7867135405540466, mean p set: 0.4476316571235657
loss_pred:0.025752892717719078, decouple_loss:0.008342592045664787
loss_pred:0.025900986045598984, decouple_loss:0.008256422355771065
loss_pred:0.026074230670928955, decouple_loss:0.008014642633497715
Iteration: 896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680145382881165, gen p mean: -0.7918968796730042, mean p set: 0.44728177785873413
The modified gen p mean: 0.4453771710395813, gen p mean: -0.7747278213500977, mean p set: 0.445857435464859
The modified gen p mean: 0.4466235339641571, gen p mean: -0.7830366492271423, mean p set: 0.4471038281917572
loss_pred:0.024717243388295174, decouple_loss:0.008043689653277397
loss_pred:0.026180138811469078, decouple_loss:0.007916589267551899
loss_pred:0.025067323818802834, decouple_loss:0.007905694656074047
Iteration: 897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643449783325195, gen p mean: -0.7845430970191956, mean p set: 0.44691479206085205
The modified gen p mean: 0.44610631465911865, gen p mean: -0.7796815037727356, mean p set: 0.44658660888671875
The modified gen p mean: 0.44700536131858826, gen p mean: -0.7823635935783386, mean p set: 0.44748565554618835
loss_pred:0.02525731548666954, decouple_loss:0.008106335066258907
loss_pred:0.025420550256967545, decouple_loss:0.007852517068386078
loss_pred:0.02493872120976448, decouple_loss:0.007952378131449223
Iteration: 898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446067214012146, gen p mean: -0.7678927779197693, mean p set: 0.4465474784374237
The modified gen p mean: 0.4477647840976715, gen p mean: -0.7774261832237244, mean p set: 0.4482450783252716
The modified gen p mean: 0.44694983959198, gen p mean: -0.7795049548149109, mean p set: 0.4474301338195801
loss_pred:0.025135740637779236, decouple_loss:0.007729042321443558
loss_pred:0.024456067010760307, decouple_loss:0.007465945556759834
loss_pred:0.02567632868885994, decouple_loss:0.007421398535370827
Iteration: 899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459965229034424, gen p mean: -0.7747974395751953, mean p set: 0.44647684693336487
The modified gen p mean: 0.44643330574035645, gen p mean: -0.7812005281448364, mean p set: 0.44691362977027893
The modified gen p mean: 0.4468805193901062, gen p mean: -0.7769307494163513, mean p set: 0.4473608434200287
loss_pred:0.02499709092080593, decouple_loss:0.007366690784692764
loss_pred:0.026209857314825058, decouple_loss:0.007036806549876928
loss_pred:0.02531730942428112, decouple_loss:0.007310288026928902
Iteration: 900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679543375968933, gen p mean: -0.7665810585021973, mean p set: 0.44727569818496704
The modified gen p mean: 0.4465217888355255, gen p mean: -0.7764347791671753, mean p set: 0.4470020830631256
The modified gen p mean: 0.4469769597053528, gen p mean: -0.7674888372421265, mean p set: 0.4474572241306305
loss_pred:0.024886678904294968, decouple_loss:0.007610262371599674
loss_pred:0.024268124252557755, decouple_loss:0.007607945706695318
loss_pred:0.024759240448474884, decouple_loss:0.007655065506696701
2023-05-07 00:50:24 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.7702866196632385, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7591479420661926, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7631697058677673, mean p set: 0.4500633478164673
loss_pred:0.025915110483765602, decouple_loss:0.007769908290356398
loss_pred:0.024662431329488754, decouple_loss:0.007543233223259449
loss_pred:0.025016414001584053, decouple_loss:0.007543369196355343
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025578927248716354, avg_mse: 0.03145979344844818
current test mse: 0.03146
Iteration: 901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705235958099365, gen p mean: -0.7602019309997559, mean p set: 0.44753265380859375
The modified gen p mean: 0.4468212425708771, gen p mean: -0.7616023421287537, mean p set: 0.44730156660079956
loss_pred:0.02479417249560356, decouple_loss:0.007318660616874695
loss_pred:0.025063406676054, decouple_loss:0.007398117333650589
The modified gen p mean: 0.4468380808830261, gen p mean: -0.7683110237121582, mean p set: 0.4473183751106262
loss_pred:0.0247550830245018, decouple_loss:0.00736582325771451
Iteration: 902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465196132659912, gen p mean: -0.754775881767273, mean p set: 0.4469999372959137
The modified gen p mean: 0.4470561742782593, gen p mean: -0.7659989595413208, mean p set: 0.4475364685058594
The modified gen p mean: 0.4472530484199524, gen p mean: -0.7617335915565491, mean p set: 0.4477333426475525
loss_pred:0.024937864392995834, decouple_loss:0.007080482318997383
loss_pred:0.024309752508997917, decouple_loss:0.007185957860201597
loss_pred:0.02583596110343933, decouple_loss:0.007346583995968103
Iteration: 903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756370782852173, gen p mean: -0.7660419344902039, mean p set: 0.4480440020561218
The modified gen p mean: 0.4472448229789734, gen p mean: -0.7592915296554565, mean p set: 0.4477251172065735
The modified gen p mean: 0.4456709921360016, gen p mean: -0.7604182362556458, mean p set: 0.4461512565612793
loss_pred:0.024127399548888206, decouple_loss:0.0069097536616027355
loss_pred:0.025136200711131096, decouple_loss:0.006958195939660072
loss_pred:0.024702873080968857, decouple_loss:0.007114477921277285
Iteration: 904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680383801460266, gen p mean: -0.7603569030761719, mean p set: 0.44728413224220276
The modified gen p mean: 0.44517549872398376, gen p mean: -0.7532578706741333, mean p set: 0.44565579295158386
The modified gen p mean: 0.44657984375953674, gen p mean: -0.756062924861908, mean p set: 0.44706007838249207
loss_pred:0.02448151633143425, decouple_loss:0.0071642110124230385
loss_pred:0.024271545931696892, decouple_loss:0.00709144864231348
loss_pred:0.023999623954296112, decouple_loss:0.0069082980044186115
Iteration: 905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484494924545288, gen p mean: -0.7629128098487854, mean p set: 0.4489297568798065
The modified gen p mean: 0.44701677560806274, gen p mean: -0.7635483741760254, mean p set: 0.44749704003334045
The modified gen p mean: 0.4477007985115051, gen p mean: -0.7612723112106323, mean p set: 0.44818106293678284
loss_pred:0.02433061972260475, decouple_loss:0.007151899393647909
loss_pred:0.025592533871531487, decouple_loss:0.006941549479961395
loss_pred:0.0245501846075058, decouple_loss:0.007118628825992346
Iteration: 906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466868042945862, gen p mean: -0.7622833251953125, mean p set: 0.4471670687198639
The modified gen p mean: 0.44651535153388977, gen p mean: -0.758320152759552, mean p set: 0.44699564576148987
The modified gen p mean: 0.44634103775024414, gen p mean: -0.7665418982505798, mean p set: 0.44682133197784424
loss_pred:0.024300791323184967, decouple_loss:0.006974151823669672
loss_pred:0.024603527039289474, decouple_loss:0.006998460739850998
loss_pred:0.02462010085582733, decouple_loss:0.006899189203977585
Iteration: 907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467865228652954, gen p mean: -0.7689805030822754, mean p set: 0.4472668468952179
The modified gen p mean: 0.4452042281627655, gen p mean: -0.7536075711250305, mean p set: 0.4456845819950104
The modified gen p mean: 0.44674137234687805, gen p mean: -0.7589269876480103, mean p set: 0.44722166657447815
loss_pred:0.023414183408021927, decouple_loss:0.006885754410177469
loss_pred:0.024910422042012215, decouple_loss:0.006946622859686613
loss_pred:0.024550162255764008, decouple_loss:0.0068998681381344795
Iteration: 908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44605761766433716, gen p mean: -0.7627648711204529, mean p set: 0.44653791189193726
The modified gen p mean: 0.44633927941322327, gen p mean: -0.761427104473114, mean p set: 0.446819543838501
The modified gen p mean: 0.44759318232536316, gen p mean: -0.7562116980552673, mean p set: 0.44807347655296326
loss_pred:0.024501856416463852, decouple_loss:0.006629394832998514
loss_pred:0.02535114251077175, decouple_loss:0.006735244300216436
loss_pred:0.024240026250481606, decouple_loss:0.006430965382605791
Iteration: 909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656580686569214, gen p mean: -0.7591626644134521, mean p set: 0.44704607129096985
The modified gen p mean: 0.4460991322994232, gen p mean: -0.7612833380699158, mean p set: 0.4465794563293457
The modified gen p mean: 0.44740480184555054, gen p mean: -0.7526272535324097, mean p set: 0.44788506627082825
loss_pred:0.024477705359458923, decouple_loss:0.006538464687764645
loss_pred:0.02454454079270363, decouple_loss:0.006525357253849506
loss_pred:0.02435111813247204, decouple_loss:0.006430947221815586
Iteration: 910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681304693222046, gen p mean: -0.7591273188591003, mean p set: 0.44729331135749817
The modified gen p mean: 0.44712939858436584, gen p mean: -0.754303514957428, mean p set: 0.44760966300964355
The modified gen p mean: 0.44734692573547363, gen p mean: -0.7615667581558228, mean p set: 0.44782721996307373
loss_pred:0.024869726970791817, decouple_loss:0.006565883290022612
loss_pred:0.025179365649819374, decouple_loss:0.006160330958664417
loss_pred:0.023826839402318, decouple_loss:0.006356091238558292
2023-05-07 00:54:02 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7577367424964905, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7466691136360168, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.7510874271392822, mean p set: 0.4500633478164673
loss_pred:0.025531195104122162, decouple_loss:0.006665523629635572
loss_pred:0.024287179112434387, decouple_loss:0.006485450081527233
loss_pred:0.024660753086209297, decouple_loss:0.006400024518370628
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02515222690999508, avg_mse: 0.03099784441292286
current test mse: 0.030998
Iteration: 911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44611552357673645, gen p mean: -0.7508756518363953, mean p set: 0.44659578800201416
The modified gen p mean: 0.44678205251693726, gen p mean: -0.7531020641326904, mean p set: 0.44726231694221497
loss_pred:0.0242758896201849, decouple_loss:0.006348450668156147
loss_pred:0.024084793403744698, decouple_loss:0.00623463885858655
The modified gen p mean: 0.4463663399219513, gen p mean: -0.7577371597290039, mean p set: 0.446846604347229
loss_pred:0.024906501173973083, decouple_loss:0.006231509614735842
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772836565971375, gen p mean: -0.7562896609306335, mean p set: 0.44820865988731384
The modified gen p mean: 0.4484004080295563, gen p mean: -0.7506223320960999, mean p set: 0.44888070225715637
The modified gen p mean: 0.44974711537361145, gen p mean: -0.7571223974227905, mean p set: 0.45022737979888916
loss_pred:0.024920063093304634, decouple_loss:0.0070497808046638966
loss_pred:0.02617008425295353, decouple_loss:0.006914868019521236
loss_pred:0.02537618577480316, decouple_loss:0.006970379501581192
Iteration: 913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44927433133125305, gen p mean: -0.766301691532135, mean p set: 0.44975459575653076
The modified gen p mean: 0.4493882358074188, gen p mean: -0.7739366888999939, mean p set: 0.4498685300350189
The modified gen p mean: 0.4492068290710449, gen p mean: -0.7637486457824707, mean p set: 0.449687123298645
loss_pred:0.02517041750252247, decouple_loss:0.00678172567859292
loss_pred:0.02537176012992859, decouple_loss:0.0064470525830984116
loss_pred:0.02552008256316185, decouple_loss:0.0063476343639194965
Iteration: 914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491191506385803, gen p mean: -0.7677451372146606, mean p set: 0.4495994448661804
The modified gen p mean: 0.4504079818725586, gen p mean: -0.7763534188270569, mean p set: 0.4508882462978363
The modified gen p mean: 0.44916269183158875, gen p mean: -0.7676265835762024, mean p set: 0.44964301586151123
loss_pred:0.024324798956513405, decouple_loss:0.006457067560404539loss_pred:0.02561616711318493, decouple_loss:0.006634739227592945
loss_pred:0.025560501962900162, decouple_loss:0.006344047840684652
Iteration: 915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481092393398285, gen p mean: -0.7681048512458801, mean p set: 0.4485895335674286
The modified gen p mean: 0.4485054016113281, gen p mean: -0.7660585641860962, mean p set: 0.44898566603660583
loss_pred:0.024890901520848274, decouple_loss:0.006382475141435862
loss_pred:0.024663332849740982, decouple_loss:0.006656172219663858
The modified gen p mean: 0.44789427518844604, gen p mean: -0.7708436250686646, mean p set: 0.44837456941604614
loss_pred:0.025164475664496422, decouple_loss:0.006288269534707069
Iteration: 916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901955127716064, gen p mean: -0.7648403644561768, mean p set: 0.44949984550476074
The modified gen p mean: 0.4475764036178589, gen p mean: -0.7786045074462891, mean p set: 0.448056697845459
loss_pred:0.024578582495450974, decouple_loss:0.006414423231035471
loss_pred:0.024412456899881363, decouple_loss:0.006179468706250191
The modified gen p mean: 0.4494730532169342, gen p mean: -0.773715078830719, mean p set: 0.4499533474445343
loss_pred:0.024831796064972878, decouple_loss:0.006398460362106562
Iteration: 917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852960109710693, gen p mean: -0.7739289999008179, mean p set: 0.44900989532470703
The modified gen p mean: 0.44813576340675354, gen p mean: -0.7733479738235474, mean p set: 0.44861605763435364
The modified gen p mean: 0.44998177886009216, gen p mean: -0.7745554447174072, mean p set: 0.45046207308769226
loss_pred:0.02532574161887169, decouple_loss:0.006272060330957174
loss_pred:0.024927416816353798, decouple_loss:0.006166660226881504
loss_pred:0.024381566792726517, decouple_loss:0.006250498350709677
Iteration: 918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497900903224945, gen p mean: -0.7664265632629395, mean p set: 0.4502703547477722
The modified gen p mean: 0.4464895725250244, gen p mean: -0.7611789703369141, mean p set: 0.4469698667526245
The modified gen p mean: 0.44796690344810486, gen p mean: -0.7662593722343445, mean p set: 0.44844722747802734
loss_pred:0.025203470140695572, decouple_loss:0.00672785472124815
loss_pred:0.024808088317513466, decouple_loss:0.006427799817174673
loss_pred:0.02489650808274746, decouple_loss:0.006360241211950779
Iteration: 919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489775598049164, gen p mean: -0.7662293314933777, mean p set: 0.44945788383483887
The modified gen p mean: 0.44869935512542725, gen p mean: -0.765542209148407, mean p set: 0.44917967915534973
The modified gen p mean: 0.45015114545822144, gen p mean: -0.7654745578765869, mean p set: 0.45063140988349915
loss_pred:0.024546436965465546, decouple_loss:0.006235191132873297
loss_pred:0.02473188191652298, decouple_loss:0.005970468744635582
loss_pred:0.025372475385665894, decouple_loss:0.006282506976276636
Iteration: 920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481106400489807, gen p mean: -0.7624841928482056, mean p set: 0.4485909342765808
The modified gen p mean: 0.4481542408466339, gen p mean: -0.7631725072860718, mean p set: 0.448634535074234
The modified gen p mean: 0.4478866457939148, gen p mean: -0.7595354318618774, mean p set: 0.4483669102191925
loss_pred:0.025295445695519447, decouple_loss:0.006106906570494175
loss_pred:0.024747764691710472, decouple_loss:0.005769159644842148
loss_pred:0.025175558403134346, decouple_loss:0.005528790410608053
2023-05-07 00:58:43 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7625609636306763, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7738964557647705, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7667019367218018, mean p set: 0.4500633478164673
loss_pred:0.024170370772480965, decouple_loss:0.006053550634533167
loss_pred:0.025541584938764572, decouple_loss:0.006409631576389074
loss_pred:0.0245125200599432, decouple_loss:0.005950612481683493
WV_0_PC_1_EH_0_PS_40_6, loss: 0.0250483900308609, avg_mse: 0.030895866453647614
current test mse: 0.030896
Iteration: 921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910916686058044, gen p mean: -0.7660741209983826, mean p set: 0.44958946108818054
loss_pred:0.024951687082648277, decouple_loss:0.005961657967418432
The modified gen p mean: 0.44854825735092163, gen p mean: -0.7659960389137268, mean p set: 0.44902855157852173
loss_pred:0.024764524772763252, decouple_loss:0.006275621708482504
The modified gen p mean: 0.44884318113327026, gen p mean: -0.7671838998794556, mean p set: 0.44932347536087036
loss_pred:0.02418551594018936, decouple_loss:0.005776442587375641
Iteration: 922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502018690109253, gen p mean: -0.7661349177360535, mean p set: 0.450682133436203
The modified gen p mean: 0.4484816789627075, gen p mean: -0.7615705728530884, mean p set: 0.44896194338798523
The modified gen p mean: 0.4493992328643799, gen p mean: -0.7680451273918152, mean p set: 0.44987955689430237
loss_pred:0.02519414760172367, decouple_loss:0.005992822349071503
loss_pred:0.025105802342295647, decouple_loss:0.006108137313276529
loss_pred:0.024519646540284157, decouple_loss:0.0063315266743302345
Iteration: 923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487565755844116, gen p mean: -0.752141535282135, mean p set: 0.4492368996143341
The modified gen p mean: 0.44981876015663147, gen p mean: -0.764236330986023, mean p set: 0.45029905438423157
The modified gen p mean: 0.4478687345981598, gen p mean: -0.7645695209503174, mean p set: 0.4483490288257599
loss_pred:0.02528098225593567, decouple_loss:0.005987342447042465
loss_pred:0.024464517831802368, decouple_loss:0.005710209254175425
loss_pred:0.024900401011109352, decouple_loss:0.005972256418317556
Iteration: 924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856056571006775, gen p mean: -0.7644100189208984, mean p set: 0.44904085993766785
The modified gen p mean: 0.44738608598709106, gen p mean: -0.7536487579345703, mean p set: 0.4478663504123688
loss_pred:0.024850191548466682, decouple_loss:0.00597561476752162
loss_pred:0.02426365576684475, decouple_loss:0.006254097912460566
The modified gen p mean: 0.4484628736972809, gen p mean: -0.7663401961326599, mean p set: 0.448943167924881
loss_pred:0.024322044104337692, decouple_loss:0.005651890300214291
Iteration: 925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44952392578125, gen p mean: -0.7497966885566711, mean p set: 0.4500042200088501
The modified gen p mean: 0.449358195066452, gen p mean: -0.7570887207984924, mean p set: 0.44983842968940735
loss_pred:0.024738462641835213, decouple_loss:0.0060892472974956036
loss_pred:0.02513354830443859, decouple_loss:0.006048096809536219
The modified gen p mean: 0.4499039351940155, gen p mean: -0.7574241161346436, mean p set: 0.4503842294216156
loss_pred:0.025169162079691887, decouple_loss:0.006021307315677404
Iteration: 926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44662222266197205, gen p mean: -0.7474365830421448, mean p set: 0.44710251688957214
The modified gen p mean: 0.4486571252346039, gen p mean: -0.7527845501899719, mean p set: 0.449137419462204
The modified gen p mean: 0.44882893562316895, gen p mean: -0.7548052668571472, mean p set: 0.44930922985076904
loss_pred:0.024313995614647865, decouple_loss:0.005891419947147369
loss_pred:0.025244392454624176, decouple_loss:0.00591039564460516
loss_pred:0.024757346138358116, decouple_loss:0.005888661369681358
Iteration: 927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448865681886673, gen p mean: -0.7602631449699402, mean p set: 0.4493459463119507
The modified gen p mean: 0.4483877718448639, gen p mean: -0.7618507742881775, mean p set: 0.4488680362701416
The modified gen p mean: 0.4480966627597809, gen p mean: -0.7642089128494263, mean p set: 0.4485769271850586
loss_pred:0.025104572996497154, decouple_loss:0.006049634888768196
loss_pred:0.02460845559835434, decouple_loss:0.005546420346945524
loss_pred:0.02465442754328251, decouple_loss:0.0058437734842300415
Iteration: 928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44888004660606384, gen p mean: -0.7558892965316772, mean p set: 0.44936034083366394
The modified gen p mean: 0.4472452998161316, gen p mean: -0.7633212804794312, mean p set: 0.4477255642414093
The modified gen p mean: 0.4487477242946625, gen p mean: -0.7623320817947388, mean p set: 0.4492279887199402
loss_pred:0.024218350648880005, decouple_loss:0.005597027484327555loss_pred:0.023813942447304726, decouple_loss:0.0058994656428694725
loss_pred:0.024264099076390266, decouple_loss:0.005719791632145643
Iteration: 929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501529335975647, gen p mean: -0.770729660987854, mean p set: 0.4506332576274872
The modified gen p mean: 0.44913238286972046, gen p mean: -0.7676041722297668, mean p set: 0.4496126174926758
The modified gen p mean: 0.4493604302406311, gen p mean: -0.7624265551567078, mean p set: 0.4498407244682312
loss_pred:0.023436762392520905, decouple_loss:0.005910167470574379loss_pred:0.023999812081456184, decouple_loss:0.005718806758522987
loss_pred:0.02466863952577114, decouple_loss:0.00572394160553813
Iteration: 930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490792155265808, gen p mean: -0.7693018317222595, mean p set: 0.4495595097541809
The modified gen p mean: 0.4494432210922241, gen p mean: -0.7610296607017517, mean p set: 0.4499235153198242
The modified gen p mean: 0.4476395547389984, gen p mean: -0.7694956064224243, mean p set: 0.4481198489665985
loss_pred:0.024635985493659973, decouple_loss:0.005525326821953058
loss_pred:0.025449084118008614, decouple_loss:0.005748494993895292
loss_pred:0.024293983355164528, decouple_loss:0.005423690192401409
2023-05-07 01:02:21 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7781401872634888, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7670621275901794, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7711319327354431, mean p set: 0.4500633478164673
loss_pred:0.025394903495907784, decouple_loss:0.005939093884080648
loss_pred:0.02407689392566681, decouple_loss:0.005701258312910795
loss_pred:0.024400487542152405, decouple_loss:0.005798862315714359
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02491474710404873, avg_mse: 0.030792471021413803
current test mse: 0.030792
Iteration: 931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495813846588135, gen p mean: -0.7711971402168274, mean p set: 0.4500616788864136
The modified gen p mean: 0.4488086700439453, gen p mean: -0.77190762758255, mean p set: 0.449288934469223
loss_pred:0.02518005482852459, decouple_loss:0.00561715429648757
loss_pred:0.02486990951001644, decouple_loss:0.00545575562864542
The modified gen p mean: 0.4477268159389496, gen p mean: -0.7636098265647888, mean p set: 0.44820713996887207
loss_pred:0.025118863210082054, decouple_loss:0.00572828808799386
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
NaN value num: 0
Iteration: 932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486565589904785, gen p mean: -0.7771694660186768, mean p set: 0.449136883020401
The modified gen p mean: 0.44835230708122253, gen p mean: -0.7716630697250366, mean p set: 0.44883257150650024
The modified gen p mean: 0.4516281485557556, gen p mean: -0.7930029034614563, mean p set: 0.4521084129810333
loss_pred:0.023426014930009842, decouple_loss:0.005968421697616577
loss_pred:0.024153269827365875, decouple_loss:0.006513594184070826
loss_pred:0.025202790275216103, decouple_loss:0.0057131219655275345
Iteration: 933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481247663497925, gen p mean: -0.7838321328163147, mean p set: 0.4486050307750702
The modified gen p mean: 0.44841107726097107, gen p mean: -0.7832677960395813, mean p set: 0.44889137148857117
The modified gen p mean: 0.44755303859710693, gen p mean: -0.7812978029251099, mean p set: 0.44803333282470703
loss_pred:0.024516813457012177, decouple_loss:0.00567890889942646
loss_pred:0.024856196716427803, decouple_loss:0.00576644204556942
loss_pred:0.02330959029495716, decouple_loss:0.005633044987916946
Iteration: 934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727784395217896, gen p mean: -0.7852152585983276, mean p set: 0.44775813817977905
The modified gen p mean: 0.4521802067756653, gen p mean: -0.8056073188781738, mean p set: 0.4526605010032654
loss_pred:0.023726709187030792, decouple_loss:0.005540740676224232
loss_pred:0.02346854656934738, decouple_loss:0.006270536687225103
The modified gen p mean: 0.4506557881832123, gen p mean: -0.7920643091201782, mean p set: 0.45113611221313477
loss_pred:0.024770256131887436, decouple_loss:0.006169299595057964
Iteration: 935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44999948143959045, gen p mean: -0.782336413860321, mean p set: 0.45047977566719055
The modified gen p mean: 0.4498324692249298, gen p mean: -0.7817700505256653, mean p set: 0.4503127932548523
The modified gen p mean: 0.4492734670639038, gen p mean: -0.7920423746109009, mean p set: 0.4497537314891815
loss_pred:0.022990046069025993, decouple_loss:0.00581758376210928
loss_pred:0.02301880158483982, decouple_loss:0.005705139599740505
loss_pred:0.02391725592315197, decouple_loss:0.005918549839407206
Iteration: 936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977709650993347, gen p mean: -0.7912753224372864, mean p set: 0.45025739073753357
The modified gen p mean: 0.4473363757133484, gen p mean: -0.76179039478302, mean p set: 0.4478166699409485
The modified gen p mean: 0.45137134194374084, gen p mean: -0.7738403081893921, mean p set: 0.45185160636901855
loss_pred:0.024942317977547646, decouple_loss:0.006206328049302101
loss_pred:0.024661002680659294, decouple_loss:0.005957901943475008
loss_pred:0.02459101937711239, decouple_loss:0.0058966330252587795
Iteration: 937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478659927845001, gen p mean: -0.757648766040802, mean p set: 0.4483462870121002
The modified gen p mean: 0.44778576493263245, gen p mean: -0.7580768465995789, mean p set: 0.44826605916023254
The modified gen p mean: 0.4499646723270416, gen p mean: -0.7700127959251404, mean p set: 0.4504449665546417
loss_pred:0.024898406118154526, decouple_loss:0.005602984223514795loss_pred:0.02391347475349903, decouple_loss:0.0059361825697124004
loss_pred:0.024336444213986397, decouple_loss:0.006157567258924246
Iteration: 938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45009303092956543, gen p mean: -0.7747370600700378, mean p set: 0.45057329535484314
The modified gen p mean: 0.4522785544395447, gen p mean: -0.7830394506454468, mean p set: 0.4527588486671448
The modified gen p mean: 0.44956454634666443, gen p mean: -0.7814275026321411, mean p set: 0.4500448405742645
loss_pred:0.024617858231067657, decouple_loss:0.00565307168290019
loss_pred:0.023357748985290527, decouple_loss:0.0058907270431518555
loss_pred:0.023735646158456802, decouple_loss:0.0055116633884608746
Iteration: 939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45021942257881165, gen p mean: -0.7852985858917236, mean p set: 0.45069968700408936
The modified gen p mean: 0.45168885588645935, gen p mean: -0.7861420512199402, mean p set: 0.45216912031173706
The modified gen p mean: 0.44873663783073425, gen p mean: -0.7706552743911743, mean p set: 0.44921693205833435
loss_pred:0.023275891318917274, decouple_loss:0.005558243487030268loss_pred:0.023658793419599533, decouple_loss:0.005859778728336096
loss_pred:0.024364136159420013, decouple_loss:0.005430243909358978
Iteration: 940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475676119327545, gen p mean: -0.7643718719482422, mean p set: 0.4480479061603546
The modified gen p mean: 0.44821226596832275, gen p mean: -0.7619330883026123, mean p set: 0.44869256019592285
The modified gen p mean: 0.44747841358184814, gen p mean: -0.761737585067749, mean p set: 0.44795873761177063
loss_pred:0.024216044694185257, decouple_loss:0.005540070589631796
loss_pred:0.023708391934633255, decouple_loss:0.006040277425199747
loss_pred:0.024862876161932945, decouple_loss:0.005757133010774851
2023-05-07 01:06:42 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7759420275688171, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7645230889320374, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7689164876937866, mean p set: 0.4500633478164673
loss_pred:0.025511382147669792, decouple_loss:0.006213893182575703
loss_pred:0.024126604199409485, decouple_loss:0.005942944437265396
loss_pred:0.02448306418955326, decouple_loss:0.00606592558324337
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02501073107123375, avg_mse: 0.03101394698023796
current test mse: 0.031014
Iteration: 941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45025697350502014, gen p mean: -0.7728638052940369, mean p set: 0.45073726773262024
The modified gen p mean: 0.44929370284080505, gen p mean: -0.7700359225273132, mean p set: 0.44977399706840515
loss_pred:0.023626485839486122, decouple_loss:0.00563919497653842
loss_pred:0.024152277037501335, decouple_loss:0.005395827349275351
The modified gen p mean: 0.44757890701293945, gen p mean: -0.7550062537193298, mean p set: 0.44805923104286194
loss_pred:0.023603377863764763, decouple_loss:0.005857714451849461
Iteration: 942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450541615486145, gen p mean: -0.776885986328125, mean p set: 0.45102187991142273
The modified gen p mean: 0.45136386156082153, gen p mean: -0.7798083424568176, mean p set: 0.45184415578842163
The modified gen p mean: 0.450407475233078, gen p mean: -0.782780647277832, mean p set: 0.4508877694606781
loss_pred:0.02361249178647995, decouple_loss:0.005730155855417252
loss_pred:0.02284461446106434, decouple_loss:0.005678369663655758
loss_pred:0.023749155923724174, decouple_loss:0.005994986742734909
Iteration: 943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500812888145447, gen p mean: -0.7634798884391785, mean p set: 0.4505615830421448
The modified gen p mean: 0.4508529603481293, gen p mean: -0.7705718278884888, mean p set: 0.45133325457572937
loss_pred:0.023454245179891586, decouple_loss:0.005564735736697912
loss_pred:0.02411295846104622, decouple_loss:0.0057393452152609825
The modified gen p mean: 0.449433296918869, gen p mean: -0.7694107890129089, mean p set: 0.44991356134414673
loss_pred:0.024121856316924095, decouple_loss:0.005403492134064436
Iteration: 944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491461515426636, gen p mean: -0.7598909735679626, mean p set: 0.44962644577026367
The modified gen p mean: 0.45010536909103394, gen p mean: -0.7699018716812134, mean p set: 0.4505856931209564
The modified gen p mean: 0.4472504258155823, gen p mean: -0.7544403672218323, mean p set: 0.44773074984550476
loss_pred:0.024148860946297646, decouple_loss:0.005389116238802671
loss_pred:0.02341293729841709, decouple_loss:0.005513228941708803
loss_pred:0.02369840256869793, decouple_loss:0.0055706556886434555
Iteration: 945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510563313961029, gen p mean: -0.7733718752861023, mean p set: 0.451536625623703
The modified gen p mean: 0.4486111104488373, gen p mean: -0.7720994353294373, mean p set: 0.44909143447875977
loss_pred:0.023995928466320038, decouple_loss:0.005556620657444
loss_pred:0.023754268884658813, decouple_loss:0.005485380534082651
The modified gen p mean: 0.44969040155410767, gen p mean: -0.7626619338989258, mean p set: 0.45017069578170776
loss_pred:0.023872174322605133, decouple_loss:0.005403523799031973
Iteration: 946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499530494213104, gen p mean: -0.7718530893325806, mean p set: 0.4504333436489105
The modified gen p mean: 0.44928550720214844, gen p mean: -0.7766968607902527, mean p set: 0.44976580142974854
The modified gen p mean: 0.44807863235473633, gen p mean: -0.7597655057907104, mean p set: 0.44855889678001404
loss_pred:0.022933434695005417, decouple_loss:0.005160382483154535
loss_pred:0.02388468198478222, decouple_loss:0.0052465577609837055
loss_pred:0.02390194498002529, decouple_loss:0.005900346674025059
Iteration: 947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487493634223938, gen p mean: -0.7637102603912354, mean p set: 0.4492295980453491
The modified gen p mean: 0.4497198462486267, gen p mean: -0.7781268954277039, mean p set: 0.4502002000808716
The modified gen p mean: 0.4491610527038574, gen p mean: -0.775442898273468, mean p set: 0.4496413469314575
loss_pred:0.024455007165670395, decouple_loss:0.005410256329923868
loss_pred:0.02360767498612404, decouple_loss:0.0053323861211538315
loss_pred:0.0246135164052248, decouple_loss:0.005542246159166098
Iteration: 948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496040344238281, gen p mean: -0.7766463756561279, mean p set: 0.4500843286514282
The modified gen p mean: 0.448701411485672, gen p mean: -0.7672220468521118, mean p set: 0.4491817057132721
The modified gen p mean: 0.4502078890800476, gen p mean: -0.775604248046875, mean p set: 0.4506881833076477
loss_pred:0.02466648630797863, decouple_loss:0.00569869764149189
loss_pred:0.023575229570269585, decouple_loss:0.005965745076537132
loss_pred:0.023956142365932465, decouple_loss:0.005260133184492588
Iteration: 949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471801221370697, gen p mean: -0.7618475556373596, mean p set: 0.4476604163646698
The modified gen p mean: 0.45128291845321655, gen p mean: -0.7869873642921448, mean p set: 0.45176324248313904
The modified gen p mean: 0.45008373260498047, gen p mean: -0.7898423075675964, mean p set: 0.45056405663490295
loss_pred:0.024966517463326454, decouple_loss:0.005720056127756834
loss_pred:0.022645611315965652, decouple_loss:0.005553616676479578
loss_pred:0.02448727935552597, decouple_loss:0.005769996903836727
Iteration: 950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513677656650543, gen p mean: -0.7865562438964844, mean p set: 0.4518480598926544
The modified gen p mean: 0.4515502154827118, gen p mean: -0.788207471370697, mean p set: 0.4520305097103119
The modified gen p mean: 0.44913578033447266, gen p mean: -0.7777432799339294, mean p set: 0.44961604475975037
loss_pred:0.02250521257519722, decouple_loss:0.0055449302308261395
loss_pred:0.022633710876107216, decouple_loss:0.0055086384527385235
loss_pred:0.023589694872498512, decouple_loss:0.005307124927639961
2023-05-07 01:10:21 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7917342782020569, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7797414064407349, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7850403785705566, mean p set: 0.4500633478164673
loss_pred:0.025902030989527702, decouple_loss:0.006471883039921522
loss_pred:0.024553103372454643, decouple_loss:0.006201862823218107
loss_pred:0.02495245635509491, decouple_loss:0.006145191378891468
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025449512526392937, avg_mse: 0.03175670653581619
current test mse: 0.031757
Iteration: 951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730284810066223, gen p mean: -0.7749805450439453, mean p set: 0.44778314232826233
The modified gen p mean: 0.4515320658683777, gen p mean: -0.7924073934555054, mean p set: 0.4520123302936554
loss_pred:0.025228451937437057, decouple_loss:0.006013104692101479
loss_pred:0.02343103289604187, decouple_loss:0.00583315035328269
The modified gen p mean: 0.44837361574172974, gen p mean: -0.775860071182251, mean p set: 0.44885390996932983
loss_pred:0.023354260250926018, decouple_loss:0.006107063964009285
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
NaN value num: 0
Iteration: 952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510660469532013, gen p mean: -0.780238687992096, mean p set: 0.4515463411808014
The modified gen p mean: 0.451831579208374, gen p mean: -0.7816270589828491, mean p set: 0.4523118734359741
The modified gen p mean: 0.4502714276313782, gen p mean: -0.7863512635231018, mean p set: 0.45075175166130066
loss_pred:0.024583613499999046, decouple_loss:0.006050081457942724
loss_pred:0.02552037499845028, decouple_loss:0.006265685427933931
loss_pred:0.024045037105679512, decouple_loss:0.005761821288615465
Iteration: 953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504881501197815, gen p mean: -0.7698814272880554, mean p set: 0.4509684145450592
The modified gen p mean: 0.44981926679611206, gen p mean: -0.7811398506164551, mean p set: 0.45029953122138977
The modified gen p mean: 0.4497401714324951, gen p mean: -0.7711837887763977, mean p set: 0.4502204656600952
loss_pred:0.024202389642596245, decouple_loss:0.005700830835849047
loss_pred:0.023789390921592712, decouple_loss:0.00567304203286767
loss_pred:0.023610364645719528, decouple_loss:0.0054880366660654545
Iteration: 954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501641094684601, gen p mean: -0.7693822979927063, mean p set: 0.4506444036960602
The modified gen p mean: 0.4494132697582245, gen p mean: -0.7702580690383911, mean p set: 0.4498935639858246
The modified gen p mean: 0.44896262884140015, gen p mean: -0.7621692419052124, mean p set: 0.44944292306900024
loss_pred:0.023468485102057457, decouple_loss:0.006095000077039003
loss_pred:0.023995477706193924, decouple_loss:0.006055667530745268
loss_pred:0.023738006129860878, decouple_loss:0.00578501308336854
Iteration: 955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500146210193634, gen p mean: -0.7801294326782227, mean p set: 0.4504949152469635
The modified gen p mean: 0.4502185583114624, gen p mean: -0.7667378187179565, mean p set: 0.4506988525390625
The modified gen p mean: 0.44979918003082275, gen p mean: -0.7682124972343445, mean p set: 0.45027947425842285
loss_pred:0.02315659075975418, decouple_loss:0.0059213098138570786loss_pred:0.023545293137431145, decouple_loss:0.005688749253749847
loss_pred:0.02334456518292427, decouple_loss:0.005637638736516237
Iteration: 956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45067375898361206, gen p mean: -0.7785106301307678, mean p set: 0.45115405321121216
The modified gen p mean: 0.4496726095676422, gen p mean: -0.7760041952133179, mean p set: 0.4501529335975647
The modified gen p mean: 0.44895100593566895, gen p mean: -0.7646891474723816, mean p set: 0.44943130016326904
loss_pred:0.0227881520986557, decouple_loss:0.0058942921459674835
loss_pred:0.023850996047258377, decouple_loss:0.005562099628150463
loss_pred:0.024172406643629074, decouple_loss:0.005902435630559921
Iteration: 957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037171244621277, gen p mean: -0.7765350341796875, mean p set: 0.4508519768714905The modified gen p mean: 0.45193353295326233, gen p mean: -0.774671733379364, mean p set: 0.45241379737854004
The modified gen p mean: 0.4499249756336212, gen p mean: -0.7754398584365845, mean p set: 0.4504052996635437
loss_pred:0.02227584272623062, decouple_loss:0.005628029350191355
loss_pred:0.023328637704253197, decouple_loss:0.0057541788555681705
loss_pred:0.02361132949590683, decouple_loss:0.005598017945885658
Iteration: 958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490172863006592, gen p mean: -0.7675613164901733, mean p set: 0.4494975507259369
The modified gen p mean: 0.44838082790374756, gen p mean: -0.7633483409881592, mean p set: 0.44886115193367004
The modified gen p mean: 0.44988730549812317, gen p mean: -0.7776828408241272, mean p set: 0.45036759972572327
loss_pred:0.02349829487502575, decouple_loss:0.0057115512900054455
loss_pred:0.023632677271962166, decouple_loss:0.005698768422007561
loss_pred:0.02387680858373642, decouple_loss:0.005693543236702681
Iteration: 959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45103469491004944, gen p mean: -0.7821183204650879, mean p set: 0.45151498913764954
The modified gen p mean: 0.4495244026184082, gen p mean: -0.7696841955184937, mean p set: 0.4500047266483307
The modified gen p mean: 0.45135101675987244, gen p mean: -0.7671670317649841, mean p set: 0.45183131098747253
loss_pred:0.02431357465684414, decouple_loss:0.006405384745448828
loss_pred:0.023914886638522148, decouple_loss:0.005855871364474297
loss_pred:0.02192830480635166, decouple_loss:0.005519052501767874
Iteration: 960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499325454235077, gen p mean: -0.7642805576324463, mean p set: 0.4504128098487854
The modified gen p mean: 0.4495488703250885, gen p mean: -0.7745974659919739, mean p set: 0.4500291645526886
The modified gen p mean: 0.4483855068683624, gen p mean: -0.7622114419937134, mean p set: 0.4488658010959625
loss_pred:0.023746449500322342, decouple_loss:0.005621816962957382
loss_pred:0.02342267334461212, decouple_loss:0.005606720224022865
loss_pred:0.023834139108657837, decouple_loss:0.005382690578699112
2023-05-07 01:15:03 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7825933694839478, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7707322239875793, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7751595377922058, mean p set: 0.4500633478164673
loss_pred:0.02556730806827545, decouple_loss:0.006297306623309851
loss_pred:0.0242016538977623, decouple_loss:0.006100520025938749
loss_pred:0.024517282843589783, decouple_loss:0.0061372448690235615
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025071000680327415, avg_mse: 0.031145310029387474
current test mse: 0.031145
Iteration: 961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513145387172699, gen p mean: -0.7660056352615356, mean p set: 0.45179483294487
The modified gen p mean: 0.45033109188079834, gen p mean: -0.7823997139930725, mean p set: 0.45081138610839844
loss_pred:0.023345526307821274, decouple_loss:0.005501719657331705
loss_pred:0.02377408556640148, decouple_loss:0.0059881811030209064
The modified gen p mean: 0.45214927196502686, gen p mean: -0.7730253338813782, mean p set: 0.45262953639030457
loss_pred:0.023446859791874886, decouple_loss:0.005691959988325834
Iteration: 962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499701261520386, gen p mean: -0.7774056792259216, mean p set: 0.45045042037963867
The modified gen p mean: 0.4503304064273834, gen p mean: -0.7655872106552124, mean p set: 0.45081067085266113
The modified gen p mean: 0.4491015374660492, gen p mean: -0.7573673725128174, mean p set: 0.4495818316936493
loss_pred:0.023511800915002823, decouple_loss:0.005373317748308182
loss_pred:0.023272119462490082, decouple_loss:0.005842356011271477
loss_pred:0.024034688249230385, decouple_loss:0.0055284989066421986
Iteration: 963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45062196254730225, gen p mean: -0.7685154676437378, mean p set: 0.45110228657722473
The modified gen p mean: 0.4498765468597412, gen p mean: -0.764936625957489, mean p set: 0.4503568708896637
loss_pred:0.024947239086031914, decouple_loss:0.00560297816991806
loss_pred:0.023508919402956963, decouple_loss:0.005271247122436762
The modified gen p mean: 0.45020654797554016, gen p mean: -0.7656176686286926, mean p set: 0.45068684220314026
loss_pred:0.02257234789431095, decouple_loss:0.005760275758802891
Iteration: 964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511227011680603, gen p mean: -0.7706682682037354, mean p set: 0.4516029953956604
The modified gen p mean: 0.4492405652999878, gen p mean: -0.760983943939209, mean p set: 0.4497208595275879
The modified gen p mean: 0.4500886797904968, gen p mean: -0.7682754397392273, mean p set: 0.4505689740180969
loss_pred:0.0235148798674345, decouple_loss:0.0055508604273200035
loss_pred:0.0240568108856678, decouple_loss:0.005358359310775995
loss_pred:0.023474054411053658, decouple_loss:0.005503957159817219
Iteration: 965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45027074217796326, gen p mean: -0.7680547833442688, mean p set: 0.45075103640556335
The modified gen p mean: 0.45003727078437805, gen p mean: -0.7796444892883301, mean p set: 0.45051753520965576
The modified gen p mean: 0.450730562210083, gen p mean: -0.7720809578895569, mean p set: 0.4512108564376831
loss_pred:0.023674005642533302, decouple_loss:0.005396092310547829loss_pred:0.023048102855682373, decouple_loss:0.005424670875072479
loss_pred:0.023244598880410194, decouple_loss:0.005278785713016987
Iteration: 966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500882625579834, gen p mean: -0.7817354202270508, mean p set: 0.4505685865879059
The modified gen p mean: 0.4501987397670746, gen p mean: -0.7726669907569885, mean p set: 0.4506790041923523
The modified gen p mean: 0.4502076208591461, gen p mean: -0.7761751413345337, mean p set: 0.4506879150867462
loss_pred:0.02475106157362461, decouple_loss:0.006106856279075146
loss_pred:0.022924888879060745, decouple_loss:0.0054656704887747765
loss_pred:0.02384682185947895, decouple_loss:0.005478814709931612
Iteration: 967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45050111413002014, gen p mean: -0.7787792086601257, mean p set: 0.45098140835762024
The modified gen p mean: 0.44930392503738403, gen p mean: -0.7727653384208679, mean p set: 0.4497842490673065
The modified gen p mean: 0.44908952713012695, gen p mean: -0.7821370959281921, mean p set: 0.44956985116004944
loss_pred:0.023323267698287964, decouple_loss:0.005343161523342133loss_pred:0.023383380845189095, decouple_loss:0.0056711300276219845
loss_pred:0.023120759055018425, decouple_loss:0.005528551060706377
Iteration: 968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506820738315582, gen p mean: -0.7790894508361816, mean p set: 0.45116233825683594
The modified gen p mean: 0.4490228295326233, gen p mean: -0.7777062058448792, mean p set: 0.4495031237602234
The modified gen p mean: 0.4505167007446289, gen p mean: -0.7802338004112244, mean p set: 0.450996994972229
loss_pred:0.023334594443440437, decouple_loss:0.005480904132127762
loss_pred:0.02331761084496975, decouple_loss:0.005469922907650471
loss_pred:0.023148128762841225, decouple_loss:0.005453800316900015
Iteration: 969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492666721343994, gen p mean: -0.7706378698348999, mean p set: 0.4497469365596771
The modified gen p mean: 0.4491910934448242, gen p mean: -0.7762743234634399, mean p set: 0.4496713876724243
The modified gen p mean: 0.45185530185699463, gen p mean: -0.7768120765686035, mean p set: 0.4523356258869171
loss_pred:0.023325562477111816, decouple_loss:0.005330311134457588
loss_pred:0.023915324360132217, decouple_loss:0.005807339679449797
loss_pred:0.022923452779650688, decouple_loss:0.00551813468337059
Iteration: 970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45159173011779785, gen p mean: -0.7765907645225525, mean p set: 0.45207199454307556
The modified gen p mean: 0.44981467723846436, gen p mean: -0.7764114737510681, mean p set: 0.45029497146606445
The modified gen p mean: 0.450952410697937, gen p mean: -0.7765276432037354, mean p set: 0.4514326751232147
loss_pred:0.023608190938830376, decouple_loss:0.0055147381499409676
loss_pred:0.02310841903090477, decouple_loss:0.00539986090734601
loss_pred:0.02255244180560112, decouple_loss:0.005313312169164419
2023-05-07 01:18:41 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7878113389015198, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7758992314338684, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7797735333442688, mean p set: 0.4500633478164673
loss_pred:0.025552136823534966, decouple_loss:0.006080152001231909
loss_pred:0.024179214611649513, decouple_loss:0.005879574455320835
loss_pred:0.024535948410630226, decouple_loss:0.005885200574994087
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02505318447947502, avg_mse: 0.031168431043624878
current test mse: 0.031168
Iteration: 971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990256428718567, gen p mean: -0.7690573334693909, mean p set: 0.45038288831710815
The modified gen p mean: 0.44911232590675354, gen p mean: -0.7767754793167114, mean p set: 0.449592649936676
loss_pred:0.023683613166213036, decouple_loss:0.00545967323705554
loss_pred:0.022852450609207153, decouple_loss:0.005205340217798948
The modified gen p mean: 0.4507567882537842, gen p mean: -0.7865596413612366, mean p set: 0.45123711228370667
loss_pred:0.02444835938513279, decouple_loss:0.005762293469160795
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
NaN value num: 0
Iteration: 972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513704478740692, gen p mean: -0.7708055973052979, mean p set: 0.4518507122993469
The modified gen p mean: 0.4518355429172516, gen p mean: -0.7729864716529846, mean p set: 0.4523157775402069
The modified gen p mean: 0.4515620768070221, gen p mean: -0.7709908485412598, mean p set: 0.4520423710346222
loss_pred:0.024086831137537956, decouple_loss:0.005587134975939989
loss_pred:0.023133087903261185, decouple_loss:0.005316538270562887
loss_pred:0.024630792438983917, decouple_loss:0.005564423277974129
Iteration: 973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452411949634552, gen p mean: -0.7768367528915405, mean p set: 0.4528922438621521
The modified gen p mean: 0.4503832757472992, gen p mean: -0.7765182852745056, mean p set: 0.4508635997772217
The modified gen p mean: 0.4508916735649109, gen p mean: -0.7712975740432739, mean p set: 0.4513719379901886
loss_pred:0.024155976250767708, decouple_loss:0.005835973657667637loss_pred:0.023494910448789597, decouple_loss:0.005692203063517809
loss_pred:0.0238446444272995, decouple_loss:0.005801454186439514
Iteration: 974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45328283309936523, gen p mean: -0.7882956266403198, mean p set: 0.45376312732696533
The modified gen p mean: 0.44965657591819763, gen p mean: -0.7709930539131165, mean p set: 0.45013684034347534
The modified gen p mean: 0.45081716775894165, gen p mean: -0.7768129706382751, mean p set: 0.45129746198654175
loss_pred:0.023153156042099, decouple_loss:0.0058471811935305595
loss_pred:0.0248725526034832, decouple_loss:0.005610770545899868
loss_pred:0.024939192458987236, decouple_loss:0.005344180855900049
Iteration: 975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515725374221802, gen p mean: -0.7856693267822266, mean p set: 0.4520528018474579
The modified gen p mean: 0.4522361159324646, gen p mean: -0.7922433614730835, mean p set: 0.4527163803577423
loss_pred:0.02359006367623806, decouple_loss:0.0057484665885567665
loss_pred:0.023678524419665337, decouple_loss:0.005758361425250769
The modified gen p mean: 0.4503253102302551, gen p mean: -0.7838572859764099, mean p set: 0.4508056044578552
loss_pred:0.024522727355360985, decouple_loss:0.00560465594753623
Iteration: 976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059725642204285, gen p mean: -0.7776703238487244, mean p set: 0.45107758045196533
The modified gen p mean: 0.45126330852508545, gen p mean: -0.7862783670425415, mean p set: 0.45174357295036316
The modified gen p mean: 0.45031100511550903, gen p mean: -0.7736209630966187, mean p set: 0.45079126954078674
loss_pred:0.023868246003985405, decouple_loss:0.005610077641904354
loss_pred:0.02454768680036068, decouple_loss:0.0054577006958425045
loss_pred:0.023791402578353882, decouple_loss:0.005570156034082174
Iteration: 977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024070143699646, gen p mean: -0.7666615843772888, mean p set: 0.45072096586227417
The modified gen p mean: 0.45033156871795654, gen p mean: -0.7687671780586243, mean p set: 0.45081186294555664
The modified gen p mean: 0.4495322108268738, gen p mean: -0.7694960236549377, mean p set: 0.4500125050544739
loss_pred:0.024876246228814125, decouple_loss:0.0055843740701675415
loss_pred:0.024235794320702553, decouple_loss:0.005899172276258469
loss_pred:0.024647582322359085, decouple_loss:0.005527909379452467
Iteration: 978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513097405433655, gen p mean: -0.7632720470428467, mean p set: 0.4517900347709656
The modified gen p mean: 0.45025834441185, gen p mean: -0.7654809951782227, mean p set: 0.4507386088371277
loss_pred:0.023513806983828545, decouple_loss:0.005445612128823996
loss_pred:0.02397039718925953, decouple_loss:0.005283342208713293
The modified gen p mean: 0.4521675705909729, gen p mean: -0.7751725912094116, mean p set: 0.452647864818573
loss_pred:0.02288295328617096, decouple_loss:0.005772707983851433
Iteration: 979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534585177898407, gen p mean: -0.7766430974006653, mean p set: 0.4539388418197632
The modified gen p mean: 0.4517292380332947, gen p mean: -0.7802118062973022, mean p set: 0.4522095024585724
The modified gen p mean: 0.45066696405410767, gen p mean: -0.7631138563156128, mean p set: 0.45114725828170776
loss_pred:0.023441322147846222, decouple_loss:0.005547663196921349
loss_pred:0.024434005841612816, decouple_loss:0.0054239192977547646
loss_pred:0.023728497326374054, decouple_loss:0.005298665724694729
Iteration: 980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520556330680847, gen p mean: -0.7779989838600159, mean p set: 0.4525359272956848
The modified gen p mean: 0.44940948486328125, gen p mean: -0.7617753148078918, mean p set: 0.44988977909088135
The modified gen p mean: 0.44847601652145386, gen p mean: -0.7597854137420654, mean p set: 0.44895628094673157
loss_pred:0.023509833961725235, decouple_loss:0.005340459290891886
loss_pred:0.024350658059120178, decouple_loss:0.005688749719411135
loss_pred:0.02425139769911766, decouple_loss:0.005787949543446302
2023-05-07 01:23:01 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7899051904678345, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7786127924919128, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7823861241340637, mean p set: 0.4500633478164673
loss_pred:0.02551182731986046, decouple_loss:0.0060195098631083965
loss_pred:0.024165155366063118, decouple_loss:0.005786200985312462
loss_pred:0.02438828907907009, decouple_loss:0.005905162077397108
WV_0_PC_1_EH_0_PS_40_6, loss: 0.0249836053699255, avg_mse: 0.03111840784549713
current test mse: 0.031118
Iteration: 981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523312449455261, gen p mean: -0.777118980884552, mean p set: 0.4528115391731262
The modified gen p mean: 0.4494536221027374, gen p mean: -0.7695989012718201, mean p set: 0.4499339163303375
loss_pred:0.024073198437690735, decouple_loss:0.00535965571179986
loss_pred:0.024517226964235306, decouple_loss:0.005171539727598429
The modified gen p mean: 0.4521346390247345, gen p mean: -0.770845353603363, mean p set: 0.452614963054657
loss_pred:0.023684188723564148, decouple_loss:0.005129814613610506
Iteration: 982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45291364192962646, gen p mean: -0.7818652987480164, mean p set: 0.45339396595954895
The modified gen p mean: 0.45202091336250305, gen p mean: -0.7791737914085388, mean p set: 0.45250123739242554
The modified gen p mean: 0.45054683089256287, gen p mean: -0.7702451944351196, mean p set: 0.45102712512016296
loss_pred:0.023521943017840385, decouple_loss:0.005414971150457859
loss_pred:0.023301806300878525, decouple_loss:0.005390501115471125
loss_pred:0.024273253977298737, decouple_loss:0.005490384064614773
Iteration: 983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45040634274482727, gen p mean: -0.7688013911247253, mean p set: 0.450886607170105
The modified gen p mean: 0.4516530930995941, gen p mean: -0.7742829322814941, mean p set: 0.4521334171295166
The modified gen p mean: 0.45292168855667114, gen p mean: -0.7863997220993042, mean p set: 0.45340198278427124
loss_pred:0.02500714547932148, decouple_loss:0.005240630824118853
loss_pred:0.02386864647269249, decouple_loss:0.005168374627828598
loss_pred:0.022741788998246193, decouple_loss:0.005323261953890324
Iteration: 984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45361801981925964, gen p mean: -0.7929445505142212, mean p set: 0.45409834384918213
The modified gen p mean: 0.4508422911167145, gen p mean: -0.7764690518379211, mean p set: 0.4513225853443146
The modified gen p mean: 0.4520135819911957, gen p mean: -0.7760820984840393, mean p set: 0.4524938464164734
loss_pred:0.023136308416724205, decouple_loss:0.005178519058972597
loss_pred:0.023276437073946, decouple_loss:0.004842889960855246
loss_pred:0.02382490038871765, decouple_loss:0.005137503147125244
Iteration: 985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45068544149398804, gen p mean: -0.7711842060089111, mean p set: 0.45116573572158813
The modified gen p mean: 0.450623482465744, gen p mean: -0.7702576518058777, mean p set: 0.4511038064956665
The modified gen p mean: 0.45327553153038025, gen p mean: -0.7839791774749756, mean p set: 0.45375579595565796
loss_pred:0.023740852251648903, decouple_loss:0.005029578227549791
loss_pred:0.023689264431595802, decouple_loss:0.005323169287294149
loss_pred:0.023243481293320656, decouple_loss:0.005316006951034069
Iteration: 986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45062869787216187, gen p mean: -0.7735083103179932, mean p set: 0.45110899209976196
The modified gen p mean: 0.4535071551799774, gen p mean: -0.7790548801422119, mean p set: 0.4539874494075775
loss_pred:0.02450583688914776, decouple_loss:0.004847224801778793
loss_pred:0.022464757785201073, decouple_loss:0.00520259840413928
The modified gen p mean: 0.4529750347137451, gen p mean: -0.7812519073486328, mean p set: 0.4534553289413452
loss_pred:0.023249074816703796, decouple_loss:0.004991474561393261
Iteration: 987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517481029033661, gen p mean: -0.7743996977806091, mean p set: 0.4522283971309662
The modified gen p mean: 0.45171675086021423, gen p mean: -0.7768722176551819, mean p set: 0.45219701528549194
The modified gen p mean: 0.4491192400455475, gen p mean: -0.7597916722297668, mean p set: 0.4495995044708252
loss_pred:0.023413386195898056, decouple_loss:0.005104816518723965loss_pred:0.023073039948940277, decouple_loss:0.005286508239805698
loss_pred:0.024024885147809982, decouple_loss:0.005250412505120039
Iteration: 988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533700942993164, gen p mean: -0.7814469337463379, mean p set: 0.4538503587245941
The modified gen p mean: 0.4521905481815338, gen p mean: -0.7698153257369995, mean p set: 0.4526708722114563
The modified gen p mean: 0.45069485902786255, gen p mean: -0.7696887850761414, mean p set: 0.45117518305778503
loss_pred:0.021933097392320633, decouple_loss:0.004877491854131222
loss_pred:0.02323022298514843, decouple_loss:0.005186866037547588
loss_pred:0.022889673709869385, decouple_loss:0.0049660056829452515
Iteration: 989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45275965332984924, gen p mean: -0.7734903693199158, mean p set: 0.45323994755744934
The modified gen p mean: 0.45201101899147034, gen p mean: -0.7748236060142517, mean p set: 0.4524913430213928
The modified gen p mean: 0.4500223398208618, gen p mean: -0.7676995992660522, mean p set: 0.4505026042461395
loss_pred:0.023580582812428474, decouple_loss:0.005221215076744556
loss_pred:0.023511439561843872, decouple_loss:0.005441754125058651
loss_pred:0.024091094732284546, decouple_loss:0.00529039790853858
Iteration: 990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45178914070129395, gen p mean: -0.7664018869400024, mean p set: 0.45226943492889404
The modified gen p mean: 0.45199593901634216, gen p mean: -0.7722060680389404, mean p set: 0.45247623324394226
The modified gen p mean: 0.4505334794521332, gen p mean: -0.7656095623970032, mean p set: 0.45101380348205566
loss_pred:0.02394573763012886, decouple_loss:0.005253949202597141loss_pred:0.023885633796453476, decouple_loss:0.005186270456761122
loss_pred:0.023653922602534294, decouple_loss:0.005458901636302471
2023-05-07 01:26:39 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7885220050811768, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7772240042686462, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7810516357421875, mean p set: 0.4500633478164673
loss_pred:0.02540871687233448, decouple_loss:0.00607188418507576
loss_pred:0.024079715833067894, decouple_loss:0.005867927800863981
loss_pred:0.024394139647483826, decouple_loss:0.005849909968674183
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02492402121424675, avg_mse: 0.03108193911612034
current test mse: 0.031082
Iteration: 991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520168602466583, gen p mean: -0.770807147026062, mean p set: 0.45249712467193604
The modified gen p mean: 0.4527318775653839, gen p mean: -0.7863771915435791, mean p set: 0.453212171792984
loss_pred:0.023593969643115997, decouple_loss:0.00507324980571866
loss_pred:0.02375558577477932, decouple_loss:0.005383480340242386
The modified gen p mean: 0.4500981867313385, gen p mean: -0.7705590724945068, mean p set: 0.4505784809589386
loss_pred:0.02334587648510933, decouple_loss:0.0052525498904287815
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
NaN value num: 0
Iteration: 992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679513573646545, gen p mean: -0.7846177816390991, mean p set: 0.44727540016174316
The modified gen p mean: 0.4454883337020874, gen p mean: -0.7883317470550537, mean p set: 0.4459685981273651
The modified gen p mean: 0.4478501081466675, gen p mean: -0.7928879857063293, mean p set: 0.4483303725719452
loss_pred:0.02543843351304531, decouple_loss:0.006147625390440226
loss_pred:0.025862932205200195, decouple_loss:0.005916826892644167
loss_pred:0.025563839823007584, decouple_loss:0.005901547148823738
Iteration: 993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479556679725647, gen p mean: -0.7930982708930969, mean p set: 0.4484359920024872
The modified gen p mean: 0.4460814893245697, gen p mean: -0.7891121506690979, mean p set: 0.4465617835521698
The modified gen p mean: 0.44760680198669434, gen p mean: -0.7903016805648804, mean p set: 0.4480871260166168
loss_pred:0.025366786867380142, decouple_loss:0.006063684355467558loss_pred:0.025143925100564957, decouple_loss:0.006148540414869785
loss_pred:0.025340041145682335, decouple_loss:0.005815727170556784
Iteration: 994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464631974697113, gen p mean: -0.7965968251228333, mean p set: 0.4469434916973114
The modified gen p mean: 0.4484342336654663, gen p mean: -0.7914854288101196, mean p set: 0.448914498090744
The modified gen p mean: 0.446698933839798, gen p mean: -0.7924439311027527, mean p set: 0.44717922806739807
loss_pred:0.025947609916329384, decouple_loss:0.006208894308656454
loss_pred:0.025439025834202766, decouple_loss:0.005937781650573015
loss_pred:0.025917526334524155, decouple_loss:0.005797782447189093
Iteration: 995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809529185295105, gen p mean: -0.800426185131073, mean p set: 0.44857561588287354
The modified gen p mean: 0.44800689816474915, gen p mean: -0.7984570264816284, mean p set: 0.44848719239234924
The modified gen p mean: 0.4471037983894348, gen p mean: -0.8050991892814636, mean p set: 0.4475840926170349
loss_pred:0.024859895929694176, decouple_loss:0.0057727559469640255
loss_pred:0.025248361751437187, decouple_loss:0.00585695868358016
loss_pred:0.024562736973166466, decouple_loss:0.005751322954893112
Iteration: 996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470379948616028, gen p mean: -0.8101675510406494, mean p set: 0.4475182592868805
The modified gen p mean: 0.4464389681816101, gen p mean: -0.80170738697052, mean p set: 0.4469192922115326
The modified gen p mean: 0.44815319776535034, gen p mean: -0.7980919480323792, mean p set: 0.44863349199295044
loss_pred:0.026198523119091988, decouple_loss:0.0064812637865543365
loss_pred:0.02660037949681282, decouple_loss:0.006003852467983961
loss_pred:0.025285707786679268, decouple_loss:0.005940890405327082
Iteration: 997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456179440021515, gen p mean: -0.7927337288856506, mean p set: 0.446098268032074
The modified gen p mean: 0.4461911916732788, gen p mean: -0.7913445830345154, mean p set: 0.4466714859008789
The modified gen p mean: 0.4463730454444885, gen p mean: -0.79762864112854, mean p set: 0.446853369474411
loss_pred:0.025125671178102493, decouple_loss:0.0060104746371507645
loss_pred:0.02521919086575508, decouple_loss:0.0058252690359950066
loss_pred:0.025499451905488968, decouple_loss:0.0062319254502654076
Iteration: 998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456440508365631, gen p mean: -0.7851191163063049, mean p set: 0.4461243748664856
The modified gen p mean: 0.4477015435695648, gen p mean: -0.784148097038269, mean p set: 0.4481818377971649
loss_pred:0.025232519954442978, decouple_loss:0.005846402607858181
loss_pred:0.025387169793248177, decouple_loss:0.005801104474812746
The modified gen p mean: 0.4466409385204315, gen p mean: -0.7875084280967712, mean p set: 0.44712120294570923
loss_pred:0.026268914341926575, decouple_loss:0.005895851645618677
Iteration: 999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461131691932678, gen p mean: -0.7796813249588013, mean p set: 0.4465934634208679
The modified gen p mean: 0.44686761498451233, gen p mean: -0.7861310243606567, mean p set: 0.4473479390144348
The modified gen p mean: 0.44687533378601074, gen p mean: -0.7824723124504089, mean p set: 0.44735562801361084
loss_pred:0.024467429146170616, decouple_loss:0.005670633632689714
loss_pred:0.025418706238269806, decouple_loss:0.006148852873593569
loss_pred:0.024683913215994835, decouple_loss:0.005858506541699171
Iteration: 1000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486715495586395, gen p mean: -0.7790617942810059, mean p set: 0.44915181398391724
The modified gen p mean: 0.4460989236831665, gen p mean: -0.7754820585250854, mean p set: 0.4465792179107666
The modified gen p mean: 0.4464641809463501, gen p mean: -0.7802439332008362, mean p set: 0.4469445049762726
loss_pred:0.02541211061179638, decouple_loss:0.0058457073755562305
loss_pred:0.025055518373847008, decouple_loss:0.005878185387700796
loss_pred:0.02485959604382515, decouple_loss:0.005996230989694595
2023-05-07 01:31:21 itr: 1000
training loss: [0.02515941 0.0257044  0.02534943]
2023-05-07 01:31:21 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7789378762245178, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7687979936599731, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7725078463554382, mean p set: 0.4500633478164673
loss_pred:0.025419194251298904, decouple_loss:0.006000500172376633
loss_pred:0.0242445170879364, decouple_loss:0.00584681611508131
loss_pred:0.024487953633069992, decouple_loss:0.0057634999975562096
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025010734796524048, avg_mse: 0.031212331727147102
current test mse: 0.031212
Iteration: 1001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471263587474823, gen p mean: -0.7701389193534851, mean p set: 0.4476066827774048
The modified gen p mean: 0.44826653599739075, gen p mean: -0.7764534950256348, mean p set: 0.44874683022499084
loss_pred:0.02460072934627533, decouple_loss:0.005907850805670023
loss_pred:0.02492404542863369, decouple_loss:0.005758543964475393
The modified gen p mean: 0.4473837912082672, gen p mean: -0.7772693634033203, mean p set: 0.4478640854358673
loss_pred:0.02535134181380272, decouple_loss:0.005704874638468027
Iteration: 1002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656896591186523, gen p mean: -0.7705248594284058, mean p set: 0.44704926013946533
The modified gen p mean: 0.44780197739601135, gen p mean: -0.7763073444366455, mean p set: 0.44828227162361145
The modified gen p mean: 0.4473097324371338, gen p mean: -0.7709261178970337, mean p set: 0.4477900266647339
loss_pred:0.025585860013961792, decouple_loss:0.005685693118721247
loss_pred:0.02633216790854931, decouple_loss:0.0058731818571686745
loss_pred:0.025093654170632362, decouple_loss:0.00569516746327281
Iteration: 1003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791150093078613, gen p mean: -0.7749837040901184, mean p set: 0.44839179515838623
The modified gen p mean: 0.44737508893013, gen p mean: -0.778237521648407, mean p set: 0.4478553533554077
loss_pred:0.024626443162560463, decouple_loss:0.005743369925767183
loss_pred:0.025883696973323822, decouple_loss:0.0058607985265553
The modified gen p mean: 0.4476119875907898, gen p mean: -0.7747982144355774, mean p set: 0.4480923116207123
loss_pred:0.024879958480596542, decouple_loss:0.005703933537006378
Iteration: 1004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464874863624573, gen p mean: -0.7806823253631592, mean p set: 0.4469677805900574
The modified gen p mean: 0.44699329137802124, gen p mean: -0.7766688466072083, mean p set: 0.44747358560562134
The modified gen p mean: 0.44794201850891113, gen p mean: -0.7740638256072998, mean p set: 0.44842231273651123
loss_pred:0.025384066626429558, decouple_loss:0.005874075461179018
loss_pred:0.025045113638043404, decouple_loss:0.005903365556150675
loss_pred:0.025837618857622147, decouple_loss:0.005675984546542168
Iteration: 1005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477238655090332, gen p mean: -0.7870181798934937, mean p set: 0.4482041299343109
The modified gen p mean: 0.44781431555747986, gen p mean: -0.7928104400634766, mean p set: 0.44829463958740234
The modified gen p mean: 0.4469752311706543, gen p mean: -0.7767909169197083, mean p set: 0.4474555552005768
loss_pred:0.02419310249388218, decouple_loss:0.005805685184895992
loss_pred:0.025615517050027847, decouple_loss:0.006209398619830608
loss_pred:0.025571094825863838, decouple_loss:0.005705543328076601
Iteration: 1006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642043113708496, gen p mean: -0.7854514718055725, mean p set: 0.44690072536468506
The modified gen p mean: 0.4473395347595215, gen p mean: -0.7917346954345703, mean p set: 0.4478198289871216
The modified gen p mean: 0.4469386339187622, gen p mean: -0.7861039638519287, mean p set: 0.4474189281463623
loss_pred:0.024805985391139984, decouple_loss:0.005477244034409523
loss_pred:0.024115312844514847, decouple_loss:0.005434128921478987
loss_pred:0.02504262514412403, decouple_loss:0.005569861736148596
Iteration: 1007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472595155239105, gen p mean: -0.8000084757804871, mean p set: 0.4477398097515106
The modified gen p mean: 0.4462970495223999, gen p mean: -0.7984112501144409, mean p set: 0.44677734375
The modified gen p mean: 0.44728413224220276, gen p mean: -0.7967620491981506, mean p set: 0.44776445627212524
loss_pred:0.024786096066236496, decouple_loss:0.005780876148492098
loss_pred:0.025959055870771408, decouple_loss:0.0053436532616615295
loss_pred:0.02598521113395691, decouple_loss:0.005655921995639801
Iteration: 1008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470159411430359, gen p mean: -0.797799289226532, mean p set: 0.4474962055683136
The modified gen p mean: 0.44801345467567444, gen p mean: -0.8030586242675781, mean p set: 0.44849371910095215
loss_pred:0.025514287874102592, decouple_loss:0.005620012059807777
loss_pred:0.024938179180026054, decouple_loss:0.005269187502563
The modified gen p mean: 0.4459565579891205, gen p mean: -0.7986062169075012, mean p set: 0.4464368224143982
loss_pred:0.024944115430116653, decouple_loss:0.005742724519222975
Iteration: 1009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695407152175903, gen p mean: -0.7879044413566589, mean p set: 0.44743436574935913
The modified gen p mean: 0.44770678877830505, gen p mean: -0.7852821350097656, mean p set: 0.44818708300590515
The modified gen p mean: 0.4469863176345825, gen p mean: -0.7970218658447266, mean p set: 0.44746658205986023
loss_pred:0.024135401472449303, decouple_loss:0.005567858926951885
loss_pred:0.02494974061846733, decouple_loss:0.005594716873019934
loss_pred:0.02543090283870697, decouple_loss:0.005993837956339121
Iteration: 1010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726115465164185, gen p mean: -0.7894525527954102, mean p set: 0.44774138927459717
The modified gen p mean: 0.44674113392829895, gen p mean: -0.7849829196929932, mean p set: 0.44722142815589905
The modified gen p mean: 0.4478020966053009, gen p mean: -0.781731367111206, mean p set: 0.4482823610305786
loss_pred:0.02562439814209938, decouple_loss:0.005657646339386702
loss_pred:0.02576683647930622, decouple_loss:0.005821706261485815
loss_pred:0.024709220975637436, decouple_loss:0.005505707114934921
2023-05-07 01:34:57 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7896691560745239, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7787455320358276, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7825396656990051, mean p set: 0.4500633478164673
loss_pred:0.02531612105667591, decouple_loss:0.005850424058735371
loss_pred:0.024054475128650665, decouple_loss:0.005650022067129612
loss_pred:0.024282535538077354, decouple_loss:0.005587493069469929
WV_0_PC_1_EH_0_PS_40_6, loss: 0.024835843592882156, avg_mse: 0.030983328819274902
current test mse: 0.030983
Iteration: 1011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673311710357666, gen p mean: -0.785675585269928, mean p set: 0.44721341133117676
The modified gen p mean: 0.447870135307312, gen p mean: -0.7874688506126404, mean p set: 0.4483503997325897
loss_pred:0.024820858612656593, decouple_loss:0.005498737096786499
loss_pred:0.02422151155769825, decouple_loss:0.005370310507714748
The modified gen p mean: 0.44741547107696533, gen p mean: -0.7864792943000793, mean p set: 0.44789573550224304
loss_pred:0.025266023352742195, decouple_loss:0.005480495747178793
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 1012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468380808830261, gen p mean: -0.7850956916809082, mean p set: 0.44731831550598145
The modified gen p mean: 0.4479805529117584, gen p mean: -0.7835638523101807, mean p set: 0.44846081733703613
The modified gen p mean: 0.44737327098846436, gen p mean: -0.7829738259315491, mean p set: 0.44785353541374207
loss_pred:0.024579405784606934, decouple_loss:0.006092915311455727
loss_pred:0.02473151870071888, decouple_loss:0.005922974552959204
loss_pred:0.02521221525967121, decouple_loss:0.0058643086813390255
Iteration: 1013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477286636829376, gen p mean: -0.785295844078064, mean p set: 0.4482089579105377
The modified gen p mean: 0.44856178760528564, gen p mean: -0.7772928476333618, mean p set: 0.44904205203056335
loss_pred:0.025397464632987976, decouple_loss:0.0060100797563791275
loss_pred:0.02431979402899742, decouple_loss:0.005733888130635023
The modified gen p mean: 0.4477596580982208, gen p mean: -0.7883203029632568, mean p set: 0.4482399523258209
loss_pred:0.025250056758522987, decouple_loss:0.00594865158200264
Iteration: 1014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476693272590637, gen p mean: -0.7888920903205872, mean p set: 0.44814959168434143
The modified gen p mean: 0.4466997981071472, gen p mean: -0.7831887602806091, mean p set: 0.4471800923347473
loss_pred:0.024136105552315712, decouple_loss:0.005652323365211487
loss_pred:0.02505822665989399, decouple_loss:0.005691413301974535
The modified gen p mean: 0.4472672641277313, gen p mean: -0.7842177152633667, mean p set: 0.4477475583553314
loss_pred:0.024316202849149704, decouple_loss:0.005708669777959585
Iteration: 1015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780266284942627, gen p mean: -0.7891615629196167, mean p set: 0.44828295707702637
The modified gen p mean: 0.44722214341163635, gen p mean: -0.788520872592926, mean p set: 0.44770246744155884
The modified gen p mean: 0.4483819007873535, gen p mean: -0.7811675071716309, mean p set: 0.4488621652126312
loss_pred:0.024812648072838783, decouple_loss:0.005514746531844139
loss_pred:0.024273939430713654, decouple_loss:0.005629610735923052
loss_pred:0.025414003059267998, decouple_loss:0.005481761414557695
Iteration: 1016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44617268443107605, gen p mean: -0.7808563113212585, mean p set: 0.44665300846099854
The modified gen p mean: 0.4474266767501831, gen p mean: -0.7809469699859619, mean p set: 0.4479069411754608
The modified gen p mean: 0.4478815495967865, gen p mean: -0.7835030555725098, mean p set: 0.4483618438243866
loss_pred:0.0248025581240654, decouple_loss:0.005663954187184572
loss_pred:0.024729624390602112, decouple_loss:0.005538415163755417
loss_pred:0.02444968745112419, decouple_loss:0.005634275730699301
Iteration: 1017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474486708641052, gen p mean: -0.7821400761604309, mean p set: 0.4479289650917053
The modified gen p mean: 0.4477365016937256, gen p mean: -0.7774501442909241, mean p set: 0.44821682572364807
The modified gen p mean: 0.44658082723617554, gen p mean: -0.7818378210067749, mean p set: 0.44706112146377563
loss_pred:0.024853600189089775, decouple_loss:0.005543301813304424
loss_pred:0.02528367005288601, decouple_loss:0.005616101901978254
loss_pred:0.02480536885559559, decouple_loss:0.005558351054787636
Iteration: 1018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488472044467926, gen p mean: -0.7710874080657959, mean p set: 0.4493274986743927
The modified gen p mean: 0.4473842680454254, gen p mean: -0.7794814705848694, mean p set: 0.4478645324707031
loss_pred:0.024498574435710907, decouple_loss:0.0054235393181443214
loss_pred:0.02408173866569996, decouple_loss:0.00613416638225317
The modified gen p mean: 0.4482875466346741, gen p mean: -0.7774438858032227, mean p set: 0.4487678110599518
loss_pred:0.023952577263116837, decouple_loss:0.005399156827479601
Iteration: 1019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482654631137848, gen p mean: -0.7783887386322021, mean p set: 0.4487457573413849
The modified gen p mean: 0.44780614972114563, gen p mean: -0.7717231512069702, mean p set: 0.4482864737510681
The modified gen p mean: 0.44873046875, gen p mean: -0.7738533616065979, mean p set: 0.4492107927799225
loss_pred:0.024978723376989365, decouple_loss:0.005616328213363886loss_pred:0.023904429748654366, decouple_loss:0.005418447777628899
loss_pred:0.024911072105169296, decouple_loss:0.005674205720424652
Iteration: 1020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726109504699707, gen p mean: -0.7804561853408813, mean p set: 0.4477413594722748
The modified gen p mean: 0.4471328556537628, gen p mean: -0.7838857769966125, mean p set: 0.4476131498813629
The modified gen p mean: 0.4475400745868683, gen p mean: -0.7825907468795776, mean p set: 0.44802039861679077
loss_pred:0.024531573057174683, decouple_loss:0.005663825664669275
loss_pred:0.023859616369009018, decouple_loss:0.0057226973585784435
loss_pred:0.02379421703517437, decouple_loss:0.005709785036742687
2023-05-07 01:39:31 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7998121976852417, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7885662913322449, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7922037839889526, mean p set: 0.4500633478164673
loss_pred:0.025104522705078125, decouple_loss:0.0057351416908204556
loss_pred:0.023813065141439438, decouple_loss:0.0055432990193367004
loss_pred:0.024136802181601524, decouple_loss:0.005531979724764824
WV_0_PC_1_EH_0_PS_40_6, loss: 0.024631638079881668, avg_mse: 0.030691098421812057
current test mse: 0.030691
Iteration: 1021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822150468826294, gen p mean: -0.7922454476356506, mean p set: 0.44870179891586304
The modified gen p mean: 0.4470638036727905, gen p mean: -0.7894960641860962, mean p set: 0.44754406809806824
loss_pred:0.02422107756137848, decouple_loss:0.005469580180943012
loss_pred:0.02448393777012825, decouple_loss:0.005539922509342432
The modified gen p mean: 0.44829726219177246, gen p mean: -0.7937445044517517, mean p set: 0.44877755641937256
loss_pred:0.024914652109146118, decouple_loss:0.005248433444648981
Iteration: 1022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468141496181488, gen p mean: -0.7941179871559143, mean p set: 0.4472944438457489
The modified gen p mean: 0.44694724678993225, gen p mean: -0.7945285439491272, mean p set: 0.44742754101753235
The modified gen p mean: 0.44696977734565735, gen p mean: -0.7948460578918457, mean p set: 0.44745007157325745
loss_pred:0.024647921323776245, decouple_loss:0.005321152042597532
loss_pred:0.02381463721394539, decouple_loss:0.005577732343226671
loss_pred:0.023890210315585136, decouple_loss:0.0053249541670084
Iteration: 1023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723835587501526, gen p mean: -0.7842882871627808, mean p set: 0.44771865010261536
The modified gen p mean: 0.4477505683898926, gen p mean: -0.7865719795227051, mean p set: 0.4482308626174927
The modified gen p mean: 0.44831037521362305, gen p mean: -0.7904131412506104, mean p set: 0.44879069924354553
loss_pred:0.023831114172935486, decouple_loss:0.005548947490751743
loss_pred:0.024657035246491432, decouple_loss:0.005265002604573965
loss_pred:0.023950757458806038, decouple_loss:0.005193773657083511
Iteration: 1024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754457473754883, gen p mean: -0.7807204723358154, mean p set: 0.4480248689651489
The modified gen p mean: 0.44712865352630615, gen p mean: -0.7856695055961609, mean p set: 0.44760891795158386
The modified gen p mean: 0.44758838415145874, gen p mean: -0.7852092981338501, mean p set: 0.44806867837905884
loss_pred:0.02506634034216404, decouple_loss:0.005679863505065441loss_pred:0.023647403344511986, decouple_loss:0.005383501295000315
loss_pred:0.024035148322582245, decouple_loss:0.005544054787606001
Iteration: 1025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472653269767761, gen p mean: -0.7773943543434143, mean p set: 0.4477456510066986
The modified gen p mean: 0.4473441243171692, gen p mean: -0.7743339538574219, mean p set: 0.4478244483470917
The modified gen p mean: 0.4477446675300598, gen p mean: -0.7780131101608276, mean p set: 0.4482249617576599
loss_pred:0.024671055376529694, decouple_loss:0.005346875637769699
loss_pred:0.024432864040136337, decouple_loss:0.0053205243311822414
loss_pred:0.023798445239663124, decouple_loss:0.005303893703967333
Iteration: 1026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483383595943451, gen p mean: -0.7669063210487366, mean p set: 0.4488186836242676
The modified gen p mean: 0.4476114511489868, gen p mean: -0.7725476026535034, mean p set: 0.4480917155742645
The modified gen p mean: 0.4489087164402008, gen p mean: -0.7729669809341431, mean p set: 0.4493890404701233
loss_pred:0.024478092789649963, decouple_loss:0.005430759862065315
loss_pred:0.0249569620937109, decouple_loss:0.005472901742905378
loss_pred:0.024280065670609474, decouple_loss:0.005287901498377323
Iteration: 1027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478708803653717, gen p mean: -0.7634809017181396, mean p set: 0.4483511745929718
The modified gen p mean: 0.44807589054107666, gen p mean: -0.7658380270004272, mean p set: 0.44855615496635437
The modified gen p mean: 0.44771134853363037, gen p mean: -0.7655521631240845, mean p set: 0.44819164276123047
loss_pred:0.024246839806437492, decouple_loss:0.0054717217572033405
loss_pred:0.024208014830946922, decouple_loss:0.00535673089325428
loss_pred:0.02355443872511387, decouple_loss:0.00541961845010519
Iteration: 1028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490087032318115, gen p mean: -0.7677125334739685, mean p set: 0.4494889974594116
The modified gen p mean: 0.4473407566547394, gen p mean: -0.761810302734375, mean p set: 0.4478210508823395
The modified gen p mean: 0.4481663703918457, gen p mean: -0.7699611783027649, mean p set: 0.4486466944217682
loss_pred:0.023889316245913506, decouple_loss:0.005197967868298292
loss_pred:0.02467229962348938, decouple_loss:0.005227797664701939
loss_pred:0.024287723004817963, decouple_loss:0.005385976750403643
Iteration: 1029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44612351059913635, gen p mean: -0.7719693183898926, mean p set: 0.44660380482673645
The modified gen p mean: 0.4476584792137146, gen p mean: -0.7693120837211609, mean p set: 0.4481387734413147
The modified gen p mean: 0.4471362233161926, gen p mean: -0.7685819864273071, mean p set: 0.44761648774147034
loss_pred:0.024922706186771393, decouple_loss:0.0053578391671180725loss_pred:0.024116773158311844, decouple_loss:0.005453384481370449
loss_pred:0.02377488650381565, decouple_loss:0.005347114987671375
Iteration: 1030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783878326416016, gen p mean: -0.7648729085922241, mean p set: 0.44831904768943787
The modified gen p mean: 0.4473603069782257, gen p mean: -0.7640833258628845, mean p set: 0.4478406012058258
The modified gen p mean: 0.44744864106178284, gen p mean: -0.7656797766685486, mean p set: 0.44792893528938293
loss_pred:0.024223120883107185, decouple_loss:0.005246181506663561
loss_pred:0.024703167378902435, decouple_loss:0.00510916905477643
loss_pred:0.024566106498241425, decouple_loss:0.005217206664383411
2023-05-07 01:43:05 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7760055661201477, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7653953433036804, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7690931558609009, mean p set: 0.4500633478164673
loss_pred:0.02505149133503437, decouple_loss:0.005454066209495068
loss_pred:0.02374219335615635, decouple_loss:0.005341906100511551
loss_pred:0.02402825653553009, decouple_loss:0.00532659562304616
WV_0_PC_1_EH_0_PS_40_6, loss: 0.024542689323425293, avg_mse: 0.030636955052614212
current test mse: 0.030637
Iteration: 1031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475277066230774, gen p mean: -0.7681650519371033, mean p set: 0.4480080008506775
The modified gen p mean: 0.4475630521774292, gen p mean: -0.7693406343460083, mean p set: 0.4480433166027069
loss_pred:0.023957330733537674, decouple_loss:0.00539336958900094
loss_pred:0.023559458553791046, decouple_loss:0.0052346158772706985
The modified gen p mean: 0.44775915145874023, gen p mean: -0.7680423855781555, mean p set: 0.44823944568634033
loss_pred:0.024506792426109314, decouple_loss:0.0049971421249210835
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
NaN value num: 0
Iteration: 1032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963276386260986, gen p mean: -0.769443154335022, mean p set: 0.4501130282878876
The modified gen p mean: 0.4501861035823822, gen p mean: -0.7629372477531433, mean p set: 0.4506663978099823
The modified gen p mean: 0.44919735193252563, gen p mean: -0.7677001953125, mean p set: 0.44967761635780334
loss_pred:0.025594491511583328, decouple_loss:0.005884000565856695
loss_pred:0.025531338527798653, decouple_loss:0.005623498000204563
loss_pred:0.025517171248793602, decouple_loss:0.005692735780030489
Iteration: 1033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864264130592346, gen p mean: -0.7674150466918945, mean p set: 0.44912293553352356
The modified gen p mean: 0.45060786604881287, gen p mean: -0.7746923565864563, mean p set: 0.45108816027641296
loss_pred:0.02686898037791252, decouple_loss:0.005691411904990673
loss_pred:0.024411432445049286, decouple_loss:0.005187985487282276
The modified gen p mean: 0.4495059549808502, gen p mean: -0.772117018699646, mean p set: 0.4499862790107727
loss_pred:0.02516656555235386, decouple_loss:0.005417047068476677
Iteration: 1034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489370882511139, gen p mean: -0.7789651155471802, mean p set: 0.4494173526763916
The modified gen p mean: 0.4503208100795746, gen p mean: -0.778415322303772, mean p set: 0.4508011043071747
The modified gen p mean: 0.44998836517333984, gen p mean: -0.7791256904602051, mean p set: 0.45046865940093994
loss_pred:0.025796353816986084, decouple_loss:0.005704505834728479
loss_pred:0.025735262781381607, decouple_loss:0.005434167105704546
loss_pred:0.02512844279408455, decouple_loss:0.005423640366643667
Iteration: 1035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45003122091293335, gen p mean: -0.7827231884002686, mean p set: 0.45051151514053345
The modified gen p mean: 0.4492329955101013, gen p mean: -0.7922284007072449, mean p set: 0.4497132897377014
The modified gen p mean: 0.4487699568271637, gen p mean: -0.7935607433319092, mean p set: 0.4492502808570862
loss_pred:0.025366930291056633, decouple_loss:0.0053631896153092384
loss_pred:0.02554454281926155, decouple_loss:0.006095409393310547
loss_pred:0.02605421096086502, decouple_loss:0.005950738675892353
Iteration: 1036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44938400387763977, gen p mean: -0.7855145335197449, mean p set: 0.44986429810523987
The modified gen p mean: 0.44968053698539734, gen p mean: -0.7899056673049927, mean p set: 0.45016080141067505
The modified gen p mean: 0.4498112201690674, gen p mean: -0.787773609161377, mean p set: 0.4502915143966675
loss_pred:0.025553155690431595, decouple_loss:0.005574336275458336loss_pred:0.025426628068089485, decouple_loss:0.005595261696726084
loss_pred:0.02560281753540039, decouple_loss:0.005544237792491913
Iteration: 1037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502841830253601, gen p mean: -0.7820542454719543, mean p set: 0.4507644772529602
The modified gen p mean: 0.4502740204334259, gen p mean: -0.7793725728988647, mean p set: 0.450754314661026
loss_pred:0.026887018233537674, decouple_loss:0.005983068607747555
loss_pred:0.026590174064040184, decouple_loss:0.005767344497144222
The modified gen p mean: 0.4489954113960266, gen p mean: -0.791818380355835, mean p set: 0.4494756758213043
loss_pred:0.025943102315068245, decouple_loss:0.005606554448604584
Iteration: 1038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496156871318817, gen p mean: -0.7728568315505981, mean p set: 0.4500959813594818
The modified gen p mean: 0.44960206747055054, gen p mean: -0.7713345289230347, mean p set: 0.45008236169815063
The modified gen p mean: 0.4498051106929779, gen p mean: -0.7947087287902832, mean p set: 0.450285404920578
loss_pred:0.034932930022478104, decouple_loss:0.006545376963913441
loss_pred:0.03572698310017586, decouple_loss:0.006686695385724306
loss_pred:0.035084307193756104, decouple_loss:0.006612057331949472
Iteration: 1039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978153705596924, gen p mean: -0.7957207560539246, mean p set: 0.45026183128356934
The modified gen p mean: 0.4497458040714264, gen p mean: -0.793106198310852, mean p set: 0.4502260982990265
The modified gen p mean: 0.4487402141094208, gen p mean: -0.8005052804946899, mean p set: 0.4492204785346985
loss_pred:0.03236890211701393, decouple_loss:0.017570847645401955loss_pred:0.03239146247506142, decouple_loss:0.017314935103058815
loss_pred:0.031597983092069626, decouple_loss:0.017607802525162697
Iteration: 1040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45172709226608276, gen p mean: -0.7919262051582336, mean p set: 0.45220738649368286
The modified gen p mean: 0.4497734606266022, gen p mean: -0.8015726804733276, mean p set: 0.4502537250518799
The modified gen p mean: 0.4489773213863373, gen p mean: -0.7936063408851624, mean p set: 0.449457585811615
loss_pred:0.03523789346218109, decouple_loss:0.03258509561419487
loss_pred:0.035375263541936874, decouple_loss:0.03289847448468208
loss_pred:0.035648662596940994, decouple_loss:0.032052572816610336
2023-05-07 01:47:28 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.772097647190094, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7652725577354431, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7670518159866333, mean p set: 0.4500633478164673
loss_pred:0.036475446075201035, decouple_loss:0.02890319563448429
loss_pred:0.03447047621011734, decouple_loss:0.02758474089205265
loss_pred:0.03561564162373543, decouple_loss:0.027635425329208374
WV_0_PC_1_EH_0_PS_40_6, loss: 0.036922574043273926, avg_mse: 0.042627543210983276
current test mse: 0.042628
Iteration: 1041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44944414496421814, gen p mean: -0.768596887588501, mean p set: 0.44992440938949585
The modified gen p mean: 0.449405312538147, gen p mean: -0.7569935321807861, mean p set: 0.44988563656806946
loss_pred:0.036418408155441284, decouple_loss:0.027952175587415695
loss_pred:0.03663375973701477, decouple_loss:0.02678510919213295
The modified gen p mean: 0.4495638608932495, gen p mean: -0.7597225308418274, mean p set: 0.4500441253185272
loss_pred:0.0373288132250309, decouple_loss:0.026825904846191406
Iteration: 1042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502265155315399, gen p mean: -0.7541549205780029, mean p set: 0.45070680975914
The modified gen p mean: 0.4495851397514343, gen p mean: -0.7693603038787842, mean p set: 0.4500654339790344
The modified gen p mean: 0.44942376017570496, gen p mean: -0.7639937400817871, mean p set: 0.44990405440330505
loss_pred:0.03551873564720154, decouple_loss:0.02688456140458584
loss_pred:0.03403365984559059, decouple_loss:0.02910688705742359
loss_pred:0.03402232378721237, decouple_loss:0.027758989483118057
Iteration: 1043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490235149860382, gen p mean: -0.7141386866569519, mean p set: 0.4495038390159607
The modified gen p mean: 0.4502299427986145, gen p mean: -0.7102689146995544, mean p set: 0.4507102370262146
The modified gen p mean: 0.45044076442718506, gen p mean: -0.7131153345108032, mean p set: 0.45092108845710754
loss_pred:0.032608818262815475, decouple_loss:0.03299443796277046
loss_pred:0.03418062999844551, decouple_loss:0.03149024024605751
loss_pred:0.03443833068013191, decouple_loss:0.03302173316478729
Iteration: 1044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810667634010315, gen p mean: -0.7567474246025085, mean p set: 0.44858694076538086
The modified gen p mean: 0.4503733515739441, gen p mean: -0.7589632272720337, mean p set: 0.4508536458015442
The modified gen p mean: 0.44938376545906067, gen p mean: -0.7566962242126465, mean p set: 0.44986405968666077
loss_pred:0.033328376710414886, decouple_loss:0.028788045048713684
loss_pred:0.03198009356856346, decouple_loss:0.028827903792262077
loss_pred:0.03193154186010361, decouple_loss:0.02786407060921192
Iteration: 1045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977566599845886, gen p mean: -0.7293511033058167, mean p set: 0.45025599002838135
The modified gen p mean: 0.44862550497055054, gen p mean: -0.7317469120025635, mean p set: 0.44910579919815063
loss_pred:0.03208322077989578, decouple_loss:0.024594884365797043
loss_pred:0.033234111964702606, decouple_loss:0.02530667930841446
The modified gen p mean: 0.44959181547164917, gen p mean: -0.72980797290802, mean p set: 0.45007210969924927
loss_pred:0.03129009157419205, decouple_loss:0.024824554100632668
Iteration: 1046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44985246658325195, gen p mean: -0.7485923767089844, mean p set: 0.45033276081085205
The modified gen p mean: 0.44984233379364014, gen p mean: -0.7404454350471497, mean p set: 0.45032259821891785
The modified gen p mean: 0.44964757561683655, gen p mean: -0.7437174916267395, mean p set: 0.45012786984443665
loss_pred:0.032135359942913055, decouple_loss:0.03367356210947037loss_pred:0.03171183541417122, decouple_loss:0.036011915653944016
loss_pred:0.03075476549565792, decouple_loss:0.03298507630825043
Iteration: 1047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492623209953308, gen p mean: -0.7604562044143677, mean p set: 0.4497425854206085
The modified gen p mean: 0.4505566358566284, gen p mean: -0.7627845406532288, mean p set: 0.4510369300842285
The modified gen p mean: 0.44803759455680847, gen p mean: -0.7628616094589233, mean p set: 0.4485178589820862
loss_pred:0.03254232183098793, decouple_loss:0.03401336073875427loss_pred:0.03355548158288002, decouple_loss:0.03495986759662628
loss_pred:0.032372910529375076, decouple_loss:0.034012679010629654
Iteration: 1048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45045435428619385, gen p mean: -0.7181562781333923, mean p set: 0.45093461871147156
The modified gen p mean: 0.4486214816570282, gen p mean: -0.7184046506881714, mean p set: 0.4491018056869507
The modified gen p mean: 0.4490238428115845, gen p mean: -0.7120000123977661, mean p set: 0.44950413703918457
loss_pred:0.032688140869140625, decouple_loss:0.030149299651384354loss_pred:0.03291322663426399, decouple_loss:0.03132843226194382
loss_pred:0.0333072803914547, decouple_loss:0.030965019017457962
Iteration: 1049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44921568036079407, gen p mean: -0.7228373885154724, mean p set: 0.4496959447860718
The modified gen p mean: 0.45207497477531433, gen p mean: -0.7239207625389099, mean p set: 0.45255526900291443
The modified gen p mean: 0.450111985206604, gen p mean: -0.7217227816581726, mean p set: 0.4505922794342041
loss_pred:0.031190410256385803, decouple_loss:0.025609323754906654
loss_pred:0.031992629170417786, decouple_loss:0.026033226400613785
loss_pred:0.030262568965554237, decouple_loss:0.025371260941028595
Iteration: 1050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493388235569, gen p mean: -0.7195247411727905, mean p set: 0.44981908798217773
The modified gen p mean: 0.45142224431037903, gen p mean: -0.7211807370185852, mean p set: 0.45190247893333435
The modified gen p mean: 0.45063337683677673, gen p mean: -0.7213820219039917, mean p set: 0.4511137008666992
loss_pred:0.0311909057199955, decouple_loss:0.023764461278915405
loss_pred:0.031629886478185654, decouple_loss:0.02479167841374874
loss_pred:0.030629253014922142, decouple_loss:0.024128274992108345
2023-05-07 01:51:06 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7073766589164734, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7001593112945557, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.702227771282196, mean p set: 0.4500633478164673
loss_pred:0.031397443264722824, decouple_loss:0.02852432057261467
loss_pred:0.030062586069107056, decouple_loss:0.0266864150762558
loss_pred:0.030466867610812187, decouple_loss:0.027268702164292336
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03201695531606674, avg_mse: 0.03795182332396507
current test mse: 0.037952
Iteration: 1051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490357041358948, gen p mean: -0.7013519406318665, mean p set: 0.4495159983634949
The modified gen p mean: 0.44992658495903015, gen p mean: -0.69757080078125, mean p set: 0.45040687918663025
loss_pred:0.031193118542432785, decouple_loss:0.027349311858415604
loss_pred:0.03035135567188263, decouple_loss:0.026242434978485107
The modified gen p mean: 0.4495774507522583, gen p mean: -0.7040426731109619, mean p set: 0.4500577449798584
loss_pred:0.02935735322535038, decouple_loss:0.02624013088643551
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 1052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44703611731529236, gen p mean: -0.6973238587379456, mean p set: 0.44751641154289246
The modified gen p mean: 0.44794782996177673, gen p mean: -0.6980335712432861, mean p set: 0.44842812418937683
The modified gen p mean: 0.4481808841228485, gen p mean: -0.7042220830917358, mean p set: 0.4486611485481262
loss_pred:0.029947753995656967, decouple_loss:0.021463872864842415
loss_pred:0.029701756313443184, decouple_loss:0.02258315496146679
loss_pred:0.03004010021686554, decouple_loss:0.021135352551937103
Iteration: 1053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446953147649765, gen p mean: -0.7142500281333923, mean p set: 0.4474334716796875
The modified gen p mean: 0.4478078782558441, gen p mean: -0.7174685597419739, mean p set: 0.4482881724834442
loss_pred:0.029738400131464005, decouple_loss:0.021829530596733093
loss_pred:0.029091032221913338, decouple_loss:0.021465959027409554
The modified gen p mean: 0.4473174214363098, gen p mean: -0.7127077579498291, mean p set: 0.4477977156639099
loss_pred:0.028791727498173714, decouple_loss:0.02103753760457039
Iteration: 1054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814741611480713, gen p mean: -0.7086424231529236, mean p set: 0.44862768054008484
The modified gen p mean: 0.44812071323394775, gen p mean: -0.7118808627128601, mean p set: 0.44860100746154785
The modified gen p mean: 0.4482124447822571, gen p mean: -0.7063993811607361, mean p set: 0.4486927390098572
loss_pred:0.029103903099894524, decouple_loss:0.02502668835222721
loss_pred:0.029634281992912292, decouple_loss:0.025821557268500328
loss_pred:0.029771748930215836, decouple_loss:0.024629736319184303
Iteration: 1055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475524127483368, gen p mean: -0.7509616017341614, mean p set: 0.4480327367782593
The modified gen p mean: 0.44684138894081116, gen p mean: -0.7478585243225098, mean p set: 0.44732168316841125
The modified gen p mean: 0.446893572807312, gen p mean: -0.7505177855491638, mean p set: 0.4473738372325897
loss_pred:0.02847795933485031, decouple_loss:0.02022874727845192
loss_pred:0.028385454788804054, decouple_loss:0.019838199019432068
loss_pred:0.02841544896364212, decouple_loss:0.01957527920603752
Iteration: 1056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737738370895386, gen p mean: -0.7330620884895325, mean p set: 0.44785767793655396
The modified gen p mean: 0.4465309977531433, gen p mean: -0.7268683314323425, mean p set: 0.4470112919807434
The modified gen p mean: 0.4466248154640198, gen p mean: -0.7233038544654846, mean p set: 0.4471050798892975
loss_pred:0.0296490378677845, decouple_loss:0.017446551471948624loss_pred:0.027040604501962662, decouple_loss:0.01801346056163311
loss_pred:0.0281941257417202, decouple_loss:0.017868975177407265
Iteration: 1057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471665024757385, gen p mean: -0.70296311378479, mean p set: 0.44764676690101624
The modified gen p mean: 0.44719362258911133, gen p mean: -0.7047122716903687, mean p set: 0.4476739168167114
The modified gen p mean: 0.4474722146987915, gen p mean: -0.7115147709846497, mean p set: 0.4479525089263916
loss_pred:0.028361400589346886, decouple_loss:0.01783420890569687
loss_pred:0.028243493288755417, decouple_loss:0.017646998167037964
loss_pred:0.028000397607684135, decouple_loss:0.018577490001916885
Iteration: 1058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753625988960266, gen p mean: -0.7241598963737488, mean p set: 0.44801655411720276
The modified gen p mean: 0.44660329818725586, gen p mean: -0.7207291722297668, mean p set: 0.44708362221717834
The modified gen p mean: 0.4466308355331421, gen p mean: -0.7221031785011292, mean p set: 0.4471111297607422
loss_pred:0.026116574183106422, decouple_loss:0.017960751429200172
loss_pred:0.027160877361893654, decouple_loss:0.018104711547493935
loss_pred:0.027444876730442047, decouple_loss:0.018696194514632225
Iteration: 1059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667771458625793, gen p mean: -0.7248824834823608, mean p set: 0.44715800881385803
The modified gen p mean: 0.4465223252773285, gen p mean: -0.7243972420692444, mean p set: 0.4470026195049286
The modified gen p mean: 0.44784802198410034, gen p mean: -0.7363262176513672, mean p set: 0.44832831621170044
loss_pred:0.02578006312251091, decouple_loss:0.016662871465086937
loss_pred:0.027528591454029083, decouple_loss:0.016406765207648277
loss_pred:0.0268561914563179, decouple_loss:0.017594516277313232
Iteration: 1060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446856826543808, gen p mean: -0.7342187166213989, mean p set: 0.4473371207714081
The modified gen p mean: 0.44840213656425476, gen p mean: -0.7275675535202026, mean p set: 0.44888240098953247
The modified gen p mean: 0.44665172696113586, gen p mean: -0.726576030254364, mean p set: 0.44713205099105835
loss_pred:0.026136133819818497, decouple_loss:0.01574525609612465
loss_pred:0.027112772688269615, decouple_loss:0.01644672453403473
loss_pred:0.02700122818350792, decouple_loss:0.015314693562686443
2023-05-07 01:55:47 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7394614815711975, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7319744229316711, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7351651191711426, mean p set: 0.4500633478164673
loss_pred:0.027931200340390205, decouple_loss:0.016848573461174965
loss_pred:0.02655533142387867, decouple_loss:0.015854746103286743
loss_pred:0.02703806199133396, decouple_loss:0.016183260828256607
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027989640831947327, avg_mse: 0.0339074470102787
current test mse: 0.033907
Iteration: 1061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482475817203522, gen p mean: -0.7373108863830566, mean p set: 0.44872787594795227
The modified gen p mean: 0.4473952651023865, gen p mean: -0.7344864010810852, mean p set: 0.4478755593299866
loss_pred:0.025970280170440674, decouple_loss:0.01565725915133953
loss_pred:0.0274566188454628, decouple_loss:0.015980957075953484
The modified gen p mean: 0.44766607880592346, gen p mean: -0.7337701320648193, mean p set: 0.44814640283584595
loss_pred:0.027161655947566032, decouple_loss:0.015404214151203632
Iteration: 1062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471932649612427, gen p mean: -0.7189778685569763, mean p set: 0.4476735293865204
The modified gen p mean: 0.4487560987472534, gen p mean: -0.72425776720047, mean p set: 0.44923636317253113
loss_pred:0.027207933366298676, decouple_loss:0.014745635911822319
loss_pred:0.02640099823474884, decouple_loss:0.015147688798606396
The modified gen p mean: 0.4466235935688019, gen p mean: -0.7195314168930054, mean p set: 0.4471038579940796
loss_pred:0.028434645384550095, decouple_loss:0.015056519769132137
Iteration: 1063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669535756111145, gen p mean: -0.6942356824874878, mean p set: 0.44717565178871155
The modified gen p mean: 0.4480387568473816, gen p mean: -0.7031979560852051, mean p set: 0.4485190510749817
The modified gen p mean: 0.44769904017448425, gen p mean: -0.6989630460739136, mean p set: 0.44817930459976196
loss_pred:0.027488522231578827, decouple_loss:0.014428043738007545
loss_pred:0.0274692140519619, decouple_loss:0.014649211429059505
loss_pred:0.02682637609541416, decouple_loss:0.014369606040418148
Iteration: 1064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472036361694336, gen p mean: -0.6901645064353943, mean p set: 0.4476839005947113
The modified gen p mean: 0.44715994596481323, gen p mean: -0.685259997844696, mean p set: 0.44764021039009094
loss_pred:0.025264335796236992, decouple_loss:0.01390933245420456
loss_pred:0.02745126001536846, decouple_loss:0.013687721453607082
The modified gen p mean: 0.4470263123512268, gen p mean: -0.6916773915290833, mean p set: 0.4475066065788269
loss_pred:0.024900253862142563, decouple_loss:0.013750571757555008
Iteration: 1065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464047849178314, gen p mean: -0.6941424012184143, mean p set: 0.44688504934310913
The modified gen p mean: 0.4472768306732178, gen p mean: -0.6878286004066467, mean p set: 0.4477570950984955
The modified gen p mean: 0.4474543035030365, gen p mean: -0.693731427192688, mean p set: 0.447934627532959
loss_pred:0.025901198387145996, decouple_loss:0.013090505264699459
loss_pred:0.026256484910845757, decouple_loss:0.013379004783928394
loss_pred:0.02697555534541607, decouple_loss:0.01313802134245634
Iteration: 1066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481477439403534, gen p mean: -0.7212966680526733, mean p set: 0.4486280083656311
The modified gen p mean: 0.447307288646698, gen p mean: -0.7184220552444458, mean p set: 0.4477875828742981
The modified gen p mean: 0.44695714116096497, gen p mean: -0.7030801177024841, mean p set: 0.44743743538856506
loss_pred:0.025729985907673836, decouple_loss:0.012880764901638031
loss_pred:0.026173893362283707, decouple_loss:0.012538116425275803
loss_pred:0.0263411533087492, decouple_loss:0.01313002035021782
Iteration: 1067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738903641700745, gen p mean: -0.721412718296051, mean p set: 0.44786933064460754
The modified gen p mean: 0.44614535570144653, gen p mean: -0.7169030904769897, mean p set: 0.44662564992904663
The modified gen p mean: 0.4467073678970337, gen p mean: -0.7249917984008789, mean p set: 0.4471876323223114
loss_pred:0.02620975859463215, decouple_loss:0.012137942016124725
loss_pred:0.02659478969871998, decouple_loss:0.011974136345088482
loss_pred:0.026352280750870705, decouple_loss:0.012149127200245857
Iteration: 1068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691500067710876, gen p mean: -0.7174794673919678, mean p set: 0.44739529490470886
The modified gen p mean: 0.4469364583492279, gen p mean: -0.7210274934768677, mean p set: 0.447416752576828
The modified gen p mean: 0.4472956657409668, gen p mean: -0.722461462020874, mean p set: 0.4477759599685669
loss_pred:0.025772711262106895, decouple_loss:0.011966260150074959loss_pred:0.02493670955300331, decouple_loss:0.012029401026666164
loss_pred:0.02622779831290245, decouple_loss:0.01255697663873434
Iteration: 1069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447295606136322, gen p mean: -0.7109017372131348, mean p set: 0.4477759003639221
The modified gen p mean: 0.4471668004989624, gen p mean: -0.7227308750152588, mean p set: 0.4476470947265625
The modified gen p mean: 0.44717469811439514, gen p mean: -0.7213417887687683, mean p set: 0.44765499234199524
loss_pred:0.025812530890107155, decouple_loss:0.011669022962450981
loss_pred:0.025450823828577995, decouple_loss:0.011723794974386692
loss_pred:0.02593730017542839, decouple_loss:0.011917604133486748
Iteration: 1070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609716534614563, gen p mean: -0.7218947410583496, mean p set: 0.4465774595737457
The modified gen p mean: 0.4463751018047333, gen p mean: -0.7173948884010315, mean p set: 0.4468553960323334
The modified gen p mean: 0.4467913806438446, gen p mean: -0.7214589715003967, mean p set: 0.4472716748714447
loss_pred:0.026306135579943657, decouple_loss:0.010843192227184772
loss_pred:0.025533359497785568, decouple_loss:0.01087306346744299
loss_pred:0.026350682601332664, decouple_loss:0.011351601220667362
2023-05-07 01:59:23 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7244375348091125, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7150022983551025, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7189109325408936, mean p set: 0.4500633478164673
loss_pred:0.02654266357421875, decouple_loss:0.011730227619409561
loss_pred:0.025330541655421257, decouple_loss:0.010746456682682037
loss_pred:0.025525124743580818, decouple_loss:0.011189131997525692
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026360539719462395, avg_mse: 0.032336533069610596
current test mse: 0.032337
Iteration: 1071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720712304115295, gen p mean: -0.7167398929595947, mean p set: 0.44768741726875305
The modified gen p mean: 0.4460698366165161, gen p mean: -0.7015147805213928, mean p set: 0.4465501010417938
loss_pred:0.025158347561955452, decouple_loss:0.010453170165419579
loss_pred:0.02551492303609848, decouple_loss:0.010546633042395115
The modified gen p mean: 0.4482123553752899, gen p mean: -0.7123818397521973, mean p set: 0.44869264960289
loss_pred:0.02551385574042797, decouple_loss:0.010519732721149921
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
NaN value num: 0
Iteration: 1072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487875998020172, gen p mean: -0.7156354784965515, mean p set: 0.4492678940296173
The modified gen p mean: 0.4508250951766968, gen p mean: -0.7215157151222229, mean p set: 0.4513053894042969
The modified gen p mean: 0.449104905128479, gen p mean: -0.7101311087608337, mean p set: 0.4495851993560791
loss_pred:0.025459520518779755, decouple_loss:0.011461117304861546
loss_pred:0.026263538748025894, decouple_loss:0.010511181317269802
loss_pred:0.026181144639849663, decouple_loss:0.010811715386807919
Iteration: 1073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45150989294052124, gen p mean: -0.7262430191040039, mean p set: 0.45199018716812134
The modified gen p mean: 0.45091378688812256, gen p mean: -0.7251129150390625, mean p set: 0.45139408111572266
The modified gen p mean: 0.45126527547836304, gen p mean: -0.7228648066520691, mean p set: 0.45174556970596313
loss_pred:0.025614432990550995, decouple_loss:0.01058967038989067
loss_pred:0.026192190125584602, decouple_loss:0.010631841607391834
loss_pred:0.02658514305949211, decouple_loss:0.010236243717372417
Iteration: 1074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45093023777008057, gen p mean: -0.7150395512580872, mean p set: 0.45141053199768066
The modified gen p mean: 0.4503456652164459, gen p mean: -0.7326386570930481, mean p set: 0.4508259892463684
The modified gen p mean: 0.4501121938228607, gen p mean: -0.7332198619842529, mean p set: 0.4505924582481384
loss_pred:0.0249767005443573, decouple_loss:0.010770467109978199
loss_pred:0.02711164578795433, decouple_loss:0.010589171200990677
loss_pred:0.025264598429203033, decouple_loss:0.010628034360706806
Iteration: 1075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503021836280823, gen p mean: -0.7240263819694519, mean p set: 0.45078244805336
The modified gen p mean: 0.44879791140556335, gen p mean: -0.7255032658576965, mean p set: 0.44927823543548584
The modified gen p mean: 0.4515972435474396, gen p mean: -0.7245628237724304, mean p set: 0.4520775377750397
loss_pred:0.025699535384774208, decouple_loss:0.010554834268987179
loss_pred:0.026301465928554535, decouple_loss:0.010181515477597713
loss_pred:0.025045031681656837, decouple_loss:0.010571829974651337
Iteration: 1076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080429315567017, gen p mean: -0.7078306674957275, mean p set: 0.45128458738327026
The modified gen p mean: 0.45170944929122925, gen p mean: -0.7165301442146301, mean p set: 0.45218974351882935
The modified gen p mean: 0.45217272639274597, gen p mean: -0.7147698402404785, mean p set: 0.45265302062034607
loss_pred:0.02582593262195587, decouple_loss:0.00966763123869896loss_pred:0.026810338720679283, decouple_loss:0.009577780961990356
loss_pred:0.024918625131249428, decouple_loss:0.010265755467116833
Iteration: 1077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497884511947632, gen p mean: -0.7244236469268799, mean p set: 0.4502687156200409
The modified gen p mean: 0.4503123164176941, gen p mean: -0.7142453789710999, mean p set: 0.4507925808429718
The modified gen p mean: 0.4506233036518097, gen p mean: -0.7122785449028015, mean p set: 0.4511035680770874
loss_pred:0.024735448881983757, decouple_loss:0.009533935226500034
loss_pred:0.025170156732201576, decouple_loss:0.009768076241016388
loss_pred:0.026129381731152534, decouple_loss:0.009452554397284985
Iteration: 1078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505714178085327, gen p mean: -0.7298665642738342, mean p set: 0.4510516822338104
The modified gen p mean: 0.45181918144226074, gen p mean: -0.7311327457427979, mean p set: 0.45229944586753845
The modified gen p mean: 0.4498886168003082, gen p mean: -0.71638423204422, mean p set: 0.4503689110279083
loss_pred:0.024737227708101273, decouple_loss:0.00880405679345131
loss_pred:0.025134820491075516, decouple_loss:0.008790746331214905
loss_pred:0.025985609740018845, decouple_loss:0.008894351311028004
Iteration: 1079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45160576701164246, gen p mean: -0.7315395474433899, mean p set: 0.45208606123924255
The modified gen p mean: 0.4508654475212097, gen p mean: -0.727629542350769, mean p set: 0.4513457417488098
The modified gen p mean: 0.450674831867218, gen p mean: -0.7309439182281494, mean p set: 0.4511551260948181
loss_pred:0.025880837813019753, decouple_loss:0.009146705269813538
loss_pred:0.0267401784658432, decouple_loss:0.008518883027136326
loss_pred:0.02716291882097721, decouple_loss:0.008362975902855396
Iteration: 1080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45211341977119446, gen p mean: -0.7261150479316711, mean p set: 0.45259371399879456
The modified gen p mean: 0.4505902826786041, gen p mean: -0.7289735078811646, mean p set: 0.4510705769062042
The modified gen p mean: 0.45182347297668457, gen p mean: -0.7290465831756592, mean p set: 0.4523037374019623
loss_pred:0.024741677567362785, decouple_loss:0.009115510620176792
loss_pred:0.025070877745747566, decouple_loss:0.00863033626228571
loss_pred:0.02533591352403164, decouple_loss:0.008633282035589218
2023-05-07 02:03:39 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7328758239746094, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7224276661872864, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7267059087753296, mean p set: 0.4500633478164673
loss_pred:0.026390207931399345, decouple_loss:0.009471654891967773
loss_pred:0.025139492005109787, decouple_loss:0.00887165404856205
loss_pred:0.02544458955526352, decouple_loss:0.009198149666190147
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026117121800780296, avg_mse: 0.032512981444597244
current test mse: 0.032513
Iteration: 1081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451200932264328, gen p mean: -0.7188036441802979, mean p set: 0.4516811966896057
The modified gen p mean: 0.45087429881095886, gen p mean: -0.7335782647132874, mean p set: 0.45135459303855896
loss_pred:0.025133922696113586, decouple_loss:0.008605343289673328
loss_pred:0.02417231723666191, decouple_loss:0.008417018689215183
The modified gen p mean: 0.4500940144062042, gen p mean: -0.7305790185928345, mean p set: 0.4505743086338043
loss_pred:0.02568097785115242, decouple_loss:0.008524978533387184
Iteration: 1082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510484039783478, gen p mean: -0.7319668531417847, mean p set: 0.45152872800827026
The modified gen p mean: 0.4505552053451538, gen p mean: -0.7221670746803284, mean p set: 0.4510355293750763
The modified gen p mean: 0.45035359263420105, gen p mean: -0.7324780225753784, mean p set: 0.45083388686180115
loss_pred:0.024990445002913475, decouple_loss:0.008413654752075672
loss_pred:0.02482307143509388, decouple_loss:0.008255207911133766
loss_pred:0.025723353028297424, decouple_loss:0.008447421714663506
Iteration: 1083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45102566480636597, gen p mean: -0.7372661828994751, mean p set: 0.45150595903396606
The modified gen p mean: 0.45143741369247437, gen p mean: -0.7231587171554565, mean p set: 0.4519176781177521
The modified gen p mean: 0.45113709568977356, gen p mean: -0.7226933240890503, mean p set: 0.45161738991737366
loss_pred:0.02496371790766716, decouple_loss:0.008042092435061932
loss_pred:0.025388043373823166, decouple_loss:0.007904183119535446
loss_pred:0.024539723992347717, decouple_loss:0.008153274655342102
Iteration: 1084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512858986854553, gen p mean: -0.719637393951416, mean p set: 0.45176616311073303
The modified gen p mean: 0.4498027265071869, gen p mean: -0.7305226922035217, mean p set: 0.450283020734787
The modified gen p mean: 0.4508441686630249, gen p mean: -0.7194452881813049, mean p set: 0.4513244926929474
loss_pred:0.025613630190491676, decouple_loss:0.007956299930810928
loss_pred:0.024483708664774895, decouple_loss:0.00797082670032978
loss_pred:0.025925010442733765, decouple_loss:0.008130457252264023
Iteration: 1085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45252037048339844, gen p mean: -0.7360733151435852, mean p set: 0.45300063490867615
The modified gen p mean: 0.45070645213127136, gen p mean: -0.7368612885475159, mean p set: 0.4511867165565491
The modified gen p mean: 0.4508184790611267, gen p mean: -0.7286418080329895, mean p set: 0.4512987732887268
loss_pred:0.02389143407344818, decouple_loss:0.008002717047929764
loss_pred:0.02633841708302498, decouple_loss:0.00794919766485691
loss_pred:0.024788297712802887, decouple_loss:0.007573556154966354
Iteration: 1086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511512517929077, gen p mean: -0.7343738675117493, mean p set: 0.4516315758228302
The modified gen p mean: 0.450673371553421, gen p mean: -0.7401220798492432, mean p set: 0.4511536657810211
The modified gen p mean: 0.45096102356910706, gen p mean: -0.738791823387146, mean p set: 0.45144134759902954
loss_pred:0.02542084828019142, decouple_loss:0.007544798776507378
loss_pred:0.02451661042869091, decouple_loss:0.00744861364364624
loss_pred:0.025066480040550232, decouple_loss:0.00771772675216198
Iteration: 1087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501175582408905, gen p mean: -0.7388923168182373, mean p set: 0.4505978226661682
The modified gen p mean: 0.4503062665462494, gen p mean: -0.7450633645057678, mean p set: 0.4507865309715271
The modified gen p mean: 0.4504936635494232, gen p mean: -0.7442972660064697, mean p set: 0.4509739875793457
loss_pred:0.024182047694921494, decouple_loss:0.0074890656396746635loss_pred:0.024493485689163208, decouple_loss:0.007602371741086245
loss_pred:0.025261061266064644, decouple_loss:0.007766354829072952
Iteration: 1088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503532350063324, gen p mean: -0.7435550093650818, mean p set: 0.4508335292339325
The modified gen p mean: 0.4508809447288513, gen p mean: -0.7374019026756287, mean p set: 0.4513612687587738
The modified gen p mean: 0.450095534324646, gen p mean: -0.7511351108551025, mean p set: 0.4505757987499237
loss_pred:0.024930881336331367, decouple_loss:0.007997483015060425loss_pred:0.02503209002315998, decouple_loss:0.007583430036902428
loss_pred:0.024483053013682365, decouple_loss:0.007870991714298725
Iteration: 1089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45091620087623596, gen p mean: -0.7330682277679443, mean p set: 0.45139649510383606
The modified gen p mean: 0.45136839151382446, gen p mean: -0.7362882494926453, mean p set: 0.4518486559391022
The modified gen p mean: 0.45091500878334045, gen p mean: -0.7401161789894104, mean p set: 0.45139533281326294
loss_pred:0.025963371619582176, decouple_loss:0.007419127505272627
loss_pred:0.023889364674687386, decouple_loss:0.007510403171181679
loss_pred:0.02464807592332363, decouple_loss:0.007526810746639967
Iteration: 1090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503781795501709, gen p mean: -0.7350088953971863, mean p set: 0.450858473777771
The modified gen p mean: 0.45015034079551697, gen p mean: -0.728227972984314, mean p set: 0.45063063502311707
The modified gen p mean: 0.45000413060188293, gen p mean: -0.7352500557899475, mean p set: 0.45048442482948303
loss_pred:0.025442402809858322, decouple_loss:0.007399071007966995
loss_pred:0.024574410170316696, decouple_loss:0.007640510331839323
loss_pred:0.02535024844110012, decouple_loss:0.0074994214810431
2023-05-07 02:07:15 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7339087724685669, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.722825288772583, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7270669341087341, mean p set: 0.4500633478164673
loss_pred:0.026170503348112106, decouple_loss:0.008150479756295681
loss_pred:0.02493232861161232, decouple_loss:0.007590987719595432
loss_pred:0.02514525130391121, decouple_loss:0.007763765752315521
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025807781144976616, avg_mse: 0.03230651840567589
current test mse: 0.032307
Iteration: 1091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504493772983551, gen p mean: -0.7259867787361145, mean p set: 0.4509296715259552
The modified gen p mean: 0.4513743817806244, gen p mean: -0.7319202423095703, mean p set: 0.4518546462059021
loss_pred:0.026531297713518143, decouple_loss:0.006973083596676588
loss_pred:0.024699807167053223, decouple_loss:0.007197404280304909
The modified gen p mean: 0.4500894844532013, gen p mean: -0.7272422909736633, mean p set: 0.4505697786808014
loss_pred:0.02647561952471733, decouple_loss:0.007082497235387564
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
NaN value num: 0
Iteration: 1092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508441388607025, gen p mean: -0.7266068458557129, mean p set: 0.4513244330883026
The modified gen p mean: 0.4507489502429962, gen p mean: -0.7209582924842834, mean p set: 0.4512292742729187
The modified gen p mean: 0.4524080455303192, gen p mean: -0.7388936281204224, mean p set: 0.4528883397579193
loss_pred:0.02613585628569126, decouple_loss:0.00778106739744544
loss_pred:0.023914065212011337, decouple_loss:0.00746327918022871
loss_pred:0.025282327085733414, decouple_loss:0.008416615426540375
Iteration: 1093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45211371779441833, gen p mean: -0.7401353120803833, mean p set: 0.4525940418243408
The modified gen p mean: 0.45347920060157776, gen p mean: -0.738311767578125, mean p set: 0.45395946502685547
The modified gen p mean: 0.45096471905708313, gen p mean: -0.7302677631378174, mean p set: 0.4514450132846832
loss_pred:0.023755650967359543, decouple_loss:0.006984144449234009
loss_pred:0.023832308128476143, decouple_loss:0.007520758081227541
loss_pred:0.024778202176094055, decouple_loss:0.007565301842987537
Iteration: 1094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498565196990967, gen p mean: -0.7423120737075806, mean p set: 0.4503368139266968
The modified gen p mean: 0.45048317313194275, gen p mean: -0.7457906007766724, mean p set: 0.45096346735954285
The modified gen p mean: 0.45276230573654175, gen p mean: -0.7382339239120483, mean p set: 0.45324259996414185
loss_pred:0.024812236428260803, decouple_loss:0.007287829183042049
loss_pred:0.02509128302335739, decouple_loss:0.0072718714363873005
loss_pred:0.02272212691605091, decouple_loss:0.007838824763894081
Iteration: 1095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45249706506729126, gen p mean: -0.7377113103866577, mean p set: 0.45297735929489136
The modified gen p mean: 0.45270633697509766, gen p mean: -0.7479877471923828, mean p set: 0.45318663120269775
The modified gen p mean: 0.45082202553749084, gen p mean: -0.7317835092544556, mean p set: 0.45130228996276855
loss_pred:0.023181598633527756, decouple_loss:0.007860166020691395
loss_pred:0.023398609831929207, decouple_loss:0.007249459158629179
loss_pred:0.023358557373285294, decouple_loss:0.007851182483136654
Iteration: 1096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522641897201538, gen p mean: -0.7418545484542847, mean p set: 0.4527444541454315
The modified gen p mean: 0.4530586898326874, gen p mean: -0.7465590238571167, mean p set: 0.4535389542579651
The modified gen p mean: 0.45180991291999817, gen p mean: -0.738765299320221, mean p set: 0.45229020714759827
loss_pred:0.024853268638253212, decouple_loss:0.007393256761133671
loss_pred:0.025576148182153702, decouple_loss:0.00718615110963583
loss_pred:0.024317370727658272, decouple_loss:0.00784616731107235
Iteration: 1097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509720802307129, gen p mean: -0.7419630289077759, mean p set: 0.451452374458313
The modified gen p mean: 0.4528239965438843, gen p mean: -0.7349874973297119, mean p set: 0.4533042907714844
The modified gen p mean: 0.4522281885147095, gen p mean: -0.7370610237121582, mean p set: 0.45270848274230957
loss_pred:0.024970469996333122, decouple_loss:0.006775243207812309
loss_pred:0.02387824095785618, decouple_loss:0.0069869281724095345
loss_pred:0.024984821677207947, decouple_loss:0.007019763812422752
Iteration: 1098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169582962989807, gen p mean: -0.7513076663017273, mean p set: 0.4521760940551758
The modified gen p mean: 0.4514199197292328, gen p mean: -0.738714873790741, mean p set: 0.4519002437591553
loss_pred:0.024720871821045876, decouple_loss:0.0071769822388887405
loss_pred:0.02333507500588894, decouple_loss:0.007145910989493132
The modified gen p mean: 0.4539802670478821, gen p mean: -0.7509968280792236, mean p set: 0.45446059107780457
loss_pred:0.02334306761622429, decouple_loss:0.007327820174396038
Iteration: 1099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539129436016083, gen p mean: -0.75666743516922, mean p set: 0.45439326763153076
The modified gen p mean: 0.4522090256214142, gen p mean: -0.7564867734909058, mean p set: 0.4526892900466919
The modified gen p mean: 0.4513746201992035, gen p mean: -0.7573020458221436, mean p set: 0.4518548846244812
loss_pred:0.024378784000873566, decouple_loss:0.006891972851008177loss_pred:0.02393987774848938, decouple_loss:0.007338885683566332
loss_pred:0.025101706385612488, decouple_loss:0.007211689837276936
Iteration: 1100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506838619709015, gen p mean: -0.7431967258453369, mean p set: 0.4511641561985016
The modified gen p mean: 0.45246726274490356, gen p mean: -0.7601283192634583, mean p set: 0.45294755697250366
The modified gen p mean: 0.4529423713684082, gen p mean: -0.7596760988235474, mean p set: 0.4534226953983307
loss_pred:0.023322971537709236, decouple_loss:0.007128051482141018
loss_pred:0.023422975093126297, decouple_loss:0.006805587559938431
loss_pred:0.023266317322850227, decouple_loss:0.0068206219002604485
2023-05-07 02:11:58 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.7615217566490173, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7488507628440857, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7537904977798462, mean p set: 0.4500633478164673
loss_pred:0.026207836344838142, decouple_loss:0.007912998087704182
loss_pred:0.024914206936955452, decouple_loss:0.007506089750677347
loss_pred:0.025081323459744453, decouple_loss:0.007685601245611906
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025786202400922775, avg_mse: 0.03229382634162903
current test mse: 0.032294
Iteration: 1101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45272040367126465, gen p mean: -0.7582168579101562, mean p set: 0.45320072770118713
The modified gen p mean: 0.4527140259742737, gen p mean: -0.7588487863540649, mean p set: 0.4531942903995514
loss_pred:0.023714227601885796, decouple_loss:0.006944078020751476loss_pred:0.023979416117072105, decouple_loss:0.007117073982954025
The modified gen p mean: 0.4522055387496948, gen p mean: -0.7537492513656616, mean p set: 0.45268580317497253
loss_pred:0.025150116533041, decouple_loss:0.00691891647875309
Iteration: 1102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513583779335022, gen p mean: -0.7583320736885071, mean p set: 0.4518386423587799
The modified gen p mean: 0.4536548852920532, gen p mean: -0.7648767232894897, mean p set: 0.4541351795196533
The modified gen p mean: 0.4521506130695343, gen p mean: -0.7610377073287964, mean p set: 0.4526309072971344
loss_pred:0.02463073655962944, decouple_loss:0.006828530691564083
loss_pred:0.023054396733641624, decouple_loss:0.006791900843381882
loss_pred:0.023952698335051537, decouple_loss:0.006689064670354128
Iteration: 1103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515138268470764, gen p mean: -0.7652709484100342, mean p set: 0.4519941210746765
The modified gen p mean: 0.4516972303390503, gen p mean: -0.7616163492202759, mean p set: 0.4521775543689728
The modified gen p mean: 0.45221826434135437, gen p mean: -0.7664786577224731, mean p set: 0.45269855856895447
loss_pred:0.023869415745139122, decouple_loss:0.006416921503841877
loss_pred:0.024517284706234932, decouple_loss:0.006419729441404343
loss_pred:0.023081069812178612, decouple_loss:0.006509837694466114
Iteration: 1104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45132583379745483, gen p mean: -0.7613189816474915, mean p set: 0.45180612802505493
The modified gen p mean: 0.4522453546524048, gen p mean: -0.7684648036956787, mean p set: 0.4527256488800049
loss_pred:0.02476724609732628, decouple_loss:0.006745135877281427
loss_pred:0.023567290976643562, decouple_loss:0.006680002436041832
The modified gen p mean: 0.4511820375919342, gen p mean: -0.7578886151313782, mean p set: 0.4516623318195343
loss_pred:0.024485129863023758, decouple_loss:0.006739161442965269
Iteration: 1105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508156180381775, gen p mean: -0.7539379000663757, mean p set: 0.4512959122657776
The modified gen p mean: 0.45102402567863464, gen p mean: -0.7596011757850647, mean p set: 0.4515043795108795
The modified gen p mean: 0.45104166865348816, gen p mean: -0.7594894170761108, mean p set: 0.45152196288108826
loss_pred:0.023078065365552902, decouple_loss:0.00675353966653347
loss_pred:0.024481946602463722, decouple_loss:0.00704280287027359
loss_pred:0.024289702996611595, decouple_loss:0.007045958656817675
Iteration: 1106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4543343782424927, gen p mean: -0.7582184672355652, mean p set: 0.4548146724700928
The modified gen p mean: 0.4510827362537384, gen p mean: -0.7566126585006714, mean p set: 0.4515630006790161
The modified gen p mean: 0.45056912302970886, gen p mean: -0.7409945130348206, mean p set: 0.4510493874549866
loss_pred:0.023275256156921387, decouple_loss:0.006989635992795229
loss_pred:0.024958061054348946, decouple_loss:0.006454443093389273
loss_pred:0.025954969227313995, decouple_loss:0.006478871218860149
Iteration: 1107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521689713001251, gen p mean: -0.7538093328475952, mean p set: 0.45264923572540283
The modified gen p mean: 0.4528367221355438, gen p mean: -0.7534003257751465, mean p set: 0.4533170461654663
The modified gen p mean: 0.45134875178337097, gen p mean: -0.7408065795898438, mean p set: 0.45182904601097107
loss_pred:0.02333371527493, decouple_loss:0.0066240327432751656
loss_pred:0.023010173812508583, decouple_loss:0.006755156442523003
loss_pred:0.02522219717502594, decouple_loss:0.006750020198523998
Iteration: 1108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511546194553375, gen p mean: -0.7432674169540405, mean p set: 0.4516349136829376
The modified gen p mean: 0.45097970962524414, gen p mean: -0.727487325668335, mean p set: 0.45146000385284424
loss_pred:0.024568907916545868, decouple_loss:0.006527566350996494
loss_pred:0.023398716002702713, decouple_loss:0.006877218373119831
The modified gen p mean: 0.45233041048049927, gen p mean: -0.7391552925109863, mean p set: 0.45281070470809937
loss_pred:0.024095676839351654, decouple_loss:0.00666849734261632
Iteration: 1109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527190923690796, gen p mean: -0.7357808947563171, mean p set: 0.4531993865966797
The modified gen p mean: 0.45227065682411194, gen p mean: -0.7237706184387207, mean p set: 0.45275095105171204
The modified gen p mean: 0.4508700370788574, gen p mean: -0.7296789884567261, mean p set: 0.4513503611087799
loss_pred:0.022842882201075554, decouple_loss:0.006169591099023819
loss_pred:0.022537432610988617, decouple_loss:0.006357540842145681
loss_pred:0.02472347393631935, decouple_loss:0.006184813100844622
Iteration: 1110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513101875782013, gen p mean: -0.7234049439430237, mean p set: 0.4517904222011566
The modified gen p mean: 0.4520118534564972, gen p mean: -0.7362231016159058, mean p set: 0.4524921178817749
The modified gen p mean: 0.45271334052085876, gen p mean: -0.7252114415168762, mean p set: 0.45319366455078125
loss_pred:0.02548825554549694, decouple_loss:0.00639286870136857
loss_pred:0.023224666714668274, decouple_loss:0.006060673855245113
loss_pred:0.02217969484627247, decouple_loss:0.005997896660119295
2023-05-07 02:15:36 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7467632293701172, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7344340085983276, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7390906810760498, mean p set: 0.4500633478164673
loss_pred:0.026387959718704224, decouple_loss:0.0072747813537716866
loss_pred:0.024955378845334053, decouple_loss:0.006892061792314053
loss_pred:0.025091640651226044, decouple_loss:0.006868293508887291
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025828910991549492, avg_mse: 0.03256697952747345
current test mse: 0.032567
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
NaN value num: 0
Iteration: 1111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451339989900589, gen p mean: -0.7513721585273743, mean p set: 0.4518203139305115
The modified gen p mean: 0.45095574855804443, gen p mean: -0.7488754391670227, mean p set: 0.45143604278564453
loss_pred:0.025882115587592125, decouple_loss:0.006853203754872084
loss_pred:0.02447844110429287, decouple_loss:0.0064422874711453915
The modified gen p mean: 0.4517925977706909, gen p mean: -0.7518746852874756, mean p set: 0.45227286219596863
loss_pred:0.024542784318327904, decouple_loss:0.007247988600283861
Iteration: 1112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516639709472656, gen p mean: -0.7418897151947021, mean p set: 0.4521442651748657
The modified gen p mean: 0.450985848903656, gen p mean: -0.7499464750289917, mean p set: 0.4514661431312561
loss_pred:0.023991737514734268, decouple_loss:0.006463996134698391
loss_pred:0.024373667314648628, decouple_loss:0.006664926186203957
The modified gen p mean: 0.451517254114151, gen p mean: -0.7491306066513062, mean p set: 0.4519975483417511
loss_pred:0.023916302248835564, decouple_loss:0.006176351569592953
Iteration: 1113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518463611602783, gen p mean: -0.7606392502784729, mean p set: 0.4523266553878784
The modified gen p mean: 0.4513707756996155, gen p mean: -0.7637931108474731, mean p set: 0.4518510699272156
The modified gen p mean: 0.4514321982860565, gen p mean: -0.7649285793304443, mean p set: 0.4519124925136566
loss_pred:0.025137197226285934, decouple_loss:0.00676752207800746
loss_pred:0.025124359875917435, decouple_loss:0.006595241837203503
loss_pred:0.02569546177983284, decouple_loss:0.0066607119515538216
Iteration: 1114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517442584037781, gen p mean: -0.7618405818939209, mean p set: 0.4522245526313782
The modified gen p mean: 0.45329049229621887, gen p mean: -0.7678268551826477, mean p set: 0.45377078652381897
loss_pred:0.023711295798420906, decouple_loss:0.0066275750286877155
loss_pred:0.023713482543826103, decouple_loss:0.0063572293147444725
The modified gen p mean: 0.45147356390953064, gen p mean: -0.7609069347381592, mean p set: 0.45195385813713074
loss_pred:0.025452744215726852, decouple_loss:0.006413932889699936
Iteration: 1115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496181607246399, gen p mean: -0.743680477142334, mean p set: 0.4500984251499176
The modified gen p mean: 0.4520858824253082, gen p mean: -0.753287672996521, mean p set: 0.4525661766529083
The modified gen p mean: 0.45396310091018677, gen p mean: -0.761975109577179, mean p set: 0.4544433653354645
loss_pred:0.02421976998448372, decouple_loss:0.006649427115917206
loss_pred:0.0243446733802557, decouple_loss:0.006841582246124744
loss_pred:0.02554410509765148, decouple_loss:0.006590003613382578
Iteration: 1116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453398197889328, gen p mean: -0.7727554440498352, mean p set: 0.4538784623146057
The modified gen p mean: 0.45302069187164307, gen p mean: -0.7736440896987915, mean p set: 0.45350101590156555
loss_pred:0.023688994348049164, decouple_loss:0.006133522372692823
loss_pred:0.02475007064640522, decouple_loss:0.006048520561307669
The modified gen p mean: 0.4507720172405243, gen p mean: -0.7524062991142273, mean p set: 0.4512523412704468
loss_pred:0.024714941158890724, decouple_loss:0.00634489580988884
Iteration: 1117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45183253288269043, gen p mean: -0.7705541253089905, mean p set: 0.4523128271102905
The modified gen p mean: 0.4514986574649811, gen p mean: -0.7741010189056396, mean p set: 0.4519789516925812
The modified gen p mean: 0.4520367980003357, gen p mean: -0.7715867757797241, mean p set: 0.4525170624256134
loss_pred:0.024535803124308586, decouple_loss:0.00605225283652544
loss_pred:0.02492235042154789, decouple_loss:0.00620481139048934
loss_pred:0.024143964052200317, decouple_loss:0.00617508077993989
Iteration: 1118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501592516899109, gen p mean: -0.7640134692192078, mean p set: 0.4506395757198334
The modified gen p mean: 0.4527859687805176, gen p mean: -0.7705976963043213, mean p set: 0.4532662332057953
The modified gen p mean: 0.45122531056404114, gen p mean: -0.7691877484321594, mean p set: 0.45170560479164124
loss_pred:0.024292733520269394, decouple_loss:0.005972051061689854loss_pred:0.02410871535539627, decouple_loss:0.005914916750043631
loss_pred:0.023915421217679977, decouple_loss:0.006137068383395672
Iteration: 1119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505755603313446, gen p mean: -0.7619597911834717, mean p set: 0.4510558545589447
The modified gen p mean: 0.44897574186325073, gen p mean: -0.7527535557746887, mean p set: 0.44945603609085083
The modified gen p mean: 0.44998785853385925, gen p mean: -0.7496321201324463, mean p set: 0.45046815276145935
loss_pred:0.024979161098599434, decouple_loss:0.006053604651242495
loss_pred:0.02338738739490509, decouple_loss:0.006351548712700605
loss_pred:0.023613842204213142, decouple_loss:0.0063126361928880215
Iteration: 1120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510898292064667, gen p mean: -0.7668859958648682, mean p set: 0.4515700936317444
The modified gen p mean: 0.4512402415275574, gen p mean: -0.7702670693397522, mean p set: 0.4517205059528351
The modified gen p mean: 0.45124655961990356, gen p mean: -0.7669855952262878, mean p set: 0.45172688364982605
loss_pred:0.02508486434817314, decouple_loss:0.006516797933727503loss_pred:0.023703215643763542, decouple_loss:0.006173828616738319
loss_pred:0.025391360744833946, decouple_loss:0.006437697447836399
2023-05-07 02:20:11 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7685554623603821, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7547035813331604, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7598251104354858, mean p set: 0.4500633478164673
loss_pred:0.026016179472208023, decouple_loss:0.007145127281546593
loss_pred:0.024603387340903282, decouple_loss:0.006969856098294258
loss_pred:0.024892322719097137, decouple_loss:0.006903022062033415
WV_0_PC_1_EH_0_PS_40_6, loss: 0.0255209319293499, avg_mse: 0.03208870440721512
current test mse: 0.032089
Iteration: 1121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511350989341736, gen p mean: -0.7763439416885376, mean p set: 0.4516153931617737
The modified gen p mean: 0.4496695399284363, gen p mean: -0.7609083652496338, mean p set: 0.4501498341560364
loss_pred:0.024479076266288757, decouple_loss:0.006343240384012461loss_pred:0.023988690227270126, decouple_loss:0.005825222469866276
The modified gen p mean: 0.4506036341190338, gen p mean: -0.7535896897315979, mean p set: 0.4510838985443115
loss_pred:0.024457359686493874, decouple_loss:0.006069628521800041
Iteration: 1122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452846497297287, gen p mean: -0.7751758694648743, mean p set: 0.4533267617225647
The modified gen p mean: 0.4519600570201874, gen p mean: -0.7703614234924316, mean p set: 0.4524403214454651
The modified gen p mean: 0.4505375027656555, gen p mean: -0.7619098424911499, mean p set: 0.451017826795578
loss_pred:0.02393973059952259, decouple_loss:0.005945589393377304
loss_pred:0.023953266441822052, decouple_loss:0.0059324693866074085
loss_pred:0.023514028638601303, decouple_loss:0.005995629355311394
Iteration: 1123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451686829328537, gen p mean: -0.7738115787506104, mean p set: 0.4521671235561371
The modified gen p mean: 0.4513089954853058, gen p mean: -0.761077344417572, mean p set: 0.4517892897129059
The modified gen p mean: 0.4525426924228668, gen p mean: -0.7599400281906128, mean p set: 0.4530230164527893
loss_pred:0.02391553670167923, decouple_loss:0.00596842123195529loss_pred:0.02360176481306553, decouple_loss:0.005837096832692623
loss_pred:0.02397969551384449, decouple_loss:0.005880175624042749
Iteration: 1124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169639587402344, gen p mean: -0.7820138335227966, mean p set: 0.45217666029930115
The modified gen p mean: 0.4517357051372528, gen p mean: -0.7671933174133301, mean p set: 0.4522160291671753
The modified gen p mean: 0.4504085183143616, gen p mean: -0.769956111907959, mean p set: 0.45088884234428406
loss_pred:0.02354840561747551, decouple_loss:0.005959557369351387
loss_pred:0.023684877902269363, decouple_loss:0.006063263397663832
loss_pred:0.02513253502547741, decouple_loss:0.005949204321950674
Iteration: 1125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489377737045288, gen p mean: -0.7507645487785339, mean p set: 0.4494180977344513
The modified gen p mean: 0.4518813490867615, gen p mean: -0.7754828929901123, mean p set: 0.4523616135120392
The modified gen p mean: 0.4518691897392273, gen p mean: -0.7751755714416504, mean p set: 0.452349454164505
loss_pred:0.023013534024357796, decouple_loss:0.005792588926851749
loss_pred:0.024589233100414276, decouple_loss:0.006159334443509579
loss_pred:0.02354436181485653, decouple_loss:0.005939210299402475
Iteration: 1126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516017436981201, gen p mean: -0.773689866065979, mean p set: 0.4520820379257202
The modified gen p mean: 0.4501783847808838, gen p mean: -0.7594826817512512, mean p set: 0.4506586492061615
The modified gen p mean: 0.4537600576877594, gen p mean: -0.7707166075706482, mean p set: 0.4542403817176819
loss_pred:0.024512236937880516, decouple_loss:0.005567763466387987
loss_pred:0.023539355024695396, decouple_loss:0.005534050054848194
loss_pred:0.024045206606388092, decouple_loss:0.005732465069741011
Iteration: 1127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519064426422119, gen p mean: -0.7732725739479065, mean p set: 0.452386736869812
The modified gen p mean: 0.4525480270385742, gen p mean: -0.7611973881721497, mean p set: 0.4530283212661743
The modified gen p mean: 0.4516013264656067, gen p mean: -0.7789686918258667, mean p set: 0.4520816504955292
loss_pred:0.024943316355347633, decouple_loss:0.005593958776444197
loss_pred:0.024073323234915733, decouple_loss:0.00584974093362689
loss_pred:0.024500370025634766, decouple_loss:0.005738966166973114
Iteration: 1128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45202934741973877, gen p mean: -0.7721675634384155, mean p set: 0.4525096118450165
The modified gen p mean: 0.44999122619628906, gen p mean: -0.7621714472770691, mean p set: 0.45047152042388916
The modified gen p mean: 0.4511801600456238, gen p mean: -0.759933590888977, mean p set: 0.4516604542732239
loss_pred:0.02368253283202648, decouple_loss:0.005841515492647886
loss_pred:0.023119132965803146, decouple_loss:0.00575633067637682
loss_pred:0.02361212484538555, decouple_loss:0.005858664866536856
Iteration: 1129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082801580429077, gen p mean: -0.779396653175354, mean p set: 0.45130833983421326
The modified gen p mean: 0.4508105218410492, gen p mean: -0.7625038027763367, mean p set: 0.4512908160686493
The modified gen p mean: 0.45270371437072754, gen p mean: -0.7735399603843689, mean p set: 0.45318397879600525
loss_pred:0.024478062987327576, decouple_loss:0.005933295004069805
loss_pred:0.02331668511033058, decouple_loss:0.005880865268409252
loss_pred:0.02439546026289463, decouple_loss:0.005636337213218212
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
NaN value num: 0
Iteration: 1130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479368031024933, gen p mean: -0.7788454294204712, mean p set: 0.4484170973300934
The modified gen p mean: 0.4490582346916199, gen p mean: -0.7632004618644714, mean p set: 0.44953852891921997
The modified gen p mean: 0.44971132278442383, gen p mean: -0.7647160887718201, mean p set: 0.4501916468143463
loss_pred:0.026932653039693832, decouple_loss:0.006283804774284363
loss_pred:0.02704535610973835, decouple_loss:0.006840467918664217
