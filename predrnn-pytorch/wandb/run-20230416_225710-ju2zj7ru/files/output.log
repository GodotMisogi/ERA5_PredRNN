After initialize model, args.img_channel:3
load model: /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_1_PS_40/model_2000.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
train_data_files nums: 41
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44735440611839294, mean_press_set: 0.4473542869091034
loss_pred:0.02130604349076748, decouple_loss:0.009900759905576706
The generated pressure mean: 0.4473342001438141, mean_press_set: 0.4473342299461365
loss_pred:0.022855063900351524, decouple_loss:0.010112414136528969
The generated pressure mean: 0.4481063783168793, mean_press_set: 0.4481063485145569
loss_pred:0.022422535344958305, decouple_loss:0.010396496392786503
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44702813029289246, mean_press_set: 0.4470282196998596
loss_pred:0.23136457800865173, decouple_loss:0.43128499388694763
The generated pressure mean: 0.4489402770996094, mean_press_set: 0.448940247297287
The generated pressure mean: 0.4480895400047302, mean_press_set: 0.4480895698070526
loss_pred:0.24726666510105133, decouple_loss:0.42951735854148865
loss_pred:0.2490600198507309, decouple_loss:0.4336393475532532
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44924819469451904, mean_press_set: 0.44924822449684143
loss_pred:0.1398889124393463, decouple_loss:0.619836688041687
The generated pressure mean: 0.4476828873157501, mean_press_set: 0.4476828873157501
loss_pred:0.13268163800239563, decouple_loss:0.6170574426651001
The generated pressure mean: 0.44913285970687866, mean_press_set: 0.44913291931152344
loss_pred:0.143131822347641, decouple_loss:0.6360771656036377
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479072391986847, mean_press_set: 0.4479072690010071
loss_pred:0.07543160766363144, decouple_loss:0.5066633224487305
The generated pressure mean: 0.44800058007240295, mean_press_set: 0.44800058007240295
The generated pressure mean: 0.44862261414527893, mean_press_set: 0.44862261414527893
loss_pred:0.07104693353176117, decouple_loss:0.5085435509681702
loss_pred:0.07312317192554474, decouple_loss:0.5038134455680847
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482133388519287, mean_press_set: 0.4482133686542511
loss_pred:0.06575389206409454, decouple_loss:0.38876107335090637
The generated pressure mean: 0.4476650059223175, mean_press_set: 0.4476650059223175
The generated pressure mean: 0.44821634888648987, mean_press_set: 0.44821637868881226
loss_pred:0.06876486539840698, decouple_loss:0.38839009404182434
loss_pred:0.06623837351799011, decouple_loss:0.38604146242141724
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468633532524109, mean_press_set: 0.4468632936477661
The generated pressure mean: 0.44727247953414917, mean_press_set: 0.44727250933647156
The generated pressure mean: 0.4461095929145813, mean_press_set: 0.4461096227169037
loss_pred:0.06864067912101746, decouple_loss:0.36223194003105164
loss_pred:0.06328374147415161, decouple_loss:0.3614107072353363
loss_pred:0.06527557969093323, decouple_loss:0.3623476028442383
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448183536529541, mean_press_set: 0.4481835961341858
loss_pred:0.060213807970285416, decouple_loss:0.29648303985595703
The generated pressure mean: 0.44795477390289307, mean_press_set: 0.4479547441005707
The generated pressure mean: 0.44676434993743896, mean_press_set: 0.44676437973976135
loss_pred:0.057263195514678955, decouple_loss:0.2942570745944977
loss_pred:0.06213840842247009, decouple_loss:0.2923753261566162
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44792136549949646, mean_press_set: 0.4479212760925293
loss_pred:0.04907587915658951, decouple_loss:0.2776246964931488
The generated pressure mean: 0.44645851850509644, mean_press_set: 0.44645851850509644
The generated pressure mean: 0.44837841391563416, mean_press_set: 0.44837847352027893
loss_pred:0.04666181653738022, decouple_loss:0.2751607894897461
loss_pred:0.046795979142189026, decouple_loss:0.27700063586235046
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44886937737464905, mean_press_set: 0.44886934757232666
The generated pressure mean: 0.4491707384586334, mean_press_set: 0.44917070865631104
The generated pressure mean: 0.44937044382095337, mean_press_set: 0.44937047362327576
loss_pred:0.04545837268233299, decouple_loss:0.26795846223831177
loss_pred:0.04616102576255798, decouple_loss:0.27019596099853516
loss_pred:0.04898354038596153, decouple_loss:0.268234521150589
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486011862754822, mean_press_set: 0.44860121607780457
loss_pred:0.04379758983850479, decouple_loss:0.23066893219947815
The generated pressure mean: 0.4477669298648834, mean_press_set: 0.4477669298648834
The generated pressure mean: 0.4489777088165283, mean_press_set: 0.44897761940956116
loss_pred:0.04536210000514984, decouple_loss:0.2306227684020996
loss_pred:0.04301204904913902, decouple_loss:0.2289145439863205
2023-04-16 23:00:30 testing...
The generated pressure mean: 0.4502691626548767, mean_press_set: 0.4502691626548767
The generated pressure mean: 0.45035699009895325, mean_press_set: 0.45035696029663086
The generated pressure mean: 0.4500633478164673, mean_press_set: 0.4500633478164673
loss_pred:0.11695864051580429, decouple_loss:0.20450609922409058
loss_pred:0.11616897583007812, decouple_loss:0.20512403547763824
loss_pred:0.11620808392763138, decouple_loss:0.20542655885219574
WV_0_PC_1_EH_1_PS_40, loss: 0.12669618427753448, avg_mse: 0.1858634650707245
current test mse: 0.185863
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44826528429985046, mean_press_set: 0.4482652246952057
The generated pressure mean: 0.4474402666091919, mean_press_set: 0.4474402070045471
loss_pred:0.041236620396375656, decouple_loss:0.1979101002216339
loss_pred:0.03989921882748604, decouple_loss:0.19626203179359436
The generated pressure mean: 0.4486008584499359, mean_press_set: 0.44860079884529114
loss_pred:0.03953208401799202, decouple_loss:0.19802433252334595
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483005404472351, mean_press_set: 0.4483005702495575
loss_pred:0.042327359318733215, decouple_loss:0.1754777878522873
The generated pressure mean: 0.4475172460079193, mean_press_set: 0.4475173056125641
The generated pressure mean: 0.4475002586841583, mean_press_set: 0.4475003480911255
loss_pred:0.04293833300471306, decouple_loss:0.17669223248958588
loss_pred:0.0401504784822464, decouple_loss:0.17925229668617249
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473882019519806, mean_press_set: 0.4473881721496582
loss_pred:0.03934066370129585, decouple_loss:0.16295450925827026
The generated pressure mean: 0.4481983184814453, mean_press_set: 0.4481982886791229The generated pressure mean: 0.4472595751285553, mean_press_set: 0.4472596049308777
loss_pred:0.036641236394643784, decouple_loss:0.15930795669555664
loss_pred:0.039221905171871185, decouple_loss:0.16256920993328094
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480326175689697, mean_press_set: 0.4480327069759369
loss_pred:0.0362473800778389, decouple_loss:0.1517895609140396
The generated pressure mean: 0.4469583332538605, mean_press_set: 0.44695839285850525
The generated pressure mean: 0.44865426421165466, mean_press_set: 0.4486541748046875
loss_pred:0.036751676350831985, decouple_loss:0.14857053756713867
loss_pred:0.03773142397403717, decouple_loss:0.15216779708862305
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483039677143097, mean_press_set: 0.4483039677143097
loss_pred:0.033660151064395905, decouple_loss:0.13541999459266663
The generated pressure mean: 0.4491502642631531, mean_press_set: 0.4491502642631531
The generated pressure mean: 0.4477671980857849, mean_press_set: 0.4477671980857849
loss_pred:0.036449819803237915, decouple_loss:0.14082379639148712
loss_pred:0.03478341922163963, decouple_loss:0.13720913231372833
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491216838359833, mean_press_set: 0.4491216838359833
The generated pressure mean: 0.4479711055755615, mean_press_set: 0.4479711353778839
The generated pressure mean: 0.4484961926937103, mean_press_set: 0.4484962224960327loss_pred:0.03396300971508026, decouple_loss:0.12370997667312622
loss_pred:0.03327704966068268, decouple_loss:0.12111620604991913
loss_pred:0.03310493379831314, decouple_loss:0.12381768226623535
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44778600335121155, mean_press_set: 0.44778600335121155
loss_pred:0.03621099516749382, decouple_loss:0.11193805932998657
The generated pressure mean: 0.4483884274959564, mean_press_set: 0.44838836789131165
The generated pressure mean: 0.4481825530529022, mean_press_set: 0.4481825828552246
loss_pred:0.029261359944939613, decouple_loss:0.11102189123630524
loss_pred:0.03311741352081299, decouple_loss:0.11385125666856766
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474206268787384, mean_press_set: 0.4474206268787384
loss_pred:0.031742651015520096, decouple_loss:0.09957277774810791
The generated pressure mean: 0.44813501834869385, mean_press_set: 0.44813501834869385
The generated pressure mean: 0.44817450642585754, mean_press_set: 0.44817450642585754
loss_pred:0.03261071443557739, decouple_loss:0.09805714339017868
loss_pred:0.03136409446597099, decouple_loss:0.09889864176511765
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478033483028412, mean_press_set: 0.44780340790748596
loss_pred:0.031064853072166443, decouple_loss:0.08208319544792175
The generated pressure mean: 0.44791603088378906, mean_press_set: 0.44791606068611145
The generated pressure mean: 0.44837889075279236, mean_press_set: 0.4483788311481476
loss_pred:0.03227807581424713, decouple_loss:0.0860448032617569
loss_pred:0.032961588352918625, decouple_loss:0.086574986577034
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44852012395858765, mean_press_set: 0.44852009415626526
The generated pressure mean: 0.44771450757980347, mean_press_set: 0.4477144777774811
The generated pressure mean: 0.4478994309902191, mean_press_set: 0.44789940118789673
loss_pred:0.03011610358953476, decouple_loss:0.0837976485490799
loss_pred:0.03143644705414772, decouple_loss:0.09696434438228607
loss_pred:0.03213861212134361, decouple_loss:0.08058376610279083
2023-04-16 23:02:22 testing...
The generated pressure mean: 0.4502691924571991, mean_press_set: 0.4502691626548767
The generated pressure mean: 0.4500633776187897, mean_press_set: 0.4500633478164673
The generated pressure mean: 0.45035699009895325, mean_press_set: 0.45035696029663086
loss_pred:0.13976819813251495, decouple_loss:0.11274635791778564
loss_pred:0.1377696841955185, decouple_loss:0.10761979222297668
loss_pred:0.1372302621603012, decouple_loss:0.10929412394762039
WV_0_PC_1_EH_1_PS_40, loss: 0.14375039935112, avg_mse: 0.25415825843811035
current test mse: 0.254158
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478406012058258, mean_press_set: 0.4478406012058258
loss_pred:0.03140804544091225, decouple_loss:0.10310371220111847
The generated pressure mean: 0.44822490215301514, mean_press_set: 0.4482249617576599
loss_pred:0.031031746417284012, decouple_loss:0.09333383291959763
The generated pressure mean: 0.44786447286605835, mean_press_set: 0.4478645324707031
loss_pred:0.02939053252339363, decouple_loss:0.09591395407915115
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44774767756462097, mean_press_set: 0.4477475583553314
loss_pred:0.029881393536925316, decouple_loss:0.09386193007230759
The generated pressure mean: 0.44828301668167114, mean_press_set: 0.44828295707702637
loss_pred:0.03199278563261032, decouple_loss:0.09835036844015121
The generated pressure mean: 0.4482167959213257, mean_press_set: 0.44821682572364807
loss_pred:0.03122480772435665, decouple_loss:0.09615559875965118
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44886213541030884, mean_press_set: 0.4488621652126312
loss_pred:0.02906685508787632, decouple_loss:0.08589523285627365
The generated pressure mean: 0.44660380482673645, mean_press_set: 0.44660380482673645
The generated pressure mean: 0.4487456679344177, mean_press_set: 0.4487457573413849
loss_pred:0.029563352465629578, decouple_loss:0.07259663194417953
loss_pred:0.03054770641028881, decouple_loss:0.07427934557199478
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44742757081985474, mean_press_set: 0.44742754101753235
loss_pred:0.02978779561817646, decouple_loss:0.0708320289850235
The generated pressure mean: 0.44802042841911316, mean_press_set: 0.44802039861679077
loss_pred:0.02848818153142929, decouple_loss:0.07244522869586945
The generated pressure mean: 0.44731831550598145, mean_press_set: 0.44731831550598145
loss_pred:0.03333722800016403, decouple_loss:0.07067505270242691
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447450190782547, mean_press_set: 0.44745007157325745
loss_pred:0.02824561856687069, decouple_loss:0.07192379236221313
The generated pressure mean: 0.44792890548706055, mean_press_set: 0.44792893528938293
The generated pressure mean: 0.4480687081813812, mean_press_set: 0.44806867837905884
loss_pred:0.028147680684924126, decouple_loss:0.06999349594116211
loss_pred:0.031433023512363434, decouple_loss:0.06942582130432129
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483511745929718, mean_press_set: 0.4483511745929718
loss_pred:0.028957027941942215, decouple_loss:0.0663415789604187
The generated pressure mean: 0.4480432868003845, mean_press_set: 0.4480433166027069
The generated pressure mean: 0.4482864737510681, mean_press_set: 0.4482864737510681
loss_pred:0.027751466259360313, decouple_loss:0.0671243667602539
loss_pred:0.02809712290763855, decouple_loss:0.06660272181034088
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488186240196228, mean_press_set: 0.4488186836242676
loss_pred:0.029108379036188126, decouple_loss:0.06673318892717361
The generated pressure mean: 0.4478244185447693, mean_press_set: 0.4478244483470917
The generated pressure mean: 0.44761648774147034, mean_press_set: 0.44761648774147034
loss_pred:0.029306165874004364, decouple_loss:0.06715711206197739
loss_pred:0.029868803918361664, decouple_loss:0.06743663549423218
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44823089241981506, mean_press_set: 0.4482308626174927
The generated pressure mean: 0.4492107927799225, mean_press_set: 0.4492107927799225
loss_pred:0.02742227539420128, decouple_loss:0.06619098782539368
The generated pressure mean: 0.4477413594722748, mean_press_set: 0.4477413594722748
loss_pred:0.02786940336227417, decouple_loss:0.06901843100786209
loss_pred:0.027730269357562065, decouple_loss:0.06553203612565994
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44846081733703613, mean_press_set: 0.44846081733703613
loss_pred:0.02743794396519661, decouple_loss:0.06167140603065491
The generated pressure mean: 0.44665297865867615, mean_press_set: 0.44665300846099854
The generated pressure mean: 0.4486466348171234, mean_press_set: 0.4486466944217682
loss_pred:0.029430005699396133, decouple_loss:0.05950479209423065
loss_pred:0.027383597567677498, decouple_loss:0.061052098870277405
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44802483916282654, mean_press_set: 0.4480248689651489
loss_pred:0.027278834953904152, decouple_loss:0.05564305931329727
The generated pressure mean: 0.4472943842411041, mean_press_set: 0.4472944438457489
loss_pred:0.027434783056378365, decouple_loss:0.058324456214904785
The generated pressure mean: 0.4479069411754608, mean_press_set: 0.4479069411754608
loss_pred:0.027561353519558907, decouple_loss:0.05582074820995331
2023-04-16 23:04:55 testing...
The generated pressure mean: 0.4502691626548767, mean_press_set: 0.4502691626548767
The generated pressure mean: 0.4500633478164673, mean_press_set: 0.4500633478164673
loss_pred:0.16158562898635864, decouple_loss:0.08035247772932053
The generated pressure mean: 0.45035696029663086, mean_press_set: 0.45035696029663086
loss_pred:0.16013947129249573, decouple_loss:0.07993491739034653
loss_pred:0.15881139039993286, decouple_loss:0.08064208924770355
WV_0_PC_1_EH_1_PS_40, loss: 0.16419433057308197, avg_mse: 0.3079119920730591
current test mse: 0.307912
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471801221370697, mean_press_set: 0.4471800923347473
loss_pred:0.028646966442465782, decouple_loss:0.05116289481520653
The generated pressure mean: 0.4480080008506775, mean_press_set: 0.4480080008506775
loss_pred:0.030401259660720825, decouple_loss:0.04947996139526367
The generated pressure mean: 0.4482089579105377, mean_press_set: 0.4482089579105377
loss_pred:0.028368188068270683, decouple_loss:0.051798392087221146
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44792890548706055, mean_press_set: 0.4479289650917053
loss_pred:0.028003472834825516, decouple_loss:0.04620674252510071
The generated pressure mean: 0.44870173931121826, mean_press_set: 0.44870179891586304
loss_pred:0.026375096291303635, decouple_loss:0.04645545780658722
The generated pressure mean: 0.44760897755622864, mean_press_set: 0.44760891795158386
loss_pred:0.027476312592625618, decouple_loss:0.045083653181791306
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44823944568634033, mean_press_set: 0.44823944568634033
loss_pred:0.026784338057041168, decouple_loss:0.04969668388366699
The generated pressure mean: 0.4477457106113434, mean_press_set: 0.4477456510066986
loss_pred:0.028412116691470146, decouple_loss:0.046384453773498535
The generated pressure mean: 0.44809165596961975, mean_press_set: 0.4480917155742645
loss_pred:0.027442172169685364, decouple_loss:0.04611652344465256
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481387734413147, mean_press_set: 0.4481387734413147
loss_pred:0.027959078550338745, decouple_loss:0.043225474655628204
The generated pressure mean: 0.4476131796836853, mean_press_set: 0.4476131498813629
loss_pred:0.02779875323176384, decouple_loss:0.05012721195816994
The generated pressure mean: 0.44771867990493774, mean_press_set: 0.44771865010261536
loss_pred:0.02849891036748886, decouple_loss:0.04317712038755417
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44782108068466187, mean_press_set: 0.4478210508823395
loss_pred:0.026951726526021957, decouple_loss:0.044652070850133896
The generated pressure mean: 0.4478534758090973, mean_press_set: 0.44785353541374207
loss_pred:0.026323266327381134, decouple_loss:0.04579256847500801
The generated pressure mean: 0.44706109166145325, mean_press_set: 0.44706112146377563
loss_pred:0.027804652228951454, decouple_loss:0.04408734664320946
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44877752661705017, mean_press_set: 0.44877755641937256
loss_pred:0.027131911367177963, decouple_loss:0.03936844691634178
The generated pressure mean: 0.44770246744155884, mean_press_set: 0.44770246744155884
The generated pressure mean: 0.44855621457099915, mean_press_set: 0.44855615496635437
loss_pred:0.025697316974401474, decouple_loss:0.0397443063557148
loss_pred:0.02771744690835476, decouple_loss:0.041900720447301865
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44836175441741943, mean_press_set: 0.4483618438243866
loss_pred:0.026470331475138664, decouple_loss:0.039901454001665115
The generated pressure mean: 0.44754403829574585, mean_press_set: 0.44754406809806824
The generated pressure mean: 0.44904208183288574, mean_press_set: 0.44904205203056335
loss_pred:0.02547799050807953, decouple_loss:0.043401625007390976
loss_pred:0.025852983817458153, decouple_loss:0.04166034981608391
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482400119304657, mean_press_set: 0.4482399523258209
loss_pred:0.02601294033229351, decouple_loss:0.03852865844964981
The generated pressure mean: 0.4481496512889862, mean_press_set: 0.44814959168434143The generated pressure mean: 0.4487907290458679, mean_press_set: 0.44879069924354553
loss_pred:0.025876380503177643, decouple_loss:0.03841857984662056
loss_pred:0.027436349540948868, decouple_loss:0.04054535925388336
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449489027261734, mean_press_set: 0.4494889974594116
loss_pred:0.02622394636273384, decouple_loss:0.040096912533044815
The generated pressure mean: 0.4493274986743927, mean_press_set: 0.4493274986743927
The generated pressure mean: 0.44831907749176025, mean_press_set: 0.44831904768943787
loss_pred:0.02657533623278141, decouple_loss:0.03667254373431206
loss_pred:0.027407808229327202, decouple_loss:0.03731943666934967
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493890404701233, mean_press_set: 0.4493890404701233
The generated pressure mean: 0.44819167256355286, mean_press_set: 0.44819164276123047
loss_pred:0.026187850162386894, decouple_loss:0.03902633488178253
The generated pressure mean: 0.4487677812576294, mean_press_set: 0.4487678110599518
loss_pred:0.026189031079411507, decouple_loss:0.03686654567718506
loss_pred:0.026603076606988907, decouple_loss:0.03339318558573723
2023-04-16 23:06:46 testing...
The generated pressure mean: 0.4502691626548767, mean_press_set: 0.4502691626548767
The generated pressure mean: 0.4500633776187897, mean_press_set: 0.4500633478164673
The generated pressure mean: 0.45035699009895325, mean_press_set: 0.45035696029663086
loss_pred:0.16599233448505402, decouple_loss:0.06606759130954742
loss_pred:0.16446053981781006, decouple_loss:0.0659528449177742
loss_pred:0.16322582960128784, decouple_loss:0.0662158951163292
WV_0_PC_1_EH_1_PS_40, loss: 0.16786351799964905, avg_mse: 0.32440388202667236
current test mse: 0.324404
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45039114356040955, mean_press_set: 0.4503912329673767
loss_pred:0.02454470284283161, decouple_loss:0.03406529501080513
The generated pressure mean: 0.44873157143592834, mean_press_set: 0.44873154163360596
loss_pred:0.025696665048599243, decouple_loss:0.03485071659088135
The generated pressure mean: 0.4500713348388672, mean_press_set: 0.45007139444351196
loss_pred:0.02425541914999485, decouple_loss:0.03276222571730614
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44843727350234985, mean_press_set: 0.44843724370002747The generated pressure mean: 0.44992581009864807, mean_press_set: 0.4499257802963257
loss_pred:0.02484208531677723, decouple_loss:0.03615008294582367
loss_pred:0.025336187332868576, decouple_loss:0.037604283541440964
The generated pressure mean: 0.44958585500717163, mean_press_set: 0.44958579540252686
loss_pred:0.026785515248775482, decouple_loss:0.03483060002326965
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45004236698150635, mean_press_set: 0.4500423073768616
loss_pred:0.025974541902542114, decouple_loss:0.03667767718434334
The generated pressure mean: 0.4508228898048401, mean_press_set: 0.4508228898048401
The generated pressure mean: 0.449707955121994, mean_press_set: 0.449707955121994
loss_pred:0.02457195334136486, decouple_loss:0.036884188652038574
loss_pred:0.024653883650898933, decouple_loss:0.03782951831817627
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45072343945503235, mean_press_set: 0.4507233798503876
loss_pred:0.026948459446430206, decouple_loss:0.03466232493519783
The generated pressure mean: 0.450700581073761, mean_press_set: 0.4507005214691162
The generated pressure mean: 0.4498126804828644, mean_press_set: 0.4498126208782196
loss_pred:0.02329317294061184, decouple_loss:0.035840656608343124
loss_pred:0.0276616383343935, decouple_loss:0.034300416707992554
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503350853919983, mean_press_set: 0.4503350555896759
loss_pred:0.026473602280020714, decouple_loss:0.02976364642381668
The generated pressure mean: 0.4476839005947113, mean_press_set: 0.4476839303970337
The generated pressure mean: 0.4494022727012634, mean_press_set: 0.4494022727012634
loss_pred:0.024361560121178627, decouple_loss:0.03106318786740303
loss_pred:0.025628848001360893, decouple_loss:0.030333107337355614
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499005973339081, mean_press_set: 0.4499005675315857
loss_pred:0.02606922946870327, decouple_loss:0.032291512936353683
The generated pressure mean: 0.4494844377040863, mean_press_set: 0.4494844079017639
The generated pressure mean: 0.4498860836029053, mean_press_set: 0.4498860538005829
loss_pred:0.02422807365655899, decouple_loss:0.03252694755792618
loss_pred:0.025387875735759735, decouple_loss:0.03247183933854103
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495563507080078, mean_press_set: 0.4495563805103302
The generated pressure mean: 0.4507656991481781, mean_press_set: 0.4507656991481781
loss_pred:0.026527341455221176, decouple_loss:0.038014113903045654
loss_pred:0.023952247574925423, decouple_loss:0.03832679241895676
The generated pressure mean: 0.45107501745224, mean_press_set: 0.4510750472545624
loss_pred:0.024330656975507736, decouple_loss:0.037850476801395416
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491027295589447, mean_press_set: 0.4491027593612671
loss_pred:0.025655265897512436, decouple_loss:0.029381830245256424
The generated pressure mean: 0.45076262950897217, mean_press_set: 0.45076262950897217
loss_pred:0.024664895609021187, decouple_loss:0.034103307873010635
The generated pressure mean: 0.45054930448532104, mean_press_set: 0.4505492150783539
loss_pred:0.023304590955376625, decouple_loss:0.030719053000211716
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450493723154068, mean_press_set: 0.4504936933517456
The generated pressure mean: 0.45101943612098694, mean_press_set: 0.4510194957256317
loss_pred:0.02190386690199375, decouple_loss:0.029789848253130913
loss_pred:0.02358313836157322, decouple_loss:0.029045380651950836
The generated pressure mean: 0.44963258504867554, mean_press_set: 0.4496326744556427
loss_pred:0.023181425407528877, decouple_loss:0.02975580468773842
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449233740568161, mean_press_set: 0.4492337107658386
The generated pressure mean: 0.4495355784893036, mean_press_set: 0.44953563809394836
The generated pressure mean: 0.45089900493621826, mean_press_set: 0.4508989155292511
loss_pred:0.02275913953781128, decouple_loss:0.032127443701028824
loss_pred:0.023696226999163628, decouple_loss:0.03217655420303345
loss_pred:0.024071495980024338, decouple_loss:0.03283650800585747
2023-04-16 23:09:13 testing...
The generated pressure mean: 0.4502691626548767, mean_press_set: 0.4502691626548767
The generated pressure mean: 0.4500633776187897, mean_press_set: 0.4500633478164673
The generated pressure mean: 0.45035699009895325, mean_press_set: 0.45035696029663086
loss_pred:0.17975163459777832, decouple_loss:0.06272678822278976
loss_pred:0.17794257402420044, decouple_loss:0.0636180192232132loss_pred:0.17663724720478058, decouple_loss:0.06338532269001007
WV_0_PC_1_EH_1_PS_40, loss: 0.18127267062664032, avg_mse: 0.35438862442970276
current test mse: 0.354389