
load model: /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_0_PC_0_EH_0_PS_40_6/model_2000.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
train_data_files nums: 124
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44428715109825134, gen p mean: 0.0, mean p set: 0.4497818946838379
loss_pred:0.03028932586312294, decouple_loss:0.01250127051025629
The modified gen p mean: 0.44527536630630493, gen p mean: 0.0, mean p set: 0.4499320983886719
loss_pred:0.028730519115924835, decouple_loss:0.012462384067475796
The modified gen p mean: 0.4443528950214386, gen p mean: 0.0, mean p set: 0.44888144731521606
loss_pred:0.028681406751275063, decouple_loss:0.011910761706531048
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.5955970883369446, gen p mean: 0.0, mean p set: 0.4487886428833008
The modified gen p mean: 0.5951786041259766, gen p mean: 0.0, mean p set: 0.45017367601394653
The modified gen p mean: 0.5968225002288818, gen p mean: 0.0, mean p set: 0.45026645064353943
loss_pred:0.10512961447238922, decouple_loss:0.14198055863380432
loss_pred:0.10297828912734985, decouple_loss:0.14113487303256989
loss_pred:0.10577315092086792, decouple_loss:0.14117372035980225
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42061787843704224, gen p mean: 0.0, mean p set: 0.4492282271385193
loss_pred:0.05730689689517021, decouple_loss:0.12407229095697403
The modified gen p mean: 0.42063379287719727, gen p mean: 0.0, mean p set: 0.4487546980381012
The modified gen p mean: 0.4222242832183838, gen p mean: 0.0, mean p set: 0.44953852891921997
loss_pred:0.05867638438940048, decouple_loss:0.12371712177991867
loss_pred:0.056906841695308685, decouple_loss:0.12579426169395447
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.31139880418777466, gen p mean: 0.0, mean p set: 0.4489196836948395
loss_pred:0.061344798654317856, decouple_loss:0.18157531321048737
The modified gen p mean: 0.3024870455265045, gen p mean: 0.0, mean p set: 0.4503753185272217
The modified gen p mean: 0.31083932518959045, gen p mean: 0.0, mean p set: 0.44944456219673157
loss_pred:0.061972301453351974, decouple_loss:0.1750391721725464
loss_pred:0.062235165387392044, decouple_loss:0.17891763150691986
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.5638156533241272, gen p mean: 0.0, mean p set: 0.44797325134277344
loss_pred:0.06510036438703537, decouple_loss:0.1624307781457901
The modified gen p mean: 0.5583927035331726, gen p mean: 0.0, mean p set: 0.45083382725715637
The modified gen p mean: 0.5611543655395508, gen p mean: 0.0, mean p set: 0.4491797089576721
loss_pred:0.06145079806447029, decouple_loss:0.15920986235141754
loss_pred:0.06169886142015457, decouple_loss:0.1540904939174652
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4050052762031555, gen p mean: 0.0, mean p set: 0.4481256306171417
The modified gen p mean: 0.4039546549320221, gen p mean: 0.0, mean p set: 0.4509304463863373
loss_pred:0.05546068027615547, decouple_loss:0.09742715209722519
loss_pred:0.056274279952049255, decouple_loss:0.09647230058908463The modified gen p mean: 0.40652230381965637, gen p mean: 0.0, mean p set: 0.44910046458244324
loss_pred:0.056786589324474335, decouple_loss:0.09897480905056
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.3899904191493988, gen p mean: 0.0, mean p set: 0.4504399299621582
The modified gen p mean: 0.3903464078903198, gen p mean: 0.0, mean p set: 0.44906121492385864
loss_pred:0.048914939165115356, decouple_loss:0.09206906706094742
loss_pred:0.05296439677476883, decouple_loss:0.0935949981212616The modified gen p mean: 0.39246082305908203, gen p mean: 0.0, mean p set: 0.4483988583087921
loss_pred:0.04884431138634682, decouple_loss:0.09279710799455643
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.41367682814598083, gen p mean: 0.0, mean p set: 0.44993606209754944
loss_pred:0.04786166176199913, decouple_loss:0.0900355651974678
The modified gen p mean: 0.41510775685310364, gen p mean: 0.0, mean p set: 0.44893211126327515
The modified gen p mean: 0.41792765259742737, gen p mean: 0.0, mean p set: 0.448575496673584
loss_pred:0.04814187064766884, decouple_loss:0.0953708365559578
loss_pred:0.0473986379802227, decouple_loss:0.09428217262029648
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.441228985786438, gen p mean: 0.0, mean p set: 0.44844523072242737
loss_pred:0.045912012457847595, decouple_loss:0.08476974070072174
The modified gen p mean: 0.43565255403518677, gen p mean: 0.0, mean p set: 0.45021507143974304
The modified gen p mean: 0.4391777217388153, gen p mean: 0.0, mean p set: 0.4496472179889679
loss_pred:0.04678900167346001, decouple_loss:0.08017627894878387
loss_pred:0.046898990869522095, decouple_loss:0.08237381279468536
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089253783226013, gen p mean: 0.0, mean p set: 0.4501113295555115
loss_pred:0.04302224516868591, decouple_loss:0.06899683177471161
The modified gen p mean: 0.4518836438655853, gen p mean: 0.0, mean p set: 0.4478487968444824
The modified gen p mean: 0.4504414200782776, gen p mean: 0.0, mean p set: 0.44917523860931396
loss_pred:0.04385989531874657, decouple_loss:0.0701611265540123
loss_pred:0.044476184993982315, decouple_loss:0.07069592922925949
2023-05-04 10:15:56 testing...
The modified gen p mean: 0.4700393080711365, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4702061116695404, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.47170859575271606, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.04428349435329437, decouple_loss:0.0681425929069519
loss_pred:0.04334835708141327, decouple_loss:0.0674920454621315
loss_pred:0.0431792326271534, decouple_loss:0.0676979124546051
WV_0_PC_0_EH_0_PS_40_6, loss: 0.04699257016181946, avg_mse: 0.049144864082336426
current test mse: 0.049145
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4718935787677765, gen p mean: 0.0, mean p set: 0.44812440872192383
The modified gen p mean: 0.47040265798568726, gen p mean: 0.0, mean p set: 0.4488662779331207
loss_pred:0.04255710542201996, decouple_loss:0.06817825883626938
loss_pred:0.041465938091278076, decouple_loss:0.06774604320526123
The modified gen p mean: 0.4711129367351532, gen p mean: 0.0, mean p set: 0.44927293062210083
loss_pred:0.04238434135913849, decouple_loss:0.06734765321016312
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4808593988418579, gen p mean: 0.0, mean p set: 0.4505065083503723
loss_pred:0.041325971484184265, decouple_loss:0.06751144677400589
The modified gen p mean: 0.4799676239490509, gen p mean: 0.0, mean p set: 0.4501916468143463
The modified gen p mean: 0.48120009899139404, gen p mean: 0.0, mean p set: 0.44868043065071106
loss_pred:0.042236410081386566, decouple_loss:0.06664952635765076
loss_pred:0.04307889565825462, decouple_loss:0.06921315938234329
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4640676975250244, gen p mean: 0.0, mean p set: 0.4493875503540039
loss_pred:0.04293307289481163, decouple_loss:0.06240979954600334
The modified gen p mean: 0.46494314074516296, gen p mean: 0.0, mean p set: 0.4507031738758087
The modified gen p mean: 0.4664291739463806, gen p mean: 0.0, mean p set: 0.4503500759601593
loss_pred:0.040106143802404404, decouple_loss:0.06132834404706955
loss_pred:0.04135836660861969, decouple_loss:0.059113387018442154
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45139917731285095, gen p mean: 0.0, mean p set: 0.4497022032737732
The modified gen p mean: 0.4514414072036743, gen p mean: 0.0, mean p set: 0.4502998888492584
loss_pred:0.04206809401512146, decouple_loss:0.057646214962005615
loss_pred:0.03903583064675331, decouple_loss:0.058106426149606705The modified gen p mean: 0.4530656337738037, gen p mean: 0.0, mean p set: 0.44863176345825195
loss_pred:0.04146571829915047, decouple_loss:0.05924006178975105
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44899436831474304, gen p mean: 0.0, mean p set: 0.4493860900402069
loss_pred:0.04081792011857033, decouple_loss:0.05983121320605278
The modified gen p mean: 0.44616398215293884, gen p mean: 0.0, mean p set: 0.4492657780647278
The modified gen p mean: 0.4488183856010437, gen p mean: 0.0, mean p set: 0.4491589367389679
loss_pred:0.03880048543214798, decouple_loss:0.056279756128787994
loss_pred:0.038939427584409714, decouple_loss:0.05440914258360863
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44027137756347656, gen p mean: 0.0, mean p set: 0.4500845670700073
The modified gen p mean: 0.43923333287239075, gen p mean: 0.0, mean p set: 0.450064092874527
loss_pred:0.03770400583744049, decouple_loss:0.05562816187739372
loss_pred:0.0387255996465683, decouple_loss:0.05496134236454964The modified gen p mean: 0.44150373339653015, gen p mean: 0.0, mean p set: 0.44847577810287476
loss_pred:0.03903505578637123, decouple_loss:0.05617578700184822
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4369002878665924, gen p mean: 0.0, mean p set: 0.4479599893093109
loss_pred:0.04040208086371422, decouple_loss:0.05644848942756653
The modified gen p mean: 0.4349979758262634, gen p mean: 0.0, mean p set: 0.45080816745758057
The modified gen p mean: 0.4386535584926605, gen p mean: 0.0, mean p set: 0.44934555888175964
loss_pred:0.041166141629219055, decouple_loss:0.05865371599793434
loss_pred:0.039388611912727356, decouple_loss:0.054607391357421875
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42596879601478577, gen p mean: 0.0, mean p set: 0.45026108622550964
loss_pred:0.040327876806259155, decouple_loss:0.051191505044698715
The modified gen p mean: 0.425655335187912, gen p mean: 0.0, mean p set: 0.4507019817829132
The modified gen p mean: 0.42616286873817444, gen p mean: 0.0, mean p set: 0.45078352093696594
loss_pred:0.03909589722752571, decouple_loss:0.05095626413822174
loss_pred:0.03851887583732605, decouple_loss:0.05163092166185379
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4364546239376068, gen p mean: 0.0, mean p set: 0.4488941431045532
The modified gen p mean: 0.4356447160243988, gen p mean: 0.0, mean p set: 0.4491029977798462
loss_pred:0.03627760335803032, decouple_loss:0.04954696446657181
The modified gen p mean: 0.43283310532569885, gen p mean: 0.0, mean p set: 0.4494177997112274loss_pred:0.0391114242374897, decouple_loss:0.04926621913909912
loss_pred:0.03760460391640663, decouple_loss:0.049240246415138245
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45406365394592285, gen p mean: 0.0, mean p set: 0.44855284690856934The modified gen p mean: 0.4513411223888397, gen p mean: 0.0, mean p set: 0.4514707326889038
loss_pred:0.03626655414700508, decouple_loss:0.05536496266722679loss_pred:0.03657166287302971, decouple_loss:0.054934173822402954
The modified gen p mean: 0.45461174845695496, gen p mean: 0.0, mean p set: 0.4484170973300934
loss_pred:0.03721078112721443, decouple_loss:0.05545811355113983
2023-05-04 10:19:31 testing...
The modified gen p mean: 0.45672035217285156, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4590285122394562, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45990970730781555, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03748541697859764, decouple_loss:0.052208561450242996
loss_pred:0.03668345510959625, decouple_loss:0.052245043218135834
loss_pred:0.035828977823257446, decouple_loss:0.052470240741968155
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03928134962916374, avg_mse: 0.04300690069794655
current test mse: 0.043007
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4618169665336609, gen p mean: 0.0, mean p set: 0.4524938464164734
The modified gen p mean: 0.46254581212997437, gen p mean: 0.0, mean p set: 0.452647864818573
loss_pred:0.03751568868756294, decouple_loss:0.055193956941366196
loss_pred:0.03558654338121414, decouple_loss:0.05526852235198021
The modified gen p mean: 0.4617807865142822, gen p mean: 0.0, mean p set: 0.4511038064956665
loss_pred:0.03657776117324829, decouple_loss:0.05476682633161545
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464862048625946, gen p mean: 0.0, mean p set: 0.4522283971309662
loss_pred:0.03526073694229126, decouple_loss:0.04721362888813019
The modified gen p mean: 0.4427828788757324, gen p mean: 0.0, mean p set: 0.4539874494075775
The modified gen p mean: 0.4426954984664917, gen p mean: 0.0, mean p set: 0.45375579595565796
loss_pred:0.03647525608539581, decouple_loss:0.04812563583254814
loss_pred:0.03474745154380798, decouple_loss:0.04777092486619949
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049285888671875, gen p mean: 0.0, mean p set: 0.45247623324394226
loss_pred:0.036335308104753494, decouple_loss:0.04461858794093132
The modified gen p mean: 0.45093095302581787, gen p mean: 0.0, mean p set: 0.4517900347709656
The modified gen p mean: 0.4523596465587616, gen p mean: 0.0, mean p set: 0.450886607170105
loss_pred:0.03754981979727745, decouple_loss:0.04483402892947197
loss_pred:0.035563137382268906, decouple_loss:0.04574985429644585
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4590255320072174, gen p mean: 0.0, mean p set: 0.4513225853443146
The modified gen p mean: 0.4614514112472534, gen p mean: 0.0, mean p set: 0.4523157775402069
loss_pred:0.034567032009363174, decouple_loss:0.04481906071305275
loss_pred:0.035244766622781754, decouple_loss:0.044722236692905426
The modified gen p mean: 0.46080222725868225, gen p mean: 0.0, mean p set: 0.45110899209976196
loss_pred:0.03584416210651398, decouple_loss:0.04525759816169739
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947686791419983, gen p mean: 0.0, mean p set: 0.4538503587245941
The modified gen p mean: 0.4542903006076813, gen p mean: 0.0, mean p set: 0.45249712467193604
loss_pred:0.031111467629671097, decouple_loss:0.044733259826898575
The modified gen p mean: 0.45736876130104065, gen p mean: 0.0, mean p set: 0.4495995044708252
loss_pred:0.03487551584839821, decouple_loss:0.04441976547241211
loss_pred:0.035305287688970566, decouple_loss:0.04446890950202942
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46230947971343994, gen p mean: 0.0, mean p set: 0.45079126954078674
loss_pred:0.03391413763165474, decouple_loss:0.04367077350616455
The modified gen p mean: 0.46159473061561584, gen p mean: 0.0, mean p set: 0.4507386088371277
The modified gen p mean: 0.4589400291442871, gen p mean: 0.0, mean p set: 0.4522095024585724
loss_pred:0.03405206277966499, decouple_loss:0.044677190482616425
loss_pred:0.033988162875175476, decouple_loss:0.04349168762564659
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4593897759914398, gen p mean: 0.0, mean p set: 0.44895628094673157
loss_pred:0.03420695289969444, decouple_loss:0.04141316935420036
The modified gen p mean: 0.45593973994255066, gen p mean: 0.0, mean p set: 0.45116573572158813
The modified gen p mean: 0.4553065299987793, gen p mean: 0.0, mean p set: 0.4539388418197632
loss_pred:0.0340927429497242, decouple_loss:0.042420197278261185
loss_pred:0.0340975746512413, decouple_loss:0.0412551574409008
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45046839118003845, gen p mean: 0.0, mean p set: 0.4499339163303375
The modified gen p mean: 0.44408369064331055, gen p mean: 0.0, mean p set: 0.45117518305778503
loss_pred:0.03331658989191055, decouple_loss:0.0411086305975914
loss_pred:0.03178364783525467, decouple_loss:0.04135028272867203
The modified gen p mean: 0.4446023404598236, gen p mean: 0.0, mean p set: 0.45250123739242554
loss_pred:0.03310229256749153, decouple_loss:0.04180460795760155
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45792239904403687, gen p mean: 0.0, mean p set: 0.45102712512016296
The modified gen p mean: 0.4543611407279968, gen p mean: 0.0, mean p set: 0.4520423710346222
loss_pred:0.033409539610147476, decouple_loss:0.03822503983974457
loss_pred:0.031965792179107666, decouple_loss:0.03788883611559868
The modified gen p mean: 0.4521915316581726, gen p mean: 0.0, mean p set: 0.45174357295036316
loss_pred:0.0335935577750206, decouple_loss:0.03835748881101608
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44512835144996643, gen p mean: 0.0, mean p set: 0.4524913430213928
loss_pred:0.034005943685770035, decouple_loss:0.037350092083215714
The modified gen p mean: 0.4493664801120758, gen p mean: 0.0, mean p set: 0.4526708722114563
The modified gen p mean: 0.450366348028183, gen p mean: 0.0, mean p set: 0.45226943492889404
loss_pred:0.0332152284681797, decouple_loss:0.03667348250746727
loss_pred:0.03266828507184982, decouple_loss:0.03751200810074806
2023-05-04 10:24:04 testing...
The modified gen p mean: 0.43541958928108215, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44146373867988586, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4442152678966522, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.035080961883068085, decouple_loss:0.03914130479097366
loss_pred:0.033880576491355896, decouple_loss:0.03827495500445366
loss_pred:0.03330450505018234, decouple_loss:0.03812338784337044
WV_0_PC_0_EH_0_PS_40_6, loss: 0.036014340817928314, avg_mse: 0.040938105434179306
current test mse: 0.040938
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4418679475784302, gen p mean: 0.0, mean p set: 0.4525359272956848The modified gen p mean: 0.44353020191192627, gen p mean: 0.0, mean p set: 0.4508056044578552
loss_pred:0.03171348199248314, decouple_loss:0.03687220439314842
loss_pred:0.03290052339434624, decouple_loss:0.03672300651669502
The modified gen p mean: 0.44089531898498535, gen p mean: 0.0, mean p set: 0.4513719379901886
loss_pred:0.03264399617910385, decouple_loss:0.03711714968085289
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44481614232063293, gen p mean: 0.0, mean p set: 0.4520528018474579
The modified gen p mean: 0.447469562292099, gen p mean: 0.0, mean p set: 0.4505784809589386
loss_pred:0.031491365283727646, decouple_loss:0.03477048873901367
The modified gen p mean: 0.44707727432250977, gen p mean: 0.0, mean p set: 0.45219701528549194loss_pred:0.03140414133667946, decouple_loss:0.03531946986913681
loss_pred:0.030130749568343163, decouple_loss:0.03660822659730911
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4556833803653717, gen p mean: 0.0, mean p set: 0.4528115391731262
loss_pred:0.03237445279955864, decouple_loss:0.03427378833293915
The modified gen p mean: 0.46196484565734863, gen p mean: 0.0, mean p set: 0.45013684034347534
The modified gen p mean: 0.46021175384521484, gen p mean: 0.0, mean p set: 0.45081186294555664
loss_pred:0.03256680443882942, decouple_loss:0.03501920402050018
loss_pred:0.03308003395795822, decouple_loss:0.034623559564352036
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4546703100204468, gen p mean: 0.0, mean p set: 0.4508635997772217
loss_pred:0.03166066110134125, decouple_loss:0.03488113731145859
The modified gen p mean: 0.44711896777153015, gen p mean: 0.0, mean p set: 0.45340198278427124
The modified gen p mean: 0.4495302736759186, gen p mean: 0.0, mean p set: 0.45376312732696533
loss_pred:0.029709691181778908, decouple_loss:0.034573864191770554
loss_pred:0.0310005284845829, decouple_loss:0.0355912446975708
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4414141774177551, gen p mean: 0.0, mean p set: 0.45409834384918213
loss_pred:0.03157738223671913, decouple_loss:0.03115248493850231
The modified gen p mean: 0.4502365291118622, gen p mean: 0.0, mean p set: 0.4505026042461395
The modified gen p mean: 0.44539493322372437, gen p mean: 0.0, mean p set: 0.45107758045196533
loss_pred:0.03253486379981041, decouple_loss:0.03238965943455696
loss_pred:0.03318110108375549, decouple_loss:0.03136048838496208
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4552974998950958, gen p mean: 0.0, mean p set: 0.4521334171295166
The modified gen p mean: 0.4564261734485626, gen p mean: 0.0, mean p set: 0.44988977909088135
loss_pred:0.03222746029496193, decouple_loss:0.030208086594939232
loss_pred:0.03314802423119545, decouple_loss:0.03035282902419567The modified gen p mean: 0.4515102207660675, gen p mean: 0.0, mean p set: 0.453212171792984
loss_pred:0.03267268091440201, decouple_loss:0.030657649040222168
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4565388262271881, gen p mean: 0.0, mean p set: 0.4528922438621521
The modified gen p mean: 0.46072855591773987, gen p mean: 0.0, mean p set: 0.4500125050544739
loss_pred:0.03095974586904049, decouple_loss:0.02972918562591076
loss_pred:0.03208431601524353, decouple_loss:0.030428344383835793
The modified gen p mean: 0.457866370677948, gen p mean: 0.0, mean p set: 0.45101380348205566
loss_pred:0.031155284494161606, decouple_loss:0.03178375959396362
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445493221282959, gen p mean: 0.0, mean p set: 0.45339396595954895
The modified gen p mean: 0.4429759979248047, gen p mean: 0.0, mean p set: 0.4527163803577423
loss_pred:0.030797617509961128, decouple_loss:0.033343855291604996
loss_pred:0.03212561085820198, decouple_loss:0.03335554152727127The modified gen p mean: 0.4500887095928192, gen p mean: 0.0, mean p set: 0.4518507122993469
loss_pred:0.031758300960063934, decouple_loss:0.032209612429142
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4545416533946991, gen p mean: 0.0, mean p set: 0.452614963054657
loss_pred:0.03133770078420639, decouple_loss:0.02896064706146717
The modified gen p mean: 0.4579649567604065, gen p mean: 0.0, mean p set: 0.45072096586227417
The modified gen p mean: 0.4495648741722107, gen p mean: 0.0, mean p set: 0.45323994755744934
loss_pred:0.03049561381340027, decouple_loss:0.028173455968499184
loss_pred:0.03208493813872337, decouple_loss:0.028744442388415337
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45247986912727356, gen p mean: 0.0, mean p set: 0.4534553289413452
The modified gen p mean: 0.45989876985549927, gen p mean: 0.0, mean p set: 0.45129746198654175
loss_pred:0.03021005168557167, decouple_loss:0.028172718361020088
loss_pred:0.032028842717409134, decouple_loss:0.026913490146398544The modified gen p mean: 0.457457572221756, gen p mean: 0.0, mean p set: 0.45114725828170776
loss_pred:0.031212909147143364, decouple_loss:0.02828141674399376
2023-05-04 10:27:35 testing...
The modified gen p mean: 0.44494763016700745, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45233890414237976, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45591893792152405, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03312572464346886, decouple_loss:0.03053286299109459
loss_pred:0.032117679715156555, decouple_loss:0.029216142371296883
loss_pred:0.03152259439229965, decouple_loss:0.02936050295829773
WV_0_PC_0_EH_0_PS_40_6, loss: 0.033740490674972534, avg_mse: 0.03881233185529709
current test mse: 0.038812
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44597506523132324, gen p mean: 0.0, mean p set: 0.4494149386882782
The modified gen p mean: 0.4518859386444092, gen p mean: 0.0, mean p set: 0.4492860734462738
loss_pred:0.03116568922996521, decouple_loss:0.030279377475380898
loss_pred:0.031149091199040413, decouple_loss:0.029295792803168297
The modified gen p mean: 0.456506609916687, gen p mean: 0.0, mean p set: 0.447748064994812
loss_pred:0.030708421021699905, decouple_loss:0.029236720874905586
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476782977581024, gen p mean: 0.0, mean p set: 0.4477371871471405
loss_pred:0.03073718398809433, decouple_loss:0.02918527089059353
The modified gen p mean: 0.44562041759490967, gen p mean: 0.0, mean p set: 0.44904303550720215
The modified gen p mean: 0.4439908564090729, gen p mean: 0.0, mean p set: 0.44843384623527527
loss_pred:0.031326889991760254, decouple_loss:0.029737813398241997
loss_pred:0.03240247815847397, decouple_loss:0.02963791787624359
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44328179955482483, gen p mean: 0.0, mean p set: 0.44859644770622253
The modified gen p mean: 0.4446214437484741, gen p mean: 0.0, mean p set: 0.4479064643383026
loss_pred:0.030277710407972336, decouple_loss:0.02854478359222412
The modified gen p mean: 0.4396948218345642, gen p mean: 0.0, mean p set: 0.4485572874546051loss_pred:0.03194046393036842, decouple_loss:0.028568489477038383
loss_pred:0.03147905692458153, decouple_loss:0.02831035666167736
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43949100375175476, gen p mean: 0.0, mean p set: 0.44884639978408813
The modified gen p mean: 0.44714412093162537, gen p mean: 0.0, mean p set: 0.447394996881485
loss_pred:0.029777156189084053, decouple_loss:0.026945166289806366
loss_pred:0.029504042118787766, decouple_loss:0.02812499925494194
The modified gen p mean: 0.4477662146091461, gen p mean: 0.0, mean p set: 0.44782793521881104
loss_pred:0.03044324927031994, decouple_loss:0.02669045887887478
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45445016026496887, gen p mean: 0.0, mean p set: 0.44786569476127625
loss_pred:0.02985825203359127, decouple_loss:0.027461837977170944
The modified gen p mean: 0.4467737674713135, gen p mean: 0.0, mean p set: 0.4498351216316223
The modified gen p mean: 0.45537325739860535, gen p mean: 0.0, mean p set: 0.4483363628387451
loss_pred:0.030800355598330498, decouple_loss:0.027176618576049805
loss_pred:0.029531914740800858, decouple_loss:0.027681874111294746
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4447774887084961, gen p mean: 0.0, mean p set: 0.44910773634910583
The modified gen p mean: 0.4468827247619629, gen p mean: 0.0, mean p set: 0.4477499723434448
loss_pred:0.029373735189437866, decouple_loss:0.027818799018859863
loss_pred:0.031591422855854034, decouple_loss:0.028384126722812653
The modified gen p mean: 0.4470812976360321, gen p mean: 0.0, mean p set: 0.44885799288749695
loss_pred:0.030789753422141075, decouple_loss:0.027699388563632965
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44261592626571655, gen p mean: 0.0, mean p set: 0.4481402039527893
loss_pred:0.02993481047451496, decouple_loss:0.024503357708454132
The modified gen p mean: 0.4445301592350006, gen p mean: 0.0, mean p set: 0.4479774832725525
The modified gen p mean: 0.4434818923473358, gen p mean: 0.0, mean p set: 0.44889771938323975
loss_pred:0.030590934678912163, decouple_loss:0.025137796998023987
loss_pred:0.030257415026426315, decouple_loss:0.024984149262309074
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44605752825737, gen p mean: 0.0, mean p set: 0.45123034715652466
The modified gen p mean: 0.4439653158187866, gen p mean: 0.0, mean p set: 0.449176549911499
loss_pred:0.029692409560084343, decouple_loss:0.026787610724568367
loss_pred:0.03115021623671055, decouple_loss:0.02557547204196453The modified gen p mean: 0.4455874264240265, gen p mean: 0.0, mean p set: 0.44923779368400574
loss_pred:0.03173567354679108, decouple_loss:0.025512760505080223
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521859884262085, gen p mean: 0.0, mean p set: 0.4478965699672699
loss_pred:0.030845100060105324, decouple_loss:0.024294886738061905
The modified gen p mean: 0.4535740315914154, gen p mean: 0.0, mean p set: 0.4488815367221832
The modified gen p mean: 0.45599523186683655, gen p mean: 0.0, mean p set: 0.44833314418792725
loss_pred:0.03174148499965668, decouple_loss:0.024968763813376427
loss_pred:0.03306281566619873, decouple_loss:0.025272946804761887
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44912511110305786, gen p mean: 0.0, mean p set: 0.4472704529762268
loss_pred:0.031390681862831116, decouple_loss:0.024913201108574867
The modified gen p mean: 0.4531930088996887, gen p mean: 0.0, mean p set: 0.45067334175109863
The modified gen p mean: 0.4466521441936493, gen p mean: 0.0, mean p set: 0.4502794146537781
loss_pred:0.03019282966852188, decouple_loss:0.024710630998015404
loss_pred:0.02953830361366272, decouple_loss:0.025345545262098312
2023-05-04 10:31:51 testing...
The modified gen p mean: 0.44024789333343506, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4516797959804535, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44807663559913635, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.031922709196805954, decouple_loss:0.025507302954792976
loss_pred:0.030365634709596634, decouple_loss:0.026385951787233353
loss_pred:0.030764810740947723, decouple_loss:0.02582939714193344
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03231309726834297, avg_mse: 0.03710564970970154
current test mse: 0.037106
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473539888858795, gen p mean: 0.0, mean p set: 0.449554443359375
The modified gen p mean: 0.43777933716773987, gen p mean: 0.0, mean p set: 0.45009157061576843
loss_pred:0.03064517304301262, decouple_loss:0.025828765705227852
loss_pred:0.029767975211143494, decouple_loss:0.02613668143749237
The modified gen p mean: 0.4483758807182312, gen p mean: 0.0, mean p set: 0.447174608707428
loss_pred:0.031746987253427505, decouple_loss:0.02671719342470169
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45845335721969604, gen p mean: 0.0, mean p set: 0.44867387413978577
The modified gen p mean: 0.455375611782074, gen p mean: 0.0, mean p set: 0.4495624303817749
loss_pred:0.03029039315879345, decouple_loss:0.022961517795920372
The modified gen p mean: 0.4578591287136078, gen p mean: 0.0, mean p set: 0.4475933015346527loss_pred:0.03027028776705265, decouple_loss:0.02436479926109314
loss_pred:0.03202245384454727, decouple_loss:0.023018211126327515
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4552988111972809, gen p mean: 0.0, mean p set: 0.4493841528892517
The modified gen p mean: 0.4503602981567383, gen p mean: 0.0, mean p set: 0.45023879408836365loss_pred:0.030116703361272812, decouple_loss:0.02371443249285221
The modified gen p mean: 0.4569089710712433, gen p mean: 0.0, mean p set: 0.44803765416145325
loss_pred:0.030492693185806274, decouple_loss:0.022797608748078346
loss_pred:0.02975217066705227, decouple_loss:0.02278820611536503
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43014708161354065, gen p mean: 0.0, mean p set: 0.45020073652267456
loss_pred:0.028922298923134804, decouple_loss:0.02334906905889511
The modified gen p mean: 0.42929038405418396, gen p mean: 0.0, mean p set: 0.4496042728424072
The modified gen p mean: 0.44771918654441833, gen p mean: 0.0, mean p set: 0.4479128420352936
loss_pred:0.02825579047203064, decouple_loss:0.024110445752739906
loss_pred:0.029407793655991554, decouple_loss:0.022825833410024643
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796791672706604, gen p mean: 0.0, mean p set: 0.44910797476768494
loss_pred:0.02878686413168907, decouple_loss:0.021769076585769653
The modified gen p mean: 0.4538128972053528, gen p mean: 0.0, mean p set: 0.4481779932975769
The modified gen p mean: 0.45521602034568787, gen p mean: 0.0, mean p set: 0.4480287730693817
loss_pred:0.030915817245841026, decouple_loss:0.0208778977394104
loss_pred:0.03094416670501232, decouple_loss:0.02089965157210827
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4672001600265503, gen p mean: 0.0, mean p set: 0.44867458939552307The modified gen p mean: 0.4523898661136627, gen p mean: 0.0, mean p set: 0.4493279755115509
loss_pred:0.030903592705726624, decouple_loss:0.022341197356581688
loss_pred:0.028013823553919792, decouple_loss:0.021675914525985718
The modified gen p mean: 0.4575429856777191, gen p mean: 0.0, mean p set: 0.4494233727455139
loss_pred:0.030210431665182114, decouple_loss:0.02209760993719101
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490918219089508, gen p mean: 0.0, mean p set: 0.44887375831604004
The modified gen p mean: 0.45039036870002747, gen p mean: 0.0, mean p set: 0.4505176842212677
loss_pred:0.03178684040904045, decouple_loss:0.02208014950156212
The modified gen p mean: 0.45431196689605713, gen p mean: 0.0, mean p set: 0.44814345240592957loss_pred:0.02837442234158516, decouple_loss:0.02116169035434723
loss_pred:0.03041986934840679, decouple_loss:0.021761015057563782
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43529364466667175, gen p mean: 0.0, mean p set: 0.44846272468566895
The modified gen p mean: 0.43621957302093506, gen p mean: 0.0, mean p set: 0.44920656085014343
loss_pred:0.0275574941188097, decouple_loss:0.022515496239066124
loss_pred:0.02909826673567295, decouple_loss:0.022892193868756294
The modified gen p mean: 0.4349791705608368, gen p mean: 0.0, mean p set: 0.4493709206581116
loss_pred:0.029216555878520012, decouple_loss:0.023407408967614174
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4401848614215851, gen p mean: 0.0, mean p set: 0.4494871497154236
The modified gen p mean: 0.4486270546913147, gen p mean: 0.0, mean p set: 0.4521370232105255
loss_pred:0.026600729674100876, decouple_loss:0.02198757603764534
loss_pred:0.028953474014997482, decouple_loss:0.021712707355618477The modified gen p mean: 0.4532163739204407, gen p mean: 0.0, mean p set: 0.44867774844169617
loss_pred:0.02958267740905285, decouple_loss:0.022533219307661057
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45464399456977844, gen p mean: 0.0, mean p set: 0.4502353370189667
loss_pred:0.028933849185705185, decouple_loss:0.020941711962223053
The modified gen p mean: 0.4569650888442993, gen p mean: 0.0, mean p set: 0.4504365622997284
The modified gen p mean: 0.4460468888282776, gen p mean: 0.0, mean p set: 0.4496400058269501
loss_pred:0.02884257584810257, decouple_loss:0.020463965833187103
loss_pred:0.028060661628842354, decouple_loss:0.02088320441544056
2023-05-04 10:35:29 testing...
The modified gen p mean: 0.45248010754585266, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.46330055594444275, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4600590169429779, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03083447925746441, decouple_loss:0.0209770817309618
loss_pred:0.029450437054038048, decouple_loss:0.0218263640999794
loss_pred:0.029887981712818146, decouple_loss:0.021172059699892998
WV_0_PC_0_EH_0_PS_40_6, loss: 0.031123891472816467, avg_mse: 0.03599615767598152
current test mse: 0.035996
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
NaN value num: 0
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4569128453731537, gen p mean: 0.0, mean p set: 0.4527485966682434
The modified gen p mean: 0.464629203081131, gen p mean: 0.0, mean p set: 0.45208099484443665
loss_pred:0.03031967580318451, decouple_loss:0.02226577326655388
loss_pred:0.03126620128750801, decouple_loss:0.023258501663804054
The modified gen p mean: 0.46543481945991516, gen p mean: 0.0, mean p set: 0.4524966776371002
loss_pred:0.03190937265753746, decouple_loss:0.02398618869483471
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43725162744522095, gen p mean: 0.0, mean p set: 0.4525245428085327
loss_pred:0.030079234391450882, decouple_loss:0.02306828834116459
The modified gen p mean: 0.44255074858665466, gen p mean: 0.0, mean p set: 0.4527277946472168
The modified gen p mean: 0.43380624055862427, gen p mean: 0.0, mean p set: 0.4517228305339813
loss_pred:0.03192456066608429, decouple_loss:0.02363406866788864
loss_pred:0.032743796706199646, decouple_loss:0.02244100347161293
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460727572441101, gen p mean: 0.0, mean p set: 0.45292118191719055
The modified gen p mean: 0.4369325041770935, gen p mean: 0.0, mean p set: 0.45223820209503174
loss_pred:0.032152317464351654, decouple_loss:0.02324078418314457
loss_pred:0.03056434914469719, decouple_loss:0.02126695029437542
The modified gen p mean: 0.44481393694877625, gen p mean: 0.0, mean p set: 0.4518997073173523
loss_pred:0.03214722126722336, decouple_loss:0.02297561801970005
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4568515717983246, gen p mean: 0.0, mean p set: 0.45064112544059753
The modified gen p mean: 0.45144620537757874, gen p mean: 0.0, mean p set: 0.45162433385849
loss_pred:0.03128918260335922, decouple_loss:0.022116029635071754
loss_pred:0.031500570476055145, decouple_loss:0.02352932281792164The modified gen p mean: 0.45503610372543335, gen p mean: 0.0, mean p set: 0.45195040106773376
loss_pred:0.029787994921207428, decouple_loss:0.022668620571494102
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.47201305627822876, gen p mean: 0.0, mean p set: 0.45127376914024353
The modified gen p mean: 0.46924686431884766, gen p mean: 0.0, mean p set: 0.4511549472808838
loss_pred:0.03174295276403427, decouple_loss:0.020236210897564888
loss_pred:0.03107060305774212, decouple_loss:0.020292207598686218
The modified gen p mean: 0.46784523129463196, gen p mean: 0.0, mean p set: 0.45069798827171326
loss_pred:0.02939877100288868, decouple_loss:0.020022470504045486
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44446608424186707, gen p mean: 0.0, mean p set: 0.45127442479133606The modified gen p mean: 0.4435432255268097, gen p mean: 0.0, mean p set: 0.45098650455474854
loss_pred:0.030590364709496498, decouple_loss:0.02048010565340519loss_pred:0.029152076691389084, decouple_loss:0.01945716328918934
The modified gen p mean: 0.4510137736797333, gen p mean: 0.0, mean p set: 0.45121118426322937
loss_pred:0.03060455061495304, decouple_loss:0.020381271839141846
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4374937415122986, gen p mean: 0.0, mean p set: 0.4520830810070038
loss_pred:0.0312834307551384, decouple_loss:0.02101360261440277
The modified gen p mean: 0.4366709887981415, gen p mean: 0.0, mean p set: 0.4518592655658722
The modified gen p mean: 0.43035802245140076, gen p mean: 0.0, mean p set: 0.4517037868499756
loss_pred:0.03117622621357441, decouple_loss:0.02063613571226597
loss_pred:0.03127129748463631, decouple_loss:0.020567016676068306
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756001234054565, gen p mean: 0.0, mean p set: 0.4537568688392639
The modified gen p mean: 0.4538992941379547, gen p mean: 0.0, mean p set: 0.45254722237586975
loss_pred:0.029390553012490273, decouple_loss:0.0216214656829834
loss_pred:0.02930201217532158, decouple_loss:0.02106863632798195
The modified gen p mean: 0.4554924964904785, gen p mean: 0.0, mean p set: 0.45037490129470825
loss_pred:0.031181544065475464, decouple_loss:0.02118172124028206
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45720139145851135, gen p mean: 0.0, mean p set: 0.45202142000198364
The modified gen p mean: 0.4587474763393402, gen p mean: 0.0, mean p set: 0.4517951011657715
loss_pred:0.030481891706585884, decouple_loss:0.019529597833752632
loss_pred:0.03073093853890896, decouple_loss:0.019768236204981804The modified gen p mean: 0.45214203000068665, gen p mean: 0.0, mean p set: 0.45274466276168823
loss_pred:0.030633531510829926, decouple_loss:0.0203216802328825
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45372605323791504, gen p mean: 0.0, mean p set: 0.45301714539527893
The modified gen p mean: 0.45757561922073364, gen p mean: 0.0, mean p set: 0.453695684671402
loss_pred:0.03063315525650978, decouple_loss:0.019942451268434525
loss_pred:0.029071513563394547, decouple_loss:0.019523601979017258
The modified gen p mean: 0.45626455545425415, gen p mean: 0.0, mean p set: 0.4543396830558777
loss_pred:0.02996348962187767, decouple_loss:0.020066281780600548
2023-05-04 10:39:42 testing...
The modified gen p mean: 0.45680710673332214, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.46870359778404236, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.46493422985076904, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.031371038407087326, decouple_loss:0.022153304889798164
loss_pred:0.030370596796274185, decouple_loss:0.02154061384499073
loss_pred:0.02975103072822094, decouple_loss:0.021535471081733704
WV_0_PC_0_EH_0_PS_40_6, loss: 0.031584713608026505, avg_mse: 0.03677310422062874
current test mse: 0.036773
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.47013601660728455, gen p mean: 0.0, mean p set: 0.4511275291442871
The modified gen p mean: 0.4636569321155548, gen p mean: 0.0, mean p set: 0.45274418592453003
loss_pred:0.03017081692814827, decouple_loss:0.01971183717250824
loss_pred:0.028368035331368446, decouple_loss:0.018917599692940712
The modified gen p mean: 0.46086883544921875, gen p mean: 0.0, mean p set: 0.4520838260650635
loss_pred:0.030005089938640594, decouple_loss:0.019356660544872284
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43125975131988525, gen p mean: 0.0, mean p set: 0.45287254452705383
The modified gen p mean: 0.4381793439388275, gen p mean: 0.0, mean p set: 0.45209240913391113
loss_pred:0.030157743021845818, decouple_loss:0.019305359572172165
loss_pred:0.029193291440606117, decouple_loss:0.01873183622956276The modified gen p mean: 0.4322657287120819, gen p mean: 0.0, mean p set: 0.4530346095561981
loss_pred:0.02947448566555977, decouple_loss:0.01947086490690708
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497314393520355, gen p mean: 0.0, mean p set: 0.4519197940826416
The modified gen p mean: 0.44775131344795227, gen p mean: 0.0, mean p set: 0.45222529768943787
loss_pred:0.029683411121368408, decouple_loss:0.01926911436021328
loss_pred:0.03042674995958805, decouple_loss:0.019424650818109512The modified gen p mean: 0.44572216272354126, gen p mean: 0.0, mean p set: 0.4511306881904602
loss_pred:0.02873455174267292, decouple_loss:0.018443111330270767
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488699734210968, gen p mean: 0.0, mean p set: 0.4539199471473694
The modified gen p mean: 0.45310524106025696, gen p mean: 0.0, mean p set: 0.4537709653377533
loss_pred:0.027935752645134926, decouple_loss:0.018103864043951035
loss_pred:0.02926217019557953, decouple_loss:0.019022278487682343
The modified gen p mean: 0.4556896984577179, gen p mean: 0.0, mean p set: 0.45118778944015503
loss_pred:0.029310617595911026, decouple_loss:0.01912984997034073
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4549552798271179, gen p mean: 0.0, mean p set: 0.45160651206970215
The modified gen p mean: 0.4510040879249573, gen p mean: 0.0, mean p set: 0.451918363571167
loss_pred:0.030417080968618393, decouple_loss:0.01842339336872101
loss_pred:0.029151400551199913, decouple_loss:0.018113436177372932The modified gen p mean: 0.4527498781681061, gen p mean: 0.0, mean p set: 0.4516591429710388
loss_pred:0.028982844203710556, decouple_loss:0.01860673725605011
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506908059120178, gen p mean: 0.0, mean p set: 0.45318475365638733
The modified gen p mean: 0.45453521609306335, gen p mean: 0.0, mean p set: 0.4515587389469147
loss_pred:0.027499916031956673, decouple_loss:0.016949083656072617
The modified gen p mean: 0.4621868431568146, gen p mean: 0.0, mean p set: 0.4524519443511963
loss_pred:0.02937406115233898, decouple_loss:0.017909390851855278
loss_pred:0.0303786750882864, decouple_loss:0.017718592658638954
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4540916681289673, gen p mean: 0.0, mean p set: 0.45445236563682556
The modified gen p mean: 0.45654991269111633, gen p mean: 0.0, mean p set: 0.45159485936164856
loss_pred:0.029620908200740814, decouple_loss:0.018135033547878265
The modified gen p mean: 0.4587591290473938, gen p mean: 0.0, mean p set: 0.4516381621360779loss_pred:0.028461609035730362, decouple_loss:0.017483187839388847
loss_pred:0.029831787571310997, decouple_loss:0.01796121895313263
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461645483970642, gen p mean: 0.0, mean p set: 0.45165136456489563
The modified gen p mean: 0.45052051544189453, gen p mean: 0.0, mean p set: 0.4506949186325073
loss_pred:0.02944389171898365, decouple_loss:0.016418643295764923
loss_pred:0.030590230599045753, decouple_loss:0.01670905388891697
The modified gen p mean: 0.44150012731552124, gen p mean: 0.0, mean p set: 0.45204612612724304
loss_pred:0.02821020781993866, decouple_loss:0.01690203696489334
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44981643557548523, gen p mean: 0.0, mean p set: 0.4510461390018463
loss_pred:0.030224207788705826, decouple_loss:0.017194757238030434
The modified gen p mean: 0.45949259400367737, gen p mean: 0.0, mean p set: 0.45119786262512207
The modified gen p mean: 0.4485217332839966, gen p mean: 0.0, mean p set: 0.45226770639419556
loss_pred:0.028185509145259857, decouple_loss:0.016760673373937607
loss_pred:0.029345504939556122, decouple_loss:0.01792064681649208
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
NaN value num: 0
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45625609159469604, gen p mean: 0.0, mean p set: 0.44701069593429565
The modified gen p mean: 0.46083688735961914, gen p mean: 0.0, mean p set: 0.44824421405792236
loss_pred:0.031186873093247414, decouple_loss:0.018867772072553635
The modified gen p mean: 0.45695382356643677, gen p mean: 0.0, mean p set: 0.4467698633670807
loss_pred:0.0302420686930418, decouple_loss:0.02042302116751671
loss_pred:0.03135210648179054, decouple_loss:0.021039359271526337
2023-05-04 10:44:06 testing...
The modified gen p mean: 0.4342138171195984, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44202178716659546, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44596850872039795, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.030914487317204475, decouple_loss:0.02015094831585884
loss_pred:0.029911067336797714, decouple_loss:0.019290361553430557
loss_pred:0.02922804467380047, decouple_loss:0.019361712038517
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03099791705608368, avg_mse: 0.03623177856206894
current test mse: 0.036232
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43507713079452515, gen p mean: 0.0, mean p set: 0.4475935399532318
The modified gen p mean: 0.44058308005332947, gen p mean: 0.0, mean p set: 0.44693848490715027
loss_pred:0.030086634680628777, decouple_loss:0.02032877691090107
loss_pred:0.030740659683942795, decouple_loss:0.019428221508860588
The modified gen p mean: 0.43840116262435913, gen p mean: 0.0, mean p set: 0.4481023848056793
loss_pred:0.030597342178225517, decouple_loss:0.019654005765914917
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.441114604473114, gen p mean: 0.0, mean p set: 0.44753962755203247
The modified gen p mean: 0.44032615423202515, gen p mean: 0.0, mean p set: 0.44771823287010193
loss_pred:0.030081303790211678, decouple_loss:0.018826033920049667
loss_pred:0.03056805394589901, decouple_loss:0.019560333341360092The modified gen p mean: 0.440122127532959, gen p mean: 0.0, mean p set: 0.44859179854393005
loss_pred:0.028811192139983177, decouple_loss:0.018500661477446556
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4588486850261688, gen p mean: 0.0, mean p set: 0.44728490710258484
loss_pred:0.029372433200478554, decouple_loss:0.02040504850447178
The modified gen p mean: 0.46078813076019287, gen p mean: 0.0, mean p set: 0.4483358860015869
The modified gen p mean: 0.45749905705451965, gen p mean: 0.0, mean p set: 0.4473547637462616
loss_pred:0.030535144731402397, decouple_loss:0.018787873908877373
loss_pred:0.02962920255959034, decouple_loss:0.019789811223745346
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4402686357498169, gen p mean: 0.0, mean p set: 0.4489297568798065
The modified gen p mean: 0.44520464539527893, gen p mean: 0.0, mean p set: 0.4473278820514679
loss_pred:0.028931204229593277, decouple_loss:0.017169620841741562
The modified gen p mean: 0.44894981384277344, gen p mean: 0.0, mean p set: 0.44820523262023926loss_pred:0.030494047328829765, decouple_loss:0.017355727031826973
loss_pred:0.030811164528131485, decouple_loss:0.016613127663731575
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44558611512184143, gen p mean: 0.0, mean p set: 0.4471152722835541
The modified gen p mean: 0.4385804533958435, gen p mean: 0.0, mean p set: 0.4495074450969696
loss_pred:0.029851866886019707, decouple_loss:0.01636318489909172
loss_pred:0.029828708618879318, decouple_loss:0.016967039555311203
The modified gen p mean: 0.4424501359462738, gen p mean: 0.0, mean p set: 0.44789600372314453
loss_pred:0.030279412865638733, decouple_loss:0.016898272559046745
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462481141090393, gen p mean: 0.0, mean p set: 0.4480431377887726
The modified gen p mean: 0.45732611417770386, gen p mean: 0.0, mean p set: 0.4484597444534302
loss_pred:0.030266201123595238, decouple_loss:0.017656145617365837
loss_pred:0.02998112142086029, decouple_loss:0.017473852261900902The modified gen p mean: 0.4455927610397339, gen p mean: 0.0, mean p set: 0.4483281373977661
loss_pred:0.030017612501978874, decouple_loss:0.017982754856348038
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4423190951347351, gen p mean: 0.0, mean p set: 0.44939130544662476
The modified gen p mean: 0.450190931558609, gen p mean: 0.0, mean p set: 0.44717973470687866
loss_pred:0.029290759935975075, decouple_loss:0.017818162217736244
loss_pred:0.030527599155902863, decouple_loss:0.017994925379753113
The modified gen p mean: 0.45010310411453247, gen p mean: 0.0, mean p set: 0.4470527172088623
loss_pred:0.03148627281188965, decouple_loss:0.017610931769013405
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.443389356136322, gen p mean: 0.0, mean p set: 0.4481962025165558
The modified gen p mean: 0.4475157856941223, gen p mean: 0.0, mean p set: 0.44863173365592957
loss_pred:0.029857955873012543, decouple_loss:0.016423344612121582
The modified gen p mean: 0.44467219710350037, gen p mean: 0.0, mean p set: 0.448716402053833loss_pred:0.02897731028497219, decouple_loss:0.01704634539783001
loss_pred:0.02786044217646122, decouple_loss:0.01682394929230213
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796010851860046, gen p mean: 0.0, mean p set: 0.44620317220687866
The modified gen p mean: 0.4417128264904022, gen p mean: 0.0, mean p set: 0.4475752115249634
loss_pred:0.02913786843419075, decouple_loss:0.017310764640569687
loss_pred:0.028660206124186516, decouple_loss:0.01740807667374611The modified gen p mean: 0.4426973760128021, gen p mean: 0.0, mean p set: 0.4480331242084503
loss_pred:0.02842245064675808, decouple_loss:0.016538290306925774
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749167561531067, gen p mean: 0.0, mean p set: 0.4489063620567322
The modified gen p mean: 0.45526474714279175, gen p mean: 0.0, mean p set: 0.4482572078704834
loss_pred:0.029305357486009598, decouple_loss:0.01631978340446949
The modified gen p mean: 0.4515189528465271, gen p mean: 0.0, mean p set: 0.4482213854789734loss_pred:0.029953543096780777, decouple_loss:0.01612098515033722
loss_pred:0.02779102697968483, decouple_loss:0.016110582277178764
2023-05-04 10:47:39 testing...
The modified gen p mean: 0.4522493779659271, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.46426886320114136, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.46059441566467285, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.029982594773173332, decouple_loss:0.01713935099542141
loss_pred:0.028562722727656364, decouple_loss:0.017669690772891045
loss_pred:0.029122307896614075, decouple_loss:0.017120204865932465
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03008802980184555, avg_mse: 0.03500758484005928
current test mse: 0.035008
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.454108864068985, gen p mean: 0.0, mean p set: 0.447655588388443The modified gen p mean: 0.4564259946346283, gen p mean: 0.0, mean p set: 0.4471314251422882
loss_pred:0.029784241691231728, decouple_loss:0.01732506975531578
loss_pred:0.029122594743967056, decouple_loss:0.018092552199959755
The modified gen p mean: 0.45921146869659424, gen p mean: 0.0, mean p set: 0.44682762026786804
loss_pred:0.0281063262373209, decouple_loss:0.017842687666416168
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511992931365967, gen p mean: 0.0, mean p set: 0.4476478397846222
loss_pred:0.02940043807029724, decouple_loss:0.016155211254954338
The modified gen p mean: 0.44248512387275696, gen p mean: 0.0, mean p set: 0.44764068722724915
The modified gen p mean: 0.44601887464523315, gen p mean: 0.0, mean p set: 0.44836893677711487
loss_pred:0.028931457549333572, decouple_loss:0.015686703845858574
loss_pred:0.028825297951698303, decouple_loss:0.016957130283117294
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43729421496391296, gen p mean: 0.0, mean p set: 0.447354793548584
loss_pred:0.030292684212327003, decouple_loss:0.01616845093667507
The modified gen p mean: 0.4406205415725708, gen p mean: 0.0, mean p set: 0.44742879271507263
The modified gen p mean: 0.43035683035850525, gen p mean: 0.0, mean p set: 0.44940972328186035
loss_pred:0.028253015130758286, decouple_loss:0.015932325273752213
loss_pred:0.030440745875239372, decouple_loss:0.016388168558478355
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4563642740249634, gen p mean: 0.0, mean p set: 0.4473206102848053
The modified gen p mean: 0.4555985927581787, gen p mean: 0.0, mean p set: 0.4484526515007019
loss_pred:0.03029521554708481, decouple_loss:0.015864001587033272
loss_pred:0.029129622504115105, decouple_loss:0.015184936113655567
The modified gen p mean: 0.4559323489665985, gen p mean: 0.0, mean p set: 0.4477632939815521
loss_pred:0.02976788952946663, decouple_loss:0.01632332243025303
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514969289302826, gen p mean: 0.0, mean p set: 0.4486939311027527
loss_pred:0.02949782833456993, decouple_loss:0.015001235529780388
The modified gen p mean: 0.44726279377937317, gen p mean: 0.0, mean p set: 0.44660601019859314
The modified gen p mean: 0.441654771566391, gen p mean: 0.0, mean p set: 0.448288232088089
loss_pred:0.028331924229860306, decouple_loss:0.01530658733099699
loss_pred:0.028158152475953102, decouple_loss:0.015226035378873348
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44280028343200684, gen p mean: 0.0, mean p set: 0.4463379681110382
loss_pred:0.029191553592681885, decouple_loss:0.015362180769443512
The modified gen p mean: 0.4400305449962616, gen p mean: 0.0, mean p set: 0.44858479499816895
The modified gen p mean: 0.433212012052536, gen p mean: 0.0, mean p set: 0.4491514265537262
loss_pred:0.027384478598833084, decouple_loss:0.015623843297362328
loss_pred:0.028434008359909058, decouple_loss:0.01485449355095625
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4564170241355896, gen p mean: 0.0, mean p set: 0.44849663972854614
loss_pred:0.029010068625211716, decouple_loss:0.013990950770676136
The modified gen p mean: 0.451623797416687, gen p mean: 0.0, mean p set: 0.44829070568084717
The modified gen p mean: 0.45799022912979126, gen p mean: 0.0, mean p set: 0.44684910774230957
loss_pred:0.029419204220175743, decouple_loss:0.014988139271736145
loss_pred:0.029253993183374405, decouple_loss:0.015517252497375011
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488697052001953, gen p mean: 0.0, mean p set: 0.4478229880332947
loss_pred:0.028257550671696663, decouple_loss:0.015843285247683525
The modified gen p mean: 0.45580166578292847, gen p mean: 0.0, mean p set: 0.44750040769577026
The modified gen p mean: 0.4586121439933777, gen p mean: 0.0, mean p set: 0.44834673404693604
loss_pred:0.029577793553471565, decouple_loss:0.014520314522087574
loss_pred:0.028867820277810097, decouple_loss:0.014779580757021904
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4368639588356018, gen p mean: 0.0, mean p set: 0.44750818610191345
loss_pred:0.028212742879986763, decouple_loss:0.014476670883595943
The modified gen p mean: 0.44313469529151917, gen p mean: 0.0, mean p set: 0.4473547041416168
The modified gen p mean: 0.43791520595550537, gen p mean: 0.0, mean p set: 0.4475308060646057
loss_pred:0.02836533449590206, decouple_loss:0.01540696807205677
loss_pred:0.02880866453051567, decouple_loss:0.014043810777366161
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
NaN value num: 0
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524618089199066, gen p mean: 0.0, mean p set: 0.45004045963287354
The modified gen p mean: 0.4506389796733856, gen p mean: 0.0, mean p set: 0.450794517993927
loss_pred:0.028558796271681786, decouple_loss:0.016446858644485474
The modified gen p mean: 0.4523097276687622, gen p mean: 0.0, mean p set: 0.4512827396392822
loss_pred:0.028859173879027367, decouple_loss:0.015967121347784996
loss_pred:0.02938024140894413, decouple_loss:0.01640699990093708
2023-05-04 10:51:54 testing...
The modified gen p mean: 0.4465465545654297, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4542061388492584, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4581036865711212, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.029834024608135223, decouple_loss:0.014526451006531715
loss_pred:0.028836263343691826, decouple_loss:0.01498290617018938
loss_pred:0.028385533019900322, decouple_loss:0.01567399874329567
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02977166324853897, avg_mse: 0.034810855984687805
current test mse: 0.034811
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44966205954551697, gen p mean: 0.0, mean p set: 0.4498981535434723
The modified gen p mean: 0.45241522789001465, gen p mean: 0.0, mean p set: 0.4488649070262909
loss_pred:0.027963196858763695, decouple_loss:0.015640664845705032
loss_pred:0.028322000056505203, decouple_loss:0.01609502173960209
The modified gen p mean: 0.4592162072658539, gen p mean: 0.0, mean p set: 0.4516826570034027
loss_pred:0.0299421027302742, decouple_loss:0.01621738262474537
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4599127471446991, gen p mean: 0.0, mean p set: 0.45117807388305664
The modified gen p mean: 0.44997474551200867, gen p mean: 0.0, mean p set: 0.45187628269195557
loss_pred:0.02908220887184143, decouple_loss:0.015329972840845585
loss_pred:0.028565693646669388, decouple_loss:0.016195379197597504The modified gen p mean: 0.4575733542442322, gen p mean: 0.0, mean p set: 0.4524483382701874
loss_pred:0.03006543032824993, decouple_loss:0.01642635092139244
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4446457028388977, gen p mean: 0.0, mean p set: 0.45080307126045227
The modified gen p mean: 0.44577670097351074, gen p mean: 0.0, mean p set: 0.45039525628089905
loss_pred:0.02854933775961399, decouple_loss:0.01532488502562046
loss_pred:0.028988979756832123, decouple_loss:0.015232555568218231The modified gen p mean: 0.44820430874824524, gen p mean: 0.0, mean p set: 0.45146021246910095
loss_pred:0.028668643906712532, decouple_loss:0.01522771641612053
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.438407301902771, gen p mean: 0.0, mean p set: 0.4507656991481781
loss_pred:0.029648343101143837, decouple_loss:0.01736774481832981
The modified gen p mean: 0.43954822421073914, gen p mean: 0.0, mean p set: 0.4520801901817322
The modified gen p mean: 0.4433195888996124, gen p mean: 0.0, mean p set: 0.45236828923225403
loss_pred:0.030896635726094246, decouple_loss:0.01615079864859581
loss_pred:0.027850519865751266, decouple_loss:0.015707427635788918
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4630686938762665, gen p mean: 0.0, mean p set: 0.4517787992954254
The modified gen p mean: 0.4575229287147522, gen p mean: 0.0, mean p set: 0.4524140954017639
loss_pred:0.028207408264279366, decouple_loss:0.015067306347191334
loss_pred:0.02828039415180683, decouple_loss:0.016561737284064293The modified gen p mean: 0.464187353849411, gen p mean: 0.0, mean p set: 0.4515541195869446
loss_pred:0.028068168088793755, decouple_loss:0.015157127752900124
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515363276004791, gen p mean: 0.0, mean p set: 0.4519265294075012
The modified gen p mean: 0.45159223675727844, gen p mean: 0.0, mean p set: 0.4516323506832123loss_pred:0.029100267216563225, decouple_loss:0.0161411315202713
The modified gen p mean: 0.4586186707019806, gen p mean: 0.0, mean p set: 0.45234063267707825
loss_pred:0.028052721172571182, decouple_loss:0.01589183136820793
loss_pred:0.029677797108888626, decouple_loss:0.015166015364229679
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45064935088157654, gen p mean: 0.0, mean p set: 0.44899213314056396
loss_pred:0.028200063854455948, decouple_loss:0.015697292983531952
The modified gen p mean: 0.4528275430202484, gen p mean: 0.0, mean p set: 0.45138245820999146
The modified gen p mean: 0.451235294342041, gen p mean: 0.0, mean p set: 0.45278817415237427
loss_pred:0.03043782152235508, decouple_loss:0.015011016279459
loss_pred:0.028668522834777832, decouple_loss:0.014308517798781395
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464634656906128, gen p mean: 0.0, mean p set: 0.4511964023113251
loss_pred:0.028053877875208855, decouple_loss:0.01567411795258522
The modified gen p mean: 0.4527003765106201, gen p mean: 0.0, mean p set: 0.4515576958656311
The modified gen p mean: 0.447089821100235, gen p mean: 0.0, mean p set: 0.45199936628341675
loss_pred:0.02837936021387577, decouple_loss:0.014997762627899647
loss_pred:0.029467729851603508, decouple_loss:0.015289360657334328
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45509687066078186, gen p mean: 0.0, mean p set: 0.44990551471710205
The modified gen p mean: 0.4489781856536865, gen p mean: 0.0, mean p set: 0.45249274373054504
loss_pred:0.02769075334072113, decouple_loss:0.014177382923662663
loss_pred:0.029516318812966347, decouple_loss:0.014929229393601418
The modified gen p mean: 0.45171427726745605, gen p mean: 0.0, mean p set: 0.45210859179496765
loss_pred:0.028560571372509003, decouple_loss:0.014545917510986328
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474942684173584, gen p mean: 0.0, mean p set: 0.4505898058414459
The modified gen p mean: 0.44976022839546204, gen p mean: 0.0, mean p set: 0.45117560029029846
loss_pred:0.028364481404423714, decouple_loss:0.014761761762201786
loss_pred:0.027227871119976044, decouple_loss:0.014414624311029911The modified gen p mean: 0.4467220604419708, gen p mean: 0.0, mean p set: 0.45408543944358826
loss_pred:0.028033003211021423, decouple_loss:0.014532058499753475
2023-05-04 10:55:25 testing...
The modified gen p mean: 0.440958708524704, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44903141260147095, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4533229470252991, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.030034294351935387, decouple_loss:0.016792815178632736
loss_pred:0.02906069904565811, decouple_loss:0.016393696889281273
loss_pred:0.02855273149907589, decouple_loss:0.01676802709698677
WV_0_PC_0_EH_0_PS_40_6, loss: 0.030048485845327377, avg_mse: 0.03519024699926376
current test mse: 0.03519
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44459548592567444, gen p mean: 0.0, mean p set: 0.4524848163127899
The modified gen p mean: 0.4490135610103607, gen p mean: 0.0, mean p set: 0.45163723826408386
loss_pred:0.0281002689152956, decouple_loss:0.01656915806233883
loss_pred:0.02839701622724533, decouple_loss:0.014257379807531834
The modified gen p mean: 0.45228323340415955, gen p mean: 0.0, mean p set: 0.44960349798202515
loss_pred:0.027562277391552925, decouple_loss:0.014367664232850075
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472765028476715, gen p mean: 0.0, mean p set: 0.4519501030445099
loss_pred:0.02777460217475891, decouple_loss:0.015798421576619148
The modified gen p mean: 0.4507494866847992, gen p mean: 0.0, mean p set: 0.45355916023254395
The modified gen p mean: 0.4509652853012085, gen p mean: 0.0, mean p set: 0.45293283462524414
loss_pred:0.028363166376948357, decouple_loss:0.013723360374569893
loss_pred:0.028625627979636192, decouple_loss:0.01371588185429573
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4584192633628845, gen p mean: 0.0, mean p set: 0.45388877391815186
loss_pred:0.02837672270834446, decouple_loss:0.014181585982441902
The modified gen p mean: 0.4668067991733551, gen p mean: 0.0, mean p set: 0.45141345262527466
The modified gen p mean: 0.4641445577144623, gen p mean: 0.0, mean p set: 0.452106237411499
loss_pred:0.028070272877812386, decouple_loss:0.01567034050822258
loss_pred:0.029437560588121414, decouple_loss:0.014268807135522366
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4541518986225128, gen p mean: 0.0, mean p set: 0.4503856897354126
The modified gen p mean: 0.44868528842926025, gen p mean: 0.0, mean p set: 0.45304831862449646
loss_pred:0.029011642560362816, decouple_loss:0.015025405213236809
loss_pred:0.028658654540777206, decouple_loss:0.01410604827105999
The modified gen p mean: 0.45555323362350464, gen p mean: 0.0, mean p set: 0.45126447081565857
loss_pred:0.02827299013733864, decouple_loss:0.01377912238240242
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43131202459335327, gen p mean: 0.0, mean p set: 0.4519835412502289
loss_pred:0.02759268693625927, decouple_loss:0.015542827546596527
The modified gen p mean: 0.4322037398815155, gen p mean: 0.0, mean p set: 0.451731413602829
The modified gen p mean: 0.43603914976119995, gen p mean: 0.0, mean p set: 0.44981685280799866
loss_pred:0.026991767808794975, decouple_loss:0.014137625694274902
loss_pred:0.030120667070150375, decouple_loss:0.01438207644969225
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45825910568237305, gen p mean: 0.0, mean p set: 0.4503021836280823
loss_pred:0.027665913105010986, decouple_loss:0.012997684068977833
The modified gen p mean: 0.45546454191207886, gen p mean: 0.0, mean p set: 0.4510754346847534
The modified gen p mean: 0.45575568079948425, gen p mean: 0.0, mean p set: 0.4501255452632904
loss_pred:0.02720852755010128, decouple_loss:0.013687432743608952
loss_pred:0.02712651714682579, decouple_loss:0.012935460545122623
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46274808049201965, gen p mean: 0.0, mean p set: 0.4516221284866333
loss_pred:0.027665965259075165, decouple_loss:0.014158586971461773
The modified gen p mean: 0.4592815935611725, gen p mean: 0.0, mean p set: 0.45082327723503113
The modified gen p mean: 0.4543760120868683, gen p mean: 0.0, mean p set: 0.452907919883728
loss_pred:0.02850758284330368, decouple_loss:0.013735156506299973
loss_pred:0.028300410136580467, decouple_loss:0.014044479466974735
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529423415660858, gen p mean: 0.0, mean p set: 0.4511864483356476
The modified gen p mean: 0.44801920652389526, gen p mean: 0.0, mean p set: 0.4517843425273895
loss_pred:0.028099510818719864, decouple_loss:0.0144125921651721
loss_pred:0.03080058842897415, decouple_loss:0.01407435443252325The modified gen p mean: 0.44362059235572815, gen p mean: 0.0, mean p set: 0.4515494108200073
loss_pred:0.027564067393541336, decouple_loss:0.014336781576275826
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44624707102775574, gen p mean: 0.0, mean p set: 0.4511508643627167
loss_pred:0.027888823300600052, decouple_loss:0.013374580070376396
The modified gen p mean: 0.44720712304115295, gen p mean: 0.0, mean p set: 0.4510097801685333
The modified gen p mean: 0.4469777047634125, gen p mean: 0.0, mean p set: 0.4519629180431366
loss_pred:0.027243701741099358, decouple_loss:0.013571769930422306
loss_pred:0.027757413685321808, decouple_loss:0.012521839700639248
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
NaN value num: 0
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45203304290771484, gen p mean: 0.0, mean p set: 0.45121368765830994
The modified gen p mean: 0.4501613974571228, gen p mean: 0.0, mean p set: 0.45078325271606445
loss_pred:0.027839018031954765, decouple_loss:0.013435225002467632
The modified gen p mean: 0.45286697149276733, gen p mean: 0.0, mean p set: 0.4505395293235779
loss_pred:0.025970833376049995, decouple_loss:0.012942076660692692
loss_pred:0.029183372855186462, decouple_loss:0.01365641225129366
2023-05-04 11:00:42 testing...
The modified gen p mean: 0.4378489553928375, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44641998410224915, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.450301855802536, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.029737815260887146, decouple_loss:0.014800693839788437
loss_pred:0.028737884014844894, decouple_loss:0.01441777590662241
loss_pred:0.028161438181996346, decouple_loss:0.015176319517195225
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02961895987391472, avg_mse: 0.03459317609667778
current test mse: 0.034593
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449955016374588, gen p mean: 0.0, mean p set: 0.45064541697502136
The modified gen p mean: 0.45221805572509766, gen p mean: 0.0, mean p set: 0.4509085714817047
loss_pred:0.027991002425551414, decouple_loss:0.013037721626460552
loss_pred:0.027887126430869102, decouple_loss:0.013113672845065594
The modified gen p mean: 0.4510577619075775, gen p mean: 0.0, mean p set: 0.45034751296043396
loss_pred:0.02883446402847767, decouple_loss:0.013917592354118824
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4571414291858673, gen p mean: 0.0, mean p set: 0.4491414725780487
loss_pred:0.02807130664587021, decouple_loss:0.013378051109611988
The modified gen p mean: 0.44948747754096985, gen p mean: 0.0, mean p set: 0.44861045479774475
The modified gen p mean: 0.4549095630645752, gen p mean: 0.0, mean p set: 0.45098215341567993
loss_pred:0.02846117503941059, decouple_loss:0.013367562554776669
loss_pred:0.02783779613673687, decouple_loss:0.012735391966998577
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44474777579307556, gen p mean: 0.0, mean p set: 0.4481392800807953
loss_pred:0.027742872014641762, decouple_loss:0.013163372874259949
The modified gen p mean: 0.444805383682251, gen p mean: 0.0, mean p set: 0.44936615228652954
The modified gen p mean: 0.4569658935070038, gen p mean: 0.0, mean p set: 0.44860953092575073
loss_pred:0.027220996096730232, decouple_loss:0.01363211777061224
loss_pred:0.027301862835884094, decouple_loss:0.012770743109285831
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44878390431404114, gen p mean: 0.0, mean p set: 0.4514385461807251
The modified gen p mean: 0.4527015686035156, gen p mean: 0.0, mean p set: 0.4504702091217041
loss_pred:0.02841123752295971, decouple_loss:0.01300046220421791
loss_pred:0.028023481369018555, decouple_loss:0.013438531197607517
The modified gen p mean: 0.4504087269306183, gen p mean: 0.0, mean p set: 0.44999319314956665
loss_pred:0.027702879160642624, decouple_loss:0.012638814747333527
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4443452060222626, gen p mean: 0.0, mean p set: 0.44999101758003235
The modified gen p mean: 0.44121143221855164, gen p mean: 0.0, mean p set: 0.4492228329181671
loss_pred:0.02814539149403572, decouple_loss:0.012475663796067238
loss_pred:0.02840752713382244, decouple_loss:0.013725499622523785
The modified gen p mean: 0.44287818670272827, gen p mean: 0.0, mean p set: 0.44903048872947693
loss_pred:0.028172330930829048, decouple_loss:0.012456865981221199
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45174986124038696, gen p mean: 0.0, mean p set: 0.4499356150627136
The modified gen p mean: 0.45182427763938904, gen p mean: 0.0, mean p set: 0.4505808651447296loss_pred:0.0272776260972023, decouple_loss:0.012682442553341389
The modified gen p mean: 0.4504848122596741, gen p mean: 0.0, mean p set: 0.4507155418395996
loss_pred:0.027434052899479866, decouple_loss:0.012556982226669788
loss_pred:0.026362013071775436, decouple_loss:0.012897340580821037
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471381902694702, gen p mean: 0.0, mean p set: 0.44827306270599365
The modified gen p mean: 0.4397335648536682, gen p mean: 0.0, mean p set: 0.44978684186935425
loss_pred:0.02782798558473587, decouple_loss:0.012931241653859615
loss_pred:0.027434708550572395, decouple_loss:0.013011896051466465
The modified gen p mean: 0.4416961073875427, gen p mean: 0.0, mean p set: 0.4490853548049927
loss_pred:0.027640068903565407, decouple_loss:0.012756193056702614
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46777474880218506, gen p mean: 0.0, mean p set: 0.45048466324806213
loss_pred:0.028156457468867302, decouple_loss:0.012421473860740662
The modified gen p mean: 0.4644089937210083, gen p mean: 0.0, mean p set: 0.44876495003700256
The modified gen p mean: 0.4630376696586609, gen p mean: 0.0, mean p set: 0.450225830078125
loss_pred:0.02967352606356144, decouple_loss:0.012799367308616638
loss_pred:0.027526389807462692, decouple_loss:0.01290200650691986
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45051416754722595, gen p mean: 0.0, mean p set: 0.4509481191635132
loss_pred:0.027767395600676537, decouple_loss:0.012612874619662762
The modified gen p mean: 0.4489816725254059, gen p mean: 0.0, mean p set: 0.45167189836502075
The modified gen p mean: 0.44643428921699524, gen p mean: 0.0, mean p set: 0.44887450337409973
loss_pred:0.026787474751472473, decouple_loss:0.012683535926043987
loss_pred:0.026003850623965263, decouple_loss:0.012869267724454403
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4353550374507904, gen p mean: 0.0, mean p set: 0.4488454759120941
The modified gen p mean: 0.4433557689189911, gen p mean: 0.0, mean p set: 0.4499700367450714
loss_pred:0.027861563488841057, decouple_loss:0.012218683026731014
loss_pred:0.027948394417762756, decouple_loss:0.013256081379950047The modified gen p mean: 0.4400362968444824, gen p mean: 0.0, mean p set: 0.4496622681617737
loss_pred:0.027398819103837013, decouple_loss:0.01236767414957285
2023-05-04 11:04:15 testing...
The modified gen p mean: 0.4411204159259796, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44965705275535583, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45340821146965027, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02972489781677723, decouple_loss:0.014317158609628677
loss_pred:0.028627166524529457, decouple_loss:0.013750608079135418
loss_pred:0.02818407490849495, decouple_loss:0.01414715126156807
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02954896353185177, avg_mse: 0.03465801477432251
current test mse: 0.034658
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4551049470901489, gen p mean: 0.0, mean p set: 0.4506658911705017
The modified gen p mean: 0.4473755657672882, gen p mean: 0.0, mean p set: 0.44984734058380127
loss_pred:0.027666637673974037, decouple_loss:0.012510968372225761
loss_pred:0.02816201187670231, decouple_loss:0.012536365538835526
The modified gen p mean: 0.4473380446434021, gen p mean: 0.0, mean p set: 0.4492338001728058
loss_pred:0.027815058827400208, decouple_loss:0.01244919653981924
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4572812616825104, gen p mean: 0.0, mean p set: 0.4493105113506317
The modified gen p mean: 0.4487578868865967, gen p mean: 0.0, mean p set: 0.4498175084590912
loss_pred:0.027924755588173866, decouple_loss:0.012045598588883877
The modified gen p mean: 0.4557754695415497, gen p mean: 0.0, mean p set: 0.4497472941875458loss_pred:0.027633115649223328, decouple_loss:0.012529824860394001
loss_pred:0.027465777471661568, decouple_loss:0.01179850660264492
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489715099334717, gen p mean: 0.0, mean p set: 0.4495784640312195
The modified gen p mean: 0.45178407430648804, gen p mean: 0.0, mean p set: 0.44904738664627075
loss_pred:0.027602288872003555, decouple_loss:0.011901975609362125
loss_pred:0.027470476925373077, decouple_loss:0.01225610077381134The modified gen p mean: 0.45556920766830444, gen p mean: 0.0, mean p set: 0.44955530762672424
loss_pred:0.027187347412109375, decouple_loss:0.01226840727031231
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44435787200927734, gen p mean: 0.0, mean p set: 0.4506763517856598The modified gen p mean: 0.4445987939834595, gen p mean: 0.0, mean p set: 0.45137009024620056
loss_pred:0.027667487040162086, decouple_loss:0.011652497574687004
loss_pred:0.02554445154964924, decouple_loss:0.01210511289536953
The modified gen p mean: 0.4476407766342163, gen p mean: 0.0, mean p set: 0.44994959235191345
loss_pred:0.028141219168901443, decouple_loss:0.012064331211149693
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4433963894844055, gen p mean: 0.0, mean p set: 0.4497326612472534
loss_pred:0.028767088428139687, decouple_loss:0.011839903891086578
The modified gen p mean: 0.44324591755867004, gen p mean: 0.0, mean p set: 0.44889989495277405
The modified gen p mean: 0.4450168013572693, gen p mean: 0.0, mean p set: 0.4488237500190735
loss_pred:0.02792401798069477, decouple_loss:0.012060308828949928
loss_pred:0.027638765051960945, decouple_loss:0.012422886677086353
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4642117917537689, gen p mean: 0.0, mean p set: 0.44983452558517456
The modified gen p mean: 0.4645583927631378, gen p mean: 0.0, mean p set: 0.4488722085952759
loss_pred:0.027897488325834274, decouple_loss:0.012215729802846909
The modified gen p mean: 0.46509432792663574, gen p mean: 0.0, mean p set: 0.4505022168159485loss_pred:0.027888275682926178, decouple_loss:0.012216540984809399
loss_pred:0.028433803468942642, decouple_loss:0.012682083994150162
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4323156177997589, gen p mean: 0.0, mean p set: 0.4484439492225647
loss_pred:0.02780449576675892, decouple_loss:0.012177716940641403
The modified gen p mean: 0.43855053186416626, gen p mean: 0.0, mean p set: 0.45093539357185364
The modified gen p mean: 0.44269701838493347, gen p mean: 0.0, mean p set: 0.4494599997997284
loss_pred:0.027721092104911804, decouple_loss:0.011727159842848778
loss_pred:0.029053205624222755, decouple_loss:0.012492525391280651
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4380302131175995, gen p mean: 0.0, mean p set: 0.44921573996543884
The modified gen p mean: 0.4383908808231354, gen p mean: 0.0, mean p set: 0.45086273550987244
loss_pred:0.02723855897784233, decouple_loss:0.012359175831079483
The modified gen p mean: 0.4431070387363434, gen p mean: 0.0, mean p set: 0.4505380690097809loss_pred:0.028127970173954964, decouple_loss:0.013010017573833466
loss_pred:0.02718473970890045, decouple_loss:0.012083452194929123
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4568915069103241, gen p mean: 0.0, mean p set: 0.44780394434928894
The modified gen p mean: 0.4571978449821472, gen p mean: 0.0, mean p set: 0.44899222254753113
loss_pred:0.027745837345719337, decouple_loss:0.012510080821812153
loss_pred:0.02648760750889778, decouple_loss:0.011818374507129192The modified gen p mean: 0.4587548077106476, gen p mean: 0.0, mean p set: 0.4492644667625427
loss_pred:0.02749502845108509, decouple_loss:0.012480632402002811
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
NaN value num: 0
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4664829671382904, gen p mean: 0.0, mean p set: 0.45075103640556335
The modified gen p mean: 0.4639159142971039, gen p mean: 0.0, mean p set: 0.4494975507259369
loss_pred:0.02771850675344467, decouple_loss:0.012431538663804531
The modified gen p mean: 0.46055343747138977, gen p mean: 0.0, mean p set: 0.4496713876724243
loss_pred:0.027571646496653557, decouple_loss:0.012523435987532139
loss_pred:0.028131093829870224, decouple_loss:0.01324063166975975
2023-05-04 11:08:36 testing...
The modified gen p mean: 0.4371179938316345, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4249357283115387, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.43333548307418823, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.02827320247888565, decouple_loss:0.014444287866353989
loss_pred:0.02995588816702366, decouple_loss:0.014778677374124527
loss_pred:0.028743518516421318, decouple_loss:0.014124087989330292
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02971332147717476, avg_mse: 0.03477497771382332
current test mse: 0.034775
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43674418330192566, gen p mean: 0.0, mean p set: 0.4523118734359741
The modified gen p mean: 0.4420086443424225, gen p mean: 0.0, mean p set: 0.450996994972229
loss_pred:0.02801487222313881, decouple_loss:0.01237023901194334
loss_pred:0.026943108066916466, decouple_loss:0.012735948897898197
The modified gen p mean: 0.4382389485836029, gen p mean: 0.0, mean p set: 0.4495031237602234
loss_pred:0.027220670133829117, decouple_loss:0.012728712521493435
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4381784498691559, gen p mean: 0.0, mean p set: 0.4506444036960602
The modified gen p mean: 0.44151514768600464, gen p mean: 0.0, mean p set: 0.45179483294487
loss_pred:0.026860687881708145, decouple_loss:0.012860373593866825
loss_pred:0.0272823516279459, decouple_loss:0.013769923709332943
The modified gen p mean: 0.4302045702934265, gen p mean: 0.0, mean p set: 0.45027947425842285
loss_pred:0.02733622118830681, decouple_loss:0.013320840895175934
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523771405220032, gen p mean: 0.0, mean p set: 0.45036759972572327
The modified gen p mean: 0.4551146924495697, gen p mean: 0.0, mean p set: 0.45183131098747253
loss_pred:0.02775639109313488, decouple_loss:0.013164225965738297
loss_pred:0.025832630693912506, decouple_loss:0.012275687418878078The modified gen p mean: 0.4634073078632355, gen p mean: 0.0, mean p set: 0.45038288831710815
loss_pred:0.02799234725534916, decouple_loss:0.01293196901679039
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4628419280052185, gen p mean: 0.0, mean p set: 0.4488658010959625
loss_pred:0.027480779215693474, decouple_loss:0.011916528455913067
The modified gen p mean: 0.45698225498199463, gen p mean: 0.0, mean p set: 0.4505689740180969
The modified gen p mean: 0.4639149308204651, gen p mean: 0.0, mean p set: 0.4495818316936493
loss_pred:0.027408594265580177, decouple_loss:0.012264790944755077
loss_pred:0.02814123034477234, decouple_loss:0.012537031434476376
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768577814102173, gen p mean: 0.0, mean p set: 0.4516029953956604
The modified gen p mean: 0.44138097763061523, gen p mean: 0.0, mean p set: 0.4506879150867462
loss_pred:0.027750371024012566, decouple_loss:0.012473666109144688
loss_pred:0.028557104989886284, decouple_loss:0.012884304858744144The modified gen p mean: 0.4437587261199951, gen p mean: 0.0, mean p set: 0.45262953639030457
loss_pred:0.02785477228462696, decouple_loss:0.012521611526608467
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45376884937286377, gen p mean: 0.0, mean p set: 0.4500047266483307
The modified gen p mean: 0.4500317871570587, gen p mean: 0.0, mean p set: 0.44956985116004944
loss_pred:0.027698855847120285, decouple_loss:0.012761532329022884
loss_pred:0.02735222317278385, decouple_loss:0.013058602809906006The modified gen p mean: 0.4573770761489868, gen p mean: 0.0, mean p set: 0.44944292306900024
loss_pred:0.027107493951916695, decouple_loss:0.012112953700125217
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45445382595062256, gen p mean: 0.0, mean p set: 0.4523356258869171
The modified gen p mean: 0.4370346963405609, gen p mean: 0.0, mean p set: 0.45081138610839844
loss_pred:0.0268102940171957, decouple_loss:0.012859277427196503
loss_pred:0.02825022302567959, decouple_loss:0.013455446809530258The modified gen p mean: 0.4542523920536041, gen p mean: 0.0, mean p set: 0.4515463411808014
loss_pred:0.027040395885705948, decouple_loss:0.01251075230538845
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44485071301460266, gen p mean: 0.0, mean p set: 0.45068684220314026
loss_pred:0.026744022965431213, decouple_loss:0.013065985403954983
The modified gen p mean: 0.44634076952934265, gen p mean: 0.0, mean p set: 0.4497208595275879
The modified gen p mean: 0.44369032979011536, gen p mean: 0.0, mean p set: 0.4500291645526886
loss_pred:0.027173412963747978, decouple_loss:0.012641550973057747
loss_pred:0.027868932113051414, decouple_loss:0.012559588998556137
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44521835446357727, gen p mean: 0.0, mean p set: 0.45075175166130066
loss_pred:0.029198776930570602, decouple_loss:0.013965030200779438
The modified gen p mean: 0.45446082949638367, gen p mean: 0.0, mean p set: 0.4497842490673065
The modified gen p mean: 0.45790284872055054, gen p mean: 0.0, mean p set: 0.4514326751232147
loss_pred:0.02666405588388443, decouple_loss:0.01255299337208271
loss_pred:0.02735285460948944, decouple_loss:0.012634608894586563
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4547622501850128, gen p mean: 0.0, mean p set: 0.4501529335975647
The modified gen p mean: 0.45225220918655396, gen p mean: 0.0, mean p set: 0.4498935639858246
loss_pred:0.027060216292738914, decouple_loss:0.011871307156980038
loss_pred:0.02731824293732643, decouple_loss:0.011943910270929337The modified gen p mean: 0.46135300397872925, gen p mean: 0.0, mean p set: 0.4506790041923523
loss_pred:0.026854215189814568, decouple_loss:0.01214392576366663
2023-05-04 11:12:12 testing...
The modified gen p mean: 0.44030898809432983, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44798344373703003, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4514653980731964, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.029767697677016258, decouple_loss:0.013646581210196018
loss_pred:0.028707927092909813, decouple_loss:0.013486716896295547
loss_pred:0.02814139612019062, decouple_loss:0.013566826470196247
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02955067716538906, avg_mse: 0.034717317670583725
current test mse: 0.034717
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452436566352844, gen p mean: 0.0, mean p set: 0.4505685865879059
The modified gen p mean: 0.44868868589401245, gen p mean: 0.0, mean p set: 0.45115405321121216
loss_pred:0.028812967240810394, decouple_loss:0.01332659088075161
loss_pred:0.026002714410424232, decouple_loss:0.011944017373025417
The modified gen p mean: 0.4465588331222534, gen p mean: 0.0, mean p set: 0.45110228657722473
loss_pred:0.02894519455730915, decouple_loss:0.012354597449302673
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4540683925151825, gen p mean: 0.0, mean p set: 0.4503568708896637
loss_pred:0.02712647058069706, decouple_loss:0.011591454036533833
The modified gen p mean: 0.4491801857948303, gen p mean: 0.0, mean p set: 0.45045042037963867
The modified gen p mean: 0.4570336937904358, gen p mean: 0.0, mean p set: 0.44943130016326904
loss_pred:0.027619635686278343, decouple_loss:0.012203074991703033
loss_pred:0.02734558843076229, decouple_loss:0.012137709185481071
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459494948387146, gen p mean: 0.0, mean p set: 0.4508519768714905
The modified gen p mean: 0.43351688981056213, gen p mean: 0.0, mean p set: 0.45029953122138977
loss_pred:0.025964966043829918, decouple_loss:0.011593657545745373
loss_pred:0.027533717453479767, decouple_loss:0.012157972902059555The modified gen p mean: 0.443234920501709, gen p mean: 0.0, mean p set: 0.4502204656600952
loss_pred:0.02722833678126335, decouple_loss:0.01149602048099041
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452154278755188, gen p mean: 0.0, mean p set: 0.4509684145450592
loss_pred:0.02777102217078209, decouple_loss:0.012476474978029728
The modified gen p mean: 0.43543457984924316, gen p mean: 0.0, mean p set: 0.45151498913764954
The modified gen p mean: 0.4512040317058563, gen p mean: 0.0, mean p set: 0.4512108564376831
loss_pred:0.027015937492251396, decouple_loss:0.01212436892092228
loss_pred:0.028302177786827087, decouple_loss:0.013215347193181515
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4707088768482208, gen p mean: 0.0, mean p set: 0.45029497146606445
The modified gen p mean: 0.46755141019821167, gen p mean: 0.0, mean p set: 0.4504949152469635
loss_pred:0.026967231184244156, decouple_loss:0.012207389809191227
loss_pred:0.02701130136847496, decouple_loss:0.012797736562788486
The modified gen p mean: 0.4675385057926178, gen p mean: 0.0, mean p set: 0.45207199454307556
loss_pred:0.027516886591911316, decouple_loss:0.012304579839110374
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4557943642139435, gen p mean: 0.0, mean p set: 0.45051753520965576
The modified gen p mean: 0.4591313302516937, gen p mean: 0.0, mean p set: 0.45098140835762024
loss_pred:0.02735452726483345, decouple_loss:0.011868168599903584
loss_pred:0.027279077097773552, decouple_loss:0.01165091060101986The modified gen p mean: 0.46271705627441406, gen p mean: 0.0, mean p set: 0.4506988525390625
loss_pred:0.026721416041254997, decouple_loss:0.011637972667813301
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43303626775741577, gen p mean: 0.0, mean p set: 0.45241379737854004
The modified gen p mean: 0.42109471559524536, gen p mean: 0.0, mean p set: 0.45123711228370667
loss_pred:0.027132617309689522, decouple_loss:0.012138541787862778
loss_pred:0.02840879186987877, decouple_loss:0.012452534399926662The modified gen p mean: 0.4286186695098877, gen p mean: 0.0, mean p set: 0.4497469365596771
loss_pred:0.027177223935723305, decouple_loss:0.011890245601534843
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452418386936188, gen p mean: 0.0, mean p set: 0.45116233825683594
The modified gen p mean: 0.4444884955883026, gen p mean: 0.0, mean p set: 0.44886115193367004
loss_pred:0.026732971891760826, decouple_loss:0.011256895959377289
The modified gen p mean: 0.4413737952709198, gen p mean: 0.0, mean p set: 0.45081067085266113
loss_pred:0.027047032490372658, decouple_loss:0.011806994676589966
loss_pred:0.02663355879485607, decouple_loss:0.012131786905229092
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4641110301017761, gen p mean: 0.0, mean p set: 0.4504128098487854
The modified gen p mean: 0.4565838575363159, gen p mean: 0.0, mean p set: 0.449592649936676loss_pred:0.02713298611342907, decouple_loss:0.011253573931753635
The modified gen p mean: 0.4644818902015686, gen p mean: 0.0, mean p set: 0.4504052996635437
loss_pred:0.026660265401005745, decouple_loss:0.011646789498627186
loss_pred:0.026911849156022072, decouple_loss:0.01115807518362999
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
NaN value num: 0
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516037702560425, gen p mean: 0.0, mean p set: 0.45187854766845703
The modified gen p mean: 0.4512161910533905, gen p mean: 0.0, mean p set: 0.45150890946388245
loss_pred:0.027292540296912193, decouple_loss:0.012617615982890129
The modified gen p mean: 0.4526062309741974, gen p mean: 0.0, mean p set: 0.4510968327522278
loss_pred:0.02871095947921276, decouple_loss:0.011926336213946342
loss_pred:0.028287872672080994, decouple_loss:0.012151962146162987
2023-05-04 11:16:25 testing...
The modified gen p mean: 0.44496971368789673, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4564512372016907, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.45265427231788635, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.029324915260076523, decouple_loss:0.013341453857719898loss_pred:0.02790752612054348, decouple_loss:0.01332590077072382
loss_pred:0.028288401663303375, decouple_loss:0.012980063445866108
WV_0_PC_0_EH_0_PS_40_6, loss: 0.029167739674448967, avg_mse: 0.0341920480132103
current test mse: 0.034192
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526308476924896, gen p mean: 0.0, mean p set: 0.4516545534133911
The modified gen p mean: 0.448015958070755, gen p mean: 0.0, mean p set: 0.45285114645957947
loss_pred:0.027942782267928123, decouple_loss:0.012292267754673958
loss_pred:0.027217084541916847, decouple_loss:0.012629885226488113
The modified gen p mean: 0.44642263650894165, gen p mean: 0.0, mean p set: 0.45111268758773804
loss_pred:0.026889082044363022, decouple_loss:0.011827519163489342
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45314767956733704, gen p mean: 0.0, mean p set: 0.4522736966609955
loss_pred:0.0271342471241951, decouple_loss:0.012031488120555878
The modified gen p mean: 0.4555221498012543, gen p mean: 0.0, mean p set: 0.4528968930244446
The modified gen p mean: 0.4548811912536621, gen p mean: 0.0, mean p set: 0.452073335647583
loss_pred:0.027783052995800972, decouple_loss:0.011545192450284958
loss_pred:0.02652665600180626, decouple_loss:0.012943769805133343
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45252177119255066, gen p mean: 0.0, mean p set: 0.4519473612308502
The modified gen p mean: 0.45580723881721497, gen p mean: 0.0, mean p set: 0.4515573978424072
loss_pred:0.02862204983830452, decouple_loss:0.012814137153327465
loss_pred:0.026751479133963585, decouple_loss:0.012366405688226223The modified gen p mean: 0.4622766971588135, gen p mean: 0.0, mean p set: 0.452898770570755
loss_pred:0.027854805812239647, decouple_loss:0.012613761238753796
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44633227586746216, gen p mean: 0.0, mean p set: 0.45066869258880615
The modified gen p mean: 0.4472942352294922, gen p mean: 0.0, mean p set: 0.451976478099823
loss_pred:0.027818763628602028, decouple_loss:0.011900012381374836
loss_pred:0.027912873774766922, decouple_loss:0.012135899625718594The modified gen p mean: 0.44199827313423157, gen p mean: 0.0, mean p set: 0.45206722617149353
loss_pred:0.028285928070545197, decouple_loss:0.011960836127400398
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4412592053413391, gen p mean: 0.0, mean p set: 0.4510093629360199
The modified gen p mean: 0.44917988777160645, gen p mean: 0.0, mean p set: 0.4522019624710083
loss_pred:0.027631018310785294, decouple_loss:0.01176535151898861
loss_pred:0.027835769578814507, decouple_loss:0.01149398647248745The modified gen p mean: 0.44512051343917847, gen p mean: 0.0, mean p set: 0.4512709379196167
loss_pred:0.027756884694099426, decouple_loss:0.011498983018100262
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4551030397415161, gen p mean: 0.0, mean p set: 0.4512738585472107
The modified gen p mean: 0.45258957147598267, gen p mean: 0.0, mean p set: 0.4526248872280121
loss_pred:0.028007747605443, decouple_loss:0.011749433353543282
The modified gen p mean: 0.4554938077926636, gen p mean: 0.0, mean p set: 0.45121413469314575loss_pred:0.02828175760805607, decouple_loss:0.011838844045996666
loss_pred:0.02745397575199604, decouple_loss:0.011703409254550934
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45735734701156616, gen p mean: 0.0, mean p set: 0.45159196853637695
The modified gen p mean: 0.4588356018066406, gen p mean: 0.0, mean p set: 0.4510124921798706loss_pred:0.028104737401008606, decouple_loss:0.012104113586246967
The modified gen p mean: 0.4492073953151703, gen p mean: 0.0, mean p set: 0.450882226228714
loss_pred:0.027385758236050606, decouple_loss:0.011746424250304699
loss_pred:0.027098188176751137, decouple_loss:0.01165078766644001
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483640491962433, gen p mean: 0.0, mean p set: 0.4523589313030243
The modified gen p mean: 0.4523707628250122, gen p mean: 0.0, mean p set: 0.4521554708480835
loss_pred:0.02720939926803112, decouple_loss:0.011880490928888321
loss_pred:0.028063582256436348, decouple_loss:0.011873622424900532The modified gen p mean: 0.44825705885887146, gen p mean: 0.0, mean p set: 0.4515230059623718
loss_pred:0.02715022675693035, decouple_loss:0.011960301548242569
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4559447467327118, gen p mean: 0.0, mean p set: 0.45075303316116333
loss_pred:0.027019118890166283, decouple_loss:0.011783224530518055
The modified gen p mean: 0.4519554674625397, gen p mean: 0.0, mean p set: 0.45099735260009766
The modified gen p mean: 0.4516809582710266, gen p mean: 0.0, mean p set: 0.4524179995059967
loss_pred:0.02757337875664234, decouple_loss:0.01191575825214386
loss_pred:0.026683809235692024, decouple_loss:0.011019023135304451
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44952407479286194, gen p mean: 0.0, mean p set: 0.45063820481300354
The modified gen p mean: 0.44981876015663147, gen p mean: 0.0, mean p set: 0.45225754380226135
loss_pred:0.02776283584535122, decouple_loss:0.01098904013633728
loss_pred:0.02814178355038166, decouple_loss:0.011298277415335178
The modified gen p mean: 0.4490694999694824, gen p mean: 0.0, mean p set: 0.4514085352420807
loss_pred:0.026956085115671158, decouple_loss:0.010741711594164371
2023-05-04 11:19:56 testing...
The modified gen p mean: 0.44487935304641724, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45229485630989075, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4563467800617218, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.029583735391497612, decouple_loss:0.01341558713465929
loss_pred:0.02834540233016014, decouple_loss:0.013311896473169327loss_pred:0.027936086058616638, decouple_loss:0.013921880163252354
WV_0_PC_0_EH_0_PS_40_6, loss: 0.029299229383468628, avg_mse: 0.03434598818421364
current test mse: 0.034346
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715628027915955, gen p mean: 0.0, mean p set: 0.45200711488723755
The modified gen p mean: 0.45119738578796387, gen p mean: 0.0, mean p set: 0.45158323645591736
loss_pred:0.028386393561959267, decouple_loss:0.011968149803578854
loss_pred:0.02845216728746891, decouple_loss:0.012040654197335243
The modified gen p mean: 0.44821232557296753, gen p mean: 0.0, mean p set: 0.45146840810775757
loss_pred:0.028108304366469383, decouple_loss:0.011790212243795395
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997990131378174, gen p mean: 0.0, mean p set: 0.45058155059814453
The modified gen p mean: 0.4521941542625427, gen p mean: 0.0, mean p set: 0.45016512274742126
loss_pred:0.02742723375558853, decouple_loss:0.01206973847001791
loss_pred:0.027967317029833794, decouple_loss:0.011575150303542614The modified gen p mean: 0.4453909993171692, gen p mean: 0.0, mean p set: 0.4517492651939392
loss_pred:0.02678585611283779, decouple_loss:0.011476334184408188
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4570782482624054, gen p mean: 0.0, mean p set: 0.4510560631752014
The modified gen p mean: 0.4563538432121277, gen p mean: 0.0, mean p set: 0.45040586590766907
loss_pred:0.02746182307600975, decouple_loss:0.011232473887503147
loss_pred:0.0271595548838377, decouple_loss:0.011804546229541302
The modified gen p mean: 0.45434102416038513, gen p mean: 0.0, mean p set: 0.45129165053367615
loss_pred:0.02728392742574215, decouple_loss:0.011521851643919945
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452822208404541, gen p mean: 0.0, mean p set: 0.450682133436203
loss_pred:0.028387675061821938, decouple_loss:0.010841195471584797
The modified gen p mean: 0.4539852440357208, gen p mean: 0.0, mean p set: 0.4506221413612366
The modified gen p mean: 0.45198795199394226, gen p mean: 0.0, mean p set: 0.4516139328479767
loss_pred:0.027819382026791573, decouple_loss:0.011669713072478771
loss_pred:0.027820654213428497, decouple_loss:0.011441713199019432
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862350821495056, gen p mean: 0.0, mean p set: 0.4507089853286743
loss_pred:0.027077769860625267, decouple_loss:0.011045687831938267
The modified gen p mean: 0.446871817111969, gen p mean: 0.0, mean p set: 0.4515584707260132
The modified gen p mean: 0.44780784845352173, gen p mean: 0.0, mean p set: 0.4514089822769165
loss_pred:0.027335183694958687, decouple_loss:0.011135496199131012
loss_pred:0.02877265028655529, decouple_loss:0.01171816699206829
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829705357551575, gen p mean: 0.0, mean p set: 0.4518337547779083
The modified gen p mean: 0.4465620219707489, gen p mean: 0.0, mean p set: 0.4513293206691742
loss_pred:0.0279487706720829, decouple_loss:0.011175011284649372
loss_pred:0.027605047449469566, decouple_loss:0.010993215255439281
The modified gen p mean: 0.44360366463661194, gen p mean: 0.0, mean p set: 0.4535543620586395
loss_pred:0.026988284662365913, decouple_loss:0.011203151196241379
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533686339855194, gen p mean: 0.0, mean p set: 0.4509367048740387
loss_pred:0.026506584137678146, decouple_loss:0.011519594117999077
The modified gen p mean: 0.448885440826416, gen p mean: 0.0, mean p set: 0.4517157971858978
The modified gen p mean: 0.45186710357666016, gen p mean: 0.0, mean p set: 0.4523850381374359
loss_pred:0.028405077755451202, decouple_loss:0.011727306060492992
loss_pred:0.02860063500702381, decouple_loss:0.011461891233921051
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45777425169944763, gen p mean: 0.0, mean p set: 0.4533900320529938
The modified gen p mean: 0.466735303401947, gen p mean: 0.0, mean p set: 0.4521616995334625
loss_pred:0.026623880490660667, decouple_loss:0.011320902034640312
loss_pred:0.02835969813168049, decouple_loss:0.011598490178585052The modified gen p mean: 0.4604329466819763, gen p mean: 0.0, mean p set: 0.4512766897678375
loss_pred:0.028245648369193077, decouple_loss:0.011302520520985126
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4555177688598633, gen p mean: 0.0, mean p set: 0.4502072036266327
loss_pred:0.027877314016222954, decouple_loss:0.011249981820583344
The modified gen p mean: 0.4559467136859894, gen p mean: 0.0, mean p set: 0.45147183537483215
The modified gen p mean: 0.45807600021362305, gen p mean: 0.0, mean p set: 0.45152246952056885
loss_pred:0.026885103434324265, decouple_loss:0.010535127483308315
loss_pred:0.02875407040119171, decouple_loss:0.011027566157281399
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
NaN value num: 0
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4405946135520935, gen p mean: 0.0, mean p set: 0.45130568742752075
The modified gen p mean: 0.43223118782043457, gen p mean: 0.0, mean p set: 0.45268896222114563
loss_pred:0.026889801025390625, decouple_loss:0.012761355377733707
The modified gen p mean: 0.44125840067863464, gen p mean: 0.0, mean p set: 0.45220664143562317
loss_pred:0.027355842292308807, decouple_loss:0.01130854431539774
loss_pred:0.026838086545467377, decouple_loss:0.01151861809194088
2023-05-04 11:24:14 testing...
The modified gen p mean: 0.43935680389404297, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4468193054199219, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45064306259155273, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02954300306737423, decouple_loss:0.013202930800616741
loss_pred:0.02831827849149704, decouple_loss:0.012750320136547089
loss_pred:0.027920808643102646, decouple_loss:0.013272043317556381
WV_0_PC_0_EH_0_PS_40_6, loss: 0.029247786849737167, avg_mse: 0.034346017986536026
current test mse: 0.034346
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814416766166687, gen p mean: 0.0, mean p set: 0.4507088363170624
loss_pred:0.027162879705429077, decouple_loss:0.011340674012899399
The modified gen p mean: 0.4467901289463043, gen p mean: 0.0, mean p set: 0.45239993929862976
loss_pred:0.027518274262547493, decouple_loss:0.011333511210978031
The modified gen p mean: 0.441290020942688, gen p mean: 0.0, mean p set: 0.4517459571361542
loss_pred:0.026541776955127716, decouple_loss:0.011825728230178356
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4577435553073883, gen p mean: 0.0, mean p set: 0.4524218738079071
The modified gen p mean: 0.46269115805625916, gen p mean: 0.0, mean p set: 0.45367616415023804
loss_pred:0.02618219517171383, decouple_loss:0.011854680255055428
loss_pred:0.028031153604388237, decouple_loss:0.012045865878462791The modified gen p mean: 0.4597223997116089, gen p mean: 0.0, mean p set: 0.4523092210292816
loss_pred:0.026899678632616997, decouple_loss:0.011485065333545208
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4540121257305145, gen p mean: 0.0, mean p set: 0.4523715376853943
loss_pred:0.026299992576241493, decouple_loss:0.012438613921403885
The modified gen p mean: 0.4555553197860718, gen p mean: 0.0, mean p set: 0.45155444741249084
The modified gen p mean: 0.4600452482700348, gen p mean: 0.0, mean p set: 0.4502086043357849
loss_pred:0.026900945231318474, decouple_loss:0.01163562387228012
loss_pred:0.026495272293686867, decouple_loss:0.011465365067124367
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4579784870147705, gen p mean: 0.0, mean p set: 0.4510599374771118
loss_pred:0.027325036004185677, decouple_loss:0.011454097926616669
The modified gen p mean: 0.4578457176685333, gen p mean: 0.0, mean p set: 0.45116758346557617
The modified gen p mean: 0.4581729471683502, gen p mean: 0.0, mean p set: 0.4497600495815277
loss_pred:0.02773185260593891, decouple_loss:0.011917206458747387
loss_pred:0.026921791955828667, decouple_loss:0.011111550033092499
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44106417894363403, gen p mean: 0.0, mean p set: 0.45128652453422546
The modified gen p mean: 0.4419841170310974, gen p mean: 0.0, mean p set: 0.4525846242904663
loss_pred:0.02680833823978901, decouple_loss:0.01185574010014534
loss_pred:0.027003547176718712, decouple_loss:0.011653321795165539The modified gen p mean: 0.44041693210601807, gen p mean: 0.0, mean p set: 0.4523046314716339
loss_pred:0.02737336978316307, decouple_loss:0.011725441552698612
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466918408870697, gen p mean: 0.0, mean p set: 0.4516802132129669
loss_pred:0.026057898998260498, decouple_loss:0.01130029559135437
The modified gen p mean: 0.4475841522216797, gen p mean: 0.0, mean p set: 0.4538613259792328
The modified gen p mean: 0.44743290543556213, gen p mean: 0.0, mean p set: 0.4515168070793152
loss_pred:0.026823807507753372, decouple_loss:0.011001779697835445
loss_pred:0.026844337582588196, decouple_loss:0.01111557800322771
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749873876571655, gen p mean: 0.0, mean p set: 0.450788289308548
The modified gen p mean: 0.451579749584198, gen p mean: 0.0, mean p set: 0.4508955478668213
loss_pred:0.02702612243592739, decouple_loss:0.011749287135899067
loss_pred:0.026852663606405258, decouple_loss:0.011356242001056671
The modified gen p mean: 0.45024389028549194, gen p mean: 0.0, mean p set: 0.45335304737091064
loss_pred:0.02808806300163269, decouple_loss:0.011556732468307018
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45320603251457214, gen p mean: 0.0, mean p set: 0.4519527554512024
The modified gen p mean: 0.4499717056751251, gen p mean: 0.0, mean p set: 0.4529889225959778
The modified gen p mean: 0.4548555016517639, gen p mean: 0.0, mean p set: 0.45124995708465576
loss_pred:0.026301167905330658, decouple_loss:0.012360011227428913
loss_pred:0.02686343900859356, decouple_loss:0.012080596759915352
loss_pred:0.026255514472723007, decouple_loss:0.01134535949677229
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45902207493782043, gen p mean: 0.0, mean p set: 0.45303553342819214
The modified gen p mean: 0.4635024070739746, gen p mean: 0.0, mean p set: 0.4515817165374756
The modified gen p mean: 0.4633826017379761, gen p mean: 0.0, mean p set: 0.45177337527275085
loss_pred:0.026831362396478653, decouple_loss:0.01129911933094263
loss_pred:0.027326999232172966, decouple_loss:0.01150890439748764
loss_pred:0.02789970301091671, decouple_loss:0.011493472382426262
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474962651729584, gen p mean: 0.0, mean p set: 0.4505651295185089
loss_pred:0.02699112519621849, decouple_loss:0.011031163856387138
The modified gen p mean: 0.4493989050388336, gen p mean: 0.0, mean p set: 0.4523712396621704
The modified gen p mean: 0.44810885190963745, gen p mean: 0.0, mean p set: 0.45010724663734436
loss_pred:0.027144474908709526, decouple_loss:0.010881849564611912
loss_pred:0.02811565063893795, decouple_loss:0.011229007504880428
2023-05-04 11:27:45 testing...
The modified gen p mean: 0.43576130270957947, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4426523745059967, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.446416974067688, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02953125722706318, decouple_loss:0.012392954900860786
loss_pred:0.028054099529981613, decouple_loss:0.01235133595764637
loss_pred:0.02846544422209263, decouple_loss:0.012050331570208073
WV_0_PC_0_EH_0_PS_40_6, loss: 0.029296845197677612, avg_mse: 0.034520190209150314
current test mse: 0.03452
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455517828464508, gen p mean: 0.0, mean p set: 0.45094895362854004
The modified gen p mean: 0.44524410367012024, gen p mean: 0.0, mean p set: 0.45109736919403076
loss_pred:0.02744602970778942, decouple_loss:0.011444435454905033
loss_pred:0.026852263137698174, decouple_loss:0.010742148384451866
The modified gen p mean: 0.4441222846508026, gen p mean: 0.0, mean p set: 0.45150282979011536
loss_pred:0.02679985761642456, decouple_loss:0.01123239565640688
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483422040939331, gen p mean: 0.0, mean p set: 0.4527246057987213
loss_pred:0.02635909989476204, decouple_loss:0.010937870480120182
The modified gen p mean: 0.44832247495651245, gen p mean: 0.0, mean p set: 0.4509281814098358
The modified gen p mean: 0.45289838314056396, gen p mean: 0.0, mean p set: 0.45235851407051086
loss_pred:0.027622923254966736, decouple_loss:0.010567491874098778
loss_pred:0.027588464319705963, decouple_loss:0.011135836131870747
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45581650733947754, gen p mean: 0.0, mean p set: 0.45134058594703674
loss_pred:0.02644914574921131, decouple_loss:0.01080613024532795
The modified gen p mean: 0.4588436186313629, gen p mean: 0.0, mean p set: 0.45026299357414246
The modified gen p mean: 0.4545804262161255, gen p mean: 0.0, mean p set: 0.4523225724697113
loss_pred:0.02553601935505867, decouple_loss:0.011538013815879822
loss_pred:0.02748887799680233, decouple_loss:0.011333459056913853
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45072507858276367, gen p mean: 0.0, mean p set: 0.4533045291900635
loss_pred:0.026279350742697716, decouple_loss:0.01069561019539833
The modified gen p mean: 0.45135733485221863, gen p mean: 0.0, mean p set: 0.45104846358299255
The modified gen p mean: 0.45046356320381165, gen p mean: 0.0, mean p set: 0.45169830322265625
loss_pred:0.02640252187848091, decouple_loss:0.011466238647699356
loss_pred:0.026987269520759583, decouple_loss:0.010713079012930393
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447559118270874, gen p mean: 0.0, mean p set: 0.45310890674591064
The modified gen p mean: 0.4533478021621704, gen p mean: 0.0, mean p set: 0.45251214504241943
loss_pred:0.026005392894148827, decouple_loss:0.01108631119132042
loss_pred:0.027302037924528122, decouple_loss:0.010995632968842983The modified gen p mean: 0.4516425132751465, gen p mean: 0.0, mean p set: 0.45044055581092834
loss_pred:0.027715932577848434, decouple_loss:0.010451940819621086
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45296454429626465, gen p mean: 0.0, mean p set: 0.4524940252304077
The modified gen p mean: 0.454929381608963, gen p mean: 0.0, mean p set: 0.45164093375205994
loss_pred:0.02543730102479458, decouple_loss:0.011706160381436348
loss_pred:0.02593834325671196, decouple_loss:0.010629494674503803The modified gen p mean: 0.4542551636695862, gen p mean: 0.0, mean p set: 0.4519391357898712
loss_pred:0.025283366441726685, decouple_loss:0.011592423543334007
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514976739883423, gen p mean: 0.0, mean p set: 0.45218244194984436
loss_pred:0.027589840814471245, decouple_loss:0.010852569714188576
The modified gen p mean: 0.45295560359954834, gen p mean: 0.0, mean p set: 0.45042940974235535
The modified gen p mean: 0.4493410289287567, gen p mean: 0.0, mean p set: 0.45093876123428345
loss_pred:0.026387710124254227, decouple_loss:0.011264056898653507
loss_pred:0.028058478608727455, decouple_loss:0.010558185167610645
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458487331867218, gen p mean: 0.0, mean p set: 0.4518023431301117
The modified gen p mean: 0.44348543882369995, gen p mean: 0.0, mean p set: 0.4520733654499054
loss_pred:0.02603086642920971, decouple_loss:0.01074814610183239
loss_pred:0.027006516233086586, decouple_loss:0.011143269948661327
The modified gen p mean: 0.4450550079345703, gen p mean: 0.0, mean p set: 0.45176488161087036
loss_pred:0.026964234188199043, decouple_loss:0.010579687543213367
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45298513770103455, gen p mean: 0.0, mean p set: 0.45229440927505493
The modified gen p mean: 0.450522243976593, gen p mean: 0.0, mean p set: 0.45116788148880005
loss_pred:0.028081946074962616, decouple_loss:0.010780032724142075
loss_pred:0.027003832161426544, decouple_loss:0.011065740138292313
The modified gen p mean: 0.4534345269203186, gen p mean: 0.0, mean p set: 0.45034632086753845
loss_pred:0.026669377461075783, decouple_loss:0.010837608017027378
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
NaN value num: 0
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4595738351345062, gen p mean: 0.0, mean p set: 0.44589856266975403
The modified gen p mean: 0.4569893479347229, gen p mean: 0.0, mean p set: 0.4459342360496521
loss_pred:0.029795410111546516, decouple_loss:0.012947392649948597
The modified gen p mean: 0.453915536403656, gen p mean: 0.0, mean p set: 0.4484492540359497
loss_pred:0.030452599748969078, decouple_loss:0.012900871224701405
loss_pred:0.029179466888308525, decouple_loss:0.012363950721919537
2023-05-04 11:32:02 testing...
The modified gen p mean: 0.43616244196891785, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4432488679885864, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44701525568962097, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.029307939112186432, decouple_loss:0.01241866685450077
loss_pred:0.027760570868849754, decouple_loss:0.012291885912418365loss_pred:0.028247185051441193, decouple_loss:0.012025316245853901
WV_0_PC_0_EH_0_PS_40_6, loss: 0.029050830751657486, avg_mse: 0.03416244685649872
current test mse: 0.034162
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4443046748638153, gen p mean: 0.0, mean p set: 0.44732820987701416
The modified gen p mean: 0.44384387135505676, gen p mean: 0.0, mean p set: 0.44704747200012207
loss_pred:0.03117261454463005, decouple_loss:0.013129803352057934
loss_pred:0.029180997982621193, decouple_loss:0.012382544577121735
The modified gen p mean: 0.44378185272216797, gen p mean: 0.0, mean p set: 0.4478325843811035
loss_pred:0.03050067462027073, decouple_loss:0.012795359827578068
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44138169288635254, gen p mean: 0.0, mean p set: 0.4471641182899475
loss_pred:0.030311252921819687, decouple_loss:0.012808543629944324The modified gen p mean: 0.43874549865722656, gen p mean: 0.0, mean p set: 0.44864365458488464
The modified gen p mean: 0.44144389033317566, gen p mean: 0.0, mean p set: 0.4466082453727722
loss_pred:0.029214909300208092, decouple_loss:0.012240763753652573
loss_pred:0.029125213623046875, decouple_loss:0.012818727642297745
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44252800941467285, gen p mean: 0.0, mean p set: 0.44832971692085266
The modified gen p mean: 0.44251298904418945, gen p mean: 0.0, mean p set: 0.44818219542503357
loss_pred:0.029587702825665474, decouple_loss:0.012384850531816483
loss_pred:0.029320523142814636, decouple_loss:0.012413141317665577
The modified gen p mean: 0.448974072933197, gen p mean: 0.0, mean p set: 0.4457412362098694
loss_pred:0.02934194728732109, decouple_loss:0.012278184294700623
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514264166355133, gen p mean: 0.0, mean p set: 0.4485847055912018
loss_pred:0.029368676245212555, decouple_loss:0.012481323443353176
The modified gen p mean: 0.4517006576061249, gen p mean: 0.0, mean p set: 0.4471109211444855
The modified gen p mean: 0.45334920287132263, gen p mean: 0.0, mean p set: 0.4459850490093231
loss_pred:0.029246123507618904, decouple_loss:0.012338331900537014
loss_pred:0.030432242900133133, decouple_loss:0.012067768722772598
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4413449168205261, gen p mean: 0.0, mean p set: 0.4476702809333801
loss_pred:0.028968987986445427, decouple_loss:0.012204323895275593
The modified gen p mean: 0.44647902250289917, gen p mean: 0.0, mean p set: 0.4470962882041931
The modified gen p mean: 0.445602685213089, gen p mean: 0.0, mean p set: 0.44733667373657227
loss_pred:0.03115501068532467, decouple_loss:0.0123536866158247
loss_pred:0.03110142983496189, decouple_loss:0.012318696826696396
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44432517886161804, gen p mean: 0.0, mean p set: 0.44793352484703064
loss_pred:0.02874878980219364, decouple_loss:0.012085366062819958
The modified gen p mean: 0.44891706109046936, gen p mean: 0.0, mean p set: 0.44761335849761963
The modified gen p mean: 0.4514549672603607, gen p mean: 0.0, mean p set: 0.44620171189308167
loss_pred:0.030373552814126015, decouple_loss:0.012191703543066978
loss_pred:0.030500395223498344, decouple_loss:0.011861550621688366
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472569227218628, gen p mean: 0.0, mean p set: 0.44921690225601196
The modified gen p mean: 0.44397738575935364, gen p mean: 0.0, mean p set: 0.44805923104286194
loss_pred:0.029086995869874954, decouple_loss:0.012521645985543728
loss_pred:0.029437899589538574, decouple_loss:0.011662009172141552The modified gen p mean: 0.4522098898887634, gen p mean: 0.0, mean p set: 0.4476500451564789
loss_pred:0.030194612219929695, decouple_loss:0.011503630317747593
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4439784586429596, gen p mean: 0.0, mean p set: 0.4479162395000458
loss_pred:0.02937944047152996, decouple_loss:0.011707611382007599
The modified gen p mean: 0.4526398777961731, gen p mean: 0.0, mean p set: 0.44609498977661133
The modified gen p mean: 0.4458549916744232, gen p mean: 0.0, mean p set: 0.44814398884773254
loss_pred:0.028763381764292717, decouple_loss:0.011456960812211037
loss_pred:0.029331762343645096, decouple_loss:0.01152747217565775
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483892619609833, gen p mean: 0.0, mean p set: 0.44789019227027893
loss_pred:0.028915828093886375, decouple_loss:0.011693648062646389
The modified gen p mean: 0.4443034827709198, gen p mean: 0.0, mean p set: 0.44859373569488525
The modified gen p mean: 0.44703584909439087, gen p mean: 0.0, mean p set: 0.44691455364227295
loss_pred:0.028089066967368126, decouple_loss:0.011695636436343193
loss_pred:0.02918435074388981, decouple_loss:0.011500917375087738
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45286083221435547, gen p mean: 0.0, mean p set: 0.44587424397468567
The modified gen p mean: 0.4518589377403259, gen p mean: 0.0, mean p set: 0.4458599388599396
loss_pred:0.030045107007026672, decouple_loss:0.01246846653521061
loss_pred:0.028681829571723938, decouple_loss:0.01219095103442669The modified gen p mean: 0.4503929316997528, gen p mean: 0.0, mean p set: 0.44635969400405884
loss_pred:0.029216421768069267, decouple_loss:0.012061183340847492
2023-05-04 11:35:33 testing...
The modified gen p mean: 0.4355793595314026, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44618746638298035, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44285276532173157, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.029305921867489815, decouple_loss:0.012372754514217377
loss_pred:0.02822078950703144, decouple_loss:0.011955522932112217loss_pred:0.027878427878022194, decouple_loss:0.012005777098238468
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02907394990324974, avg_mse: 0.03423520550131798
current test mse: 0.034235
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464358687400818, gen p mean: 0.0, mean p set: 0.4463336765766144
The modified gen p mean: 0.4436184763908386, gen p mean: 0.0, mean p set: 0.4474199414253235
loss_pred:0.02920551411807537, decouple_loss:0.011766934767365456
loss_pred:0.030153576284646988, decouple_loss:0.011732567101716995
The modified gen p mean: 0.44152864813804626, gen p mean: 0.0, mean p set: 0.44756653904914856
loss_pred:0.028879156336188316, decouple_loss:0.011224054731428623
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446929931640625, gen p mean: 0.0, mean p set: 0.4466424882411957
The modified gen p mean: 0.4476163387298584, gen p mean: 0.0, mean p set: 0.44731420278549194
loss_pred:0.029678601771593094, decouple_loss:0.010956481099128723
loss_pred:0.029359910637140274, decouple_loss:0.011570721864700317The modified gen p mean: 0.4435833692550659, gen p mean: 0.0, mean p set: 0.4483678936958313
loss_pred:0.028896674513816833, decouple_loss:0.011199714615941048
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44633743166923523, gen p mean: 0.0, mean p set: 0.4494474530220032
loss_pred:0.0294034443795681, decouple_loss:0.011992080137133598
The modified gen p mean: 0.4504813551902771, gen p mean: 0.0, mean p set: 0.44745099544525146
The modified gen p mean: 0.4494471549987793, gen p mean: 0.0, mean p set: 0.44724923372268677
loss_pred:0.029340049251914024, decouple_loss:0.011383824050426483
loss_pred:0.029875634238123894, decouple_loss:0.011301012709736824
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513428807258606, gen p mean: 0.0, mean p set: 0.4463099241256714
The modified gen p mean: 0.44662395119667053, gen p mean: 0.0, mean p set: 0.4484466016292572
loss_pred:0.029782220721244812, decouple_loss:0.011286132968962193
loss_pred:0.02913418971002102, decouple_loss:0.011586730368435383
The modified gen p mean: 0.44320669770240784, gen p mean: 0.0, mean p set: 0.4483919143676758
loss_pred:0.02829139493405819, decouple_loss:0.012070477940142155
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013877749443054, gen p mean: 0.0, mean p set: 0.4474896788597107
The modified gen p mean: 0.45001089572906494, gen p mean: 0.0, mean p set: 0.4468361735343933
loss_pred:0.028477439656853676, decouple_loss:0.011631330475211143
loss_pred:0.02947181463241577, decouple_loss:0.011284547857940197The modified gen p mean: 0.4473559260368347, gen p mean: 0.0, mean p set: 0.4483541250228882
loss_pred:0.02902449108660221, decouple_loss:0.01163478847593069
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44528570771217346, gen p mean: 0.0, mean p set: 0.4485665559768677
The modified gen p mean: 0.452452152967453, gen p mean: 0.0, mean p set: 0.4466065764427185
loss_pred:0.028716975823044777, decouple_loss:0.010852044448256493
loss_pred:0.02873956225812435, decouple_loss:0.011100927367806435The modified gen p mean: 0.4447823762893677, gen p mean: 0.0, mean p set: 0.4479012191295624
loss_pred:0.02898012101650238, decouple_loss:0.01087251678109169
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4390975534915924, gen p mean: 0.0, mean p set: 0.4480588138103485
loss_pred:0.02924114651978016, decouple_loss:0.01090184599161148
The modified gen p mean: 0.44753319025039673, gen p mean: 0.0, mean p set: 0.4475829601287842
The modified gen p mean: 0.4453940689563751, gen p mean: 0.0, mean p set: 0.4465598464012146
loss_pred:0.02884112298488617, decouple_loss:0.011252792552113533
loss_pred:0.027838829904794693, decouple_loss:0.011162870563566685
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471624791622162, gen p mean: 0.0, mean p set: 0.44673120975494385
loss_pred:0.028976215049624443, decouple_loss:0.011459860019385815
The modified gen p mean: 0.44319987297058105, gen p mean: 0.0, mean p set: 0.4483163356781006
The modified gen p mean: 0.44462907314300537, gen p mean: 0.0, mean p set: 0.4468995928764343
loss_pred:0.029180020093917847, decouple_loss:0.011540455743670464
loss_pred:0.02877933531999588, decouple_loss:0.011691991239786148
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530559778213501, gen p mean: 0.0, mean p set: 0.44682827591896057The modified gen p mean: 0.4501214921474457, gen p mean: 0.0, mean p set: 0.4482518434524536
loss_pred:0.029159270226955414, decouple_loss:0.011257223784923553loss_pred:0.029294222593307495, decouple_loss:0.011249173432588577
The modified gen p mean: 0.4523078501224518, gen p mean: 0.0, mean p set: 0.4467763900756836
loss_pred:0.029031194746494293, decouple_loss:0.011361648328602314
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
NaN value num: 0
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483041763305664, gen p mean: 0.0, mean p set: 0.45265159010887146
The modified gen p mean: 0.44798022508621216, gen p mean: 0.0, mean p set: 0.4500081539154053
The modified gen p mean: 0.44888585805892944, gen p mean: 0.0, mean p set: 0.4530782699584961
loss_pred:0.02760794758796692, decouple_loss:0.01289639063179493
loss_pred:0.028747668489813805, decouple_loss:0.013120608404278755
loss_pred:0.02834514155983925, decouple_loss:0.013440590351819992
2023-05-04 11:39:50 testing...
The modified gen p mean: 0.44230392575263977, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.453225702047348, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4498739242553711, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.028991999104619026, decouple_loss:0.011781794019043446
loss_pred:0.0276152603328228, decouple_loss:0.011558747850358486
loss_pred:0.02798646129667759, decouple_loss:0.011592189781367779
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028780117630958557, avg_mse: 0.03386998176574707
current test mse: 0.03387
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521147310733795, gen p mean: 0.0, mean p set: 0.45039013028144836
The modified gen p mean: 0.45004597306251526, gen p mean: 0.0, mean p set: 0.4511072635650635
loss_pred:0.027679769322276115, decouple_loss:0.012180483900010586
loss_pred:0.02779507078230381, decouple_loss:0.01222235057502985
The modified gen p mean: 0.45470282435417175, gen p mean: 0.0, mean p set: 0.4495929181575775
loss_pred:0.027032677084207535, decouple_loss:0.012213518843054771
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4589520990848541, gen p mean: 0.0, mean p set: 0.44991159439086914
The modified gen p mean: 0.44955191016197205, gen p mean: 0.0, mean p set: 0.44994187355041504
loss_pred:0.02598073147237301, decouple_loss:0.012035097926855087
The modified gen p mean: 0.4538670778274536, gen p mean: 0.0, mean p set: 0.4502619802951813loss_pred:0.026527151465415955, decouple_loss:0.012196622788906097
loss_pred:0.027072420343756676, decouple_loss:0.011975268833339214
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828224182128906, gen p mean: 0.0, mean p set: 0.45067763328552246
loss_pred:0.027483990415930748, decouple_loss:0.012173236347734928
The modified gen p mean: 0.44647255539894104, gen p mean: 0.0, mean p set: 0.44970813393592834
The modified gen p mean: 0.44940900802612305, gen p mean: 0.0, mean p set: 0.45233187079429626
loss_pred:0.02794850990176201, decouple_loss:0.012010006234049797
loss_pred:0.026981627568602562, decouple_loss:0.01174034085124731
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44882237911224365, gen p mean: 0.0, mean p set: 0.4498123526573181The modified gen p mean: 0.4465671479701996, gen p mean: 0.0, mean p set: 0.4501286447048187
loss_pred:0.027338383719325066, decouple_loss:0.011054866015911102
loss_pred:0.026026301085948944, decouple_loss:0.011613072827458382
The modified gen p mean: 0.45350655913352966, gen p mean: 0.0, mean p set: 0.4516216814517975
loss_pred:0.02799830585718155, decouple_loss:0.011514965444803238
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523855149745941, gen p mean: 0.0, mean p set: 0.4497832953929901
The modified gen p mean: 0.45456069707870483, gen p mean: 0.0, mean p set: 0.44961148500442505
loss_pred:0.02747313864529133, decouple_loss:0.011447637341916561
The modified gen p mean: 0.4566667675971985, gen p mean: 0.0, mean p set: 0.44978389143943787loss_pred:0.026316434144973755, decouple_loss:0.011128799058496952
loss_pred:0.02567344345152378, decouple_loss:0.011574343778192997
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44361448287963867, gen p mean: 0.0, mean p set: 0.45174553990364075
The modified gen p mean: 0.44033411145210266, gen p mean: 0.0, mean p set: 0.4496227502822876
loss_pred:0.028491349890828133, decouple_loss:0.012380491010844707
loss_pred:0.025332339107990265, decouple_loss:0.011715423315763474
The modified gen p mean: 0.4421645402908325, gen p mean: 0.0, mean p set: 0.4503614008426666
loss_pred:0.027160022407770157, decouple_loss:0.011357156559824944
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45084619522094727, gen p mean: 0.0, mean p set: 0.4503604471683502
loss_pred:0.025796610862016678, decouple_loss:0.011010201647877693
The modified gen p mean: 0.4537331163883209, gen p mean: 0.0, mean p set: 0.451677143573761
The modified gen p mean: 0.4504036009311676, gen p mean: 0.0, mean p set: 0.450275719165802
loss_pred:0.02488778904080391, decouple_loss:0.011309530586004257
loss_pred:0.027503516525030136, decouple_loss:0.01181323267519474
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45520031452178955, gen p mean: 0.0, mean p set: 0.45206427574157715
The modified gen p mean: 0.45451509952545166, gen p mean: 0.0, mean p set: 0.4512771964073181
loss_pred:0.027497662231326103, decouple_loss:0.011494114995002747
loss_pred:0.027526933699846268, decouple_loss:0.0118538374081254The modified gen p mean: 0.45368558168411255, gen p mean: 0.0, mean p set: 0.45187583565711975
loss_pred:0.027788622304797173, decouple_loss:0.011752725578844547
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4577014148235321, gen p mean: 0.0, mean p set: 0.45175236463546753
loss_pred:0.02863171137869358, decouple_loss:0.012099236249923706
The modified gen p mean: 0.4509909451007843, gen p mean: 0.0, mean p set: 0.44958019256591797
The modified gen p mean: 0.45734986662864685, gen p mean: 0.0, mean p set: 0.4523402154445648
loss_pred:0.028804868459701538, decouple_loss:0.011950644664466381
loss_pred:0.025884374976158142, decouple_loss:0.011115514673292637
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478934407234192, gen p mean: 0.0, mean p set: 0.45020341873168945
The modified gen p mean: 0.4559556245803833, gen p mean: 0.0, mean p set: 0.44957494735717773
loss_pred:0.02744705229997635, decouple_loss:0.011115864850580692
loss_pred:0.02508816495537758, decouple_loss:0.01130175031721592The modified gen p mean: 0.4543696343898773, gen p mean: 0.0, mean p set: 0.4494384825229645
loss_pred:0.02554473467171192, decouple_loss:0.011328039690852165
2023-05-04 11:43:26 testing...
The modified gen p mean: 0.4319402277469635, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4394543468952179, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4424941837787628, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.029249947518110275, decouple_loss:0.012291583232581615
loss_pred:0.028157005086541176, decouple_loss:0.011904190294444561
loss_pred:0.027677616104483604, decouple_loss:0.012052558362483978
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02896566316485405, avg_mse: 0.03409925475716591
current test mse: 0.034099
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44530200958251953, gen p mean: 0.0, mean p set: 0.4518806040287018
The modified gen p mean: 0.43735793232917786, gen p mean: 0.0, mean p set: 0.4496690630912781
loss_pred:0.02719346061348915, decouple_loss:0.01122298650443554
loss_pred:0.026047570630908012, decouple_loss:0.010733355768024921
The modified gen p mean: 0.4413694441318512, gen p mean: 0.0, mean p set: 0.4503765404224396
loss_pred:0.0272474717348814, decouple_loss:0.010765941813588142
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454396665096283, gen p mean: 0.0, mean p set: 0.45093992352485657
The modified gen p mean: 0.45679619908332825, gen p mean: 0.0, mean p set: 0.44996196031570435
loss_pred:0.027767125517129898, decouple_loss:0.011176582425832748
loss_pred:0.027883777394890785, decouple_loss:0.011243078857660294
The modified gen p mean: 0.4478856027126312, gen p mean: 0.0, mean p set: 0.4500085711479187
loss_pred:0.027187151834368706, decouple_loss:0.01082672644406557
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46078911423683167, gen p mean: 0.0, mean p set: 0.44950950145721436The modified gen p mean: 0.45390835404396057, gen p mean: 0.0, mean p set: 0.45169880986213684
loss_pred:0.02679497003555298, decouple_loss:0.011071966961026192
loss_pred:0.027456674724817276, decouple_loss:0.011247768066823483
The modified gen p mean: 0.45170095562934875, gen p mean: 0.0, mean p set: 0.45020246505737305
loss_pred:0.0275576189160347, decouple_loss:0.011045058257877827
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533323645591736, gen p mean: 0.0, mean p set: 0.4505756199359894
The modified gen p mean: 0.44980841875076294, gen p mean: 0.0, mean p set: 0.4516032636165619
loss_pred:0.02838372066617012, decouple_loss:0.011175813153386116
loss_pred:0.026455525308847427, decouple_loss:0.010972942225635052The modified gen p mean: 0.45169755816459656, gen p mean: 0.0, mean p set: 0.44948339462280273
loss_pred:0.0265712458640337, decouple_loss:0.011101706884801388
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448701411485672, gen p mean: 0.0, mean p set: 0.45207321643829346
The modified gen p mean: 0.44578981399536133, gen p mean: 0.0, mean p set: 0.45071735978126526
loss_pred:0.027769548818469048, decouple_loss:0.010987840592861176
loss_pred:0.02562251314520836, decouple_loss:0.01094266027212143The modified gen p mean: 0.4369760751724243, gen p mean: 0.0, mean p set: 0.4501604735851288
loss_pred:0.02551628090441227, decouple_loss:0.011015255935490131
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448225736618042, gen p mean: 0.0, mean p set: 0.4495577812194824
The modified gen p mean: 0.44977888464927673, gen p mean: 0.0, mean p set: 0.4498610198497772
loss_pred:0.026584787294268608, decouple_loss:0.01104417908936739
loss_pred:0.027657151222229004, decouple_loss:0.011388138867914677The modified gen p mean: 0.4559503197669983, gen p mean: 0.0, mean p set: 0.4497336745262146
loss_pred:0.026700178161263466, decouple_loss:0.010630138218402863
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4607010781764984, gen p mean: 0.0, mean p set: 0.44982221722602844
The modified gen p mean: 0.45208582282066345, gen p mean: 0.0, mean p set: 0.4509774148464203
loss_pred:0.02760886214673519, decouple_loss:0.0104552386328578
The modified gen p mean: 0.448991596698761, gen p mean: 0.0, mean p set: 0.45065566897392273
loss_pred:0.0271916501224041, decouple_loss:0.010573226027190685
loss_pred:0.02691461704671383, decouple_loss:0.010858268477022648
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734418392181396, gen p mean: 0.0, mean p set: 0.45051491260528564
loss_pred:0.02619371935725212, decouple_loss:0.010395179502665997
The modified gen p mean: 0.45260369777679443, gen p mean: 0.0, mean p set: 0.45006775856018066
The modified gen p mean: 0.4455302059650421, gen p mean: 0.0, mean p set: 0.4502403438091278
loss_pred:0.02645963802933693, decouple_loss:0.010650902055203915
loss_pred:0.026232140138745308, decouple_loss:0.010026794858276844
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45770972967147827, gen p mean: 0.0, mean p set: 0.4503854513168335
The modified gen p mean: 0.4544491469860077, gen p mean: 0.0, mean p set: 0.45200085639953613
loss_pred:0.025075191631913185, decouple_loss:0.010348419658839703
The modified gen p mean: 0.4505472779273987, gen p mean: 0.0, mean p set: 0.45080122351646423loss_pred:0.026919415220618248, decouple_loss:0.010101927444338799
loss_pred:0.027379071339964867, decouple_loss:0.010812865570187569
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494986832141876, gen p mean: 0.0, mean p set: 0.4483332633972168
The modified gen p mean: 0.44590163230895996, gen p mean: 0.0, mean p set: 0.4485950171947479
loss_pred:0.029174890369176865, decouple_loss:0.012300090864300728
The modified gen p mean: 0.4510567784309387, gen p mean: 0.0, mean p set: 0.44843021035194397
loss_pred:0.028433198109269142, decouple_loss:0.012065076269209385
loss_pred:0.028039587661623955, decouple_loss:0.012424931861460209
2023-05-04 11:47:42 testing...
The modified gen p mean: 0.43487349152565, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4422492980957031, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4447735548019409, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.029408300295472145, decouple_loss:0.011707778088748455
loss_pred:0.028243115171790123, decouple_loss:0.011258180253207684
loss_pred:0.0278296060860157, decouple_loss:0.011512240394949913
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02906831167638302, avg_mse: 0.034443214535713196
current test mse: 0.034443
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4405893087387085, gen p mean: 0.0, mean p set: 0.44854387640953064
The modified gen p mean: 0.43929484486579895, gen p mean: 0.0, mean p set: 0.44859760999679565
loss_pred:0.028558362275362015, decouple_loss:0.011765771545469761
loss_pred:0.029558828100562096, decouple_loss:0.011715039610862732
The modified gen p mean: 0.4383033812046051, gen p mean: 0.0, mean p set: 0.4486139416694641
loss_pred:0.02841796725988388, decouple_loss:0.011815404519438744
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44603806734085083, gen p mean: 0.0, mean p set: 0.44843557476997375
loss_pred:0.028489356860518456, decouple_loss:0.011941354721784592
The modified gen p mean: 0.45028114318847656, gen p mean: 0.0, mean p set: 0.44799885153770447
The modified gen p mean: 0.44833606481552124, gen p mean: 0.0, mean p set: 0.448095440864563
loss_pred:0.027095645666122437, decouple_loss:0.011785533279180527
loss_pred:0.027666110545396805, decouple_loss:0.010909312404692173
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45533591508865356, gen p mean: 0.0, mean p set: 0.4491655230522156
The modified gen p mean: 0.45187532901763916, gen p mean: 0.0, mean p set: 0.44819650053977966
loss_pred:0.028236927464604378, decouple_loss:0.011435827240347862
loss_pred:0.027680465951561928, decouple_loss:0.011834547854959965The modified gen p mean: 0.45390456914901733, gen p mean: 0.0, mean p set: 0.448201984167099
loss_pred:0.027186905965209007, decouple_loss:0.012020615860819817
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466122090816498, gen p mean: 0.0, mean p set: 0.4478999972343445
loss_pred:0.027999967336654663, decouple_loss:0.011463090777397156
The modified gen p mean: 0.45126670598983765, gen p mean: 0.0, mean p set: 0.44789719581604004
The modified gen p mean: 0.44414645433425903, gen p mean: 0.0, mean p set: 0.44836533069610596
loss_pred:0.028414243832230568, decouple_loss:0.011444167234003544
loss_pred:0.02806408330798149, decouple_loss:0.011042077094316483
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4385625422000885, gen p mean: 0.0, mean p set: 0.44859638810157776
The modified gen p mean: 0.4419195055961609, gen p mean: 0.0, mean p set: 0.44819343090057373
loss_pred:0.029134787619113922, decouple_loss:0.011496166698634624
The modified gen p mean: 0.4388028681278229, gen p mean: 0.0, mean p set: 0.44926151633262634loss_pred:0.028215544298291206, decouple_loss:0.011537136510014534
loss_pred:0.027463924139738083, decouple_loss:0.011679773218929768
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937780499458313, gen p mean: 0.0, mean p set: 0.44828298687934875
The modified gen p mean: 0.44808387756347656, gen p mean: 0.0, mean p set: 0.44776955246925354loss_pred:0.02892715111374855, decouple_loss:0.011133521795272827
The modified gen p mean: 0.4496331810951233, gen p mean: 0.0, mean p set: 0.4479960799217224
loss_pred:0.027731984853744507, decouple_loss:0.011281715705990791
loss_pred:0.02837803214788437, decouple_loss:0.01142195239663124
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45380911231040955, gen p mean: 0.0, mean p set: 0.4482753276824951
loss_pred:0.02917066216468811, decouple_loss:0.011365030892193317The modified gen p mean: 0.45904454588890076, gen p mean: 0.0, mean p set: 0.4484822154045105
The modified gen p mean: 0.4597878158092499, gen p mean: 0.0, mean p set: 0.44792643189430237
loss_pred:0.02826092019677162, decouple_loss:0.011150151491165161
loss_pred:0.028951076790690422, decouple_loss:0.010675708763301373
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45363542437553406, gen p mean: 0.0, mean p set: 0.4486706554889679
The modified gen p mean: 0.45488598942756653, gen p mean: 0.0, mean p set: 0.4488089084625244
loss_pred:0.02664092741906643, decouple_loss:0.011099958792328835
loss_pred:0.02869013324379921, decouple_loss:0.011041718535125256The modified gen p mean: 0.45187461376190186, gen p mean: 0.0, mean p set: 0.44854554533958435
loss_pred:0.02647877298295498, decouple_loss:0.01122105773538351
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43936285376548767, gen p mean: 0.0, mean p set: 0.4476061165332794
loss_pred:0.027585092931985855, decouple_loss:0.010916419327259064
The modified gen p mean: 0.43904364109039307, gen p mean: 0.0, mean p set: 0.44810721278190613
The modified gen p mean: 0.43667030334472656, gen p mean: 0.0, mean p set: 0.4482516348361969
loss_pred:0.028614746406674385, decouple_loss:0.011020504869520664
loss_pred:0.02786571905016899, decouple_loss:0.010910038836300373
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45083606243133545, gen p mean: 0.0, mean p set: 0.44839832186698914
The modified gen p mean: 0.4482591152191162, gen p mean: 0.0, mean p set: 0.44928398728370667
loss_pred:0.026914268732070923, decouple_loss:0.011361410841345787
loss_pred:0.028620226308703423, decouple_loss:0.010930504649877548The modified gen p mean: 0.4479307532310486, gen p mean: 0.0, mean p set: 0.44838467240333557
loss_pred:0.026738591492176056, decouple_loss:0.011221932247281075
2023-05-04 11:51:17 testing...
The modified gen p mean: 0.43809911608695984, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44509249925613403, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4480074644088745, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.028800006955862045, decouple_loss:0.011501789093017578
loss_pred:0.027836663648486137, decouple_loss:0.011251547373831272
loss_pred:0.027480684220790863, decouple_loss:0.011096708476543427
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028603285551071167, avg_mse: 0.033608175814151764
current test mse: 0.033608
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44240516424179077, gen p mean: 0.0, mean p set: 0.4485490918159485
The modified gen p mean: 0.44876375794410706, gen p mean: 0.0, mean p set: 0.44889721274375916
loss_pred:0.02887840010225773, decouple_loss:0.011218449100852013
loss_pred:0.026887066662311554, decouple_loss:0.01092960499227047
The modified gen p mean: 0.4443255066871643, gen p mean: 0.0, mean p set: 0.44892874360084534
loss_pred:0.02780204825103283, decouple_loss:0.010815432295203209
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4549327790737152, gen p mean: 0.0, mean p set: 0.4496433436870575
The modified gen p mean: 0.45705386996269226, gen p mean: 0.0, mean p set: 0.4487065374851227
loss_pred:0.028011854737997055, decouple_loss:0.010389710776507854
loss_pred:0.027232924476265907, decouple_loss:0.0111849969252944The modified gen p mean: 0.45317164063453674, gen p mean: 0.0, mean p set: 0.44838589429855347
loss_pred:0.027783814817667007, decouple_loss:0.010957315564155579
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4554671347141266, gen p mean: 0.0, mean p set: 0.4492427408695221
loss_pred:0.027837608009576797, decouple_loss:0.010684134438633919
The modified gen p mean: 0.4476664960384369, gen p mean: 0.0, mean p set: 0.44828253984451294
The modified gen p mean: 0.44714662432670593, gen p mean: 0.0, mean p set: 0.448775053024292
loss_pred:0.02911783941090107, decouple_loss:0.010765625163912773
loss_pred:0.02820598892867565, decouple_loss:0.010796675458550453
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43568065762519836, gen p mean: 0.0, mean p set: 0.44847962260246277
The modified gen p mean: 0.4335775375366211, gen p mean: 0.0, mean p set: 0.4489077031612396
loss_pred:0.029253965243697166, decouple_loss:0.011230857111513615
The modified gen p mean: 0.43886032700538635, gen p mean: 0.0, mean p set: 0.4481166899204254loss_pred:0.027055049315094948, decouple_loss:0.011215094476938248
loss_pred:0.02843778394162655, decouple_loss:0.010756246745586395
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45364290475845337, gen p mean: 0.0, mean p set: 0.4476796090602875
loss_pred:0.027914253994822502, decouple_loss:0.010726355016231537
The modified gen p mean: 0.461219847202301, gen p mean: 0.0, mean p set: 0.44859370589256287
The modified gen p mean: 0.45312467217445374, gen p mean: 0.0, mean p set: 0.4483576714992523
loss_pred:0.02813277207314968, decouple_loss:0.010421759448945522
loss_pred:0.028157036751508713, decouple_loss:0.010741639882326126
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532034397125244, gen p mean: 0.0, mean p set: 0.4482157230377197
The modified gen p mean: 0.45387881994247437, gen p mean: 0.0, mean p set: 0.44802939891815186
loss_pred:0.027420049533247948, decouple_loss:0.010283408686518669
loss_pred:0.027945909649133682, decouple_loss:0.010365384630858898The modified gen p mean: 0.4549127519130707, gen p mean: 0.0, mean p set: 0.44826412200927734
loss_pred:0.0273281242698431, decouple_loss:0.010426534339785576
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479231536388397, gen p mean: 0.0, mean p set: 0.44797900319099426
The modified gen p mean: 0.44984614849090576, gen p mean: 0.0, mean p set: 0.4480193257331848
loss_pred:0.0278637558221817, decouple_loss:0.010527152568101883
The modified gen p mean: 0.44951504468917847, gen p mean: 0.0, mean p set: 0.4483139216899872loss_pred:0.027665123343467712, decouple_loss:0.010570615530014038
loss_pred:0.027706025168299675, decouple_loss:0.010265672579407692
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45272296667099, gen p mean: 0.0, mean p set: 0.4488312005996704
loss_pred:0.02677753008902073, decouple_loss:0.010764162056148052
The modified gen p mean: 0.4491501748561859, gen p mean: 0.0, mean p set: 0.44846177101135254
The modified gen p mean: 0.4441361129283905, gen p mean: 0.0, mean p set: 0.4479837417602539
loss_pred:0.028420764952898026, decouple_loss:0.010362332686781883
loss_pred:0.02767755277454853, decouple_loss:0.010600489564239979
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4356984794139862, gen p mean: 0.0, mean p set: 0.448341965675354
The modified gen p mean: 0.4372958540916443, gen p mean: 0.0, mean p set: 0.4477587640285492
loss_pred:0.02795739658176899, decouple_loss:0.010089565999805927
The modified gen p mean: 0.4403851628303528, gen p mean: 0.0, mean p set: 0.44904080033302307
loss_pred:0.027107231318950653, decouple_loss:0.010280642658472061
loss_pred:0.02633533626794815, decouple_loss:0.010305196978151798
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4448257088661194, gen p mean: 0.0, mean p set: 0.449325829744339
The modified gen p mean: 0.438900887966156, gen p mean: 0.0, mean p set: 0.44880568981170654
loss_pred:0.02800970897078514, decouple_loss:0.011170350946485996
The modified gen p mean: 0.4436972737312317, gen p mean: 0.0, mean p set: 0.44941452145576477
loss_pred:0.026903454214334488, decouple_loss:0.011714360676705837
loss_pred:0.027707844972610474, decouple_loss:0.010775680653750896
2023-05-04 11:55:35 testing...
The modified gen p mean: 0.45647454261779785, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.46359536051750183, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4661911427974701, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.028626320883631706, decouple_loss:0.010608847253024578
loss_pred:0.027416251599788666, decouple_loss:0.010630362667143345
loss_pred:0.027636680752038956, decouple_loss:0.010556153953075409
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02842300944030285, avg_mse: 0.033379122614860535
current test mse: 0.033379
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4619259536266327, gen p mean: 0.0, mean p set: 0.448443204164505
The modified gen p mean: 0.46000605821609497, gen p mean: 0.0, mean p set: 0.44759440422058105
loss_pred:0.027248170226812363, decouple_loss:0.010625040158629417
loss_pred:0.02782660722732544, decouple_loss:0.010866313241422176
The modified gen p mean: 0.45978471636772156, gen p mean: 0.0, mean p set: 0.44762441515922546
loss_pred:0.028133202344179153, decouple_loss:0.01210692897439003
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45790886878967285, gen p mean: 0.0, mean p set: 0.44866064190864563
The modified gen p mean: 0.4542474150657654, gen p mean: 0.0, mean p set: 0.44897186756134033
loss_pred:0.027933362871408463, decouple_loss:0.011361617594957352
loss_pred:0.02860105037689209, decouple_loss:0.011189449578523636
The modified gen p mean: 0.4596281349658966, gen p mean: 0.0, mean p set: 0.4479982852935791
loss_pred:0.026721524074673653, decouple_loss:0.010310051031410694
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44988083839416504, gen p mean: 0.0, mean p set: 0.4471501410007477
loss_pred:0.02831510454416275, decouple_loss:0.011297900229692459
The modified gen p mean: 0.44425779581069946, gen p mean: 0.0, mean p set: 0.4477570950984955
The modified gen p mean: 0.44785475730895996, gen p mean: 0.0, mean p set: 0.4476620554924011
loss_pred:0.028207428753376007, decouple_loss:0.010799124836921692
loss_pred:0.028692157939076424, decouple_loss:0.011098803952336311
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4394289553165436, gen p mean: 0.0, mean p set: 0.448081910610199
loss_pred:0.028992166742682457, decouple_loss:0.011022290214896202
The modified gen p mean: 0.4384716749191284, gen p mean: 0.0, mean p set: 0.44860947132110596
The modified gen p mean: 0.4397650361061096, gen p mean: 0.0, mean p set: 0.4469318985939026
loss_pred:0.029389899224042892, decouple_loss:0.011318773962557316
loss_pred:0.027862487360835075, decouple_loss:0.01073557510972023
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43894243240356445, gen p mean: 0.0, mean p set: 0.4477013349533081
The modified gen p mean: 0.4427579343318939, gen p mean: 0.0, mean p set: 0.4482389986515045
loss_pred:0.02812621183693409, decouple_loss:0.010835998691618443
loss_pred:0.02774548903107643, decouple_loss:0.0107126384973526
The modified gen p mean: 0.44529175758361816, gen p mean: 0.0, mean p set: 0.44830334186553955
loss_pred:0.028752360492944717, decouple_loss:0.011102473363280296
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832009077072144, gen p mean: 0.0, mean p set: 0.4471273422241211
The modified gen p mean: 0.4495140314102173, gen p mean: 0.0, mean p set: 0.4470519721508026
loss_pred:0.02854098379611969, decouple_loss:0.011129260063171387
loss_pred:0.0283050537109375, decouple_loss:0.0109598683193326The modified gen p mean: 0.4437892436981201, gen p mean: 0.0, mean p set: 0.44924864172935486
loss_pred:0.026898005977272987, decouple_loss:0.011352833360433578
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4562600553035736, gen p mean: 0.0, mean p set: 0.448304146528244
The modified gen p mean: 0.46167948842048645, gen p mean: 0.0, mean p set: 0.4486064314842224
loss_pred:0.027731195092201233, decouple_loss:0.011000857688486576
The modified gen p mean: 0.45555761456489563, gen p mean: 0.0, mean p set: 0.44800394773483276loss_pred:0.026654841378331184, decouple_loss:0.010764730162918568
loss_pred:0.02818387933075428, decouple_loss:0.010788330808281898
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4546130299568176, gen p mean: 0.0, mean p set: 0.44830429553985596
loss_pred:0.027088556438684464, decouple_loss:0.010679668746888638
The modified gen p mean: 0.4547203779220581, gen p mean: 0.0, mean p set: 0.44896969199180603
The modified gen p mean: 0.4540194272994995, gen p mean: 0.0, mean p set: 0.4473787844181061
loss_pred:0.02810230851173401, decouple_loss:0.010892248712480068
loss_pred:0.02772035263478756, decouple_loss:0.011105189099907875
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445275217294693, gen p mean: 0.0, mean p set: 0.4482576549053192
loss_pred:0.0282058697193861, decouple_loss:0.010247121565043926The modified gen p mean: 0.4469875991344452, gen p mean: 0.0, mean p set: 0.44888588786125183
The modified gen p mean: 0.4403024911880493, gen p mean: 0.0, mean p set: 0.4473388195037842
loss_pred:0.027036773040890694, decouple_loss:0.010844424366950989
loss_pred:0.02777170017361641, decouple_loss:0.010329221375286579
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44495469331741333, gen p mean: 0.0, mean p set: 0.4485197067260742
loss_pred:0.0265825018286705, decouple_loss:0.010231132619082928
The modified gen p mean: 0.4409218430519104, gen p mean: 0.0, mean p set: 0.4491487443447113
The modified gen p mean: 0.43952125310897827, gen p mean: 0.0, mean p set: 0.44789108633995056
loss_pred:0.02871946431696415, decouple_loss:0.011247444897890091
loss_pred:0.02720468118786812, decouple_loss:0.01039370521903038
2023-05-04 11:59:12 testing...
The modified gen p mean: 0.4390886425971985, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4470036029815674, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4498157501220703, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.028674021363258362, decouple_loss:0.01059501152485609
loss_pred:0.027584001421928406, decouple_loss:0.010561447590589523
loss_pred:0.027199773117899895, decouple_loss:0.010625509545207024
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02834896557033062, avg_mse: 0.03329954668879509
current test mse: 0.0333
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44461920857429504, gen p mean: 0.0, mean p set: 0.44758692383766174
The modified gen p mean: 0.4450395703315735, gen p mean: 0.0, mean p set: 0.4476523995399475
loss_pred:0.02901451848447323, decouple_loss:0.010740354657173157
loss_pred:0.02838628925383091, decouple_loss:0.010393505915999413
The modified gen p mean: 0.4478943645954132, gen p mean: 0.0, mean p set: 0.44966015219688416
loss_pred:0.027004079893231392, decouple_loss:0.010408507660031319
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4549965560436249, gen p mean: 0.0, mean p set: 0.447422593832016
loss_pred:0.027545737102627754, decouple_loss:0.01046720426529646
The modified gen p mean: 0.4532613158226013, gen p mean: 0.0, mean p set: 0.4472118318080902
The modified gen p mean: 0.45325547456741333, gen p mean: 0.0, mean p set: 0.4477090537548065
loss_pred:0.0275118388235569, decouple_loss:0.010369868017733097
loss_pred:0.027097662910819054, decouple_loss:0.010158935561776161
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515599012374878, gen p mean: 0.0, mean p set: 0.44794946908950806
loss_pred:0.027339307591319084, decouple_loss:0.010660136118531227
The modified gen p mean: 0.4520038366317749, gen p mean: 0.0, mean p set: 0.4490576982498169
The modified gen p mean: 0.45163166522979736, gen p mean: 0.0, mean p set: 0.44783034920692444
loss_pred:0.02668284811079502, decouple_loss:0.010098230093717575
loss_pred:0.0279832910746336, decouple_loss:0.01014910638332367
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450749933719635, gen p mean: 0.0, mean p set: 0.44770386815071106
The modified gen p mean: 0.44421684741973877, gen p mean: 0.0, mean p set: 0.4485662877559662
loss_pred:0.027643561363220215, decouple_loss:0.010146843269467354
The modified gen p mean: 0.4501068890094757, gen p mean: 0.0, mean p set: 0.4478378891944885loss_pred:0.026741061359643936, decouple_loss:0.010273388586938381
loss_pred:0.027164509519934654, decouple_loss:0.0100824274122715
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4397895038127899, gen p mean: 0.0, mean p set: 0.44768473505973816
The modified gen p mean: 0.44407638907432556, gen p mean: 0.0, mean p set: 0.44800183176994324
loss_pred:0.028104661032557487, decouple_loss:0.009858042933046818
The modified gen p mean: 0.4371426999568939, gen p mean: 0.0, mean p set: 0.44853144884109497
loss_pred:0.027851440012454987, decouple_loss:0.009721720591187477
loss_pred:0.027532443404197693, decouple_loss:0.010288245044648647
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521842300891876, gen p mean: 0.0, mean p set: 0.4486024081707001
The modified gen p mean: 0.4524783492088318, gen p mean: 0.0, mean p set: 0.4481918513774872
loss_pred:0.027681047096848488, decouple_loss:0.009645157493650913
loss_pred:0.02752794697880745, decouple_loss:0.010147036984562874
The modified gen p mean: 0.45187124609947205, gen p mean: 0.0, mean p set: 0.4481172263622284
loss_pred:0.02749360352754593, decouple_loss:0.009791256859898567
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4542364180088043, gen p mean: 0.0, mean p set: 0.448910653591156
loss_pred:0.026849882677197456, decouple_loss:0.010093344375491142
The modified gen p mean: 0.4487021267414093, gen p mean: 0.0, mean p set: 0.4483886957168579
The modified gen p mean: 0.448037713766098, gen p mean: 0.0, mean p set: 0.4487426280975342
loss_pred:0.028039025142788887, decouple_loss:0.010229035280644894
loss_pred:0.02717362530529499, decouple_loss:0.010120738297700882
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4443877041339874, gen p mean: 0.0, mean p set: 0.44737890362739563
The modified gen p mean: 0.44582879543304443, gen p mean: 0.0, mean p set: 0.4477039873600006
loss_pred:0.0276349987834692, decouple_loss:0.009812181815505028
loss_pred:0.026062287390232086, decouple_loss:0.00993275735527277The modified gen p mean: 0.44345101714134216, gen p mean: 0.0, mean p set: 0.4476398825645447
loss_pred:0.027492543682456017, decouple_loss:0.009667308069765568
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44649553298950195, gen p mean: 0.0, mean p set: 0.448486864566803
The modified gen p mean: 0.44797274470329285, gen p mean: 0.0, mean p set: 0.44869139790534973
loss_pred:0.0271262489259243, decouple_loss:0.010073468089103699
loss_pred:0.02645130269229412, decouple_loss:0.009732972830533981
The modified gen p mean: 0.44976919889450073, gen p mean: 0.0, mean p set: 0.4474763870239258
loss_pred:0.028099458664655685, decouple_loss:0.0099281445145607
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46062469482421875, gen p mean: 0.0, mean p set: 0.4476318955421448
The modified gen p mean: 0.4586314857006073, gen p mean: 0.0, mean p set: 0.44857192039489746
loss_pred:0.02840700000524521, decouple_loss:0.010125282220542431
The modified gen p mean: 0.4630368947982788, gen p mean: 0.0, mean p set: 0.4483031630516052
loss_pred:0.02854282408952713, decouple_loss:0.010529333725571632
loss_pred:0.028440337628126144, decouple_loss:0.010621858760714531
2023-05-04 12:03:28 testing...
The modified gen p mean: 0.43011295795440674, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44025900959968567, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4375683069229126, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.028588052839040756, decouple_loss:0.01019430160522461
loss_pred:0.027142414823174477, decouple_loss:0.009740197099745274
loss_pred:0.027493273839354515, decouple_loss:0.009922625496983528
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028238866478204727, avg_mse: 0.03308519348502159
current test mse: 0.033085
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4360154867172241, gen p mean: 0.0, mean p set: 0.447712779045105
The modified gen p mean: 0.4407426416873932, gen p mean: 0.0, mean p set: 0.44864511489868164
loss_pred:0.027854690328240395, decouple_loss:0.010322763584554195
loss_pred:0.027580562978982925, decouple_loss:0.01028444804251194
The modified gen p mean: 0.4419623613357544, gen p mean: 0.0, mean p set: 0.4489271342754364
loss_pred:0.026752710342407227, decouple_loss:0.00981668010354042
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4377407729625702, gen p mean: 0.0, mean p set: 0.44810402393341064
The modified gen p mean: 0.4335401952266693, gen p mean: 0.0, mean p set: 0.44911372661590576
loss_pred:0.026927778497338295, decouple_loss:0.010123219341039658
loss_pred:0.02714729681611061, decouple_loss:0.010298601351678371
The modified gen p mean: 0.43998485803604126, gen p mean: 0.0, mean p set: 0.44781461358070374
loss_pred:0.028606418520212173, decouple_loss:0.009709829464554787
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4541310966014862, gen p mean: 0.0, mean p set: 0.4488029479980469
loss_pred:0.02679368667304516, decouple_loss:0.01023817528039217
The modified gen p mean: 0.45195722579956055, gen p mean: 0.0, mean p set: 0.4484356641769409
The modified gen p mean: 0.45131543278694153, gen p mean: 0.0, mean p set: 0.44831880927085876
loss_pred:0.02775048464536667, decouple_loss:0.010043315589427948
loss_pred:0.028567073866724968, decouple_loss:0.009883797727525234
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925007224082947, gen p mean: 0.0, mean p set: 0.44936102628707886
loss_pred:0.026819787919521332, decouple_loss:0.010323140770196915
The modified gen p mean: 0.4523438513278961, gen p mean: 0.0, mean p set: 0.44927188754081726
The modified gen p mean: 0.45240694284439087, gen p mean: 0.0, mean p set: 0.4485013484954834
loss_pred:0.02755773440003395, decouple_loss:0.010133827105164528
loss_pred:0.027347417548298836, decouple_loss:0.009737073443830013
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4443439841270447, gen p mean: 0.0, mean p set: 0.44850432872772217
loss_pred:0.027028655633330345, decouple_loss:0.010180571116507053
The modified gen p mean: 0.449614942073822, gen p mean: 0.0, mean p set: 0.44664737582206726
The modified gen p mean: 0.45278406143188477, gen p mean: 0.0, mean p set: 0.4485422670841217
loss_pred:0.027363156899809837, decouple_loss:0.009854630567133427
loss_pred:0.028262849897146225, decouple_loss:0.01021847315132618
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725239276885986, gen p mean: 0.0, mean p set: 0.4492678940296173
The modified gen p mean: 0.4465894401073456, gen p mean: 0.0, mean p set: 0.44829073548316956
loss_pred:0.0269005224108696, decouple_loss:0.00939772929996252
loss_pred:0.028157643973827362, decouple_loss:0.00987109076231718The modified gen p mean: 0.44614461064338684, gen p mean: 0.0, mean p set: 0.4482678174972534
loss_pred:0.02758103609085083, decouple_loss:0.009903134778141975
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521026313304901, gen p mean: 0.0, mean p set: 0.44871973991394043
The modified gen p mean: 0.450545072555542, gen p mean: 0.0, mean p set: 0.4482938349246979
loss_pred:0.027216589078307152, decouple_loss:0.010055544786155224
loss_pred:0.027683520689606667, decouple_loss:0.009998624213039875The modified gen p mean: 0.4499644339084625, gen p mean: 0.0, mean p set: 0.4483374059200287
loss_pred:0.026471879333257675, decouple_loss:0.009736670181155205
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520739018917084, gen p mean: 0.0, mean p set: 0.44870471954345703
loss_pred:0.027762018144130707, decouple_loss:0.009601391851902008
The modified gen p mean: 0.4464731216430664, gen p mean: 0.0, mean p set: 0.44800689816474915
The modified gen p mean: 0.4504889249801636, gen p mean: 0.0, mean p set: 0.4475124180316925
loss_pred:0.027246292680501938, decouple_loss:0.009679126553237438
loss_pred:0.027962785214185715, decouple_loss:0.009672366082668304
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44437074661254883, gen p mean: 0.0, mean p set: 0.44831034541130066
The modified gen p mean: 0.44360291957855225, gen p mean: 0.0, mean p set: 0.448603093624115
loss_pred:0.028311459347605705, decouple_loss:0.009659545496106148
The modified gen p mean: 0.44460028409957886, gen p mean: 0.0, mean p set: 0.44685330986976624loss_pred:0.027626097202301025, decouple_loss:0.009539945051074028
loss_pred:0.027872193604707718, decouple_loss:0.009487801231443882
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44080913066864014, gen p mean: 0.0, mean p set: 0.4485968351364136
loss_pred:0.02654186263680458, decouple_loss:0.00989818200469017
The modified gen p mean: 0.4491848349571228, gen p mean: 0.0, mean p set: 0.44845762848854065
The modified gen p mean: 0.4461357593536377, gen p mean: 0.0, mean p set: 0.44938814640045166
loss_pred:0.0285042691975832, decouple_loss:0.009676963090896606
loss_pred:0.02649514377117157, decouple_loss:0.009893755428493023
2023-05-04 12:07:01 testing...
The modified gen p mean: 0.44150662422180176, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4512200653553009, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44841521978378296, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.028398822993040085, decouple_loss:0.010013708844780922
loss_pred:0.027078017592430115, decouple_loss:0.009672249667346478
loss_pred:0.027371032163500786, decouple_loss:0.009778459556400776
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02810703217983246, avg_mse: 0.03297140449285507
current test mse: 0.032971
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45227304100990295, gen p mean: 0.0, mean p set: 0.4487583637237549
The modified gen p mean: 0.4515005946159363, gen p mean: 0.0, mean p set: 0.4483935534954071
loss_pred:0.0281252209097147, decouple_loss:0.009364382363855839
loss_pred:0.026587408035993576, decouple_loss:0.009437690488994122
The modified gen p mean: 0.4505326747894287, gen p mean: 0.0, mean p set: 0.44872552156448364
loss_pred:0.028262747451663017, decouple_loss:0.00937476847320795
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485037624835968, gen p mean: 0.0, mean p set: 0.4477825164794922
The modified gen p mean: 0.4512227475643158, gen p mean: 0.0, mean p set: 0.4486865699291229
loss_pred:0.027787456288933754, decouple_loss:0.009371647611260414
loss_pred:0.027371998876333237, decouple_loss:0.009110710583627224The modified gen p mean: 0.4479294419288635, gen p mean: 0.0, mean p set: 0.44920313358306885
loss_pred:0.026638684794306755, decouple_loss:0.009512439370155334
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468104839324951, gen p mean: 0.0, mean p set: 0.4470512866973877
The modified gen p mean: 0.44823142886161804, gen p mean: 0.0, mean p set: 0.4481017291545868loss_pred:0.028186580166220665, decouple_loss:0.00951465591788292
The modified gen p mean: 0.4540952742099762, gen p mean: 0.0, mean p set: 0.4479440450668335
loss_pred:0.027065083384513855, decouple_loss:0.009348917752504349
loss_pred:0.027641229331493378, decouple_loss:0.009497778490185738
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477914869785309, gen p mean: 0.0, mean p set: 0.4490111172199249
The modified gen p mean: 0.443179726600647, gen p mean: 0.0, mean p set: 0.44748347997665405
loss_pred:0.02670629322528839, decouple_loss:0.009162772446870804
loss_pred:0.027423195540905, decouple_loss:0.00934989657253027The modified gen p mean: 0.4466397166252136, gen p mean: 0.0, mean p set: 0.44740280508995056
loss_pred:0.02736170031130314, decouple_loss:0.009352375753223896
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527503252029419, gen p mean: 0.0, mean p set: 0.44823122024536133
loss_pred:0.027854876592755318, decouple_loss:0.00938995461910963
The modified gen p mean: 0.45099738240242004, gen p mean: 0.0, mean p set: 0.448335200548172
The modified gen p mean: 0.4549163579940796, gen p mean: 0.0, mean p set: 0.44848933815956116
loss_pred:0.02686232700943947, decouple_loss:0.009212968870997429
loss_pred:0.02621537074446678, decouple_loss:0.009202939458191395
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507530629634857, gen p mean: 0.0, mean p set: 0.44869464635849
The modified gen p mean: 0.4440403878688812, gen p mean: 0.0, mean p set: 0.44858577847480774
loss_pred:0.027310336008667946, decouple_loss:0.009460934437811375
loss_pred:0.027033256366848946, decouple_loss:0.009466907940804958The modified gen p mean: 0.44717782735824585, gen p mean: 0.0, mean p set: 0.4483359158039093
loss_pred:0.027188435196876526, decouple_loss:0.009526215493679047
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4385647177696228, gen p mean: 0.0, mean p set: 0.4478394687175751
The modified gen p mean: 0.44246721267700195, gen p mean: 0.0, mean p set: 0.4484493136405945
loss_pred:0.028319070115685463, decouple_loss:0.009470523335039616
The modified gen p mean: 0.4446071982383728, gen p mean: 0.0, mean p set: 0.44724538922309875
loss_pred:0.026793891564011574, decouple_loss:0.008955972269177437
loss_pred:0.02817888930439949, decouple_loss:0.009227486327290535
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497818350791931, gen p mean: 0.0, mean p set: 0.4492388963699341
The modified gen p mean: 0.444085955619812, gen p mean: 0.0, mean p set: 0.4479339122772217
loss_pred:0.027234012261033058, decouple_loss:0.009335028938949108
loss_pred:0.027692772448062897, decouple_loss:0.009316724725067616The modified gen p mean: 0.4512037932872772, gen p mean: 0.0, mean p set: 0.4478871822357178
loss_pred:0.028537044301629066, decouple_loss:0.009161483496427536
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45528796315193176, gen p mean: 0.0, mean p set: 0.447892427444458
loss_pred:0.02835426665842533, decouple_loss:0.009169286116957664
The modified gen p mean: 0.45514506101608276, gen p mean: 0.0, mean p set: 0.44878846406936646
The modified gen p mean: 0.4538823366165161, gen p mean: 0.0, mean p set: 0.44839873909950256
loss_pred:0.028119057416915894, decouple_loss:0.009088325314223766
loss_pred:0.02669724076986313, decouple_loss:0.009255723096430302
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
NaN value num: 0
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470497667789459, gen p mean: 0.0, mean p set: 0.44929149746894836
The modified gen p mean: 0.4429393708705902, gen p mean: 0.0, mean p set: 0.4501986801624298
loss_pred:0.028867295011878014, decouple_loss:0.010206333361566067
The modified gen p mean: 0.4438176155090332, gen p mean: 0.0, mean p set: 0.45043838024139404
loss_pred:0.029898926615715027, decouple_loss:0.010277762077748775
loss_pred:0.028963690623641014, decouple_loss:0.010325523093342781
2023-05-04 12:11:22 testing...
The modified gen p mean: 0.45093968510627747, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4441590905189514, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45401015877723694, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.027517307549715042, decouple_loss:0.00968209095299244
loss_pred:0.028585132211446762, decouple_loss:0.009929406456649303
loss_pred:0.02720770612359047, decouple_loss:0.009748944081366062
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028259389102458954, avg_mse: 0.033120255917310715
current test mse: 0.03312
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45257100462913513, gen p mean: 0.0, mean p set: 0.4491483271121979
The modified gen p mean: 0.4565027952194214, gen p mean: 0.0, mean p set: 0.44925227761268616
loss_pred:0.02864689752459526, decouple_loss:0.009990982711315155loss_pred:0.02941218577325344, decouple_loss:0.009903830476105213
The modified gen p mean: 0.4546990990638733, gen p mean: 0.0, mean p set: 0.44875091314315796
loss_pred:0.029047852382063866, decouple_loss:0.009646706283092499
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4393627941608429, gen p mean: 0.0, mean p set: 0.4507625102996826
The modified gen p mean: 0.4440005421638489, gen p mean: 0.0, mean p set: 0.44983765482902527
loss_pred:0.029488354921340942, decouple_loss:0.010291523300111294
loss_pred:0.027434946969151497, decouple_loss:0.009592704474925995The modified gen p mean: 0.4416869878768921, gen p mean: 0.0, mean p set: 0.44867777824401855
loss_pred:0.028297338634729385, decouple_loss:0.00980125367641449
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44432321190834045, gen p mean: 0.0, mean p set: 0.44995957612991333
The modified gen p mean: 0.44490548968315125, gen p mean: 0.0, mean p set: 0.4496876895427704
loss_pred:0.02869824320077896, decouple_loss:0.009946785867214203
The modified gen p mean: 0.4439062178134918, gen p mean: 0.0, mean p set: 0.44966015219688416loss_pred:0.02917897328734398, decouple_loss:0.010099845007061958
loss_pred:0.028164813295006752, decouple_loss:0.010042528621852398
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.457454651594162, gen p mean: 0.0, mean p set: 0.4491855800151825
The modified gen p mean: 0.45541372895240784, gen p mean: 0.0, mean p set: 0.45019885897636414
loss_pred:0.02833203412592411, decouple_loss:0.010299327783286572
loss_pred:0.02929368056356907, decouple_loss:0.0107711311429739The modified gen p mean: 0.44980522990226746, gen p mean: 0.0, mean p set: 0.4501812756061554
loss_pred:0.02921450324356556, decouple_loss:0.010485966689884663
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4641532897949219, gen p mean: 0.0, mean p set: 0.4499370753765106
The modified gen p mean: 0.4634762704372406, gen p mean: 0.0, mean p set: 0.4487350583076477
loss_pred:0.02884034998714924, decouple_loss:0.009554549120366573
loss_pred:0.02870800346136093, decouple_loss:0.009807324968278408The modified gen p mean: 0.45495057106018066, gen p mean: 0.0, mean p set: 0.4500735104084015
loss_pred:0.028147630393505096, decouple_loss:0.010739577934145927
Iteration: 306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4402361810207367, gen p mean: 0.0, mean p set: 0.4495299160480499
loss_pred:0.028850911185145378, decouple_loss:0.010422899387776852
The modified gen p mean: 0.44744783639907837, gen p mean: 0.0, mean p set: 0.4483890235424042
The modified gen p mean: 0.4459168612957001, gen p mean: 0.0, mean p set: 0.4494244158267975
loss_pred:0.02764713577926159, decouple_loss:0.009883163496851921
loss_pred:0.02834172360599041, decouple_loss:0.009962920099496841
Iteration: 307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467434287071228, gen p mean: 0.0, mean p set: 0.44943687319755554
The modified gen p mean: 0.44297468662261963, gen p mean: 0.0, mean p set: 0.4504740536212921
loss_pred:0.02899688296020031, decouple_loss:0.009423516690731049
loss_pred:0.028633613139390945, decouple_loss:0.009614710696041584The modified gen p mean: 0.4405508041381836, gen p mean: 0.0, mean p set: 0.4502294957637787
loss_pred:0.029783423990011215, decouple_loss:0.009500948712229729
Iteration: 308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495513439178467, gen p mean: 0.0, mean p set: 0.44967401027679443
The modified gen p mean: 0.45029380917549133, gen p mean: 0.0, mean p set: 0.4499465525150299
loss_pred:0.028796454891562462, decouple_loss:0.009572586044669151
loss_pred:0.027674634009599686, decouple_loss:0.009392197243869305The modified gen p mean: 0.4474487900733948, gen p mean: 0.0, mean p set: 0.4506526291370392
loss_pred:0.029821734875440598, decouple_loss:0.01017917599529028
Iteration: 309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462425410747528, gen p mean: 0.0, mean p set: 0.4501313269138336
loss_pred:0.028090152889490128, decouple_loss:0.009467452764511108
The modified gen p mean: 0.45278558135032654, gen p mean: 0.0, mean p set: 0.449175626039505
The modified gen p mean: 0.43964293599128723, gen p mean: 0.0, mean p set: 0.450113981962204
loss_pred:0.029198065400123596, decouple_loss:0.009870518930256367
loss_pred:0.028549741953611374, decouple_loss:0.009461077861487865
Iteration: 310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46106868982315063, gen p mean: 0.0, mean p set: 0.4486234188079834
loss_pred:0.02887510322034359, decouple_loss:0.009479284286499023
The modified gen p mean: 0.4533807635307312, gen p mean: 0.0, mean p set: 0.45035961270332336
The modified gen p mean: 0.4591468870639801, gen p mean: 0.0, mean p set: 0.44925686717033386
loss_pred:0.029683465138077736, decouple_loss:0.009065655060112476
loss_pred:0.02897913008928299, decouple_loss:0.009406494908034801
2023-05-04 12:14:54 testing...
The modified gen p mean: 0.4424132704734802, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45165523886680603, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4489789307117462, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.028528116643428802, decouple_loss:0.010310211218893528
loss_pred:0.027158809825778008, decouple_loss:0.010079819709062576
loss_pred:0.02746560238301754, decouple_loss:0.010035381652414799
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028224600479006767, avg_mse: 0.03322070464491844
current test mse: 0.033221
Iteration: 311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451281428337097, gen p mean: 0.0, mean p set: 0.45061272382736206
The modified gen p mean: 0.4451241195201874, gen p mean: 0.0, mean p set: 0.44969442486763
loss_pred:0.029387006536126137, decouple_loss:0.010193191468715668
loss_pred:0.029592059552669525, decouple_loss:0.009136737324297428
The modified gen p mean: 0.4446023106575012, gen p mean: 0.0, mean p set: 0.45033130049705505
loss_pred:0.029068978503346443, decouple_loss:0.01006623636931181
Iteration: 312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500281810760498, gen p mean: 0.0, mean p set: 0.4489312171936035
The modified gen p mean: 0.44242653250694275, gen p mean: 0.0, mean p set: 0.44920605421066284
loss_pred:0.028784852474927902, decouple_loss:0.009501630440354347
loss_pred:0.028537919744849205, decouple_loss:0.01034476887434721The modified gen p mean: 0.4440802335739136, gen p mean: 0.0, mean p set: 0.450385719537735
loss_pred:0.028885729610919952, decouple_loss:0.0096967164427042
Iteration: 313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147547125816345, gen p mean: 0.0, mean p set: 0.4497784972190857
The modified gen p mean: 0.4478743374347687, gen p mean: 0.0, mean p set: 0.4501429796218872
loss_pred:0.030677754431962967, decouple_loss:0.00960515160113573
loss_pred:0.028056057170033455, decouple_loss:0.009580204263329506
The modified gen p mean: 0.4504527151584625, gen p mean: 0.0, mean p set: 0.4490078091621399
loss_pred:0.028169825673103333, decouple_loss:0.009376092813909054
Iteration: 314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45606666803359985, gen p mean: 0.0, mean p set: 0.44925400614738464
The modified gen p mean: 0.449817955493927, gen p mean: 0.0, mean p set: 0.4491247832775116
loss_pred:0.027971966192126274, decouple_loss:0.00952718872576952
loss_pred:0.02805684693157673, decouple_loss:0.009662115946412086The modified gen p mean: 0.45189595222473145, gen p mean: 0.0, mean p set: 0.45020923018455505
loss_pred:0.029000800102949142, decouple_loss:0.009641877375543118
Iteration: 315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45321962237358093, gen p mean: 0.0, mean p set: 0.45009905099868774
The modified gen p mean: 0.4557933807373047, gen p mean: 0.0, mean p set: 0.4499610364437103
loss_pred:0.028618937358260155, decouple_loss:0.009174851700663567
The modified gen p mean: 0.4474872946739197, gen p mean: 0.0, mean p set: 0.45017439126968384loss_pred:0.028581000864505768, decouple_loss:0.00895128957927227
loss_pred:0.029095392674207687, decouple_loss:0.009950137697160244
Iteration: 316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458361268043518, gen p mean: 0.0, mean p set: 0.4503738284111023
The modified gen p mean: 0.4455137848854065, gen p mean: 0.0, mean p set: 0.4500521421432495
loss_pred:0.02798967808485031, decouple_loss:0.00941319391131401
loss_pred:0.02732134982943535, decouple_loss:0.009085638448596The modified gen p mean: 0.4451318383216858, gen p mean: 0.0, mean p set: 0.44864723086357117
loss_pred:0.028991326689720154, decouple_loss:0.009469366632401943
Iteration: 317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44192278385162354, gen p mean: 0.0, mean p set: 0.4494764804840088
The modified gen p mean: 0.4402479827404022, gen p mean: 0.0, mean p set: 0.4495510160923004
loss_pred:0.028040364384651184, decouple_loss:0.009382644668221474
loss_pred:0.030181167647242546, decouple_loss:0.009247875772416592
The modified gen p mean: 0.4411121904850006, gen p mean: 0.0, mean p set: 0.4497062563896179
loss_pred:0.02857636846601963, decouple_loss:0.009473484940826893
Iteration: 318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45569732785224915, gen p mean: 0.0, mean p set: 0.4493584930896759
loss_pred:0.029727326706051826, decouple_loss:0.009131520986557007The modified gen p mean: 0.4526471197605133, gen p mean: 0.0, mean p set: 0.45085832476615906
The modified gen p mean: 0.4527522623538971, gen p mean: 0.0, mean p set: 0.4502195417881012
loss_pred:0.028588350862264633, decouple_loss:0.009138154797255993
loss_pred:0.028259454295039177, decouple_loss:0.009368488565087318
Iteration: 319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46845170855522156, gen p mean: 0.0, mean p set: 0.4494204819202423
The modified gen p mean: 0.4660075604915619, gen p mean: 0.0, mean p set: 0.44902318716049194
loss_pred:0.029666876420378685, decouple_loss:0.009291479364037514
loss_pred:0.028114404529333115, decouple_loss:0.009471719153225422The modified gen p mean: 0.46626099944114685, gen p mean: 0.0, mean p set: 0.44897153973579407
loss_pred:0.027909772470593452, decouple_loss:0.00937636848539114
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4417933523654938, gen p mean: 0.0, mean p set: 0.4467509686946869
The modified gen p mean: 0.44532305002212524, gen p mean: 0.0, mean p set: 0.4484681785106659
loss_pred:0.02773594669997692, decouple_loss:0.009703178890049458
The modified gen p mean: 0.44326502084732056, gen p mean: 0.0, mean p set: 0.44838324189186096
loss_pred:0.02806060016155243, decouple_loss:0.009602234698832035
loss_pred:0.02773011103272438, decouple_loss:0.009719442576169968
2023-05-04 12:19:09 testing...
The modified gen p mean: 0.41979703307151794, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.42983001470565796, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.42679154872894287, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.028618600219488144, decouple_loss:0.010248479433357716
loss_pred:0.027146434411406517, decouple_loss:0.009713537991046906
loss_pred:0.027527138590812683, decouple_loss:0.009734841994941235
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028259005397558212, avg_mse: 0.033108435571193695
current test mse: 0.033108
Iteration: 321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42782577872276306, gen p mean: 0.0, mean p set: 0.44779056310653687
The modified gen p mean: 0.4284932613372803, gen p mean: 0.0, mean p set: 0.447729229927063
loss_pred:0.02682996727526188, decouple_loss:0.009939022362232208
loss_pred:0.0277657900005579, decouple_loss:0.00976916216313839
The modified gen p mean: 0.42948633432388306, gen p mean: 0.0, mean p set: 0.4470071494579315
loss_pred:0.027327513322234154, decouple_loss:0.009466242045164108
Iteration: 322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45173966884613037, gen p mean: 0.0, mean p set: 0.4481656849384308
The modified gen p mean: 0.4508861303329468, gen p mean: 0.0, mean p set: 0.44759562611579895
loss_pred:0.02789152041077614, decouple_loss:0.009531463496387005
loss_pred:0.026719646528363228, decouple_loss:0.00971931405365467
The modified gen p mean: 0.4516444504261017, gen p mean: 0.0, mean p set: 0.44812464714050293
loss_pred:0.027147501707077026, decouple_loss:0.009678175672888756
Iteration: 323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4648081660270691, gen p mean: 0.0, mean p set: 0.4486413896083832
The modified gen p mean: 0.4645775258541107, gen p mean: 0.0, mean p set: 0.4478640854358673
loss_pred:0.02664264291524887, decouple_loss:0.010005142539739609
loss_pred:0.02673596888780594, decouple_loss:0.01014003437012434The modified gen p mean: 0.4602185785770416, gen p mean: 0.0, mean p set: 0.44784313440322876
loss_pred:0.028106827288866043, decouple_loss:0.00980850588530302
Iteration: 324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44306680560112, gen p mean: 0.0, mean p set: 0.4478125274181366
loss_pred:0.02660287544131279, decouple_loss:0.00938979908823967
The modified gen p mean: 0.4433746039867401, gen p mean: 0.0, mean p set: 0.44724181294441223
The modified gen p mean: 0.4460161626338959, gen p mean: 0.0, mean p set: 0.4473138451576233
loss_pred:0.027436798438429832, decouple_loss:0.0096799461171031
loss_pred:0.02657853066921234, decouple_loss:0.00925143901258707
Iteration: 325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44138824939727783, gen p mean: 0.0, mean p set: 0.44661951065063477
loss_pred:0.027367305010557175, decouple_loss:0.009373337961733341
The modified gen p mean: 0.4358403980731964, gen p mean: 0.0, mean p set: 0.44841933250427246
The modified gen p mean: 0.4355654716491699, gen p mean: 0.0, mean p set: 0.4470813572406769
loss_pred:0.02709541656076908, decouple_loss:0.009099914692342281
loss_pred:0.028648730367422104, decouple_loss:0.009256603196263313
Iteration: 326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841575622558594, gen p mean: 0.0, mean p set: 0.44746458530426025
loss_pred:0.026825789362192154, decouple_loss:0.009172854945063591
The modified gen p mean: 0.44996848702430725, gen p mean: 0.0, mean p set: 0.44884711503982544
The modified gen p mean: 0.4524471163749695, gen p mean: 0.0, mean p set: 0.448952317237854
loss_pred:0.02721288986504078, decouple_loss:0.009353346191346645
loss_pred:0.027120063081383705, decouple_loss:0.009472324512898922
Iteration: 327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45507434010505676, gen p mean: 0.0, mean p set: 0.44803258776664734
The modified gen p mean: 0.4583824872970581, gen p mean: 0.0, mean p set: 0.44888749718666077
loss_pred:0.027184369042515755, decouple_loss:0.009326273575425148
loss_pred:0.026979289948940277, decouple_loss:0.008847342804074287
The modified gen p mean: 0.45841747522354126, gen p mean: 0.0, mean p set: 0.4487118422985077
loss_pred:0.027168959379196167, decouple_loss:0.008971893228590488
Iteration: 328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44502487778663635, gen p mean: 0.0, mean p set: 0.4485728442668915
The modified gen p mean: 0.445193886756897, gen p mean: 0.0, mean p set: 0.44809815287590027
loss_pred:0.026787856593728065, decouple_loss:0.008954665623605251
The modified gen p mean: 0.4428739845752716, gen p mean: 0.0, mean p set: 0.44638389348983765loss_pred:0.026751777157187462, decouple_loss:0.009390630759298801
loss_pred:0.02638167142868042, decouple_loss:0.009494825266301632
Iteration: 329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4435681104660034, gen p mean: 0.0, mean p set: 0.44725507497787476
loss_pred:0.026974637061357498, decouple_loss:0.009365523234009743
The modified gen p mean: 0.44091588258743286, gen p mean: 0.0, mean p set: 0.44719401001930237
The modified gen p mean: 0.4422030746936798, gen p mean: 0.0, mean p set: 0.44756636023521423
loss_pred:0.02719232626259327, decouple_loss:0.009316305629909039
loss_pred:0.02779058739542961, decouple_loss:0.009449845179915428
Iteration: 330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4438994824886322, gen p mean: 0.0, mean p set: 0.44797375798225403
The modified gen p mean: 0.4473462700843811, gen p mean: 0.0, mean p set: 0.44827502965927124
loss_pred:0.02857910841703415, decouple_loss:0.009053696878254414
loss_pred:0.027058441191911697, decouple_loss:0.008843536488711834The modified gen p mean: 0.4481275677680969, gen p mean: 0.0, mean p set: 0.44691428542137146
loss_pred:0.027142491191625595, decouple_loss:0.009205765090882778
2023-05-04 12:22:41 testing...
The modified gen p mean: 0.4453057050704956, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45235729217529297, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45535534620285034, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02813146263360977, decouple_loss:0.009876653552055359
loss_pred:0.026885077357292175, decouple_loss:0.009508900344371796
loss_pred:0.027154283598065376, decouple_loss:0.009590345434844494
WV_0_PC_0_EH_0_PS_40_6, loss: 0.0278732068836689, avg_mse: 0.03284021094441414
current test mse: 0.03284
Iteration: 331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449492484331131, gen p mean: 0.0, mean p set: 0.4486749470233917
The modified gen p mean: 0.45199599862098694, gen p mean: 0.0, mean p set: 0.4477818012237549
loss_pred:0.028036387637257576, decouple_loss:0.009725147858262062
loss_pred:0.026695579290390015, decouple_loss:0.009172432124614716
The modified gen p mean: 0.45332738757133484, gen p mean: 0.0, mean p set: 0.44642776250839233
loss_pred:0.027365153655409813, decouple_loss:0.00944762397557497
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4559999108314514, gen p mean: 0.0, mean p set: 0.44709837436676025
loss_pred:0.02735929936170578, decouple_loss:0.009073929861187935
The modified gen p mean: 0.45017150044441223, gen p mean: 0.0, mean p set: 0.4465283155441284
The modified gen p mean: 0.4542097747325897, gen p mean: 0.0, mean p set: 0.44765913486480713
loss_pred:0.02792184241116047, decouple_loss:0.009352907538414001
loss_pred:0.02747536450624466, decouple_loss:0.009127059951424599
Iteration: 333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44220253825187683, gen p mean: 0.0, mean p set: 0.4482816159725189
loss_pred:0.02749592810869217, decouple_loss:0.009155080653727055
The modified gen p mean: 0.4394192695617676, gen p mean: 0.0, mean p set: 0.4481956660747528
The modified gen p mean: 0.43531861901283264, gen p mean: 0.0, mean p set: 0.44820475578308105
loss_pred:0.02789265662431717, decouple_loss:0.009184093214571476
loss_pred:0.02689909003674984, decouple_loss:0.008955133147537708
Iteration: 334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45263907313346863, gen p mean: 0.0, mean p set: 0.4466179311275482
The modified gen p mean: 0.45046475529670715, gen p mean: 0.0, mean p set: 0.4477040469646454
loss_pred:0.027347680181264877, decouple_loss:0.009049088694155216
loss_pred:0.026576021686196327, decouple_loss:0.008902500383555889
The modified gen p mean: 0.4514990746974945, gen p mean: 0.0, mean p set: 0.44802215695381165
loss_pred:0.026688354089856148, decouple_loss:0.008750777691602707
Iteration: 335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4440182149410248, gen p mean: 0.0, mean p set: 0.4488631784915924
The modified gen p mean: 0.44648921489715576, gen p mean: 0.0, mean p set: 0.44816744327545166
loss_pred:0.027380269020795822, decouple_loss:0.008741214871406555
loss_pred:0.027609659358859062, decouple_loss:0.009050639346241951
The modified gen p mean: 0.44905415177345276, gen p mean: 0.0, mean p set: 0.4482135772705078
loss_pred:0.02706642635166645, decouple_loss:0.008871485479176044
Iteration: 336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44995468854904175, gen p mean: 0.0, mean p set: 0.4478060305118561
loss_pred:0.02720234915614128, decouple_loss:0.009062475524842739
The modified gen p mean: 0.44816315174102783, gen p mean: 0.0, mean p set: 0.4479471743106842
The modified gen p mean: 0.447279155254364, gen p mean: 0.0, mean p set: 0.4477352201938629
loss_pred:0.02755918726325035, decouple_loss:0.008836952969431877
loss_pred:0.02718762680888176, decouple_loss:0.00902871135622263
Iteration: 337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525544345378876, gen p mean: 0.0, mean p set: 0.4490656852722168
The modified gen p mean: 0.4475122094154358, gen p mean: 0.0, mean p set: 0.4485515058040619
loss_pred:0.026534879580140114, decouple_loss:0.008820847608149052
loss_pred:0.028384162113070488, decouple_loss:0.009062496945261955The modified gen p mean: 0.44970178604125977, gen p mean: 0.0, mean p set: 0.4484192430973053
loss_pred:0.027955465018749237, decouple_loss:0.008541671559214592
Iteration: 338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686201214790344, gen p mean: 0.0, mean p set: 0.4485739767551422
The modified gen p mean: 0.44599637389183044, gen p mean: 0.0, mean p set: 0.44797828793525696
loss_pred:0.026435814797878265, decouple_loss:0.008767787367105484
loss_pred:0.02734299562871456, decouple_loss:0.008722515776753426The modified gen p mean: 0.44683757424354553, gen p mean: 0.0, mean p set: 0.44837021827697754
loss_pred:0.027310533449053764, decouple_loss:0.008655468001961708
Iteration: 339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44618189334869385, gen p mean: 0.0, mean p set: 0.44809025526046753
loss_pred:0.026767052710056305, decouple_loss:0.008334849961102009
The modified gen p mean: 0.44785746932029724, gen p mean: 0.0, mean p set: 0.4477280378341675
The modified gen p mean: 0.44149914383888245, gen p mean: 0.0, mean p set: 0.4480046033859253
loss_pred:0.027303822338581085, decouple_loss:0.008920826949179173
loss_pred:0.026179326698184013, decouple_loss:0.008860901929438114
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4433380663394928, gen p mean: 0.0, mean p set: 0.44907623529434204
The modified gen p mean: 0.45145535469055176, gen p mean: 0.0, mean p set: 0.4467402696609497
loss_pred:0.028070958331227303, decouple_loss:0.009549998678267002
The modified gen p mean: 0.4526786208152771, gen p mean: 0.0, mean p set: 0.44808098673820496
loss_pred:0.02836754359304905, decouple_loss:0.011265113949775696
loss_pred:0.02740926295518875, decouple_loss:0.009371187537908554
2023-05-04 12:27:08 testing...
The modified gen p mean: 0.44822606444358826, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45497292280197144, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4576624929904938, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02804485335946083, decouple_loss:0.009436494670808315
loss_pred:0.027132393792271614, decouple_loss:0.00919756293296814loss_pred:0.026835495606064796, decouple_loss:0.009392299689352512
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02780468761920929, avg_mse: 0.03278975561261177
current test mse: 0.03279
Iteration: 341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45056232810020447, gen p mean: 0.0, mean p set: 0.448073148727417
The modified gen p mean: 0.4494969844818115, gen p mean: 0.0, mean p set: 0.4469289183616638
loss_pred:0.027283888310194016, decouple_loss:0.009624470956623554
loss_pred:0.02655855379998684, decouple_loss:0.009554488584399223
The modified gen p mean: 0.4496381878852844, gen p mean: 0.0, mean p set: 0.44694921374320984
loss_pred:0.027291402220726013, decouple_loss:0.009445521980524063
Iteration: 342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461093246936798, gen p mean: 0.0, mean p set: 0.447951078414917
The modified gen p mean: 0.4470447599887848, gen p mean: 0.0, mean p set: 0.4464118480682373
loss_pred:0.027221662923693657, decouple_loss:0.009213563986122608
loss_pred:0.02819831296801567, decouple_loss:0.008706795983016491
The modified gen p mean: 0.44341158866882324, gen p mean: 0.0, mean p set: 0.44573795795440674
loss_pred:0.026787010952830315, decouple_loss:0.009342528879642487
Iteration: 343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4442654252052307, gen p mean: 0.0, mean p set: 0.4465752840042114
The modified gen p mean: 0.4482077658176422, gen p mean: 0.0, mean p set: 0.4466271698474884
loss_pred:0.027365125715732574, decouple_loss:0.009131446480751038
loss_pred:0.0274516474455595, decouple_loss:0.009020302444696426
The modified gen p mean: 0.4435218870639801, gen p mean: 0.0, mean p set: 0.4473566710948944
loss_pred:0.02692636102437973, decouple_loss:0.008819123730063438
Iteration: 344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45468810200691223, gen p mean: 0.0, mean p set: 0.44668781757354736
The modified gen p mean: 0.4440004527568817, gen p mean: 0.0, mean p set: 0.4490543007850647
loss_pred:0.02814050205051899, decouple_loss:0.00866216141730547
loss_pred:0.02811345085501671, decouple_loss:0.01053584460169077The modified gen p mean: 0.45456910133361816, gen p mean: 0.0, mean p set: 0.44675159454345703
loss_pred:0.027046630159020424, decouple_loss:0.00886503141373396
Iteration: 345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44586068391799927, gen p mean: 0.0, mean p set: 0.44630563259124756
loss_pred:0.02664005197584629, decouple_loss:0.008738561533391476
The modified gen p mean: 0.4420803189277649, gen p mean: 0.0, mean p set: 0.4473665952682495
The modified gen p mean: 0.4426112473011017, gen p mean: 0.0, mean p set: 0.44715940952301025
loss_pred:0.02759857289493084, decouple_loss:0.008982274681329727
loss_pred:0.027276692911982536, decouple_loss:0.009183017536997795
Iteration: 346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44090861082077026, gen p mean: 0.0, mean p set: 0.44651132822036743
The modified gen p mean: 0.4388023912906647, gen p mean: 0.0, mean p set: 0.44799599051475525
loss_pred:0.028210610151290894, decouple_loss:0.00829760730266571
loss_pred:0.026563340798020363, decouple_loss:0.00904263649135828The modified gen p mean: 0.43305322527885437, gen p mean: 0.0, mean p set: 0.448486864566803
loss_pred:0.02805960923433304, decouple_loss:0.009097900241613388
Iteration: 347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451941579580307, gen p mean: 0.0, mean p set: 0.4471011161804199
loss_pred:0.02702011726796627, decouple_loss:0.008995149284601212
The modified gen p mean: 0.4543381631374359, gen p mean: 0.0, mean p set: 0.4461599588394165
The modified gen p mean: 0.4573296904563904, gen p mean: 0.0, mean p set: 0.44725558161735535
loss_pred:0.02716384269297123, decouple_loss:0.008843391202390194
loss_pred:0.02680617943406105, decouple_loss:0.009326837956905365
Iteration: 348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45113083720207214, gen p mean: 0.0, mean p set: 0.4457697868347168
loss_pred:0.026278775185346603, decouple_loss:0.009260912425816059
The modified gen p mean: 0.4553928077220917, gen p mean: 0.0, mean p set: 0.44680535793304443
The modified gen p mean: 0.4503123164176941, gen p mean: 0.0, mean p set: 0.4482913017272949
loss_pred:0.026735231280326843, decouple_loss:0.008657014928758144
loss_pred:0.026903504505753517, decouple_loss:0.009557103738188744
Iteration: 349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43734291195869446, gen p mean: 0.0, mean p set: 0.44695523381233215
loss_pred:0.0265467818826437, decouple_loss:0.009003524668514729
The modified gen p mean: 0.43204084038734436, gen p mean: 0.0, mean p set: 0.4487825632095337
The modified gen p mean: 0.4361623525619507, gen p mean: 0.0, mean p set: 0.44865259528160095
loss_pred:0.026499571278691292, decouple_loss:0.009100896306335926
loss_pred:0.026995636522769928, decouple_loss:0.009838176891207695
Iteration: 350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45450499653816223, gen p mean: 0.0, mean p set: 0.4473038911819458
The modified gen p mean: 0.4525618255138397, gen p mean: 0.0, mean p set: 0.4461652636528015
loss_pred:0.026571154594421387, decouple_loss:0.00887652300298214
The modified gen p mean: 0.45616045594215393, gen p mean: 0.0, mean p set: 0.4471926689147949loss_pred:0.027290089055895805, decouple_loss:0.008992012590169907
loss_pred:0.027900665998458862, decouple_loss:0.009057782590389252
2023-05-04 12:30:40 testing...
The modified gen p mean: 0.444450706243515, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45087045431137085, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45360925793647766, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.028030266985297203, decouple_loss:0.009138182736933231
loss_pred:0.02715962380170822, decouple_loss:0.00908404216170311
loss_pred:0.026835385710000992, decouple_loss:0.009507851675152779
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027803927659988403, avg_mse: 0.03284063935279846
current test mse: 0.032841
Iteration: 351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4414822459220886, gen p mean: 0.0, mean p set: 0.44933852553367615
The modified gen p mean: 0.44603797793388367, gen p mean: 0.0, mean p set: 0.4471711814403534
loss_pred:0.027790512889623642, decouple_loss:0.00967633817344904
loss_pred:0.02736094407737255, decouple_loss:0.008781311102211475
The modified gen p mean: 0.44896671175956726, gen p mean: 0.0, mean p set: 0.44673389196395874
loss_pred:0.027245203033089638, decouple_loss:0.008840779773890972
Iteration: 352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491707384586334, gen p mean: 0.0, mean p set: 0.4486584961414337
The modified gen p mean: 0.4535588026046753, gen p mean: 0.0, mean p set: 0.4467838406562805
loss_pred:0.026543764397501945, decouple_loss:0.008527638390660286
The modified gen p mean: 0.4498610496520996, gen p mean: 0.0, mean p set: 0.4476941227912903
loss_pred:0.026908135041594505, decouple_loss:0.008390347473323345
loss_pred:0.02780766785144806, decouple_loss:0.008692878298461437
Iteration: 353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44878584146499634, gen p mean: 0.0, mean p set: 0.4473998546600342
loss_pred:0.027072375640273094, decouple_loss:0.008367544040083885
The modified gen p mean: 0.4468401372432709, gen p mean: 0.0, mean p set: 0.44858697056770325
The modified gen p mean: 0.4510413408279419, gen p mean: 0.0, mean p set: 0.44630685448646545
loss_pred:0.02773944102227688, decouple_loss:0.00899958610534668
loss_pred:0.02674585022032261, decouple_loss:0.008692064322531223
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4398956894874573, gen p mean: 0.0, mean p set: 0.4478095471858978
The modified gen p mean: 0.4448012709617615, gen p mean: 0.0, mean p set: 0.447246253490448
loss_pred:0.02633597142994404, decouple_loss:0.008633234538137913
loss_pred:0.026844419538974762, decouple_loss:0.008293552324175835
The modified gen p mean: 0.44233131408691406, gen p mean: 0.0, mean p set: 0.44782623648643494
loss_pred:0.02680494450032711, decouple_loss:0.008576758205890656
Iteration: 355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43983376026153564, gen p mean: 0.0, mean p set: 0.44794052839279175
loss_pred:0.02636767365038395, decouple_loss:0.008539793081581593
The modified gen p mean: 0.43749335408210754, gen p mean: 0.0, mean p set: 0.44931700825691223
The modified gen p mean: 0.44544705748558044, gen p mean: 0.0, mean p set: 0.44758522510528564
loss_pred:0.02685375325381756, decouple_loss:0.008275497704744339
loss_pred:0.026818519458174706, decouple_loss:0.009116698056459427
Iteration: 356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45109009742736816, gen p mean: 0.0, mean p set: 0.4477439522743225
loss_pred:0.026743995025753975, decouple_loss:0.00831563863903284
The modified gen p mean: 0.45115065574645996, gen p mean: 0.0, mean p set: 0.44689324498176575
The modified gen p mean: 0.45385122299194336, gen p mean: 0.0, mean p set: 0.44787678122520447
loss_pred:0.027550937607884407, decouple_loss:0.00831015408039093
loss_pred:0.028417902067303658, decouple_loss:0.008267220109701157
Iteration: 357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451587051153183, gen p mean: 0.0, mean p set: 0.44752782583236694
loss_pred:0.027834933251142502, decouple_loss:0.008230415172874928
The modified gen p mean: 0.4557880461215973, gen p mean: 0.0, mean p set: 0.44625577330589294
The modified gen p mean: 0.44993269443511963, gen p mean: 0.0, mean p set: 0.44868341088294983
loss_pred:0.026813657954335213, decouple_loss:0.008965144865214825
loss_pred:0.027918869629502296, decouple_loss:0.008289304561913013
Iteration: 358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4424937665462494, gen p mean: 0.0, mean p set: 0.44952791929244995
loss_pred:0.02656930312514305, decouple_loss:0.008884262293577194
The modified gen p mean: 0.4453102946281433, gen p mean: 0.0, mean p set: 0.4484470784664154
The modified gen p mean: 0.4445101320743561, gen p mean: 0.0, mean p set: 0.4478280544281006
loss_pred:0.026525123044848442, decouple_loss:0.008288022130727768
loss_pred:0.026718826964497566, decouple_loss:0.008138997480273247
Iteration: 359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473884105682373, gen p mean: 0.0, mean p set: 0.4479255974292755
The modified gen p mean: 0.45217281579971313, gen p mean: 0.0, mean p set: 0.44712045788764954
loss_pred:0.027902953326702118, decouple_loss:0.00809954758733511
loss_pred:0.026604555547237396, decouple_loss:0.008468051441013813
The modified gen p mean: 0.45403140783309937, gen p mean: 0.0, mean p set: 0.44647401571273804
loss_pred:0.027572622522711754, decouple_loss:0.008614551275968552
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
NaN value num: 0
Iteration: 360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4415627121925354, gen p mean: 0.0, mean p set: 0.44934335350990295
The modified gen p mean: 0.44794508814811707, gen p mean: 0.0, mean p set: 0.44737857580184937
loss_pred:0.029368676245212555, decouple_loss:0.009249587543308735
The modified gen p mean: 0.4465442895889282, gen p mean: 0.0, mean p set: 0.44876134395599365
loss_pred:0.02993716485798359, decouple_loss:0.009434659965336323
loss_pred:0.030343009158968925, decouple_loss:0.00921835470944643
2023-05-04 12:34:55 testing...
The modified gen p mean: 0.44064679741859436, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4469943046569824, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497731924057007, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.028019150719046593, decouple_loss:0.008664998225867748
loss_pred:0.026972154155373573, decouple_loss:0.008569975383579731
loss_pred:0.026697082445025444, decouple_loss:0.008917874656617641
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02766534313559532, avg_mse: 0.03264819458127022
current test mse: 0.032648
Iteration: 361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44261279702186584, gen p mean: 0.0, mean p set: 0.44811415672302246
The modified gen p mean: 0.44196513295173645, gen p mean: 0.0, mean p set: 0.4489694833755493
loss_pred:0.02895878627896309, decouple_loss:0.008787265047430992
loss_pred:0.029369240626692772, decouple_loss:0.009408743120729923
The modified gen p mean: 0.44465237855911255, gen p mean: 0.0, mean p set: 0.4468248784542084
loss_pred:0.02759527787566185, decouple_loss:0.008800005540251732
Iteration: 362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46293383836746216, gen p mean: 0.0, mean p set: 0.4478082060813904
loss_pred:0.028268780559301376, decouple_loss:0.009356807917356491
The modified gen p mean: 0.4602240324020386, gen p mean: 0.0, mean p set: 0.44648540019989014
The modified gen p mean: 0.4530611038208008, gen p mean: 0.0, mean p set: 0.44662904739379883
loss_pred:0.0281318798661232, decouple_loss:0.008560671471059322
loss_pred:0.028660031035542488, decouple_loss:0.008656643331050873
Iteration: 363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4434509873390198, gen p mean: 0.0, mean p set: 0.4462752044200897
loss_pred:0.028218716382980347, decouple_loss:0.008629699237644672
The modified gen p mean: 0.45045650005340576, gen p mean: 0.0, mean p set: 0.44906821846961975
The modified gen p mean: 0.4438055157661438, gen p mean: 0.0, mean p set: 0.4492022693157196
loss_pred:0.029436586424708366, decouple_loss:0.0092749809846282
loss_pred:0.028289513662457466, decouple_loss:0.009167984127998352
Iteration: 364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4396873414516449, gen p mean: 0.0, mean p set: 0.44756606221199036
loss_pred:0.027341408655047417, decouple_loss:0.008505585603415966
The modified gen p mean: 0.4440995454788208, gen p mean: 0.0, mean p set: 0.44828951358795166
The modified gen p mean: 0.43927404284477234, gen p mean: 0.0, mean p set: 0.446553498506546
loss_pred:0.027762925252318382, decouple_loss:0.00862233154475689
loss_pred:0.027604965493083, decouple_loss:0.008712084963917732
Iteration: 365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4407072365283966, gen p mean: 0.0, mean p set: 0.44824743270874023
loss_pred:0.029747888445854187, decouple_loss:0.008569184690713882
The modified gen p mean: 0.43834188580513, gen p mean: 0.0, mean p set: 0.44801223278045654
The modified gen p mean: 0.44084566831588745, gen p mean: 0.0, mean p set: 0.4487190544605255
loss_pred:0.029485706239938736, decouple_loss:0.008945613168179989
loss_pred:0.02868238277733326, decouple_loss:0.008641771972179413
Iteration: 366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45714420080184937, gen p mean: 0.0, mean p set: 0.44762495160102844
loss_pred:0.0277254618704319, decouple_loss:0.008979570120573044
The modified gen p mean: 0.45283254981040955, gen p mean: 0.0, mean p set: 0.4473387897014618
The modified gen p mean: 0.4544168710708618, gen p mean: 0.0, mean p set: 0.4474048614501953
loss_pred:0.02750764787197113, decouple_loss:0.008692103438079357
loss_pred:0.027889084070920944, decouple_loss:0.008421523496508598
Iteration: 367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519784450531006, gen p mean: 0.0, mean p set: 0.446742981672287
The modified gen p mean: 0.447845458984375, gen p mean: 0.0, mean p set: 0.4473620653152466
loss_pred:0.02864934504032135, decouple_loss:0.008550974540412426
The modified gen p mean: 0.452529639005661, gen p mean: 0.0, mean p set: 0.44724777340888977loss_pred:0.028554830700159073, decouple_loss:0.008503393270075321
loss_pred:0.02746325172483921, decouple_loss:0.008491774089634418
Iteration: 368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44119274616241455, gen p mean: 0.0, mean p set: 0.4482557475566864The modified gen p mean: 0.44710883498191833, gen p mean: 0.0, mean p set: 0.4466968774795532
loss_pred:0.0280512273311615, decouple_loss:0.008608849719166756loss_pred:0.02879643440246582, decouple_loss:0.00890741590410471
The modified gen p mean: 0.4424096643924713, gen p mean: 0.0, mean p set: 0.4484969973564148
loss_pred:0.02951662242412567, decouple_loss:0.008824610151350498
Iteration: 369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461855888366699, gen p mean: 0.0, mean p set: 0.44641000032424927
loss_pred:0.028087647631764412, decouple_loss:0.00859507080167532
The modified gen p mean: 0.4464398920536041, gen p mean: 0.0, mean p set: 0.44670480489730835
The modified gen p mean: 0.4538469910621643, gen p mean: 0.0, mean p set: 0.4471668004989624
loss_pred:0.028530295938253403, decouple_loss:0.009067602455615997
loss_pred:0.027842216193675995, decouple_loss:0.008295823819935322
Iteration: 370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508155882358551, gen p mean: 0.0, mean p set: 0.448001891374588
loss_pred:0.02940605953335762, decouple_loss:0.008439893834292889
The modified gen p mean: 0.4513407051563263, gen p mean: 0.0, mean p set: 0.4467630088329315
The modified gen p mean: 0.4510268568992615, gen p mean: 0.0, mean p set: 0.4468485414981842
loss_pred:0.027589356526732445, decouple_loss:0.008233604021370411
loss_pred:0.027951907366514206, decouple_loss:0.008348065428435802
2023-05-04 12:38:26 testing...
The modified gen p mean: 0.43400701880455017, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44009479880332947, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44323402643203735, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02827640064060688, decouple_loss:0.008918951265513897
loss_pred:0.02725915238261223, decouple_loss:0.008620578795671463
loss_pred:0.02694954350590706, decouple_loss:0.008735152892768383
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027932941913604736, avg_mse: 0.03320528194308281
current test mse: 0.033205
Iteration: 371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4397810995578766, gen p mean: 0.0, mean p set: 0.44684502482414246
The modified gen p mean: 0.43951094150543213, gen p mean: 0.0, mean p set: 0.44826972484588623
loss_pred:0.02778637781739235, decouple_loss:0.008264228701591492
loss_pred:0.02748708240687847, decouple_loss:0.008562920615077019
The modified gen p mean: 0.43726646900177, gen p mean: 0.0, mean p set: 0.4474782347679138
loss_pred:0.027588317170739174, decouple_loss:0.008321123197674751
Iteration: 372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44196587800979614, gen p mean: 0.0, mean p set: 0.44780007004737854
The modified gen p mean: 0.445017009973526, gen p mean: 0.0, mean p set: 0.44682982563972473
The modified gen p mean: 0.4479338228702545, gen p mean: 0.0, mean p set: 0.4486643373966217
loss_pred:0.028055906295776367, decouple_loss:0.008863055147230625
loss_pred:0.028028635308146477, decouple_loss:0.008669130504131317
loss_pred:0.02984280325472355, decouple_loss:0.008917354978621006
Iteration: 373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45897963643074036, gen p mean: 0.0, mean p set: 0.44877323508262634
The modified gen p mean: 0.45951926708221436, gen p mean: 0.0, mean p set: 0.44726744294166565
loss_pred:0.029030172154307365, decouple_loss:0.00901276059448719
loss_pred:0.028056515380740166, decouple_loss:0.00857594609260559The modified gen p mean: 0.4588921070098877, gen p mean: 0.0, mean p set: 0.44707152247428894
loss_pred:0.027514612302184105, decouple_loss:0.008373844437301159
Iteration: 374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447266548871994, gen p mean: 0.0, mean p set: 0.4467707574367523
The modified gen p mean: 0.4466870427131653, gen p mean: 0.0, mean p set: 0.44666171073913574
loss_pred:0.02844327501952648, decouple_loss:0.008300041779875755
loss_pred:0.02775229699909687, decouple_loss:0.008195362985134125
The modified gen p mean: 0.4472224712371826, gen p mean: 0.0, mean p set: 0.44882747530937195
loss_pred:0.02923758327960968, decouple_loss:0.008804423734545708
Iteration: 375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43451040983200073, gen p mean: 0.0, mean p set: 0.4478208124637604
The modified gen p mean: 0.43387091159820557, gen p mean: 0.0, mean p set: 0.44730156660079956
loss_pred:0.0290572140365839, decouple_loss:0.008685873821377754
loss_pred:0.0285345409065485, decouple_loss:0.008297300897538662The modified gen p mean: 0.4362229108810425, gen p mean: 0.0, mean p set: 0.448250949382782
loss_pred:0.028980661183595657, decouple_loss:0.008415733464062214
Iteration: 376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049187541007996, gen p mean: 0.0, mean p set: 0.4474903643131256
The modified gen p mean: 0.44785645604133606, gen p mean: 0.0, mean p set: 0.4466526508331299
loss_pred:0.027836183086037636, decouple_loss:0.008359424769878387
The modified gen p mean: 0.449770987033844, gen p mean: 0.0, mean p set: 0.4472139775753021loss_pred:0.027924122288823128, decouple_loss:0.00858698133379221
loss_pred:0.027930133044719696, decouple_loss:0.008951425552368164
Iteration: 377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4610480070114136, gen p mean: 0.0, mean p set: 0.4466361403465271
The modified gen p mean: 0.46698206663131714, gen p mean: 0.0, mean p set: 0.4474250078201294
loss_pred:0.027991583570837975, decouple_loss:0.008392137475311756
loss_pred:0.02932967245578766, decouple_loss:0.008917571976780891The modified gen p mean: 0.4681689739227295, gen p mean: 0.0, mean p set: 0.4474022090435028
loss_pred:0.02897244691848755, decouple_loss:0.008788651786744595
Iteration: 378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4391331076622009, gen p mean: 0.0, mean p set: 0.4467627704143524
loss_pred:0.027745625004172325, decouple_loss:0.008207529783248901
The modified gen p mean: 0.444075345993042, gen p mean: 0.0, mean p set: 0.44883307814598083
The modified gen p mean: 0.44322121143341064, gen p mean: 0.0, mean p set: 0.449388325214386
loss_pred:0.029528480023145676, decouple_loss:0.008867393247783184
loss_pred:0.030007600784301758, decouple_loss:0.008359339088201523
Iteration: 379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4308530390262604, gen p mean: 0.0, mean p set: 0.44756564497947693
The modified gen p mean: 0.43229150772094727, gen p mean: 0.0, mean p set: 0.4492294192314148
loss_pred:0.0274118073284626, decouple_loss:0.00892870593816042
The modified gen p mean: 0.4318094551563263, gen p mean: 0.0, mean p set: 0.44799190759658813loss_pred:0.029556194320321083, decouple_loss:0.008924264460802078
loss_pred:0.027653038501739502, decouple_loss:0.009050392545759678
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
NaN value num: 0
Iteration: 380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4422474503517151, gen p mean: 0.0, mean p set: 0.4483906924724579
The modified gen p mean: 0.4436282813549042, gen p mean: 0.0, mean p set: 0.4486483037471771
loss_pred:0.028769247233867645, decouple_loss:0.009995268657803535
The modified gen p mean: 0.44705888628959656, gen p mean: 0.0, mean p set: 0.4487829804420471
loss_pred:0.02893989160656929, decouple_loss:0.009829683229327202
loss_pred:0.0271974578499794, decouple_loss:0.009334140457212925
2023-05-04 12:42:41 testing...
The modified gen p mean: 0.4557359516620636, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.46185776591300964, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4646025002002716, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02846837043762207, decouple_loss:0.009663557633757591
loss_pred:0.02761894278228283, decouple_loss:0.00954706221818924
loss_pred:0.027226610109210014, decouple_loss:0.009758145548403263
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02825412154197693, avg_mse: 0.03360549360513687
current test mse: 0.033605
Iteration: 381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45805421471595764, gen p mean: 0.0, mean p set: 0.4449720084667206The modified gen p mean: 0.4545672535896301, gen p mean: 0.0, mean p set: 0.4486467242240906
loss_pred:0.028459914028644562, decouple_loss:0.009282661601901054
loss_pred:0.027748044580221176, decouple_loss:0.009859071113169193
The modified gen p mean: 0.45830777287483215, gen p mean: 0.0, mean p set: 0.44815483689308167
loss_pred:0.02818518877029419, decouple_loss:0.009299661964178085
Iteration: 382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4578920602798462, gen p mean: 0.0, mean p set: 0.4462781846523285
The modified gen p mean: 0.44981396198272705, gen p mean: 0.0, mean p set: 0.44642698764801025
loss_pred:0.027775416150689125, decouple_loss:0.009303770028054714
loss_pred:0.027284204959869385, decouple_loss:0.009144362062215805
The modified gen p mean: 0.4512629806995392, gen p mean: 0.0, mean p set: 0.4457470774650574
loss_pred:0.027048304677009583, decouple_loss:0.009057335555553436
Iteration: 383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538058042526245, gen p mean: 0.0, mean p set: 0.4476630687713623
The modified gen p mean: 0.4495757520198822, gen p mean: 0.0, mean p set: 0.4452323615550995
loss_pred:0.027156958356499672, decouple_loss:0.009015897288918495
loss_pred:0.026884496212005615, decouple_loss:0.009095028974115849
The modified gen p mean: 0.4444652199745178, gen p mean: 0.0, mean p set: 0.4487939476966858
loss_pred:0.028174348175525665, decouple_loss:0.009278531186282635
Iteration: 384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4404063820838928, gen p mean: 0.0, mean p set: 0.4497237801551819
The modified gen p mean: 0.44621455669403076, gen p mean: 0.0, mean p set: 0.44635626673698425loss_pred:0.027739206328988075, decouple_loss:0.00890414696186781
The modified gen p mean: 0.4377171993255615, gen p mean: 0.0, mean p set: 0.4485023021697998
loss_pred:0.02715865708887577, decouple_loss:0.009121501818299294
loss_pred:0.028234420344233513, decouple_loss:0.009040270000696182
Iteration: 385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4368445575237274, gen p mean: 0.0, mean p set: 0.4474453032016754
The modified gen p mean: 0.43855857849121094, gen p mean: 0.0, mean p set: 0.4491027295589447
loss_pred:0.027185993269085884, decouple_loss:0.00864762719720602
loss_pred:0.028152668848633766, decouple_loss:0.008852694183588028The modified gen p mean: 0.4379871189594269, gen p mean: 0.0, mean p set: 0.4477749764919281
loss_pred:0.02951710857450962, decouple_loss:0.008879875764250755
Iteration: 386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44630590081214905, gen p mean: 0.0, mean p set: 0.44718730449676514
loss_pred:0.027288783341646194, decouple_loss:0.008930510841310024
The modified gen p mean: 0.45026981830596924, gen p mean: 0.0, mean p set: 0.4459638297557831
The modified gen p mean: 0.45124515891075134, gen p mean: 0.0, mean p set: 0.4484868049621582
loss_pred:0.027776114642620087, decouple_loss:0.009021097794175148
loss_pred:0.029350925236940384, decouple_loss:0.009458420798182487
Iteration: 387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46193066239356995, gen p mean: 0.0, mean p set: 0.4470408260822296
loss_pred:0.027177095413208008, decouple_loss:0.00915741641074419
The modified gen p mean: 0.4524070918560028, gen p mean: 0.0, mean p set: 0.44711804389953613
The modified gen p mean: 0.4580429196357727, gen p mean: 0.0, mean p set: 0.4463125169277191
loss_pred:0.027432724833488464, decouple_loss:0.009128288365900517
loss_pred:0.027167560532689095, decouple_loss:0.00909058190882206
Iteration: 388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669950008392334, gen p mean: 0.0, mean p set: 0.4471952021121979
loss_pred:0.026972571387887, decouple_loss:0.009171421639621258
The modified gen p mean: 0.439943790435791, gen p mean: 0.0, mean p set: 0.447277694940567
The modified gen p mean: 0.4409646987915039, gen p mean: 0.0, mean p set: 0.44658976793289185
loss_pred:0.026926178485155106, decouple_loss:0.00904582254588604
loss_pred:0.028905868530273438, decouple_loss:0.009313028305768967
Iteration: 389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4394453465938568, gen p mean: 0.0, mean p set: 0.44811511039733887
The modified gen p mean: 0.4442821443080902, gen p mean: 0.0, mean p set: 0.4481199383735657
loss_pred:0.02871767245233059, decouple_loss:0.009388694539666176
loss_pred:0.027266616001725197, decouple_loss:0.008907182142138481The modified gen p mean: 0.4410415589809418, gen p mean: 0.0, mean p set: 0.4473304748535156
loss_pred:0.027242012321949005, decouple_loss:0.00875589344650507
Iteration: 390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514663815498352, gen p mean: 0.0, mean p set: 0.44957417249679565
loss_pred:0.025987396016716957, decouple_loss:0.009338422678411007
The modified gen p mean: 0.45372942090034485, gen p mean: 0.0, mean p set: 0.44727998971939087
The modified gen p mean: 0.45383208990097046, gen p mean: 0.0, mean p set: 0.4504740536212921
loss_pred:0.02692052349448204, decouple_loss:0.009148730896413326
loss_pred:0.028856178745627403, decouple_loss:0.009162024594843388
2023-05-04 12:46:12 testing...
The modified gen p mean: 0.4444037079811096, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4502406120300293, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45335012674331665, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02822696976363659, decouple_loss:0.009307040832936764
loss_pred:0.027277566492557526, decouple_loss:0.009186050854623318
loss_pred:0.02697281911969185, decouple_loss:0.009263330139219761
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027955060824751854, avg_mse: 0.03314840793609619
current test mse: 0.033148
Iteration: 391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447457492351532, gen p mean: 0.0, mean p set: 0.4490150213241577
The modified gen p mean: 0.4475342035293579, gen p mean: 0.0, mean p set: 0.4468673765659332
loss_pred:0.029032327234745026, decouple_loss:0.009373429231345654
loss_pred:0.027896154671907425, decouple_loss:0.008629081770777702
The modified gen p mean: 0.44347506761550903, gen p mean: 0.0, mean p set: 0.4488413631916046
loss_pred:0.0279270950704813, decouple_loss:0.00919276662170887
Iteration: 392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448753297328949, gen p mean: 0.0, mean p set: 0.4486178159713745
loss_pred:0.02857978641986847, decouple_loss:0.009299307130277157
The modified gen p mean: 0.45250818133354187, gen p mean: 0.0, mean p set: 0.4477825164794922
The modified gen p mean: 0.45413532853126526, gen p mean: 0.0, mean p set: 0.4469718039035797
loss_pred:0.0266730859875679, decouple_loss:0.008989415131509304
loss_pred:0.02776564471423626, decouple_loss:0.008950994350016117
Iteration: 393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45477041602134705, gen p mean: 0.0, mean p set: 0.4470330774784088
loss_pred:0.026310261338949203, decouple_loss:0.008926249109208584
The modified gen p mean: 0.44895637035369873, gen p mean: 0.0, mean p set: 0.4502406716346741
The modified gen p mean: 0.4521716833114624, gen p mean: 0.0, mean p set: 0.4481523334980011
loss_pred:0.02778744138777256, decouple_loss:0.008711697533726692
loss_pred:0.027231672778725624, decouple_loss:0.009177823550999165
Iteration: 394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4415014088153839, gen p mean: 0.0, mean p set: 0.44841283559799194
loss_pred:0.027951965108513832, decouple_loss:0.008490931242704391
The modified gen p mean: 0.43632742762565613, gen p mean: 0.0, mean p set: 0.449752539396286
The modified gen p mean: 0.43565720319747925, gen p mean: 0.0, mean p set: 0.44912174344062805
loss_pred:0.02719590812921524, decouple_loss:0.00847232062369585
loss_pred:0.026142729446291924, decouple_loss:0.008593120612204075
Iteration: 395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4394185245037079, gen p mean: 0.0, mean p set: 0.4500530958175659The modified gen p mean: 0.4451047480106354, gen p mean: 0.0, mean p set: 0.4480111598968506
loss_pred:0.025557056069374084, decouple_loss:0.008731089532375336loss_pred:0.02831076644361019, decouple_loss:0.00828974973410368
The modified gen p mean: 0.4435909390449524, gen p mean: 0.0, mean p set: 0.44659915566444397
loss_pred:0.02750971168279648, decouple_loss:0.008775296621024609
Iteration: 396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45902273058891296, gen p mean: 0.0, mean p set: 0.4480600357055664
The modified gen p mean: 0.45623019337654114, gen p mean: 0.0, mean p set: 0.4475480318069458
loss_pred:0.02882344089448452, decouple_loss:0.00897803995758295
loss_pred:0.02722562663257122, decouple_loss:0.008786010555922985
The modified gen p mean: 0.4599013328552246, gen p mean: 0.0, mean p set: 0.44588083028793335
loss_pred:0.026870068162679672, decouple_loss:0.0087043521925807
Iteration: 397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522702991962433, gen p mean: 0.0, mean p set: 0.44770243763923645
The modified gen p mean: 0.4473828077316284, gen p mean: 0.0, mean p set: 0.44467902183532715
loss_pred:0.027999289333820343, decouple_loss:0.008813854306936264
loss_pred:0.028095286339521408, decouple_loss:0.0087471017614007The modified gen p mean: 0.45441240072250366, gen p mean: 0.0, mean p set: 0.44628193974494934
loss_pred:0.02673419751226902, decouple_loss:0.00897593330591917
Iteration: 398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4323834478855133, gen p mean: 0.0, mean p set: 0.44674885272979736
The modified gen p mean: 0.4338458180427551, gen p mean: 0.0, mean p set: 0.4479677379131317
loss_pred:0.02701450325548649, decouple_loss:0.008793639950454235
loss_pred:0.028464823961257935, decouple_loss:0.009039903990924358
The modified gen p mean: 0.4369399845600128, gen p mean: 0.0, mean p set: 0.44750338792800903
loss_pred:0.026861580088734627, decouple_loss:0.008708018809556961
Iteration: 399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43885233998298645, gen p mean: 0.0, mean p set: 0.4456256330013275
The modified gen p mean: 0.44011613726615906, gen p mean: 0.0, mean p set: 0.450869619846344
loss_pred:0.02736293151974678, decouple_loss:0.008593951351940632
loss_pred:0.025959432125091553, decouple_loss:0.008835220709443092
The modified gen p mean: 0.4434513449668884, gen p mean: 0.0, mean p set: 0.44577544927597046
loss_pred:0.026134947314858437, decouple_loss:0.00860567856580019
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
NaN value num: 0
Iteration: 400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46055302023887634, gen p mean: 0.0, mean p set: 0.4501636028289795
The modified gen p mean: 0.4652424156665802, gen p mean: 0.0, mean p set: 0.44959568977355957
loss_pred:0.027321364730596542, decouple_loss:0.009773744270205498
The modified gen p mean: 0.46641647815704346, gen p mean: 0.0, mean p set: 0.4495902955532074
loss_pred:0.027700286358594894, decouple_loss:0.009869296103715897
loss_pred:0.027085738256573677, decouple_loss:0.009805863723158836
2023-05-04 12:50:23 testing...
The modified gen p mean: 0.44461745023727417, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4508110582828522, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45390400290489197, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.028103332966566086, decouple_loss:0.009099231101572514
loss_pred:0.027142129838466644, decouple_loss:0.00877334363758564
loss_pred:0.026728078722953796, decouple_loss:0.008973772637546062
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027771955356001854, avg_mse: 0.03304826468229294
current test mse: 0.033048
Iteration: 401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504852592945099, gen p mean: 0.0, mean p set: 0.4502776563167572
The modified gen p mean: 0.4546775817871094, gen p mean: 0.0, mean p set: 0.45128580927848816
loss_pred:0.0271284282207489, decouple_loss:0.009813006967306137
loss_pred:0.02695416659116745, decouple_loss:0.009960263967514038
The modified gen p mean: 0.4533282518386841, gen p mean: 0.0, mean p set: 0.45206621289253235
loss_pred:0.027533354237675667, decouple_loss:0.009775618091225624
Iteration: 402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4414859414100647, gen p mean: 0.0, mean p set: 0.45221275091171265
The modified gen p mean: 0.44321978092193604, gen p mean: 0.0, mean p set: 0.4525558054447174
loss_pred:0.02736920677125454, decouple_loss:0.010197039693593979
The modified gen p mean: 0.4457714557647705, gen p mean: 0.0, mean p set: 0.45124614238739014
loss_pred:0.02648729458451271, decouple_loss:0.010596183128654957
loss_pred:0.02720820903778076, decouple_loss:0.010102537460625172
Iteration: 403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493933916091919, gen p mean: 0.0, mean p set: 0.4514558017253876
loss_pred:0.02755606733262539, decouple_loss:0.00965044740587473
The modified gen p mean: 0.44905734062194824, gen p mean: 0.0, mean p set: 0.4541929364204407
The modified gen p mean: 0.4464210867881775, gen p mean: 0.0, mean p set: 0.45284390449523926
loss_pred:0.02765793353319168, decouple_loss:0.010108942165970802
loss_pred:0.02752888947725296, decouple_loss:0.010313814505934715
Iteration: 404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45112335681915283, gen p mean: 0.0, mean p set: 0.45177412033081055
The modified gen p mean: 0.4529266059398651, gen p mean: 0.0, mean p set: 0.4536963999271393
loss_pred:0.0261697955429554, decouple_loss:0.010183663107454777
loss_pred:0.027343573048710823, decouple_loss:0.009978610090911388
The modified gen p mean: 0.4550018906593323, gen p mean: 0.0, mean p set: 0.45320096611976624
loss_pred:0.027719806879758835, decouple_loss:0.00997280701994896
Iteration: 405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45972225069999695, gen p mean: 0.0, mean p set: 0.4519027769565582
loss_pred:0.02571319416165352, decouple_loss:0.009617513045668602
The modified gen p mean: 0.4614391326904297, gen p mean: 0.0, mean p set: 0.4518203139305115
The modified gen p mean: 0.4648687243461609, gen p mean: 0.0, mean p set: 0.4493648409843445
loss_pred:0.026972079649567604, decouple_loss:0.010226602666079998
loss_pred:0.02693166211247444, decouple_loss:0.009599673561751842
Iteration: 406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496082067489624, gen p mean: 0.0, mean p set: 0.4520263373851776
The modified gen p mean: 0.45032811164855957, gen p mean: 0.0, mean p set: 0.4504190683364868
loss_pred:0.026449140161275864, decouple_loss:0.009137468412518501
loss_pred:0.027866417542099953, decouple_loss:0.009776144288480282
The modified gen p mean: 0.4552472233772278, gen p mean: 0.0, mean p set: 0.45133697986602783
loss_pred:0.027422193437814713, decouple_loss:0.009353277273476124
Iteration: 407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43829345703125, gen p mean: 0.0, mean p set: 0.45261847972869873
loss_pred:0.02702244557440281, decouple_loss:0.00947827473282814
The modified gen p mean: 0.4382309913635254, gen p mean: 0.0, mean p set: 0.451975017786026
The modified gen p mean: 0.4372376799583435, gen p mean: 0.0, mean p set: 0.4510199725627899
loss_pred:0.02726518176496029, decouple_loss:0.009579859673976898
loss_pred:0.026598770171403885, decouple_loss:0.009346305392682552
Iteration: 408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4577081799507141, gen p mean: 0.0, mean p set: 0.4519725739955902
loss_pred:0.02718445472419262, decouple_loss:0.009401431307196617
The modified gen p mean: 0.44775497913360596, gen p mean: 0.0, mean p set: 0.45178547501564026
The modified gen p mean: 0.4511165916919708, gen p mean: 0.0, mean p set: 0.45091211795806885
loss_pred:0.027423948049545288, decouple_loss:0.009493048302829266
loss_pred:0.0260761808604002, decouple_loss:0.009052741341292858
Iteration: 409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4623361825942993, gen p mean: 0.0, mean p set: 0.4497344493865967
loss_pred:0.02652670256793499, decouple_loss:0.009452932514250278
The modified gen p mean: 0.4596439301967621, gen p mean: 0.0, mean p set: 0.45314162969589233
The modified gen p mean: 0.459305077791214, gen p mean: 0.0, mean p set: 0.45132896304130554
loss_pred:0.027287820354104042, decouple_loss:0.00892550591379404
loss_pred:0.027253812178969383, decouple_loss:0.009744689799845219
Iteration: 410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4545171856880188, gen p mean: 0.0, mean p set: 0.44971778988838196
The modified gen p mean: 0.45139798521995544, gen p mean: 0.0, mean p set: 0.450082391500473
loss_pred:0.02650093100965023, decouple_loss:0.008953563868999481
loss_pred:0.026999104768037796, decouple_loss:0.0093576954677701
The modified gen p mean: 0.44772303104400635, gen p mean: 0.0, mean p set: 0.4536430835723877
loss_pred:0.02740233577787876, decouple_loss:0.009568960405886173
2023-05-04 12:53:54 testing...
The modified gen p mean: 0.43679818511009216, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44319310784339905, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4456751346588135, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.028335239738225937, decouple_loss:0.009991142898797989
loss_pred:0.02724458836019039, decouple_loss:0.009658082388341427
loss_pred:0.026718363165855408, decouple_loss:0.009800929576158524
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027923567220568657, avg_mse: 0.03326468914747238
current test mse: 0.033265
Iteration: 411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493446946144104, gen p mean: 0.0, mean p set: 0.4509369134902954
The modified gen p mean: 0.44367891550064087, gen p mean: 0.0, mean p set: 0.452089786529541
loss_pred:0.02737664245069027, decouple_loss:0.00895457062870264
loss_pred:0.025297725573182106, decouple_loss:0.009420144371688366
The modified gen p mean: 0.4449562728404999, gen p mean: 0.0, mean p set: 0.45125362277030945
loss_pred:0.02619708515703678, decouple_loss:0.009253193624317646
Iteration: 412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469457268714905, gen p mean: 0.0, mean p set: 0.45099470019340515
loss_pred:0.027542565017938614, decouple_loss:0.009077825583517551
The modified gen p mean: 0.4488637447357178, gen p mean: 0.0, mean p set: 0.45022767782211304
The modified gen p mean: 0.4502406120300293, gen p mean: 0.0, mean p set: 0.4498707354068756
loss_pred:0.02767731249332428, decouple_loss:0.009228309616446495
loss_pred:0.026448195800185204, decouple_loss:0.009161527268588543
Iteration: 413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482448697090149, gen p mean: 0.0, mean p set: 0.44902369379997253
loss_pred:0.02690901979804039, decouple_loss:0.0097318384796381
The modified gen p mean: 0.44785699248313904, gen p mean: 0.0, mean p set: 0.4494280517101288
The modified gen p mean: 0.44831496477127075, gen p mean: 0.0, mean p set: 0.4490357041358948
loss_pred:0.026302797719836235, decouple_loss:0.009799987077713013
loss_pred:0.02595636434853077, decouple_loss:0.009738052263855934
Iteration: 414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509735405445099, gen p mean: 0.0, mean p set: 0.45182791352272034
The modified gen p mean: 0.45170292258262634, gen p mean: 0.0, mean p set: 0.45318490266799927
loss_pred:0.027094315737485886, decouple_loss:0.00918719545006752
loss_pred:0.027430396527051926, decouple_loss:0.009486997500061989
The modified gen p mean: 0.445666640996933, gen p mean: 0.0, mean p set: 0.45052674412727356
loss_pred:0.02685588225722313, decouple_loss:0.009273883886635303
Iteration: 415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4600997865200043, gen p mean: 0.0, mean p set: 0.4517350196838379
loss_pred:0.026412399485707283, decouple_loss:0.009650775231420994
The modified gen p mean: 0.46147266030311584, gen p mean: 0.0, mean p set: 0.45107904076576233
The modified gen p mean: 0.4597820043563843, gen p mean: 0.0, mean p set: 0.4526461362838745
loss_pred:0.026674335822463036, decouple_loss:0.009261849336326122
loss_pred:0.025751812383532524, decouple_loss:0.00980902835726738
Iteration: 416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4551968276500702, gen p mean: 0.0, mean p set: 0.4498874545097351
The modified gen p mean: 0.45260459184646606, gen p mean: 0.0, mean p set: 0.4517255127429962
loss_pred:0.026040639728307724, decouple_loss:0.009188884869217873
The modified gen p mean: 0.453091561794281, gen p mean: 0.0, mean p set: 0.45273545384407043loss_pred:0.026272447779774666, decouple_loss:0.00917587336152792
loss_pred:0.02684468775987625, decouple_loss:0.00932459905743599
Iteration: 417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4437643885612488, gen p mean: 0.0, mean p set: 0.4501683712005615
loss_pred:0.027368756011128426, decouple_loss:0.008871455676853657
The modified gen p mean: 0.43719297647476196, gen p mean: 0.0, mean p set: 0.4520416855812073
The modified gen p mean: 0.44023871421813965, gen p mean: 0.0, mean p set: 0.4523043632507324
loss_pred:0.025787603110074997, decouple_loss:0.00915512815117836
loss_pred:0.026553887873888016, decouple_loss:0.008862268179655075
Iteration: 418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491191804409027, gen p mean: 0.0, mean p set: 0.451738178730011
loss_pred:0.02661593072116375, decouple_loss:0.008852263912558556
The modified gen p mean: 0.4534566104412079, gen p mean: 0.0, mean p set: 0.44918093085289
The modified gen p mean: 0.446817547082901, gen p mean: 0.0, mean p set: 0.45100730657577515
loss_pred:0.027455510571599007, decouple_loss:0.008808497339487076
loss_pred:0.026607876643538475, decouple_loss:0.009269382804632187
Iteration: 419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4553030729293823, gen p mean: 0.0, mean p set: 0.45099982619285583
loss_pred:0.026727154850959778, decouple_loss:0.008847896009683609
The modified gen p mean: 0.45347511768341064, gen p mean: 0.0, mean p set: 0.45269572734832764
The modified gen p mean: 0.45481154322624207, gen p mean: 0.0, mean p set: 0.4502570331096649
loss_pred:0.027244174852967262, decouple_loss:0.008811086416244507
loss_pred:0.025091398507356644, decouple_loss:0.009187350049614906
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44336190819740295, gen p mean: 0.0, mean p set: 0.4487267732620239
The modified gen p mean: 0.45172446966171265, gen p mean: 0.0, mean p set: 0.4479648470878601
loss_pred:0.027830269187688828, decouple_loss:0.0095728300511837
The modified gen p mean: 0.44811955094337463, gen p mean: 0.0, mean p set: 0.4473494589328766
loss_pred:0.02779555320739746, decouple_loss:0.009514630772173405
loss_pred:0.029580043628811836, decouple_loss:0.011000270955264568
2023-05-04 12:58:04 testing...
The modified gen p mean: 0.4405008554458618, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44919154047966003, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44671788811683655, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.02802017331123352, decouple_loss:0.009746653027832508
loss_pred:0.026659421622753143, decouple_loss:0.00963599607348442
loss_pred:0.027019966393709183, decouple_loss:0.009367616847157478
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02771236002445221, avg_mse: 0.033005233854055405
current test mse: 0.033005
Iteration: 421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478575885295868, gen p mean: 0.0, mean p set: 0.4473569989204407
The modified gen p mean: 0.4459577202796936, gen p mean: 0.0, mean p set: 0.44728177785873413
loss_pred:0.026855593547225, decouple_loss:0.009095343761146069
loss_pred:0.0280259121209383, decouple_loss:0.01009889505803585
The modified gen p mean: 0.44719210267066956, gen p mean: 0.0, mean p set: 0.4469609558582306
loss_pred:0.02714747004210949, decouple_loss:0.009400906972587109
Iteration: 422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530850350856781, gen p mean: 0.0, mean p set: 0.44899824261665344
The modified gen p mean: 0.45347875356674194, gen p mean: 0.0, mean p set: 0.4473989009857178
loss_pred:0.027315231040120125, decouple_loss:0.009059669449925423
loss_pred:0.028486233204603195, decouple_loss:0.009160446934401989The modified gen p mean: 0.4515978991985321, gen p mean: 0.0, mean p set: 0.4500883221626282
loss_pred:0.026798630133271217, decouple_loss:0.009116295725107193
Iteration: 423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45183223485946655, gen p mean: 0.0, mean p set: 0.44803139567375183
The modified gen p mean: 0.4462754726409912, gen p mean: 0.0, mean p set: 0.4478318989276886
loss_pred:0.027815256267786026, decouple_loss:0.008825680240988731
loss_pred:0.028533171862363815, decouple_loss:0.00875996332615614The modified gen p mean: 0.45215755701065063, gen p mean: 0.0, mean p set: 0.44737815856933594
loss_pred:0.027382666245102882, decouple_loss:0.008748989552259445
Iteration: 424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4426442086696625, gen p mean: 0.0, mean p set: 0.4476413428783417
loss_pred:0.027701575309038162, decouple_loss:0.008844821713864803
The modified gen p mean: 0.43627241253852844, gen p mean: 0.0, mean p set: 0.4482575058937073
The modified gen p mean: 0.4357322156429291, gen p mean: 0.0, mean p set: 0.4481104910373688
loss_pred:0.02662312611937523, decouple_loss:0.00883135199546814
loss_pred:0.028000174090266228, decouple_loss:0.008790360763669014
Iteration: 425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4390937089920044, gen p mean: 0.0, mean p set: 0.4484971761703491
loss_pred:0.02665494941174984, decouple_loss:0.008960861712694168
The modified gen p mean: 0.4436020851135254, gen p mean: 0.0, mean p set: 0.44703981280326843
The modified gen p mean: 0.44721558690071106, gen p mean: 0.0, mean p set: 0.4468221068382263
loss_pred:0.02739121951162815, decouple_loss:0.0098438560962677
loss_pred:0.028416883200407028, decouple_loss:0.00943180825561285
Iteration: 426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4562406837940216, gen p mean: 0.0, mean p set: 0.44753316044807434
loss_pred:0.0282442569732666, decouple_loss:0.009002619422972202
The modified gen p mean: 0.45801278948783875, gen p mean: 0.0, mean p set: 0.44820234179496765
The modified gen p mean: 0.455456405878067, gen p mean: 0.0, mean p set: 0.4477183520793915
loss_pred:0.028921138495206833, decouple_loss:0.009010710753500462
loss_pred:0.027604835107922554, decouple_loss:0.008900945074856281
Iteration: 427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450823575258255, gen p mean: 0.0, mean p set: 0.4481060206890106
The modified gen p mean: 0.4526461660861969, gen p mean: 0.0, mean p set: 0.44846174120903015
loss_pred:0.028738584369421005, decouple_loss:0.008875735104084015
The modified gen p mean: 0.4561663269996643, gen p mean: 0.0, mean p set: 0.44751542806625366
loss_pred:0.027675824239850044, decouple_loss:0.008587346412241459
loss_pred:0.02763659507036209, decouple_loss:0.008915047161281109
Iteration: 428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44354569911956787, gen p mean: 0.0, mean p set: 0.448797345161438
The modified gen p mean: 0.44406864047050476, gen p mean: 0.0, mean p set: 0.44989389181137085
loss_pred:0.02799523063004017, decouple_loss:0.008480439893901348
loss_pred:0.02705618180334568, decouple_loss:0.008931421674787998The modified gen p mean: 0.44561827182769775, gen p mean: 0.0, mean p set: 0.4469473958015442
loss_pred:0.027954179793596268, decouple_loss:0.008991907350718975
Iteration: 429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4449356496334076, gen p mean: 0.0, mean p set: 0.4471015930175781
The modified gen p mean: 0.44587865471839905, gen p mean: 0.0, mean p set: 0.44752857089042664
loss_pred:0.029437687247991562, decouple_loss:0.00921851210296154
loss_pred:0.028357576578855515, decouple_loss:0.00919400341808796The modified gen p mean: 0.4470275640487671, gen p mean: 0.0, mean p set: 0.44738900661468506
loss_pred:0.027300041168928146, decouple_loss:0.009185656905174255
Iteration: 430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45421913266181946, gen p mean: 0.0, mean p set: 0.4478605389595032
loss_pred:0.028558991849422455, decouple_loss:0.008649276569485664
The modified gen p mean: 0.4539904296398163, gen p mean: 0.0, mean p set: 0.4468388855457306
The modified gen p mean: 0.45627978444099426, gen p mean: 0.0, mean p set: 0.44733917713165283
loss_pred:0.02771385945379734, decouple_loss:0.008952105417847633
loss_pred:0.027663657441735268, decouple_loss:0.009230710566043854
2023-05-04 13:01:36 testing...
The modified gen p mean: 0.4388032555580139, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4446595311164856, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44720932841300964, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.028663652017712593, decouple_loss:0.009305346757173538
loss_pred:0.027493583038449287, decouple_loss:0.008982045575976372
loss_pred:0.027033863589167595, decouple_loss:0.009034264832735062
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028185728937387466, avg_mse: 0.0338888019323349
current test mse: 0.033889
Iteration: 431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468819499015808, gen p mean: 0.0, mean p set: 0.44699788093566895
The modified gen p mean: 0.44790831208229065, gen p mean: 0.0, mean p set: 0.4471484422683716
loss_pred:0.027939729392528534, decouple_loss:0.008893579244613647
loss_pred:0.027540825307369232, decouple_loss:0.008987135253846645
The modified gen p mean: 0.4478769600391388, gen p mean: 0.0, mean p set: 0.4471592903137207
loss_pred:0.02743419259786606, decouple_loss:0.008995666168630123
Iteration: 432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4358427822589874, gen p mean: 0.0, mean p set: 0.4497283697128296
loss_pred:0.027289479970932007, decouple_loss:0.009717179462313652
The modified gen p mean: 0.43576300144195557, gen p mean: 0.0, mean p set: 0.4489316940307617
The modified gen p mean: 0.4387967884540558, gen p mean: 0.0, mean p set: 0.44744372367858887
loss_pred:0.02762024849653244, decouple_loss:0.009255148470401764
loss_pred:0.027491416782140732, decouple_loss:0.009772383607923985
Iteration: 433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523913264274597, gen p mean: 0.0, mean p set: 0.4470820426940918
The modified gen p mean: 0.4480001628398895, gen p mean: 0.0, mean p set: 0.44736534357070923
loss_pred:0.026857499033212662, decouple_loss:0.010194990783929825
loss_pred:0.028284268453717232, decouple_loss:0.009972597472369671The modified gen p mean: 0.4461779296398163, gen p mean: 0.0, mean p set: 0.44807443022727966
loss_pred:0.026696398854255676, decouple_loss:0.00994682777673006
Iteration: 434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45102381706237793, gen p mean: 0.0, mean p set: 0.44861525297164917
The modified gen p mean: 0.4523327946662903, gen p mean: 0.0, mean p set: 0.4474294185638428
loss_pred:0.028516879305243492, decouple_loss:0.010035927407443523
loss_pred:0.026615658774971962, decouple_loss:0.009890292771160603
The modified gen p mean: 0.44909432530403137, gen p mean: 0.0, mean p set: 0.4474082589149475
loss_pred:0.0289606936275959, decouple_loss:0.009686410427093506
Iteration: 435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44921183586120605, gen p mean: 0.0, mean p set: 0.44813334941864014
The modified gen p mean: 0.4548124372959137, gen p mean: 0.0, mean p set: 0.44714486598968506
loss_pred:0.027816947549581528, decouple_loss:0.009635042399168015
loss_pred:0.0272597037255764, decouple_loss:0.009583181701600552The modified gen p mean: 0.45152148604393005, gen p mean: 0.0, mean p set: 0.4494958221912384
loss_pred:0.027559315785765648, decouple_loss:0.0097805829718709
Iteration: 436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491473138332367, gen p mean: 0.0, mean p set: 0.44890403747558594
The modified gen p mean: 0.45079272985458374, gen p mean: 0.0, mean p set: 0.4484897553920746
loss_pred:0.026905786246061325, decouple_loss:0.010054339654743671
loss_pred:0.027435587719082832, decouple_loss:0.009757802821695805
The modified gen p mean: 0.45308515429496765, gen p mean: 0.0, mean p set: 0.44677209854125977
loss_pred:0.027518872171640396, decouple_loss:0.009940379299223423
Iteration: 437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44566696882247925, gen p mean: 0.0, mean p set: 0.44798544049263
The modified gen p mean: 0.4400939643383026, gen p mean: 0.0, mean p set: 0.4480628967285156
loss_pred:0.028052160516381264, decouple_loss:0.009331120178103447
loss_pred:0.027771862223744392, decouple_loss:0.009626608341932297
The modified gen p mean: 0.4479380249977112, gen p mean: 0.0, mean p set: 0.4477604627609253
loss_pred:0.0276847705245018, decouple_loss:0.009569433517754078
Iteration: 438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.441146582365036, gen p mean: 0.0, mean p set: 0.4487859904766083
loss_pred:0.027375152334570885, decouple_loss:0.009039398282766342
The modified gen p mean: 0.4401029348373413, gen p mean: 0.0, mean p set: 0.4482457637786865
The modified gen p mean: 0.4465992748737335, gen p mean: 0.0, mean p set: 0.44802284240722656
loss_pred:0.02753177098929882, decouple_loss:0.008968556299805641
loss_pred:0.027216678485274315, decouple_loss:0.00901107769459486
Iteration: 439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494422376155853, gen p mean: 0.0, mean p set: 0.449098140001297
loss_pred:0.02780703641474247, decouple_loss:0.00917131919413805
The modified gen p mean: 0.445860356092453, gen p mean: 0.0, mean p set: 0.44897395372390747
The modified gen p mean: 0.4479048550128937, gen p mean: 0.0, mean p set: 0.4481140077114105
loss_pred:0.027018729597330093, decouple_loss:0.009252728894352913
loss_pred:0.0278616975992918, decouple_loss:0.009351348504424095
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4558996260166168, gen p mean: 0.0, mean p set: 0.44851356744766235
The modified gen p mean: 0.4507366418838501, gen p mean: 0.0, mean p set: 0.44656795263290405
loss_pred:0.027542345225811005, decouple_loss:0.01018254179507494
The modified gen p mean: 0.45303505659103394, gen p mean: 0.0, mean p set: 0.4482978880405426
loss_pred:0.028078390285372734, decouple_loss:0.009749950841069221
loss_pred:0.027497682720422745, decouple_loss:0.010667704977095127
2023-05-04 13:05:48 testing...
The modified gen p mean: 0.4479639530181885, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4558090269565582, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4536227285861969, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.02801022306084633, decouple_loss:0.009803113527595997
loss_pred:0.02653772197663784, decouple_loss:0.009676852263510227
loss_pred:0.026996999979019165, decouple_loss:0.009624517522752285
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027666723355650902, avg_mse: 0.03271837159991264
current test mse: 0.032718
Iteration: 441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45512688159942627, gen p mean: 0.0, mean p set: 0.44902777671813965
The modified gen p mean: 0.4549944996833801, gen p mean: 0.0, mean p set: 0.44789430499076843
loss_pred:0.027450215071439743, decouple_loss:0.009652948006987572
loss_pred:0.027126887813210487, decouple_loss:0.009782648645341396
The modified gen p mean: 0.44963833689689636, gen p mean: 0.0, mean p set: 0.4466356933116913
loss_pred:0.02748434618115425, decouple_loss:0.010054358281195164
Iteration: 442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4419555068016052, gen p mean: 0.0, mean p set: 0.4472885727882385
The modified gen p mean: 0.44555869698524475, gen p mean: 0.0, mean p set: 0.44827497005462646
loss_pred:0.027554325759410858, decouple_loss:0.009909817017614841
loss_pred:0.02665710635483265, decouple_loss:0.00949777103960514The modified gen p mean: 0.43946129083633423, gen p mean: 0.0, mean p set: 0.44957879185676575
loss_pred:0.0265483558177948, decouple_loss:0.009744768962264061
Iteration: 443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44157302379608154, gen p mean: 0.0, mean p set: 0.4466274678707123
The modified gen p mean: 0.44181525707244873, gen p mean: 0.0, mean p set: 0.44801008701324463
loss_pred:0.027528587728738785, decouple_loss:0.009684357792139053
loss_pred:0.026891294866800308, decouple_loss:0.009409420192241669
The modified gen p mean: 0.44660529494285583, gen p mean: 0.0, mean p set: 0.4492754638195038
loss_pred:0.027492087334394455, decouple_loss:0.009530267678201199
Iteration: 444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463474154472351, gen p mean: 0.0, mean p set: 0.44761988520622253
The modified gen p mean: 0.4436461627483368, gen p mean: 0.0, mean p set: 0.449184387922287
loss_pred:0.027066173031926155, decouple_loss:0.009176932275295258
loss_pred:0.02673974819481373, decouple_loss:0.00938581582158804The modified gen p mean: 0.44441452622413635, gen p mean: 0.0, mean p set: 0.4478735327720642
loss_pred:0.02702472172677517, decouple_loss:0.009028488770127296
Iteration: 445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45362839102745056, gen p mean: 0.0, mean p set: 0.44887441396713257
loss_pred:0.027441145852208138, decouple_loss:0.00880433153361082
The modified gen p mean: 0.45039451122283936, gen p mean: 0.0, mean p set: 0.44671642780303955
The modified gen p mean: 0.4545510411262512, gen p mean: 0.0, mean p set: 0.449869304895401
loss_pred:0.02804526872932911, decouple_loss:0.00893395859748125
loss_pred:0.027172837406396866, decouple_loss:0.009114163927733898
Iteration: 446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44880008697509766, gen p mean: 0.0, mean p set: 0.44767752289772034
loss_pred:0.026551004499197006, decouple_loss:0.008799877017736435
The modified gen p mean: 0.4515191316604614, gen p mean: 0.0, mean p set: 0.44736772775650024
The modified gen p mean: 0.4464397430419922, gen p mean: 0.0, mean p set: 0.44775891304016113
loss_pred:0.027171935886144638, decouple_loss:0.008845490403473377
loss_pred:0.026759710162878036, decouple_loss:0.009495841339230537
Iteration: 447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44592878222465515, gen p mean: 0.0, mean p set: 0.4476076066493988
loss_pred:0.02649630606174469, decouple_loss:0.009235888719558716
The modified gen p mean: 0.4458855092525482, gen p mean: 0.0, mean p set: 0.4474617540836334
The modified gen p mean: 0.4446627199649811, gen p mean: 0.0, mean p set: 0.448087215423584
loss_pred:0.026583917438983917, decouple_loss:0.008976939134299755
loss_pred:0.02680688351392746, decouple_loss:0.009286044165492058
Iteration: 448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4440085291862488, gen p mean: 0.0, mean p set: 0.4466353952884674
The modified gen p mean: 0.4438987672328949, gen p mean: 0.0, mean p set: 0.44709834456443787
loss_pred:0.026956012472510338, decouple_loss:0.008921122178435326
loss_pred:0.026814138516783714, decouple_loss:0.00889774039387703The modified gen p mean: 0.4470463693141937, gen p mean: 0.0, mean p set: 0.45031026005744934
loss_pred:0.027172088623046875, decouple_loss:0.00937594287097454
Iteration: 449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45578402280807495, gen p mean: 0.0, mean p set: 0.4483223557472229
The modified gen p mean: 0.44911274313926697, gen p mean: 0.0, mean p set: 0.44740915298461914
loss_pred:0.026328306645154953, decouple_loss:0.008473689667880535
loss_pred:0.026720311492681503, decouple_loss:0.00846803653985262The modified gen p mean: 0.4505770802497864, gen p mean: 0.0, mean p set: 0.449787974357605
loss_pred:0.026723267510533333, decouple_loss:0.008989626541733742
Iteration: 450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450713187456131, gen p mean: 0.0, mean p set: 0.4473150670528412
loss_pred:0.02671916037797928, decouple_loss:0.009060134179890156
The modified gen p mean: 0.44918376207351685, gen p mean: 0.0, mean p set: 0.44784191250801086
The modified gen p mean: 0.44822293519973755, gen p mean: 0.0, mean p set: 0.4469049572944641
loss_pred:0.02674984745681286, decouple_loss:0.008786173537373543
loss_pred:0.026721181347966194, decouple_loss:0.008477877825498581
2023-05-04 13:09:25 testing...
The modified gen p mean: 0.44272008538246155, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.450435996055603, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44834741950035095, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.02765924669802189, decouple_loss:0.00870511308312416
loss_pred:0.02634703926742077, decouple_loss:0.008907094597816467
loss_pred:0.02660287544131279, decouple_loss:0.008710344322025776
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027308430522680283, avg_mse: 0.032422833144664764
current test mse: 0.032423
Iteration: 451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44579246640205383, gen p mean: 0.0, mean p set: 0.44900041818618774The modified gen p mean: 0.45075902342796326, gen p mean: 0.0, mean p set: 0.4479758143424988
loss_pred:0.025897441431879997, decouple_loss:0.008541394956409931
loss_pred:0.026285627856850624, decouple_loss:0.008595427498221397
The modified gen p mean: 0.44891270995140076, gen p mean: 0.0, mean p set: 0.4485120475292206
loss_pred:0.028119411319494247, decouple_loss:0.00849937554448843
Iteration: 452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654732942581177, gen p mean: 0.0, mean p set: 0.4488007128238678
The modified gen p mean: 0.4437198042869568, gen p mean: 0.0, mean p set: 0.44808489084243774
loss_pred:0.026994282379746437, decouple_loss:0.00856536440551281
loss_pred:0.026401428505778313, decouple_loss:0.008285357616841793The modified gen p mean: 0.4503140449523926, gen p mean: 0.0, mean p set: 0.44801437854766846
loss_pred:0.026800699532032013, decouple_loss:0.008785909041762352
Iteration: 453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43833374977111816, gen p mean: 0.0, mean p set: 0.44727712869644165
loss_pred:0.026498818770051003, decouple_loss:0.008420975878834724
The modified gen p mean: 0.4413411319255829, gen p mean: 0.0, mean p set: 0.4488462209701538
The modified gen p mean: 0.4441118538379669, gen p mean: 0.0, mean p set: 0.4489942789077759
loss_pred:0.027347123250365257, decouple_loss:0.008606030605733395
loss_pred:0.02658063918352127, decouple_loss:0.008473935537040234
Iteration: 454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494926333427429, gen p mean: 0.0, mean p set: 0.44826194643974304
The modified gen p mean: 0.4511704742908478, gen p mean: 0.0, mean p set: 0.44832706451416016
loss_pred:0.027037642896175385, decouple_loss:0.008002979680895805
The modified gen p mean: 0.4473190903663635, gen p mean: 0.0, mean p set: 0.445966511964798
loss_pred:0.026293491944670677, decouple_loss:0.008131551556289196
loss_pred:0.02708062343299389, decouple_loss:0.008446402847766876
Iteration: 455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45644599199295044, gen p mean: 0.0, mean p set: 0.4481530487537384
loss_pred:0.026106340810656548, decouple_loss:0.0077570765279233456
The modified gen p mean: 0.4540393650531769, gen p mean: 0.0, mean p set: 0.447562575340271
The modified gen p mean: 0.4593648314476013, gen p mean: 0.0, mean p set: 0.4477689266204834
loss_pred:0.027189327403903008, decouple_loss:0.00781919900327921
loss_pred:0.02662353403866291, decouple_loss:0.008038502186536789
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702261686325073, gen p mean: 0.0, mean p set: 0.44775715470314026
loss_pred:0.026525821536779404, decouple_loss:0.008345660753548145
The modified gen p mean: 0.4482426345348358, gen p mean: 0.0, mean p set: 0.44909462332725525
The modified gen p mean: 0.44924497604370117, gen p mean: 0.0, mean p set: 0.4487912356853485
loss_pred:0.027633102610707283, decouple_loss:0.007953055202960968
loss_pred:0.02655944786965847, decouple_loss:0.008338848128914833
Iteration: 457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4388522803783417, gen p mean: 0.0, mean p set: 0.4499136209487915
The modified gen p mean: 0.44166478514671326, gen p mean: 0.0, mean p set: 0.4479130506515503loss_pred:0.026837052777409554, decouple_loss:0.008322826586663723
The modified gen p mean: 0.4359946548938751, gen p mean: 0.0, mean p set: 0.44745954871177673
loss_pred:0.026634441688656807, decouple_loss:0.0077534690499305725
loss_pred:0.026346564292907715, decouple_loss:0.007875816896557808
Iteration: 458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44239428639411926, gen p mean: 0.0, mean p set: 0.4480946362018585
loss_pred:0.026376960799098015, decouple_loss:0.007542060222476721
The modified gen p mean: 0.44305655360221863, gen p mean: 0.0, mean p set: 0.447646826505661
The modified gen p mean: 0.4430369734764099, gen p mean: 0.0, mean p set: 0.4484986364841461
loss_pred:0.02644185908138752, decouple_loss:0.007753115613013506
loss_pred:0.02659694291651249, decouple_loss:0.008201575838029385
Iteration: 459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533087909221649, gen p mean: 0.0, mean p set: 0.44821611046791077
The modified gen p mean: 0.45215553045272827, gen p mean: 0.0, mean p set: 0.44606801867485046
loss_pred:0.02668624185025692, decouple_loss:0.007884306833148003
loss_pred:0.02682330645620823, decouple_loss:0.008129959926009178The modified gen p mean: 0.4527377486228943, gen p mean: 0.0, mean p set: 0.44869065284729004
loss_pred:0.026092519983649254, decouple_loss:0.007479988504201174
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
NaN value num: 0
Iteration: 460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45137372612953186, gen p mean: 0.0, mean p set: 0.4511098861694336
The modified gen p mean: 0.4569230377674103, gen p mean: 0.0, mean p set: 0.45088016986846924
The modified gen p mean: 0.45109909772872925, gen p mean: 0.0, mean p set: 0.4514060616493225
loss_pred:0.02731999009847641, decouple_loss:0.008973262272775173
loss_pred:0.028783198446035385, decouple_loss:0.00927585456520319
loss_pred:0.02870660461485386, decouple_loss:0.009184896014630795
2023-05-04 13:13:43 testing...
The modified gen p mean: 0.4444349408149719, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45032358169555664, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45267266035079956, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02764403074979782, decouple_loss:0.008346310816705227
loss_pred:0.026625093072652817, decouple_loss:0.00805182009935379
loss_pred:0.026423078030347824, decouple_loss:0.008298038505017757
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027309004217386246, avg_mse: 0.032582178711891174
current test mse: 0.032582
Iteration: 461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518345892429352, gen p mean: 0.0, mean p set: 0.45164790749549866
The modified gen p mean: 0.4530702531337738, gen p mean: 0.0, mean p set: 0.45108845829963684
loss_pred:0.027238797396421432, decouple_loss:0.008946586400270462
loss_pred:0.026965947821736336, decouple_loss:0.00877831969410181
The modified gen p mean: 0.44771498441696167, gen p mean: 0.0, mean p set: 0.45338475704193115
loss_pred:0.027950497344136238, decouple_loss:0.008971800096333027
Iteration: 462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45661333203315735, gen p mean: 0.0, mean p set: 0.45222604274749756
loss_pred:0.028908560052514076, decouple_loss:0.008626948110759258
The modified gen p mean: 0.45571961998939514, gen p mean: 0.0, mean p set: 0.45258012413978577
The modified gen p mean: 0.45205509662628174, gen p mean: 0.0, mean p set: 0.4515374004840851
loss_pred:0.027675777673721313, decouple_loss:0.008787637576460838
loss_pred:0.02815723605453968, decouple_loss:0.00856825616210699
Iteration: 463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44974851608276367, gen p mean: 0.0, mean p set: 0.45108652114868164
loss_pred:0.028685279190540314, decouple_loss:0.00848622340708971
The modified gen p mean: 0.4481511116027832, gen p mean: 0.0, mean p set: 0.45203498005867004
The modified gen p mean: 0.44824546575546265, gen p mean: 0.0, mean p set: 0.45174819231033325
loss_pred:0.027778079733252525, decouple_loss:0.008981053717434406
loss_pred:0.028159046545624733, decouple_loss:0.008897417224943638
Iteration: 464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44956356287002563, gen p mean: 0.0, mean p set: 0.45148617029190063
loss_pred:0.02680857665836811, decouple_loss:0.008416014723479748
The modified gen p mean: 0.44497761130332947, gen p mean: 0.0, mean p set: 0.4514998197555542
The modified gen p mean: 0.4462614357471466, gen p mean: 0.0, mean p set: 0.4518622159957886
loss_pred:0.026891138404607773, decouple_loss:0.008703307248651981
loss_pred:0.028587164357304573, decouple_loss:0.008633311837911606
Iteration: 465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4543798565864563, gen p mean: 0.0, mean p set: 0.45197397470474243
loss_pred:0.025037521496415138, decouple_loss:0.008627808652818203The modified gen p mean: 0.46005555987358093, gen p mean: 0.0, mean p set: 0.4512137174606323
The modified gen p mean: 0.45854130387306213, gen p mean: 0.0, mean p set: 0.45197105407714844
loss_pred:0.026946811005473137, decouple_loss:0.008538082242012024
loss_pred:0.02561335451900959, decouple_loss:0.008616261184215546
Iteration: 466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.444627046585083, gen p mean: 0.0, mean p set: 0.4498913586139679
loss_pred:0.025710416957736015, decouple_loss:0.008825816214084625
The modified gen p mean: 0.4487263262271881, gen p mean: 0.0, mean p set: 0.45288771390914917
The modified gen p mean: 0.4488341510295868, gen p mean: 0.0, mean p set: 0.4522937834262848
loss_pred:0.024990608915686607, decouple_loss:0.008608645759522915
loss_pred:0.02873545140028, decouple_loss:0.008665917441248894
Iteration: 467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44141706824302673, gen p mean: 0.0, mean p set: 0.45211273431777954
The modified gen p mean: 0.446501761674881, gen p mean: 0.0, mean p set: 0.45187801122665405
loss_pred:0.028511736541986465, decouple_loss:0.009003594517707825
loss_pred:0.028514238074421883, decouple_loss:0.008938513696193695
The modified gen p mean: 0.4454236924648285, gen p mean: 0.0, mean p set: 0.45337486267089844
loss_pred:0.026520011946558952, decouple_loss:0.0089824628084898
Iteration: 468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4725567698478699, gen p mean: 0.0, mean p set: 0.4516793489456177
The modified gen p mean: 0.4700077772140503, gen p mean: 0.0, mean p set: 0.4515528082847595
loss_pred:0.028068583458662033, decouple_loss:0.008673998527228832
loss_pred:0.02889879420399666, decouple_loss:0.008564670570194721The modified gen p mean: 0.462195485830307, gen p mean: 0.0, mean p set: 0.4507710039615631
loss_pred:0.027935046702623367, decouple_loss:0.00888479221612215
Iteration: 469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4562104344367981, gen p mean: 0.0, mean p set: 0.45166081190109253
loss_pred:0.026842860504984856, decouple_loss:0.00836231280118227
The modified gen p mean: 0.4605797827243805, gen p mean: 0.0, mean p set: 0.45105281472206116
The modified gen p mean: 0.4558527171611786, gen p mean: 0.0, mean p set: 0.4532400667667389
loss_pred:0.02874171733856201, decouple_loss:0.008453001268208027
loss_pred:0.025219138711690903, decouple_loss:0.008215234614908695
Iteration: 470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4308967590332031, gen p mean: 0.0, mean p set: 0.4513946771621704
The modified gen p mean: 0.42530709505081177, gen p mean: 0.0, mean p set: 0.45158541202545166
loss_pred:0.02719937637448311, decouple_loss:0.008350486867129803
loss_pred:0.028323475271463394, decouple_loss:0.008725419640541077
The modified gen p mean: 0.42535141110420227, gen p mean: 0.0, mean p set: 0.45269879698753357
loss_pred:0.026518309488892555, decouple_loss:0.008471515960991383
2023-05-04 13:17:14 testing...
The modified gen p mean: 0.4387466311454773, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4449412226676941, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44747427105903625, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.028017733246088028, decouple_loss:0.009140330366790295
loss_pred:0.0269313957542181, decouple_loss:0.009035345166921616
loss_pred:0.026544665917754173, decouple_loss:0.009084214456379414
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027618929743766785, avg_mse: 0.03310735896229744
current test mse: 0.033107
Iteration: 471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4412999153137207, gen p mean: 0.0, mean p set: 0.4516860842704773
The modified gen p mean: 0.4375387132167816, gen p mean: 0.0, mean p set: 0.45154067873954773
loss_pred:0.027126580476760864, decouple_loss:0.008472640067338943
loss_pred:0.028290795162320137, decouple_loss:0.009079216048121452
The modified gen p mean: 0.4414152503013611, gen p mean: 0.0, mean p set: 0.4510160982608795
loss_pred:0.027666905894875526, decouple_loss:0.008755147457122803
Iteration: 472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4734407961368561, gen p mean: 0.0, mean p set: 0.45052260160446167
loss_pred:0.026936663314700127, decouple_loss:0.008924704976379871
The modified gen p mean: 0.473601371049881, gen p mean: 0.0, mean p set: 0.45141565799713135
The modified gen p mean: 0.47432971000671387, gen p mean: 0.0, mean p set: 0.4529227614402771
loss_pred:0.02806551195681095, decouple_loss:0.009137322194874287
loss_pred:0.028729107230901718, decouple_loss:0.009042401798069477
Iteration: 473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904255867004395, gen p mean: 0.0, mean p set: 0.4508439898490906
loss_pred:0.02513042464852333, decouple_loss:0.008892619982361794
The modified gen p mean: 0.45320823788642883, gen p mean: 0.0, mean p set: 0.4520242512226105
The modified gen p mean: 0.45831167697906494, gen p mean: 0.0, mean p set: 0.4512825310230255
loss_pred:0.026511579751968384, decouple_loss:0.008800293318927288
loss_pred:0.0261258315294981, decouple_loss:0.00875288899987936
Iteration: 474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4401346445083618, gen p mean: 0.0, mean p set: 0.45239734649658203
loss_pred:0.026201281696558, decouple_loss:0.008623797446489334
The modified gen p mean: 0.4439629018306732, gen p mean: 0.0, mean p set: 0.45278200507164
The modified gen p mean: 0.4400777518749237, gen p mean: 0.0, mean p set: 0.4517945945262909
loss_pred:0.025912629440426826, decouple_loss:0.008514337241649628
loss_pred:0.02720433473587036, decouple_loss:0.00884352345019579
Iteration: 475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4446651339530945, gen p mean: 0.0, mean p set: 0.45076268911361694
The modified gen p mean: 0.44241753220558167, gen p mean: 0.0, mean p set: 0.45239561796188354
loss_pred:0.028325552120804787, decouple_loss:0.008749258704483509
loss_pred:0.026877310127019882, decouple_loss:0.008596501313149929The modified gen p mean: 0.44611871242523193, gen p mean: 0.0, mean p set: 0.451505571603775
loss_pred:0.02738819271326065, decouple_loss:0.008413338102400303
Iteration: 476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4545387625694275, gen p mean: 0.0, mean p set: 0.4520331025123596
The modified gen p mean: 0.45664700865745544, gen p mean: 0.0, mean p set: 0.4528633952140808
loss_pred:0.02799961529672146, decouple_loss:0.009143709205091
loss_pred:0.026672089472413063, decouple_loss:0.009069593623280525The modified gen p mean: 0.4521404802799225, gen p mean: 0.0, mean p set: 0.4528789222240448
loss_pred:0.0258663147687912, decouple_loss:0.008802210912108421
Iteration: 477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45472797751426697, gen p mean: 0.0, mean p set: 0.45181748270988464
The modified gen p mean: 0.44904789328575134, gen p mean: 0.0, mean p set: 0.4519181549549103
loss_pred:0.0285304244607687, decouple_loss:0.009084834717214108
The modified gen p mean: 0.4450203776359558, gen p mean: 0.0, mean p set: 0.4513830542564392loss_pred:0.025355495512485504, decouple_loss:0.008887873031198978
loss_pred:0.0282940361648798, decouple_loss:0.009403371252119541
Iteration: 478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4626387059688568, gen p mean: 0.0, mean p set: 0.4515029489994049
loss_pred:0.025425627827644348, decouple_loss:0.00897190161049366
The modified gen p mean: 0.46204131841659546, gen p mean: 0.0, mean p set: 0.4511229395866394
The modified gen p mean: 0.45717930793762207, gen p mean: 0.0, mean p set: 0.45181164145469666
loss_pred:0.028143778443336487, decouple_loss:0.009355218149721622
loss_pred:0.027253983542323112, decouple_loss:0.009208453819155693
Iteration: 479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4545893371105194, gen p mean: 0.0, mean p set: 0.4514080286026001
The modified gen p mean: 0.45566606521606445, gen p mean: 0.0, mean p set: 0.45145145058631897
loss_pred:0.028398260474205017, decouple_loss:0.009329422377049923
loss_pred:0.026562675833702087, decouple_loss:0.0092886658385396The modified gen p mean: 0.4502858817577362, gen p mean: 0.0, mean p set: 0.45172742009162903
loss_pred:0.027571288868784904, decouple_loss:0.009933440014719963
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4405912756919861, gen p mean: 0.0, mean p set: 0.4491502642631531
The modified gen p mean: 0.44110533595085144, gen p mean: 0.0, mean p set: 0.4474402070045471
loss_pred:0.027073681354522705, decouple_loss:0.009486480616033077
The modified gen p mean: 0.4366031587123871, gen p mean: 0.0, mean p set: 0.44852009415626526
loss_pred:0.02837265469133854, decouple_loss:0.009707411751151085
loss_pred:0.027559757232666016, decouple_loss:0.009595774114131927
2023-05-04 13:21:24 testing...
The modified gen p mean: 0.43905121088027954, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.447819322347641, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44483229517936707, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.02791648916900158, decouple_loss:0.009328177198767662
loss_pred:0.02651865780353546, decouple_loss:0.009314059279859066
loss_pred:0.026876157149672508, decouple_loss:0.009240037761628628
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027568472549319267, avg_mse: 0.033027298748493195
current test mse: 0.033027
Iteration: 481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44495832920074463, gen p mean: 0.0, mean p set: 0.44789940118789673
The modified gen p mean: 0.4438912868499756, gen p mean: 0.0, mean p set: 0.4474206268787384
loss_pred:0.027883239090442657, decouple_loss:0.009442051872611046
loss_pred:0.027004577219486237, decouple_loss:0.009322532452642918
The modified gen p mean: 0.446684330701828, gen p mean: 0.0, mean p set: 0.4480327069759369
loss_pred:0.02693318948149681, decouple_loss:0.009351111017167568
Iteration: 482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45306041836738586, gen p mean: 0.0, mean p set: 0.44913291931152344
The modified gen p mean: 0.4514639973640442, gen p mean: 0.0, mean p set: 0.4483005702495575
loss_pred:0.027986060827970505, decouple_loss:0.009517182596027851
The modified gen p mean: 0.4530448019504547, gen p mean: 0.0, mean p set: 0.4475173056125641
loss_pred:0.027483422309160233, decouple_loss:0.009217770770192146
loss_pred:0.027130067348480225, decouple_loss:0.009865805506706238
Iteration: 483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45129016041755676, gen p mean: 0.0, mean p set: 0.4481063485145569
loss_pred:0.02768399566411972, decouple_loss:0.009070765227079391
The modified gen p mean: 0.45026588439941406, gen p mean: 0.0, mean p set: 0.44937047362327576
The modified gen p mean: 0.4485679566860199, gen p mean: 0.0, mean p set: 0.44838836789131165
loss_pred:0.025886032730340958, decouple_loss:0.009284978732466698
loss_pred:0.028404181823134422, decouple_loss:0.009293253533542156
Iteration: 484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856908917427063, gen p mean: 0.0, mean p set: 0.4476650059223175
loss_pred:0.027097709476947784, decouple_loss:0.009122746996581554
The modified gen p mean: 0.4519956111907959, gen p mean: 0.0, mean p set: 0.4481825828552246
The modified gen p mean: 0.45061442255973816, gen p mean: 0.0, mean p set: 0.4477144777774811
loss_pred:0.02683810330927372, decouple_loss:0.008900913409888744
loss_pred:0.026522640138864517, decouple_loss:0.00891001895070076
Iteration: 485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656723737716675, gen p mean: 0.0, mean p set: 0.44860079884529114
loss_pred:0.027408912777900696, decouple_loss:0.009144379757344723
The modified gen p mean: 0.4391234517097473, gen p mean: 0.0, mean p set: 0.44886934757232666
The modified gen p mean: 0.4438287019729614, gen p mean: 0.0, mean p set: 0.4482133686542511
loss_pred:0.026520974934101105, decouple_loss:0.00887533649802208
loss_pred:0.02686881460249424, decouple_loss:0.00914624985307455
Iteration: 486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4443361163139343, gen p mean: 0.0, mean p set: 0.44924822449684143
loss_pred:0.027117745950818062, decouple_loss:0.008802855387330055
The modified gen p mean: 0.444659024477005, gen p mean: 0.0, mean p set: 0.44727250933647156
The modified gen p mean: 0.4464731514453888, gen p mean: 0.0, mean p set: 0.4472596049308777
loss_pred:0.026542631909251213, decouple_loss:0.00846822839230299
loss_pred:0.02665017358958721, decouple_loss:0.008544648997485638
Iteration: 487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45153263211250305, gen p mean: 0.0, mean p set: 0.44800058007240295
The modified gen p mean: 0.4489268362522125, gen p mean: 0.0, mean p set: 0.4473881721496582
loss_pred:0.025857938453555107, decouple_loss:0.00840461440384388
loss_pred:0.027271157130599022, decouple_loss:0.00865747407078743
The modified gen p mean: 0.4503260850906372, gen p mean: 0.0, mean p set: 0.44695839285850525
loss_pred:0.026746707037091255, decouple_loss:0.008313149213790894
Iteration: 488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798845052719116, gen p mean: 0.0, mean p set: 0.44780340790748596
The modified gen p mean: 0.45295846462249756, gen p mean: 0.0, mean p set: 0.4491216838359833
loss_pred:0.026641258969902992, decouple_loss:0.008381095714867115
loss_pred:0.026925580576062202, decouple_loss:0.008344433270394802The modified gen p mean: 0.4518260955810547, gen p mean: 0.0, mean p set: 0.44917070865631104
loss_pred:0.02739197015762329, decouple_loss:0.008492751978337765
Iteration: 489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464748501777649, gen p mean: 0.0, mean p set: 0.4483039677143097
The modified gen p mean: 0.44251734018325806, gen p mean: 0.0, mean p set: 0.4476828873157501
loss_pred:0.025572100654244423, decouple_loss:0.00834676157683134
loss_pred:0.026269659399986267, decouple_loss:0.008461583405733109The modified gen p mean: 0.44783467054367065, gen p mean: 0.0, mean p set: 0.4481982886791229
loss_pred:0.025887172669172287, decouple_loss:0.008156741969287395
Iteration: 490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44176411628723145, gen p mean: 0.0, mean p set: 0.448940247297287
The modified gen p mean: 0.4493802785873413, gen p mean: 0.0, mean p set: 0.4484962224960327
loss_pred:0.027338165789842606, decouple_loss:0.00835768599063158
loss_pred:0.02716667763888836, decouple_loss:0.008088791742920876The modified gen p mean: 0.44503429532051086, gen p mean: 0.0, mean p set: 0.4486541748046875
loss_pred:0.028019215911626816, decouple_loss:0.008516197092831135
2023-05-04 13:24:57 testing...
The modified gen p mean: 0.44545191526412964, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4509292244911194, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.453828364610672, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.027455518022179604, decouple_loss:0.008268867619335651
loss_pred:0.0264606736600399, decouple_loss:0.00810939259827137
loss_pred:0.026033978909254074, decouple_loss:0.008194240741431713
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02705959975719452, avg_mse: 0.03232424706220627
current test mse: 0.032324
Iteration: 491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44983527064323425, gen p mean: 0.0, mean p set: 0.44813501834869385
The modified gen p mean: 0.453426718711853, gen p mean: 0.0, mean p set: 0.4473542869091034
loss_pred:0.026948606595396996, decouple_loss:0.008327736519277096
loss_pred:0.02648703008890152, decouple_loss:0.007898552343249321
The modified gen p mean: 0.44643956422805786, gen p mean: 0.0, mean p set: 0.4479212760925293
loss_pred:0.025974689051508904, decouple_loss:0.008229361847043037
Iteration: 492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468444883823395, gen p mean: 0.0, mean p set: 0.4470282196998596
loss_pred:0.026141906157135963, decouple_loss:0.008043281733989716
The modified gen p mean: 0.4510945975780487, gen p mean: 0.0, mean p set: 0.44645851850509644
The modified gen p mean: 0.45223742723464966, gen p mean: 0.0, mean p set: 0.4480895698070526
loss_pred:0.026544010266661644, decouple_loss:0.007923619821667671
loss_pred:0.026984021067619324, decouple_loss:0.008103140629827976
Iteration: 493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764745235443115, gen p mean: 0.0, mean p set: 0.4479547441005707
loss_pred:0.025982476770877838, decouple_loss:0.007971357554197311
The modified gen p mean: 0.4473429024219513, gen p mean: 0.0, mean p set: 0.4477671980857849
The modified gen p mean: 0.44531986117362976, gen p mean: 0.0, mean p set: 0.44817450642585754
loss_pred:0.026625491678714752, decouple_loss:0.008083046413958073
loss_pred:0.02655838429927826, decouple_loss:0.008223096840083599
Iteration: 494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.444822758436203, gen p mean: 0.0, mean p set: 0.4475003480911255
The modified gen p mean: 0.44574153423309326, gen p mean: 0.0, mean p set: 0.44791606068611145
loss_pred:0.02609023079276085, decouple_loss:0.007908916100859642
loss_pred:0.027483860030770302, decouple_loss:0.008397392928600311The modified gen p mean: 0.4442407190799713, gen p mean: 0.0, mean p set: 0.4479072690010071
loss_pred:0.027348261326551437, decouple_loss:0.008262443356215954
Iteration: 495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463595151901245, gen p mean: 0.0, mean p set: 0.4482652246952057The modified gen p mean: 0.44565892219543457, gen p mean: 0.0, mean p set: 0.44778600335121155
loss_pred:0.027217242866754532, decouple_loss:0.008199564181268215
loss_pred:0.02656848542392254, decouple_loss:0.008033491671085358
The modified gen p mean: 0.4451117217540741, gen p mean: 0.0, mean p set: 0.4473342299461365
loss_pred:0.026573384180665016, decouple_loss:0.008042605593800545
Iteration: 496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45210400223731995, gen p mean: 0.0, mean p set: 0.44860121607780457
The modified gen p mean: 0.45044687390327454, gen p mean: 0.0, mean p set: 0.4479711353778839
loss_pred:0.025514589622616768, decouple_loss:0.007886304520070553
The modified gen p mean: 0.4522518813610077, gen p mean: 0.0, mean p set: 0.44837847352027893
loss_pred:0.026499276980757713, decouple_loss:0.00800101924687624
loss_pred:0.026019511744379997, decouple_loss:0.007805087603628635
Iteration: 497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45123910903930664, gen p mean: 0.0, mean p set: 0.4468632936477661
The modified gen p mean: 0.45349013805389404, gen p mean: 0.0, mean p set: 0.44676437973976135
loss_pred:0.02601568214595318, decouple_loss:0.007628642022609711
loss_pred:0.026533853262662888, decouple_loss:0.008037741295993328
The modified gen p mean: 0.45018914341926575, gen p mean: 0.0, mean p set: 0.4483788311481476
loss_pred:0.026902299374341965, decouple_loss:0.007904601283371449
Iteration: 498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44257742166519165, gen p mean: 0.0, mean p set: 0.4477669298648834
loss_pred:0.026094352826476097, decouple_loss:0.0075912787579
The modified gen p mean: 0.44683244824409485, gen p mean: 0.0, mean p set: 0.4461096227169037
The modified gen p mean: 0.4436618685722351, gen p mean: 0.0, mean p set: 0.44821637868881226
loss_pred:0.026461174711585045, decouple_loss:0.0074977693147957325
loss_pred:0.02661507949233055, decouple_loss:0.007558239158242941
Iteration: 499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4428636431694031, gen p mean: 0.0, mean p set: 0.44862261414527893
loss_pred:0.02594970166683197, decouple_loss:0.007436400279402733
The modified gen p mean: 0.4430868923664093, gen p mean: 0.0, mean p set: 0.44897761940956116
The modified gen p mean: 0.44367897510528564, gen p mean: 0.0, mean p set: 0.4481835961341858
loss_pred:0.026888547465205193, decouple_loss:0.00769710261374712
loss_pred:0.02613929472863674, decouple_loss:0.007424504030495882
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
NaN value num: 0
Iteration: 500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535630941390991, gen p mean: 0.0, mean p set: 0.45099109411239624
The modified gen p mean: 0.4541279077529907, gen p mean: 0.0, mean p set: 0.45061951875686646
loss_pred:0.026461107656359673, decouple_loss:0.008222716860473156
The modified gen p mean: 0.44972723722457886, gen p mean: 0.0, mean p set: 0.45104461908340454
loss_pred:0.02664834074676037, decouple_loss:0.008487346582114697
loss_pred:0.026783961802721024, decouple_loss:0.008410228416323662
2023-05-04 13:29:15 testing...
The modified gen p mean: 0.4500865638256073, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4449729919433594, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45306143164634705, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02652628719806671, decouple_loss:0.00789560005068779
loss_pred:0.0276032742112875, decouple_loss:0.00814057793468237
loss_pred:0.026109542697668076, decouple_loss:0.007966401055455208
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027146410197019577, avg_mse: 0.0325750894844532
current test mse: 0.032575
Iteration: 501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45308947563171387, gen p mean: 0.0, mean p set: 0.44909584522247314
The modified gen p mean: 0.4510309398174286, gen p mean: 0.0, mean p set: 0.4498820900917053
loss_pred:0.0261769350618124, decouple_loss:0.008233790285885334
loss_pred:0.02602354623377323, decouple_loss:0.008275690488517284
The modified gen p mean: 0.45018503069877625, gen p mean: 0.0, mean p set: 0.45151427388191223
loss_pred:0.027640048414468765, decouple_loss:0.008764466270804405
Iteration: 502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527973234653473, gen p mean: 0.0, mean p set: 0.449493408203125
The modified gen p mean: 0.45403021574020386, gen p mean: 0.0, mean p set: 0.4490794241428375
loss_pred:0.02691742591559887, decouple_loss:0.008477055467665195
loss_pred:0.02666189707815647, decouple_loss:0.008580848574638367
The modified gen p mean: 0.45159342885017395, gen p mean: 0.0, mean p set: 0.4512903094291687
loss_pred:0.027491409331560135, decouple_loss:0.00873460341244936
Iteration: 503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4551439881324768, gen p mean: 0.0, mean p set: 0.44931018352508545
The modified gen p mean: 0.44985896348953247, gen p mean: 0.0, mean p set: 0.45079106092453003
loss_pred:0.027275407686829567, decouple_loss:0.008463434875011444
The modified gen p mean: 0.4553656578063965, gen p mean: 0.0, mean p set: 0.45045775175094604loss_pred:0.026041053235530853, decouple_loss:0.008213881403207779
loss_pred:0.025825034826993942, decouple_loss:0.007974247448146343
Iteration: 504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44621655344963074, gen p mean: 0.0, mean p set: 0.4514070451259613
The modified gen p mean: 0.4410525858402252, gen p mean: 0.0, mean p set: 0.4512398838996887
loss_pred:0.02731829136610031, decouple_loss:0.008384262211620808
loss_pred:0.02769363299012184, decouple_loss:0.008173509500920773
The modified gen p mean: 0.4471142888069153, gen p mean: 0.0, mean p set: 0.45005032420158386
loss_pred:0.02610081061720848, decouple_loss:0.007798629347234964
Iteration: 505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861695170402527, gen p mean: 0.0, mean p set: 0.44945380091667175
The modified gen p mean: 0.44777244329452515, gen p mean: 0.0, mean p set: 0.4513188898563385
loss_pred:0.026433425024151802, decouple_loss:0.008050487376749516
loss_pred:0.02685057371854782, decouple_loss:0.00842526089400053
The modified gen p mean: 0.4463309645652771, gen p mean: 0.0, mean p set: 0.4506239891052246
loss_pred:0.026023581624031067, decouple_loss:0.008306470699608326
Iteration: 506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44458696246147156, gen p mean: 0.0, mean p set: 0.44993993639945984
loss_pred:0.02700224332511425, decouple_loss:0.00854688510298729
The modified gen p mean: 0.4468797743320465, gen p mean: 0.0, mean p set: 0.44908758997917175
The modified gen p mean: 0.44458696246147156, gen p mean: 0.0, mean p set: 0.45058220624923706
loss_pred:0.02668638527393341, decouple_loss:0.008459929376840591
loss_pred:0.027731625363230705, decouple_loss:0.008792993612587452
Iteration: 507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45202985405921936, gen p mean: 0.0, mean p set: 0.4503445625305176
The modified gen p mean: 0.4595078229904175, gen p mean: 0.0, mean p set: 0.451661616563797
loss_pred:0.02653203159570694, decouple_loss:0.00863515492528677
loss_pred:0.026969783008098602, decouple_loss:0.008217728696763515
The modified gen p mean: 0.45804792642593384, gen p mean: 0.0, mean p set: 0.4504653811454773
loss_pred:0.02560379169881344, decouple_loss:0.008063897490501404
Iteration: 508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45937350392341614, gen p mean: 0.0, mean p set: 0.45046308636665344
The modified gen p mean: 0.4618528485298157, gen p mean: 0.0, mean p set: 0.45067429542541504
loss_pred:0.02599301189184189, decouple_loss:0.008446368388831615
loss_pred:0.026433488354086876, decouple_loss:0.008081616833806038The modified gen p mean: 0.4590873122215271, gen p mean: 0.0, mean p set: 0.44937294721603394
loss_pred:0.025299690663814545, decouple_loss:0.0078092715702950954
Iteration: 509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463554918766022, gen p mean: 0.0, mean p set: 0.4499933123588562The modified gen p mean: 0.45196107029914856, gen p mean: 0.0, mean p set: 0.4507562518119812
loss_pred:0.026367461308836937, decouple_loss:0.008511503227055073
loss_pred:0.026272408664226532, decouple_loss:0.008707222528755665
The modified gen p mean: 0.44628432393074036, gen p mean: 0.0, mean p set: 0.45040175318717957
loss_pred:0.026105646044015884, decouple_loss:0.00833992287516594
Iteration: 510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44054168462753296, gen p mean: 0.0, mean p set: 0.4490005075931549
The modified gen p mean: 0.4360027611255646, gen p mean: 0.0, mean p set: 0.45053014159202576
loss_pred:0.026351427659392357, decouple_loss:0.00843663141131401
The modified gen p mean: 0.4416898190975189, gen p mean: 0.0, mean p set: 0.4502848982810974loss_pred:0.025626126676797867, decouple_loss:0.008254282176494598
loss_pred:0.026496080681681633, decouple_loss:0.008403850719332695
2023-05-04 13:32:48 testing...
The modified gen p mean: 0.4366057515144348, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44184672832489014, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4448452591896057, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.027991872280836105, decouple_loss:0.008960836566984653
loss_pred:0.026818767189979553, decouple_loss:0.008791961707174778
loss_pred:0.026385994628071785, decouple_loss:0.008805325254797935
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02750818058848381, avg_mse: 0.03308471664786339
current test mse: 0.033085
Iteration: 511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44329357147216797, gen p mean: 0.0, mean p set: 0.4512932300567627The modified gen p mean: 0.4490232765674591, gen p mean: 0.0, mean p set: 0.4505939483642578
loss_pred:0.026400024071335793, decouple_loss:0.00823276862502098
loss_pred:0.025858750566840172, decouple_loss:0.00820431299507618
The modified gen p mean: 0.4455866813659668, gen p mean: 0.0, mean p set: 0.45064401626586914
loss_pred:0.025904029607772827, decouple_loss:0.00845402106642723
Iteration: 512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45194730162620544, gen p mean: 0.0, mean p set: 0.4509795904159546
The modified gen p mean: 0.4545641541481018, gen p mean: 0.0, mean p set: 0.4516618549823761
loss_pred:0.02623409777879715, decouple_loss:0.008123023435473442
loss_pred:0.02621186524629593, decouple_loss:0.008158314041793346The modified gen p mean: 0.4548364281654358, gen p mean: 0.0, mean p set: 0.4487698972225189
loss_pred:0.02703714370727539, decouple_loss:0.00840645283460617
Iteration: 513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4589339792728424, gen p mean: 0.0, mean p set: 0.45175716280937195
The modified gen p mean: 0.45584604144096375, gen p mean: 0.0, mean p set: 0.45031872391700745
loss_pred:0.026848867535591125, decouple_loss:0.008462824858725071
loss_pred:0.02622929774224758, decouple_loss:0.008253480307757854The modified gen p mean: 0.45685189962387085, gen p mean: 0.0, mean p set: 0.4487225413322449
loss_pred:0.02589874342083931, decouple_loss:0.008631369099020958
Iteration: 514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454193115234375, gen p mean: 0.0, mean p set: 0.45033547282218933
The modified gen p mean: 0.45389389991760254, gen p mean: 0.0, mean p set: 0.4514269232749939
loss_pred:0.02636663056910038, decouple_loss:0.008813126012682915
The modified gen p mean: 0.4497357904911041, gen p mean: 0.0, mean p set: 0.45081597566604614loss_pred:0.026344535872340202, decouple_loss:0.008044145070016384
loss_pred:0.025779269635677338, decouple_loss:0.008209973573684692
Iteration: 515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468195140361786, gen p mean: 0.0, mean p set: 0.4500750005245209
The modified gen p mean: 0.4512169063091278, gen p mean: 0.0, mean p set: 0.44870832562446594
loss_pred:0.026218414306640625, decouple_loss:0.007963054813444614
loss_pred:0.027156075462698936, decouple_loss:0.008117638528347015The modified gen p mean: 0.44850876927375793, gen p mean: 0.0, mean p set: 0.4506531357765198
loss_pred:0.02597714774310589, decouple_loss:0.007669622544199228
Iteration: 516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44578537344932556, gen p mean: 0.0, mean p set: 0.44931429624557495
loss_pred:0.027165450155735016, decouple_loss:0.008014672435820103
The modified gen p mean: 0.44140589237213135, gen p mean: 0.0, mean p set: 0.45067667961120605
The modified gen p mean: 0.4451547861099243, gen p mean: 0.0, mean p set: 0.4506286382675171
loss_pred:0.025242377072572708, decouple_loss:0.007856386713683605
loss_pred:0.02545998804271221, decouple_loss:0.007815564051270485
Iteration: 517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45342183113098145, gen p mean: 0.0, mean p set: 0.44908347725868225
The modified gen p mean: 0.4453546106815338, gen p mean: 0.0, mean p set: 0.4507039785385132
loss_pred:0.025730561465024948, decouple_loss:0.007866231724619865
loss_pred:0.025853397324681282, decouple_loss:0.007759070489555597
The modified gen p mean: 0.4488869607448578, gen p mean: 0.0, mean p set: 0.44937488436698914
loss_pred:0.02613772451877594, decouple_loss:0.007682120427489281
Iteration: 518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45428070425987244, gen p mean: 0.0, mean p set: 0.4493492543697357
loss_pred:0.026418471708893776, decouple_loss:0.008058018051087856
The modified gen p mean: 0.45658373832702637, gen p mean: 0.0, mean p set: 0.4508443772792816
The modified gen p mean: 0.46117275953292847, gen p mean: 0.0, mean p set: 0.4508165121078491
loss_pred:0.02569921687245369, decouple_loss:0.007791405543684959
loss_pred:0.025750543922185898, decouple_loss:0.007859253324568272
Iteration: 519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44202595949172974, gen p mean: 0.0, mean p set: 0.4503578245639801
loss_pred:0.02653518319129944, decouple_loss:0.008154597133398056
The modified gen p mean: 0.4456733763217926, gen p mean: 0.0, mean p set: 0.44983693957328796
The modified gen p mean: 0.4484184682369232, gen p mean: 0.0, mean p set: 0.4488380551338196
loss_pred:0.026202276349067688, decouple_loss:0.007961422204971313
loss_pred:0.026609288528561592, decouple_loss:0.008042155764997005
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
NaN value num: 0
Iteration: 520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512152373790741, gen p mean: 0.0, mean p set: 0.4531055986881256
The modified gen p mean: 0.44984954595565796, gen p mean: 0.0, mean p set: 0.4516338109970093
loss_pred:0.026396777480840683, decouple_loss:0.007979955524206161
The modified gen p mean: 0.4516158401966095, gen p mean: 0.0, mean p set: 0.45172739028930664
loss_pred:0.026422817260026932, decouple_loss:0.008290649391710758
loss_pred:0.026048563420772552, decouple_loss:0.0079950001090765
2023-05-04 13:37:00 testing...
The modified gen p mean: 0.4427197277545929, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4482811987400055, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45099788904190063, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.027688441798090935, decouple_loss:0.008364751935005188
loss_pred:0.02656554989516735, decouple_loss:0.008132578805088997
loss_pred:0.026135893538594246, decouple_loss:0.008314670994877815
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027210161089897156, avg_mse: 0.03270344063639641
current test mse: 0.032703
Iteration: 521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.454263836145401, gen p mean: 0.0, mean p set: 0.45089107751846313
The modified gen p mean: 0.44872334599494934, gen p mean: 0.0, mean p set: 0.4514986276626587
loss_pred:0.026315653696656227, decouple_loss:0.007768659386783838
loss_pred:0.026492232456803322, decouple_loss:0.00835326686501503
The modified gen p mean: 0.44821998476982117, gen p mean: 0.0, mean p set: 0.4527551829814911
loss_pred:0.02689339593052864, decouple_loss:0.008247495628893375
Iteration: 522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45136773586273193, gen p mean: 0.0, mean p set: 0.4523775279521942
The modified gen p mean: 0.4516846537590027, gen p mean: 0.0, mean p set: 0.4518711566925049
loss_pred:0.02622470259666443, decouple_loss:0.00813539233058691
loss_pred:0.02617224119603634, decouple_loss:0.008190294727683067The modified gen p mean: 0.45573756098747253, gen p mean: 0.0, mean p set: 0.45412078499794006
loss_pred:0.026506278663873672, decouple_loss:0.008275357075035572
Iteration: 523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473942816257477, gen p mean: 0.0, mean p set: 0.45321789383888245
The modified gen p mean: 0.45132380723953247, gen p mean: 0.0, mean p set: 0.45189008116722107loss_pred:0.026266098022460938, decouple_loss:0.00818327534943819
The modified gen p mean: 0.4537303149700165, gen p mean: 0.0, mean p set: 0.45124828815460205
loss_pred:0.026392262428998947, decouple_loss:0.007875196635723114
loss_pred:0.026335854083299637, decouple_loss:0.008127683773636818
Iteration: 524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45328405499458313, gen p mean: 0.0, mean p set: 0.4520549178123474
The modified gen p mean: 0.45151206851005554, gen p mean: 0.0, mean p set: 0.4507158100605011
loss_pred:0.027589766308665276, decouple_loss:0.00790321733802557
loss_pred:0.025290710851550102, decouple_loss:0.008013870567083359The modified gen p mean: 0.44928476214408875, gen p mean: 0.0, mean p set: 0.4522334337234497
loss_pred:0.02597900852560997, decouple_loss:0.007890543900430202
Iteration: 525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510934352874756, gen p mean: 0.0, mean p set: 0.452862411737442
loss_pred:0.026107916608452797, decouple_loss:0.007937762886285782
The modified gen p mean: 0.4530048370361328, gen p mean: 0.0, mean p set: 0.4530409872531891
The modified gen p mean: 0.4555101692676544, gen p mean: 0.0, mean p set: 0.45181846618652344
loss_pred:0.02665577083826065, decouple_loss:0.007914657704532146
loss_pred:0.025662310421466827, decouple_loss:0.007937469519674778
Iteration: 526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4611733555793762, gen p mean: 0.0, mean p set: 0.451375812292099
loss_pred:0.026997603476047516, decouple_loss:0.007839991711080074
The modified gen p mean: 0.4637128412723541, gen p mean: 0.0, mean p set: 0.4535618722438812
The modified gen p mean: 0.4544416666030884, gen p mean: 0.0, mean p set: 0.4518677592277527
loss_pred:0.02612457051873207, decouple_loss:0.007704396266490221
loss_pred:0.025598838925361633, decouple_loss:0.007730690762400627
Iteration: 527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683516025543213, gen p mean: 0.0, mean p set: 0.45285117626190186
The modified gen p mean: 0.45416149497032166, gen p mean: 0.0, mean p set: 0.45309609174728394
loss_pred:0.026544613763689995, decouple_loss:0.007929841056466103
loss_pred:0.02677777037024498, decouple_loss:0.007858945988118649The modified gen p mean: 0.44757628440856934, gen p mean: 0.0, mean p set: 0.4513013958930969
loss_pred:0.02574083022773266, decouple_loss:0.007918698713183403
Iteration: 528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451269507408142, gen p mean: 0.0, mean p set: 0.45170727372169495
The modified gen p mean: 0.44579198956489563, gen p mean: 0.0, mean p set: 0.45344221591949463
loss_pred:0.025085454806685448, decouple_loss:0.007640393450856209
loss_pred:0.02693345583975315, decouple_loss:0.00787820853292942The modified gen p mean: 0.44734030961990356, gen p mean: 0.0, mean p set: 0.4534555673599243
loss_pred:0.02636159025132656, decouple_loss:0.007650890853255987
Iteration: 529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458804726600647, gen p mean: 0.0, mean p set: 0.4519580900669098
loss_pred:0.026531212031841278, decouple_loss:0.007911866530776024
The modified gen p mean: 0.4574708640575409, gen p mean: 0.0, mean p set: 0.45315417647361755
The modified gen p mean: 0.45105046033859253, gen p mean: 0.0, mean p set: 0.4510918855667114
loss_pred:0.026132186874747276, decouple_loss:0.00790553167462349
loss_pred:0.02548547275364399, decouple_loss:0.007796617224812508
Iteration: 530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446088582277298, gen p mean: 0.0, mean p set: 0.4529340863227844
loss_pred:0.02659456804394722, decouple_loss:0.00820312649011612
The modified gen p mean: 0.4468390643596649, gen p mean: 0.0, mean p set: 0.45258164405822754
The modified gen p mean: 0.44448673725128174, gen p mean: 0.0, mean p set: 0.4528955817222595
loss_pred:0.026455745100975037, decouple_loss:0.008132068440318108
loss_pred:0.02647647075355053, decouple_loss:0.00811221543699503
2023-05-04 13:40:33 testing...
The modified gen p mean: 0.45111167430877686, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45754286646842957, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4604944884777069, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.027638064697384834, decouple_loss:0.008842897601425648
loss_pred:0.026541290804743767, decouple_loss:0.008533596061170101
loss_pred:0.026238489896059036, decouple_loss:0.008650155737996101
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027239728718996048, avg_mse: 0.03284608945250511
current test mse: 0.032846
Iteration: 531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4581355154514313, gen p mean: 0.0, mean p set: 0.45237478613853455
The modified gen p mean: 0.4581666588783264, gen p mean: 0.0, mean p set: 0.4507977068424225
loss_pred:0.027086567133665085, decouple_loss:0.007909437641501427
loss_pred:0.02590268664062023, decouple_loss:0.00813341699540615
The modified gen p mean: 0.46091482043266296, gen p mean: 0.0, mean p set: 0.45143428444862366
loss_pred:0.02498704567551613, decouple_loss:0.007785791996866465
Iteration: 532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46293744444847107, gen p mean: 0.0, mean p set: 0.45151615142822266
loss_pred:0.025717558339238167, decouple_loss:0.007973912172019482
The modified gen p mean: 0.45548999309539795, gen p mean: 0.0, mean p set: 0.45191919803619385
The modified gen p mean: 0.46308621764183044, gen p mean: 0.0, mean p set: 0.45299410820007324
loss_pred:0.02647290751338005, decouple_loss:0.008119518868625164
loss_pred:0.02559339441359043, decouple_loss:0.008092249743640423
Iteration: 533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451266348361969, gen p mean: 0.0, mean p set: 0.4525703489780426
The modified gen p mean: 0.4526800215244293, gen p mean: 0.0, mean p set: 0.4536671042442322
loss_pred:0.02564874105155468, decouple_loss:0.0074732122011482716
The modified gen p mean: 0.45221754908561707, gen p mean: 0.0, mean p set: 0.45142796635627747loss_pred:0.025724362581968307, decouple_loss:0.007500357460230589
loss_pred:0.025444643571972847, decouple_loss:0.007551364600658417
Iteration: 534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460048973560333, gen p mean: 0.0, mean p set: 0.45390620827674866
loss_pred:0.026972593739628792, decouple_loss:0.00743607385084033
The modified gen p mean: 0.4434911012649536, gen p mean: 0.0, mean p set: 0.4525795578956604
The modified gen p mean: 0.44553589820861816, gen p mean: 0.0, mean p set: 0.45381149649620056
loss_pred:0.026646144688129425, decouple_loss:0.007367367390543222
loss_pred:0.026778031140565872, decouple_loss:0.007442540023475885
Iteration: 535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4450477063655853, gen p mean: 0.0, mean p set: 0.4526018798351288
The modified gen p mean: 0.44983649253845215, gen p mean: 0.0, mean p set: 0.45254209637641907
loss_pred:0.026280477643013, decouple_loss:0.0078097120858728886
loss_pred:0.026681974530220032, decouple_loss:0.007577355485409498The modified gen p mean: 0.4511687457561493, gen p mean: 0.0, mean p set: 0.45360562205314636
loss_pred:0.027007341384887695, decouple_loss:0.007706295233219862
Iteration: 536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452654719352722, gen p mean: 0.0, mean p set: 0.4526480436325073
The modified gen p mean: 0.45087289810180664, gen p mean: 0.0, mean p set: 0.4532724618911743
loss_pred:0.02629479020833969, decouple_loss:0.007337402552366257
loss_pred:0.026742061600089073, decouple_loss:0.007330446969717741
The modified gen p mean: 0.4497049152851105, gen p mean: 0.0, mean p set: 0.4515622556209564
loss_pred:0.02647596038877964, decouple_loss:0.007453657686710358
Iteration: 537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526864290237427, gen p mean: 0.0, mean p set: 0.45368802547454834
The modified gen p mean: 0.4547373950481415, gen p mean: 0.0, mean p set: 0.4536888301372528
loss_pred:0.026944532990455627, decouple_loss:0.008321710862219334
loss_pred:0.027185380458831787, decouple_loss:0.008062428794801235
The modified gen p mean: 0.4598250091075897, gen p mean: 0.0, mean p set: 0.4517892897129059
loss_pred:0.0256017055362463, decouple_loss:0.0077494424767792225
Iteration: 538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.466574102640152, gen p mean: 0.0, mean p set: 0.45300236344337463
loss_pred:0.02616526558995247, decouple_loss:0.007571129593998194
The modified gen p mean: 0.4609169065952301, gen p mean: 0.0, mean p set: 0.45228198170661926
The modified gen p mean: 0.46061673760414124, gen p mean: 0.0, mean p set: 0.45124077796936035
loss_pred:0.02504831925034523, decouple_loss:0.007649608422070742
loss_pred:0.026897095143795013, decouple_loss:0.007867810316383839
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
NaN value num: 0
Iteration: 539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4405110776424408, gen p mean: 0.0, mean p set: 0.448152095079422
The modified gen p mean: 0.43176427483558655, gen p mean: 0.0, mean p set: 0.4488895833492279
loss_pred:0.02730138972401619, decouple_loss:0.009298436343669891
The modified gen p mean: 0.4380832016468048, gen p mean: 0.0, mean p set: 0.44663766026496887
loss_pred:0.02658444084227085, decouple_loss:0.008625101298093796
loss_pred:0.02649649977684021, decouple_loss:0.008847970515489578
Iteration: 540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464174807071686, gen p mean: 0.0, mean p set: 0.44788476824760437
loss_pred:0.025470474734902382, decouple_loss:0.008716132491827011
The modified gen p mean: 0.4494401514530182, gen p mean: 0.0, mean p set: 0.4477405250072479
The modified gen p mean: 0.450857937335968, gen p mean: 0.0, mean p set: 0.44805875420570374
loss_pred:0.026248672977089882, decouple_loss:0.008256123401224613
loss_pred:0.026371272280812263, decouple_loss:0.008319691754877567
2023-05-04 13:44:43 testing...
The modified gen p mean: 0.44533097743988037, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4510878324508667, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45381203293800354, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.027565686032176018, decouple_loss:0.008653930388391018
loss_pred:0.02650141529738903, decouple_loss:0.008458287455141544
loss_pred:0.02611570805311203, decouple_loss:0.008551801554858685
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02715533785521984, avg_mse: 0.032688580453395844
current test mse: 0.032689
Iteration: 541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45020416378974915, gen p mean: 0.0, mean p set: 0.44719216227531433
loss_pred:0.02589241974055767, decouple_loss:0.008318141102790833
The modified gen p mean: 0.44983744621276855, gen p mean: 0.0, mean p set: 0.44820359349250793
loss_pred:0.026304228231310844, decouple_loss:0.00816365797072649
The modified gen p mean: 0.4435744285583496, gen p mean: 0.0, mean p set: 0.447569340467453
loss_pred:0.02678726799786091, decouple_loss:0.008846975862979889
Iteration: 542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45213115215301514, gen p mean: 0.0, mean p set: 0.44742998480796814
The modified gen p mean: 0.45123711228370667, gen p mean: 0.0, mean p set: 0.4477180242538452
loss_pred:0.02856128290295601, decouple_loss:0.00866714771836996
loss_pred:0.028131786733865738, decouple_loss:0.008275379426777363
The modified gen p mean: 0.44653189182281494, gen p mean: 0.0, mean p set: 0.4468752145767212
loss_pred:0.02601412869989872, decouple_loss:0.008346839807927608
Iteration: 543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471905529499054, gen p mean: 0.0, mean p set: 0.44670340418815613
The modified gen p mean: 0.4446420669555664, gen p mean: 0.0, mean p set: 0.44742920994758606
loss_pred:0.025746310129761696, decouple_loss:0.008238989859819412
loss_pred:0.026507027447223663, decouple_loss:0.00853075459599495The modified gen p mean: 0.45000821352005005, gen p mean: 0.0, mean p set: 0.4468367099761963
loss_pred:0.026477647945284843, decouple_loss:0.008583824150264263
Iteration: 544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4412914216518402, gen p mean: 0.0, mean p set: 0.44834375381469727The modified gen p mean: 0.4399418234825134, gen p mean: 0.0, mean p set: 0.44606053829193115
loss_pred:0.028102995827794075, decouple_loss:0.008555548265576363
loss_pred:0.025128699839115143, decouple_loss:0.00811207015067339
The modified gen p mean: 0.4436648190021515, gen p mean: 0.0, mean p set: 0.44762900471687317
loss_pred:0.025824086740612984, decouple_loss:0.008433687500655651
Iteration: 545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4414214789867401, gen p mean: 0.0, mean p set: 0.44780099391937256
loss_pred:0.025906190276145935, decouple_loss:0.008060835301876068
The modified gen p mean: 0.4394034147262573, gen p mean: 0.0, mean p set: 0.44701457023620605
The modified gen p mean: 0.43610501289367676, gen p mean: 0.0, mean p set: 0.44709208607673645
loss_pred:0.02636740729212761, decouple_loss:0.008136200718581676
loss_pred:0.02630208432674408, decouple_loss:0.008308054879307747
Iteration: 546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.456190824508667, gen p mean: 0.0, mean p set: 0.44723597168922424
The modified gen p mean: 0.456106036901474, gen p mean: 0.0, mean p set: 0.4477160573005676
loss_pred:0.026328682899475098, decouple_loss:0.0080134067684412
loss_pred:0.025931205600500107, decouple_loss:0.007859708741307259The modified gen p mean: 0.46063387393951416, gen p mean: 0.0, mean p set: 0.4480101466178894
loss_pred:0.026176417246460915, decouple_loss:0.007909790612757206
Iteration: 547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535134434700012, gen p mean: 0.0, mean p set: 0.4481947124004364
loss_pred:0.02727465331554413, decouple_loss:0.007839451543986797
The modified gen p mean: 0.4473005533218384, gen p mean: 0.0, mean p set: 0.4475148916244507
The modified gen p mean: 0.4524116814136505, gen p mean: 0.0, mean p set: 0.44783106446266174
loss_pred:0.02585599385201931, decouple_loss:0.007950992323458195
loss_pred:0.0257710050791502, decouple_loss:0.008073665201663971
Iteration: 548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457055330276489, gen p mean: 0.0, mean p set: 0.44807007908821106
The modified gen p mean: 0.4408762753009796, gen p mean: 0.0, mean p set: 0.448160856962204
loss_pred:0.026350950822234154, decouple_loss:0.007479280233383179
loss_pred:0.026367375627160072, decouple_loss:0.007614528760313988
The modified gen p mean: 0.440070241689682, gen p mean: 0.0, mean p set: 0.44769227504730225
loss_pred:0.025722073391079903, decouple_loss:0.007852992042899132
Iteration: 549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460708498954773, gen p mean: 0.0, mean p set: 0.4461626410484314
The modified gen p mean: 0.4494779109954834, gen p mean: 0.0, mean p set: 0.4464336037635803
loss_pred:0.02506645955145359, decouple_loss:0.007830379530787468
loss_pred:0.02629910409450531, decouple_loss:0.007790848612785339
The modified gen p mean: 0.4493388235569, gen p mean: 0.0, mean p set: 0.44779494404792786
loss_pred:0.02645610086619854, decouple_loss:0.00770945381373167
Iteration: 550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460456967353821, gen p mean: 0.0, mean p set: 0.4466695487499237
loss_pred:0.026340872049331665, decouple_loss:0.007691819220781326
The modified gen p mean: 0.44322699308395386, gen p mean: 0.0, mean p set: 0.448373407125473
The modified gen p mean: 0.4488588571548462, gen p mean: 0.0, mean p set: 0.44765612483024597
loss_pred:0.026131916791200638, decouple_loss:0.007578985765576363
loss_pred:0.026723263785243034, decouple_loss:0.007829401642084122
2023-05-04 13:48:19 testing...
The modified gen p mean: 0.43653377890586853, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44186073541641235, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4444196820259094, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.027625076472759247, decouple_loss:0.007962756790220737
loss_pred:0.02647516131401062, decouple_loss:0.00787949375808239
loss_pred:0.026219181716442108, decouple_loss:0.007956376299262047
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027169784530997276, avg_mse: 0.03286272659897804
current test mse: 0.032863
Iteration: 551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43852147459983826, gen p mean: 0.0, mean p set: 0.4478742182254791
The modified gen p mean: 0.4372965097427368, gen p mean: 0.0, mean p set: 0.4476166069507599
loss_pred:0.0271696038544178, decouple_loss:0.008070328272879124
loss_pred:0.026025714352726936, decouple_loss:0.007583978120237589
The modified gen p mean: 0.44431599974632263, gen p mean: 0.0, mean p set: 0.44803011417388916
loss_pred:0.027955757454037666, decouple_loss:0.00800538994371891
Iteration: 552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45056676864624023, gen p mean: 0.0, mean p set: 0.44808676838874817
The modified gen p mean: 0.4516415596008301, gen p mean: 0.0, mean p set: 0.4478749632835388
loss_pred:0.025542819872498512, decouple_loss:0.007656069938093424
loss_pred:0.025786973536014557, decouple_loss:0.007634994573891163The modified gen p mean: 0.4515314996242523, gen p mean: 0.0, mean p set: 0.44762122631073
loss_pred:0.026218600571155548, decouple_loss:0.0077895610593259335
Iteration: 553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45541051030158997, gen p mean: 0.0, mean p set: 0.44746798276901245
The modified gen p mean: 0.4465068280696869, gen p mean: 0.0, mean p set: 0.44990822672843933
loss_pred:0.0258916225284338, decouple_loss:0.0073562865145504475
loss_pred:0.026247872039675713, decouple_loss:0.008792603388428688The modified gen p mean: 0.4489150941371918, gen p mean: 0.0, mean p set: 0.44953420758247375
loss_pred:0.026451630517840385, decouple_loss:0.008685915730893612
Iteration: 554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45568960905075073, gen p mean: 0.0, mean p set: 0.4489504396915436
The modified gen p mean: 0.45275381207466125, gen p mean: 0.0, mean p set: 0.44777578115463257
loss_pred:0.02691728249192238, decouple_loss:0.00725666806101799
loss_pred:0.025564689189195633, decouple_loss:0.00752362422645092The modified gen p mean: 0.4532075822353363, gen p mean: 0.0, mean p set: 0.4477635622024536
loss_pred:0.025898747146129608, decouple_loss:0.007536190561950207
Iteration: 555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459858238697052, gen p mean: 0.0, mean p set: 0.4478749930858612
loss_pred:0.02602440118789673, decouple_loss:0.0074010384269058704
The modified gen p mean: 0.4393012225627899, gen p mean: 0.0, mean p set: 0.44729119539260864
The modified gen p mean: 0.44597703218460083, gen p mean: 0.0, mean p set: 0.4478980302810669
loss_pred:0.025551622733473778, decouple_loss:0.007511843927204609
loss_pred:0.02555902861058712, decouple_loss:0.007456559222191572
Iteration: 556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43927133083343506, gen p mean: 0.0, mean p set: 0.4474208950996399
The modified gen p mean: 0.4502596855163574, gen p mean: 0.0, mean p set: 0.4485294818878174
loss_pred:0.02607840485870838, decouple_loss:0.00725916912779212
loss_pred:0.02716974914073944, decouple_loss:0.0071678971871733665The modified gen p mean: 0.44534653425216675, gen p mean: 0.0, mean p set: 0.4474751055240631
loss_pred:0.025262268260121346, decouple_loss:0.007160598412156105
Iteration: 557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4362037181854248, gen p mean: 0.0, mean p set: 0.44896718859672546
The modified gen p mean: 0.4512137174606323, gen p mean: 0.0, mean p set: 0.447546124458313
loss_pred:0.026008063927292824, decouple_loss:0.007926052436232567
loss_pred:0.02752913162112236, decouple_loss:0.00725781824439764
The modified gen p mean: 0.4467337131500244, gen p mean: 0.0, mean p set: 0.4469371736049652
loss_pred:0.025671932846307755, decouple_loss:0.007296392694115639
Iteration: 558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45218631625175476, gen p mean: 0.0, mean p set: 0.4466399550437927
The modified gen p mean: 0.4506899118423462, gen p mean: 0.0, mean p set: 0.44699984788894653
loss_pred:0.026258215308189392, decouple_loss:0.007397384382784367
loss_pred:0.02624368667602539, decouple_loss:0.007283971644937992The modified gen p mean: 0.4518797695636749, gen p mean: 0.0, mean p set: 0.44820722937583923
loss_pred:0.027002742514014244, decouple_loss:0.007312302011996508
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510267674922943, gen p mean: 0.0, mean p set: 0.44948315620422363
The modified gen p mean: 0.4464714825153351, gen p mean: 0.0, mean p set: 0.4487197697162628
The modified gen p mean: 0.44978955388069153, gen p mean: 0.0, mean p set: 0.44866541028022766loss_pred:0.026214970275759697, decouple_loss:0.008574265986680984
loss_pred:0.02655237354338169, decouple_loss:0.007644566707313061
loss_pred:0.02648976631462574, decouple_loss:0.007530748378485441
Iteration: 560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475412964820862, gen p mean: 0.0, mean p set: 0.44841745495796204
loss_pred:0.02542702667415142, decouple_loss:0.007894682697951794
The modified gen p mean: 0.44596853852272034, gen p mean: 0.0, mean p set: 0.4506722390651703
The modified gen p mean: 0.44593045115470886, gen p mean: 0.0, mean p set: 0.447760671377182
loss_pred:0.026714418083429337, decouple_loss:0.007384355645626783
loss_pred:0.026516752317547798, decouple_loss:0.007635686080902815
2023-05-04 13:52:30 testing...
The modified gen p mean: 0.4338260293006897, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.441988468170166, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.43983760476112366, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.027438659220933914, decouple_loss:0.007660053204745054
loss_pred:0.026001663878560066, decouple_loss:0.007565658539533615
loss_pred:0.026288097724318504, decouple_loss:0.00749493483453989
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02695482037961483, avg_mse: 0.032582275569438934
current test mse: 0.032582
Iteration: 561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4413132965564728, gen p mean: 0.0, mean p set: 0.4495809078216553
The modified gen p mean: 0.4340204894542694, gen p mean: 0.0, mean p set: 0.4493098258972168
loss_pred:0.026662001386284828, decouple_loss:0.007581586949527264
loss_pred:0.02528957463800907, decouple_loss:0.008143564686179161
The modified gen p mean: 0.43967100977897644, gen p mean: 0.0, mean p set: 0.44985491037368774
loss_pred:0.026366250589489937, decouple_loss:0.007440553046762943
Iteration: 562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505968689918518, gen p mean: 0.0, mean p set: 0.44741183519363403
loss_pred:0.025297105312347412, decouple_loss:0.007602280471473932
The modified gen p mean: 0.4494231939315796, gen p mean: 0.0, mean p set: 0.4491964280605316
The modified gen p mean: 0.4560260772705078, gen p mean: 0.0, mean p set: 0.44823670387268066
loss_pred:0.025738460943102837, decouple_loss:0.007541163358837366
loss_pred:0.02527809701859951, decouple_loss:0.007817530073225498
Iteration: 563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45056015253067017, gen p mean: 0.0, mean p set: 0.4481406807899475
The modified gen p mean: 0.45700621604919434, gen p mean: 0.0, mean p set: 0.4469376802444458
loss_pred:0.02566962130367756, decouple_loss:0.008488141000270844
loss_pred:0.02642371505498886, decouple_loss:0.007646323647350073The modified gen p mean: 0.45148608088493347, gen p mean: 0.0, mean p set: 0.4473493695259094
loss_pred:0.025943713262677193, decouple_loss:0.007723326329141855
Iteration: 564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849082827568054, gen p mean: 0.0, mean p set: 0.4493577182292938
loss_pred:0.024758055806159973, decouple_loss:0.008215793408453465
The modified gen p mean: 0.45697930455207825, gen p mean: 0.0, mean p set: 0.44976967573165894
The modified gen p mean: 0.45549750328063965, gen p mean: 0.0, mean p set: 0.4488963484764099
loss_pred:0.02613280899822712, decouple_loss:0.008075123652815819
loss_pred:0.025811702013015747, decouple_loss:0.00748662743717432
Iteration: 565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459485113620758, gen p mean: 0.0, mean p set: 0.44878509640693665
The modified gen p mean: 0.44787096977233887, gen p mean: 0.0, mean p set: 0.4476757347583771
loss_pred:0.025735093280673027, decouple_loss:0.008406191132962704
The modified gen p mean: 0.44728052616119385, gen p mean: 0.0, mean p set: 0.4468816816806793loss_pred:0.025466125458478928, decouple_loss:0.00744748767465353
loss_pred:0.02633276954293251, decouple_loss:0.008617079816758633
Iteration: 566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44300779700279236, gen p mean: 0.0, mean p set: 0.45020049810409546
The modified gen p mean: 0.4427998661994934, gen p mean: 0.0, mean p set: 0.4493766129016876
loss_pred:0.026024430990219116, decouple_loss:0.007507889531552792
loss_pred:0.02661960758268833, decouple_loss:0.007768690120428801The modified gen p mean: 0.4370814859867096, gen p mean: 0.0, mean p set: 0.4497106075286865
loss_pred:0.025566544383764267, decouple_loss:0.0077202096581459045
Iteration: 567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.443591833114624, gen p mean: 0.0, mean p set: 0.4487130343914032
The modified gen p mean: 0.44557175040245056, gen p mean: 0.0, mean p set: 0.449078768491745
loss_pred:0.025563765317201614, decouple_loss:0.00749976234510541
loss_pred:0.025604790076613426, decouple_loss:0.007211070973426104
The modified gen p mean: 0.4488697648048401, gen p mean: 0.0, mean p set: 0.4478890001773834
loss_pred:0.025748537853360176, decouple_loss:0.007636408321559429
Iteration: 568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45769110321998596, gen p mean: 0.0, mean p set: 0.44924619793891907
loss_pred:0.026021013036370277, decouple_loss:0.007306462153792381
The modified gen p mean: 0.45961105823516846, gen p mean: 0.0, mean p set: 0.44784975051879883
The modified gen p mean: 0.4548979103565216, gen p mean: 0.0, mean p set: 0.44709157943725586
loss_pred:0.025334512814879417, decouple_loss:0.007299189455807209
loss_pred:0.02508859895169735, decouple_loss:0.00748564163222909
Iteration: 569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451117217540741, gen p mean: 0.0, mean p set: 0.44798991084098816
loss_pred:0.024822650477290154, decouple_loss:0.007537739351391792
The modified gen p mean: 0.4472217559814453, gen p mean: 0.0, mean p set: 0.44753846526145935
The modified gen p mean: 0.450181245803833, gen p mean: 0.0, mean p set: 0.4464992880821228
loss_pred:0.027105754241347313, decouple_loss:0.0074039027094841
loss_pred:0.026043543592095375, decouple_loss:0.007369582075625658
Iteration: 570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44366809725761414, gen p mean: 0.0, mean p set: 0.4476434886455536
The modified gen p mean: 0.4406892955303192, gen p mean: 0.0, mean p set: 0.44880014657974243loss_pred:0.025454552844166756, decouple_loss:0.007182023022323847
The modified gen p mean: 0.4426405429840088, gen p mean: 0.0, mean p set: 0.44741132855415344
loss_pred:0.024792112410068512, decouple_loss:0.00708437105640769
loss_pred:0.02601569890975952, decouple_loss:0.00839072372764349
2023-05-04 13:56:05 testing...
The modified gen p mean: 0.44200459122657776, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4476914703845978, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4496472477912903, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.027182240039110184, decouple_loss:0.007477819453924894
loss_pred:0.026012837886810303, decouple_loss:0.007264857180416584
loss_pred:0.025754736736416817, decouple_loss:0.007400527596473694
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02668565884232521, avg_mse: 0.032242171466350555
current test mse: 0.032242
Iteration: 571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45199480652809143, gen p mean: 0.0, mean p set: 0.44838523864746094
The modified gen p mean: 0.45026785135269165, gen p mean: 0.0, mean p set: 0.4505167305469513
loss_pred:0.026812581345438957, decouple_loss:0.007306648418307304
loss_pred:0.026247117668390274, decouple_loss:0.007112628780305386
The modified gen p mean: 0.44992220401763916, gen p mean: 0.0, mean p set: 0.44969815015792847
loss_pred:0.025928635150194168, decouple_loss:0.007110884413123131
Iteration: 572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455873370170593, gen p mean: 0.0, mean p set: 0.44924888014793396
loss_pred:0.026573317125439644, decouple_loss:0.0075623937882483006
The modified gen p mean: 0.4512821137905121, gen p mean: 0.0, mean p set: 0.44782590866088867
The modified gen p mean: 0.4447111487388611, gen p mean: 0.0, mean p set: 0.4483746588230133
loss_pred:0.02577311359345913, decouple_loss:0.007959463633596897
loss_pred:0.026782428845763206, decouple_loss:0.007142937742173672
Iteration: 573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480934143066406, gen p mean: 0.0, mean p set: 0.44752633571624756
The modified gen p mean: 0.45137321949005127, gen p mean: 0.0, mean p set: 0.44950512051582336
loss_pred:0.02435620315372944, decouple_loss:0.00733973691239953
loss_pred:0.025606870651245117, decouple_loss:0.007311394438147545The modified gen p mean: 0.444416344165802, gen p mean: 0.0, mean p set: 0.44863414764404297
loss_pred:0.02478172443807125, decouple_loss:0.0070910085923969746
Iteration: 574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488721489906311, gen p mean: 0.0, mean p set: 0.4481384754180908
The modified gen p mean: 0.44625604152679443, gen p mean: 0.0, mean p set: 0.4496791362762451
loss_pred:0.02492508664727211, decouple_loss:0.007287928368896246
The modified gen p mean: 0.4522104263305664, gen p mean: 0.0, mean p set: 0.44906049966812134
loss_pred:0.025392459705471992, decouple_loss:0.007352897431701422
loss_pred:0.025487961247563362, decouple_loss:0.007201068568974733
Iteration: 575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452453553676605, gen p mean: 0.0, mean p set: 0.4487580358982086
loss_pred:0.024493854492902756, decouple_loss:0.006996021140366793
The modified gen p mean: 0.44502168893814087, gen p mean: 0.0, mean p set: 0.4493320882320404
The modified gen p mean: 0.4441905617713928, gen p mean: 0.0, mean p set: 0.4485096037387848
loss_pred:0.02566174603998661, decouple_loss:0.007947703823447227
loss_pred:0.025675106793642044, decouple_loss:0.007524642162024975
Iteration: 576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4559076428413391, gen p mean: 0.0, mean p set: 0.44842419028282166
The modified gen p mean: 0.45849695801734924, gen p mean: 0.0, mean p set: 0.4483111500740051
loss_pred:0.02546675130724907, decouple_loss:0.0071553075686097145
The modified gen p mean: 0.4561106860637665, gen p mean: 0.0, mean p set: 0.4498105049133301loss_pred:0.02613934315741062, decouple_loss:0.007761080749332905
loss_pred:0.025599580258131027, decouple_loss:0.00698158610612154
Iteration: 577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532634913921356, gen p mean: 0.0, mean p set: 0.4477404057979584
The modified gen p mean: 0.45430245995521545, gen p mean: 0.0, mean p set: 0.4466628134250641
loss_pred:0.02564311772584915, decouple_loss:0.0078091067261993885
loss_pred:0.026422834023833275, decouple_loss:0.007022519130259752The modified gen p mean: 0.4523598253726959, gen p mean: 0.0, mean p set: 0.44749414920806885
loss_pred:0.02604830265045166, decouple_loss:0.00792143028229475
Iteration: 578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43831396102905273, gen p mean: 0.0, mean p set: 0.44786572456359863
loss_pred:0.02505539543926716, decouple_loss:0.007203605957329273
The modified gen p mean: 0.43667373061180115, gen p mean: 0.0, mean p set: 0.4477921724319458
The modified gen p mean: 0.43903085589408875, gen p mean: 0.0, mean p set: 0.4479677379131317
loss_pred:0.02460978552699089, decouple_loss:0.007095198146998882
loss_pred:0.025125237181782722, decouple_loss:0.007550007663667202
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
NaN value num: 0
Iteration: 579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4340763986110687, gen p mean: 0.0, mean p set: 0.4504474103450775
The modified gen p mean: 0.44395703077316284, gen p mean: 0.0, mean p set: 0.4512324035167694
The modified gen p mean: 0.43928587436676025, gen p mean: 0.0, mean p set: 0.4519873261451721
loss_pred:0.025109414011240005, decouple_loss:0.008351314812898636
loss_pred:0.026216736063361168, decouple_loss:0.007836735807359219
loss_pred:0.025236982852220535, decouple_loss:0.008016077801585197
Iteration: 580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45975297689437866, gen p mean: 0.0, mean p set: 0.4533640444278717
The modified gen p mean: 0.46392616629600525, gen p mean: 0.0, mean p set: 0.45075374841690063
loss_pred:0.024854958057403564, decouple_loss:0.008436116389930248
loss_pred:0.026222964748740196, decouple_loss:0.007996880449354649
The modified gen p mean: 0.46427011489868164, gen p mean: 0.0, mean p set: 0.4501752555370331
loss_pred:0.02568626031279564, decouple_loss:0.008057814091444016
2023-05-04 14:00:20 testing...
The modified gen p mean: 0.44841235876083374, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45426443219184875, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4559405446052551, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02708728425204754, decouple_loss:0.00765447411686182
loss_pred:0.02603665553033352, decouple_loss:0.007569482084363699
loss_pred:0.02573104202747345, decouple_loss:0.0075258612632751465
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026664158329367638, avg_mse: 0.03226044401526451
current test mse: 0.03226
Iteration: 581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45787957310676575, gen p mean: 0.0, mean p set: 0.4498332440853119
The modified gen p mean: 0.45332270860671997, gen p mean: 0.0, mean p set: 0.4499163329601288
loss_pred:0.02522891014814377, decouple_loss:0.007582765072584152
loss_pred:0.02664857730269432, decouple_loss:0.007623298559337854
The modified gen p mean: 0.45113706588745117, gen p mean: 0.0, mean p set: 0.448142409324646
loss_pred:0.025689871981739998, decouple_loss:0.007462195120751858
Iteration: 582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4414116442203522, gen p mean: 0.0, mean p set: 0.4524591267108917
The modified gen p mean: 0.4418003559112549, gen p mean: 0.0, mean p set: 0.4498688280582428
loss_pred:0.025283750146627426, decouple_loss:0.007721487432718277
loss_pred:0.025426875799894333, decouple_loss:0.007576328236609697The modified gen p mean: 0.4397166669368744, gen p mean: 0.0, mean p set: 0.4521452486515045
loss_pred:0.025461476296186447, decouple_loss:0.0076659806072711945
Iteration: 583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4553913176059723, gen p mean: 0.0, mean p set: 0.44862014055252075
loss_pred:0.025234689936041832, decouple_loss:0.0073077017441391945
The modified gen p mean: 0.459793359041214, gen p mean: 0.0, mean p set: 0.4517160654067993
The modified gen p mean: 0.45755714178085327, gen p mean: 0.0, mean p set: 0.44953182339668274
loss_pred:0.025216078385710716, decouple_loss:0.007389402948319912
loss_pred:0.024911783635616302, decouple_loss:0.007456981111317873
Iteration: 584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501551687717438, gen p mean: 0.0, mean p set: 0.4506407380104065
The modified gen p mean: 0.4426077604293823, gen p mean: 0.0, mean p set: 0.4509674608707428
loss_pred:0.024967443197965622, decouple_loss:0.007402369752526283
loss_pred:0.02535152994096279, decouple_loss:0.007204072549939156
The modified gen p mean: 0.4453333616256714, gen p mean: 0.0, mean p set: 0.45326003432273865
loss_pred:0.025069985538721085, decouple_loss:0.007134506478905678
Iteration: 585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4375709891319275, gen p mean: 0.0, mean p set: 0.45198073983192444
The modified gen p mean: 0.4344438910484314, gen p mean: 0.0, mean p set: 0.45022377371788025
loss_pred:0.025320041924715042, decouple_loss:0.00792422890663147
loss_pred:0.025166824460029602, decouple_loss:0.007571293041110039The modified gen p mean: 0.44453683495521545, gen p mean: 0.0, mean p set: 0.4514331519603729
loss_pred:0.024688633158802986, decouple_loss:0.0073881554417312145
Iteration: 586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46338215470314026, gen p mean: 0.0, mean p set: 0.44951876997947693
The modified gen p mean: 0.459428995847702, gen p mean: 0.0, mean p set: 0.45039960741996765
loss_pred:0.02454642951488495, decouple_loss:0.007559179328382015
loss_pred:0.025999054312705994, decouple_loss:0.007670568767935038The modified gen p mean: 0.4613666534423828, gen p mean: 0.0, mean p set: 0.45087674260139465
loss_pred:0.02634851075708866, decouple_loss:0.007532733492553234
Iteration: 587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46383267641067505, gen p mean: 0.0, mean p set: 0.45197638869285583
The modified gen p mean: 0.45958417654037476, gen p mean: 0.0, mean p set: 0.45162567496299744
loss_pred:0.024652255699038506, decouple_loss:0.00712848175317049
loss_pred:0.026326682418584824, decouple_loss:0.007457760162651539The modified gen p mean: 0.46263208985328674, gen p mean: 0.0, mean p set: 0.45195427536964417
loss_pred:0.024378838017582893, decouple_loss:0.007393285632133484
Iteration: 588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4448360204696655, gen p mean: 0.0, mean p set: 0.4517051577568054
loss_pred:0.02448820322751999, decouple_loss:0.007475000340491533
The modified gen p mean: 0.4422164857387543, gen p mean: 0.0, mean p set: 0.4533170461654663
The modified gen p mean: 0.439642071723938, gen p mean: 0.0, mean p set: 0.4501676559448242
loss_pred:0.025414621457457542, decouple_loss:0.0073532178066670895
loss_pred:0.024200141429901123, decouple_loss:0.007463887799531221
Iteration: 589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4421009421348572, gen p mean: 0.0, mean p set: 0.4523191750049591
loss_pred:0.025850791484117508, decouple_loss:0.0076049929484725
The modified gen p mean: 0.4412311017513275, gen p mean: 0.0, mean p set: 0.4520314931869507
The modified gen p mean: 0.4402218163013458, gen p mean: 0.0, mean p set: 0.45208731293678284
loss_pred:0.025370635092258453, decouple_loss:0.007708017248660326
loss_pred:0.02492581680417061, decouple_loss:0.007726803421974182
Iteration: 590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4589608609676361, gen p mean: 0.0, mean p set: 0.4518211781978607
The modified gen p mean: 0.45559120178222656, gen p mean: 0.0, mean p set: 0.44922778010368347
loss_pred:0.02560095675289631, decouple_loss:0.007580278441309929
The modified gen p mean: 0.46082669496536255, gen p mean: 0.0, mean p set: 0.45022279024124146loss_pred:0.025109732523560524, decouple_loss:0.007491275668144226
loss_pred:0.025232650339603424, decouple_loss:0.00708808982744813
2023-05-04 14:03:53 testing...
The modified gen p mean: 0.4539684057235718, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45960819721221924, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4612073302268982, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02732318826019764, decouple_loss:0.00796530395746231
loss_pred:0.026289448142051697, decouple_loss:0.007912054657936096
loss_pred:0.02592766471207142, decouple_loss:0.007893151603639126
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026909610256552696, avg_mse: 0.032625943422317505
current test mse: 0.032626
Iteration: 591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4583134949207306, gen p mean: 0.0, mean p set: 0.45333418250083923
The modified gen p mean: 0.4589708745479584, gen p mean: 0.0, mean p set: 0.44940266013145447
loss_pred:0.024385808035731316, decouple_loss:0.007167597766965628
loss_pred:0.0246813353151083, decouple_loss:0.0069968379102647305
The modified gen p mean: 0.4572606384754181, gen p mean: 0.0, mean p set: 0.45029211044311523
loss_pred:0.02564297430217266, decouple_loss:0.007427866570651531
Iteration: 592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511447250843048, gen p mean: 0.0, mean p set: 0.4497356712818146
The modified gen p mean: 0.44810524582862854, gen p mean: 0.0, mean p set: 0.45262959599494934
loss_pred:0.024630893021821976, decouple_loss:0.007368569262325764
loss_pred:0.024488596245646477, decouple_loss:0.007350260391831398The modified gen p mean: 0.4488801956176758, gen p mean: 0.0, mean p set: 0.4516620337963104
loss_pred:0.024437375366687775, decouple_loss:0.0074309599585831165
Iteration: 593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459872841835022, gen p mean: 0.0, mean p set: 0.45175832509994507
The modified gen p mean: 0.4462139904499054, gen p mean: 0.0, mean p set: 0.45028162002563477
The modified gen p mean: 0.4458010196685791, gen p mean: 0.0, mean p set: 0.4503476321697235
loss_pred:0.02504185400903225, decouple_loss:0.007161916233599186
loss_pred:0.02439522184431553, decouple_loss:0.007380490191280842
loss_pred:0.025873782113194466, decouple_loss:0.007457434665411711
Iteration: 594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44598791003227234, gen p mean: 0.0, mean p set: 0.45130327343940735
loss_pred:0.025052262470126152, decouple_loss:0.007196017075330019
The modified gen p mean: 0.44892004132270813, gen p mean: 0.0, mean p set: 0.4504731595516205
The modified gen p mean: 0.44886428117752075, gen p mean: 0.0, mean p set: 0.4495701789855957
loss_pred:0.025748740881681442, decouple_loss:0.0070747872814536095
loss_pred:0.02554088458418846, decouple_loss:0.007225033827126026
Iteration: 595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468591809272766, gen p mean: 0.0, mean p set: 0.4493304491043091
loss_pred:0.025200847536325455, decouple_loss:0.007276215124875307
The modified gen p mean: 0.44957849383354187, gen p mean: 0.0, mean p set: 0.4516368806362152
The modified gen p mean: 0.4486428201198578, gen p mean: 0.0, mean p set: 0.44998836517333984
loss_pred:0.02530864253640175, decouple_loss:0.006952641531825066
loss_pred:0.02598506212234497, decouple_loss:0.007181661203503609
Iteration: 596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45369264483451843, gen p mean: 0.0, mean p set: 0.4498729407787323
The modified gen p mean: 0.45444461703300476, gen p mean: 0.0, mean p set: 0.45026808977127075
loss_pred:0.02595788799226284, decouple_loss:0.006983298342674971
loss_pred:0.025666767731308937, decouple_loss:0.006957691162824631The modified gen p mean: 0.4514005482196808, gen p mean: 0.0, mean p set: 0.449952095746994
loss_pred:0.024467263370752335, decouple_loss:0.0070874751545488834
Iteration: 597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45550787448883057, gen p mean: 0.0, mean p set: 0.4517599642276764
loss_pred:0.02418951503932476, decouple_loss:0.007694366853684187
The modified gen p mean: 0.45040494203567505, gen p mean: 0.0, mean p set: 0.4518939256668091
The modified gen p mean: 0.45006904006004333, gen p mean: 0.0, mean p set: 0.4510645270347595
loss_pred:0.025386717170476913, decouple_loss:0.00727276923134923
loss_pred:0.02504204772412777, decouple_loss:0.007573109120130539
Iteration: 598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830331206321716, gen p mean: 0.0, mean p set: 0.4519321024417877
The modified gen p mean: 0.4518500566482544, gen p mean: 0.0, mean p set: 0.4518289566040039
loss_pred:0.02508220262825489, decouple_loss:0.007411430589854717
The modified gen p mean: 0.44695258140563965, gen p mean: 0.0, mean p set: 0.4516025483608246
loss_pred:0.023880459368228912, decouple_loss:0.007335528265684843
loss_pred:0.025895919650793076, decouple_loss:0.007191122509539127
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
NaN value num: 0
Iteration: 599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45165112614631653, gen p mean: 0.0, mean p set: 0.4521428048610687
The modified gen p mean: 0.45070335268974304, gen p mean: 0.0, mean p set: 0.45174646377563477
The modified gen p mean: 0.4579818546772003, gen p mean: 0.0, mean p set: 0.4507599174976349
loss_pred:0.025893406942486763, decouple_loss:0.007197887171059847
loss_pred:0.025222493335604668, decouple_loss:0.00759592792019248
loss_pred:0.024060916155576706, decouple_loss:0.007673274260014296
Iteration: 600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531010389328003, gen p mean: 0.0, mean p set: 0.452427476644516
loss_pred:0.02520907297730446, decouple_loss:0.007593690883368254
The modified gen p mean: 0.4485507011413574, gen p mean: 0.0, mean p set: 0.4517534077167511
The modified gen p mean: 0.454983115196228, gen p mean: 0.0, mean p set: 0.4535069465637207
loss_pred:0.024819443002343178, decouple_loss:0.007570662070065737
loss_pred:0.0249787624925375, decouple_loss:0.008324413560330868
2023-05-04 14:08:29 testing...
The modified gen p mean: 0.43976151943206787, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4485904574394226, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4463971257209778, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.027299681678414345, decouple_loss:0.008070769719779491
loss_pred:0.025794731453061104, decouple_loss:0.008087988011538982
loss_pred:0.026190705597400665, decouple_loss:0.00799145083874464
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026830878108739853, avg_mse: 0.03261389955878258
current test mse: 0.032614
Iteration: 601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44888627529144287, gen p mean: 0.0, mean p set: 0.4523538649082184
The modified gen p mean: 0.4455167353153229, gen p mean: 0.0, mean p set: 0.45464667677879333
loss_pred:0.025174202397465706, decouple_loss:0.007700800430029631
loss_pred:0.025216128677129745, decouple_loss:0.00810300000011921
The modified gen p mean: 0.4486826956272125, gen p mean: 0.0, mean p set: 0.4534248113632202
loss_pred:0.025210639461874962, decouple_loss:0.008030013181269169
Iteration: 602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4547070562839508, gen p mean: 0.0, mean p set: 0.4503670632839203
The modified gen p mean: 0.44929203391075134, gen p mean: 0.0, mean p set: 0.45302614569664
loss_pred:0.024607611820101738, decouple_loss:0.007833321578800678
loss_pred:0.024949267506599426, decouple_loss:0.00796328205615282The modified gen p mean: 0.45278316736221313, gen p mean: 0.0, mean p set: 0.4515247046947479
loss_pred:0.02543637715280056, decouple_loss:0.007895824499428272
Iteration: 603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45663949847221375, gen p mean: 0.0, mean p set: 0.45263591408729553
loss_pred:0.02464725263416767, decouple_loss:0.0077918958850204945
The modified gen p mean: 0.4577521085739136, gen p mean: 0.0, mean p set: 0.4543021321296692
The modified gen p mean: 0.45228153467178345, gen p mean: 0.0, mean p set: 0.4522990584373474
loss_pred:0.025332070887088776, decouple_loss:0.00752181326970458
loss_pred:0.025001725181937218, decouple_loss:0.007705981377512217
Iteration: 604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4560052454471588, gen p mean: 0.0, mean p set: 0.4526262879371643
loss_pred:0.024708062410354614, decouple_loss:0.007570146583020687
The modified gen p mean: 0.45712989568710327, gen p mean: 0.0, mean p set: 0.45371225476264954
The modified gen p mean: 0.4539288878440857, gen p mean: 0.0, mean p set: 0.4527541399002075
loss_pred:0.025348544120788574, decouple_loss:0.0075078802183270454
loss_pred:0.025840342044830322, decouple_loss:0.007243049796670675
Iteration: 605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4450136721134186, gen p mean: 0.0, mean p set: 0.4511880576610565
The modified gen p mean: 0.4491760730743408, gen p mean: 0.0, mean p set: 0.45117396116256714
loss_pred:0.025419244542717934, decouple_loss:0.007341860793530941
The modified gen p mean: 0.4519596993923187, gen p mean: 0.0, mean p set: 0.45299163460731506loss_pred:0.025113634765148163, decouple_loss:0.007713432423770428
loss_pred:0.02418351173400879, decouple_loss:0.00709129311144352
Iteration: 606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45076611638069153, gen p mean: 0.0, mean p set: 0.45199844241142273
loss_pred:0.024993715807795525, decouple_loss:0.007389985490590334
The modified gen p mean: 0.4501682221889496, gen p mean: 0.0, mean p set: 0.45317909121513367
The modified gen p mean: 0.4499107003211975, gen p mean: 0.0, mean p set: 0.4532091021537781
loss_pred:0.026041071861982346, decouple_loss:0.007236730773001909
loss_pred:0.024931786581873894, decouple_loss:0.007277566473931074
Iteration: 607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45070725679397583, gen p mean: 0.0, mean p set: 0.453043133020401
loss_pred:0.024551648646593094, decouple_loss:0.007390226703137159
The modified gen p mean: 0.4556170403957367, gen p mean: 0.0, mean p set: 0.45356857776641846
The modified gen p mean: 0.4505349397659302, gen p mean: 0.0, mean p set: 0.4516587555408478
loss_pred:0.023942073807120323, decouple_loss:0.007317056879401207
loss_pred:0.02463766746222973, decouple_loss:0.007648364640772343
Iteration: 608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4550277590751648, gen p mean: 0.0, mean p set: 0.450962096452713
The modified gen p mean: 0.45346981287002563, gen p mean: 0.0, mean p set: 0.45258408784866333
loss_pred:0.02523929625749588, decouple_loss:0.0072757466696202755
loss_pred:0.025715572759509087, decouple_loss:0.0073599256575107574The modified gen p mean: 0.4535033404827118, gen p mean: 0.0, mean p set: 0.4539869725704193
loss_pred:0.025400424376130104, decouple_loss:0.007224561180919409
Iteration: 609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45211511850357056, gen p mean: 0.0, mean p set: 0.4525293707847595
loss_pred:0.025254450738430023, decouple_loss:0.007385302800685167
The modified gen p mean: 0.45047199726104736, gen p mean: 0.0, mean p set: 0.4541240334510803
The modified gen p mean: 0.4519737958908081, gen p mean: 0.0, mean p set: 0.4534578025341034
loss_pred:0.024826647713780403, decouple_loss:0.006871099583804607
loss_pred:0.02502928301692009, decouple_loss:0.007240098901093006
Iteration: 610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45397648215293884, gen p mean: 0.0, mean p set: 0.45297572016716003
The modified gen p mean: 0.4562259614467621, gen p mean: 0.0, mean p set: 0.45378997921943665
loss_pred:0.025671418756246567, decouple_loss:0.007186015136539936
The modified gen p mean: 0.451517790555954, gen p mean: 0.0, mean p set: 0.45120686292648315loss_pred:0.024464858695864677, decouple_loss:0.007123875897377729
loss_pred:0.024351684376597404, decouple_loss:0.007541288621723652
2023-05-04 14:12:01 testing...
The modified gen p mean: 0.4372411072254181, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44570404291152954, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44318535923957825, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.0273775365203619, decouple_loss:0.007929577492177486
loss_pred:0.02587820775806904, decouple_loss:0.007740657776594162
loss_pred:0.02617897465825081, decouple_loss:0.007686398457735777
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026867516338825226, avg_mse: 0.03276657685637474
current test mse: 0.032767
Iteration: 611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4440770745277405, gen p mean: 0.0, mean p set: 0.45324504375457764
The modified gen p mean: 0.4480336010456085, gen p mean: 0.0, mean p set: 0.45238205790519714
loss_pred:0.025069842115044594, decouple_loss:0.006941152736544609
loss_pred:0.025008495897054672, decouple_loss:0.0072314441204071045
The modified gen p mean: 0.44470450282096863, gen p mean: 0.0, mean p set: 0.4529651403427124
loss_pred:0.02447989583015442, decouple_loss:0.006792004685848951
Iteration: 612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45755407214164734, gen p mean: 0.0, mean p set: 0.45406821370124817
loss_pred:0.024946901947259903, decouple_loss:0.006976672913879156
The modified gen p mean: 0.45365872979164124, gen p mean: 0.0, mean p set: 0.4515807330608368
The modified gen p mean: 0.4566391110420227, gen p mean: 0.0, mean p set: 0.4511021673679352
loss_pred:0.025228647515177727, decouple_loss:0.007149146404117346
loss_pred:0.025605378672480583, decouple_loss:0.007320248056203127
Iteration: 613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534509778022766, gen p mean: 0.0, mean p set: 0.45178741216659546
loss_pred:0.024212095886468887, decouple_loss:0.007082885131239891
The modified gen p mean: 0.4538500905036926, gen p mean: 0.0, mean p set: 0.4517782926559448
The modified gen p mean: 0.45137959718704224, gen p mean: 0.0, mean p set: 0.4541327655315399
loss_pred:0.02537638321518898, decouple_loss:0.007128386292606592
loss_pred:0.02542535960674286, decouple_loss:0.006863026414066553
Iteration: 614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45005202293395996, gen p mean: 0.0, mean p set: 0.4540506899356842
loss_pred:0.024816174060106277, decouple_loss:0.006776144728064537
The modified gen p mean: 0.4491533935070038, gen p mean: 0.0, mean p set: 0.4534684121608734
The modified gen p mean: 0.4505915343761444, gen p mean: 0.0, mean p set: 0.4527439475059509
loss_pred:0.02463720552623272, decouple_loss:0.006907280534505844
loss_pred:0.02429797872900963, decouple_loss:0.006826893426477909
Iteration: 615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499383568763733, gen p mean: 0.0, mean p set: 0.4508254826068878
The modified gen p mean: 0.4531599283218384, gen p mean: 0.0, mean p set: 0.45397165417671204
loss_pred:0.025129811838269234, decouple_loss:0.007029318250715733
loss_pred:0.02434341236948967, decouple_loss:0.006867509335279465The modified gen p mean: 0.45372211933135986, gen p mean: 0.0, mean p set: 0.45400142669677734
loss_pred:0.024731870740652084, decouple_loss:0.006908809766173363
Iteration: 616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4607323706150055, gen p mean: 0.0, mean p set: 0.4505046308040619
The modified gen p mean: 0.4607740044593811, gen p mean: 0.0, mean p set: 0.4523839056491852
loss_pred:0.024383701384067535, decouple_loss:0.007014714181423187
The modified gen p mean: 0.4605969488620758, gen p mean: 0.0, mean p set: 0.4532904326915741loss_pred:0.02455330081284046, decouple_loss:0.006902181077748537
loss_pred:0.024612365290522575, decouple_loss:0.006963436026126146
Iteration: 617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4434554874897003, gen p mean: 0.0, mean p set: 0.4532560408115387
loss_pred:0.024156615138053894, decouple_loss:0.006887655705213547
The modified gen p mean: 0.4466482400894165, gen p mean: 0.0, mean p set: 0.4539780914783478
The modified gen p mean: 0.4452586770057678, gen p mean: 0.0, mean p set: 0.4533679187297821
loss_pred:0.024423951283097267, decouple_loss:0.00673163216561079
loss_pred:0.025045793503522873, decouple_loss:0.006600983906537294
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44637560844421387, gen p mean: 0.0, mean p set: 0.45063140988349915
The modified gen p mean: 0.44195446372032166, gen p mean: 0.0, mean p set: 0.449288934469223
The modified gen p mean: 0.44412076473236084, gen p mean: 0.0, mean p set: 0.44917967915534973
loss_pred:0.026998307555913925, decouple_loss:0.007623910438269377
loss_pred:0.02640559896826744, decouple_loss:0.007482714485377073
loss_pred:0.026531271636486053, decouple_loss:0.007405667100101709
Iteration: 619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4633997976779938, gen p mean: 0.0, mean p set: 0.448634535074234
The modified gen p mean: 0.4590056240558624, gen p mean: 0.0, mean p set: 0.44936034083366394
loss_pred:0.026250189170241356, decouple_loss:0.007353872060775757
loss_pred:0.025843970477581024, decouple_loss:0.007681461051106453
The modified gen p mean: 0.45919156074523926, gen p mean: 0.0, mean p set: 0.4492279887199402
loss_pred:0.026107182726264, decouple_loss:0.00741900410503149
Iteration: 620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44478368759155273, gen p mean: 0.0, mean p set: 0.4493459463119507
loss_pred:0.027061063796281815, decouple_loss:0.007641480769962072
The modified gen p mean: 0.446736216545105, gen p mean: 0.0, mean p set: 0.44820713996887207
The modified gen p mean: 0.4545840919017792, gen p mean: 0.0, mean p set: 0.4485895335674286
loss_pred:0.026027344167232513, decouple_loss:0.007234117481857538
loss_pred:0.027324136346578598, decouple_loss:0.007466648239642382
2023-05-04 14:16:17 testing...
The modified gen p mean: 0.433112233877182, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4418467879295349, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.43936073780059814, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.027027271687984467, decouple_loss:0.007344222627580166
loss_pred:0.0255497507750988, decouple_loss:0.007150345481932163
loss_pred:0.025914721190929413, decouple_loss:0.007164760492742062
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026524905115365982, avg_mse: 0.032252490520477295
current test mse: 0.032252
Iteration: 621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43925267457962036, gen p mean: 0.0, mean p set: 0.45029905438423157
The modified gen p mean: 0.4385526776313782, gen p mean: 0.0, mean p set: 0.44949984550476074
loss_pred:0.026180176064372063, decouple_loss:0.007054346613585949
loss_pred:0.026143863797187805, decouple_loss:0.007087976671755314
The modified gen p mean: 0.4375566244125366, gen p mean: 0.0, mean p set: 0.44964301586151123
loss_pred:0.027166424319148064, decouple_loss:0.007199825718998909
Iteration: 622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990554451942444, gen p mean: 0.0, mean p set: 0.4499533474445343
The modified gen p mean: 0.4505905508995056, gen p mean: 0.0, mean p set: 0.45046207308769226
loss_pred:0.02619033120572567, decouple_loss:0.00731676397845149
loss_pred:0.025632794946432114, decouple_loss:0.00733934435993433The modified gen p mean: 0.44812098145484924, gen p mean: 0.0, mean p set: 0.449687123298645
loss_pred:0.027083726599812508, decouple_loss:0.007082104682922363
Iteration: 623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45454275608062744, gen p mean: 0.0, mean p set: 0.4503842294216156
The modified gen p mean: 0.4571743905544281, gen p mean: 0.0, mean p set: 0.4485769271850586
loss_pred:0.02669551409780979, decouple_loss:0.007480212952941656
loss_pred:0.02609901688992977, decouple_loss:0.007455107755959034
The modified gen p mean: 0.45843955874443054, gen p mean: 0.0, mean p set: 0.4483490288257599
loss_pred:0.0264943428337574, decouple_loss:0.0075187901966273785
Iteration: 624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529000520706177, gen p mean: 0.0, mean p set: 0.44902855157852173
The modified gen p mean: 0.4527003765106201, gen p mean: 0.0, mean p set: 0.4469698667526245
loss_pred:0.026051169261336327, decouple_loss:0.0076264189556241035
The modified gen p mean: 0.456376850605011, gen p mean: 0.0, mean p set: 0.44844722747802734loss_pred:0.025957301259040833, decouple_loss:0.007762840948998928
loss_pred:0.026307672262191772, decouple_loss:0.007264150772243738
Iteration: 625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4388381838798523, gen p mean: 0.0, mean p set: 0.4488680362701416
loss_pred:0.026322852820158005, decouple_loss:0.007390646729618311
The modified gen p mean: 0.44377249479293823, gen p mean: 0.0, mean p set: 0.4496126174926758
The modified gen p mean: 0.4434211850166321, gen p mean: 0.0, mean p set: 0.4477255642414093
loss_pred:0.025684518739581108, decouple_loss:0.007143695838749409
loss_pred:0.025659428909420967, decouple_loss:0.007623433135449886
Iteration: 626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4407159686088562, gen p mean: 0.0, mean p set: 0.44945788383483887
loss_pred:0.02552301064133644, decouple_loss:0.007409891113638878
The modified gen p mean: 0.44407919049263, gen p mean: 0.0, mean p set: 0.450682133436203
The modified gen p mean: 0.44389480352401733, gen p mean: 0.0, mean p set: 0.4508882462978363
loss_pred:0.025432376191020012, decouple_loss:0.007381378207355738
loss_pred:0.026643604040145874, decouple_loss:0.00758797861635685
Iteration: 627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45535945892333984, gen p mean: 0.0, mean p set: 0.4498685300350189
loss_pred:0.026403743773698807, decouple_loss:0.007121086120605469
The modified gen p mean: 0.4548070430755615, gen p mean: 0.0, mean p set: 0.44710251688957214
The modified gen p mean: 0.4576234817504883, gen p mean: 0.0, mean p set: 0.4485909342765808
loss_pred:0.026448562741279602, decouple_loss:0.007155580446124077
loss_pred:0.025946736335754395, decouple_loss:0.007425848860293627
Iteration: 628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4635573923587799, gen p mean: 0.0, mean p set: 0.44888070225715637
The modified gen p mean: 0.4582679271697998, gen p mean: 0.0, mean p set: 0.44958946108818054
loss_pred:0.02602328546345234, decouple_loss:0.007255963981151581
loss_pred:0.0261274054646492, decouple_loss:0.007209566421806812
The modified gen p mean: 0.4550938308238983, gen p mean: 0.0, mean p set: 0.44898566603660583
loss_pred:0.02605597861111164, decouple_loss:0.007342128548771143
Iteration: 629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43973681330680847, gen p mean: 0.0, mean p set: 0.45022737979888916
The modified gen p mean: 0.4419836401939392, gen p mean: 0.0, mean p set: 0.4506332576274872loss_pred:0.027145497500896454, decouple_loss:0.00718431081622839
The modified gen p mean: 0.43870478868484497, gen p mean: 0.0, mean p set: 0.4500042200088501
loss_pred:0.024972116574645042, decouple_loss:0.007243260275572538
loss_pred:0.02609962970018387, decouple_loss:0.007155565079301596
Iteration: 630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4440121054649353, gen p mean: 0.0, mean p set: 0.44861605763435364
The modified gen p mean: 0.4445316195487976, gen p mean: 0.0, mean p set: 0.4499235153198242
loss_pred:0.026061465963721275, decouple_loss:0.007417802698910236
loss_pred:0.02690267004072666, decouple_loss:0.007228078320622444
The modified gen p mean: 0.44678619503974915, gen p mean: 0.0, mean p set: 0.4492368996143341
loss_pred:0.026564087718725204, decouple_loss:0.007164728362113237
2023-05-04 14:19:49 testing...
The modified gen p mean: 0.4483030140399933, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45451581478118896, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4568057656288147, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.026960311457514763, decouple_loss:0.007213827222585678
loss_pred:0.025858044624328613, decouple_loss:0.007150041870772839
loss_pred:0.025545304641127586, decouple_loss:0.007176910527050495
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026480233296751976, avg_mse: 0.032203059643507004
current test mse: 0.032203
Iteration: 631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45162728428840637, gen p mean: 0.0, mean p set: 0.449137419462204
The modified gen p mean: 0.45354947447776794, gen p mean: 0.0, mean p set: 0.448056697845459
loss_pred:0.027004947885870934, decouple_loss:0.007388845086097717
loss_pred:0.025529921054840088, decouple_loss:0.007032450754195452
The modified gen p mean: 0.45149487257003784, gen p mean: 0.0, mean p set: 0.4502703547477722
loss_pred:0.026871060952544212, decouple_loss:0.007438806351274252
Iteration: 632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462363123893738, gen p mean: 0.0, mean p set: 0.44975459575653076
loss_pred:0.0260294321924448, decouple_loss:0.007086309604346752
The modified gen p mean: 0.44516199827194214, gen p mean: 0.0, mean p set: 0.44987955689430237
The modified gen p mean: 0.4454687535762787, gen p mean: 0.0, mean p set: 0.44900989532470703
loss_pred:0.02585616335272789, decouple_loss:0.007413529325276613
loss_pred:0.02641926519572735, decouple_loss:0.0072443848475813866
Iteration: 633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44354668259620667, gen p mean: 0.0, mean p set: 0.44983842968940735
The modified gen p mean: 0.4510253071784973, gen p mean: 0.0, mean p set: 0.44837456941604614
loss_pred:0.02652730979025364, decouple_loss:0.007373462896794081
loss_pred:0.026297712698578835, decouple_loss:0.007049015257507563The modified gen p mean: 0.44740939140319824, gen p mean: 0.0, mean p set: 0.4495595097541809
loss_pred:0.025990497320890427, decouple_loss:0.007308287546038628
Iteration: 634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46038728952407837, gen p mean: 0.0, mean p set: 0.448943167924881
The modified gen p mean: 0.458926260471344, gen p mean: 0.0, mean p set: 0.44932347536087036
loss_pred:0.025616802275180817, decouple_loss:0.007157244253903627
loss_pred:0.02556285634636879, decouple_loss:0.007089642342180014
The modified gen p mean: 0.46127623319625854, gen p mean: 0.0, mean p set: 0.4483669102191925
loss_pred:0.02630195952951908, decouple_loss:0.006981652230024338
Iteration: 635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44423621892929077, gen p mean: 0.0, mean p set: 0.4478663504123688
loss_pred:0.025621972978115082, decouple_loss:0.007223130669444799
The modified gen p mean: 0.44135499000549316, gen p mean: 0.0, mean p set: 0.44904085993766785
The modified gen p mean: 0.44687312841415405, gen p mean: 0.0, mean p set: 0.4498407244682312
loss_pred:0.026099277660250664, decouple_loss:0.00706204678863287
loss_pred:0.026108823716640472, decouple_loss:0.006885199341922998
Iteration: 636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4360106885433197, gen p mean: 0.0, mean p set: 0.44820865988731384
loss_pred:0.026482632383704185, decouple_loss:0.007254600990563631
The modified gen p mean: 0.435059517621994, gen p mean: 0.0, mean p set: 0.44896194338798523
The modified gen p mean: 0.4345147907733917, gen p mean: 0.0, mean p set: 0.4481198489665985
loss_pred:0.025719238445162773, decouple_loss:0.007008740212768316
loss_pred:0.026282567530870438, decouple_loss:0.007300151977688074
Iteration: 637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4563552439212799, gen p mean: 0.0, mean p set: 0.4495994448661804
loss_pred:0.026464736089110374, decouple_loss:0.006771589629352093
The modified gen p mean: 0.4547916054725647, gen p mean: 0.0, mean p set: 0.44930922985076904
The modified gen p mean: 0.4537717401981354, gen p mean: 0.0, mean p set: 0.4500616788864136
loss_pred:0.025842923671007156, decouple_loss:0.006934271194040775
loss_pred:0.026583515107631683, decouple_loss:0.006863438058644533
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
NaN value num: 0
Iteration: 638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46175917983055115, gen p mean: 0.0, mean p set: 0.45026248693466187
The modified gen p mean: 0.4615029990673065, gen p mean: 0.0, mean p set: 0.44809824228286743
loss_pred:0.02499040961265564, decouple_loss:0.007702400907874107
The modified gen p mean: 0.4682079553604126, gen p mean: 0.0, mean p set: 0.4490615427494049
loss_pred:0.026297597214579582, decouple_loss:0.00767403282225132
loss_pred:0.026824073866009712, decouple_loss:0.007885650731623173
Iteration: 639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44064831733703613, gen p mean: 0.0, mean p set: 0.4509424567222595
The modified gen p mean: 0.43700483441352844, gen p mean: 0.0, mean p set: 0.4504929184913635
loss_pred:0.025131210684776306, decouple_loss:0.007834422402083874
loss_pred:0.025380762293934822, decouple_loss:0.007701591122895479The modified gen p mean: 0.4350399374961853, gen p mean: 0.0, mean p set: 0.44993945956230164
loss_pred:0.024670083075761795, decouple_loss:0.00758436881005764
Iteration: 640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4419115483760834, gen p mean: 0.0, mean p set: 0.45060494542121887
The modified gen p mean: 0.44314512610435486, gen p mean: 0.0, mean p set: 0.4509258568286896
loss_pred:0.02667304314672947, decouple_loss:0.007674131542444229
loss_pred:0.02581014111638069, decouple_loss:0.008111572824418545
The modified gen p mean: 0.4416685998439789, gen p mean: 0.0, mean p set: 0.44900739192962646
loss_pred:0.026554113253951073, decouple_loss:0.007628286723047495
2023-05-04 14:24:05 testing...
The modified gen p mean: 0.4599062204360962, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4677693545818329, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.46597355604171753, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.027293412014842033, decouple_loss:0.007881631143391132
loss_pred:0.02589377947151661, decouple_loss:0.00787726603448391
loss_pred:0.02629895880818367, decouple_loss:0.007906277664005756
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026889804750680923, avg_mse: 0.03289063647389412
current test mse: 0.032891
Iteration: 641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46331942081451416, gen p mean: 0.0, mean p set: 0.45065850019454956
The modified gen p mean: 0.45855531096458435, gen p mean: 0.0, mean p set: 0.44941338896751404
loss_pred:0.02512122131884098, decouple_loss:0.007521852385252714
loss_pred:0.025416376069188118, decouple_loss:0.008099041879177094
The modified gen p mean: 0.46428340673446655, gen p mean: 0.0, mean p set: 0.45152729749679565
loss_pred:0.025412065908312798, decouple_loss:0.007688021752983332
Iteration: 642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45729246735572815, gen p mean: 0.0, mean p set: 0.44976404309272766
loss_pred:0.025854775682091713, decouple_loss:0.007191043347120285
The modified gen p mean: 0.45390886068344116, gen p mean: 0.0, mean p set: 0.4494905471801758
The modified gen p mean: 0.459835022687912, gen p mean: 0.0, mean p set: 0.4510088264942169
loss_pred:0.025856969878077507, decouple_loss:0.0076647428795695305
loss_pred:0.025404594838619232, decouple_loss:0.007263170555233955
Iteration: 643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4388509690761566, gen p mean: 0.0, mean p set: 0.45030689239501953
The modified gen p mean: 0.4311213493347168, gen p mean: 0.0, mean p set: 0.45023781061172485
loss_pred:0.025138044729828835, decouple_loss:0.007084918208420277
loss_pred:0.025304416194558144, decouple_loss:0.007301736157387495The modified gen p mean: 0.4382938742637634, gen p mean: 0.0, mean p set: 0.4495079815387726
loss_pred:0.025518087670207024, decouple_loss:0.007187190465629101
Iteration: 644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473629593849182, gen p mean: 0.0, mean p set: 0.4483596682548523
The modified gen p mean: 0.4438152015209198, gen p mean: 0.0, mean p set: 0.44911783933639526
loss_pred:0.027213243767619133, decouple_loss:0.007499392144382
loss_pred:0.025633739307522774, decouple_loss:0.007528079207986593
The modified gen p mean: 0.44336050748825073, gen p mean: 0.0, mean p set: 0.44958722591400146
loss_pred:0.026110660284757614, decouple_loss:0.0076019237749278545
Iteration: 645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4664681851863861, gen p mean: 0.0, mean p set: 0.45297008752822876
loss_pred:0.025223715230822563, decouple_loss:0.007331643253564835
The modified gen p mean: 0.4636315703392029, gen p mean: 0.0, mean p set: 0.4510234594345093
The modified gen p mean: 0.4687505066394806, gen p mean: 0.0, mean p set: 0.45275649428367615
loss_pred:0.025361526757478714, decouple_loss:0.007398255169391632
loss_pred:0.026666788384318352, decouple_loss:0.0073162587359547615
Iteration: 646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45823368430137634, gen p mean: 0.0, mean p set: 0.4504006803035736
loss_pred:0.026616020128130913, decouple_loss:0.007623680867254734
The modified gen p mean: 0.4519071877002716, gen p mean: 0.0, mean p set: 0.4519214332103729
The modified gen p mean: 0.45324066281318665, gen p mean: 0.0, mean p set: 0.4526459276676178
loss_pred:0.025871889665722847, decouple_loss:0.007724278140813112
loss_pred:0.025177493691444397, decouple_loss:0.007783262059092522
Iteration: 647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43707188963890076, gen p mean: 0.0, mean p set: 0.4498515725135803
loss_pred:0.025406712666153908, decouple_loss:0.008415297605097294
The modified gen p mean: 0.43534284830093384, gen p mean: 0.0, mean p set: 0.4518038034439087
The modified gen p mean: 0.437286913394928, gen p mean: 0.0, mean p set: 0.45140528678894043
loss_pred:0.0249595008790493, decouple_loss:0.008458687923848629
loss_pred:0.024806002154946327, decouple_loss:0.008226899430155754
Iteration: 648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44632217288017273, gen p mean: 0.0, mean p set: 0.44952380657196045
The modified gen p mean: 0.44599464535713196, gen p mean: 0.0, mean p set: 0.45156213641166687
loss_pred:0.02631416730582714, decouple_loss:0.009383606724441051
loss_pred:0.027019625529646873, decouple_loss:0.009511024691164494The modified gen p mean: 0.4470561742782593, gen p mean: 0.0, mean p set: 0.45045995712280273
loss_pred:0.025538230314850807, decouple_loss:0.00941013265401125
Iteration: 649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4597683250904083, gen p mean: 0.0, mean p set: 0.45024624466896057
loss_pred:0.02540941908955574, decouple_loss:0.00875860545784235
The modified gen p mean: 0.4605022072792053, gen p mean: 0.0, mean p set: 0.449381947517395
The modified gen p mean: 0.46043655276298523, gen p mean: 0.0, mean p set: 0.4502033293247223
loss_pred:0.0258209016174078, decouple_loss:0.008617657236754894
loss_pred:0.02517937868833542, decouple_loss:0.008663952350616455
Iteration: 650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512530565261841, gen p mean: 0.0, mean p set: 0.4482645094394684
The modified gen p mean: 0.449988454580307, gen p mean: 0.0, mean p set: 0.4518826901912689
loss_pred:0.027052652090787888, decouple_loss:0.008477086201310158
loss_pred:0.026189660653471947, decouple_loss:0.008624562062323093
The modified gen p mean: 0.44925251603126526, gen p mean: 0.0, mean p set: 0.4506358802318573
loss_pred:0.02626228891313076, decouple_loss:0.008546232245862484
2023-05-04 14:27:41 testing...
The modified gen p mean: 0.4387102723121643, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44511303305625916, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44710591435432434, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.027426617220044136, decouple_loss:0.0092106768861413
loss_pred:0.026423389092087746, decouple_loss:0.008967719972133636
loss_pred:0.02609284594655037, decouple_loss:0.008913335390388966
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02709914743900299, avg_mse: 0.03313273936510086
current test mse: 0.033133
Iteration: 651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4414065480232239, gen p mean: 0.0, mean p set: 0.4490666687488556
The modified gen p mean: 0.44577088952064514, gen p mean: 0.0, mean p set: 0.45264333486557007
loss_pred:0.02533062733709812, decouple_loss:0.008600739762187004
loss_pred:0.025055134668946266, decouple_loss:0.008515751920640469
The modified gen p mean: 0.4392848014831543, gen p mean: 0.0, mean p set: 0.4505738615989685
loss_pred:0.024827560409903526, decouple_loss:0.0087629035115242
Iteration: 652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45487114787101746, gen p mean: 0.0, mean p set: 0.451885849237442
loss_pred:0.025784581899642944, decouple_loss:0.008763199672102928
The modified gen p mean: 0.4514533281326294, gen p mean: 0.0, mean p set: 0.45193883776664734
The modified gen p mean: 0.46130800247192383, gen p mean: 0.0, mean p set: 0.44963955879211426
loss_pred:0.0262533500790596, decouple_loss:0.00855057779699564
loss_pred:0.025143956765532494, decouple_loss:0.008741630241274834
Iteration: 653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45912325382232666, gen p mean: 0.0, mean p set: 0.4505072236061096
The modified gen p mean: 0.4546244442462921, gen p mean: 0.0, mean p set: 0.4494827091693878
loss_pred:0.025222349911928177, decouple_loss:0.00835852324962616
loss_pred:0.02590990997850895, decouple_loss:0.008604916743934155
The modified gen p mean: 0.4554090201854706, gen p mean: 0.0, mean p set: 0.4522995054721832
loss_pred:0.024843059480190277, decouple_loss:0.008745603263378143
Iteration: 654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482344686985016, gen p mean: 0.0, mean p set: 0.4507831633090973
loss_pred:0.025874949991703033, decouple_loss:0.00903416145592928
The modified gen p mean: 0.4469003677368164, gen p mean: 0.0, mean p set: 0.4518527686595917
The modified gen p mean: 0.44991761445999146, gen p mean: 0.0, mean p set: 0.4533156752586365
loss_pred:0.0258914977312088, decouple_loss:0.00903002917766571
loss_pred:0.024769702926278114, decouple_loss:0.00888045784085989
Iteration: 655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493263065814972, gen p mean: 0.0, mean p set: 0.4497814178466797
loss_pred:0.025962041690945625, decouple_loss:0.008420734666287899
The modified gen p mean: 0.44597962498664856, gen p mean: 0.0, mean p set: 0.45017367601394653
The modified gen p mean: 0.44537678360939026, gen p mean: 0.0, mean p set: 0.4518917500972748
loss_pred:0.02443339116871357, decouple_loss:0.008758928626775742
loss_pred:0.025164280086755753, decouple_loss:0.00889784749597311
Iteration: 656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471324384212494, gen p mean: 0.0, mean p set: 0.4522479474544525
loss_pred:0.02481985278427601, decouple_loss:0.008293905295431614
The modified gen p mean: 0.4450798034667969, gen p mean: 0.0, mean p set: 0.45247551798820496
The modified gen p mean: 0.44600021839141846, gen p mean: 0.0, mean p set: 0.4507688283920288
loss_pred:0.02583029493689537, decouple_loss:0.008293647319078445
loss_pred:0.024600598961114883, decouple_loss:0.008224966935813427
Iteration: 657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535234868526459, gen p mean: 0.0, mean p set: 0.4505264163017273
The modified gen p mean: 0.44876962900161743, gen p mean: 0.0, mean p set: 0.44908812642097473
loss_pred:0.023958586156368256, decouple_loss:0.008071265183389187
loss_pred:0.02474423497915268, decouple_loss:0.008103684522211552The modified gen p mean: 0.45379236340522766, gen p mean: 0.0, mean p set: 0.4499800503253937
loss_pred:0.02602759562432766, decouple_loss:0.00801986176520586
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
NaN value num: 0
Iteration: 658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45308756828308105, gen p mean: 0.0, mean p set: 0.44770586490631104
The modified gen p mean: 0.45027250051498413, gen p mean: 0.0, mean p set: 0.4479944705963135
loss_pred:0.02623838186264038, decouple_loss:0.008557276800274849
The modified gen p mean: 0.45307761430740356, gen p mean: 0.0, mean p set: 0.44636544585227966
loss_pred:0.026370514184236526, decouple_loss:0.008398538455367088
loss_pred:0.02656911127269268, decouple_loss:0.008463850244879723
Iteration: 659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480151832103729, gen p mean: 0.0, mean p set: 0.44733378291130066
loss_pred:0.027288351207971573, decouple_loss:0.008277052082121372
The modified gen p mean: 0.4518565833568573, gen p mean: 0.0, mean p set: 0.4479721784591675The modified gen p mean: 0.4462045431137085, gen p mean: 0.0, mean p set: 0.4469212293624878
loss_pred:0.025609318166971207, decouple_loss:0.008183937519788742
loss_pred:0.025410013273358345, decouple_loss:0.008091570809483528
Iteration: 660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4408942461013794, gen p mean: 0.0, mean p set: 0.44841480255126953
The modified gen p mean: 0.44752198457717896, gen p mean: 0.0, mean p set: 0.4461488425731659
loss_pred:0.026907023042440414, decouple_loss:0.008186742663383484
The modified gen p mean: 0.4459631145000458, gen p mean: 0.0, mean p set: 0.4466760754585266
loss_pred:0.025320641696453094, decouple_loss:0.008082508109509945
loss_pred:0.0266904104501009, decouple_loss:0.0081080486997962
2023-05-04 14:31:57 testing...
The modified gen p mean: 0.43760526180267334, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4438203275203705, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4457746744155884, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02705068700015545, decouple_loss:0.008183859288692474
loss_pred:0.02607579529285431, decouple_loss:0.007987369783222675
loss_pred:0.025592217221856117, decouple_loss:0.00803993921726942
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026643086224794388, avg_mse: 0.032533857971429825
current test mse: 0.032534
Iteration: 661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44565925002098083, gen p mean: 0.0, mean p set: 0.4469703137874603
The modified gen p mean: 0.44266119599342346, gen p mean: 0.0, mean p set: 0.4467623829841614
loss_pred:0.026633165776729584, decouple_loss:0.007839501835405827
loss_pred:0.027297887951135635, decouple_loss:0.00827284250408411
The modified gen p mean: 0.44189369678497314, gen p mean: 0.0, mean p set: 0.4493277370929718
loss_pred:0.025107067078351974, decouple_loss:0.007879318669438362
Iteration: 662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474959969520569, gen p mean: 0.0, mean p set: 0.44630083441734314
The modified gen p mean: 0.4478384554386139, gen p mean: 0.0, mean p set: 0.4466996490955353
loss_pred:0.026520047336816788, decouple_loss:0.0076388888992369175
loss_pred:0.02667084150016308, decouple_loss:0.007522070314735174The modified gen p mean: 0.4455113708972931, gen p mean: 0.0, mean p set: 0.44859790802001953
loss_pred:0.02539048157632351, decouple_loss:0.007558497600257397
Iteration: 663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532763659954071, gen p mean: 0.0, mean p set: 0.4464716613292694
The modified gen p mean: 0.45408281683921814, gen p mean: 0.0, mean p set: 0.44611287117004395
loss_pred:0.025353386998176575, decouple_loss:0.007418356835842133
loss_pred:0.02702864445745945, decouple_loss:0.007364332210272551The modified gen p mean: 0.454415887594223, gen p mean: 0.0, mean p set: 0.44716089963912964
loss_pred:0.025288894772529602, decouple_loss:0.007280122954398394
Iteration: 664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4414043426513672, gen p mean: 0.0, mean p set: 0.44912847876548767
loss_pred:0.025058286264538765, decouple_loss:0.0073960102163255215
The modified gen p mean: 0.4422648251056671, gen p mean: 0.0, mean p set: 0.4473523199558258
The modified gen p mean: 0.4426833391189575, gen p mean: 0.0, mean p set: 0.44792690873146057
loss_pred:0.026285594329237938, decouple_loss:0.007450731471180916
loss_pred:0.02544061280786991, decouple_loss:0.007547530345618725
Iteration: 665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44190457463264465, gen p mean: 0.0, mean p set: 0.44744330644607544
The modified gen p mean: 0.4403354227542877, gen p mean: 0.0, mean p set: 0.44728702306747437
loss_pred:0.02540028840303421, decouple_loss:0.00749697582796216
loss_pred:0.02633778378367424, decouple_loss:0.0076313987374305725The modified gen p mean: 0.4445350468158722, gen p mean: 0.0, mean p set: 0.44634416699409485
loss_pred:0.02633090689778328, decouple_loss:0.007354983128607273
Iteration: 666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44865480065345764, gen p mean: 0.0, mean p set: 0.44648122787475586
The modified gen p mean: 0.4484536945819855, gen p mean: 0.0, mean p set: 0.4473839998245239
loss_pred:0.026326166465878487, decouple_loss:0.007695214822888374
loss_pred:0.025307688862085342, decouple_loss:0.007286530453711748The modified gen p mean: 0.4476540982723236, gen p mean: 0.0, mean p set: 0.4474653899669647
loss_pred:0.026560736820101738, decouple_loss:0.007724284194409847
Iteration: 667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45575225353240967, gen p mean: 0.0, mean p set: 0.4465733468532562
The modified gen p mean: 0.4575001895427704, gen p mean: 0.0, mean p set: 0.4466344118118286
loss_pred:0.026397693902254105, decouple_loss:0.007282573264092207
loss_pred:0.026411617174744606, decouple_loss:0.007309223525226116The modified gen p mean: 0.45829132199287415, gen p mean: 0.0, mean p set: 0.4461663067340851
loss_pred:0.02649771049618721, decouple_loss:0.0072016906924545765
Iteration: 668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4401850402355194, gen p mean: 0.0, mean p set: 0.44677287340164185
loss_pred:0.026778027415275574, decouple_loss:0.007089030928909779
The modified gen p mean: 0.44171568751335144, gen p mean: 0.0, mean p set: 0.4472929835319519
The modified gen p mean: 0.4426395893096924, gen p mean: 0.0, mean p set: 0.4474627375602722
loss_pred:0.02650360018014908, decouple_loss:0.007490768097341061
loss_pred:0.025151308625936508, decouple_loss:0.007096336223185062
Iteration: 669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4408043324947357, gen p mean: 0.0, mean p set: 0.4460771083831787
loss_pred:0.026196841150522232, decouple_loss:0.007438404951244593
The modified gen p mean: 0.43979746103286743, gen p mean: 0.0, mean p set: 0.4470764696598053
The modified gen p mean: 0.43954378366470337, gen p mean: 0.0, mean p set: 0.4469709098339081
loss_pred:0.025408001616597176, decouple_loss:0.007137233391404152
loss_pred:0.026268038898706436, decouple_loss:0.00715575460344553
Iteration: 670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4449637234210968, gen p mean: 0.0, mean p set: 0.4464380145072937
The modified gen p mean: 0.4401467442512512, gen p mean: 0.0, mean p set: 0.4480360448360443
loss_pred:0.024813298135995865, decouple_loss:0.006978245917707682
loss_pred:0.024913273751735687, decouple_loss:0.007302877493202686
The modified gen p mean: 0.4462733268737793, gen p mean: 0.0, mean p set: 0.4468151926994324
loss_pred:0.025952041149139404, decouple_loss:0.006948181893676519
2023-05-04 14:35:29 testing...
The modified gen p mean: 0.45067065954208374, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4567866027355194, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4590977430343628, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.026707414537668228, decouple_loss:0.007389599457383156
loss_pred:0.02567601390182972, decouple_loss:0.007146748714148998
loss_pred:0.02536921575665474, decouple_loss:0.0071960813365876675
WV_0_PC_0_EH_0_PS_40_6, loss: 0.0262797549366951, avg_mse: 0.03210490196943283
current test mse: 0.032105
Iteration: 671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4578308165073395, gen p mean: 0.0, mean p set: 0.4459622800350189
The modified gen p mean: 0.45422545075416565, gen p mean: 0.0, mean p set: 0.4468543529510498
loss_pred:0.02595529519021511, decouple_loss:0.0069757974706590176
loss_pred:0.026496076956391335, decouple_loss:0.006877971347421408
The modified gen p mean: 0.4539119005203247, gen p mean: 0.0, mean p set: 0.4467245936393738
loss_pred:0.026039492338895798, decouple_loss:0.007019055541604757
Iteration: 672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798892736434937, gen p mean: 0.0, mean p set: 0.44626984000205994
loss_pred:0.026307785883545876, decouple_loss:0.007178084924817085
The modified gen p mean: 0.4380224049091339, gen p mean: 0.0, mean p set: 0.44760826230049133
The modified gen p mean: 0.4447178840637207, gen p mean: 0.0, mean p set: 0.44707679748535156
loss_pred:0.026129666715860367, decouple_loss:0.007199214305728674
loss_pred:0.026041369885206223, decouple_loss:0.00707975635305047
Iteration: 673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453311562538147, gen p mean: 0.0, mean p set: 0.4468507766723633
loss_pred:0.02487892657518387, decouple_loss:0.006799319759011269
The modified gen p mean: 0.4439297020435333, gen p mean: 0.0, mean p set: 0.44621503353118896
The modified gen p mean: 0.443525105714798, gen p mean: 0.0, mean p set: 0.4474280774593353
loss_pred:0.026003148406744003, decouple_loss:0.0069963657297194
loss_pred:0.02537495829164982, decouple_loss:0.00674600200727582
Iteration: 674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45394521951675415, gen p mean: 0.0, mean p set: 0.44694146513938904
loss_pred:0.025724243372678757, decouple_loss:0.006701224483549595
The modified gen p mean: 0.44961655139923096, gen p mean: 0.0, mean p set: 0.44749733805656433
The modified gen p mean: 0.4548918306827545, gen p mean: 0.0, mean p set: 0.4462999701499939
loss_pred:0.026542916893959045, decouple_loss:0.006833487190306187
loss_pred:0.026431823149323463, decouple_loss:0.007433954626321793
Iteration: 675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461463689804077, gen p mean: 0.0, mean p set: 0.44667208194732666
loss_pred:0.02589925192296505, decouple_loss:0.006348851602524519
The modified gen p mean: 0.44478994607925415, gen p mean: 0.0, mean p set: 0.4461705982685089
The modified gen p mean: 0.4394267201423645, gen p mean: 0.0, mean p set: 0.44810721278190613
loss_pred:0.025258449837565422, decouple_loss:0.006820907816290855
loss_pred:0.026722239330410957, decouple_loss:0.006751317996531725
Iteration: 676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4413791298866272, gen p mean: 0.0, mean p set: 0.44691601395606995
The modified gen p mean: 0.44245782494544983, gen p mean: 0.0, mean p set: 0.4471311867237091
loss_pred:0.026415614411234856, decouple_loss:0.006649171933531761
loss_pred:0.025580519810318947, decouple_loss:0.006333020515739918The modified gen p mean: 0.4367624819278717, gen p mean: 0.0, mean p set: 0.44872260093688965
loss_pred:0.024735454469919205, decouple_loss:0.0067816078662872314
Iteration: 677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452515572309494, gen p mean: 0.0, mean p set: 0.4472403824329376
loss_pred:0.026393871754407883, decouple_loss:0.0066893273033201694
The modified gen p mean: 0.4522879421710968, gen p mean: 0.0, mean p set: 0.4485476016998291
The modified gen p mean: 0.44404444098472595, gen p mean: 0.0, mean p set: 0.4468180239200592
loss_pred:0.02625887654721737, decouple_loss:0.0068229082971811295
loss_pred:0.024638706818223, decouple_loss:0.006808899808675051
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
NaN value num: 0
Iteration: 678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531862139701843, gen p mean: 0.0, mean p set: 0.4508860111236572
The modified gen p mean: 0.4514661431312561, gen p mean: 0.0, mean p set: 0.45023679733276367
The modified gen p mean: 0.45330068469047546, gen p mean: 0.0, mean p set: 0.45037439465522766
loss_pred:0.02557213231921196, decouple_loss:0.006913593504577875
loss_pred:0.025087999179959297, decouple_loss:0.006856868043541908
loss_pred:0.025697924196720123, decouple_loss:0.007181213237345219
Iteration: 679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.456012099981308, gen p mean: 0.0, mean p set: 0.4508816599845886
loss_pred:0.024388384073972702, decouple_loss:0.007341824937611818
The modified gen p mean: 0.4544755816459656, gen p mean: 0.0, mean p set: 0.4520488977432251
The modified gen p mean: 0.4477269947528839, gen p mean: 0.0, mean p set: 0.449785053730011
loss_pred:0.024942362681031227, decouple_loss:0.0071213142946362495
loss_pred:0.02599889598786831, decouple_loss:0.006571893580257893
Iteration: 680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44572198390960693, gen p mean: 0.0, mean p set: 0.4507678747177124
The modified gen p mean: 0.4437679946422577, gen p mean: 0.0, mean p set: 0.45180633664131165
loss_pred:0.02490844950079918, decouple_loss:0.006792317144572735
loss_pred:0.026128174737095833, decouple_loss:0.007180606946349144The modified gen p mean: 0.443324476480484, gen p mean: 0.0, mean p set: 0.45010891556739807
loss_pred:0.025781158357858658, decouple_loss:0.0066673788242042065
2023-05-04 14:39:54 testing...
The modified gen p mean: 0.44684678316116333, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45280909538269043, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45474058389663696, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02671542577445507, decouple_loss:0.007226722314953804
loss_pred:0.025687048211693764, decouple_loss:0.007116685155779123loss_pred:0.025424566119909286, decouple_loss:0.0071457428857684135
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026300501078367233, avg_mse: 0.032262951135635376
current test mse: 0.032263
Iteration: 681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45846638083457947, gen p mean: 0.0, mean p set: 0.4506262540817261
The modified gen p mean: 0.45642125606536865, gen p mean: 0.0, mean p set: 0.4518067240715027
loss_pred:0.02432856336236, decouple_loss:0.007011991925537586
loss_pred:0.02373305708169937, decouple_loss:0.006998179480433464
The modified gen p mean: 0.44838589429855347, gen p mean: 0.0, mean p set: 0.4498198330402374
loss_pred:0.02565549872815609, decouple_loss:0.006850336212664843
Iteration: 682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45185211300849915, gen p mean: 0.0, mean p set: 0.45049622654914856
The modified gen p mean: 0.4580051600933075, gen p mean: 0.0, mean p set: 0.4516959488391876
loss_pred:0.026508061215281487, decouple_loss:0.00689970375970006
loss_pred:0.02470109425485134, decouple_loss:0.006744027137756348
The modified gen p mean: 0.4507136642932892, gen p mean: 0.0, mean p set: 0.45142364501953125
loss_pred:0.025670398026704788, decouple_loss:0.006824333220720291
Iteration: 683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44419410824775696, gen p mean: 0.0, mean p set: 0.4523853361606598
loss_pred:0.025562480092048645, decouple_loss:0.006766787264496088
The modified gen p mean: 0.4425923228263855, gen p mean: 0.0, mean p set: 0.44928696751594543
The modified gen p mean: 0.4464254379272461, gen p mean: 0.0, mean p set: 0.4528287649154663
loss_pred:0.02524460479617119, decouple_loss:0.006646700669080019
loss_pred:0.024251125752925873, decouple_loss:0.006591474637389183
Iteration: 684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44655701518058777, gen p mean: 0.0, mean p set: 0.45208439230918884
loss_pred:0.02511431835591793, decouple_loss:0.007185677066445351
The modified gen p mean: 0.44666919112205505, gen p mean: 0.0, mean p set: 0.4494556486606598
The modified gen p mean: 0.4442143738269806, gen p mean: 0.0, mean p set: 0.4500194787979126
loss_pred:0.02508746087551117, decouple_loss:0.006560214329510927
loss_pred:0.02503521554172039, decouple_loss:0.006971870549023151
Iteration: 685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4660237729549408, gen p mean: 0.0, mean p set: 0.4518364667892456
The modified gen p mean: 0.4545031785964966, gen p mean: 0.0, mean p set: 0.4515089690685272
loss_pred:0.025160089135169983, decouple_loss:0.006622379645705223
loss_pred:0.025573724880814552, decouple_loss:0.0066633461974561214The modified gen p mean: 0.4630598723888397, gen p mean: 0.0, mean p set: 0.4523966908454895
loss_pred:0.02461208775639534, decouple_loss:0.006486736703664064
Iteration: 686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451820433139801, gen p mean: 0.0, mean p set: 0.45037025213241577
The modified gen p mean: 0.4531260132789612, gen p mean: 0.0, mean p set: 0.4501945972442627
loss_pred:0.025759652256965637, decouple_loss:0.006861012428998947
loss_pred:0.026121804490685463, decouple_loss:0.006738552823662758The modified gen p mean: 0.45494213700294495, gen p mean: 0.0, mean p set: 0.4517871141433716
loss_pred:0.02497195638716221, decouple_loss:0.006681972183287144
Iteration: 687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472089409828186, gen p mean: 0.0, mean p set: 0.451625794172287
loss_pred:0.024047693237662315, decouple_loss:0.006475623231381178
The modified gen p mean: 0.44144561886787415, gen p mean: 0.0, mean p set: 0.4512340724468231
The modified gen p mean: 0.44522330164909363, gen p mean: 0.0, mean p set: 0.44904741644859314
loss_pred:0.027472015470266342, decouple_loss:0.006884098518639803
loss_pred:0.02620595693588257, decouple_loss:0.006665970664471388
Iteration: 688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44834524393081665, gen p mean: 0.0, mean p set: 0.452411413192749
The modified gen p mean: 0.446787029504776, gen p mean: 0.0, mean p set: 0.4504021108150482
loss_pred:0.0253073088824749, decouple_loss:0.006853948347270489
loss_pred:0.027102986350655556, decouple_loss:0.006565105635672808The modified gen p mean: 0.44314515590667725, gen p mean: 0.0, mean p set: 0.45006316900253296
loss_pred:0.02527175471186638, decouple_loss:0.006422067992389202
Iteration: 689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524800777435303, gen p mean: 0.0, mean p set: 0.4506370425224304
loss_pred:0.02762046456336975, decouple_loss:0.0070007131434977055
The modified gen p mean: 0.45251256227493286, gen p mean: 0.0, mean p set: 0.4506132900714874
The modified gen p mean: 0.45787572860717773, gen p mean: 0.0, mean p set: 0.4503283202648163
loss_pred:0.024440329521894455, decouple_loss:0.00691223843023181
loss_pred:0.026147304102778435, decouple_loss:0.006349300034344196
Iteration: 690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45056426525115967, gen p mean: 0.0, mean p set: 0.4507118761539459
loss_pred:0.025486484169960022, decouple_loss:0.006501376628875732
The modified gen p mean: 0.456601083278656, gen p mean: 0.0, mean p set: 0.4509114921092987
The modified gen p mean: 0.45080864429473877, gen p mean: 0.0, mean p set: 0.44978898763656616
loss_pred:0.02430896647274494, decouple_loss:0.006680596619844437
loss_pred:0.024644844233989716, decouple_loss:0.006607938092201948
2023-05-04 14:43:25 testing...
The modified gen p mean: 0.44085976481437683, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44668570160865784, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44837188720703125, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.026740578934550285, decouple_loss:0.007221507374197245
loss_pred:0.025729697197675705, decouple_loss:0.007110573351383209
loss_pred:0.02537032589316368, decouple_loss:0.007028162479400635
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026302872225642204, avg_mse: 0.03231590986251831
current test mse: 0.032316
Iteration: 691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483146667480469, gen p mean: 0.0, mean p set: 0.4515781104564667
The modified gen p mean: 0.4485224187374115, gen p mean: 0.0, mean p set: 0.45276302099227905
loss_pred:0.02359021268785, decouple_loss:0.006711005698889494
loss_pred:0.025318529456853867, decouple_loss:0.006562831345945597
The modified gen p mean: 0.44619932770729065, gen p mean: 0.0, mean p set: 0.45094767212867737
loss_pred:0.027469366788864136, decouple_loss:0.0068246047012507915
Iteration: 692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44497406482696533, gen p mean: 0.0, mean p set: 0.44932547211647034
loss_pred:0.025506429374217987, decouple_loss:0.006349062547087669
The modified gen p mean: 0.4470512568950653, gen p mean: 0.0, mean p set: 0.44889846444129944
The modified gen p mean: 0.4455529451370239, gen p mean: 0.0, mean p set: 0.45217210054397583
loss_pred:0.025280293077230453, decouple_loss:0.0067550609819591045
loss_pred:0.02704370766878128, decouple_loss:0.00665286835283041
Iteration: 693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45314207673072815, gen p mean: 0.0, mean p set: 0.4506323039531708
loss_pred:0.025460103526711464, decouple_loss:0.00633030803874135
The modified gen p mean: 0.4619342088699341, gen p mean: 0.0, mean p set: 0.4523797929286957
The modified gen p mean: 0.4522991180419922, gen p mean: 0.0, mean p set: 0.4504729211330414
loss_pred:0.02495083212852478, decouple_loss:0.006496563088148832
loss_pred:0.025125088170170784, decouple_loss:0.006384456995874643
Iteration: 694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520871639251709, gen p mean: 0.0, mean p set: 0.4517802298069
loss_pred:0.024637361988425255, decouple_loss:0.006504885386675596
The modified gen p mean: 0.45694223046302795, gen p mean: 0.0, mean p set: 0.4519183933734894
The modified gen p mean: 0.451792448759079, gen p mean: 0.0, mean p set: 0.4517803192138672
loss_pred:0.026412632316350937, decouple_loss:0.006493533030152321
loss_pred:0.02376352809369564, decouple_loss:0.0064099812880158424
Iteration: 695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44917869567871094, gen p mean: 0.0, mean p set: 0.4505631625652313
loss_pred:0.024029960855841637, decouple_loss:0.00637389998883009
The modified gen p mean: 0.441459983587265, gen p mean: 0.0, mean p set: 0.4503953158855438
The modified gen p mean: 0.44912466406822205, gen p mean: 0.0, mean p set: 0.4521786570549011
loss_pred:0.023569662123918533, decouple_loss:0.006428213324397802
loss_pred:0.025417929515242577, decouple_loss:0.0062667145393788815
Iteration: 696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459838569164276, gen p mean: 0.0, mean p set: 0.44963186979293823
The modified gen p mean: 0.44655612111091614, gen p mean: 0.0, mean p set: 0.4492642879486084
loss_pred:0.026854872703552246, decouple_loss:0.0064299521036446095
loss_pred:0.025212770327925682, decouple_loss:0.006378513760864735
The modified gen p mean: 0.4475646913051605, gen p mean: 0.0, mean p set: 0.452788382768631
loss_pred:0.024895671755075455, decouple_loss:0.0065151904709637165
Iteration: 697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539868235588074, gen p mean: 0.0, mean p set: 0.44944655895233154
loss_pred:0.024491656571626663, decouple_loss:0.00639148848131299
The modified gen p mean: 0.4524407386779785, gen p mean: 0.0, mean p set: 0.45060670375823975
The modified gen p mean: 0.4546854496002197, gen p mean: 0.0, mean p set: 0.4510500431060791
loss_pred:0.025325264781713486, decouple_loss:0.006343384739011526
loss_pred:0.025594562292099, decouple_loss:0.006110372953116894
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
NaN value num: 0
Iteration: 698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46102485060691833, gen p mean: 0.0, mean p set: 0.4503384232521057
The modified gen p mean: 0.4618242084980011, gen p mean: 0.0, mean p set: 0.4489688575267792
loss_pred:0.025989802554249763, decouple_loss:0.006764085963368416
The modified gen p mean: 0.4595849812030792, gen p mean: 0.0, mean p set: 0.4524841606616974
loss_pred:0.024263665080070496, decouple_loss:0.006518686655908823
loss_pred:0.024630200117826462, decouple_loss:0.006473578047007322
Iteration: 699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451470375061035, gen p mean: 0.0, mean p set: 0.45094114542007446
loss_pred:0.02397400513291359, decouple_loss:0.006553506013005972
The modified gen p mean: 0.43960464000701904, gen p mean: 0.0, mean p set: 0.4516703188419342
The modified gen p mean: 0.44598183035850525, gen p mean: 0.0, mean p set: 0.44969022274017334
loss_pred:0.02471270225942135, decouple_loss:0.00661043543368578
loss_pred:0.025594118982553482, decouple_loss:0.00651661166921258
Iteration: 700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4418138861656189, gen p mean: 0.0, mean p set: 0.45163747668266296The modified gen p mean: 0.443655788898468, gen p mean: 0.0, mean p set: 0.4509385824203491
loss_pred:0.02366410382091999, decouple_loss:0.00642419932410121
loss_pred:0.024421820417046547, decouple_loss:0.00639503076672554
The modified gen p mean: 0.44203367829322815, gen p mean: 0.0, mean p set: 0.451826274394989
loss_pred:0.024676604196429253, decouple_loss:0.0063935862854123116
2023-05-04 14:47:37 testing...
The modified gen p mean: 0.4428923428058624, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4487994909286499, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45066797733306885, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.026711001992225647, decouple_loss:0.007390182465314865
loss_pred:0.0256967730820179, decouple_loss:0.007306389510631561
loss_pred:0.025316135957837105, decouple_loss:0.007346464321017265
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026275355368852615, avg_mse: 0.03230749070644379
current test mse: 0.032307
Iteration: 701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4561609923839569, gen p mean: 0.0, mean p set: 0.4507162272930145
The modified gen p mean: 0.45485296845436096, gen p mean: 0.0, mean p set: 0.45097577571868896
loss_pred:0.024059217423200607, decouple_loss:0.006637407001107931
loss_pred:0.02466602250933647, decouple_loss:0.006709755398333073
The modified gen p mean: 0.4546296298503876, gen p mean: 0.0, mean p set: 0.4513179361820221
loss_pred:0.023173002526164055, decouple_loss:0.006564245093613863
Iteration: 702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4561043083667755, gen p mean: 0.0, mean p set: 0.4517979323863983
loss_pred:0.022804828360676765, decouple_loss:0.006463213823735714
The modified gen p mean: 0.4556838274002075, gen p mean: 0.0, mean p set: 0.4485994875431061
The modified gen p mean: 0.4547021687030792, gen p mean: 0.0, mean p set: 0.4512156844139099
loss_pred:0.02395651489496231, decouple_loss:0.006534857675433159
loss_pred:0.024858010932803154, decouple_loss:0.007440273184329271
Iteration: 703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450332373380661, gen p mean: 0.0, mean p set: 0.4524308443069458
loss_pred:0.02424502559006214, decouple_loss:0.006461263168603182
The modified gen p mean: 0.448709100484848, gen p mean: 0.0, mean p set: 0.4508203864097595
The modified gen p mean: 0.4510951042175293, gen p mean: 0.0, mean p set: 0.4496423602104187
loss_pred:0.024388274177908897, decouple_loss:0.00649466784670949
loss_pred:0.025544386357069016, decouple_loss:0.007777942810207605
Iteration: 704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447240948677063, gen p mean: 0.0, mean p set: 0.44973814487457275
The modified gen p mean: 0.44635745882987976, gen p mean: 0.0, mean p set: 0.44945064187049866
loss_pred:0.025634905323386192, decouple_loss:0.007046804763376713
loss_pred:0.02507084794342518, decouple_loss:0.007274068426340818The modified gen p mean: 0.447121262550354, gen p mean: 0.0, mean p set: 0.44994789361953735
loss_pred:0.025833457708358765, decouple_loss:0.00720775593072176
Iteration: 705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44070520997047424, gen p mean: 0.0, mean p set: 0.450663298368454
loss_pred:0.02538532391190529, decouple_loss:0.00684008002281189
The modified gen p mean: 0.4444442093372345, gen p mean: 0.0, mean p set: 0.44948139786720276
The modified gen p mean: 0.44123467803001404, gen p mean: 0.0, mean p set: 0.4513757526874542
loss_pred:0.02352507784962654, decouple_loss:0.006769371218979359
loss_pred:0.0250075813382864, decouple_loss:0.006655551493167877
Iteration: 706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537372589111328, gen p mean: 0.0, mean p set: 0.4516293406486511
loss_pred:0.023777171969413757, decouple_loss:0.00642402283847332
The modified gen p mean: 0.45227617025375366, gen p mean: 0.0, mean p set: 0.45032238960266113
The modified gen p mean: 0.44970959424972534, gen p mean: 0.0, mean p set: 0.4514824450016022
loss_pred:0.02429278939962387, decouple_loss:0.006793959531933069
loss_pred:0.02528318762779236, decouple_loss:0.006839231122285128
Iteration: 707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4578555226325989, gen p mean: 0.0, mean p set: 0.4510786831378937
The modified gen p mean: 0.4558105170726776, gen p mean: 0.0, mean p set: 0.4524208605289459
loss_pred:0.023849042132496834, decouple_loss:0.006681368686258793
The modified gen p mean: 0.46159040927886963, gen p mean: 0.0, mean p set: 0.4509407579898834loss_pred:0.025833994150161743, decouple_loss:0.006972430273890495
loss_pred:0.023428121581673622, decouple_loss:0.006641285493969917
Iteration: 708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4613851308822632, gen p mean: 0.0, mean p set: 0.4519474506378174
The modified gen p mean: 0.46339327096939087, gen p mean: 0.0, mean p set: 0.4507116973400116
loss_pred:0.023135580122470856, decouple_loss:0.006378163583576679
loss_pred:0.025552740320563316, decouple_loss:0.006598360370844603The modified gen p mean: 0.4655596613883972, gen p mean: 0.0, mean p set: 0.4511450529098511
loss_pred:0.023446669802069664, decouple_loss:0.0065305051393806934
Iteration: 709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4420604109764099, gen p mean: 0.0, mean p set: 0.45174965262413025
The modified gen p mean: 0.44674253463745117, gen p mean: 0.0, mean p set: 0.4514772295951843
loss_pred:0.023369180038571358, decouple_loss:0.006437980569899082
loss_pred:0.023730944842100143, decouple_loss:0.006209848448634148The modified gen p mean: 0.44243311882019043, gen p mean: 0.0, mean p set: 0.45230305194854736
loss_pred:0.024157460778951645, decouple_loss:0.006288479547947645
Iteration: 710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4386593997478485, gen p mean: 0.0, mean p set: 0.448832631111145
The modified gen p mean: 0.4370788037776947, gen p mean: 0.0, mean p set: 0.45101502537727356
loss_pred:0.02494227886199951, decouple_loss:0.007077827118337154
loss_pred:0.024408763274550438, decouple_loss:0.006567813456058502The modified gen p mean: 0.43895965814590454, gen p mean: 0.0, mean p set: 0.45189934968948364
loss_pred:0.0233527310192585, decouple_loss:0.006246986333280802
2023-05-04 14:51:08 testing...
The modified gen p mean: 0.4444114863872528, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44996291399002075, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45153889060020447, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02723495103418827, decouple_loss:0.007651787716895342
loss_pred:0.026154005900025368, decouple_loss:0.00757835665717721
loss_pred:0.025754563510417938, decouple_loss:0.007507562171667814
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02676013670861721, avg_mse: 0.03318297117948532
current test mse: 0.033183
Iteration: 711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45223429799079895, gen p mean: 0.0, mean p set: 0.45162826776504517
The modified gen p mean: 0.4507397711277008, gen p mean: 0.0, mean p set: 0.45173394680023193
loss_pred:0.023131947964429855, decouple_loss:0.006496719550341368
loss_pred:0.024021094664931297, decouple_loss:0.006754366215318441
The modified gen p mean: 0.4494929611682892, gen p mean: 0.0, mean p set: 0.4511139988899231
loss_pred:0.025139959529042244, decouple_loss:0.006729570683091879
Iteration: 712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4601893126964569, gen p mean: 0.0, mean p set: 0.45111945271492004
The modified gen p mean: 0.46219247579574585, gen p mean: 0.0, mean p set: 0.44987818598747253
loss_pred:0.024583233520388603, decouple_loss:0.006558489054441452
loss_pred:0.02590540051460266, decouple_loss:0.007281469646841288
The modified gen p mean: 0.46634113788604736, gen p mean: 0.0, mean p set: 0.44922199845314026
loss_pred:0.026447007432579994, decouple_loss:0.007221081294119358
Iteration: 713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45156851410865784, gen p mean: 0.0, mean p set: 0.4523622393608093
The modified gen p mean: 0.4550764262676239, gen p mean: 0.0, mean p set: 0.4486648738384247
loss_pred:0.024697620421648026, decouple_loss:0.006539289839565754
loss_pred:0.025714697316288948, decouple_loss:0.006913454737514257
The modified gen p mean: 0.4522378444671631, gen p mean: 0.0, mean p set: 0.45272788405418396
loss_pred:0.025918392464518547, decouple_loss:0.006841091439127922
Iteration: 714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44148650765419006, gen p mean: 0.0, mean p set: 0.4511634409427643
loss_pred:0.025305690243840218, decouple_loss:0.00676325336098671
The modified gen p mean: 0.43913811445236206, gen p mean: 0.0, mean p set: 0.4486250877380371
The modified gen p mean: 0.43690550327301025, gen p mean: 0.0, mean p set: 0.45086607336997986
loss_pred:0.02608717605471611, decouple_loss:0.007318349555134773
loss_pred:0.026293236762285233, decouple_loss:0.006733844056725502
Iteration: 715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4424111843109131, gen p mean: 0.0, mean p set: 0.4503934979438782
The modified gen p mean: 0.44373589754104614, gen p mean: 0.0, mean p set: 0.45071932673454285
loss_pred:0.02493392489850521, decouple_loss:0.007093118038028479
loss_pred:0.024805905297398567, decouple_loss:0.006739923730492592The modified gen p mean: 0.4467989206314087, gen p mean: 0.0, mean p set: 0.4522624611854553
loss_pred:0.024801716208457947, decouple_loss:0.006769072264432907
Iteration: 716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4563424289226532, gen p mean: 0.0, mean p set: 0.4503360688686371
loss_pred:0.025293681770563126, decouple_loss:0.00796788651496172
The modified gen p mean: 0.45612868666648865, gen p mean: 0.0, mean p set: 0.4511736333370209
The modified gen p mean: 0.4558027684688568, gen p mean: 0.0, mean p set: 0.45086219906806946
loss_pred:0.025377182289958, decouple_loss:0.00753783667460084
loss_pred:0.024291163310408592, decouple_loss:0.007444372866302729
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
NaN value num: 0
Iteration: 717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496197998523712, gen p mean: 0.0, mean p set: 0.4522242546081543
The modified gen p mean: 0.45283475518226624, gen p mean: 0.0, mean p set: 0.451865553855896
loss_pred:0.02564132958650589, decouple_loss:0.007726270239800215
The modified gen p mean: 0.4579109251499176, gen p mean: 0.0, mean p set: 0.4539310038089752
loss_pred:0.02438591793179512, decouple_loss:0.007665643934160471
loss_pred:0.025195373222231865, decouple_loss:0.007577714044600725
Iteration: 718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4560810923576355, gen p mean: 0.0, mean p set: 0.4529041349887848
The modified gen p mean: 0.45631301403045654, gen p mean: 0.0, mean p set: 0.45359519124031067
loss_pred:0.024605751037597656, decouple_loss:0.007626502774655819
loss_pred:0.024816948920488358, decouple_loss:0.007635278627276421The modified gen p mean: 0.45867881178855896, gen p mean: 0.0, mean p set: 0.4503691494464874
loss_pred:0.02451212890446186, decouple_loss:0.007437179796397686
Iteration: 719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45171692967414856, gen p mean: 0.0, mean p set: 0.451384037733078
The modified gen p mean: 0.4527893662452698, gen p mean: 0.0, mean p set: 0.4509764611721039
loss_pred:0.023651262745261192, decouple_loss:0.007448253687471151
loss_pred:0.02432052604854107, decouple_loss:0.007723274640738964
The modified gen p mean: 0.45532703399658203, gen p mean: 0.0, mean p set: 0.453027606010437
loss_pred:0.024378055706620216, decouple_loss:0.007475069724023342
Iteration: 720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4408423900604248, gen p mean: 0.0, mean p set: 0.45214059948921204
The modified gen p mean: 0.43988481163978577, gen p mean: 0.0, mean p set: 0.4518068730831146
loss_pred:0.02578677050769329, decouple_loss:0.007872800342738628
loss_pred:0.025792088359594345, decouple_loss:0.007878754287958145The modified gen p mean: 0.43473780155181885, gen p mean: 0.0, mean p set: 0.4521753489971161
loss_pred:0.02578417770564556, decouple_loss:0.008046903647482395
2023-05-04 14:55:20 testing...
The modified gen p mean: 0.44840991497039795, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45540425181388855, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.45357760787010193, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.027173686772584915, decouple_loss:0.007747081108391285
loss_pred:0.025703465566039085, decouple_loss:0.007834569551050663
loss_pred:0.02610672265291214, decouple_loss:0.007724744733422995
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02671639993786812, avg_mse: 0.03302180767059326
current test mse: 0.033022
Iteration: 721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512457847595215, gen p mean: 0.0, mean p set: 0.4521616995334625
The modified gen p mean: 0.4525182247161865, gen p mean: 0.0, mean p set: 0.45181599259376526
loss_pred:0.025027841329574585, decouple_loss:0.0077142189256846905
loss_pred:0.024585535749793053, decouple_loss:0.0074359034188091755
The modified gen p mean: 0.455824613571167, gen p mean: 0.0, mean p set: 0.45266470313072205
loss_pred:0.02481761761009693, decouple_loss:0.007213497534394264
Iteration: 722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46196186542510986, gen p mean: 0.0, mean p set: 0.45193058252334595
loss_pred:0.024636078625917435, decouple_loss:0.00709365401417017
The modified gen p mean: 0.4627739489078522, gen p mean: 0.0, mean p set: 0.452752947807312
The modified gen p mean: 0.46050673723220825, gen p mean: 0.0, mean p set: 0.45293402671813965
loss_pred:0.02629968710243702, decouple_loss:0.0076795280911028385
loss_pred:0.025863248854875565, decouple_loss:0.0076911854557693005
Iteration: 723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45613518357276917, gen p mean: 0.0, mean p set: 0.4515356123447418
loss_pred:0.025853699073195457, decouple_loss:0.00745835667476058
The modified gen p mean: 0.45349323749542236, gen p mean: 0.0, mean p set: 0.45151403546333313
The modified gen p mean: 0.4576551020145416, gen p mean: 0.0, mean p set: 0.45189085602760315
loss_pred:0.024743186309933662, decouple_loss:0.007447925861924887
loss_pred:0.025012286379933357, decouple_loss:0.007456852123141289
Iteration: 724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44007784128189087, gen p mean: 0.0, mean p set: 0.45216134190559387
loss_pred:0.02580409124493599, decouple_loss:0.007538038771599531
The modified gen p mean: 0.4412580728530884, gen p mean: 0.0, mean p set: 0.45153874158859253
The modified gen p mean: 0.437071293592453, gen p mean: 0.0, mean p set: 0.45036500692367554
loss_pred:0.02441687136888504, decouple_loss:0.0074020856991410255
loss_pred:0.023952210322022438, decouple_loss:0.007443854119628668
Iteration: 725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44452589750289917, gen p mean: 0.0, mean p set: 0.45328596234321594
loss_pred:0.026499692350625992, decouple_loss:0.007766174618154764
The modified gen p mean: 0.4454649090766907, gen p mean: 0.0, mean p set: 0.45337265729904175
The modified gen p mean: 0.4431331753730774, gen p mean: 0.0, mean p set: 0.4521217942237854
loss_pred:0.02626827545464039, decouple_loss:0.007443544454872608
loss_pred:0.02423526719212532, decouple_loss:0.007253681309521198
Iteration: 726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46504107117652893, gen p mean: 0.0, mean p set: 0.4518103301525116
The modified gen p mean: 0.4666014313697815, gen p mean: 0.0, mean p set: 0.4520217776298523
loss_pred:0.02413892187178135, decouple_loss:0.007138275541365147
loss_pred:0.024932250380516052, decouple_loss:0.0074499016627669334The modified gen p mean: 0.46686825156211853, gen p mean: 0.0, mean p set: 0.45365968346595764
loss_pred:0.024819107726216316, decouple_loss:0.007437197025865316
Iteration: 727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45451366901397705, gen p mean: 0.0, mean p set: 0.45049792528152466
loss_pred:0.02428198792040348, decouple_loss:0.007869875989854336
The modified gen p mean: 0.45242083072662354, gen p mean: 0.0, mean p set: 0.4522145688533783
The modified gen p mean: 0.45729586482048035, gen p mean: 0.0, mean p set: 0.45199838280677795
loss_pred:0.025301437824964523, decouple_loss:0.007368951570242643
loss_pred:0.02621583268046379, decouple_loss:0.007739259395748377
Iteration: 728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4380462169647217, gen p mean: 0.0, mean p set: 0.4520357549190521
The modified gen p mean: 0.437763512134552, gen p mean: 0.0, mean p set: 0.4507259726524353
loss_pred:0.024779321625828743, decouple_loss:0.007199146784842014
loss_pred:0.024275075644254684, decouple_loss:0.007312660105526447
The modified gen p mean: 0.4383523166179657, gen p mean: 0.0, mean p set: 0.45137453079223633
loss_pred:0.025389108806848526, decouple_loss:0.007258932571858168
Iteration: 729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815412163734436, gen p mean: 0.0, mean p set: 0.45075303316116333
loss_pred:0.023806056007742882, decouple_loss:0.006954026874154806
The modified gen p mean: 0.4445676803588867, gen p mean: 0.0, mean p set: 0.4514019787311554
The modified gen p mean: 0.44718435406684875, gen p mean: 0.0, mean p set: 0.4500395953655243
loss_pred:0.023627545684576035, decouple_loss:0.006943595129996538
loss_pred:0.02374432608485222, decouple_loss:0.0069884867407381535
Iteration: 730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45603540539741516, gen p mean: 0.0, mean p set: 0.45279279351234436
loss_pred:0.02592470310628414, decouple_loss:0.007134412880986929
The modified gen p mean: 0.4550214409828186, gen p mean: 0.0, mean p set: 0.4514599144458771
The modified gen p mean: 0.45456820726394653, gen p mean: 0.0, mean p set: 0.4517495334148407
loss_pred:0.024461666122078896, decouple_loss:0.007025468163192272
loss_pred:0.025031419470906258, decouple_loss:0.0068501983769237995
2023-05-04 14:58:52 testing...
The modified gen p mean: 0.4481423497200012, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45634737610816956, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4537141025066376, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.026780588552355766, decouple_loss:0.007339102681726217
loss_pred:0.02535858005285263, decouple_loss:0.007351800799369812
loss_pred:0.02576781064271927, decouple_loss:0.00719103729352355
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02633369341492653, avg_mse: 0.03249570354819298
current test mse: 0.032496
Iteration: 731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4541028141975403, gen p mean: 0.0, mean p set: 0.45367300510406494
The modified gen p mean: 0.4585227072238922, gen p mean: 0.0, mean p set: 0.45405787229537964
loss_pred:0.026085518300533295, decouple_loss:0.007074369117617607
loss_pred:0.02482251077890396, decouple_loss:0.006651419680565596
The modified gen p mean: 0.4545043408870697, gen p mean: 0.0, mean p set: 0.45189085602760315
loss_pred:0.02409796230494976, decouple_loss:0.0066102552227675915
Iteration: 732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44637155532836914, gen p mean: 0.0, mean p set: 0.4523584544658661
The modified gen p mean: 0.4514959454536438, gen p mean: 0.0, mean p set: 0.45267003774642944
loss_pred:0.02510896325111389, decouple_loss:0.007052581757307053
The modified gen p mean: 0.4541371166706085, gen p mean: 0.0, mean p set: 0.4516959488391876loss_pred:0.025240812450647354, decouple_loss:0.006819607224315405
loss_pred:0.023946622386574745, decouple_loss:0.006575603503733873
Iteration: 733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4560593366622925, gen p mean: 0.0, mean p set: 0.45153123140335083
loss_pred:0.023673951625823975, decouple_loss:0.00648923683911562
The modified gen p mean: 0.4571603536605835, gen p mean: 0.0, mean p set: 0.4528812766075134
The modified gen p mean: 0.4537598192691803, gen p mean: 0.0, mean p set: 0.4523863196372986
loss_pred:0.02362532913684845, decouple_loss:0.006718997377902269
loss_pred:0.02538297511637211, decouple_loss:0.006923675537109375
Iteration: 734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4445333182811737, gen p mean: 0.0, mean p set: 0.45247751474380493
The modified gen p mean: 0.45064881443977356, gen p mean: 0.0, mean p set: 0.45055609941482544
loss_pred:0.02514488436281681, decouple_loss:0.006985250394791365
loss_pred:0.02606618031859398, decouple_loss:0.006843265146017075
The modified gen p mean: 0.45436376333236694, gen p mean: 0.0, mean p set: 0.45298269391059875
loss_pred:0.025032062083482742, decouple_loss:0.006810192950069904
Iteration: 735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486355185508728, gen p mean: 0.0, mean p set: 0.452322781085968
loss_pred:0.026073867455124855, decouple_loss:0.007013875525444746
The modified gen p mean: 0.4481399655342102, gen p mean: 0.0, mean p set: 0.451306015253067
The modified gen p mean: 0.44920143485069275, gen p mean: 0.0, mean p set: 0.4523301124572754
loss_pred:0.025765009224414825, decouple_loss:0.00681730080395937
loss_pred:0.024815598502755165, decouple_loss:0.006519852671772242
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
NaN value num: 0
Iteration: 736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45144370198249817, gen p mean: 0.0, mean p set: 0.45147088170051575
The modified gen p mean: 0.45334121584892273, gen p mean: 0.0, mean p set: 0.4497682452201843The modified gen p mean: 0.45167234539985657, gen p mean: 0.0, mean p set: 0.45010536909103394
loss_pred:0.024752795696258545, decouple_loss:0.006776650436222553loss_pred:0.025585072115063667, decouple_loss:0.006895315833389759
loss_pred:0.0246722474694252, decouple_loss:0.0068796840496361256
Iteration: 737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533994197845459, gen p mean: 0.0, mean p set: 0.45029133558273315
The modified gen p mean: 0.45164695382118225, gen p mean: 0.0, mean p set: 0.45007672905921936
loss_pred:0.02628917247056961, decouple_loss:0.007027790881693363
loss_pred:0.025152644142508507, decouple_loss:0.006834359373897314The modified gen p mean: 0.4494275152683258, gen p mean: 0.0, mean p set: 0.45199474692344666
loss_pred:0.02428181655704975, decouple_loss:0.0069808815605938435
Iteration: 738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478142261505127, gen p mean: 0.0, mean p set: 0.4522706866264343
The modified gen p mean: 0.4502447247505188, gen p mean: 0.0, mean p set: 0.44993916153907776
loss_pred:0.025822799652814865, decouple_loss:0.006953753065317869
loss_pred:0.02476445771753788, decouple_loss:0.007098312024027109The modified gen p mean: 0.4487943947315216, gen p mean: 0.0, mean p set: 0.45241761207580566
loss_pred:0.024974336847662926, decouple_loss:0.006854167208075523
Iteration: 739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45220184326171875, gen p mean: 0.0, mean p set: 0.4513498842716217
The modified gen p mean: 0.4488345682621002, gen p mean: 0.0, mean p set: 0.45220157504081726
loss_pred:0.024544723331928253, decouple_loss:0.00694561842828989
loss_pred:0.024658210575580597, decouple_loss:0.006913184653967619The modified gen p mean: 0.4497907757759094, gen p mean: 0.0, mean p set: 0.4516623318195343
loss_pred:0.02458232454955578, decouple_loss:0.006697384640574455
Iteration: 740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44938749074935913, gen p mean: 0.0, mean p set: 0.4504096210002899
loss_pred:0.025374116376042366, decouple_loss:0.006861669477075338
The modified gen p mean: 0.4509243071079254, gen p mean: 0.0, mean p set: 0.4520223140716553
The modified gen p mean: 0.45030125975608826, gen p mean: 0.0, mean p set: 0.45228299498558044
loss_pred:0.024791639298200607, decouple_loss:0.00687197083607316
loss_pred:0.025210844352841377, decouple_loss:0.006562735885381699
2023-05-04 15:03:08 testing...
The modified gen p mean: 0.44775786995887756, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45356011390686035, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45633038878440857, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02683636173605919, decouple_loss:0.007164435926824808
loss_pred:0.025788836181163788, decouple_loss:0.0069833677262067795
loss_pred:0.025407841429114342, decouple_loss:0.0070493342354893684
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026364296674728394, avg_mse: 0.032614924013614655
current test mse: 0.032615
Iteration: 741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45205017924308777, gen p mean: 0.0, mean p set: 0.4521428644657135
The modified gen p mean: 0.44528546929359436, gen p mean: 0.0, mean p set: 0.45190224051475525
loss_pred:0.024099569767713547, decouple_loss:0.006439774297177792
loss_pred:0.025989260524511337, decouple_loss:0.006962243467569351
The modified gen p mean: 0.4524865448474884, gen p mean: 0.0, mean p set: 0.4522954225540161
loss_pred:0.02478238195180893, decouple_loss:0.0065772091038525105
Iteration: 742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45482107996940613, gen p mean: 0.0, mean p set: 0.452203631401062
The modified gen p mean: 0.4559749364852905, gen p mean: 0.0, mean p set: 0.45101073384284973
loss_pred:0.025336630642414093, decouple_loss:0.006356105208396912
loss_pred:0.025983687490224838, decouple_loss:0.0066205523908138275
The modified gen p mean: 0.448102205991745, gen p mean: 0.0, mean p set: 0.4521483778953552
loss_pred:0.02571127749979496, decouple_loss:0.00662856874987483
Iteration: 743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45519357919692993, gen p mean: 0.0, mean p set: 0.4522424042224884
The modified gen p mean: 0.4555588662624359, gen p mean: 0.0, mean p set: 0.452263742685318
loss_pred:0.024612436071038246, decouple_loss:0.0065027824603021145
loss_pred:0.024532003328204155, decouple_loss:0.006346488371491432
The modified gen p mean: 0.45756587386131287, gen p mean: 0.0, mean p set: 0.4509834945201874
loss_pred:0.02500450797379017, decouple_loss:0.006501500494778156
Iteration: 744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45482155680656433, gen p mean: 0.0, mean p set: 0.4501630365848541
loss_pred:0.024164848029613495, decouple_loss:0.006636270321905613
The modified gen p mean: 0.4513646960258484, gen p mean: 0.0, mean p set: 0.44987794756889343
The modified gen p mean: 0.45323485136032104, gen p mean: 0.0, mean p set: 0.4517904818058014
loss_pred:0.025507885962724686, decouple_loss:0.006660138256847858
loss_pred:0.025743551552295685, decouple_loss:0.006549049634486437
Iteration: 745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44595491886138916, gen p mean: 0.0, mean p set: 0.45251601934432983
The modified gen p mean: 0.4445566236972809, gen p mean: 0.0, mean p set: 0.4515630006790161
loss_pred:0.024696044623851776, decouple_loss:0.006516635417938232
loss_pred:0.024531325325369835, decouple_loss:0.006309301592409611
The modified gen p mean: 0.4441092312335968, gen p mean: 0.0, mean p set: 0.4515727162361145
loss_pred:0.0246199332177639, decouple_loss:0.006371665745973587
Iteration: 746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44385600090026855, gen p mean: 0.0, mean p set: 0.45135000348091125
The modified gen p mean: 0.44557610154151917, gen p mean: 0.0, mean p set: 0.4502951502799988
loss_pred:0.024614855647087097, decouple_loss:0.0064167059026658535
loss_pred:0.024354564025998116, decouple_loss:0.006187828723341227The modified gen p mean: 0.4439493715763092, gen p mean: 0.0, mean p set: 0.4509831368923187
loss_pred:0.02573322504758835, decouple_loss:0.006470406427979469
Iteration: 747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45411643385887146, gen p mean: 0.0, mean p set: 0.45294854044914246
The modified gen p mean: 0.45526736974716187, gen p mean: 0.0, mean p set: 0.45418456196784973
loss_pred:0.024335790425539017, decouple_loss:0.0066943238489329815
loss_pred:0.024834273383021355, decouple_loss:0.00655662314966321The modified gen p mean: 0.4529416263103485, gen p mean: 0.0, mean p set: 0.4529906213283539
loss_pred:0.024340922012925148, decouple_loss:0.0064895921386778355
Iteration: 748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45860305428504944, gen p mean: 0.0, mean p set: 0.4498836398124695
The modified gen p mean: 0.46179071068763733, gen p mean: 0.0, mean p set: 0.453868567943573
loss_pred:0.025140073150396347, decouple_loss:0.006749740801751614
loss_pred:0.024547221139073372, decouple_loss:0.00686781108379364The modified gen p mean: 0.45858755707740784, gen p mean: 0.0, mean p set: 0.4525899887084961
loss_pred:0.024366145953536034, decouple_loss:0.0066370912827551365
Iteration: 749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4552476108074188, gen p mean: 0.0, mean p set: 0.4513280689716339
loss_pred:0.02431531436741352, decouple_loss:0.006400112062692642
The modified gen p mean: 0.4551578760147095, gen p mean: 0.0, mean p set: 0.451905757188797
The modified gen p mean: 0.4535635709762573, gen p mean: 0.0, mean p set: 0.449973464012146
loss_pred:0.02518904209136963, decouple_loss:0.00655074417591095
loss_pred:0.025019150227308273, decouple_loss:0.006301100365817547
Iteration: 750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43904444575309753, gen p mean: 0.0, mean p set: 0.4502543807029724
The modified gen p mean: 0.44155359268188477, gen p mean: 0.0, mean p set: 0.4515514075756073
loss_pred:0.026032671332359314, decouple_loss:0.006547421216964722
loss_pred:0.025416472926735878, decouple_loss:0.006566611584275961The modified gen p mean: 0.4416462481021881, gen p mean: 0.0, mean p set: 0.4532740116119385
loss_pred:0.02418590523302555, decouple_loss:0.006402204278856516
2023-05-04 15:06:39 testing...
The modified gen p mean: 0.4402875304222107, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44582539796829224, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4483819007873535, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.026659313589334488, decouple_loss:0.006850481498986483
loss_pred:0.025486988946795464, decouple_loss:0.006679271813482046
loss_pred:0.025185007601976395, decouple_loss:0.0067112138494849205
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026114454492926598, avg_mse: 0.03230797499418259
current test mse: 0.032308
Iteration: 751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452267289161682, gen p mean: 0.0, mean p set: 0.45054367184638977
The modified gen p mean: 0.44633686542510986, gen p mean: 0.0, mean p set: 0.4507746696472168
loss_pred:0.02384420856833458, decouple_loss:0.006165314931422472
loss_pred:0.025938143953680992, decouple_loss:0.006370831746608019
The modified gen p mean: 0.4433406591415405, gen p mean: 0.0, mean p set: 0.45079872012138367
loss_pred:0.025894204154610634, decouple_loss:0.006365776527673006
Iteration: 752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45821279287338257, gen p mean: 0.0, mean p set: 0.45082080364227295
loss_pred:0.024138160049915314, decouple_loss:0.006264694966375828
The modified gen p mean: 0.45355772972106934, gen p mean: 0.0, mean p set: 0.4509196877479553
The modified gen p mean: 0.4580669105052948, gen p mean: 0.0, mean p set: 0.4513210654258728
loss_pred:0.025324082002043724, decouple_loss:0.006244199816137552
loss_pred:0.025278426706790924, decouple_loss:0.00627074483782053
Iteration: 753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45008042454719543, gen p mean: 0.0, mean p set: 0.4503602981567383
loss_pred:0.024551747366786003, decouple_loss:0.0062987301498651505
The modified gen p mean: 0.44630956649780273, gen p mean: 0.0, mean p set: 0.45172062516212463
The modified gen p mean: 0.45145195722579956, gen p mean: 0.0, mean p set: 0.45166799426078796
loss_pred:0.02481977827847004, decouple_loss:0.00626054871827364
loss_pred:0.02583911269903183, decouple_loss:0.0062520140781998634
Iteration: 754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511941969394684, gen p mean: 0.0, mean p set: 0.4525294005870819
The modified gen p mean: 0.45077767968177795, gen p mean: 0.0, mean p set: 0.45361581444740295
loss_pred:0.024535350501537323, decouple_loss:0.00618263753131032
loss_pred:0.02458658255636692, decouple_loss:0.006686813198029995
The modified gen p mean: 0.44997599720954895, gen p mean: 0.0, mean p set: 0.4504365921020508
loss_pred:0.02406889572739601, decouple_loss:0.0063264756463468075
Iteration: 755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4610818922519684, gen p mean: 0.0, mean p set: 0.450778603553772
loss_pred:0.0251915380358696, decouple_loss:0.006173397414386272
The modified gen p mean: 0.4558638036251068, gen p mean: 0.0, mean p set: 0.4516597390174866
The modified gen p mean: 0.45488718152046204, gen p mean: 0.0, mean p set: 0.4498387575149536
loss_pred:0.025395985692739487, decouple_loss:0.006832472048699856
loss_pred:0.023971902206540108, decouple_loss:0.00635309424251318
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
NaN value num: 0
Iteration: 756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511561393737793, gen p mean: 0.0, mean p set: 0.4534589648246765
The modified gen p mean: 0.4535874128341675, gen p mean: 0.0, mean p set: 0.45018163323402405
loss_pred:0.025229213759303093, decouple_loss:0.006628513336181641
The modified gen p mean: 0.4552310109138489, gen p mean: 0.0, mean p set: 0.4501686692237854
loss_pred:0.024880945682525635, decouple_loss:0.006974807940423489
loss_pred:0.02523522637784481, decouple_loss:0.006334547884762287
Iteration: 757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44423362612724304, gen p mean: 0.0, mean p set: 0.4506070911884308
The modified gen p mean: 0.45149651169776917, gen p mean: 0.0, mean p set: 0.45087239146232605
loss_pred:0.0260775126516819, decouple_loss:0.0063157277181744576
loss_pred:0.02541515603661537, decouple_loss:0.006249654572457075
The modified gen p mean: 0.44988566637039185, gen p mean: 0.0, mean p set: 0.4499790072441101
loss_pred:0.025717901065945625, decouple_loss:0.006146344821900129
Iteration: 758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4429955780506134, gen p mean: 0.0, mean p set: 0.45031604170799255
loss_pred:0.026026973500847816, decouple_loss:0.006353151053190231
The modified gen p mean: 0.44479599595069885, gen p mean: 0.0, mean p set: 0.4505581855773926
The modified gen p mean: 0.4426708221435547, gen p mean: 0.0, mean p set: 0.450695663690567
loss_pred:0.0252673476934433, decouple_loss:0.005966572090983391
loss_pred:0.025802867487072945, decouple_loss:0.0060417382046580315
Iteration: 759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473956823348999, gen p mean: 0.0, mean p set: 0.4521060883998871
loss_pred:0.025346025824546814, decouple_loss:0.006632387638092041
The modified gen p mean: 0.44512271881103516, gen p mean: 0.0, mean p set: 0.45096808671951294
The modified gen p mean: 0.44703245162963867, gen p mean: 0.0, mean p set: 0.4497148096561432
loss_pred:0.02593940682709217, decouple_loss:0.006041588261723518
loss_pred:0.024931875988841057, decouple_loss:0.006080150604248047
Iteration: 760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45447245240211487, gen p mean: 0.0, mean p set: 0.4534813165664673
The modified gen p mean: 0.45454877614974976, gen p mean: 0.0, mean p set: 0.45028528571128845
loss_pred:0.025865204632282257, decouple_loss:0.0066649289801716805
loss_pred:0.024693800136446953, decouple_loss:0.006176302209496498
The modified gen p mean: 0.4511088728904724, gen p mean: 0.0, mean p set: 0.4502440094947815
loss_pred:0.026545343920588493, decouple_loss:0.0065505714155733585
2023-05-04 15:10:56 testing...
The modified gen p mean: 0.4473213851451874, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4537335932254791, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4563729166984558, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.026478838175535202, decouple_loss:0.006897837854921818
loss_pred:0.02545992285013199, decouple_loss:0.006713346112519503
loss_pred:0.025146400555968285, decouple_loss:0.006723515223711729
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02603396587073803, avg_mse: 0.03228231146931648
current test mse: 0.032282
Iteration: 761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4582937955856323, gen p mean: 0.0, mean p set: 0.4500192403793335
The modified gen p mean: 0.45975491404533386, gen p mean: 0.0, mean p set: 0.4507025480270386
loss_pred:0.025752674788236618, decouple_loss:0.0060772281140089035
loss_pred:0.0263941902667284, decouple_loss:0.006393494084477425
The modified gen p mean: 0.453060120344162, gen p mean: 0.0, mean p set: 0.4510878920555115
loss_pred:0.026040147989988327, decouple_loss:0.006270867306739092
Iteration: 762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44648173451423645, gen p mean: 0.0, mean p set: 0.4502916932106018
loss_pred:0.026010066270828247, decouple_loss:0.006212092470377684
The modified gen p mean: 0.4438096582889557, gen p mean: 0.0, mean p set: 0.4493838846683502
The modified gen p mean: 0.4501150846481323, gen p mean: 0.0, mean p set: 0.45020267367362976
loss_pred:0.026583392173051834, decouple_loss:0.006219025235623121
loss_pred:0.025823909789323807, decouple_loss:0.00642093550413847
Iteration: 763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702333211898804, gen p mean: 0.0, mean p set: 0.4505661725997925
The modified gen p mean: 0.44947946071624756, gen p mean: 0.0, mean p set: 0.45061424374580383
loss_pred:0.02423798479139805, decouple_loss:0.005978177301585674
loss_pred:0.024725960567593575, decouple_loss:0.005868476815521717The modified gen p mean: 0.4462616741657257, gen p mean: 0.0, mean p set: 0.4511836767196655
loss_pred:0.025822937488555908, decouple_loss:0.0062630497850477695
Iteration: 764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147329568862915, gen p mean: 0.0, mean p set: 0.4531964957714081
loss_pred:0.02531743235886097, decouple_loss:0.006508948747068644
The modified gen p mean: 0.44826340675354004, gen p mean: 0.0, mean p set: 0.45364704728126526
The modified gen p mean: 0.4521768391132355, gen p mean: 0.0, mean p set: 0.4496527314186096
loss_pred:0.025138862431049347, decouple_loss:0.006155815441161394
loss_pred:0.02503352053463459, decouple_loss:0.006577366031706333
Iteration: 765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452567458152771, gen p mean: 0.0, mean p set: 0.45219725370407104
loss_pred:0.024619732052087784, decouple_loss:0.0066878036595880985
The modified gen p mean: 0.4472050666809082, gen p mean: 0.0, mean p set: 0.44981902837753296
The modified gen p mean: 0.4487841725349426, gen p mean: 0.0, mean p set: 0.4493206739425659
loss_pred:0.025043416768312454, decouple_loss:0.006175320129841566
loss_pred:0.02502187341451645, decouple_loss:0.006476567126810551
Iteration: 766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474521279335022, gen p mean: 0.0, mean p set: 0.45020797848701477
loss_pred:0.025455987080931664, decouple_loss:0.006572470534592867
The modified gen p mean: 0.45242950320243835, gen p mean: 0.0, mean p set: 0.4507887363433838
The modified gen p mean: 0.4510505795478821, gen p mean: 0.0, mean p set: 0.45406150817871094
loss_pred:0.02443472482264042, decouple_loss:0.006468221079558134
loss_pred:0.024493690580129623, decouple_loss:0.006123889237642288
Iteration: 767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45867860317230225, gen p mean: 0.0, mean p set: 0.4532198905944824
loss_pred:0.02540201134979725, decouple_loss:0.006617102771997452
The modified gen p mean: 0.46057575941085815, gen p mean: 0.0, mean p set: 0.44982537627220154
The modified gen p mean: 0.45902425050735474, gen p mean: 0.0, mean p set: 0.45304545760154724
loss_pred:0.024916287511587143, decouple_loss:0.006722821854054928
loss_pred:0.025686044245958328, decouple_loss:0.006270624231547117
Iteration: 768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506489038467407, gen p mean: 0.0, mean p set: 0.4517436623573303
loss_pred:0.025719355791807175, decouple_loss:0.006282910238951445
The modified gen p mean: 0.4521007537841797, gen p mean: 0.0, mean p set: 0.4500143229961395
The modified gen p mean: 0.4489728808403015, gen p mean: 0.0, mean p set: 0.4520338773727417
loss_pred:0.025062384083867073, decouple_loss:0.006326028611510992
loss_pred:0.025279678404331207, decouple_loss:0.005894303787499666
Iteration: 769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4404867887496948, gen p mean: 0.0, mean p set: 0.4510722756385803
loss_pred:0.024881459772586823, decouple_loss:0.006237534340471029
The modified gen p mean: 0.44424644112586975, gen p mean: 0.0, mean p set: 0.45330190658569336
The modified gen p mean: 0.442263126373291, gen p mean: 0.0, mean p set: 0.45016786456108093
loss_pred:0.026170695200562477, decouple_loss:0.006110980175435543
loss_pred:0.024658825248479843, decouple_loss:0.006404954940080643
Iteration: 770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4541257321834564, gen p mean: 0.0, mean p set: 0.45045459270477295
loss_pred:0.024201292544603348, decouple_loss:0.005959442816674709
The modified gen p mean: 0.4510738253593445, gen p mean: 0.0, mean p set: 0.44924721121788025
The modified gen p mean: 0.45371997356414795, gen p mean: 0.0, mean p set: 0.44966429471969604
loss_pred:0.026136035099625587, decouple_loss:0.006266498472541571
loss_pred:0.025173284113407135, decouple_loss:0.006285781040787697
2023-05-04 15:14:26 testing...
The modified gen p mean: 0.4455948770046234, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4537454843521118, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.451569139957428, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.026385998353362083, decouple_loss:0.006792729254812002
loss_pred:0.025079647079110146, decouple_loss:0.006679648999124765
loss_pred:0.0253436341881752, decouple_loss:0.0066723087802529335
WV_0_PC_0_EH_0_PS_40_6, loss: 0.025938838720321655, avg_mse: 0.03210840001702309
current test mse: 0.032108
Iteration: 771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45085448026657104, gen p mean: 0.0, mean p set: 0.451905757188797
The modified gen p mean: 0.4505901336669922, gen p mean: 0.0, mean p set: 0.44921332597732544
loss_pred:0.024749161675572395, decouple_loss:0.006056748330593109
loss_pred:0.02573096565902233, decouple_loss:0.006151038687676191
The modified gen p mean: 0.4492641091346741, gen p mean: 0.0, mean p set: 0.44917213916778564
loss_pred:0.024852702394127846, decouple_loss:0.0061036366969347
Iteration: 772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502071440219879, gen p mean: 0.0, mean p set: 0.4531312584877014
The modified gen p mean: 0.44639071822166443, gen p mean: 0.0, mean p set: 0.4477446675300598
loss_pred:0.025222575291991234, decouple_loss:0.006485992111265659
loss_pred:0.02456085942685604, decouple_loss:0.0065750740468502045
The modified gen p mean: 0.44679751992225647, gen p mean: 0.0, mean p set: 0.44894298911094666
loss_pred:0.024295616894960403, decouple_loss:0.006444825790822506
Iteration: 773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45416364073753357, gen p mean: 0.0, mean p set: 0.4503326416015625
loss_pred:0.026351165026426315, decouple_loss:0.006154913455247879
The modified gen p mean: 0.4540478587150574, gen p mean: 0.0, mean p set: 0.45352625846862793
The modified gen p mean: 0.4560658633708954, gen p mean: 0.0, mean p set: 0.4528343677520752
loss_pred:0.024735288694500923, decouple_loss:0.006289246026426554
loss_pred:0.02476385049521923, decouple_loss:0.006415231619030237
Iteration: 774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45795804262161255, gen p mean: 0.0, mean p set: 0.45032599568367004
loss_pred:0.02469680644571781, decouple_loss:0.005816360004246235
The modified gen p mean: 0.4572909474372864, gen p mean: 0.0, mean p set: 0.45040273666381836
The modified gen p mean: 0.44872334599494934, gen p mean: 0.0, mean p set: 0.44903984665870667
loss_pred:0.02484641782939434, decouple_loss:0.006120938807725906
loss_pred:0.025652524083852768, decouple_loss:0.005960686597973108
Iteration: 775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44455868005752563, gen p mean: 0.0, mean p set: 0.45265257358551025
loss_pred:0.024614961817860603, decouple_loss:0.0060918573290109634
The modified gen p mean: 0.44283056259155273, gen p mean: 0.0, mean p set: 0.4516725242137909
The modified gen p mean: 0.44096091389656067, gen p mean: 0.0, mean p set: 0.4494048058986664
loss_pred:0.02437456138432026, decouple_loss:0.005635746754705906
loss_pred:0.025568686425685883, decouple_loss:0.005747657269239426
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512852430343628, gen p mean: 0.0, mean p set: 0.44768741726875305
The modified gen p mean: 0.44837725162506104, gen p mean: 0.0, mean p set: 0.44888240098953247
loss_pred:0.02515275776386261, decouple_loss:0.006525997072458267
The modified gen p mean: 0.44874656200408936, gen p mean: 0.0, mean p set: 0.4486927390098572
loss_pred:0.0255141519010067, decouple_loss:0.006167931482195854
loss_pred:0.025380710139870644, decouple_loss:0.006398917641490698
Iteration: 777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43910881876945496, gen p mean: 0.0, mean p set: 0.4479525089263916
The modified gen p mean: 0.4441934823989868, gen p mean: 0.0, mean p set: 0.44817930459976196
loss_pred:0.025450747460126877, decouple_loss:0.006403233855962753
loss_pred:0.02561211585998535, decouple_loss:0.0061683193780481815The modified gen p mean: 0.4436497986316681, gen p mean: 0.0, mean p set: 0.44713205099105835
loss_pred:0.025511479005217552, decouple_loss:0.006758556701242924
Iteration: 778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496608376502991, gen p mean: 0.0, mean p set: 0.4476470947265625
The modified gen p mean: 0.4472861886024475, gen p mean: 0.0, mean p set: 0.4486611485481262
loss_pred:0.025487300008535385, decouple_loss:0.006536385510116816
loss_pred:0.025369592010974884, decouple_loss:0.006911740638315678The modified gen p mean: 0.4481198489665985, gen p mean: 0.0, mean p set: 0.44732168316841125
loss_pred:0.02536052279174328, decouple_loss:0.006779308896511793
Iteration: 779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45333772897720337, gen p mean: 0.0, mean p set: 0.4482881724834442
loss_pred:0.025888390839099884, decouple_loss:0.006563116330653429
The modified gen p mean: 0.4621753394603729, gen p mean: 0.0, mean p set: 0.44764676690101624
The modified gen p mean: 0.45185208320617676, gen p mean: 0.0, mean p set: 0.4468553960323334
loss_pred:0.026421012356877327, decouple_loss:0.006560951936990023
loss_pred:0.025982216000556946, decouple_loss:0.006579902954399586
Iteration: 780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4387945830821991, gen p mean: 0.0, mean p set: 0.44708362221717834
The modified gen p mean: 0.4389882981777191, gen p mean: 0.0, mean p set: 0.4477759003639221
loss_pred:0.025546200573444366, decouple_loss:0.006226950325071812
loss_pred:0.02597867324948311, decouple_loss:0.00645379489287734
The modified gen p mean: 0.43894290924072266, gen p mean: 0.0, mean p set: 0.4471038579940796
loss_pred:0.027675477787852287, decouple_loss:0.006329523399472237
2023-05-04 15:18:44 testing...
The modified gen p mean: 0.4380800724029541, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44402581453323364, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4457598626613617, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02664513885974884, decouple_loss:0.0065394979901611805
loss_pred:0.025524336844682693, decouple_loss:0.006362822838127613
loss_pred:0.025140874087810516, decouple_loss:0.006412122864276171
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026092026382684708, avg_mse: 0.03233039006590843
current test mse: 0.03233
Iteration: 781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4448688328266144, gen p mean: 0.0, mean p set: 0.44842812418937683
The modified gen p mean: 0.44429269433021545, gen p mean: 0.0, mean p set: 0.44751641154289246
loss_pred:0.025836722925305367, decouple_loss:0.00626102602109313
loss_pred:0.02538701333105564, decouple_loss:0.006212528795003891
The modified gen p mean: 0.44685909152030945, gen p mean: 0.0, mean p set: 0.4471050798892975
loss_pred:0.025580722838640213, decouple_loss:0.006346145179122686
Iteration: 782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520277678966522, gen p mean: 0.0, mean p set: 0.44814640283584595
loss_pred:0.026078544557094574, decouple_loss:0.006458766758441925
The modified gen p mean: 0.44812870025634766, gen p mean: 0.0, mean p set: 0.4477875828742981
The modified gen p mean: 0.4461492896080017, gen p mean: 0.0, mean p set: 0.44765499234199524
loss_pred:0.02597842738032341, decouple_loss:0.006361191626638174
loss_pred:0.0260101780295372, decouple_loss:0.006418902892619371
Iteration: 783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44467881321907043, gen p mean: 0.0, mean p set: 0.4470112919807434
loss_pred:0.0245814248919487, decouple_loss:0.0064310310408473015
The modified gen p mean: 0.4451097249984741, gen p mean: 0.0, mean p set: 0.4476839005947113
The modified gen p mean: 0.44590243697166443, gen p mean: 0.0, mean p set: 0.44739529490470886
loss_pred:0.024448422715067863, decouple_loss:0.006161950062960386
loss_pred:0.024426056072115898, decouple_loss:0.006387457251548767
Iteration: 784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4377919137477875, gen p mean: 0.0, mean p set: 0.4473738372325897
The modified gen p mean: 0.4425591230392456, gen p mean: 0.0, mean p set: 0.44923636317253113
loss_pred:0.024708101525902748, decouple_loss:0.006604402791708708
loss_pred:0.02532006986439228, decouple_loss:0.006631667725741863The modified gen p mean: 0.43810051679611206, gen p mean: 0.0, mean p set: 0.4480327367782593
loss_pred:0.025642002001404762, decouple_loss:0.006581771187484264
Iteration: 785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45622119307518005, gen p mean: 0.0, mean p set: 0.44785767793655396
The modified gen p mean: 0.4607052803039551, gen p mean: 0.0, mean p set: 0.4476735293865204
loss_pred:0.026687733829021454, decouple_loss:0.00657451618462801
loss_pred:0.025903213769197464, decouple_loss:0.006407115142792463The modified gen p mean: 0.4598422348499298, gen p mean: 0.0, mean p set: 0.4477977156639099
loss_pred:0.025265201926231384, decouple_loss:0.006386894732713699
Iteration: 786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45983240008354187, gen p mean: 0.0, mean p set: 0.44743743538856506
loss_pred:0.025670982897281647, decouple_loss:0.007145738694816828
The modified gen p mean: 0.4556090533733368, gen p mean: 0.0, mean p set: 0.4478755593299866
The modified gen p mean: 0.460193008184433, gen p mean: 0.0, mean p set: 0.44688504934310913
loss_pred:0.02493024431169033, decouple_loss:0.006774955429136753
loss_pred:0.025650208815932274, decouple_loss:0.006726197898387909
Iteration: 787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4383135735988617, gen p mean: 0.0, mean p set: 0.4486280083656311
loss_pred:0.02508888579905033, decouple_loss:0.006616425700485706
The modified gen p mean: 0.4338967800140381, gen p mean: 0.0, mean p set: 0.44717565178871155
The modified gen p mean: 0.43974369764328003, gen p mean: 0.0, mean p set: 0.4465774595737457
loss_pred:0.026064591482281685, decouple_loss:0.0066156848333776
loss_pred:0.02597573958337307, decouple_loss:0.0066458540968596935
Iteration: 788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4367388188838959, gen p mean: 0.0, mean p set: 0.44715800881385803The modified gen p mean: 0.4397942125797272, gen p mean: 0.0, mean p set: 0.44869264960289
loss_pred:0.0241051334887743, decouple_loss:0.006674501579254866
loss_pred:0.025215649977326393, decouple_loss:0.006577376741915941
The modified gen p mean: 0.43846407532691956, gen p mean: 0.0, mean p set: 0.44801655411720276
loss_pred:0.02388748712837696, decouple_loss:0.006495878100395203
Iteration: 789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525969624519348, gen p mean: 0.0, mean p set: 0.4473371207714081
loss_pred:0.024071794003248215, decouple_loss:0.006536174099892378
The modified gen p mean: 0.45498335361480713, gen p mean: 0.0, mean p set: 0.4477759599685669
The modified gen p mean: 0.44918200373649597, gen p mean: 0.0, mean p set: 0.44662564992904663
loss_pred:0.025259552523493767, decouple_loss:0.0068220593966543674
loss_pred:0.025597242638468742, decouple_loss:0.006616335827857256
Iteration: 790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45696866512298584, gen p mean: 0.0, mean p set: 0.44862768054008484The modified gen p mean: 0.45067328214645386, gen p mean: 0.0, mean p set: 0.447934627532959
loss_pred:0.024816716089844704, decouple_loss:0.006401912309229374
loss_pred:0.02591072767972946, decouple_loss:0.0066108847968280315
The modified gen p mean: 0.45439353585243225, gen p mean: 0.0, mean p set: 0.4470026195049286
loss_pred:0.02541005238890648, decouple_loss:0.006646625231951475
2023-05-04 15:22:15 testing...
The modified gen p mean: 0.4425508677959442, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4482353627681732, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4501678943634033, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.026268498972058296, decouple_loss:0.006657854653894901
loss_pred:0.02518855594098568, decouple_loss:0.006616129074245691
loss_pred:0.024807650595903397, decouple_loss:0.006639895960688591
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02575346641242504, avg_mse: 0.03183789551258087
current test mse: 0.031838
Iteration: 791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471743106842041, gen p mean: 0.0, mean p set: 0.4465501010417938
The modified gen p mean: 0.44703778624534607, gen p mean: 0.0, mean p set: 0.4475066065788269
loss_pred:0.025083882734179497, decouple_loss:0.006459077820181847
loss_pred:0.02381405420601368, decouple_loss:0.006236875895410776
The modified gen p mean: 0.44878309965133667, gen p mean: 0.0, mean p set: 0.44860100746154785
loss_pred:0.02515505999326706, decouple_loss:0.006420201156288385
Iteration: 792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451112449169159, gen p mean: 0.0, mean p set: 0.447416752576828
loss_pred:0.024941623210906982, decouple_loss:0.006244285497814417
The modified gen p mean: 0.44017016887664795, gen p mean: 0.0, mean p set: 0.4472716748714447
The modified gen p mean: 0.4486903250217438, gen p mean: 0.0, mean p set: 0.44786933064460754
loss_pred:0.02550751529633999, decouple_loss:0.006170384120196104
loss_pred:0.026028834283351898, decouple_loss:0.006367558613419533
Iteration: 793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44136732816696167, gen p mean: 0.0, mean p set: 0.4474334716796875
The modified gen p mean: 0.4375838339328766, gen p mean: 0.0, mean p set: 0.4471111297607422
loss_pred:0.025158056989312172, decouple_loss:0.005978121422231197
loss_pred:0.02478639781475067, decouple_loss:0.006115290801972151The modified gen p mean: 0.44006189703941345, gen p mean: 0.0, mean p set: 0.4471876323223114
loss_pred:0.02551446482539177, decouple_loss:0.006032479926943779
Iteration: 794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45008522272109985, gen p mean: 0.0, mean p set: 0.44872787594795227
The modified gen p mean: 0.44602155685424805, gen p mean: 0.0, mean p set: 0.44764021039009094
loss_pred:0.024249762296676636, decouple_loss:0.006051213480532169
loss_pred:0.025880703702569008, decouple_loss:0.006213891785591841The modified gen p mean: 0.448286235332489, gen p mean: 0.0, mean p set: 0.44832831621170044
loss_pred:0.02517102286219597, decouple_loss:0.0063568660989403725
Iteration: 795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46125659346580505, gen p mean: 0.0, mean p set: 0.4476739168167114
The modified gen p mean: 0.45367398858070374, gen p mean: 0.0, mean p set: 0.4485190510749817
loss_pred:0.025501662865281105, decouple_loss:0.006236061453819275
loss_pred:0.02583860419690609, decouple_loss:0.006310104858130217The modified gen p mean: 0.459628164768219, gen p mean: 0.0, mean p set: 0.4477570950984955
loss_pred:0.025234105065464973, decouple_loss:0.006234504282474518
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514205753803253, gen p mean: 0.0, mean p set: 0.44771143794059753
The modified gen p mean: 0.4479354918003082, gen p mean: 0.0, mean p set: 0.44792598485946655
loss_pred:0.02600928209722042, decouple_loss:0.00667470321059227
The modified gen p mean: 0.4533240795135498, gen p mean: 0.0, mean p set: 0.44725102186203003
loss_pred:0.026302775368094444, decouple_loss:0.006512372754514217
loss_pred:0.02538766711950302, decouple_loss:0.006276455242186785
Iteration: 797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43349316716194153, gen p mean: 0.0, mean p set: 0.4490669369697571
loss_pred:0.025598401203751564, decouple_loss:0.006524498108774424
The modified gen p mean: 0.43655505776405334, gen p mean: 0.0, mean p set: 0.4480897784233093
The modified gen p mean: 0.4354017376899719, gen p mean: 0.0, mean p set: 0.4476645588874817
loss_pred:0.02659502811729908, decouple_loss:0.006449166219681501
loss_pred:0.026062745600938797, decouple_loss:0.006662621162831783
Iteration: 798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4437617063522339, gen p mean: 0.0, mean p set: 0.44833505153656006
The modified gen p mean: 0.4431633949279785, gen p mean: 0.0, mean p set: 0.44774720072746277
loss_pred:0.025835208594799042, decouple_loss:0.006868342403322458
loss_pred:0.02495015226304531, decouple_loss:0.006371393799781799The modified gen p mean: 0.44611257314682007, gen p mean: 0.0, mean p set: 0.44793930649757385
loss_pred:0.02610054984688759, decouple_loss:0.006086411885917187
Iteration: 799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45622336864471436, gen p mean: 0.0, mean p set: 0.4488099217414856
The modified gen p mean: 0.4587862193584442, gen p mean: 0.0, mean p set: 0.44781771302223206
loss_pred:0.02705306001007557, decouple_loss:0.006325163878500462
loss_pred:0.026359915733337402, decouple_loss:0.00662663858383894The modified gen p mean: 0.45919057726860046, gen p mean: 0.0, mean p set: 0.44820162653923035
loss_pred:0.026812618598341942, decouple_loss:0.0064153228886425495
Iteration: 800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44511377811431885, gen p mean: 0.0, mean p set: 0.4482428729534149
The modified gen p mean: 0.44704341888427734, gen p mean: 0.0, mean p set: 0.4477778375148773
loss_pred:0.025523105636239052, decouple_loss:0.006674271542578936
loss_pred:0.024845890700817108, decouple_loss:0.00638996995985508
The modified gen p mean: 0.450018972158432, gen p mean: 0.0, mean p set: 0.44783589243888855
