
load model: /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_0_PC_1_EH_0_PS_40_6/model_2000.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
train_data_files nums: 124
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676896929740906, gen p mean: -0.7202038764953613, mean p set: 0.44724923372268677
loss_pred:0.02854960225522518, decouple_loss:0.011955443769693375
The modified gen p mean: 0.4452609717845917, gen p mean: -0.7182325720787048, mean p set: 0.4457412362098694
loss_pred:0.02792184427380562, decouple_loss:0.011430193670094013
The modified gen p mean: 0.44683387875556946, gen p mean: -0.7105404138565063, mean p set: 0.44731420278549194
loss_pred:0.028239088132977486, decouple_loss:0.011586950160562992
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44561466574668884, gen p mean: -0.6357032656669617, mean p set: 0.44609498977661133
The modified gen p mean: 0.4481044113636017, gen p mean: -0.6442766785621643, mean p set: 0.4485847055912018
loss_pred:0.1273503303527832, decouple_loss:0.17602640390396118
loss_pred:0.12612242996692657, decouple_loss:0.17536358535289764
The modified gen p mean: 0.44685637950897217, gen p mean: -0.6294847130775452, mean p set: 0.44733667373657227
loss_pred:0.1277756690979004, decouple_loss:0.17643287777900696
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44587939977645874, gen p mean: -0.5502240657806396, mean p set: 0.44635969400405884
The modified gen p mean: 0.44811347126960754, gen p mean: -0.5562120079994202, mean p set: 0.44859373569488525
loss_pred:0.05722077935934067, decouple_loss:0.15419387817382812
loss_pred:0.05555882304906845, decouple_loss:0.15463802218437195
The modified gen p mean: 0.4458533823490143, gen p mean: -0.5484077334403992, mean p set: 0.4463336765766144
loss_pred:0.05584625527262688, decouple_loss:0.15343551337718964
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462960660457611, gen p mean: -0.6063627600669861, mean p set: 0.4467763900756836
loss_pred:0.055139582604169846, decouple_loss:0.14980432391166687
The modified gen p mean: 0.4477715492248535, gen p mean: -0.6109257936477661, mean p set: 0.4482518434524536
The modified gen p mean: 0.4478738307952881, gen p mean: -0.6089321374893188, mean p set: 0.4483541250228882
loss_pred:0.05249118432402611, decouple_loss:0.14889828860759735
loss_pred:0.05059975013136864, decouple_loss:0.14789223670959473
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478360712528229, gen p mean: -0.518277108669281, mean p set: 0.4483163356781006
loss_pred:0.049695197492837906, decouple_loss:0.11699595302343369
The modified gen p mean: 0.445453941822052, gen p mean: -0.5098713040351868, mean p set: 0.4459342360496521
The modified gen p mean: 0.4487365782260895, gen p mean: -0.5159137845039368, mean p set: 0.44921690225601196
loss_pred:0.04970601573586464, decouple_loss:0.1147436574101448
loss_pred:0.04952602833509445, decouple_loss:0.11727354675531387
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713306427001953, gen p mean: -0.5137541890144348, mean p set: 0.44761335849761963
The modified gen p mean: 0.44537967443466187, gen p mean: -0.5186110138893127, mean p set: 0.4458599388599396loss_pred:0.050404924899339676, decouple_loss:0.11455535888671875
loss_pred:0.04655993729829788, decouple_loss:0.11745502799749374
The modified gen p mean: 0.4471026659011841, gen p mean: -0.5209535360336304, mean p set: 0.4475829601287842
loss_pred:0.04569581523537636, decouple_loss:0.11445311456918716
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479116201400757, gen p mean: -0.5365116000175476, mean p set: 0.4483919143676758
loss_pred:0.04574732109904289, decouple_loss:0.11327057331800461
The modified gen p mean: 0.44745323061943054, gen p mean: -0.5356693267822266, mean p set: 0.44793352484703064
The modified gen p mean: 0.4464193284511566, gen p mean: -0.531577467918396, mean p set: 0.4468995928764343
loss_pred:0.044269513338804245, decouple_loss:0.11245083808898926
loss_pred:0.04612422734498978, decouple_loss:0.11129767447710037
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44541826844215393, gen p mean: -0.5108500123023987, mean p set: 0.44589856266975403
loss_pred:0.043747369199991226, decouple_loss:0.09308914840221405
The modified gen p mean: 0.4479689598083496, gen p mean: -0.5136726498603821, mean p set: 0.4484492540359497
The modified gen p mean: 0.44816336035728455, gen p mean: -0.5178055763244629, mean p set: 0.44864365458488464
loss_pred:0.04250302165746689, decouple_loss:0.08985041081905365
loss_pred:0.04290912300348282, decouple_loss:0.09051837772130966
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469396471977234, gen p mean: -0.5129553079605103, mean p set: 0.4474199414253235
loss_pred:0.04337718337774277, decouple_loss:0.08262257277965546
The modified gen p mean: 0.4489671587944031, gen p mean: -0.5238065123558044, mean p set: 0.4494474530220032
The modified gen p mean: 0.4461263120174408, gen p mean: -0.5201975703239441, mean p set: 0.4466065764427185
loss_pred:0.04085289686918259, decouple_loss:0.08823354542255402
loss_pred:0.041443634778261185, decouple_loss:0.08504273742437363
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479663372039795, gen p mean: -0.513186514377594, mean p set: 0.4484466016292572
The modified gen p mean: 0.445504754781723, gen p mean: -0.5132851004600525, mean p set: 0.4459850490093231
loss_pred:0.039843376725912094, decouple_loss:0.07746901363134384
loss_pred:0.03814544528722763, decouple_loss:0.07937947660684586The modified gen p mean: 0.4458296597003937, gen p mean: -0.5140448212623596, mean p set: 0.4463099241256714
loss_pred:0.03982696309685707, decouple_loss:0.07554401457309723
2023-05-04 10:16:01 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.522239089012146, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5201969742774963, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.524590253829956, mean p set: 0.4502691626548767
loss_pred:0.03707471489906311, decouple_loss:0.06868062913417816
loss_pred:0.0378391370177269, decouple_loss:0.0682145208120346
loss_pred:0.03901734948158264, decouple_loss:0.07076075673103333
WV_0_PC_1_EH_0_PS_40_6, loss: 0.04143800213932991, avg_mse: 0.04367769882082939
current test mse: 0.043678
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446970671415329, gen p mean: -0.5182849764823914, mean p set: 0.44745099544525146
The modified gen p mean: 0.4475785195827484, gen p mean: -0.5291046500205994, mean p set: 0.4480588138103485
loss_pred:0.04025588184595108, decouple_loss:0.06620050966739655
loss_pred:0.03886948525905609, decouple_loss:0.06948131322860718
The modified gen p mean: 0.44663065671920776, gen p mean: -0.5175405740737915, mean p set: 0.4471109211444855
loss_pred:0.03963709995150566, decouple_loss:0.0664590448141098
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470093846321106, gen p mean: -0.5642215609550476, mean p set: 0.4474896788597107
loss_pred:0.03677651286125183, decouple_loss:0.06493490189313889
The modified gen p mean: 0.44784945249557495, gen p mean: -0.5595038533210754, mean p set: 0.44832971692085266The modified gen p mean: 0.44656720757484436, gen p mean: -0.5586900115013123, mean p set: 0.44704747200012207
loss_pred:0.03841451182961464, decouple_loss:0.06531260162591934
loss_pred:0.0375639908015728, decouple_loss:0.06434740871191025
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460795521736145, gen p mean: -0.5586780905723572, mean p set: 0.4465598464012146
The modified gen p mean: 0.44572147727012634, gen p mean: -0.5610330104827881, mean p set: 0.44620171189308167
loss_pred:0.03638216853141785, decouple_loss:0.0567038431763649
loss_pred:0.037212077528238297, decouple_loss:0.05706005170941353
The modified gen p mean: 0.446615993976593, gen p mean: -0.5594420433044434, mean p set: 0.4470962882041931
loss_pred:0.037499360740184784, decouple_loss:0.05717131122946739
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478876292705536, gen p mean: -0.564035177230835, mean p set: 0.4483678936958313
loss_pred:0.036930978298187256, decouple_loss:0.05547964200377464
The modified gen p mean: 0.44718998670578003, gen p mean: -0.5588517189025879, mean p set: 0.4476702809333801
The modified gen p mean: 0.4471697509288788, gen p mean: -0.5552380681037903, mean p set: 0.4476500451564789
loss_pred:0.0369102768599987, decouple_loss:0.05418025329709053
loss_pred:0.03795015811920166, decouple_loss:0.052722904831171036
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461621940135956, gen p mean: -0.5671762228012085, mean p set: 0.4466424882411957
loss_pred:0.03752998635172844, decouple_loss:0.06172166392207146
The modified gen p mean: 0.44643428921699524, gen p mean: -0.566383421421051, mean p set: 0.44691455364227295
The modified gen p mean: 0.44742095470428467, gen p mean: -0.5718563199043274, mean p set: 0.4479012191295624
loss_pred:0.035424523055553436, decouple_loss:0.06082351878285408
loss_pred:0.03702833130955696, decouple_loss:0.06316438317298889
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770190119743347, gen p mean: -0.5815311074256897, mean p set: 0.44818219542503357
The modified gen p mean: 0.44766372442245483, gen p mean: -0.588796854019165, mean p set: 0.44814398884773254
loss_pred:0.03560016676783562, decouple_loss:0.05204331502318382
loss_pred:0.03482644632458687, decouple_loss:0.05336441844701767
The modified gen p mean: 0.44740989804267883, gen p mean: -0.5845919251441956, mean p set: 0.44789019227027893
loss_pred:0.034911591559648514, decouple_loss:0.051585327833890915
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44539394974708557, gen p mean: -0.5803046226501465, mean p set: 0.44587424397468567
loss_pred:0.03570229932665825, decouple_loss:0.04837512969970703
The modified gen p mean: 0.4461279511451721, gen p mean: -0.5839383602142334, mean p set: 0.4466082453727722
The modified gen p mean: 0.44708627462387085, gen p mean: -0.5892744660377502, mean p set: 0.44756653904914856
loss_pred:0.03529706224799156, decouple_loss:0.04883454367518425
loss_pred:0.03460933640599251, decouple_loss:0.047642193734645844
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474359452724457, gen p mean: -0.589424192905426, mean p set: 0.4479162395000458
The modified gen p mean: 0.44684791564941406, gen p mean: -0.575547993183136, mean p set: 0.44732820987701416
loss_pred:0.03465563803911209, decouple_loss:0.04743434861302376
loss_pred:0.035982418805360794, decouple_loss:0.044390350580215454
The modified gen p mean: 0.44625091552734375, gen p mean: -0.5781717896461487, mean p set: 0.44673120975494385
loss_pred:0.035021524876356125, decouple_loss:0.046164680272340775
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463479816913605, gen p mean: -0.5694559216499329, mean p set: 0.44682827591896057
The modified gen p mean: 0.4480862617492676, gen p mean: -0.581926703453064, mean p set: 0.4485665559768677
loss_pred:0.03459469601511955, decouple_loss:0.0436633937060833
loss_pred:0.03416085243225098, decouple_loss:0.04365001618862152
The modified gen p mean: 0.4473522901535034, gen p mean: -0.5718227028846741, mean p set: 0.4478325843811035
loss_pred:0.03528287634253502, decouple_loss:0.0433979369699955
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466838240623474, gen p mean: -0.5717570185661316, mean p set: 0.4471641182899475
The modified gen p mean: 0.44757893681526184, gen p mean: -0.5854163765907288, mean p set: 0.44805923104286194
loss_pred:0.03448191657662392, decouple_loss:0.04260996729135513
loss_pred:0.03371695429086685, decouple_loss:0.04429576173424721
The modified gen p mean: 0.4463559091091156, gen p mean: -0.5780313014984131, mean p set: 0.4468361735343933
loss_pred:0.0335872620344162, decouple_loss:0.04453063756227493
2023-05-04 10:19:35 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5900065302848816, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5906506776809692, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5953937768936157, mean p set: 0.4502691626548767
loss_pred:0.03204849734902382, decouple_loss:0.043898358941078186
loss_pred:0.03281571716070175, decouple_loss:0.04358204826712608
loss_pred:0.03387343883514404, decouple_loss:0.0450519435107708
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03512142598628998, avg_mse: 0.038606271147727966
current test mse: 0.038606
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502217173576355, gen p mean: -0.5916919708251953, mean p set: 0.4507019817829132
The modified gen p mean: 0.44807255268096924, gen p mean: -0.5924005508422852, mean p set: 0.44855284690856934
loss_pred:0.03272838890552521, decouple_loss:0.043696328997612
loss_pred:0.0332644023001194, decouple_loss:0.04461153224110603
The modified gen p mean: 0.44858092069625854, gen p mean: -0.5957328677177429, mean p set: 0.44906121492385864
loss_pred:0.03448668494820595, decouple_loss:0.047165315598249435
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840115308761597, gen p mean: -0.6071632504463196, mean p set: 0.44888144731521606
The modified gen p mean: 0.44896426796913147, gen p mean: -0.6034702062606812, mean p set: 0.44944456219673157loss_pred:0.032298944890499115, decouple_loss:0.04123200476169586
The modified gen p mean: 0.4484393894672394, gen p mean: -0.6073058843612671, mean p set: 0.4489196836948395
loss_pred:0.03275149315595627, decouple_loss:0.04131307825446129
loss_pred:0.03192795813083649, decouple_loss:0.04261591657996178
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496042728424072, gen p mean: -0.5988079905509949, mean p set: 0.4500845670700073
The modified gen p mean: 0.4491669237613678, gen p mean: -0.604120671749115, mean p set: 0.4496472179889679
loss_pred:0.03163159638643265, decouple_loss:0.04054129496216774
loss_pred:0.03343205153942108, decouple_loss:0.04132453352212906
The modified gen p mean: 0.44764411449432373, gen p mean: -0.6018745303153992, mean p set: 0.44812440872192383
loss_pred:0.03186935931444168, decouple_loss:0.04042873531579971
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45032787322998047, gen p mean: -0.5971575379371643, mean p set: 0.45080816745758057
loss_pred:0.032100893557071686, decouple_loss:0.03868081048130989
The modified gen p mean: 0.4490582346916199, gen p mean: -0.5929898619651794, mean p set: 0.44953852891921997
The modified gen p mean: 0.4496310353279114, gen p mean: -0.6017272472381592, mean p set: 0.4501113295555115
loss_pred:0.03361784294247627, decouple_loss:0.03831757605075836
loss_pred:0.031392890959978104, decouple_loss:0.03880861774086952
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500262141227722, gen p mean: -0.6076738834381104, mean p set: 0.4505065083503723
The modified gen p mean: 0.44799548387527466, gen p mean: -0.6091417074203491, mean p set: 0.44847577810287476
loss_pred:0.0313357450067997, decouple_loss:0.038392841815948486
loss_pred:0.03167801722884178, decouple_loss:0.04074832424521446
The modified gen p mean: 0.44749295711517334, gen p mean: -0.6092686653137207, mean p set: 0.44797325134277344
loss_pred:0.03259981796145439, decouple_loss:0.039339836686849594
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489058256149292, gen p mean: -0.6148812770843506, mean p set: 0.4493860900402069
The modified gen p mean: 0.44815143942832947, gen p mean: -0.6120792627334595, mean p set: 0.44863176345825195
loss_pred:0.03159348666667938, decouple_loss:0.03951137512922287
loss_pred:0.0319000706076622, decouple_loss:0.038316886872053146
The modified gen p mean: 0.44869494438171387, gen p mean: -0.6146098971366882, mean p set: 0.44917523860931396
loss_pred:0.03133781999349594, decouple_loss:0.038362473249435425
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945579767227173, gen p mean: -0.5985105037689209, mean p set: 0.44993606209754944
loss_pred:0.031034942716360092, decouple_loss:0.0360221266746521
The modified gen p mean: 0.4487926661968231, gen p mean: -0.6036922335624695, mean p set: 0.44927293062210083
The modified gen p mean: 0.44945183396339417, gen p mean: -0.5986454486846924, mean p set: 0.4499320983886719
loss_pred:0.03159372881054878, decouple_loss:0.03674779087305069
loss_pred:0.030811581760644913, decouple_loss:0.03651086986064911
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486786425113678, gen p mean: -0.6145232915878296, mean p set: 0.4491589367389679
The modified gen p mean: 0.44845178723335266, gen p mean: -0.621627688407898, mean p set: 0.44893211126327515
loss_pred:0.03119674138724804, decouple_loss:0.03404710069298744
loss_pred:0.03151820972561836, decouple_loss:0.03386750817298889
The modified gen p mean: 0.448386013507843, gen p mean: -0.6158344149589539, mean p set: 0.4488662779331207
loss_pred:0.031368352472782135, decouple_loss:0.033812716603279114
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497861862182617, gen p mean: -0.6148386001586914, mean p set: 0.45026645064353943The modified gen p mean: 0.4495837986469269, gen p mean: -0.6210717558860779, mean p set: 0.450064092874527
loss_pred:0.02974250540137291, decouple_loss:0.03438902646303177
loss_pred:0.03044498711824417, decouple_loss:0.03407291695475578
The modified gen p mean: 0.4489072561264038, gen p mean: -0.6274973750114441, mean p set: 0.4493875503540039
loss_pred:0.031494710594415665, decouple_loss:0.03449608013033867
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796493649482727, gen p mean: -0.6198116540908813, mean p set: 0.44844523072242737
The modified gen p mean: 0.44969338178634644, gen p mean: -0.6211708784103394, mean p set: 0.45017367601394653
loss_pred:0.031697485595941544, decouple_loss:0.038658734411001205
loss_pred:0.03101305477321148, decouple_loss:0.03700092434883118
The modified gen p mean: 0.4503535032272339, gen p mean: -0.6135145425796509, mean p set: 0.45083382725715637
loss_pred:0.03093574568629265, decouple_loss:0.03609532117843628
2023-05-04 10:23:54 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6184364557266235, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6273033618927002, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6206573247909546, mean p set: 0.4500633478164673
loss_pred:0.03281468152999878, decouple_loss:0.037739723920822144
loss_pred:0.03425050526857376, decouple_loss:0.03766176849603653
loss_pred:0.03349059820175171, decouple_loss:0.036562398076057434
WV_0_PC_1_EH_0_PS_40_6, loss: 0.035384662449359894, avg_mse: 0.03981959447264671
current test mse: 0.03982
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449711412191391, gen p mean: -0.6203708648681641, mean p set: 0.4501916468143463
The modified gen p mean: 0.44886526465415955, gen p mean: -0.6371509432792664, mean p set: 0.44934555888175964
loss_pred:0.03470547869801521, decouple_loss:0.03545372933149338
loss_pred:0.034167978912591934, decouple_loss:0.035903461277484894
The modified gen p mean: 0.4482744038105011, gen p mean: -0.6253178715705872, mean p set: 0.4487546980381012
loss_pred:0.03307754918932915, decouple_loss:0.036639805883169174
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484138786792755, gen p mean: -0.6153696775436401, mean p set: 0.4488941431045532
The modified gen p mean: 0.44978079199790955, gen p mean: -0.6119936108589172, mean p set: 0.45026108622550964
loss_pred:0.031983423978090286, decouple_loss:0.033728357404470444
loss_pred:0.03385334834456444, decouple_loss:0.035054516047239304
The modified gen p mean: 0.4493016302585602, gen p mean: -0.6123039722442627, mean p set: 0.4497818946838379
loss_pred:0.03403347358107567, decouple_loss:0.034149426966905594
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499596357345581, gen p mean: -0.6056509017944336, mean p set: 0.4504399299621582
The modified gen p mean: 0.4509904086589813, gen p mean: -0.6065759658813477, mean p set: 0.4514707326889038
loss_pred:0.03154011070728302, decouple_loss:0.03318990767002106
loss_pred:0.03146965429186821, decouple_loss:0.03320525586605072
The modified gen p mean: 0.45045018196105957, gen p mean: -0.6053227782249451, mean p set: 0.4509304463863373
loss_pred:0.03204347565770149, decouple_loss:0.033156637102365494
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492219388484955, gen p mean: -0.5922282934188843, mean p set: 0.4497022032737732
loss_pred:0.03329408913850784, decouple_loss:0.03373628854751587
The modified gen p mean: 0.448699414730072, gen p mean: -0.6023293137550354, mean p set: 0.4491797089576721
The modified gen p mean: 0.4479368031024933, gen p mean: -0.6049376726150513, mean p set: 0.4484170973300934
loss_pred:0.031520627439022064, decouple_loss:0.03345051780343056
loss_pred:0.03195025399327278, decouple_loss:0.034492429345846176
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483083486557007, gen p mean: -0.6093810796737671, mean p set: 0.4487886428833008
The modified gen p mean: 0.44989505410194397, gen p mean: -0.611611545085907, mean p set: 0.4503753185272217
loss_pred:0.03146910294890404, decouple_loss:0.03319278731942177
loss_pred:0.030980253592133522, decouple_loss:0.033282000571489334
The modified gen p mean: 0.4498195946216583, gen p mean: -0.6113957762718201, mean p set: 0.4502998888492584
loss_pred:0.030189339071512222, decouple_loss:0.032767608761787415
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45030322670936584, gen p mean: -0.6313444972038269, mean p set: 0.45078352093696594
The modified gen p mean: 0.44820013642311096, gen p mean: -0.6274576783180237, mean p set: 0.44868043065071106
loss_pred:0.030707277357578278, decouple_loss:0.033282071352005005
loss_pred:0.03074401058256626, decouple_loss:0.03337914124131203
The modified gen p mean: 0.447918564081192, gen p mean: -0.6304417848587036, mean p set: 0.4483988583087921
loss_pred:0.030564667657017708, decouple_loss:0.033321041613817215
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474797248840332, gen p mean: -0.6439356207847595, mean p set: 0.4479599893093109
loss_pred:0.031344715505838394, decouple_loss:0.033841781318187714
The modified gen p mean: 0.4487854838371277, gen p mean: -0.631209671497345, mean p set: 0.4492657780647278
The modified gen p mean: 0.44764530658721924, gen p mean: -0.6374866366386414, mean p set: 0.4481256306171417
loss_pred:0.03107251040637493, decouple_loss:0.032662563025951385
loss_pred:0.03136618062853813, decouple_loss:0.03415898233652115
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487479329109192, gen p mean: -0.618435800075531, mean p set: 0.4492282271385193
loss_pred:0.030763445422053337, decouple_loss:0.03002038225531578
The modified gen p mean: 0.44973480701446533, gen p mean: -0.6160387396812439, mean p set: 0.45021507143974304
The modified gen p mean: 0.44862014055252075, gen p mean: -0.6218464970588684, mean p set: 0.44910046458244324
loss_pred:0.031072411686182022, decouple_loss:0.03134230524301529
loss_pred:0.031204042956233025, decouple_loss:0.03235116973519325
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486227035522461, gen p mean: -0.6126540899276733, mean p set: 0.4491029977798462
The modified gen p mean: 0.4498697817325592, gen p mean: -0.6129676699638367, mean p set: 0.4503500759601593
loss_pred:0.03105551190674305, decouple_loss:0.03237442299723625
loss_pred:0.029675981029868126, decouple_loss:0.030137846246361732
The modified gen p mean: 0.4480952024459839, gen p mean: -0.6105757355690002, mean p set: 0.448575496673584
loss_pred:0.030710041522979736, decouple_loss:0.030534662306308746
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489375054836273, gen p mean: -0.6218076944351196, mean p set: 0.4494177997112274
loss_pred:0.030259935185313225, decouple_loss:0.029728800058364868
The modified gen p mean: 0.4502228796482086, gen p mean: -0.6129987835884094, mean p set: 0.4507031738758087
The modified gen p mean: 0.4473685026168823, gen p mean: -0.6195563077926636, mean p set: 0.4478487968444824
loss_pred:0.030187785625457764, decouple_loss:0.028818024322390556
loss_pred:0.030269470065832138, decouple_loss:0.030574753880500793
2023-05-04 10:27:28 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.620038628578186, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.6285894513130188, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6222377419471741, mean p set: 0.4500633478164673
loss_pred:0.02934424579143524, decouple_loss:0.03117530792951584
loss_pred:0.029897009953856468, decouple_loss:0.030005929991602898loss_pred:0.030909180641174316, decouple_loss:0.030414026230573654
WV_0_PC_1_EH_0_PS_40_6, loss: 0.0315767340362072, avg_mse: 0.03598092123866081
current test mse: 0.035981
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481632709503174, gen p mean: -0.62115478515625, mean p set: 0.4486435651779175
The modified gen p mean: 0.45043060183525085, gen p mean: -0.6242485046386719, mean p set: 0.45091089606285095
loss_pred:0.029542962089180946, decouple_loss:0.03318764269351959
loss_pred:0.030022218823432922, decouple_loss:0.034031569957733154
The modified gen p mean: 0.4473547339439392, gen p mean: -0.61749666929245, mean p set: 0.4478350281715393
loss_pred:0.030284659937024117, decouple_loss:0.03357243165373802
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945549964904785, gen p mean: -0.6242093443870544, mean p set: 0.44993579387664795
The modified gen p mean: 0.45023971796035767, gen p mean: -0.6276223063468933, mean p set: 0.45072001218795776
loss_pred:0.029870279133319855, decouple_loss:0.032845210283994675
loss_pred:0.029972467571496964, decouple_loss:0.030908731743693352
The modified gen p mean: 0.4491342306137085, gen p mean: -0.6218163967132568, mean p set: 0.4496145248413086
loss_pred:0.03097645752131939, decouple_loss:0.03164544329047203
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853904843330383, gen p mean: -0.6293262839317322, mean p set: 0.44901934266090393
The modified gen p mean: 0.44788646697998047, gen p mean: -0.6218751072883606, mean p set: 0.4483667314052582
loss_pred:0.02943025901913643, decouple_loss:0.030471976846456528
loss_pred:0.03010488674044609, decouple_loss:0.0290828850120306
The modified gen p mean: 0.44892340898513794, gen p mean: -0.6272286772727966, mean p set: 0.44940370321273804
loss_pred:0.030238159000873566, decouple_loss:0.029728060588240623
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499377906322479, gen p mean: -0.6306390762329102, mean p set: 0.45041805505752563
loss_pred:0.02895021066069603, decouple_loss:0.028672529384493828
The modified gen p mean: 0.4494793713092804, gen p mean: -0.6378399729728699, mean p set: 0.4499596655368805
The modified gen p mean: 0.4487953782081604, gen p mean: -0.6253969669342041, mean p set: 0.4492756426334381
loss_pred:0.02877284213900566, decouple_loss:0.028610562905669212
loss_pred:0.030816147103905678, decouple_loss:0.028472131118178368
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508521556854248, gen p mean: -0.6321679353713989, mean p set: 0.4513324499130249
The modified gen p mean: 0.4503285884857178, gen p mean: -0.6278324127197266, mean p set: 0.45080891251564026
loss_pred:0.029693609103560448, decouple_loss:0.026981059461832047
loss_pred:0.030765559524297714, decouple_loss:0.027950655668973923
The modified gen p mean: 0.4511122703552246, gen p mean: -0.6327489018440247, mean p set: 0.4515925347805023
loss_pred:0.028017330914735794, decouple_loss:0.026984643191099167
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784224033355713, gen p mean: -0.6174699068069458, mean p set: 0.4483225345611572
loss_pred:0.030212273821234703, decouple_loss:0.026732781901955605
The modified gen p mean: 0.44963958859443665, gen p mean: -0.6241562962532043, mean p set: 0.45011985301971436
The modified gen p mean: 0.4508323669433594, gen p mean: -0.6300487518310547, mean p set: 0.45131269097328186
loss_pred:0.02809138223528862, decouple_loss:0.027819465845823288
loss_pred:0.027339274063706398, decouple_loss:0.028390279039740562
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504573941230774, gen p mean: -0.6260344386100769, mean p set: 0.4509376883506775
The modified gen p mean: 0.4473794400691986, gen p mean: -0.6185989379882812, mean p set: 0.4478597342967987
loss_pred:0.029042862355709076, decouple_loss:0.025980481877923012
loss_pred:0.02965477667748928, decouple_loss:0.02755526453256607
The modified gen p mean: 0.44781580567359924, gen p mean: -0.6194033622741699, mean p set: 0.44829609990119934
loss_pred:0.02975199930369854, decouple_loss:0.02795388549566269
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900259375572205, gen p mean: -0.6283827424049377, mean p set: 0.44948288798332214
loss_pred:0.02726374752819538, decouple_loss:0.026031138375401497
The modified gen p mean: 0.44781234860420227, gen p mean: -0.6169779300689697, mean p set: 0.44829264283180237
The modified gen p mean: 0.4510965049266815, gen p mean: -0.6259682178497314, mean p set: 0.4515767991542816
loss_pred:0.028757881373167038, decouple_loss:0.02555948868393898
loss_pred:0.02758108079433441, decouple_loss:0.025607777759432793
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764041900634766, gen p mean: -0.6186324954032898, mean p set: 0.44812071323394775
loss_pred:0.02916097268462181, decouple_loss:0.025026749819517136
The modified gen p mean: 0.4482405185699463, gen p mean: -0.6223954558372498, mean p set: 0.4487208127975464
The modified gen p mean: 0.4497719407081604, gen p mean: -0.625939667224884, mean p set: 0.4502522349357605
loss_pred:0.02839355170726776, decouple_loss:0.024725617840886116
loss_pred:0.027618229389190674, decouple_loss:0.025062883272767067
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44923341274261475, gen p mean: -0.6347453594207764, mean p set: 0.44971367716789246
The modified gen p mean: 0.4495052695274353, gen p mean: -0.6368059515953064, mean p set: 0.4499855935573578
loss_pred:0.02979089505970478, decouple_loss:0.025204205885529518
loss_pred:0.027719974517822266, decouple_loss:0.024501895532011986
The modified gen p mean: 0.44994351267814636, gen p mean: -0.6386595368385315, mean p set: 0.4504237771034241
loss_pred:0.027969712391495705, decouple_loss:0.02542725019156933
2023-05-04 10:36:35 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.657477080821991, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6471295952796936, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6497915387153625, mean p set: 0.4500633478164673
loss_pred:0.03017549403011799, decouple_loss:0.026118794456124306
loss_pred:0.028565702959895134, decouple_loss:0.026057032868266106
loss_pred:0.02900649979710579, decouple_loss:0.02574114315211773
WV_0_PC_1_EH_0_PS_40_6, loss: 0.030547847971320152, avg_mse: 0.035244427621364594
current test mse: 0.035244
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890737533569336, gen p mean: -0.6455265283584595, mean p set: 0.44938766956329346
The modified gen p mean: 0.4489538371562958, gen p mean: -0.6487125158309937, mean p set: 0.44943416118621826
loss_pred:0.027487192302942276, decouple_loss:0.02396017126739025
loss_pred:0.027482055127620697, decouple_loss:0.023661166429519653
The modified gen p mean: 0.4504087269306183, gen p mean: -0.6477870941162109, mean p set: 0.450888991355896
loss_pred:0.028269417583942413, decouple_loss:0.02431836910545826
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45106568932533264, gen p mean: -0.6527785658836365, mean p set: 0.45154598355293274
loss_pred:0.027967503294348717, decouple_loss:0.022863168269395828
The modified gen p mean: 0.44947919249534607, gen p mean: -0.650888979434967, mean p set: 0.4499594569206238
The modified gen p mean: 0.45048201084136963, gen p mean: -0.6559609770774841, mean p set: 0.4509623348712921
loss_pred:0.027740759775042534, decouple_loss:0.023480825126171112
loss_pred:0.029055899009108543, decouple_loss:0.02340361662209034
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495418071746826, gen p mean: -0.6514992713928223, mean p set: 0.4500221312046051
The modified gen p mean: 0.4521694481372833, gen p mean: -0.6514659523963928, mean p set: 0.4526497423648834
loss_pred:0.02672664448618889, decouple_loss:0.02388612926006317
loss_pred:0.027022872120141983, decouple_loss:0.023519111797213554
The modified gen p mean: 0.45027220249176025, gen p mean: -0.6442013382911682, mean p set: 0.45075252652168274
loss_pred:0.028351740911602974, decouple_loss:0.023550933226943016
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45154479146003723, gen p mean: -0.6404326558113098, mean p set: 0.45202508568763733
loss_pred:0.030304860323667526, decouple_loss:0.023112796247005463
The modified gen p mean: 0.45113056898117065, gen p mean: -0.6465703248977661, mean p set: 0.45161086320877075
The modified gen p mean: 0.44889235496520996, gen p mean: -0.6401058435440063, mean p set: 0.44937264919281006
loss_pred:0.027769839391112328, decouple_loss:0.023333018645644188
loss_pred:0.029052285477519035, decouple_loss:0.02342643402516842
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495643079280853, gen p mean: -0.6414862871170044, mean p set: 0.4500446021556854
loss_pred:0.028016705065965652, decouple_loss:0.022237658500671387
The modified gen p mean: 0.45079004764556885, gen p mean: -0.6407730579376221, mean p set: 0.45127037167549133
The modified gen p mean: 0.45031601190567017, gen p mean: -0.6444358825683594, mean p set: 0.45079630613327026
loss_pred:0.027649277821183205, decouple_loss:0.021663907915353775
loss_pred:0.026798829436302185, decouple_loss:0.02168808877468109
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514255225658417, gen p mean: -0.6457216739654541, mean p set: 0.4519057869911194
The modified gen p mean: 0.4502425789833069, gen p mean: -0.6529192924499512, mean p set: 0.4507228434085846
loss_pred:0.030505357310175896, decouple_loss:0.02089507132768631
loss_pred:0.02803672105073929, decouple_loss:0.0217271838337183
The modified gen p mean: 0.4506310820579529, gen p mean: -0.6501843333244324, mean p set: 0.451111376285553
loss_pred:0.0270758718252182, decouple_loss:0.021207693964242935
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919106364250183, gen p mean: -0.6556481122970581, mean p set: 0.44967135787010193
The modified gen p mean: 0.4477938711643219, gen p mean: -0.647860586643219, mean p set: 0.4482741951942444
loss_pred:0.027686461806297302, decouple_loss:0.021467529237270355
loss_pred:0.028414098545908928, decouple_loss:0.021103184670209885
The modified gen p mean: 0.4492426812648773, gen p mean: -0.6516265273094177, mean p set: 0.4497230052947998
loss_pred:0.027625365182757378, decouple_loss:0.020717058330774307
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44983920454978943, gen p mean: -0.6593897342681885, mean p set: 0.45031946897506714
loss_pred:0.028049977496266365, decouple_loss:0.02158799022436142
The modified gen p mean: 0.44846534729003906, gen p mean: -0.6595937609672546, mean p set: 0.4489456117153168
The modified gen p mean: 0.4486335217952728, gen p mean: -0.6609336137771606, mean p set: 0.4491138160228729
loss_pred:0.027296897023916245, decouple_loss:0.020327407866716385
loss_pred:0.027976391837000847, decouple_loss:0.020208707079291344
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45174407958984375, gen p mean: -0.6707535982131958, mean p set: 0.45222434401512146
loss_pred:0.027397766709327698, decouple_loss:0.02001737244427204
The modified gen p mean: 0.4503253102302551, gen p mean: -0.6692714691162109, mean p set: 0.4508056342601776
The modified gen p mean: 0.4473605155944824, gen p mean: -0.6608984470367432, mean p set: 0.44784078001976013
loss_pred:0.026226598769426346, decouple_loss:0.02073163352906704
loss_pred:0.027648769319057465, decouple_loss:0.019779155030846596
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972679018974304, gen p mean: -0.6683009266853333, mean p set: 0.45020708441734314
loss_pred:0.028433606028556824, decouple_loss:0.019732654094696045
The modified gen p mean: 0.448962539434433, gen p mean: -0.6702428460121155, mean p set: 0.4494428038597107
The modified gen p mean: 0.44856590032577515, gen p mean: -0.6688404679298401, mean p set: 0.44904619455337524
loss_pred:0.027600131928920746, decouple_loss:0.019145619124174118
loss_pred:0.028516804799437523, decouple_loss:0.01925669237971306
2023-05-04 10:40:11 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6724780201911926, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6810218095779419, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6693644523620605, mean p set: 0.45035696029663086
loss_pred:0.028412600979208946, decouple_loss:0.021620169281959534
loss_pred:0.029446087777614594, decouple_loss:0.0221913680434227
loss_pred:0.027940677478909492, decouple_loss:0.021573534235358238
WV_0_PC_1_EH_0_PS_40_6, loss: 0.029689541086554527, avg_mse: 0.03466276824474335
current test mse: 0.034663
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480937123298645, gen p mean: -0.6700908541679382, mean p set: 0.4485739767551422
The modified gen p mean: 0.44779473543167114, gen p mean: -0.6672348380088806, mean p set: 0.44827502965927124
loss_pred:0.02834412083029747, decouple_loss:0.02291998267173767
loss_pred:0.028621580451726913, decouple_loss:0.022301923483610153
The modified gen p mean: 0.4466010630130768, gen p mean: -0.681659996509552, mean p set: 0.4470813572406769
loss_pred:0.028229281306266785, decouple_loss:0.021863626316189766
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482315480709076, gen p mean: -0.6613356471061707, mean p set: 0.4487118422985077
loss_pred:0.028161244466900826, decouple_loss:0.021443279460072517
The modified gen p mean: 0.4468335509300232, gen p mean: -0.6556393504142761, mean p set: 0.4473138451576233
The modified gen p mean: 0.44711536169052124, gen p mean: -0.6708440780639648, mean p set: 0.44759562611579895
loss_pred:0.028715994209051132, decouple_loss:0.023181840777397156
loss_pred:0.027735194191336632, decouple_loss:0.021946249529719353
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768717885017395, gen p mean: -0.6566867828369141, mean p set: 0.44816744327545166
The modified gen p mean: 0.4480712115764618, gen p mean: -0.6500644683837891, mean p set: 0.4485515058040619
loss_pred:0.028673356398940086, decouple_loss:0.02151811495423317
loss_pred:0.0294545479118824, decouple_loss:0.02118060551583767
The modified gen p mean: 0.44788992404937744, gen p mean: -0.6509339213371277, mean p set: 0.44837021827697754
loss_pred:0.02828390523791313, decouple_loss:0.02099497616291046
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677478075027466, gen p mean: -0.644729495048523, mean p set: 0.44725507497787476
The modified gen p mean: 0.4461391866207123, gen p mean: -0.6425451636314392, mean p set: 0.44661951065063477
loss_pred:0.02771112509071827, decouple_loss:0.02135417051613331
loss_pred:0.02793177217245102, decouple_loss:0.021828772500157356
The modified gen p mean: 0.44731026887893677, gen p mean: -0.6641120910644531, mean p set: 0.44779056310653687
loss_pred:0.02711760811507702, decouple_loss:0.02069615200161934
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462707042694092, gen p mean: -0.6542736291885376, mean p set: 0.4467509686946869
loss_pred:0.028472134843468666, decouple_loss:0.01995684579014778
The modified gen p mean: 0.4480925500392914, gen p mean: -0.6620229482650757, mean p set: 0.4485728442668915
The modified gen p mean: 0.4472237825393677, gen p mean: -0.6688516139984131, mean p set: 0.4477040469646454
loss_pred:0.027460815384984016, decouple_loss:0.02001052536070347
loss_pred:0.027447042986750603, decouple_loss:0.019843894988298416
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472489058971405, gen p mean: -0.6687609553337097, mean p set: 0.447729229927063
The modified gen p mean: 0.4473322331905365, gen p mean: -0.677848219871521, mean p set: 0.4478125274181366
loss_pred:0.02797466516494751, decouple_loss:0.019043028354644775
loss_pred:0.027081763371825218, decouple_loss:0.019709020853042603
The modified gen p mean: 0.44836685061454773, gen p mean: -0.6763098835945129, mean p set: 0.44884711503982544
loss_pred:0.027643350884318352, decouple_loss:0.019174937158823013
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473838210105896, gen p mean: -0.673694372177124, mean p set: 0.4478640854358673
The modified gen p mean: 0.4477333128452301, gen p mean: -0.6717873811721802, mean p set: 0.4482135772705078
loss_pred:0.027165904641151428, decouple_loss:0.019643492996692657
loss_pred:0.02757747285068035, decouple_loss:0.01867089606821537
The modified gen p mean: 0.44698426127433777, gen p mean: -0.6770310997962952, mean p set: 0.44746458530426025
loss_pred:0.02731492929160595, decouple_loss:0.01905905269086361
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749343395233154, gen p mean: -0.6687175035476685, mean p set: 0.44797375798225403
The modified gen p mean: 0.44816112518310547, gen p mean: -0.6660095453262329, mean p set: 0.4486413896083832
loss_pred:0.029372623190283775, decouple_loss:0.018315348774194717
loss_pred:0.026897387579083443, decouple_loss:0.018531600013375282
The modified gen p mean: 0.4477154016494751, gen p mean: -0.6696291565895081, mean p set: 0.4481956660747528
loss_pred:0.02743457444012165, decouple_loss:0.018489452078938484
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772443175315857, gen p mean: -0.6668521761894226, mean p set: 0.44820475578308105
loss_pred:0.028514279052615166, decouple_loss:0.018322261050343513
The modified gen p mean: 0.4479389190673828, gen p mean: -0.6714954376220703, mean p set: 0.4484192430973053
The modified gen p mean: 0.44708606600761414, gen p mean: -0.6691873669624329, mean p set: 0.44756636023521423
loss_pred:0.028523338958621025, decouple_loss:0.018026554957032204
loss_pred:0.027741914615035057, decouple_loss:0.01855885609984398
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643402099609375, gen p mean: -0.6596959233283997, mean p set: 0.44691428542137146
The modified gen p mean: 0.44594743847846985, gen p mean: -0.6660416126251221, mean p set: 0.44642776250839233
loss_pred:0.027869753539562225, decouple_loss:0.01868068426847458
loss_pred:0.027767686173319817, decouple_loss:0.01852826401591301
The modified gen p mean: 0.44793900847435, gen p mean: -0.6689834594726562, mean p set: 0.44841933250427246
loss_pred:0.028850993141531944, decouple_loss:0.01807120069861412
2023-05-04 10:44:50 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6615055203437805, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.6726405024528503, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6649284362792969, mean p set: 0.4500633478164673
loss_pred:0.028707927092909813, decouple_loss:0.019696597009897232loss_pred:0.027258126065135002, decouple_loss:0.01813080906867981
loss_pred:0.02773897722363472, decouple_loss:0.018556566908955574
WV_0_PC_1_EH_0_PS_40_6, loss: 0.0288414116948843, avg_mse: 0.033635228872299194
current test mse: 0.033635
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476853609085083, gen p mean: -0.6626026630401611, mean p set: 0.4481656849384308
The modified gen p mean: 0.44761785864830017, gen p mean: -0.665103018283844, mean p set: 0.44809815287590027
loss_pred:0.0278615802526474, decouple_loss:0.017178690060973167
loss_pred:0.026914319023489952, decouple_loss:0.019257433712482452
The modified gen p mean: 0.4473015367984772, gen p mean: -0.6624850034713745, mean p set: 0.4477818012237549
loss_pred:0.027107035741209984, decouple_loss:0.017742406576871872
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484720230102539, gen p mean: -0.6653234958648682, mean p set: 0.448952317237854
The modified gen p mean: 0.44840723276138306, gen p mean: -0.6627400517463684, mean p set: 0.44888749718666077
loss_pred:0.0274056326597929, decouple_loss:0.017984852194786072
loss_pred:0.026830414310097694, decouple_loss:0.017179174348711967
The modified gen p mean: 0.44725489616394043, gen p mean: -0.6697624325752258, mean p set: 0.4477352201938629
loss_pred:0.028008123859763145, decouple_loss:0.017162904143333435
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463503360748291, gen p mean: -0.6735299229621887, mean p set: 0.4468306601047516
The modified gen p mean: 0.4478013217449188, gen p mean: -0.6721819639205933, mean p set: 0.4482816159725189
loss_pred:0.026403984054923058, decouple_loss:0.01718802936375141
loss_pred:0.027479253709316254, decouple_loss:0.017051737755537033
The modified gen p mean: 0.4475243389606476, gen p mean: -0.6716161370277405, mean p set: 0.4480046033859253
loss_pred:0.02662546932697296, decouple_loss:0.016489623114466667
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724777340888977, gen p mean: -0.6716848015785217, mean p set: 0.4477280378341675
loss_pred:0.027963491156697273, decouple_loss:0.01652716100215912
The modified gen p mean: 0.44590359926223755, gen p mean: -0.6761359572410583, mean p set: 0.44638389348983765
The modified gen p mean: 0.4461376368999481, gen p mean: -0.6674906611442566, mean p set: 0.4466179311275482
loss_pred:0.026476923376321793, decouple_loss:0.016803773120045662
loss_pred:0.027563011273741722, decouple_loss:0.01722155325114727
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483828842639923, gen p mean: -0.6737578511238098, mean p set: 0.4488631784915924
loss_pred:0.02802036888897419, decouple_loss:0.01654905080795288
The modified gen p mean: 0.4474668800830841, gen p mean: -0.6737771034240723, mean p set: 0.4479471743106842
The modified gen p mean: 0.447325736284256, gen p mean: -0.6712899804115295, mean p set: 0.4478060305118561
loss_pred:0.027403656393289566, decouple_loss:0.016216043382883072
loss_pred:0.027436839416623116, decouple_loss:0.016332557424902916
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661808013916016, gen p mean: -0.6672510504722595, mean p set: 0.44709837436676025
The modified gen p mean: 0.44717881083488464, gen p mean: -0.674031138420105, mean p set: 0.44765913486480713
loss_pred:0.027651110664010048, decouple_loss:0.01655898615717888
loss_pred:0.027738433331251144, decouple_loss:0.015496429055929184
The modified gen p mean: 0.44736284017562866, gen p mean: -0.6742976903915405, mean p set: 0.44784313440322876
loss_pred:0.028115682303905487, decouple_loss:0.01593124307692051
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798794388771057, gen p mean: -0.6711207628250122, mean p set: 0.4484681785106659
loss_pred:0.02746471017599106, decouple_loss:0.015651743859052658
The modified gen p mean: 0.44749799370765686, gen p mean: -0.6778550148010254, mean p set: 0.44797828793525696
The modified gen p mean: 0.44676151871681213, gen p mean: -0.6847812533378601, mean p set: 0.44724181294441223
loss_pred:0.02767224982380867, decouple_loss:0.0157685074955225
loss_pred:0.026383396238088608, decouple_loss:0.016852686181664467
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485853910446167, gen p mean: -0.6740062832832336, mean p set: 0.4490656852722168
loss_pred:0.026832571253180504, decouple_loss:0.016161665320396423
The modified gen p mean: 0.4460480511188507, gen p mean: -0.6729727387428284, mean p set: 0.4465283155441284
The modified gen p mean: 0.44754183292388916, gen p mean: -0.6718136668205261, mean p set: 0.44802215695381165
loss_pred:0.02810455858707428, decouple_loss:0.015741663053631783
loss_pred:0.02682754397392273, decouple_loss:0.015528888441622257
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760996103286743, gen p mean: -0.6834656000137329, mean p set: 0.44809025526046753
The modified gen p mean: 0.4481946527957916, gen p mean: -0.6792172193527222, mean p set: 0.4486749470233917
loss_pred:0.02699718251824379, decouple_loss:0.015367069281637669
loss_pred:0.028168177232146263, decouple_loss:0.015329127199947834The modified gen p mean: 0.44671371579170227, gen p mean: -0.6772689819335938, mean p set: 0.44719401001930237
loss_pred:0.027873819693922997, decouple_loss:0.015495711006224155
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465268850326538, gen p mean: -0.6816686987876892, mean p set: 0.4470071494579315
The modified gen p mean: 0.44764432311058044, gen p mean: -0.6868079900741577, mean p set: 0.44812464714050293
loss_pred:0.026980265974998474, decouple_loss:0.015173128806054592
loss_pred:0.02697800099849701, decouple_loss:0.015060263685882092
The modified gen p mean: 0.44755229353904724, gen p mean: -0.6855942606925964, mean p set: 0.44803258776664734
loss_pred:0.027086755260825157, decouple_loss:0.015844950452446938
2023-05-04 10:48:27 testing...
The modified gen p mean: 0.4498766362667084, gen p mean: -0.6907030940055847, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7012150287628174, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6947215795516968, mean p set: 0.4500633478164673
loss_pred:0.027052387595176697, decouple_loss:0.015807781368494034
loss_pred:0.028432393446564674, decouple_loss:0.01716548390686512loss_pred:0.027431810274720192, decouple_loss:0.016262639313936234
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028459463268518448, avg_mse: 0.03327491506934166
current test mse: 0.033275
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
NaN value num: 0
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44926661252975464, gen p mean: -0.6870226263999939, mean p set: 0.4497469365596771
loss_pred:0.02728097140789032, decouple_loss:0.018776318058371544
The modified gen p mean: 0.45027074217796326, gen p mean: -0.6905902028083801, mean p set: 0.45075103640556335
loss_pred:0.026715818792581558, decouple_loss:0.020027045160531998
The modified gen p mean: 0.450730562210083, gen p mean: -0.694714367389679, mean p set: 0.4512108564376831
loss_pred:0.027152031660079956, decouple_loss:0.019893629476428032
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45159170031547546, gen p mean: -0.7008578181266785, mean p set: 0.45207199454307556The modified gen p mean: 0.44838088750839233, gen p mean: -0.6930744647979736, mean p set: 0.44886115193367004
loss_pred:0.026927100494503975, decouple_loss:0.018654657527804375
loss_pred:0.026857759803533554, decouple_loss:0.018693162128329277
The modified gen p mean: 0.45075684785842896, gen p mean: -0.7137895822525024, mean p set: 0.45123711228370667
loss_pred:0.02767597883939743, decouple_loss:0.020075276494026184
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449925035238266, gen p mean: -0.7062346339225769, mean p set: 0.4504052996635437
The modified gen p mean: 0.4501987099647522, gen p mean: -0.7026675343513489, mean p set: 0.4506790041923523
loss_pred:0.02679099328815937, decouple_loss:0.017900748178362846
loss_pred:0.02625182829797268, decouple_loss:0.017980903387069702
The modified gen p mean: 0.45214927196502686, gen p mean: -0.7078105807304382, mean p set: 0.45262953639030457
loss_pred:0.02667122893035412, decouple_loss:0.017950911074876785
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449672669172287, gen p mean: -0.7002337574958801, mean p set: 0.4501529335975647
The modified gen p mean: 0.4513145387172699, gen p mean: -0.6969737410545349, mean p set: 0.45179483294487
loss_pred:0.026461806148290634, decouple_loss:0.016817938536405563
loss_pred:0.026659881696105003, decouple_loss:0.017295874655246735
The modified gen p mean: 0.4510660171508789, gen p mean: -0.7018323540687561, mean p set: 0.4515463411808014
loss_pred:0.026490040123462677, decouple_loss:0.016509102657437325
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037171244621277, gen p mean: -0.6900942325592041, mean p set: 0.4508519768714905
The modified gen p mean: 0.4495488703250885, gen p mean: -0.6938457489013672, mean p set: 0.4500291645526886
loss_pred:0.02531137876212597, decouple_loss:0.017072532325983047
loss_pred:0.026380790397524834, decouple_loss:0.01772199012339115
The modified gen p mean: 0.44838547706604004, gen p mean: -0.6825447082519531, mean p set: 0.4488658010959625
loss_pred:0.026592325419187546, decouple_loss:0.017141517251729965
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45003727078437805, gen p mean: -0.687585711479187, mean p set: 0.45051753520965576
loss_pred:0.027025870978832245, decouple_loss:0.01703992858529091
The modified gen p mean: 0.4497402012348175, gen p mean: -0.6766355633735657, mean p set: 0.4502204656600952
The modified gen p mean: 0.45135098695755005, gen p mean: -0.6828228235244751, mean p set: 0.45183131098747253
loss_pred:0.026491140946745872, decouple_loss:0.01569017767906189
loss_pred:0.024896617978811264, decouple_loss:0.01603338122367859
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033106207847595, gen p mean: -0.6822215914726257, mean p set: 0.45081138610839844
The modified gen p mean: 0.4506820738315582, gen p mean: -0.6750107407569885, mean p set: 0.45116233825683594
loss_pred:0.027056269347667694, decouple_loss:0.01857817731797695
loss_pred:0.0262747872620821, decouple_loss:0.016245143488049507
The modified gen p mean: 0.44896262884140015, gen p mean: -0.6655823588371277, mean p set: 0.44944292306900024
loss_pred:0.02625906653702259, decouple_loss:0.01582164689898491
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450622022151947, gen p mean: -0.680768609046936, mean p set: 0.45110228657722473
The modified gen p mean: 0.44981926679611206, gen p mean: -0.6829857230186462, mean p set: 0.45029953122138977
loss_pred:0.02825831063091755, decouple_loss:0.017258936539292336
loss_pred:0.02674226462841034, decouple_loss:0.017095521092414856
The modified gen p mean: 0.4491015374660492, gen p mean: -0.6698824763298035, mean p set: 0.4495818316936493
loss_pred:0.02704635076224804, decouple_loss:0.01644231751561165
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500886797904968, gen p mean: -0.6967827081680298, mean p set: 0.4505689740180969
loss_pred:0.02637684904038906, decouple_loss:0.016057733446359634
The modified gen p mean: 0.4491910934448242, gen p mean: -0.6925029158592224, mean p set: 0.4496713876724243
The modified gen p mean: 0.4490896165370941, gen p mean: -0.6944670081138611, mean p set: 0.44956985116004944
loss_pred:0.026847371831536293, decouple_loss:0.017015831544995308
loss_pred:0.02634144388139248, decouple_loss:0.016412802040576935
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450952410697937, gen p mean: -0.7027074098587036, mean p set: 0.4514326751232147The modified gen p mean: 0.44895103573799133, gen p mean: -0.693042516708374, mean p set: 0.44943130016326904
loss_pred:0.02561468444764614, decouple_loss:0.016274236142635345
loss_pred:0.026619255542755127, decouple_loss:0.016153763979673386
The modified gen p mean: 0.4498765468597412, gen p mean: -0.7035417556762695, mean p set: 0.4503568708896637
loss_pred:0.026573576033115387, decouple_loss:0.01585651934146881
2023-05-04 10:52:56 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.695671796798706, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.707229733467102, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7001535892486572, mean p set: 0.4500633478164673
loss_pred:0.027292881160974503, decouple_loss:0.017792237922549248
loss_pred:0.028882725164294243, decouple_loss:0.018117031082510948
loss_pred:0.02778630144894123, decouple_loss:0.01780153438448906
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028882481157779694, avg_mse: 0.034001633524894714
current test mse: 0.034002
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451831579208374, gen p mean: -0.7021480202674866, mean p set: 0.4523118734359741
The modified gen p mean: 0.45020654797554016, gen p mean: -0.6986067295074463, mean p set: 0.45068684220314026
loss_pred:0.0265828687697649, decouple_loss:0.01613059639930725
loss_pred:0.025774935260415077, decouple_loss:0.016630705446004868
The modified gen p mean: 0.45193353295326233, gen p mean: -0.6979303359985352, mean p set: 0.45241379737854004
loss_pred:0.026225620880723, decouple_loss:0.016542086377739906
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493040144443512, gen p mean: -0.6814252734184265, mean p set: 0.4497842490673065
The modified gen p mean: 0.4499325454235077, gen p mean: -0.6866783499717712, mean p set: 0.4504128098487854
loss_pred:0.026233548298478127, decouple_loss:0.015211273916065693
loss_pred:0.026503369212150574, decouple_loss:0.01561169046908617
The modified gen p mean: 0.4492405652999878, gen p mean: -0.6822927594184875, mean p set: 0.4497208595275879
loss_pred:0.02682650089263916, decouple_loss:0.015282664448022842
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45103469491004944, gen p mean: -0.6968925595283508, mean p set: 0.45151498913764954
loss_pred:0.027309847995638847, decouple_loss:0.01758282072842121
The modified gen p mean: 0.4499701261520386, gen p mean: -0.6909059882164001, mean p set: 0.45045042037963867
The modified gen p mean: 0.4500882923603058, gen p mean: -0.6881119012832642, mean p set: 0.4505685865879059
loss_pred:0.026265764608979225, decouple_loss:0.01636250875890255
loss_pred:0.027701104059815407, decouple_loss:0.017621204257011414
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45067375898361206, gen p mean: -0.6883957982063293, mean p set: 0.45115405321121216
loss_pred:0.02504475601017475, decouple_loss:0.015271415002644062
The modified gen p mean: 0.44979918003082275, gen p mean: -0.6840289831161499, mean p set: 0.45027947425842285
The modified gen p mean: 0.44990262389183044, gen p mean: -0.681096076965332, mean p set: 0.45038288831710815
loss_pred:0.026291623711586, decouple_loss:0.015311013907194138
loss_pred:0.026726964861154556, decouple_loss:0.015680713579058647
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502076506614685, gen p mean: -0.6873739361763, mean p set: 0.4506879150867462
The modified gen p mean: 0.4491123855113983, gen p mean: -0.6877394318580627, mean p set: 0.449592649936676
loss_pred:0.027020059525966644, decouple_loss:0.01529170386493206
loss_pred:0.025946225970983505, decouple_loss:0.015371441841125488
The modified gen p mean: 0.4495244026184082, gen p mean: -0.6916146278381348, mean p set: 0.4500047266483307
loss_pred:0.02676866389811039, decouple_loss:0.015669463202357292
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490228295326233, gen p mean: -0.6919692754745483, mean p set: 0.4495031237602234
The modified gen p mean: 0.45185530185699463, gen p mean: -0.6908848881721497, mean p set: 0.4523356258869171
loss_pred:0.02574843168258667, decouple_loss:0.014836365357041359
loss_pred:0.025437351316213608, decouple_loss:0.015228848904371262
The modified gen p mean: 0.4503304064273834, gen p mean: -0.6880677938461304, mean p set: 0.45081067085266113
loss_pred:0.025685131549835205, decouple_loss:0.015794701874256134
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45050114393234253, gen p mean: -0.6944590210914612, mean p set: 0.45098140835762024
The modified gen p mean: 0.450014591217041, gen p mean: -0.7037326693534851, mean p set: 0.4504949152469635
loss_pred:0.026139458641409874, decouple_loss:0.015337527729570866
loss_pred:0.026074206456542015, decouple_loss:0.014776513911783695
The modified gen p mean: 0.4502185583114624, gen p mean: -0.6934242248535156, mean p set: 0.4506988525390625
loss_pred:0.025771448388695717, decouple_loss:0.014842201955616474
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490172564983368, gen p mean: -0.7007998824119568, mean p set: 0.4494975507259369
loss_pred:0.02603977732360363, decouple_loss:0.014622271992266178
The modified gen p mean: 0.45027145743370056, gen p mean: -0.706684410572052, mean p set: 0.45075175166130066
The modified gen p mean: 0.44981470704078674, gen p mean: -0.7031686305999756, mean p set: 0.45029497146606445
loss_pred:0.027702195569872856, decouple_loss:0.015885796397924423
loss_pred:0.02563009224832058, decouple_loss:0.014890051446855068
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494132697582245, gen p mean: -0.6997950077056885, mean p set: 0.4498935639858246
loss_pred:0.02638060972094536, decouple_loss:0.015244430862367153
The modified gen p mean: 0.4505167007446289, gen p mean: -0.7037928104400635, mean p set: 0.450996994972229
The modified gen p mean: 0.4504880905151367, gen p mean: -0.6973493099212646, mean p set: 0.4509684145450592
loss_pred:0.025692958384752274, decouple_loss:0.015600139275193214
loss_pred:0.02652514912188053, decouple_loss:0.015344259329140186
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44988730549812317, gen p mean: -0.7013933658599854, mean p set: 0.45036759972572327
The modified gen p mean: 0.4511227011680603, gen p mean: -0.7001200318336487, mean p set: 0.4516029953956604
loss_pred:0.02647416479885578, decouple_loss:0.0139527078717947
loss_pred:0.026012564077973366, decouple_loss:0.014303307048976421
The modified gen p mean: 0.4501641094684601, gen p mean: -0.6959711313247681, mean p set: 0.4506444036960602
loss_pred:0.025660783052444458, decouple_loss:0.015041905455291271
2023-05-04 10:56:30 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7043818831443787, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6928752660751343, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6968674063682556, mean p set: 0.4500633478164673
loss_pred:0.02868725173175335, decouple_loss:0.017133008688688278
loss_pred:0.027222992852330208, decouple_loss:0.016767341643571854
loss_pred:0.02765950933098793, decouple_loss:0.0166632067412138
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02869931235909462, avg_mse: 0.033833637833595276
current test mse: 0.033834
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
NaN value num: 0
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44610947370529175, gen p mean: -0.695916473865509, mean p set: 0.44658976793289185
The modified gen p mean: 0.44580167531967163, gen p mean: -0.7005822658538818, mean p set: 0.44628193974494934
loss_pred:0.02776648849248886, decouple_loss:0.01762455329298973
loss_pred:0.02798731066286564, decouple_loss:0.017335325479507446
The modified gen p mean: 0.4467996656894684, gen p mean: -0.7006232142448425, mean p set: 0.44727998971939087
loss_pred:0.029051942750811577, decouple_loss:0.016193682327866554
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864150881767273, gen p mean: -0.6993772387504578, mean p set: 0.44912174344062805
The modified gen p mean: 0.4470677375793457, gen p mean: -0.7007909417152405, mean p set: 0.4475480318069458
loss_pred:0.027395596727728844, decouple_loss:0.01615191623568535
loss_pred:0.027909409254789352, decouple_loss:0.016964979469776154
The modified gen p mean: 0.44767454266548157, gen p mean: -0.698530375957489, mean p set: 0.44815483689308167
loss_pred:0.028044113889336586, decouple_loss:0.017590805888175964
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481680393218994, gen p mean: -0.6981313824653625, mean p set: 0.4486483037471771
The modified gen p mean: 0.4473022222518921, gen p mean: -0.6925761103630066, mean p set: 0.4477825164794922
loss_pred:0.029033387079834938, decouple_loss:0.016407247632741928
loss_pred:0.027990859001874924, decouple_loss:0.015960296615958214
The modified gen p mean: 0.44836103916168213, gen p mean: -0.6954197883605957, mean p set: 0.4488413631916046
loss_pred:0.028237359598279, decouple_loss:0.016403891146183014
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44449174404144287, gen p mean: -0.698755145072937, mean p set: 0.4449720084667206
The modified gen p mean: 0.4492722451686859, gen p mean: -0.6963489651679993, mean p set: 0.449752539396286
loss_pred:0.028481990098953247, decouple_loss:0.015598161146044731
loss_pred:0.026158539578318596, decouple_loss:0.015063881874084473
The modified gen p mean: 0.44909387826919556, gen p mean: -0.6975656747817993, mean p set: 0.44957417249679565
loss_pred:0.026063673198223114, decouple_loss:0.015407117083668709
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722214341163635, gen p mean: -0.698286235332489, mean p set: 0.44770243763923645
loss_pred:0.028301211073994637, decouple_loss:0.015264793299138546
The modified gen p mean: 0.448302686214447, gen p mean: -0.6975356340408325, mean p set: 0.4487829804420471
The modified gen p mean: 0.44626855850219727, gen p mean: -0.7013084292411804, mean p set: 0.44674885272979736
loss_pred:0.027131346985697746, decouple_loss:0.015276150777935982
loss_pred:0.027589133009314537, decouple_loss:0.015269760973751545
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476347863674164, gen p mean: -0.7102596163749695, mean p set: 0.44811511039733887
The modified gen p mean: 0.4468501806259155, gen p mean: -0.7041006684303284, mean p set: 0.4473304748535156
loss_pred:0.02908473275601864, decouple_loss:0.01529811043292284
loss_pred:0.027265630662441254, decouple_loss:0.014976002275943756
The modified gen p mean: 0.4457978904247284, gen p mean: -0.7010809779167175, mean p set: 0.4462781846523285
loss_pred:0.027594823390245438, decouple_loss:0.015012630261480808
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480065107345581, gen p mean: -0.7194170355796814, mean p set: 0.4484868049621582
The modified gen p mean: 0.4503893554210663, gen p mean: -0.713312566280365, mean p set: 0.450869619846344
loss_pred:0.029262075200676918, decouple_loss:0.01595398597419262
loss_pred:0.02638865076005459, decouple_loss:0.014915340580046177
The modified gen p mean: 0.4452667832374573, gen p mean: -0.7161610722541809, mean p set: 0.4457470774650574
loss_pred:0.027078084647655487, decouple_loss:0.015095402486622334
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479103982448578, gen p mean: -0.7250300049781799, mean p set: 0.4483906924724579
loss_pred:0.02864866890013218, decouple_loss:0.014633378013968468
The modified gen p mean: 0.4472946226596832, gen p mean: -0.7168693542480469, mean p set: 0.4477749764919281
loss_pred:0.029121993109583855, decouple_loss:0.01443427987396717
The modified gen p mean: 0.4467070400714874, gen p mean: -0.7229659557342529, mean p set: 0.44718730449676514
loss_pred:0.02755250222980976, decouple_loss:0.014659468084573746
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451453387737274, gen p mean: -0.720629096031189, mean p set: 0.4456256330013275
The modified gen p mean: 0.4447520673274994, gen p mean: -0.7165952324867249, mean p set: 0.4452323615550995
loss_pred:0.02766871079802513, decouple_loss:0.014173941686749458
loss_pred:0.02692718803882599, decouple_loss:0.014869366772472858
The modified gen p mean: 0.44587594270706177, gen p mean: -0.712271511554718, mean p set: 0.44635626673698425
loss_pred:0.026899609714746475, decouple_loss:0.015263792127370834
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480220079421997, gen p mean: -0.7017495036125183, mean p set: 0.4485023021697998
The modified gen p mean: 0.4458322525024414, gen p mean: -0.7000831365585327, mean p set: 0.4463125169277191
loss_pred:0.027738085016608238, decouple_loss:0.014573205262422562
loss_pred:0.027241786941885948, decouple_loss:0.014378197491168976
The modified gen p mean: 0.4499937891960144, gen p mean: -0.7013640403747559, mean p set: 0.4504740536212921
loss_pred:0.026209769770503044, decouple_loss:0.01449720561504364
2023-05-04 11:00:55 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6852218508720398, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.6967389583587646, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.689285933971405, mean p set: 0.4500633478164673
loss_pred:0.026832900941371918, decouple_loss:0.015418198890984058
loss_pred:0.028291016817092896, decouple_loss:0.015565729700028896
loss_pred:0.02730375900864601, decouple_loss:0.015137790702283382
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028244588524103165, avg_mse: 0.03316822648048401
current test mse: 0.033168
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44638708233833313, gen p mean: -0.697758674621582, mean p set: 0.4468673765659332
The modified gen p mean: 0.44853469729423523, gen p mean: -0.6982864141464233, mean p set: 0.4490150213241577
loss_pred:0.027711641043424606, decouple_loss:0.014404361136257648
loss_pred:0.02894926443696022, decouple_loss:0.01532668061554432
The modified gen p mean: 0.4461188316345215, gen p mean: -0.695366621017456, mean p set: 0.44659915566444397
loss_pred:0.027470121160149574, decouple_loss:0.014441202394664288
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476396441459656, gen p mean: -0.6996662020683289, mean p set: 0.4481199383735657
The modified gen p mean: 0.4481664299964905, gen p mean: -0.7022332549095154, mean p set: 0.4486467242240906
loss_pred:0.027342747896909714, decouple_loss:0.01417981181293726
loss_pred:0.0272922832518816, decouple_loss:0.015265782363712788
The modified gen p mean: 0.4469650089740753, gen p mean: -0.6985235810279846, mean p set: 0.4474453032016754
loss_pred:0.026886798441410065, decouple_loss:0.013675404712557793
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465605318546295, gen p mean: -0.7002270817756653, mean p set: 0.4470408260822296
loss_pred:0.02690783143043518, decouple_loss:0.013474181294441223
The modified gen p mean: 0.448622465133667, gen p mean: -0.701961874961853, mean p set: 0.4491027295589447
The modified gen p mean: 0.4475797712802887, gen p mean: -0.7052230834960938, mean p set: 0.4480600357055664
loss_pred:0.02797240950167179, decouple_loss:0.01425450574606657
loss_pred:0.02909356728196144, decouple_loss:0.014371969737112522
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793251156806946, gen p mean: -0.7052223086357117, mean p set: 0.44841283559799194
The modified gen p mean: 0.44419872760772705, gen p mean: -0.7121476531028748, mean p set: 0.44467902183532715
loss_pred:0.027855567634105682, decouple_loss:0.013643286190927029
loss_pred:0.027959652245044708, decouple_loss:0.013440153561532497
The modified gen p mean: 0.44540050625801086, gen p mean: -0.7089025974273682, mean p set: 0.44588083028793335
loss_pred:0.026794016361236572, decouple_loss:0.013690635561943054
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445483535528183, gen p mean: -0.7096152305603027, mean p set: 0.4459638297557831
loss_pred:0.027685459703207016, decouple_loss:0.013859722763299942
The modified gen p mean: 0.4465527832508087, gen p mean: -0.703216016292572, mean p set: 0.4470330774784088
The modified gen p mean: 0.4464915096759796, gen p mean: -0.7035936713218689, mean p set: 0.4469718039035797
loss_pred:0.026256581768393517, decouple_loss:0.014094166457653046
loss_pred:0.026747461408376694, decouple_loss:0.014568994753062725
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44976040720939636, gen p mean: -0.7099869847297668, mean p set: 0.4502406716346741
The modified gen p mean: 0.4475308656692505, gen p mean: -0.7090863585472107, mean p set: 0.4480111598968506
loss_pred:0.02664455771446228, decouple_loss:0.01431946363300085
loss_pred:0.028362823650240898, decouple_loss:0.013409997336566448
The modified gen p mean: 0.44529515504837036, gen p mean: -0.7116471529006958, mean p set: 0.44577544927597046
loss_pred:0.026356766000390053, decouple_loss:0.012990979477763176
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476720690727234, gen p mean: -0.710614025592804, mean p set: 0.4481523334980011
loss_pred:0.02748354896903038, decouple_loss:0.013093234039843082
The modified gen p mean: 0.4467974305152893, gen p mean: -0.7066411375999451, mean p set: 0.447277694940567
The modified gen p mean: 0.4466377794742584, gen p mean: -0.7102127075195312, mean p set: 0.44711804389953613
loss_pred:0.02817356400191784, decouple_loss:0.013657712377607822
loss_pred:0.026952188462018967, decouple_loss:0.014184919185936451
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481375813484192, gen p mean: -0.708458662033081, mean p set: 0.4486178159713745
The modified gen p mean: 0.4471827447414398, gen p mean: -0.7075813412666321, mean p set: 0.4476630687713623
loss_pred:0.0284473467618227, decouple_loss:0.014692245051264763
loss_pred:0.02664349228143692, decouple_loss:0.01299709640443325
The modified gen p mean: 0.44702309370040894, gen p mean: -0.7086874842643738, mean p set: 0.44750338792800903
loss_pred:0.027045240625739098, decouple_loss:0.013434876687824726
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671493768692017, gen p mean: -0.6977874040603638, mean p set: 0.4471952021121979
The modified gen p mean: 0.4495728015899658, gen p mean: -0.7029654383659363, mean p set: 0.4500530958175659
loss_pred:0.02668382227420807, decouple_loss:0.01272635068744421
loss_pred:0.02543817088007927, decouple_loss:0.013447348959743977
The modified gen p mean: 0.44594669342041016, gen p mean: -0.7037157416343689, mean p set: 0.44642698764801025
loss_pred:0.026906076818704605, decouple_loss:0.013284404762089252
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492434859275818, gen p mean: -0.6873862743377686, mean p set: 0.4497237801551819
loss_pred:0.027140913531184196, decouple_loss:0.013808765448629856
The modified gen p mean: 0.4483136534690857, gen p mean: -0.6926177740097046, mean p set: 0.4487939476966858
The modified gen p mean: 0.4474874436855316, gen p mean: -0.6915990710258484, mean p set: 0.4479677379131317
loss_pred:0.02790788747370243, decouple_loss:0.01411906536668539
loss_pred:0.02840529941022396, decouple_loss:0.01438282709568739
2023-05-04 11:04:30 testing...
The modified gen p mean: 0.44987669587135315, gen p mean: -0.6798756122589111, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6907092928886414, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6836860775947571, mean p set: 0.4500633478164673
loss_pred:0.026827428489923477, decouple_loss:0.014317166991531849
loss_pred:0.02822420559823513, decouple_loss:0.014324331656098366
loss_pred:0.027329178526997566, decouple_loss:0.01431392040103674
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028176194056868553, avg_mse: 0.033234890550374985
current test mse: 0.033235
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481312930583954, gen p mean: -0.6906251907348633, mean p set: 0.4486115872859955
The modified gen p mean: 0.44800665974617004, gen p mean: -0.6897059082984924, mean p set: 0.44848695397377014
loss_pred:0.028371838852763176, decouple_loss:0.01373289618641138
loss_pred:0.028114665299654007, decouple_loss:0.014126110821962357
The modified gen p mean: 0.44774129986763, gen p mean: -0.6814510226249695, mean p set: 0.4482216238975525
loss_pred:0.028806380927562714, decouple_loss:0.013525896705687046
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654354453086853, gen p mean: -0.6937009692192078, mean p set: 0.44702383875846863
The modified gen p mean: 0.4468156695365906, gen p mean: -0.6932054758071899, mean p set: 0.44729599356651306
loss_pred:0.027361730113625526, decouple_loss:0.013458597473800182
loss_pred:0.026943717151880264, decouple_loss:0.013803783804178238
The modified gen p mean: 0.4471528232097626, gen p mean: -0.6946778297424316, mean p set: 0.44763314723968506
loss_pred:0.02850455231964588, decouple_loss:0.014562631957232952
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476644992828369, gen p mean: -0.697259247303009, mean p set: 0.4481448233127594
loss_pred:0.02804415673017502, decouple_loss:0.013025371357798576
The modified gen p mean: 0.4476643204689026, gen p mean: -0.7084716558456421, mean p set: 0.4481445848941803
The modified gen p mean: 0.4476197361946106, gen p mean: -0.6983988881111145, mean p set: 0.4481000304222107
loss_pred:0.0274741742759943, decouple_loss:0.013680187053978443
loss_pred:0.027952710166573524, decouple_loss:0.01331759337335825
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759687781333923, gen p mean: -0.7108796238899231, mean p set: 0.44807714223861694
The modified gen p mean: 0.44858667254447937, gen p mean: -0.715844988822937, mean p set: 0.4490669369697571
loss_pred:0.02770804613828659, decouple_loss:0.01375283021479845
loss_pred:0.027305003255605698, decouple_loss:0.013938665390014648
The modified gen p mean: 0.44665277004241943, gen p mean: -0.7134211659431458, mean p set: 0.44713303446769714
loss_pred:0.026843460276722908, decouple_loss:0.012948848307132721
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475800395011902, gen p mean: -0.7004141211509705, mean p set: 0.4480603337287903
loss_pred:0.027987301349639893, decouple_loss:0.013981458730995655
The modified gen p mean: 0.44729742407798767, gen p mean: -0.7017086744308472, mean p set: 0.44777771830558777
The modified gen p mean: 0.44719043374061584, gen p mean: -0.7092065215110779, mean p set: 0.44767072796821594
loss_pred:0.028471624478697777, decouple_loss:0.013752625323832035
loss_pred:0.028467627242207527, decouple_loss:0.013307380490005016
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469161927700043, gen p mean: -0.6897180080413818, mean p set: 0.44739648699760437
loss_pred:0.028807297348976135, decouple_loss:0.013222423382103443
The modified gen p mean: 0.44707900285720825, gen p mean: -0.6965742707252502, mean p set: 0.44755926728248596
The modified gen p mean: 0.44698387384414673, gen p mean: -0.6914920806884766, mean p set: 0.4474641680717468
loss_pred:0.028758633881807327, decouple_loss:0.013837330974638462
loss_pred:0.029233628883957863, decouple_loss:0.013532591052353382
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475558400154114, gen p mean: -0.7037546634674072, mean p set: 0.4480361342430115
loss_pred:0.028432436287403107, decouple_loss:0.0137640330940485
The modified gen p mean: 0.44718432426452637, gen p mean: -0.7029324769973755, mean p set: 0.4476645588874817
The modified gen p mean: 0.4477626085281372, gen p mean: -0.6938114166259766, mean p set: 0.4482428729534149
loss_pred:0.028553666546940804, decouple_loss:0.013322179205715656
loss_pred:0.027612509205937386, decouple_loss:0.013908951543271542
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733738899230957, gen p mean: -0.6996453404426575, mean p set: 0.44781771302223206
loss_pred:0.028399549424648285, decouple_loss:0.013875068165361881
The modified gen p mean: 0.44748654961586, gen p mean: -0.6967583894729614, mean p set: 0.4479668438434601
The modified gen p mean: 0.4471803605556488, gen p mean: -0.7027541399002075, mean p set: 0.4476606547832489
loss_pred:0.029467983171343803, decouple_loss:0.013574878685176373
loss_pred:0.028918392956256866, decouple_loss:0.012925230897963047
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772130250930786, gen p mean: -0.7100396156311035, mean p set: 0.44820162653923035The modified gen p mean: 0.44630637764930725, gen p mean: -0.707055926322937, mean p set: 0.44678664207458496
loss_pred:0.028777239844202995, decouple_loss:0.013644451275467873
loss_pred:0.02710544317960739, decouple_loss:0.013505821116268635
The modified gen p mean: 0.4473235309123993, gen p mean: -0.7113587260246277, mean p set: 0.4478038251399994
loss_pred:0.027562163770198822, decouple_loss:0.013960317708551884
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785475730895996, gen p mean: -0.7134435176849365, mean p set: 0.44833505153656006
The modified gen p mean: 0.4472311735153198, gen p mean: -0.7031335830688477, mean p set: 0.44771143794059753
loss_pred:0.027595607563853264, decouple_loss:0.013663861900568008
loss_pred:0.02829582616686821, decouple_loss:0.01337277702987194
The modified gen p mean: 0.4471185505390167, gen p mean: -0.7055909633636475, mean p set: 0.4475988745689392
loss_pred:0.027763109654188156, decouple_loss:0.013385902158915997
2023-05-04 11:08:51 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7082569003105164, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7126983404159546, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7199299335479736, mean p set: 0.4502691626548767
loss_pred:0.026778465136885643, decouple_loss:0.013297461904585361
loss_pred:0.02718210779130459, decouple_loss:0.013323751278221607
loss_pred:0.028064487501978874, decouple_loss:0.013733992353081703
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028014272451400757, avg_mse: 0.03312523290514946
current test mse: 0.033125
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477905035018921, gen p mean: -0.7157191038131714, mean p set: 0.4482708275318146
The modified gen p mean: 0.4473910927772522, gen p mean: -0.7138369679450989, mean p set: 0.4478713572025299
loss_pred:0.029080450534820557, decouple_loss:0.013044706545770168
loss_pred:0.02883155643939972, decouple_loss:0.013524281792342663
The modified gen p mean: 0.44745901226997375, gen p mean: -0.7072423100471497, mean p set: 0.44793930649757385
loss_pred:0.028033113107085228, decouple_loss:0.013016407378017902
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744566082954407, gen p mean: -0.7098459601402283, mean p set: 0.44792598485946655
The modified gen p mean: 0.44710057973861694, gen p mean: -0.7062237858772278, mean p set: 0.44758090376853943
loss_pred:0.027903560549020767, decouple_loss:0.013422849588096142
loss_pred:0.028050798922777176, decouple_loss:0.013198764994740486
The modified gen p mean: 0.44719043374061584, gen p mean: -0.6996860504150391, mean p set: 0.44767072796821594
loss_pred:0.028787370771169662, decouple_loss:0.012701624073088169
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478148818016052, gen p mean: -0.69915372133255, mean p set: 0.4482952058315277
loss_pred:0.02790270373225212, decouple_loss:0.013094504363834858
The modified gen p mean: 0.446276992559433, gen p mean: -0.7016891837120056, mean p set: 0.4467572569847107
The modified gen p mean: 0.448141485452652, gen p mean: -0.6974555253982544, mean p set: 0.4486217796802521
loss_pred:0.02654731087386608, decouple_loss:0.012944266200065613
loss_pred:0.02773997373878956, decouple_loss:0.012726932764053345
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479086399078369, gen p mean: -0.706981897354126, mean p set: 0.4483889639377594
The modified gen p mean: 0.4476320147514343, gen p mean: -0.7087188363075256, mean p set: 0.4481123387813568
loss_pred:0.02734290063381195, decouple_loss:0.012717146426439285
loss_pred:0.026617281138896942, decouple_loss:0.01314902026206255
The modified gen p mean: 0.44677072763442993, gen p mean: -0.7042192816734314, mean p set: 0.44725102186203003
loss_pred:0.027165226638317108, decouple_loss:0.012547866441309452
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469631612300873, gen p mean: -0.718134343624115, mean p set: 0.447443425655365
The modified gen p mean: 0.44749000668525696, gen p mean: -0.7199876308441162, mean p set: 0.4479702413082123
loss_pred:0.02740802802145481, decouple_loss:0.012476054020226002
loss_pred:0.027120035141706467, decouple_loss:0.013633549213409424
The modified gen p mean: 0.44776326417922974, gen p mean: -0.7187345623970032, mean p set: 0.44824355840682983
loss_pred:0.028063330799341202, decouple_loss:0.012535838410258293
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752684235572815, gen p mean: -0.72432541847229, mean p set: 0.44800713658332825
loss_pred:0.02793915569782257, decouple_loss:0.012588970363140106
The modified gen p mean: 0.4476095139980316, gen p mean: -0.7267070412635803, mean p set: 0.4480897784233093
The modified gen p mean: 0.4472975432872772, gen p mean: -0.7262731194496155, mean p set: 0.4477778375148773
loss_pred:0.02776402421295643, decouple_loss:0.013118771836161613
loss_pred:0.026577331125736237, decouple_loss:0.012385779991745949
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485894441604614, gen p mean: -0.7250479459762573, mean p set: 0.4490697383880615
The modified gen p mean: 0.44726693630218506, gen p mean: -0.7215253710746765, mean p set: 0.44774720072746277
loss_pred:0.0265833530575037, decouple_loss:0.012177092023193836
loss_pred:0.02656618505716324, decouple_loss:0.012148947454988956
The modified gen p mean: 0.44779273867607117, gen p mean: -0.7200422883033752, mean p set: 0.4482730031013489
loss_pred:0.027081888169050217, decouple_loss:0.012472365982830524
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475264549255371, gen p mean: -0.7120417356491089, mean p set: 0.4480067491531372
The modified gen p mean: 0.448035329580307, gen p mean: -0.7194159030914307, mean p set: 0.4485156238079071
loss_pred:0.028020819649100304, decouple_loss:0.012263201177120209
loss_pred:0.025954917073249817, decouple_loss:0.01200595311820507
The modified gen p mean: 0.44601359963417053, gen p mean: -0.7129148840904236, mean p set: 0.44649389386177063
loss_pred:0.026545239612460136, decouple_loss:0.01246943324804306
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735562801361084, gen p mean: -0.7075397372245789, mean p set: 0.44783589243888855
loss_pred:0.02677050605416298, decouple_loss:0.012108162976801395
The modified gen p mean: 0.447537362575531, gen p mean: -0.704926073551178, mean p set: 0.4480176270008087
The modified gen p mean: 0.44758734107017517, gen p mean: -0.6900667548179626, mean p set: 0.44806763529777527
loss_pred:0.028201621025800705, decouple_loss:0.012673790566623211
loss_pred:0.02768288366496563, decouple_loss:0.013801858760416508
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475240707397461, gen p mean: -0.7079042792320251, mean p set: 0.4480043649673462
The modified gen p mean: 0.44701895117759705, gen p mean: -0.695152759552002, mean p set: 0.44749921560287476
loss_pred:0.02833295799791813, decouple_loss:0.012562965042889118
loss_pred:0.028729353100061417, decouple_loss:0.012576387263834476
The modified gen p mean: 0.44720011949539185, gen p mean: -0.7067489624023438, mean p set: 0.44768041372299194
loss_pred:0.02674790658056736, decouple_loss:0.012236743234097958
2023-05-04 11:12:26 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7040583491325378, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7159043550491333, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830237865448, gen p mean: -0.7084270119667053, mean p set: 0.4500633478164673
loss_pred:0.026562431827187538, decouple_loss:0.012554770335555077
loss_pred:0.027723396196961403, decouple_loss:0.013075551949441433loss_pred:0.02690490521490574, decouple_loss:0.012490015476942062
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02769891731441021, avg_mse: 0.032595112919807434
current test mse: 0.032595
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
NaN value num: 0
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476771950721741, gen p mean: -0.7145280241966248, mean p set: 0.44815748929977417
loss_pred:0.028671564534306526, decouple_loss:0.012872797437012196
The modified gen p mean: 0.44805869460105896, gen p mean: -0.7095550894737244, mean p set: 0.44853898882865906
loss_pred:0.028356481343507767, decouple_loss:0.013716830871999264
The modified gen p mean: 0.44800901412963867, gen p mean: -0.7129844427108765, mean p set: 0.44848933815956116
loss_pred:0.02826537750661373, decouple_loss:0.013400794938206673
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472518265247345, gen p mean: -0.7099685668945312, mean p set: 0.4477321207523346
loss_pred:0.029040446504950523, decouple_loss:0.012954670935869217
The modified gen p mean: 0.44846221804618835, gen p mean: -0.7162866592407227, mean p set: 0.44894248247146606
The modified gen p mean: 0.44815874099731445, gen p mean: -0.7151160836219788, mean p set: 0.44863903522491455
loss_pred:0.02882479503750801, decouple_loss:0.012761198915541172
loss_pred:0.027899039909243584, decouple_loss:0.012982278130948544
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891196489334106, gen p mean: -0.716858446598053, mean p set: 0.4493922293186188
loss_pred:0.027661936357617378, decouple_loss:0.012691514566540718
The modified gen p mean: 0.44795748591423035, gen p mean: -0.7110970616340637, mean p set: 0.44843775033950806
The modified gen p mean: 0.44701382517814636, gen p mean: -0.7046292424201965, mean p set: 0.4474940896034241
loss_pred:0.027989085763692856, decouple_loss:0.012868314981460571
loss_pred:0.02839171327650547, decouple_loss:0.012763483449816704
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477475881576538, gen p mean: -0.7096097469329834, mean p set: 0.4482278525829315
loss_pred:0.028124427422881126, decouple_loss:0.012231727130711079
The modified gen p mean: 0.44846928119659424, gen p mean: -0.7049126625061035, mean p set: 0.44894954562187195
The modified gen p mean: 0.4480712413787842, gen p mean: -0.7127136588096619, mean p set: 0.44855156540870667
loss_pred:0.027879992499947548, decouple_loss:0.01278406847268343
loss_pred:0.027207858860492706, decouple_loss:0.012942549772560596
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476719796657562, gen p mean: -0.71380615234375, mean p set: 0.4481523036956787
The modified gen p mean: 0.44823214411735535, gen p mean: -0.7103686928749084, mean p set: 0.44871240854263306
loss_pred:0.027477983385324478, decouple_loss:0.011806919239461422
loss_pred:0.028358936309814453, decouple_loss:0.012330802157521248
The modified gen p mean: 0.44838833808898926, gen p mean: -0.7032768130302429, mean p set: 0.44886863231658936
loss_pred:0.02720186673104763, decouple_loss:0.012681172229349613
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793984293937683, gen p mean: -0.7129332423210144, mean p set: 0.44842007756233215
The modified gen p mean: 0.4484626352787018, gen p mean: -0.7131653428077698, mean p set: 0.44894295930862427
loss_pred:0.028068656101822853, decouple_loss:0.01214586291462183
loss_pred:0.027168894186615944, decouple_loss:0.012392624281346798
The modified gen p mean: 0.4477936327457428, gen p mean: -0.7166954874992371, mean p set: 0.4482739567756653
loss_pred:0.027959786355495453, decouple_loss:0.01240632776170969
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469981789588928, gen p mean: -0.7170729637145996, mean p set: 0.4474784731864929
The modified gen p mean: 0.4483610987663269, gen p mean: -0.7086729407310486, mean p set: 0.4488413631916046
loss_pred:0.028076717630028725, decouple_loss:0.011700127273797989
loss_pred:0.028034362941980362, decouple_loss:0.012319900095462799
The modified gen p mean: 0.4480228126049042, gen p mean: -0.7110771536827087, mean p set: 0.4485030770301819
loss_pred:0.027411939576268196, decouple_loss:0.012430026195943356
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793790578842163, gen p mean: -0.721664547920227, mean p set: 0.44841820001602173
The modified gen p mean: 0.4475162625312805, gen p mean: -0.7150295376777649, mean p set: 0.447996586561203
loss_pred:0.026885753497481346, decouple_loss:0.012448210269212723
loss_pred:0.027808960527181625, decouple_loss:0.012111547403037548
The modified gen p mean: 0.4477674961090088, gen p mean: -0.7119264602661133, mean p set: 0.4482477605342865
loss_pred:0.027821771800518036, decouple_loss:0.012011812068521976
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835129380226135, gen p mean: -0.7064483761787415, mean p set: 0.44883155822753906
The modified gen p mean: 0.44760870933532715, gen p mean: -0.7137497067451477, mean p set: 0.44808903336524963
loss_pred:0.02872833050787449, decouple_loss:0.012105735018849373
loss_pred:0.02748294733464718, decouple_loss:0.01174105517566204
The modified gen p mean: 0.44901153445243835, gen p mean: -0.7163726091384888, mean p set: 0.44949179887771606
loss_pred:0.02754336968064308, decouple_loss:0.012440638616681099
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488667845726013, gen p mean: -0.7050928473472595, mean p set: 0.4493470788002014
loss_pred:0.027407366782426834, decouple_loss:0.01204898301512003
The modified gen p mean: 0.4482515752315521, gen p mean: -0.7016539573669434, mean p set: 0.4487318992614746
The modified gen p mean: 0.4475019872188568, gen p mean: -0.7037007808685303, mean p set: 0.4479822516441345
loss_pred:0.02821340598165989, decouple_loss:0.012146929278969765
loss_pred:0.02810549922287464, decouple_loss:0.01167358923703432
2023-05-04 11:16:41 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6999989748001099, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7044456601142883, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7117670774459839, mean p set: 0.4502691626548767
loss_pred:0.026955289766192436, decouple_loss:0.012672029435634613loss_pred:0.026492683216929436, decouple_loss:0.012548575177788734
loss_pred:0.027876948937773705, decouple_loss:0.012661425396800041
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027739673852920532, avg_mse: 0.03278390318155289
current test mse: 0.032784
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755542278289795, gen p mean: -0.7105132937431335, mean p set: 0.44803571701049805
The modified gen p mean: 0.44765704870224, gen p mean: -0.7110106945037842, mean p set: 0.4481373429298401
loss_pred:0.02696591056883335, decouple_loss:0.011948998086154461
loss_pred:0.026576180011034012, decouple_loss:0.012337996624410152
The modified gen p mean: 0.448513001203537, gen p mean: -0.7099958062171936, mean p set: 0.4489932656288147
loss_pred:0.02695431560277939, decouple_loss:0.011527219787240028
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797036051750183, gen p mean: -0.699768602848053, mean p set: 0.44845062494277954
The modified gen p mean: 0.44846969842910767, gen p mean: -0.6996586918830872, mean p set: 0.44895002245903015
loss_pred:0.027374187484383583, decouple_loss:0.011546951718628407
loss_pred:0.028072966262698174, decouple_loss:0.011494309641420841
The modified gen p mean: 0.44850581884384155, gen p mean: -0.7047919034957886, mean p set: 0.44898611307144165
loss_pred:0.028223557397723198, decouple_loss:0.011770256794989109
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737720489501953, gen p mean: -0.7049908638000488, mean p set: 0.44785749912261963
loss_pred:0.02783445082604885, decouple_loss:0.011484537273645401
The modified gen p mean: 0.44726303219795227, gen p mean: -0.6951966285705566, mean p set: 0.44774329662323
The modified gen p mean: 0.44729775190353394, gen p mean: -0.7053093314170837, mean p set: 0.44777801632881165
loss_pred:0.02780451811850071, decouple_loss:0.012049756944179535
loss_pred:0.02746761590242386, decouple_loss:0.011570615693926811
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849759340286255, gen p mean: -0.7137996554374695, mean p set: 0.44897785782814026
The modified gen p mean: 0.44836854934692383, gen p mean: -0.7059025764465332, mean p set: 0.4488488733768463
loss_pred:0.027606423944234848, decouple_loss:0.011636385694146156
loss_pred:0.028586866334080696, decouple_loss:0.011770606972277164
The modified gen p mean: 0.4473387897014618, gen p mean: -0.7050458788871765, mean p set: 0.4478190541267395
loss_pred:0.028082387521862984, decouple_loss:0.011339150369167328
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447792649269104, gen p mean: -0.7146532535552979, mean p set: 0.4482729434967041
The modified gen p mean: 0.44767841696739197, gen p mean: -0.7203872203826904, mean p set: 0.44815871119499207loss_pred:0.027659421786665916, decouple_loss:0.011750779114663601
loss_pred:0.027660170570015907, decouple_loss:0.01146441325545311
The modified gen p mean: 0.44744303822517395, gen p mean: -0.7113423943519592, mean p set: 0.44792336225509644
loss_pred:0.02759816125035286, decouple_loss:0.011753460392355919
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476569890975952, gen p mean: -0.7101767063140869, mean p set: 0.4481372833251953
The modified gen p mean: 0.4475323259830475, gen p mean: -0.7114108204841614, mean p set: 0.4480125904083252
loss_pred:0.02893483079969883, decouple_loss:0.011174737475812435
loss_pred:0.02765347622334957, decouple_loss:0.010974646545946598
The modified gen p mean: 0.44896137714385986, gen p mean: -0.7079180479049683, mean p set: 0.4494416415691376
loss_pred:0.028704343363642693, decouple_loss:0.011557960882782936
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819241762161255, gen p mean: -0.7054065465927124, mean p set: 0.44867268204689026
The modified gen p mean: 0.4482339918613434, gen p mean: -0.7168968319892883, mean p set: 0.4487142562866211
loss_pred:0.027597742155194283, decouple_loss:0.011525668203830719
loss_pred:0.028114326298236847, decouple_loss:0.011363149620592594
The modified gen p mean: 0.4473279118537903, gen p mean: -0.7166928052902222, mean p set: 0.4478082060813904
loss_pred:0.027618279680609703, decouple_loss:0.011269424110651016
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488697052001953, gen p mean: -0.7342987656593323, mean p set: 0.449349969625473
The modified gen p mean: 0.4479679763317108, gen p mean: -0.7269667387008667, mean p set: 0.4484483003616333
loss_pred:0.026654884219169617, decouple_loss:0.011845581233501434
loss_pred:0.027748730033636093, decouple_loss:0.011475909501314163
The modified gen p mean: 0.4478350579738617, gen p mean: -0.7272615432739258, mean p set: 0.4483153223991394
loss_pred:0.027445420622825623, decouple_loss:0.011678281240165234
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756460189819336, gen p mean: -0.7161846160888672, mean p set: 0.44804492592811584
The modified gen p mean: 0.44839394092559814, gen p mean: -0.7189196944236755, mean p set: 0.44887417554855347
loss_pred:0.027491601184010506, decouple_loss:0.011044093407690525
loss_pred:0.027006519958376884, decouple_loss:0.01076333038508892
The modified gen p mean: 0.4478950798511505, gen p mean: -0.730149507522583, mean p set: 0.4483753740787506
loss_pred:0.025975462049245834, decouple_loss:0.011484283022582531
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474294185638428, gen p mean: -0.7120351195335388, mean p set: 0.4479096829891205
The modified gen p mean: 0.44865739345550537, gen p mean: -0.713387668132782, mean p set: 0.4491376578807831
loss_pred:0.028328385204076767, decouple_loss:0.011081051081418991
loss_pred:0.028800606727600098, decouple_loss:0.011411712504923344
The modified gen p mean: 0.4474272131919861, gen p mean: -0.7128540873527527, mean p set: 0.4479075074195862
loss_pred:0.0280116219073534, decouple_loss:0.011071545071899891
2023-05-04 11:20:15 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7073932886123657, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7196268439292908, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7120088934898376, mean p set: 0.4500633478164673
loss_pred:0.02660936489701271, decouple_loss:0.012091844342648983
loss_pred:0.027995465323328972, decouple_loss:0.012420075945556164
loss_pred:0.0270006712526083, decouple_loss:0.011892992071807384
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02780858241021633, avg_mse: 0.032944727689027786
current test mse: 0.032945
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
NaN value num: 0
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539129436016083, gen p mean: -0.7151646614074707, mean p set: 0.45439326763153076
The modified gen p mean: 0.4516972601413727, gen p mean: -0.7126411199569702, mean p set: 0.4521775543689728
loss_pred:0.026783905923366547, decouple_loss:0.014847159385681152
loss_pred:0.027645286172628403, decouple_loss:0.013729535043239594
The modified gen p mean: 0.4524080753326416, gen p mean: -0.7207730412483215, mean p set: 0.4528883397579193
loss_pred:0.0264744870364666, decouple_loss:0.013218367472290993
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515138268470764, gen p mean: -0.7186605334281921, mean p set: 0.4519941210746765
loss_pred:0.026590846478939056, decouple_loss:0.013183292001485825
The modified gen p mean: 0.4513258635997772, gen p mean: -0.7175238132476807, mean p set: 0.45180612802505493
The modified gen p mean: 0.4505383372306824, gen p mean: -0.7155986428260803, mean p set: 0.4510186016559601
loss_pred:0.027653997763991356, decouple_loss:0.013813978992402554
loss_pred:0.027467679232358932, decouple_loss:0.014112699776887894
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508700370788574, gen p mean: -0.7114601135253906, mean p set: 0.4513503611087799
The modified gen p mean: 0.45233041048049927, gen p mean: -0.7119619846343994, mean p set: 0.45281070470809937
loss_pred:0.02789241075515747, decouple_loss:0.012895123101770878
loss_pred:0.02705606445670128, decouple_loss:0.012974115088582039
The modified gen p mean: 0.4527623653411865, gen p mean: -0.7116332054138184, mean p set: 0.45324259996414185
loss_pred:0.025157786905765533, decouple_loss:0.01355392299592495
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453058660030365, gen p mean: -0.7174559235572815, mean p set: 0.4535389542579651
loss_pred:0.026181375607848167, decouple_loss:0.014304300770163536
The modified gen p mean: 0.4521506130695343, gen p mean: -0.7131983041763306, mean p set: 0.4526309072971344
The modified gen p mean: 0.45097970962524414, gen p mean: -0.6987536549568176, mean p set: 0.45146000385284424
loss_pred:0.026669226586818695, decouple_loss:0.01375524140894413
loss_pred:0.025871729478240013, decouple_loss:0.014960681088268757
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514199197292328, gen p mean: -0.7050432562828064, mean p set: 0.4519002437591553
The modified gen p mean: 0.45221826434135437, gen p mean: -0.7152351140975952, mean p set: 0.45269855856895447
loss_pred:0.025467578321695328, decouple_loss:0.014123629778623581
loss_pred:0.02576933056116104, decouple_loss:0.01343805156648159
The modified gen p mean: 0.4510241150856018, gen p mean: -0.712272047996521, mean p set: 0.4515043795108795
loss_pred:0.02743164263665676, decouple_loss:0.013948953710496426
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048317313194275, gen p mean: -0.7082006335258484, mean p set: 0.45096346735954285The modified gen p mean: 0.4522453844547272, gen p mean: -0.7091776728630066, mean p set: 0.4527256488800049
loss_pred:0.027568083256483078, decouple_loss:0.013448921032249928
loss_pred:0.026174314320087433, decouple_loss:0.013710805214941502
The modified gen p mean: 0.4527190923690796, gen p mean: -0.7087087035179138, mean p set: 0.4531993865966797
loss_pred:0.025637052953243256, decouple_loss:0.013531632721424103
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516957700252533, gen p mean: -0.7063636779785156, mean p set: 0.4521760940551758
The modified gen p mean: 0.45096471905708313, gen p mean: -0.7016609311103821, mean p set: 0.4514450132846832
loss_pred:0.026897834613919258, decouple_loss:0.013337582349777222
loss_pred:0.027262846007943153, decouple_loss:0.013644106686115265
The modified gen p mean: 0.4539802670478821, gen p mean: -0.7064402103424072, mean p set: 0.45446059107780457
loss_pred:0.025356538593769073, decouple_loss:0.01372786145657301
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104166865348816, gen p mean: -0.7101478576660156, mean p set: 0.45152196288108826
The modified gen p mean: 0.4521137475967407, gen p mean: -0.7129605412483215, mean p set: 0.4525940418243408
loss_pred:0.02693900279700756, decouple_loss:0.013050953857600689
loss_pred:0.025892646983265877, decouple_loss:0.012845225632190704
The modified gen p mean: 0.450749009847641, gen p mean: -0.7026028633117676, mean p set: 0.4512292742729187
loss_pred:0.028738446533679962, decouple_loss:0.013575858436524868
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513101279735565, gen p mean: -0.7049354910850525, mean p set: 0.4517904222011566
The modified gen p mean: 0.4520118534564972, gen p mean: -0.7176393270492554, mean p set: 0.4524921178817749
loss_pred:0.02834697999060154, decouple_loss:0.013623219914734364
loss_pred:0.02597631700336933, decouple_loss:0.013131762854754925
The modified gen p mean: 0.4513746201992035, gen p mean: -0.713717520236969, mean p set: 0.4518548846244812
loss_pred:0.02729768492281437, decouple_loss:0.012674286030232906
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45246726274490356, gen p mean: -0.719092071056366, mean p set: 0.45294755697250366
The modified gen p mean: 0.4543343782424927, gen p mean: -0.7168436050415039, mean p set: 0.4548146724700928
loss_pred:0.025849228724837303, decouple_loss:0.013141914270818233
loss_pred:0.025691790506243706, decouple_loss:0.013876013457775116
The modified gen p mean: 0.4510827362537384, gen p mean: -0.7145454287528992, mean p set: 0.4515630006790161
loss_pred:0.027641095221042633, decouple_loss:0.0127369724214077
2023-05-04 11:24:26 testing...
The modified gen p mean: 0.44987669587135315, gen p mean: -0.7089745402336121, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7135812044143677, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7209184169769287, mean p set: 0.4502691626548767
loss_pred:0.026967767626047134, decouple_loss:0.014099505729973316
loss_pred:0.027327196672558784, decouple_loss:0.0139725711196661
loss_pred:0.028480183333158493, decouple_loss:0.014546948485076427
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028302034363150597, avg_mse: 0.03352335840463638
current test mse: 0.033523
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509720802307129, gen p mean: -0.7170146703720093, mean p set: 0.451452374458313
The modified gen p mean: 0.45180991291999817, gen p mean: -0.7097300887107849, mean p set: 0.45229020714759827
loss_pred:0.027003513649106026, decouple_loss:0.012863244861364365
loss_pred:0.027358515188097954, decouple_loss:0.012721643783152103
The modified gen p mean: 0.4527140259742737, gen p mean: -0.7172214984893799, mean p set: 0.4531942903995514
loss_pred:0.026163375005126, decouple_loss:0.013330976478755474
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498565196990967, gen p mean: -0.7214600443840027, mean p set: 0.4503368139266968
loss_pred:0.0266482625156641, decouple_loss:0.012195130810141563
The modified gen p mean: 0.45134875178337097, gen p mean: -0.7127593755722046, mean p set: 0.45182904601097107
The modified gen p mean: 0.45222821831703186, gen p mean: -0.7193480730056763, mean p set: 0.45270848274230957
loss_pred:0.02785649709403515, decouple_loss:0.012824607081711292
loss_pred:0.026786383241415024, decouple_loss:0.012331485748291016
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522641897201538, gen p mean: -0.7211239337921143, mean p set: 0.4527444541454315
The modified gen p mean: 0.45227065682411194, gen p mean: -0.7122194766998291, mean p set: 0.45275095105171204
loss_pred:0.026546603068709373, decouple_loss:0.012431887909770012
loss_pred:0.025264808908104897, decouple_loss:0.013008693233132362
The modified gen p mean: 0.4521689713001251, gen p mean: -0.7236508131027222, mean p set: 0.45264923572540283
loss_pred:0.025955861434340477, decouple_loss:0.012615873478353024
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45270633697509766, gen p mean: -0.7162837386131287, mean p set: 0.45318663120269775
The modified gen p mean: 0.4529423713684082, gen p mean: -0.7163088917732239, mean p set: 0.4534226953983307
loss_pred:0.025115754455327988, decouple_loss:0.012509684078395367
loss_pred:0.025313997641205788, decouple_loss:0.012451774440705776
The modified gen p mean: 0.45056912302970886, gen p mean: -0.7013047337532043, mean p set: 0.4510493874549866
loss_pred:0.028570374473929405, decouple_loss:0.012209173291921616
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082202553749084, gen p mean: -0.6967127919197083, mean p set: 0.45130228996276855
The modified gen p mean: 0.4506838619709015, gen p mean: -0.6943376064300537, mean p set: 0.4511641561985016
loss_pred:0.025309652090072632, decouple_loss:0.013456432148814201
loss_pred:0.025361744686961174, decouple_loss:0.01357719674706459
The modified gen p mean: 0.4508156180381775, gen p mean: -0.7012262344360352, mean p set: 0.4512959122657776
loss_pred:0.02551962248980999, decouple_loss:0.01342921145260334
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513583183288574, gen p mean: -0.7015698552131653, mean p set: 0.4518386423587799
The modified gen p mean: 0.4528367221355438, gen p mean: -0.7077498435974121, mean p set: 0.4533170461654663loss_pred:0.027076810598373413, decouple_loss:0.013245144858956337
The modified gen p mean: 0.4511820375919342, gen p mean: -0.6968123912811279, mean p set: 0.4516623318195343
loss_pred:0.02541760541498661, decouple_loss:0.013514275662600994
loss_pred:0.027370890602469444, decouple_loss:0.01332833431661129
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45249706506729126, gen p mean: -0.710394024848938, mean p set: 0.45297735929489136
The modified gen p mean: 0.4528239965438843, gen p mean: -0.7120521664619446, mean p set: 0.4533042907714844
loss_pred:0.025075800716876984, decouple_loss:0.012605474330484867
loss_pred:0.02551441080868244, decouple_loss:0.01252039149403572
The modified gen p mean: 0.4536548852920532, gen p mean: -0.7176185250282288, mean p set: 0.4541351795196533
loss_pred:0.025298135355114937, decouple_loss:0.013057993724942207
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511546194553375, gen p mean: -0.7255927324295044, mean p set: 0.4516349136829376
The modified gen p mean: 0.4522090256214142, gen p mean: -0.7253191471099854, mean p set: 0.4526892900466919
loss_pred:0.02738473191857338, decouple_loss:0.013050739653408527
loss_pred:0.026647452265024185, decouple_loss:0.012235777452588081
The modified gen p mean: 0.45271334052085876, gen p mean: -0.7165623903274536, mean p set: 0.45319366455078125
loss_pred:0.024719834327697754, decouple_loss:0.011627770029008389
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45220547914505005, gen p mean: -0.7104654312133789, mean p set: 0.45268580317497253
loss_pred:0.02710960991680622, decouple_loss:0.012549176812171936
The modified gen p mean: 0.453479140996933, gen p mean: -0.7139945030212402, mean p set: 0.45395946502685547
The modified gen p mean: 0.45272040367126465, gen p mean: -0.7163322567939758, mean p set: 0.45320072770118713
loss_pred:0.025364378467202187, decouple_loss:0.011826789006590843
loss_pred:0.025504251942038536, decouple_loss:0.012408633716404438
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
NaN value num: 0
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904962182044983, gen p mean: -0.7086184620857239, mean p set: 0.4495299160480499
The modified gen p mean: 0.4488781988620758, gen p mean: -0.6927869915962219, mean p set: 0.4493584930896759
The modified gen p mean: 0.44825479388237, gen p mean: -0.7042551040649414, mean p set: 0.4487350583076477
loss_pred:0.02977152168750763, decouple_loss:0.013651163317263126
loss_pred:0.028477828949689865, decouple_loss:0.014305251650512218
loss_pred:0.028498707339167595, decouple_loss:0.013981691561639309
2023-05-04 11:28:44 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6996074914932251, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7119657397270203, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7044546008110046, mean p set: 0.4500633478164673
loss_pred:0.026700349524617195, decouple_loss:0.013639322482049465
loss_pred:0.028162682428956032, decouple_loss:0.01381324976682663
loss_pred:0.02709103189408779, decouple_loss:0.013439123518764973
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027999550104141235, avg_mse: 0.033178895711898804
current test mse: 0.033179
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487052857875824, gen p mean: -0.70827716588974, mean p set: 0.4491855800151825
The modified gen p mean: 0.4497185945510864, gen p mean: -0.6994806528091431, mean p set: 0.45019885897636414
loss_pred:0.027820836752653122, decouple_loss:0.013462808914482594
loss_pred:0.028990333899855614, decouple_loss:0.014102908782660961
The modified gen p mean: 0.44819748401641846, gen p mean: -0.7062270045280457, mean p set: 0.44867777824401855
loss_pred:0.028081893920898438, decouple_loss:0.013518400490283966
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486444890499115, gen p mean: -0.7237837314605713, mean p set: 0.4491247832775116
The modified gen p mean: 0.44922593235969543, gen p mean: -0.7161067128181458, mean p set: 0.4497062563896179
loss_pred:0.02758007124066353, decouple_loss:0.013157534413039684
loss_pred:0.028060084208846092, decouple_loss:0.012992268428206444
The modified gen p mean: 0.44877374172210693, gen p mean: -0.7072698473930359, mean p set: 0.44925400614738464
loss_pred:0.02778610773384571, decouple_loss:0.013284540735185146
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501723051071167, gen p mean: -0.7164931893348694, mean p set: 0.4506526291370392
loss_pred:0.02898731455206871, decouple_loss:0.013080349192023277
The modified gen p mean: 0.44849124550819397, gen p mean: -0.7187083959579468, mean p set: 0.44897153973579407
The modified gen p mean: 0.4502822160720825, gen p mean: -0.720468282699585, mean p set: 0.4507625102996826
loss_pred:0.0274838637560606, decouple_loss:0.012567780911922455
loss_pred:0.028691833838820457, decouple_loss:0.012912517413496971
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497009813785553, gen p mean: -0.7273949980735779, mean p set: 0.4501812756061554
loss_pred:0.028435537591576576, decouple_loss:0.01298489049077034
The modified gen p mean: 0.44935736060142517, gen p mean: -0.7118985652923584, mean p set: 0.44983765482902527
The modified gen p mean: 0.44895657896995544, gen p mean: -0.7139027118682861, mean p set: 0.44943687319755554
loss_pred:0.026940032839775085, decouple_loss:0.01227094791829586
loss_pred:0.028237760066986084, decouple_loss:0.012403364293277264
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494567811489105, gen p mean: -0.7111643552780151, mean p set: 0.4499370753765106
loss_pred:0.028064468875527382, decouple_loss:0.011824078857898712
The modified gen p mean: 0.4494662880897522, gen p mean: -0.708562433719635, mean p set: 0.4499465525150299
The modified gen p mean: 0.44948074221611023, gen p mean: -0.7103936672210693, mean p set: 0.4499610364437103
loss_pred:0.02676290273666382, decouple_loss:0.012193102389574051
loss_pred:0.02791753225028515, decouple_loss:0.012087909504771233
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972896575927734, gen p mean: -0.7092217803001404, mean p set: 0.45020923018455505
The modified gen p mean: 0.4496626853942871, gen p mean: -0.7088961005210876, mean p set: 0.4501429796218872
loss_pred:0.02845674566924572, decouple_loss:0.01217249222099781
loss_pred:0.027377091348171234, decouple_loss:0.01220603846013546
The modified gen p mean: 0.449593186378479, gen p mean: -0.7269966006278992, mean p set: 0.4500735104084015
loss_pred:0.02744406647980213, decouple_loss:0.013525759801268578
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498935341835022, gen p mean: -0.7072739005088806, mean p set: 0.4503738284111023
loss_pred:0.027481699362397194, decouple_loss:0.012531386688351631
The modified gen p mean: 0.44961875677108765, gen p mean: -0.7094123363494873, mean p set: 0.45009905099868774
The modified gen p mean: 0.4489961862564087, gen p mean: -0.7007807493209839, mean p set: 0.4494764804840088
loss_pred:0.028191544115543365, decouple_loss:0.012423685751855373
loss_pred:0.027450179681181908, decouple_loss:0.011859484948217869
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872573018074036, gen p mean: -0.7174829244613647, mean p set: 0.44920605421066284
The modified gen p mean: 0.44995805621147156, gen p mean: -0.7095909118652344, mean p set: 0.45043838024139404
loss_pred:0.027705533429980278, decouple_loss:0.012763005681335926
loss_pred:0.027778485789895058, decouple_loss:0.012481631711125374
The modified gen p mean: 0.44877660274505615, gen p mean: -0.7021167874336243, mean p set: 0.44925686717033386
loss_pred:0.02793891355395317, decouple_loss:0.011985082179307938
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013242959976196, gen p mean: -0.6999356746673584, mean p set: 0.45061272382736206
loss_pred:0.0287727452814579, decouple_loss:0.01277716364711523
The modified gen p mean: 0.44985097646713257, gen p mean: -0.7118586897850037, mean p set: 0.45033130049705505
The modified gen p mean: 0.4492073953151703, gen p mean: -0.6998685002326965, mean p set: 0.4496876895427704
loss_pred:0.028044411912560463, decouple_loss:0.012265547178685665
loss_pred:0.028305931016802788, decouple_loss:0.012238065712153912
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816696643829346, gen p mean: -0.7076032161712646, mean p set: 0.44864723086357117
The modified gen p mean: 0.4486953318119049, gen p mean: -0.7132865190505981, mean p set: 0.449175626039505
loss_pred:0.028267059475183487, decouple_loss:0.012528929859399796
loss_pred:0.027847295626997948, decouple_loss:0.01256293524056673
The modified gen p mean: 0.4499937891960144, gen p mean: -0.7063042521476746, mean p set: 0.4504740536212921
loss_pred:0.02753642573952675, decouple_loss:0.011915162205696106
2023-05-04 11:32:17 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7058443427085876, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7109514474868774, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7182526588439941, mean p set: 0.4502691626548767
loss_pred:0.026573214679956436, decouple_loss:0.01280959416180849
loss_pred:0.026896629482507706, decouple_loss:0.012592161074280739
loss_pred:0.027912363409996033, decouple_loss:0.013258027844130993
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027771731838583946, avg_mse: 0.03285111114382744
current test mse: 0.032851
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496510326862335, gen p mean: -0.7095947861671448, mean p set: 0.4501313269138336
The modified gen p mean: 0.44854292273521423, gen p mean: -0.712661623954773, mean p set: 0.44902318716049194
loss_pred:0.027259455993771553, decouple_loss:0.012066327966749668
loss_pred:0.027191778644919395, decouple_loss:0.012252922169864178
The modified gen p mean: 0.4485274851322174, gen p mean: -0.7109853029251099, mean p set: 0.4490078091621399
loss_pred:0.027240151539444923, decouple_loss:0.011787798255681992
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479087293148041, gen p mean: -0.7035041451454163, mean p set: 0.4483890235424042
The modified gen p mean: 0.4499054551124573, gen p mean: -0.7163943648338318, mean p set: 0.450385719537735
loss_pred:0.027460811659693718, decouple_loss:0.01174404937773943
loss_pred:0.02797638438642025, decouple_loss:0.011692067608237267
The modified gen p mean: 0.44919368624687195, gen p mean: -0.7053258419036865, mean p set: 0.44967401027679443
loss_pred:0.027723146602511406, decouple_loss:0.011438315734267235
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481431543827057, gen p mean: -0.7021220326423645, mean p set: 0.4486234188079834
The modified gen p mean: 0.4490707218647003, gen p mean: -0.7029403448104858, mean p set: 0.4495510160923004
loss_pred:0.02775176241993904, decouple_loss:0.011622429825365543
loss_pred:0.029272982850670815, decouple_loss:0.011597913689911366
The modified gen p mean: 0.44866806268692017, gen p mean: -0.7094603776931763, mean p set: 0.4491483271121979
loss_pred:0.027467802166938782, decouple_loss:0.012009327299892902
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496336579322815, gen p mean: -0.710931122303009, mean p set: 0.450113981962204
The modified gen p mean: 0.4489402174949646, gen p mean: -0.6969596743583679, mean p set: 0.4494204819202423
loss_pred:0.02822970040142536, decouple_loss:0.012197350151836872
loss_pred:0.029146280139684677, decouple_loss:0.011854659765958786
The modified gen p mean: 0.4497392773628235, gen p mean: -0.70453941822052, mean p set: 0.4502195417881012
loss_pred:0.028103290125727654, decouple_loss:0.011819125153124332
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947925209999084, gen p mean: -0.7052592635154724, mean p set: 0.44995957612991333
loss_pred:0.02754868194460869, decouple_loss:0.011168555356562138
The modified gen p mean: 0.44917985796928406, gen p mean: -0.7073521614074707, mean p set: 0.44966015219688416
The modified gen p mean: 0.4497184157371521, gen p mean: -0.7078949809074402, mean p set: 0.4501986801624298
loss_pred:0.027063295245170593, decouple_loss:0.01140880212187767
loss_pred:0.027476856485009193, decouple_loss:0.011300725862383842
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969406723976135, gen p mean: -0.709144651889801, mean p set: 0.45017439126968384
loss_pred:0.02824060060083866, decouple_loss:0.011214204132556915
The modified gen p mean: 0.44877198338508606, gen p mean: -0.711087703704834, mean p set: 0.44925227761268616
The modified gen p mean: 0.449298232793808, gen p mean: -0.7006356120109558, mean p set: 0.4497784972190857
loss_pred:0.027870619669556618, decouple_loss:0.010976122692227364
loss_pred:0.029649371281266212, decouple_loss:0.01082227285951376
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497491717338562, gen p mean: -0.7167258858680725, mean p set: 0.4502294957637787
The modified gen p mean: 0.4489441514015198, gen p mean: -0.7099179029464722, mean p set: 0.4494244158267975
loss_pred:0.02845069020986557, decouple_loss:0.010932988487184048
loss_pred:0.026567114517092705, decouple_loss:0.01113329827785492
The modified gen p mean: 0.44845089316368103, gen p mean: -0.711126446723938, mean p set: 0.4489312171936035
loss_pred:0.027661165222525597, decouple_loss:0.011177693493664265
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495718479156494, gen p mean: -0.7069267630577087, mean p set: 0.4500521421432495
The modified gen p mean: 0.44827064871788025, gen p mean: -0.7071839570999146, mean p set: 0.44875091314315796
loss_pred:0.026709439232945442, decouple_loss:0.011047515086829662
loss_pred:0.02765531837940216, decouple_loss:0.011089043691754341
The modified gen p mean: 0.45037803053855896, gen p mean: -0.712026059627533, mean p set: 0.45085832476615906
loss_pred:0.027507271617650986, decouple_loss:0.010983948595821857
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44987934827804565, gen p mean: -0.7095870971679688, mean p set: 0.45035961270332336
loss_pred:0.028361400589346886, decouple_loss:0.01068265549838543
The modified gen p mean: 0.44881120324134827, gen p mean: -0.7073726654052734, mean p set: 0.44929149746894836
The modified gen p mean: 0.4492141306400299, gen p mean: -0.7090872526168823, mean p set: 0.44969442486763
loss_pred:0.028269335627555847, decouple_loss:0.01113082841038704
loss_pred:0.0284870658069849, decouple_loss:0.010850508697330952
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
NaN value num: 0
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522593915462494, gen p mean: -0.7034356594085693, mean p set: 0.4527396559715271
The modified gen p mean: 0.4522206485271454, gen p mean: -0.7103071808815002, mean p set: 0.4527009129524231
loss_pred:0.02634485438466072, decouple_loss:0.013539980165660381
The modified gen p mean: 0.450897216796875, gen p mean: -0.717096209526062, mean p set: 0.4513775408267975
loss_pred:0.02589857019484043, decouple_loss:0.013617862947285175
loss_pred:0.026600852608680725, decouple_loss:0.012960526160895824
2023-05-04 11:36:32 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7158656716346741, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7284824848175049, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7208064794540405, mean p set: 0.4500633478164673
loss_pred:0.026574932038784027, decouple_loss:0.011647958308458328
loss_pred:0.02796080708503723, decouple_loss:0.012087676674127579
loss_pred:0.02695295959711075, decouple_loss:0.011717552319169044
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027753785252571106, avg_mse: 0.032961443066596985
current test mse: 0.032961
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499717652797699, gen p mean: -0.7217742800712585, mean p set: 0.45045205950737
loss_pred:0.026799872517585754, decouple_loss:0.012322192080318928
The modified gen p mean: 0.45147356390953064, gen p mean: -0.7163793444633484, mean p set: 0.45195385813713074
loss_pred:0.025533944368362427, decouple_loss:0.01285452488809824
The modified gen p mean: 0.45030415058135986, gen p mean: -0.7191900610923767, mean p set: 0.45078444480895996
loss_pred:0.026955822482705116, decouple_loss:0.01293317973613739
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521578848361969, gen p mean: -0.7253802418708801, mean p set: 0.452638179063797
The modified gen p mean: 0.44973820447921753, gen p mean: -0.7235550284385681, mean p set: 0.4502184987068176loss_pred:0.027225883677601814, decouple_loss:0.012238807044923306
loss_pred:0.027166742831468582, decouple_loss:0.011895355768501759
The modified gen p mean: 0.45389440655708313, gen p mean: -0.7242662906646729, mean p set: 0.45437467098236084
loss_pred:0.02572077512741089, decouple_loss:0.012873304076492786
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45068255066871643, gen p mean: -0.7241951823234558, mean p set: 0.45116284489631653
The modified gen p mean: 0.4508111774921417, gen p mean: -0.725618302822113, mean p set: 0.4512914717197418
loss_pred:0.02703780308365822, decouple_loss:0.01203978806734085
loss_pred:0.02604822814464569, decouple_loss:0.012662085704505444
The modified gen p mean: 0.4495902359485626, gen p mean: -0.7254506349563599, mean p set: 0.4500705301761627
loss_pred:0.02652801387012005, decouple_loss:0.012903296388685703
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519071877002716, gen p mean: -0.7217035889625549, mean p set: 0.4523874819278717
The modified gen p mean: 0.44997653365135193, gen p mean: -0.725196897983551, mean p set: 0.450456827878952
loss_pred:0.025604315102100372, decouple_loss:0.011931410990655422
loss_pred:0.02754053846001625, decouple_loss:0.012554232962429523
The modified gen p mean: 0.4515414535999298, gen p mean: -0.7187233567237854, mean p set: 0.4520217776298523
loss_pred:0.02583511918783188, decouple_loss:0.01185793336480856
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499695599079132, gen p mean: -0.7274394631385803, mean p set: 0.4504498541355133
loss_pred:0.027231913059949875, decouple_loss:0.012600659392774105
The modified gen p mean: 0.45075225830078125, gen p mean: -0.7316102981567383, mean p set: 0.45123252272605896
The modified gen p mean: 0.4518769085407257, gen p mean: -0.7178982496261597, mean p set: 0.4523571729660034
loss_pred:0.02721218951046467, decouple_loss:0.012629387900233269
loss_pred:0.025630798190832138, decouple_loss:0.011460866779088974
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500679075717926, gen p mean: -0.7263972163200378, mean p set: 0.4505482017993927
The modified gen p mean: 0.4520878493785858, gen p mean: -0.7200048565864563, mean p set: 0.4525681734085083
loss_pred:0.026725895702838898, decouple_loss:0.01254220400005579
loss_pred:0.026181047782301903, decouple_loss:0.012507310137152672
The modified gen p mean: 0.45093464851379395, gen p mean: -0.7229937314987183, mean p set: 0.45141491293907166
loss_pred:0.02665359154343605, decouple_loss:0.012453550472855568
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490162134170532, gen p mean: -0.7134162187576294, mean p set: 0.4494965374469757
The modified gen p mean: 0.45066073536872864, gen p mean: -0.7227123975753784, mean p set: 0.45114099979400635
loss_pred:0.02766496315598488, decouple_loss:0.012073392979800701
loss_pred:0.02661079727113247, decouple_loss:0.012410405091941357
The modified gen p mean: 0.45007598400115967, gen p mean: -0.7201920747756958, mean p set: 0.45055627822875977
loss_pred:0.02640938013792038, decouple_loss:0.012070979923009872
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510863423347473, gen p mean: -0.7094571590423584, mean p set: 0.451566606760025
The modified gen p mean: 0.45123782753944397, gen p mean: -0.7095577716827393, mean p set: 0.45171812176704407
loss_pred:0.02811271883547306, decouple_loss:0.012193738482892513
loss_pred:0.02777010016143322, decouple_loss:0.01189757976680994
The modified gen p mean: 0.45057156682014465, gen p mean: -0.7172885537147522, mean p set: 0.45105183124542236
loss_pred:0.027388593181967735, decouple_loss:0.011647210456430912
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501606523990631, gen p mean: -0.7265164852142334, mean p set: 0.4506409764289856
loss_pred:0.026445498690009117, decouple_loss:0.012248351238667965
The modified gen p mean: 0.4535161554813385, gen p mean: -0.7224904298782349, mean p set: 0.453996479511261
The modified gen p mean: 0.4511641561985016, gen p mean: -0.7154810428619385, mean p set: 0.4516444504261017
loss_pred:0.025426384061574936, decouple_loss:0.012768523767590523loss_pred:0.028043998405337334, decouple_loss:0.012367709539830685
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502183198928833, gen p mean: -0.724460244178772, mean p set: 0.4506986141204834
loss_pred:0.02710724249482155, decouple_loss:0.011665066704154015
The modified gen p mean: 0.45372727513313293, gen p mean: -0.7142556309700012, mean p set: 0.45420756936073303
The modified gen p mean: 0.4521706998348236, gen p mean: -0.7163044214248657, mean p set: 0.4526509940624237
loss_pred:0.02596733532845974, decouple_loss:0.012431775219738483
loss_pred:0.028244739398360252, decouple_loss:0.01141325943171978
2023-05-04 11:40:04 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7125177979469299, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7251839637756348, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.71796715259552, mean p set: 0.4500633478164673
loss_pred:0.02665737271308899, decouple_loss:0.01258721575140953
loss_pred:0.0281992070376873, decouple_loss:0.0128793865442276
loss_pred:0.027130620554089546, decouple_loss:0.012636982835829258
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02796412631869316, avg_mse: 0.03332366794347763
current test mse: 0.033324
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523758292198181, gen p mean: -0.7085856795310974, mean p set: 0.4528560936450958
The modified gen p mean: 0.4504055976867676, gen p mean: -0.7201570868492126, mean p set: 0.4508858919143677
loss_pred:0.026495015248656273, decouple_loss:0.011591424234211445
loss_pred:0.026622150093317032, decouple_loss:0.011686459183692932
The modified gen p mean: 0.4505867660045624, gen p mean: -0.7186737060546875, mean p set: 0.4510670304298401
loss_pred:0.02606196328997612, decouple_loss:0.011554067954421043
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499722719192505, gen p mean: -0.7170553803443909, mean p set: 0.4504525363445282
The modified gen p mean: 0.4502720534801483, gen p mean: -0.7099485993385315, mean p set: 0.450752317905426
loss_pred:0.027007658034563065, decouple_loss:0.011379572562873363
loss_pred:0.02568691223859787, decouple_loss:0.012188926339149475
The modified gen p mean: 0.4522046744823456, gen p mean: -0.7171531319618225, mean p set: 0.4526849389076233
loss_pred:0.026488229632377625, decouple_loss:0.011997045017778873
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45017924904823303, gen p mean: -0.7111448645591736, mean p set: 0.45065951347351074
The modified gen p mean: 0.45059317350387573, gen p mean: -0.7037560343742371, mean p set: 0.45107343792915344
loss_pred:0.02537122555077076, decouple_loss:0.012127766385674477
loss_pred:0.026653742417693138, decouple_loss:0.011596173979341984
The modified gen p mean: 0.45031094551086426, gen p mean: -0.7078770995140076, mean p set: 0.45079126954078674
loss_pred:0.026595743373036385, decouple_loss:0.011089934036135674
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996291399002075, gen p mean: -0.7143458724021912, mean p set: 0.45044317841529846
The modified gen p mean: 0.45219239592552185, gen p mean: -0.7100675106048584, mean p set: 0.45267269015312195
loss_pred:0.026445504277944565, decouple_loss:0.01152464747428894
loss_pred:0.025355437770485878, decouple_loss:0.011468310840427876
The modified gen p mean: 0.45250585675239563, gen p mean: -0.7140821814537048, mean p set: 0.4529861509799957
loss_pred:0.02574482560157776, decouple_loss:0.012072613462805748
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526808559894562, gen p mean: -0.7158911228179932, mean p set: 0.4531611502170563
The modified gen p mean: 0.45085400342941284, gen p mean: -0.7219228148460388, mean p set: 0.45133426785469055
loss_pred:0.026580357924103737, decouple_loss:0.011331718415021896
loss_pred:0.027156434953212738, decouple_loss:0.01127688866108656
The modified gen p mean: 0.4501114785671234, gen p mean: -0.7256687879562378, mean p set: 0.4505917727947235
loss_pred:0.025846881791949272, decouple_loss:0.011754615232348442
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45101141929626465, gen p mean: -0.7366925477981567, mean p set: 0.45149174332618713
loss_pred:0.026135461404919624, decouple_loss:0.011606233194470406
The modified gen p mean: 0.4500938355922699, gen p mean: -0.7339881658554077, mean p set: 0.4505741000175476
The modified gen p mean: 0.45253220200538635, gen p mean: -0.7292892336845398, mean p set: 0.45301249623298645
loss_pred:0.02693604864180088, decouple_loss:0.011730552650988102
loss_pred:0.025593705475330353, decouple_loss:0.011114069260656834
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505920112133026, gen p mean: -0.7218292355537415, mean p set: 0.4510722756385803
The modified gen p mean: 0.45037972927093506, gen p mean: -0.7303444743156433, mean p set: 0.45086002349853516
loss_pred:0.02663201093673706, decouple_loss:0.011742082424461842
loss_pred:0.027002546936273575, decouple_loss:0.011535446159541607
The modified gen p mean: 0.4523325562477112, gen p mean: -0.7238406538963318, mean p set: 0.45281288027763367
loss_pred:0.028318261727690697, decouple_loss:0.011313147842884064
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45085054636001587, gen p mean: -0.7260322570800781, mean p set: 0.45133084058761597
loss_pred:0.02639838680624962, decouple_loss:0.010924313217401505
The modified gen p mean: 0.45092833042144775, gen p mean: -0.717253565788269, mean p set: 0.45140859484672546
The modified gen p mean: 0.45046618580818176, gen p mean: -0.7254560589790344, mean p set: 0.4509464502334595
loss_pred:0.027652082964777946, decouple_loss:0.011005919426679611
loss_pred:0.025836031883955002, decouple_loss:0.011484860442578793
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45096904039382935, gen p mean: -0.7157379984855652, mean p set: 0.45144933462142944
The modified gen p mean: 0.4502878487110138, gen p mean: -0.7200605273246765, mean p set: 0.4507681429386139
loss_pred:0.02497307024896145, decouple_loss:0.0110931983217597
loss_pred:0.02603410743176937, decouple_loss:0.010857299901545048The modified gen p mean: 0.4506599009037018, gen p mean: -0.720020055770874, mean p set: 0.4511401653289795
loss_pred:0.026557307690382004, decouple_loss:0.0109510887414217
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
NaN value num: 0
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519462585449219, gen p mean: -0.7364287972450256, mean p set: 0.45242658257484436
The modified gen p mean: 0.4541001617908478, gen p mean: -0.7444695830345154, mean p set: 0.4545804262161255
loss_pred:0.026726841926574707, decouple_loss:0.013584143482148647
The modified gen p mean: 0.4505912661552429, gen p mean: -0.7298030257225037, mean p set: 0.451071560382843
loss_pred:0.026054374873638153, decouple_loss:0.01148214377462864
loss_pred:0.026366397738456726, decouple_loss:0.012091612443327904
2023-05-04 11:44:20 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7209715843200684, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7340959906578064, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7257457375526428, mean p set: 0.4500633478164673
loss_pred:0.02655692957341671, decouple_loss:0.012477926909923553
loss_pred:0.028008142486214638, decouple_loss:0.012656073085963726
loss_pred:0.02702559530735016, decouple_loss:0.012183324433863163
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027818843722343445, avg_mse: 0.03313593938946724
current test mse: 0.033136
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519380033016205, gen p mean: -0.7345799207687378, mean p set: 0.4524182975292206
The modified gen p mean: 0.4523387849330902, gen p mean: -0.7324064373970032, mean p set: 0.4528190791606903
loss_pred:0.026243163272738457, decouple_loss:0.012016195803880692
loss_pred:0.025624217465519905, decouple_loss:0.011894186958670616
The modified gen p mean: 0.45383355021476746, gen p mean: -0.7272164821624756, mean p set: 0.45431381464004517
loss_pred:0.025821469724178314, decouple_loss:0.012289471924304962
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45240917801856995, gen p mean: -0.7259199023246765, mean p set: 0.45288947224617004
The modified gen p mean: 0.45161476731300354, gen p mean: -0.72559654712677, mean p set: 0.45209503173828125
loss_pred:0.025728946551680565, decouple_loss:0.010719187557697296
loss_pred:0.02517876960337162, decouple_loss:0.012046032585203648
The modified gen p mean: 0.4503896236419678, gen p mean: -0.725062906742096, mean p set: 0.45086991786956787
loss_pred:0.02565448358654976, decouple_loss:0.011325177736580372
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451864093542099, gen p mean: -0.7250847816467285, mean p set: 0.4523443579673767
The modified gen p mean: 0.45217084884643555, gen p mean: -0.7243077754974365, mean p set: 0.45265111327171326
loss_pred:0.025793861597776413, decouple_loss:0.011666087433695793
loss_pred:0.026227222755551338, decouple_loss:0.011614134535193443
The modified gen p mean: 0.4532493054866791, gen p mean: -0.7247710227966309, mean p set: 0.4537295699119568
loss_pred:0.02526930905878544, decouple_loss:0.011938652954995632
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504230320453644, gen p mean: -0.7277852892875671, mean p set: 0.4509033262729645
The modified gen p mean: 0.45042431354522705, gen p mean: -0.7223300933837891, mean p set: 0.45090457797050476
loss_pred:0.02617182396352291, decouple_loss:0.01127028837800026
loss_pred:0.02587050199508667, decouple_loss:0.011733854189515114
The modified gen p mean: 0.4525851309299469, gen p mean: -0.7318707704544067, mean p set: 0.453065425157547
loss_pred:0.026297325268387794, decouple_loss:0.011111031286418438
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493984580039978, gen p mean: -0.7198513746261597, mean p set: 0.4498787522315979
loss_pred:0.024695435538887978, decouple_loss:0.011941451579332352
The modified gen p mean: 0.4527290463447571, gen p mean: -0.7308817505836487, mean p set: 0.4532093107700348
The modified gen p mean: 0.4512014091014862, gen p mean: -0.7299277782440186, mean p set: 0.4516817331314087
loss_pred:0.02543606609106064, decouple_loss:0.01169566810131073
loss_pred:0.025755565613508224, decouple_loss:0.011455455794930458
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519653022289276, gen p mean: -0.7419315576553345, mean p set: 0.4524455666542053
loss_pred:0.025670913979411125, decouple_loss:0.011384808458387852
The modified gen p mean: 0.45040595531463623, gen p mean: -0.7402483224868774, mean p set: 0.45088624954223633
The modified gen p mean: 0.450573205947876, gen p mean: -0.7281890511512756, mean p set: 0.45105352997779846
loss_pred:0.026246093213558197, decouple_loss:0.011681823991239071
loss_pred:0.027238914743065834, decouple_loss:0.011310474947094917
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45334434509277344, gen p mean: -0.7389289140701294, mean p set: 0.45382463932037354
The modified gen p mean: 0.45038142800331116, gen p mean: -0.734610915184021, mean p set: 0.45086169242858887
loss_pred:0.02615802176296711, decouple_loss:0.011024371720850468
loss_pred:0.0270601287484169, decouple_loss:0.011007161810994148
The modified gen p mean: 0.4511701762676239, gen p mean: -0.7463821172714233, mean p set: 0.4516505002975464
loss_pred:0.025132987648248672, decouple_loss:0.011232352815568447
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514361321926117, gen p mean: -0.7511689066886902, mean p set: 0.4519164264202118
The modified gen p mean: 0.449937641620636, gen p mean: -0.7402478456497192, mean p set: 0.4504178762435913
loss_pred:0.02663620375096798, decouple_loss:0.010834037326276302
loss_pred:0.02638379856944084, decouple_loss:0.011253135278820992
The modified gen p mean: 0.4501190483570099, gen p mean: -0.745435893535614, mean p set: 0.4505993127822876
loss_pred:0.02663385309278965, decouple_loss:0.01105467975139618
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45228126645088196, gen p mean: -0.7430765628814697, mean p set: 0.45276156067848206
loss_pred:0.02563176304101944, decouple_loss:0.010555852204561234
The modified gen p mean: 0.4520409405231476, gen p mean: -0.7363725900650024, mean p set: 0.45252126455307007
The modified gen p mean: 0.4513079524040222, gen p mean: -0.7425253391265869, mean p set: 0.4517882466316223
loss_pred:0.025197604671120644, decouple_loss:0.011087571270763874
loss_pred:0.026113642379641533, decouple_loss:0.011038560420274734
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530911147594452, gen p mean: -0.7254610657691956, mean p set: 0.4535713791847229
The modified gen p mean: 0.45258837938308716, gen p mean: -0.7175535559654236, mean p set: 0.45306864380836487
loss_pred:0.02552957274019718, decouple_loss:0.011315644718706608
loss_pred:0.026190197095274925, decouple_loss:0.011226393282413483
The modified gen p mean: 0.45273318886756897, gen p mean: -0.7312815189361572, mean p set: 0.45321348309516907
loss_pred:0.025768989697098732, decouple_loss:0.011238855309784412
2023-05-04 11:47:55 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7112911939620972, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7242239117622375, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7162676453590393, mean p set: 0.4500633478164673
loss_pred:0.02654910273849964, decouple_loss:0.012299809604883194
loss_pred:0.027980541810393333, decouple_loss:0.012192881666123867
loss_pred:0.02692635916173458, decouple_loss:0.011987949721515179
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027760013937950134, avg_mse: 0.03307170420885086
current test mse: 0.033072
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45198854804039, gen p mean: -0.7327738404273987, mean p set: 0.4524688422679901
The modified gen p mean: 0.4534416198730469, gen p mean: -0.7128350734710693, mean p set: 0.453921914100647
loss_pred:0.025796782225370407, decouple_loss:0.011069288477301598
loss_pred:0.02583305351436138, decouple_loss:0.011281528510153294
The modified gen p mean: 0.4510310888290405, gen p mean: -0.7159309387207031, mean p set: 0.4515113830566406
loss_pred:0.02597183734178543, decouple_loss:0.010836135596036911
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45060399174690247, gen p mean: -0.7203159332275391, mean p set: 0.45108428597450256
loss_pred:0.026820572093129158, decouple_loss:0.010736962780356407
The modified gen p mean: 0.45310530066490173, gen p mean: -0.7405928373336792, mean p set: 0.45358556509017944
The modified gen p mean: 0.4548640251159668, gen p mean: -0.7361879944801331, mean p set: 0.4553443193435669
loss_pred:0.02621600590646267, decouple_loss:0.011267720721662045
loss_pred:0.025253217667341232, decouple_loss:0.011398401111364365
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45282450318336487, gen p mean: -0.7293509244918823, mean p set: 0.4533047676086426
The modified gen p mean: 0.45117470622062683, gen p mean: -0.7270048260688782, mean p set: 0.45165497064590454
loss_pred:0.02611054852604866, decouple_loss:0.010653678327798843
loss_pred:0.02693193405866623, decouple_loss:0.010533608496189117
The modified gen p mean: 0.45183470845222473, gen p mean: -0.7311659455299377, mean p set: 0.45231500267982483
loss_pred:0.025064663961529732, decouple_loss:0.010803613811731339
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505560100078583, gen p mean: -0.7251041531562805, mean p set: 0.4510363042354584
The modified gen p mean: 0.4507555365562439, gen p mean: -0.7269862294197083, mean p set: 0.451235830783844
loss_pred:0.025626562535762787, decouple_loss:0.010955535806715488
loss_pred:0.025071298703551292, decouple_loss:0.010511433705687523
The modified gen p mean: 0.4494636654853821, gen p mean: -0.7298575043678284, mean p set: 0.4499439597129822
loss_pred:0.025603169575333595, decouple_loss:0.010806376114487648
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45290035009384155, gen p mean: -0.7308754920959473, mean p set: 0.45338064432144165
The modified gen p mean: 0.45174407958984375, gen p mean: -0.7407844662666321, mean p set: 0.45222437381744385
loss_pred:0.02643091231584549, decouple_loss:0.01073608361184597
loss_pred:0.02583775483071804, decouple_loss:0.010934179648756981
The modified gen p mean: 0.452301561832428, gen p mean: -0.7415652871131897, mean p set: 0.4527818560600281
loss_pred:0.025373686105012894, decouple_loss:0.010951428674161434
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024576783180237, gen p mean: -0.7357859015464783, mean p set: 0.4507260322570801
The modified gen p mean: 0.45404502749443054, gen p mean: -0.7488552331924438, mean p set: 0.45452532172203064
loss_pred:0.026226729154586792, decouple_loss:0.010959749110043049
loss_pred:0.02672560140490532, decouple_loss:0.010963271372020245
The modified gen p mean: 0.4507405161857605, gen p mean: -0.7361704707145691, mean p set: 0.4512208104133606
loss_pred:0.026027359068393707, decouple_loss:0.01114689465612173
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515925645828247, gen p mean: -0.7419539093971252, mean p set: 0.4520728290081024
loss_pred:0.024869805201888084, decouple_loss:0.010519569739699364
The modified gen p mean: 0.4540459215641022, gen p mean: -0.7492780089378357, mean p set: 0.45452621579170227
The modified gen p mean: 0.4497024416923523, gen p mean: -0.7331732511520386, mean p set: 0.45018270611763
loss_pred:0.02451048046350479, decouple_loss:0.010881815105676651
loss_pred:0.02523268386721611, decouple_loss:0.010955296456813812
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531160593032837, gen p mean: -0.7557162046432495, mean p set: 0.4535963535308838
loss_pred:0.025443214923143387, decouple_loss:0.010486473329365253
The modified gen p mean: 0.4505847990512848, gen p mean: -0.7303206324577332, mean p set: 0.4510650634765625
The modified gen p mean: 0.44958359003067017, gen p mean: -0.7315694093704224, mean p set: 0.45006391406059265
loss_pred:0.025560244917869568, decouple_loss:0.01032259501516819
loss_pred:0.02475602552294731, decouple_loss:0.010771789588034153
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45201167464256287, gen p mean: -0.7393695712089539, mean p set: 0.45249199867248535
loss_pred:0.02604525536298752, decouple_loss:0.010391325689852238
The modified gen p mean: 0.44977107644081116, gen p mean: -0.7273285984992981, mean p set: 0.45025137066841125
The modified gen p mean: 0.4512365460395813, gen p mean: -0.7356943488121033, mean p set: 0.451716810464859
loss_pred:0.02548377960920334, decouple_loss:0.010197610594332218
loss_pred:0.025691160932183266, decouple_loss:0.010536324232816696
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477365016937256, gen p mean: -0.7251628637313843, mean p set: 0.44821682572364807
The modified gen p mean: 0.4472653865814209, gen p mean: -0.7269181609153748, mean p set: 0.4477456510066986
The modified gen p mean: 0.44713616371154785, gen p mean: -0.7270556092262268, mean p set: 0.44761648774147034
loss_pred:0.027764596045017242, decouple_loss:0.011498039588332176
loss_pred:0.026852106675505638, decouple_loss:0.011283939704298973
loss_pred:0.027987798675894737, decouple_loss:0.010765745304524899
2023-05-04 11:52:16 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7130613923072815, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7262181639671326, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7180479168891907, mean p set: 0.4500633478164673
loss_pred:0.02649432048201561, decouple_loss:0.011441859416663647
loss_pred:0.027867289260029793, decouple_loss:0.01189864706248045
loss_pred:0.026875188574194908, decouple_loss:0.011336144991219044
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027656875550746918, avg_mse: 0.03294061869382858
current test mse: 0.032941
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472610652446747, gen p mean: -0.7136951088905334, mean p set: 0.4477413594722748
The modified gen p mean: 0.4489087760448456, gen p mean: -0.7200483679771423, mean p set: 0.4493890404701233
loss_pred:0.027259469032287598, decouple_loss:0.011489076539874077
loss_pred:0.026961175724864006, decouple_loss:0.010923253372311592
The modified gen p mean: 0.4483383595943451, gen p mean: -0.7110120058059692, mean p set: 0.4488186836242676
loss_pred:0.027241606265306473, decouple_loss:0.010903537273406982
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831040501594543, gen p mean: -0.724819540977478, mean p set: 0.44879069924354553
The modified gen p mean: 0.4461727440357208, gen p mean: -0.7217586636543274, mean p set: 0.44665300846099854
loss_pred:0.026570305228233337, decouple_loss:0.010272717103362083
loss_pred:0.027274085208773613, decouple_loss:0.010894889943301678
The modified gen p mean: 0.44758838415145874, gen p mean: -0.724644660949707, mean p set: 0.44806867837905884
loss_pred:0.026757294312119484, decouple_loss:0.010988549329340458
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471328556537628, gen p mean: -0.7280932068824768, mean p set: 0.4476131498813629
The modified gen p mean: 0.4476584792137146, gen p mean: -0.7338135838508606, mean p set: 0.4481387734413147
loss_pred:0.026497025042772293, decouple_loss:0.010379618965089321
loss_pred:0.02700957842171192, decouple_loss:0.010919557884335518
The modified gen p mean: 0.44822147488594055, gen p mean: -0.7299473285675049, mean p set: 0.44870179891586304
loss_pred:0.026846524327993393, decouple_loss:0.010824128985404968
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475630223751068, gen p mean: -0.7392348051071167, mean p set: 0.4480433166027069
The modified gen p mean: 0.44696977734565735, gen p mean: -0.7388476133346558, mean p set: 0.44745007157325745
loss_pred:0.026337845250964165, decouple_loss:0.010524637997150421
loss_pred:0.026369616389274597, decouple_loss:0.010471981018781662
The modified gen p mean: 0.4478815495967865, gen p mean: -0.7411125302314758, mean p set: 0.4483618438243866
loss_pred:0.026665080338716507, decouple_loss:0.011114021763205528
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477505385875702, gen p mean: -0.740304172039032, mean p set: 0.4482308626174927
loss_pred:0.02751173824071884, decouple_loss:0.010476949624717236
The modified gen p mean: 0.4473407566547394, gen p mean: -0.7398369908332825, mean p set: 0.4478210508823395
The modified gen p mean: 0.4477446377277374, gen p mean: -0.742940366268158, mean p set: 0.4482249617576599
loss_pred:0.02732338011264801, decouple_loss:0.010560081340372562
loss_pred:0.026592062786221504, decouple_loss:0.010423208586871624
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476693272590637, gen p mean: -0.7373999357223511, mean p set: 0.44814959168434143
loss_pred:0.02658713608980179, decouple_loss:0.010325213894248009
The modified gen p mean: 0.4482875466346741, gen p mean: -0.7343838810920715, mean p set: 0.4487678110599518
The modified gen p mean: 0.44838187098503113, gen p mean: -0.7305540442466736, mean p set: 0.4488621652126312
loss_pred:0.026446297764778137, decouple_loss:0.0100296875461936
loss_pred:0.027719635516405106, decouple_loss:0.010319896042346954
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780266284942627, gen p mean: -0.7353094220161438, mean p set: 0.44828295707702637
The modified gen p mean: 0.44772869348526, gen p mean: -0.731060266494751, mean p set: 0.4482089579105377
loss_pred:0.027274740859866142, decouple_loss:0.010772163979709148
loss_pred:0.02746017649769783, decouple_loss:0.010741588659584522
The modified gen p mean: 0.4490087032318115, gen p mean: -0.7320547699928284, mean p set: 0.4494889974594116
loss_pred:0.026279283687472343, decouple_loss:0.010840136557817459
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742661714553833, gen p mean: -0.729293942451477, mean p set: 0.4479069411754608
The modified gen p mean: 0.4468141198158264, gen p mean: -0.7290840744972229, mean p set: 0.4472944438457489
loss_pred:0.02720431052148342, decouple_loss:0.010554512962698936
loss_pred:0.027007175609469414, decouple_loss:0.010803595185279846
The modified gen p mean: 0.4477596580982208, gen p mean: -0.7305559515953064, mean p set: 0.4482399523258209
loss_pred:0.027291052043437958, decouple_loss:0.010539671406149864
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44712862372398376, gen p mean: -0.7292765974998474, mean p set: 0.44760891795158386
The modified gen p mean: 0.44737324118614197, gen p mean: -0.7283733487129211, mean p set: 0.44785353541374207
loss_pred:0.027565406635403633, decouple_loss:0.010807293467223644
loss_pred:0.026799166575074196, decouple_loss:0.010816721245646477
The modified gen p mean: 0.44683799147605896, gen p mean: -0.7288260459899902, mean p set: 0.44731831550598145
loss_pred:0.02740325778722763, decouple_loss:0.01128098089247942
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466997981071472, gen p mean: -0.7320790886878967, mean p set: 0.4471800923347473
The modified gen p mean: 0.44783875346183777, gen p mean: -0.733596920967102, mean p set: 0.44831904768943787
loss_pred:0.027675246819853783, decouple_loss:0.01025326643139124
loss_pred:0.02728164568543434, decouple_loss:0.010591681115329266
The modified gen p mean: 0.4473603069782257, gen p mean: -0.7304600477218628, mean p set: 0.4478406012058258
loss_pred:0.027471719309687614, decouple_loss:0.010271129198372364
2023-05-04 11:55:52 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7297314405441284, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7419724464416504, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.734323263168335, mean p set: 0.4500633478164673
loss_pred:0.0263261366635561, decouple_loss:0.010663190856575966
loss_pred:0.027777699753642082, decouple_loss:0.010621299035847187
loss_pred:0.026830706745386124, decouple_loss:0.010730937123298645
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027511771768331528, avg_mse: 0.03280717879533768
current test mse: 0.032807
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481663703918457, gen p mean: -0.7355857491493225, mean p set: 0.4486466944217682
The modified gen p mean: 0.44722214341163635, gen p mean: -0.736266016960144, mean p set: 0.44770246744155884
loss_pred:0.026872657239437103, decouple_loss:0.010542834177613258
loss_pred:0.02653985284268856, decouple_loss:0.01055996771901846
The modified gen p mean: 0.44807589054107666, gen p mean: -0.7294379472732544, mean p set: 0.44855615496635437
loss_pred:0.026962315663695335, decouple_loss:0.010713730938732624
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488471746444702, gen p mean: -0.717312753200531, mean p set: 0.4493274986743927
loss_pred:0.02686723694205284, decouple_loss:0.010662151500582695
The modified gen p mean: 0.44873046875, gen p mean: -0.7228434681892395, mean p set: 0.4492107927799225
The modified gen p mean: 0.44771134853363037, gen p mean: -0.7232984900474548, mean p set: 0.44819164276123047
loss_pred:0.027250830084085464, decouple_loss:0.010887782089412212
loss_pred:0.026058388873934746, decouple_loss:0.011055604554712772
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476114511489868, gen p mean: -0.720781683921814, mean p set: 0.4480917155742645
loss_pred:0.02765573561191559, decouple_loss:0.010543247684836388
The modified gen p mean: 0.4475277066230774, gen p mean: -0.7196687459945679, mean p set: 0.4480080008506775
The modified gen p mean: 0.44856175780296326, gen p mean: -0.7121979594230652, mean p set: 0.44904205203056335
loss_pred:0.026837116107344627, decouple_loss:0.010702717117965221
loss_pred:0.02638140320777893, decouple_loss:0.010464644990861416
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44612351059913635, gen p mean: -0.7246540188789368, mean p set: 0.44660380482673645
The modified gen p mean: 0.44706377387046814, gen p mean: -0.7220522165298462, mean p set: 0.44754406809806824
loss_pred:0.02765694260597229, decouple_loss:0.010468254797160625
loss_pred:0.027132367715239525, decouple_loss:0.010590732097625732
The modified gen p mean: 0.44744864106178284, gen p mean: -0.7215778231620789, mean p set: 0.44792893528938293
loss_pred:0.027337711304426193, decouple_loss:0.009982475079596043
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694724678993225, gen p mean: -0.728824257850647, mean p set: 0.44742754101753235
The modified gen p mean: 0.44734418392181396, gen p mean: -0.7209975719451904, mean p set: 0.4478244483470917
loss_pred:0.02643929049372673, decouple_loss:0.011480974033474922
loss_pred:0.02703862451016903, decouple_loss:0.010448379442095757
The modified gen p mean: 0.447806179523468, gen p mean: -0.7191356420516968, mean p set: 0.4482864737510681
loss_pred:0.026471944525837898, decouple_loss:0.010278131812810898
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482654631137848, gen p mean: -0.7227153182029724, mean p set: 0.4487457573413849
loss_pred:0.02767682448029518, decouple_loss:0.010824943892657757
The modified gen p mean: 0.4475401043891907, gen p mean: -0.7199914455413818, mean p set: 0.44802039861679077
The modified gen p mean: 0.44775915145874023, gen p mean: -0.7227643132209778, mean p set: 0.44823944568634033
loss_pred:0.02640693448483944, decouple_loss:0.010420648381114006
loss_pred:0.027493536472320557, decouple_loss:0.010049723088741302
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798049330711365, gen p mean: -0.7194512486457825, mean p set: 0.44846081733703613
loss_pred:0.026767680421471596, decouple_loss:0.010281645692884922
The modified gen p mean: 0.4474487006664276, gen p mean: -0.7205263376235962, mean p set: 0.4479289650917053
loss_pred:0.027280708774924278, decouple_loss:0.010443059727549553
The modified gen p mean: 0.44658082723617554, gen p mean: -0.7217577695846558, mean p set: 0.44706112146377563
loss_pred:0.02703750692307949, decouple_loss:0.010041127912700176
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482972323894501, gen p mean: -0.7182626724243164, mean p set: 0.44877755641937256
loss_pred:0.027751699090003967, decouple_loss:0.01036940235644579
The modified gen p mean: 0.4472672939300537, gen p mean: -0.7152522802352905, mean p set: 0.4477475583553314
The modified gen p mean: 0.44723835587501526, gen p mean: -0.7143600583076477, mean p set: 0.44771865010261536
loss_pred:0.026968995109200478, decouple_loss:0.010668975301086903
loss_pred:0.026594849303364754, decouple_loss:0.01061294786632061
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478708803653717, gen p mean: -0.7196232080459595, mean p set: 0.4483511745929718
The modified gen p mean: 0.44754457473754883, gen p mean: -0.7217727303504944, mean p set: 0.4480248689651489
loss_pred:0.026655983179807663, decouple_loss:0.00990799255669117
loss_pred:0.026203203946352005, decouple_loss:0.009911966510117054
The modified gen p mean: 0.4473842680454254, gen p mean: -0.7269399762153625, mean p set: 0.4478645324707031
loss_pred:0.02632462978363037, decouple_loss:0.010719439014792442
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
NaN value num: 0
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45357754826545715, gen p mean: -0.7259160280227661, mean p set: 0.45405787229537964
The modified gen p mean: 0.4516810476779938, gen p mean: -0.7257804870605469, mean p set: 0.45216134190559387
loss_pred:0.02775784581899643, decouple_loss:0.011322866193950176
The modified gen p mean: 0.45345067977905273, gen p mean: -0.7254043221473694, mean p set: 0.4539310038089752
loss_pred:0.026963938027620316, decouple_loss:0.011752266436815262
loss_pred:0.026472199708223343, decouple_loss:0.0115534458309412
2023-05-04 12:00:05 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7293066382408142, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7410566210746765, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7335618138313293, mean p set: 0.4500633478164673
loss_pred:0.026323119178414345, decouple_loss:0.010418680496513844
loss_pred:0.027831152081489563, decouple_loss:0.010717038065195084
loss_pred:0.026702607050538063, decouple_loss:0.01036591175943613
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027477320283651352, avg_mse: 0.03271428868174553
current test mse: 0.032714
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509217143058777, gen p mean: -0.7324588894844055, mean p set: 0.4514019787311554
The modified gen p mean: 0.45145028829574585, gen p mean: -0.737784743309021, mean p set: 0.45193058252334595
loss_pred:0.02524613030254841, decouple_loss:0.01110905408859253
loss_pred:0.025598427280783653, decouple_loss:0.011191186495125294
The modified gen p mean: 0.45231249928474426, gen p mean: -0.7359265685081482, mean p set: 0.45279279351234436
loss_pred:0.02771204523742199, decouple_loss:0.011706242337822914
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45166027545928955, gen p mean: -0.7323142290115356, mean p set: 0.45214059948921204
The modified gen p mean: 0.45001766085624695, gen p mean: -0.7294341921806335, mean p set: 0.45049792528152466
loss_pred:0.0269297044724226, decouple_loss:0.011732267215847969
loss_pred:0.025885459035634995, decouple_loss:0.011602851562201977
The modified gen p mean: 0.4510584771633148, gen p mean: -0.7355147004127502, mean p set: 0.45153874158859253
loss_pred:0.02580319344997406, decouple_loss:0.010763630270957947
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45218974351882935, gen p mean: -0.7414037585258484, mean p set: 0.45267003774642944
The modified gen p mean: 0.451269268989563, gen p mean: -0.7384470701217651, mean p set: 0.4517495334148407
loss_pred:0.026771822944283485, decouple_loss:0.012158605270087719
loss_pred:0.02638578601181507, decouple_loss:0.011880425736308098
The modified gen p mean: 0.4519060552120209, gen p mean: -0.7436745762825012, mean p set: 0.4523863196372986
loss_pred:0.025405889376997948, decouple_loss:0.011749938130378723
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45250239968299866, gen p mean: -0.7274424433708191, mean p set: 0.45298269391059875
The modified gen p mean: 0.45289239287376404, gen p mean: -0.7331031560897827, mean p set: 0.45337265729904175
loss_pred:0.026879362761974335, decouple_loss:0.011631211265921593
loss_pred:0.025520605966448784, decouple_loss:0.011627444066107273
The modified gen p mean: 0.4516950845718384, gen p mean: -0.7335494756698608, mean p set: 0.4521753489971161
loss_pred:0.026898877695202827, decouple_loss:0.011778324842453003
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45007577538490295, gen p mean: -0.7271482944488525, mean p set: 0.45055609941482544
The modified gen p mean: 0.45168137550354004, gen p mean: -0.734636664390564, mean p set: 0.4521616995334625
loss_pred:0.02808327041566372, decouple_loss:0.01287078857421875
loss_pred:0.02645258978009224, decouple_loss:0.012759923934936523
The modified gen p mean: 0.4518498182296753, gen p mean: -0.7288533449172974, mean p set: 0.4523301124572754
loss_pred:0.026853268966078758, decouple_loss:0.012157456949353218
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504961371421814, gen p mean: -0.7266553044319153, mean p set: 0.4509764611721039
The modified gen p mean: 0.45280569791793823, gen p mean: -0.7353283166885376, mean p set: 0.45328596234321594
loss_pred:0.02504921145737171, decouple_loss:0.011843102984130383
loss_pred:0.027646049857139587, decouple_loss:0.011881403625011444
The modified gen p mean: 0.4502457082271576, gen p mean: -0.7314492464065552, mean p set: 0.4507259726524353
loss_pred:0.0258026160299778, decouple_loss:0.011834648437798023
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516415297985077, gen p mean: -0.7372696995735168, mean p set: 0.4521217942237854
loss_pred:0.027945077046751976, decouple_loss:0.011731704697012901
The modified gen p mean: 0.45218443870544434, gen p mean: -0.7392679452896118, mean p set: 0.45266470313072205
The modified gen p mean: 0.4522726833820343, gen p mean: -0.7354590892791748, mean p set: 0.452752947807312
loss_pred:0.02613726258277893, decouple_loss:0.01168851274996996
loss_pred:0.027481142431497574, decouple_loss:0.01232660748064518
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45151805877685547, gen p mean: -0.7363597750663757, mean p set: 0.45199838280677795
The modified gen p mean: 0.45141056180000305, gen p mean: -0.7425277233123779, mean p set: 0.45189085602760315
loss_pred:0.02701147086918354, decouple_loss:0.012474524788558483
loss_pred:0.025699159130454063, decouple_loss:0.012120440602302551
The modified gen p mean: 0.4508257210254669, gen p mean: -0.7411447763442993, mean p set: 0.451306015253067
loss_pred:0.027568884193897247, decouple_loss:0.012294428423047066
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451878160238266, gen p mean: -0.7592491507530212, mean p set: 0.4523584544658661
loss_pred:0.026563437655568123, decouple_loss:0.011945690959692001
The modified gen p mean: 0.4513852596282959, gen p mean: -0.752206027507782, mean p set: 0.451865553855896
The modified gen p mean: 0.4518425166606903, gen p mean: -0.7462997436523438, mean p set: 0.452322781085968
loss_pred:0.026778273284435272, decouple_loss:0.011714844033122063
loss_pred:0.027626076713204384, decouple_loss:0.011494682170450687
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517439603805542, gen p mean: -0.7577340602874756, mean p set: 0.4522242546081543
The modified gen p mean: 0.45103371143341064, gen p mean: -0.7544774413108826, mean p set: 0.45151403546333313
loss_pred:0.025322653353214264, decouple_loss:0.011331327259540558
loss_pred:0.026157790794968605, decouple_loss:0.01148229744285345
The modified gen p mean: 0.4517342448234558, gen p mean: -0.7535771131515503, mean p set: 0.4522145688533783
loss_pred:0.027613330632448196, decouple_loss:0.011514980345964432
2023-05-04 12:03:38 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.735194742679596, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7474713921546936, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7399358153343201, mean p set: 0.4500633478164673
loss_pred:0.026686331257224083, decouple_loss:0.012338298372924328
loss_pred:0.02823660336434841, decouple_loss:0.012311812490224838
loss_pred:0.027082936838269234, decouple_loss:0.012038478627800941
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027946768328547478, avg_mse: 0.03349678963422775
current test mse: 0.033497
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450979620218277, gen p mean: -0.7405073642730713, mean p set: 0.4514599144458771
The modified gen p mean: 0.4513300359249115, gen p mean: -0.741424560546875, mean p set: 0.4518103301525116
loss_pred:0.026757190003991127, decouple_loss:0.011647656559944153
loss_pred:0.02536696195602417, decouple_loss:0.01075307559221983
The modified gen p mean: 0.451555460691452, gen p mean: -0.74440598487854, mean p set: 0.4520357549190521
loss_pred:0.026457060128450394, decouple_loss:0.011242089793086052
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510553181171417, gen p mean: -0.7368783354759216, mean p set: 0.4515356123447418
loss_pred:0.026948776096105576, decouple_loss:0.011256365105509758
The modified gen p mean: 0.4523261487483978, gen p mean: -0.7424355149269104, mean p set: 0.4528064429759979
The modified gen p mean: 0.44988885521888733, gen p mean: -0.7346909642219543, mean p set: 0.4503691494464874
loss_pred:0.02561170607805252, decouple_loss:0.011164937168359756
loss_pred:0.025405339896678925, decouple_loss:0.011211559176445007
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45319274067878723, gen p mean: -0.747097373008728, mean p set: 0.45367300510406494
loss_pred:0.027797881513834, decouple_loss:0.011521548964083195
The modified gen p mean: 0.45311492681503296, gen p mean: -0.7451298236846924, mean p set: 0.45359519124031067The modified gen p mean: 0.44988471269607544, gen p mean: -0.7441521286964417, mean p set: 0.45036500692367554
loss_pred:0.02593807876110077, decouple_loss:0.011147038079798222
loss_pred:0.024901924654841423, decouple_loss:0.011327042244374752
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524238407611847, gen p mean: -0.7462306618690491, mean p set: 0.4529041349887848
loss_pred:0.025464126840233803, decouple_loss:0.011010242626070976
The modified gen p mean: 0.4525472819805145, gen p mean: -0.7423424124717712, mean p set: 0.453027606010437
The modified gen p mean: 0.45240092277526855, gen p mean: -0.7450205683708191, mean p set: 0.4528812766075134
loss_pred:0.025273382663726807, decouple_loss:0.010711506940424442
loss_pred:0.02686098963022232, decouple_loss:0.01093093492090702
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519972503185272, gen p mean: -0.7568128705024719, mean p set: 0.45247751474380493
The modified gen p mean: 0.45027273893356323, gen p mean: -0.7420211434364319, mean p set: 0.45075303316116333
loss_pred:0.02684343233704567, decouple_loss:0.011190746910870075
loss_pred:0.02533666044473648, decouple_loss:0.010400455445051193
The modified gen p mean: 0.4515415132045746, gen p mean: -0.7406458258628845, mean p set: 0.4520217776298523
loss_pred:0.02629489079117775, decouple_loss:0.011112918145954609
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513266086578369, gen p mean: -0.7495328187942505, mean p set: 0.4518068730831146
The modified gen p mean: 0.45317938923835754, gen p mean: -0.7466071844100952, mean p set: 0.45365968346595764
loss_pred:0.026433564722537994, decouple_loss:0.010731811635196209
loss_pred:0.025964703410863876, decouple_loss:0.010282130911946297
The modified gen p mean: 0.4510509669780731, gen p mean: -0.748550295829773, mean p set: 0.45153123140335083
loss_pred:0.024850670248270035, decouple_loss:0.010049179196357727
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45245373249053955, gen p mean: -0.7448816895484924, mean p set: 0.45293402671813965
loss_pred:0.02757357619702816, decouple_loss:0.0113229276612401
The modified gen p mean: 0.4495593309402466, gen p mean: -0.7409339547157288, mean p set: 0.4500395953655243
The modified gen p mean: 0.45133569836616516, gen p mean: -0.7496893405914307, mean p set: 0.45181599259376526
loss_pred:0.024885065853595734, decouple_loss:0.010495140217244625
loss_pred:0.025649119168519974, decouple_loss:0.01079732645303011
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512156546115875, gen p mean: -0.736539363861084, mean p set: 0.4516959488391876
The modified gen p mean: 0.4509037733078003, gen p mean: -0.7370381951332092, mean p set: 0.451384037733078
loss_pred:0.025192031636834145, decouple_loss:0.010693347081542015
loss_pred:0.024717628955841064, decouple_loss:0.010586508549749851
The modified gen p mean: 0.4508942663669586, gen p mean: -0.732930600643158, mean p set: 0.45137453079223633
loss_pred:0.02686941623687744, decouple_loss:0.010889586992561817
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
NaN value num: 0
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473308324813843, gen p mean: -0.7398550510406494, mean p set: 0.447811096906662
The modified gen p mean: 0.4482898712158203, gen p mean: -0.7410245537757874, mean p set: 0.4487701654434204
loss_pred:0.027306681498885155, decouple_loss:0.01242393720895052
The modified gen p mean: 0.44666028022766113, gen p mean: -0.742870569229126, mean p set: 0.44714057445526123
loss_pred:0.0271216481924057, decouple_loss:0.012288538739085197
loss_pred:0.02761048823595047, decouple_loss:0.012319616042077541
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44561293721199036, gen p mean: -0.7377912998199463, mean p set: 0.44609320163726807
The modified gen p mean: 0.44679054617881775, gen p mean: -0.7436604499816895, mean p set: 0.44727084040641785
loss_pred:0.026064585894346237, decouple_loss:0.011605076491832733
loss_pred:0.027128078043460846, decouple_loss:0.011586370877921581
The modified gen p mean: 0.4482974410057068, gen p mean: -0.7358819246292114, mean p set: 0.4487777352333069
loss_pred:0.027904022485017776, decouple_loss:0.01132314931601286
2023-05-04 12:07:57 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7339249849319458, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7466278076171875, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.738768994808197, mean p set: 0.4500633478164673
loss_pred:0.026484742760658264, decouple_loss:0.011552123352885246
loss_pred:0.028054215013980865, decouple_loss:0.011840026825666428
loss_pred:0.026850448921322823, decouple_loss:0.011543814092874527
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02771206758916378, avg_mse: 0.03307073190808296
current test mse: 0.033071
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722530245780945, gen p mean: -0.7469040751457214, mean p set: 0.44770559668540955
The modified gen p mean: 0.44593241810798645, gen p mean: -0.7390343546867371, mean p set: 0.44641271233558655
loss_pred:0.026806462556123734, decouple_loss:0.0109569001942873
loss_pred:0.026911661028862, decouple_loss:0.011857773177325726
The modified gen p mean: 0.44632381200790405, gen p mean: -0.7362260818481445, mean p set: 0.44680410623550415
loss_pred:0.02658011205494404, decouple_loss:0.011339285410940647
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44649404287338257, gen p mean: -0.7465704679489136, mean p set: 0.4469743072986603
The modified gen p mean: 0.447072833776474, gen p mean: -0.7454727292060852, mean p set: 0.4475530982017517
loss_pred:0.027546871453523636, decouple_loss:0.011032787151634693
loss_pred:0.027977634221315384, decouple_loss:0.011391245760023594
The modified gen p mean: 0.4471910297870636, gen p mean: -0.7515506148338318, mean p set: 0.4476713538169861
loss_pred:0.02720746211707592, decouple_loss:0.011620325967669487
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758152961730957, gen p mean: -0.7511900663375854, mean p set: 0.4480617940425873
The modified gen p mean: 0.446638286113739, gen p mean: -0.7450129389762878, mean p set: 0.4471185803413391
loss_pred:0.027416236698627472, decouple_loss:0.010475157760083675
loss_pred:0.02678718976676464, decouple_loss:0.010485814884305
The modified gen p mean: 0.4459202289581299, gen p mean: -0.7387686967849731, mean p set: 0.44640052318573
loss_pred:0.02684140019118786, decouple_loss:0.010641842149198055
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475783109664917, gen p mean: -0.7365733981132507, mean p set: 0.4480586051940918
The modified gen p mean: 0.44680696725845337, gen p mean: -0.7367606163024902, mean p set: 0.44728726148605347
loss_pred:0.027464987710118294, decouple_loss:0.011462148278951645
loss_pred:0.02644306607544422, decouple_loss:0.010862433351576328
The modified gen p mean: 0.44823575019836426, gen p mean: -0.7340041399002075, mean p set: 0.44871607422828674
loss_pred:0.027440829202532768, decouple_loss:0.010727626271545887
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464988112449646, gen p mean: -0.723632276058197, mean p set: 0.4469790756702423
The modified gen p mean: 0.4456835389137268, gen p mean: -0.7218037843704224, mean p set: 0.4461638331413269
loss_pred:0.026648540049791336, decouple_loss:0.010539497248828411
loss_pred:0.026834111660718918, decouple_loss:0.010863922536373138
The modified gen p mean: 0.44636714458465576, gen p mean: -0.7300752997398376, mean p set: 0.44684743881225586
loss_pred:0.02737000212073326, decouple_loss:0.0102210259065032
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471195936203003, gen p mean: -0.7240521907806396, mean p set: 0.4475998878479004
The modified gen p mean: 0.44707542657852173, gen p mean: -0.7263472080230713, mean p set: 0.4475557208061218
loss_pred:0.027922771871089935, decouple_loss:0.010551166720688343
loss_pred:0.027704160660505295, decouple_loss:0.01030617207288742
The modified gen p mean: 0.4483083188533783, gen p mean: -0.7184162139892578, mean p set: 0.4487886130809784
loss_pred:0.027236642315983772, decouple_loss:0.010444405488669872
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807305932044983, gen p mean: -0.7362166047096252, mean p set: 0.4485533535480499
loss_pred:0.02748454548418522, decouple_loss:0.010476335883140564
The modified gen p mean: 0.44904494285583496, gen p mean: -0.7261776924133301, mean p set: 0.44952526688575745The modified gen p mean: 0.4453831911087036, gen p mean: -0.7239325046539307, mean p set: 0.4458634853363037
loss_pred:0.02616812288761139, decouple_loss:0.010402193292975426
loss_pred:0.026476308703422546, decouple_loss:0.010346382856369019
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462381899356842, gen p mean: -0.7289997339248657, mean p set: 0.4467185139656067
loss_pred:0.02734486199915409, decouple_loss:0.01017950102686882
The modified gen p mean: 0.4465714693069458, gen p mean: -0.7285831570625305, mean p set: 0.4470517337322235
The modified gen p mean: 0.4488806128501892, gen p mean: -0.7307909727096558, mean p set: 0.4493609070777893
loss_pred:0.027048079296946526, decouple_loss:0.01003345474600792
loss_pred:0.027471743524074554, decouple_loss:0.010272441431879997
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464878439903259, gen p mean: -0.7386683225631714, mean p set: 0.446968138217926
loss_pred:0.027336090803146362, decouple_loss:0.009645343758165836
The modified gen p mean: 0.446050226688385, gen p mean: -0.7340431809425354, mean p set: 0.4465305209159851
The modified gen p mean: 0.44810542464256287, gen p mean: -0.7454242706298828, mean p set: 0.44858571887016296
loss_pred:0.027053697034716606, decouple_loss:0.009600548073649406
loss_pred:0.02732599899172783, decouple_loss:0.010208066552877426
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939735531806946, gen p mean: -0.7348833084106445, mean p set: 0.44987761974334717
loss_pred:0.026026343926787376, decouple_loss:0.010136703960597515
The modified gen p mean: 0.44712579250335693, gen p mean: -0.742797315120697, mean p set: 0.44760608673095703
The modified gen p mean: 0.4463096857070923, gen p mean: -0.7344136238098145, mean p set: 0.44678995013237
loss_pred:0.027121715247631073, decouple_loss:0.010478905402123928
loss_pred:0.026969583705067635, decouple_loss:0.009908881969749928
2023-05-04 12:11:32 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7225250601768494, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7341617345809937, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.726922333240509, mean p set: 0.4500633478164673
loss_pred:0.02632690593600273, decouple_loss:0.010771303437650204
loss_pred:0.02776286192238331, decouple_loss:0.010807736776769161
loss_pred:0.026644006371498108, decouple_loss:0.010608524084091187
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027447715401649475, avg_mse: 0.03277081996202469
current test mse: 0.032771
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477458596229553, gen p mean: -0.7407287955284119, mean p set: 0.4482261538505554
The modified gen p mean: 0.4460093677043915, gen p mean: -0.7279993891716003, mean p set: 0.4464896619319916
loss_pred:0.02598443254828453, decouple_loss:0.01025257259607315
loss_pred:0.026479573920369148, decouple_loss:0.010196364484727383
The modified gen p mean: 0.44568878412246704, gen p mean: -0.7270517349243164, mean p set: 0.4461691081523895
loss_pred:0.026344168931245804, decouple_loss:0.010395550169050694
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456712305545807, gen p mean: -0.7238296866416931, mean p set: 0.4461515247821808
The modified gen p mean: 0.44878455996513367, gen p mean: -0.7303725481033325, mean p set: 0.44926485419273376
loss_pred:0.025956038385629654, decouple_loss:0.01008806936442852
loss_pred:0.02706725150346756, decouple_loss:0.010257016867399216
The modified gen p mean: 0.44680356979370117, gen p mean: -0.7337049841880798, mean p set: 0.44728389382362366
loss_pred:0.02697967179119587, decouple_loss:0.010228664614260197
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793540239334106, gen p mean: -0.7325881719589233, mean p set: 0.4484156668186188
loss_pred:0.026186224073171616, decouple_loss:0.01036431547254324
The modified gen p mean: 0.4475260078907013, gen p mean: -0.7380377650260925, mean p set: 0.4480063021183014
The modified gen p mean: 0.44733691215515137, gen p mean: -0.7358638644218445, mean p set: 0.44781720638275146
loss_pred:0.025860652327537537, decouple_loss:0.010243081487715244
loss_pred:0.026511963456869125, decouple_loss:0.009826676920056343
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44538143277168274, gen p mean: -0.7232766151428223, mean p set: 0.44586169719696045
The modified gen p mean: 0.44609618186950684, gen p mean: -0.7259750366210938, mean p set: 0.44657647609710693
loss_pred:0.026233050972223282, decouple_loss:0.00995312724262476
loss_pred:0.025702089071273804, decouple_loss:0.009698828682303429
The modified gen p mean: 0.4458862841129303, gen p mean: -0.7249427437782288, mean p set: 0.446366548538208
loss_pred:0.026001455262303352, decouple_loss:0.009660602547228336
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44633179903030396, gen p mean: -0.7218677401542664, mean p set: 0.44681212306022644
loss_pred:0.027064776048064232, decouple_loss:0.009651001542806625
The modified gen p mean: 0.44915899634361267, gen p mean: -0.7306450009346008, mean p set: 0.44963929057121277
The modified gen p mean: 0.4459381699562073, gen p mean: -0.7193951606750488, mean p set: 0.446418434381485
loss_pred:0.02678302302956581, decouple_loss:0.00965653732419014
loss_pred:0.02724222093820572, decouple_loss:0.009289326146245003
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44870543479919434, gen p mean: -0.7239773869514465, mean p set: 0.44918572902679443
The modified gen p mean: 0.44540107250213623, gen p mean: -0.7260210514068604, mean p set: 0.44588136672973633
loss_pred:0.02678116224706173, decouple_loss:0.010294590145349503
loss_pred:0.02732730470597744, decouple_loss:0.008961312472820282
The modified gen p mean: 0.4472513794898987, gen p mean: -0.728778064250946, mean p set: 0.4477316439151764
loss_pred:0.026743007823824883, decouple_loss:0.009245199151337147
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714638590812683, gen p mean: -0.7321016788482666, mean p set: 0.4476267099380493
loss_pred:0.027347641065716743, decouple_loss:0.009923827834427357
The modified gen p mean: 0.44616612792015076, gen p mean: -0.7235513925552368, mean p set: 0.44664642214775085
The modified gen p mean: 0.44588375091552734, gen p mean: -0.7286160588264465, mean p set: 0.44636404514312744
loss_pred:0.02669154852628708, decouple_loss:0.009451430290937424
loss_pred:0.026346763595938683, decouple_loss:0.009610278531908989
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473434090614319, gen p mean: -0.734161913394928, mean p set: 0.4478236734867096
The modified gen p mean: 0.44729194045066833, gen p mean: -0.7373444437980652, mean p set: 0.44777223467826843
loss_pred:0.02679823338985443, decouple_loss:0.009463990107178688
loss_pred:0.02716754376888275, decouple_loss:0.010065849870443344
The modified gen p mean: 0.44641467928886414, gen p mean: -0.7289808988571167, mean p set: 0.4468950033187866
loss_pred:0.025907767936587334, decouple_loss:0.009300400502979755
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
NaN value num: 0
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214930176734924, gen p mean: -0.7277946472167969, mean p set: 0.45262959599494934
The modified gen p mean: 0.4512357711791992, gen p mean: -0.728630542755127, mean p set: 0.4517160654067993
loss_pred:0.025909824296832085, decouple_loss:0.010536618530750275
The modified gen p mean: 0.45149609446525574, gen p mean: -0.7303611040115356, mean p set: 0.45197638869285583
loss_pred:0.025255870074033737, decouple_loss:0.010929602198302746
loss_pred:0.024865861982107162, decouple_loss:0.010396135970950127
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504871964454651, gen p mean: -0.7313585877418518, mean p set: 0.4509674608707428
loss_pred:0.025665225461125374, decouple_loss:0.010017944499850273
The modified gen p mean: 0.44991931319236755, gen p mean: -0.7361071109771729, mean p set: 0.45039960741996765
The modified gen p mean: 0.4498118460178375, gen p mean: -0.7253555059432983, mean p set: 0.45029211044311523
loss_pred:0.026181120425462723, decouple_loss:0.009861568920314312
loss_pred:0.02593185380101204, decouple_loss:0.010005919262766838
2023-05-04 12:15:44 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7151415944099426, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7262239456176758, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7197430729866028, mean p set: 0.4500633478164673
loss_pred:0.026292074471712112, decouple_loss:0.010394281707704067
loss_pred:0.027741510421037674, decouple_loss:0.010707812383770943
loss_pred:0.02660917490720749, decouple_loss:0.010272974148392677
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02740383893251419, avg_mse: 0.03281797468662262
current test mse: 0.032818
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082300901412964, gen p mean: -0.7245887517929077, mean p set: 0.45130327343940735
The modified gen p mean: 0.45118170976638794, gen p mean: -0.7169846892356873, mean p set: 0.4516620337963104
loss_pred:0.02527739480137825, decouple_loss:0.010293962433934212
loss_pred:0.024784443899989128, decouple_loss:0.01046435534954071
The modified gen p mean: 0.4515511989593506, gen p mean: -0.726039707660675, mean p set: 0.4520314931869507
loss_pred:0.025239303708076477, decouple_loss:0.010249823331832886
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490899443626404, gen p mean: -0.7209416627883911, mean p set: 0.4495701789855957
The modified gen p mean: 0.4516649544239044, gen p mean: -0.7168509364128113, mean p set: 0.4521452486515045loss_pred:0.026306722313165665, decouple_loss:0.009733553975820541
The modified gen p mean: 0.44903847575187683, gen p mean: -0.712394118309021, mean p set: 0.44951876997947693
loss_pred:0.025406014174222946, decouple_loss:0.009657137095928192
loss_pred:0.024769525974988937, decouple_loss:0.010380127467215061
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493885636329651, gen p mean: -0.7282953858375549, mean p set: 0.4498688280582428
loss_pred:0.02571321837604046, decouple_loss:0.009658865630626678
The modified gen p mean: 0.44969499111175537, gen p mean: -0.7159515023231506, mean p set: 0.4501752555370331
The modified gen p mean: 0.4511565864086151, gen p mean: -0.7295989990234375, mean p set: 0.4516368806362152
loss_pred:0.025786682963371277, decouple_loss:0.010027939453721046
loss_pred:0.02669156715273857, decouple_loss:0.010198560543358326
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513486921787262, gen p mean: -0.7340765595436096, mean p set: 0.4518289566040039
The modified gen p mean: 0.44974252581596375, gen p mean: -0.7434057593345642, mean p set: 0.45022279024124146
loss_pred:0.024214578792452812, decouple_loss:0.009602830745279789
loss_pred:0.02565534971654415, decouple_loss:0.009190029464662075
The modified gen p mean: 0.45150044560432434, gen p mean: -0.7330684661865234, mean p set: 0.45198073983192444
loss_pred:0.025678765028715134, decouple_loss:0.010310879908502102
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45145177841186523, gen p mean: -0.7378308773040771, mean p set: 0.4519321024417877
The modified gen p mean: 0.44978779554367065, gen p mean: -0.7460577487945557, mean p set: 0.45026808977127075
loss_pred:0.025394463911652565, decouple_loss:0.009867959655821323
loss_pred:0.026078594848513603, decouple_loss:0.009991602972149849
The modified gen p mean: 0.4514136016368866, gen p mean: -0.7337083220481873, mean p set: 0.4518939256668091
loss_pred:0.025472180917859077, decouple_loss:0.010055766440927982
Iteration: 306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512248933315277, gen p mean: -0.7304874658584595, mean p set: 0.4517051577568054
loss_pred:0.024696072563529015, decouple_loss:0.010034183971583843
The modified gen p mean: 0.45058420300483704, gen p mean: -0.7399588823318481, mean p set: 0.4510645270347595
The modified gen p mean: 0.4492553770542145, gen p mean: -0.7233943939208984, mean p set: 0.4497356712818146
loss_pred:0.02560647763311863, decouple_loss:0.009565414860844612
loss_pred:0.024778231978416443, decouple_loss:0.009745098650455475
Iteration: 307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496873617172241, gen p mean: -0.7458660006523132, mean p set: 0.4501676559448242
The modified gen p mean: 0.4498673677444458, gen p mean: -0.7288267612457275, mean p set: 0.4503476321697235
loss_pred:0.025869745761156082, decouple_loss:0.010017071850597858
loss_pred:0.02459929697215557, decouple_loss:0.009461287409067154
The modified gen p mean: 0.4528367817401886, gen p mean: -0.7364948987960815, mean p set: 0.4533170461654663
loss_pred:0.024633973836898804, decouple_loss:0.00986016821116209
Iteration: 308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813987612724304, gen p mean: -0.7408841252326965, mean p set: 0.44862014055252075
The modified gen p mean: 0.4493529200553894, gen p mean: -0.7265313863754272, mean p set: 0.4498332440853119
loss_pred:0.025575747713446617, decouple_loss:0.009892290458083153
loss_pred:0.02536575123667717, decouple_loss:0.009353937581181526
The modified gen p mean: 0.45039644837379456, gen p mean: -0.7440606355667114, mean p set: 0.45087674260139465
loss_pred:0.026580609381198883, decouple_loss:0.009745268151164055
Iteration: 309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45285388827323914, gen p mean: -0.7424466609954834, mean p set: 0.45333418250083923
The modified gen p mean: 0.4511222839355469, gen p mean: -0.7530953884124756, mean p set: 0.4516025483608246
loss_pred:0.02467968501150608, decouple_loss:0.009874305687844753
loss_pred:0.0261259563267231, decouple_loss:0.009692911989986897
The modified gen p mean: 0.4493926763534546, gen p mean: -0.7385233640670776, mean p set: 0.4498729407787323
loss_pred:0.026140645146369934, decouple_loss:0.009501133114099503
Iteration: 310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450160413980484, gen p mean: -0.7364867925643921, mean p set: 0.4506407380104065
loss_pred:0.024893982335925102, decouple_loss:0.010131608694791794
The modified gen p mean: 0.4476621448993683, gen p mean: -0.7462389469146729, mean p set: 0.448142409324646
The modified gen p mean: 0.45027345418930054, gen p mean: -0.7508537173271179, mean p set: 0.45075374841690063
loss_pred:0.02569577656686306, decouple_loss:0.009788934141397476
loss_pred:0.026216333732008934, decouple_loss:0.009620703756809235
2023-05-04 12:19:16 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.737430214881897, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7423020005226135, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7495465278625488, mean p set: 0.4502691626548767
loss_pred:0.02631022408604622, decouple_loss:0.010746886022388935
loss_pred:0.026662716642022133, decouple_loss:0.01068023033440113
loss_pred:0.027801061049103737, decouple_loss:0.011127748526632786
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02746724896132946, avg_mse: 0.03292010352015495
current test mse: 0.03292
Iteration: 311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509528577327728, gen p mean: -0.7444138526916504, mean p set: 0.4514331519603729
The modified gen p mean: 0.44950807094573975, gen p mean: -0.7437509894371033, mean p set: 0.44998836517333984
loss_pred:0.024735644459724426, decouple_loss:0.010013358667492867
loss_pred:0.025278830900788307, decouple_loss:0.009312198497354984
The modified gen p mean: 0.45147398114204407, gen p mean: -0.7467681169509888, mean p set: 0.45195427536964417
loss_pred:0.02430299110710621, decouple_loss:0.009732553735375404
Iteration: 312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996708631515503, gen p mean: -0.7547169923782349, mean p set: 0.4504474103450775
The modified gen p mean: 0.448747456073761, gen p mean: -0.7512650489807129, mean p set: 0.44922778010368347
loss_pred:0.025247132405638695, decouple_loss:0.009538534097373486
loss_pred:0.02538723684847355, decouple_loss:0.009546585381031036
The modified gen p mean: 0.4499928653240204, gen p mean: -0.7585902810096741, mean p set: 0.4504731595516205
loss_pred:0.02581838145852089, decouple_loss:0.009159663692116737
Iteration: 313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448850154876709, gen p mean: -0.7578660249710083, mean p set: 0.4493304491043091
The modified gen p mean: 0.4511454105377197, gen p mean: -0.7623006701469421, mean p set: 0.45162567496299744loss_pred:0.025308242067694664, decouple_loss:0.009219597093760967
The modified gen p mean: 0.44892239570617676, gen p mean: -0.756253182888031, mean p set: 0.44940266013145447
loss_pred:0.02637479081749916, decouple_loss:0.009449795819818974
loss_pred:0.024905439466238022, decouple_loss:0.009381868876516819
Iteration: 314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494360387325287, gen p mean: -0.76023268699646, mean p set: 0.4499163329601288The modified gen p mean: 0.44974350929260254, gen p mean: -0.771679699420929, mean p set: 0.45022377371788025
loss_pred:0.025208549574017525, decouple_loss:0.009189687669277191
loss_pred:0.026711178943514824, decouple_loss:0.009110051207244396
The modified gen p mean: 0.4507521092891693, gen p mean: -0.7578845620155334, mean p set: 0.4512324035167694
loss_pred:0.024826055392622948, decouple_loss:0.009347030892968178
Iteration: 315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512796401977539, gen p mean: -0.7502542734146118, mean p set: 0.4517599642276764
loss_pred:0.02439899370074272, decouple_loss:0.009738154709339142
The modified gen p mean: 0.451978862285614, gen p mean: -0.7585752010345459, mean p set: 0.4524591267108917
The modified gen p mean: 0.4518389105796814, gen p mean: -0.7550362944602966, mean p set: 0.4523191750049591
loss_pred:0.025037402287125587, decouple_loss:0.009547101333737373
loss_pred:0.026135915890336037, decouple_loss:0.00988747552037239
Iteration: 316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44980132579803467, gen p mean: -0.7537465691566467, mean p set: 0.45028162002563477
The modified gen p mean: 0.4512780010700226, gen p mean: -0.7500237822532654, mean p set: 0.45175832509994507
loss_pred:0.026046007871627808, decouple_loss:0.009208998642861843
loss_pred:0.02553946152329445, decouple_loss:0.009247124195098877
The modified gen p mean: 0.44905152916908264, gen p mean: -0.7470548748970032, mean p set: 0.44953182339668274
loss_pred:0.024948440492153168, decouple_loss:0.009434884414076805
Iteration: 317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528837502002716, gen p mean: -0.7412280440330505, mean p set: 0.4533640444278717
The modified gen p mean: 0.45160701870918274, gen p mean: -0.7402523756027222, mean p set: 0.45208731293678284
loss_pred:0.024908918887376785, decouple_loss:0.009302785620093346
loss_pred:0.025474393740296364, decouple_loss:0.009644730016589165
The modified gen p mean: 0.4513408839702606, gen p mean: -0.7330630421638489, mean p set: 0.4518211781978607
loss_pred:0.02580997347831726, decouple_loss:0.00965712871402502
Iteration: 318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45277971029281616, gen p mean: -0.7275826334953308, mean p set: 0.45326003432273865
loss_pred:0.025098539888858795, decouple_loss:0.009618313983082771
The modified gen p mean: 0.4494718015193939, gen p mean: -0.7254776358604431, mean p set: 0.449952095746994
The modified gen p mean: 0.451507031917572, gen p mean: -0.731410801410675, mean p set: 0.4519873261451721
loss_pred:0.02464803121984005, decouple_loss:0.009505894035100937
loss_pred:0.02635994926095009, decouple_loss:0.009326505474746227
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
NaN value num: 0
Iteration: 319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514182507991791, gen p mean: -0.7367599606513977, mean p set: 0.4518985152244568
The modified gen p mean: 0.4503520727157593, gen p mean: -0.722591757774353, mean p set: 0.45083242654800415
The modified gen p mean: 0.45277729630470276, gen p mean: -0.7425787448883057, mean p set: 0.45325756072998047
loss_pred:0.02616320736706257, decouple_loss:0.009424027055501938
loss_pred:0.026013270020484924, decouple_loss:0.010107501409947872
loss_pred:0.025895357131958008, decouple_loss:0.009980781935155392
Iteration: 320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501558840274811, gen p mean: -0.7294530272483826, mean p set: 0.4506361782550812
loss_pred:0.026850393041968346, decouple_loss:0.009963428601622581
The modified gen p mean: 0.4492751657962799, gen p mean: -0.7341210842132568, mean p set: 0.4497554302215576
The modified gen p mean: 0.4494902193546295, gen p mean: -0.731599748134613, mean p set: 0.4499705135822296
loss_pred:0.026652462780475616, decouple_loss:0.009809599258005619
loss_pred:0.02636590227484703, decouple_loss:0.009889330714941025
2023-05-04 12:23:33 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7387523055076599, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.743736982345581, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7504081726074219, mean p set: 0.4502691626548767
loss_pred:0.02645917795598507, decouple_loss:0.010441148653626442
loss_pred:0.026774512603878975, decouple_loss:0.010415873490273952
loss_pred:0.027959762141108513, decouple_loss:0.01058201864361763
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02758846804499626, avg_mse: 0.03311949223279953
current test mse: 0.033119
Iteration: 321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483364522457123, gen p mean: -0.7364152073860168, mean p set: 0.44881677627563477
The modified gen p mean: 0.4499867856502533, gen p mean: -0.7416890263557434, mean p set: 0.4504671096801758
loss_pred:0.02698458358645439, decouple_loss:0.009744299575686455
loss_pred:0.026701975613832474, decouple_loss:0.009556596167385578
The modified gen p mean: 0.45244041085243225, gen p mean: -0.749273419380188, mean p set: 0.45292070508003235
loss_pred:0.02783162146806717, decouple_loss:0.009762950241565704
Iteration: 322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495660960674286, gen p mean: -0.7478167414665222, mean p set: 0.4500464200973511
The modified gen p mean: 0.4507392644882202, gen p mean: -0.7519556283950806, mean p set: 0.4512195587158203
loss_pred:0.02614852599799633, decouple_loss:0.010057508014142513
loss_pred:0.027213355526328087, decouple_loss:0.009291546419262886
The modified gen p mean: 0.4496941566467285, gen p mean: -0.7459373474121094, mean p set: 0.4501744508743286
loss_pred:0.026375798508524895, decouple_loss:0.010210114531219006
Iteration: 323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487243890762329, gen p mean: -0.7380653023719788, mean p set: 0.4492046535015106
The modified gen p mean: 0.4502318203449249, gen p mean: -0.7425458431243896, mean p set: 0.4507121443748474
loss_pred:0.027876975014805794, decouple_loss:0.009847602806985378
loss_pred:0.02623075805604458, decouple_loss:0.009584972634911537
The modified gen p mean: 0.45195165276527405, gen p mean: -0.7565180063247681, mean p set: 0.45243194699287415
loss_pred:0.028006192296743393, decouple_loss:0.010474057868123055
Iteration: 324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45249879360198975, gen p mean: -0.7479310035705566, mean p set: 0.45297905802726746The modified gen p mean: 0.4498998820781708, gen p mean: -0.7365930080413818, mean p set: 0.4503801465034485
loss_pred:0.027644839137792587, decouple_loss:0.010004078038036823
loss_pred:0.026010064408183098, decouple_loss:0.009865719825029373
The modified gen p mean: 0.450303316116333, gen p mean: -0.7308589816093445, mean p set: 0.4507836401462555
loss_pred:0.02726706489920616, decouple_loss:0.009509669616818428
Iteration: 325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497639238834381, gen p mean: -0.7352134585380554, mean p set: 0.4502442479133606
The modified gen p mean: 0.44804272055625916, gen p mean: -0.7197917103767395, mean p set: 0.44852298498153687
loss_pred:0.026653682813048363, decouple_loss:0.00984314177185297
loss_pred:0.027282128110527992, decouple_loss:0.009406511671841145
The modified gen p mean: 0.44935181736946106, gen p mean: -0.7269346714019775, mean p set: 0.44983211159706116
loss_pred:0.026135295629501343, decouple_loss:0.009092232212424278
Iteration: 326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512171745300293, gen p mean: -0.735040009021759, mean p set: 0.451697438955307
loss_pred:0.02757428213953972, decouple_loss:0.009689337573945522
The modified gen p mean: 0.4524685740470886, gen p mean: -0.7492206692695618, mean p set: 0.4529488980770111
The modified gen p mean: 0.4515188932418823, gen p mean: -0.7443897128105164, mean p set: 0.4519991874694824
loss_pred:0.026554957032203674, decouple_loss:0.010283170267939568
loss_pred:0.027499070391058922, decouple_loss:0.009853205643594265
Iteration: 327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507633149623871, gen p mean: -0.7339350581169128, mean p set: 0.4512436091899872
The modified gen p mean: 0.4513773024082184, gen p mean: -0.7434768676757812, mean p set: 0.4518575668334961
loss_pred:0.026731988415122032, decouple_loss:0.009935947135090828
loss_pred:0.02739802934229374, decouple_loss:0.00993582047522068
The modified gen p mean: 0.45077523589134216, gen p mean: -0.741361141204834, mean p set: 0.4512555003166199
loss_pred:0.027773644775152206, decouple_loss:0.010077465325593948
Iteration: 328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45285531878471375, gen p mean: -0.7525289058685303, mean p set: 0.45333564281463623
loss_pred:0.024919871240854263, decouple_loss:0.009729699231684208
The modified gen p mean: 0.4501718282699585, gen p mean: -0.7349172234535217, mean p set: 0.4506521224975586
The modified gen p mean: 0.4486974775791168, gen p mean: -0.7386730909347534, mean p set: 0.4491777718067169
loss_pred:0.026047946885228157, decouple_loss:0.009557546116411686
loss_pred:0.026264823973178864, decouple_loss:0.009730925783514977
Iteration: 329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518306851387024, gen p mean: -0.7537184357643127, mean p set: 0.4523109793663025
loss_pred:0.02730109728872776, decouple_loss:0.010311711579561234
The modified gen p mean: 0.4513542950153351, gen p mean: -0.7475671768188477, mean p set: 0.4518345892429352
The modified gen p mean: 0.4511845111846924, gen p mean: -0.7473794221878052, mean p set: 0.4516648054122925
loss_pred:0.026535075157880783, decouple_loss:0.009520751424133778
loss_pred:0.025007309392094612, decouple_loss:0.009689414873719215
Iteration: 330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45143282413482666, gen p mean: -0.7448185086250305, mean p set: 0.45191308856010437
The modified gen p mean: 0.45070233941078186, gen p mean: -0.7456701993942261, mean p set: 0.45118266344070435
loss_pred:0.025624625384807587, decouple_loss:0.009435237385332584
loss_pred:0.026995275169610977, decouple_loss:0.009090851992368698
The modified gen p mean: 0.44866201281547546, gen p mean: -0.7339504957199097, mean p set: 0.44914230704307556
loss_pred:0.02622240222990513, decouple_loss:0.009320296347141266
2023-05-04 12:27:08 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7313638925552368, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7422982454299927, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7357245087623596, mean p set: 0.4500633478164673
loss_pred:0.02650582604110241, decouple_loss:0.010530857369303703
loss_pred:0.02783975750207901, decouple_loss:0.010527093894779682
loss_pred:0.02673514559864998, decouple_loss:0.010315602645277977
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027549803256988525, avg_mse: 0.03305327519774437
current test mse: 0.033053
Iteration: 331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45017117261886597, gen p mean: -0.7375668287277222, mean p set: 0.4506514370441437The modified gen p mean: 0.44840550422668457, gen p mean: -0.7285129427909851, mean p set: 0.4488857686519623
loss_pred:0.02600918523967266, decouple_loss:0.009355946443974972
loss_pred:0.02739855647087097, decouple_loss:0.009243156760931015
The modified gen p mean: 0.45324620604515076, gen p mean: -0.7472299933433533, mean p set: 0.45372650027275085
loss_pred:0.024875672534108162, decouple_loss:0.00966727826744318
Iteration: 332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45008793473243713, gen p mean: -0.7294996976852417, mean p set: 0.45056816935539246
loss_pred:0.026655785739421844, decouple_loss:0.009085644036531448
The modified gen p mean: 0.45090606808662415, gen p mean: -0.7375381588935852, mean p set: 0.45138633251190186
The modified gen p mean: 0.45093390345573425, gen p mean: -0.73196941614151, mean p set: 0.45141419768333435
loss_pred:0.025640107691287994, decouple_loss:0.009052431210875511
loss_pred:0.02710016258060932, decouple_loss:0.009600082412362099
Iteration: 333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512278437614441, gen p mean: -0.7464215755462646, mean p set: 0.4517081081867218
The modified gen p mean: 0.4506523013114929, gen p mean: -0.7391485571861267, mean p set: 0.4511326253414154
loss_pred:0.027343586087226868, decouple_loss:0.009866475127637386
loss_pred:0.027297360822558403, decouple_loss:0.009156862273812294The modified gen p mean: 0.4496780037879944, gen p mean: -0.7324014902114868, mean p set: 0.4501582682132721
loss_pred:0.026068158447742462, decouple_loss:0.00910934992134571
Iteration: 334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45149004459381104, gen p mean: -0.7384957671165466, mean p set: 0.45197030901908875
The modified gen p mean: 0.4490574300289154, gen p mean: -0.7358745336532593, mean p set: 0.4495377540588379
loss_pred:0.026645680889487267, decouple_loss:0.00938562210649252
loss_pred:0.02588496170938015, decouple_loss:0.009278986603021622
The modified gen p mean: 0.4508698880672455, gen p mean: -0.7492777109146118, mean p set: 0.4513501822948456
loss_pred:0.0270142313092947, decouple_loss:0.009428643621504307
Iteration: 335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503582715988159, gen p mean: -0.7240287661552429, mean p set: 0.450838565826416
The modified gen p mean: 0.4507479667663574, gen p mean: -0.7273239493370056, mean p set: 0.45122823119163513
loss_pred:0.027669034898281097, decouple_loss:0.009350130334496498
loss_pred:0.027894427999854088, decouple_loss:0.009286957792937756
The modified gen p mean: 0.4509352445602417, gen p mean: -0.7246782779693604, mean p set: 0.4514155387878418
loss_pred:0.02638232707977295, decouple_loss:0.009053348563611507
Iteration: 336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089441537857056, gen p mean: -0.7215654850006104, mean p set: 0.45137470960617065
The modified gen p mean: 0.4508529603481293, gen p mean: -0.7267082333564758, mean p set: 0.451333224773407
loss_pred:0.027672890573740005, decouple_loss:0.009350208565592766
loss_pred:0.025392595678567886, decouple_loss:0.008853004314005375
The modified gen p mean: 0.448230504989624, gen p mean: -0.7132694721221924, mean p set: 0.4487107992172241
loss_pred:0.02708236686885357, decouple_loss:0.009468781761825085
Iteration: 337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978851079940796, gen p mean: -0.7248818874359131, mean p set: 0.45026880502700806
loss_pred:0.026308495551347733, decouple_loss:0.008932558819651604
The modified gen p mean: 0.4517655074596405, gen p mean: -0.7298194169998169, mean p set: 0.4522458016872406The modified gen p mean: 0.4526841342449188, gen p mean: -0.7396276593208313, mean p set: 0.4531644284725189
loss_pred:0.024609670042991638, decouple_loss:0.00954066589474678
loss_pred:0.027621310204267502, decouple_loss:0.008984364569187164
Iteration: 338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45174968242645264, gen p mean: -0.7538381814956665, mean p set: 0.45222997665405273
loss_pred:0.026788366958498955, decouple_loss:0.009831544943153858
The modified gen p mean: 0.44968530535697937, gen p mean: -0.7372544407844543, mean p set: 0.45016559958457947
The modified gen p mean: 0.4500799775123596, gen p mean: -0.7341446280479431, mean p set: 0.45056024193763733
loss_pred:0.025415999814867973, decouple_loss:0.009063832461833954
loss_pred:0.026672568172216415, decouple_loss:0.009626302868127823
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
NaN value num: 0
Iteration: 339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661030173301697, gen p mean: -0.7370396852493286, mean p set: 0.4470905661582947
The modified gen p mean: 0.44692352414131165, gen p mean: -0.7410801649093628, mean p set: 0.44740378856658936
loss_pred:0.027933556586503983, decouple_loss:0.009747248142957687
The modified gen p mean: 0.4473632276058197, gen p mean: -0.7306795716285706, mean p set: 0.4478435218334198
loss_pred:0.028532039374113083, decouple_loss:0.009804613888263702
loss_pred:0.028278499841690063, decouple_loss:0.009791076183319092
Iteration: 340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494776725769043, gen p mean: -0.737507164478302, mean p set: 0.449957937002182
loss_pred:0.02689153328537941, decouple_loss:0.009692046791315079
The modified gen p mean: 0.44676363468170166, gen p mean: -0.7372457981109619, mean p set: 0.44724392890930176
The modified gen p mean: 0.44732263684272766, gen p mean: -0.7387202382087708, mean p set: 0.44780290126800537
loss_pred:0.028426840901374817, decouple_loss:0.00979282334446907
loss_pred:0.028361130505800247, decouple_loss:0.009418332017958164
2023-05-04 12:31:28 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7297495603561401, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7407600283622742, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7336843013763428, mean p set: 0.4500633478164673
loss_pred:0.02632083371281624, decouple_loss:0.009749461896717548
loss_pred:0.02777986228466034, decouple_loss:0.00998464785516262
loss_pred:0.026699356734752655, decouple_loss:0.009655071422457695
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02742317132651806, avg_mse: 0.03295827656984329
current test mse: 0.032958
Iteration: 341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827449321746826, gen p mean: -0.7375559210777283, mean p set: 0.44875475764274597
The modified gen p mean: 0.4485849440097809, gen p mean: -0.7518317699432373, mean p set: 0.449065238237381
loss_pred:0.027698026970028877, decouple_loss:0.009576238691806793
loss_pred:0.02802954986691475, decouple_loss:0.010284015908837318
The modified gen p mean: 0.44652819633483887, gen p mean: -0.7383798956871033, mean p set: 0.44700849056243896
loss_pred:0.028058940544724464, decouple_loss:0.009401846677064896
Iteration: 342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800692796707153, gen p mean: -0.7408254146575928, mean p set: 0.44848722219467163
The modified gen p mean: 0.4474189877510071, gen p mean: -0.7345688939094543, mean p set: 0.44789931178092957
loss_pred:0.026921238750219345, decouple_loss:0.009584791027009487
loss_pred:0.02716822363436222, decouple_loss:0.009603125974535942
The modified gen p mean: 0.4486321806907654, gen p mean: -0.7399800419807434, mean p set: 0.4491124749183655
loss_pred:0.027421653270721436, decouple_loss:0.009488286450505257
Iteration: 343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779494404792786, gen p mean: -0.7389060854911804, mean p set: 0.44827520847320557
The modified gen p mean: 0.4472668170928955, gen p mean: -0.7523719668388367, mean p set: 0.447747141122818
loss_pred:0.028310414403676987, decouple_loss:0.009633256122469902
loss_pred:0.027358129620552063, decouple_loss:0.01042940467596054
The modified gen p mean: 0.4471818208694458, gen p mean: -0.7413604855537415, mean p set: 0.4476620852947235
loss_pred:0.02803509682416916, decouple_loss:0.009447997435927391
Iteration: 344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469072222709656, gen p mean: -0.738171398639679, mean p set: 0.4473875164985657
The modified gen p mean: 0.4476235508918762, gen p mean: -0.7342448830604553, mean p set: 0.44810381531715393
loss_pred:0.028688795864582062, decouple_loss:0.009360432624816895
loss_pred:0.028280526399612427, decouple_loss:0.009144475683569908
The modified gen p mean: 0.4474196135997772, gen p mean: -0.73579341173172, mean p set: 0.4478999078273773
loss_pred:0.028368279337882996, decouple_loss:0.008936590515077114
Iteration: 345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472569227218628, gen p mean: -0.7443506717681885, mean p set: 0.4477372169494629
loss_pred:0.02783564291894436, decouple_loss:0.009416429325938225
The modified gen p mean: 0.45010483264923096, gen p mean: -0.7400258183479309, mean p set: 0.45058512687683105
The modified gen p mean: 0.44640520215034485, gen p mean: -0.7325224280357361, mean p set: 0.44688549637794495
loss_pred:0.02741401642560959, decouple_loss:0.009388529695570469
loss_pred:0.029463276267051697, decouple_loss:0.009691988117992878
Iteration: 346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656434655189514, gen p mean: -0.7421156167984009, mean p set: 0.44704464077949524
loss_pred:0.02697550319135189, decouple_loss:0.009503667242825031
The modified gen p mean: 0.4475669860839844, gen p mean: -0.7351461052894592, mean p set: 0.4480472505092621
The modified gen p mean: 0.44686856865882874, gen p mean: -0.7344489097595215, mean p set: 0.44734886288642883
loss_pred:0.0278070829808712, decouple_loss:0.009980323724448681
loss_pred:0.027857284992933273, decouple_loss:0.009773066267371178
Iteration: 347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476662278175354, gen p mean: -0.7380034923553467, mean p set: 0.4481465220451355
The modified gen p mean: 0.4457154870033264, gen p mean: -0.7443524599075317, mean p set: 0.4461957514286041
loss_pred:0.027110498398542404, decouple_loss:0.00942976213991642
loss_pred:0.027309047058224678, decouple_loss:0.009449816308915615
The modified gen p mean: 0.4470927119255066, gen p mean: -0.7376387119293213, mean p set: 0.4475730061531067
loss_pred:0.0273506511002779, decouple_loss:0.009508863091468811
Iteration: 348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488506615161896, gen p mean: -0.7612374424934387, mean p set: 0.4493309259414673
The modified gen p mean: 0.4465080201625824, gen p mean: -0.7507306933403015, mean p set: 0.4469883143901825
loss_pred:0.027287231758236885, decouple_loss:0.01055650133639574
loss_pred:0.027730688452720642, decouple_loss:0.009190043434500694
The modified gen p mean: 0.4477561116218567, gen p mean: -0.7613821625709534, mean p set: 0.4482364058494568
loss_pred:0.027206894010305405, decouple_loss:0.010219153948128223
Iteration: 349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796591997146606, gen p mean: -0.7457298040390015, mean p set: 0.44844627380371094
loss_pred:0.027646362781524658, decouple_loss:0.009406338445842266
The modified gen p mean: 0.44664105772972107, gen p mean: -0.7462819218635559, mean p set: 0.44712138175964355
The modified gen p mean: 0.44708481431007385, gen p mean: -0.7548631429672241, mean p set: 0.44756510853767395
loss_pred:0.028298262506723404, decouple_loss:0.009800128638744354
loss_pred:0.02680821716785431, decouple_loss:0.009158775210380554
Iteration: 350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471374452114105, gen p mean: -0.7414243221282959, mean p set: 0.4476177394390106
The modified gen p mean: 0.4480510652065277, gen p mean: -0.7495293617248535, mean p set: 0.4485313296318054
loss_pred:0.02740117721259594, decouple_loss:0.009304788894951344
loss_pred:0.02702052891254425, decouple_loss:0.00949531514197588The modified gen p mean: 0.44842782616615295, gen p mean: -0.744326114654541, mean p set: 0.44890812039375305
loss_pred:0.026564504951238632, decouple_loss:0.00984880793839693
2023-05-04 12:35:02 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7390629053115845, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7506660223007202, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7432684302330017, mean p set: 0.4500633478164673
loss_pred:0.02616168186068535, decouple_loss:0.00991613045334816
loss_pred:0.0276167169213295, decouple_loss:0.00982836913317442
loss_pred:0.026643788442015648, decouple_loss:0.009722063317894936
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02729850634932518, avg_mse: 0.03274306282401085
current test mse: 0.032743
Iteration: 351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44672462344169617, gen p mean: -0.7449886202812195, mean p set: 0.44720491766929626
The modified gen p mean: 0.44856974482536316, gen p mean: -0.7470383048057556, mean p set: 0.44905006885528564
loss_pred:0.02827852964401245, decouple_loss:0.008972658775746822
loss_pred:0.02716745063662529, decouple_loss:0.009040714241564274
The modified gen p mean: 0.44708743691444397, gen p mean: -0.7452836036682129, mean p set: 0.44756776094436646
loss_pred:0.027536073699593544, decouple_loss:0.009115669876337051
Iteration: 352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468706250190735, gen p mean: -0.7439437508583069, mean p set: 0.4473509192466736
loss_pred:0.02812100201845169, decouple_loss:0.008849652484059334
The modified gen p mean: 0.44688671827316284, gen p mean: -0.7453919649124146, mean p set: 0.44736701250076294
The modified gen p mean: 0.4475695490837097, gen p mean: -0.7409876585006714, mean p set: 0.4480498135089874
loss_pred:0.028117593377828598, decouple_loss:0.008907734416425228loss_pred:0.02777734212577343, decouple_loss:0.00886414386332035
Iteration: 353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462997615337372, gen p mean: -0.7492597103118896, mean p set: 0.4467800557613373
The modified gen p mean: 0.44786548614501953, gen p mean: -0.7509204745292664, mean p set: 0.44834578037261963
loss_pred:0.028102871030569077, decouple_loss:0.008995616808533669
loss_pred:0.027170807123184204, decouple_loss:0.009047147817909718
The modified gen p mean: 0.4491763710975647, gen p mean: -0.7524144649505615, mean p set: 0.4496566355228424
loss_pred:0.028102392330765724, decouple_loss:0.009030431509017944
Iteration: 354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460969567298889, gen p mean: -0.7387529611587524, mean p set: 0.446577250957489
loss_pred:0.027163302525877953, decouple_loss:0.009142621420323849
The modified gen p mean: 0.4474089741706848, gen p mean: -0.7377387285232544, mean p set: 0.4478892683982849
The modified gen p mean: 0.4475644528865814, gen p mean: -0.7393625974655151, mean p set: 0.4480447769165039
loss_pred:0.026917768642306328, decouple_loss:0.009514682926237583
loss_pred:0.026822222396731377, decouple_loss:0.008848495781421661
Iteration: 355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481431543827057, gen p mean: -0.743217945098877, mean p set: 0.4486234486103058
The modified gen p mean: 0.44769012928009033, gen p mean: -0.7392018437385559, mean p set: 0.44817039370536804
loss_pred:0.02739022672176361, decouple_loss:0.008705630898475647
loss_pred:0.026775570586323738, decouple_loss:0.008744541555643082
The modified gen p mean: 0.4492040276527405, gen p mean: -0.7409003973007202, mean p set: 0.4496842920780182
loss_pred:0.02666056901216507, decouple_loss:0.008804510347545147
Iteration: 356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482758045196533, gen p mean: -0.7394554018974304, mean p set: 0.44875606894493103
loss_pred:0.026784740388393402, decouple_loss:0.008888004347682
The modified gen p mean: 0.4470256268978119, gen p mean: -0.741887092590332, mean p set: 0.4475059509277344
The modified gen p mean: 0.4482972025871277, gen p mean: -0.7402951717376709, mean p set: 0.4487774670124054
loss_pred:0.0281133484095335, decouple_loss:0.008759056217968464
loss_pred:0.0265871100127697, decouple_loss:0.008954728953540325
Iteration: 357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484081268310547, gen p mean: -0.7592334151268005, mean p set: 0.4488883912563324
loss_pred:0.02769140712916851, decouple_loss:0.009765359573066235
The modified gen p mean: 0.4465142488479614, gen p mean: -0.7486737370491028, mean p set: 0.4469945430755615
The modified gen p mean: 0.44650036096572876, gen p mean: -0.7414077520370483, mean p set: 0.44698062539100647
loss_pred:0.02761119045317173, decouple_loss:0.009042361751198769
loss_pred:0.027942631393671036, decouple_loss:0.009055170230567455
Iteration: 358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448119193315506, gen p mean: -0.7633604407310486, mean p set: 0.4485994875431061
The modified gen p mean: 0.44678249955177307, gen p mean: -0.7487717866897583, mean p set: 0.44726279377937317
loss_pred:0.027356719598174095, decouple_loss:0.009833350777626038
loss_pred:0.028648626059293747, decouple_loss:0.008771776221692562
The modified gen p mean: 0.44580337405204773, gen p mean: -0.7545754313468933, mean p set: 0.44628363847732544
loss_pred:0.02735321782529354, decouple_loss:0.009054594673216343
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
NaN value num: 0
Iteration: 359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45216771960258484, gen p mean: -0.7511807680130005, mean p set: 0.4526480436325073
The modified gen p mean: 0.45251381397247314, gen p mean: -0.7553474307060242, mean p set: 0.45299410820007324
loss_pred:0.026853112503886223, decouple_loss:0.00954124890267849
The modified gen p mean: 0.4529753029346466, gen p mean: -0.7523598670959473, mean p set: 0.4534555673599243
loss_pred:0.026666052639484406, decouple_loss:0.009915091097354889
loss_pred:0.026735709980130196, decouple_loss:0.010107386857271194
Iteration: 360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45189446210861206, gen p mean: -0.7438822388648987, mean p set: 0.45237478613853455
loss_pred:0.027346452698111534, decouple_loss:0.01053073350340128
The modified gen p mean: 0.45238208770751953, gen p mean: -0.7482874989509583, mean p set: 0.452862411737442
The modified gen p mean: 0.45143890380859375, gen p mean: -0.7532551884651184, mean p set: 0.45191919803619385
loss_pred:0.026359066367149353, decouple_loss:0.010618004947900772
loss_pred:0.025590799748897552, decouple_loss:0.009867065586149693
2023-05-04 12:39:20 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7255521416664124, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7372620701789856, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7300496101379395, mean p set: 0.4500633478164673
loss_pred:0.02645653672516346, decouple_loss:0.010278036817908287
loss_pred:0.027732545509934425, decouple_loss:0.010336187668144703
loss_pred:0.02683553658425808, decouple_loss:0.009920930489897728
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027517125010490417, avg_mse: 0.033034779131412506
current test mse: 0.033035
Iteration: 361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45210132002830505, gen p mean: -0.7319499850273132, mean p set: 0.45258164405822754
The modified gen p mean: 0.4504108130931854, gen p mean: -0.7221935987472534, mean p set: 0.45089107751846313
loss_pred:0.026996007189154625, decouple_loss:0.010035634972155094
loss_pred:0.026595577597618103, decouple_loss:0.010125230066478252
The modified gen p mean: 0.4526253044605255, gen p mean: -0.7259259223937988, mean p set: 0.4531055986881256
loss_pred:0.027084309607744217, decouple_loss:0.00970294140279293
Iteration: 362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513090252876282, gen p mean: -0.7304562330245972, mean p set: 0.4517892897129059
loss_pred:0.02611612156033516, decouple_loss:0.009848547168076038
The modified gen p mean: 0.450235515832901, gen p mean: -0.7333325743675232, mean p set: 0.4507158100605011
The modified gen p mean: 0.4513874650001526, gen p mean: -0.7375978231430054, mean p set: 0.4518677592277527
loss_pred:0.02546354942023754, decouple_loss:0.010000940412282944
loss_pred:0.02643692120909691, decouple_loss:0.009294377639889717
Iteration: 363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45364052057266235, gen p mean: -0.7254102826118469, mean p set: 0.45412078499794006
loss_pred:0.026363292708992958, decouple_loss:0.010098548606038094
The modified gen p mean: 0.45094770193099976, gen p mean: -0.7390850186347961, mean p set: 0.45142796635627747
The modified gen p mean: 0.4525220990180969, gen p mean: -0.7371823787689209, mean p set: 0.45300236344337463
loss_pred:0.02557314932346344, decouple_loss:0.009778235107660294
loss_pred:0.026019388809800148, decouple_loss:0.010156778618693352
Iteration: 364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45076048374176025, gen p mean: -0.74027419090271, mean p set: 0.45124077796936035
The modified gen p mean: 0.45076799392700195, gen p mean: -0.7422300577163696, mean p set: 0.45124828815460205
loss_pred:0.025239290669560432, decouple_loss:0.00947954785078764
loss_pred:0.026729080826044083, decouple_loss:0.009886790998280048
The modified gen p mean: 0.4520992636680603, gen p mean: -0.742636501789093, mean p set: 0.4525795578956604
loss_pred:0.027085397392511368, decouple_loss:0.009793412871658802
Iteration: 365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510819911956787, gen p mean: -0.7253682613372803, mean p set: 0.4515622556209564
The modified gen p mean: 0.451018363237381, gen p mean: -0.728943407535553, mean p set: 0.4514986276626587
loss_pred:0.02639489248394966, decouple_loss:0.009587014093995094
loss_pred:0.026302551850676537, decouple_loss:0.009830109775066376
The modified gen p mean: 0.45124709606170654, gen p mean: -0.7274843454360962, mean p set: 0.45172739028930664
loss_pred:0.02599835954606533, decouple_loss:0.009615890681743622
Iteration: 366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511534869670868, gen p mean: -0.7267297506332397, mean p set: 0.4516338109970093
The modified gen p mean: 0.4514777660369873, gen p mean: -0.7337846159934998, mean p set: 0.4519580900669098
loss_pred:0.0265045128762722, decouple_loss:0.009560463018715382
loss_pred:0.02720627188682556, decouple_loss:0.010289827361702919
The modified gen p mean: 0.4521215856075287, gen p mean: -0.7314853072166443, mean p set: 0.4526018798351288
loss_pred:0.026244664564728737, decouple_loss:0.00970225315541029
Iteration: 367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524537920951843, gen p mean: -0.7233168482780457, mean p set: 0.4529340863227844
loss_pred:0.027243254706263542, decouple_loss:0.010671964846551418
The modified gen p mean: 0.45133817195892334, gen p mean: -0.7268750667572021, mean p set: 0.45181846618652344
The modified gen p mean: 0.4508211314678192, gen p mean: -0.7228327393531799, mean p set: 0.4513013958930969
loss_pred:0.02609659917652607, decouple_loss:0.009930278174579144
loss_pred:0.02610866166651249, decouple_loss:0.009745477698743343
Iteration: 368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45122694969177246, gen p mean: -0.7323523163795471, mean p set: 0.45170727372169495
loss_pred:0.025432785972952843, decouple_loss:0.009651131927967072
The modified gen p mean: 0.45320776104927063, gen p mean: -0.7321686148643494, mean p set: 0.45368802547454834
The modified gen p mean: 0.45342594385147095, gen p mean: -0.7311469912528992, mean p set: 0.45390620827674866
loss_pred:0.02720261737704277, decouple_loss:0.010408727452158928
loss_pred:0.026998762041330338, decouple_loss:0.009804712608456612
Iteration: 369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45296192169189453, gen p mean: -0.7283222675323486, mean p set: 0.45344221591949463
The modified gen p mean: 0.45312532782554626, gen p mean: -0.7408953309059143, mean p set: 0.45360562205314636
loss_pred:0.026972420513629913, decouple_loss:0.010153318755328655
loss_pred:0.02679404988884926, decouple_loss:0.010234331712126732
The modified gen p mean: 0.45237088203430176, gen p mean: -0.7377750873565674, mean p set: 0.45285117626190186
loss_pred:0.026498258113861084, decouple_loss:0.010057988576591015
Iteration: 370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527921676635742, gen p mean: -0.7433423399925232, mean p set: 0.4532724618911743
The modified gen p mean: 0.45333120226860046, gen p mean: -0.7384227514266968, mean p set: 0.45381149649620056
loss_pred:0.02671089768409729, decouple_loss:0.00962503720074892
loss_pred:0.02668423391878605, decouple_loss:0.009437542408704758
The modified gen p mean: 0.4513908624649048, gen p mean: -0.7420387268066406, mean p set: 0.4518711566925049
loss_pred:0.026277529075741768, decouple_loss:0.009881040081381798
2023-05-04 12:42:56 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7357439398765564, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7472277283668518, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7404468655586243, mean p set: 0.4500633478164673
loss_pred:0.02669922076165676, decouple_loss:0.010622790083289146
loss_pred:0.02813183143734932, decouple_loss:0.01105492003262043
loss_pred:0.027044959366321564, decouple_loss:0.010443039238452911
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027827350422739983, avg_mse: 0.033578526228666306
current test mse: 0.033579
Iteration: 371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45267388224601746, gen p mean: -0.7400267124176025, mean p set: 0.45315417647361755
loss_pred:0.026142893359065056, decouple_loss:0.009535685181617737
The modified gen p mean: 0.45095396041870117, gen p mean: -0.7387051582336426, mean p set: 0.45143428444862366
loss_pred:0.02502809464931488, decouple_loss:0.009554670192301273
The modified gen p mean: 0.45061159133911133, gen p mean: -0.7354597449302673, mean p set: 0.4510918855667114
loss_pred:0.02546354942023754, decouple_loss:0.009671052917838097
Iteration: 372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532085359096527, gen p mean: -0.7356773018836975, mean p set: 0.4536888301372528
loss_pred:0.027060886844992638, decouple_loss:0.010261411778628826
The modified gen p mean: 0.45308157801628113, gen p mean: -0.7283760905265808, mean p set: 0.4535618722438812
The modified gen p mean: 0.4514097571372986, gen p mean: -0.7327349185943604, mean p set: 0.45189008116722107
loss_pred:0.025627102702856064, decouple_loss:0.01009477861225605
loss_pred:0.026436472311615944, decouple_loss:0.009922513738274574
Iteration: 373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45241525769233704, gen p mean: -0.7309499382972717, mean p set: 0.4528955817222595
The modified gen p mean: 0.4525606632232666, gen p mean: -0.733503520488739, mean p set: 0.4530409872531891
loss_pred:0.026361148804426193, decouple_loss:0.01013280637562275
loss_pred:0.026626093313097954, decouple_loss:0.009692876599729061
The modified gen p mean: 0.4515746533870697, gen p mean: -0.7270752787590027, mean p set: 0.4520549178123474
loss_pred:0.02737579122185707, decouple_loss:0.009974840097129345
Iteration: 374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45189720392227173, gen p mean: -0.7242674231529236, mean p set: 0.4523775279521942
The modified gen p mean: 0.45206183195114136, gen p mean: -0.7235603928565979, mean p set: 0.45254209637641907
loss_pred:0.026013091206550598, decouple_loss:0.009898250922560692
loss_pred:0.02665078453719616, decouple_loss:0.00973185058683157
The modified gen p mean: 0.4526158273220062, gen p mean: -0.7250916957855225, mean p set: 0.45309609174728394
loss_pred:0.02675613947212696, decouple_loss:0.009811379946768284
Iteration: 375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520900845527649, gen p mean: -0.7369445562362671, mean p set: 0.4525703489780426
The modified gen p mean: 0.4517531096935272, gen p mean: -0.7406491041183472, mean p set: 0.4522334337234497
loss_pred:0.025819595903158188, decouple_loss:0.00940793938934803
loss_pred:0.025810083374381065, decouple_loss:0.009435510262846947
The modified gen p mean: 0.4503174424171448, gen p mean: -0.738091766834259, mean p set: 0.4507977068424225
loss_pred:0.026081232354044914, decouple_loss:0.009723875671625137
Iteration: 376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45180171728134155, gen p mean: -0.7369584441184998, mean p set: 0.45228198170661926
loss_pred:0.02658163756132126, decouple_loss:0.009582693688571453
The modified gen p mean: 0.45073312520980835, gen p mean: -0.7349255681037903, mean p set: 0.45121341943740845
The modified gen p mean: 0.4508954882621765, gen p mean: -0.7327625751495361, mean p set: 0.451375812292099
loss_pred:0.025327904149889946, decouple_loss:0.00928642600774765
loss_pred:0.02665504813194275, decouple_loss:0.00943154189735651
Iteration: 377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452274888753891, gen p mean: -0.7388875484466553, mean p set: 0.4527551829814911The modified gen p mean: 0.4533539414405823, gen p mean: -0.7381056547164917, mean p set: 0.45383426547050476
loss_pred:0.026477018371224403, decouple_loss:0.009420070797204971
loss_pred:0.026900574564933777, decouple_loss:0.009876212105154991
The modified gen p mean: 0.45273759961128235, gen p mean: -0.7443850636482239, mean p set: 0.45321789383888245
loss_pred:0.025878190994262695, decouple_loss:0.009644249454140663
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
NaN value num: 0
Iteration: 378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45132339000701904, gen p mean: -0.7369300127029419, mean p set: 0.45180368423461914
The modified gen p mean: 0.4524969756603241, gen p mean: -0.741283655166626, mean p set: 0.4529772400856018
loss_pred:0.026270704343914986, decouple_loss:0.010400086641311646
The modified gen p mean: 0.45346465706825256, gen p mean: -0.7399289608001709, mean p set: 0.4539449214935303
loss_pred:0.025769051164388657, decouple_loss:0.010318546555936337
loss_pred:0.025898240506649017, decouple_loss:0.00994657352566719
Iteration: 379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521520435810089, gen p mean: -0.740300178527832, mean p set: 0.4526323080062866
The modified gen p mean: 0.45154979825019836, gen p mean: -0.7444339990615845, mean p set: 0.45203009247779846
loss_pred:0.026256674900650978, decouple_loss:0.010152149945497513
loss_pred:0.025255080312490463, decouple_loss:0.010192004963755608
The modified gen p mean: 0.4520367681980133, gen p mean: -0.740650475025177, mean p set: 0.452517032623291
loss_pred:0.02566753886640072, decouple_loss:0.009974627755582333
Iteration: 380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45167723298072815, gen p mean: -0.7490212321281433, mean p set: 0.45215752720832825
loss_pred:0.02677685022354126, decouple_loss:0.009960093535482883
The modified gen p mean: 0.4524695873260498, gen p mean: -0.7528147101402283, mean p set: 0.4529498815536499
The modified gen p mean: 0.45029470324516296, gen p mean: -0.7501684427261353, mean p set: 0.45077502727508545
loss_pred:0.02536722458899021, decouple_loss:0.010335730388760567
loss_pred:0.02700086496770382, decouple_loss:0.009953783825039864
2023-05-04 12:47:14 testing...
The modified gen p mean: 0.44987669587135315, gen p mean: -0.7390503883361816, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7506462931632996, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7434285283088684, mean p set: 0.4500633478164673
loss_pred:0.02628212980926037, decouple_loss:0.010576184839010239
loss_pred:0.02775121107697487, decouple_loss:0.010923775844275951
loss_pred:0.02671181969344616, decouple_loss:0.010568656027317047
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027449531480669975, avg_mse: 0.03295052796602249
current test mse: 0.032951
Iteration: 381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523853361606598, gen p mean: -0.7477526068687439, mean p set: 0.4528656601905823
The modified gen p mean: 0.4493550658226013, gen p mean: -0.7441291809082031, mean p set: 0.4498353600502014
loss_pred:0.026235690340399742, decouple_loss:0.009935724548995495
loss_pred:0.026779336854815483, decouple_loss:0.009820275008678436
The modified gen p mean: 0.4518226385116577, gen p mean: -0.7503779530525208, mean p set: 0.4523029327392578
loss_pred:0.025590945035219193, decouple_loss:0.009836689569056034
Iteration: 382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45488834381103516, gen p mean: -0.7509791254997253, mean p set: 0.45536860823631287
The modified gen p mean: 0.45141032338142395, gen p mean: -0.7523559927940369, mean p set: 0.45189061760902405
loss_pred:0.025073029100894928, decouple_loss:0.009345355443656445
loss_pred:0.025720903649926186, decouple_loss:0.009735459461808205
The modified gen p mean: 0.45085933804512024, gen p mean: -0.7525030374526978, mean p set: 0.45133963227272034
loss_pred:0.025978896766901016, decouple_loss:0.009584033861756325
Iteration: 383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45203450322151184, gen p mean: -0.7655097246170044, mean p set: 0.45251479744911194
The modified gen p mean: 0.452595055103302, gen p mean: -0.7578747868537903, mean p set: 0.4530753493309021
loss_pred:0.026098163798451424, decouple_loss:0.009356312453746796
loss_pred:0.025799598544836044, decouple_loss:0.009036779403686523
The modified gen p mean: 0.45077621936798096, gen p mean: -0.7573489546775818, mean p set: 0.45125651359558105
loss_pred:0.025243686512112617, decouple_loss:0.009039736352860928
Iteration: 384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512932002544403, gen p mean: -0.7723100185394287, mean p set: 0.451773464679718
The modified gen p mean: 0.451680064201355, gen p mean: -0.7664972543716431, mean p set: 0.4521603584289551
loss_pred:0.026494547724723816, decouple_loss:0.00962713360786438
loss_pred:0.02590521052479744, decouple_loss:0.009448389522731304
The modified gen p mean: 0.45221635699272156, gen p mean: -0.7643839716911316, mean p set: 0.45269668102264404
loss_pred:0.02583850361406803, decouple_loss:0.009372883476316929
Iteration: 385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509139657020569, gen p mean: -0.753047525882721, mean p set: 0.451394259929657
loss_pred:0.02587199956178665, decouple_loss:0.009501222521066666
The modified gen p mean: 0.45280522108078003, gen p mean: -0.7562174201011658, mean p set: 0.45328548550605774
The modified gen p mean: 0.4525321424007416, gen p mean: -0.7561008334159851, mean p set: 0.4530124366283417
loss_pred:0.02541634626686573, decouple_loss:0.00936692301183939
loss_pred:0.02559228427708149, decouple_loss:0.009618970565497875
Iteration: 386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525904357433319, gen p mean: -0.7457716464996338, mean p set: 0.453070729970932
The modified gen p mean: 0.4530589282512665, gen p mean: -0.7393844127655029, mean p set: 0.45353925228118896
loss_pred:0.025278832763433456, decouple_loss:0.009507544338703156
loss_pred:0.025439880788326263, decouple_loss:0.009521051310002804
The modified gen p mean: 0.45566442608833313, gen p mean: -0.7383573651313782, mean p set: 0.45614469051361084
loss_pred:0.025320496410131454, decouple_loss:0.009268361143767834
Iteration: 387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528324604034424, gen p mean: -0.7353195548057556, mean p set: 0.4533127248287201
The modified gen p mean: 0.45218998193740845, gen p mean: -0.7315046787261963, mean p set: 0.45267021656036377
loss_pred:0.02578503079712391, decouple_loss:0.009698324836790562
loss_pred:0.026237914338707924, decouple_loss:0.009882284328341484
The modified gen p mean: 0.451323926448822, gen p mean: -0.7352886199951172, mean p set: 0.4518042206764221
loss_pred:0.025017403066158295, decouple_loss:0.009461513720452785
Iteration: 388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520688056945801, gen p mean: -0.7446175217628479, mean p set: 0.45254912972450256
The modified gen p mean: 0.4513205289840698, gen p mean: -0.7482003569602966, mean p set: 0.4518008232116699
loss_pred:0.025704611092805862, decouple_loss:0.009271697141230106
loss_pred:0.025466861203312874, decouple_loss:0.009146224707365036
The modified gen p mean: 0.4507061541080475, gen p mean: -0.7502995729446411, mean p set: 0.4511864483356476
loss_pred:0.02666550874710083, decouple_loss:0.008991114795207977
Iteration: 389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45303037762641907, gen p mean: -0.750910222530365, mean p set: 0.45351067185401917
loss_pred:0.026030082255601883, decouple_loss:0.009253092110157013
The modified gen p mean: 0.45311006903648376, gen p mean: -0.754199206829071, mean p set: 0.45359036326408386
The modified gen p mean: 0.45382753014564514, gen p mean: -0.7509025931358337, mean p set: 0.4543078541755676
loss_pred:0.026294536888599396, decouple_loss:0.009316975250840187
loss_pred:0.02583501674234867, decouple_loss:0.009023101069033146
Iteration: 390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508713483810425, gen p mean: -0.7448558211326599, mean p set: 0.4513516426086426
The modified gen p mean: 0.45258423686027527, gen p mean: -0.7540872097015381, mean p set: 0.45306456089019775
loss_pred:0.025770651176571846, decouple_loss:0.008874665014445782
loss_pred:0.026088090613484383, decouple_loss:0.008891414850950241
The modified gen p mean: 0.45179104804992676, gen p mean: -0.7436897158622742, mean p set: 0.45227131247520447
loss_pred:0.025420714169740677, decouple_loss:0.00915832445025444
2023-05-04 12:50:49 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7359563708305359, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7478169202804565, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7407621741294861, mean p set: 0.4500633478164673
loss_pred:0.026325535029172897, decouple_loss:0.010174369439482689
loss_pred:0.027741512283682823, decouple_loss:0.010122253559529781
loss_pred:0.026668591424822807, decouple_loss:0.01017412357032299
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02741972729563713, avg_mse: 0.03302982449531555
current test mse: 0.03303
Iteration: 391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527682662010193, gen p mean: -0.7449371218681335, mean p set: 0.4532485604286194
The modified gen p mean: 0.45142698287963867, gen p mean: -0.743151068687439, mean p set: 0.45190730690956116
loss_pred:0.026435764506459236, decouple_loss:0.009138829074800014
loss_pred:0.025602160021662712, decouple_loss:0.009169359691441059
The modified gen p mean: 0.44968923926353455, gen p mean: -0.742438018321991, mean p set: 0.45016953349113464
loss_pred:0.025690797716379166, decouple_loss:0.008837644010782242
Iteration: 392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523903429508209, gen p mean: -0.745135486125946, mean p set: 0.452870637178421
loss_pred:0.026245078071951866, decouple_loss:0.009322891011834145
The modified gen p mean: 0.45025011897087097, gen p mean: -0.7456892728805542, mean p set: 0.45073044300079346
The modified gen p mean: 0.45246604084968567, gen p mean: -0.7439196705818176, mean p set: 0.45294633507728577
loss_pred:0.026167407631874084, decouple_loss:0.009039312601089478
loss_pred:0.025366879999637604, decouple_loss:0.00901271402835846
Iteration: 393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523266851902008, gen p mean: -0.7540777325630188, mean p set: 0.4528070092201233
The modified gen p mean: 0.45100727677345276, gen p mean: -0.7607468962669373, mean p set: 0.45148760080337524
loss_pred:0.025527117773890495, decouple_loss:0.008839408867061138
loss_pred:0.025860276073217392, decouple_loss:0.009048026986420155
The modified gen p mean: 0.45296230912208557, gen p mean: -0.7538416981697083, mean p set: 0.4534425735473633
loss_pred:0.02591201663017273, decouple_loss:0.008959505707025528
Iteration: 394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45163533091545105, gen p mean: -0.7608889937400818, mean p set: 0.45211559534072876
loss_pred:0.025862988084554672, decouple_loss:0.00904380064457655
The modified gen p mean: 0.4524965286254883, gen p mean: -0.755986213684082, mean p set: 0.452976793050766
The modified gen p mean: 0.4509826600551605, gen p mean: -0.7612931132316589, mean p set: 0.4514629542827606
loss_pred:0.02596583403646946, decouple_loss:0.008815684355795383
loss_pred:0.025654487311840057, decouple_loss:0.00899582915008068
Iteration: 395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527053236961365, gen p mean: -0.7662643194198608, mean p set: 0.4531856179237366
loss_pred:0.02483966387808323, decouple_loss:0.00953272357583046
The modified gen p mean: 0.4500975012779236, gen p mean: -0.7554907202720642, mean p set: 0.4505777657032013
The modified gen p mean: 0.44957488775253296, gen p mean: -0.7538701295852661, mean p set: 0.45005518198013306
loss_pred:0.02589147724211216, decouple_loss:0.008724542334675789
loss_pred:0.02595817670226097, decouple_loss:0.008857016451656818
Iteration: 396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037293434143066, gen p mean: -0.7460585832595825, mean p set: 0.45085322856903076
loss_pred:0.026664450764656067, decouple_loss:0.008627583272755146
The modified gen p mean: 0.45286643505096436, gen p mean: -0.756436824798584, mean p set: 0.45334672927856445
The modified gen p mean: 0.45390570163726807, gen p mean: -0.7495192289352417, mean p set: 0.4543859660625458
loss_pred:0.026062216609716415, decouple_loss:0.00870816595852375
loss_pred:0.024983616545796394, decouple_loss:0.0089181587100029
Iteration: 397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45300841331481934, gen p mean: -0.7439818382263184, mean p set: 0.45348870754241943
The modified gen p mean: 0.4510918855667114, gen p mean: -0.7456261515617371, mean p set: 0.45157214999198914
loss_pred:0.025286179035902023, decouple_loss:0.008666124194860458
loss_pred:0.0257706418633461, decouple_loss:0.008953897282481194
The modified gen p mean: 0.4547361135482788, gen p mean: -0.744417667388916, mean p set: 0.4552163779735565
loss_pred:0.025725839659571648, decouple_loss:0.009065228514373302
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
NaN value num: 0
Iteration: 398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525343179702759, gen p mean: -0.7484164834022522, mean p set: 0.45301464200019836
The modified gen p mean: 0.452502965927124, gen p mean: -0.7491640448570251, mean p set: 0.4529832601547241
The modified gen p mean: 0.45013538002967834, gen p mean: -0.7387677431106567, mean p set: 0.45061564445495605
loss_pred:0.02508624456822872, decouple_loss:0.010173512622714043
loss_pred:0.025798603892326355, decouple_loss:0.009938818402588367
loss_pred:0.02588449791073799, decouple_loss:0.010550488717854023
Iteration: 399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505603611469269, gen p mean: -0.7577447891235352, mean p set: 0.45104068517684937
The modified gen p mean: 0.44941961765289307, gen p mean: -0.7504616379737854, mean p set: 0.44989991188049316
loss_pred:0.025989560410380363, decouple_loss:0.010094395838677883
loss_pred:0.026233147829771042, decouple_loss:0.009988784790039062
The modified gen p mean: 0.44954437017440796, gen p mean: -0.7427634000778198, mean p set: 0.45002463459968567
loss_pred:0.02562318556010723, decouple_loss:0.00952752586454153
Iteration: 400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503837525844574, gen p mean: -0.7529226541519165, mean p set: 0.4508640468120575
loss_pred:0.026147635653614998, decouple_loss:0.009330252185463905
The modified gen p mean: 0.4533082842826843, gen p mean: -0.7540806531906128, mean p set: 0.4537885785102844
The modified gen p mean: 0.44874173402786255, gen p mean: -0.7475193738937378, mean p set: 0.44922199845314026
loss_pred:0.024585193023085594, decouple_loss:0.009357670322060585
loss_pred:0.02607022412121296, decouple_loss:0.00939902476966381
2023-05-04 12:55:03 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7434071898460388, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7550808191299438, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.74824059009552, mean p set: 0.4500633478164673
loss_pred:0.02624208852648735, decouple_loss:0.009928667917847633
loss_pred:0.026715252548456192, decouple_loss:0.009759903885424137
loss_pred:0.02767164632678032, decouple_loss:0.01022550743073225
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02737489901483059, avg_mse: 0.03298048675060272
current test mse: 0.03298
Iteration: 401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869574904441833, gen p mean: -0.7436903119087219, mean p set: 0.44917601346969604
The modified gen p mean: 0.452386736869812, gen p mean: -0.751376748085022, mean p set: 0.4528670310974121
loss_pred:0.026217671111226082, decouple_loss:0.008996410295367241
loss_pred:0.025385349988937378, decouple_loss:0.009711007587611675
The modified gen p mean: 0.4500104486942291, gen p mean: -0.7541909217834473, mean p set: 0.4504907429218292
loss_pred:0.027112750336527824, decouple_loss:0.009342541918158531
Iteration: 402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525712728500366, gen p mean: -0.7545644044876099, mean p set: 0.4530515968799591
The modified gen p mean: 0.4502578377723694, gen p mean: -0.7454932928085327, mean p set: 0.4507381319999695
loss_pred:0.02560981921851635, decouple_loss:0.009377527981996536
loss_pred:0.025506924837827682, decouple_loss:0.009072397835552692
The modified gen p mean: 0.4498424530029297, gen p mean: -0.7546137571334839, mean p set: 0.4503227472305298
loss_pred:0.026199636980891228, decouple_loss:0.009112212806940079
Iteration: 403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45096728205680847, gen p mean: -0.7558057308197021, mean p set: 0.4514475464820862
loss_pred:0.026506049558520317, decouple_loss:0.00936046615242958
The modified gen p mean: 0.4502831995487213, gen p mean: -0.7597556710243225, mean p set: 0.4507634937763214
The modified gen p mean: 0.448539137840271, gen p mean: -0.7525794506072998, mean p set: 0.4490193724632263
loss_pred:0.02617782913148403, decouple_loss:0.009489716961979866
loss_pred:0.02554507739841938, decouple_loss:0.009126116521656513
Iteration: 404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493556320667267, gen p mean: -0.760754406452179, mean p set: 0.4498359262943268
The modified gen p mean: 0.4501749277114868, gen p mean: -0.7551939487457275, mean p set: 0.4506552517414093
loss_pred:0.026119839400053024, decouple_loss:0.009498951025307178
The modified gen p mean: 0.44931161403656006, gen p mean: -0.7538695335388184, mean p set: 0.44979190826416016
loss_pred:0.027246974408626556, decouple_loss:0.009381628595292568
loss_pred:0.026571379974484444, decouple_loss:0.009127498604357243
Iteration: 405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44950199127197266, gen p mean: -0.7546744346618652, mean p set: 0.44998228549957275
The modified gen p mean: 0.4500272572040558, gen p mean: -0.7568488121032715, mean p set: 0.4505075514316559
loss_pred:0.026153171434998512, decouple_loss:0.009577332995831966
loss_pred:0.026973906904459, decouple_loss:0.009005887433886528
The modified gen p mean: 0.44999271631240845, gen p mean: -0.7593442797660828, mean p set: 0.45047301054000854
loss_pred:0.02684350498020649, decouple_loss:0.009209738112986088
Iteration: 406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491752088069916, gen p mean: -0.7509430050849915, mean p set: 0.4496554732322693
loss_pred:0.025946123525500298, decouple_loss:0.00877303071320057
The modified gen p mean: 0.4498870372772217, gen p mean: -0.7502498030662537, mean p set: 0.4503673017024994
The modified gen p mean: 0.45121529698371887, gen p mean: -0.7579824328422546, mean p set: 0.45169559121131897
loss_pred:0.025120016187429428, decouple_loss:0.008978160098195076
loss_pred:0.026640567928552628, decouple_loss:0.009330482222139835
Iteration: 407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488760232925415, gen p mean: -0.7550973296165466, mean p set: 0.4493563175201416
The modified gen p mean: 0.44951504468917847, gen p mean: -0.7614957094192505, mean p set: 0.44999533891677856
loss_pred:0.026773368939757347, decouple_loss:0.009304944425821304
loss_pred:0.026088478043675423, decouple_loss:0.008908475749194622
The modified gen p mean: 0.45037809014320374, gen p mean: -0.7681154608726501, mean p set: 0.45085835456848145
loss_pred:0.025866638869047165, decouple_loss:0.009468045085668564
Iteration: 408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449049711227417, gen p mean: -0.7630971074104309, mean p set: 0.4495299756526947
The modified gen p mean: 0.4503077566623688, gen p mean: -0.7595838904380798, mean p set: 0.45078805088996887
loss_pred:0.02648015506565571, decouple_loss:0.009043511934578419
loss_pred:0.025825094431638718, decouple_loss:0.009058318100869656
The modified gen p mean: 0.4498305916786194, gen p mean: -0.7560577392578125, mean p set: 0.4503108859062195
loss_pred:0.025984562933444977, decouple_loss:0.008696703240275383
Iteration: 409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147770643234253, gen p mean: -0.7570831179618835, mean p set: 0.4519580006599426
loss_pred:0.026092683896422386, decouple_loss:0.009574142284691334
The modified gen p mean: 0.4499151110649109, gen p mean: -0.7556108832359314, mean p set: 0.450395405292511
The modified gen p mean: 0.4519721567630768, gen p mean: -0.7570527791976929, mean p set: 0.4524524509906769
loss_pred:0.025243129581212997, decouple_loss:0.008808214217424393
loss_pred:0.024441668763756752, decouple_loss:0.009162015281617641
Iteration: 410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494783282279968, gen p mean: -0.753189206123352, mean p set: 0.4499586224555969
The modified gen p mean: 0.4495808780193329, gen p mean: -0.7533029913902283, mean p set: 0.450061172246933
loss_pred:0.025715315714478493, decouple_loss:0.008628057315945625
loss_pred:0.026787901297211647, decouple_loss:0.00880214013159275
The modified gen p mean: 0.4503800570964813, gen p mean: -0.7552116513252258, mean p set: 0.4508603513240814
loss_pred:0.026426877826452255, decouple_loss:0.008480409160256386
2023-05-04 12:58:38 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7415666580200195, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7541150450706482, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7471285462379456, mean p set: 0.4500633478164673
loss_pred:0.02610284462571144, decouple_loss:0.009801694191992283
loss_pred:0.02746559865772724, decouple_loss:0.010051379911601543
loss_pred:0.026448743417859077, decouple_loss:0.00951777771115303
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027161911129951477, avg_mse: 0.03271304443478584
current test mse: 0.032713
Iteration: 411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508987367153168, gen p mean: -0.754094123840332, mean p set: 0.45137903094291687
The modified gen p mean: 0.45002520084381104, gen p mean: -0.7560296058654785, mean p set: 0.4505055248737335
loss_pred:0.026443814858794212, decouple_loss:0.008865383453667164
loss_pred:0.02578624151647091, decouple_loss:0.00902503915131092
The modified gen p mean: 0.4493119716644287, gen p mean: -0.7535555958747864, mean p set: 0.4497922658920288
loss_pred:0.025999216362833977, decouple_loss:0.008412198163568974
Iteration: 412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494835436344147, gen p mean: -0.7573581337928772, mean p set: 0.44996383786201477
The modified gen p mean: 0.4481469988822937, gen p mean: -0.7571380734443665, mean p set: 0.4486272633075714
loss_pred:0.026480942964553833, decouple_loss:0.008347148075699806
loss_pred:0.02605930157005787, decouple_loss:0.008708881214261055
The modified gen p mean: 0.44925764203071594, gen p mean: -0.745367169380188, mean p set: 0.44973790645599365
loss_pred:0.025127489119768143, decouple_loss:0.008279943838715553
Iteration: 413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45020461082458496, gen p mean: -0.7534370422363281, mean p set: 0.45068490505218506
The modified gen p mean: 0.45172998309135437, gen p mean: -0.7471845149993896, mean p set: 0.45221027731895447
loss_pred:0.025881562381982803, decouple_loss:0.008728108368813992
loss_pred:0.02574351243674755, decouple_loss:0.008954734541475773
The modified gen p mean: 0.45165202021598816, gen p mean: -0.7588043808937073, mean p set: 0.45213228464126587
loss_pred:0.02550523169338703, decouple_loss:0.009080663323402405
Iteration: 414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45040807127952576, gen p mean: -0.7402610778808594, mean p set: 0.45088836550712585
The modified gen p mean: 0.45023179054260254, gen p mean: -0.748489260673523, mean p set: 0.45071205496788025
loss_pred:0.025744520127773285, decouple_loss:0.008856179192662239
loss_pred:0.02579512819647789, decouple_loss:0.008775646798312664
The modified gen p mean: 0.4486159384250641, gen p mean: -0.7391251921653748, mean p set: 0.4490962028503418
loss_pred:0.025800026953220367, decouple_loss:0.008273518644273281
Iteration: 415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019587874412537, gen p mean: -0.7416295409202576, mean p set: 0.45067617297172546
loss_pred:0.02484198659658432, decouple_loss:0.008284099400043488
The modified gen p mean: 0.44909605383872986, gen p mean: -0.7355235815048218, mean p set: 0.44957631826400757
The modified gen p mean: 0.4508315324783325, gen p mean: -0.742180585861206, mean p set: 0.4513118267059326
loss_pred:0.025968195870518684, decouple_loss:0.0085415318608284
loss_pred:0.025181995704770088, decouple_loss:0.00830595102161169
Iteration: 416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497844874858856, gen p mean: -0.7451584935188293, mean p set: 0.4502647817134857
loss_pred:0.02596988156437874, decouple_loss:0.00819455087184906
The modified gen p mean: 0.44974303245544434, gen p mean: -0.7504286170005798, mean p set: 0.4502233564853668
The modified gen p mean: 0.4522729516029358, gen p mean: -0.7459143400192261, mean p set: 0.4527532756328583
loss_pred:0.025817591696977615, decouple_loss:0.008108015172183514
loss_pred:0.02571835182607174, decouple_loss:0.008893482387065887
Iteration: 417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45145395398139954, gen p mean: -0.7531654238700867, mean p set: 0.45193424820899963
The modified gen p mean: 0.4496683180332184, gen p mean: -0.7512654066085815, mean p set: 0.4501486122608185
loss_pred:0.026310209184885025, decouple_loss:0.008709215559065342
loss_pred:0.025755595415830612, decouple_loss:0.008472681045532227
The modified gen p mean: 0.4521687626838684, gen p mean: -0.7533395290374756, mean p set: 0.4526490569114685
loss_pred:0.02493450604379177, decouple_loss:0.008319409564137459
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493604004383087, gen p mean: -0.739956259727478, mean p set: 0.4498407244682312
The modified gen p mean: 0.4495813846588135, gen p mean: -0.7450994849205017, mean p set: 0.4500616788864136
loss_pred:0.027242833748459816, decouple_loss:0.009329712949693203
The modified gen p mean: 0.447726845741272, gen p mean: -0.7394788861274719, mean p set: 0.44820713996887207
loss_pred:0.02689576894044876, decouple_loss:0.009226981550455093
loss_pred:0.027602797374129295, decouple_loss:0.009740060195326805
Iteration: 419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476395547389984, gen p mean: -0.7438730597496033, mean p set: 0.4481198489665985
The modified gen p mean: 0.44813576340675354, gen p mean: -0.7446797490119934, mean p set: 0.44861605763435364
loss_pred:0.02626458927989006, decouple_loss:0.009146545082330704
loss_pred:0.026529008522629738, decouple_loss:0.008761443197727203
The modified gen p mean: 0.44880861043930054, gen p mean: -0.7442329525947571, mean p set: 0.449288934469223
loss_pred:0.02682514861226082, decouple_loss:0.008936175145208836
Iteration: 420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484628736972809, gen p mean: -0.7535140514373779, mean p set: 0.448943167924881
The modified gen p mean: 0.4501529932022095, gen p mean: -0.7532714605331421, mean p set: 0.4506332576274872
loss_pred:0.02626357227563858, decouple_loss:0.008744890801608562
loss_pred:0.02537914738059044, decouple_loss:0.008857471868395805
The modified gen p mean: 0.44935810565948486, gen p mean: -0.7519033551216125, mean p set: 0.44983842968940735
loss_pred:0.0272077564150095, decouple_loss:0.0092996871098876
2023-05-04 13:02:48 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7516515851020813, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7646988034248352, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7574072480201721, mean p set: 0.4500633478164673
loss_pred:0.025883875787258148, decouple_loss:0.009163972921669483
loss_pred:0.027272237464785576, decouple_loss:0.009250825271010399
loss_pred:0.026286426931619644, decouple_loss:0.008903938345611095
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026936158537864685, avg_mse: 0.03233838826417923
current test mse: 0.032338
Iteration: 421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473860263824463, gen p mean: -0.7464070320129395, mean p set: 0.4478663504123688
The modified gen p mean: 0.44856056571006775, gen p mean: -0.7567775845527649, mean p set: 0.44904085993766785
loss_pred:0.026201479136943817, decouple_loss:0.009480929002165794
loss_pred:0.026569319888949394, decouple_loss:0.008748405613005161
The modified gen p mean: 0.44897758960723877, gen p mean: -0.7580005526542664, mean p set: 0.44945788383483887
loss_pred:0.02604769356548786, decouple_loss:0.00867383647710085
Iteration: 422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504079818725586, gen p mean: -0.7561531066894531, mean p set: 0.4508882462978363
The modified gen p mean: 0.4484004080295563, gen p mean: -0.7444443702697754, mean p set: 0.44888070225715637
loss_pred:0.026042649522423744, decouple_loss:0.008532200939953327
loss_pred:0.02670961245894432, decouple_loss:0.00919325090944767
The modified gen p mean: 0.4493882358074188, gen p mean: -0.7546456456184387, mean p set: 0.4498685300350189
loss_pred:0.027037495747208595, decouple_loss:0.008450585417449474
Iteration: 423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44888004660606384, gen p mean: -0.7607343196868896, mean p set: 0.44936034083366394
The modified gen p mean: 0.44865718483924866, gen p mean: -0.7621785998344421, mean p set: 0.449137419462204
loss_pred:0.02584563009440899, decouple_loss:0.008480421267449856
loss_pred:0.027386145666241646, decouple_loss:0.008721022866666317
The modified gen p mean: 0.4475764036178589, gen p mean: -0.7718838453292847, mean p set: 0.448056697845459
loss_pred:0.025946181267499924, decouple_loss:0.008429738692939281
Iteration: 424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44882893562316895, gen p mean: -0.7645571231842041, mean p set: 0.44930922985076904
The modified gen p mean: 0.4480966627597809, gen p mean: -0.7699387669563293, mean p set: 0.4485769271850586
loss_pred:0.026441574096679688, decouple_loss:0.008959755301475525
loss_pred:0.026470055803656578, decouple_loss:0.00866886880248785
The modified gen p mean: 0.4491627514362335, gen p mean: -0.7595731019973755, mean p set: 0.44964301586151123
loss_pred:0.02726956270635128, decouple_loss:0.008629634976387024
Iteration: 425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448865681886673, gen p mean: -0.7483095526695251, mean p set: 0.4493459463119507
loss_pred:0.026934539899230003, decouple_loss:0.009095316752791405
The modified gen p mean: 0.4481092393398285, gen p mean: -0.7444853186607361, mean p set: 0.4485895335674286
The modified gen p mean: 0.44939932227134705, gen p mean: -0.7512898445129395, mean p set: 0.44987955689430237
loss_pred:0.02627381682395935, decouple_loss:0.008546358905732632
loss_pred:0.02616192400455475, decouple_loss:0.00953302439302206
Iteration: 426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502018690109253, gen p mean: -0.7444818019866943, mean p set: 0.450682133436203
The modified gen p mean: 0.44852960109710693, gen p mean: -0.7483292818069458, mean p set: 0.44900989532470703
loss_pred:0.02672617882490158, decouple_loss:0.009070918895304203
loss_pred:0.02655646577477455, decouple_loss:0.008928587660193443
The modified gen p mean: 0.4492068290710449, gen p mean: -0.7390356659889221, mean p set: 0.449687123298645
loss_pred:0.027079831808805466, decouple_loss:0.008491404354572296
Iteration: 427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487566351890564, gen p mean: -0.7320653796195984, mean p set: 0.4492368996143341
loss_pred:0.02706066146492958, decouple_loss:0.008680989034473896
The modified gen p mean: 0.4481106400489807, gen p mean: -0.7445163130760193, mean p set: 0.4485909342765808
The modified gen p mean: 0.44974711537361145, gen p mean: -0.7430627346038818, mean p set: 0.45022737979888916
loss_pred:0.026891054585576057, decouple_loss:0.008616624400019646
loss_pred:0.02750995010137558, decouple_loss:0.00865267962217331
Iteration: 428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491323232650757, gen p mean: -0.7490128874778748, mean p set: 0.4496126174926758
loss_pred:0.02574579231441021, decouple_loss:0.008524293079972267
The modified gen p mean: 0.4494730234146118, gen p mean: -0.7483335733413696, mean p set: 0.4499533474445343
The modified gen p mean: 0.44789427518844604, gen p mean: -0.7432929873466492, mean p set: 0.44837456941604614
loss_pred:0.02640191651880741, decouple_loss:0.008782465942203999
loss_pred:0.02644544467329979, decouple_loss:0.008029509335756302
Iteration: 429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472452998161316, gen p mean: -0.7548404932022095, mean p set: 0.4477255642414093
The modified gen p mean: 0.45015114545822144, gen p mean: -0.7556889057159424, mean p set: 0.45063140988349915
loss_pred:0.025853892788290977, decouple_loss:0.008043955080211163
loss_pred:0.026669558137655258, decouple_loss:0.008568158373236656
The modified gen p mean: 0.44910913705825806, gen p mean: -0.7533734440803528, mean p set: 0.44958946108818054
loss_pred:0.026327695697546005, decouple_loss:0.008551707491278648
Iteration: 430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499039351940155, gen p mean: -0.7595580816268921, mean p set: 0.4503842294216156
loss_pred:0.02677512913942337, decouple_loss:0.008503708057105541
The modified gen p mean: 0.4491191506385803, gen p mean: -0.7506029605865479, mean p set: 0.4495994448661804
The modified gen p mean: 0.4483877718448639, gen p mean: -0.7597030401229858, mean p set: 0.4488680362701416
loss_pred:0.027032146230340004, decouple_loss:0.008578959852457047
loss_pred:0.026453597471117973, decouple_loss:0.008459528908133507
2023-05-04 13:06:21 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7480795383453369, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7525806427001953, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7593461275100708, mean p set: 0.4502691626548767
loss_pred:0.02577435038983822, decouple_loss:0.008641436696052551
loss_pred:0.026131879538297653, decouple_loss:0.008802296593785286
loss_pred:0.027202965691685677, decouple_loss:0.00919793639332056
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02681376039981842, avg_mse: 0.03220132365822792
current test mse: 0.032201
Iteration: 431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796690344810486, gen p mean: -0.7510912418365479, mean p set: 0.44844722747802734
The modified gen p mean: 0.44854825735092163, gen p mean: -0.7502881288528442, mean p set: 0.44902855157852173
loss_pred:0.026428915560245514, decouple_loss:0.008299612440168858
loss_pred:0.02633245289325714, decouple_loss:0.008728688582777977
The modified gen p mean: 0.44884318113327026, gen p mean: -0.7524222135543823, mean p set: 0.44932347536087036
loss_pred:0.025617942214012146, decouple_loss:0.008542178198695183
Iteration: 432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848164916038513, gen p mean: -0.7466709613800049, mean p set: 0.44896194338798523
The modified gen p mean: 0.44952392578125, gen p mean: -0.7419393658638, mean p set: 0.4500042200088501
loss_pred:0.026573341339826584, decouple_loss:0.009015918709337711
loss_pred:0.026388633996248245, decouple_loss:0.008846192620694637
The modified gen p mean: 0.44788658618927, gen p mean: -0.7470847368240356, mean p set: 0.4483669102191925
loss_pred:0.026498086750507355, decouple_loss:0.008271574042737484
Iteration: 433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901958107948303, gen p mean: -0.7391141057014465, mean p set: 0.44949984550476074
loss_pred:0.025961153209209442, decouple_loss:0.008490059524774551
The modified gen p mean: 0.44927430152893066, gen p mean: -0.741552472114563, mean p set: 0.44975459575653076
The modified gen p mean: 0.4485054016113281, gen p mean: -0.737456738948822, mean p set: 0.44898566603660583
loss_pred:0.026385461911559105, decouple_loss:0.008570082485675812
loss_pred:0.026235518977046013, decouple_loss:0.008517520502209663
Iteration: 434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44981876015663147, gen p mean: -0.7380295991897583, mean p set: 0.45029905438423157
loss_pred:0.026295693591237068, decouple_loss:0.008160051889717579
The modified gen p mean: 0.44979003071784973, gen p mean: -0.7377899289131165, mean p set: 0.4502703547477722
The modified gen p mean: 0.44998177886009216, gen p mean: -0.7411087155342102, mean p set: 0.45046207308769226
loss_pred:0.026677878573536873, decouple_loss:0.008657218888401985
loss_pred:0.02568739838898182, decouple_loss:0.008690344169735909
Iteration: 435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487477242946625, gen p mean: -0.7352122068405151, mean p set: 0.4492279887199402
loss_pred:0.025867251679301262, decouple_loss:0.008403763175010681
The modified gen p mean: 0.4490792453289032, gen p mean: -0.7382271885871887, mean p set: 0.4495595097541809
The modified gen p mean: 0.448699414730072, gen p mean: -0.7381334900856018, mean p set: 0.44917967915534973
loss_pred:0.02620125189423561, decouple_loss:0.008318363688886166
loss_pred:0.02606673166155815, decouple_loss:0.008292092941701412
Iteration: 436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478687345981598, gen p mean: -0.74607253074646, mean p set: 0.4483490288257599
loss_pred:0.026312673464417458, decouple_loss:0.008437294512987137
The modified gen p mean: 0.4481542408466339, gen p mean: -0.7461806535720825, mean p set: 0.448634535074234
The modified gen p mean: 0.44662222266197205, gen p mean: -0.7333758473396301, mean p set: 0.44710251688957214
loss_pred:0.025975778698921204, decouple_loss:0.008343307301402092
loss_pred:0.026240229606628418, decouple_loss:0.00873474683612585
Iteration: 437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772836565971375, gen p mean: -0.7514995336532593, mean p set: 0.44820865988731384
The modified gen p mean: 0.4494432210922241, gen p mean: -0.7451962232589722, mean p set: 0.4499235153198242
loss_pred:0.02638865076005459, decouple_loss:0.008577071130275726
loss_pred:0.027148565277457237, decouple_loss:0.00852150097489357
The modified gen p mean: 0.446489542722702, gen p mean: -0.7480906248092651, mean p set: 0.4469698667526245
loss_pred:0.02608095295727253, decouple_loss:0.008427953347563744
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44657102227211, gen p mean: -0.7503026127815247, mean p set: 0.4470512866973877
The modified gen p mean: 0.44800907373428345, gen p mean: -0.751273512840271, mean p set: 0.44848933815956116
loss_pred:0.025638118386268616, decouple_loss:0.008592522703111172
The modified gen p mean: 0.44762372970581055, gen p mean: -0.760567843914032, mean p set: 0.44810402393341064
loss_pred:0.027115538716316223, decouple_loss:0.008691646158695221
loss_pred:0.025648973882198334, decouple_loss:0.009015158750116825
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461670517921448, gen p mean: -0.745877742767334, mean p set: 0.44664737582206726
The modified gen p mean: 0.4479184150695801, gen p mean: -0.7546131014823914, mean p set: 0.44839873909950256
loss_pred:0.027058325707912445, decouple_loss:0.008928060531616211
loss_pred:0.027299100533127785, decouple_loss:0.008645191788673401
The modified gen p mean: 0.44823944568634033, gen p mean: -0.7457607388496399, mean p set: 0.44871973991394043
loss_pred:0.02601812034845352, decouple_loss:0.008749393746256828
Iteration: 440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816285371780396, gen p mean: -0.744982898235321, mean p set: 0.44864311814308167
The modified gen p mean: 0.44692254066467285, gen p mean: -0.7433643341064453, mean p set: 0.44740280508995056
loss_pred:0.026112675666809082, decouple_loss:0.008877037093043327
loss_pred:0.026267461478710175, decouple_loss:0.008725158870220184
The modified gen p mean: 0.44700318574905396, gen p mean: -0.7505589723587036, mean p set: 0.44748347997665405
loss_pred:0.026399556547403336, decouple_loss:0.008822393603622913
2023-05-04 13:10:35 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7450360059738159, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7498436570167542, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.755831241607666, mean p set: 0.4502691626548767
loss_pred:0.025684889405965805, decouple_loss:0.008658595383167267
loss_pred:0.026120616123080254, decouple_loss:0.008686029352247715
loss_pred:0.02709612064063549, decouple_loss:0.009121650829911232
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026741646230220795, avg_mse: 0.032048095017671585
current test mse: 0.032048
Iteration: 441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447463721036911, gen p mean: -0.7417715787887573, mean p set: 0.4479440450668335
The modified gen p mean: 0.448758602142334, gen p mean: -0.7484362721443176, mean p set: 0.4492388963699341
loss_pred:0.02623598650097847, decouple_loss:0.008696637116372585
loss_pred:0.026011835783720016, decouple_loss:0.008531077764928341
The modified gen p mean: 0.44745364785194397, gen p mean: -0.7475833296775818, mean p set: 0.4479339122772217
loss_pred:0.026567069813609123, decouple_loss:0.008609740994870663
Iteration: 442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809165596961975, gen p mean: -0.7460614442825317, mean p set: 0.44857192039489746
The modified gen p mean: 0.4482062757015228, gen p mean: -0.7480719089508057, mean p set: 0.4486865699291229
loss_pred:0.02687637321650982, decouple_loss:0.008203521370887756
loss_pred:0.026058251038193703, decouple_loss:0.00844231154769659
The modified gen p mean: 0.4483226239681244, gen p mean: -0.7487780451774597, mean p set: 0.4488029479980469
loss_pred:0.025323325768113136, decouple_loss:0.008568471297621727
Iteration: 443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470321238040924, gen p mean: -0.749676525592804, mean p set: 0.4475124180316925
loss_pred:0.02623242326080799, decouple_loss:0.008271990343928337
The modified gen p mean: 0.4474121332168579, gen p mean: -0.75431227684021, mean p set: 0.447892427444458
The modified gen p mean: 0.44824522733688354, gen p mean: -0.7555724382400513, mean p set: 0.44872552156448364
loss_pred:0.02709643729031086, decouple_loss:0.00822808314114809
loss_pred:0.027008365839719772, decouple_loss:0.008658288978040218
Iteration: 444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479553699493408, gen p mean: -0.7519813179969788, mean p set: 0.4484356641769409
The modified gen p mean: 0.44811657071113586, gen p mean: -0.7582900524139404, mean p set: 0.4485968351364136
loss_pred:0.026944279670715332, decouple_loss:0.00817931815981865
loss_pred:0.025372734293341637, decouple_loss:0.008508617989718914
The modified gen p mean: 0.44830814003944397, gen p mean: -0.7494805455207825, mean p set: 0.44878846406936646
loss_pred:0.02560918591916561, decouple_loss:0.008232948370277882
Iteration: 445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478548765182495, gen p mean: -0.7438479065895081, mean p set: 0.448335200548172
The modified gen p mean: 0.44783854484558105, gen p mean: -0.74798184633255, mean p set: 0.44831880927085876
loss_pred:0.02489663101732731, decouple_loss:0.00834096223115921
loss_pred:0.026189373806118965, decouple_loss:0.008149875327944756
The modified gen p mean: 0.44853079319000244, gen p mean: -0.7436513304710388, mean p set: 0.4490111172199249
loss_pred:0.02540578693151474, decouple_loss:0.008245800621807575
Iteration: 446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676509499549866, gen p mean: -0.7343074679374695, mean p set: 0.44724538922309875
loss_pred:0.026874279603362083, decouple_loss:0.008129929192364216
The modified gen p mean: 0.4480619728565216, gen p mean: -0.7329626679420471, mean p set: 0.4485422670841217
The modified gen p mean: 0.44879159331321716, gen p mean: -0.7335656881332397, mean p set: 0.44927188754081726
loss_pred:0.025690924376249313, decouple_loss:0.008454501628875732
loss_pred:0.025748319923877716, decouple_loss:0.008396451361477375
Iteration: 447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482143521308899, gen p mean: -0.7367460131645203, mean p set: 0.44869464635849
loss_pred:0.026058683171868324, decouple_loss:0.00828559324145317
The modified gen p mean: 0.447857141494751, gen p mean: -0.7410238981246948, mean p set: 0.4483374059200287
The modified gen p mean: 0.4477875530719757, gen p mean: -0.7371570467948914, mean p set: 0.4482678174972534
loss_pred:0.025153493508696556, decouple_loss:0.008414680138230324
loss_pred:0.026119520887732506, decouple_loss:0.008420988917350769
Iteration: 448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872283935546875, gen p mean: -0.7484257817268372, mean p set: 0.44920313358306885
loss_pred:0.025123104453086853, decouple_loss:0.008693806827068329
The modified gen p mean: 0.44783008098602295, gen p mean: -0.7458561062812805, mean p set: 0.44831034541130066
The modified gen p mean: 0.4474068880081177, gen p mean: -0.7372806668281555, mean p set: 0.4478871822357178
loss_pred:0.026889970526099205, decouple_loss:0.008547077886760235
loss_pred:0.026887115091085434, decouple_loss:0.0080715985968709
Iteration: 449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810548424720764, gen p mean: -0.7482863068580627, mean p set: 0.44858577847480774
The modified gen p mean: 0.44802403450012207, gen p mean: -0.7493077516555786, mean p set: 0.44850432872772217
loss_pred:0.025689825415611267, decouple_loss:0.008230907842516899
loss_pred:0.02528943493962288, decouple_loss:0.008367148227989674
The modified gen p mean: 0.4478135406970978, gen p mean: -0.7444939017295837, mean p set: 0.4482938349246979
loss_pred:0.026180069893598557, decouple_loss:0.008431070484220982
Iteration: 450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481227993965149, gen p mean: -0.7499780654907227, mean p set: 0.448603093624115
The modified gen p mean: 0.44863346219062805, gen p mean: -0.7531805634498596, mean p set: 0.44911372661590576
loss_pred:0.025853773579001427, decouple_loss:0.008233842439949512
loss_pred:0.025408783927559853, decouple_loss:0.007826082408428192
The modified gen p mean: 0.44797733426094055, gen p mean: -0.7399988174438477, mean p set: 0.44845762848854065
loss_pred:0.02505371905863285, decouple_loss:0.008459587581455708
2023-05-04 13:14:08 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7425973415374756, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.752970814704895, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7470892071723938, mean p set: 0.4500633478164673
loss_pred:0.025582874193787575, decouple_loss:0.008189204148948193
loss_pred:0.02686324715614319, decouple_loss:0.008601335808634758
loss_pred:0.02593252994120121, decouple_loss:0.008121737278997898
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026541423052549362, avg_mse: 0.03181204944849014
current test mse: 0.031812
Iteration: 451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478556215763092, gen p mean: -0.7446985244750977, mean p set: 0.4483359158039093
The modified gen p mean: 0.4477509558200836, gen p mean: -0.7434556484222412, mean p set: 0.44823122024536133
loss_pred:0.025647396221756935, decouple_loss:0.007842857390642166
loss_pred:0.026330620050430298, decouple_loss:0.00809517502784729
The modified gen p mean: 0.44733431935310364, gen p mean: -0.7451077699661255, mean p set: 0.44781461358070374
loss_pred:0.02687174826860428, decouple_loss:0.0077508254908025265
Iteration: 452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816482067108154, gen p mean: -0.7504869699478149, mean p set: 0.44864511489868164
loss_pred:0.025691015645861626, decouple_loss:0.00812153797596693
The modified gen p mean: 0.44781047105789185, gen p mean: -0.7457646131515503, mean p set: 0.44829073548316956
The modified gen p mean: 0.4480210542678833, gen p mean: -0.7505984902381897, mean p set: 0.4485013484954834
loss_pred:0.026606997475028038, decouple_loss:0.008096322417259216
loss_pred:0.02579706721007824, decouple_loss:0.008015742525458336
Iteration: 453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482780694961548, gen p mean: -0.7428329586982727, mean p set: 0.4487583637237549
loss_pred:0.026473868638277054, decouple_loss:0.007529404014348984
The modified gen p mean: 0.447913259267807, gen p mean: -0.7493622899055481, mean p set: 0.4483935534954071
The modified gen p mean: 0.4487875998020172, gen p mean: -0.7487838864326477, mean p set: 0.4492678940296173
loss_pred:0.02510717883706093, decouple_loss:0.007956811226904392
loss_pred:0.025199037045240402, decouple_loss:0.007775152567774057
Iteration: 454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822442531585693, gen p mean: -0.744731068611145, mean p set: 0.44870471954345703
The modified gen p mean: 0.44637301564216614, gen p mean: -0.7455992102622986, mean p set: 0.44685330986976624
loss_pred:0.026075130328536034, decouple_loss:0.00781650748103857
loss_pred:0.02616194263100624, decouple_loss:0.008128460496664047
The modified gen p mean: 0.44888073205947876, gen p mean: -0.7568554878234863, mean p set: 0.44936102628707886
loss_pred:0.024980423972010612, decouple_loss:0.0080982381477952
Iteration: 455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715163111686707, gen p mean: -0.7444485425949097, mean p set: 0.4476318955421448
loss_pred:0.026703229174017906, decouple_loss:0.0077547612600028515
The modified gen p mean: 0.4478228688240051, gen p mean: -0.7459508180618286, mean p set: 0.4483031630516052
The modified gen p mean: 0.44752660393714905, gen p mean: -0.751814067363739, mean p set: 0.44800689816474915
loss_pred:0.026271332055330276, decouple_loss:0.00769418990239501
loss_pred:0.025631433352828026, decouple_loss:0.007666615303605795
Iteration: 456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473022222518921, gen p mean: -0.7483450174331665, mean p set: 0.4477825164794922
loss_pred:0.026225415989756584, decouple_loss:0.007733410689979792
The modified gen p mean: 0.4479690194129944, gen p mean: -0.7454022765159607, mean p set: 0.4484493136405945
The modified gen p mean: 0.4484468698501587, gen p mean: -0.7420134544372559, mean p set: 0.4489271342754364
loss_pred:0.025339970365166664, decouple_loss:0.007509589660912752
loss_pred:0.025050794705748558, decouple_loss:0.007713157683610916
Iteration: 457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472324848175049, gen p mean: -0.7436898350715637, mean p set: 0.447712779045105
The modified gen p mean: 0.44890785217285156, gen p mean: -0.7410801649093628, mean p set: 0.44938814640045166
loss_pred:0.02591717429459095, decouple_loss:0.007982642389833927
loss_pred:0.02669852040708065, decouple_loss:0.007836653850972652
The modified gen p mean: 0.44735920429229736, gen p mean: -0.7419644594192505, mean p set: 0.4478394687175751
loss_pred:0.02659939043223858, decouple_loss:0.007677216548472643
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482479691505432, gen p mean: -0.7447654008865356, mean p set: 0.4487282633781433
The modified gen p mean: 0.4484303593635559, gen p mean: -0.7609002590179443, mean p set: 0.4489106833934784
loss_pred:0.025997400283813477, decouple_loss:0.00963642168790102
The modified gen p mean: 0.4469155967235565, gen p mean: -0.749449610710144, mean p set: 0.4473958909511566
loss_pred:0.026058658957481384, decouple_loss:0.007739825174212456
loss_pred:0.025671029463410378, decouple_loss:0.00815153494477272
Iteration: 459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482154846191406, gen p mean: -0.7653360366821289, mean p set: 0.44869574904441833
The modified gen p mean: 0.4471322298049927, gen p mean: -0.7435072064399719, mean p set: 0.4476125240325928
loss_pred:0.026241987943649292, decouple_loss:0.009244424290955067
loss_pred:0.02571222372353077, decouple_loss:0.007721517700701952
The modified gen p mean: 0.4476761221885681, gen p mean: -0.7569939494132996, mean p set: 0.4481564164161682
loss_pred:0.025665411725640297, decouple_loss:0.007831809110939503
Iteration: 460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784075021743774, gen p mean: -0.7631452083587646, mean p set: 0.44832107424736023
loss_pred:0.02645815908908844, decouple_loss:0.008683238178491592
The modified gen p mean: 0.44891947507858276, gen p mean: -0.7698370218276978, mean p set: 0.44939976930618286
The modified gen p mean: 0.4461434781551361, gen p mean: -0.7398657202720642, mean p set: 0.4466237425804138
loss_pred:0.024997185915708542, decouple_loss:0.009463042952120304
loss_pred:0.02519184537231922, decouple_loss:0.008196091279387474
2023-05-04 13:18:22 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7421666979789734, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7473968267440796, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7536278367042542, mean p set: 0.4502691626548767
loss_pred:0.02554725669324398, decouple_loss:0.008266167715191841
loss_pred:0.025981666520237923, decouple_loss:0.0081869475543499
loss_pred:0.026922350749373436, decouple_loss:0.008256962522864342
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02656225860118866, avg_mse: 0.03191386163234711
current test mse: 0.031914
Iteration: 461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807347655296326, gen p mean: -0.7598170638084412, mean p set: 0.4485537111759186
The modified gen p mean: 0.4485395848751068, gen p mean: -0.7451021671295166, mean p set: 0.4490198791027069
loss_pred:0.026988716796040535, decouple_loss:0.009083433076739311
loss_pred:0.02603897638618946, decouple_loss:0.007859781384468079
The modified gen p mean: 0.4500880539417267, gen p mean: -0.7579600214958191, mean p set: 0.4505683481693268
loss_pred:0.02475563809275627, decouple_loss:0.007839974015951157
Iteration: 462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468289911746979, gen p mean: -0.7432955503463745, mean p set: 0.447309285402298
The modified gen p mean: 0.44856446981430054, gen p mean: -0.7400315403938293, mean p set: 0.44904476404190063
loss_pred:0.02486267499625683, decouple_loss:0.00787065178155899
loss_pred:0.025932257995009422, decouple_loss:0.007771978620439768
The modified gen p mean: 0.4482189118862152, gen p mean: -0.7615023255348206, mean p set: 0.4486992359161377
loss_pred:0.02608335018157959, decouple_loss:0.008707377128303051
Iteration: 463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823968410491943, gen p mean: -0.7501993775367737, mean p set: 0.44871997833251953
The modified gen p mean: 0.4477846324443817, gen p mean: -0.752472460269928, mean p set: 0.4482649564743042
loss_pred:0.025024471804499626, decouple_loss:0.007858894765377045
The modified gen p mean: 0.4483945369720459, gen p mean: -0.7630887627601624, mean p set: 0.4488748610019684
loss_pred:0.025736480951309204, decouple_loss:0.008027784526348114
loss_pred:0.025902867317199707, decouple_loss:0.008512591011822224
Iteration: 464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492430090904236, gen p mean: -0.769008457660675, mean p set: 0.4497232735157013
The modified gen p mean: 0.4475904703140259, gen p mean: -0.7592823505401611, mean p set: 0.4480707347393036
loss_pred:0.02467966079711914, decouple_loss:0.008164932020008564
loss_pred:0.02642839401960373, decouple_loss:0.008446738123893738
The modified gen p mean: 0.44771867990493774, gen p mean: -0.7599654197692871, mean p set: 0.44819900393486023
loss_pred:0.025375546887516975, decouple_loss:0.007828600704669952
Iteration: 465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45016229152679443, gen p mean: -0.7719231843948364, mean p set: 0.4506426155567169
loss_pred:0.02429850772023201, decouple_loss:0.008954392746090889
The modified gen p mean: 0.448035329580307, gen p mean: -0.7608607411384583, mean p set: 0.4485156238079071
The modified gen p mean: 0.44588345289230347, gen p mean: -0.7465829849243164, mean p set: 0.44636374711990356
loss_pred:0.024843456223607063, decouple_loss:0.008209404535591602
loss_pred:0.025079555809497833, decouple_loss:0.008249513804912567
Iteration: 466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812512397766113, gen p mean: -0.7551680207252502, mean p set: 0.44860541820526123
loss_pred:0.026216240599751472, decouple_loss:0.007738464046269655
The modified gen p mean: 0.446414589881897, gen p mean: -0.7493010759353638, mean p set: 0.4468948543071747
The modified gen p mean: 0.44881510734558105, gen p mean: -0.7717708349227905, mean p set: 0.44929543137550354
loss_pred:0.024678442627191544, decouple_loss:0.00790521502494812
loss_pred:0.025495585054159164, decouple_loss:0.008246849291026592
Iteration: 467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495560824871063, gen p mean: -0.7608451843261719, mean p set: 0.4500364065170288
loss_pred:0.024709485471248627, decouple_loss:0.007623662240803242
The modified gen p mean: 0.4466460347175598, gen p mean: -0.7539718151092529, mean p set: 0.4471263289451599
The modified gen p mean: 0.44700509309768677, gen p mean: -0.7555915713310242, mean p set: 0.4474853575229645
loss_pred:0.02500160224735737, decouple_loss:0.007566353771835566
loss_pred:0.024556951597332954, decouple_loss:0.007584366947412491
Iteration: 468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904136657714844, gen p mean: -0.7593683004379272, mean p set: 0.44952166080474854
The modified gen p mean: 0.44795140624046326, gen p mean: -0.7467882633209229, mean p set: 0.44843170046806335
loss_pred:0.02523161843419075, decouple_loss:0.007888254709541798
loss_pred:0.02472470887005329, decouple_loss:0.007534696254879236
The modified gen p mean: 0.44762858748435974, gen p mean: -0.7591726183891296, mean p set: 0.4481089115142822
loss_pred:0.026182200759649277, decouple_loss:0.00823269784450531
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466298222541809, gen p mean: -0.749001145362854, mean p set: 0.447110116481781
The modified gen p mean: 0.4483628273010254, gen p mean: -0.7644763588905334, mean p set: 0.4488431215286255
loss_pred:0.026567135006189346, decouple_loss:0.007954727858304977
loss_pred:0.02507530152797699, decouple_loss:0.007732137572020292
The modified gen p mean: 0.44852304458618164, gen p mean: -0.7532920837402344, mean p set: 0.44900330901145935
loss_pred:0.0249645933508873, decouple_loss:0.007365706842392683
Iteration: 470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44970178604125977, gen p mean: -0.7646563053131104, mean p set: 0.45018208026885986
The modified gen p mean: 0.4474222660064697, gen p mean: -0.7588844895362854, mean p set: 0.4479025602340698
loss_pred:0.023927124217152596, decouple_loss:0.0073500750586390495
loss_pred:0.025225192308425903, decouple_loss:0.007388186641037464
The modified gen p mean: 0.4477677047252655, gen p mean: -0.7614651918411255, mean p set: 0.4482479691505432
loss_pred:0.02580060064792633, decouple_loss:0.007718667853623629
2023-05-04 13:22:03 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7489324808120728, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7594918608665466, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7532676458358765, mean p set: 0.4500633478164673
loss_pred:0.025498859584331512, decouple_loss:0.007902642711997032
loss_pred:0.026773979887366295, decouple_loss:0.007978771813213825
loss_pred:0.025829948484897614, decouple_loss:0.007856589742004871
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02642989717423916, avg_mse: 0.03171414136886597
current test mse: 0.031714
Iteration: 471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800320267677307, gen p mean: -0.7539451122283936, mean p set: 0.4484834671020508
The modified gen p mean: 0.4470553696155548, gen p mean: -0.7590925693511963, mean p set: 0.4475356340408325
loss_pred:0.025407230481505394, decouple_loss:0.007459510117769241
loss_pred:0.025312401354312897, decouple_loss:0.0075680953450500965
The modified gen p mean: 0.4468555450439453, gen p mean: -0.7597775459289551, mean p set: 0.4473358392715454
loss_pred:0.025075044482946396, decouple_loss:0.0075486465357244015
Iteration: 472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716453552246094, gen p mean: -0.7644972801208496, mean p set: 0.4476448595523834
The modified gen p mean: 0.4478377103805542, gen p mean: -0.7671759128570557, mean p set: 0.4483180344104767
loss_pred:0.025932973250746727, decouple_loss:0.007405981887131929
loss_pred:0.026355812326073647, decouple_loss:0.008060308173298836
The modified gen p mean: 0.44918563961982727, gen p mean: -0.7620345950126648, mean p set: 0.449665904045105
loss_pred:0.02417735569179058, decouple_loss:0.007140480447560549
Iteration: 473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475768804550171, gen p mean: -0.7645730376243591, mean p set: 0.4480571746826172
loss_pred:0.02586117573082447, decouple_loss:0.007447169627994299
The modified gen p mean: 0.447710245847702, gen p mean: -0.7661667466163635, mean p set: 0.4481905400753021
The modified gen p mean: 0.44678202271461487, gen p mean: -0.7610992193222046, mean p set: 0.44726231694221497
loss_pred:0.025874540209770203, decouple_loss:0.007592064794152975
loss_pred:0.027126969769597054, decouple_loss:0.007956522516906261
Iteration: 474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479919970035553, gen p mean: -0.7774964570999146, mean p set: 0.448472261428833
loss_pred:0.0246749110519886, decouple_loss:0.0074936882592737675
The modified gen p mean: 0.44753527641296387, gen p mean: -0.7669644355773926, mean p set: 0.4480155408382416
The modified gen p mean: 0.44702866673469543, gen p mean: -0.7671566009521484, mean p set: 0.44750893115997314
loss_pred:0.027051232755184174, decouple_loss:0.00794972199946642
loss_pred:0.02531532570719719, decouple_loss:0.007424810901284218
Iteration: 475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472527801990509, gen p mean: -0.7640625834465027, mean p set: 0.4477330446243286
The modified gen p mean: 0.44707077741622925, gen p mean: -0.7735834717750549, mean p set: 0.44755110144615173
loss_pred:0.025349395349621773, decouple_loss:0.007532917428761721
loss_pred:0.026100652292370796, decouple_loss:0.007461015600711107
The modified gen p mean: 0.44793441891670227, gen p mean: -0.7684918642044067, mean p set: 0.44841471314430237
loss_pred:0.026394711807370186, decouple_loss:0.007344926241785288
Iteration: 476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44617778062820435, gen p mean: -0.7547841668128967, mean p set: 0.44665804505348206
The modified gen p mean: 0.4480890929698944, gen p mean: -0.7610211372375488, mean p set: 0.4485693573951721
loss_pred:0.02526061423122883, decouple_loss:0.007964788004755974
loss_pred:0.024477839469909668, decouple_loss:0.007661707699298859
The modified gen p mean: 0.4468880295753479, gen p mean: -0.7634179592132568, mean p set: 0.447368323802948
loss_pred:0.025893868878483772, decouple_loss:0.0077012041583657265
Iteration: 477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474042057991028, gen p mean: -0.7519091367721558, mean p set: 0.4478845000267029
The modified gen p mean: 0.4482412040233612, gen p mean: -0.7613905668258667, mean p set: 0.4487214982509613
loss_pred:0.02488040179014206, decouple_loss:0.007436705753207207
loss_pred:0.02549910917878151, decouple_loss:0.007410278543829918
The modified gen p mean: 0.4494439363479614, gen p mean: -0.7711272835731506, mean p set: 0.4499242305755615
loss_pred:0.024551890790462494, decouple_loss:0.008240464143455029
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448636531829834, gen p mean: -0.743033230304718, mean p set: 0.4491168260574341
The modified gen p mean: 0.4481053054332733, gen p mean: -0.7411789298057556, mean p set: 0.4485855996608734
loss_pred:0.026271380484104156, decouple_loss:0.008605403825640678
The modified gen p mean: 0.4482541084289551, gen p mean: -0.7430619597434998, mean p set: 0.4487343728542328
loss_pred:0.026679586619138718, decouple_loss:0.008763328194618225
loss_pred:0.026805555447936058, decouple_loss:0.008147848770022392
Iteration: 479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483461380004883, gen p mean: -0.7523196339607239, mean p set: 0.4488264322280884
The modified gen p mean: 0.4482864737510681, gen p mean: -0.7505714297294617, mean p set: 0.4487667679786682
loss_pred:0.02505960874259472, decouple_loss:0.008028799667954445
loss_pred:0.025457723066210747, decouple_loss:0.00782880000770092
The modified gen p mean: 0.44850486516952515, gen p mean: -0.7449617385864258, mean p set: 0.44898515939712524
loss_pred:0.02538473531603813, decouple_loss:0.00817447155714035
Iteration: 480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463944733142853, gen p mean: -0.7475160956382751, mean p set: 0.4468747675418854
The modified gen p mean: 0.447777658700943, gen p mean: -0.7547792792320251, mean p set: 0.4482579529285431
loss_pred:0.025841502472758293, decouple_loss:0.007951881736516953
The modified gen p mean: 0.44756534695625305, gen p mean: -0.7497482299804688, mean p set: 0.44804564118385315
loss_pred:0.02582140453159809, decouple_loss:0.008453631773591042
loss_pred:0.025577949360013008, decouple_loss:0.008091902360320091
2023-05-04 13:26:25 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7515515089035034, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7641111016273499, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7568683624267578, mean p set: 0.4500633478164673
loss_pred:0.02553851157426834, decouple_loss:0.007989657111465931
loss_pred:0.026879141107201576, decouple_loss:0.00824928842484951
loss_pred:0.02592543698847294, decouple_loss:0.008033035323023796
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026518896222114563, avg_mse: 0.03184131532907486
current test mse: 0.031841
Iteration: 481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487621486186981, gen p mean: -0.7513785362243652, mean p set: 0.4492424428462982
The modified gen p mean: 0.4465106725692749, gen p mean: -0.7492825984954834, mean p set: 0.446990966796875
loss_pred:0.025359945371747017, decouple_loss:0.007919969037175179
loss_pred:0.025288864970207214, decouple_loss:0.008083602413535118
The modified gen p mean: 0.44788697361946106, gen p mean: -0.7553187012672424, mean p set: 0.44836726784706116
loss_pred:0.024807751178741455, decouple_loss:0.008006504736840725
Iteration: 482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478696584701538, gen p mean: -0.7597683072090149, mean p set: 0.4483499228954315
loss_pred:0.02502070739865303, decouple_loss:0.00814742874354124
The modified gen p mean: 0.44962185621261597, gen p mean: -0.7554898858070374, mean p set: 0.4501021206378937
The modified gen p mean: 0.4484059512615204, gen p mean: -0.7582104802131653, mean p set: 0.4488862454891205
loss_pred:0.025375772267580032, decouple_loss:0.008202462457120419
loss_pred:0.02621379680931568, decouple_loss:0.00793742761015892
Iteration: 483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831424951553345, gen p mean: -0.7536314129829407, mean p set: 0.44879457354545593
The modified gen p mean: 0.44796428084373474, gen p mean: -0.7549253106117249, mean p set: 0.44844454526901245
loss_pred:0.02558400109410286, decouple_loss:0.00802393164485693
loss_pred:0.025073764845728874, decouple_loss:0.008200745098292828
The modified gen p mean: 0.44935524463653564, gen p mean: -0.7483776807785034, mean p set: 0.44983553886413574
loss_pred:0.025501014664769173, decouple_loss:0.008036866784095764
Iteration: 484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480462074279785, gen p mean: -0.7495951056480408, mean p set: 0.4485265016555786
The modified gen p mean: 0.44748514890670776, gen p mean: -0.75147944688797, mean p set: 0.44796544313430786
loss_pred:0.02480352856218815, decouple_loss:0.008041036315262318
loss_pred:0.025721317157149315, decouple_loss:0.007960116490721703
The modified gen p mean: 0.4483340084552765, gen p mean: -0.7549740076065063, mean p set: 0.4488143026828766
loss_pred:0.025353899225592613, decouple_loss:0.008047513663768768
Iteration: 485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487915635108948, gen p mean: -0.7505994439125061, mean p set: 0.4492718279361725
The modified gen p mean: 0.4483553469181061, gen p mean: -0.7511740326881409, mean p set: 0.44883567094802856
loss_pred:0.02560993656516075, decouple_loss:0.008260838687419891
loss_pred:0.026402955874800682, decouple_loss:0.00794603768736124
The modified gen p mean: 0.44923385977745056, gen p mean: -0.7544553279876709, mean p set: 0.44971415400505066
loss_pred:0.026134265586733818, decouple_loss:0.008567125536501408
Iteration: 486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828712940216064, gen p mean: -0.7456367611885071, mean p set: 0.44876742362976074
loss_pred:0.026097066700458527, decouple_loss:0.008284487761557102
The modified gen p mean: 0.4470710754394531, gen p mean: -0.7464183568954468, mean p set: 0.44755133986473083
The modified gen p mean: 0.45018258690834045, gen p mean: -0.747426450252533, mean p set: 0.45066288113594055
loss_pred:0.024700142443180084, decouple_loss:0.008029162883758545
loss_pred:0.02596604824066162, decouple_loss:0.007878967560827732
Iteration: 487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810235500335693, gen p mean: -0.7526229619979858, mean p set: 0.4485826790332794
The modified gen p mean: 0.4467921853065491, gen p mean: -0.7484146952629089, mean p set: 0.4472724497318268
loss_pred:0.025581376627087593, decouple_loss:0.0077049569226801395
loss_pred:0.025773674249649048, decouple_loss:0.007945915684103966
The modified gen p mean: 0.44865861535072327, gen p mean: -0.743184506893158, mean p set: 0.44913890957832336
loss_pred:0.02510363981127739, decouple_loss:0.007878195494413376
Iteration: 488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465603828430176, gen p mean: -0.7489743232727051, mean p set: 0.44704070687294006
The modified gen p mean: 0.4481866657733917, gen p mean: -0.7608239054679871, mean p set: 0.44866693019866943
loss_pred:0.0249320138245821, decouple_loss:0.00835731066763401
loss_pred:0.025497036054730415, decouple_loss:0.007879865355789661
The modified gen p mean: 0.4475911557674408, gen p mean: -0.7548168897628784, mean p set: 0.4480714499950409
loss_pred:0.024513810873031616, decouple_loss:0.007920128293335438
Iteration: 489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508858025074005, gen p mean: -0.750957727432251, mean p set: 0.4513660967350006
The modified gen p mean: 0.44871821999549866, gen p mean: -0.7527538537979126, mean p set: 0.44919851422309875
loss_pred:0.025962648913264275, decouple_loss:0.007771790027618408
loss_pred:0.025869233533740044, decouple_loss:0.007947556674480438
The modified gen p mean: 0.44732072949409485, gen p mean: -0.7483031749725342, mean p set: 0.44780102372169495
loss_pred:0.02590511180460453, decouple_loss:0.007930182851850986
Iteration: 490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44615504145622253, gen p mean: -0.7385182976722717, mean p set: 0.44663533568382263
loss_pred:0.025444395840168, decouple_loss:0.007686575874686241
The modified gen p mean: 0.448758602142334, gen p mean: -0.7458077073097229, mean p set: 0.4492388665676117
The modified gen p mean: 0.4479285478591919, gen p mean: -0.7447043061256409, mean p set: 0.448408842086792
loss_pred:0.02489416114985943, decouple_loss:0.0076576462015509605
loss_pred:0.02589430660009384, decouple_loss:0.007872008718550205
2023-05-04 13:30:01 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7369729280471802, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7481404542922974, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7418485879898071, mean p set: 0.4500633478164673
loss_pred:0.025654518976807594, decouple_loss:0.007980159483850002
loss_pred:0.027021724730730057, decouple_loss:0.008372052572667599
loss_pred:0.026002753525972366, decouple_loss:0.00808471255004406
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026633616536855698, avg_mse: 0.032037265598773956
current test mse: 0.032037
Iteration: 491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490843415260315, gen p mean: -0.7405537962913513, mean p set: 0.4495646357536316
The modified gen p mean: 0.44837528467178345, gen p mean: -0.7415587902069092, mean p set: 0.44885557889938354
loss_pred:0.025613369420170784, decouple_loss:0.007869457826018333
loss_pred:0.025510618463158607, decouple_loss:0.007722238078713417
The modified gen p mean: 0.44872066378593445, gen p mean: -0.7426946759223938, mean p set: 0.44920095801353455
loss_pred:0.025636116042733192, decouple_loss:0.007669688668102026
Iteration: 492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481760263442993, gen p mean: -0.7427430152893066, mean p set: 0.4486563205718994
loss_pred:0.025348583236336708, decouple_loss:0.007828171364963055
The modified gen p mean: 0.44806262850761414, gen p mean: -0.7457733750343323, mean p set: 0.44854292273521423
The modified gen p mean: 0.4487471878528595, gen p mean: -0.7417662143707275, mean p set: 0.4492274820804596
loss_pred:0.025263849645853043, decouple_loss:0.007825048640370369
loss_pred:0.02552785538136959, decouple_loss:0.00786583311855793
Iteration: 493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476674795150757, gen p mean: -0.741111159324646, mean p set: 0.4481477439403534
The modified gen p mean: 0.447750449180603, gen p mean: -0.7437035441398621, mean p set: 0.4482307732105255loss_pred:0.02615228295326233, decouple_loss:0.007713894359767437
The modified gen p mean: 0.44847527146339417, gen p mean: -0.7436923384666443, mean p set: 0.44895556569099426
loss_pred:0.024827683344483376, decouple_loss:0.007571074645966291
loss_pred:0.026211479678750038, decouple_loss:0.007687164470553398
Iteration: 494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477931559085846, gen p mean: -0.7398874759674072, mean p set: 0.4482734203338623
The modified gen p mean: 0.4475422203540802, gen p mean: -0.7409546971321106, mean p set: 0.4480225145816803
loss_pred:0.024834664538502693, decouple_loss:0.007736541330814362
loss_pred:0.02589832805097103, decouple_loss:0.007724130991846323
The modified gen p mean: 0.4488387405872345, gen p mean: -0.743062436580658, mean p set: 0.449319064617157
loss_pred:0.025842325761914253, decouple_loss:0.0076467785984277725
Iteration: 495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486162066459656, gen p mean: -0.7406114935874939, mean p set: 0.4490965008735657
The modified gen p mean: 0.4482608735561371, gen p mean: -0.7453587055206299, mean p set: 0.4487411379814148
loss_pred:0.02613481506705284, decouple_loss:0.008095543831586838
loss_pred:0.02457345649600029, decouple_loss:0.008037548512220383
The modified gen p mean: 0.44782358407974243, gen p mean: -0.7399051785469055, mean p set: 0.44830387830734253
loss_pred:0.026325648650527, decouple_loss:0.00790275726467371
Iteration: 496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473828375339508, gen p mean: -0.7403491735458374, mean p set: 0.4478631317615509
The modified gen p mean: 0.44761234521865845, gen p mean: -0.7396407127380371, mean p set: 0.44809263944625854
loss_pred:0.025172783061861992, decouple_loss:0.007485847920179367
loss_pred:0.025579094886779785, decouple_loss:0.007732518017292023
The modified gen p mean: 0.44648703932762146, gen p mean: -0.7381212711334229, mean p set: 0.44696733355522156
loss_pred:0.024810096248984337, decouple_loss:0.007777281571179628
Iteration: 497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502047896385193, gen p mean: -0.737939715385437, mean p set: 0.450685054063797
The modified gen p mean: 0.44940853118896484, gen p mean: -0.7374566793441772, mean p set: 0.44988885521888733
loss_pred:0.025862855836749077, decouple_loss:0.00774178234860301
loss_pred:0.026037326082587242, decouple_loss:0.007558615878224373
The modified gen p mean: 0.44727644324302673, gen p mean: -0.7380199432373047, mean p set: 0.44775673747062683
loss_pred:0.024924159049987793, decouple_loss:0.007680507376790047
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483235776424408, gen p mean: -0.738944411277771, mean p set: 0.4488038718700409
The modified gen p mean: 0.4479582905769348, gen p mean: -0.7323254346847534, mean p set: 0.4484385848045349
loss_pred:0.0250963494181633, decouple_loss:0.00793987512588501
The modified gen p mean: 0.44755682349205017, gen p mean: -0.7363384962081909, mean p set: 0.44803711771965027
loss_pred:0.024902692064642906, decouple_loss:0.007961984723806381
loss_pred:0.026502564549446106, decouple_loss:0.008303781971335411
Iteration: 499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763848185539246, gen p mean: -0.7384182214736938, mean p set: 0.44811877608299255
loss_pred:0.025232218205928802, decouple_loss:0.007727399468421936
The modified gen p mean: 0.4483779966831207, gen p mean: -0.7391915321350098, mean p set: 0.4488582909107208
The modified gen p mean: 0.44768163561820984, gen p mean: -0.7326300144195557, mean p set: 0.44816192984580994
loss_pred:0.025814520195126534, decouple_loss:0.007632798049598932
loss_pred:0.025220070034265518, decouple_loss:0.007958229631185532
Iteration: 500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872990250587463, gen p mean: -0.7468065023422241, mean p set: 0.44921019673347473
The modified gen p mean: 0.4485977590084076, gen p mean: -0.7420397400856018, mean p set: 0.4490780532360077
loss_pred:0.024773139506578445, decouple_loss:0.007909033447504044
loss_pred:0.025718115270137787, decouple_loss:0.007502216380089521The modified gen p mean: 0.448378324508667, gen p mean: -0.738900363445282, mean p set: 0.4488586187362671
loss_pred:0.025461073964834213, decouple_loss:0.007586121093481779
2023-05-04 13:34:16 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7344053983688354, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888386249542, gen p mean: -0.7446941137313843, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7387231588363647, mean p set: 0.4500633478164673
loss_pred:0.025844663381576538, decouple_loss:0.008006474003195763
loss_pred:0.02716347947716713, decouple_loss:0.008040444925427437
loss_pred:0.026067793369293213, decouple_loss:0.007921344600617886
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026758117601275444, avg_mse: 0.032150592654943466
current test mse: 0.032151
Iteration: 501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481548070907593, gen p mean: -0.7351124286651611, mean p set: 0.4486351013183594
The modified gen p mean: 0.4483889937400818, gen p mean: -0.7405006289482117, mean p set: 0.4488692879676819
loss_pred:0.025496691465377808, decouple_loss:0.007842518389225006
loss_pred:0.025805290788412094, decouple_loss:0.007700204383581877
The modified gen p mean: 0.44750353693962097, gen p mean: -0.7336392402648926, mean p set: 0.44798383116722107
loss_pred:0.027222907170653343, decouple_loss:0.008073844946920872
Iteration: 502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481067955493927, gen p mean: -0.7419103980064392, mean p set: 0.4485870599746704
The modified gen p mean: 0.44762122631073, gen p mean: -0.7343481779098511, mean p set: 0.4481014907360077
loss_pred:0.024606255814433098, decouple_loss:0.007825113832950592
loss_pred:0.02559937909245491, decouple_loss:0.008250929415225983
The modified gen p mean: 0.44736239314079285, gen p mean: -0.73465496301651, mean p set: 0.44784268736839294
loss_pred:0.027268216013908386, decouple_loss:0.007728074211627245
Iteration: 503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480278789997101, gen p mean: -0.7362726926803589, mean p set: 0.4485081434249878
The modified gen p mean: 0.44736185669898987, gen p mean: -0.7318800091743469, mean p set: 0.44784215092658997
loss_pred:0.026569295674562454, decouple_loss:0.008001795038580894
loss_pred:0.025733334943652153, decouple_loss:0.008566739037632942The modified gen p mean: 0.44849923253059387, gen p mean: -0.7389726042747498, mean p set: 0.4489794969558716
loss_pred:0.02571268379688263, decouple_loss:0.007986755110323429
Iteration: 504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493151009082794, gen p mean: -0.7450361847877502, mean p set: 0.4497953951358795
The modified gen p mean: 0.447090744972229, gen p mean: -0.7404675483703613, mean p set: 0.4475710391998291
loss_pred:0.025901269167661667, decouple_loss:0.00796634703874588
loss_pred:0.025023093447089195, decouple_loss:0.0075000920332968235
The modified gen p mean: 0.44711458683013916, gen p mean: -0.7429798245429993, mean p set: 0.44759488105773926
loss_pred:0.02617906592786312, decouple_loss:0.00775167578831315
Iteration: 505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484996795654297, gen p mean: -0.7550770044326782, mean p set: 0.4489799737930298
loss_pred:0.025438763201236725, decouple_loss:0.007563150953501463
The modified gen p mean: 0.449061781167984, gen p mean: -0.7540600895881653, mean p set: 0.4495420455932617
The modified gen p mean: 0.4482242166996002, gen p mean: -0.7494696378707886, mean p set: 0.4487045109272003
loss_pred:0.025261422619223595, decouple_loss:0.00789753720164299
loss_pred:0.025573499500751495, decouple_loss:0.007765850052237511
Iteration: 506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812268018722534, gen p mean: -0.7497442364692688, mean p set: 0.44860297441482544
The modified gen p mean: 0.4472711682319641, gen p mean: -0.7497545480728149, mean p set: 0.4477514326572418
loss_pred:0.02474820241332054, decouple_loss:0.007554671261459589
The modified gen p mean: 0.44796130061149597, gen p mean: -0.7477060556411743, mean p set: 0.44844159483909607
loss_pred:0.02623634785413742, decouple_loss:0.007798728067427874
loss_pred:0.024994395673274994, decouple_loss:0.007495104800909758
Iteration: 507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715479016304016, gen p mean: -0.746468722820282, mean p set: 0.44763508439064026
The modified gen p mean: 0.44938555359840393, gen p mean: -0.7520003914833069, mean p set: 0.4498658776283264
loss_pred:0.025362463667988777, decouple_loss:0.0075295232236385345
loss_pred:0.025645840913057327, decouple_loss:0.008059568703174591The modified gen p mean: 0.4481460750102997, gen p mean: -0.7479662299156189, mean p set: 0.4486263692378998
loss_pred:0.025938834995031357, decouple_loss:0.007613369729369879
Iteration: 508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812414050102234, gen p mean: -0.7500299215316772, mean p set: 0.4486044645309448
loss_pred:0.024760505184531212, decouple_loss:0.007587551139295101
The modified gen p mean: 0.44729697704315186, gen p mean: -0.7530324459075928, mean p set: 0.44777724146842957
The modified gen p mean: 0.4490264058113098, gen p mean: -0.7526201605796814, mean p set: 0.4495067000389099
loss_pred:0.02650252729654312, decouple_loss:0.007653922773897648
loss_pred:0.024515269324183464, decouple_loss:0.007917535491287708
Iteration: 509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777804613113403, gen p mean: -0.7546753883361816, mean p set: 0.44825834035873413
loss_pred:0.025340041145682335, decouple_loss:0.00759546086192131
The modified gen p mean: 0.4477725327014923, gen p mean: -0.7544811964035034, mean p set: 0.4482528567314148
The modified gen p mean: 0.44764864444732666, gen p mean: -0.7467949986457825, mean p set: 0.44812890887260437
loss_pred:0.024668272584676743, decouple_loss:0.007316300179809332
loss_pred:0.025966938585042953, decouple_loss:0.007829823531210423
Iteration: 510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730043411254883, gen p mean: -0.7558050751686096, mean p set: 0.4477807283401489
loss_pred:0.02584512159228325, decouple_loss:0.007450706325471401
The modified gen p mean: 0.4477311372756958, gen p mean: -0.7543796300888062, mean p set: 0.4482114315032959
The modified gen p mean: 0.44745561480522156, gen p mean: -0.7473649978637695, mean p set: 0.44793590903282166
loss_pred:0.02498987317085266, decouple_loss:0.00748373894020915
loss_pred:0.02577878162264824, decouple_loss:0.007653958164155483
2023-05-04 13:37:52 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7475676536560059, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7524216771125793, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7586053609848022, mean p set: 0.4502691626548767
loss_pred:0.02545722760260105, decouple_loss:0.007478681392967701
loss_pred:0.025776974856853485, decouple_loss:0.007579616270959377
loss_pred:0.026757381856441498, decouple_loss:0.007877947762608528
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02637946605682373, avg_mse: 0.031664326786994934
current test mse: 0.031664
Iteration: 511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483753740787506, gen p mean: -0.7448804974555969, mean p set: 0.4488556683063507
The modified gen p mean: 0.448429673910141, gen p mean: -0.7508891224861145, mean p set: 0.4489099383354187
loss_pred:0.025824351236224174, decouple_loss:0.007233126554638147
loss_pred:0.024767320603132248, decouple_loss:0.00732576334849
The modified gen p mean: 0.4473142623901367, gen p mean: -0.7394078373908997, mean p set: 0.4477945566177368
loss_pred:0.026266958564519882, decouple_loss:0.007541034836322069
Iteration: 512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808003306388855, gen p mean: -0.7427651286125183, mean p set: 0.44856035709381104
The modified gen p mean: 0.44723644852638245, gen p mean: -0.7375018000602722, mean p set: 0.44771671295166016
loss_pred:0.025411728769540787, decouple_loss:0.007837174460291862
loss_pred:0.026630206033587456, decouple_loss:0.007456531748175621
The modified gen p mean: 0.4479518532752991, gen p mean: -0.7538037896156311, mean p set: 0.44843214750289917
loss_pred:0.02486104518175125, decouple_loss:0.007451354991644621
Iteration: 513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877690076828003, gen p mean: -0.740105390548706, mean p set: 0.4492571949958801
loss_pred:0.025374174118041992, decouple_loss:0.007865026593208313
The modified gen p mean: 0.4474526643753052, gen p mean: -0.7417516112327576, mean p set: 0.4479329288005829
The modified gen p mean: 0.4486527442932129, gen p mean: -0.7438052296638489, mean p set: 0.449133038520813
loss_pred:0.02476038597524166, decouple_loss:0.0071677821688354015
loss_pred:0.025318564847111702, decouple_loss:0.00729701342061162
Iteration: 514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44693225622177124, gen p mean: -0.734971284866333, mean p set: 0.4474125802516937
loss_pred:0.0249788835644722, decouple_loss:0.007217494770884514
The modified gen p mean: 0.4474695920944214, gen p mean: -0.7341349720954895, mean p set: 0.4479498863220215
The modified gen p mean: 0.44834771752357483, gen p mean: -0.7431115508079529, mean p set: 0.4488280117511749
loss_pred:0.024831289425492287, decouple_loss:0.007231115363538265
loss_pred:0.025163350626826286, decouple_loss:0.007103392388671637
Iteration: 515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44857344031333923, gen p mean: -0.7441387176513672, mean p set: 0.44905373454093933
The modified gen p mean: 0.4480270743370056, gen p mean: -0.7481337189674377, mean p set: 0.4485073983669281
loss_pred:0.026158034801483154, decouple_loss:0.007444452494382858
loss_pred:0.025259356945753098, decouple_loss:0.007399751339107752
The modified gen p mean: 0.4475186765193939, gen p mean: -0.7408279776573181, mean p set: 0.4479990005493164
loss_pred:0.024452880024909973, decouple_loss:0.007058936636894941
Iteration: 516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728949666023254, gen p mean: -0.7482765316963196, mean p set: 0.44776979088783264
The modified gen p mean: 0.446613073348999, gen p mean: -0.7463610172271729, mean p set: 0.4470933675765991
loss_pred:0.024789629504084587, decouple_loss:0.0070426189340651035
loss_pred:0.025263065472245216, decouple_loss:0.007290814537554979
The modified gen p mean: 0.44846057891845703, gen p mean: -0.7507889866828918, mean p set: 0.44894084334373474
loss_pred:0.024929244071245193, decouple_loss:0.007168987765908241
Iteration: 517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817668199539185, gen p mean: -0.7433887720108032, mean p set: 0.44865697622299194
loss_pred:0.02575722709298134, decouple_loss:0.007287941873073578
The modified gen p mean: 0.44725486636161804, gen p mean: -0.7367603778839111, mean p set: 0.44773516058921814
The modified gen p mean: 0.4485163986682892, gen p mean: -0.7451791167259216, mean p set: 0.4489966928958893
loss_pred:0.0261051245033741, decouple_loss:0.007203132379800081
loss_pred:0.026229124516248703, decouple_loss:0.0069915903732180595
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
NaN value num: 0
Iteration: 518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44944626092910767, gen p mean: -0.753018319606781, mean p set: 0.44992655515670776
The modified gen p mean: 0.45029667019844055, gen p mean: -0.7516264319419861, mean p set: 0.45077693462371826
loss_pred:0.024824919179081917, decouple_loss:0.008217194117605686
The modified gen p mean: 0.4503312408924103, gen p mean: -0.7521694302558899, mean p set: 0.4508115351200104
loss_pred:0.02626287192106247, decouple_loss:0.008430201560258865
loss_pred:0.025274382904171944, decouple_loss:0.008354186080396175
Iteration: 519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107388496398926, gen p mean: -0.7551434636116028, mean p set: 0.45155417919158936
The modified gen p mean: 0.4517829120159149, gen p mean: -0.7579337358474731, mean p set: 0.452263206243515
loss_pred:0.026356766000390053, decouple_loss:0.008859887719154358
loss_pred:0.02518586628139019, decouple_loss:0.008175715804100037
The modified gen p mean: 0.4530012607574463, gen p mean: -0.7602911591529846, mean p set: 0.453481525182724
loss_pred:0.02471276931464672, decouple_loss:0.008188227191567421
Iteration: 520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45153576135635376, gen p mean: -0.7488209009170532, mean p set: 0.45201605558395386
loss_pred:0.025767739862203598, decouple_loss:0.008818699046969414
The modified gen p mean: 0.45306816697120667, gen p mean: -0.7593945860862732, mean p set: 0.45354846119880676
The modified gen p mean: 0.45014965534210205, gen p mean: -0.7530659437179565, mean p set: 0.45062994956970215
loss_pred:0.024308230727910995, decouple_loss:0.008028561249375343
loss_pred:0.026331324130296707, decouple_loss:0.008717861957848072
2023-05-04 13:42:02 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7468137145042419, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7513264417648315, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7575057744979858, mean p set: 0.4502691626548767
loss_pred:0.02555938996374607, decouple_loss:0.008361916989088058
loss_pred:0.025907909497618675, decouple_loss:0.008328956551849842
loss_pred:0.026932474225759506, decouple_loss:0.008622592315077782
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026555150747299194, avg_mse: 0.0319906584918499
current test mse: 0.031991
Iteration: 521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45241332054138184, gen p mean: -0.7571678757667542, mean p set: 0.45289358496665955
The modified gen p mean: 0.4523983597755432, gen p mean: -0.7536340951919556, mean p set: 0.4528786242008209
loss_pred:0.024653811007738113, decouple_loss:0.008274151012301445
loss_pred:0.025733431801199913, decouple_loss:0.007851476781070232
The modified gen p mean: 0.4499052166938782, gen p mean: -0.750325620174408, mean p set: 0.45038551092147827
loss_pred:0.0251736119389534, decouple_loss:0.008183479309082031
Iteration: 522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45027369260787964, gen p mean: -0.7540368437767029, mean p set: 0.4507540166378021
loss_pred:0.025855490937829018, decouple_loss:0.007890812121331692
The modified gen p mean: 0.4510103166103363, gen p mean: -0.7550244331359863, mean p set: 0.451490581035614
The modified gen p mean: 0.4509449303150177, gen p mean: -0.7517889738082886, mean p set: 0.4514252245426178
loss_pred:0.025265729054808617, decouple_loss:0.007864941842854023
loss_pred:0.0256324652582407, decouple_loss:0.007997628301382065
Iteration: 523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519434869289398, gen p mean: -0.7661840915679932, mean p set: 0.4524238109588623
loss_pred:0.025028850883245468, decouple_loss:0.008045920170843601
The modified gen p mean: 0.4505440890789032, gen p mean: -0.7697936296463013, mean p set: 0.4510243833065033
The modified gen p mean: 0.45031309127807617, gen p mean: -0.7630020976066589, mean p set: 0.4507933557033539
loss_pred:0.02601771615445614, decouple_loss:0.0083484360948205
loss_pred:0.02525256760418415, decouple_loss:0.008063682354986668
Iteration: 524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450015127658844, gen p mean: -0.7498981356620789, mean p set: 0.4504954218864441
loss_pred:0.025664949789643288, decouple_loss:0.00783182680606842
The modified gen p mean: 0.45086175203323364, gen p mean: -0.7588040828704834, mean p set: 0.45134201645851135
The modified gen p mean: 0.4504777491092682, gen p mean: -0.7513163089752197, mean p set: 0.4509580433368683
loss_pred:0.025919921696186066, decouple_loss:0.008180803619325161
loss_pred:0.025178810581564903, decouple_loss:0.007901565171778202
Iteration: 525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45106467604637146, gen p mean: -0.756956934928894, mean p set: 0.45154494047164917
The modified gen p mean: 0.4512133300304413, gen p mean: -0.7656673192977905, mean p set: 0.4516936242580414
loss_pred:0.024468619376420975, decouple_loss:0.008458255790174007
loss_pred:0.02657562494277954, decouple_loss:0.008532662875950336
The modified gen p mean: 0.4526062309741974, gen p mean: -0.7597201466560364, mean p set: 0.4530864953994751
loss_pred:0.025991924107074738, decouple_loss:0.007934661582112312
Iteration: 526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508785903453827, gen p mean: -0.7650858759880066, mean p set: 0.451358824968338
The modified gen p mean: 0.45065435767173767, gen p mean: -0.761306643486023, mean p set: 0.4511346220970154
loss_pred:0.02497800812125206, decouple_loss:0.00804936420172453
loss_pred:0.025843817740678787, decouple_loss:0.008130681701004505
The modified gen p mean: 0.4498280882835388, gen p mean: -0.7555128335952759, mean p set: 0.4503083825111389
loss_pred:0.026082981377840042, decouple_loss:0.007867388427257538
Iteration: 527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451759397983551, gen p mean: -0.7581789493560791, mean p set: 0.4522396922111511
loss_pred:0.025535311549901962, decouple_loss:0.007717757951468229
The modified gen p mean: 0.4516170918941498, gen p mean: -0.7632720470428467, mean p set: 0.4520973861217499
The modified gen p mean: 0.4506767988204956, gen p mean: -0.7542954087257385, mean p set: 0.4511570930480957
loss_pred:0.026093125343322754, decouple_loss:0.007845941931009293
loss_pred:0.02621716633439064, decouple_loss:0.007943364791572094
Iteration: 528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513828754425049, gen p mean: -0.7697367072105408, mean p set: 0.4518631398677826
loss_pred:0.026671942323446274, decouple_loss:0.008682689629495144
The modified gen p mean: 0.45170366764068604, gen p mean: -0.7730161547660828, mean p set: 0.45218396186828613
The modified gen p mean: 0.4504963755607605, gen p mean: -0.7653791904449463, mean p set: 0.4509766697883606
loss_pred:0.026739293709397316, decouple_loss:0.0082688108086586
loss_pred:0.02601487562060356, decouple_loss:0.007868869230151176
Iteration: 529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45238879323005676, gen p mean: -0.7743596434593201, mean p set: 0.45286911725997925
The modified gen p mean: 0.45175155997276306, gen p mean: -0.7706191539764404, mean p set: 0.45223185420036316
loss_pred:0.025364482775330544, decouple_loss:0.008411535993218422
loss_pred:0.025134911760687828, decouple_loss:0.008333508856594563
The modified gen p mean: 0.45068854093551636, gen p mean: -0.7684938907623291, mean p set: 0.45116883516311646
loss_pred:0.02644149772822857, decouple_loss:0.008052702061831951
Iteration: 530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451369047164917, gen p mean: -0.7625910043716431, mean p set: 0.4518493115901947
The modified gen p mean: 0.45108503103256226, gen p mean: -0.7641265988349915, mean p set: 0.45156532526016235
loss_pred:0.026266250759363174, decouple_loss:0.008503969758749008
loss_pred:0.024423178285360336, decouple_loss:0.008441195823252201
The modified gen p mean: 0.4509691596031189, gen p mean: -0.7568835020065308, mean p set: 0.451449453830719
loss_pred:0.024863824248313904, decouple_loss:0.008624736219644547
2023-05-04 13:45:34 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.754304826259613, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7660972476005554, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7594389915466309, mean p set: 0.4500633478164673
loss_pred:0.025970647111535072, decouple_loss:0.008827035315334797
loss_pred:0.02625180594623089, decouple_loss:0.008667033165693283loss_pred:0.027228189632296562, decouple_loss:0.009185290895402431
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02692820504307747, avg_mse: 0.03267683461308479
current test mse: 0.032677
Iteration: 531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45045387744903564, gen p mean: -0.7563111782073975, mean p set: 0.45093417167663574
The modified gen p mean: 0.45127439498901367, gen p mean: -0.7609752416610718, mean p set: 0.45175471901893616
loss_pred:0.02577081136405468, decouple_loss:0.008251199498772621
loss_pred:0.025047145783901215, decouple_loss:0.007921992801129818
The modified gen p mean: 0.4500358998775482, gen p mean: -0.7596079707145691, mean p set: 0.4505161941051483
loss_pred:0.025394633412361145, decouple_loss:0.007866119034588337
Iteration: 532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45092010498046875, gen p mean: -0.7606751918792725, mean p set: 0.45140039920806885
The modified gen p mean: 0.4501487612724304, gen p mean: -0.7561166286468506, mean p set: 0.45062902569770813
loss_pred:0.025142693892121315, decouple_loss:0.00852276012301445
loss_pred:0.025438537821173668, decouple_loss:0.008310830220580101
The modified gen p mean: 0.4509936571121216, gen p mean: -0.7579238414764404, mean p set: 0.4514739513397217
loss_pred:0.025683274492621422, decouple_loss:0.008301693014800549
Iteration: 533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517129063606262, gen p mean: -0.7638869881629944, mean p set: 0.4521932005882263
The modified gen p mean: 0.44963377714157104, gen p mean: -0.7651373147964478, mean p set: 0.45011407136917114
loss_pred:0.025953218340873718, decouple_loss:0.008249448612332344
loss_pred:0.025546861812472343, decouple_loss:0.008475618436932564
The modified gen p mean: 0.45170968770980835, gen p mean: -0.7594709992408752, mean p set: 0.45218998193740845
loss_pred:0.026260165497660637, decouple_loss:0.008261924609541893
Iteration: 534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515957236289978, gen p mean: -0.7673673033714294, mean p set: 0.4520759880542755
The modified gen p mean: 0.451000839471817, gen p mean: -0.7695759534835815, mean p set: 0.4514811336994171
loss_pred:0.025039955973625183, decouple_loss:0.007886853069067001
loss_pred:0.026096593588590622, decouple_loss:0.007924613542854786
The modified gen p mean: 0.4494660496711731, gen p mean: -0.7615868449211121, mean p set: 0.4499463438987732
loss_pred:0.026181982830166817, decouple_loss:0.007914871908724308
Iteration: 535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45130977034568787, gen p mean: -0.7612832188606262, mean p set: 0.45179006457328796
The modified gen p mean: 0.4502072036266327, gen p mean: -0.7554810643196106, mean p set: 0.4506874978542328
loss_pred:0.025252075865864754, decouple_loss:0.008060883730649948
loss_pred:0.02656681463122368, decouple_loss:0.007977056317031384
The modified gen p mean: 0.45124179124832153, gen p mean: -0.7648987770080566, mean p set: 0.451722115278244
loss_pred:0.02620687149465084, decouple_loss:0.008657860569655895
Iteration: 536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520995318889618, gen p mean: -0.7623746395111084, mean p set: 0.4525797963142395
The modified gen p mean: 0.4522620439529419, gen p mean: -0.7619783878326416, mean p set: 0.452742338180542
loss_pred:0.02473217248916626, decouple_loss:0.00865442305803299
loss_pred:0.024137992411851883, decouple_loss:0.008435046300292015
The modified gen p mean: 0.45241865515708923, gen p mean: -0.7584904432296753, mean p set: 0.45289894938468933
loss_pred:0.024998409673571587, decouple_loss:0.008598560467362404
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468916654586792, gen p mean: -0.7448080778121948, mean p set: 0.4473719894886017
The modified gen p mean: 0.44665101170539856, gen p mean: -0.7546138167381287, mean p set: 0.4471312463283539
loss_pred:0.025994280353188515, decouple_loss:0.008900916203856468
The modified gen p mean: 0.4475764036178589, gen p mean: -0.7522131204605103, mean p set: 0.448056697845459
loss_pred:0.02667170576751232, decouple_loss:0.00898066908121109
loss_pred:0.026036879047751427, decouple_loss:0.00952132511883974
Iteration: 538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465504586696625, gen p mean: -0.74732506275177, mean p set: 0.44703078269958496
loss_pred:0.026532409712672234, decouple_loss:0.008503641001880169
The modified gen p mean: 0.44827795028686523, gen p mean: -0.7488493919372559, mean p set: 0.44875821471214294
The modified gen p mean: 0.44786641001701355, gen p mean: -0.7475098967552185, mean p set: 0.44834670424461365
loss_pred:0.027368158102035522, decouple_loss:0.009002331644296646
loss_pred:0.026549186557531357, decouple_loss:0.008690985850989819
Iteration: 539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447671502828598, gen p mean: -0.7654405832290649, mean p set: 0.44815176725387573
The modified gen p mean: 0.44691750407218933, gen p mean: -0.768710196018219, mean p set: 0.44739779829978943
loss_pred:0.025301655754446983, decouple_loss:0.008564773015677929
loss_pred:0.02576562389731407, decouple_loss:0.008906012400984764
The modified gen p mean: 0.4465515613555908, gen p mean: -0.7606779336929321, mean p set: 0.4470318555831909
loss_pred:0.02552853152155876, decouple_loss:0.008796353824436665
Iteration: 540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487743079662323, gen p mean: -0.7667772769927979, mean p set: 0.4492546021938324
The modified gen p mean: 0.44645535945892334, gen p mean: -0.7719820737838745, mean p set: 0.44693562388420105
loss_pred:0.02524726279079914, decouple_loss:0.008650452829897404
loss_pred:0.025359351187944412, decouple_loss:0.008914678357541561
The modified gen p mean: 0.4473675787448883, gen p mean: -0.770309567451477, mean p set: 0.4478478729724884
loss_pred:0.02544405683875084, decouple_loss:0.008551683276891708
2023-05-04 13:49:51 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7564746737480164, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7621423006057739, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7696810364723206, mean p set: 0.4502691626548767
loss_pred:0.025737540796399117, decouple_loss:0.008610532619059086
loss_pred:0.026157408952713013, decouple_loss:0.008592645637691021
loss_pred:0.027064040303230286, decouple_loss:0.008607645519077778
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02674984559416771, avg_mse: 0.0322750024497509
current test mse: 0.032275
Iteration: 541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44670215249061584, gen p mean: -0.7684939503669739, mean p set: 0.44718244671821594
The modified gen p mean: 0.4492502808570862, gen p mean: -0.7709981799125671, mean p set: 0.44973060488700867
loss_pred:0.025333696976304054, decouple_loss:0.008321125991642475
loss_pred:0.025439463555812836, decouple_loss:0.008544142358005047
The modified gen p mean: 0.4478625953197479, gen p mean: -0.7737761735916138, mean p set: 0.44834285974502563
loss_pred:0.02609647624194622, decouple_loss:0.008698198944330215
Iteration: 542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44633227586746216, gen p mean: -0.7616640329360962, mean p set: 0.44681257009506226
loss_pred:0.02509468048810959, decouple_loss:0.008253834210336208
The modified gen p mean: 0.4467405080795288, gen p mean: -0.7607285380363464, mean p set: 0.4472208023071289
The modified gen p mean: 0.44701990485191345, gen p mean: -0.7572372555732727, mean p set: 0.44750016927719116
loss_pred:0.025150539353489876, decouple_loss:0.00836457870900631
loss_pred:0.026626015082001686, decouple_loss:0.008313009515404701
Iteration: 543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839704036712646, gen p mean: -0.7589566707611084, mean p set: 0.44887736439704895
loss_pred:0.02609924040734768, decouple_loss:0.008551210165023804
The modified gen p mean: 0.447029709815979, gen p mean: -0.7594333291053772, mean p set: 0.4475100040435791
The modified gen p mean: 0.4455268085002899, gen p mean: -0.7536906003952026, mean p set: 0.44600710272789
loss_pred:0.02506454475224018, decouple_loss:0.00880071148276329
loss_pred:0.026230638846755028, decouple_loss:0.008474262431263924
Iteration: 544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876816868782043, gen p mean: -0.7533055543899536, mean p set: 0.44924843311309814
loss_pred:0.02534906566143036, decouple_loss:0.008141242899000645
The modified gen p mean: 0.44613558053970337, gen p mean: -0.7446693778038025, mean p set: 0.4466158449649811
The modified gen p mean: 0.44546037912368774, gen p mean: -0.7514839172363281, mean p set: 0.44594070315361023
loss_pred:0.024985918775200844, decouple_loss:0.008340512402355671
loss_pred:0.024608677253127098, decouple_loss:0.008350713178515434
Iteration: 545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473969638347626, gen p mean: -0.7470170259475708, mean p set: 0.44787725806236267
The modified gen p mean: 0.44737598299980164, gen p mean: -0.7506160140037537, mean p set: 0.44785624742507935
loss_pred:0.026055652648210526, decouple_loss:0.00799770187586546
loss_pred:0.024998217821121216, decouple_loss:0.007901732809841633
The modified gen p mean: 0.4464106261730194, gen p mean: -0.7537859678268433, mean p set: 0.4468908905982971
loss_pred:0.02551577240228653, decouple_loss:0.008050564676523209
Iteration: 546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448159784078598, gen p mean: -0.7491072416305542, mean p set: 0.44864004850387573
The modified gen p mean: 0.4465046525001526, gen p mean: -0.7467141151428223, mean p set: 0.4469849467277527
loss_pred:0.02615462802350521, decouple_loss:0.008252700790762901
loss_pred:0.024900564923882484, decouple_loss:0.007924015633761883
The modified gen p mean: 0.4461483955383301, gen p mean: -0.7460881471633911, mean p set: 0.4466286599636078
loss_pred:0.024752238765358925, decouple_loss:0.00816334504634142
Iteration: 547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781818985939026, gen p mean: -0.7535786628723145, mean p set: 0.44829845428466797
The modified gen p mean: 0.4466874897480011, gen p mean: -0.7479087114334106, mean p set: 0.4471677839756012
loss_pred:0.02489091269671917, decouple_loss:0.007751074153929949
loss_pred:0.02531341463327408, decouple_loss:0.007958066649734974
The modified gen p mean: 0.44797658920288086, gen p mean: -0.7521082162857056, mean p set: 0.44845691323280334
loss_pred:0.02608279511332512, decouple_loss:0.00808663759380579
Iteration: 548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661250710487366, gen p mean: -0.7543015480041504, mean p set: 0.44709280133247375
loss_pred:0.02529204823076725, decouple_loss:0.007741485722362995
The modified gen p mean: 0.44692403078079224, gen p mean: -0.7599672079086304, mean p set: 0.44740432500839233
The modified gen p mean: 0.44767534732818604, gen p mean: -0.7569844722747803, mean p set: 0.4481556713581085
loss_pred:0.025029964745044708, decouple_loss:0.0078212209045887
loss_pred:0.025486834347248077, decouple_loss:0.0077737499959766865
Iteration: 549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844359159469604, gen p mean: -0.757754921913147, mean p set: 0.44892388582229614
The modified gen p mean: 0.4471036195755005, gen p mean: -0.7588641047477722, mean p set: 0.4475838840007782
loss_pred:0.02680022083222866, decouple_loss:0.008024918846786022
loss_pred:0.025338739156723022, decouple_loss:0.008227339945733547
The modified gen p mean: 0.446512371301651, gen p mean: -0.754077136516571, mean p set: 0.4469926357269287
loss_pred:0.026206830516457558, decouple_loss:0.0076842899434268475
Iteration: 550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482708275318146, gen p mean: -0.752932071685791, mean p set: 0.44875115156173706
The modified gen p mean: 0.44768601655960083, gen p mean: -0.7477415800094604, mean p set: 0.4481663107872009
loss_pred:0.026294197887182236, decouple_loss:0.00819192174822092
loss_pred:0.026069238781929016, decouple_loss:0.00789240375161171
The modified gen p mean: 0.44707977771759033, gen p mean: -0.7573999166488647, mean p set: 0.4475601017475128
loss_pred:0.025885608047246933, decouple_loss:0.007801518775522709
2023-05-04 13:53:27 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7513577938079834, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7630813717842102, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7567110657691956, mean p set: 0.4500633478164673
loss_pred:0.025580620393157005, decouple_loss:0.00788413267582655
loss_pred:0.026996390894055367, decouple_loss:0.008086427114903927loss_pred:0.025860389694571495, decouple_loss:0.007777353283017874
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02654159814119339, avg_mse: 0.032097477465867996
current test mse: 0.032097
Iteration: 551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738298654556274, gen p mean: -0.7636268734931946, mean p set: 0.44786328077316284
The modified gen p mean: 0.44916796684265137, gen p mean: -0.7652839422225952, mean p set: 0.44964826107025146
loss_pred:0.024521611630916595, decouple_loss:0.007524923887103796
loss_pred:0.02488008141517639, decouple_loss:0.007837188430130482
The modified gen p mean: 0.44630926847457886, gen p mean: -0.7612754702568054, mean p set: 0.44678959250450134
loss_pred:0.02481231279671192, decouple_loss:0.008071713149547577
Iteration: 552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474863111972809, gen p mean: -0.7648702263832092, mean p set: 0.447966605424881
loss_pred:0.024780020117759705, decouple_loss:0.007427669130265713
The modified gen p mean: 0.4475334584712982, gen p mean: -0.7635494470596313, mean p set: 0.4480137526988983
The modified gen p mean: 0.4469894468784332, gen p mean: -0.7660442590713501, mean p set: 0.4474697411060333
loss_pred:0.02529275417327881, decouple_loss:0.0074819643050432205
loss_pred:0.025031160563230515, decouple_loss:0.007615762297064066
Iteration: 553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729194045066833, gen p mean: -0.7570940852165222, mean p set: 0.44777220487594604
loss_pred:0.025344807654619217, decouple_loss:0.00756367202848196
The modified gen p mean: 0.4458523094654083, gen p mean: -0.7637219429016113, mean p set: 0.4463326036930084
The modified gen p mean: 0.44714269042015076, gen p mean: -0.7615726590156555, mean p set: 0.44762295484542847
loss_pred:0.024411935359239578, decouple_loss:0.0073716468177735806
loss_pred:0.025276727974414825, decouple_loss:0.0076560345478355885
Iteration: 554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735249876976013, gen p mean: -0.7577487826347351, mean p set: 0.44783279299736023
The modified gen p mean: 0.4470362365245819, gen p mean: -0.7466557025909424, mean p set: 0.447516530752182
loss_pred:0.025026001036167145, decouple_loss:0.007195041514933109
loss_pred:0.026212923228740692, decouple_loss:0.007461790926754475
The modified gen p mean: 0.4466387629508972, gen p mean: -0.7564948797225952, mean p set: 0.4471190571784973
loss_pred:0.024596888571977615, decouple_loss:0.007364127319306135
Iteration: 555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468054175376892, gen p mean: -0.7595667243003845, mean p set: 0.4472857117652893
The modified gen p mean: 0.44697317481040955, gen p mean: -0.7518605589866638, mean p set: 0.44745346903800964
loss_pred:0.02467874437570572, decouple_loss:0.007315021473914385
loss_pred:0.025991253554821014, decouple_loss:0.007276823278516531
The modified gen p mean: 0.4455258548259735, gen p mean: -0.7599804997444153, mean p set: 0.4460061490535736
loss_pred:0.025190716609358788, decouple_loss:0.007746842689812183
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44644027948379517, gen p mean: -0.7644855976104736, mean p set: 0.44692057371139526
The modified gen p mean: 0.4480457603931427, gen p mean: -0.7614840865135193, mean p set: 0.4485260546207428loss_pred:0.025595130398869514, decouple_loss:0.007409129291772842
loss_pred:0.025971462950110435, decouple_loss:0.007467958610504866
The modified gen p mean: 0.44723886251449585, gen p mean: -0.7623166441917419, mean p set: 0.44771912693977356
loss_pred:0.025458257645368576, decouple_loss:0.007263286504894495
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
NaN value num: 0
Iteration: 557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475134611129761, gen p mean: -0.7584691643714905, mean p set: 0.4479937255382538
The modified gen p mean: 0.44812843203544617, gen p mean: -0.7563965916633606, mean p set: 0.44860872626304626
The modified gen p mean: 0.4487714469432831, gen p mean: -0.7682891488075256, mean p set: 0.44925177097320557
loss_pred:0.026312125846743584, decouple_loss:0.00775821041315794
loss_pred:0.02761920727789402, decouple_loss:0.007678454276174307
loss_pred:0.026955995708703995, decouple_loss:0.007528889924287796
Iteration: 558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493815302848816, gen p mean: -0.771933913230896, mean p set: 0.4498618543148041
loss_pred:0.026529118418693542, decouple_loss:0.007682887837290764
The modified gen p mean: 0.44697052240371704, gen p mean: -0.7616618275642395, mean p set: 0.44745081663131714
The modified gen p mean: 0.45017313957214355, gen p mean: -0.782551109790802, mean p set: 0.45065340399742126
loss_pred:0.02709890902042389, decouple_loss:0.0071615055203437805
loss_pred:0.027160614728927612, decouple_loss:0.007983637973666191
Iteration: 559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44954660534858704, gen p mean: -0.7738618850708008, mean p set: 0.45002689957618713
loss_pred:0.027945654466748238, decouple_loss:0.008068894036114216
The modified gen p mean: 0.44981130957603455, gen p mean: -0.7736478447914124, mean p set: 0.45029157400131226
The modified gen p mean: 0.4485195279121399, gen p mean: -0.7690138816833496, mean p set: 0.4489997923374176
loss_pred:0.027701690793037415, decouple_loss:0.007531591225415468
loss_pred:0.027313636615872383, decouple_loss:0.007439597975462675
Iteration: 560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489491581916809, gen p mean: -0.7752683758735657, mean p set: 0.4494294226169586
The modified gen p mean: 0.4479981064796448, gen p mean: -0.7626785039901733, mean p set: 0.44847843050956726
loss_pred:0.02806014008820057, decouple_loss:0.007722351234406233
loss_pred:0.027295632287859917, decouple_loss:0.007664212025702
The modified gen p mean: 0.44948768615722656, gen p mean: -0.7700790762901306, mean p set: 0.44996798038482666
loss_pred:0.027528313919901848, decouple_loss:0.007481145206838846
2023-05-04 13:57:41 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7641087770462036, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7752618789672852, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7691830992698669, mean p set: 0.4500633478164673
loss_pred:0.025591326877474785, decouple_loss:0.007460080087184906
loss_pred:0.026833219453692436, decouple_loss:0.0077384039759635925
loss_pred:0.025765936821699142, decouple_loss:0.0074057811871171
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02644023299217224, avg_mse: 0.032010674476623535
current test mse: 0.032011
Iteration: 561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44989821314811707, gen p mean: -0.777288019657135, mean p set: 0.45037850737571716
loss_pred:0.02736664190888405, decouple_loss:0.007136246655136347
The modified gen p mean: 0.4487517476081848, gen p mean: -0.770874559879303, mean p set: 0.4492320418357849
loss_pred:0.02695019729435444, decouple_loss:0.007257101126015186
The modified gen p mean: 0.4474564790725708, gen p mean: -0.767184317111969, mean p set: 0.4479367434978485
loss_pred:0.02633008174598217, decouple_loss:0.007328183855861425
Iteration: 562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490557014942169, gen p mean: -0.7715225219726562, mean p set: 0.44953596591949463
The modified gen p mean: 0.4484270215034485, gen p mean: -0.7680418491363525, mean p set: 0.4489073157310486
loss_pred:0.027356302365660667, decouple_loss:0.007315066643059254
loss_pred:0.027267685160040855, decouple_loss:0.007149454206228256
The modified gen p mean: 0.44785863161087036, gen p mean: -0.7558448910713196, mean p set: 0.44833892583847046
loss_pred:0.027568437159061432, decouple_loss:0.0073879254050552845
Iteration: 563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915780425071716, gen p mean: -0.7680438160896301, mean p set: 0.44963809847831726
loss_pred:0.02676181122660637, decouple_loss:0.007419489789754152
The modified gen p mean: 0.44840845465660095, gen p mean: -0.7613325715065002, mean p set: 0.44888877868652344
The modified gen p mean: 0.44869574904441833, gen p mean: -0.7639641761779785, mean p set: 0.44917601346969604
loss_pred:0.026387829333543777, decouple_loss:0.007394758518785238
loss_pred:0.028316041454672813, decouple_loss:0.0075790188275277615
Iteration: 564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44899824261665344, gen p mean: -0.7514103055000305, mean p set: 0.4494785666465759
The modified gen p mean: 0.4478062689304352, gen p mean: -0.7479872107505798, mean p set: 0.4482865631580353loss_pred:0.027802124619483948, decouple_loss:0.0073906187899410725
The modified gen p mean: 0.44958388805389404, gen p mean: -0.7536859512329102, mean p set: 0.45006415247917175
loss_pred:0.027535101398825645, decouple_loss:0.007311133202165365
loss_pred:0.02846425026655197, decouple_loss:0.007540646940469742
Iteration: 565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447001188993454, gen p mean: -0.7518283724784851, mean p set: 0.4474814832210541
The modified gen p mean: 0.4490993618965149, gen p mean: -0.7566596269607544, mean p set: 0.449579656124115
loss_pred:0.027168573811650276, decouple_loss:0.007604035548865795
loss_pred:0.027492733672261238, decouple_loss:0.007362868636846542
The modified gen p mean: 0.44730862975120544, gen p mean: -0.7468468546867371, mean p set: 0.44778892397880554
loss_pred:0.026785437017679214, decouple_loss:0.007351677864789963
Iteration: 566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449436753988266, gen p mean: -0.7594843506813049, mean p set: 0.4499170780181885
loss_pred:0.026178598403930664, decouple_loss:0.007066953927278519
The modified gen p mean: 0.44962507486343384, gen p mean: -0.7575374841690063, mean p set: 0.45010536909103394
The modified gen p mean: 0.4486970007419586, gen p mean: -0.7532529234886169, mean p set: 0.44917726516723633
loss_pred:0.027493352070450783, decouple_loss:0.0071687172167003155
loss_pred:0.026630405336618423, decouple_loss:0.0070970309898257256
Iteration: 567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856566190719604, gen p mean: -0.7598288059234619, mean p set: 0.44904592633247375
The modified gen p mean: 0.44922003149986267, gen p mean: -0.7604036927223206, mean p set: 0.44970032572746277loss_pred:0.027819426730275154, decouple_loss:0.007418496068567038
The modified gen p mean: 0.4491023123264313, gen p mean: -0.7582420110702515, mean p set: 0.44958263635635376
loss_pred:0.02673913910984993, decouple_loss:0.007202199660241604
loss_pred:0.026698118075728416, decouple_loss:0.007126166019588709
Iteration: 568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476543366909027, gen p mean: -0.7555423974990845, mean p set: 0.4481346309185028
The modified gen p mean: 0.44789645075798035, gen p mean: -0.7649107575416565, mean p set: 0.44837674498558044
loss_pred:0.027516121044754982, decouple_loss:0.0072844247333705425
loss_pred:0.025620244443416595, decouple_loss:0.007499261759221554
The modified gen p mean: 0.45018404722213745, gen p mean: -0.7790666818618774, mean p set: 0.45066434144973755
loss_pred:0.02728370763361454, decouple_loss:0.007748304400593042
Iteration: 569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507370889186859, gen p mean: -0.7874391078948975, mean p set: 0.451217383146286
The modified gen p mean: 0.4469609260559082, gen p mean: -0.7697680592536926, mean p set: 0.4474412202835083
loss_pred:0.026206940412521362, decouple_loss:0.0075010014697909355
loss_pred:0.027231959626078606, decouple_loss:0.007203658111393452
The modified gen p mean: 0.4486750662326813, gen p mean: -0.7733560800552368, mean p set: 0.44915536046028137
loss_pred:0.027445051819086075, decouple_loss:0.006901558022946119
Iteration: 570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501849114894867, gen p mean: -0.7755648493766785, mean p set: 0.4506652057170868
The modified gen p mean: 0.44855383038520813, gen p mean: -0.7697665095329285, mean p set: 0.4490341246128082
loss_pred:0.025928573682904243, decouple_loss:0.006841993425041437
loss_pred:0.025976939126849174, decouple_loss:0.0072073969058692455
The modified gen p mean: 0.4495876133441925, gen p mean: -0.7719373106956482, mean p set: 0.4500678777694702
loss_pred:0.02649761363863945, decouple_loss:0.007308489643037319
2023-05-04 14:01:14 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7561678290367126, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7669057250022888, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7611457705497742, mean p set: 0.4500633478164673
loss_pred:0.0253890547901392, decouple_loss:0.007492285221815109
loss_pred:0.02681121602654457, decouple_loss:0.007816889323294163
loss_pred:0.025796381756663322, decouple_loss:0.007499734405428171
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02637903392314911, avg_mse: 0.031938765197992325
current test mse: 0.031939
Iteration: 571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491068422794342, gen p mean: -0.7639376521110535, mean p set: 0.4495871365070343
The modified gen p mean: 0.4497879445552826, gen p mean: -0.7721577882766724, mean p set: 0.4502682387828827
loss_pred:0.027573782950639725, decouple_loss:0.006971985567361116
loss_pred:0.02715890482068062, decouple_loss:0.00729689234867692
The modified gen p mean: 0.4493502378463745, gen p mean: -0.7642542123794556, mean p set: 0.449830561876297
loss_pred:0.026909593492746353, decouple_loss:0.007108010817319155
Iteration: 572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475889503955841, gen p mean: -0.7565984129905701, mean p set: 0.4480692446231842
The modified gen p mean: 0.4487400949001312, gen p mean: -0.7591069340705872, mean p set: 0.4492203891277313
loss_pred:0.026432085782289505, decouple_loss:0.007217869628220797
loss_pred:0.02651253342628479, decouple_loss:0.00716853141784668
The modified gen p mean: 0.45038357377052307, gen p mean: -0.7660853266716003, mean p set: 0.4508638381958008
loss_pred:0.025577034801244736, decouple_loss:0.0067843059077858925
Iteration: 573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484054148197174, gen p mean: -0.7619454860687256, mean p set: 0.4488857388496399
loss_pred:0.02684652805328369, decouple_loss:0.0067628431133925915
The modified gen p mean: 0.4482823312282562, gen p mean: -0.760674238204956, mean p set: 0.4487626254558563
The modified gen p mean: 0.4493086040019989, gen p mean: -0.7566693425178528, mean p set: 0.449788898229599
loss_pred:0.026090102270245552, decouple_loss:0.0068604969419538975
loss_pred:0.0274933073669672, decouple_loss:0.007016857620328665
Iteration: 574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487094581127167, gen p mean: -0.7575845122337341, mean p set: 0.4491897523403168
The modified gen p mean: 0.4474480152130127, gen p mean: -0.7548032999038696, mean p set: 0.4479283094406128
loss_pred:0.027188459411263466, decouple_loss:0.006917901802808046
loss_pred:0.0271171685308218, decouple_loss:0.007003944367170334
The modified gen p mean: 0.4495446979999542, gen p mean: -0.7611111402511597, mean p set: 0.45002496242523193
loss_pred:0.02737259306013584, decouple_loss:0.0068130576983094215
Iteration: 575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943666458129883, gen p mean: -0.7580506801605225, mean p set: 0.44991692900657654
The modified gen p mean: 0.4479564130306244, gen p mean: -0.7574681043624878, mean p set: 0.4484367072582245
loss_pred:0.028233831748366356, decouple_loss:0.007189106196165085
loss_pred:0.026948461309075356, decouple_loss:0.006819761358201504
The modified gen p mean: 0.45001980662345886, gen p mean: -0.7696210741996765, mean p set: 0.4505000710487366
loss_pred:0.02707924321293831, decouple_loss:0.007519955281168222
Iteration: 576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491044580936432, gen p mean: -0.780285120010376, mean p set: 0.4495847821235657
loss_pred:0.026391318067908287, decouple_loss:0.006956310942769051
The modified gen p mean: 0.45032188296318054, gen p mean: -0.7816005349159241, mean p set: 0.45080211758613586
The modified gen p mean: 0.4490108788013458, gen p mean: -0.7766719460487366, mean p set: 0.44949114322662354
loss_pred:0.026788022369146347, decouple_loss:0.007504126522690058
loss_pred:0.026585232466459274, decouple_loss:0.007118438836187124
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
NaN value num: 0
Iteration: 577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653427600860596, gen p mean: -0.77211993932724, mean p set: 0.44701457023620605
The modified gen p mean: 0.4473939538002014, gen p mean: -0.7759992480278015, mean p set: 0.4478742182254791
The modified gen p mean: 0.4471362829208374, gen p mean: -0.7634215950965881, mean p set: 0.4476166069507599
loss_pred:0.0265056099742651, decouple_loss:0.00754562160000205
loss_pred:0.02550521306693554, decouple_loss:0.007110242266207933
loss_pred:0.025784874334931374, decouple_loss:0.007597463205456734
Iteration: 578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477144181728363, gen p mean: -0.7592600584030151, mean p set: 0.4481947124004364
loss_pred:0.027096185833215714, decouple_loss:0.00707442918792367
The modified gen p mean: 0.44905388355255127, gen p mean: -0.7796909809112549, mean p set: 0.44953420758247375
The modified gen p mean: 0.4484701454639435, gen p mean: -0.7549203038215637, mean p set: 0.4489504396915436
loss_pred:0.026147058233618736, decouple_loss:0.008040806278586388
loss_pred:0.026535514742136, decouple_loss:0.006927027367055416
Iteration: 579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446189284324646, gen p mean: -0.7691318392753601, mean p set: 0.4466695487499237
The modified gen p mean: 0.4471486806869507, gen p mean: -0.7649155259132385, mean p set: 0.44762900471687317
loss_pred:0.025703858584165573, decouple_loss:0.007306824903935194
loss_pred:0.025138139724731445, decouple_loss:0.0069150677882134914
The modified gen p mean: 0.44772329926490784, gen p mean: -0.764835000038147, mean p set: 0.44820359349250793
loss_pred:0.02545158378779888, decouple_loss:0.006871195510029793
Iteration: 580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44675564765930176, gen p mean: -0.7755336761474609, mean p set: 0.44723597168922424
The modified gen p mean: 0.4477269947528839, gen p mean: -0.7638694047927856, mean p set: 0.44820722937583923
loss_pred:0.025558164343237877, decouple_loss:0.007288564927875996
loss_pred:0.02670498937368393, decouple_loss:0.006968689151108265
The modified gen p mean: 0.44735077023506165, gen p mean: -0.7686277031898499, mean p set: 0.44783106446266174
loss_pred:0.025329850614070892, decouple_loss:0.006945399567484856
2023-05-04 14:05:25 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7662489414215088, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7706701159477234, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7771120667457581, mean p set: 0.4502691626548767
loss_pred:0.02552935481071472, decouple_loss:0.00744334002956748
loss_pred:0.025873135775327682, decouple_loss:0.007513652089983225
loss_pred:0.026884587481617928, decouple_loss:0.007695628795772791
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026473237201571465, avg_mse: 0.03217243030667305
current test mse: 0.032172
Iteration: 581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754984974861145, gen p mean: -0.7731344103813171, mean p set: 0.44803011417388916
The modified gen p mean: 0.44848692417144775, gen p mean: -0.7839178442955017, mean p set: 0.44896718859672546
loss_pred:0.027488837018609047, decouple_loss:0.00729558477178216
loss_pred:0.025846228003501892, decouple_loss:0.008051397278904915
The modified gen p mean: 0.44732069969177246, gen p mean: -0.7775298357009888, mean p set: 0.44780099391937256
loss_pred:0.025215452536940575, decouple_loss:0.007191657088696957
Iteration: 582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760653376579285, gen p mean: -0.7683186531066895, mean p set: 0.44808676838874817
The modified gen p mean: 0.4463948905467987, gen p mean: -0.7636113166809082, mean p set: 0.4468752145767212
loss_pred:0.02507428452372551, decouple_loss:0.007056237664073706
loss_pred:0.024926384910941124, decouple_loss:0.00730747077614069
The modified gen p mean: 0.44758978486061096, gen p mean: -0.7610267996788025, mean p set: 0.44807007908821106
loss_pred:0.025643032044172287, decouple_loss:0.006688621826469898
Iteration: 583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671186804771423, gen p mean: -0.7597699165344238, mean p set: 0.44719216227531433
The modified gen p mean: 0.4471409320831299, gen p mean: -0.760254442691803, mean p set: 0.44762122631073
loss_pred:0.024944281205534935, decouple_loss:0.0071158641949296
loss_pred:0.025400035083293915, decouple_loss:0.00688957329839468
The modified gen p mean: 0.4459533095359802, gen p mean: -0.7682792544364929, mean p set: 0.4464336037635803
loss_pred:0.025560744106769562, decouple_loss:0.007105742581188679
Iteration: 584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729548692703247, gen p mean: -0.7626689076423645, mean p set: 0.44777578115463257
The modified gen p mean: 0.44694894552230835, gen p mean: -0.7629910707473755, mean p set: 0.44742920994758606
loss_pred:0.025192689150571823, decouple_loss:0.006991418544203043
loss_pred:0.0255393348634243, decouple_loss:0.007396128959953785
The modified gen p mean: 0.4469406008720398, gen p mean: -0.7713398933410645, mean p set: 0.4474208950996399
loss_pred:0.025661470368504524, decouple_loss:0.007125591393560171
Iteration: 585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464569091796875, gen p mean: -0.7640767693519592, mean p set: 0.4469371736049652
The modified gen p mean: 0.4472377598285675, gen p mean: -0.7562139630317688, mean p set: 0.4477180242538452
loss_pred:0.025173546746373177, decouple_loss:0.006955898366868496
loss_pred:0.026814237236976624, decouple_loss:0.0069242012687027454
The modified gen p mean: 0.4473946988582611, gen p mean: -0.7559717893600464, mean p set: 0.4478749632835388
loss_pred:0.02512475475668907, decouple_loss:0.006702126935124397
Iteration: 586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694972038269043, gen p mean: -0.7568492889404297, mean p set: 0.44742998480796814
The modified gen p mean: 0.447578489780426, gen p mean: -0.7567588090896606, mean p set: 0.44805875420570374
loss_pred:0.027392718940973282, decouple_loss:0.006880177650600672
loss_pred:0.02502898871898651, decouple_loss:0.0068926881067454815
The modified gen p mean: 0.44681090116500854, gen p mean: -0.7635694742202759, mean p set: 0.44729119539260864
loss_pred:0.025017384439706802, decouple_loss:0.006824813317507505
Iteration: 587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476805627346039, gen p mean: -0.7615843415260315, mean p set: 0.448160856962204
loss_pred:0.02573559805750847, decouple_loss:0.006888122297823429
The modified gen p mean: 0.4470658600330353, gen p mean: -0.7583887577056885, mean p set: 0.447546124458313
The modified gen p mean: 0.44740450382232666, gen p mean: -0.7648015022277832, mean p set: 0.44788476824760437
loss_pred:0.02699636109173298, decouple_loss:0.006791396997869015
loss_pred:0.02424728497862816, decouple_loss:0.007236984558403492
Iteration: 588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472602307796478, gen p mean: -0.7663230895996094, mean p set: 0.4477405250072479
loss_pred:0.02524920552968979, decouple_loss:0.00713483989238739
The modified gen p mean: 0.4465195834636688, gen p mean: -0.7707560062408447, mean p set: 0.44699984788894653
The modified gen p mean: 0.4472832679748535, gen p mean: -0.766438901424408, mean p set: 0.4477635622024536
loss_pred:0.02555404044687748, decouple_loss:0.006983637809753418
loss_pred:0.02522016502916813, decouple_loss:0.00696396641433239
Iteration: 589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473946988582611, gen p mean: -0.7679950594902039, mean p set: 0.4478749930858612
The modified gen p mean: 0.44717586040496826, gen p mean: -0.7649137377738953, mean p set: 0.44765612483024597
loss_pred:0.02554190903902054, decouple_loss:0.006693423725664616
The modified gen p mean: 0.44731464982032776, gen p mean: -0.7688154578208923, mean p set: 0.44779494404792786
loss_pred:0.02527129091322422, decouple_loss:0.006891068071126938
loss_pred:0.02583358995616436, decouple_loss:0.006642778404057026
Iteration: 590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472357928752899, gen p mean: -0.7681838870048523, mean p set: 0.4477160573005676
The modified gen p mean: 0.4469947814941406, gen p mean: -0.7689203023910522, mean p set: 0.4474751055240631
loss_pred:0.02505142241716385, decouple_loss:0.006692841183394194
loss_pred:0.02454461343586445, decouple_loss:0.006946040783077478
The modified gen p mean: 0.4480492174625397, gen p mean: -0.7643702030181885, mean p set: 0.4485294818878174
loss_pred:0.026405366137623787, decouple_loss:0.006825036834925413
2023-05-04 14:08:57 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7653529047966003, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7702240347862244, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7764676213264465, mean p set: 0.4502691626548767
loss_pred:0.02536153234541416, decouple_loss:0.007221351843327284
loss_pred:0.025697099044919014, decouple_loss:0.007240033708512783
loss_pred:0.02674238197505474, decouple_loss:0.007347372360527515
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026297150179743767, avg_mse: 0.03188682347536087
current test mse: 0.031887
Iteration: 591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698768854141235, gen p mean: -0.7757403254508972, mean p set: 0.44746798276901245
The modified gen p mean: 0.4475298225879669, gen p mean: -0.7708249092102051, mean p set: 0.4480101466178894
loss_pred:0.025334954261779785, decouple_loss:0.006912593729794025
loss_pred:0.025255687534809113, decouple_loss:0.006654931232333183
The modified gen p mean: 0.4470345973968506, gen p mean: -0.7710822820663452, mean p set: 0.4475148916244507
loss_pred:0.02493753470480442, decouple_loss:0.00673286197707057
Iteration: 592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461573660373688, gen p mean: -0.773583710193634, mean p set: 0.44663766026496887
loss_pred:0.025054385885596275, decouple_loss:0.006752013694494963
The modified gen p mean: 0.4463563859462738, gen p mean: -0.7712863087654114, mean p set: 0.4468367099761963
The modified gen p mean: 0.44721198081970215, gen p mean: -0.7732836008071899, mean p set: 0.44769227504730225
loss_pred:0.025249915197491646, decouple_loss:0.006769787985831499
loss_pred:0.02472655288875103, decouple_loss:0.007194042205810547
Iteration: 593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44622308015823364, gen p mean: -0.7652844190597534, mean p set: 0.44670340418815613
loss_pred:0.024694306775927544, decouple_loss:0.006635252386331558
The modified gen p mean: 0.4478931128978729, gen p mean: -0.7618696093559265, mean p set: 0.448373407125473
The modified gen p mean: 0.4456823468208313, gen p mean: -0.768798291683197, mean p set: 0.4461626410484314
loss_pred:0.025606436654925346, decouple_loss:0.006905506365001202
loss_pred:0.02416827343404293, decouple_loss:0.006679218728095293
Iteration: 594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786348938941956, gen p mean: -0.7645437717437744, mean p set: 0.44834375381469727
loss_pred:0.027030304074287415, decouple_loss:0.006997882854193449
The modified gen p mean: 0.44661179184913635, gen p mean: -0.7620019912719727, mean p set: 0.44709208607673645
The modified gen p mean: 0.4476718306541443, gen p mean: -0.7620722651481628, mean p set: 0.448152095079422
loss_pred:0.02538125030696392, decouple_loss:0.006898668594658375
loss_pred:0.02520054206252098, decouple_loss:0.006385734770447016
Iteration: 595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484092891216278, gen p mean: -0.7720968723297119, mean p set: 0.4488895833492279
The modified gen p mean: 0.4494279623031616, gen p mean: -0.774563193321228, mean p set: 0.44990822672843933
loss_pred:0.02565162442624569, decouple_loss:0.007574708666652441
loss_pred:0.025509821251034737, decouple_loss:0.007888669148087502
The modified gen p mean: 0.447417676448822, gen p mean: -0.7553021907806396, mean p set: 0.4478980302810669
loss_pred:0.024947939440608025, decouple_loss:0.006772286258637905
Iteration: 596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446159690618515, gen p mean: -0.7624830603599548, mean p set: 0.4466399550437927
The modified gen p mean: 0.4470890462398529, gen p mean: -0.7698342800140381, mean p set: 0.447569340467453
loss_pred:0.025468885898590088, decouple_loss:0.007095681503415108
loss_pred:0.02547514997422695, decouple_loss:0.007115321699529886The modified gen p mean: 0.44558027386665344, gen p mean: -0.7535800933837891, mean p set: 0.44606053829193115
loss_pred:0.024219738319516182, decouple_loss:0.006913403049111366
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480159282684326, gen p mean: -0.7572290897369385, mean p set: 0.4484962224960327
The modified gen p mean: 0.4472869336605072, gen p mean: -0.7510531544685364, mean p set: 0.4477671980857849
loss_pred:0.026300564408302307, decouple_loss:0.006937087047845125
The modified gen p mean: 0.44628411531448364, gen p mean: -0.7464340329170227, mean p set: 0.44676437973976135
loss_pred:0.026820465922355652, decouple_loss:0.007207264192402363
loss_pred:0.02630099281668663, decouple_loss:0.007268709130585194
Iteration: 598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44647812843322754, gen p mean: -0.7620015144348145, mean p set: 0.44695839285850525
The modified gen p mean: 0.4476260542869568, gen p mean: -0.7558919191360474, mean p set: 0.4481063485145569
loss_pred:0.02599712833762169, decouple_loss:0.0070703113451600075
loss_pred:0.026700148358941078, decouple_loss:0.0074286931194365025
The modified gen p mean: 0.4467793107032776, gen p mean: -0.7591481804847717, mean p set: 0.4472596049308777
loss_pred:0.025722810998558998, decouple_loss:0.007070351392030716
Iteration: 599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477023184299469, gen p mean: -0.7601694464683533, mean p set: 0.4481825828552246
The modified gen p mean: 0.4478203058242798, gen p mean: -0.7622076272964478, mean p set: 0.4483005702495575
loss_pred:0.025732118636369705, decouple_loss:0.007245109416544437
loss_pred:0.026582185178995132, decouple_loss:0.007370569743216038
The modified gen p mean: 0.44889020919799805, gen p mean: -0.7718725800514221, mean p set: 0.44937047362327576
loss_pred:0.02753395028412342, decouple_loss:0.007821571081876755
Iteration: 600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814231991767883, gen p mean: -0.7665423154830933, mean p set: 0.44862261414527893
loss_pred:0.025279980152845383, decouple_loss:0.006968707777559757
The modified gen p mean: 0.44769424200057983, gen p mean: -0.7588518857955933, mean p set: 0.44817450642585754
The modified gen p mean: 0.44812050461769104, gen p mean: -0.7662901282310486, mean p set: 0.44860079884529114
loss_pred:0.02633131667971611, decouple_loss:0.007518335245549679
loss_pred:0.02628496289253235, decouple_loss:0.007401523645967245
2023-05-04 14:13:17 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7577015161514282, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7693001627922058, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830237865448, gen p mean: -0.7625041604042053, mean p set: 0.4500633478164673
loss_pred:0.025260983034968376, decouple_loss:0.007452362682670355
loss_pred:0.02671598456799984, decouple_loss:0.007710063364356756
loss_pred:0.025635655969381332, decouple_loss:0.007335836999118328
WV_0_PC_1_EH_0_PS_40_6, loss: 0.0262458473443985, avg_mse: 0.03177635744214058
current test mse: 0.031776
Iteration: 601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446853905916214, gen p mean: -0.7625362873077393, mean p set: 0.4473342299461365
The modified gen p mean: 0.4469403624534607, gen p mean: -0.7576549649238586, mean p set: 0.4474206268787384
loss_pred:0.02593022957444191, decouple_loss:0.007371538784354925
loss_pred:0.025660037994384766, decouple_loss:0.007384891156107187
The modified gen p mean: 0.44812095165252686, gen p mean: -0.7629421949386597, mean p set: 0.44860121607780457
loss_pred:0.02472992241382599, decouple_loss:0.00716383196413517
Iteration: 602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723421335220337, gen p mean: -0.752987265586853, mean p set: 0.4477144777774811
loss_pred:0.025939276441931725, decouple_loss:0.0073410398326814175
The modified gen p mean: 0.4469078481197357, gen p mean: -0.746967613697052, mean p set: 0.4473881721496582
The modified gen p mean: 0.44747447967529297, gen p mean: -0.7454744577407837, mean p set: 0.4479547441005707
loss_pred:0.026179643347859383, decouple_loss:0.0073492624796926975
loss_pred:0.025406364351511, decouple_loss:0.007264264859259129
Iteration: 603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732311367988586, gen p mean: -0.7466070652008057, mean p set: 0.44780340790748596
The modified gen p mean: 0.44752028584480286, gen p mean: -0.7417811155319214, mean p set: 0.44800058007240295
loss_pred:0.02614031359553337, decouple_loss:0.007242417894303799
loss_pred:0.024930225685238838, decouple_loss:0.007023998070508242
The modified gen p mean: 0.4477180242538452, gen p mean: -0.7431737184524536, mean p set: 0.4481982886791229
loss_pred:0.025352979078888893, decouple_loss:0.007042666431516409
Iteration: 604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790807366371155, gen p mean: -0.7594460844993591, mean p set: 0.44838836789131165
The modified gen p mean: 0.44730570912361145, gen p mean: -0.742612361907959, mean p set: 0.44778600335121155
loss_pred:0.024993283674120903, decouple_loss:0.007277096156030893
loss_pred:0.02607404999434948, decouple_loss:0.006930740084499121
The modified gen p mean: 0.4470200538635254, gen p mean: -0.7460194826126099, mean p set: 0.4475003480911255
loss_pred:0.02560488134622574, decouple_loss:0.00691843219101429
Iteration: 605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695988297462463, gen p mean: -0.7564249634742737, mean p set: 0.4474402070045471
loss_pred:0.02605883777141571, decouple_loss:0.0072461203671991825
The modified gen p mean: 0.4474908113479614, gen p mean: -0.7602728009223938, mean p set: 0.4479711353778839
The modified gen p mean: 0.44720256328582764, gen p mean: -0.7651819586753845, mean p set: 0.4476828873157501
loss_pred:0.02603846974670887, decouple_loss:0.007292911410331726
loss_pred:0.02551058679819107, decouple_loss:0.007322649471461773
Iteration: 606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486526548862457, gen p mean: -0.7766923904418945, mean p set: 0.44913291931152344
The modified gen p mean: 0.44597822427749634, gen p mean: -0.7655118107795715, mean p set: 0.44645851850509644
loss_pred:0.027141639962792397, decouple_loss:0.0075257690623402596
loss_pred:0.026171624660491943, decouple_loss:0.007104998454451561
The modified gen p mean: 0.4486413598060608, gen p mean: -0.7733365297317505, mean p set: 0.4491216838359833
loss_pred:0.02606923319399357, decouple_loss:0.007352564949542284
Iteration: 607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876790046691895, gen p mean: -0.7809617519378662, mean p set: 0.44924822449684143
The modified gen p mean: 0.4463830292224884, gen p mean: -0.7759659886360168, mean p set: 0.4468632936477661
loss_pred:0.026408476755023003, decouple_loss:0.007390436250716448
loss_pred:0.025427622720599174, decouple_loss:0.007106261793524027
The modified gen p mean: 0.4477849304676056, gen p mean: -0.782699465751648, mean p set: 0.4482652246952057
loss_pred:0.02647414244711399, decouple_loss:0.007275337819010019
Iteration: 608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869041442871094, gen p mean: -0.7752789855003357, mean p set: 0.44917070865631104
The modified gen p mean: 0.44679224491119385, gen p mean: -0.7685298919677734, mean p set: 0.44727250933647156
loss_pred:0.026322292163968086, decouple_loss:0.00713739451020956
loss_pred:0.025827473029494286, decouple_loss:0.006754555739462376
The modified gen p mean: 0.4477330446243286, gen p mean: -0.7743099927902222, mean p set: 0.4482133686542511
loss_pred:0.025471866130828857, decouple_loss:0.007031876128166914
Iteration: 609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475523829460144, gen p mean: -0.754266083240509, mean p set: 0.4480327069759369
The modified gen p mean: 0.448669970035553, gen p mean: -0.7683222889900208, mean p set: 0.4491502642631531
loss_pred:0.025665566325187683, decouple_loss:0.007005305960774422
loss_pred:0.026971181854605675, decouple_loss:0.007384716998785734
The modified gen p mean: 0.445629358291626, gen p mean: -0.7525658011436462, mean p set: 0.4461096227169037
loss_pred:0.0261501744389534, decouple_loss:0.0070740473456680775
Iteration: 610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484599530696869, gen p mean: -0.7565572261810303, mean p set: 0.448940247297287
The modified gen p mean: 0.4478982090950012, gen p mean: -0.7473489046096802, mean p set: 0.44837847352027893
loss_pred:0.026401331648230553, decouple_loss:0.007338584400713444
loss_pred:0.0252872072160244, decouple_loss:0.006996488198637962
The modified gen p mean: 0.44803979992866516, gen p mean: -0.755203127861023, mean p set: 0.44852009415626526
loss_pred:0.02572588436305523, decouple_loss:0.007472357712686062
2023-05-04 14:16:49 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7512078285217285, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7394465208053589, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.743975043296814, mean p set: 0.4500633478164673
loss_pred:0.02658803202211857, decouple_loss:0.007743579801172018
loss_pred:0.025358226150274277, decouple_loss:0.007343594450503588
loss_pred:0.025599902495741844, decouple_loss:0.007390053477138281
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02622334286570549, avg_mse: 0.03175041824579239
current test mse: 0.03175
Iteration: 611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471847116947174, gen p mean: -0.7399984002113342, mean p set: 0.4476650059223175
The modified gen p mean: 0.4468740224838257, gen p mean: -0.7396489381790161, mean p set: 0.4473542869091034
loss_pred:0.025882359594106674, decouple_loss:0.0071450527757406235
loss_pred:0.02552793361246586, decouple_loss:0.007003926672041416
The modified gen p mean: 0.44743573665618896, gen p mean: -0.7408140301704407, mean p set: 0.44791606068611145
loss_pred:0.026678627356886864, decouple_loss:0.007372802589088678
Iteration: 612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654789566993713, gen p mean: -0.7454489469528198, mean p set: 0.4470282196998596
The modified gen p mean: 0.44849735498428345, gen p mean: -0.7425219416618347, mean p set: 0.44897761940956116
loss_pred:0.025192737579345703, decouple_loss:0.007278381381183863
loss_pred:0.02544317953288555, decouple_loss:0.007178744301199913
The modified gen p mean: 0.4474409818649292, gen p mean: -0.7488663792610168, mean p set: 0.4479212760925293
loss_pred:0.02505924552679062, decouple_loss:0.007635819725692272
Iteration: 613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481739103794098, gen p mean: -0.7586417198181152, mean p set: 0.4486541748046875
loss_pred:0.026881519705057144, decouple_loss:0.007468447554856539
The modified gen p mean: 0.4477033019065857, gen p mean: -0.7460289001464844, mean p set: 0.4481835961341858
The modified gen p mean: 0.4476092755794525, gen p mean: -0.7421325445175171, mean p set: 0.4480895698070526
loss_pred:0.026141371577978134, decouple_loss:0.007296832278370857
loss_pred:0.02552933618426323, decouple_loss:0.007348688319325447
Iteration: 614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838905334472656, gen p mean: -0.756630539894104, mean p set: 0.44886934757232666
The modified gen p mean: 0.44741907715797424, gen p mean: -0.7494692206382751, mean p set: 0.44789940118789673loss_pred:0.025805646553635597, decouple_loss:0.00720258941873908
The modified gen p mean: 0.447037011384964, gen p mean: -0.7456430196762085, mean p set: 0.4475173056125641
loss_pred:0.026513461023569107, decouple_loss:0.007476290687918663
loss_pred:0.025767970830202103, decouple_loss:0.007511028554290533
Iteration: 615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478985369205475, gen p mean: -0.7567741274833679, mean p set: 0.4483788311481476
The modified gen p mean: 0.44773608446121216, gen p mean: -0.7631713151931763, mean p set: 0.44821637868881226
loss_pred:0.0260761771351099, decouple_loss:0.0072080222889781
loss_pred:0.02582484856247902, decouple_loss:0.007018447387963533
The modified gen p mean: 0.4478236734867096, gen p mean: -0.7615496516227722, mean p set: 0.4483039677143097
loss_pred:0.024621058255434036, decouple_loss:0.007034142501652241
Iteration: 616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765475392341614, gen p mean: -0.7547171115875244, mean p set: 0.44813501834869385
The modified gen p mean: 0.4474269449710846, gen p mean: -0.7687473297119141, mean p set: 0.4479072690010071
loss_pred:0.02584025077521801, decouple_loss:0.007325157057493925
loss_pred:0.02625623717904091, decouple_loss:0.007059706375002861
The modified gen p mean: 0.4472866356372833, gen p mean: -0.7595473527908325, mean p set: 0.4477669298648834
loss_pred:0.025249237194657326, decouple_loss:0.007010281085968018
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
NaN value num: 0
Iteration: 617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535592198371887, gen p mean: -0.7701637148857117, mean p set: 0.45403948426246643
The modified gen p mean: 0.45037102699279785, gen p mean: -0.7706456780433655, mean p set: 0.45085132122039795
loss_pred:0.026210831478238106, decouple_loss:0.00798092596232891
The modified gen p mean: 0.45137616991996765, gen p mean: -0.7589863538742065, mean p set: 0.45185646414756775
loss_pred:0.024711154401302338, decouple_loss:0.008216986432671547
loss_pred:0.02632422372698784, decouple_loss:0.007912848144769669
Iteration: 618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45227837562561035, gen p mean: -0.7743609547615051, mean p set: 0.45275866985321045
loss_pred:0.02578880824148655, decouple_loss:0.0077610742300748825
The modified gen p mean: 0.45200252532958984, gen p mean: -0.7666952610015869, mean p set: 0.45248281955718994
The modified gen p mean: 0.4518778324127197, gen p mean: -0.7764748930931091, mean p set: 0.4523581564426422
loss_pred:0.025806603953242302, decouple_loss:0.007681259419769049
loss_pred:0.025228599086403847, decouple_loss:0.007858905009925365
Iteration: 619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45204538106918335, gen p mean: -0.7655672430992126, mean p set: 0.45252567529678345
The modified gen p mean: 0.4509446620941162, gen p mean: -0.7590758800506592, mean p set: 0.4514249265193939
loss_pred:0.025628548115491867, decouple_loss:0.00790474470704794
loss_pred:0.025588935241103172, decouple_loss:0.007900592871010303The modified gen p mean: 0.4515189230442047, gen p mean: -0.7634022831916809, mean p set: 0.4519991874694824
loss_pred:0.024653492495417595, decouple_loss:0.008127830922603607
Iteration: 620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45250359177589417, gen p mean: -0.766684353351593, mean p set: 0.4529838562011719
loss_pred:0.02585851028561592, decouple_loss:0.0075830938294529915
The modified gen p mean: 0.45340868830680847, gen p mean: -0.7694406509399414, mean p set: 0.4538889527320862
The modified gen p mean: 0.45184358954429626, gen p mean: -0.7706860899925232, mean p set: 0.45232388377189636
loss_pred:0.024547861889004707, decouple_loss:0.00771039305254817
loss_pred:0.02539960667490959, decouple_loss:0.007893458008766174
2023-05-04 14:21:03 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7601236701011658, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7726263403892517, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7650558352470398, mean p set: 0.4500633478164673
loss_pred:0.025272948667407036, decouple_loss:0.00801082793623209
loss_pred:0.02676442265510559, decouple_loss:0.00834723748266697
loss_pred:0.02565242163836956, decouple_loss:0.0079201590269804
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02630123496055603, avg_mse: 0.03182801976799965
current test mse: 0.031828
Iteration: 621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45415031909942627, gen p mean: -0.7734205722808838, mean p set: 0.45463061332702637
The modified gen p mean: 0.4518677890300751, gen p mean: -0.7722465395927429, mean p set: 0.45234808325767517
loss_pred:0.024907981976866722, decouple_loss:0.00793197751045227
loss_pred:0.02567223645746708, decouple_loss:0.007841686718165874
The modified gen p mean: 0.45161670446395874, gen p mean: -0.7703361511230469, mean p set: 0.45209699869155884
loss_pred:0.02725115790963173, decouple_loss:0.008039565756917
Iteration: 622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45087969303131104, gen p mean: -0.7624173760414124, mean p set: 0.45135995745658875
loss_pred:0.025361482053995132, decouple_loss:0.007924389094114304
The modified gen p mean: 0.4516957104206085, gen p mean: -0.760994017124176, mean p set: 0.45217597484588623
The modified gen p mean: 0.45119157433509827, gen p mean: -0.7549852728843689, mean p set: 0.45167189836502075
loss_pred:0.02629057690501213, decouple_loss:0.007852787151932716
loss_pred:0.02576834335923195, decouple_loss:0.00779051473364234
Iteration: 623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529211223125458, gen p mean: -0.7699124813079834, mean p set: 0.4534013867378235
loss_pred:0.024273399263620377, decouple_loss:0.00809402484446764
The modified gen p mean: 0.4496992230415344, gen p mean: -0.7696387767791748, mean p set: 0.45017948746681213
The modified gen p mean: 0.4525832533836365, gen p mean: -0.7704442143440247, mean p set: 0.4530635178089142
loss_pred:0.025419410318136215, decouple_loss:0.0079934261739254
loss_pred:0.024963948875665665, decouple_loss:0.008011367172002792
Iteration: 624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520740807056427, gen p mean: -0.7597097754478455, mean p set: 0.4525543749332428
The modified gen p mean: 0.45232877135276794, gen p mean: -0.7665677666664124, mean p set: 0.45280906558036804
loss_pred:0.026068737730383873, decouple_loss:0.007531524170190096
loss_pred:0.02551642246544361, decouple_loss:0.007484635338187218
The modified gen p mean: 0.45391517877578735, gen p mean: -0.7646740078926086, mean p set: 0.45439544320106506
loss_pred:0.024179935455322266, decouple_loss:0.007542828097939491
Iteration: 625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45356109738349915, gen p mean: -0.7603307366371155, mean p set: 0.45404139161109924
loss_pred:0.0248402152210474, decouple_loss:0.007363165263086557
The modified gen p mean: 0.451592355966568, gen p mean: -0.7716833353042603, mean p set: 0.4520726501941681
The modified gen p mean: 0.4523482918739319, gen p mean: -0.7616703510284424, mean p set: 0.4528285562992096
loss_pred:0.02629707381129265, decouple_loss:0.007477597799152136
loss_pred:0.02562611550092697, decouple_loss:0.007565649226307869
Iteration: 626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523914158344269, gen p mean: -0.7671834826469421, mean p set: 0.452871710062027
loss_pred:0.025479288771748543, decouple_loss:0.007438276428729296
The modified gen p mean: 0.45387494564056396, gen p mean: -0.7639022469520569, mean p set: 0.45435523986816406
The modified gen p mean: 0.4525918662548065, gen p mean: -0.7753626704216003, mean p set: 0.4530721604824066
loss_pred:0.025251993909478188, decouple_loss:0.007211202289909124
loss_pred:0.025373555719852448, decouple_loss:0.007681646849960089
Iteration: 627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45139169692993164, gen p mean: -0.7698686122894287, mean p set: 0.4518720209598541
The modified gen p mean: 0.45240339636802673, gen p mean: -0.7768301367759705, mean p set: 0.45288369059562683
loss_pred:0.025906823575496674, decouple_loss:0.007065556477755308
loss_pred:0.025001468136906624, decouple_loss:0.007422347087413073
The modified gen p mean: 0.4518062174320221, gen p mean: -0.7708132863044739, mean p set: 0.4522865414619446
loss_pred:0.02465912699699402, decouple_loss:0.007394714280962944
Iteration: 628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510282874107361, gen p mean: -0.7651363015174866, mean p set: 0.4515085816383362
loss_pred:0.024768881499767303, decouple_loss:0.007627132814377546
The modified gen p mean: 0.45173218846321106, gen p mean: -0.7615984678268433, mean p set: 0.45221248269081116
The modified gen p mean: 0.4535473585128784, gen p mean: -0.7639241218566895, mean p set: 0.45402759313583374
loss_pred:0.024756528437137604, decouple_loss:0.0075351158156991005
loss_pred:0.02527446486055851, decouple_loss:0.007221946958452463
Iteration: 629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45282846689224243, gen p mean: -0.7563233375549316, mean p set: 0.45330876111984253
loss_pred:0.024052439257502556, decouple_loss:0.007430363912135363
The modified gen p mean: 0.45172885060310364, gen p mean: -0.7658309936523438, mean p set: 0.4522091746330261
The modified gen p mean: 0.4515969753265381, gen p mean: -0.7642767429351807, mean p set: 0.45207729935646057
loss_pred:0.02651093527674675, decouple_loss:0.007723967079073191
loss_pred:0.025505436584353447, decouple_loss:0.007273952942341566
Iteration: 630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516531229019165, gen p mean: -0.7525770664215088, mean p set: 0.4521334171295166
loss_pred:0.025479692965745926, decouple_loss:0.007281322497874498
The modified gen p mean: 0.4515679180622101, gen p mean: -0.76748126745224, mean p set: 0.45204824209213257
The modified gen p mean: 0.45155516266822815, gen p mean: -0.7507540583610535, mean p set: 0.45203545689582825
loss_pred:0.02470816671848297, decouple_loss:0.007679993752390146
loss_pred:0.026440361514687538, decouple_loss:0.007476084399968386
2023-05-04 14:24:35 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7509778141975403, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7633712291717529, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7560136318206787, mean p set: 0.4500633478164673
loss_pred:0.025370564311742783, decouple_loss:0.008033609949052334
loss_pred:0.025657065212726593, decouple_loss:0.00801410898566246loss_pred:0.026799874380230904, decouple_loss:0.00817147083580494
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026346154510974884, avg_mse: 0.031967852264642715
current test mse: 0.031968
Iteration: 631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512805640697479, gen p mean: -0.7617622017860413, mean p set: 0.45176082849502563
The modified gen p mean: 0.4516083300113678, gen p mean: -0.7610837817192078, mean p set: 0.4520886242389679
loss_pred:0.024204138666391373, decouple_loss:0.007747226394712925
loss_pred:0.02661271020770073, decouple_loss:0.007415988482534885
The modified gen p mean: 0.451813280582428, gen p mean: -0.7666539549827576, mean p set: 0.45229360461235046
loss_pred:0.02417990379035473, decouple_loss:0.00762348435819149
Iteration: 632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45130518078804016, gen p mean: -0.7603685855865479, mean p set: 0.45178544521331787
The modified gen p mean: 0.45235347747802734, gen p mean: -0.7681999206542969, mean p set: 0.45283377170562744
loss_pred:0.02596314623951912, decouple_loss:0.0069428435526788235
loss_pred:0.025047630071640015, decouple_loss:0.006703932769596577The modified gen p mean: 0.4513547122478485, gen p mean: -0.7654172778129578, mean p set: 0.4518350064754486
loss_pred:0.025065552443265915, decouple_loss:0.006782793439924717
Iteration: 633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523889422416687, gen p mean: -0.7766321897506714, mean p set: 0.4528692364692688The modified gen p mean: 0.45244100689888, gen p mean: -0.7668840885162354, mean p set: 0.4529213011264801
loss_pred:0.02557307481765747, decouple_loss:0.0072396984323859215loss_pred:0.025319166481494904, decouple_loss:0.006865444127470255
The modified gen p mean: 0.4531554579734802, gen p mean: -0.77472984790802, mean p set: 0.4536357522010803
loss_pred:0.0248896274715662, decouple_loss:0.007237317506223917
Iteration: 634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535503685474396, gen p mean: -0.7855609655380249, mean p set: 0.45403069257736206
loss_pred:0.024640705436468124, decouple_loss:0.007670211140066385
The modified gen p mean: 0.45097583532333374, gen p mean: -0.7714846730232239, mean p set: 0.45145612955093384
The modified gen p mean: 0.451862633228302, gen p mean: -0.7776949405670166, mean p set: 0.4523428976535797
loss_pred:0.025202492251992226, decouple_loss:0.00744971027597785
loss_pred:0.02575482614338398, decouple_loss:0.007193799130618572
Iteration: 635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452161580324173, gen p mean: -0.7705870866775513, mean p set: 0.45264187455177307
The modified gen p mean: 0.45025843381881714, gen p mean: -0.7827591896057129, mean p set: 0.45073869824409485
loss_pred:0.02490462362766266, decouple_loss:0.007262095343321562
loss_pred:0.024814484640955925, decouple_loss:0.007168833166360855
The modified gen p mean: 0.4517376720905304, gen p mean: -0.7748275399208069, mean p set: 0.4522179961204529
loss_pred:0.026779761537909508, decouple_loss:0.007020606659352779
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446953147649765, gen p mean: -0.761874794960022, mean p set: 0.4474334716796875
The modified gen p mean: 0.448038786649704, gen p mean: -0.7713175415992737, mean p set: 0.4485190510749817
loss_pred:0.026607776060700417, decouple_loss:0.00781249487772584
The modified gen p mean: 0.44717469811439514, gen p mean: -0.7626047730445862, mean p set: 0.44765499234199524
loss_pred:0.026122570037841797, decouple_loss:0.0076983110047876835
loss_pred:0.026182083413004875, decouple_loss:0.007898992858827114
Iteration: 637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695714116096497, gen p mean: -0.7364488840103149, mean p set: 0.44743743538856506
The modified gen p mean: 0.44665172696113586, gen p mean: -0.7402377724647522, mean p set: 0.44713205099105835
loss_pred:0.02593119814991951, decouple_loss:0.0083104707300663
loss_pred:0.025551239028573036, decouple_loss:0.008268216624855995
The modified gen p mean: 0.44667768478393555, gen p mean: -0.7485069632530212, mean p set: 0.44715800881385803
loss_pred:0.024438440799713135, decouple_loss:0.007783737499266863
Iteration: 638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447307288646698, gen p mean: -0.7550538778305054, mean p set: 0.4477875828742981
loss_pred:0.026066504418849945, decouple_loss:0.0073102847672998905
The modified gen p mean: 0.44784805178642273, gen p mean: -0.7592641711235046, mean p set: 0.44832831621170044
The modified gen p mean: 0.4470263123512268, gen p mean: -0.753235399723053, mean p set: 0.4475066065788269
loss_pred:0.025607751682400703, decouple_loss:0.007545165717601776
loss_pred:0.024313505738973618, decouple_loss:0.007221575826406479
Iteration: 639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446893572807312, gen p mean: -0.7505561709403992, mean p set: 0.4473738372325897
loss_pred:0.02492114156484604, decouple_loss:0.0071326629258692265
The modified gen p mean: 0.44755247235298157, gen p mean: -0.7533906698226929, mean p set: 0.4480327367782593
The modified gen p mean: 0.4482123553752899, gen p mean: -0.7448093891143799, mean p set: 0.44869264960289
loss_pred:0.0255311019718647, decouple_loss:0.007278662174940109
loss_pred:0.02572888322174549, decouple_loss:0.007416679989546537
Iteration: 640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476989805698395, gen p mean: -0.7533156871795654, mean p set: 0.44817930459976196
The modified gen p mean: 0.4472956657409668, gen p mean: -0.7537785768508911, mean p set: 0.4477759599685669
loss_pred:0.026064623147249222, decouple_loss:0.007087309379130602
loss_pred:0.026011571288108826, decouple_loss:0.007124557159841061
The modified gen p mean: 0.4466235339641571, gen p mean: -0.7522404789924622, mean p set: 0.4471038579940796
loss_pred:0.027499549090862274, decouple_loss:0.007185799535363913
2023-05-04 14:28:58 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7562952637672424, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7607039213180542, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7679123282432556, mean p set: 0.4502691626548767
loss_pred:0.025131680071353912, decouple_loss:0.007346995174884796
loss_pred:0.025340570136904716, decouple_loss:0.007359580602496862
loss_pred:0.026402976363897324, decouple_loss:0.007430893834680319
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025994032621383667, avg_mse: 0.031456876546144485
current test mse: 0.031457
Iteration: 641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720712304115295, gen p mean: -0.7565036416053772, mean p set: 0.44768741726875305
The modified gen p mean: 0.44669532775878906, gen p mean: -0.7542272806167603, mean p set: 0.44717565178871155
loss_pred:0.025524234399199486, decouple_loss:0.00711412588134408
loss_pred:0.026263218373060226, decouple_loss:0.007033031899482012
The modified gen p mean: 0.44660335779190063, gen p mean: -0.7554526329040527, mean p set: 0.44708362221717834
loss_pred:0.025312982499599457, decouple_loss:0.0069465939886868
Iteration: 642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794780015945435, gen p mean: -0.7706894874572754, mean p set: 0.44842812418937683
loss_pred:0.025874976068735123, decouple_loss:0.00692728953436017
The modified gen p mean: 0.44753625988960266, gen p mean: -0.7698066830635071, mean p set: 0.44801655411720276
The modified gen p mean: 0.44609716534614563, gen p mean: -0.7665655612945557, mean p set: 0.4465774595737457
loss_pred:0.024213628843426704, decouple_loss:0.007007905747741461
loss_pred:0.026447145268321037, decouple_loss:0.006784758530557156
Iteration: 643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467073082923889, gen p mean: -0.7675317525863647, mean p set: 0.4471876323223114
The modified gen p mean: 0.44821247458457947, gen p mean: -0.7568350434303284, mean p set: 0.4486927390098572
loss_pred:0.025974709540605545, decouple_loss:0.006805703975260258
loss_pred:0.02571638859808445, decouple_loss:0.007177972234785557
The modified gen p mean: 0.4467913806438446, gen p mean: -0.7674464583396912, mean p set: 0.4472716748714447
loss_pred:0.026616111397743225, decouple_loss:0.0070932297967374325
Iteration: 644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447295606136322, gen p mean: -0.7467055320739746, mean p set: 0.4477759003639221
The modified gen p mean: 0.4465223252773285, gen p mean: -0.7494360208511353, mean p set: 0.4470026195049286loss_pred:0.02596338279545307, decouple_loss:0.007129187695682049
The modified gen p mean: 0.4469364881515503, gen p mean: -0.7617275714874268, mean p set: 0.447416752576828
loss_pred:0.02550806663930416, decouple_loss:0.007108523976057768
loss_pred:0.025430282577872276, decouple_loss:0.006848684977740049
Iteration: 645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840213656425476, gen p mean: -0.7484557628631592, mean p set: 0.44888240098953247
The modified gen p mean: 0.44691500067710876, gen p mean: -0.7558643221855164, mean p set: 0.44739529490470886
loss_pred:0.025225970894098282, decouple_loss:0.007273285649716854
loss_pred:0.0247027687728405, decouple_loss:0.006866495590656996
The modified gen p mean: 0.44814738631248474, gen p mean: -0.7546845078468323, mean p set: 0.44862768054008484
loss_pred:0.025258095934987068, decouple_loss:0.006959555670619011
Iteration: 646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474543333053589, gen p mean: -0.766716480255127, mean p set: 0.447934627532959
loss_pred:0.026014866307377815, decouple_loss:0.006807188503444195
The modified gen p mean: 0.4474722146987915, gen p mean: -0.7695997357368469, mean p set: 0.4479525089263916
The modified gen p mean: 0.4460698366165161, gen p mean: -0.7477364540100098, mean p set: 0.4465501010417938
loss_pred:0.025348611176013947, decouple_loss:0.006820306181907654
loss_pred:0.025444364175200462, decouple_loss:0.007130171172320843
Iteration: 647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487560987472534, gen p mean: -0.7685771584510803, mean p set: 0.44923636317253113The modified gen p mean: 0.4466308355331421, gen p mean: -0.7580930590629578, mean p set: 0.4471111297607422
loss_pred:0.025356249883770943, decouple_loss:0.006905262358486652loss_pred:0.024975119158625603, decouple_loss:0.006793121807277203
The modified gen p mean: 0.4463751018047333, gen p mean: -0.755661129951477, mean p set: 0.4468553960323334
loss_pred:0.025542480871081352, decouple_loss:0.00672217458486557
Iteration: 648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472036063671112, gen p mean: -0.7489449977874756, mean p set: 0.4476839005947113
The modified gen p mean: 0.4472768306732178, gen p mean: -0.7437286376953125, mean p set: 0.4477570950984955
loss_pred:0.024423807859420776, decouple_loss:0.007076888810843229
loss_pred:0.02581585943698883, decouple_loss:0.0069093769416213036
The modified gen p mean: 0.4482475817203522, gen p mean: -0.7552744746208191, mean p set: 0.44872787594795227
loss_pred:0.024757111445069313, decouple_loss:0.006929499097168446
Iteration: 649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471932053565979, gen p mean: -0.758286714553833, mean p set: 0.4476735293865204
loss_pred:0.02606247365474701, decouple_loss:0.006740236654877663
The modified gen p mean: 0.4471668004989624, gen p mean: -0.7626765370368958, mean p set: 0.4476470947265625
The modified gen p mean: 0.4466247856616974, gen p mean: -0.7543120980262756, mean p set: 0.4471050798892975
loss_pred:0.025298796594142914, decouple_loss:0.007062968797981739
loss_pred:0.02567186951637268, decouple_loss:0.006736238952726126
Iteration: 650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473174214363098, gen p mean: -0.7681808471679688, mean p set: 0.4477977156639099
loss_pred:0.025418134406208992, decouple_loss:0.00677498197183013
The modified gen p mean: 0.44614535570144653, gen p mean: -0.7585570812225342, mean p set: 0.44662564992904663
The modified gen p mean: 0.44738903641700745, gen p mean: -0.7654211521148682, mean p set: 0.44786933064460754
loss_pred:0.02598302811384201, decouple_loss:0.006654896307736635
loss_pred:0.025887537747621536, decouple_loss:0.006760186981409788
2023-05-04 14:32:36 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7588081359863281, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7703835964202881, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7633110880851746, mean p set: 0.4500633478164673
loss_pred:0.025210905820131302, decouple_loss:0.007040428929030895
loss_pred:0.026701031252741814, decouple_loss:0.007312377914786339
loss_pred:0.025607844814658165, decouple_loss:0.007081934716552496
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026197172701358795, avg_mse: 0.03172875940799713
current test mse: 0.031729
Iteration: 651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766610860824585, gen p mean: -0.7625979781150818, mean p set: 0.44814640283584595
The modified gen p mean: 0.4478078782558441, gen p mean: -0.7703285217285156, mean p set: 0.4482881724834442
loss_pred:0.025831522420048714, decouple_loss:0.006741839461028576
loss_pred:0.025590479373931885, decouple_loss:0.006860701832920313
The modified gen p mean: 0.4471665024757385, gen p mean: -0.7594989538192749, mean p set: 0.44764676690101624
loss_pred:0.025996984913945198, decouple_loss:0.006625261623412371
Iteration: 652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481808841228485, gen p mean: -0.765552818775177, mean p set: 0.4486611485481262
loss_pred:0.025156743824481964, decouple_loss:0.006981574930250645
The modified gen p mean: 0.4465309977531433, gen p mean: -0.7536633610725403, mean p set: 0.4470112919807434
The modified gen p mean: 0.44640475511550903, gen p mean: -0.7558733224868774, mean p set: 0.44688504934310913
loss_pred:0.02448335289955139, decouple_loss:0.00687506003305316
loss_pred:0.025134088471531868, decouple_loss:0.006756115704774857
Iteration: 653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737738370895386, gen p mean: -0.7644404172897339, mean p set: 0.44785767793655396
The modified gen p mean: 0.44684135913848877, gen p mean: -0.7608192563056946, mean p set: 0.44732168316841125
loss_pred:0.026727057993412018, decouple_loss:0.006694199051707983
loss_pred:0.02490127459168434, decouple_loss:0.006795424036681652
The modified gen p mean: 0.44812074303627014, gen p mean: -0.763915479183197, mean p set: 0.44860100746154785
loss_pred:0.025447823107242584, decouple_loss:0.006728199776262045
Iteration: 654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473952651023865, gen p mean: -0.7644103765487671, mean p set: 0.4478755593299866
loss_pred:0.025639448314905167, decouple_loss:0.006806685123592615
The modified gen p mean: 0.44715988636016846, gen p mean: -0.7575932741165161, mean p set: 0.44764021039009094
The modified gen p mean: 0.44703614711761475, gen p mean: -0.7629380226135254, mean p set: 0.44751641154289246
loss_pred:0.026427341625094414, decouple_loss:0.006742678117007017
loss_pred:0.025204304605722427, decouple_loss:0.00652852701023221
Iteration: 655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446856826543808, gen p mean: -0.7548136115074158, mean p set: 0.4473371207714081
loss_pred:0.024185948073863983, decouple_loss:0.006747142411768436
The modified gen p mean: 0.4481477439403534, gen p mean: -0.7651092410087585, mean p set: 0.4486280083656311
The modified gen p mean: 0.44719359278678894, gen p mean: -0.7567301392555237, mean p set: 0.4476739168167114
loss_pred:0.02520476095378399, decouple_loss:0.006711538415402174
loss_pred:0.025917204096913338, decouple_loss:0.006625674199312925
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
NaN value num: 0
Iteration: 656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479018747806549, gen p mean: -0.7499470710754395, mean p set: 0.448382169008255
The modified gen p mean: 0.44732335209846497, gen p mean: -0.747506320476532, mean p set: 0.44780364632606506
The modified gen p mean: 0.4496905505657196, gen p mean: -0.7587858438491821, mean p set: 0.4501708745956421
loss_pred:0.025699764490127563, decouple_loss:0.007039180025458336
loss_pred:0.02503674477338791, decouple_loss:0.0074812923558056355
loss_pred:0.025620797649025917, decouple_loss:0.00712834857404232
Iteration: 657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480643570423126, gen p mean: -0.7557035088539124, mean p set: 0.4485446512699127
loss_pred:0.024967631325125694, decouple_loss:0.007072391454130411
The modified gen p mean: 0.4488028287887573, gen p mean: -0.7628187537193298, mean p set: 0.4492831230163574
The modified gen p mean: 0.4501236379146576, gen p mean: -0.7687268257141113, mean p set: 0.4506039321422577
loss_pred:0.024608178064227104, decouple_loss:0.00714347418397665
loss_pred:0.025001604110002518, decouple_loss:0.008108665235340595
Iteration: 658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495709240436554, gen p mean: -0.7666741013526917, mean p set: 0.4500511884689331
The modified gen p mean: 0.44751742482185364, gen p mean: -0.7619324326515198, mean p set: 0.44799768924713135
loss_pred:0.024860847741365433, decouple_loss:0.00746648944914341
loss_pred:0.025294296443462372, decouple_loss:0.007178644649684429
The modified gen p mean: 0.44963377714157104, gen p mean: -0.7609435319900513, mean p set: 0.45011407136917114
loss_pred:0.02578645572066307, decouple_loss:0.007858064956963062
Iteration: 659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512284994125366, gen p mean: -0.7641202807426453, mean p set: 0.4517087936401367
loss_pred:0.02576778270304203, decouple_loss:0.007624375633895397
The modified gen p mean: 0.44973331689834595, gen p mean: -0.7735109329223633, mean p set: 0.45021358132362366
The modified gen p mean: 0.44836822152137756, gen p mean: -0.7624085545539856, mean p set: 0.44884851574897766
loss_pred:0.023892560973763466, decouple_loss:0.007853449322283268
loss_pred:0.025721639394760132, decouple_loss:0.007031009066849947
Iteration: 660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502338469028473, gen p mean: -0.7629711627960205, mean p set: 0.450714111328125
loss_pred:0.023981833830475807, decouple_loss:0.007283162325620651
The modified gen p mean: 0.4500649571418762, gen p mean: -0.7603392601013184, mean p set: 0.45054522156715393
The modified gen p mean: 0.4509034752845764, gen p mean: -0.7666934728622437, mean p set: 0.4513837993144989
loss_pred:0.025995614007115364, decouple_loss:0.0072874403558671474
loss_pred:0.02443247102200985, decouple_loss:0.007171735633164644
2023-05-04 14:36:52 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.765508234500885, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7774225473403931, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7700735330581665, mean p set: 0.4500633478164673
loss_pred:0.02527809701859951, decouple_loss:0.0074672214686870575
loss_pred:0.02666264958679676, decouple_loss:0.007771063130348921
loss_pred:0.025620276108384132, decouple_loss:0.007570797577500343
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02623382769525051, avg_mse: 0.03194405138492584
current test mse: 0.031944
Iteration: 661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480181932449341, gen p mean: -0.7602838277816772, mean p set: 0.4484984576702118
The modified gen p mean: 0.45038384199142456, gen p mean: -0.7719410061836243, mean p set: 0.45086413621902466
loss_pred:0.02524605020880699, decouple_loss:0.007081655319780111
loss_pred:0.02446824684739113, decouple_loss:0.007122708950191736
The modified gen p mean: 0.4497394263744354, gen p mean: -0.7643623948097229, mean p set: 0.4502197206020355
loss_pred:0.0258681271225214, decouple_loss:0.007281715981662273
Iteration: 662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733551144599915, gen p mean: -0.7594457268714905, mean p set: 0.44781580567359924
The modified gen p mean: 0.4492908716201782, gen p mean: -0.7664071321487427, mean p set: 0.4497711658477783
loss_pred:0.02578769251704216, decouple_loss:0.007111806888133287
loss_pred:0.025978127494454384, decouple_loss:0.007219234015792608
The modified gen p mean: 0.45021918416023254, gen p mean: -0.7684333920478821, mean p set: 0.45069950819015503
loss_pred:0.02399750053882599, decouple_loss:0.00703675951808691
Iteration: 663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45052462816238403, gen p mean: -0.7706225514411926, mean p set: 0.45100489258766174
loss_pred:0.024771761149168015, decouple_loss:0.006973582785576582
The modified gen p mean: 0.4491611123085022, gen p mean: -0.7688922882080078, mean p set: 0.4496413767337799
The modified gen p mean: 0.4505389928817749, gen p mean: -0.7664348483085632, mean p set: 0.451019287109375
loss_pred:0.025399312376976013, decouple_loss:0.006982376798987389
loss_pred:0.024356678128242493, decouple_loss:0.006742455065250397
Iteration: 664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493815302848816, gen p mean: -0.7716538906097412, mean p set: 0.4498618245124817
The modified gen p mean: 0.4502882659435272, gen p mean: -0.7857025265693665, mean p set: 0.4507685601711273
loss_pred:0.02503165788948536, decouple_loss:0.00730740325525403
loss_pred:0.024883776903152466, decouple_loss:0.007744445465505123
The modified gen p mean: 0.44756880402565, gen p mean: -0.7635927200317383, mean p set: 0.4480490982532501
loss_pred:0.025536956265568733, decouple_loss:0.007500840350985527
Iteration: 665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45032647252082825, gen p mean: -0.7766526937484741, mean p set: 0.45080679655075073
The modified gen p mean: 0.4475097954273224, gen p mean: -0.7652204632759094, mean p set: 0.4479900598526001
loss_pred:0.02529788576066494, decouple_loss:0.0069526187144219875
loss_pred:0.026156028732657433, decouple_loss:0.007071652915328741
The modified gen p mean: 0.44767820835113525, gen p mean: -0.7678330540657043, mean p set: 0.44815847277641296
loss_pred:0.025089921429753304, decouple_loss:0.00693824328482151
Iteration: 666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447966068983078, gen p mean: -0.7667455077171326, mean p set: 0.4484463632106781
loss_pred:0.02459508739411831, decouple_loss:0.007056298200041056
The modified gen p mean: 0.4499267637729645, gen p mean: -0.7666230201721191, mean p set: 0.4504070580005646
The modified gen p mean: 0.4474199712276459, gen p mean: -0.7605357766151428, mean p set: 0.44790026545524597
loss_pred:0.02600906603038311, decouple_loss:0.007387996185570955
loss_pred:0.02502606250345707, decouple_loss:0.007432717364281416
Iteration: 667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960716366767883, gen p mean: -0.7680884599685669, mean p set: 0.45008742809295654
loss_pred:0.02482093870639801, decouple_loss:0.007233518175780773
The modified gen p mean: 0.4475921094417572, gen p mean: -0.7591013312339783, mean p set: 0.4480723738670349
The modified gen p mean: 0.449078768491745, gen p mean: -0.7628910541534424, mean p set: 0.4495590925216675
loss_pred:0.025292906910181046, decouple_loss:0.0071171848103404045
loss_pred:0.024677103385329247, decouple_loss:0.00734748225659132
Iteration: 668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44863617420196533, gen p mean: -0.7617737650871277, mean p set: 0.44911646842956543
The modified gen p mean: 0.4503447413444519, gen p mean: -0.7603381276130676, mean p set: 0.4508250057697296loss_pred:0.025132104754447937, decouple_loss:0.007066352292895317
The modified gen p mean: 0.44969457387924194, gen p mean: -0.7620885968208313, mean p set: 0.45017489790916443
loss_pred:0.026011398062109947, decouple_loss:0.007154800929129124
loss_pred:0.025101369246840477, decouple_loss:0.0071802265010774136
Iteration: 669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502367079257965, gen p mean: -0.7635880708694458, mean p set: 0.4507170021533966
The modified gen p mean: 0.44783496856689453, gen p mean: -0.755759596824646, mean p set: 0.44831526279449463
loss_pred:0.025325974449515343, decouple_loss:0.0070876856334507465
loss_pred:0.026013802736997604, decouple_loss:0.006987396627664566
The modified gen p mean: 0.45033854246139526, gen p mean: -0.7641246914863586, mean p set: 0.450818806886673
loss_pred:0.025762800127267838, decouple_loss:0.007065418642014265
Iteration: 670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505366384983063, gen p mean: -0.7660636901855469, mean p set: 0.45101693272590637
loss_pred:0.023869100958108902, decouple_loss:0.007419920526444912
The modified gen p mean: 0.4482101798057556, gen p mean: -0.764691174030304, mean p set: 0.4486904740333557
The modified gen p mean: 0.44751399755477905, gen p mean: -0.7625030875205994, mean p set: 0.44799432158470154
loss_pred:0.02425699308514595, decouple_loss:0.007052435539662838
loss_pred:0.02473241090774536, decouple_loss:0.006975114345550537
2023-05-04 14:40:24 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7698829770088196, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7748016119003296, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7822579741477966, mean p set: 0.4502691626548767
loss_pred:0.025324832648038864, decouple_loss:0.007377896457910538
loss_pred:0.025737881660461426, decouple_loss:0.007280068937689066
loss_pred:0.026740338653326035, decouple_loss:0.0076483264565467834
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026306122541427612, avg_mse: 0.03217325359582901
current test mse: 0.032173
Iteration: 671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492204189300537, gen p mean: -0.7677391171455383, mean p set: 0.4497006833553314
The modified gen p mean: 0.4510071277618408, gen p mean: -0.7699617743492126, mean p set: 0.45148739218711853
loss_pred:0.026014650240540504, decouple_loss:0.0068870545364916325
loss_pred:0.025517916306853294, decouple_loss:0.007375052198767662
The modified gen p mean: 0.44779157638549805, gen p mean: -0.7688238024711609, mean p set: 0.44827190041542053
loss_pred:0.024491695687174797, decouple_loss:0.006802066694945097
Iteration: 672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45021116733551025, gen p mean: -0.7734158635139465, mean p set: 0.45069149136543274
loss_pred:0.025843841955065727, decouple_loss:0.007167826872318983
The modified gen p mean: 0.4500119984149933, gen p mean: -0.7906532883644104, mean p set: 0.45049232244491577
The modified gen p mean: 0.4497472047805786, gen p mean: -0.7884971499443054, mean p set: 0.4502274990081787
loss_pred:0.024445578455924988, decouple_loss:0.007618567440658808
loss_pred:0.023964468389749527, decouple_loss:0.007413696497678757
Iteration: 673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823694229125977, gen p mean: -0.7657972574234009, mean p set: 0.44871723651885986
loss_pred:0.02544058859348297, decouple_loss:0.0068951924331486225
The modified gen p mean: 0.4476509690284729, gen p mean: -0.764128565788269, mean p set: 0.4481312930583954
The modified gen p mean: 0.45018360018730164, gen p mean: -0.7693509459495544, mean p set: 0.45066389441490173
loss_pred:0.025281589478254318, decouple_loss:0.0067883701995015144
loss_pred:0.025261128321290016, decouple_loss:0.006885628215968609
Iteration: 674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480859339237213, gen p mean: -0.7604114413261414, mean p set: 0.4485662281513214
The modified gen p mean: 0.45018166303634644, gen p mean: -0.7755655646324158, mean p set: 0.4506619870662689
loss_pred:0.02550269290804863, decouple_loss:0.006930443923920393
loss_pred:0.02498549222946167, decouple_loss:0.0072382474318146706
The modified gen p mean: 0.44820454716682434, gen p mean: -0.7637749910354614, mean p set: 0.44868484139442444
loss_pred:0.02475692890584469, decouple_loss:0.006612733006477356
Iteration: 675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768673181533813, gen p mean: -0.7484739422798157, mean p set: 0.44816699624061584
loss_pred:0.025249626487493515, decouple_loss:0.00687316944822669
The modified gen p mean: 0.447935551404953, gen p mean: -0.7542688846588135, mean p set: 0.4484158456325531
The modified gen p mean: 0.44882696866989136, gen p mean: -0.7594797611236572, mean p set: 0.44930723309516907
loss_pred:0.025179820135235786, decouple_loss:0.006845525931566954
loss_pred:0.02489415742456913, decouple_loss:0.006974160671234131
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468212425708771, gen p mean: -0.7638201117515564, mean p set: 0.44730156660079956
The modified gen p mean: 0.44678205251693726, gen p mean: -0.770535945892334, mean p set: 0.44726231694221497
loss_pred:0.026466965675354004, decouple_loss:0.008414182811975479
The modified gen p mean: 0.44605761766433716, gen p mean: -0.7672426700592041, mean p set: 0.44653791189193726
loss_pred:0.028222938999533653, decouple_loss:0.008738060481846333
loss_pred:0.02735939435660839, decouple_loss:0.008716297335922718
Iteration: 677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44530776143074036, gen p mean: -0.785899817943573, mean p set: 0.44578808546066284
The modified gen p mean: 0.44734692573547363, gen p mean: -0.7983226776123047, mean p set: 0.44782721996307373
loss_pred:0.04154616594314575, decouple_loss:0.08483985811471939
loss_pred:0.041326191276311874, decouple_loss:0.08817990869283676
The modified gen p mean: 0.44517549872398376, gen p mean: -0.7873522639274597, mean p set: 0.44565579295158386
loss_pred:0.041815001517534256, decouple_loss:0.08574458956718445
Iteration: 678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44651535153388977, gen p mean: -0.6971602439880371, mean p set: 0.44699564576148987
The modified gen p mean: 0.44694983959198, gen p mean: -0.7009377479553223, mean p set: 0.4474301338195801
loss_pred:0.061063501983881, decouple_loss:0.21669380366802216
loss_pred:0.06200535222887993, decouple_loss:0.2204791009426117
The modified gen p mean: 0.44610631465911865, gen p mean: -0.6947385668754578, mean p set: 0.44658660888671875
loss_pred:0.06084572896361351, decouple_loss:0.21749022603034973
Iteration: 679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456709921360016, gen p mean: -0.7745377421379089, mean p set: 0.4461512565612793The modified gen p mean: 0.4463663399219513, gen p mean: -0.773754358291626, mean p set: 0.446846604347229
loss_pred:0.07711669057607651, decouple_loss:0.19317539036273956loss_pred:0.07663379609584808, decouple_loss:0.19538889825344086
The modified gen p mean: 0.44705235958099365, gen p mean: -0.7747746706008911, mean p set: 0.44753265380859375
loss_pred:0.07624060660600662, decouple_loss:0.19140037894248962
Iteration: 680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465217888355255, gen p mean: -0.5684589147567749, mean p set: 0.4470020830631256
loss_pred:0.07636874169111252, decouple_loss:0.5387887358665466
The modified gen p mean: 0.4467865526676178, gen p mean: -0.5685905814170837, mean p set: 0.4472668468952179
The modified gen p mean: 0.44715139269828796, gen p mean: -0.5686920285224915, mean p set: 0.4476316571235657
loss_pred:0.07921531796455383, decouple_loss:0.534447431564331
loss_pred:0.07769220322370529, decouple_loss:0.5365586280822754
2023-05-04 14:44:35 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.9856103658676147, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.9885904788970947, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.9880396723747253, mean p set: 0.4502691626548767
loss_pred:0.10006295144557953, decouple_loss:0.26572126150131226
loss_pred:0.09906399250030518, decouple_loss:0.2652934789657593
loss_pred:0.09819884598255157, decouple_loss:0.26874682307243347
WV_0_PC_1_EH_0_PS_40_6, loss: 0.11243795603513718, avg_mse: 0.10319539904594421
current test mse: 0.103195
Iteration: 681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758808612823486, gen p mean: -0.9861828684806824, mean p set: 0.44806838035583496
The modified gen p mean: 0.4477647542953491, gen p mean: -0.9854156374931335, mean p set: 0.4482450783252716
loss_pred:0.09875397384166718, decouple_loss:0.26680460572242737
loss_pred:0.10072489082813263, decouple_loss:0.2678196430206299
The modified gen p mean: 0.446565717458725, gen p mean: -0.9901782870292664, mean p set: 0.44704607129096985
loss_pred:0.09754211455583572, decouple_loss:0.26521599292755127
Iteration: 682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643449783325195, gen p mean: -0.612794041633606, mean p set: 0.44691479206085205
loss_pred:0.07137114554643631, decouple_loss:0.304654598236084
The modified gen p mean: 0.4463392496109009, gen p mean: -0.6106651425361633, mean p set: 0.446819543838501
The modified gen p mean: 0.4466235041618347, gen p mean: -0.6108981966972351, mean p set: 0.4471038281917572
loss_pred:0.07285265624523163, decouple_loss:0.29785555601119995
loss_pred:0.07209917902946472, decouple_loss:0.30203166604042053
Iteration: 683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470166862010956, gen p mean: -0.6268684267997742, mean p set: 0.44749704003334045
The modified gen p mean: 0.44679540395736694, gen p mean: -0.6243436932563782, mean p set: 0.44727569818496704
loss_pred:0.07479044049978256, decouple_loss:0.2708209455013275
loss_pred:0.07471484690904617, decouple_loss:0.26673829555511475
The modified gen p mean: 0.44725301861763, gen p mean: -0.6274495124816895, mean p set: 0.4477333426475525
loss_pred:0.07569406181573868, decouple_loss:0.27026161551475525
Iteration: 684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770076870918274, gen p mean: -0.5984257459640503, mean p set: 0.44818106293678284
The modified gen p mean: 0.4460671544075012, gen p mean: -0.5952256917953491, mean p set: 0.4465474784374237
loss_pred:0.05991420894861221, decouple_loss:0.32636573910713196
loss_pred:0.06172079220414162, decouple_loss:0.3116520643234253
The modified gen p mean: 0.44657978415489197, gen p mean: -0.5923415422439575, mean p set: 0.44706007838249207
loss_pred:0.06161630153656006, decouple_loss:0.3119550049304962
Iteration: 685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44674137234687805, gen p mean: -0.730569064617157, mean p set: 0.44722166657447815
The modified gen p mean: 0.44611552357673645, gen p mean: -0.7314885258674622, mean p set: 0.44659578800201416
loss_pred:0.06363550573587418, decouple_loss:0.22285370528697968
loss_pred:0.06378673762083054, decouple_loss:0.22227329015731812
The modified gen p mean: 0.4464333653450012, gen p mean: -0.7336706519126892, mean p set: 0.44691362977027893
loss_pred:0.06361237913370132, decouple_loss:0.2256525158882141
Iteration: 686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44632676243782043, gen p mean: -0.5925784707069397, mean p set: 0.44680705666542053
The modified gen p mean: 0.4466868042945862, gen p mean: -0.5959610342979431, mean p set: 0.4471670687198639
loss_pred:0.06857603788375854, decouple_loss:0.20190228521823883
loss_pred:0.06178564578294754, decouple_loss:0.20574872195720673
The modified gen p mean: 0.44671717286109924, gen p mean: -0.5912227034568787, mean p set: 0.44719746708869934
loss_pred:0.06785959005355835, decouple_loss:0.20987814664840698
Iteration: 687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698435068130493, gen p mean: -0.6667535901069641, mean p set: 0.44746461510658264
The modified gen p mean: 0.4452042877674103, gen p mean: -0.6641194820404053, mean p set: 0.4456845819950104
loss_pred:0.06260774284601212, decouple_loss:0.19594819843769073
loss_pred:0.06484347581863403, decouple_loss:0.1951419860124588
The modified gen p mean: 0.44756370782852173, gen p mean: -0.6686280965805054, mean p set: 0.4480440020561218
loss_pred:0.06171206012368202, decouple_loss:0.19859442114830017
Iteration: 688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44634103775024414, gen p mean: -0.6745623350143433, mean p set: 0.44682133197784424
The modified gen p mean: 0.446666419506073, gen p mean: -0.6741576194763184, mean p set: 0.4471467435359955
loss_pred:0.06445172429084778, decouple_loss:0.1941271275281906
loss_pred:0.06272102147340775, decouple_loss:0.1870660036802292
The modified gen p mean: 0.44712939858436584, gen p mean: -0.6742910742759705, mean p set: 0.44760966300964355
loss_pred:0.06362611055374146, decouple_loss:0.19018855690956116
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681304693222046, gen p mean: -0.679040789604187, mean p set: 0.44729331135749817
loss_pred:0.05925783887505531, decouple_loss:0.15245556831359863
The modified gen p mean: 0.4468015134334564, gen p mean: -0.6808374524116516, mean p set: 0.44728177785873413
The modified gen p mean: 0.44794607162475586, gen p mean: -0.6824864149093628, mean p set: 0.44842633605003357
loss_pred:0.058662060648202896, decouple_loss:0.15629863739013672
loss_pred:0.06039397045969963, decouple_loss:0.15778669714927673
Iteration: 690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759318232536316, gen p mean: -0.6431511640548706, mean p set: 0.44807347655296326
loss_pred:0.05621999129652977, decouple_loss:0.13588553667068481
The modified gen p mean: 0.44688060879707336, gen p mean: -0.6463584899902344, mean p set: 0.4473608434200287
The modified gen p mean: 0.44700536131858826, gen p mean: -0.6471946835517883, mean p set: 0.44748565554618835
loss_pred:0.05763339251279831, decouple_loss:0.1404867321252823
loss_pred:0.057527296245098114, decouple_loss:0.14087559282779694
2023-05-04 14:48:07 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6310746669769287, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6297174096107483, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.6313496828079224, mean p set: 0.4502691626548767
loss_pred:0.055425021797418594, decouple_loss:0.12539522349834442
loss_pred:0.054569363594055176, decouple_loss:0.12562119960784912
loss_pred:0.05682701990008354, decouple_loss:0.12636397778987885
WV_0_PC_1_EH_0_PS_40_6, loss: 0.06189681217074394, avg_mse: 0.056139685213565826
current test mse: 0.05614
Iteration: 691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472448527812958, gen p mean: -0.6311661601066589, mean p set: 0.4477251172065735
The modified gen p mean: 0.44680383801460266, gen p mean: -0.6329073309898376, mean p set: 0.44728413224220276
loss_pred:0.05518336966633797, decouple_loss:0.1264621764421463
loss_pred:0.0529131218791008, decouple_loss:0.12351305037736893
The modified gen p mean: 0.44666972756385803, gen p mean: -0.6334894299507141, mean p set: 0.4471500515937805
loss_pred:0.05369928479194641, decouple_loss:0.12684327363967896
Iteration: 692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484494924545288, gen p mean: -0.6223616003990173, mean p set: 0.4489297568798065
The modified gen p mean: 0.44740480184555054, gen p mean: -0.6202846169471741, mean p set: 0.44788506627082825
loss_pred:0.05407233163714409, decouple_loss:0.12336135655641556
loss_pred:0.05366390570998192, decouple_loss:0.11788640916347504
The modified gen p mean: 0.4461234509944916, gen p mean: -0.6222196221351624, mean p set: 0.4466037154197693
loss_pred:0.05361250042915344, decouple_loss:0.12225187569856644
Iteration: 693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468703269958496, gen p mean: -0.5905275344848633, mean p set: 0.4473506212234497
The modified gen p mean: 0.4469769299030304, gen p mean: -0.5887645483016968, mean p set: 0.4474572241306305loss_pred:0.05388448014855385, decouple_loss:0.1047908365726471
The modified gen p mean: 0.4467034637928009, gen p mean: -0.5936279892921448, mean p set: 0.447183758020401
loss_pred:0.05174604803323746, decouple_loss:0.10293005406856537
loss_pred:0.05313354358077049, decouple_loss:0.10520179569721222
Iteration: 694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453771114349365, gen p mean: -0.5808934569358826, mean p set: 0.445857435464859
The modified gen p mean: 0.44661515951156616, gen p mean: -0.5855993032455444, mean p set: 0.44709545373916626
loss_pred:0.05345014110207558, decouple_loss:0.09697360545396805
loss_pred:0.05069931596517563, decouple_loss:0.09634821116924286
The modified gen p mean: 0.4459965229034424, gen p mean: -0.5839666724205017, mean p set: 0.44647684693336487
loss_pred:0.05372704565525055, decouple_loss:0.09527797251939774
Iteration: 695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446519672870636, gen p mean: -0.5821065306663513, mean p set: 0.4469999372959137The modified gen p mean: 0.446099191904068, gen p mean: -0.5822919607162476, mean p set: 0.4465794563293457
loss_pred:0.05256856232881546, decouple_loss:0.09043660014867783loss_pred:0.04973553493618965, decouple_loss:0.09093475341796875
The modified gen p mean: 0.4470561742782593, gen p mean: -0.5845456719398499, mean p set: 0.4475364685058594
loss_pred:0.04789704456925392, decouple_loss:0.09228585660457611
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
NaN value num: 0
Iteration: 696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45127907395362854, gen p mean: -0.5695520043373108, mean p set: 0.45175933837890625
The modified gen p mean: 0.4507195055484772, gen p mean: -0.5704849362373352, mean p set: 0.4511997699737549
loss_pred:0.05430220440030098, decouple_loss:0.08708588033914566
The modified gen p mean: 0.45180192589759827, gen p mean: -0.5694979429244995, mean p set: 0.452282190322876
loss_pred:0.052426088601350784, decouple_loss:0.08588350564241409
loss_pred:0.05390433594584465, decouple_loss:0.08793427795171738
Iteration: 697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506078064441681, gen p mean: -0.5726271271705627, mean p set: 0.4510881304740906
The modified gen p mean: 0.4527312219142914, gen p mean: -0.5728650689125061, mean p set: 0.4532114863395691
loss_pred:0.054417598992586136, decouple_loss:0.08667518943548203
loss_pred:0.053565334528684616, decouple_loss:0.08459360152482986
The modified gen p mean: 0.4537576138973236, gen p mean: -0.5745172500610352, mean p set: 0.4542378783226013
loss_pred:0.05320519208908081, decouple_loss:0.08638984709978104
Iteration: 698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504154622554779, gen p mean: -0.5688738226890564, mean p set: 0.4508957266807556
The modified gen p mean: 0.4514560103416443, gen p mean: -0.5637215375900269, mean p set: 0.451936274766922
loss_pred:0.05059726908802986, decouple_loss:0.07808302342891693
loss_pred:0.053308092057704926, decouple_loss:0.07705917209386826
The modified gen p mean: 0.45318588614463806, gen p mean: -0.5675152540206909, mean p set: 0.45366615056991577
loss_pred:0.05350791662931442, decouple_loss:0.07745861262083054
Iteration: 699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451896607875824, gen p mean: -0.5534103512763977, mean p set: 0.4523768723011017
The modified gen p mean: 0.45042166113853455, gen p mean: -0.5497240424156189, mean p set: 0.45090195536613464
loss_pred:0.04714782163500786, decouple_loss:0.07974223047494888
loss_pred:0.050240375101566315, decouple_loss:0.0819689929485321
The modified gen p mean: 0.45307889580726624, gen p mean: -0.55574631690979, mean p set: 0.45355919003486633
loss_pred:0.05240333452820778, decouple_loss:0.07859992980957031
Iteration: 700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495961666107178, gen p mean: -0.5707483291625977, mean p set: 0.4500764310359955
The modified gen p mean: 0.45190170407295227, gen p mean: -0.5749403834342957, mean p set: 0.45238202810287476
loss_pred:0.050008129328489304, decouple_loss:0.07533614337444305
loss_pred:0.046464040875434875, decouple_loss:0.07437480241060257
The modified gen p mean: 0.45113590359687805, gen p mean: -0.5721060633659363, mean p set: 0.45161619782447815
loss_pred:0.050238050520420074, decouple_loss:0.07659175992012024
2023-05-04 14:52:28 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5479043126106262, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5519000291824341, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5466611385345459, mean p set: 0.4500633478164673
loss_pred:0.05028117075562477, decouple_loss:0.07630284130573273loss_pred:0.04733337089419365, decouple_loss:0.07232783734798431
loss_pred:0.04822162911295891, decouple_loss:0.0739281177520752
WV_0_PC_1_EH_0_PS_40_6, loss: 0.05232137069106102, avg_mse: 0.05024954676628113
current test mse: 0.05025
Iteration: 701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534457325935364, gen p mean: -0.5432325601577759, mean p set: 0.4539260268211365
The modified gen p mean: 0.4504041075706482, gen p mean: -0.5496349334716797, mean p set: 0.4508844316005707
loss_pred:0.04794701188802719, decouple_loss:0.07030195742845535
loss_pred:0.04490439593791962, decouple_loss:0.07118051499128342
The modified gen p mean: 0.4525775909423828, gen p mean: -0.5556138157844543, mean p set: 0.4530578553676605
loss_pred:0.05170699208974838, decouple_loss:0.07283617556095123
Iteration: 702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519626796245575, gen p mean: -0.5548417568206787, mean p set: 0.4524429440498352
loss_pred:0.045536864548921585, decouple_loss:0.07332488894462585
The modified gen p mean: 0.4533480405807495, gen p mean: -0.5619466304779053, mean p set: 0.4538283348083496The modified gen p mean: 0.4499393105506897, gen p mean: -0.5625353455543518, mean p set: 0.4504196047782898
loss_pred:0.04345109686255455, decouple_loss:0.06788269430398941
loss_pred:0.04845288023352623, decouple_loss:0.07193636894226074
Iteration: 703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502507448196411, gen p mean: -0.5681381225585938, mean p set: 0.4507310390472412
The modified gen p mean: 0.4502141773700714, gen p mean: -0.5691400170326233, mean p set: 0.4506944417953491
loss_pred:0.04729633405804634, decouple_loss:0.06489014625549316
loss_pred:0.04689105600118637, decouple_loss:0.06502948701381683
The modified gen p mean: 0.4531592130661011, gen p mean: -0.57330721616745, mean p set: 0.45363950729370117
loss_pred:0.04659805819392204, decouple_loss:0.0656081810593605
Iteration: 704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45145145058631897, gen p mean: -0.5509212017059326, mean p set: 0.4519317150115967
The modified gen p mean: 0.45120465755462646, gen p mean: -0.5443537831306458, mean p set: 0.45168498158454895
loss_pred:0.04766731709241867, decouple_loss:0.06068949028849602
loss_pred:0.0460769385099411, decouple_loss:0.060862112790346146
The modified gen p mean: 0.4533970355987549, gen p mean: -0.549228310585022, mean p set: 0.4538773000240326
loss_pred:0.04749106615781784, decouple_loss:0.06227879971265793
Iteration: 705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45320290327072144, gen p mean: -0.5881349444389343, mean p set: 0.4536832273006439
The modified gen p mean: 0.4541676640510559, gen p mean: -0.5949193835258484, mean p set: 0.454647958278656
loss_pred:0.04428187012672424, decouple_loss:0.060373805463314056
loss_pred:0.04411202296614647, decouple_loss:0.061429258435964584
The modified gen p mean: 0.4521729052066803, gen p mean: -0.5952200293540955, mean p set: 0.452653169631958
loss_pred:0.045684464275836945, decouple_loss:0.059314846992492676
Iteration: 706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498823881149292, gen p mean: -0.5542755722999573, mean p set: 0.4503626525402069
loss_pred:0.04291614145040512, decouple_loss:0.05889738351106644
The modified gen p mean: 0.4505513906478882, gen p mean: -0.5578857660293579, mean p set: 0.4510316848754883
The modified gen p mean: 0.4529380202293396, gen p mean: -0.5619447231292725, mean p set: 0.4534182846546173
loss_pred:0.04367620870471001, decouple_loss:0.059564296156167984
loss_pred:0.04625493288040161, decouple_loss:0.05949398875236511
Iteration: 707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519538879394531, gen p mean: -0.5509983897209167, mean p set: 0.4524341821670532
loss_pred:0.04154347628355026, decouple_loss:0.05719151720404625
The modified gen p mean: 0.45496630668640137, gen p mean: -0.5589385032653809, mean p set: 0.45544660091400146
The modified gen p mean: 0.4515368342399597, gen p mean: -0.5446175932884216, mean p set: 0.4520170986652374
loss_pred:0.04269639030098915, decouple_loss:0.05874752625823021
loss_pred:0.04278970882296562, decouple_loss:0.05672464147210121
Iteration: 708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963768124580383, gen p mean: -0.5575093626976013, mean p set: 0.45011797547340393
The modified gen p mean: 0.453291118144989, gen p mean: -0.5595958828926086, mean p set: 0.4537713825702667
loss_pred:0.038617171347141266, decouple_loss:0.05482764169573784
loss_pred:0.04164572432637215, decouple_loss:0.05494502931833267
The modified gen p mean: 0.4530724287033081, gen p mean: -0.5653034448623657, mean p set: 0.4535527229309082
loss_pred:0.04469211772084236, decouple_loss:0.053246814757585526
Iteration: 709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45206934213638306, gen p mean: -0.5262914896011353, mean p set: 0.45254963636398315
loss_pred:0.04205616936087608, decouple_loss:0.0568588525056839
The modified gen p mean: 0.45349952578544617, gen p mean: -0.5365922451019287, mean p set: 0.45397984981536865The modified gen p mean: 0.45238861441612244, gen p mean: -0.5323621034622192, mean p set: 0.45286890864372253
loss_pred:0.04407856985926628, decouple_loss:0.05826703831553459
loss_pred:0.03911389037966728, decouple_loss:0.05720356106758118
Iteration: 710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4548651874065399, gen p mean: -0.5840044021606445, mean p set: 0.45534548163414
loss_pred:0.04001085087656975, decouple_loss:0.05664926394820213
The modified gen p mean: 0.4530890882015228, gen p mean: -0.5747882127761841, mean p set: 0.4535693824291229
The modified gen p mean: 0.4501403272151947, gen p mean: -0.5751532316207886, mean p set: 0.4506206214427948
loss_pred:0.04196593910455704, decouple_loss:0.05214687064290047
loss_pred:0.039105553179979324, decouple_loss:0.05238492786884308
2023-05-04 14:56:02 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5464575290679932, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5553106665611267, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830237865448, gen p mean: -0.5478963255882263, mean p set: 0.4500633478164673
loss_pred:0.04155871644616127, decouple_loss:0.052728962153196335
loss_pred:0.04414508119225502, decouple_loss:0.0562586784362793
loss_pred:0.04229738563299179, decouple_loss:0.053990207612514496
WV_0_PC_1_EH_0_PS_40_6, loss: 0.045383356511592865, avg_mse: 0.046012766659259796
current test mse: 0.046013
Iteration: 711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45085054636001587, gen p mean: -0.5449685454368591, mean p set: 0.4513308107852936The modified gen p mean: 0.4508812725543976, gen p mean: -0.5479831695556641, mean p set: 0.45136159658432007
loss_pred:0.04010359197854996, decouple_loss:0.053184960037469864loss_pred:0.040106166154146194, decouple_loss:0.05429191514849663
The modified gen p mean: 0.4537471532821655, gen p mean: -0.5479258894920349, mean p set: 0.45422741770744324
loss_pred:0.0409238338470459, decouple_loss:0.05172872543334961
Iteration: 712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496065676212311, gen p mean: -0.5499047636985779, mean p set: 0.4500868618488312
loss_pred:0.03631429374217987, decouple_loss:0.0475330613553524
The modified gen p mean: 0.451791375875473, gen p mean: -0.544866681098938, mean p set: 0.45227164030075073
The modified gen p mean: 0.4521256983280182, gen p mean: -0.5501444339752197, mean p set: 0.4526059925556183
loss_pred:0.04169168323278427, decouple_loss:0.04969164356589317
loss_pred:0.04117993265390396, decouple_loss:0.04754762724041939
Iteration: 713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521179795265198, gen p mean: -0.5433583855628967, mean p set: 0.45259830355644226
The modified gen p mean: 0.45300745964050293, gen p mean: -0.5510051250457764, mean p set: 0.453487753868103
loss_pred:0.040117014199495316, decouple_loss:0.04870126396417618
loss_pred:0.03941461071372032, decouple_loss:0.046347495168447495
The modified gen p mean: 0.452873170375824, gen p mean: -0.5463439226150513, mean p set: 0.4533534646034241
loss_pred:0.04027813673019409, decouple_loss:0.04601031914353371
Iteration: 714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45099908113479614, gen p mean: -0.554376482963562, mean p set: 0.45147937536239624
loss_pred:0.0374876968562603, decouple_loss:0.047889333218336105
The modified gen p mean: 0.4523985683917999, gen p mean: -0.5621774792671204, mean p set: 0.45287883281707764
The modified gen p mean: 0.4540480971336365, gen p mean: -0.5629054307937622, mean p set: 0.4545283913612366
loss_pred:0.03597262129187584, decouple_loss:0.04680941253900528
loss_pred:0.03668077290058136, decouple_loss:0.04824374243617058
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
NaN value num: 0
Iteration: 715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498899281024933, gen p mean: -0.5561325550079346, mean p set: 0.45037025213241577
The modified gen p mean: 0.45121562480926514, gen p mean: -0.5499285459518433, mean p set: 0.4516959488391876
loss_pred:0.03850511461496353, decouple_loss:0.046454958617687225
The modified gen p mean: 0.4489753246307373, gen p mean: -0.5553284287452698, mean p set: 0.4494556486606598
loss_pred:0.04051973298192024, decouple_loss:0.049114007502794266
loss_pred:0.039036598056554794, decouple_loss:0.04549786448478699
Iteration: 716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510286748409271, gen p mean: -0.562957227230072, mean p set: 0.4515089690685272
loss_pred:0.03964431211352348, decouple_loss:0.046938396990299225
The modified gen p mean: 0.4502315819263458, gen p mean: -0.5587012767791748, mean p set: 0.4507118761539459
The modified gen p mean: 0.4511455297470093, gen p mean: -0.5511259436607361, mean p set: 0.451625794172287
loss_pred:0.03983442857861519, decouple_loss:0.049098141491413116
loss_pred:0.0372878722846508, decouple_loss:0.044845666736364365
Iteration: 717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498940706253052, gen p mean: -0.5382545590400696, mean p set: 0.45037439465522766
The modified gen p mean: 0.4510977864265442, gen p mean: -0.5298464298248291, mean p set: 0.4515781104564667loss_pred:0.0377717986702919, decouple_loss:0.045947734266519547
The modified gen p mean: 0.450753778219223, gen p mean: -0.5381833910942078, mean p set: 0.4512340724468231
loss_pred:0.037257883697748184, decouple_loss:0.04446829482913017
loss_pred:0.03938905894756317, decouple_loss:0.04809614643454552
Iteration: 718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44880664348602295, gen p mean: -0.5656556487083435, mean p set: 0.44928696751594543
The modified gen p mean: 0.45169180631637573, gen p mean: -0.5653777718544006, mean p set: 0.45217210054397583
loss_pred:0.036935996264219284, decouple_loss:0.046606820076704025
loss_pred:0.038901858031749725, decouple_loss:0.04628138616681099
The modified gen p mean: 0.45094335079193115, gen p mean: -0.5656196475028992, mean p set: 0.45142364501953125
loss_pred:0.03759550675749779, decouple_loss:0.04502808302640915
Iteration: 719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962865114212036, gen p mean: -0.5640019774436951, mean p set: 0.45010891556739807
The modified gen p mean: 0.45008283853530884, gen p mean: -0.5492962002754211, mean p set: 0.4505631625652313
loss_pred:0.03803088888525963, decouple_loss:0.04367133602499962
loss_pred:0.03616601973772049, decouple_loss:0.04097475856542587
The modified gen p mean: 0.45132601261138916, gen p mean: -0.5583562254905701, mean p set: 0.45180633664131165
loss_pred:0.03837776184082031, decouple_loss:0.04164758324623108
Iteration: 720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45015203952789307, gen p mean: -0.5498682856559753, mean p set: 0.4506323039531708
loss_pred:0.037164539098739624, decouple_loss:0.04455545172095299
The modified gen p mean: 0.4523484706878662, gen p mean: -0.5459631085395813, mean p set: 0.4528287649154663
The modified gen p mean: 0.4504311978816986, gen p mean: -0.542802095413208, mean p set: 0.4509114921092987
loss_pred:0.036268964409828186, decouple_loss:0.04417640343308449
loss_pred:0.0350436307489872, decouple_loss:0.04451223462820053
2023-05-04 15:00:25 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5429782867431641, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.5518253445625305, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5452917218208313, mean p set: 0.4500633478164673
loss_pred:0.036297354847192764, decouple_loss:0.04457354545593262
loss_pred:0.03862564265727997, decouple_loss:0.04693218320608139
loss_pred:0.037296779453754425, decouple_loss:0.04509351775050163
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03968324884772301, avg_mse: 0.04212140664458275
current test mse: 0.042121
Iteration: 721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45040568709373474, gen p mean: -0.5492792725563049, mean p set: 0.4508860111236572
The modified gen p mean: 0.4513000547885895, gen p mean: -0.5513817667961121, mean p set: 0.4517803192138672
loss_pred:0.03643388673663139, decouple_loss:0.045693282037973404loss_pred:0.0376848541200161, decouple_loss:0.043668974190950394
The modified gen p mean: 0.4495391845703125, gen p mean: -0.5492652058601379, mean p set: 0.4500194787979126
loss_pred:0.03597252443432808, decouple_loss:0.043246977031230927
Iteration: 722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493047595024109, gen p mean: -0.5510499477386475, mean p set: 0.449785053730011
loss_pred:0.03751072287559509, decouple_loss:0.03951958566904068
The modified gen p mean: 0.45228272676467896, gen p mean: -0.5442898869514465, mean p set: 0.45276302099227905
The modified gen p mean: 0.4487839937210083, gen p mean: -0.5433051586151123, mean p set: 0.4492642879486084
loss_pred:0.03672757372260094, decouple_loss:0.03938803821802139
loss_pred:0.03577558696269989, decouple_loss:0.039401136338710785
Iteration: 723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519163966178894, gen p mean: -0.5556288957595825, mean p set: 0.4523966908454895
The modified gen p mean: 0.45189952850341797, gen p mean: -0.5519365072250366, mean p set: 0.4523797929286957
loss_pred:0.03493517264723778, decouple_loss:0.03873210772871971
loss_pred:0.03526799753308296, decouple_loss:0.03932414948940277
The modified gen p mean: 0.4499926269054413, gen p mean: -0.563923716545105, mean p set: 0.4504729211330414
loss_pred:0.03632785379886627, decouple_loss:0.037852220237255096
Iteration: 724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523080587387085, gen p mean: -0.5668002367019653, mean p set: 0.452788382768631
The modified gen p mean: 0.45046737790107727, gen p mean: -0.5758552551269531, mean p set: 0.45094767212867737
loss_pred:0.03548474982380867, decouple_loss:0.037255287170410156
loss_pred:0.03881103917956352, decouple_loss:0.0393383726477623
The modified gen p mean: 0.44841817021369934, gen p mean: -0.5720494389533997, mean p set: 0.44889846444129944
loss_pred:0.03750472888350487, decouple_loss:0.04035871475934982
Iteration: 725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856712222099304, gen p mean: -0.5740782618522644, mean p set: 0.44904741644859314
The modified gen p mean: 0.4499150216579437, gen p mean: -0.5838446617126465, mean p set: 0.4503953158855438loss_pred:0.037229023873806, decouple_loss:0.03627437353134155
The modified gen p mean: 0.4502875506877899, gen p mean: -0.5759222507476807, mean p set: 0.4507678747177124
loss_pred:0.035653334110975266, decouple_loss:0.03753369674086571
loss_pred:0.034083761274814606, decouple_loss:0.03747247904539108
Iteration: 726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45015671849250793, gen p mean: -0.5801153182983398, mean p set: 0.4506370425224304
The modified gen p mean: 0.44933953881263733, gen p mean: -0.5819987654685974, mean p set: 0.4498198330402374
loss_pred:0.03780088946223259, decouple_loss:0.038185905665159225
The modified gen p mean: 0.45190510153770447, gen p mean: -0.5743153691291809, mean p set: 0.4523853361606598
loss_pred:0.035257063806056976, decouple_loss:0.03925849497318268
loss_pred:0.035386621952056885, decouple_loss:0.039457887411117554
Iteration: 727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451698362827301, gen p mean: -0.544285774230957, mean p set: 0.4521786570549011
The modified gen p mean: 0.4505697190761566, gen p mean: -0.5501965880393982, mean p set: 0.4510500431060791
loss_pred:0.033518169075250626, decouple_loss:0.037244945764541626
loss_pred:0.03551171347498894, decouple_loss:0.03556275740265846
The modified gen p mean: 0.44958290457725525, gen p mean: -0.5546779036521912, mean p set: 0.45006316900253296
loss_pred:0.03500567004084587, decouple_loss:0.03773384541273117
Iteration: 728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450145959854126, gen p mean: -0.5538970828056335, mean p set: 0.4506262540817261
loss_pred:0.032316844910383224, decouple_loss:0.03435230255126953
The modified gen p mean: 0.4499218165874481, gen p mean: -0.5596131682395935, mean p set: 0.4504021108150482
The modified gen p mean: 0.4513561427593231, gen p mean: -0.5504199862480164, mean p set: 0.4518364667892456
loss_pred:0.03603854775428772, decouple_loss:0.03334460407495499
loss_pred:0.033806413412094116, decouple_loss:0.03415883332490921
Iteration: 729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514380693435669, gen p mean: -0.5630268454551697, mean p set: 0.4519183933734894
The modified gen p mean: 0.44915157556533813, gen p mean: -0.5737920999526978, mean p set: 0.44963186979293823
loss_pred:0.03232226148247719, decouple_loss:0.033685266971588135
loss_pred:0.03609215095639229, decouple_loss:0.03529459983110428
The modified gen p mean: 0.4513264298439026, gen p mean: -0.5637704133987427, mean p set: 0.4518067240715027
loss_pred:0.03242141753435135, decouple_loss:0.03461669757962227
Iteration: 730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512999653816223, gen p mean: -0.559188187122345, mean p set: 0.4517802298069
The modified gen p mean: 0.4498480260372162, gen p mean: -0.5478495955467224, mean p set: 0.4503283202648163
loss_pred:0.033057328313589096, decouple_loss:0.03304588794708252
loss_pred:0.03297966346144676, decouple_loss:0.03376713767647743The modified gen p mean: 0.4515685737133026, gen p mean: -0.5567705035209656, mean p set: 0.4520488977432251
loss_pred:0.0327569879591465, decouple_loss:0.031229505315423012
2023-05-04 15:04:01 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.5683743953704834, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5591741800308228, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5616679787635803, mean p set: 0.4500633478164673
loss_pred:0.035633254796266556, decouple_loss:0.035507045686244965
loss_pred:0.03393785282969475, decouple_loss:0.03392317518591881
loss_pred:0.03443525359034538, decouple_loss:0.03424971550703049
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03639678657054901, avg_mse: 0.03985291346907616
current test mse: 0.039853
Iteration: 731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001593232154846, gen p mean: -0.5667317509651184, mean p set: 0.45049622654914856
The modified gen p mean: 0.4497143030166626, gen p mean: -0.5648863315582275, mean p set: 0.4501945972442627
loss_pred:0.034355711191892624, decouple_loss:0.03232088312506676
loss_pred:0.03476952016353607, decouple_loss:0.032250091433525085
The modified gen p mean: 0.44930869340896606, gen p mean: -0.5662640333175659, mean p set: 0.44978898763656616
loss_pred:0.032586753368377686, decouple_loss:0.03347346559166908
Iteration: 732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497564733028412, gen p mean: -0.5784087777137756, mean p set: 0.45023679733276367
The modified gen p mean: 0.44884517788887024, gen p mean: -0.5755431652069092, mean p set: 0.44932547211647034
loss_pred:0.033840060234069824, decouple_loss:0.03431951627135277
loss_pred:0.0339927077293396, decouple_loss:0.032751668244600296
The modified gen p mean: 0.45012643933296204, gen p mean: -0.5770936608314514, mean p set: 0.45060670375823975
loss_pred:0.034197766333818436, decouple_loss:0.03322884812951088
Iteration: 733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013299584388733, gen p mean: -0.5668368935585022, mean p set: 0.4506132900714874
The modified gen p mean: 0.45160412788391113, gen p mean: -0.5692779421806335, mean p set: 0.45208439230918884
loss_pred:0.03405261039733887, decouple_loss:0.029505545273423195
loss_pred:0.033164817839860916, decouple_loss:0.03082706220448017
The modified gen p mean: 0.4513068199157715, gen p mean: -0.5686481595039368, mean p set: 0.4517871141433716
loss_pred:0.03297383710741997, decouple_loss:0.02943611331284046
Iteration: 734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45040133595466614, gen p mean: -0.5640432834625244, mean p set: 0.4508816599845886
The modified gen p mean: 0.44896623492240906, gen p mean: -0.5806169509887695, mean p set: 0.44944655895233154
loss_pred:0.032276254147291183, decouple_loss:0.029790667816996574
loss_pred:0.0324866883456707, decouple_loss:0.02778642810881138
The modified gen p mean: 0.4519311487674713, gen p mean: -0.577835202217102, mean p set: 0.452411413192749
loss_pred:0.03362349048256874, decouple_loss:0.02897346019744873
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
NaN value num: 0
Iteration: 735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450796902179718, gen p mean: -0.5857756733894348, mean p set: 0.4512771964073181
The modified gen p mean: 0.4493320882320404, gen p mean: -0.5898228287696838, mean p set: 0.4498123526573181
loss_pred:0.03191384673118591, decouple_loss:0.029930099844932556
The modified gen p mean: 0.4491126537322998, gen p mean: -0.5844606161117554, mean p set: 0.4495929181575775
loss_pred:0.03286324441432953, decouple_loss:0.034855328500270844
loss_pred:0.03199152275919914, decouple_loss:0.03179564327001572
Iteration: 736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930359721183777, gen p mean: -0.5953013300895691, mean p set: 0.44978389143943787
The modified gen p mean: 0.4504971206188202, gen p mean: -0.5906354784965515, mean p set: 0.4509774148464203
loss_pred:0.030811110511422157, decouple_loss:0.03249415010213852
loss_pred:0.03287678211927414, decouple_loss:0.03155885264277458
The modified gen p mean: 0.44907745718955994, gen p mean: -0.5965191125869751, mean p set: 0.4495577812194824
loss_pred:0.03201662003993988, decouple_loss:0.029123365879058838
Iteration: 737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909465312957764, gen p mean: -0.5965564846992493, mean p set: 0.44957494735717773
loss_pred:0.02944253385066986, decouple_loss:0.03164645656943321
The modified gen p mean: 0.44990983605384827, gen p mean: -0.5910045504570007, mean p set: 0.45039013028144836The modified gen p mean: 0.45217129588127136, gen p mean: -0.5878218412399292, mean p set: 0.45265159010887146
loss_pred:0.03210625424981117, decouple_loss:0.02886628732085228
loss_pred:0.03292510285973549, decouple_loss:0.0315084308385849
Iteration: 738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023706555366516, gen p mean: -0.5997834205627441, mean p set: 0.45071735978126526
The modified gen p mean: 0.4525979459285736, gen p mean: -0.5877925157546997, mean p set: 0.4530782699584961
loss_pred:0.030269324779510498, decouple_loss:0.03047925792634487
loss_pred:0.03289741277694702, decouple_loss:0.029639560729265213
The modified gen p mean: 0.44988110661506653, gen p mean: -0.6047743558883667, mean p set: 0.4503614008426666
loss_pred:0.03185500577092171, decouple_loss:0.029979035258293152
Iteration: 739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45127204060554504, gen p mean: -0.5740857720375061, mean p set: 0.45175236463546753
loss_pred:0.03277813270688057, decouple_loss:0.02842397801578045
The modified gen p mean: 0.44913122057914734, gen p mean: -0.5842627286911011, mean p set: 0.44961148500442505
The modified gen p mean: 0.44902917742729187, gen p mean: -0.572517454624176, mean p set: 0.44950950145721436
loss_pred:0.030186854302883148, decouple_loss:0.02760237827897072
loss_pred:0.032331690192222595, decouple_loss:0.028656261041760445
Iteration: 740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493030309677124, gen p mean: -0.5779107809066772, mean p set: 0.4497832953929901
The modified gen p mean: 0.449003130197525, gen p mean: -0.5741586089134216, mean p set: 0.44948339462280273
loss_pred:0.03190850466489792, decouple_loss:0.027926305308938026
loss_pred:0.030524274334311485, decouple_loss:0.02723412960767746
The modified gen p mean: 0.44972312450408936, gen p mean: -0.580417811870575, mean p set: 0.45020341873168945
loss_pred:0.03185977041721344, decouple_loss:0.02799638919532299
2023-05-04 15:08:27 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5718223452568054, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.5806422233581543, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5737431645393372, mean p set: 0.4500633478164673
loss_pred:0.03208564221858978, decouple_loss:0.029238266870379448
loss_pred:0.033939916640520096, decouple_loss:0.03142610564827919
loss_pred:0.032469723373651505, decouple_loss:0.029850782826542854
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03434034809470177, avg_mse: 0.038310207426548004
current test mse: 0.03831
Iteration: 741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45158398151397705, gen p mean: -0.5761670470237732, mean p set: 0.45206427574157715
The modified gen p mean: 0.44958746433258057, gen p mean: -0.5712471008300781, mean p set: 0.45006775856018066
loss_pred:0.031382910907268524, decouple_loss:0.02917872741818428
loss_pred:0.029957333579659462, decouple_loss:0.027218909934163094
The modified gen p mean: 0.4499051570892334, gen p mean: -0.5752108693122864, mean p set: 0.4503854513168335
loss_pred:0.028725840151309967, decouple_loss:0.02772379107773304
Iteration: 742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496801793575287, gen p mean: -0.6035754084587097, mean p set: 0.4501604735851288
The modified gen p mean: 0.4514003098011017, gen p mean: -0.5947712659835815, mean p set: 0.4518806040287018
loss_pred:0.029520336538553238, decouple_loss:0.02921590954065323
loss_pred:0.03086206689476967, decouple_loss:0.02773190476000309
The modified gen p mean: 0.4495278596878052, gen p mean: -0.600698709487915, mean p set: 0.4500081539154053
loss_pred:0.030871840193867683, decouple_loss:0.027829984202980995
Iteration: 743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45159292221069336, gen p mean: -0.5995946526527405, mean p set: 0.45207321643829346
The modified gen p mean: 0.45139554142951965, gen p mean: -0.6059882044792175, mean p set: 0.45187583565711975
loss_pred:0.032269615679979324, decouple_loss:0.02822921797633171
The modified gen p mean: 0.45152056217193604, gen p mean: -0.6029309630393982, mean p set: 0.45200085639953613
loss_pred:0.0321505032479763, decouple_loss:0.02812804840505123
loss_pred:0.030863076448440552, decouple_loss:0.02832593396306038
Iteration: 744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497954249382019, gen p mean: -0.6148344874382019, mean p set: 0.450275719165802
The modified gen p mean: 0.44922783970832825, gen p mean: -0.6151821613311768, mean p set: 0.44970813393592834
loss_pred:0.028570760041475296, decouple_loss:0.02701500803232193
loss_pred:0.030113836750388145, decouple_loss:0.02703522890806198
The modified gen p mean: 0.44934192299842834, gen p mean: -0.5960646271705627, mean p set: 0.44982221722602844
loss_pred:0.03141293674707413, decouple_loss:0.025189679116010666
Iteration: 745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500953257083893, gen p mean: -0.5917999148368835, mean p set: 0.4505756199359894
The modified gen p mean: 0.4497816562652588, gen p mean: -0.6029222011566162, mean p set: 0.4502619802951813
loss_pred:0.03193392977118492, decouple_loss:0.026330070570111275
loss_pred:0.03007497265934944, decouple_loss:0.02719174511730671
The modified gen p mean: 0.44948169589042664, gen p mean: -0.5888341665267944, mean p set: 0.44996196031570435
loss_pred:0.031043294817209244, decouple_loss:0.02560349367558956
Iteration: 746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019733905792236, gen p mean: -0.5960464477539062, mean p set: 0.45067763328552246
loss_pred:0.03042144514620304, decouple_loss:0.0281847957521677
The modified gen p mean: 0.4491424560546875, gen p mean: -0.6038429141044617, mean p set: 0.4496227502822876
The modified gen p mean: 0.4493807256221771, gen p mean: -0.5937114953994751, mean p set: 0.4498610198497772
loss_pred:0.028418898582458496, decouple_loss:0.027022834867239
loss_pred:0.030805164948105812, decouple_loss:0.025746682658791542
Iteration: 747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497600495815277, gen p mean: -0.5989778637886047, mean p set: 0.4502403438091278
The modified gen p mean: 0.44946157932281494, gen p mean: -0.6055704951286316, mean p set: 0.44994187355041504
loss_pred:0.02929162234067917, decouple_loss:0.02661566622555256
loss_pred:0.02909032441675663, decouple_loss:0.024681048467755318
The modified gen p mean: 0.449528306722641, gen p mean: -0.5945567488670349, mean p set: 0.4500085711479187
loss_pred:0.03013213910162449, decouple_loss:0.02536231093108654
Iteration: 748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450175404548645, gen p mean: -0.6044628620147705, mean p set: 0.45065566897392273
loss_pred:0.030201712623238564, decouple_loss:0.025014091283082962
The modified gen p mean: 0.44972214102745056, gen p mean: -0.6029329895973206, mean p set: 0.45020246505737305
The modified gen p mean: 0.45032092928886414, gen p mean: -0.6066510081291199, mean p set: 0.45080122351646423
loss_pred:0.030400216579437256, decouple_loss:0.023698715493083
loss_pred:0.030156763270497322, decouple_loss:0.025250157341361046
Iteration: 749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45185160636901855, gen p mean: -0.6153490543365479, mean p set: 0.45233187079429626
The modified gen p mean: 0.4511414170265198, gen p mean: -0.615687906742096, mean p set: 0.4516216814517975
loss_pred:0.03007957525551319, decouple_loss:0.023349948227405548
loss_pred:0.030376069247722626, decouple_loss:0.023448672145605087
The modified gen p mean: 0.44943132996559143, gen p mean: -0.6160194277763367, mean p set: 0.44991159439086914
loss_pred:0.027880001813173294, decouple_loss:0.02349136769771576
Iteration: 750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121848583221436, gen p mean: -0.6281336545944214, mean p set: 0.45169880986213684
loss_pred:0.029103625565767288, decouple_loss:0.0234496109187603
The modified gen p mean: 0.449188768863678, gen p mean: -0.6351860761642456, mean p set: 0.4496690630912781
The modified gen p mean: 0.44988012313842773, gen p mean: -0.6322396993637085, mean p set: 0.4503604471683502
loss_pred:0.028533369302749634, decouple_loss:0.024398859590291977
loss_pred:0.028218626976013184, decouple_loss:0.02380438894033432
2023-05-04 15:11:59 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6111505031585693, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.6210131049156189, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6140787601470947, mean p set: 0.4500633478164673
loss_pred:0.030741961672902107, decouple_loss:0.024388298392295837
loss_pred:0.03253934159874916, decouple_loss:0.025472944602370262
loss_pred:0.03110310807824135, decouple_loss:0.024108080193400383
WV_0_PC_1_EH_0_PS_40_6, loss: 0.032694295048713684, avg_mse: 0.03716263920068741
current test mse: 0.037163
Iteration: 751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506269693374634, gen p mean: -0.6175661087036133, mean p set: 0.4511072635650635
The modified gen p mean: 0.4498962461948395, gen p mean: -0.615832507610321, mean p set: 0.4503765404224396
loss_pred:0.02978319302201271, decouple_loss:0.022670039907097816
loss_pred:0.02936411090195179, decouple_loss:0.02238372713327408
The modified gen p mean: 0.4490998685359955, gen p mean: -0.6280223727226257, mean p set: 0.44958019256591797
loss_pred:0.02789020724594593, decouple_loss:0.023427709937095642
Iteration: 752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45126527547836304, gen p mean: -0.620232105255127, mean p set: 0.45174553990364075
loss_pred:0.0304985623806715, decouple_loss:0.02293095365166664
The modified gen p mean: 0.4492534101009369, gen p mean: -0.6134822964668274, mean p set: 0.4497336745262146
The modified gen p mean: 0.44964835047721863, gen p mean: -0.6239190697669983, mean p set: 0.4501286447048187
loss_pred:0.028827454894781113, decouple_loss:0.02242552861571312
loss_pred:0.027981309220194817, decouple_loss:0.02180195227265358
Iteration: 753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511968493461609, gen p mean: -0.619220495223999, mean p set: 0.451677143573761
loss_pred:0.02932622842490673, decouple_loss:0.021142983809113503
The modified gen p mean: 0.45003461837768555, gen p mean: -0.6259185075759888, mean p set: 0.45051491260528564
The modified gen p mean: 0.4504595994949341, gen p mean: -0.6228163242340088, mean p set: 0.45093992352485657
loss_pred:0.028137406334280968, decouple_loss:0.02159900963306427
loss_pred:0.0297556109726429, decouple_loss:0.02116432972252369
Iteration: 754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518599212169647, gen p mean: -0.6209850311279297, mean p set: 0.4523402154445648
loss_pred:0.030400270596146584, decouple_loss:0.020481795072555542
The modified gen p mean: 0.4511229991912842, gen p mean: -0.6214749813079834, mean p set: 0.4516032636165619
The modified gen p mean: 0.4489581882953644, gen p mean: -0.6255948543548584, mean p set: 0.4494384825229645
loss_pred:0.028224706649780273, decouple_loss:0.020678570494055748
loss_pred:0.0275574978441, decouple_loss:0.02174615114927292
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746023416519165, gen p mean: -0.6365962624549866, mean p set: 0.44794052839279175
The modified gen p mean: 0.44620752334594727, gen p mean: -0.6406489014625549, mean p set: 0.44668781757354736
loss_pred:0.0325276143848896, decouple_loss:0.025637276470661163
The modified gen p mean: 0.4468863010406494, gen p mean: -0.6410057544708252, mean p set: 0.4473665952682495
loss_pred:0.030689982697367668, decouple_loss:0.02472960576415062
loss_pred:0.03234557434916496, decouple_loss:0.025624822825193405
Iteration: 756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479668438434601, gen p mean: -0.6054860949516296, mean p set: 0.4484470784664154
loss_pred:0.030642224475741386, decouple_loss:0.024566730484366417
The modified gen p mean: 0.44734594225883484, gen p mean: -0.5963447690010071, mean p set: 0.44782623648643494
The modified gen p mean: 0.4459315538406372, gen p mean: -0.5961576104164124, mean p set: 0.4464118480682373
loss_pred:0.031747255474328995, decouple_loss:0.026814142242074013
loss_pred:0.03211453557014465, decouple_loss:0.025966351851820946
Iteration: 757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473477303981781, gen p mean: -0.6473727822303772, mean p set: 0.4478280544281006
loss_pred:0.03128330036997795, decouple_loss:0.025821533054113388
The modified gen p mean: 0.4468236267566681, gen p mean: -0.6310044527053833, mean p set: 0.4473038911819458
The modified gen p mean: 0.4466908872127533, gen p mean: -0.6385458111763, mean p set: 0.4471711814403534
loss_pred:0.031234607100486755, decouple_loss:0.023583976551890373
loss_pred:0.03203906863927841, decouple_loss:0.024588990956544876
Iteration: 758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488367438316345, gen p mean: -0.6449187994003296, mean p set: 0.44931700825691223
loss_pred:0.030656788498163223, decouple_loss:0.0275545846670866
The modified gen p mean: 0.44603100419044495, gen p mean: -0.6341152191162109, mean p set: 0.44651132822036743
The modified gen p mean: 0.4461468756198883, gen p mean: -0.6248677372932434, mean p set: 0.4466271698474884
loss_pred:0.03159775212407112, decouple_loss:0.023967310786247253
loss_pred:0.03086269274353981, decouple_loss:0.02271750383079052
Iteration: 759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667914509773254, gen p mean: -0.6314886808395386, mean p set: 0.44715940952301025
The modified gen p mean: 0.44647493958473206, gen p mean: -0.6396605372428894, mean p set: 0.44695523381233215
loss_pred:0.030871408060193062, decouple_loss:0.022512463852763176
loss_pred:0.029976647347211838, decouple_loss:0.022154618054628372
The modified gen p mean: 0.44577547907829285, gen p mean: -0.6317282915115356, mean p set: 0.44625577330589294
loss_pred:0.0310739167034626, decouple_loss:0.022758740931749344
Iteration: 760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456796944141388, gen p mean: -0.6429420709609985, mean p set: 0.4461599588394165
The modified gen p mean: 0.44677528738975525, gen p mean: -0.6504906415939331, mean p set: 0.44725558161735535
loss_pred:0.0307622067630291, decouple_loss:0.02276790700852871
loss_pred:0.03048992156982422, decouple_loss:0.02174943871796131
The modified gen p mean: 0.44691959023475647, gen p mean: -0.6511366963386536, mean p set: 0.4473998546600342
loss_pred:0.030614955350756645, decouple_loss:0.02190621942281723
2023-05-04 15:16:17 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6093303561210632, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.6187988519668579, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6130742430686951, mean p set: 0.4500633478164673
loss_pred:0.030181139707565308, decouple_loss:0.022886665537953377
loss_pred:0.03142515942454338, decouple_loss:0.022253485396504402
loss_pred:0.030531495809555054, decouple_loss:0.02250892110168934
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03184008598327637, avg_mse: 0.03646659106016159
current test mse: 0.036467
Iteration: 761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44739651679992676, gen p mean: -0.6139805912971497, mean p set: 0.44787678122520447
The modified gen p mean: 0.44820311665534973, gen p mean: -0.6272441744804382, mean p set: 0.44868341088294983
loss_pred:0.03107982687652111, decouple_loss:0.022694222629070282
loss_pred:0.030352607369422913, decouple_loss:0.02515486441552639
The modified gen p mean: 0.4478110074996948, gen p mean: -0.623400092124939, mean p set: 0.4482913017272949
loss_pred:0.03037276864051819, decouple_loss:0.023404542356729507
Iteration: 762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44627127051353455, gen p mean: -0.6139630079269409, mean p set: 0.44675159454345703
loss_pred:0.030230756849050522, decouple_loss:0.02259015291929245
The modified gen p mean: 0.4452894926071167, gen p mean: -0.6075851321220398, mean p set: 0.4457697868347168
The modified gen p mean: 0.4466208219528198, gen p mean: -0.6155725717544556, mean p set: 0.4471011161804199
loss_pred:0.029304619878530502, decouple_loss:0.02324027754366398
loss_pred:0.030127644538879395, decouple_loss:0.02280835621058941
Iteration: 763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609498977661133, gen p mean: -0.6216602325439453, mean p set: 0.4465752840042114
The modified gen p mean: 0.44885820150375366, gen p mean: -0.6296159029006958, mean p set: 0.44933852553367615
loss_pred:0.030577383935451508, decouple_loss:0.02168474718928337
loss_pred:0.030763575807213783, decouple_loss:0.025002293288707733The modified gen p mean: 0.4474453032016754, gen p mean: -0.6177077293395996, mean p set: 0.4479255974292755
loss_pred:0.03088465891778469, decouple_loss:0.021943727508187294
Iteration: 764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44625359773635864, gen p mean: -0.6287509202957153, mean p set: 0.44673389196395874
The modified gen p mean: 0.44664016366004944, gen p mean: -0.6283714771270752, mean p set: 0.44712045788764954
loss_pred:0.029728664085268974, decouple_loss:0.020841659978032112
loss_pred:0.0295525211840868, decouple_loss:0.020887387916445732
The modified gen p mean: 0.44525760412216187, gen p mean: -0.6287676095962524, mean p set: 0.44573795795440674
loss_pred:0.02955683507025242, decouple_loss:0.02142399176955223
Iteration: 765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475928544998169, gen p mean: -0.6409130096435547, mean p set: 0.448073148727417
The modified gen p mean: 0.4462599754333496, gen p mean: -0.637725830078125, mean p set: 0.4467402696609497
loss_pred:0.02975551225244999, decouple_loss:0.021610066294670105
loss_pred:0.030094152316451073, decouple_loss:0.01992545835673809
The modified gen p mean: 0.44710493087768555, gen p mean: -0.6374657154083252, mean p set: 0.44758522510528564
loss_pred:0.029634719714522362, decouple_loss:0.020471112802624702
Iteration: 766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44582659006118774, gen p mean: -0.6338807344436646, mean p set: 0.44630685448646545
loss_pred:0.02993781492114067, decouple_loss:0.020111018791794777
The modified gen p mean: 0.4463250935077667, gen p mean: -0.6379127502441406, mean p set: 0.44680535793304443
The modified gen p mean: 0.4468763768672943, gen p mean: -0.6408993005752563, mean p set: 0.4473566710948944
loss_pred:0.028995536267757416, decouple_loss:0.019176997244358063
loss_pred:0.02910604327917099, decouple_loss:0.019619522616267204
Iteration: 767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464486539363861, gen p mean: -0.6456873416900635, mean p set: 0.4469289183616638
loss_pred:0.028421251103281975, decouple_loss:0.019178733229637146
The modified gen p mean: 0.4459937512874603, gen p mean: -0.6307534575462341, mean p set: 0.44647401571273804
The modified gen p mean: 0.44904765486717224, gen p mean: -0.6487565636634827, mean p set: 0.44952791929244995
loss_pred:0.03004297986626625, decouple_loss:0.019524795934557915
loss_pred:0.02889709174633026, decouple_loss:0.020792605355381966
Iteration: 768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448574036359787, gen p mean: -0.6479009985923767, mean p set: 0.4490543007850647
The modified gen p mean: 0.4483022391796112, gen p mean: -0.6512807011604309, mean p set: 0.4487825632095337
loss_pred:0.030053500086069107, decouple_loss:0.020605584606528282
loss_pred:0.029026390984654427, decouple_loss:0.02160368487238884
The modified gen p mean: 0.44751569628715515, gen p mean: -0.6324413418769836, mean p set: 0.44799599051475525
loss_pred:0.028922807425260544, decouple_loss:0.018884221091866493
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467660188674927, gen p mean: -0.6122332215309143, mean p set: 0.447246253490448
The modified gen p mean: 0.4472636878490448, gen p mean: -0.6157915592193604, mean p set: 0.4477439522743225
loss_pred:0.028822338208556175, decouple_loss:0.019775250926613808
loss_pred:0.029057439416646957, decouple_loss:0.01862524077296257
The modified gen p mean: 0.44568493962287903, gen p mean: -0.6150648593902588, mean p set: 0.4461652636528015
loss_pred:0.029644275084137917, decouple_loss:0.019400829449295998
Iteration: 770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480065703392029, gen p mean: -0.6103042364120483, mean p set: 0.448486864566803
loss_pred:0.029386000707745552, decouple_loss:0.018328266218304634
The modified gen p mean: 0.44879674911499023, gen p mean: -0.6193954348564148, mean p set: 0.44927704334259033
The modified gen p mean: 0.44760069251060486, gen p mean: -0.6062479615211487, mean p set: 0.44808098673820496
loss_pred:0.028974046930670738, decouple_loss:0.019373347982764244
loss_pred:0.029035136103630066, decouple_loss:0.018653176724910736
2023-05-04 15:19:52 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6094391345977783, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.6196485757827759, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.613503098487854, mean p set: 0.4500633478164673
loss_pred:0.02881072461605072, decouple_loss:0.018823526799678802
loss_pred:0.030171440914273262, decouple_loss:0.01786036789417267
loss_pred:0.029142767190933228, decouple_loss:0.01814248040318489
WV_0_PC_1_EH_0_PS_40_6, loss: 0.030288752168416977, avg_mse: 0.0348537303507328
current test mse: 0.034854
Iteration: 771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463035464286804, gen p mean: -0.6210858225822449, mean p set: 0.4467838406562805
The modified gen p mean: 0.4481782019138336, gen p mean: -0.6263582110404968, mean p set: 0.4486584961414337
loss_pred:0.028637411072850227, decouple_loss:0.017698276787996292
loss_pred:0.02841039001941681, decouple_loss:0.018446188420057297
The modified gen p mean: 0.4467123746871948, gen p mean: -0.6097458004951477, mean p set: 0.4471926689147949
loss_pred:0.029265351593494415, decouple_loss:0.017852015793323517
Iteration: 772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472138583660126, gen p mean: -0.6282771825790405, mean p set: 0.4476941227912903
The modified gen p mean: 0.4473292827606201, gen p mean: -0.6212121248245239, mean p set: 0.4478095471858978
loss_pred:0.02946816198527813, decouple_loss:0.01849869079887867
loss_pred:0.028206918388605118, decouple_loss:0.018278436735272408
The modified gen p mean: 0.44859594106674194, gen p mean: -0.6363264918327332, mean p set: 0.44907623529434204
loss_pred:0.029579605907201767, decouple_loss:0.020128503441810608
Iteration: 773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44704753160476685, gen p mean: -0.6141304969787598, mean p set: 0.44752782583236694
loss_pred:0.029585499316453934, decouple_loss:0.017541248351335526
The modified gen p mean: 0.44646894931793213, gen p mean: -0.6231913566589355, mean p set: 0.44694921374320984
The modified gen p mean: 0.44641295075416565, gen p mean: -0.611491858959198, mean p set: 0.44689324498176575
loss_pred:0.028726862743496895, decouple_loss:0.017683908343315125
loss_pred:0.03020678088068962, decouple_loss:0.01745545119047165
Iteration: 774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810667634010315, gen p mean: -0.6387460231781006, mean p set: 0.44858697056770325
loss_pred:0.028511380776762962, decouple_loss:0.016846217215061188
The modified gen p mean: 0.44582533836364746, gen p mean: -0.630230724811554, mean p set: 0.44630563259124756
The modified gen p mean: 0.44817230105400085, gen p mean: -0.6361457705497742, mean p set: 0.44865259528160095
loss_pred:0.02828778699040413, decouple_loss:0.017536845058202744
loss_pred:0.028035538271069527, decouple_loss:0.017234019935131073
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
NaN value num: 0
Iteration: 775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44957005977630615, gen p mean: -0.6173380613327026, mean p set: 0.45005032420158386
The modified gen p mean: 0.44992145895957947, gen p mean: -0.6175258755683899, mean p set: 0.45040175318717957
The modified gen p mean: 0.4482422471046448, gen p mean: -0.6177284717559814, mean p set: 0.4487225413322449
loss_pred:0.029179247096180916, decouple_loss:0.020549800246953964
loss_pred:0.028672652319073677, decouple_loss:0.020765429362654686
loss_pred:0.02827117219567299, decouple_loss:0.021923938766121864
Iteration: 776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860729575157166, gen p mean: -0.6215733885765076, mean p set: 0.44908758997917175
loss_pred:0.030243001878261566, decouple_loss:0.01958967186510563
The modified gen p mean: 0.45017290115356445, gen p mean: -0.6219632625579834, mean p set: 0.4506531357765198
The modified gen p mean: 0.4501018822193146, gen p mean: -0.6276921629905701, mean p set: 0.45058220624923706
loss_pred:0.02871181070804596, decouple_loss:0.02040058746933937
loss_pred:0.02930358611047268, decouple_loss:0.019020602107048035
Iteration: 777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503107964992523, gen p mean: -0.6422796249389648, mean p set: 0.45079106092453003
The modified gen p mean: 0.4485991299152374, gen p mean: -0.6415039300918579, mean p set: 0.4490794241428375
loss_pred:0.028910862281918526, decouple_loss:0.018744464963674545
loss_pred:0.029435565695166588, decouple_loss:0.019061174243688583
The modified gen p mean: 0.44987753033638, gen p mean: -0.6423042416572571, mean p set: 0.4503578245639801
loss_pred:0.03013605810701847, decouple_loss:0.019100720062851906
Iteration: 778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503362476825714, gen p mean: -0.6369702816009521, mean p set: 0.4508165121078491
The modified gen p mean: 0.44882988929748535, gen p mean: -0.6408908367156982, mean p set: 0.44931018352508545
loss_pred:0.02831486240029335, decouple_loss:0.018796028569340706
loss_pred:0.02931314893066883, decouple_loss:0.019010113552212715
The modified gen p mean: 0.44983845949172974, gen p mean: -0.6473912596702576, mean p set: 0.45031872391700745
loss_pred:0.028389448300004005, decouple_loss:0.018511299043893814
Iteration: 779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488926827907562, gen p mean: -0.6411283016204834, mean p set: 0.44937294721603394
The modified gen p mean: 0.45033565163612366, gen p mean: -0.6393474340438843, mean p set: 0.45081597566604614
loss_pred:0.027612628415226936, decouple_loss:0.017444849014282227
loss_pred:0.02850976400077343, decouple_loss:0.018908310681581497
The modified gen p mean: 0.45051082968711853, gen p mean: -0.6459593176841736, mean p set: 0.45099109411239624
loss_pred:0.028580838814377785, decouple_loss:0.017811615020036697
Iteration: 780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44985517859458923, gen p mean: -0.6481504440307617, mean p set: 0.45033547282218933
The modified gen p mean: 0.4508385956287384, gen p mean: -0.6378219127655029, mean p set: 0.4513188898563385
loss_pred:0.028889643028378487, decouple_loss:0.017287639901041985
loss_pred:0.029090067371726036, decouple_loss:0.016191843897104263
The modified gen p mean: 0.44945964217185974, gen p mean: -0.6415761709213257, mean p set: 0.44993993639945984
loss_pred:0.02910294197499752, decouple_loss:0.016284789890050888
2023-05-04 15:24:07 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6353418231010437, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6395866274833679, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6456643342971802, mean p set: 0.4502691626548767
loss_pred:0.02874113991856575, decouple_loss:0.018003109842538834
loss_pred:0.028927555307745934, decouple_loss:0.01789260283112526
loss_pred:0.030184239149093628, decouple_loss:0.018186049535870552
WV_0_PC_1_EH_0_PS_40_6, loss: 0.030185675248503685, avg_mse: 0.035041410475969315
current test mse: 0.035041
Iteration: 781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019403100013733, gen p mean: -0.6300184726715088, mean p set: 0.45067429542541504
The modified gen p mean: 0.4495947062969208, gen p mean: -0.640100359916687, mean p set: 0.4500750005245209
loss_pred:0.028661424294114113, decouple_loss:0.016602421179413795
loss_pred:0.028802141547203064, decouple_loss:0.015400798059999943
The modified gen p mean: 0.44997742772102356, gen p mean: -0.6423601508140564, mean p set: 0.45045775175094604
loss_pred:0.02764219231903553, decouple_loss:0.016552694141864777
Iteration: 782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860315322875977, gen p mean: -0.637732207775116, mean p set: 0.44908347725868225
loss_pred:0.027783459052443504, decouple_loss:0.016665752977132797
The modified gen p mean: 0.45127686858177185, gen p mean: -0.6373293995857239, mean p set: 0.45175716280937195The modified gen p mean: 0.4501436650753021, gen p mean: -0.6428609490394592, mean p set: 0.4506239891052246
loss_pred:0.028363315388560295, decouple_loss:0.017492352053523064
loss_pred:0.027646418660879135, decouple_loss:0.016246654093265533
Iteration: 783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44940185546875, gen p mean: -0.6471637487411499, mean p set: 0.4498820900917053
The modified gen p mean: 0.451181560754776, gen p mean: -0.6491838097572327, mean p set: 0.4516618549823761
loss_pred:0.027732303366065025, decouple_loss:0.015372952446341515
loss_pred:0.02851514331996441, decouple_loss:0.015632402151823044
The modified gen p mean: 0.45036405324935913, gen p mean: -0.6411148309707642, mean p set: 0.4508443772792816
loss_pred:0.02795996516942978, decouple_loss:0.016134291887283325
Iteration: 784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44897353649139404, gen p mean: -0.6290433406829834, mean p set: 0.44945380091667175
The modified gen p mean: 0.448868989944458, gen p mean: -0.6368824243545532, mean p set: 0.4493492543697357
loss_pred:0.028106728568673134, decouple_loss:0.015174323692917824
loss_pred:0.02868158370256424, decouple_loss:0.01755405031144619
The modified gen p mean: 0.44822803139686584, gen p mean: -0.625011682510376, mean p set: 0.44870832562446594
loss_pred:0.029438363388180733, decouple_loss:0.017196185886859894
Iteration: 785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509267508983612, gen p mean: -0.6352224946022034, mean p set: 0.4514070451259613
loss_pred:0.028669655323028564, decouple_loss:0.01611003652215004
The modified gen p mean: 0.45056435465812683, gen p mean: -0.6411863565444946, mean p set: 0.45104461908340454
The modified gen p mean: 0.4507595896720886, gen p mean: -0.6366475224494934, mean p set: 0.4512398838996887
loss_pred:0.028048200532794, decouple_loss:0.014824948273599148
loss_pred:0.029007695615291595, decouple_loss:0.016851039603352547
Iteration: 786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498046040534973, gen p mean: -0.6247736811637878, mean p set: 0.4502848982810974
loss_pred:0.028290342539548874, decouple_loss:0.01548418402671814
The modified gen p mean: 0.44889456033706665, gen p mean: -0.6392549872398376, mean p set: 0.44937488436698914
The modified gen p mean: 0.4508129358291626, gen p mean: -0.6389580965042114, mean p set: 0.4512932300567627
loss_pred:0.02764742635190487, decouple_loss:0.015394572168588638
