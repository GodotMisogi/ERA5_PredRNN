After initialize model, args.img_channel:30
load model: /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_8000.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
train_data_files nums: 125
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488389492034912, gen p mean: -0.12457608431577682, mean p set: 0.4494136571884155
loss_pred:0.01424658764153719, decouple_loss:0.0009087430080398917
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
The modified gen p mean: 0.4487619996070862, gen p mean: -0.1189766675233841, mean p set: 0.44933751225471497
loss_pred:0.014868393540382385, decouple_loss:0.0008813388994894922
The modified gen p mean: 0.44773370027542114, gen p mean: -0.12317490577697754, mean p set: 0.4483092129230499
loss_pred:0.014975850470364094, decouple_loss:0.0009194746962748468
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786569476127625, gen p mean: -0.11433728784322739, mean p set: 0.4484424889087677
loss_pred:0.01877431571483612, decouple_loss:0.004195006564259529
The modified gen p mean: 0.44931989908218384, gen p mean: -0.11708109080791473, mean p set: 0.449893057346344
loss_pred:0.01872367411851883, decouple_loss:0.004270591307431459
The modified gen p mean: 0.44911685585975647, gen p mean: -0.11441066116094589, mean p set: 0.4496924579143524
loss_pred:0.018580380827188492, decouple_loss:0.004421649966388941
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476054012775421, gen p mean: -0.11701270192861557, mean p set: 0.4481810927391052
loss_pred:0.01763332076370716, decouple_loss:0.0031440809834748507
The modified gen p mean: 0.4479005038738251, gen p mean: -0.1186276227235794, mean p set: 0.44847777485847473
loss_pred:0.018214713782072067, decouple_loss:0.002889045048505068
The modified gen p mean: 0.4475015699863434, gen p mean: -0.118489108979702, mean p set: 0.4480784237384796
loss_pred:0.01767340674996376, decouple_loss:0.0029723350889980793
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710657000541687, gen p mean: -0.11260652542114258, mean p set: 0.44768157601356506
loss_pred:0.01739375665783882, decouple_loss:0.00223694765008986
The modified gen p mean: 0.4483715295791626, gen p mean: -0.11452174186706543, mean p set: 0.448948472738266
loss_pred:0.0177474282681942, decouple_loss:0.002007165690883994
The modified gen p mean: 0.44746702909469604, gen p mean: -0.10255800932645798, mean p set: 0.44804272055625916
loss_pred:0.01650475710630417, decouple_loss:0.002727261744439602
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44826364517211914, gen p mean: -0.1238403171300888, mean p set: 0.44884148240089417
loss_pred:0.01648886129260063, decouple_loss:0.0015621287748217583
The modified gen p mean: 0.4475553333759308, gen p mean: -0.12213073670864105, mean p set: 0.4481314718723297
loss_pred:0.018222138285636902, decouple_loss:0.0015078205615282059
The modified gen p mean: 0.4487433135509491, gen p mean: -0.1297784298658371, mean p set: 0.449317067861557
loss_pred:0.01721489615738392, decouple_loss:0.0015690060099586844
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673192501068115, gen p mean: -0.1381251960992813, mean p set: 0.44730639457702637
loss_pred:0.016823118552565575, decouple_loss:0.0016521590296179056
The modified gen p mean: 0.4477255046367645, gen p mean: -0.13457120954990387, mean p set: 0.44830194115638733
loss_pred:0.01731889881193638, decouple_loss:0.0016443683998659253
The modified gen p mean: 0.4484344720840454, gen p mean: -0.14118234813213348, mean p set: 0.44901350140571594
loss_pred:0.017160754650831223, decouple_loss:0.001673088874667883
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752201437950134, gen p mean: -0.13837160170078278, mean p set: 0.44810163974761963
loss_pred:0.0165037140250206, decouple_loss:0.001790623995475471
The modified gen p mean: 0.44931933283805847, gen p mean: -0.13951553404331207, mean p set: 0.449893593788147
loss_pred:0.016646331176161766, decouple_loss:0.0020490630995482206
The modified gen p mean: 0.44862672686576843, gen p mean: -0.13630132377147675, mean p set: 0.4492034912109375
loss_pred:0.01676064543426037, decouple_loss:0.001895945519208908
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829919934272766, gen p mean: -0.13248451054096222, mean p set: 0.44887539744377136
loss_pred:0.01635735109448433, decouple_loss:0.0017084210412576795
The modified gen p mean: 0.44890671968460083, gen p mean: -0.13242429494857788, mean p set: 0.44948384165763855
loss_pred:0.01682300865650177, decouple_loss:0.0015013483352959156
The modified gen p mean: 0.4470454156398773, gen p mean: -0.12963110208511353, mean p set: 0.44762104749679565
loss_pred:0.016955547034740448, decouple_loss:0.0016652637859806418
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489070475101471, gen p mean: -0.11745183914899826, mean p set: 0.449482798576355
loss_pred:0.016264406964182854, decouple_loss:0.0015159865142777562
The modified gen p mean: 0.4485551714897156, gen p mean: -0.12522512674331665, mean p set: 0.4491303265094757
loss_pred:0.016185922548174858, decouple_loss:0.0016508913831785321
The modified gen p mean: 0.4471820890903473, gen p mean: -0.12420688569545746, mean p set: 0.4477550983428955
loss_pred:0.016288692131638527, decouple_loss:0.002008531242609024
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449407160282135, gen p mean: -0.12426276504993439, mean p set: 0.4499812126159668
loss_pred:0.01608012430369854, decouple_loss:0.0017909312155097723
The modified gen p mean: 0.44970327615737915, gen p mean: -0.11873363703489304, mean p set: 0.4502778649330139
loss_pred:0.016834357753396034, decouple_loss:0.0014191038208082318
The modified gen p mean: 0.448129802942276, gen p mean: -0.10616842657327652, mean p set: 0.44870755076408386
loss_pred:0.015621181577444077, decouple_loss:0.0015945996856316924
2023-04-30 22:44:03 testing...
The modified gen p mean: 0.44974109530448914, gen p mean: -0.12166072428226471, mean p set: 0.4502691626548767
loss_pred:0.01889207400381565, decouple_loss:0.0015889292117208242
The modified gen p mean: 0.4494844973087311, gen p mean: -0.11688963323831558, mean p set: 0.4500633478164673
loss_pred:0.018075237050652504, decouple_loss:0.00140574190299958
The modified gen p mean: 0.44978171586990356, gen p mean: -0.11623626947402954, mean p set: 0.45035696029663086
loss_pred:0.01858760043978691, decouple_loss:0.0013864117208868265
WV_1_PC_1_EH_0_PS_40, loss: 0.018591322004795074, avg_mse: 0.02881072834134102
current test mse: 0.028811
At step 10, Best test: 0.028811
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935235381126404, gen p mean: -0.11915970593690872, mean p set: 0.4499293565750122
loss_pred:0.016327857971191406, decouple_loss:0.0011413574684411287
The modified gen p mean: 0.44975054264068604, gen p mean: -0.11721014231443405, mean p set: 0.45032650232315063
loss_pred:0.015867415815591812, decouple_loss:0.0016242052661255002
The modified gen p mean: 0.44883862137794495, gen p mean: -0.12125498056411743, mean p set: 0.44941920042037964
loss_pred:0.016589472070336342, decouple_loss:0.0013239127583801746
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487611651420593, gen p mean: -0.127310112118721, mean p set: 0.44933804869651794
loss_pred:0.014842833392322063, decouple_loss:0.001939659472554922
The modified gen p mean: 0.448444664478302, gen p mean: -0.12041908502578735, mean p set: 0.44901934266090393The modified gen p mean: 0.447787880897522, gen p mean: -0.12474533170461655, mean p set: 0.44836223125457764
loss_pred:0.015209724195301533, decouple_loss:0.00146020099055022
loss_pred:0.01659442111849785, decouple_loss:0.0013670861953869462
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449221670627594, gen p mean: -0.12269697338342667, mean p set: 0.4497983753681183
loss_pred:0.015751613304018974, decouple_loss:0.0015434336382895708
The modified gen p mean: 0.4495047926902771, gen p mean: -0.11322642862796783, mean p set: 0.45008060336112976
loss_pred:0.015480277128517628, decouple_loss:0.001559638069011271
The modified gen p mean: 0.4471612572669983, gen p mean: -0.11914041638374329, mean p set: 0.44773876667022705
loss_pred:0.015866603702306747, decouple_loss:0.0013740230351686478
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879087805747986, gen p mean: -0.12166536599397659, mean p set: 0.4493674635887146
loss_pred:0.01544164028018713, decouple_loss:0.001373416162095964
The modified gen p mean: 0.4485214054584503, gen p mean: -0.12198500335216522, mean p set: 0.44909700751304626
loss_pred:0.014677533879876137, decouple_loss:0.0014400703366845846
The modified gen p mean: 0.44731730222702026, gen p mean: -0.12357260286808014, mean p set: 0.44789305329322815
loss_pred:0.015926890075206757, decouple_loss:0.001536563620902598
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477359652519226, gen p mean: -0.13007386028766632, mean p set: 0.4483141601085663
loss_pred:0.01536248903721571, decouple_loss:0.0013860238250344992
The modified gen p mean: 0.44813281297683716, gen p mean: -0.12210225313901901, mean p set: 0.4487088918685913
loss_pred:0.014800860546529293, decouple_loss:0.0012717997888103127
The modified gen p mean: 0.44798997044563293, gen p mean: -0.11985115706920624, mean p set: 0.4485621154308319
loss_pred:0.014892752282321453, decouple_loss:0.001359038520604372
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791343808174133, gen p mean: -0.12463054805994034, mean p set: 0.4484889805316925
loss_pred:0.01525178924202919, decouple_loss:0.0014500044053420424
The modified gen p mean: 0.448679655790329, gen p mean: -0.12785084545612335, mean p set: 0.4492538273334503
The modified gen p mean: 0.44866037368774414, gen p mean: -0.12301235646009445, mean p set: 0.4492361843585968
loss_pred:0.015571758151054382, decouple_loss:0.0015558114973828197
loss_pred:0.014533155597746372, decouple_loss:0.0014262017793953419
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485451281070709, gen p mean: -0.12798769772052765, mean p set: 0.44912344217300415
loss_pred:0.014118708670139313, decouple_loss:0.0011416635243222117
The modified gen p mean: 0.44802436232566833, gen p mean: -0.12586790323257446, mean p set: 0.4485989212989807
The modified gen p mean: 0.4482811391353607, gen p mean: -0.12078255414962769, mean p set: 0.4488604962825775
loss_pred:0.015947066247463226, decouple_loss:0.0012198450276628137
loss_pred:0.01450595073401928, decouple_loss:0.0010763740865513682
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474368989467621, gen p mean: -0.12535862624645233, mean p set: 0.4480117857456207
loss_pred:0.015080909244716167, decouple_loss:0.0012387954629957676
The modified gen p mean: 0.4485805034637451, gen p mean: -0.11738354712724686, mean p set: 0.4491572082042694
The modified gen p mean: 0.44709062576293945, gen p mean: -0.12498127669095993, mean p set: 0.44766971468925476
loss_pred:0.01468424592167139, decouple_loss:0.0011654406553134322
loss_pred:0.0156544279307127, decouple_loss:0.0011375624453648925
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828540086746216, gen p mean: -0.1226247176527977, mean p set: 0.4488602578639984
The modified gen p mean: 0.44778648018836975, gen p mean: -0.1210634708404541, mean p set: 0.44836267828941345
loss_pred:0.014926968142390251, decouple_loss:0.0010340561857447028
loss_pred:0.0157921202480793, decouple_loss:0.0011090608313679695
The modified gen p mean: 0.44804295897483826, gen p mean: -0.12038619071245193, mean p set: 0.4486178159713745
loss_pred:0.015236851759254932, decouple_loss:0.0010646373266354203
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447433203458786, gen p mean: -0.12168961763381958, mean p set: 0.44801095128059387
The modified gen p mean: 0.44859999418258667, gen p mean: -0.12299133837223053, mean p set: 0.44917547702789307
loss_pred:0.01533986534923315, decouple_loss:0.0010529791470617056
loss_pred:0.015053005889058113, decouple_loss:0.0011193726677447557
The modified gen p mean: 0.44919294118881226, gen p mean: -0.12688764929771423, mean p set: 0.4497707486152649
loss_pred:0.014859328046441078, decouple_loss:0.0010928047122433782
2023-04-30 22:46:15 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12565645575523376, mean p set: 0.4502691626548767
loss_pred:0.018152106553316116, decouple_loss:0.0011667251819744706
The modified gen p mean: 0.4497827887535095, gen p mean: -0.12012910097837448, mean p set: 0.45035696029663086
The modified gen p mean: 0.4494878649711609, gen p mean: -0.12092547118663788, mean p set: 0.4500633478164673
loss_pred:0.017825504764914513, decouple_loss:0.0011379974894225597
loss_pred:0.01748117245733738, decouple_loss:0.0012234009336680174
WV_1_PC_1_EH_0_PS_40, loss: 0.017878396436572075, avg_mse: 0.027623362839221954
current test mse: 0.027623
At step 20, Best test: 0.027623
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001518726348877, gen p mean: -0.11541587114334106, mean p set: 0.4505905210971832
loss_pred:0.015678197145462036, decouple_loss:0.0010398607701063156
The modified gen p mean: 0.4487631022930145, gen p mean: -0.1178804337978363, mean p set: 0.4493391215801239
loss_pred:0.015256697311997414, decouple_loss:0.0009927042992785573
The modified gen p mean: 0.4507288932800293, gen p mean: -0.11841360479593277, mean p set: 0.45130491256713867
loss_pred:0.015263944864273071, decouple_loss:0.0012046719202771783
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502905011177063, gen p mean: -0.11548910290002823, mean p set: 0.4508661925792694
loss_pred:0.015345940366387367, decouple_loss:0.0013926139799878001
The modified gen p mean: 0.4479334354400635, gen p mean: -0.12166029959917068, mean p set: 0.44850999116897583The modified gen p mean: 0.4495986998081207, gen p mean: -0.12315525859594345, mean p set: 0.4501734673976898
loss_pred:0.015641674399375916, decouple_loss:0.001352408085949719loss_pred:0.015293123200535774, decouple_loss:0.001174082630313933
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939056038856506, gen p mean: -0.12331598252058029, mean p set: 0.44996631145477295
loss_pred:0.014846393838524818, decouple_loss:0.0011991106439381838
The modified gen p mean: 0.44914016127586365, gen p mean: -0.12206927686929703, mean p set: 0.4497183561325073The modified gen p mean: 0.44990792870521545, gen p mean: -0.1164994016289711, mean p set: 0.4504837691783905
loss_pred:0.015660468488931656, decouple_loss:0.0011722331400960684
loss_pred:0.01528748869895935, decouple_loss:0.001041641691699624
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505651295185089, gen p mean: -0.11147500574588776, mean p set: 0.451143354177475
loss_pred:0.01533506903797388, decouple_loss:0.0009328442974947393
The modified gen p mean: 0.4487634301185608, gen p mean: -0.11182014644145966, mean p set: 0.44934147596359253
loss_pred:0.015334404073655605, decouple_loss:0.0009097810834646225
The modified gen p mean: 0.4490870535373688, gen p mean: -0.1132950559258461, mean p set: 0.4496645927429199
loss_pred:0.015204337425529957, decouple_loss:0.0008653269032947719
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44917890429496765, gen p mean: -0.10389261692762375, mean p set: 0.4497552812099457
loss_pred:0.014699720777571201, decouple_loss:0.001323662931099534
The modified gen p mean: 0.44827359914779663, gen p mean: -0.10873406380414963, mean p set: 0.44884949922561646
loss_pred:0.015557866543531418, decouple_loss:0.0011031925678253174
The modified gen p mean: 0.4492681920528412, gen p mean: -0.10993210226297379, mean p set: 0.4498424530029297
loss_pred:0.015339639969170094, decouple_loss:0.0011712724808603525
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490993022918701, gen p mean: -0.10186821222305298, mean p set: 0.4496765732765198
loss_pred:0.015683431178331375, decouple_loss:0.0010572229512035847
The modified gen p mean: 0.4479627311229706, gen p mean: -0.10213645547628403, mean p set: 0.4485381245613098
loss_pred:0.016030849888920784, decouple_loss:0.0011150961508974433
The modified gen p mean: 0.44910815358161926, gen p mean: -0.10649111866950989, mean p set: 0.4496835172176361
loss_pred:0.015259827487170696, decouple_loss:0.0010002772323787212
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44902271032333374, gen p mean: -0.10188480466604233, mean p set: 0.44959837198257446
loss_pred:0.01562853902578354, decouple_loss:0.000930934795178473
The modified gen p mean: 0.4487306773662567, gen p mean: -0.10064790397882462, mean p set: 0.4493071436882019
loss_pred:0.01576297916471958, decouple_loss:0.0009830716298893094
The modified gen p mean: 0.4500420391559601, gen p mean: -0.10024712979793549, mean p set: 0.4506189823150635
loss_pred:0.014887431636452675, decouple_loss:0.0009983127238228917
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013290643692017, gen p mean: -0.09891066700220108, mean p set: 0.45070981979370117
loss_pred:0.014599114656448364, decouple_loss:0.0008550501079298556
The modified gen p mean: 0.4485104978084564, gen p mean: -0.10469052940607071, mean p set: 0.44908788800239563
loss_pred:0.015825804322957993, decouple_loss:0.0009522546315565705
The modified gen p mean: 0.44853633642196655, gen p mean: -0.10399764031171799, mean p set: 0.4491119980812073
loss_pred:0.015677597373723984, decouple_loss:0.0009875509422272444
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499785900115967, gen p mean: -0.10290208458900452, mean p set: 0.4505513906478882
loss_pred:0.014402665197849274, decouple_loss:0.001053177285939455
The modified gen p mean: 0.44827648997306824, gen p mean: -0.10402694344520569, mean p set: 0.44885316491127014
loss_pred:0.015279542654752731, decouple_loss:0.0010430056136101484
The modified gen p mean: 0.4491899907588959, gen p mean: -0.10514900088310242, mean p set: 0.4497663974761963
loss_pred:0.014684098772704601, decouple_loss:0.0009693443425931036
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483703672885895, gen p mean: -0.11146673560142517, mean p set: 0.4489458501338959
loss_pred:0.014778906479477882, decouple_loss:0.0010554221225902438
The modified gen p mean: 0.44917529821395874, gen p mean: -0.1066698208451271, mean p set: 0.4497511684894562
loss_pred:0.015351474285125732, decouple_loss:0.0009420909336768091
The modified gen p mean: 0.44849255681037903, gen p mean: -0.10815533995628357, mean p set: 0.44906798005104065
loss_pred:0.015064396895468235, decouple_loss:0.0009655589237809181
2023-04-30 22:49:07 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11348002403974533, mean p set: 0.4502691626548767
loss_pred:0.017810124903917313, decouple_loss:0.0010386051144450903
The modified gen p mean: 0.44953402876853943, gen p mean: -0.10849684476852417, mean p set: 0.4500633478164673
loss_pred:0.017074886709451675, decouple_loss:0.001056396053172648
The modified gen p mean: 0.44978067278862, gen p mean: -0.10760785639286041, mean p set: 0.45035696029663086
loss_pred:0.01747296191751957, decouple_loss:0.001091982121579349
WV_1_PC_1_EH_0_PS_40, loss: 0.01750577613711357, avg_mse: 0.027167025953531265
current test mse: 0.027167
At step 30, Best test: 0.027167
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482973515987396, gen p mean: -0.1037985160946846, mean p set: 0.4488740861415863
loss_pred:0.014979167841374874, decouple_loss:0.0010015313746407628
The modified gen p mean: 0.4497385621070862, gen p mean: -0.11264835298061371, mean p set: 0.4503171145915985
loss_pred:0.014948248863220215, decouple_loss:0.00090977200306952
The modified gen p mean: 0.44955340027809143, gen p mean: -0.10503584891557693, mean p set: 0.45013123750686646
loss_pred:0.015025430358946323, decouple_loss:0.0009667134145274758
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501974284648895, gen p mean: -0.10120780020952225, mean p set: 0.4507763385772705
loss_pred:0.014436615630984306, decouple_loss:0.0009641429642215371
The modified gen p mean: 0.4496925175189972, gen p mean: -0.11067770421504974, mean p set: 0.4502677023410797The modified gen p mean: 0.4489157497882843, gen p mean: -0.1097809448838234, mean p set: 0.44949063658714294
loss_pred:0.014855622313916683, decouple_loss:0.0008643328910693526
loss_pred:0.014751503244042397, decouple_loss:0.000878283753991127
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500906467437744, gen p mean: -0.10345352441072464, mean p set: 0.45066767930984497
loss_pred:0.015159880742430687, decouple_loss:0.0009514092234894633
The modified gen p mean: 0.447562575340271, gen p mean: -0.10604652017354965, mean p set: 0.44813892245292664
loss_pred:0.015779932960867882, decouple_loss:0.000953129434492439
The modified gen p mean: 0.4500270187854767, gen p mean: -0.10242512822151184, mean p set: 0.4506046175956726
loss_pred:0.0149328438565135, decouple_loss:0.0008350055431947112
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481317400932312, gen p mean: -0.10880322009325027, mean p set: 0.44870686531066895
loss_pred:0.015934377908706665, decouple_loss:0.0008389409631490707
The modified gen p mean: 0.450809121131897, gen p mean: -0.10427802056074142, mean p set: 0.45138660073280334
loss_pred:0.014609081670641899, decouple_loss:0.0008365242392756045
The modified gen p mean: 0.44793838262557983, gen p mean: -0.10678701102733612, mean p set: 0.44851261377334595
loss_pred:0.014095489867031574, decouple_loss:0.0008970116614364088
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488438367843628, gen p mean: -0.10950334370136261, mean p set: 0.4494198262691498
loss_pred:0.01541476882994175, decouple_loss:0.0009392053470946848
The modified gen p mean: 0.44968390464782715, gen p mean: -0.110261932015419, mean p set: 0.45026013255119324
loss_pred:0.014858207665383816, decouple_loss:0.0008581234724260867
The modified gen p mean: 0.4491714537143707, gen p mean: -0.10737338662147522, mean p set: 0.4497471749782562
loss_pred:0.014204445295035839, decouple_loss:0.0008691076654940844
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484156668186188, gen p mean: -0.1099332720041275, mean p set: 0.448993444442749
loss_pred:0.014962535351514816, decouple_loss:0.0008889731834642589
The modified gen p mean: 0.44959574937820435, gen p mean: -0.11217460036277771, mean p set: 0.45017269253730774
loss_pred:0.014798608608543873, decouple_loss:0.0010009825928136706
The modified gen p mean: 0.4490998685359955, gen p mean: -0.11197320371866226, mean p set: 0.44967731833457947
loss_pred:0.014589784666895866, decouple_loss:0.0009076297283172607
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495776891708374, gen p mean: -0.1083194836974144, mean p set: 0.4501534700393677
loss_pred:0.014792907051742077, decouple_loss:0.0009749531163834035
The modified gen p mean: 0.44893166422843933, gen p mean: -0.10853146016597748, mean p set: 0.4495089054107666
loss_pred:0.014591488987207413, decouple_loss:0.000834363279864192
The modified gen p mean: 0.44956135749816895, gen p mean: -0.1113351508975029, mean p set: 0.45013657212257385
loss_pred:0.014491038396954536, decouple_loss:0.0008089679758995771
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919055700302124, gen p mean: -0.11117565631866455, mean p set: 0.4497673809528351
loss_pred:0.014909288845956326, decouple_loss:0.001053801504895091
The modified gen p mean: 0.4488213062286377, gen p mean: -0.11303333193063736, mean p set: 0.4493984878063202
loss_pred:0.015038445591926575, decouple_loss:0.0009687932324595749
The modified gen p mean: 0.4478779435157776, gen p mean: -0.11005332320928574, mean p set: 0.44845327734947205
loss_pred:0.0141897639259696, decouple_loss:0.0012784943683072925
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489445984363556, gen p mean: -0.1120496466755867, mean p set: 0.4495182931423187
loss_pred:0.01452369149774313, decouple_loss:0.0010733495000749826
The modified gen p mean: 0.44933807849884033, gen p mean: -0.11031082272529602, mean p set: 0.44991418719291687
loss_pred:0.014859064482152462, decouple_loss:0.0009539617458358407
The modified gen p mean: 0.4507140815258026, gen p mean: -0.10737285017967224, mean p set: 0.45129016041755676
loss_pred:0.014844194985926151, decouple_loss:0.001089707133360207
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048898458480835, gen p mean: -0.10787543654441833, mean p set: 0.45106619596481323
loss_pred:0.014071650803089142, decouple_loss:0.0009724954143166542
The modified gen p mean: 0.44864600896835327, gen p mean: -0.11415159702301025, mean p set: 0.449221134185791
loss_pred:0.014410904608666897, decouple_loss:0.0009452541708014905
The modified gen p mean: 0.44937947392463684, gen p mean: -0.10757046192884445, mean p set: 0.44995465874671936
loss_pred:0.014445754699409008, decouple_loss:0.0009100216557271779
2023-04-30 22:51:20 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11311947554349899, mean p set: 0.4502691626548767
loss_pred:0.0176659245043993, decouple_loss:0.0011272708652541041
The modified gen p mean: 0.44953453540802, gen p mean: -0.10803762078285217, mean p set: 0.4500633478164673
loss_pred:0.016899947077035904, decouple_loss:0.0010282157454639673
The modified gen p mean: 0.44977954030036926, gen p mean: -0.10722492635250092, mean p set: 0.45035696029663086
loss_pred:0.017386797815561295, decouple_loss:0.0011073312489315867
WV_1_PC_1_EH_0_PS_40, loss: 0.01737193763256073, avg_mse: 0.02702372521162033
current test mse: 0.027024
At step 40, Best test: 0.027024
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121142268180847, gen p mean: -0.10408657789230347, mean p set: 0.4517871141433716
loss_pred:0.019028058275580406, decouple_loss:0.0012169125257059932
The modified gen p mean: 0.44966018199920654, gen p mean: -0.10751218348741531, mean p set: 0.45023679733276367
loss_pred:0.017585722729563713, decouple_loss:0.0011949616018682718
The modified gen p mean: 0.44979438185691833, gen p mean: -0.10707636922597885, mean p set: 0.45037025213241577
loss_pred:0.017982324585318565, decouple_loss:0.001474168966524303
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45123031735420227, gen p mean: -0.10208674520254135, mean p set: 0.4518067240715027
loss_pred:0.01740245707333088, decouple_loss:0.0009945203782990575
The modified gen p mean: 0.4521859586238861, gen p mean: -0.10294824838638306, mean p set: 0.45276302099227905The modified gen p mean: 0.45120346546173096, gen p mean: -0.10901365429162979, mean p set: 0.4517802298069
loss_pred:0.01887715794146061, decouple_loss:0.0013189440360292792
loss_pred:0.018077410757541656, decouple_loss:0.0012982480693608522
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518335461616516, gen p mean: -0.10340563207864761, mean p set: 0.452411413192749
loss_pred:0.01897204853594303, decouple_loss:0.0014347309479489923
The modified gen p mean: 0.4503713548183441, gen p mean: -0.10531150549650192, mean p set: 0.45094767212867737The modified gen p mean: 0.44953057169914246, gen p mean: -0.1047532856464386, mean p set: 0.45010891556739807
loss_pred:0.019519327208399773, decouple_loss:0.0015597459860146046
loss_pred:0.01738549768924713, decouple_loss:0.0010750745423138142
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498278796672821, gen p mean: -0.1028001606464386, mean p set: 0.4504021108150482
loss_pred:0.018679626286029816, decouple_loss:0.0011667748913168907
The modified gen p mean: 0.4503057897090912, gen p mean: -0.10132890939712524, mean p set: 0.4508816599845886
loss_pred:0.018042247742414474, decouple_loss:0.0014874793123453856
The modified gen p mean: 0.4518200159072876, gen p mean: -0.09811300784349442, mean p set: 0.4523966908454895
loss_pred:0.01744096167385578, decouple_loss:0.0011227172799408436
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488780200481415, gen p mean: -0.10294828563928604, mean p set: 0.4494556486606598
loss_pred:0.017726169899106026, decouple_loss:0.0010331931989639997
The modified gen p mean: 0.4518006443977356, gen p mean: -0.09684067219495773, mean p set: 0.4523797929286957
loss_pred:0.017893869429826736, decouple_loss:0.00090562499826774
The modified gen p mean: 0.45019111037254333, gen p mean: -0.1037222370505333, mean p set: 0.4507678747177124
loss_pred:0.016763100400567055, decouple_loss:0.000956330681219697
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45120134949684143, gen p mean: -0.10551878064870834, mean p set: 0.4517803192138672
loss_pred:0.018667757511138916, decouple_loss:0.001117522595450282
The modified gen p mean: 0.45159462094306946, gen p mean: -0.10580981522798538, mean p set: 0.45217210054397583
The modified gen p mean: 0.4487122595310211, gen p mean: -0.1031324565410614, mean p set: 0.44928696751594543
loss_pred:0.017949042841792107, decouple_loss:0.0012603680370375514
loss_pred:0.015948083251714706, decouple_loss:0.0010312139056622982
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45047643780708313, gen p mean: -0.10188165307044983, mean p set: 0.4510500431060791
loss_pred:0.017676005139946938, decouple_loss:0.0012165310326963663
The modified gen p mean: 0.4483238160610199, gen p mean: -0.10217401385307312, mean p set: 0.44889846444129944
loss_pred:0.019053345546126366, decouple_loss:0.001139829051680863
The modified gen p mean: 0.4492124915122986, gen p mean: -0.10376818478107452, mean p set: 0.44978898763656616
loss_pred:0.016505563631653786, decouple_loss:0.001177610014565289
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45111823081970215, gen p mean: -0.09218990057706833, mean p set: 0.4516959488391876
loss_pred:0.017742427065968513, decouple_loss:0.0010500190546736121
The modified gen p mean: 0.4500620365142822, gen p mean: -0.1038447916507721, mean p set: 0.4506370425224304
loss_pred:0.019461555406451225, decouple_loss:0.001362559967674315
The modified gen p mean: 0.4486900866031647, gen p mean: -0.10178451240062714, mean p set: 0.4492642879486084
loss_pred:0.017143430188298225, decouple_loss:0.0008878601947799325
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449054479598999, gen p mean: -0.10352587699890137, mean p set: 0.44963186979293823
loss_pred:0.019296061247587204, decouple_loss:0.00166191381867975
The modified gen p mean: 0.4487488567829132, gen p mean: -0.10362555086612701, mean p set: 0.44932547211647034
loss_pred:0.017454329878091812, decouple_loss:0.0010783366160467267
The modified gen p mean: 0.4510512053966522, gen p mean: -0.09821213781833649, mean p set: 0.451625794172287
loss_pred:0.016761958599090576, decouple_loss:0.0012163824867457151
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492422938346863, gen p mean: -0.11064926534891129, mean p set: 0.4498198330402374
loss_pred:0.01789797656238079, decouple_loss:0.0011482523987069726
The modified gen p mean: 0.4494872987270355, gen p mean: -0.10956299304962158, mean p set: 0.45006316900253296
loss_pred:0.017167719081044197, decouple_loss:0.0012938040308654308
The modified gen p mean: 0.4514724612236023, gen p mean: -0.10493253916501999, mean p set: 0.4520488977432251
loss_pred:0.01773001067340374, decouple_loss:0.0012526168720796704
2023-04-30 22:54:12 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12119728326797485, mean p set: 0.4502691626548767
loss_pred:0.017791766673326492, decouple_loss:0.0010811352403834462
The modified gen p mean: 0.44953393936157227, gen p mean: -0.1164194867014885, mean p set: 0.4500633478164673
loss_pred:0.017109215259552002, decouple_loss:0.0011499272659420967
The modified gen p mean: 0.44978073239326477, gen p mean: -0.11553104221820831, mean p set: 0.45035696029663086
loss_pred:0.017446748912334442, decouple_loss:0.00119532470125705
WV_1_PC_1_EH_0_PS_40, loss: 0.017506351694464684, avg_mse: 0.027221757918596268
current test mse: 0.027222
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45003819465637207, gen p mean: -0.11733544617891312, mean p set: 0.4506132900714874
loss_pred:0.017633900046348572, decouple_loss:0.0011027902364730835
The modified gen p mean: 0.4503343999385834, gen p mean: -0.1066989079117775, mean p set: 0.4509114921092987The modified gen p mean: 0.451259583234787, gen p mean: -0.10532774776220322, mean p set: 0.4518364667892456
loss_pred:0.01728503592312336, decouple_loss:0.0011368964333087206
loss_pred:0.017738351598381996, decouple_loss:0.0011675211135298014
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506601393222809, gen p mean: -0.12536410987377167, mean p set: 0.4512340724468231
loss_pred:0.018439408391714096, decouple_loss:0.0010148939909413457
The modified gen p mean: 0.45013758540153503, gen p mean: -0.12061123549938202, mean p set: 0.4507118761539459The modified gen p mean: 0.4510015547275543, gen p mean: -0.11928829550743103, mean p set: 0.4515781104564667
loss_pred:0.01775427535176277, decouple_loss:0.001174691366031766
loss_pred:0.016742665320634842, decouple_loss:0.001355183543637395
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44961875677108765, gen p mean: -0.12416619062423706, mean p set: 0.4501945972442627
loss_pred:0.01787615194916725, decouple_loss:0.0010686464374884963
The modified gen p mean: 0.44989559054374695, gen p mean: -0.1283077746629715, mean p set: 0.4504729211330414
The modified gen p mean: 0.44992122054100037, gen p mean: -0.12415812164545059, mean p set: 0.45049622654914856
loss_pred:0.016920151188969612, decouple_loss:0.0010713392402976751
loss_pred:0.018591951578855515, decouple_loss:0.0010831457329913974
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494471251964569, gen p mean: -0.129771426320076, mean p set: 0.4500194787979126
loss_pred:0.0172420684248209, decouple_loss:0.001089294208213687
The modified gen p mean: 0.4500570595264435, gen p mean: -0.12605659663677216, mean p set: 0.4506323039531708
loss_pred:0.018291374668478966, decouple_loss:0.0010761646553874016
The modified gen p mean: 0.4503093957901001, gen p mean: -0.12442570924758911, mean p set: 0.4508860111236572
loss_pred:0.016864322125911713, decouple_loss:0.0013508294941857457
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492095410823822, gen p mean: -0.12699371576309204, mean p set: 0.449785053730011
loss_pred:0.01706630364060402, decouple_loss:0.0014040035894140601
The modified gen p mean: 0.45004910230636597, gen p mean: -0.11787674576044083, mean p set: 0.4506262540817261
loss_pred:0.01669505052268505, decouple_loss:0.0012449003988876939
The modified gen p mean: 0.44981902837753296, gen p mean: -0.12791506946086884, mean p set: 0.4503953158855438
loss_pred:0.017168384045362473, decouple_loss:0.0013777251588180661
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522111415863037, gen p mean: -0.11876710504293442, mean p set: 0.452788382768631
loss_pred:0.01796107180416584, decouple_loss:0.0011733958963304758
The modified gen p mean: 0.4512307345867157, gen p mean: -0.12248282134532928, mean p set: 0.45180633664131165
loss_pred:0.01757565326988697, decouple_loss:0.0009494774858467281
The modified gen p mean: 0.4509291350841522, gen p mean: -0.12404179573059082, mean p set: 0.4515089690685272
loss_pred:0.017248140648007393, decouple_loss:0.0009400597191415727
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497532546520233, gen p mean: -0.10984092950820923, mean p set: 0.4503283202648163
loss_pred:0.01700202375650406, decouple_loss:0.0011387171689420938
The modified gen p mean: 0.45084312558174133, gen p mean: -0.11476368457078934, mean p set: 0.45142364501953125
loss_pred:0.017712684348225594, decouple_loss:0.001015085494145751
The modified gen p mean: 0.4516005218029022, gen p mean: -0.1107468456029892, mean p set: 0.4521786570549011
loss_pred:0.016480112448334694, decouple_loss:0.000995835056528449
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513402283191681, gen p mean: -0.10452575236558914, mean p set: 0.4519183933734894
loss_pred:0.01652657799422741, decouple_loss:0.0009659257484599948
The modified gen p mean: 0.44847214221954346, gen p mean: -0.10506260395050049, mean p set: 0.44904741644859314
loss_pred:0.019454244524240494, decouple_loss:0.00097973074298352
The modified gen p mean: 0.4522548317909241, gen p mean: -0.10701096802949905, mean p set: 0.4528287649154663
loss_pred:0.017571764066815376, decouple_loss:0.0010497851762920618
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44998979568481445, gen p mean: -0.10223953425884247, mean p set: 0.4505631625652313
loss_pred:0.017289094626903534, decouple_loss:0.001104523311369121
The modified gen p mean: 0.45003053545951843, gen p mean: -0.10877975076436996, mean p set: 0.45060670375823975
loss_pred:0.016962511464953423, decouple_loss:0.0008897514780983329
The modified gen p mean: 0.4488706886768341, gen p mean: -0.10853312164545059, mean p set: 0.44944655895233154
loss_pred:0.01637526974081993, decouple_loss:0.0010145452106371522
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497971832752228, gen p mean: -0.10649993270635605, mean p set: 0.45037439465522766
loss_pred:0.01679081842303276, decouple_loss:0.00094361457740888
The modified gen p mean: 0.4515063762664795, gen p mean: -0.10918574035167694, mean p set: 0.45208439230918884
loss_pred:0.017696332186460495, decouple_loss:0.0014216849813237786
The modified gen p mean: 0.4518069922924042, gen p mean: -0.10671313852071762, mean p set: 0.4523853361606598
loss_pred:0.018819304183125496, decouple_loss:0.0013250451302155852
2023-04-30 22:56:19 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11737816780805588, mean p set: 0.4502691626548767
loss_pred:0.017939215525984764, decouple_loss:0.0011308531975373626
The modified gen p mean: 0.449533611536026, gen p mean: -0.11225029081106186, mean p set: 0.4500633478164673
loss_pred:0.01711874082684517, decouple_loss:0.0010100937215611339
The modified gen p mean: 0.4497796297073364, gen p mean: -0.11146888881921768, mean p set: 0.45035696029663086
loss_pred:0.01752621866762638, decouple_loss:0.000945593579672277
WV_1_PC_1_EH_0_PS_40, loss: 0.01757950149476528, avg_mse: 0.027300618588924408
current test mse: 0.027301
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
NaN value num: 0
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939425587654114, gen p mean: -0.10949815064668655, mean p set: 0.4499700367450714
loss_pred:0.017805084586143494, decouple_loss:0.0009974305285140872
The modified gen p mean: 0.4482962489128113, gen p mean: -0.10937085747718811, mean p set: 0.44887450337409973
loss_pred:0.01634618267416954, decouple_loss:0.0010007871314883232
The modified gen p mean: 0.4480346441268921, gen p mean: -0.11116968095302582, mean p set: 0.44861045479774475
loss_pred:0.017410676926374435, decouple_loss:0.0010774279944598675
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481900632381439, gen p mean: -0.11190704256296158, mean p set: 0.44876495003700256
loss_pred:0.01626644656062126, decouple_loss:0.000927186047192663
The modified gen p mean: 0.4500681459903717, gen p mean: -0.10792878270149231, mean p set: 0.45064541697502136The modified gen p mean: 0.4482968747615814, gen p mean: -0.10656564682722092, mean p set: 0.4488722085952759
loss_pred:0.018103646114468575, decouple_loss:0.001038136426359415
loss_pred:0.01770101487636566, decouple_loss:0.0011805570684373379
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472285509109497, gen p mean: -0.10608202964067459, mean p set: 0.44780394434928894
loss_pred:0.01633181981742382, decouple_loss:0.001104881172068417
The modified gen p mean: 0.44936156272888184, gen p mean: -0.10674583911895752, mean p set: 0.4499356150627136
loss_pred:0.017772657796740532, decouple_loss:0.0011418287176638842
The modified gen p mean: 0.44908952713012695, gen p mean: -0.113568015396595, mean p set: 0.4496622681617737
loss_pred:0.016812244430184364, decouple_loss:0.0011905906721949577
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824928045272827, gen p mean: -0.11077623069286346, mean p set: 0.4488237500190735
loss_pred:0.0173183660954237, decouple_loss:0.0009876583935692906
The modified gen p mean: 0.45032998919487, gen p mean: -0.11019407212734222, mean p set: 0.4509085714817047
loss_pred:0.016891086474061012, decouple_loss:0.0013596114004030824
The modified gen p mean: 0.450636088848114, gen p mean: -0.1111820638179779, mean p set: 0.45121368765830994
loss_pred:0.016050897538661957, decouple_loss:0.001113660167902708
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864988327026367, gen p mean: -0.10951089859008789, mean p set: 0.4492228329181671
loss_pred:0.017001263797283173, decouple_loss:0.0013459321344271302
The modified gen p mean: 0.4507947266101837, gen p mean: -0.11002647131681442, mean p set: 0.45137009024620056
loss_pred:0.015899086371064186, decouple_loss:0.001027956372126937
The modified gen p mean: 0.4476986527442932, gen p mean: -0.10640321671962738, mean p set: 0.44827306270599365
loss_pred:0.016708653420209885, decouple_loss:0.001469431328587234
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503590166568756, gen p mean: -0.10916560143232346, mean p set: 0.45093539357185364
loss_pred:0.01795073039829731, decouple_loss:0.0010451972484588623
The modified gen p mean: 0.4501386880874634, gen p mean: -0.10605894774198532, mean p set: 0.4507155418395996
loss_pred:0.016983015462756157, decouple_loss:0.0010704497108235955
The modified gen p mean: 0.4499596655368805, gen p mean: -0.10695996135473251, mean p set: 0.4505380690097809
loss_pred:0.017030928283929825, decouple_loss:0.0009672846063040197
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44897836446762085, gen p mean: -0.10403496772050858, mean p set: 0.44955530762672424
loss_pred:0.01704377867281437, decouple_loss:0.001150054158642888
The modified gen p mean: 0.4491567611694336, gen p mean: -0.10941340774297714, mean p set: 0.4497326612472534
The modified gen p mean: 0.44845306873321533, gen p mean: -0.1084972694516182, mean p set: 0.44903048872947693
loss_pred:0.018306419253349304, decouple_loss:0.0011518985265865922
loss_pred:0.017480500042438507, decouple_loss:0.0009285073610953987
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493742883205414, gen p mean: -0.10016433894634247, mean p set: 0.44994959235191345
loss_pred:0.016895592212677002, decouple_loss:0.0009132405975833535
The modified gen p mean: 0.4497702419757843, gen p mean: -0.10249853879213333, mean p set: 0.45034751296043396
The modified gen p mean: 0.4502868950366974, gen p mean: -0.10413672775030136, mean p set: 0.45086273550987244
loss_pred:0.017473602667450905, decouple_loss:0.0009349928004667163
loss_pred:0.016923807561397552, decouple_loss:0.0008832902531139553
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44920939207077026, gen p mean: -0.09846817702054977, mean p set: 0.44978684186935425
loss_pred:0.016590125858783722, decouple_loss:0.001051572966389358
The modified gen p mean: 0.4486592710018158, gen p mean: -0.10114862024784088, mean p set: 0.4492338001728058
loss_pred:0.016729136928915977, decouple_loss:0.0011123520089313388
The modified gen p mean: 0.4499252438545227, gen p mean: -0.09510961920022964, mean p set: 0.4505022168159485
loss_pred:0.01682610996067524, decouple_loss:0.0008562779403291643
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45109453797340393, gen p mean: -0.09104964137077332, mean p set: 0.45167189836502075
loss_pred:0.01625673845410347, decouple_loss:0.001006913254968822
The modified gen p mean: 0.44832709431648254, gen p mean: -0.08987115323543549, mean p set: 0.44889989495277405
loss_pred:0.016707418486475945, decouple_loss:0.0009622763027437031
The modified gen p mean: 0.4480324983596802, gen p mean: -0.08994216471910477, mean p set: 0.44860953092575073
loss_pred:0.017245814204216003, decouple_loss:0.0011566972825676203
2023-04-30 22:59:10 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10117505490779877, mean p set: 0.4502691626548767
loss_pred:0.01799224503338337, decouple_loss:0.0009884474566206336
The modified gen p mean: 0.4495355188846588, gen p mean: -0.09573458135128021, mean p set: 0.4500633478164673
loss_pred:0.017133230343461037, decouple_loss:0.0010328841162845492
The modified gen p mean: 0.4497796297073364, gen p mean: -0.09484437108039856, mean p set: 0.45035696029663086
loss_pred:0.017570631578564644, decouple_loss:0.0009930208325386047
WV_1_PC_1_EH_0_PS_40, loss: 0.017615608870983124, avg_mse: 0.027245227247476578
current test mse: 0.027245
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45009925961494446, gen p mean: -0.09268298000097275, mean p set: 0.4506763517856598
loss_pred:0.016741707921028137, decouple_loss:0.0010166638530790806
The modified gen p mean: 0.4478672742843628, gen p mean: -0.09541259706020355, mean p set: 0.4484439492225647The modified gen p mean: 0.4490010440349579, gen p mean: -0.09126441925764084, mean p set: 0.4495784640312195
loss_pred:0.017160270363092422, decouple_loss:0.0010304702445864677
loss_pred:0.017469234764575958, decouple_loss:0.0009890743531286716
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484717845916748, gen p mean: -0.09433980286121368, mean p set: 0.44904738664627075
loss_pred:0.016989249736070633, decouple_loss:0.0008863660623319447
The modified gen p mean: 0.4504077434539795, gen p mean: -0.09694833308458328, mean p set: 0.45098215341567993The modified gen p mean: 0.44927117228507996, gen p mean: -0.09862393885850906, mean p set: 0.44984734058380127
loss_pred:0.01721077784895897, decouple_loss:0.0010411000112071633
loss_pred:0.01763792522251606, decouple_loss:0.001041875104419887
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498947858810425, gen p mean: -0.10249501466751099, mean p set: 0.4504702091217041
loss_pred:0.016839276999235153, decouple_loss:0.0010873444844037294
The modified gen p mean: 0.44990766048431396, gen p mean: -0.10509948432445526, mean p set: 0.45048466324806213The modified gen p mean: 0.44873476028442383, gen p mean: -0.10347389429807663, mean p set: 0.4493105113506317
loss_pred:0.016417691484093666, decouple_loss:0.0010769714135676622loss_pred:0.017072487622499466, decouple_loss:0.0013212681515142322
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500895142555237, gen p mean: -0.10732447355985641, mean p set: 0.4506658911705017
loss_pred:0.01695152558386326, decouple_loss:0.0010598767548799515
The modified gen p mean: 0.44965073466300964, gen p mean: -0.11391174793243408, mean p set: 0.450225830078125
loss_pred:0.018063833937048912, decouple_loss:0.0011130220955237746
The modified gen p mean: 0.44879278540611267, gen p mean: -0.11378219723701477, mean p set: 0.44936615228652954
loss_pred:0.01654057390987873, decouple_loss:0.0010443972423672676
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44888150691986084, gen p mean: -0.10946101695299149, mean p set: 0.4494599997997284
loss_pred:0.016952205449342728, decouple_loss:0.00098817003890872
The modified gen p mean: 0.4494175314903259, gen p mean: -0.11108741909265518, mean p set: 0.44999101758003235
loss_pred:0.016934527084231377, decouple_loss:0.000887477770447731
The modified gen p mean: 0.4499644339084625, gen p mean: -0.11339084804058075, mean p set: 0.4505395293235779
loss_pred:0.018290778622031212, decouple_loss:0.001291567226871848
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45036980509757996, gen p mean: -0.11019566655158997, mean p set: 0.4509481191635132
loss_pred:0.016689233481884003, decouple_loss:0.000977843999862671
The modified gen p mean: 0.44851016998291016, gen p mean: -0.11312601715326309, mean p set: 0.4490853548049927
loss_pred:0.016392843797802925, decouple_loss:0.0008541657589375973
The modified gen p mean: 0.4492414593696594, gen p mean: -0.11375201493501663, mean p set: 0.4498175084590912
loss_pred:0.01697111502289772, decouple_loss:0.0008821855881251395
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45020896196365356, gen p mean: -0.1162121519446373, mean p set: 0.45078325271606445
loss_pred:0.016341909766197205, decouple_loss:0.0011184022296220064
The modified gen p mean: 0.44925665855407715, gen p mean: -0.11069463938474655, mean p set: 0.44983452558517456
The modified gen p mean: 0.4508615732192993, gen p mean: -0.11151087284088135, mean p set: 0.4514385461807251
loss_pred:0.01685008965432644, decouple_loss:0.0009013237431645393
loss_pred:0.0172492116689682, decouple_loss:0.0010047995019704103
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486866295337677, gen p mean: -0.11034610867500305, mean p set: 0.4492644667625427
loss_pred:0.01609700173139572, decouple_loss:0.0009064262849278748
The modified gen p mean: 0.4485657215118408, gen p mean: -0.10740923136472702, mean p set: 0.4491414725780487
loss_pred:0.017136860638856888, decouple_loss:0.0009786805603653193
The modified gen p mean: 0.44917356967926025, gen p mean: -0.11219006031751633, mean p set: 0.4497472941875458
loss_pred:0.016416532918810844, decouple_loss:0.0009361961856484413
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482710361480713, gen p mean: -0.10642058402299881, mean p set: 0.4488454759120941
loss_pred:0.016633590683341026, decouple_loss:0.0009159243199974298
The modified gen p mean: 0.4484172463417053, gen p mean: -0.10821382701396942, mean p set: 0.44899222254753113
loss_pred:0.015175496228039265, decouple_loss:0.0009225308313034475
The modified gen p mean: 0.4494172930717468, gen p mean: -0.10467825084924698, mean p set: 0.44999319314956665
loss_pred:0.01691730134189129, decouple_loss:0.0009786162991076708
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44863826036453247, gen p mean: -0.10517707467079163, mean p set: 0.44921573996543884
loss_pred:0.015551845543086529, decouple_loss:0.0008924654102884233
The modified gen p mean: 0.4500020146369934, gen p mean: -0.10487650334835052, mean p set: 0.4505808651447296
loss_pred:0.016609029844403267, decouple_loss:0.0009552469709888101
The modified gen p mean: 0.44756239652633667, gen p mean: -0.10709062218666077, mean p set: 0.4481392800807953
loss_pred:0.016494331881403923, decouple_loss:0.0009922379394993186
2023-04-30 23:01:16 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11583556979894638, mean p set: 0.4502691626548767
loss_pred:0.017933297902345657, decouple_loss:0.0010836066212505102
The modified gen p mean: 0.4495368003845215, gen p mean: -0.11038260161876678, mean p set: 0.4500633478164673
loss_pred:0.01715756766498089, decouple_loss:0.0010007194941863418
The modified gen p mean: 0.44977840781211853, gen p mean: -0.10977897047996521, mean p set: 0.45035696029663086
loss_pred:0.01751386560499668, decouple_loss:0.00102744169998914
WV_1_PC_1_EH_0_PS_40, loss: 0.01758677512407303, avg_mse: 0.027244649827480316
current test mse: 0.027245
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768038392066956, gen p mean: -0.10782980173826218, mean p set: 0.4482579529285431
loss_pred:0.01539307739585638, decouple_loss:0.0008563532028347254
The modified gen p mean: 0.4462983310222626, gen p mean: -0.11733682453632355, mean p set: 0.4468747675418854
loss_pred:0.015877898782491684, decouple_loss:0.00104133237618953
The modified gen p mean: 0.44851958751678467, gen p mean: -0.11457838863134384, mean p set: 0.4490965008735657
loss_pred:0.015552392229437828, decouple_loss:0.001117554260417819
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931119680404663, gen p mean: -0.10834255069494247, mean p set: 0.44988885521888733
loss_pred:0.015494104474782944, decouple_loss:0.0011026987340301275
The modified gen p mean: 0.44722461700439453, gen p mean: -0.11285743862390518, mean p set: 0.44780102372169495The modified gen p mean: 0.4476966857910156, gen p mean: -0.11434859037399292, mean p set: 0.4482734203338623
loss_pred:0.01585806906223297, decouple_loss:0.0010225786827504635
loss_pred:0.014840579591691494, decouple_loss:0.0009663588716648519
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728559255599976, gen p mean: -0.12290964275598526, mean p set: 0.4478631317615509
loss_pred:0.015091195702552795, decouple_loss:0.000842742680106312
The modified gen p mean: 0.4475162625312805, gen p mean: -0.11767971515655518, mean p set: 0.44809263944625854
loss_pred:0.014712604694068432, decouple_loss:0.0008682482875883579
The modified gen p mean: 0.4489883780479431, gen p mean: -0.12298845499753952, mean p set: 0.4495646357536316
loss_pred:0.014992212876677513, decouple_loss:0.00077026680810377
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482171833515167, gen p mean: -0.12491884082555771, mean p set: 0.44879457354545593
loss_pred:0.014835644513368607, decouple_loss:0.0009356202790513635
The modified gen p mean: 0.4473876655101776, gen p mean: -0.12602441012859344, mean p set: 0.44796544313430786
loss_pred:0.014896035194396973, decouple_loss:0.0010192635236307979
The modified gen p mean: 0.4476548731327057, gen p mean: -0.12607167661190033, mean p set: 0.4482307732105255
loss_pred:0.014749893918633461, decouple_loss:0.0010491813300177455
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854429364204407, gen p mean: -0.12707647681236267, mean p set: 0.4491168260574341
loss_pred:0.01535232923924923, decouple_loss:0.00098700902890414
The modified gen p mean: 0.4486970603466034, gen p mean: -0.1303013414144516, mean p set: 0.4492718279361725
loss_pred:0.01505003497004509, decouple_loss:0.0009796819649636745
The modified gen p mean: 0.4486236870288849, gen p mean: -0.12122945487499237, mean p set: 0.44919851422309875
loss_pred:0.014949001371860504, decouple_loss:0.0010155158815905452
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474676251411438, gen p mean: -0.12655015289783478, mean p set: 0.44804564118385315
loss_pred:0.015077025629580021, decouple_loss:0.0008298646425828338
The modified gen p mean: 0.4460603892803192, gen p mean: -0.12232735753059387, mean p set: 0.44663533568382263
loss_pred:0.014689063653349876, decouple_loss:0.0008913115016184747
The modified gen p mean: 0.4463925063610077, gen p mean: -0.12580296397209167, mean p set: 0.44696733355522156
loss_pred:0.014527693390846252, decouple_loss:0.0009625998209230602
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44825124740600586, gen p mean: -0.12300888448953629, mean p set: 0.4488264322280884
loss_pred:0.014897431246936321, decouple_loss:0.0009684499236755073
The modified gen p mean: 0.4479488730430603, gen p mean: -0.11672354489564896, mean p set: 0.4485265016555786
loss_pred:0.014208218082785606, decouple_loss:0.001036842237226665
The modified gen p mean: 0.4481887221336365, gen p mean: -0.12234630435705185, mean p set: 0.4487667679786682
loss_pred:0.014837053604424, decouple_loss:0.0008381818770430982
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482395350933075, gen p mean: -0.10895893722772598, mean p set: 0.4488143026828766
loss_pred:0.014732682146131992, decouple_loss:0.0009062431054189801
The modified gen p mean: 0.4481654763221741, gen p mean: -0.11840087175369263, mean p set: 0.4487411379814148
loss_pred:0.014140299521386623, decouple_loss:0.0008681531762704253
The modified gen p mean: 0.45008552074432373, gen p mean: -0.11423011124134064, mean p set: 0.45066288113594055
loss_pred:0.014570455066859722, decouple_loss:0.000955523457378149
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480079710483551, gen p mean: -0.11081945151090622, mean p set: 0.4485826790332794
loss_pred:0.014545581303536892, decouple_loss:0.000873706245329231
The modified gen p mean: 0.45079001784324646, gen p mean: -0.1121424064040184, mean p set: 0.4513660967350006
loss_pred:0.014569933526217937, decouple_loss:0.0007901351782493293
The modified gen p mean: 0.44808122515678406, gen p mean: -0.11868531256914139, mean p set: 0.4486563205718994
loss_pred:0.014145203866064548, decouple_loss:0.0007923915982246399
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464648365974426, gen p mean: -0.11431307345628738, mean p set: 0.44704070687294006
loss_pred:0.014108866453170776, decouple_loss:0.0008610649383626878
The modified gen p mean: 0.4483814537525177, gen p mean: -0.11684833467006683, mean p set: 0.44895556569099426
loss_pred:0.014957637526094913, decouple_loss:0.000984576647169888
The modified gen p mean: 0.4486624300479889, gen p mean: -0.11129456758499146, mean p set: 0.4492388665676117
loss_pred:0.014201588928699493, decouple_loss:0.0008770136628299952
2023-04-30 23:04:09 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1149027869105339, mean p set: 0.4502691626548767
loss_pred:0.01784026436507702, decouple_loss:0.0012246532132849097
The modified gen p mean: 0.44953498244285583, gen p mean: -0.10976919531822205, mean p set: 0.4500633478164673
loss_pred:0.017060600221157074, decouple_loss:0.0010676354868337512
The modified gen p mean: 0.44978079199790955, gen p mean: -0.10916034877300262, mean p set: 0.45035696029663086
loss_pred:0.01749081164598465, decouple_loss:0.001088567660190165
WV_1_PC_1_EH_0_PS_40, loss: 0.01752023957669735, avg_mse: 0.02710079587996006
current test mse: 0.027101
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718143343925476, gen p mean: -0.1159573569893837, mean p set: 0.44775673747062683
loss_pred:0.014225413091480732, decouple_loss:0.0009998541790992022
The modified gen p mean: 0.44856178760528564, gen p mean: -0.10299565643072128, mean p set: 0.44913890957832336The modified gen p mean: 0.4477711021900177, gen p mean: -0.1129366010427475, mean p set: 0.4483499228954315
loss_pred:0.014554569497704506, decouple_loss:0.0010434852447360754
loss_pred:0.014324096962809563, decouple_loss:0.0013325486797839403
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44913795590400696, gen p mean: -0.11600325256586075, mean p set: 0.44971415400505066
loss_pred:0.01498472224920988, decouple_loss:0.0011242340551689267
The modified gen p mean: 0.44952622056007385, gen p mean: -0.11415474116802216, mean p set: 0.4501021206378937The modified gen p mean: 0.44756871461868286, gen p mean: -0.10962347686290741, mean p set: 0.4481477439403534
loss_pred:0.014295920729637146, decouple_loss:0.0008396873599849641
loss_pred:0.014449725858867168, decouple_loss:0.0007723239832557738
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448090523481369, gen p mean: -0.11260448396205902, mean p set: 0.44866693019866943
loss_pred:0.014394902624189854, decouple_loss:0.0008902993286028504
The modified gen p mean: 0.44786566495895386, gen p mean: -0.11365857720375061, mean p set: 0.44844454526901245
loss_pred:0.014001977629959583, decouple_loss:0.0008625269983895123
The modified gen p mean: 0.4478341341018677, gen p mean: -0.11241529136896133, mean p set: 0.448408842086792
loss_pred:0.014903298579156399, decouple_loss:0.0008344022207893431
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744664430618286, gen p mean: -0.11598211526870728, mean p set: 0.4480225145816803
loss_pred:0.015100459568202496, decouple_loss:0.0010835753055289388
The modified gen p mean: 0.44641393423080444, gen p mean: -0.12136673182249069, mean p set: 0.446990966796875
loss_pred:0.014664025977253914, decouple_loss:0.0012929170625284314
The modified gen p mean: 0.4480096101760864, gen p mean: -0.11651445925235748, mean p set: 0.4485855996608734
loss_pred:0.014668764546513557, decouple_loss:0.0008114048978313804
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484086334705353, gen p mean: -0.11066377907991409, mean p set: 0.44898515939712524
loss_pred:0.01426711492240429, decouple_loss:0.0009831816423684359
The modified gen p mean: 0.44862326979637146, gen p mean: -0.11252297461032867, mean p set: 0.44920095801353455
loss_pred:0.01435527391731739, decouple_loss:0.000890838447958231
The modified gen p mean: 0.44697681069374084, gen p mean: -0.12186277657747269, mean p set: 0.44755133986473083
loss_pred:0.013673710636794567, decouple_loss:0.0009623990627005696
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486501216888428, gen p mean: -0.11251644045114517, mean p set: 0.4492274820804596
loss_pred:0.014115285128355026, decouple_loss:0.0009835923556238413
The modified gen p mean: 0.4482578635215759, gen p mean: -0.1135326474905014, mean p set: 0.44883567094802856
loss_pred:0.014658731408417225, decouple_loss:0.0010803488548845053
The modified gen p mean: 0.44796502590179443, gen p mean: -0.11112523078918457, mean p set: 0.44854292273521423
loss_pred:0.014045551419258118, decouple_loss:0.0012850440107285976
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483107626438141, gen p mean: -0.1123945340514183, mean p set: 0.4488862454891205
loss_pred:0.014539998956024647, decouple_loss:0.000857842096593231
The modified gen p mean: 0.44815731048583984, gen p mean: -0.11555659025907516, mean p set: 0.4487343728542328
loss_pred:0.015172962099313736, decouple_loss:0.0009372077183797956
The modified gen p mean: 0.448665052652359, gen p mean: -0.10723480582237244, mean p set: 0.4492424428462982
loss_pred:0.014169461093842983, decouple_loss:0.0008711540140211582
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482809901237488, gen p mean: -0.11178777366876602, mean p set: 0.44885557889938354
loss_pred:0.013972381129860878, decouple_loss:0.0011424743570387363
The modified gen p mean: 0.4477286636829376, gen p mean: -0.11296415328979492, mean p set: 0.44830387830734253
The modified gen p mean: 0.44669750332832336, gen p mean: -0.11816006153821945, mean p set: 0.4472724497318268
loss_pred:0.015139715746045113, decouple_loss:0.0009179612970910966
loss_pred:0.01431598886847496, decouple_loss:0.0010498290648683906
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819366931915283, gen p mean: -0.11174509674310684, mean p set: 0.44876742362976074
loss_pred:0.014395371079444885, decouple_loss:0.0008698587189428508
The modified gen p mean: 0.4501095116138458, gen p mean: -0.11134924739599228, mean p set: 0.450685054063797
loss_pred:0.01431662030518055, decouple_loss:0.0010576102649793029
The modified gen p mean: 0.4474954307079315, gen p mean: -0.11439064145088196, mean p set: 0.4480714499950409
loss_pred:0.013915940187871456, decouple_loss:0.0009497828432358801
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779327511787415, gen p mean: -0.11934799700975418, mean p set: 0.44836726784706116
loss_pred:0.013605293817818165, decouple_loss:0.0008876770734786987
The modified gen p mean: 0.44874173402786255, gen p mean: -0.10813362896442413, mean p set: 0.449319064617157
loss_pred:0.01435182522982359, decouple_loss:0.000980833894573152
The modified gen p mean: 0.4492585361003876, gen p mean: -0.10618279874324799, mean p set: 0.44983553886413574
loss_pred:0.014102851040661335, decouple_loss:0.0009944331832230091
2023-04-30 23:06:17 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.11854446679353714, mean p set: 0.4502691626548767
loss_pred:0.01771005243062973, decouple_loss:0.001040330738760531
The modified gen p mean: 0.44953685998916626, gen p mean: -0.11317672580480576, mean p set: 0.4500633478164673
loss_pred:0.0170008335262537, decouple_loss:0.001218107296153903
The modified gen p mean: 0.4497801959514618, gen p mean: -0.11290107667446136, mean p set: 0.45035696029663086
loss_pred:0.017422711476683617, decouple_loss:0.0011062853736802936
WV_1_PC_1_EH_0_PS_40, loss: 0.01743394508957863, avg_mse: 0.027015216648578644
current test mse: 0.027015
At step 100, Best test: 0.027015
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
NaN value num: 0
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45324093103408813, gen p mean: -0.10347696393728256, mean p set: 0.4538205564022064
loss_pred:0.0183048527687788, decouple_loss:0.0011507879244163632
The modified gen p mean: 0.45188388228416443, gen p mean: -0.10650495439767838, mean p set: 0.4524628818035126
loss_pred:0.017729006707668304, decouple_loss:0.0014260448515415192
The modified gen p mean: 0.4525352418422699, gen p mean: -0.10676702857017517, mean p set: 0.45311251282691956
loss_pred:0.017271317541599274, decouple_loss:0.0011130378115922213
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45148640871047974, gen p mean: -0.1093200072646141, mean p set: 0.4520629048347473
loss_pred:0.01744598150253296, decouple_loss:0.0009405511082150042
The modified gen p mean: 0.4511895477771759, gen p mean: -0.11015098541975021, mean p set: 0.45176732540130615The modified gen p mean: 0.45226359367370605, gen p mean: -0.10896650701761246, mean p set: 0.4528384804725647
loss_pred:0.017702143639326096, decouple_loss:0.001170507282949984
loss_pred:0.01725051924586296, decouple_loss:0.0014179050922393799
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504257142543793, gen p mean: -0.09930992871522903, mean p set: 0.4510028660297394
loss_pred:0.01669684611260891, decouple_loss:0.0013060590717941523
The modified gen p mean: 0.45267924666404724, gen p mean: -0.10527177155017853, mean p set: 0.4532550275325775The modified gen p mean: 0.45201176404953003, gen p mean: -0.10768921673297882, mean p set: 0.4525880217552185
loss_pred:0.017485955730080605, decouple_loss:0.0012939771404489875
loss_pred:0.016766903921961784, decouple_loss:0.0010824796045199037
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45041605830192566, gen p mean: -0.09886384010314941, mean p set: 0.4509917199611664
loss_pred:0.01680433750152588, decouple_loss:0.0009828123729676008
The modified gen p mean: 0.4514032304286957, gen p mean: -0.10025458037853241, mean p set: 0.45197993516921997
loss_pred:0.01783919148147106, decouple_loss:0.0009574675932526588
The modified gen p mean: 0.4495193064212799, gen p mean: -0.1098082885146141, mean p set: 0.45009464025497437
loss_pred:0.017464518547058105, decouple_loss:0.0010740779107436538
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534408748149872, gen p mean: -0.10746417939662933, mean p set: 0.4540169835090637
loss_pred:0.016906777396798134, decouple_loss:0.0012302061077207327
The modified gen p mean: 0.45030447840690613, gen p mean: -0.10209100693464279, mean p set: 0.45088011026382446
loss_pred:0.016790486872196198, decouple_loss:0.0017184597672894597
The modified gen p mean: 0.4479309618473053, gen p mean: -0.10192370414733887, mean p set: 0.44850653409957886
loss_pred:0.017444366589188576, decouple_loss:0.0010797798167914152
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489286243915558, gen p mean: -0.10442432761192322, mean p set: 0.4495052993297577
loss_pred:0.017712708562612534, decouple_loss:0.0009120461763814092
The modified gen p mean: 0.4488411247730255, gen p mean: -0.11161148548126221, mean p set: 0.44942015409469604
loss_pred:0.01817491464316845, decouple_loss:0.001000048010610044
The modified gen p mean: 0.45026305317878723, gen p mean: -0.1031847670674324, mean p set: 0.4508405923843384
loss_pred:0.0163379218429327, decouple_loss:0.0010430903639644384
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489440619945526, gen p mean: -0.11070207506418228, mean p set: 0.4495220482349396
loss_pred:0.01785999722778797, decouple_loss:0.0010673539945855737
The modified gen p mean: 0.45109060406684875, gen p mean: -0.10951794683933258, mean p set: 0.4516671597957611
The modified gen p mean: 0.4524500370025635, gen p mean: -0.11167311668395996, mean p set: 0.4530285596847534
loss_pred:0.017945848405361176, decouple_loss:0.0008909188327379525
loss_pred:0.017755908891558647, decouple_loss:0.001080345013178885
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492499530315399, gen p mean: -0.11103726923465729, mean p set: 0.4498278796672821
loss_pred:0.017521757632493973, decouple_loss:0.0012248536804690957
The modified gen p mean: 0.448961466550827, gen p mean: -0.10866814851760864, mean p set: 0.4495377540588379
loss_pred:0.017603524029254913, decouple_loss:0.0011079648975282907
The modified gen p mean: 0.4495583176612854, gen p mean: -0.11341828107833862, mean p set: 0.4501332640647888
loss_pred:0.017548246309161186, decouple_loss:0.0012659264029935002
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45376989245414734, gen p mean: -0.11087696999311447, mean p set: 0.4543490707874298
loss_pred:0.01682240143418312, decouple_loss:0.0011769053526222706
The modified gen p mean: 0.4489556849002838, gen p mean: -0.10922589898109436, mean p set: 0.44952961802482605
loss_pred:0.017457718029618263, decouple_loss:0.0010405092034488916
The modified gen p mean: 0.44798991084098816, gen p mean: -0.11000905930995941, mean p set: 0.44856709241867065
loss_pred:0.01813448779284954, decouple_loss:0.0011623087339103222
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838660955429077, gen p mean: -0.10989519208669662, mean p set: 0.4489629566669464
loss_pred:0.017709866166114807, decouple_loss:0.000919751008041203
The modified gen p mean: 0.45153215527534485, gen p mean: -0.10373733192682266, mean p set: 0.45210903882980347
The modified gen p mean: 0.4496075510978699, gen p mean: -0.10672558844089508, mean p set: 0.45018160343170166
loss_pred:0.017519136890769005, decouple_loss:0.0011791496071964502
loss_pred:0.0182169321924448, decouple_loss:0.0011349659180268645
2023-04-30 23:09:10 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1152338981628418, mean p set: 0.4502691626548767
loss_pred:0.017916984856128693, decouple_loss:0.0009783171117305756
The modified gen p mean: 0.4495360255241394, gen p mean: -0.11042017489671707, mean p set: 0.4500633478164673
loss_pred:0.017072178423404694, decouple_loss:0.0011120609706267715
The modified gen p mean: 0.449782133102417, gen p mean: -0.10991114377975464, mean p set: 0.45035696029663086
loss_pred:0.01748746633529663, decouple_loss:0.0011424471158534288
WV_1_PC_1_EH_0_PS_40, loss: 0.017546091228723526, avg_mse: 0.027196088805794716
current test mse: 0.027196
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476691782474518, gen p mean: -0.10892578214406967, mean p set: 0.4482481777667999
loss_pred:0.017842629924416542, decouple_loss:0.0012119970051571727
The modified gen p mean: 0.4490722417831421, gen p mean: -0.10382335633039474, mean p set: 0.44964808225631714
loss_pred:0.018223874270915985, decouple_loss:0.0014111053897067904
The modified gen p mean: 0.45014625787734985, gen p mean: -0.10699836909770966, mean p set: 0.450724720954895
loss_pred:0.016666507348418236, decouple_loss:0.001478897756896913
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953811168670654, gen p mean: -0.11230222135782242, mean p set: 0.4501151144504547
loss_pred:0.017852282151579857, decouple_loss:0.0011280435137450695
The modified gen p mean: 0.44788163900375366, gen p mean: -0.10927793383598328, mean p set: 0.448453426361084The modified gen p mean: 0.4493752717971802, gen p mean: -0.10554622858762741, mean p set: 0.4499515891075134
loss_pred:0.01775815524160862, decouple_loss:0.0009056085837073624loss_pred:0.017279354855418205, decouple_loss:0.0009887622436508536
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520488977432251, gen p mean: -0.10762327909469604, mean p set: 0.45262470841407776
loss_pred:0.016482891514897346, decouple_loss:0.0012001844588667154
The modified gen p mean: 0.45106613636016846, gen p mean: -0.10796567052602768, mean p set: 0.45164522528648376
loss_pred:0.01731785200536251, decouple_loss:0.0009270557202398777
The modified gen p mean: 0.44785717129707336, gen p mean: -0.1053638756275177, mean p set: 0.44843316078186035
loss_pred:0.01768939010798931, decouple_loss:0.001005910336971283
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512651562690735, gen p mean: -0.10709051787853241, mean p set: 0.4518432915210724
loss_pred:0.016889197751879692, decouple_loss:0.0007647083839401603
The modified gen p mean: 0.45268914103507996, gen p mean: -0.10876648128032684, mean p set: 0.4532664716243744
loss_pred:0.01700294390320778, decouple_loss:0.0009685096447356045
The modified gen p mean: 0.4520508348941803, gen p mean: -0.10429845750331879, mean p set: 0.45262858271598816
loss_pred:0.01730864867568016, decouple_loss:0.0014310996048152447
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528050422668457, gen p mean: -0.10153872519731522, mean p set: 0.4533843994140625
loss_pred:0.018029706552624702, decouple_loss:0.0010267944307997823
The modified gen p mean: 0.45267850160598755, gen p mean: -0.10738250613212585, mean p set: 0.45325586199760437
loss_pred:0.017288999632000923, decouple_loss:0.0010854065185412765
The modified gen p mean: 0.45055389404296875, gen p mean: -0.11199458688497543, mean p set: 0.45113280415534973
loss_pred:0.01634126529097557, decouple_loss:0.001318909227848053
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45179563760757446, gen p mean: -0.10589143633842468, mean p set: 0.45237189531326294
loss_pred:0.01743665710091591, decouple_loss:0.0014909622259438038
The modified gen p mean: 0.4517762362957001, gen p mean: -0.10309290140867233, mean p set: 0.4523541033267975
loss_pred:0.01685338467359543, decouple_loss:0.0011603569146245718
The modified gen p mean: 0.4482555389404297, gen p mean: -0.1043333187699318, mean p set: 0.44883227348327637
loss_pred:0.017685022205114365, decouple_loss:0.001065678196027875
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214974880218506, gen p mean: -0.10368199646472931, mean p set: 0.452727735042572
loss_pred:0.016750842332839966, decouple_loss:0.001299126772210002
The modified gen p mean: 0.45002156496047974, gen p mean: -0.1034286767244339, mean p set: 0.45060133934020996
loss_pred:0.016100170090794563, decouple_loss:0.0008783048251643777
The modified gen p mean: 0.4536001980304718, gen p mean: -0.09826146811246872, mean p set: 0.45417720079421997
loss_pred:0.01801847666501999, decouple_loss:0.0009027898195199668
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501798748970032, gen p mean: -0.0970284566283226, mean p set: 0.45075568556785583
loss_pred:0.01665978506207466, decouple_loss:0.0013023489154875278
The modified gen p mean: 0.4513755142688751, gen p mean: -0.09955307096242905, mean p set: 0.45195209980010986
loss_pred:0.017145441845059395, decouple_loss:0.0009239477221854031
The modified gen p mean: 0.45334163308143616, gen p mean: -0.09661442041397095, mean p set: 0.4539194405078888
loss_pred:0.016582395881414413, decouple_loss:0.0011149448109790683
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45099520683288574, gen p mean: -0.10271409898996353, mean p set: 0.45157068967819214
loss_pred:0.016728859394788742, decouple_loss:0.0012134616263210773
The modified gen p mean: 0.4510515630245209, gen p mean: -0.10542111098766327, mean p set: 0.45162856578826904
loss_pred:0.015870358794927597, decouple_loss:0.0012248221319168806
The modified gen p mean: 0.4493618905544281, gen p mean: -0.10044950991868973, mean p set: 0.4499378204345703
loss_pred:0.017234163358807564, decouple_loss:0.0010726386681199074
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45129162073135376, gen p mean: -0.10695762187242508, mean p set: 0.45186808705329895
The modified gen p mean: 0.45359110832214355, gen p mean: -0.10214974731206894, mean p set: 0.4541688859462738
loss_pred:0.015835320577025414, decouple_loss:0.0009935053531080484
loss_pred:0.016594786196947098, decouple_loss:0.0010881368070840836
The modified gen p mean: 0.45018458366394043, gen p mean: -0.10494256019592285, mean p set: 0.4507615268230438
loss_pred:0.017406726256012917, decouple_loss:0.0009320098906755447
2023-04-30 23:11:17 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11899181455373764, mean p set: 0.4502691626548767
loss_pred:0.01772187277674675, decouple_loss:0.0009628682746551931
The modified gen p mean: 0.44953498244285583, gen p mean: -0.11306466907262802, mean p set: 0.4500633478164673
loss_pred:0.017029471695423126, decouple_loss:0.0010251292260363698
The modified gen p mean: 0.4497798681259155, gen p mean: -0.11214529722929001, mean p set: 0.45035696029663086
loss_pred:0.017510835081338882, decouple_loss:0.0010955301113426685
WV_1_PC_1_EH_0_PS_40, loss: 0.017472120001912117, avg_mse: 0.027227750048041344
current test mse: 0.027228
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44631460309028625, gen p mean: -0.11873610317707062, mean p set: 0.4468908905982971
loss_pred:0.015803756192326546, decouple_loss:0.0009018711862154305
The modified gen p mean: 0.44660520553588867, gen p mean: -0.11821994185447693, mean p set: 0.44718244671821594
loss_pred:0.015665613114833832, decouple_loss:0.001196611556224525
The modified gen p mean: 0.44728684425354004, gen p mean: -0.11796338856220245, mean p set: 0.44786328077316284
loss_pred:0.015259609557688236, decouple_loss:0.0010281434515491128
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44748014211654663, gen p mean: -0.12221477180719376, mean p set: 0.448056697845459
loss_pred:0.015585707500576973, decouple_loss:0.0010398922022432089
The modified gen p mean: 0.4454331696033478, gen p mean: -0.11699065566062927, mean p set: 0.4460061490535736The modified gen p mean: 0.4486790597438812, gen p mean: -0.11767304688692093, mean p set: 0.4492546021938324
loss_pred:0.015772392973303795, decouple_loss:0.001091756159439683
loss_pred:0.01588756963610649, decouple_loss:0.0014791174326092005
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44693616032600403, gen p mean: -0.11651550978422165, mean p set: 0.4475100040435791
loss_pred:0.015056478790938854, decouple_loss:0.0008879384258762002
The modified gen p mean: 0.4465169608592987, gen p mean: -0.11450006067752838, mean p set: 0.44709280133247375
loss_pred:0.015482312068343163, decouple_loss:0.0010179001837968826
The modified gen p mean: 0.44907286763191223, gen p mean: -0.116105817258358, mean p set: 0.44964826107025146
loss_pred:0.015638576820492744, decouple_loss:0.0010326839983463287
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471425712108612, gen p mean: -0.11690451949834824, mean p set: 0.44771912693977356
loss_pred:0.015826521441340446, decouple_loss:0.001241698395460844
The modified gen p mean: 0.4473891258239746, gen p mean: -0.11855998635292053, mean p set: 0.447966605424881
loss_pred:0.015248265117406845, decouple_loss:0.0011016572825610638
The modified gen p mean: 0.4471944570541382, gen p mean: -0.12097790837287903, mean p set: 0.44777220487594604
loss_pred:0.015539880841970444, decouple_loss:0.0012119609164074063
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479505717754364, gen p mean: -0.1193038746714592, mean p set: 0.4485260546207428
loss_pred:0.015562396496534348, decouple_loss:0.001196335069835186
The modified gen p mean: 0.44679728150367737, gen p mean: -0.12029464542865753, mean p set: 0.4473719894886017
loss_pred:0.01597985252737999, decouple_loss:0.0011000082595273852
The modified gen p mean: 0.4472832977771759, gen p mean: -0.12372592836618423, mean p set: 0.44785624742507935
loss_pred:0.014974427409470081, decouple_loss:0.0011412003077566624
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687625765800476, gen p mean: -0.12384849786758423, mean p set: 0.44745346903800964
The modified gen p mean: 0.44689226150512695, gen p mean: -0.12767428159713745, mean p set: 0.4474697411060333
loss_pred:0.016259388998150826, decouple_loss:0.0012117736041545868
loss_pred:0.015514632686972618, decouple_loss:0.0009922153549268842
The modified gen p mean: 0.44915416836738586, gen p mean: -0.1274726390838623, mean p set: 0.44973060488700867
loss_pred:0.015741016715765, decouple_loss:0.001451147603802383
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475747048854828, gen p mean: -0.1304255872964859, mean p set: 0.44815176725387573
loss_pred:0.015228860080242157, decouple_loss:0.0011142912553623319
The modified gen p mean: 0.4465562403202057, gen p mean: -0.13004928827285767, mean p set: 0.4471312463283539
loss_pred:0.0150993000715971, decouple_loss:0.0012734108604490757
The modified gen p mean: 0.44704753160476685, gen p mean: -0.13090206682682037, mean p set: 0.44762295484542847
loss_pred:0.015170164406299591, decouple_loss:0.0009247278212569654
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44645318388938904, gen p mean: -0.12999729812145233, mean p set: 0.4470318555831909
loss_pred:0.015149757266044617, decouple_loss:0.0011217946885153651
The modified gen p mean: 0.4465443789958954, gen p mean: -0.13130341470241547, mean p set: 0.4471190571784973
loss_pred:0.014806114137172699, decouple_loss:0.001084947376511991
The modified gen p mean: 0.4468206465244293, gen p mean: -0.13415521383285522, mean p set: 0.44739779829978943
loss_pred:0.015195590443909168, decouple_loss:0.0010800632881000638
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708380103111267, gen p mean: -0.12051787227392197, mean p set: 0.44765836000442505
loss_pred:0.01614578254520893, decouple_loss:0.0011417712084949017
The modified gen p mean: 0.4460514485836029, gen p mean: -0.12654012441635132, mean p set: 0.4466286599636078
loss_pred:0.01518403273075819, decouple_loss:0.001043033553287387
The modified gen p mean: 0.4477694630622864, gen p mean: -0.12547612190246582, mean p set: 0.44834670424461365
loss_pred:0.015580886043608189, decouple_loss:0.0010698506375774741
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698435068130493, gen p mean: -0.12158767133951187, mean p set: 0.4475601017475128
loss_pred:0.015496887266635895, decouple_loss:0.001000134157948196
The modified gen p mean: 0.4478807747364044, gen p mean: -0.12134525924921036, mean p set: 0.44845691323280334
loss_pred:0.015341218560934067, decouple_loss:0.0010129008442163467
The modified gen p mean: 0.44867178797721863, gen p mean: -0.12204594165086746, mean p set: 0.44924843311309814
loss_pred:0.015463943593204021, decouple_loss:0.00114434736315161
2023-04-30 23:14:21 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12409503757953644, mean p set: 0.4502691626548767
loss_pred:0.017770297825336456, decouple_loss:0.0009112003608606756
The modified gen p mean: 0.4495348036289215, gen p mean: -0.11849294602870941, mean p set: 0.4500633478164673
loss_pred:0.01695447787642479, decouple_loss:0.001129674375988543
The modified gen p mean: 0.4497818946838379, gen p mean: -0.11735060811042786, mean p set: 0.45035696029663086
loss_pred:0.017399409785866737, decouple_loss:0.0009675281471572816
WV_1_PC_1_EH_0_PS_40, loss: 0.017424868419766426, avg_mse: 0.02709447592496872
current test mse: 0.027094
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457572400569916, gen p mean: -0.1244467943906784, mean p set: 0.4463326036930084
loss_pred:0.014667083509266376, decouple_loss:0.001255484763532877
The modified gen p mean: 0.44664430618286133, gen p mean: -0.11949869245290756, mean p set: 0.4472208023071289
loss_pred:0.015062096528708935, decouple_loss:0.0011047791922464967
The modified gen p mean: 0.4477234482765198, gen p mean: -0.12325622141361237, mean p set: 0.44829845428466797
loss_pred:0.01462803315371275, decouple_loss:0.0010001104092225432
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463585317134857, gen p mean: -0.1221994087100029, mean p set: 0.44693562388420105
loss_pred:0.014810594730079174, decouple_loss:0.001026615733280778
The modified gen p mean: 0.4462128281593323, gen p mean: -0.1215110719203949, mean p set: 0.44678959250450134The modified gen p mean: 0.4475901424884796, gen p mean: -0.12196185439825058, mean p set: 0.4481663107872009
loss_pred:0.014694327488541603, decouple_loss:0.0010511016007512808
loss_pred:0.015922417864203453, decouple_loss:0.0009577680029906332
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462362229824066, gen p mean: -0.12049959599971771, mean p set: 0.44681257009506226
loss_pred:0.014666846953332424, decouple_loss:0.001252492074854672
The modified gen p mean: 0.4464169442653656, gen p mean: -0.12062769383192062, mean p set: 0.4469926357269287The modified gen p mean: 0.4454323649406433, gen p mean: -0.1211458146572113, mean p set: 0.44600710272789
loss_pred:0.01529666781425476, decouple_loss:0.0009993776911869645
loss_pred:0.01537003181874752, decouple_loss:0.0010815939167514443
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447272390127182, gen p mean: -0.12395963817834854, mean p set: 0.4478478729724884
loss_pred:0.014758186414837837, decouple_loss:0.0009697010973468423
The modified gen p mean: 0.44536563754081726, gen p mean: -0.12249112129211426, mean p set: 0.44594070315361023
loss_pred:0.014746807515621185, decouple_loss:0.0009571441914886236
The modified gen p mean: 0.44776639342308044, gen p mean: -0.12254418432712555, mean p set: 0.44834285974502563
loss_pred:0.015425781719386578, decouple_loss:0.0011041591642424464
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448064923286438, gen p mean: -0.1161537915468216, mean p set: 0.44864004850387573
loss_pred:0.015514904633164406, decouple_loss:0.0010799795854836702
The modified gen p mean: 0.4460397958755493, gen p mean: -0.12191524356603622, mean p set: 0.4466158449649811
loss_pred:0.014836166054010391, decouple_loss:0.0010610881727188826
The modified gen p mean: 0.4469388425350189, gen p mean: -0.1196049153804779, mean p set: 0.447516530752182
loss_pred:0.015522939153015614, decouple_loss:0.0009268138092011213
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467090368270874, gen p mean: -0.12439457327127457, mean p set: 0.4472857117652893
loss_pred:0.014775142073631287, decouple_loss:0.0010368551593273878
The modified gen p mean: 0.44641047716140747, gen p mean: -0.12266407907009125, mean p set: 0.4469849467277527
The modified gen p mean: 0.44700825214385986, gen p mean: -0.12573038041591644, mean p set: 0.4475838840007782
loss_pred:0.014705689623951912, decouple_loss:0.0009688966092653573
loss_pred:0.015034782700240612, decouple_loss:0.0010369520168751478
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683051109313965, gen p mean: -0.12362448126077652, mean p set: 0.44740432500839233
loss_pred:0.014679965563118458, decouple_loss:0.0011211114469915628
The modified gen p mean: 0.4469248354434967, gen p mean: -0.11868298798799515, mean p set: 0.44750016927719116
The modified gen p mean: 0.4481762647628784, gen p mean: -0.11853041499853134, mean p set: 0.44875115156173706
loss_pred:0.016253797337412834, decouple_loss:0.0009476266568526626
loss_pred:0.015460418537259102, decouple_loss:0.0011418807553127408
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447256863117218, gen p mean: -0.11784424632787704, mean p set: 0.44783279299736023
The modified gen p mean: 0.44634735584259033, gen p mean: -0.12036747485399246, mean p set: 0.44692057371139526
loss_pred:0.014999504201114178, decouple_loss:0.0014238508883863688
loss_pred:0.015095965005457401, decouple_loss:0.0009621731005609035
The modified gen p mean: 0.44659075140953064, gen p mean: -0.11823324859142303, mean p set: 0.4471677839756012
loss_pred:0.014750012196600437, decouple_loss:0.0009952060645446181
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758176803588867, gen p mean: -0.12384390830993652, mean p set: 0.4481556713581085
The modified gen p mean: 0.4474376142024994, gen p mean: -0.11691110581159592, mean p set: 0.4480137526988983loss_pred:0.014915366657078266, decouple_loss:0.0010949720162898302
loss_pred:0.015060554258525372, decouple_loss:0.0012981531908735633
The modified gen p mean: 0.44730424880981445, gen p mean: -0.11692129820585251, mean p set: 0.44787725806236267
loss_pred:0.015829656273126602, decouple_loss:0.001292784116230905
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464532434940338, gen p mean: -0.11950460076332092, mean p set: 0.44703078269958496
loss_pred:0.014847245998680592, decouple_loss:0.0010527968406677246
The modified gen p mean: 0.4483495056629181, gen p mean: -0.11627796292304993, mean p set: 0.44892388582229614
The modified gen p mean: 0.44818273186683655, gen p mean: -0.11587399989366531, mean p set: 0.44875821471214294
loss_pred:0.01550669502466917, decouple_loss:0.0011963151628151536
loss_pred:0.015496283769607544, decouple_loss:0.001261587836779654
2023-04-30 23:16:27 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11969228088855743, mean p set: 0.4502691626548767
loss_pred:0.017844857648015022, decouple_loss:0.001080153975635767
The modified gen p mean: 0.4495351016521454, gen p mean: -0.11437453329563141, mean p set: 0.4500633478164673
loss_pred:0.016890594735741615, decouple_loss:0.0012481107842177153
The modified gen p mean: 0.4497823715209961, gen p mean: -0.11355087161064148, mean p set: 0.45035696029663086
loss_pred:0.017452575266361237, decouple_loss:0.001185643719509244
WV_1_PC_1_EH_0_PS_40, loss: 0.01745457574725151, avg_mse: 0.027044465765357018
current test mse: 0.027044
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710132479667664, gen p mean: -0.11745855957269669, mean p set: 0.4476762115955353
loss_pred:0.014636015519499779, decouple_loss:0.0012257981579750776
The modified gen p mean: 0.4469989538192749, gen p mean: -0.11880427598953247, mean p set: 0.4475724399089813
loss_pred:0.015070012770593166, decouple_loss:0.0010581347160041332
The modified gen p mean: 0.4464927911758423, gen p mean: -0.11695842444896698, mean p set: 0.4470658302307129
loss_pred:0.015482017770409584, decouple_loss:0.0010582238901406527
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460058808326721, gen p mean: -0.10807957500219345, mean p set: 0.44658011198043823
loss_pred:0.01571626588702202, decouple_loss:0.0015604418003931642
The modified gen p mean: 0.44788581132888794, gen p mean: -0.1163443848490715, mean p set: 0.44846251606941223
The modified gen p mean: 0.44634678959846497, gen p mean: -0.11324173957109451, mean p set: 0.44692397117614746
loss_pred:0.014642223715782166, decouple_loss:0.0010654800571501255
loss_pred:0.015382117591798306, decouple_loss:0.0012332347687333822
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470089077949524, gen p mean: -0.11559069156646729, mean p set: 0.447585791349411
loss_pred:0.015123173594474792, decouple_loss:0.0008879194501787424
The modified gen p mean: 0.44698262214660645, gen p mean: -0.11897816509008408, mean p set: 0.4475582242012024
loss_pred:0.014623340219259262, decouple_loss:0.0008868459262885153
The modified gen p mean: 0.4460750222206116, gen p mean: -0.10965248197317123, mean p set: 0.4466512203216553
loss_pred:0.01573011837899685, decouple_loss:0.0009135023574344814
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467748701572418, gen p mean: -0.11587768793106079, mean p set: 0.44735097885131836
The modified gen p mean: 0.4467707574367523, gen p mean: -0.1122264713048935, mean p set: 0.4473459720611572
loss_pred:0.014861125499010086, decouple_loss:0.001233177143149078
loss_pred:0.015328527428209782, decouple_loss:0.0016836489085108042
The modified gen p mean: 0.4469212293624878, gen p mean: -0.11484973877668381, mean p set: 0.4474965035915375
loss_pred:0.01481415331363678, decouple_loss:0.0011800675420090556
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749370217323303, gen p mean: -0.1166672557592392, mean p set: 0.44806966185569763
loss_pred:0.014908495359122753, decouple_loss:0.001215707859955728
The modified gen p mean: 0.4487278461456299, gen p mean: -0.12511150538921356, mean p set: 0.44930580258369446
loss_pred:0.014802110381424427, decouple_loss:0.001268285559490323
The modified gen p mean: 0.4470163583755493, gen p mean: -0.11773268133401871, mean p set: 0.447593629360199
loss_pred:0.014944776892662048, decouple_loss:0.0012415105011314154
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477576017379761, gen p mean: -0.12092189490795135, mean p set: 0.44833290576934814
loss_pred:0.015098494477570057, decouple_loss:0.0008965931483544409
The modified gen p mean: 0.4464450180530548, gen p mean: -0.12067922204732895, mean p set: 0.44702303409576416
loss_pred:0.015380515716969967, decouple_loss:0.0008424219558946788
The modified gen p mean: 0.44594091176986694, gen p mean: -0.11774761974811554, mean p set: 0.44651639461517334
loss_pred:0.01529635675251484, decouple_loss:0.0018003639997914433
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676682353019714, gen p mean: -0.12035474926233292, mean p set: 0.4473433792591095
loss_pred:0.015227196738123894, decouple_loss:0.001535298302769661
The modified gen p mean: 0.44681501388549805, gen p mean: -0.12111524492502213, mean p set: 0.44738972187042236
The modified gen p mean: 0.4483255445957184, gen p mean: -0.12817974388599396, mean p set: 0.4489026963710785
loss_pred:0.015097369439899921, decouple_loss:0.0008693034178577363
loss_pred:0.014681280590593815, decouple_loss:0.0009634403977543116
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44604626297950745, gen p mean: -0.11997999995946884, mean p set: 0.4466211497783661
loss_pred:0.014805353246629238, decouple_loss:0.0011494263308122754
The modified gen p mean: 0.44722625613212585, gen p mean: -0.1275823563337326, mean p set: 0.4478035867214203
loss_pred:0.015042334794998169, decouple_loss:0.0012620168272405863
The modified gen p mean: 0.4474164545536041, gen p mean: -0.12028322368860245, mean p set: 0.4479915201663971
loss_pred:0.014703908935189247, decouple_loss:0.001190746552310884
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695669412612915, gen p mean: -0.12078753858804703, mean p set: 0.4475339949131012
loss_pred:0.015446176752448082, decouple_loss:0.0013596564531326294
The modified gen p mean: 0.4472638666629791, gen p mean: -0.12044838070869446, mean p set: 0.4478381872177124
loss_pred:0.014944847673177719, decouple_loss:0.00106377387419343
The modified gen p mean: 0.44615429639816284, gen p mean: -0.11693228036165237, mean p set: 0.44673141837120056
loss_pred:0.015360554680228233, decouple_loss:0.0009006797336041927
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44670370221138, gen p mean: -0.11401592940092087, mean p set: 0.4472809433937073
The modified gen p mean: 0.4468771517276764, gen p mean: -0.1120205670595169, mean p set: 0.4474518895149231
loss_pred:0.015080135315656662, decouple_loss:0.0011515698861330748
loss_pred:0.014907043427228928, decouple_loss:0.0011239162413403392
The modified gen p mean: 0.44698747992515564, gen p mean: -0.11829191446304321, mean p set: 0.4475627839565277
loss_pred:0.013902346603572369, decouple_loss:0.0010424997890368104
2023-04-30 23:19:46 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11160819977521896, mean p set: 0.4502691626548767
loss_pred:0.017769282683730125, decouple_loss:0.0014352620346471667
The modified gen p mean: 0.44953492283821106, gen p mean: -0.1067284420132637, mean p set: 0.4500633478164673
loss_pred:0.01694561541080475, decouple_loss:0.0012529520317912102
The modified gen p mean: 0.4497811198234558, gen p mean: -0.10598660260438919, mean p set: 0.45035696029663086
loss_pred:0.01747581735253334, decouple_loss:0.0013506405521184206
WV_1_PC_1_EH_0_PS_40, loss: 0.01746422052383423, avg_mse: 0.027036966755986214
current test mse: 0.027037
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477280378341675, gen p mean: -0.10856437683105469, mean p set: 0.4483036994934082
loss_pred:0.014382218942046165, decouple_loss:0.0015053118113428354
The modified gen p mean: 0.44708433747291565, gen p mean: -0.11033879965543747, mean p set: 0.4476585388183594The modified gen p mean: 0.44762498140335083, gen p mean: -0.10917975753545761, mean p set: 0.44819772243499756
loss_pred:0.015317216515541077, decouple_loss:0.0011354906018823385loss_pred:0.015421506948769093, decouple_loss:0.0011881331447511911
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479890465736389, gen p mean: -0.10712997615337372, mean p set: 0.44856566190719604
loss_pred:0.014504779130220413, decouple_loss:0.0010564710246399045
The modified gen p mean: 0.4464249312877655, gen p mean: -0.10992199927568436, mean p set: 0.44700121879577637The modified gen p mean: 0.446891188621521, gen p mean: -0.10811885446310043, mean p set: 0.4474670886993408
loss_pred:0.015181563794612885, decouple_loss:0.001087742275558412
loss_pred:0.014573559165000916, decouple_loss:0.0010890839621424675
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475523829460144, gen p mean: -0.10625456273555756, mean p set: 0.4481275677680969
loss_pred:0.014682039618492126, decouple_loss:0.0012846323661506176
The modified gen p mean: 0.44596871733665466, gen p mean: -0.10407689213752747, mean p set: 0.4465442895889282The modified gen p mean: 0.44792434573173523, gen p mean: -0.11414320766925812, mean p set: 0.44850221276283264
loss_pred:0.014791318215429783, decouple_loss:0.0013632215559482574loss_pred:0.014689525589346886, decouple_loss:0.000980289070867002
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466114342212677, gen p mean: -0.1092437356710434, mean p set: 0.4471836984157562
loss_pred:0.015088461339473724, decouple_loss:0.0017463794210925698
The modified gen p mean: 0.4471491873264313, gen p mean: -0.11655766516923904, mean p set: 0.44772762060165405
loss_pred:0.014047573320567608, decouple_loss:0.0013424588833004236
The modified gen p mean: 0.4477149248123169, gen p mean: -0.11069503426551819, mean p set: 0.44829118251800537
loss_pred:0.01452399231493473, decouple_loss:0.001225208048708737
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466665983200073, gen p mean: -0.11804819852113724, mean p set: 0.44724223017692566
loss_pred:0.015113740228116512, decouple_loss:0.0011293443385511637
The modified gen p mean: 0.44644418358802795, gen p mean: -0.11673907935619354, mean p set: 0.44701918959617615
loss_pred:0.015299975872039795, decouple_loss:0.0011263882042840123
The modified gen p mean: 0.4468652606010437, gen p mean: -0.11357962340116501, mean p set: 0.4474417567253113
loss_pred:0.015077759511768818, decouple_loss:0.0010593149345368147
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459279775619507, gen p mean: -0.11695165187120438, mean p set: 0.446504145860672
loss_pred:0.015193269588053226, decouple_loss:0.001320193987339735
The modified gen p mean: 0.44712817668914795, gen p mean: -0.11600961536169052, mean p set: 0.4477064609527588
The modified gen p mean: 0.44620391726493835, gen p mean: -0.11608541756868362, mean p set: 0.4467797577381134
loss_pred:0.014469761401414871, decouple_loss:0.0008400230435654521
loss_pred:0.015420329757034779, decouple_loss:0.0008600604487583041
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679394364356995, gen p mean: -0.11254078894853592, mean p set: 0.447368860244751
loss_pred:0.015084941871464252, decouple_loss:0.001073525520041585
The modified gen p mean: 0.44681936502456665, gen p mean: -0.11743640899658203, mean p set: 0.447394996881485
The modified gen p mean: 0.4466624855995178, gen p mean: -0.11794067919254303, mean p set: 0.44724246859550476
loss_pred:0.01492211502045393, decouple_loss:0.0011895798379555345
loss_pred:0.014557061716914177, decouple_loss:0.0017149150371551514
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466111958026886, gen p mean: -0.11331817507743835, mean p set: 0.44718724489212036
loss_pred:0.015076687559485435, decouple_loss:0.0012036827392876148
The modified gen p mean: 0.4479947090148926, gen p mean: -0.11467617005109787, mean p set: 0.448570191860199
The modified gen p mean: 0.4458884596824646, gen p mean: -0.11252359300851822, mean p set: 0.4464643895626068
loss_pred:0.014703354798257351, decouple_loss:0.0011602842714637518
loss_pred:0.0146709606051445, decouple_loss:0.001184872118756175
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470979571342468, gen p mean: -0.11545176804065704, mean p set: 0.44767507910728455
loss_pred:0.014164435677230358, decouple_loss:0.0009013465605676174
The modified gen p mean: 0.4472542107105255, gen p mean: -0.11008751392364502, mean p set: 0.44783177971839905
loss_pred:0.014998765662312508, decouple_loss:0.00134017295204103
The modified gen p mean: 0.4459467828273773, gen p mean: -0.11161628365516663, mean p set: 0.4465225338935852
loss_pred:0.014720669947564602, decouple_loss:0.000863464258145541
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457584023475647, gen p mean: -0.10905695706605911, mean p set: 0.4463328719139099
loss_pred:0.014541923068463802, decouple_loss:0.0010797398863360286
The modified gen p mean: 0.446859747171402, gen p mean: -0.10705654323101044, mean p set: 0.4474363923072815
loss_pred:0.014867592602968216, decouple_loss:0.0014680161839351058
The modified gen p mean: 0.44724375009536743, gen p mean: -0.11149188876152039, mean p set: 0.44781920313835144
loss_pred:0.015139053575694561, decouple_loss:0.0011999026173725724
2023-04-30 23:21:53 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11193644255399704, mean p set: 0.4502691626548767
loss_pred:0.017687680199742317, decouple_loss:0.0009460294968448579
The modified gen p mean: 0.449537456035614, gen p mean: -0.10685265064239502, mean p set: 0.4500633478164673
loss_pred:0.016897177323698997, decouple_loss:0.0010334112448617816
The modified gen p mean: 0.4497832655906677, gen p mean: -0.10569122433662415, mean p set: 0.45035696029663086
loss_pred:0.01745465211570263, decouple_loss:0.0009019855642691255
WV_1_PC_1_EH_0_PS_40, loss: 0.017394527792930603, avg_mse: 0.027085715904831886
current test mse: 0.027086
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
NaN value num: 0
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472443163394928, gen p mean: -0.11037762463092804, mean p set: 0.4478208124637604
loss_pred:0.019203023985028267, decouple_loss:0.0010631675831973553
The modified gen p mean: 0.445835143327713, gen p mean: -0.11024994403123856, mean p set: 0.44641000032424927
loss_pred:0.01810876466333866, decouple_loss:0.0009483643225394189
The modified gen p mean: 0.4486512541770935, gen p mean: -0.10298247635364532, mean p set: 0.4492294192314148
loss_pred:0.01870139315724373, decouple_loss:0.0009254174074158072
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447671502828598, gen p mean: -0.1073288694024086, mean p set: 0.44824743270874023
loss_pred:0.019271245226264, decouple_loss:0.0010109267896041274
The modified gen p mean: 0.4456973671913147, gen p mean: -0.11001716554164886, mean p set: 0.4462752044200897The modified gen p mean: 0.4469022750854492, gen p mean: -0.10840525478124619, mean p set: 0.4474782347679138
loss_pred:0.01814567856490612, decouple_loss:0.001072336221113801
loss_pred:0.0182096678763628, decouple_loss:0.0010598828084766865
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722408056259155, gen p mean: -0.11049859970808029, mean p set: 0.44780007004737854
The modified gen p mean: 0.4468025267124176, gen p mean: -0.10258538275957108, mean p set: 0.44737857580184937loss_pred:0.018186088651418686, decouple_loss:0.0010490496642887592
loss_pred:0.018424740061163902, decouple_loss:0.0012332797050476074
The modified gen p mean: 0.4461953341960907, gen p mean: -0.10879243165254593, mean p set: 0.4467707574367523
loss_pred:0.017834054306149483, decouple_loss:0.001094808685593307
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460529386997223, gen p mean: -0.11538209021091461, mean p set: 0.44662904739379883
loss_pred:0.017965350300073624, decouple_loss:0.0009584258659742773
The modified gen p mean: 0.44608595967292786, gen p mean: -0.10911981761455536, mean p set: 0.44666171073913574
loss_pred:0.01784658432006836, decouple_loss:0.0008171757799573243
The modified gen p mean: 0.44814109802246094, gen p mean: -0.10535134375095367, mean p set: 0.4487190544605255
loss_pred:0.018098626285791397, decouple_loss:0.0010627334704622626
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474170207977295, gen p mean: -0.11390788108110428, mean p set: 0.44799190759658813
loss_pred:0.017261382192373276, decouple_loss:0.0011286844965070486
The modified gen p mean: 0.4467853009700775, gen p mean: -0.11173877865076065, mean p set: 0.4473620653152466
loss_pred:0.018902529031038284, decouple_loss:0.000901268795132637
The modified gen p mean: 0.44862598180770874, gen p mean: -0.10907340049743652, mean p set: 0.4492022693157196
loss_pred:0.018309378996491432, decouple_loss:0.0010225281585007906
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460597336292267, gen p mean: -0.11717690527439117, mean p set: 0.4466361403465271
loss_pred:0.017652813345193863, decouple_loss:0.0009750755853019655
The modified gen p mean: 0.44616809487342834, gen p mean: -0.1114000752568245, mean p set: 0.446742981672287
loss_pred:0.018015166744589806, decouple_loss:0.0009581226040609181
The modified gen p mean: 0.44881296157836914, gen p mean: -0.10772336274385452, mean p set: 0.449388325214386
loss_pred:0.018265439197421074, decouple_loss:0.0009677266352809966
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771328568458557, gen p mean: -0.10977216809988022, mean p set: 0.44828951358795166
The modified gen p mean: 0.4469146132469177, gen p mean: -0.11263212561607361, mean p set: 0.4474903643131256
loss_pred:0.017691481858491898, decouple_loss:0.0009816588135436177
loss_pred:0.017909487709403038, decouple_loss:0.0008663912885822356
The modified gen p mean: 0.44876644015312195, gen p mean: -0.1165655180811882, mean p set: 0.44934335350990295
loss_pred:0.019164567813277245, decouple_loss:0.000942882033996284
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459100067615509, gen p mean: -0.11309473216533661, mean p set: 0.44648540019989014
loss_pred:0.018731093034148216, decouple_loss:0.001290756044909358
The modified gen p mean: 0.4468469023704529, gen p mean: -0.10869153589010239, mean p set: 0.4474250078201294
loss_pred:0.018393585458397865, decouple_loss:0.0012006649048998952
The modified gen p mean: 0.4476932883262634, gen p mean: -0.11287714540958405, mean p set: 0.44826972484588623
loss_pred:0.017138304188847542, decouple_loss:0.0012031850637868047
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461197853088379, gen p mean: -0.11068572103977203, mean p set: 0.4466968774795532
The modified gen p mean: 0.4464953541755676, gen p mean: -0.11367599666118622, mean p set: 0.44707152247428894
loss_pred:0.01827799528837204, decouple_loss:0.0010953256860375404
loss_pred:0.017690373584628105, decouple_loss:0.0013650436885654926
The modified gen p mean: 0.4482556879520416, gen p mean: -0.1092459186911583, mean p set: 0.44883307814598083
loss_pred:0.018407125025987625, decouple_loss:0.0009582831989973783
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462723731994629, gen p mean: -0.11324337124824524, mean p set: 0.4468485414981842
loss_pred:0.01701473630964756, decouple_loss:0.0010930915595963597
The modified gen p mean: 0.44667115807533264, gen p mean: -0.10794202238321304, mean p set: 0.44724777340888977
The modified gen p mean: 0.44672536849975586, gen p mean: -0.11281002312898636, mean p set: 0.44730156660079956
loss_pred:0.017597593367099762, decouple_loss:0.0010066564427688718
loss_pred:0.018144341185688972, decouple_loss:0.001135125756263733
2023-04-30 23:25:22 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11831499636173248, mean p set: 0.4502691626548767
loss_pred:0.017656441777944565, decouple_loss:0.001248562359251082
The modified gen p mean: 0.4495336711406708, gen p mean: -0.11342957615852356, mean p set: 0.4500633478164673
loss_pred:0.016984237357974052, decouple_loss:0.0013640490360558033
The modified gen p mean: 0.4497801661491394, gen p mean: -0.11275044828653336, mean p set: 0.45035696029663086
loss_pred:0.017407607287168503, decouple_loss:0.0013647193554788828
WV_1_PC_1_EH_0_PS_40, loss: 0.017415717244148254, avg_mse: 0.026974648237228394
current test mse: 0.026975
At step 170, Best test: 0.026975
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819504022598267, gen p mean: -0.10653092712163925, mean p set: 0.44877323508262634
loss_pred:0.017665686085820198, decouple_loss:0.0011634503025561571
The modified gen p mean: 0.4472297430038452, gen p mean: -0.10466163605451584, mean p set: 0.4478082060813904
loss_pred:0.017895227298140526, decouple_loss:0.0014686539070680737
The modified gen p mean: 0.44612884521484375, gen p mean: -0.11000830680131912, mean p set: 0.44670480489730835
loss_pred:0.017457811161875725, decouple_loss:0.0012194948503747582
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460778832435608, gen p mean: -0.1193947046995163, mean p set: 0.4466526508331299
loss_pred:0.0175793319940567, decouple_loss:0.0010136400815099478
The modified gen p mean: 0.4467639625072479, gen p mean: -0.11838628351688385, mean p set: 0.4473387897014618The modified gen p mean: 0.4462559223175049, gen p mean: -0.1153765618801117, mean p set: 0.44682982563972473
loss_pred:0.017651483416557312, decouple_loss:0.0009717352804727852loss_pred:0.018210159614682198, decouple_loss:0.0014965856680646539
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839155673980713, gen p mean: -0.11512554436922073, mean p set: 0.4489694833755493
The modified gen p mean: 0.4466915428638458, gen p mean: -0.11284517496824265, mean p set: 0.44726744294166565
loss_pred:0.018282581120729446, decouple_loss:0.0011282298946753144
loss_pred:0.017552876845002174, decouple_loss:0.0012041181325912476
The modified gen p mean: 0.44792041182518005, gen p mean: -0.1129242479801178, mean p set: 0.4484969973564148
loss_pred:0.019181158393621445, decouple_loss:0.0013524122769013047
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484916925430298, gen p mean: -0.10988181084394455, mean p set: 0.44906821846961975
loss_pred:0.0171833373606205, decouple_loss:0.0011256858706474304
The modified gen p mean: 0.4481849670410156, gen p mean: -0.11146201193332672, mean p set: 0.44876134395599365
loss_pred:0.01849834993481636, decouple_loss:0.0009084533085115254
The modified gen p mean: 0.44659098982810974, gen p mean: -0.10714305192232132, mean p set: 0.4471668004989624
loss_pred:0.018251780420541763, decouple_loss:0.0011430783197283745
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767722487449646, gen p mean: -0.11838160455226898, mean p set: 0.448250949382782
loss_pred:0.01860024221241474, decouple_loss:0.0009954724228009582
The modified gen p mean: 0.4474391043186188, gen p mean: -0.12247614562511444, mean p set: 0.44801223278045654
loss_pred:0.01853070594370365, decouple_loss:0.0009577566524967551
The modified gen p mean: 0.446637362241745, gen p mean: -0.11492685973644257, mean p set: 0.4472139775753021
loss_pred:0.017136942595243454, decouple_loss:0.0009857140248641372
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480879008769989, gen p mean: -0.1155463308095932, mean p set: 0.4486643373966217
loss_pred:0.018718961626291275, decouple_loss:0.0012102153850719333
The modified gen p mean: 0.44767916202545166, gen p mean: -0.1218404620885849, mean p set: 0.4482557475566864
loss_pred:0.01864605024456978, decouple_loss:0.0009744492708705366
The modified gen p mean: 0.4470486342906952, gen p mean: -0.1160603016614914, mean p set: 0.44762495160102844
loss_pred:0.017252648249268532, decouple_loss:0.000996244139969349
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468260109424591, gen p mean: -0.11315378546714783, mean p set: 0.4474022090435028
loss_pred:0.01794675551354885, decouple_loss:0.0012324105482548475
The modified gen p mean: 0.4461877942085266, gen p mean: -0.11990660429000854, mean p set: 0.4467630088329315
loss_pred:0.018068743869662285, decouple_loss:0.0011088034370914102
The modified gen p mean: 0.4482497572898865, gen p mean: -0.12115306407213211, mean p set: 0.44882747530937195
loss_pred:0.01825917325913906, decouple_loss:0.0012324560666456819
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44624993205070496, gen p mean: -0.1227458044886589, mean p set: 0.4468248784542084
loss_pred:0.017690841108560562, decouple_loss:0.001291221589781344
The modified gen p mean: 0.4462696313858032, gen p mean: -0.12125192582607269, mean p set: 0.44684502482414246
loss_pred:0.016664693132042885, decouple_loss:0.0014782778453081846
The modified gen p mean: 0.4469889998435974, gen p mean: -0.12359727174043655, mean p set: 0.44756564497947693
loss_pred:0.016855433583259583, decouple_loss:0.0011244287015870214
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468298554420471, gen p mean: -0.1205330565571785, mean p set: 0.4474048614501953
loss_pred:0.018262993544340134, decouple_loss:0.0012712915195152164
The modified gen p mean: 0.4469928741455078, gen p mean: -0.12051984667778015, mean p set: 0.44756606221199036
loss_pred:0.017206495627760887, decouple_loss:0.0011059179669246078
The modified gen p mean: 0.4474247097969055, gen p mean: -0.1175747662782669, mean p set: 0.448001891374588
loss_pred:0.01915719360113144, decouple_loss:0.0009952837135642767
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459761083126068, gen p mean: -0.1180330365896225, mean p set: 0.446553498506546
loss_pred:0.017810363322496414, decouple_loss:0.0009959331946447492
The modified gen p mean: 0.4475386440753937, gen p mean: -0.12074016779661179, mean p set: 0.44811415672302246
loss_pred:0.018439145758748055, decouple_loss:0.0010081829968839884
The modified gen p mean: 0.4461882412433624, gen p mean: -0.12103033810853958, mean p set: 0.4467627704143524
loss_pred:0.018031934276223183, decouple_loss:0.0010092054726555943
2023-04-30 23:27:34 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12445468455553055, mean p set: 0.4502691626548767
loss_pred:0.017667926847934723, decouple_loss:0.0010119336657226086
The modified gen p mean: 0.44953805208206177, gen p mean: -0.11924994736909866, mean p set: 0.4500633478164673
loss_pred:0.016991576179862022, decouple_loss:0.0008930181502364576
The modified gen p mean: 0.44977903366088867, gen p mean: -0.1176740825176239, mean p set: 0.45035696029663086
loss_pred:0.017371512949466705, decouple_loss:0.0010634728241711855
WV_1_PC_1_EH_0_PS_40, loss: 0.017393147572875023, avg_mse: 0.026970919221639633
current test mse: 0.026971
At step 180, Best test: 0.026971
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
NaN value num: 0
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502544701099396, gen p mean: -0.10671783983707428, mean p set: 0.4508306682109833
loss_pred:0.018544143065810204, decouple_loss:0.0010336593259125948
The modified gen p mean: 0.4519071877002716, gen p mean: -0.11147130280733109, mean p set: 0.45248425006866455
loss_pred:0.018533483147621155, decouple_loss:0.001048811711370945
The modified gen p mean: 0.4522126615047455, gen p mean: -0.10971741378307343, mean p set: 0.45278772711753845
loss_pred:0.019065605476498604, decouple_loss:0.0012700891820713878
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532000422477722, gen p mean: -0.10963592678308487, mean p set: 0.45377665758132935
loss_pred:0.017396898940205574, decouple_loss:0.0011465135030448437
The modified gen p mean: 0.4531644284725189, gen p mean: -0.110774464905262, mean p set: 0.4537392258644104The modified gen p mean: 0.45354628562927246, gen p mean: -0.10850627720355988, mean p set: 0.45412477850914
loss_pred:0.018343433737754822, decouple_loss:0.0011628580978140235
loss_pred:0.017937568947672844, decouple_loss:0.001134522375650704
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534417390823364, gen p mean: -0.10948563367128372, mean p set: 0.4540198743343353
loss_pred:0.017964109778404236, decouple_loss:0.0012856790563091636
The modified gen p mean: 0.45358458161354065, gen p mean: -0.10884346812963486, mean p set: 0.4541594386100769
loss_pred:0.017938783392310143, decouple_loss:0.0011893389746546745
The modified gen p mean: 0.45182183384895325, gen p mean: -0.10642796009778976, mean p set: 0.452399343252182
loss_pred:0.017977096140384674, decouple_loss:0.001286995131522417
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530668556690216, gen p mean: -0.10326429456472397, mean p set: 0.4536438286304474
loss_pred:0.018495457246899605, decouple_loss:0.0011339678894728422
The modified gen p mean: 0.4524891674518585, gen p mean: -0.11017870903015137, mean p set: 0.4530661106109619
loss_pred:0.017399048432707787, decouple_loss:0.0009592003771103919
The modified gen p mean: 0.45385080575942993, gen p mean: -0.10950249433517456, mean p set: 0.454429566860199
loss_pred:0.017627069726586342, decouple_loss:0.001118911663070321
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45441779494285583, gen p mean: -0.10851757973432541, mean p set: 0.4549979567527771
loss_pred:0.018198532983660698, decouple_loss:0.0012526902137324214
The modified gen p mean: 0.4524063467979431, gen p mean: -0.10266412049531937, mean p set: 0.45298275351524353
loss_pred:0.018260572105646133, decouple_loss:0.0015812544152140617
The modified gen p mean: 0.4536009430885315, gen p mean: -0.10456668585538864, mean p set: 0.45417800545692444
loss_pred:0.01790788397192955, decouple_loss:0.0013433789135888219
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45180845260620117, gen p mean: -0.10088122636079788, mean p set: 0.452383428812027
loss_pred:0.017863130196928978, decouple_loss:0.001370846526697278
The modified gen p mean: 0.4525420367717743, gen p mean: -0.10195721685886383, mean p set: 0.453119158744812
The modified gen p mean: 0.4517194628715515, gen p mean: -0.1029771938920021, mean p set: 0.4522961974143982
loss_pred:0.01813100464642048, decouple_loss:0.0012795337243005633
loss_pred:0.01803336665034294, decouple_loss:0.0015118604060262442
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45234331488609314, gen p mean: -0.10503655672073364, mean p set: 0.4529195725917816
loss_pred:0.018024252727627754, decouple_loss:0.0011431833263486624
The modified gen p mean: 0.45151302218437195, gen p mean: -0.10332030057907104, mean p set: 0.45208826661109924
loss_pred:0.01774185337126255, decouple_loss:0.0011146689066663384
The modified gen p mean: 0.4529597759246826, gen p mean: -0.10577399283647537, mean p set: 0.4535352885723114
loss_pred:0.017388686537742615, decouple_loss:0.0011082385899499059
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45280659198760986, gen p mean: -0.09969213604927063, mean p set: 0.4533842206001282
loss_pred:0.0177752748131752, decouple_loss:0.0010926795657724142
The modified gen p mean: 0.4518384039402008, gen p mean: -0.09585174173116684, mean p set: 0.4524155259132385
loss_pred:0.017626145854592323, decouple_loss:0.0012263059616088867
The modified gen p mean: 0.45175254344940186, gen p mean: -0.09340152889490128, mean p set: 0.45232921838760376
loss_pred:0.01745862513780594, decouple_loss:0.0012381883570924401
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45426928997039795, gen p mean: -0.10691653937101364, mean p set: 0.45484670996665955
loss_pred:0.017752259969711304, decouple_loss:0.0012680008076131344
The modified gen p mean: 0.45248687267303467, gen p mean: -0.1049022302031517, mean p set: 0.45306292176246643
loss_pred:0.01848859339952469, decouple_loss:0.0013825464993715286
The modified gen p mean: 0.45182472467422485, gen p mean: -0.10037174075841904, mean p set: 0.4524010717868805
loss_pred:0.018194738775491714, decouple_loss:0.0012934064725413918
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45163458585739136, gen p mean: -0.10122527927160263, mean p set: 0.45221033692359924
loss_pred:0.01779489405453205, decouple_loss:0.0012043197639286518
The modified gen p mean: 0.45264190435409546, gen p mean: -0.10338950157165527, mean p set: 0.4532190263271332
The modified gen p mean: 0.45245233178138733, gen p mean: -0.10352929681539536, mean p set: 0.4530290365219116
loss_pred:0.017314495518803596, decouple_loss:0.0015242982190102339
loss_pred:0.017887914553284645, decouple_loss:0.0010102790547534823
2023-04-30 23:30:52 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11366152763366699, mean p set: 0.4502691626548767
loss_pred:0.018003372475504875, decouple_loss:0.0011009685695171356
The modified gen p mean: 0.44953426718711853, gen p mean: -0.10855869203805923, mean p set: 0.4500633478164673
loss_pred:0.017253058031201363, decouple_loss:0.0011205170303583145
The modified gen p mean: 0.44978103041648865, gen p mean: -0.1068335473537445, mean p set: 0.45035696029663086
loss_pred:0.017551980912685394, decouple_loss:0.0010333294048905373
WV_1_PC_1_EH_0_PS_40, loss: 0.017657052725553513, avg_mse: 0.02736671455204487
current test mse: 0.027367
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510110318660736, gen p mean: -0.09473925828933716, mean p set: 0.45158764719963074
loss_pred:0.017837150022387505, decouple_loss:0.0012170423287898302
The modified gen p mean: 0.4527421295642853, gen p mean: -0.10429272055625916, mean p set: 0.45331934094429016The modified gen p mean: 0.45085248351097107, gen p mean: -0.09744750708341599, mean p set: 0.4514295160770416
loss_pred:0.01685665175318718, decouple_loss:0.001188715104945004
loss_pred:0.017897630110383034, decouple_loss:0.0011731518898159266
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45146551728248596, gen p mean: -0.09337504208087921, mean p set: 0.4520424008369446
loss_pred:0.018394162878394127, decouple_loss:0.0012734689516946673
The modified gen p mean: 0.45168793201446533, gen p mean: -0.09198466688394547, mean p set: 0.4522660970687866The modified gen p mean: 0.4511854946613312, gen p mean: -0.100895956158638, mean p set: 0.45176076889038086
loss_pred:0.018364693969488144, decouple_loss:0.0013922950020059943
loss_pred:0.016962364315986633, decouple_loss:0.0010452429996803403
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522252380847931, gen p mean: -0.09319458156824112, mean p set: 0.45280152559280396
loss_pred:0.01788816973567009, decouple_loss:0.0013095850590616465
The modified gen p mean: 0.45326367020606995, gen p mean: -0.09455010294914246, mean p set: 0.4538425803184509
loss_pred:0.01781904511153698, decouple_loss:0.0010509045096114278
The modified gen p mean: 0.45323944091796875, gen p mean: -0.09665445238351822, mean p set: 0.4538169205188751
loss_pred:0.0168932992964983, decouple_loss:0.0010700165294110775
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45161569118499756, gen p mean: -0.09362845122814178, mean p set: 0.45219212770462036
The modified gen p mean: 0.4529399871826172, gen p mean: -0.09365792572498322, mean p set: 0.45351678133010864loss_pred:0.017549337819218636, decouple_loss:0.0011147104669362307
loss_pred:0.017146676778793335, decouple_loss:0.0011781498324126005
The modified gen p mean: 0.451665461063385, gen p mean: -0.09209335595369339, mean p set: 0.4522446393966675
loss_pred:0.017923813313245773, decouple_loss:0.0011514286743476987
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521614611148834, gen p mean: -0.09709174185991287, mean p set: 0.45273926854133606
loss_pred:0.017396805807948112, decouple_loss:0.000955078168772161
The modified gen p mean: 0.4544863998889923, gen p mean: -0.09425840526819229, mean p set: 0.45506227016448975
loss_pred:0.017685189843177795, decouple_loss:0.0013089316198602319
The modified gen p mean: 0.4514614939689636, gen p mean: -0.092952199280262, mean p set: 0.45203670859336853
loss_pred:0.018323956057429314, decouple_loss:0.0012191483983770013
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522225558757782, gen p mean: -0.0966809093952179, mean p set: 0.4528021812438965
loss_pred:0.017813365906476974, decouple_loss:0.0009793656645342708
The modified gen p mean: 0.4525793492794037, gen p mean: -0.1024973914027214, mean p set: 0.4531553387641907
The modified gen p mean: 0.4546505808830261, gen p mean: -0.10110650211572647, mean p set: 0.45522719621658325
loss_pred:0.018126294016838074, decouple_loss:0.0009887854102998972
loss_pred:0.018541082739830017, decouple_loss:0.0009638809715397656
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45179784297943115, gen p mean: -0.1008802056312561, mean p set: 0.4523732364177704
loss_pred:0.018223335966467857, decouple_loss:0.0013610459864139557
The modified gen p mean: 0.45429620146751404, gen p mean: -0.10315396636724472, mean p set: 0.4548746943473816
The modified gen p mean: 0.45156678557395935, gen p mean: -0.10212208330631256, mean p set: 0.45214447379112244
loss_pred:0.01790914312005043, decouple_loss:0.0011630404042080045
loss_pred:0.017417365685105324, decouple_loss:0.0017269122181460261
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521458148956299, gen p mean: -0.09761758148670197, mean p set: 0.45272231101989746
loss_pred:0.01706276834011078, decouple_loss:0.0013808715157210827
The modified gen p mean: 0.4509885311126709, gen p mean: -0.09946347028017044, mean p set: 0.45156678557395935
loss_pred:0.017976749688386917, decouple_loss:0.0013816053979098797
The modified gen p mean: 0.4526134431362152, gen p mean: -0.09972698986530304, mean p set: 0.4531923532485962
loss_pred:0.018219634890556335, decouple_loss:0.0015642597572878003
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45347321033477783, gen p mean: -0.10072173923254013, mean p set: 0.45405256748199463
loss_pred:0.01805914007127285, decouple_loss:0.0012259628856554627
The modified gen p mean: 0.45304715633392334, gen p mean: -0.09709487110376358, mean p set: 0.45362505316734314
The modified gen p mean: 0.4519384801387787, gen p mean: -0.09574802219867706, mean p set: 0.45251336693763733
loss_pred:0.01761440746486187, decouple_loss:0.001540486584417522
loss_pred:0.018103033304214478, decouple_loss:0.0014066535513848066
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448939710855484, gen p mean: -0.11760639399290085, mean p set: 0.4495137631893158
The modified gen p mean: 0.4476332366466522, gen p mean: -0.11424878984689713, mean p set: 0.448209285736084loss_pred:0.016182512044906616, decouple_loss:0.0024869025219231844
loss_pred:0.016107428818941116, decouple_loss:0.0018073614919558167
The modified gen p mean: 0.4465319514274597, gen p mean: -0.1121644601225853, mean p set: 0.44710773229599
loss_pred:0.016646144911646843, decouple_loss:0.002026960952207446
2023-04-30 23:34:43 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1192801296710968, mean p set: 0.4502691626548767
loss_pred:0.018099000677466393, decouple_loss:0.0014074384234845638
The modified gen p mean: 0.44953474402427673, gen p mean: -0.11430226266384125, mean p set: 0.4500633478164673
loss_pred:0.017258312553167343, decouple_loss:0.0012191925197839737
The modified gen p mean: 0.4497803747653961, gen p mean: -0.11342528462409973, mean p set: 0.45035696029663086
loss_pred:0.01761270873248577, decouple_loss:0.001290972693823278
WV_1_PC_1_EH_0_PS_40, loss: 0.01772196590900421, avg_mse: 0.02751949243247509
current test mse: 0.027519
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468819797039032, gen p mean: -0.11642176657915115, mean p set: 0.4474574029445648
loss_pred:0.016377927735447884, decouple_loss:0.0011528411414474249
The modified gen p mean: 0.44712620973587036, gen p mean: -0.11515896767377853, mean p set: 0.4477007985115051The modified gen p mean: 0.4478626549243927, gen p mean: -0.1166481003165245, mean p set: 0.44844114780426025
loss_pred:0.01634851284325123, decouple_loss:0.0014267000369727612
loss_pred:0.0162972342222929, decouple_loss:0.0013763390015810728
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457109272480011, gen p mean: -0.1158609688282013, mean p set: 0.4462839961051941
loss_pred:0.015825459733605385, decouple_loss:0.0011749246623367071
The modified gen p mean: 0.44488516449928284, gen p mean: -0.12005636096000671, mean p set: 0.4454576373100281The modified gen p mean: 0.4462047517299652, gen p mean: -0.11420267820358276, mean p set: 0.4467789828777313
loss_pred:0.016326311975717545, decouple_loss:0.0013699365081265569
loss_pred:0.016376061365008354, decouple_loss:0.0012795531656593084
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471063017845154, gen p mean: -0.11728110909461975, mean p set: 0.4476804733276367
loss_pred:0.01669539324939251, decouple_loss:0.001713785226456821
The modified gen p mean: 0.4478102922439575, gen p mean: -0.12241148203611374, mean p set: 0.44838783144950867
loss_pred:0.015952253714203835, decouple_loss:0.00171136565040797
The modified gen p mean: 0.4473632574081421, gen p mean: -0.11878291517496109, mean p set: 0.44793781638145447
loss_pred:0.01635102927684784, decouple_loss:0.0016762270824983716
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744932651519775, gen p mean: -0.12477384507656097, mean p set: 0.44802701473236084
loss_pred:0.014632629230618477, decouple_loss:0.0013895287411287427
The modified gen p mean: 0.4460100829601288, gen p mean: -0.12036538124084473, mean p set: 0.4465861916542053
loss_pred:0.015634221956133842, decouple_loss:0.0011730529367923737
The modified gen p mean: 0.44587889313697815, gen p mean: -0.12247765809297562, mean p set: 0.446456640958786
loss_pred:0.01591530255973339, decouple_loss:0.0011248126393184066
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44622641801834106, gen p mean: -0.11834743618965149, mean p set: 0.44680383801460266
loss_pred:0.015623079612851143, decouple_loss:0.0010774543043226004
The modified gen p mean: 0.44671857357025146, gen p mean: -0.1147245392203331, mean p set: 0.44729292392730713
loss_pred:0.01603688858449459, decouple_loss:0.0009271540329791605
The modified gen p mean: 0.4463275969028473, gen p mean: -0.11509506404399872, mean p set: 0.44690370559692383
loss_pred:0.015818851068615913, decouple_loss:0.0010021405760198832
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471789002418518, gen p mean: -0.10810522735118866, mean p set: 0.4477542042732239
loss_pred:0.01624215394258499, decouple_loss:0.001329050282947719
The modified gen p mean: 0.4471183121204376, gen p mean: -0.11928857117891312, mean p set: 0.44769522547721863
The modified gen p mean: 0.4457502067089081, gen p mean: -0.11406653374433517, mean p set: 0.4463306665420532
loss_pred:0.015776565298438072, decouple_loss:0.001533611910417676
loss_pred:0.015773097053170204, decouple_loss:0.0013393588596954942
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682276248931885, gen p mean: -0.11846274882555008, mean p set: 0.44739776849746704
The modified gen p mean: 0.4454056918621063, gen p mean: -0.12475060671567917, mean p set: 0.44598105549812317
loss_pred:0.015462190844118595, decouple_loss:0.000992750865407288
loss_pred:0.015406249091029167, decouple_loss:0.0012276966590434313
The modified gen p mean: 0.44686952233314514, gen p mean: -0.11519282311201096, mean p set: 0.44744551181793213
loss_pred:0.01557201612740755, decouple_loss:0.0010991832241415977
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44639161229133606, gen p mean: -0.1278102695941925, mean p set: 0.44696754217147827
loss_pred:0.014682941138744354, decouple_loss:0.0009019686840474606
The modified gen p mean: 0.44762080907821655, gen p mean: -0.12381833046674728, mean p set: 0.4481981694698334
loss_pred:0.016093412414193153, decouple_loss:0.0009742164984345436
The modified gen p mean: 0.4474334418773651, gen p mean: -0.1149626076221466, mean p set: 0.448009192943573
loss_pred:0.015865307301282883, decouple_loss:0.000993803609162569
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717738032341003, gen p mean: -0.12910103797912598, mean p set: 0.44775307178497314
loss_pred:0.014544527977705002, decouple_loss:0.0009561410406604409
The modified gen p mean: 0.4470369815826416, gen p mean: -0.12311036139726639, mean p set: 0.4476129114627838
loss_pred:0.016426345333456993, decouple_loss:0.0016218435484915972
The modified gen p mean: 0.44650837779045105, gen p mean: -0.12834730744361877, mean p set: 0.44708412885665894
loss_pred:0.015832725912332535, decouple_loss:0.001021999167278409
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465835988521576, gen p mean: -0.12444492429494858, mean p set: 0.44716206192970276
loss_pred:0.01592491939663887, decouple_loss:0.0010413244599476457
The modified gen p mean: 0.44613081216812134, gen p mean: -0.12613548338413239, mean p set: 0.4467063546180725
The modified gen p mean: 0.44804054498672485, gen p mean: -0.12416893988847733, mean p set: 0.44861549139022827
loss_pred:0.015751240774989128, decouple_loss:0.000997001538053155
loss_pred:0.015388790518045425, decouple_loss:0.000983725069090724
2023-04-30 23:36:49 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12725214660167694, mean p set: 0.4502691626548767
loss_pred:0.01795985922217369, decouple_loss:0.0013966275146231055
The modified gen p mean: 0.44953426718711853, gen p mean: -0.12202559411525726, mean p set: 0.4500633478164673
loss_pred:0.01708219200372696, decouple_loss:0.0010403275955468416
The modified gen p mean: 0.44978028535842896, gen p mean: -0.12121645361185074, mean p set: 0.45035696029663086
loss_pred:0.01754007861018181, decouple_loss:0.0009023103630170226
WV_1_PC_1_EH_0_PS_40, loss: 0.017583031207323074, avg_mse: 0.02722201496362686
current test mse: 0.027222
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461710453033447, gen p mean: -0.12326905876398087, mean p set: 0.446748286485672
loss_pred:0.016079874709248543, decouple_loss:0.0009311138419434428
The modified gen p mean: 0.44731366634368896, gen p mean: -0.12014377862215042, mean p set: 0.4478902518749237
The modified gen p mean: 0.44750675559043884, gen p mean: -0.12781086564064026, mean p set: 0.44808200001716614
loss_pred:0.015821252018213272, decouple_loss:0.0010577637003734708
loss_pred:0.014355717226862907, decouple_loss:0.0013676881790161133
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457869231700897, gen p mean: -0.12165433168411255, mean p set: 0.44635844230651855
loss_pred:0.015462775714695454, decouple_loss:0.001712700235657394
The modified gen p mean: 0.44635623693466187, gen p mean: -0.11820527166128159, mean p set: 0.4469318985939026The modified gen p mean: 0.4480046033859253, gen p mean: -0.12422265112400055, mean p set: 0.44858217239379883
loss_pred:0.015772897750139236, decouple_loss:0.0011134122032672167
loss_pred:0.015113584697246552, decouple_loss:0.001254199887625873
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44645291566848755, gen p mean: -0.1180042251944542, mean p set: 0.4470267593860626
loss_pred:0.015474713407456875, decouple_loss:0.0010758134303614497
The modified gen p mean: 0.4454817473888397, gen p mean: -0.11644493788480759, mean p set: 0.4460590183734894
loss_pred:0.015342030674219131, decouple_loss:0.0013015279546380043
The modified gen p mean: 0.44663986563682556, gen p mean: -0.11564429104328156, mean p set: 0.44721704721450806
loss_pred:0.014841294847428799, decouple_loss:0.0011975147062912583
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466039538383484, gen p mean: -0.11790969222784042, mean p set: 0.44717955589294434
loss_pred:0.015177919529378414, decouple_loss:0.001241797232069075
The modified gen p mean: 0.44735783338546753, gen p mean: -0.118007592856884, mean p set: 0.4479331374168396
loss_pred:0.015392079018056393, decouple_loss:0.001252171816304326
The modified gen p mean: 0.44692033529281616, gen p mean: -0.11902569234371185, mean p set: 0.4474954903125763
loss_pred:0.015367405489087105, decouple_loss:0.001008645980618894
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44635048508644104, gen p mean: -0.12323863059282303, mean p set: 0.44692835211753845
loss_pred:0.014901172369718552, decouple_loss:0.0008710516849532723
The modified gen p mean: 0.44778144359588623, gen p mean: -0.11947712302207947, mean p set: 0.4483581483364105
loss_pred:0.014579958282411098, decouple_loss:0.0010043323272839189
The modified gen p mean: 0.44713595509529114, gen p mean: -0.11720801889896393, mean p set: 0.44771286845207214
loss_pred:0.015227158553898335, decouple_loss:0.0009953477419912815
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701287150382996, gen p mean: -0.11881919205188751, mean p set: 0.44758957624435425
loss_pred:0.01544400304555893, decouple_loss:0.0011788426199927926
The modified gen p mean: 0.44850119948387146, gen p mean: -0.12057075649499893, mean p set: 0.44907715916633606
loss_pred:0.014874255284667015, decouple_loss:0.0009210178977809846
The modified gen p mean: 0.44845297932624817, gen p mean: -0.11532050371170044, mean p set: 0.4490286707878113
loss_pred:0.01578456535935402, decouple_loss:0.0009775966173037887
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.444914311170578, gen p mean: -0.12601353228092194, mean p set: 0.44549062848091125
loss_pred:0.015099365264177322, decouple_loss:0.0009491581004112959
The modified gen p mean: 0.44830527901649475, gen p mean: -0.12141209840774536, mean p set: 0.448881059885025
loss_pred:0.015008886344730854, decouple_loss:0.000980134354904294
The modified gen p mean: 0.4481882154941559, gen p mean: -0.12059608846902847, mean p set: 0.44876447319984436
loss_pred:0.014658858999609947, decouple_loss:0.0009672421729192138
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465826749801636, gen p mean: -0.12108587473630905, mean p set: 0.44716131687164307
loss_pred:0.015422922559082508, decouple_loss:0.0010329756187275052
The modified gen p mean: 0.4468446969985962, gen p mean: -0.12075918912887573, mean p set: 0.44741740822792053
loss_pred:0.016218360513448715, decouple_loss:0.0009430884965695441
The modified gen p mean: 0.4477365016937256, gen p mean: -0.11994317173957825, mean p set: 0.44831427931785583
loss_pred:0.015102510340511799, decouple_loss:0.0009283259278163314
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463638961315155, gen p mean: -0.11600750684738159, mean p set: 0.44694095849990845
loss_pred:0.015939928591251373, decouple_loss:0.0009959073504433036
The modified gen p mean: 0.44651347398757935, gen p mean: -0.12420327216386795, mean p set: 0.4470905363559723
The modified gen p mean: 0.4477677643299103, gen p mean: -0.11900515109300613, mean p set: 0.44834378361701965
loss_pred:0.015131145715713501, decouple_loss:0.000932559312786907
loss_pred:0.014683922752737999, decouple_loss:0.0011634442489594221
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
NaN value num: 0
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462183713912964, gen p mean: -0.11689414829015732, mean p set: 0.44679519534111023
loss_pred:0.01760184019804001, decouple_loss:0.0009165851515717804The modified gen p mean: 0.44671884179115295, gen p mean: -0.11607513576745987, mean p set: 0.44729360938072205
loss_pred:0.017921196296811104, decouple_loss:0.0011819086503237486
The modified gen p mean: 0.4466128349304199, gen p mean: -0.11968731880187988, mean p set: 0.4471885859966278
loss_pred:0.017619401216506958, decouple_loss:0.000927999266423285
2023-04-30 23:39:53 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11827030032873154, mean p set: 0.4502691626548767
loss_pred:0.01765209622681141, decouple_loss:0.0009605353698134422
The modified gen p mean: 0.4495333433151245, gen p mean: -0.11278995126485825, mean p set: 0.4500633478164673
loss_pred:0.016877729445695877, decouple_loss:0.0010588013101369143
The modified gen p mean: 0.44978049397468567, gen p mean: -0.11216861009597778, mean p set: 0.45035696029663086
loss_pred:0.01736053079366684, decouple_loss:0.0010844155913218856
WV_1_PC_1_EH_0_PS_40, loss: 0.0173485167324543, avg_mse: 0.02692316100001335
current test mse: 0.026923
At step 220, Best test: 0.026923
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44896453619003296, gen p mean: -0.11535727232694626, mean p set: 0.44954198598861694
loss_pred:0.017889393493533134, decouple_loss:0.001039130729623139
The modified gen p mean: 0.4466942548751831, gen p mean: -0.11391335725784302, mean p set: 0.44727015495300293
loss_pred:0.01765124686062336, decouple_loss:0.0011646101484075189
The modified gen p mean: 0.44626399874687195, gen p mean: -0.11205463856458664, mean p set: 0.4468423128128052
loss_pred:0.01762389950454235, decouple_loss:0.0009368450846523046
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468042552471161, gen p mean: -0.10900454223155975, mean p set: 0.44738173484802246
loss_pred:0.018374187871813774, decouple_loss:0.0010511515429243445
The modified gen p mean: 0.4455145597457886, gen p mean: -0.10914836823940277, mean p set: 0.44608867168426514The modified gen p mean: 0.4457054138183594, gen p mean: -0.11118657886981964, mean p set: 0.44628050923347473
loss_pred:0.017947275191545486, decouple_loss:0.001214426476508379
loss_pred:0.017412349581718445, decouple_loss:0.0008826131816022098
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710108637809753, gen p mean: -0.10738480091094971, mean p set: 0.447676420211792
loss_pred:0.017870452255010605, decouple_loss:0.0009484571637585759
The modified gen p mean: 0.44711947441101074, gen p mean: -0.10914009064435959, mean p set: 0.44769448041915894
loss_pred:0.01703554205596447, decouple_loss:0.0011765973176807165
The modified gen p mean: 0.4456321597099304, gen p mean: -0.10814168304204941, mean p set: 0.44620731472969055
loss_pred:0.018112828955054283, decouple_loss:0.0010484523372724652
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783705472946167, gen p mean: -0.11187805980443954, mean p set: 0.44841188192367554
loss_pred:0.017282992601394653, decouple_loss:0.0009659860515967011
The modified gen p mean: 0.4463716745376587, gen p mean: -0.10998355597257614, mean p set: 0.446946382522583
loss_pred:0.017935920506715775, decouple_loss:0.001087211538106203
The modified gen p mean: 0.44562575221061707, gen p mean: -0.10872931778430939, mean p set: 0.44620129466056824
loss_pred:0.017029160633683205, decouple_loss:0.0009950886014848948
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486747682094574, gen p mean: -0.1158088818192482, mean p set: 0.44925111532211304
loss_pred:0.0172652006149292, decouple_loss:0.001101270318031311
The modified gen p mean: 0.4457622468471527, gen p mean: -0.11692340672016144, mean p set: 0.44634005427360535
loss_pred:0.01759951189160347, decouple_loss:0.0008699457976035774
The modified gen p mean: 0.4487350881099701, gen p mean: -0.1157856434583664, mean p set: 0.4493103623390198
loss_pred:0.017459960654377937, decouple_loss:0.001165179768577218
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44578123092651367, gen p mean: -0.12023721635341644, mean p set: 0.44635435938835144
loss_pred:0.016170384362339973, decouple_loss:0.001053398591466248
The modified gen p mean: 0.4486696124076843, gen p mean: -0.12079248577356339, mean p set: 0.4492454528808594
The modified gen p mean: 0.44621989130973816, gen p mean: -0.1141715943813324, mean p set: 0.44679397344589233
loss_pred:0.0175744891166687, decouple_loss:0.0009997575543820858
loss_pred:0.017932869493961334, decouple_loss:0.0009408951736986637
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477112889289856, gen p mean: -0.1258973926305771, mean p set: 0.4482870399951935
loss_pred:0.017256328836083412, decouple_loss:0.000995598384179175
The modified gen p mean: 0.44742169976234436, gen p mean: -0.12503673136234283, mean p set: 0.4479977488517761
The modified gen p mean: 0.4460681974887848, gen p mean: -0.12187635898590088, mean p set: 0.446643590927124
loss_pred:0.0176300760358572, decouple_loss:0.0010096484329551458
loss_pred:0.017482547089457512, decouple_loss:0.0012102355249226093
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958066940307617, gen p mean: -0.11447778344154358, mean p set: 0.4501565396785736
loss_pred:0.017152655869722366, decouple_loss:0.0013098570052534342
The modified gen p mean: 0.4467813968658447, gen p mean: -0.1170477643609047, mean p set: 0.44735464453697205
loss_pred:0.016685815528035164, decouple_loss:0.0010559047805145383
The modified gen p mean: 0.44698768854141235, gen p mean: -0.11766992509365082, mean p set: 0.4475610554218292
loss_pred:0.017269177362322807, decouple_loss:0.0013633489143103361
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481979012489319, gen p mean: -0.11700505018234253, mean p set: 0.448774129152298
loss_pred:0.01758628338575363, decouple_loss:0.0010437824530526996
The modified gen p mean: 0.44553959369659424, gen p mean: -0.11030913889408112, mean p set: 0.44611674547195435
loss_pred:0.017198413610458374, decouple_loss:0.0009249580907635391
The modified gen p mean: 0.44838660955429077, gen p mean: -0.11456109583377838, mean p set: 0.44896358251571655
loss_pred:0.017249805852770805, decouple_loss:0.0012731276219710708
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464012682437897, gen p mean: -0.11768307536840439, mean p set: 0.44697561860084534
loss_pred:0.017231304198503494, decouple_loss:0.0010342925088480115
The modified gen p mean: 0.445947527885437, gen p mean: -0.11860340088605881, mean p set: 0.44652286171913147
loss_pred:0.01740802265703678, decouple_loss:0.0008886102586984634
The modified gen p mean: 0.44755953550338745, gen p mean: -0.12069263309240341, mean p set: 0.4481349289417267
loss_pred:0.017533643171191216, decouple_loss:0.0009493773686699569
2023-04-30 23:42:05 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1275707185268402, mean p set: 0.4502691626548767
loss_pred:0.017648207023739815, decouple_loss:0.0012749043526127934
The modified gen p mean: 0.4495343267917633, gen p mean: -0.12157747894525528, mean p set: 0.4500633478164673
loss_pred:0.01700802706182003, decouple_loss:0.0013344062026590109
The modified gen p mean: 0.4497784972190857, gen p mean: -0.12102698534727097, mean p set: 0.45035696029663086
loss_pred:0.017383387312293053, decouple_loss:0.0014196101110428572
WV_1_PC_1_EH_0_PS_40, loss: 0.017413688823580742, avg_mse: 0.027031738311052322
current test mse: 0.027032
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44685158133506775, gen p mean: -0.12591466307640076, mean p set: 0.4474274814128876
loss_pred:0.016314323991537094, decouple_loss:0.0013586173299700022
The modified gen p mean: 0.44663164019584656, gen p mean: -0.1274459958076477, mean p set: 0.4472094774246216The modified gen p mean: 0.44779425859451294, gen p mean: -0.12508633732795715, mean p set: 0.4483734667301178
loss_pred:0.016294673085212708, decouple_loss:0.0014385568210855126
loss_pred:0.017451798543334007, decouple_loss:0.0012699081562459469
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460984468460083, gen p mean: -0.12128500640392303, mean p set: 0.446674108505249
loss_pred:0.017038585618138313, decouple_loss:0.0008604041067883372
The modified gen p mean: 0.44584378600120544, gen p mean: -0.12424290925264359, mean p set: 0.4464176893234253The modified gen p mean: 0.44681382179260254, gen p mean: -0.1245288997888565, mean p set: 0.44739121198654175
loss_pred:0.01683536358177662, decouple_loss:0.0008642220054753125
loss_pred:0.01763414591550827, decouple_loss:0.0008821323863230646
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464517831802368, gen p mean: -0.12552355229854584, mean p set: 0.44702741503715515
loss_pred:0.016884762793779373, decouple_loss:0.0008739487384445965
The modified gen p mean: 0.4494413733482361, gen p mean: -0.11930234730243683, mean p set: 0.45001867413520813The modified gen p mean: 0.44724923372268677, gen p mean: -0.1221909373998642, mean p set: 0.4478275179862976
loss_pred:0.016901930794119835, decouple_loss:0.0010648374445736408
loss_pred:0.017485851421952248, decouple_loss:0.0011292375857010484
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462119936943054, gen p mean: -0.12846814095973969, mean p set: 0.44678524136543274
loss_pred:0.016840534284710884, decouple_loss:0.0008529124897904694
The modified gen p mean: 0.44770169258117676, gen p mean: -0.12414529919624329, mean p set: 0.4482783079147339
loss_pred:0.016901712864637375, decouple_loss:0.0009699484216980636
The modified gen p mean: 0.4465070366859436, gen p mean: -0.11768651008605957, mean p set: 0.44708189368247986
loss_pred:0.017306596040725708, decouple_loss:0.0009311694884672761
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462813436985016, gen p mean: -0.11954697966575623, mean p set: 0.4468569755554199
loss_pred:0.01719416305422783, decouple_loss:0.0009599135955795646
The modified gen p mean: 0.44560542702674866, gen p mean: -0.12113326042890549, mean p set: 0.4461832046508789
loss_pred:0.017330845817923546, decouple_loss:0.0008611042285338044
The modified gen p mean: 0.44565948843955994, gen p mean: -0.12262513488531113, mean p set: 0.4462357461452484
loss_pred:0.017432494089007378, decouple_loss:0.0008802442462183535
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471116364002228, gen p mean: -0.11728410422801971, mean p set: 0.4476877748966217
loss_pred:0.01722150854766369, decouple_loss:0.0009543665801174939
The modified gen p mean: 0.44649630784988403, gen p mean: -0.11845965683460236, mean p set: 0.4470725357532501
loss_pred:0.01759994775056839, decouple_loss:0.0009545432985760272
The modified gen p mean: 0.44757547974586487, gen p mean: -0.12737388908863068, mean p set: 0.44815075397491455
loss_pred:0.016951747238636017, decouple_loss:0.0009417743422091007
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471203684806824, gen p mean: -0.1227387934923172, mean p set: 0.4476989805698395
loss_pred:0.01717291586101055, decouple_loss:0.0008603791357018054
The modified gen p mean: 0.4465368986129761, gen p mean: -0.12320878356695175, mean p set: 0.44711199402809143
loss_pred:0.01789851486682892, decouple_loss:0.0009003143641166389
The modified gen p mean: 0.4470219612121582, gen p mean: -0.1245540902018547, mean p set: 0.44760003685951233
loss_pred:0.017269784584641457, decouple_loss:0.0009019443532451987
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461236894130707, gen p mean: -0.11901331692934036, mean p set: 0.4466998875141144
loss_pred:0.01705353334546089, decouple_loss:0.0008989799534901977
The modified gen p mean: 0.4468590021133423, gen p mean: -0.11737030744552612, mean p set: 0.44743549823760986
loss_pred:0.01763293333351612, decouple_loss:0.0008349285926669836
The modified gen p mean: 0.4485192596912384, gen p mean: -0.122104711830616, mean p set: 0.44909629225730896
loss_pred:0.017657242715358734, decouple_loss:0.0011608650675043464
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459878206253052, gen p mean: -0.11546371877193451, mean p set: 0.446562796831131
loss_pred:0.017160842195153236, decouple_loss:0.0008053742931224406
The modified gen p mean: 0.44596871733665466, gen p mean: -0.11404918879270554, mean p set: 0.44654545187950134
loss_pred:0.017481597140431404, decouple_loss:0.0009851540671661496
The modified gen p mean: 0.4468512237071991, gen p mean: -0.11738424003124237, mean p set: 0.44742733240127563
loss_pred:0.017582999542355537, decouple_loss:0.0010615317150950432
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
NaN value num: 0
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048069953918457, gen p mean: -0.10977121442556381, mean p set: 0.4510560631752014
loss_pred:0.017017029225826263, decouple_loss:0.0009079626761376858
The modified gen p mean: 0.4500032067298889, gen p mean: -0.10894041508436203, mean p set: 0.45058155059814453
loss_pred:0.018273601308465004, decouple_loss:0.0009582680650055408
The modified gen p mean: 0.4506981670856476, gen p mean: -0.1126459538936615, mean p set: 0.4512766897678375
loss_pred:0.017170101404190063, decouple_loss:0.0013377011055126786
2023-04-30 23:44:59 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12651745975017548, mean p set: 0.4502691626548767
loss_pred:0.017823997884988785, decouple_loss:0.0010793233523145318
The modified gen p mean: 0.4495360255241394, gen p mean: -0.12089603394269943, mean p set: 0.4500633478164673
loss_pred:0.01706312969326973, decouple_loss:0.0009481684537604451
The modified gen p mean: 0.44977980852127075, gen p mean: -0.12029879540205002, mean p set: 0.45035696029663086
loss_pred:0.017402131110429764, decouple_loss:0.0010292184306308627
WV_1_PC_1_EH_0_PS_40, loss: 0.017480697482824326, avg_mse: 0.027095574885606766
current test mse: 0.027096
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515779912471771, gen p mean: -0.11442940682172775, mean p set: 0.4521554708480835
loss_pred:0.01770642213523388, decouple_loss:0.0010536166373640299
The modified gen p mean: 0.45149683952331543, gen p mean: -0.11496025323867798, mean p set: 0.452073335647583The modified gen p mean: 0.4515857398509979, gen p mean: -0.10924676060676575, mean p set: 0.4521616995334625
loss_pred:0.017171688377857208, decouple_loss:0.0011285297805443406
loss_pred:0.0178880263119936, decouple_loss:0.0012918459251523018
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509793817996979, gen p mean: -0.11421327292919159, mean p set: 0.4515573978424072
loss_pred:0.01706327125430107, decouple_loss:0.001223006402142346
The modified gen p mean: 0.45017531514167786, gen p mean: -0.11594125628471375, mean p set: 0.45075303316116333The modified gen p mean: 0.45075249671936035, gen p mean: -0.1157173290848732, mean p set: 0.4513293206691742
loss_pred:0.0180029459297657, decouple_loss:0.001134058809839189
loss_pred:0.01704804040491581, decouple_loss:0.0011341209756210446
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495881497859955, gen p mean: -0.11969934403896332, mean p set: 0.45016512274742126
loss_pred:0.017779860645532608, decouple_loss:0.001076977699995041
The modified gen p mean: 0.4509454071521759, gen p mean: -0.11335296183824539, mean p set: 0.45152246952056885
loss_pred:0.018077805638313293, decouple_loss:0.0011714716674759984
The modified gen p mean: 0.45051971077919006, gen p mean: -0.11877354979515076, mean p set: 0.4510968327522278
loss_pred:0.016769081354141235, decouple_loss:0.0010940724750980735
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45139703154563904, gen p mean: -0.11493167281150818, mean p set: 0.451976478099823
loss_pred:0.017487073317170143, decouple_loss:0.0011721536284312606
The modified gen p mean: 0.45168137550354004, gen p mean: -0.11872793734073639, mean p set: 0.45225754380226135
loss_pred:0.018133429810404778, decouple_loss:0.001113993232138455
The modified gen p mean: 0.4518081843852997, gen p mean: -0.11612745374441147, mean p set: 0.4523850381374359
loss_pred:0.0182754285633564, decouple_loss:0.001217554439790547
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510071277618408, gen p mean: -0.11814490705728531, mean p set: 0.45158323645591736
loss_pred:0.01832076720893383, decouple_loss:0.0010231371270492673
The modified gen p mean: 0.451625794172287, gen p mean: -0.11818783730268478, mean p set: 0.4522019624710083
loss_pred:0.01731378771364689, decouple_loss:0.0009005416068248451
The modified gen p mean: 0.45098382234573364, gen p mean: -0.11790330708026886, mean p set: 0.4515584707260132
loss_pred:0.01792440004646778, decouple_loss:0.0008992478833533823
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498317837715149, gen p mean: -0.11488133668899536, mean p set: 0.45040586590766907
loss_pred:0.017288504168391228, decouple_loss:0.0012547429651021957
The modified gen p mean: 0.4509292244911194, gen p mean: -0.12099098414182663, mean p set: 0.45150890946388245
loss_pred:0.016226045787334442, decouple_loss:0.0011497604427859187
The modified gen p mean: 0.45232295989990234, gen p mean: -0.11348337680101395, mean p set: 0.452898770570755
loss_pred:0.017351962625980377, decouple_loss:0.001215026481077075
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503066837787628, gen p mean: -0.12446492165327072, mean p set: 0.450882226228714
The modified gen p mean: 0.45071646571159363, gen p mean: -0.11490529030561447, mean p set: 0.45129165053367615
loss_pred:0.016279032453894615, decouple_loss:0.0009387239115312696
loss_pred:0.01729930192232132, decouple_loss:0.0008697138400748372
The modified gen p mean: 0.4513702988624573, gen p mean: -0.11813049763441086, mean p set: 0.4519473612308502
loss_pred:0.017989631742239, decouple_loss:0.001264209276996553
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512985348701477, gen p mean: -0.1194021999835968, mean p set: 0.45187854766845703
loss_pred:0.017543796449899673, decouple_loss:0.001118446234613657
The modified gen p mean: 0.4504372775554657, gen p mean: -0.118576779961586, mean p set: 0.4510124921798706
loss_pred:0.01663222536444664, decouple_loss:0.000930200214497745
The modified gen p mean: 0.4506361782550812, gen p mean: -0.11723507940769196, mean p set: 0.45121413469314575
loss_pred:0.017073215916752815, decouple_loss:0.0009643973899073899
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511740803718567, gen p mean: -0.11875373125076294, mean p set: 0.4517492651939392
loss_pred:0.016282372176647186, decouple_loss:0.0008881542016752064
The modified gen p mean: 0.4508322775363922, gen p mean: -0.11430241167545319, mean p set: 0.4514089822769165
loss_pred:0.017034824937582016, decouple_loss:0.0008033657795749605
The modified gen p mean: 0.45069387555122375, gen p mean: -0.11889316141605377, mean p set: 0.4512709379196167
loss_pred:0.016858408227562904, decouple_loss:0.0008528101607225835
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45125582814216614, gen p mean: -0.11376647651195526, mean p set: 0.4518337547779083
loss_pred:0.0172659233212471, decouple_loss:0.0010545883560553193
The modified gen p mean: 0.45009222626686096, gen p mean: -0.11678662896156311, mean p set: 0.45066869258880615
loss_pred:0.017497630789875984, decouple_loss:0.0010659140534698963
The modified gen p mean: 0.45101532340049744, gen p mean: -0.11554946005344391, mean p set: 0.45159196853637695
loss_pred:0.017836133018136024, decouple_loss:0.0010200272081419826
2023-04-30 23:47:06 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12022793292999268, mean p set: 0.4502691626548767
loss_pred:0.01787649467587471, decouple_loss:0.0009186242241412401
The modified gen p mean: 0.4495391249656677, gen p mean: -0.11455845832824707, mean p set: 0.4500633478164673
loss_pred:0.017249317839741707, decouple_loss:0.0010554209584370255
The modified gen p mean: 0.4497819244861603, gen p mean: -0.1137642189860344, mean p set: 0.45035696029663086
loss_pred:0.017575206235051155, decouple_loss:0.0009289241861552
WV_1_PC_1_EH_0_PS_40, loss: 0.017615389078855515, avg_mse: 0.027179108932614326
current test mse: 0.027179
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509473741054535, gen p mean: -0.10935958474874496, mean p set: 0.4515230059623718
loss_pred:0.016113242134451866, decouple_loss:0.000993741094134748
The modified gen p mean: 0.4508950710296631, gen p mean: -0.10900263488292694, mean p set: 0.45147183537483215The modified gen p mean: 0.45107871294021606, gen p mean: -0.11059755831956863, mean p set: 0.4516545534133911
loss_pred:0.016455600038170815, decouple_loss:0.0008579723653383553
loss_pred:0.017748747020959854, decouple_loss:0.0009950089734047651
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500454366207123, gen p mean: -0.10618070513010025, mean p set: 0.4506221413612366
The modified gen p mean: 0.4528130888938904, gen p mean: -0.10763712972402573, mean p set: 0.4533900320529938
loss_pred:0.016977248713374138, decouple_loss:0.0012916865525767207
loss_pred:0.01737646572291851, decouple_loss:0.0012505889171734452
The modified gen p mean: 0.4508917033672333, gen p mean: -0.11130685359239578, mean p set: 0.45146840810775757
loss_pred:0.017601599916815758, decouple_loss:0.001062922296114266
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013427734375, gen p mean: -0.10370362550020218, mean p set: 0.4507089853286743
loss_pred:0.016686365008354187, decouple_loss:0.000915338983759284
The modified gen p mean: 0.45231926441192627, gen p mean: -0.1059582456946373, mean p set: 0.4528968930244446
loss_pred:0.016568396240472794, decouple_loss:0.001089064055122435
The modified gen p mean: 0.4516962766647339, gen p mean: -0.1118924617767334, mean p set: 0.4522736966609955
loss_pred:0.016807612031698227, decouple_loss:0.0009262386593036354
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506959319114685, gen p mean: -0.10631533712148666, mean p set: 0.4512738585472107
loss_pred:0.01769932545721531, decouple_loss:0.0013131560990586877
The modified gen p mean: 0.4529736042022705, gen p mean: -0.10800886154174805, mean p set: 0.4535543620586395
loss_pred:0.01677008345723152, decouple_loss:0.0010398277081549168
The modified gen p mean: 0.45204681158065796, gen p mean: -0.11248186230659485, mean p set: 0.4526248872280121
loss_pred:0.01706164889037609, decouple_loss:0.0010007460368797183
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45227423310279846, gen p mean: -0.1137961596250534, mean p set: 0.45285114645957947
loss_pred:0.0169658362865448, decouple_loss:0.0010700690327212214
The modified gen p mean: 0.45006346702575684, gen p mean: -0.11468344181776047, mean p set: 0.45063820481300354
loss_pred:0.016449734568595886, decouple_loss:0.0009222182561643422
The modified gen p mean: 0.45053577423095703, gen p mean: -0.11763445287942886, mean p set: 0.45111268758773804
loss_pred:0.015605313703417778, decouple_loss:0.0009022405720315874
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45083194971084595, gen p mean: -0.11374012380838394, mean p set: 0.4514085352420807
loss_pred:0.015937000513076782, decouple_loss:0.0009171757847070694
The modified gen p mean: 0.451782763004303, gen p mean: -0.11309554427862167, mean p set: 0.4523589313030243
loss_pred:0.01622490957379341, decouple_loss:0.0011743250070139766
The modified gen p mean: 0.45143041014671326, gen p mean: -0.11250913888216019, mean p set: 0.45200711488723755
loss_pred:0.01721423678100109, decouple_loss:0.001160119310952723
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511398673057556, gen p mean: -0.10978439450263977, mean p set: 0.4517157971858978
loss_pred:0.017073681578040123, decouple_loss:0.0009901132434606552
The modified gen p mean: 0.45149141550064087, gen p mean: -0.11078661680221558, mean p set: 0.45206722617149353
loss_pred:0.017216315492987633, decouple_loss:0.001093657803721726
The modified gen p mean: 0.4518398344516754, gen p mean: -0.10287779569625854, mean p set: 0.4524179995059967
loss_pred:0.017267433926463127, decouple_loss:0.0012298449873924255
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45035889744758606, gen p mean: -0.10217919200658798, mean p set: 0.4509367048740387
loss_pred:0.016903288662433624, decouple_loss:0.0012681037187576294
The modified gen p mean: 0.4496321976184845, gen p mean: -0.10423903167247772, mean p set: 0.4502072036266327
loss_pred:0.01685585081577301, decouple_loss:0.0009082027827389538
The modified gen p mean: 0.45043450593948364, gen p mean: -0.11186588555574417, mean p set: 0.4510093629360199
loss_pred:0.016442865133285522, decouple_loss:0.00099565414711833
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501063823699951, gen p mean: -0.10184331238269806, mean p set: 0.450682133436203
loss_pred:0.017495540902018547, decouple_loss:0.0008713894640095532
The modified gen p mean: 0.45042145252227783, gen p mean: -0.10150714963674545, mean p set: 0.45099735260009766
loss_pred:0.01597744971513748, decouple_loss:0.0010454208822920918
The modified gen p mean: 0.45103898644447327, gen p mean: -0.10003191232681274, mean p set: 0.4516139328479767
loss_pred:0.017193756997585297, decouple_loss:0.0011051336769014597
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
NaN value num: 0
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001867413520813, gen p mean: -0.11160691827535629, mean p set: 0.4505924582481384
The modified gen p mean: 0.4505765438079834, gen p mean: -0.10439988970756531, mean p set: 0.4511536657810211
loss_pred:0.017947962507605553, decouple_loss:0.001050422084517777
loss_pred:0.017250897362828255, decouple_loss:0.0011838689679279923
The modified gen p mean: 0.4502151608467102, gen p mean: -0.1101645901799202, mean p set: 0.4507925808429718
loss_pred:0.01808851771056652, decouple_loss:0.001107900869101286
2023-04-30 23:50:19 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12183130532503128, mean p set: 0.4502691626548767
loss_pred:0.017810005694627762, decouple_loss:0.0012756150681525469
The modified gen p mean: 0.4495338797569275, gen p mean: -0.11587133258581161, mean p set: 0.4500633478164673
loss_pred:0.0171339213848114, decouple_loss:0.0013947391416877508
The modified gen p mean: 0.44978067278862, gen p mean: -0.11465644836425781, mean p set: 0.45035696029663086
loss_pred:0.017470583319664, decouple_loss:0.0014308353420346975
WV_1_PC_1_EH_0_PS_40, loss: 0.01753985695540905, avg_mse: 0.02717076800763607
current test mse: 0.027171
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499913156032562, gen p mean: -0.11816824972629547, mean p set: 0.4505697786808014
loss_pred:0.01908070594072342, decouple_loss:0.001323950826190412
The modified gen p mean: 0.4502808153629303, gen p mean: -0.11349380761384964, mean p set: 0.450858473777771The modified gen p mean: 0.4504607319831848, gen p mean: -0.10943225026130676, mean p set: 0.4510355293750763
loss_pred:0.018031002953648567, decouple_loss:0.001121528446674347
loss_pred:0.01731022819876671, decouple_loss:0.0010466803796589375
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508178234100342, gen p mean: -0.11227830499410629, mean p set: 0.45139408111572266
loss_pred:0.018384559080004692, decouple_loss:0.0013726609759032726
The modified gen p mean: 0.44900867342948914, gen p mean: -0.11433439701795578, mean p set: 0.4495851993560791The modified gen p mean: 0.45024824142456055, gen p mean: -0.11747521907091141, mean p set: 0.4508259892463684
loss_pred:0.017435744404792786, decouple_loss:0.0010346684139221907
loss_pred:0.017001863569021225, decouple_loss:0.0012635396560654044
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45052558183670044, gen p mean: -0.11397399753332138, mean p set: 0.4511035680770874
loss_pred:0.018136318773031235, decouple_loss:0.001182114821858704
The modified gen p mean: 0.45207783579826355, gen p mean: -0.11533913016319275, mean p set: 0.45265302062034607The modified gen p mean: 0.4500199258327484, gen p mean: -0.11084896326065063, mean p set: 0.4505978226661682
loss_pred:0.016842827200889587, decouple_loss:0.0013746711192652583
loss_pred:0.017418324947357178, decouple_loss:0.0014456098433583975
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511895477771759, gen p mean: -0.1086149588227272, mean p set: 0.45176616311073303
loss_pred:0.01790785975754261, decouple_loss:0.0012293588370084763
The modified gen p mean: 0.45070603489875793, gen p mean: -0.11785482615232468, mean p set: 0.45128458738327026
loss_pred:0.017552033066749573, decouple_loss:0.0011649802327156067
The modified gen p mean: 0.4507201611995697, gen p mean: -0.10608154535293579, mean p set: 0.4512987732887268
loss_pred:0.017405830323696136, decouple_loss:0.0012166030937805772
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45035338401794434, gen p mean: -0.11440302431583405, mean p set: 0.4509296715259552
The modified gen p mean: 0.45150789618492126, gen p mean: -0.1127508208155632, mean p set: 0.45208606123924255
loss_pred:0.019295549020171165, decouple_loss:0.0012363643618300557
loss_pred:0.017450138926506042, decouple_loss:0.0013125751866027713
The modified gen p mean: 0.4506091773509979, gen p mean: -0.11407158523797989, mean p set: 0.4511867165565491
loss_pred:0.01871824823319912, decouple_loss:0.0010984815889969468
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45134085416793823, gen p mean: -0.1141178235411644, mean p set: 0.4519176781177521
loss_pred:0.017373759299516678, decouple_loss:0.001144845737144351
The modified gen p mean: 0.4502563774585724, gen p mean: -0.11445905268192291, mean p set: 0.45083388686180115
loss_pred:0.017184196040034294, decouple_loss:0.0012339879758656025
The modified gen p mean: 0.45172950625419617, gen p mean: -0.11586333066225052, mean p set: 0.4523037374019623
loss_pred:0.017416782677173615, decouple_loss:0.0011264976346865296
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504759609699249, gen p mean: -0.11775124818086624, mean p set: 0.4510516822338104
loss_pred:0.017011858522892, decouple_loss:0.0011669634841382504
The modified gen p mean: 0.45149824023246765, gen p mean: -0.11762288212776184, mean p set: 0.4520775377750397
loss_pred:0.017140794545412064, decouple_loss:0.0009875961113721132
The modified gen p mean: 0.450257271528244, gen p mean: -0.11754536628723145, mean p set: 0.4508335292339325
loss_pred:0.017376476898789406, decouple_loss:0.0008580203866586089
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45127353072166443, gen p mean: -0.11396655440330505, mean p set: 0.4518546462059021
loss_pred:0.01792936585843563, decouple_loss:0.0010968061396852136
The modified gen p mean: 0.4514128267765045, gen p mean: -0.1135229617357254, mean p set: 0.45199018716812134
loss_pred:0.01794935017824173, decouple_loss:0.0010443046921864152
The modified gen p mean: 0.4507712423801422, gen p mean: -0.1139497309923172, mean p set: 0.4513457417488098
loss_pred:0.018072882667183876, decouple_loss:0.001098416862078011
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510393440723419, gen p mean: -0.11304182559251785, mean p set: 0.45161738991737366
loss_pred:0.01707303896546364, decouple_loss:0.0012729301815852523
The modified gen p mean: 0.4516139030456543, gen p mean: -0.10903388261795044, mean p set: 0.45218974351882935
loss_pred:0.018084563314914703, decouple_loss:0.0010380345629528165
The modified gen p mean: 0.4499986171722412, gen p mean: -0.11403914541006088, mean p set: 0.4505743086338043
loss_pred:0.017942722886800766, decouple_loss:0.0013493485748767853
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508229196071625, gen p mean: -0.10678905993700027, mean p set: 0.45139649510383606
loss_pred:0.017761915922164917, decouple_loss:0.0012908227508887649
The modified gen p mean: 0.4504932165145874, gen p mean: -0.10347376018762589, mean p set: 0.4510705769062042
The modified gen p mean: 0.4512742757797241, gen p mean: -0.10802925378084183, mean p set: 0.4518486559391022
loss_pred:0.017253786325454712, decouple_loss:0.000911216891836375
loss_pred:0.017076890915632248, decouple_loss:0.001027902471832931
2023-04-30 23:52:25 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11679650843143463, mean p set: 0.4502691626548767
loss_pred:0.017786219716072083, decouple_loss:0.001306347083300352
The modified gen p mean: 0.4495331645011902, gen p mean: -0.11058889329433441, mean p set: 0.4500633478164673
loss_pred:0.017182236537337303, decouple_loss:0.00102415238507092
The modified gen p mean: 0.4497778117656708, gen p mean: -0.11001333594322205, mean p set: 0.45035696029663086
loss_pred:0.017452560365200043, decouple_loss:0.0010208217427134514
WV_1_PC_1_EH_0_PS_40, loss: 0.017529528588056564, avg_mse: 0.02725411020219326
current test mse: 0.027254
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45095211267471313, gen p mean: -0.10992023348808289, mean p set: 0.45152872800827026
loss_pred:0.01774081587791443, decouple_loss:0.002009872579947114
The modified gen p mean: 0.4511038064956665, gen p mean: -0.10395259410142899, mean p set: 0.4516811966896057The modified gen p mean: 0.45039641857147217, gen p mean: -0.10772188007831573, mean p set: 0.4509739875793457
loss_pred:0.017345963045954704, decouple_loss:0.0011718461755663157
loss_pred:0.017011720687150955, decouple_loss:0.0009057483403012156
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510570168495178, gen p mean: -0.11067166179418564, mean p set: 0.4516315758228302
loss_pred:0.018073564395308495, decouple_loss:0.001787095912732184
The modified gen p mean: 0.4486916959285736, gen p mean: -0.11027048528194427, mean p set: 0.4492678940296173
The modified gen p mean: 0.45020821690559387, gen p mean: -0.11541207134723663, mean p set: 0.4507865309715271
loss_pred:0.01733425259590149, decouple_loss:0.0011880325619131327
loss_pred:0.01682807132601738, decouple_loss:0.001372658764012158
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524213373661041, gen p mean: -0.12145721912384033, mean p set: 0.45300063490867615
loss_pred:0.016607772558927536, decouple_loss:0.000960185716394335
The modified gen p mean: 0.45081979036331177, gen p mean: -0.11862874031066895, mean p set: 0.45139533281326294
loss_pred:0.016711680218577385, decouple_loss:0.0013691670028492808
The modified gen p mean: 0.44970786571502686, gen p mean: -0.12187100201845169, mean p set: 0.450283020734787
loss_pred:0.017077714204788208, decouple_loss:0.0011529738549143076
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45078420639038086, gen p mean: -0.12340237200260162, mean p set: 0.4513612687587738
loss_pred:0.0171893872320652, decouple_loss:0.0013458303874358535
The modified gen p mean: 0.45074862241744995, gen p mean: -0.11765699088573456, mean p set: 0.4513244926929474
loss_pred:0.01833656057715416, decouple_loss:0.0011726972879841924
The modified gen p mean: 0.4520171880722046, gen p mean: -0.12372596561908722, mean p set: 0.45259371399879456
loss_pred:0.01717923954129219, decouple_loss:0.0010636253282427788
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505807161331177, gen p mean: -0.13226822018623352, mean p set: 0.4511551260948181
loss_pred:0.018651509657502174, decouple_loss:0.0012537386501207948
The modified gen p mean: 0.4500018060207367, gen p mean: -0.12735627591609955, mean p set: 0.4505757987499237
loss_pred:0.016663996502757072, decouple_loss:0.0012011835351586342
The modified gen p mean: 0.4487026035785675, gen p mean: -0.128916934132576, mean p set: 0.44927823543548584
loss_pred:0.017556214705109596, decouple_loss:0.000937191303819418
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497930407524109, gen p mean: -0.13052015006542206, mean p set: 0.4503689110279083
loss_pred:0.017331605777144432, decouple_loss:0.0008681925246492028
The modified gen p mean: 0.4507778286933899, gen p mean: -0.12352187186479568, mean p set: 0.45135459303855896
loss_pred:0.01648085191845894, decouple_loss:0.001407512230798602
The modified gen p mean: 0.4509288966655731, gen p mean: -0.12725642323493958, mean p set: 0.45150595903396606
loss_pred:0.017765361815690994, decouple_loss:0.0014476693468168378
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45172515511512756, gen p mean: -0.12219315767288208, mean p set: 0.45229944586753845
loss_pred:0.01756982132792473, decouple_loss:0.0012104184133931994
The modified gen p mean: 0.4500533640384674, gen p mean: -0.1224394142627716, mean p set: 0.45063063502311707
The modified gen p mean: 0.45086511969566345, gen p mean: -0.12121503800153732, mean p set: 0.45144134759902954
loss_pred:0.01753944531083107, decouple_loss:0.0010468624532222748
loss_pred:0.017399398609995842, decouple_loss:0.000987791339866817
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508342444896698, gen p mean: -0.11884266883134842, mean p set: 0.45141053199768066
loss_pred:0.017429597675800323, decouple_loss:0.001334570930339396
The modified gen p mean: 0.449907511472702, gen p mean: -0.11837147176265717, mean p set: 0.45048442482948303
loss_pred:0.017393406480550766, decouple_loss:0.0011881329119205475
The modified gen p mean: 0.45117029547691345, gen p mean: -0.12154987454414368, mean p set: 0.45174556970596313
loss_pred:0.01790192909538746, decouple_loss:0.0009766455041244626
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45020556449890137, gen p mean: -0.12150672823190689, mean p set: 0.45078244805336
The modified gen p mean: 0.44969239830970764, gen p mean: -0.12004809081554413, mean p set: 0.4502687156200409
loss_pred:0.017484284937381744, decouple_loss:0.0011654041009023786
loss_pred:0.017138803377747536, decouple_loss:0.0013144091935828328
The modified gen p mean: 0.45072656869888306, gen p mean: -0.11636440455913544, mean p set: 0.4513053894042969
loss_pred:0.016665995121002197, decouple_loss:0.0012622076319530606
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
NaN value num: 0
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525121748447418, gen p mean: -0.11202681809663773, mean p set: 0.4530870020389557
loss_pred:0.017199939116835594, decouple_loss:0.0012112408876419067
The modified gen p mean: 0.4493301212787628, gen p mean: -0.1055445522069931, mean p set: 0.4499078094959259
The modified gen p mean: 0.45192328095436096, gen p mean: -0.11352655291557312, mean p set: 0.45249855518341064
loss_pred:0.017941463738679886, decouple_loss:0.0008472266490571201
loss_pred:0.017866194248199463, decouple_loss:0.0011610768269747496
2023-04-30 23:55:35 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11779893189668655, mean p set: 0.4502691626548767
loss_pred:0.017826296389102936, decouple_loss:0.0008484695572406054
The modified gen p mean: 0.44953280687332153, gen p mean: -0.1117258071899414, mean p set: 0.4500633478164673
loss_pred:0.017133476212620735, decouple_loss:0.0008702949853613973
The modified gen p mean: 0.44978100061416626, gen p mean: -0.11114273220300674, mean p set: 0.45035696029663086
loss_pred:0.017486408352851868, decouple_loss:0.0009600663324818015
WV_1_PC_1_EH_0_PS_40, loss: 0.01752670854330063, avg_mse: 0.027182726189494133
current test mse: 0.027183
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45175033807754517, gen p mean: -0.10904695093631744, mean p set: 0.4523274898529053
loss_pred:0.01782386191189289, decouple_loss:0.001320431474596262
The modified gen p mean: 0.45209378004074097, gen p mean: -0.10618249326944351, mean p set: 0.4526708424091339
loss_pred:0.017103450372815132, decouple_loss:0.0010100972140207887
The modified gen p mean: 0.4504532217979431, gen p mean: -0.10696285963058472, mean p set: 0.4510296881198883
loss_pred:0.018164096400141716, decouple_loss:0.0011145540047436953
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511500298976898, gen p mean: -0.09596814215183258, mean p set: 0.45172441005706787
loss_pred:0.017499107867479324, decouple_loss:0.0011201072484254837
The modified gen p mean: 0.4514445662498474, gen p mean: -0.10229779034852982, mean p set: 0.4520227611064911The modified gen p mean: 0.4512672424316406, gen p mean: -0.10108189284801483, mean p set: 0.4518454968929291
loss_pred:0.017862483859062195, decouple_loss:0.0018183139618486166
loss_pred:0.017402786761522293, decouple_loss:0.0008918703533709049
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214229822158813, gen p mean: -0.09571889042854309, mean p set: 0.4527184069156647
loss_pred:0.01719115860760212, decouple_loss:0.001139865256845951
The modified gen p mean: 0.45195117592811584, gen p mean: -0.1064641997218132, mean p set: 0.4525282084941864The modified gen p mean: 0.4522113502025604, gen p mean: -0.0935724526643753, mean p set: 0.4527874290943146
loss_pred:0.017303766682744026, decouple_loss:0.001311369938775897
loss_pred:0.01782410591840744, decouple_loss:0.0010603014379739761
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45185431838035583, gen p mean: -0.09779383987188339, mean p set: 0.45243212580680847
loss_pred:0.017172591760754585, decouple_loss:0.0010757597628980875
The modified gen p mean: 0.4520471394062042, gen p mean: -0.10012517869472504, mean p set: 0.4526216387748718
loss_pred:0.017050938680768013, decouple_loss:0.0014609145000576973
The modified gen p mean: 0.45100924372673035, gen p mean: -0.10346640646457672, mean p set: 0.4515860676765442
loss_pred:0.01721270941197872, decouple_loss:0.0012732374016195536
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953015446662903, gen p mean: -0.10185890644788742, mean p set: 0.4501059055328369
loss_pred:0.017420262098312378, decouple_loss:0.0010170661844313145
The modified gen p mean: 0.45205157995224, gen p mean: -0.10185205936431885, mean p set: 0.452627569437027
loss_pred:0.01816696673631668, decouple_loss:0.0016625963617116213
The modified gen p mean: 0.4509982168674469, gen p mean: -0.1048588901758194, mean p set: 0.45157474279403687
loss_pred:0.01711561717092991, decouple_loss:0.001429676660336554
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504478871822357, gen p mean: -0.11131049692630768, mean p set: 0.4510248601436615
loss_pred:0.01734563149511814, decouple_loss:0.0014455605996772647
The modified gen p mean: 0.44963550567626953, gen p mean: -0.11230652034282684, mean p set: 0.45021140575408936
loss_pred:0.017896974459290504, decouple_loss:0.001641649752855301
The modified gen p mean: 0.4514140486717224, gen p mean: -0.11156009882688522, mean p set: 0.4519905745983124
loss_pred:0.016971219331026077, decouple_loss:0.0013937941985204816
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45129597187042236, gen p mean: -0.11509343981742859, mean p set: 0.4518716335296631
loss_pred:0.01669415831565857, decouple_loss:0.001098737120628357
The modified gen p mean: 0.4514799416065216, gen p mean: -0.12041968107223511, mean p set: 0.45205479860305786
loss_pred:0.016535542905330658, decouple_loss:0.001284462516196072
The modified gen p mean: 0.45147016644477844, gen p mean: -0.11640090495347977, mean p set: 0.45204487442970276
loss_pred:0.016435781493782997, decouple_loss:0.0016204738058149815
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500395655632019, gen p mean: -0.11861342191696167, mean p set: 0.45061367750167847
loss_pred:0.017512401565909386, decouple_loss:0.0012051108060404658
The modified gen p mean: 0.45115259289741516, gen p mean: -0.12164277583360672, mean p set: 0.451729416847229
loss_pred:0.017108263447880745, decouple_loss:0.0011486649746075273
The modified gen p mean: 0.4514831006526947, gen p mean: -0.12077650427818298, mean p set: 0.4520612061023712
loss_pred:0.01759996823966503, decouple_loss:0.0008643831824883819
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520510733127594, gen p mean: -0.12501002848148346, mean p set: 0.45262742042541504
loss_pred:0.016897480934858322, decouple_loss:0.0012264690594747663
The modified gen p mean: 0.45109716057777405, gen p mean: -0.12694743275642395, mean p set: 0.4516755938529968
loss_pred:0.017038531601428986, decouple_loss:0.0017411577282473445
The modified gen p mean: 0.45151063799858093, gen p mean: -0.12602730095386505, mean p set: 0.45208823680877686
loss_pred:0.01694231666624546, decouple_loss:0.0010520799551159143
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526073932647705, gen p mean: -0.12746299803256989, mean p set: 0.4531855285167694
loss_pred:0.017524266615509987, decouple_loss:0.0010890921112149954
The modified gen p mean: 0.4520586431026459, gen p mean: -0.12599307298660278, mean p set: 0.4526340067386627
loss_pred:0.01725788600742817, decouple_loss:0.0014829905703663826
The modified gen p mean: 0.4510675370693207, gen p mean: -0.1283588856458664, mean p set: 0.45164716243743896
loss_pred:0.01742430031299591, decouple_loss:0.0011824654648080468
2023-04-30 23:57:40 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1357739120721817, mean p set: 0.4502691626548767
loss_pred:0.017815001308918, decouple_loss:0.0012502457248046994
The modified gen p mean: 0.44953370094299316, gen p mean: -0.12964345514774323, mean p set: 0.4500633478164673
loss_pred:0.017177660018205643, decouple_loss:0.0011568429181352258
The modified gen p mean: 0.44977861642837524, gen p mean: -0.12874265015125275, mean p set: 0.45035696029663086
loss_pred:0.017602339386940002, decouple_loss:0.0010180657263845205
WV_1_PC_1_EH_0_PS_40, loss: 0.017588753253221512, avg_mse: 0.027282528579235077
current test mse: 0.027283
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990941882133484, gen p mean: -0.12693797051906586, mean p set: 0.4504854083061218
loss_pred:0.018638698384165764, decouple_loss:0.0010985484113916755
The modified gen p mean: 0.4514232873916626, gen p mean: -0.11921090632677078, mean p set: 0.45199981331825256The modified gen p mean: 0.45203492045402527, gen p mean: -0.11976899951696396, mean p set: 0.45261338353157043
loss_pred:0.016387062147259712, decouple_loss:0.0012411228381097317
loss_pred:0.01722552254796028, decouple_loss:0.0010789503576233983
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519309997558594, gen p mean: -0.11795583367347717, mean p set: 0.4525078237056732
loss_pred:0.01737593486905098, decouple_loss:0.0013017721939831972
The modified gen p mean: 0.45193830132484436, gen p mean: -0.11097410321235657, mean p set: 0.4525144100189209The modified gen p mean: 0.4515421688556671, gen p mean: -0.11131536215543747, mean p set: 0.45211732387542725
loss_pred:0.01740461029112339, decouple_loss:0.0018796444637700915
loss_pred:0.017214305698871613, decouple_loss:0.001013510162010789
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128417015075684, gen p mean: -0.10423120856285095, mean p set: 0.45186206698417664
loss_pred:0.01739002950489521, decouple_loss:0.0008734450093470514
The modified gen p mean: 0.4510025978088379, gen p mean: -0.10340607166290283, mean p set: 0.4515799880027771The modified gen p mean: 0.451501727104187, gen p mean: -0.10434454679489136, mean p set: 0.45208021998405457
loss_pred:0.017441462725400925, decouple_loss:0.0011187364580109715
loss_pred:0.016224157065153122, decouple_loss:0.0011921410914510489
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499604105949402, gen p mean: -0.09722422063350677, mean p set: 0.45053553581237793
loss_pred:0.017595795914530754, decouple_loss:0.0010784132173284888
The modified gen p mean: 0.4520045518875122, gen p mean: -0.09683268517255783, mean p set: 0.452579140663147
loss_pred:0.017471568658947945, decouple_loss:0.0011604813626036048
The modified gen p mean: 0.4514169692993164, gen p mean: -0.0989365205168724, mean p set: 0.4519910514354706
loss_pred:0.01743345707654953, decouple_loss:0.0011732022976502776
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45151957869529724, gen p mean: -0.0953139215707779, mean p set: 0.45209604501724243
loss_pred:0.017170749604701996, decouple_loss:0.0010543428361415863
The modified gen p mean: 0.4504573941230774, gen p mean: -0.09749164432287216, mean p set: 0.4510330855846405
loss_pred:0.01737147755920887, decouple_loss:0.0010447298409417272
The modified gen p mean: 0.45190998911857605, gen p mean: -0.09916853904724121, mean p set: 0.4524872899055481
loss_pred:0.016781019046902657, decouple_loss:0.0010000370675697923
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512863755226135, gen p mean: -0.0986059159040451, mean p set: 0.4518626928329468
loss_pred:0.017070379108190536, decouple_loss:0.001183676766231656
The modified gen p mean: 0.4507705569267273, gen p mean: -0.10486146807670593, mean p set: 0.45134681463241577
loss_pred:0.017069755122065544, decouple_loss:0.0015194773441180587
The modified gen p mean: 0.4529074728488922, gen p mean: -0.1001107320189476, mean p set: 0.4534855782985687
loss_pred:0.01657228171825409, decouple_loss:0.0012445731554180384
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45175105333328247, gen p mean: -0.1050325408577919, mean p set: 0.4523273706436157
loss_pred:0.017168663442134857, decouple_loss:0.001269453321583569
The modified gen p mean: 0.4518668055534363, gen p mean: -0.11323187500238419, mean p set: 0.45244550704956055
loss_pred:0.017075570300221443, decouple_loss:0.0011460289824754
The modified gen p mean: 0.4514705240726471, gen p mean: -0.10502734780311584, mean p set: 0.4520479440689087
loss_pred:0.01680051162838936, decouple_loss:0.001361478352919221
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516242444515228, gen p mean: -0.11242550611495972, mean p set: 0.45219916105270386
loss_pred:0.01754896715283394, decouple_loss:0.0010613981867209077
The modified gen p mean: 0.4515799283981323, gen p mean: -0.1084829643368721, mean p set: 0.4521573483943939
loss_pred:0.0171844270080328, decouple_loss:0.0010197027586400509
The modified gen p mean: 0.45126861333847046, gen p mean: -0.11307024955749512, mean p set: 0.45184382796287537
loss_pred:0.016592325642704964, decouple_loss:0.0011189517099410295
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738978147506714, gen p mean: -0.12722477316856384, mean p set: 0.4479677379131317
loss_pred:0.01512719877064228, decouple_loss:0.001075820648111403
The modified gen p mean: 0.4486701488494873, gen p mean: -0.1262698620557785, mean p set: 0.44924888014793396
The modified gen p mean: 0.4472503960132599, gen p mean: -0.11760444194078445, mean p set: 0.44782590866088867
loss_pred:0.01532577071338892, decouple_loss:0.0009760323446244001
loss_pred:0.015681004151701927, decouple_loss:0.001181307714432478
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478400945663452, gen p mean: -0.11932332813739777, mean p set: 0.44841745495796204
loss_pred:0.01484239287674427, decouple_loss:0.001236381591297686
The modified gen p mean: 0.4475630819797516, gen p mean: -0.12489750981330872, mean p set: 0.4481384754180908
The modified gen p mean: 0.44813910126686096, gen p mean: -0.13135577738285065, mean p set: 0.4487130343914032
loss_pred:0.014595369808375835, decouple_loss:0.0013286223402246833
loss_pred:0.01533929817378521, decouple_loss:0.001029846491292119
2023-05-01 00:00:58 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.13247354328632355, mean p set: 0.4502691626548767
loss_pred:0.017842411994934082, decouple_loss:0.0014143732842057943
The modified gen p mean: 0.4495370090007782, gen p mean: -0.12676884233951569, mean p set: 0.4500633478164673
loss_pred:0.017245257273316383, decouple_loss:0.001107935095205903
The modified gen p mean: 0.44978228211402893, gen p mean: -0.12542735040187836, mean p set: 0.45035696029663086
loss_pred:0.017597176134586334, decouple_loss:0.0009779698448255658
WV_1_PC_1_EH_0_PS_40, loss: 0.01761995442211628, avg_mse: 0.0274719949811697
current test mse: 0.027472
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486221969127655, gen p mean: -0.13354529440402985, mean p set: 0.4491964280605316
loss_pred:0.015119222924113274, decouple_loss:0.0009310627356171608
The modified gen p mean: 0.44716769456863403, gen p mean: -0.1297861635684967, mean p set: 0.4477404057979584The modified gen p mean: 0.44818124175071716, gen p mean: -0.13174109160900116, mean p set: 0.4487580358982086
loss_pred:0.01579992286860943, decouple_loss:0.0012262121308594942
loss_pred:0.01437936257570982, decouple_loss:0.0009288795408792794
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480590224266052, gen p mean: -0.13656283915042877, mean p set: 0.44863414764404297
loss_pred:0.014875226654112339, decouple_loss:0.0012625110102817416
The modified gen p mean: 0.44677650928497314, gen p mean: -0.13628779351711273, mean p set: 0.4473493695259094The modified gen p mean: 0.44910380244255066, gen p mean: -0.13428381085395813, mean p set: 0.4496791362762451
loss_pred:0.015530641190707684, decouple_loss:0.0013400891330093145
loss_pred:0.015376188792288303, decouple_loss:0.0011411324376240373
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472752511501312, gen p mean: -0.12242598831653595, mean p set: 0.44784975051879883
loss_pred:0.014591893181204796, decouple_loss:0.00114337052218616
The modified gen p mean: 0.44731268286705017, gen p mean: -0.12510716915130615, mean p set: 0.4478890001773834The modified gen p mean: 0.4472168982028961, gen p mean: -0.13127805292606354, mean p set: 0.4477921724319458
loss_pred:0.015093494206666946, decouple_loss:0.0009676878689788282
loss_pred:0.01527276448905468, decouple_loss:0.0009662578231655061
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490053057670593, gen p mean: -0.11631176620721817, mean p set: 0.4495809078216553
loss_pred:0.015000557526946068, decouple_loss:0.000992782530374825
The modified gen p mean: 0.4478493332862854, gen p mean: -0.11857857555150986, mean p set: 0.44842419028282166
loss_pred:0.014985550194978714, decouple_loss:0.000985509599559009
The modified gen p mean: 0.4487546980381012, gen p mean: -0.11875778436660767, mean p set: 0.4493320882320404
loss_pred:0.015035255812108517, decouple_loss:0.0011509159812703729
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44651657342910767, gen p mean: -0.11724047362804413, mean p set: 0.44709157943725586
loss_pred:0.01509841438382864, decouple_loss:0.0012802144046872854
The modified gen p mean: 0.44592225551605225, gen p mean: -0.11237317323684692, mean p set: 0.4464992880821228
loss_pred:0.015335001982748508, decouple_loss:0.0011096243979409337
The modified gen p mean: 0.45009446144104004, gen p mean: -0.1086859256029129, mean p set: 0.4506722390651703
loss_pred:0.01473916694521904, decouple_loss:0.0009319697855971754
Iteration: 306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488013982772827, gen p mean: -0.11151036620140076, mean p set: 0.4493766129016876
loss_pred:0.014837274327874184, decouple_loss:0.001026208745315671
The modified gen p mean: 0.44820961356163025, gen p mean: -0.11654943972826004, mean p set: 0.44878509640693665
The modified gen p mean: 0.4489296078681946, gen p mean: -0.11161379516124725, mean p set: 0.44950512051582336
loss_pred:0.015124146826565266, decouple_loss:0.0010968390852212906
loss_pred:0.014634935185313225, decouple_loss:0.0010368298972025514
Iteration: 307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481443166732788, gen p mean: -0.11605650931596756, mean p set: 0.4487197697162628
loss_pred:0.014974020421504974, decouple_loss:0.0010061445645987988
The modified gen p mean: 0.44878053665161133, gen p mean: -0.1183852106332779, mean p set: 0.4493577182292938
loss_pred:0.014139212667942047, decouple_loss:0.0009332455811090767
The modified gen p mean: 0.44913408160209656, gen p mean: -0.11776886880397797, mean p set: 0.4497106075286865
loss_pred:0.014869553036987782, decouple_loss:0.0010698833502829075
Iteration: 308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491216540336609, gen p mean: -0.11177808046340942, mean p set: 0.44969815015792847
loss_pred:0.01495044119656086, decouple_loss:0.001174191478639841
The modified gen p mean: 0.4479345381259918, gen p mean: -0.11598286032676697, mean p set: 0.4485096037387848
loss_pred:0.014897020533680916, decouple_loss:0.0011549839982762933
The modified gen p mean: 0.4472880959510803, gen p mean: -0.1182820275425911, mean p set: 0.44786572456359863
loss_pred:0.01454903930425644, decouple_loss:0.0013122805394232273
Iteration: 309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499388635158539, gen p mean: -0.11428508907556534, mean p set: 0.4505167305469513
loss_pred:0.015039498917758465, decouple_loss:0.0011588714551180601
The modified gen p mean: 0.4492347836494446, gen p mean: -0.11291578412055969, mean p set: 0.4498105049133301
loss_pred:0.015155221335589886, decouple_loss:0.0010393686825409532
The modified gen p mean: 0.44709840416908264, gen p mean: -0.11784642189741135, mean p set: 0.4476757347583771
loss_pred:0.014892971143126488, decouple_loss:0.0008882666006684303
Iteration: 310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683486223220825, gen p mean: -0.11907937377691269, mean p set: 0.44741132855415344
loss_pred:0.015359190292656422, decouple_loss:0.0012423783773556352
The modified gen p mean: 0.44773435592651367, gen p mean: -0.11282092332839966, mean p set: 0.4483111500740051
The modified gen p mean: 0.44683387875556946, gen p mean: -0.12266978621482849, mean p set: 0.44741183519363403
loss_pred:0.015034305863082409, decouple_loss:0.0015986510552465916
loss_pred:0.014790001325309277, decouple_loss:0.0012870567152276635
2023-05-01 00:03:05 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12449108064174652, mean p set: 0.4502691626548767
loss_pred:0.017812175676226616, decouple_loss:0.00130692298989743
The modified gen p mean: 0.4495374262332916, gen p mean: -0.11879834532737732, mean p set: 0.4500633478164673
loss_pred:0.0171164833009243, decouple_loss:0.001013160333968699
The modified gen p mean: 0.44978198409080505, gen p mean: -0.11792468279600143, mean p set: 0.45035696029663086
loss_pred:0.017482751980423927, decouple_loss:0.0010397646110504866
WV_1_PC_1_EH_0_PS_40, loss: 0.017526468262076378, avg_mse: 0.027169445529580116
current test mse: 0.027169
Iteration: 311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822022318840027, gen p mean: -0.1221330463886261, mean p set: 0.44880014657974243
loss_pred:0.01411352027207613, decouple_loss:0.001111234538257122
The modified gen p mean: 0.4469168782234192, gen p mean: -0.1179143413901329, mean p set: 0.44749414920806885The modified gen p mean: 0.4474163353443146, gen p mean: -0.12106911092996597, mean p set: 0.44798991084098816
loss_pred:0.01501650270074606, decouple_loss:0.0010974968317896128loss_pred:0.014140437357127666, decouple_loss:0.0008257291046902537
Iteration: 312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471856653690338, gen p mean: -0.11807919293642044, mean p set: 0.447760671377182
loss_pred:0.014671926386654377, decouple_loss:0.0012396840611472726
The modified gen p mean: 0.4480898082256317, gen p mean: -0.12050241976976395, mean p set: 0.44866541028022766
The modified gen p mean: 0.44695356488227844, gen p mean: -0.12135805934667587, mean p set: 0.44752633571624756
loss_pred:0.014911633916199207, decouple_loss:0.0010910991113632917
loss_pred:0.013927999883890152, decouple_loss:0.0009537649457342923
Iteration: 313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44630926847457886, gen p mean: -0.1207430362701416, mean p set: 0.4468816816806793
loss_pred:0.015179880894720554, decouple_loss:0.0009797475067898631
The modified gen p mean: 0.44873306155204773, gen p mean: -0.12568120658397675, mean p set: 0.4493098258972168The modified gen p mean: 0.44706806540489197, gen p mean: -0.12450084835290909, mean p set: 0.4476434886455536
loss_pred:0.014165972359478474, decouple_loss:0.0009844137821346521
loss_pred:0.01458952110260725, decouple_loss:0.0008273569983430207
Iteration: 314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919487833976746, gen p mean: -0.12278516590595245, mean p set: 0.44976967573165894
loss_pred:0.014216355048120022, decouple_loss:0.001053385902196169
The modified gen p mean: 0.4485023617744446, gen p mean: -0.1259349286556244, mean p set: 0.449078768491745
loss_pred:0.014335375279188156, decouple_loss:0.0010068980045616627
The modified gen p mean: 0.44756561517715454, gen p mean: -0.12760722637176514, mean p set: 0.4481406807899475
loss_pred:0.014503410086035728, decouple_loss:0.0010382912587374449
Iteration: 315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492775797843933, gen p mean: -0.12396103143692017, mean p set: 0.44985491037368774
loss_pred:0.01464835274964571, decouple_loss:0.0008735631126910448
The modified gen p mean: 0.4496266841888428, gen p mean: -0.12521342933177948, mean p set: 0.45020049810409546
loss_pred:0.01437830738723278, decouple_loss:0.0009144438081420958
The modified gen p mean: 0.44779708981513977, gen p mean: -0.12817791104316711, mean p set: 0.4483746588230133
loss_pred:0.014728844165802002, decouple_loss:0.0009585930965840816
Iteration: 316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696250557899475, gen p mean: -0.12495477497577667, mean p set: 0.44753846526145935
loss_pred:0.014841180294752121, decouple_loss:0.0012608538381755352
The modified gen p mean: 0.44608789682388306, gen p mean: -0.12411628663539886, mean p set: 0.4466628134250641
loss_pred:0.015068155713379383, decouple_loss:0.001463632914237678
The modified gen p mean: 0.4463626444339752, gen p mean: -0.12286459654569626, mean p set: 0.4469376802444458
loss_pred:0.014867608435451984, decouple_loss:0.0014610305661335588
Iteration: 317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848668575286865, gen p mean: -0.11773858964443207, mean p set: 0.44906049966812134
loss_pred:0.014280769973993301, decouple_loss:0.000906093860976398
The modified gen p mean: 0.44780856370925903, gen p mean: -0.11460192501544952, mean p set: 0.44838523864746094
loss_pred:0.0150865837931633, decouple_loss:0.000949821958784014
The modified gen p mean: 0.44890761375427246, gen p mean: -0.11745801568031311, mean p set: 0.44948315620422363
loss_pred:0.014482080936431885, decouple_loss:0.0011098688701167703
Iteration: 318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476598799228668, gen p mean: -0.11529712378978729, mean p set: 0.44823670387268066
loss_pred:0.014400141313672066, decouple_loss:0.0010061016073450446
The modified gen p mean: 0.44831880927085876, gen p mean: -0.11675173789262772, mean p set: 0.4488963484764099
loss_pred:0.014530615881085396, decouple_loss:0.0011724618962034583
The modified gen p mean: 0.4486705958843231, gen p mean: -0.11714590340852737, mean p set: 0.44924619793891907
loss_pred:0.014416146092116833, decouple_loss:0.000970104243606329
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493085741996765, gen p mean: -0.11777597665786743, mean p set: 0.44988352060317993
The modified gen p mean: 0.44859275221824646, gen p mean: -0.11796427518129349, mean p set: 0.4491656422615051loss_pred:0.016895385459065437, decouple_loss:0.0009020238649100065
loss_pred:0.01775149069726467, decouple_loss:0.0010598119115456939
The modified gen p mean: 0.45024779438972473, gen p mean: -0.12010275572538376, mean p set: 0.4508230984210968
loss_pred:0.01763373240828514, decouple_loss:0.000982065568678081
Iteration: 320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495631456375122, gen p mean: -0.11953986436128616, mean p set: 0.4501415491104126
loss_pred:0.01740102842450142, decouple_loss:0.0008906530565582216
The modified gen p mean: 0.4500124156475067, gen p mean: -0.11524457484483719, mean p set: 0.45058757066726685
loss_pred:0.018049949780106544, decouple_loss:0.0011420826194807887
The modified gen p mean: 0.4491543173789978, gen p mean: -0.10982093960046768, mean p set: 0.44972866773605347
loss_pred:0.018054910004138947, decouple_loss:0.0010384585475549102
2023-05-01 00:06:40 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1159285232424736, mean p set: 0.4502691626548767
loss_pred:0.017425375059247017, decouple_loss:0.0011083876015618443
The modified gen p mean: 0.4495357871055603, gen p mean: -0.1099470779299736, mean p set: 0.4500633478164673
loss_pred:0.016859298571944237, decouple_loss:0.001179551356472075
The modified gen p mean: 0.449780136346817, gen p mean: -0.10912898927927017, mean p set: 0.45035696029663086
loss_pred:0.01731509156525135, decouple_loss:0.0012394689256325364
WV_1_PC_1_EH_0_PS_40, loss: 0.017258713021874428, avg_mse: 0.026754485443234444
current test mse: 0.026754
At step 320, Best test: 0.026754
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497656524181366, gen p mean: -0.1127997636795044, mean p set: 0.4503425657749176
loss_pred:0.017079776152968407, decouple_loss:0.0010834702989086509
The modified gen p mean: 0.44851821660995483, gen p mean: -0.10913018882274628, mean p set: 0.4490925073623657
loss_pred:0.018121352419257164, decouple_loss:0.0012299041263759136
The modified gen p mean: 0.4493137001991272, gen p mean: -0.11220040172338486, mean p set: 0.44988662004470825
loss_pred:0.016807017847895622, decouple_loss:0.0012227765982970595
Iteration: 322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492555260658264, gen p mean: -0.10863840579986572, mean p set: 0.4498307406902313
loss_pred:0.016929272562265396, decouple_loss:0.0012378040701150894
The modified gen p mean: 0.45042508840560913, gen p mean: -0.1115684062242508, mean p set: 0.4510018229484558The modified gen p mean: 0.449569970369339, gen p mean: -0.10724960267543793, mean p set: 0.45014673471450806
loss_pred:0.01858781836926937, decouple_loss:0.000873635639436543
loss_pred:0.017240261659026146, decouple_loss:0.001162263797596097
Iteration: 323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862836599349976, gen p mean: -0.11028655618429184, mean p set: 0.4492048919200897
loss_pred:0.01691177673637867, decouple_loss:0.0010697079123929143
The modified gen p mean: 0.45014095306396484, gen p mean: -0.10763432085514069, mean p set: 0.4507182538509369
loss_pred:0.01695372350513935, decouple_loss:0.0011287033557891846
The modified gen p mean: 0.4491596221923828, gen p mean: -0.10896313190460205, mean p set: 0.44973650574684143
loss_pred:0.01711850054562092, decouple_loss:0.000953319133259356
Iteration: 324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493769109249115, gen p mean: -0.10830406844615936, mean p set: 0.44995349645614624
loss_pred:0.017335522919893265, decouple_loss:0.0011064402060583234
The modified gen p mean: 0.44983601570129395, gen p mean: -0.10834154486656189, mean p set: 0.4504148066043854
loss_pred:0.017946511507034302, decouple_loss:0.0010597070213407278
The modified gen p mean: 0.45037204027175903, gen p mean: -0.11123885214328766, mean p set: 0.4509483277797699
loss_pred:0.018496330827474594, decouple_loss:0.0013499665074050426
Iteration: 325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018574595451355, gen p mean: -0.11007722467184067, mean p set: 0.4507621228694916
loss_pred:0.017986368387937546, decouple_loss:0.001274786191061139
The modified gen p mean: 0.4488729238510132, gen p mean: -0.11708637326955795, mean p set: 0.44944941997528076
loss_pred:0.017351249232888222, decouple_loss:0.000904624757822603
The modified gen p mean: 0.4481185972690582, gen p mean: -0.11387080699205399, mean p set: 0.4486955404281616
loss_pred:0.017557067796587944, decouple_loss:0.0013751996448263526
Iteration: 326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45000478625297546, gen p mean: -0.12340600788593292, mean p set: 0.450583815574646
loss_pred:0.018198054283857346, decouple_loss:0.0013054159935563803
The modified gen p mean: 0.44970467686653137, gen p mean: -0.11685661226511002, mean p set: 0.4502823054790497
loss_pred:0.017426427453756332, decouple_loss:0.0009879186982288957
The modified gen p mean: 0.45113879442214966, gen p mean: -0.11449295282363892, mean p set: 0.4517151713371277
loss_pred:0.017796797677874565, decouple_loss:0.0009507014765404165
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45072779059410095, gen p mean: -0.12185651063919067, mean p set: 0.4513084292411804
loss_pred:0.01795840449631214, decouple_loss:0.0009650310385040939
The modified gen p mean: 0.4506954848766327, gen p mean: -0.12145989388227463, mean p set: 0.45127072930336
loss_pred:0.017714785411953926, decouple_loss:0.0009751763427630067
The modified gen p mean: 0.45034968852996826, gen p mean: -0.11440232396125793, mean p set: 0.45092761516571045
loss_pred:0.018097037449479103, decouple_loss:0.0012317438377067447
Iteration: 328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500481188297272, gen p mean: -0.1208910420536995, mean p set: 0.45062586665153503
loss_pred:0.017680339515209198, decouple_loss:0.0012879259884357452
The modified gen p mean: 0.4492253363132477, gen p mean: -0.12036561220884323, mean p set: 0.4498046338558197
The modified gen p mean: 0.44912341237068176, gen p mean: -0.11949776858091354, mean p set: 0.4496990144252777
loss_pred:0.01786207966506481, decouple_loss:0.0012647288385778666
loss_pred:0.01795254461467266, decouple_loss:0.001105652074329555
Iteration: 329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496314525604248, gen p mean: -0.1248660534620285, mean p set: 0.4502067267894745
loss_pred:0.01696408912539482, decouple_loss:0.0011223527835682034
The modified gen p mean: 0.449251264333725, gen p mean: -0.11700087040662766, mean p set: 0.4498307704925537
loss_pred:0.017463667318224907, decouple_loss:0.001190060400404036
The modified gen p mean: 0.4493442177772522, gen p mean: -0.11981090158224106, mean p set: 0.4499199688434601
loss_pred:0.01699717901647091, decouple_loss:0.0011003251420333982
Iteration: 330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925791025161743, gen p mean: -0.1210370808839798, mean p set: 0.4498342275619507
loss_pred:0.017448432743549347, decouple_loss:0.0008762229699641466
The modified gen p mean: 0.4480324983596802, gen p mean: -0.1231660321354866, mean p set: 0.448609322309494
loss_pred:0.017580276355147362, decouple_loss:0.0010375800775364041
The modified gen p mean: 0.44880691170692444, gen p mean: -0.12141647189855576, mean p set: 0.4493815302848816
loss_pred:0.017489034682512283, decouple_loss:0.0008552699000574648
2023-05-01 00:08:50 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12333087623119354, mean p set: 0.4502691626548767
loss_pred:0.017460396513342857, decouple_loss:0.001401468412950635
The modified gen p mean: 0.44953373074531555, gen p mean: -0.1173970177769661, mean p set: 0.4500633478164673
loss_pred:0.016804514452815056, decouple_loss:0.001424121088348329
The modified gen p mean: 0.44978028535842896, gen p mean: -0.11624931544065475, mean p set: 0.45035696029663086
loss_pred:0.017320172861218452, decouple_loss:0.0012411823263391852
WV_1_PC_1_EH_0_PS_40, loss: 0.017262807115912437, avg_mse: 0.026650773361325264
current test mse: 0.026651
At step 330, Best test: 0.026651
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492358863353729, gen p mean: -0.11790024489164352, mean p set: 0.4498143792152405
loss_pred:0.017263803631067276, decouple_loss:0.0010592229664325714
The modified gen p mean: 0.45062050223350525, gen p mean: -0.11676166951656342, mean p set: 0.4511975646018982
loss_pred:0.016974888741970062, decouple_loss:0.0011263892520219088
The modified gen p mean: 0.4496033787727356, gen p mean: -0.11774411052465439, mean p set: 0.45017993450164795
loss_pred:0.017574524506926537, decouple_loss:0.0011373480083420873
Iteration: 332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45028695464134216, gen p mean: -0.11289454996585846, mean p set: 0.4508611261844635
loss_pred:0.017697690054774284, decouple_loss:0.0011435083579272032
The modified gen p mean: 0.4505901336669922, gen p mean: -0.11429578065872192, mean p set: 0.45116761326789856The modified gen p mean: 0.45052725076675415, gen p mean: -0.11318424344062805, mean p set: 0.451102077960968
loss_pred:0.017957402393221855, decouple_loss:0.001197504228912294loss_pred:0.017461489886045456, decouple_loss:0.0012907023774459958
Iteration: 333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496804177761078, gen p mean: -0.1154080182313919, mean p set: 0.4502556622028351
loss_pred:0.017616672441363335, decouple_loss:0.0010358592262491584
The modified gen p mean: 0.4494917690753937, gen p mean: -0.11677529662847519, mean p set: 0.45006564259529114
loss_pred:0.017064059153199196, decouple_loss:0.0008441635291092098
The modified gen p mean: 0.4498053789138794, gen p mean: -0.11659518629312515, mean p set: 0.45038241147994995
loss_pred:0.01716434769332409, decouple_loss:0.0009206978720612824
Iteration: 334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45005810260772705, gen p mean: -0.12051237374544144, mean p set: 0.4506319463253021
loss_pred:0.017495334148406982, decouple_loss:0.0010875961743295193
The modified gen p mean: 0.44979262351989746, gen p mean: -0.12278283387422562, mean p set: 0.45036831498146057
loss_pred:0.01713745854794979, decouple_loss:0.0009372882195748389
The modified gen p mean: 0.4500409662723541, gen p mean: -0.12753483653068542, mean p set: 0.4506154954433441
loss_pred:0.01753469929099083, decouple_loss:0.0013667941093444824
Iteration: 335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500991702079773, gen p mean: -0.1202465072274208, mean p set: 0.45067691802978516
loss_pred:0.0172786395996809, decouple_loss:0.0011019594967365265
The modified gen p mean: 0.44904017448425293, gen p mean: -0.1271064430475235, mean p set: 0.4496159553527832
loss_pred:0.01716691255569458, decouple_loss:0.0009587175445631146
The modified gen p mean: 0.4505020081996918, gen p mean: -0.12391291558742523, mean p set: 0.4510757029056549
loss_pred:0.018222695216536522, decouple_loss:0.0012038060231134295
Iteration: 336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44955748319625854, gen p mean: -0.12407027184963226, mean p set: 0.450135201215744
loss_pred:0.016578076407313347, decouple_loss:0.0011017926735803485
The modified gen p mean: 0.4486161470413208, gen p mean: -0.13293109834194183, mean p set: 0.4491928219795227
The modified gen p mean: 0.45016130805015564, gen p mean: -0.12855912744998932, mean p set: 0.45073747634887695
loss_pred:0.01701374165713787, decouple_loss:0.0009458968415856361
loss_pred:0.018116837367415428, decouple_loss:0.0010850484250113368
Iteration: 337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44895243644714355, gen p mean: -0.12794436514377594, mean p set: 0.44952836632728577
The modified gen p mean: 0.4494585692882538, gen p mean: -0.1289704442024231, mean p set: 0.4500381648540497
loss_pred:0.016931623220443726, decouple_loss:0.0007748788921162486
loss_pred:0.017025036737322807, decouple_loss:0.00079348124563694
The modified gen p mean: 0.4486151337623596, gen p mean: -0.1258709579706192, mean p set: 0.4491916298866272
loss_pred:0.017301321029663086, decouple_loss:0.0009037858108058572
Iteration: 338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901129603385925, gen p mean: -0.12158055603504181, mean p set: 0.4495888352394104
The modified gen p mean: 0.4500729739665985, gen p mean: -0.12166695296764374, mean p set: 0.4506498873233795
loss_pred:0.01724599301815033, decouple_loss:0.0009557244484312832
loss_pred:0.01749817654490471, decouple_loss:0.0007481139036826789
The modified gen p mean: 0.44999024271965027, gen p mean: -0.12796761095523834, mean p set: 0.45056453347206116
loss_pred:0.018235821276903152, decouple_loss:0.0009606428211554885
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
NaN value num: 0
Iteration: 339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45176658034324646, gen p mean: -0.11136509478092194, mean p set: 0.4523402154445648
loss_pred:0.01799437776207924, decouple_loss:0.0011239126324653625
The modified gen p mean: 0.44923654198646545, gen p mean: -0.12381265312433243, mean p set: 0.4498123526573181
The modified gen p mean: 0.45010316371917725, gen p mean: -0.11802985519170761, mean p set: 0.45067763328552246
loss_pred:0.01684083603322506, decouple_loss:0.0009300687815994024
loss_pred:0.016624143347144127, decouple_loss:0.0009744943818077445
Iteration: 340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449245810508728, gen p mean: -0.10582531243562698, mean p set: 0.44982221722602844
loss_pred:0.017472514882683754, decouple_loss:0.0012634930899366736
The modified gen p mean: 0.45022255182266235, gen p mean: -0.11483249813318253, mean p set: 0.45080122351646423
loss_pred:0.017073579132556915, decouple_loss:0.0010268616024404764
The modified gen p mean: 0.4492073953151703, gen p mean: -0.11363174021244049, mean p set: 0.4497832953929901
loss_pred:0.01761164702475071, decouple_loss:0.0008589604403823614
2023-05-01 00:11:42 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11868039518594742, mean p set: 0.4502691626548767
loss_pred:0.017540786415338516, decouple_loss:0.0012431938666850328
The modified gen p mean: 0.44953453540802, gen p mean: -0.11256801337003708, mean p set: 0.4500633478164673
loss_pred:0.01688097044825554, decouple_loss:0.001183230779133737
The modified gen p mean: 0.44978031516075134, gen p mean: -0.1114603579044342, mean p set: 0.45035696029663086
loss_pred:0.017224285751581192, decouple_loss:0.001054903375916183
WV_1_PC_1_EH_0_PS_40, loss: 0.017273370176553726, avg_mse: 0.026708196848630905
current test mse: 0.026708
Iteration: 341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44928431510925293, gen p mean: -0.10773500800132751, mean p set: 0.4498610198497772
loss_pred:0.017643805593252182, decouple_loss:0.0010224039433524013
The modified gen p mean: 0.45250141620635986, gen p mean: -0.10902521014213562, mean p set: 0.4530782699584961The modified gen p mean: 0.44993698596954346, gen p mean: -0.10873666405677795, mean p set: 0.45051491260528564
loss_pred:0.01737956702709198, decouple_loss:0.0011059279786422849
loss_pred:0.015955166891217232, decouple_loss:0.0009341812692582607
Iteration: 342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45036301016807556, gen p mean: -0.10674311220645905, mean p set: 0.45093992352485657
loss_pred:0.01772548258304596, decouple_loss:0.0012726819841191173
The modified gen p mean: 0.44970056414604187, gen p mean: -0.11305443197488785, mean p set: 0.450275719165802The modified gen p mean: 0.44899627566337585, gen p mean: -0.1027168482542038, mean p set: 0.44957494735717773
loss_pred:0.014826040714979172, decouple_loss:0.001183056621812284
loss_pred:0.015712475404143333, decouple_loss:0.001048186095431447
Iteration: 343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490051865577698, gen p mean: -0.1115696132183075, mean p set: 0.44958019256591797
loss_pred:0.015652576461434364, decouple_loss:0.001215634518302977
The modified gen p mean: 0.4489814043045044, gen p mean: -0.11272313445806503, mean p set: 0.4495577812194824
loss_pred:0.01647014357149601, decouple_loss:0.0009625761304050684
The modified gen p mean: 0.44966453313827515, gen p mean: -0.1069401353597641, mean p set: 0.4502403438091278
loss_pred:0.015512313693761826, decouple_loss:0.0009450639481656253
Iteration: 344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493664801120758, gen p mean: -0.11295033991336823, mean p set: 0.44994187355041504
loss_pred:0.015846310183405876, decouple_loss:0.0010949582792818546
The modified gen p mean: 0.44962602853775024, gen p mean: -0.10913131386041641, mean p set: 0.45020246505737305
loss_pred:0.017099488526582718, decouple_loss:0.001203511143103242
The modified gen p mean: 0.4490463435649872, gen p mean: -0.11335728317499161, mean p set: 0.4496227502822876
loss_pred:0.015227405354380608, decouple_loss:0.0009356887312605977
Iteration: 345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45142224431037903, gen p mean: -0.10598056763410568, mean p set: 0.45200085639953613
loss_pred:0.016746219247579575, decouple_loss:0.0014076133957132697
The modified gen p mean: 0.45040014386177063, gen p mean: -0.10549252480268478, mean p set: 0.4509774148464203
loss_pred:0.01760762929916382, decouple_loss:0.0011470792815089226
The modified gen p mean: 0.44962942600250244, gen p mean: -0.11052720993757248, mean p set: 0.45020341873168945
loss_pred:0.017507124692201614, decouple_loss:0.0009908420033752918
Iteration: 346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901686906814575, gen p mean: -0.10738345980644226, mean p set: 0.4495929181575775
loss_pred:0.016824893653392792, decouple_loss:0.0012558538001030684
The modified gen p mean: 0.4494912028312683, gen p mean: -0.10547113418579102, mean p set: 0.45006775856018066
loss_pred:0.016628580167889595, decouple_loss:0.0011866313870996237
The modified gen p mean: 0.45149701833724976, gen p mean: -0.10217469185590744, mean p set: 0.45207321643829346
loss_pred:0.017196886241436005, decouple_loss:0.0012148980749771
Iteration: 347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44981104135513306, gen p mean: -0.11267736554145813, mean p set: 0.4503854513168335
loss_pred:0.015499953180551529, decouple_loss:0.0010863516945391893
The modified gen p mean: 0.45207446813583374, gen p mean: -0.1170906275510788, mean p set: 0.45265159010887146
loss_pred:0.01658892259001732, decouple_loss:0.0013279595877975225
The modified gen p mean: 0.44886329770088196, gen p mean: -0.11639823764562607, mean p set: 0.4494384825229645
loss_pred:0.016013476997613907, decouple_loss:0.001082860166206956
Iteration: 348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493861794471741, gen p mean: -0.11329454928636551, mean p set: 0.44996196031570435
loss_pred:0.017344363033771515, decouple_loss:0.0010580311063677073
The modified gen p mean: 0.4489082396030426, gen p mean: -0.11494802683591843, mean p set: 0.44948339462280273
loss_pred:0.01635776460170746, decouple_loss:0.0009897068375721574
The modified gen p mean: 0.4514878988265991, gen p mean: -0.11989182978868484, mean p set: 0.45206427574157715
loss_pred:0.01731422357261181, decouple_loss:0.0011941962875425816
Iteration: 349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978630542755127, gen p mean: -0.11587463319301605, mean p set: 0.4503614008426666
loss_pred:0.016536911949515343, decouple_loss:0.001205030595883727
The modified gen p mean: 0.4491579830646515, gen p mean: -0.11015848070383072, mean p set: 0.4497336745262146
loss_pred:0.016372349113225937, decouple_loss:0.0010110402945429087
The modified gen p mean: 0.44943442940711975, gen p mean: -0.11219054460525513, mean p set: 0.4500081539154053
loss_pred:0.01688273437321186, decouple_loss:0.0011072062188759446
Iteration: 350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903478026390076, gen p mean: -0.1161903589963913, mean p set: 0.44961148500442505
loss_pred:0.016085436567664146, decouple_loss:0.0008977939141914248
The modified gen p mean: 0.4507017135620117, gen p mean: -0.11552693694829941, mean p set: 0.4512771964073181
The modified gen p mean: 0.44981250166893005, gen p mean: -0.11112573742866516, mean p set: 0.45039013028144836
loss_pred:0.016837675124406815, decouple_loss:0.0014144430169835687
loss_pred:0.01711845025420189, decouple_loss:0.0010292172664776444
2023-05-01 00:13:49 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12420812249183655, mean p set: 0.4502691626548767
loss_pred:0.017665673047304153, decouple_loss:0.001157605554908514
The modified gen p mean: 0.4495355784893036, gen p mean: -0.11837390810251236, mean p set: 0.4500633478164673
loss_pred:0.016917632892727852, decouple_loss:0.0012396672973409295
The modified gen p mean: 0.44978123903274536, gen p mean: -0.11717183887958527, mean p set: 0.45035696029663086
loss_pred:0.01728196069598198, decouple_loss:0.0010256873210892081
WV_1_PC_1_EH_0_PS_40, loss: 0.017345473170280457, avg_mse: 0.026882924139499664
current test mse: 0.026883
Iteration: 351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45130324363708496, gen p mean: -0.1066599041223526, mean p set: 0.4518806040287018
loss_pred:0.017009498551487923, decouple_loss:0.0010443093487992883
The modified gen p mean: 0.4513026177883148, gen p mean: -0.11593620479106903, mean p set: 0.45187583565711975The modified gen p mean: 0.44893375039100647, gen p mean: -0.10759854316711426, mean p set: 0.44950950145721436
loss_pred:0.017238304018974304, decouple_loss:0.001225985586643219
loss_pred:0.01674419455230236, decouple_loss:0.0012126422952860594
Iteration: 352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495844841003418, gen p mean: -0.12482322007417679, mean p set: 0.4501604735851288
loss_pred:0.015444070100784302, decouple_loss:0.0010420575272291899
The modified gen p mean: 0.4499983787536621, gen p mean: -0.11175119131803513, mean p set: 0.4505756199359894The modified gen p mean: 0.4511016011238098, gen p mean: -0.11653663218021393, mean p set: 0.451677143573761
loss_pred:0.017193295061588287, decouple_loss:0.0011932970955967903
loss_pred:0.017292991280555725, decouple_loss:0.0012785018188878894
Iteration: 353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45014211535453796, gen p mean: -0.11087942123413086, mean p set: 0.45071735978126526
loss_pred:0.015764504671096802, decouple_loss:0.0010783416219055653
The modified gen p mean: 0.45007818937301636, gen p mean: -0.11219348758459091, mean p set: 0.45065566897392273
loss_pred:0.01680334471166134, decouple_loss:0.001087815035134554
The modified gen p mean: 0.45116785168647766, gen p mean: -0.11191831529140472, mean p set: 0.45174553990364075
loss_pred:0.017165532335639, decouple_loss:0.0014472906477749348
Iteration: 354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44979989528656006, gen p mean: -0.10567809641361237, mean p set: 0.4503765404224396
loss_pred:0.01700560934841633, decouple_loss:0.0011653448455035686
The modified gen p mean: 0.44920849800109863, gen p mean: -0.10731059312820435, mean p set: 0.44978389143943787
loss_pred:0.01533807348459959, decouple_loss:0.001177107566036284
The modified gen p mean: 0.44955387711524963, gen p mean: -0.11442261189222336, mean p set: 0.4501286447048187
loss_pred:0.014826907776296139, decouple_loss:0.0010380200110375881
Iteration: 355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496859610080719, gen p mean: -0.11092526465654373, mean p set: 0.4502619802951813
loss_pred:0.01689719781279564, decouple_loss:0.0009781653061509132
The modified gen p mean: 0.44913217425346375, gen p mean: -0.10994699597358704, mean p set: 0.44970813393592834
loss_pred:0.016191838309168816, decouple_loss:0.0009685538825578988
The modified gen p mean: 0.4497832953929901, gen p mean: -0.11704421043395996, mean p set: 0.4503604471683502
loss_pred:0.015398011542856693, decouple_loss:0.001016151043586433
Iteration: 356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511213004589081, gen p mean: -0.10871902853250504, mean p set: 0.45169880986213684
loss_pred:0.01715167425572872, decouple_loss:0.0011081526754423976
The modified gen p mean: 0.4505311846733093, gen p mean: -0.10984310507774353, mean p set: 0.4511072635650635
loss_pred:0.01697755791246891, decouple_loss:0.001053248648531735
The modified gen p mean: 0.44933369755744934, gen p mean: -0.10914910584688187, mean p set: 0.44991159439086914
loss_pred:0.015479962341487408, decouple_loss:0.0010138947982341051
Iteration: 357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45102423429489136, gen p mean: -0.10556846857070923, mean p set: 0.4516032636165619
loss_pred:0.016405822709202766, decouple_loss:0.0010173087939620018
The modified gen p mean: 0.4517560601234436, gen p mean: -0.10723943263292313, mean p set: 0.45233187079429626
loss_pred:0.017489884048700333, decouple_loss:0.0009438408887945116
The modified gen p mean: 0.4511738717556, gen p mean: -0.10834537446498871, mean p set: 0.45175236463546753
loss_pred:0.017176784574985504, decouple_loss:0.0010436002630740404
Iteration: 358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909462332725525, gen p mean: -0.11208074539899826, mean p set: 0.4496690630912781
loss_pred:0.015825264155864716, decouple_loss:0.0010802308097481728
The modified gen p mean: 0.4494318962097168, gen p mean: -0.10487520694732666, mean p set: 0.4500085711479187
loss_pred:0.0171816349029541, decouple_loss:0.0011435957858338952
The modified gen p mean: 0.4510471820831299, gen p mean: -0.10385258495807648, mean p set: 0.4516216814517975
loss_pred:0.016952283680438995, decouple_loss:0.0012242789380252361
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
NaN value num: 0
Iteration: 359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492768347263336, gen p mean: -0.11133568733930588, mean p set: 0.4498515725135803
loss_pred:0.01689894124865532, decouple_loss:0.0012120121391490102
The modified gen p mean: 0.45127353072166443, gen p mean: -0.1099151223897934, mean p set: 0.4518527686595917
The modified gen p mean: 0.448485404253006, gen p mean: -0.10774678736925125, mean p set: 0.4490615427494049
loss_pred:0.016321897506713867, decouple_loss:0.0013324510073289275
loss_pred:0.01792585477232933, decouple_loss:0.0011901957914233208
Iteration: 360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499504864215851, gen p mean: -0.11102701723575592, mean p set: 0.4505264163017273
loss_pred:0.01667063869535923, decouple_loss:0.001262878649868071
The modified gen p mean: 0.45007947087287903, gen p mean: -0.11370079219341278, mean p set: 0.45065850019454956
loss_pred:0.016509899869561195, decouple_loss:0.0012937072897329926
The modified gen p mean: 0.45130762457847595, gen p mean: -0.10943741351366043, mean p set: 0.4518826901912689
loss_pred:0.017394252121448517, decouple_loss:0.001286237733438611
2023-05-01 00:16:38 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12293185293674469, mean p set: 0.4502691626548767
loss_pred:0.017684513702988625, decouple_loss:0.0012474266113713384
The modified gen p mean: 0.4495350122451782, gen p mean: -0.11678056418895721, mean p set: 0.4500633478164673
loss_pred:0.01711443066596985, decouple_loss:0.0013532777084037662
The modified gen p mean: 0.4497779905796051, gen p mean: -0.11568358540534973, mean p set: 0.45035696029663086
loss_pred:0.01739821396768093, decouple_loss:0.0011839696671813726
WV_1_PC_1_EH_0_PS_40, loss: 0.01746213249862194, avg_mse: 0.02705579437315464
current test mse: 0.027056
Iteration: 361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516698122024536, gen p mean: -0.11404499411582947, mean p set: 0.4522479474544525
loss_pred:0.016697101294994354, decouple_loss:0.0014127626782283187
The modified gen p mean: 0.4500292241573334, gen p mean: -0.1138899028301239, mean p set: 0.45060494542121887The modified gen p mean: 0.4476867616176605, gen p mean: -0.11494499444961548, mean p set: 0.4482645094394684
loss_pred:0.01723911613225937, decouple_loss:0.0011095856316387653
loss_pred:0.017831796780228615, decouple_loss:0.0014593343948945403
Iteration: 362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512278437614441, gen p mean: -0.1162438839673996, mean p set: 0.4518038034439087
loss_pred:0.015873152762651443, decouple_loss:0.0012747434666380286
The modified gen p mean: 0.4484311640262604, gen p mean: -0.11817030608654022, mean p set: 0.44900739192962646The modified gen p mean: 0.44988173246383667, gen p mean: -0.11222808808088303, mean p set: 0.45045995712280273
loss_pred:0.01713140867650509, decouple_loss:0.0013512137811630964
loss_pred:0.017071183770895004, decouple_loss:0.0014054570347070694
Iteration: 363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45206907391548157, gen p mean: -0.1138807013630867, mean p set: 0.4526459276676178
The modified gen p mean: 0.4488062560558319, gen p mean: -0.11527710407972336, mean p set: 0.449381947517395
loss_pred:0.016618698835372925, decouple_loss:0.0010755009716376662
loss_pred:0.016903212293982506, decouple_loss:0.0012063180329278111
The modified gen p mean: 0.4499164819717407, gen p mean: -0.11967437714338303, mean p set: 0.4504929184913635
loss_pred:0.017111018300056458, decouple_loss:0.0013117624912410975
Iteration: 364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496627748012543, gen p mean: -0.12021922320127487, mean p set: 0.45023781061172485
loss_pred:0.016730286180973053, decouple_loss:0.0009498968138359487
The modified gen p mean: 0.44967061281204224, gen p mean: -0.11430037021636963, mean p set: 0.45024624466896057
loss_pred:0.016965461894869804, decouple_loss:0.001025366596877575
The modified gen p mean: 0.44973066449165344, gen p mean: -0.11254426091909409, mean p set: 0.45030689239501953
loss_pred:0.017156101763248444, decouple_loss:0.001043542637489736
Iteration: 365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513082504272461, gen p mean: -0.11268429458141327, mean p set: 0.451885849237442
loss_pred:0.016919123008847237, decouple_loss:0.0013858209131285548
The modified gen p mean: 0.4509836435317993, gen p mean: -0.11434177309274673, mean p set: 0.45156213641166687
loss_pred:0.017414424568414688, decouple_loss:0.0014628303470090032
The modified gen p mean: 0.4503467082977295, gen p mean: -0.11372505128383636, mean p set: 0.4509258568286896
loss_pred:0.016610389575362206, decouple_loss:0.0014622325543314219
Iteration: 366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450364887714386, gen p mean: -0.11450117081403732, mean p set: 0.4509424567222595
loss_pred:0.016816647723317146, decouple_loss:0.0012303864350542426
The modified gen p mean: 0.4484902620315552, gen p mean: -0.1190047413110733, mean p set: 0.4490666687488556
loss_pred:0.01689661666750908, decouple_loss:0.0014205948682501912
The modified gen p mean: 0.4513450264930725, gen p mean: -0.11622631549835205, mean p set: 0.4519214332103729
loss_pred:0.015919169411063194, decouple_loss:0.0012564639328047633
Iteration: 367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44883695244789124, gen p mean: -0.12169991433620453, mean p set: 0.44941338896751404
loss_pred:0.017089666798710823, decouple_loss:0.0013273676158860326
The modified gen p mean: 0.45020633935928345, gen p mean: -0.108333058655262, mean p set: 0.4507831633090973
loss_pred:0.017751015722751617, decouple_loss:0.00120036699809134
The modified gen p mean: 0.44894883036613464, gen p mean: -0.11771265417337418, mean p set: 0.44952380657196045
loss_pred:0.016783760860562325, decouple_loss:0.0013864581706002355
Iteration: 368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521794617176056, gen p mean: -0.10624060034751892, mean p set: 0.45275649428367615
loss_pred:0.01647646725177765, decouple_loss:0.0010408589150756598
The modified gen p mean: 0.4527370035648346, gen p mean: -0.10655000060796738, mean p set: 0.4533156752586365
loss_pred:0.016993094235658646, decouple_loss:0.0009545029024593532
The modified gen p mean: 0.4499327838420868, gen p mean: -0.10858277976512909, mean p set: 0.4505072236061096
loss_pred:0.016660330817103386, decouple_loss:0.001092501450330019
Iteration: 369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448934942483902, gen p mean: -0.1133723109960556, mean p set: 0.4495079815387726
loss_pred:0.017139891162514687, decouple_loss:0.0012629996053874493
The modified gen p mean: 0.45043379068374634, gen p mean: -0.10917709022760391, mean p set: 0.4510088264942169
The modified gen p mean: 0.450950026512146, gen p mean: -0.10980356484651566, mean p set: 0.45152729749679565
loss_pred:0.016342977061867714, decouple_loss:0.0009746330906637013
loss_pred:0.01679537631571293, decouple_loss:0.0009593727299943566
Iteration: 370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44850918650627136, gen p mean: -0.1224788948893547, mean p set: 0.44908812642097473
loss_pred:0.017245111986994743, decouple_loss:0.0009668365819379687
The modified gen p mean: 0.44752126932144165, gen p mean: -0.12145508825778961, mean p set: 0.44809824228286743
The modified gen p mean: 0.44900792837142944, gen p mean: -0.11318381875753403, mean p set: 0.44958722591400146
loss_pred:0.016578758135437965, decouple_loss:0.0009465932380408049
loss_pred:0.016918743029236794, decouple_loss:0.0009721481474116445
2023-05-01 00:18:44 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.126299187541008, mean p set: 0.4502691626548767
loss_pred:0.017689453437924385, decouple_loss:0.0008144580642692745
The modified gen p mean: 0.4495376944541931, gen p mean: -0.11959914863109589, mean p set: 0.4500633478164673
loss_pred:0.017016874626278877, decouple_loss:0.0010329909855499864
The modified gen p mean: 0.4497824013233185, gen p mean: -0.11857835948467255, mean p set: 0.45035696029663086
loss_pred:0.017415614798665047, decouple_loss:0.000984873971901834
WV_1_PC_1_EH_0_PS_40, loss: 0.017421187832951546, avg_mse: 0.027060316875576973
current test mse: 0.02706
Iteration: 371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496266841888428, gen p mean: -0.1167369857430458, mean p set: 0.4502033293247223
loss_pred:0.01653548702597618, decouple_loss:0.0008950153714977205
The modified gen p mean: 0.4518998861312866, gen p mean: -0.11932512372732162, mean p set: 0.45247551798820496The modified gen p mean: 0.44891485571861267, gen p mean: -0.1222754493355751, mean p set: 0.4494905471801758
loss_pred:0.01641887240111828, decouple_loss:0.0008650076924823225
loss_pred:0.016687311232089996, decouple_loss:0.0011519186664372683
Iteration: 372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45136091113090515, gen p mean: -0.12103145569562912, mean p set: 0.45193883776664734
loss_pred:0.016189351677894592, decouple_loss:0.0009019357385113835
The modified gen p mean: 0.449061781167984, gen p mean: -0.11124622821807861, mean p set: 0.44963955879211426The modified gen p mean: 0.44940513372421265, gen p mean: -0.1138482466340065, mean p set: 0.4499800503253937
loss_pred:0.01703774183988571, decouple_loss:0.0010744971223175526
loss_pred:0.017855171114206314, decouple_loss:0.0010943174129351974
Iteration: 373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485422670841217, gen p mean: -0.11974633485078812, mean p set: 0.44911783933639526
The modified gen p mean: 0.44920575618743896, gen p mean: -0.11050548404455185, mean p set: 0.4497814178466797
loss_pred:0.016706259921193123, decouple_loss:0.0010787165956571698
loss_pred:0.017213013023138046, decouple_loss:0.0007947745034471154
The modified gen p mean: 0.4513149559497833, gen p mean: -0.1144767701625824, mean p set: 0.4518917500972748
loss_pred:0.016475439071655273, decouple_loss:0.0012036197585985065
Iteration: 374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517228305339813, gen p mean: -0.11449826508760452, mean p set: 0.4522995054721832
loss_pred:0.01643606834113598, decouple_loss:0.0009936729911714792
The modified gen p mean: 0.4499940574169159, gen p mean: -0.1251712143421173, mean p set: 0.4505738615989685
loss_pred:0.016246523708105087, decouple_loss:0.0010235710069537163
The modified gen p mean: 0.4495985209941864, gen p mean: -0.11801999062299728, mean p set: 0.45017367601394653
loss_pred:0.01684594340622425, decouple_loss:0.0010207976447418332
Iteration: 375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520656168460846, gen p mean: -0.11709171533584595, mean p set: 0.45264333486557007
loss_pred:0.016011113300919533, decouple_loss:0.0011877119541168213
The modified gen p mean: 0.44968685507774353, gen p mean: -0.12531505525112152, mean p set: 0.45026248693466187
loss_pred:0.017228547483682632, decouple_loss:0.0008901759865693748
The modified gen p mean: 0.4504486620426178, gen p mean: -0.12144961208105087, mean p set: 0.4510234594345093
loss_pred:0.017600281164050102, decouple_loss:0.0010069372365251184
Iteration: 376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448906272649765, gen p mean: -0.12346465140581131, mean p set: 0.4494827091693878
loss_pred:0.017291126772761345, decouple_loss:0.000836789608001709
The modified gen p mean: 0.4501897990703583, gen p mean: -0.12086044251918793, mean p set: 0.4507688283920288
The modified gen p mean: 0.4523962438106537, gen p mean: -0.12088305503129959, mean p set: 0.45297008752822876
loss_pred:0.01728474162518978, decouple_loss:0.0008310735574923456
loss_pred:0.01651536300778389, decouple_loss:0.0009289678419008851
Iteration: 377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44936537742614746, gen p mean: -0.12373557686805725, mean p set: 0.44993945956230164
loss_pred:0.01621241495013237, decouple_loss:0.0011890645837411284
The modified gen p mean: 0.44918695092201233, gen p mean: -0.11784381419420242, mean p set: 0.44976404309272766
The modified gen p mean: 0.44982409477233887, gen p mean: -0.11287356913089752, mean p set: 0.4504006803035736
loss_pred:0.01711789146065712, decouple_loss:0.0009334167698398232
loss_pred:0.0166349858045578, decouple_loss:0.0009019830031320453
Iteration: 378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082777738571167, gen p mean: -0.1102684885263443, mean p set: 0.45140528678894043
loss_pred:0.016143683344125748, decouple_loss:0.0009597282623872161
The modified gen p mean: 0.4500586986541748, gen p mean: -0.11038544774055481, mean p set: 0.4506358802318573
loss_pred:0.017701948061585426, decouple_loss:0.0009762888657860458
The modified gen p mean: 0.4477844834327698, gen p mean: -0.1082797721028328, mean p set: 0.4483596682548523
loss_pred:0.017342418432235718, decouple_loss:0.0009868203196674585
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
NaN value num: 0
Iteration: 379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45050048828125, gen p mean: -0.10420382767915726, mean p set: 0.4510754346847534
The modified gen p mean: 0.4508066773414612, gen p mean: -0.09857400506734848, mean p set: 0.45138245820999146
loss_pred:0.01639753207564354, decouple_loss:0.0010890908306464553
loss_pred:0.01732836663722992, decouple_loss:0.0012260653311386704
The modified gen p mean: 0.450982004404068, gen p mean: -0.09523571282625198, mean p set: 0.4515576958656311
loss_pred:0.01693681627511978, decouple_loss:0.0013971449807286263
Iteration: 380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104512572288513, gen p mean: -0.09773898124694824, mean p set: 0.4516221284866333
loss_pred:0.016799896955490112, decouple_loss:0.0011728227837011218
The modified gen p mean: 0.4515315592288971, gen p mean: -0.10144626349210739, mean p set: 0.45210859179496765
loss_pred:0.017549782991409302, decouple_loss:0.0009742325055412948
The modified gen p mean: 0.45176470279693604, gen p mean: -0.09838443994522095, mean p set: 0.45234063267707825
loss_pred:0.018307015299797058, decouple_loss:0.0009585233638063073
2023-05-01 00:21:30 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11053987592458725, mean p set: 0.4502691626548767
loss_pred:0.017790677025914192, decouple_loss:0.0010844304924830794
The modified gen p mean: 0.4495377838611603, gen p mean: -0.10447201132774353, mean p set: 0.4500633478164673
loss_pred:0.017094984650611877, decouple_loss:0.0011391962179914117
The modified gen p mean: 0.44978001713752747, gen p mean: -0.10331180691719055, mean p set: 0.45035696029663086
loss_pred:0.01746344193816185, decouple_loss:0.0011925793951377273
WV_1_PC_1_EH_0_PS_40, loss: 0.017506638541817665, avg_mse: 0.02715480327606201
current test mse: 0.027155
Iteration: 381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506208002567291, gen p mean: -0.10223785042762756, mean p set: 0.4511964023113251
loss_pred:0.017050113528966904, decouple_loss:0.0010207941522821784
The modified gen p mean: 0.45233154296875, gen p mean: -0.10267317295074463, mean p set: 0.452907919883728The modified gen p mean: 0.44932273030281067, gen p mean: -0.1010892242193222, mean p set: 0.4498981535434723
loss_pred:0.017641916871070862, decouple_loss:0.0011748395627364516
loss_pred:0.016533736139535904, decouple_loss:0.0013199939858168364
Iteration: 382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502464830875397, gen p mean: -0.10494238883256912, mean p set: 0.45082327723503113
loss_pred:0.017326083034276962, decouple_loss:0.0010143746621906757
The modified gen p mean: 0.4498162567615509, gen p mean: -0.09879934042692184, mean p set: 0.45039525628089905The modified gen p mean: 0.4529801309108734, gen p mean: -0.0947398692369461, mean p set: 0.45355916023254395
loss_pred:0.017299219965934753, decouple_loss:0.0009743149275891483
loss_pred:0.017252042889595032, decouple_loss:0.0010313933016732335
Iteration: 383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495500326156616, gen p mean: -0.10588391870260239, mean p set: 0.4501255452632904
loss_pred:0.016292370855808258, decouple_loss:0.0011191735975444317
The modified gen p mean: 0.4482860565185547, gen p mean: -0.10362987220287323, mean p set: 0.4488649070262909
loss_pred:0.01636303775012493, decouple_loss:0.0010685463203117251
The modified gen p mean: 0.45043283700942993, gen p mean: -0.10439474880695343, mean p set: 0.4510097801685333
loss_pred:0.016433345153927803, decouple_loss:0.0010306733893230557
Iteration: 384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45351162552833557, gen p mean: -0.11284191906452179, mean p set: 0.45408543944358826
loss_pred:0.017040735110640526, decouple_loss:0.001006785430945456
The modified gen p mean: 0.45183685421943665, gen p mean: -0.11366750299930573, mean p set: 0.4524140954017639
loss_pred:0.016848906874656677, decouple_loss:0.0013740956783294678
The modified gen p mean: 0.4492422342300415, gen p mean: -0.11550579220056534, mean p set: 0.44981685280799866
loss_pred:0.016765331849455833, decouple_loss:0.001074027270078659
Iteration: 385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533126652240753, gen p mean: -0.12261504679918289, mean p set: 0.45388877391815186
loss_pred:0.01747451163828373, decouple_loss:0.0011551305651664734
The modified gen p mean: 0.4509771466255188, gen p mean: -0.12254102528095245, mean p set: 0.4515541195869446
loss_pred:0.01647861860692501, decouple_loss:0.0010815842542797327
The modified gen p mean: 0.45068812370300293, gen p mean: -0.12001068890094757, mean p set: 0.45126447081565857
loss_pred:0.01626090705394745, decouple_loss:0.0010478266049176455
Iteration: 386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514210820198059, gen p mean: -0.12150851637125015, mean p set: 0.45199936628341675
loss_pred:0.01774759776890278, decouple_loss:0.0011073864297941327
The modified gen p mean: 0.4508358836174011, gen p mean: -0.11815156042575836, mean p set: 0.45141345262527466
loss_pred:0.018080100417137146, decouple_loss:0.0010477538453415036
The modified gen p mean: 0.4524685740470886, gen p mean: -0.12427224963903427, mean p set: 0.45304831862449646
loss_pred:0.01774679124355316, decouple_loss:0.0012076080311089754
Iteration: 387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523550570011139, gen p mean: -0.11982287466526031, mean p set: 0.45293283462524414
loss_pred:0.01698159985244274, decouple_loss:0.0011560522252693772
The modified gen p mean: 0.4484185576438904, gen p mean: -0.12344086915254593, mean p set: 0.44899213314056396
The modified gen p mean: 0.4494648575782776, gen p mean: -0.12134713679552078, mean p set: 0.45004045963287354
loss_pred:0.016458692029118538, decouple_loss:0.0011605025501921773
loss_pred:0.01645885407924652, decouple_loss:0.0010775008704513311
Iteration: 388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501863420009613, gen p mean: -0.12570999562740326, mean p set: 0.4507656991481781
loss_pred:0.01794927380979061, decouple_loss:0.0010883735958486795
The modified gen p mean: 0.451527863740921, gen p mean: -0.12104979902505875, mean p set: 0.452106237411499
loss_pred:0.016755396500229836, decouple_loss:0.0010471894638612866
The modified gen p mean: 0.4509739577770233, gen p mean: -0.12513084709644318, mean p set: 0.4515494108200073
loss_pred:0.016425468027591705, decouple_loss:0.000912826566491276
Iteration: 389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45140910148620605, gen p mean: -0.124703049659729, mean p set: 0.4519835412502289
loss_pred:0.01604141667485237, decouple_loss:0.0010343807516619563
The modified gen p mean: 0.4498099088668823, gen p mean: -0.12528276443481445, mean p set: 0.4503856897354126
loss_pred:0.01742224581539631, decouple_loss:0.0010246254969388247
The modified gen p mean: 0.4512993097305298, gen p mean: -0.1262982189655304, mean p set: 0.45187628269195557
loss_pred:0.016768131405115128, decouple_loss:0.0011053582420572639
Iteration: 390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505976736545563, gen p mean: -0.12400899827480316, mean p set: 0.45117560029029846
loss_pred:0.01586691103875637, decouple_loss:0.0008335040183737874
The modified gen p mean: 0.4510602056980133, gen p mean: -0.12370079755783081, mean p set: 0.45163723826408386
loss_pred:0.01731661893427372, decouple_loss:0.0010996890487149358
The modified gen p mean: 0.45060375332832336, gen p mean: -0.11426416784524918, mean p set: 0.45117807388305664
loss_pred:0.01657027192413807, decouple_loss:0.0008850519661791623
2023-05-01 00:23:36 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12951959669589996, mean p set: 0.4502691626548767
loss_pred:0.017754757776856422, decouple_loss:0.0010116177145391703
The modified gen p mean: 0.4495343565940857, gen p mean: -0.12351559102535248, mean p set: 0.4500633478164673
loss_pred:0.017174450680613518, decouple_loss:0.0011075809597969055
The modified gen p mean: 0.44978028535842896, gen p mean: -0.12224851548671722, mean p set: 0.45035696029663086
loss_pred:0.01750463992357254, decouple_loss:0.0010656764497980475
WV_1_PC_1_EH_0_PS_40, loss: 0.017531031742691994, avg_mse: 0.027119318023324013
current test mse: 0.027119
Iteration: 391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506109058856964, gen p mean: -0.11054420471191406, mean p set: 0.4511864483356476
loss_pred:0.01695379428565502, decouple_loss:0.0010464799124747515
The modified gen p mean: 0.45057448744773865, gen p mean: -0.12408535927534103, mean p set: 0.4511508643627167The modified gen p mean: 0.4517917335033417, gen p mean: -0.1119624450802803, mean p set: 0.45236828923225403
loss_pred:0.01682518795132637, decouple_loss:0.00122475263196975loss_pred:0.017977500334382057, decouple_loss:0.0011395405745133758
Iteration: 392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45120173692703247, gen p mean: -0.11548185348510742, mean p set: 0.4517787992954254
loss_pred:0.016248509287834167, decouple_loss:0.0011123098665848374
The modified gen p mean: 0.4508846402168274, gen p mean: -0.11398494988679886, mean p set: 0.45146021246910095The modified gen p mean: 0.45115381479263306, gen p mean: -0.11375504732131958, mean p set: 0.451731413602829
loss_pred:0.01691586524248123, decouple_loss:0.0009954060660675168
loss_pred:0.017778446897864342, decouple_loss:0.0009676690679043531
Iteration: 393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45150578022003174, gen p mean: -0.1155109778046608, mean p set: 0.4520801901817322
The modified gen p mean: 0.45137056708335876, gen p mean: -0.11653967946767807, mean p set: 0.4519501030445099
loss_pred:0.016284670680761337, decouple_loss:0.0011942971032112837
loss_pred:0.016205137595534325, decouple_loss:0.0012659546919167042
The modified gen p mean: 0.45021679997444153, gen p mean: -0.12437504529953003, mean p set: 0.450794517993927
loss_pred:0.016240475699305534, decouple_loss:0.0013158924411982298
Iteration: 394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45221197605133057, gen p mean: -0.11618845909833908, mean p set: 0.45278817415237427
loss_pred:0.018072541803121567, decouple_loss:0.0011205942137166858
The modified gen p mean: 0.4513503909111023, gen p mean: -0.11863525211811066, mean p set: 0.4519265294075012
loss_pred:0.017667504027485847, decouple_loss:0.0013294130330905318
The modified gen p mean: 0.44902750849723816, gen p mean: -0.12086809426546097, mean p set: 0.44960349798202515
loss_pred:0.016514329239726067, decouple_loss:0.0013247973984107375
Iteration: 395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502272605895996, gen p mean: -0.11834811419248581, mean p set: 0.45080307126045227
loss_pred:0.017428573220968246, decouple_loss:0.0015702060190960765
The modified gen p mean: 0.45120978355407715, gen p mean: -0.11265398561954498, mean p set: 0.4517843425273895
loss_pred:0.018780896440148354, decouple_loss:0.0013174139894545078
The modified gen p mean: 0.4519188404083252, gen p mean: -0.11366629600524902, mean p set: 0.45249274373054504
loss_pred:0.017702732235193253, decouple_loss:0.001237326767295599
Iteration: 396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933003187179565, gen p mean: -0.11178266257047653, mean p set: 0.44990551471710205
loss_pred:0.01580182835459709, decouple_loss:0.0009852993534877896
The modified gen p mean: 0.4519091546535492, gen p mean: -0.11188414692878723, mean p set: 0.4524848163127899
The modified gen p mean: 0.45187050104141235, gen p mean: -0.10920009016990662, mean p set: 0.4524483382701874
loss_pred:0.016355592757463455, decouple_loss:0.001406018971465528
loss_pred:0.017551710829138756, decouple_loss:0.0010536115150898695
Iteration: 397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510553777217865, gen p mean: -0.10851580649614334, mean p set: 0.4516323506832123
loss_pred:0.01670881360769272, decouple_loss:0.0013375966809689999
The modified gen p mean: 0.4511069357395172, gen p mean: -0.10119102150201797, mean p set: 0.4516826570034027
loss_pred:0.017080876976251602, decouple_loss:0.0012755512725561857
The modified gen p mean: 0.45070692896842957, gen p mean: -0.09896072000265121, mean p set: 0.4512827396392822
loss_pred:0.01690426468849182, decouple_loss:0.0015396274393424392
Iteration: 398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449725478887558, gen p mean: -0.10122272372245789, mean p set: 0.4503021836280823
The modified gen p mean: 0.4513859748840332, gen p mean: -0.10354124754667282, mean p set: 0.4519629180431366
loss_pred:0.01604105904698372, decouple_loss:0.0008977079996839166
loss_pred:0.01634937897324562, decouple_loss:0.0008512552594766021
The modified gen p mean: 0.45001712441444397, gen p mean: -0.10695096105337143, mean p set: 0.4505898058414459
loss_pred:0.01724103093147278, decouple_loss:0.0013898784527555108
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
NaN value num: 0
Iteration: 399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488993287086487, gen p mean: -0.11776335537433624, mean p set: 0.4494765102863312
loss_pred:0.01665703020989895, decouple_loss:0.0011208944488316774
The modified gen p mean: 0.44716164469718933, gen p mean: -0.11293347179889679, mean p set: 0.4477371573448181
The modified gen p mean: 0.4489942491054535, gen p mean: -0.11276072263717651, mean p set: 0.44957301020622253
loss_pred:0.01756741851568222, decouple_loss:0.0014158054254949093
loss_pred:0.01718437857925892, decouple_loss:0.0012362763518467546
Iteration: 400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476284682750702, gen p mean: -0.11419689655303955, mean p set: 0.44820311665534973
loss_pred:0.017459431663155556, decouple_loss:0.0011346478713676333
The modified gen p mean: 0.4497489035129547, gen p mean: -0.11431039124727249, mean p set: 0.45032617449760437
The modified gen p mean: 0.4474099278450012, gen p mean: -0.11262083798646927, mean p set: 0.44798994064331055
loss_pred:0.017592351883649826, decouple_loss:0.0010091421427205205
loss_pred:0.018282752484083176, decouple_loss:0.001342394039966166
2023-05-01 00:26:22 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12444332242012024, mean p set: 0.4502691626548767
loss_pred:0.017666414380073547, decouple_loss:0.0009418169502168894
The modified gen p mean: 0.44953492283821106, gen p mean: -0.11850191652774811, mean p set: 0.4500633478164673
loss_pred:0.017198605462908745, decouple_loss:0.0010278812842443585
The modified gen p mean: 0.4497823417186737, gen p mean: -0.11724244058132172, mean p set: 0.45035696029663086
loss_pred:0.01740504428744316, decouple_loss:0.000953117327298969
WV_1_PC_1_EH_0_PS_40, loss: 0.017472069710493088, avg_mse: 0.027070634067058563
current test mse: 0.027071
Iteration: 401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471985399723053, gen p mean: -0.12346793711185455, mean p set: 0.4477744400501251
loss_pred:0.01768607087433338, decouple_loss:0.000896223820745945
The modified gen p mean: 0.4473784863948822, gen p mean: -0.1207255944609642, mean p set: 0.4479536712169647The modified gen p mean: 0.44853076338768005, gen p mean: -0.11245623975992203, mean p set: 0.4491044282913208
loss_pred:0.01839974708855152, decouple_loss:0.0011103120632469654
loss_pred:0.017095353454351425, decouple_loss:0.0008563933079130948
Iteration: 402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963234663009644, gen p mean: -0.12355384230613708, mean p set: 0.45020791888237
loss_pred:0.016828423365950584, decouple_loss:0.0010095499455928802
The modified gen p mean: 0.45009177923202515, gen p mean: -0.12269598245620728, mean p set: 0.450667142868042
The modified gen p mean: 0.44681254029273987, gen p mean: -0.12451108545064926, mean p set: 0.44738876819610596
loss_pred:0.01734945736825466, decouple_loss:0.00109824538230896
loss_pred:0.018823303282260895, decouple_loss:0.0011446498101577163
Iteration: 403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476943910121918, gen p mean: -0.1338377445936203, mean p set: 0.44826775789260864
loss_pred:0.018912697210907936, decouple_loss:0.0011271819239482284
The modified gen p mean: 0.44860586524009705, gen p mean: -0.12708131968975067, mean p set: 0.4491809606552124The modified gen p mean: 0.4470811188220978, gen p mean: -0.126981720328331, mean p set: 0.44765329360961914
loss_pred:0.0169379860162735, decouple_loss:0.0010718427365645766
loss_pred:0.017442742362618446, decouple_loss:0.0009146576630882919
Iteration: 404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694939255714417, gen p mean: -0.13360796868801117, mean p set: 0.4475262761116028
The modified gen p mean: 0.4477827548980713, gen p mean: -0.12844015657901764, mean p set: 0.44835713505744934loss_pred:0.018558796495199203, decouple_loss:0.0010013548890128732
loss_pred:0.017183789983391762, decouple_loss:0.0011173747479915619
The modified gen p mean: 0.4464602768421173, gen p mean: -0.13865575194358826, mean p set: 0.4470324218273163
loss_pred:0.017631566151976585, decouple_loss:0.0009769572643563151
Iteration: 405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820815324783325, gen p mean: -0.1387883871793747, mean p set: 0.44878458976745605
loss_pred:0.016505926847457886, decouple_loss:0.000902986153960228
The modified gen p mean: 0.44846680760383606, gen p mean: -0.13184815645217896, mean p set: 0.44904273748397827
loss_pred:0.016950752586126328, decouple_loss:0.0009430599166080356
The modified gen p mean: 0.4478254020214081, gen p mean: -0.13056103885173798, mean p set: 0.44840285181999207
loss_pred:0.017589397728443146, decouple_loss:0.001069547957740724
Iteration: 406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468291401863098, gen p mean: -0.1263444721698761, mean p set: 0.4474024772644043
loss_pred:0.017628109082579613, decouple_loss:0.0009441075962968171
The modified gen p mean: 0.4473992586135864, gen p mean: -0.12991739809513092, mean p set: 0.447974294424057
The modified gen p mean: 0.4482566714286804, gen p mean: -0.130214661359787, mean p set: 0.448832243680954
loss_pred:0.017190534621477127, decouple_loss:0.0009814739460125566
loss_pred:0.019208071753382683, decouple_loss:0.0012230734573677182
Iteration: 407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688811898231506, gen p mean: -0.13182999193668365, mean p set: 0.4474656283855438
loss_pred:0.017011592164635658, decouple_loss:0.0011981887510046363
The modified gen p mean: 0.4468786120414734, gen p mean: -0.12494562566280365, mean p set: 0.44745421409606934
loss_pred:0.017047373577952385, decouple_loss:0.0008201111340895295
The modified gen p mean: 0.44820669293403625, gen p mean: -0.12690775096416473, mean p set: 0.4487842917442322
loss_pred:0.017723863944411278, decouple_loss:0.0010113479802384973
Iteration: 408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490524232387543, gen p mean: -0.12277666479349136, mean p set: 0.4496292173862457
loss_pred:0.01696130633354187, decouple_loss:0.0014038669178262353
The modified gen p mean: 0.44790148735046387, gen p mean: -0.1219278946518898, mean p set: 0.4484792649745941
loss_pred:0.0178789421916008, decouple_loss:0.0008487605373375118
The modified gen p mean: 0.44765082001686096, gen p mean: -0.12172713130712509, mean p set: 0.4482274651527405
loss_pred:0.01849452592432499, decouple_loss:0.0009191249264404178
Iteration: 409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446374773979187, gen p mean: -0.11807499080896378, mean p set: 0.44695067405700684
loss_pred:0.018348943442106247, decouple_loss:0.0014280927134677768
The modified gen p mean: 0.44707557559013367, gen p mean: -0.12331829220056534, mean p set: 0.4476519823074341
The modified gen p mean: 0.4480513036251068, gen p mean: -0.11563887447118759, mean p set: 0.44862788915634155
loss_pred:0.01671317219734192, decouple_loss:0.0008134117815643549
loss_pred:0.016741828992962837, decouple_loss:0.0012940288288518786
Iteration: 410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446506530046463, gen p mean: -0.1251978576183319, mean p set: 0.44708430767059326
loss_pred:0.017488766461610794, decouple_loss:0.0010744398459792137
The modified gen p mean: 0.4492062032222748, gen p mean: -0.11700703948736191, mean p set: 0.4497813284397125
loss_pred:0.016381680965423584, decouple_loss:0.001376076485030353
The modified gen p mean: 0.44731688499450684, gen p mean: -0.12073422968387604, mean p set: 0.44789421558380127
loss_pred:0.01722748950123787, decouple_loss:0.0009971660329028964
2023-05-01 00:28:28 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12487704306840897, mean p set: 0.4502691626548767
loss_pred:0.017622681334614754, decouple_loss:0.0009234003373421729
The modified gen p mean: 0.44953471422195435, gen p mean: -0.11870940774679184, mean p set: 0.4500633478164673
loss_pred:0.01712914928793907, decouple_loss:0.0009314111666753888
The modified gen p mean: 0.4497816562652588, gen p mean: -0.11841505020856857, mean p set: 0.45035696029663086
loss_pred:0.017455724999308586, decouple_loss:0.000851949502248317
WV_1_PC_1_EH_0_PS_40, loss: 0.017447631806135178, avg_mse: 0.02711218036711216
current test mse: 0.027112
Iteration: 411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470338225364685, gen p mean: -0.11425591260194778, mean p set: 0.44761213660240173
loss_pred:0.017933707684278488, decouple_loss:0.0009248382993973792
The modified gen p mean: 0.44823116064071655, gen p mean: -0.11513368040323257, mean p set: 0.44880858063697815The modified gen p mean: 0.44681426882743835, gen p mean: -0.12165109813213348, mean p set: 0.4473898112773895
loss_pred:0.017399990931153297, decouple_loss:0.0008957245154306293
loss_pred:0.016922863200306892, decouple_loss:0.0008935975492931902
Iteration: 412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860267639160156, gen p mean: -0.12384945154190063, mean p set: 0.4491821527481079
loss_pred:0.016372838988900185, decouple_loss:0.0009373628417961299
The modified gen p mean: 0.44957295060157776, gen p mean: -0.1231498196721077, mean p set: 0.45015189051628113The modified gen p mean: 0.4484173357486725, gen p mean: -0.12789057195186615, mean p set: 0.44899317622184753
loss_pred:0.017056919634342194, decouple_loss:0.0007634588982909918
loss_pred:0.0167838167399168, decouple_loss:0.0010020440677180886
Iteration: 413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468928277492523, gen p mean: -0.12378522008657455, mean p set: 0.44746968150138855
loss_pred:0.017082909122109413, decouple_loss:0.0008160354336723685
The modified gen p mean: 0.4468149244785309, gen p mean: -0.12331532686948776, mean p set: 0.447390615940094The modified gen p mean: 0.4487043023109436, gen p mean: -0.12071719020605087, mean p set: 0.44927728176116943
loss_pred:0.01887740008533001, decouple_loss:0.0012447310145944357
loss_pred:0.016802828758955002, decouple_loss:0.0007929690182209015
Iteration: 414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740724563598633, gen p mean: -0.12282001972198486, mean p set: 0.4479839503765106
loss_pred:0.017560645937919617, decouple_loss:0.0010549260769039392
The modified gen p mean: 0.4477684199810028, gen p mean: -0.12553109228610992, mean p set: 0.44834980368614197
loss_pred:0.01856415905058384, decouple_loss:0.0008668827940709889
The modified gen p mean: 0.4490880072116852, gen p mean: -0.12745699286460876, mean p set: 0.4496642053127289
loss_pred:0.016532236710190773, decouple_loss:0.0009897979907691479
Iteration: 415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732266664505005, gen p mean: -0.1273835450410843, mean p set: 0.44789883494377136
loss_pred:0.017915699630975723, decouple_loss:0.0008836985798552632
The modified gen p mean: 0.44909149408340454, gen p mean: -0.12689203023910522, mean p set: 0.44966837763786316
loss_pred:0.017069358378648758, decouple_loss:0.0009313506307080388
The modified gen p mean: 0.4470345079898834, gen p mean: -0.12767496705055237, mean p set: 0.4476097822189331
loss_pred:0.01748236082494259, decouple_loss:0.0008895641658455133
Iteration: 416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476334750652313, gen p mean: -0.13061591982841492, mean p set: 0.44820842146873474
loss_pred:0.01718262955546379, decouple_loss:0.001264175632968545
The modified gen p mean: 0.4480191767215729, gen p mean: -0.12918561697006226, mean p set: 0.44859588146209717
loss_pred:0.01818079687654972, decouple_loss:0.0009548496454954147
The modified gen p mean: 0.44798514246940613, gen p mean: -0.12502288818359375, mean p set: 0.44855955243110657
loss_pred:0.017401142045855522, decouple_loss:0.0010427914094179869
Iteration: 417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906407594680786, gen p mean: -0.12095901370048523, mean p set: 0.44964075088500977
loss_pred:0.016512569040060043, decouple_loss:0.0009552933042868972
The modified gen p mean: 0.4480361044406891, gen p mean: -0.1292935013771057, mean p set: 0.44861429929733276
The modified gen p mean: 0.44722411036491394, gen p mean: -0.11938738077878952, mean p set: 0.44779905676841736
loss_pred:0.017188945785164833, decouple_loss:0.0009134763386100531
loss_pred:0.01749735325574875, decouple_loss:0.001129464595578611
Iteration: 418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492964446544647, gen p mean: -0.12098192423582077, mean p set: 0.4498717188835144
loss_pred:0.01697012037038803, decouple_loss:0.0014458748046308756
The modified gen p mean: 0.44725272059440613, gen p mean: -0.11984983086585999, mean p set: 0.4478277862071991
loss_pred:0.017925918102264404, decouple_loss:0.0009800712577998638
The modified gen p mean: 0.4482242166996002, gen p mean: -0.12065168470144272, mean p set: 0.44879916310310364
loss_pred:0.016988767310976982, decouple_loss:0.0012840944109484553
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485004246234894, gen p mean: -0.12116819620132446, mean p set: 0.44907623529434204
loss_pred:0.01669182814657688, decouple_loss:0.0011045974679291248
The modified gen p mean: 0.4468231797218323, gen p mean: -0.12051636725664139, mean p set: 0.4473998546600342
The modified gen p mean: 0.44729676842689514, gen p mean: -0.11479923129081726, mean p set: 0.44787678122520447
loss_pred:0.015659919008612633, decouple_loss:0.0009562366758473217
loss_pred:0.01641562581062317, decouple_loss:0.001488165115006268
Iteration: 420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467805325984955, gen p mean: -0.12330769002437592, mean p set: 0.4473566710948944
loss_pred:0.015820834785699844, decouple_loss:0.0009841484716162086
The modified gen p mean: 0.44593697786331177, gen p mean: -0.12018729001283646, mean p set: 0.44651132822036743
loss_pred:0.01668735221028328, decouple_loss:0.0012825787998735905
The modified gen p mean: 0.4480120539665222, gen p mean: -0.12606357038021088, mean p set: 0.44858697056770325
loss_pred:0.01599603332579136, decouple_loss:0.0008204125915654004
2023-05-01 00:31:15 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1313602328300476, mean p set: 0.4502691626548767
loss_pred:0.01761743798851967, decouple_loss:0.0008894686470739543
The modified gen p mean: 0.4495351314544678, gen p mean: -0.1255732625722885, mean p set: 0.4500633478164673
loss_pred:0.017125578597187996, decouple_loss:0.0011368024861440063
The modified gen p mean: 0.44978222250938416, gen p mean: -0.12495723366737366, mean p set: 0.45035696029663086
loss_pred:0.017483675852417946, decouple_loss:0.0011636220151558518
WV_1_PC_1_EH_0_PS_40, loss: 0.01746206358075142, avg_mse: 0.027080833911895752
current test mse: 0.027081
Iteration: 421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787219166755676, gen p mean: -0.13066276907920837, mean p set: 0.4484470784664154
loss_pred:0.016138283535838127, decouple_loss:0.0008838475914672017
The modified gen p mean: 0.44725191593170166, gen p mean: -0.12906937301158905, mean p set: 0.4478280544281006The modified gen p mean: 0.4462292492389679, gen p mean: -0.12670660018920898, mean p set: 0.44680535793304443
loss_pred:0.015947457402944565, decouple_loss:0.0008691714028827846
loss_pred:0.0155732287093997, decouple_loss:0.0009356304071843624
Iteration: 422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737350940704346, gen p mean: -0.13358533382415771, mean p set: 0.447951078414917
The modified gen p mean: 0.4463830888271332, gen p mean: -0.12740863859653473, mean p set: 0.44695523381233215
loss_pred:0.015339729376137257, decouple_loss:0.0008058326784521341
loss_pred:0.015777550637722015, decouple_loss:0.001079324632883072
The modified gen p mean: 0.44750547409057617, gen p mean: -0.1300664097070694, mean p set: 0.44808098673820496
loss_pred:0.01618223823606968, decouple_loss:0.0008550379425287247
Iteration: 423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467306137084961, gen p mean: -0.13300950825214386, mean p set: 0.4473038911819458
loss_pred:0.01593835838139057, decouple_loss:0.0007441330817528069
The modified gen p mean: 0.44658467173576355, gen p mean: -0.13142859935760498, mean p set: 0.44715940952301025
loss_pred:0.016139782965183258, decouple_loss:0.0007352960528805852
The modified gen p mean: 0.44567883014678955, gen p mean: -0.1273864507675171, mean p set: 0.44625577330589294
loss_pred:0.01593426801264286, decouple_loss:0.0008260670001618564
Iteration: 424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461739659309387, gen p mean: -0.13055473566055298, mean p set: 0.44675159454345703
loss_pred:0.01575450785458088, decouple_loss:0.0008623076719231904
The modified gen p mean: 0.44820138812065125, gen p mean: -0.13320642709732056, mean p set: 0.4487825632095337
loss_pred:0.01585806906223297, decouple_loss:0.0009509174269624054
The modified gen p mean: 0.4473515748977661, gen p mean: -0.13286320865154266, mean p set: 0.4479255974292755
loss_pred:0.016126291826367378, decouple_loss:0.000989746768027544
Iteration: 425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472503066062927, gen p mean: -0.12595807015895844, mean p set: 0.44782623648643494
loss_pred:0.015366464853286743, decouple_loss:0.0008682849002070725
The modified gen p mean: 0.4465957581996918, gen p mean: -0.13165147602558136, mean p set: 0.4471711814403534
loss_pred:0.01559426635503769, decouple_loss:0.0008964464068412781
The modified gen p mean: 0.4451659619808197, gen p mean: -0.13412073254585266, mean p set: 0.44573795795440674
loss_pred:0.01568451151251793, decouple_loss:0.000920016027521342
Iteration: 426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463721513748169, gen p mean: -0.1259310394525528, mean p set: 0.44694921374320984
loss_pred:0.015790078788995743, decouple_loss:0.0009254493634216487
The modified gen p mean: 0.4462074041366577, gen p mean: -0.12580017745494843, mean p set: 0.4467838406562805
loss_pred:0.015259774401783943, decouple_loss:0.0008202046738006175
The modified gen p mean: 0.44716790318489075, gen p mean: -0.129817932844162, mean p set: 0.4477439522743225
loss_pred:0.01533221174031496, decouple_loss:0.0010391769465059042
Iteration: 427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445730984210968, gen p mean: -0.11909584701061249, mean p set: 0.44630685448646545
loss_pred:0.016034891828894615, decouple_loss:0.0008872739272192121
The modified gen p mean: 0.4463161826133728, gen p mean: -0.12215036898851395, mean p set: 0.44689324498176575
loss_pred:0.01614530012011528, decouple_loss:0.000916726072318852
The modified gen p mean: 0.4471188187599182, gen p mean: -0.12073156237602234, mean p set: 0.4476941227912903
loss_pred:0.015894753858447075, decouple_loss:0.0009518827428109944
Iteration: 428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447715163230896, gen p mean: -0.12086685001850128, mean p set: 0.4482913017272949
loss_pred:0.015345907770097256, decouple_loss:0.0011222099419683218
The modified gen p mean: 0.4466175138950348, gen p mean: -0.11738840490579605, mean p set: 0.4471926689147949
The modified gen p mean: 0.4451964795589447, gen p mean: -0.1251051276922226, mean p set: 0.4457697868347168
loss_pred:0.015762638300657272, decouple_loss:0.0007588610169477761
loss_pred:0.015895862132310867, decouple_loss:0.0009571777773089707
Iteration: 429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44610926508903503, gen p mean: -0.11918926984071732, mean p set: 0.44668781757354736
loss_pred:0.01622648723423481, decouple_loss:0.0007469166303053498
The modified gen p mean: 0.44600212574005127, gen p mean: -0.11849860846996307, mean p set: 0.4465752840042114
loss_pred:0.015820350497961044, decouple_loss:0.0008829571888782084
The modified gen p mean: 0.44605228304862976, gen p mean: -0.1155318170785904, mean p set: 0.4466271698474884
loss_pred:0.015386381186544895, decouple_loss:0.0007523479289375246
Iteration: 430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458960294723511, gen p mean: -0.11619964241981506, mean p set: 0.44647401571273804
loss_pred:0.015699930489063263, decouple_loss:0.0010166183346882463
The modified gen p mean: 0.4487423896789551, gen p mean: -0.12374325841665268, mean p set: 0.44931700825691223
The modified gen p mean: 0.4487626552581787, gen p mean: -0.1235714927315712, mean p set: 0.44933852553367615
loss_pred:0.01539094652980566, decouple_loss:0.0008832896128296852
loss_pred:0.01578010804951191, decouple_loss:0.0009244347456842661
2023-05-01 00:33:22 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1229628175497055, mean p set: 0.4502691626548767
loss_pred:0.017491210252046585, decouple_loss:0.0008174355025403202
The modified gen p mean: 0.4495346248149872, gen p mean: -0.11784294247627258, mean p set: 0.4500633478164673
loss_pred:0.01702038384974003, decouple_loss:0.0009723224793560803
The modified gen p mean: 0.4497791528701782, gen p mean: -0.11714313924312592, mean p set: 0.45035696029663086
loss_pred:0.017422469332814217, decouple_loss:0.0011168350465595722
WV_1_PC_1_EH_0_PS_40, loss: 0.017359798774123192, avg_mse: 0.02694339118897915
current test mse: 0.026943
Iteration: 431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455808401107788, gen p mean: -0.1275063157081604, mean p set: 0.4461599588394165
loss_pred:0.01595703326165676, decouple_loss:0.0008240278693847358
The modified gen p mean: 0.44810548424720764, gen p mean: -0.12130460888147354, mean p set: 0.44868341088294983The modified gen p mean: 0.44583752751350403, gen p mean: -0.11698881536722183, mean p set: 0.4464118480682373
loss_pred:0.015452333725988865, decouple_loss:0.0009514456032775342
loss_pred:0.016007566824555397, decouple_loss:0.0007730140932835639
Iteration: 432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807708263397217, gen p mean: -0.1218770369887352, mean p set: 0.44865259528160095
loss_pred:0.01510084979236126, decouple_loss:0.0010134187759831548
The modified gen p mean: 0.44558951258659363, gen p mean: -0.1268855780363083, mean p set: 0.4461652636528015The modified gen p mean: 0.44869911670684814, gen p mean: -0.12187284976243973, mean p set: 0.44927704334259033
loss_pred:0.015685761347413063, decouple_loss:0.0008928487077355385
loss_pred:0.01551043801009655, decouple_loss:0.0008744872757233679
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457302391529083, gen p mean: -0.12091270089149475, mean p set: 0.44630563259124756
loss_pred:0.015158281661570072, decouple_loss:0.0008437708020210266
The modified gen p mean: 0.4473629295825958, gen p mean: -0.1272517591714859, mean p set: 0.44794052839279175
loss_pred:0.015166760422289371, decouple_loss:0.0008903475245460868
The modified gen p mean: 0.4466697573661804, gen p mean: -0.11812949180603027, mean p set: 0.447246253490448
loss_pred:0.014996019192039967, decouple_loss:0.0008481698459945619
Iteration: 434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484771490097046, gen p mean: -0.1251518577337265, mean p set: 0.4490543007850647
loss_pred:0.0155623285099864, decouple_loss:0.001205262029543519
The modified gen p mean: 0.44742056727409363, gen p mean: -0.1278664469718933, mean p set: 0.44799599051475525
loss_pred:0.014722281135618687, decouple_loss:0.0008922999841161072
The modified gen p mean: 0.44679155945777893, gen p mean: -0.12516705691814423, mean p set: 0.4473665952682495
loss_pred:0.015499679371714592, decouple_loss:0.0008307381067425013
Iteration: 435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480837285518646, gen p mean: -0.1262197345495224, mean p set: 0.4486584961414337
loss_pred:0.015152527950704098, decouple_loss:0.0009434905950911343
The modified gen p mean: 0.44749730825424194, gen p mean: -0.12451912462711334, mean p set: 0.448073148727417
loss_pred:0.01546272449195385, decouple_loss:0.001113011734560132
The modified gen p mean: 0.44654592871665955, gen p mean: -0.12379615753889084, mean p set: 0.44712045788764954
loss_pred:0.015272795222699642, decouple_loss:0.0008278829045593739
Iteration: 436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466813802719116, gen p mean: -0.125071719288826, mean p set: 0.44725558161735535
loss_pred:0.01543387584388256, decouple_loss:0.0009347586892545223
The modified gen p mean: 0.44635167717933655, gen p mean: -0.12459955364465714, mean p set: 0.4469289183616638
loss_pred:0.015224826522171497, decouple_loss:0.0010330893564969301
The modified gen p mean: 0.4469519555568695, gen p mean: -0.12735745310783386, mean p set: 0.44752782583236694
loss_pred:0.015636015683412552, decouple_loss:0.0009501741151325405
Iteration: 437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44895344972610474, gen p mean: -0.12742845714092255, mean p set: 0.44952791929244995
loss_pred:0.015031801536679268, decouple_loss:0.001043315278366208
The modified gen p mean: 0.44616350531578064, gen p mean: -0.12140065431594849, mean p set: 0.4467402696609497
loss_pred:0.015992702916264534, decouple_loss:0.0008861509268172085
The modified gen p mean: 0.44615963101387024, gen p mean: -0.12549668550491333, mean p set: 0.44673389196395874
loss_pred:0.015034317038953304, decouple_loss:0.000939586665481329
Iteration: 438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791340827941895, gen p mean: -0.12886160612106323, mean p set: 0.448486864566803
loss_pred:0.015487889759242535, decouple_loss:0.0009898293064907193
The modified gen p mean: 0.44652503728866577, gen p mean: -0.12988924980163574, mean p set: 0.4471011161804199
The modified gen p mean: 0.44723355770111084, gen p mean: -0.13165515661239624, mean p set: 0.4478095471858978
loss_pred:0.015788983553647995, decouple_loss:0.0011890876339748502
loss_pred:0.015269393101334572, decouple_loss:0.0010335393017157912
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
NaN value num: 0
Iteration: 439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519428312778473, gen p mean: -0.1171584203839302, mean p set: 0.4525179862976074
loss_pred:0.016530483961105347, decouple_loss:0.0022227000445127487
The modified gen p mean: 0.4523256719112396, gen p mean: -0.12005391716957092, mean p set: 0.4529043138027191
The modified gen p mean: 0.4511100649833679, gen p mean: -0.12480282783508301, mean p set: 0.4516848623752594
loss_pred:0.017579784616827965, decouple_loss:0.002232831669971347
loss_pred:0.01789117231965065, decouple_loss:0.0018480190774425864
Iteration: 440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525541067123413, gen p mean: -0.11413959413766861, mean p set: 0.4531313478946686
loss_pred:0.01758173480629921, decouple_loss:0.0014178479323163629
The modified gen p mean: 0.4525831639766693, gen p mean: -0.12465357780456543, mean p set: 0.4531596302986145
loss_pred:0.017266076058149338, decouple_loss:0.0012281358940526843
The modified gen p mean: 0.4514051675796509, gen p mean: -0.11971794813871384, mean p set: 0.45198309421539307
loss_pred:0.01831117272377014, decouple_loss:0.001392783597111702
2023-05-01 00:36:09 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11996851861476898, mean p set: 0.4502691626548767
loss_pred:0.01752995327115059, decouple_loss:0.001353474915958941
The modified gen p mean: 0.4495380222797394, gen p mean: -0.11395101249217987, mean p set: 0.4500633478164673
loss_pred:0.016863375902175903, decouple_loss:0.0013853393029421568
The modified gen p mean: 0.4497809112071991, gen p mean: -0.11349932104349136, mean p set: 0.45035696029663086
loss_pred:0.017194485291838646, decouple_loss:0.001450996263884008
WV_1_PC_1_EH_0_PS_40, loss: 0.017265770584344864, avg_mse: 0.026773082092404366
current test mse: 0.026773
Iteration: 441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502623677253723, gen p mean: -0.10517794638872147, mean p set: 0.4508371949195862
loss_pred:0.01744666136801243, decouple_loss:0.001411215984262526
The modified gen p mean: 0.45231613516807556, gen p mean: -0.10541325807571411, mean p set: 0.4528920352458954The modified gen p mean: 0.4531628489494324, gen p mean: -0.10746408998966217, mean p set: 0.453741192817688
loss_pred:0.017452623695135117, decouple_loss:0.0014121170388534665
loss_pred:0.01719786413013935, decouple_loss:0.001491480739787221
Iteration: 442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532889127731323, gen p mean: -0.10015023499727249, mean p set: 0.45386558771133423
loss_pred:0.01671212911605835, decouple_loss:0.001667807693593204
The modified gen p mean: 0.4524874687194824, gen p mean: -0.09661933779716492, mean p set: 0.45306316018104553The modified gen p mean: 0.4505668878555298, gen p mean: -0.0976104736328125, mean p set: 0.45114362239837646
loss_pred:0.01709211803972721, decouple_loss:0.0016508761327713728
loss_pred:0.016534779220819473, decouple_loss:0.001643451047129929
Iteration: 443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518377184867859, gen p mean: -0.09525129199028015, mean p set: 0.45241400599479675
loss_pred:0.017028963193297386, decouple_loss:0.0009723810944706202
The modified gen p mean: 0.4532873332500458, gen p mean: -0.09985041618347168, mean p set: 0.4538623094558716
The modified gen p mean: 0.4505384564399719, gen p mean: -0.09660323709249496, mean p set: 0.451114296913147
loss_pred:0.017385268583893776, decouple_loss:0.0009567819652147591
loss_pred:0.0173353124409914, decouple_loss:0.001035017310641706
Iteration: 444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514550268650055, gen p mean: -0.09754335135221481, mean p set: 0.45203232765197754
loss_pred:0.017482904717326164, decouple_loss:0.0016103649977594614
The modified gen p mean: 0.4513031244277954, gen p mean: -0.10288247466087341, mean p set: 0.4518786072731018
loss_pred:0.01796559989452362, decouple_loss:0.0010512166190892458
The modified gen p mean: 0.45194709300994873, gen p mean: -0.10406281054019928, mean p set: 0.4525260329246521
loss_pred:0.017584562301635742, decouple_loss:0.0010049708653241396
Iteration: 445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522673487663269, gen p mean: -0.10589345544576645, mean p set: 0.4528461992740631
loss_pred:0.0168153028935194, decouple_loss:0.0021510242950171232
The modified gen p mean: 0.4533537030220032, gen p mean: -0.11161070317029953, mean p set: 0.45393162965774536
loss_pred:0.017705140635371208, decouple_loss:0.0018973980331793427
The modified gen p mean: 0.45205041766166687, gen p mean: -0.10618452727794647, mean p set: 0.4526279866695404
loss_pred:0.017484482377767563, decouple_loss:0.0014152453513816
Iteration: 446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45115306973457336, gen p mean: -0.11128496378660202, mean p set: 0.45172953605651855
loss_pred:0.016983311623334885, decouple_loss:0.0011784817324951291
The modified gen p mean: 0.45139357447624207, gen p mean: -0.11837248504161835, mean p set: 0.4519711136817932
loss_pred:0.018035441637039185, decouple_loss:0.0013786274939775467
The modified gen p mean: 0.4525207281112671, gen p mean: -0.12145444750785828, mean p set: 0.4530986547470093
loss_pred:0.017264366149902344, decouple_loss:0.0011881607351824641
Iteration: 447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512428045272827, gen p mean: -0.11144044995307922, mean p set: 0.45181983709335327
loss_pred:0.01812095008790493, decouple_loss:0.00241130986250937
The modified gen p mean: 0.45092642307281494, gen p mean: -0.10804707556962967, mean p set: 0.45150119066238403
loss_pred:0.017579983919858932, decouple_loss:0.0013694060035049915
The modified gen p mean: 0.4508735239505768, gen p mean: -0.10740981996059418, mean p set: 0.45145025849342346
loss_pred:0.01794285513460636, decouple_loss:0.0010732217924669385
Iteration: 448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45199844241142273, gen p mean: -0.11905398219823837, mean p set: 0.452574759721756
loss_pred:0.01817391999065876, decouple_loss:0.0014428150607272983
The modified gen p mean: 0.4506470859050751, gen p mean: -0.11978711932897568, mean p set: 0.4512217342853546
loss_pred:0.0174859631806612, decouple_loss:0.001053201500326395
The modified gen p mean: 0.4521087110042572, gen p mean: -0.12088268995285034, mean p set: 0.4526858329772949
loss_pred:0.01724448800086975, decouple_loss:0.0013362700119614601
Iteration: 449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114290714263916, gen p mean: -0.11490155756473541, mean p set: 0.45171958208084106
loss_pred:0.017261652275919914, decouple_loss:0.0010494885500520468
The modified gen p mean: 0.452606737613678, gen p mean: -0.12517260015010834, mean p set: 0.4531821608543396
loss_pred:0.018169552087783813, decouple_loss:0.0010381765896454453
The modified gen p mean: 0.45170652866363525, gen p mean: -0.11606934666633606, mean p set: 0.45228642225265503
loss_pred:0.0174376480281353, decouple_loss:0.0009779458632692695
Iteration: 450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520697295665741, gen p mean: -0.11293218284845352, mean p set: 0.4526466727256775
loss_pred:0.017747586593031883, decouple_loss:0.0010184518760070205
The modified gen p mean: 0.4517127275466919, gen p mean: -0.11515093594789505, mean p set: 0.45228806138038635
loss_pred:0.01734931208193302, decouple_loss:0.001720538712106645
The modified gen p mean: 0.4514161944389343, gen p mean: -0.11470066756010056, mean p set: 0.4519937038421631
loss_pred:0.01724446378648281, decouple_loss:0.0010902759386226535
2023-05-01 00:38:16 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11374928057193756, mean p set: 0.4502691626548767
loss_pred:0.018078716471791267, decouple_loss:0.0013299238635227084
The modified gen p mean: 0.4495352506637573, gen p mean: -0.10784918069839478, mean p set: 0.4500633478164673
loss_pred:0.01728181354701519, decouple_loss:0.0014936490915715694
The modified gen p mean: 0.4497811198234558, gen p mean: -0.10693615674972534, mean p set: 0.45035696029663086
loss_pred:0.017633209004998207, decouple_loss:0.0011937001254409552
WV_1_PC_1_EH_0_PS_40, loss: 0.01773153431713581, avg_mse: 0.027362190186977386
current test mse: 0.027362
Iteration: 451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518298804759979, gen p mean: -0.10008585453033447, mean p set: 0.45240697264671326
loss_pred:0.016511784866452217, decouple_loss:0.0012281148228794336
The modified gen p mean: 0.45177167654037476, gen p mean: -0.10543471574783325, mean p set: 0.4523479640483856The modified gen p mean: 0.4511799216270447, gen p mean: -0.1044837236404419, mean p set: 0.4517561197280884
loss_pred:0.01663503237068653, decouple_loss:0.0009988065576180816
loss_pred:0.017196232452988625, decouple_loss:0.001097282045520842
Iteration: 452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45182108879089355, gen p mean: -0.10604531317949295, mean p set: 0.4523969888687134
loss_pred:0.0174120906740427, decouple_loss:0.0017321208724752069
The modified gen p mean: 0.4532019793987274, gen p mean: -0.11202143132686615, mean p set: 0.453777015209198The modified gen p mean: 0.4534471035003662, gen p mean: -0.09970539063215256, mean p set: 0.4540221691131592
loss_pred:0.017321260645985603, decouple_loss:0.001872930210083723
loss_pred:0.016345597803592682, decouple_loss:0.001335522742010653
Iteration: 453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523208737373352, gen p mean: -0.107505664229393, mean p set: 0.45289722084999084
loss_pred:0.0166131854057312, decouple_loss:0.001156533369794488
The modified gen p mean: 0.4516372084617615, gen p mean: -0.11196479201316833, mean p set: 0.45221495628356934The modified gen p mean: 0.4534541666507721, gen p mean: -0.10768955945968628, mean p set: 0.45403215289115906
loss_pred:0.01738988794386387, decouple_loss:0.0010576746426522732
loss_pred:0.01707085780799389, decouple_loss:0.0010650005424395204
Iteration: 454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45206668972969055, gen p mean: -0.1144867092370987, mean p set: 0.4526461064815521
loss_pred:0.017373627051711082, decouple_loss:0.001367646618746221
The modified gen p mean: 0.4526154696941376, gen p mean: -0.11049241572618484, mean p set: 0.4531908929347992
loss_pred:0.01664731837809086, decouple_loss:0.0011033340124413371
The modified gen p mean: 0.45314455032348633, gen p mean: -0.11973477154970169, mean p set: 0.4537212550640106
loss_pred:0.01743760146200657, decouple_loss:0.001370993792079389
Iteration: 455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45076990127563477, gen p mean: -0.11748877912759781, mean p set: 0.4513482451438904
loss_pred:0.017787234857678413, decouple_loss:0.0014625969342887402
The modified gen p mean: 0.4519895315170288, gen p mean: -0.11528737097978592, mean p set: 0.45256444811820984
loss_pred:0.01703902892768383, decouple_loss:0.0012204000959172845
The modified gen p mean: 0.45164042711257935, gen p mean: -0.11453433334827423, mean p set: 0.4522169232368469
loss_pred:0.01788993738591671, decouple_loss:0.0012450148351490498
Iteration: 456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082202553749084, gen p mean: -0.11537302285432816, mean p set: 0.4513972997665405
loss_pred:0.017649982124567032, decouple_loss:0.0018074973486363888
The modified gen p mean: 0.45059430599212646, gen p mean: -0.11350882798433304, mean p set: 0.4511723518371582
The modified gen p mean: 0.45300740003585815, gen p mean: -0.11235138028860092, mean p set: 0.45358291268348694
loss_pred:0.017048845067620277, decouple_loss:0.001430419273674488
loss_pred:0.0167001374065876, decouple_loss:0.001910122111439705
Iteration: 457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530445635318756, gen p mean: -0.11600004881620407, mean p set: 0.45362168550491333
loss_pred:0.01665387488901615, decouple_loss:0.0012848024489358068
The modified gen p mean: 0.4517807066440582, gen p mean: -0.11255885660648346, mean p set: 0.452355295419693
The modified gen p mean: 0.4522950351238251, gen p mean: -0.12019899487495422, mean p set: 0.45287367701530457
loss_pred:0.016932539641857147, decouple_loss:0.0012714398326352239
loss_pred:0.017007825896143913, decouple_loss:0.0011577594559639692
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
NaN value num: 0
Iteration: 458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747087359428406, gen p mean: -0.12597405910491943, mean p set: 0.4480479061603546
loss_pred:0.017273567616939545, decouple_loss:0.0014470168389379978
The modified gen p mean: 0.4500071406364441, gen p mean: -0.1257314383983612, mean p set: 0.4505856931209564
The modified gen p mean: 0.4515940248966217, gen p mean: -0.13143783807754517, mean p set: 0.45216912031173706
loss_pred:0.017077703028917313, decouple_loss:0.001102886744774878
loss_pred:0.017354117706418037, decouple_loss:0.0014106114394962788
Iteration: 459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496214687824249, gen p mean: -0.13685815036296844, mean p set: 0.4502002000808716
loss_pred:0.016730353236198425, decouple_loss:0.001084763091057539
The modified gen p mean: 0.4490392804145813, gen p mean: -0.1358894556760788, mean p set: 0.44961604475975037
loss_pred:0.01679328829050064, decouple_loss:0.0011398086789995432
The modified gen p mean: 0.4515305757522583, gen p mean: -0.14346559345722198, mean p set: 0.4521084129810333
loss_pred:0.017413407564163208, decouple_loss:0.0011525022564455867
Iteration: 460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521850645542145, gen p mean: -0.12793223559856415, mean p set: 0.4527588486671448
loss_pred:0.0164380744099617, decouple_loss:0.0012877960689365864
The modified gen p mean: 0.44950830936431885, gen p mean: -0.1190127283334732, mean p set: 0.4500843286514282
loss_pred:0.01741466298699379, decouple_loss:0.0010394519194960594
The modified gen p mean: 0.4514554738998413, gen p mean: -0.12278397381305695, mean p set: 0.4520305097103119
loss_pred:0.016122842207551003, decouple_loss:0.0010646176524460316
2023-05-01 00:41:11 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12447439134120941, mean p set: 0.4502691626548767
loss_pred:0.018088970333337784, decouple_loss:0.0012919813161715865
The modified gen p mean: 0.4495362639427185, gen p mean: -0.11837811768054962, mean p set: 0.4500633478164673
loss_pred:0.017350345849990845, decouple_loss:0.0011741179041564465
The modified gen p mean: 0.44978079199790955, gen p mean: -0.1172698587179184, mean p set: 0.45035696029663086
loss_pred:0.01764167845249176, decouple_loss:0.0012766903964802623
WV_1_PC_1_EH_0_PS_40, loss: 0.01775604486465454, avg_mse: 0.027248362079262733
current test mse: 0.027248
Iteration: 461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514351189136505, gen p mean: -0.11796223372220993, mean p set: 0.4520123302936554
loss_pred:0.016409270465373993, decouple_loss:0.001223728060722351
The modified gen p mean: 0.44906455278396606, gen p mean: -0.10958501696586609, mean p set: 0.4496413469314575
loss_pred:0.01752505451440811, decouple_loss:0.001066251890733838
The modified gen p mean: 0.4486059248447418, gen p mean: -0.11468883603811264, mean p set: 0.4491817057132721
loss_pred:0.01603878103196621, decouple_loss:0.0011844426626339555
Iteration: 462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504500925540924, gen p mean: -0.11869592219591141, mean p set: 0.45102187991142273
loss_pred:0.01695285178720951, decouple_loss:0.0012706124689429998
The modified gen p mean: 0.44990479946136475, gen p mean: -0.11708875745534897, mean p set: 0.45047977566719055The modified gen p mean: 0.44919681549072266, gen p mean: -0.11374212801456451, mean p set: 0.44977399706840515
loss_pred:0.016398873180150986, decouple_loss:0.0011402626987546682
loss_pred:0.017175503075122833, decouple_loss:0.0010935525642707944
Iteration: 463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777119159698486, gen p mean: -0.1170286014676094, mean p set: 0.4483462870121002
loss_pred:0.016448084264993668, decouple_loss:0.001110351993702352
The modified gen p mean: 0.4476888179779053, gen p mean: -0.11593583971261978, mean p set: 0.44826605916023254
loss_pred:0.01754201203584671, decouple_loss:0.0010013955179601908
The modified gen p mean: 0.44748371839523315, gen p mean: -0.1206868514418602, mean p set: 0.44805923104286194
loss_pred:0.01674736849963665, decouple_loss:0.0013964463723823428
Iteration: 464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485626816749573, gen p mean: -0.11023829132318497, mean p set: 0.449136883020401
loss_pred:0.017527911812067032, decouple_loss:0.0013126214034855366
The modified gen p mean: 0.4507586359977722, gen p mean: -0.11641103029251099, mean p set: 0.45133325457572937
loss_pred:0.017593886703252792, decouple_loss:0.0015653215814381838
The modified gen p mean: 0.44933536648750305, gen p mean: -0.11564746499061584, mean p set: 0.44991356134414673
loss_pred:0.017166033387184143, decouple_loss:0.0017044501146301627
Iteration: 465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495941400527954, gen p mean: -0.10979188233613968, mean p set: 0.45017069578170776
loss_pred:0.016755593940615654, decouple_loss:0.0015163427451625466
The modified gen p mean: 0.45208442211151123, gen p mean: -0.12186763435602188, mean p set: 0.4526605010032654
loss_pred:0.016180438920855522, decouple_loss:0.0013252956559881568
The modified gen p mean: 0.4501129984855652, gen p mean: -0.11407550424337387, mean p set: 0.4506881833076477
loss_pred:0.016606487333774567, decouple_loss:0.0010966560803353786
Iteration: 466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449175626039505, gen p mean: -0.11974267661571503, mean p set: 0.4497537314891815
loss_pred:0.01630498841404915, decouple_loss:0.0010024335933849216
The modified gen p mean: 0.448513001203537, gen p mean: -0.11361745744943619, mean p set: 0.44909143447875977
loss_pred:0.01710941269993782, decouple_loss:0.0010043708607554436
The modified gen p mean: 0.4471823573112488, gen p mean: -0.11487439274787903, mean p set: 0.44775813817977905
loss_pred:0.016539134085178375, decouple_loss:0.0012615665327757597
Iteration: 467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44985800981521606, gen p mean: -0.11650161445140839, mean p set: 0.4504333436489105
loss_pred:0.01622076705098152, decouple_loss:0.0013988936552777886
The modified gen p mean: 0.4471547603607178, gen p mean: -0.12034237384796143, mean p set: 0.44773074984550476
The modified gen p mean: 0.4496797025203705, gen p mean: -0.12773311138153076, mean p set: 0.45025739073753357
loss_pred:0.01679675281047821, decouple_loss:0.0010108689311891794
loss_pred:0.017979754135012627, decouple_loss:0.0013055471936240792
Iteration: 468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472448229789734, gen p mean: -0.12547892332077026, mean p set: 0.4478166699409485
The modified gen p mean: 0.4479821026325226, gen p mean: -0.11805291473865509, mean p set: 0.44855889678001404
loss_pred:0.01712898537516594, decouple_loss:0.0009693342726677656
loss_pred:0.016180453822016716, decouple_loss:0.0009646542021073401
The modified gen p mean: 0.44831717014312744, gen p mean: -0.1154550239443779, mean p set: 0.44889137148857117
loss_pred:0.017396433278918266, decouple_loss:0.0010207847226411104
Iteration: 469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45118823647499084, gen p mean: -0.12044686079025269, mean p set: 0.45176324248313904
The modified gen p mean: 0.44825536012649536, gen p mean: -0.11220550537109375, mean p set: 0.44883257150650024
loss_pred:0.015482835471630096, decouple_loss:0.0011247644433751702
loss_pred:0.015873834490776062, decouple_loss:0.0012464289320632815
The modified gen p mean: 0.45127570629119873, gen p mean: -0.11514928191900253, mean p set: 0.45185160636901855
loss_pred:0.01754949614405632, decouple_loss:0.0013917750911787152
Iteration: 470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738155603408813, gen p mean: -0.12039326131343842, mean p set: 0.44795873761177063
The modified gen p mean: 0.44986647367477417, gen p mean: -0.11875782161951065, mean p set: 0.4504449665546417
loss_pred:0.01706162840127945, decouple_loss:0.0012678263010457158
loss_pred:0.017139937728643417, decouple_loss:0.0010387819493189454
The modified gen p mean: 0.4499884843826294, gen p mean: -0.11314152181148529, mean p set: 0.4505615830421448
loss_pred:0.016554882749915123, decouple_loss:0.001099980203434825
2023-05-01 00:43:19 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12417976558208466, mean p set: 0.4502691626548767
loss_pred:0.017798537388443947, decouple_loss:0.0009986255317926407
The modified gen p mean: 0.4495353400707245, gen p mean: -0.11881403625011444, mean p set: 0.4500633478164673
loss_pred:0.017159679904580116, decouple_loss:0.0012073987163603306
The modified gen p mean: 0.4497818052768707, gen p mean: -0.11779053509235382, mean p set: 0.45035696029663086
loss_pred:0.017419181764125824, decouple_loss:0.001135455910116434
WV_1_PC_1_EH_0_PS_40, loss: 0.017514824867248535, avg_mse: 0.02707178331911564
current test mse: 0.027072
Iteration: 471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486425518989563, gen p mean: -0.1145716980099678, mean p set: 0.44921693205833435
loss_pred:0.01694188266992569, decouple_loss:0.0014055176870897412
The modified gen p mean: 0.4512738585472107, gen p mean: -0.12007122486829758, mean p set: 0.4518480598926544
loss_pred:0.015255735255777836, decouple_loss:0.0012275063199922442
The modified gen p mean: 0.4486537277698517, gen p mean: -0.11186115443706512, mean p set: 0.4492295980453491
loss_pred:0.016699189320206642, decouple_loss:0.0015450665960088372
Iteration: 472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474565386772156, gen p mean: -0.11624850332736969, mean p set: 0.44803333282470703
loss_pred:0.015965625643730164, decouple_loss:0.001060612965375185
The modified gen p mean: 0.44720810651779175, gen p mean: -0.12182319909334183, mean p set: 0.44778314232826233The modified gen p mean: 0.4503120183944702, gen p mean: -0.12340327352285385, mean p set: 0.4508877694606781
loss_pred:0.017551051452755928, decouple_loss:0.0011240385938435793
loss_pred:0.017203696072101593, decouple_loss:0.0013558296486735344
Iteration: 473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973134994506836, gen p mean: -0.11618071049451828, mean p set: 0.4503127932548523
loss_pred:0.01595347933471203, decouple_loss:0.001069153775461018
The modified gen p mean: 0.44802799820899963, gen p mean: -0.11593454331159592, mean p set: 0.4486050307750702The modified gen p mean: 0.44919121265411377, gen p mean: -0.11645284295082092, mean p set: 0.44976580142974854
loss_pred:0.01676362007856369, decouple_loss:0.0011148395715281367
loss_pred:0.01705438457429409, decouple_loss:0.0009816751116886735
Iteration: 474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45055851340293884, gen p mean: -0.11168225854635239, mean p set: 0.45113611221313477
loss_pred:0.017416680231690407, decouple_loss:0.0009845965541899204
The modified gen p mean: 0.44999608397483826, gen p mean: -0.112738236784935, mean p set: 0.45057329535484314
loss_pred:0.01707966811954975, decouple_loss:0.00102582189720124
The modified gen p mean: 0.45126524567604065, gen p mean: -0.11929687112569809, mean p set: 0.45184415578842163
loss_pred:0.01600361429154873, decouple_loss:0.001012385473586619
Iteration: 475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501626789569855, gen p mean: -0.11121781170368195, mean p set: 0.45073726773262024
loss_pred:0.01674404926598072, decouple_loss:0.0012374952202662826
The modified gen p mean: 0.4470871090888977, gen p mean: -0.11434778571128845, mean p set: 0.4476604163646698
loss_pred:0.017213553190231323, decouple_loss:0.0015311326133087277
The modified gen p mean: 0.45012426376342773, gen p mean: -0.11634042114019394, mean p set: 0.45069968700408936
loss_pred:0.015781132504343987, decouple_loss:0.0011441416572779417
Iteration: 476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509594440460205, gen p mean: -0.10614684969186783, mean p set: 0.451536625623703
loss_pred:0.016666345298290253, decouple_loss:0.001169798313640058
The modified gen p mean: 0.4499841034412384, gen p mean: -0.1162024587392807, mean p set: 0.45056405663490295
loss_pred:0.016847603023052216, decouple_loss:0.0016732681542634964
The modified gen p mean: 0.44827908277511597, gen p mean: -0.11502546817064285, mean p set: 0.44885390996932983
loss_pred:0.015632828697562218, decouple_loss:0.001313326065428555
Iteration: 477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490484893321991, gen p mean: -0.10883666574954987, mean p set: 0.44962644577026367
loss_pred:0.016528025269508362, decouple_loss:0.0007414656574837863
The modified gen p mean: 0.44947054982185364, gen p mean: -0.1136028915643692, mean p set: 0.4500448405742645
loss_pred:0.016650794073939323, decouple_loss:0.0010005682706832886
The modified gen p mean: 0.448115736246109, gen p mean: -0.10828297585248947, mean p set: 0.44869256019592285
loss_pred:0.01605316251516342, decouple_loss:0.0010248339967802167
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
NaN value num: 0
Iteration: 478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524357318878174, gen p mean: -0.10932514816522598, mean p set: 0.45301321148872375
loss_pred:0.01775474101305008, decouple_loss:0.0016512259608134627
The modified gen p mean: 0.45008385181427, gen p mean: -0.10751958936452866, mean p set: 0.4506586492061615
loss_pred:0.016803959384560585, decouple_loss:0.0018068737117573619
The modified gen p mean: 0.4511511027812958, gen p mean: -0.11227664351463318, mean p set: 0.45172688364982605
loss_pred:0.01856241747736931, decouple_loss:0.00140480138361454
Iteration: 479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45198854804039, gen p mean: -0.11364592611789703, mean p set: 0.4525661766529083
loss_pred:0.017444966360926628, decouple_loss:0.001919698202982545
The modified gen p mean: 0.45150431990623474, gen p mean: -0.11604016274213791, mean p set: 0.4520820379257202
loss_pred:0.01809883862733841, decouple_loss:0.0011121486313641071
The modified gen p mean: 0.4513368308544159, gen p mean: -0.11556407064199448, mean p set: 0.4519124925136566
loss_pred:0.018085239455103874, decouple_loss:0.0012824044097214937
Iteration: 480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45268914103507996, gen p mean: -0.11297246813774109, mean p set: 0.4532662332057953
loss_pred:0.016794219613075256, decouple_loss:0.0016670654295012355
The modified gen p mean: 0.45319047570228577, gen p mean: -0.11443840712308884, mean p set: 0.45377078652381897
loss_pred:0.016558902338147163, decouple_loss:0.0017040468519553542
The modified gen p mean: 0.4518105685710907, gen p mean: -0.1142602413892746, mean p set: 0.452386736869812
loss_pred:0.01766934245824814, decouple_loss:0.0013800414744764566
2023-05-01 00:46:14 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12234261631965637, mean p set: 0.4502691626548767
loss_pred:0.01791539415717125, decouple_loss:0.0009475345141254365
The modified gen p mean: 0.449533611536026, gen p mean: -0.11724967509508133, mean p set: 0.4500633478164673
loss_pred:0.017132483422756195, decouple_loss:0.0011540468549355865
The modified gen p mean: 0.4497816562652588, gen p mean: -0.11652973294258118, mean p set: 0.45035696029663086
loss_pred:0.017386719584465027, decouple_loss:0.0011116638779640198
WV_1_PC_1_EH_0_PS_40, loss: 0.017531752586364746, avg_mse: 0.027188707143068314
current test mse: 0.027189
Iteration: 481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108547806739807, gen p mean: -0.11652405560016632, mean p set: 0.4516604542732239
loss_pred:0.017142387107014656, decouple_loss:0.0010556740453466773
The modified gen p mean: 0.4508562386035919, gen p mean: -0.11181161552667618, mean p set: 0.45143604278564453The modified gen p mean: 0.4495752155780792, gen p mean: -0.10789505392313004, mean p set: 0.4501498341560364
loss_pred:0.016727278009057045, decouple_loss:0.001068274024873972
loss_pred:0.016651909798383713, decouple_loss:0.0012422275030985475
Iteration: 482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45292407274246216, gen p mean: -0.11076496541500092, mean p set: 0.45350101590156555
loss_pred:0.01752038113772869, decouple_loss:0.0010338330175727606
The modified gen p mean: 0.4511438012123108, gen p mean: -0.11717447638511658, mean p set: 0.4517205059528351The modified gen p mean: 0.4509941637516022, gen p mean: -0.11135895550251007, mean p set: 0.4515700936317444
loss_pred:0.017832612618803978, decouple_loss:0.00100345304235816
loss_pred:0.01687484234571457, decouple_loss:0.0010915289167314768
Iteration: 483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526066780090332, gen p mean: -0.10926084965467453, mean p set: 0.45318397879600525
loss_pred:0.01692168414592743, decouple_loss:0.0013431347906589508
The modified gen p mean: 0.449521541595459, gen p mean: -0.10584630072116852, mean p set: 0.4500984251499176
loss_pred:0.01722710393369198, decouple_loss:0.0011151954531669617
The modified gen p mean: 0.45244669914245605, gen p mean: -0.11228618770837784, mean p set: 0.4530230164527893
loss_pred:0.016741830855607986, decouple_loss:0.0009122809278778732
Iteration: 484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45194104313850403, gen p mean: -0.11021915078163147, mean p set: 0.4525170624256134
loss_pred:0.017331594601273537, decouple_loss:0.0013385189231485128
The modified gen p mean: 0.45121386647224426, gen p mean: -0.10577917844057083, mean p set: 0.4517892897129059
loss_pred:0.017235811799764633, decouple_loss:0.0011926060542464256
The modified gen p mean: 0.4517861008644104, gen p mean: -0.10840960592031479, mean p set: 0.4523616135120392
loss_pred:0.017379440367221832, decouple_loss:0.0014303304487839341
Iteration: 485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514017403125763, gen p mean: -0.10591810941696167, mean p set: 0.4519789516925812
loss_pred:0.01757584698498249, decouple_loss:0.0010965765686705709
The modified gen p mean: 0.45193153619766235, gen p mean: -0.10695960372686386, mean p set: 0.4525096118450165
loss_pred:0.016942642629146576, decouple_loss:0.0011791783617809415
The modified gen p mean: 0.4515664279460907, gen p mean: -0.10193461924791336, mean p set: 0.4521442651748657
loss_pred:0.0168604739010334, decouple_loss:0.0011602916056290269
Iteration: 486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510381519794464, gen p mean: -0.10871583223342896, mean p set: 0.4516153931617737
loss_pred:0.017626894637942314, decouple_loss:0.0012493535177782178
The modified gen p mean: 0.451419860124588, gen p mean: -0.10293763130903244, mean p set: 0.4519975483417511
loss_pred:0.01666615717113018, decouple_loss:0.0013340187724679708
The modified gen p mean: 0.45127275586128235, gen p mean: -0.11525197327136993, mean p set: 0.4518510699272156
loss_pred:0.017653128132224083, decouple_loss:0.0014296653680503368
Iteration: 487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507320821285248, gen p mean: -0.11710188537836075, mean p set: 0.45130833983421326
loss_pred:0.017136476933956146, decouple_loss:0.0010534364264458418
The modified gen p mean: 0.4513743221759796, gen p mean: -0.1122441440820694, mean p set: 0.45195385813713074
The modified gen p mean: 0.45386970043182373, gen p mean: -0.10896994173526764, mean p set: 0.4544433653354645
loss_pred:0.017652234062552452, decouple_loss:0.0010322661837562919
loss_pred:0.017656732350587845, decouple_loss:0.0010535819455981255
Iteration: 488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488789737224579, gen p mean: -0.11364533752202988, mean p set: 0.44945603609085083
loss_pred:0.017069373279809952, decouple_loss:0.0014399416977539659
The modified gen p mean: 0.4504801332950592, gen p mean: -0.12401679903268814, mean p set: 0.4510558545589447
The modified gen p mean: 0.45169803500175476, gen p mean: -0.12424197047948837, mean p set: 0.45227286219596863
loss_pred:0.017902111634612083, decouple_loss:0.0008753366419114172
loss_pred:0.01699344627559185, decouple_loss:0.0009977453155443072
Iteration: 489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44884300231933594, gen p mean: -0.11566988378763199, mean p set: 0.4494180977344513
loss_pred:0.016532698646187782, decouple_loss:0.0012803637655451894
The modified gen p mean: 0.4515882134437561, gen p mean: -0.1267075538635254, mean p set: 0.4521671235561371
loss_pred:0.01689315214753151, decouple_loss:0.001128514762967825
The modified gen p mean: 0.4512481987476349, gen p mean: -0.12359806150197983, mean p set: 0.4518203139305115
loss_pred:0.017308209091424942, decouple_loss:0.0010048565454781055
Iteration: 490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500656723976135, gen p mean: -0.12338718771934509, mean p set: 0.4506395757198334
loss_pred:0.01708681881427765, decouple_loss:0.0014352991711348295
The modified gen p mean: 0.4498949348926544, gen p mean: -0.1300031691789627, mean p set: 0.45047152042388916
The modified gen p mean: 0.45274972915649414, gen p mean: -0.12804202735424042, mean p set: 0.4533267617225647
loss_pred:0.016233548521995544, decouple_loss:0.0010153837502002716
loss_pred:0.016629550606012344, decouple_loss:0.0016232262132689357
2023-05-01 00:48:20 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13770468533039093, mean p set: 0.4502691626548767
loss_pred:0.01785014197230339, decouple_loss:0.0017866488778963685
The modified gen p mean: 0.44953498244285583, gen p mean: -0.13245081901550293, mean p set: 0.4500633478164673
loss_pred:0.01711219549179077, decouple_loss:0.001207827590405941
The modified gen p mean: 0.4497789740562439, gen p mean: -0.13129746913909912, mean p set: 0.45035696029663086
loss_pred:0.01743137277662754, decouple_loss:0.0010403173509985209
WV_1_PC_1_EH_0_PS_40, loss: 0.01753181591629982, avg_mse: 0.027138277888298035
current test mse: 0.027138
Iteration: 491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45245105028152466, gen p mean: -0.12788458168506622, mean p set: 0.4530283212661743
loss_pred:0.016802731901407242, decouple_loss:0.0010121423983946443
The modified gen p mean: 0.4517754018306732, gen p mean: -0.13209699094295502, mean p set: 0.452349454164505The modified gen p mean: 0.4518637955188751, gen p mean: -0.1296961009502411, mean p set: 0.4524403214454651
loss_pred:0.016515102237462997, decouple_loss:0.0012104165507480502loss_pred:0.016908632591366768, decouple_loss:0.001413768040947616
Iteration: 492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511291980743408, gen p mean: -0.1361793726682663, mean p set: 0.45170560479164124
loss_pred:0.016423344612121582, decouple_loss:0.0008479429525323212
The modified gen p mean: 0.4516490399837494, gen p mean: -0.13450342416763306, mean p set: 0.4522245526313782The modified gen p mean: 0.45044073462486267, gen p mean: -0.12739834189414978, mean p set: 0.451017826795578
loss_pred:0.017081161960959435, decouple_loss:0.0012256493791937828
loss_pred:0.016505420207977295, decouple_loss:0.0011479861568659544
Iteration: 493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517403841018677, gen p mean: -0.13569815456867218, mean p set: 0.4523128271102905
loss_pred:0.017580881714820862, decouple_loss:0.0011656159767881036
The modified gen p mean: 0.4516434371471405, gen p mean: -0.1337554156780243, mean p set: 0.4522160291671753
loss_pred:0.017226727679371834, decouple_loss:0.0010916568571701646
The modified gen p mean: 0.4503139555454254, gen p mean: -0.1369541585445404, mean p set: 0.45088884234428406
loss_pred:0.018049482256174088, decouple_loss:0.0010590841993689537
Iteration: 494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451597660779953, gen p mean: -0.13779285550117493, mean p set: 0.45217666029930115
loss_pred:0.016708755865693092, decouple_loss:0.0016990138683468103
The modified gen p mean: 0.4517512321472168, gen p mean: -0.12948313355445862, mean p set: 0.4523266553878784
loss_pred:0.017139654606580734, decouple_loss:0.0011236119316890836
The modified gen p mean: 0.45150279998779297, gen p mean: -0.13216276466846466, mean p set: 0.4520816504955292
loss_pred:0.017299452796578407, decouple_loss:0.0013455245643854141
Iteration: 495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536653757095337, gen p mean: -0.12512321770191193, mean p set: 0.4542403817176819
loss_pred:0.016959257423877716, decouple_loss:0.0009325132705271244
The modified gen p mean: 0.4507142901420593, gen p mean: -0.13203878700733185, mean p set: 0.4512908160686493
loss_pred:0.01646462455391884, decouple_loss:0.0009414282394573092
The modified gen p mean: 0.4506753385066986, gen p mean: -0.12494651973247528, mean p set: 0.4512523412704468
loss_pred:0.01730668731033802, decouple_loss:0.0009030842338688672
Iteration: 496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505068063735962, gen p mean: -0.12306977808475494, mean p set: 0.4510838985443115
loss_pred:0.01713774912059307, decouple_loss:0.001126821618527174
The modified gen p mean: 0.4508887529373169, gen p mean: -0.12494128197431564, mean p set: 0.4514661431312561
loss_pred:0.017221815884113312, decouple_loss:0.0011772182770073414
The modified gen p mean: 0.4532974660396576, gen p mean: -0.12293056398630142, mean p set: 0.4538784623146057
loss_pred:0.016261747106909752, decouple_loss:0.0012947055511176586
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
NaN value num: 0
Iteration: 497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097750425338745, gen p mean: -0.11634422838687897, mean p set: 0.45155417919158936
loss_pred:0.017492353916168213, decouple_loss:0.00102127599529922
The modified gen p mean: 0.4508466422557831, gen p mean: -0.1152287945151329, mean p set: 0.4514252245426178
The modified gen p mean: 0.45296916365623474, gen p mean: -0.1229008287191391, mean p set: 0.45354846119880676
loss_pred:0.016915500164031982, decouple_loss:0.0008838943904265761
loss_pred:0.0163051038980484, decouple_loss:0.000921732047572732
Iteration: 498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509149491786957, gen p mean: -0.11624956876039505, mean p set: 0.451490581035614
loss_pred:0.01654299907386303, decouple_loss:0.0011716274311766028
The modified gen p mean: 0.4508715271949768, gen p mean: -0.11492231488227844, mean p set: 0.451449453830719
The modified gen p mean: 0.45290255546569824, gen p mean: -0.12449613958597183, mean p set: 0.453481525182724
loss_pred:0.016681229695677757, decouple_loss:0.0008329293341375887
loss_pred:0.015955477952957153, decouple_loss:0.0009392992360517383
Iteration: 499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507812559604645, gen p mean: -0.12320073693990707, mean p set: 0.451358824968338
loss_pred:0.016673732548952103, decouple_loss:0.0012912990059703588
The modified gen p mean: 0.44954028725624084, gen p mean: -0.1255803257226944, mean p set: 0.45011407136917114
loss_pred:0.017368465662002563, decouple_loss:0.000891322735697031
The modified gen p mean: 0.4516157805919647, gen p mean: -0.11483905464410782, mean p set: 0.4521932005882263
loss_pred:0.017051169648766518, decouple_loss:0.001159541541710496
Iteration: 500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450380802154541, gen p mean: -0.11593280732631683, mean p set: 0.4509580433368683
loss_pred:0.01658332347869873, decouple_loss:0.0010726586915552616
The modified gen p mean: 0.4499187469482422, gen p mean: -0.11507034301757812, mean p set: 0.4504954218864441
loss_pred:0.016843421384692192, decouple_loss:0.0008951915660873055
The modified gen p mean: 0.4503568410873413, gen p mean: -0.1226571649312973, mean p set: 0.45093417167663574
loss_pred:0.01716938056051731, decouple_loss:0.0007565732812508941
2023-05-01 00:51:07 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1300169974565506, mean p set: 0.4502691626548767
loss_pred:0.017963865771889687, decouple_loss:0.0015783252893015742
The modified gen p mean: 0.44953179359436035, gen p mean: -0.12486957758665085, mean p set: 0.4500633478164673
loss_pred:0.017089713364839554, decouple_loss:0.0012925707269459963
The modified gen p mean: 0.44977930188179016, gen p mean: -0.12387543171644211, mean p set: 0.45035696029663086
loss_pred:0.017448799684643745, decouple_loss:0.0008880192181095481
WV_1_PC_1_EH_0_PS_40, loss: 0.01756344363093376, avg_mse: 0.02710873819887638
current test mse: 0.027109
Iteration: 501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451612263917923, gen p mean: -0.1117553561925888, mean p set: 0.45218998193740845
loss_pred:0.016827989369630814, decouple_loss:0.0007572415634058416
The modified gen p mean: 0.450052946805954, gen p mean: -0.12100092321634293, mean p set: 0.45062994956970215
loss_pred:0.017462419345974922, decouple_loss:0.0008359869825653732
The modified gen p mean: 0.4497319757938385, gen p mean: -0.12144679576158524, mean p set: 0.4503083825111389
loss_pred:0.017491323873400688, decouple_loss:0.0008357432670891285
Iteration: 502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45117658376693726, gen p mean: -0.12049748748540878, mean p set: 0.45175471901893616
loss_pred:0.017304295673966408, decouple_loss:0.0011183281894773245
The modified gen p mean: 0.4501114785671234, gen p mean: -0.11770891398191452, mean p set: 0.4506874978542328
The modified gen p mean: 0.4512874186038971, gen p mean: -0.11894188076257706, mean p set: 0.4518631398677826
loss_pred:0.017503922805190086, decouple_loss:0.0009199713240377605
loss_pred:0.017781278118491173, decouple_loss:0.001464483211748302
Iteration: 503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45231524109840393, gen p mean: -0.1318710297346115, mean p set: 0.45289358496665955
loss_pred:0.016600575298070908, decouple_loss:0.0008382936357520521
The modified gen p mean: 0.4516519010066986, gen p mean: -0.1255214959383011, mean p set: 0.45223185420036316The modified gen p mean: 0.4504494369029999, gen p mean: -0.126801997423172, mean p set: 0.4510243833065033
loss_pred:0.016725817695260048, decouple_loss:0.0009637402836233377
loss_pred:0.01698203757405281, decouple_loss:0.0010403988417237997
Iteration: 504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45152002573013306, gen p mean: -0.11962445080280304, mean p set: 0.4520973861217499
loss_pred:0.017298517748713493, decouple_loss:0.0010781757300719619
The modified gen p mean: 0.4493509531021118, gen p mean: -0.12784165143966675, mean p set: 0.44992655515670776
loss_pred:0.01791394129395485, decouple_loss:0.0016269347397610545
The modified gen p mean: 0.4507673978805542, gen p mean: -0.12588834762573242, mean p set: 0.45134201645851135
loss_pred:0.01686803065240383, decouple_loss:0.0010370871750637889
Iteration: 505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059219002723694, gen p mean: -0.1286434382200241, mean p set: 0.45116883516311646
loss_pred:0.017423605546355247, decouple_loss:0.001220474485307932
The modified gen p mean: 0.45021745562553406, gen p mean: -0.13064664602279663, mean p set: 0.4507933557033539
loss_pred:0.01663612388074398, decouple_loss:0.0009532264666631818
The modified gen p mean: 0.44980868697166443, gen p mean: -0.12765923142433167, mean p set: 0.45038551092147827
loss_pred:0.01664295420050621, decouple_loss:0.0010876096785068512
Iteration: 506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450234979391098, gen p mean: -0.12724106013774872, mean p set: 0.4508115351200104
loss_pred:0.01648549735546112, decouple_loss:0.001113744918256998
The modified gen p mean: 0.45039838552474976, gen p mean: -0.12247321754693985, mean p set: 0.4509766697883606
loss_pred:0.01703747734427452, decouple_loss:0.0009372747736051679
The modified gen p mean: 0.4512169361114502, gen p mean: -0.12324702739715576, mean p set: 0.45179006457328796
loss_pred:0.01650899089872837, decouple_loss:0.0010416473960503936
Iteration: 507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512513279914856, gen p mean: -0.12003921717405319, mean p set: 0.45182737708091736
loss_pred:0.01686789095401764, decouple_loss:0.000968847016338259
The modified gen p mean: 0.45099103450775146, gen p mean: -0.1275528222322464, mean p set: 0.45156532526016235
loss_pred:0.01574423909187317, decouple_loss:0.0012595810694620013
The modified gen p mean: 0.4522990584373474, gen p mean: -0.1222272515296936, mean p set: 0.4528786242008209
loss_pred:0.016905834898352623, decouple_loss:0.0010238694958388805
Iteration: 508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508225619792938, gen p mean: -0.12103337049484253, mean p set: 0.45140039920806885
loss_pred:0.016374973580241203, decouple_loss:0.0008986112661659718
The modified gen p mean: 0.45055925846099854, gen p mean: -0.11432138085365295, mean p set: 0.4511346220970154
loss_pred:0.01641499251127243, decouple_loss:0.0008671727264299989
The modified gen p mean: 0.45166274905204773, gen p mean: -0.11332911998033524, mean p set: 0.4522396922111511
loss_pred:0.016398604959249496, decouple_loss:0.0007984510157257318
Iteration: 509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44936928153038025, gen p mean: -0.1134057343006134, mean p set: 0.4499463438987732
loss_pred:0.01720978319644928, decouple_loss:0.001081661437638104
The modified gen p mean: 0.45127397775650024, gen p mean: -0.10733041912317276, mean p set: 0.4518493115901947
loss_pred:0.017052151262760162, decouple_loss:0.0008706959197297692
The modified gen p mean: 0.4509681463241577, gen p mean: -0.1130044236779213, mean p set: 0.45154494047164917
loss_pred:0.015648743137717247, decouple_loss:0.0009574362193234265
Iteration: 510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509033262729645, gen p mean: -0.11282139271497726, mean p set: 0.4514811336994171
loss_pred:0.017183367162942886, decouple_loss:0.0009047829662449658
The modified gen p mean: 0.45216575264930725, gen p mean: -0.11634764075279236, mean p set: 0.452742338180542
loss_pred:0.015999577939510345, decouple_loss:0.0009484471520408988
The modified gen p mean: 0.45143923163414, gen p mean: -0.10694209486246109, mean p set: 0.45201605558395386
loss_pred:0.01725754700601101, decouple_loss:0.0011631945380941033
2023-05-01 00:53:11 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12276285141706467, mean p set: 0.4502691626548767
loss_pred:0.017900386825203896, decouple_loss:0.0016259781550616026
The modified gen p mean: 0.4495314657688141, gen p mean: -0.11754307150840759, mean p set: 0.4500633478164673
loss_pred:0.01712348312139511, decouple_loss:0.0013566211564466357
The modified gen p mean: 0.4497770667076111, gen p mean: -0.11682675033807755, mean p set: 0.45035696029663086
loss_pred:0.0173901729285717, decouple_loss:0.0010858068708330393
WV_1_PC_1_EH_0_PS_40, loss: 0.01753915473818779, avg_mse: 0.027137964963912964
current test mse: 0.027138
Iteration: 511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516858756542206, gen p mean: -0.11383750289678574, mean p set: 0.452263206243515
loss_pred:0.016308601945638657, decouple_loss:0.0010809767991304398
The modified gen p mean: 0.4525086283683777, gen p mean: -0.10717616975307465, mean p set: 0.4530864953994751
loss_pred:0.016553249210119247, decouple_loss:0.0010537732159718871
The modified gen p mean: 0.4520045816898346, gen p mean: -0.118147112429142, mean p set: 0.4525797963142395
loss_pred:0.016050292178988457, decouple_loss:0.0009785526199266315
Iteration: 512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501785635948181, gen p mean: -0.112273670732975, mean p set: 0.4507540166378021
loss_pred:0.016756495460867882, decouple_loss:0.0011531452182680368
The modified gen p mean: 0.45058125257492065, gen p mean: -0.1119096577167511, mean p set: 0.4511570930480957The modified gen p mean: 0.45184996724128723, gen p mean: -0.12431948632001877, mean p set: 0.4524238109588623
loss_pred:0.017156831920146942, decouple_loss:0.0009822623105719686
loss_pred:0.01640525460243225, decouple_loss:0.0008506132871843874
Iteration: 513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514983594417572, gen p mean: -0.12064938247203827, mean p set: 0.4520759880542755
loss_pred:0.016094349324703217, decouple_loss:0.0008675709250383079
The modified gen p mean: 0.45114457607269287, gen p mean: -0.11778927594423294, mean p set: 0.451722115278244
loss_pred:0.01689438708126545, decouple_loss:0.0010169779416173697
The modified gen p mean: 0.4500490725040436, gen p mean: -0.11899084597826004, mean p set: 0.45062902569770813
loss_pred:0.016577724367380142, decouple_loss:0.0009981951443478465
Iteration: 514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44993671774864197, gen p mean: -0.11618093401193619, mean p set: 0.4505161941051483
loss_pred:0.01667020283639431, decouple_loss:0.000993821187876165
The modified gen p mean: 0.45229271054267883, gen p mean: -0.1216549500823021, mean p set: 0.45286911725997925
loss_pred:0.01613980159163475, decouple_loss:0.00116369454190135
The modified gen p mean: 0.45089712738990784, gen p mean: -0.11505360156297684, mean p set: 0.4514739513397217
loss_pred:0.01697656698524952, decouple_loss:0.0013017916353419423
Iteration: 515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516061544418335, gen p mean: -0.11721006035804749, mean p set: 0.45218396186828613
loss_pred:0.017466656863689423, decouple_loss:0.0011562597937881947
The modified gen p mean: 0.45232492685317993, gen p mean: -0.11981474608182907, mean p set: 0.45289894938468933
loss_pred:0.01624135673046112, decouple_loss:0.001133536221459508
The modified gen p mean: 0.451115220785141, gen p mean: -0.11991164833307266, mean p set: 0.4516936242580414
loss_pred:0.017244966700673103, decouple_loss:0.0010838900925591588
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
NaN value num: 0
Iteration: 516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490073025226593, gen p mean: -0.12773014605045319, mean p set: 0.4495847821235657
loss_pred:0.017987148836255074, decouple_loss:0.0009168056421913207
The modified gen p mean: 0.4486559331417084, gen p mean: -0.12512575089931488, mean p set: 0.4492320418357849
The modified gen p mean: 0.4479035437107086, gen p mean: -0.1292399764060974, mean p set: 0.44847843050956726
loss_pred:0.018170487135648727, decouple_loss:0.0009935761336237192
loss_pred:0.01881522685289383, decouple_loss:0.001069488818757236
Iteration: 517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492522180080414, gen p mean: -0.1277565062046051, mean p set: 0.449830561876297
loss_pred:0.018725598230957985, decouple_loss:0.0011425671400502324
The modified gen p mean: 0.44896048307418823, gen p mean: -0.12906737625598907, mean p set: 0.44953596591949463
loss_pred:0.01769198849797249, decouple_loss:0.001188477617688477
The modified gen p mean: 0.44776391983032227, gen p mean: -0.12462592124938965, mean p set: 0.44833892583847046
loss_pred:0.019760096445679665, decouple_loss:0.0012860255083069205
Iteration: 518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492124021053314, gen p mean: -0.12721917033195496, mean p set: 0.449788898229599
loss_pred:0.017978377640247345, decouple_loss:0.0009145248914137483
The modified gen p mean: 0.44687458872795105, gen p mean: -0.12952399253845215, mean p set: 0.44745081663131714
loss_pred:0.018686171621084213, decouple_loss:0.0009388240869157016
The modified gen p mean: 0.4473513662815094, gen p mean: -0.13103073835372925, mean p set: 0.4479283094406128
loss_pred:0.01840069517493248, decouple_loss:0.0008650074596516788
Iteration: 519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447559118270874, gen p mean: -0.12025003880262375, mean p set: 0.4481346309185028
loss_pred:0.01966048777103424, decouple_loss:0.000983617501333356
The modified gen p mean: 0.44830837845802307, gen p mean: -0.1269097924232483, mean p set: 0.4488857388496399
The modified gen p mean: 0.4485781788825989, gen p mean: -0.11922048777341843, mean p set: 0.44915536046028137
loss_pred:0.018364988267421722, decouple_loss:0.0009271262679249048
loss_pred:0.017907381057739258, decouple_loss:0.0008883238770067692
Iteration: 520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780126214027405, gen p mean: -0.11981692910194397, mean p set: 0.44837674498558044
loss_pred:0.0172845758497715, decouple_loss:0.0011399099603295326
The modified gen p mean: 0.44786128401756287, gen p mean: -0.12021217495203018, mean p set: 0.4484367072582245
The modified gen p mean: 0.448188453912735, gen p mean: -0.12942422926425934, mean p set: 0.4487626254558563
loss_pred:0.01873129792511463, decouple_loss:0.0012750145979225636
loss_pred:0.018044017255306244, decouple_loss:0.0010806123027577996
2023-05-01 00:55:58 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1270413100719452, mean p set: 0.4502691626548767
loss_pred:0.017652370035648346, decouple_loss:0.0014785456005483866
The modified gen p mean: 0.4495360255241394, gen p mean: -0.1215575635433197, mean p set: 0.4500633478164673
loss_pred:0.017058422788977623, decouple_loss:0.0011064693098887801
The modified gen p mean: 0.44977861642837524, gen p mean: -0.12085399776697159, mean p set: 0.45035696029663086
loss_pred:0.017346570268273354, decouple_loss:0.0010030227713286877
WV_1_PC_1_EH_0_PS_40, loss: 0.017412256449460983, avg_mse: 0.026960359886288643
current test mse: 0.02696
Iteration: 521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44845983386039734, gen p mean: -0.11448924988508224, mean p set: 0.4490341246128082
loss_pred:0.017317770048975945, decouple_loss:0.0011807318078354
The modified gen p mean: 0.4497986137866974, gen p mean: -0.11941222846508026, mean p set: 0.45037850737571716The modified gen p mean: 0.44992613792419434, gen p mean: -0.1148078441619873, mean p set: 0.4505000710487366
loss_pred:0.017683595418930054, decouple_loss:0.0009093350963667035
loss_pred:0.017869003117084503, decouple_loss:0.001388460397720337
Iteration: 522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945159554481506, gen p mean: -0.11969786882400513, mean p set: 0.45002496242523193
loss_pred:0.017719248309731483, decouple_loss:0.001120185130275786
The modified gen p mean: 0.44949230551719666, gen p mean: -0.1256876289844513, mean p set: 0.4500678777694702The modified gen p mean: 0.44928479194641113, gen p mean: -0.12174547463655472, mean p set: 0.4498618543148041
loss_pred:0.017488956451416016, decouple_loss:0.0010105771943926811
loss_pred:0.016979699954390526, decouple_loss:0.0010025248629972339
Iteration: 523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900643825531006, gen p mean: -0.1255137175321579, mean p set: 0.44958263635635376
loss_pred:0.017827806994318962, decouple_loss:0.0011097079841420054
The modified gen p mean: 0.44847095012664795, gen p mean: -0.118227519094944, mean p set: 0.44904592633247375
loss_pred:0.018918413668870926, decouple_loss:0.0009052371024154127
The modified gen p mean: 0.44953057169914246, gen p mean: -0.12709179520606995, mean p set: 0.45010536909103394
loss_pred:0.0183357372879982, decouple_loss:0.001273373607546091
Iteration: 524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906094670295715, gen p mean: -0.12846216559410095, mean p set: 0.44963809847831726
loss_pred:0.016837211325764656, decouple_loss:0.0009741121903061867
The modified gen p mean: 0.4469049870967865, gen p mean: -0.1341957151889801, mean p set: 0.4474814832210541
loss_pred:0.018350688740611076, decouple_loss:0.0008622552850283682
The modified gen p mean: 0.4474926292896271, gen p mean: -0.13714243471622467, mean p set: 0.4480692446231842
loss_pred:0.018127672374248505, decouple_loss:0.0009394891676492989
Iteration: 525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832974672317505, gen p mean: -0.13428720831871033, mean p set: 0.4489073157310486
loss_pred:0.018061470240354538, decouple_loss:0.001083433860912919
The modified gen p mean: 0.4474180042743683, gen p mean: -0.13347019255161285, mean p set: 0.4479937255382538
loss_pred:0.01840062439441681, decouple_loss:0.0009666556725278497
The modified gen p mean: 0.44969260692596436, gen p mean: -0.12920746207237244, mean p set: 0.4502682387828827
loss_pred:0.018497778102755547, decouple_loss:0.0010611615143716335
Iteration: 526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831445813179016, gen p mean: -0.1333710253238678, mean p set: 0.44888877868652344
The modified gen p mean: 0.4489153027534485, gen p mean: -0.12993896007537842, mean p set: 0.44949114322662354
loss_pred:0.018242165446281433, decouple_loss:0.0008531665080226958
loss_pred:0.01777150295674801, decouple_loss:0.0009252780000679195
The modified gen p mean: 0.44901296496391296, gen p mean: -0.12624603509902954, mean p set: 0.4495871365070343
loss_pred:0.01776384934782982, decouple_loss:0.0011114890221506357
Iteration: 527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486159682273865, gen p mean: -0.1258043497800827, mean p set: 0.4491897523403168
loss_pred:0.017509397119283676, decouple_loss:0.000992660177871585
The modified gen p mean: 0.4506411850452423, gen p mean: -0.12951700389385223, mean p set: 0.451217383146286
The modified gen p mean: 0.44686540961265564, gen p mean: -0.13208818435668945, mean p set: 0.4474412202835083
loss_pred:0.0173040758818388, decouple_loss:0.001214708318002522
loss_pred:0.018359601497650146, decouple_loss:0.0009400096023455262
Iteration: 528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497174620628357, gen p mean: -0.13147316873073578, mean p set: 0.45029157400131226
loss_pred:0.017881816253066063, decouple_loss:0.0008425924461334944
The modified gen p mean: 0.4500906467437744, gen p mean: -0.1318497210741043, mean p set: 0.4506652057170868
The modified gen p mean: 0.4472140371799469, gen p mean: -0.12857167422771454, mean p set: 0.44778892397880554
loss_pred:0.016736168414354324, decouple_loss:0.0009654360474087298
loss_pred:0.018218934535980225, decouple_loss:0.001215006923303008
Iteration: 529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486779570579529, gen p mean: -0.12977389991283417, mean p set: 0.44925177097320557
loss_pred:0.018287653103470802, decouple_loss:0.0014224447077140212
The modified gen p mean: 0.44842302799224854, gen p mean: -0.13668222725391388, mean p set: 0.4489997923374176
The modified gen p mean: 0.4488529562950134, gen p mean: -0.12098913639783859, mean p set: 0.4494294226169586
loss_pred:0.018109383061528206, decouple_loss:0.0014475345378741622
loss_pred:0.01887783221900463, decouple_loss:0.0014662181492894888
Iteration: 530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890233874320984, gen p mean: -0.13322781026363373, mean p set: 0.4494785666465759
loss_pred:0.019359448924660683, decouple_loss:0.0011880191741511226
The modified gen p mean: 0.4502886235713959, gen p mean: -0.13551130890846252, mean p set: 0.4508638381958008
The modified gen p mean: 0.44934073090553284, gen p mean: -0.13279367983341217, mean p set: 0.4499170780181885
loss_pred:0.01644112914800644, decouple_loss:0.0008467051666229963
loss_pred:0.0165964737534523, decouple_loss:0.001014052890241146
2023-05-01 00:58:05 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13592004776000977, mean p set: 0.4502691626548767
loss_pred:0.017671780660748482, decouple_loss:0.0010585804702714086
The modified gen p mean: 0.4495333433151245, gen p mean: -0.13037796318531036, mean p set: 0.4500633478164673
loss_pred:0.016987156122922897, decouple_loss:0.0010730426292866468
The modified gen p mean: 0.44978126883506775, gen p mean: -0.12965410947799683, mean p set: 0.45035696029663086
loss_pred:0.017327405512332916, decouple_loss:0.0010150609305128455
WV_1_PC_1_EH_0_PS_40, loss: 0.017381224781274796, avg_mse: 0.026909835636615753
current test mse: 0.02691
Iteration: 531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493945240974426, gen p mean: -0.13531816005706787, mean p set: 0.44996798038482666
loss_pred:0.01853182725608349, decouple_loss:0.0008898959495127201
The modified gen p mean: 0.45022356510162354, gen p mean: -0.12874411046504974, mean p set: 0.45080211758613586The modified gen p mean: 0.4480324685573578, gen p mean: -0.12350692600011826, mean p set: 0.44860872626304626
loss_pred:0.018178192898631096, decouple_loss:0.0008608351345174015loss_pred:0.017515093088150024, decouple_loss:0.0010022408096119761
Iteration: 532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948697090148926, gen p mean: -0.1263352781534195, mean p set: 0.45006415247917175
loss_pred:0.01868714764714241, decouple_loss:0.0012056864798069
The modified gen p mean: 0.4477071166038513, gen p mean: -0.12667401134967804, mean p set: 0.4482865631580353The modified gen p mean: 0.4486442804336548, gen p mean: -0.12130463123321533, mean p set: 0.4492203891277313
loss_pred:0.018965141847729683, decouple_loss:0.0009109930251725018
loss_pred:0.017873531207442284, decouple_loss:0.001052608247846365
Iteration: 533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860267639160156, gen p mean: -0.1249602884054184, mean p set: 0.44917726516723633
loss_pred:0.017835993319749832, decouple_loss:0.0009637831244617701
The modified gen p mean: 0.4500870108604431, gen p mean: -0.12365347146987915, mean p set: 0.45066434144973755
loss_pred:0.017924681305885315, decouple_loss:0.0009857505792751908
The modified gen p mean: 0.4473613202571869, gen p mean: -0.12296528369188309, mean p set: 0.4479367434978485
loss_pred:0.017977558076381683, decouple_loss:0.0009241037187166512
Iteration: 534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491250216960907, gen p mean: -0.12429975718259811, mean p set: 0.44970032572746277
loss_pred:0.017720645293593407, decouple_loss:0.001368608558550477
The modified gen p mean: 0.44944679737091064, gen p mean: -0.11385006457567215, mean p set: 0.45002689957618713
loss_pred:0.018294647336006165, decouple_loss:0.0010962195228785276
The modified gen p mean: 0.44934046268463135, gen p mean: -0.12544114887714386, mean p set: 0.44991692900657654
loss_pred:0.01862587034702301, decouple_loss:0.001220841077156365
Iteration: 535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490033984184265, gen p mean: -0.12211069464683533, mean p set: 0.449579656124115
loss_pred:0.017530003562569618, decouple_loss:0.0007950381259433925
The modified gen p mean: 0.4500754475593567, gen p mean: -0.12914149463176727, mean p set: 0.45065340399742126
loss_pred:0.017712753266096115, decouple_loss:0.001236827694810927
The modified gen p mean: 0.4485984444618225, gen p mean: -0.12326766550540924, mean p set: 0.44917601346969604
loss_pred:0.019002817571163177, decouple_loss:0.0009071910753846169
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
NaN value num: 0
Iteration: 536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532102644443512, gen p mean: -0.12589752674102783, mean p set: 0.4537885785102844
loss_pred:0.01614794135093689, decouple_loss:0.0017188402125611901
The modified gen p mean: 0.45018675923347473, gen p mean: -0.12107355892658234, mean p set: 0.4507634937763214
The modified gen p mean: 0.4500986933708191, gen p mean: -0.12303571403026581, mean p set: 0.45067617297172546
loss_pred:0.01726100780069828, decouple_loss:0.001944471150636673
loss_pred:0.016324343159794807, decouple_loss:0.0012897818814963102
Iteration: 537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44944843649864197, gen p mean: -0.11726565659046173, mean p set: 0.45002463459968567
loss_pred:0.016578326001763344, decouple_loss:0.0010124919936060905
The modified gen p mean: 0.44932371377944946, gen p mean: -0.12078451365232468, mean p set: 0.44989991188049316
The modified gen p mean: 0.4497438967227936, gen p mean: -0.12100635468959808, mean p set: 0.4503227472305298
loss_pred:0.016954658553004265, decouple_loss:0.000826469506137073
loss_pred:0.016768690198659897, decouple_loss:0.0008455092902295291
Iteration: 538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499140977859497, gen p mean: -0.11822853982448578, mean p set: 0.4504907429218292
loss_pred:0.017589401453733444, decouple_loss:0.001106100156903267
The modified gen p mean: 0.44916144013404846, gen p mean: -0.11120452731847763, mean p set: 0.44973790645599365
loss_pred:0.01604331098496914, decouple_loss:0.0011057847877964377
The modified gen p mean: 0.4486434757709503, gen p mean: -0.1202450767159462, mean p set: 0.44922199845314026
loss_pred:0.016875967383384705, decouple_loss:0.0008600710425525904
Iteration: 539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851985573768616, gen p mean: -0.10949904471635818, mean p set: 0.4490962028503418
loss_pred:0.01647142693400383, decouple_loss:0.0010295369429513812
The modified gen p mean: 0.45111700892448425, gen p mean: -0.10725091397762299, mean p set: 0.45169559121131897
loss_pred:0.017708607017993927, decouple_loss:0.0010679245460778475
The modified gen p mean: 0.4501623809337616, gen p mean: -0.11240123957395554, mean p set: 0.4507381319999695
loss_pred:0.016615161672234535, decouple_loss:0.0008794241584837437
Iteration: 540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45247432589530945, gen p mean: -0.10728700459003448, mean p set: 0.4530515968799591
loss_pred:0.016621092334389687, decouple_loss:0.001016816240735352
The modified gen p mean: 0.44925764203071594, gen p mean: -0.10986410826444626, mean p set: 0.4498359262943268
The modified gen p mean: 0.4494195878505707, gen p mean: -0.1078847348690033, mean p set: 0.44999533891677856
loss_pred:0.016576683148741722, decouple_loss:0.0009344989666715264
loss_pred:0.016958601772785187, decouple_loss:0.0008712238050065935
2023-05-01 01:00:50 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12060273438692093, mean p set: 0.4502691626548767
loss_pred:0.017800429835915565, decouple_loss:0.001088437158614397
The modified gen p mean: 0.4495342969894409, gen p mean: -0.11543163657188416, mean p set: 0.4500633478164673
loss_pred:0.017025010660290718, decouple_loss:0.0009247706038877368
The modified gen p mean: 0.4497799277305603, gen p mean: -0.11490429937839508, mean p set: 0.45035696029663086
loss_pred:0.017356613650918007, decouple_loss:0.0008200579322874546
WV_1_PC_1_EH_0_PS_40, loss: 0.017441239207983017, avg_mse: 0.02701340802013874
current test mse: 0.027013
Iteration: 541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44938716292381287, gen p mean: -0.10699060559272766, mean p set: 0.44996383786201477
loss_pred:0.017116205766797066, decouple_loss:0.0009268908761441708
The modified gen p mean: 0.4496435225009918, gen p mean: -0.11170989274978638, mean p set: 0.4502233564853668The modified gen p mean: 0.45243698358535767, gen p mean: -0.1077658161520958, mean p set: 0.45301464200019836
loss_pred:0.016405252739787102, decouple_loss:0.0009487629868090153loss_pred:0.016531702131032944, decouple_loss:0.001483677071519196
Iteration: 542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45135799050331116, gen p mean: -0.10907039791345596, mean p set: 0.45193424820899963
The modified gen p mean: 0.4500381052494049, gen p mean: -0.10967236012220383, mean p set: 0.45061564445495605
loss_pred:0.017244307324290276, decouple_loss:0.0013615931384265423
loss_pred:0.01653757132589817, decouple_loss:0.000943661667406559
The modified gen p mean: 0.4500774145126343, gen p mean: -0.11475146561861038, mean p set: 0.4506552517414093
loss_pred:0.017662767320871353, decouple_loss:0.0010610505705699325
Iteration: 543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45046404004096985, gen p mean: -0.11330648511648178, mean p set: 0.45104068517684937
loss_pred:0.017048679292201996, decouple_loss:0.000948367000091821
The modified gen p mean: 0.4487791657447815, gen p mean: -0.11287396401166916, mean p set: 0.4493563175201416The modified gen p mean: 0.4496850371360779, gen p mean: -0.11284630745649338, mean p set: 0.4502647817134857
loss_pred:0.017273493111133575, decouple_loss:0.0011412396561354399
loss_pred:0.01655840128660202, decouple_loss:0.0008823710959404707
Iteration: 544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45087143778800964, gen p mean: -0.1073838546872139, mean p set: 0.4514475464820862
loss_pred:0.017093533650040627, decouple_loss:0.0009818279650062323
The modified gen p mean: 0.4489520192146301, gen p mean: -0.11154835671186447, mean p set: 0.4495299756526947
loss_pred:0.016764797270298004, decouple_loss:0.0010305360192433
The modified gen p mean: 0.44973453879356384, gen p mean: -0.10931370407342911, mean p set: 0.4503108859062195
loss_pred:0.016823437064886093, decouple_loss:0.0008752951980568469
Iteration: 545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499329924583435, gen p mean: -0.11294566094875336, mean p set: 0.4505075514316559
loss_pred:0.01707470789551735, decouple_loss:0.0011681673349812627
The modified gen p mean: 0.4490795135498047, gen p mean: -0.10883373767137527, mean p set: 0.4496554732322693
loss_pred:0.016717342659831047, decouple_loss:0.0011008151341229677
The modified gen p mean: 0.4518766701221466, gen p mean: -0.11404865980148315, mean p set: 0.4524524509906769
loss_pred:0.0161734726279974, decouple_loss:0.0009666950209066272
Iteration: 546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44899946451187134, gen p mean: -0.11345212906599045, mean p set: 0.44957631826400757
loss_pred:0.016540583223104477, decouple_loss:0.0011543980799615383
The modified gen p mean: 0.450288325548172, gen p mean: -0.11014450341463089, mean p set: 0.4508640468120575
loss_pred:0.016339050605893135, decouple_loss:0.0008521165582351387
The modified gen p mean: 0.44844162464141846, gen p mean: -0.11935252696275711, mean p set: 0.4490193724632263
loss_pred:0.016160372644662857, decouple_loss:0.0012244114186614752
Iteration: 547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502841532230377, gen p mean: -0.11507975310087204, mean p set: 0.45085835456848145
loss_pred:0.016617583110928535, decouple_loss:0.001188185065984726
The modified gen p mean: 0.4515564441680908, gen p mean: -0.11625304818153381, mean p set: 0.45213228464126587
The modified gen p mean: 0.4499286115169525, gen p mean: -0.1151401624083519, mean p set: 0.4505055248737335
loss_pred:0.016607776284217834, decouple_loss:0.0013793586986139417
loss_pred:0.016184527426958084, decouple_loss:0.00107027858030051
Iteration: 548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502809941768646, gen p mean: -0.11372631043195724, mean p set: 0.4508603513240814
loss_pred:0.01708805561065674, decouple_loss:0.0017131440108641982
The modified gen p mean: 0.44938230514526367, gen p mean: -0.11806727945804596, mean p set: 0.4499586224555969
loss_pred:0.016045309603214264, decouple_loss:0.0013168917503207922
The modified gen p mean: 0.44989651441574097, gen p mean: -0.11364059895277023, mean p set: 0.45047301054000854
loss_pred:0.017211521044373512, decouple_loss:0.001342285773716867
Iteration: 549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44921445846557617, gen p mean: -0.11331665515899658, mean p set: 0.44979190826416016
loss_pred:0.01649351790547371, decouple_loss:0.0009601645288057625
The modified gen p mean: 0.45240527391433716, gen p mean: -0.11544474959373474, mean p set: 0.4529832601547241
The modified gen p mean: 0.4494066536426544, gen p mean: -0.11392118036746979, mean p set: 0.44998228549957275
loss_pred:0.01577320322394371, decouple_loss:0.001078139990568161
loss_pred:0.016900647431612015, decouple_loss:0.0009086323552764952
Iteration: 550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45217815041542053, gen p mean: -0.11249881982803345, mean p set: 0.4527532756328583
loss_pred:0.016689199954271317, decouple_loss:0.0009573758579790592
The modified gen p mean: 0.4498203992843628, gen p mean: -0.124236099421978, mean p set: 0.450395405292511
loss_pred:0.016202112659811974, decouple_loss:0.0010611171601340175
The modified gen p mean: 0.4501052498817444, gen p mean: -0.11395949125289917, mean p set: 0.45068490505218506
loss_pred:0.01679573580622673, decouple_loss:0.00110119569581002
2023-05-01 01:02:57 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12414078414440155, mean p set: 0.4502691626548767
loss_pred:0.017814742401242256, decouple_loss:0.001407955540344119
The modified gen p mean: 0.44953277707099915, gen p mean: -0.11886487901210785, mean p set: 0.4500633478164673
loss_pred:0.01698794588446617, decouple_loss:0.0012768919114023447
The modified gen p mean: 0.449780136346817, gen p mean: -0.11833177506923676, mean p set: 0.45035696029663086
loss_pred:0.017320066690444946, decouple_loss:0.001245580380782485
WV_1_PC_1_EH_0_PS_40, loss: 0.017439760267734528, avg_mse: 0.02696331776678562
current test mse: 0.026963
Iteration: 551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44957250356674194, gen p mean: -0.11092309653759003, mean p set: 0.4501486122608185
loss_pred:0.016670912504196167, decouple_loss:0.0013806667411699891
The modified gen p mean: 0.45206940174102783, gen p mean: -0.1135198250412941, mean p set: 0.4526490569114685The modified gen p mean: 0.4492148160934448, gen p mean: -0.11421944200992584, mean p set: 0.4497922658920288
loss_pred:0.01613481715321541, decouple_loss:0.0012248909333720803
loss_pred:0.01655133068561554, decouple_loss:0.0009737042710185051
Iteration: 552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948509335517883, gen p mean: -0.11594653129577637, mean p set: 0.450061172246933
The modified gen p mean: 0.45073556900024414, gen p mean: -0.11992499977350235, mean p set: 0.4513118267059326
loss_pred:0.017393067479133606, decouple_loss:0.0008799189236015081
loss_pred:0.016439855098724365, decouple_loss:0.0009329493041150272The modified gen p mean: 0.45013734698295593, gen p mean: -0.11137168854475021, mean p set: 0.45071205496788025
loss_pred:0.016780052334070206, decouple_loss:0.0009824519511312246
Iteration: 553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44979119300842285, gen p mean: -0.10738682001829147, mean p set: 0.4503673017024994
loss_pred:0.015910467132925987, decouple_loss:0.00091723189689219
The modified gen p mean: 0.45080333948135376, gen p mean: -0.10542408376932144, mean p set: 0.45137903094291687
loss_pred:0.01751040853559971, decouple_loss:0.0011382505763322115
The modified gen p mean: 0.45229148864746094, gen p mean: -0.11013596504926682, mean p set: 0.4528670310974121
loss_pred:0.01654363051056862, decouple_loss:0.0011880582896992564
Iteration: 554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45031318068504333, gen p mean: -0.11122853308916092, mean p set: 0.45088836550712585
The modified gen p mean: 0.44805076718330383, gen p mean: -0.11013372242450714, mean p set: 0.4486272633075714
loss_pred:0.016663476824760437, decouple_loss:0.001715878606773913
loss_pred:0.01673896424472332, decouple_loss:0.0010479748016223311
The modified gen p mean: 0.4502106308937073, gen p mean: -0.10291381180286407, mean p set: 0.45078805088996887
loss_pred:0.01661275140941143, decouple_loss:0.0010140846716240048
Iteration: 555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860130548477173, gen p mean: -0.10233549773693085, mean p set: 0.44917601346969604
loss_pred:0.01618889346718788, decouple_loss:0.0008160886936821043
The modified gen p mean: 0.4513816833496094, gen p mean: -0.1056012436747551, mean p set: 0.4519580006599426
loss_pred:0.01695243827998638, decouple_loss:0.0014680546009913087
The modified gen p mean: 0.4516349136829376, gen p mean: -0.10451854020357132, mean p set: 0.45221027731895447
loss_pred:0.01711997203528881, decouple_loss:0.0014774507144466043
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
NaN value num: 0
Iteration: 556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45093807578086853, gen p mean: -0.10696863383054733, mean p set: 0.4515168070793152
loss_pred:0.01623942144215107, decouple_loss:0.0012055562110617757
The modified gen p mean: 0.4513620138168335, gen p mean: -0.1040445938706398, mean p set: 0.4519391357898712
The modified gen p mean: 0.4511677920818329, gen p mean: -0.11026231944561005, mean p set: 0.4517459571361542
loss_pred:0.015509487129747868, decouple_loss:0.0013440338661894202
loss_pred:0.01668664440512657, decouple_loss:0.0012749972520396113
Iteration: 557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451718807220459, gen p mean: -0.1097908765077591, mean p set: 0.45229440927505493
loss_pred:0.016550984233617783, decouple_loss:0.0011318133911117911
The modified gen p mean: 0.4503609538078308, gen p mean: -0.10966861993074417, mean p set: 0.45093876123428345
loss_pred:0.01642400026321411, decouple_loss:0.001364633091725409
The modified gen p mean: 0.45309978723526, gen p mean: -0.11038867384195328, mean p set: 0.45367616415023804
loss_pred:0.01680767722427845, decouple_loss:0.0013103123055770993
Iteration: 558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45035240054130554, gen p mean: -0.12740564346313477, mean p set: 0.4509281814098358
loss_pred:0.01601238176226616, decouple_loss:0.001076721353456378
The modified gen p mean: 0.4524126648902893, gen p mean: -0.11746452748775482, mean p set: 0.4529889225959778
loss_pred:0.015520493499934673, decouple_loss:0.00091631367104128
The modified gen p mean: 0.4504716694355011, gen p mean: -0.11872324347496033, mean p set: 0.45104846358299255
loss_pred:0.01527232676744461, decouple_loss:0.000752193562220782
Iteration: 559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521469175815582, gen p mean: -0.12593966722488403, mean p set: 0.4527246057987213
loss_pred:0.016490662470459938, decouple_loss:0.0008615670376457274
The modified gen p mean: 0.4518238306045532, gen p mean: -0.12395130097866058, mean p set: 0.45239993929862976
loss_pred:0.016181591898202896, decouple_loss:0.0009755382779985666
The modified gen p mean: 0.4517953097820282, gen p mean: -0.12244562059640884, mean p set: 0.4523715376853943
loss_pred:0.01563636213541031, decouple_loss:0.001102140755392611
Iteration: 560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502120018005371, gen p mean: -0.1290464997291565, mean p set: 0.450788289308548
loss_pred:0.015492243692278862, decouple_loss:0.0007526875706389546
The modified gen p mean: 0.44985365867614746, gen p mean: -0.12193043529987335, mean p set: 0.45042940974235535
loss_pred:0.016473472118377686, decouple_loss:0.0010137014323845506
The modified gen p mean: 0.4527759850025177, gen p mean: -0.12148264050483704, mean p set: 0.45335304737091064
loss_pred:0.01664147339761257, decouple_loss:0.0013751931255683303
2023-05-01 01:05:45 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1328519880771637, mean p set: 0.4502691626548767
loss_pred:0.01768629439175129, decouple_loss:0.0009511461830697954
The modified gen p mean: 0.44953420758247375, gen p mean: -0.12691666185855865, mean p set: 0.4500633478164673
loss_pred:0.016996966674923897, decouple_loss:0.0009277585777454078
The modified gen p mean: 0.44978025555610657, gen p mean: -0.12588708102703094, mean p set: 0.45035696029663086
loss_pred:0.017308643087744713, decouple_loss:0.000832718622405082
WV_1_PC_1_EH_0_PS_40, loss: 0.017375826835632324, avg_mse: 0.02697506546974182
current test mse: 0.026975
Iteration: 561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45172783732414246, gen p mean: -0.12142685055732727, mean p set: 0.4523046314716339
loss_pred:0.016495617106556892, decouple_loss:0.0009040979784913361
The modified gen p mean: 0.4511059522628784, gen p mean: -0.12011576443910599, mean p set: 0.4516802132129669
The modified gen p mean: 0.45179444551467896, gen p mean: -0.11816777288913727, mean p set: 0.4523712396621704
loss_pred:0.015314481221139431, decouple_loss:0.0009255901677533984
loss_pred:0.016386913135647774, decouple_loss:0.001018419163301587
Iteration: 562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507308304309845, gen p mean: -0.11930147558450699, mean p set: 0.45130568742752075
loss_pred:0.016237841919064522, decouple_loss:0.000928665860556066
The modified gen p mean: 0.452008455991745, gen p mean: -0.11770611256361008, mean p set: 0.4525846242904663
The modified gen p mean: 0.4513761103153229, gen p mean: -0.11604108661413193, mean p set: 0.4519527554512024
loss_pred:0.01632518321275711, decouple_loss:0.0009402847499586642
loss_pred:0.0157245434820652, decouple_loss:0.00104987109079957
Iteration: 563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059120655059814, gen p mean: -0.11591928452253342, mean p set: 0.45116788148880005
loss_pred:0.016755009070038795, decouple_loss:0.0009082292090170085
The modified gen p mean: 0.449631929397583, gen p mean: -0.12235833704471588, mean p set: 0.4502086043357849
loss_pred:0.01578693464398384, decouple_loss:0.001038281014189124
The modified gen p mean: 0.45031705498695374, gen p mean: -0.12147840857505798, mean p set: 0.4508955478668213
loss_pred:0.015529487282037735, decouple_loss:0.0008932079654186964
Iteration: 564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45118948817253113, gen p mean: -0.11950500309467316, mean p set: 0.45176488161087036
loss_pred:0.015931736677885056, decouple_loss:0.0009075307170860469
The modified gen p mean: 0.4511975646018982, gen p mean: -0.11995555460453033, mean p set: 0.45177337527275085
loss_pred:0.01608123630285263, decouple_loss:0.0008550959755666554
The modified gen p mean: 0.4504854679107666, gen p mean: -0.11824531108140945, mean p set: 0.4510599374771118
loss_pred:0.016101596876978874, decouple_loss:0.0008755021844990551
Iteration: 565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517485201358795, gen p mean: -0.11733278632164001, mean p set: 0.4523225724697113
loss_pred:0.0155398640781641, decouple_loss:0.0008258423185907304
The modified gen p mean: 0.44918227195739746, gen p mean: -0.1158486157655716, mean p set: 0.4497600495815277
loss_pred:0.016104383394122124, decouple_loss:0.0007687259931117296
The modified gen p mean: 0.44952985644340515, gen p mean: -0.11854994297027588, mean p set: 0.45010724663734436
loss_pred:0.0160855520516634, decouple_loss:0.0010023057693615556
Iteration: 566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097866654396057, gen p mean: -0.11682592332363129, mean p set: 0.45155444741249084
loss_pred:0.01618979498744011, decouple_loss:0.0009985023643821478
The modified gen p mean: 0.45173168182373047, gen p mean: -0.11351580172777176, mean p set: 0.4523092210292816
loss_pred:0.015651671215891838, decouple_loss:0.0007696712855249643
The modified gen p mean: 0.44986432790756226, gen p mean: -0.11623138934373856, mean p set: 0.45044055581092834
loss_pred:0.016330379992723465, decouple_loss:0.0007274218951351941
Iteration: 567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44998809695243835, gen p mean: -0.11532020568847656, mean p set: 0.4505651295185089
loss_pred:0.015778452157974243, decouple_loss:0.0008286029915325344
The modified gen p mean: 0.4509260356426239, gen p mean: -0.10927458852529526, mean p set: 0.45150282979011536
loss_pred:0.016010738909244537, decouple_loss:0.0009494227124378085
The modified gen p mean: 0.4511207640171051, gen p mean: -0.10917802155017853, mean p set: 0.45169830322265625
loss_pred:0.015726953744888306, decouple_loss:0.0008468669839203358
Iteration: 568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45122531056404114, gen p mean: -0.10929255187511444, mean p set: 0.4518023431301117
loss_pred:0.01550349686294794, decouple_loss:0.000967152533121407
The modified gen p mean: 0.4505902826786041, gen p mean: -0.1128973588347435, mean p set: 0.45116758346557617
loss_pred:0.01614542491734028, decouple_loss:0.0011828936403617263
The modified gen p mean: 0.4525320827960968, gen p mean: -0.11332549899816513, mean p set: 0.45310890674591064
loss_pred:0.015881890431046486, decouple_loss:0.0010175860952585936
Iteration: 569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45191720128059387, gen p mean: -0.11071433126926422, mean p set: 0.4524940252304077
loss_pred:0.01545403990894556, decouple_loss:0.0008372222073376179
The modified gen p mean: 0.4516042470932007, gen p mean: -0.11211458593606949, mean p set: 0.45218244194984436
The modified gen p mean: 0.45067211985588074, gen p mean: -0.10989509522914886, mean p set: 0.45124995708465576
loss_pred:0.016026724129915237, decouple_loss:0.000839939690195024
loss_pred:0.015476741828024387, decouple_loss:0.0008492867927998304
Iteration: 570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510631859302521, gen p mean: -0.11476913094520569, mean p set: 0.45164093375205994
loss_pred:0.015159174799919128, decouple_loss:0.0007760687731206417
The modified gen p mean: 0.45076045393943787, gen p mean: -0.11980339139699936, mean p set: 0.45134058594703674
loss_pred:0.015752755105495453, decouple_loss:0.000807490898296237
The modified gen p mean: 0.4496893286705017, gen p mean: -0.11486823111772537, mean p set: 0.45026299357414246
loss_pred:0.01616963930428028, decouple_loss:0.0007104464457370341
2023-05-01 01:07:52 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1259300708770752, mean p set: 0.4502691626548767
loss_pred:0.017633000388741493, decouple_loss:0.0009667001431807876
The modified gen p mean: 0.4495345652103424, gen p mean: -0.12043171375989914, mean p set: 0.4500633478164673
loss_pred:0.016931721940636635, decouple_loss:0.0010169793386012316
The modified gen p mean: 0.44978171586990356, gen p mean: -0.11948822438716888, mean p set: 0.45035696029663086
loss_pred:0.017250457778573036, decouple_loss:0.0009821729036048055
WV_1_PC_1_EH_0_PS_40, loss: 0.017321158200502396, avg_mse: 0.026873333379626274
current test mse: 0.026873
Iteration: 571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45245811343193054, gen p mean: -0.11452291905879974, mean p set: 0.45303553342819214
loss_pred:0.01600327529013157, decouple_loss:0.0008923074929043651
The modified gen p mean: 0.4516301453113556, gen p mean: -0.11851663142442703, mean p set: 0.45220664143562317The modified gen p mean: 0.4514969289302826, gen p mean: -0.11671070009469986, mean p set: 0.4520733654499054
loss_pred:0.015525728464126587, decouple_loss:0.0010064865928143263
loss_pred:0.015920929610729218, decouple_loss:0.0008849022560752928
Iteration: 572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527271091938019, gen p mean: -0.11247062683105469, mean p set: 0.4533045291900635
loss_pred:0.015410764142870903, decouple_loss:0.0009238323546014726
The modified gen p mean: 0.45193731784820557, gen p mean: -0.10995417833328247, mean p set: 0.45251214504241943The modified gen p mean: 0.45211005210876465, gen p mean: -0.11432231217622757, mean p set: 0.45268896222114563
loss_pred:0.016004813835024834, decouple_loss:0.0007819283637218177
loss_pred:0.015072728507220745, decouple_loss:0.0010307470802217722
Iteration: 573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45070940256118774, gen p mean: -0.1095324456691742, mean p set: 0.45128652453422546
loss_pred:0.01604314334690571, decouple_loss:0.0011534239165484905
The modified gen p mean: 0.45051974058151245, gen p mean: -0.11422817409038544, mean p set: 0.45109736919403076The modified gen p mean: 0.4510042071342468, gen p mean: -0.10990859568119049, mean p set: 0.4515817165374756
loss_pred:0.015595908276736736, decouple_loss:0.0008016616920940578
loss_pred:0.016571994870901108, decouple_loss:0.0008486954611726105
Iteration: 574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518450200557709, gen p mean: -0.10895384103059769, mean p set: 0.4524218738079071
loss_pred:0.016085153445601463, decouple_loss:0.0010847907979041338
The modified gen p mean: 0.4503720998764038, gen p mean: -0.11009610444307327, mean p set: 0.45094895362854004
loss_pred:0.015832796692848206, decouple_loss:0.0011079825926572084
The modified gen p mean: 0.45177897810935974, gen p mean: -0.10956960916519165, mean p set: 0.45235851407051086
loss_pred:0.016121461987495422, decouple_loss:0.0012958904262632132
Iteration: 575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44976967573165894, gen p mean: -0.1099461019039154, mean p set: 0.45034632086753845
loss_pred:0.01610630750656128, decouple_loss:0.0008041309774853289
The modified gen p mean: 0.45013129711151123, gen p mean: -0.11078311502933502, mean p set: 0.4507088363170624
loss_pred:0.01605392061173916, decouple_loss:0.000898968952242285
The modified gen p mean: 0.4532850682735443, gen p mean: -0.10770303010940552, mean p set: 0.4538613259792328
loss_pred:0.015760164707899094, decouple_loss:0.0011647562496364117
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
NaN value num: 0
Iteration: 576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511043429374695, gen p mean: -0.10758039355278015, mean p set: 0.4516817331314087
loss_pred:0.01670202985405922, decouple_loss:0.0010431904811412096
The modified gen p mean: 0.45121249556541443, gen p mean: -0.10908002406358719, mean p set: 0.4517882466316223
The modified gen p mean: 0.45152047276496887, gen p mean: -0.10601207613945007, mean p set: 0.45209503173828125
loss_pred:0.016568101942539215, decouple_loss:0.0009104813798330724
loss_pred:0.015780705958604813, decouple_loss:0.0009207944967783988
Iteration: 577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049577951431274, gen p mean: -0.10716778039932251, mean p set: 0.451071560382843
loss_pred:0.016074830666184425, decouple_loss:0.001042266609147191
The modified gen p mean: 0.4520728886127472, gen p mean: -0.10470282286405563, mean p set: 0.45265111327171326
loss_pred:0.016920890659093857, decouple_loss:0.0009031816152855754
The modified gen p mean: 0.45108023285865784, gen p mean: -0.10209646075963974, mean p set: 0.45165497064590454
loss_pred:0.017359023913741112, decouple_loss:0.0011441626120358706
Iteration: 578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049023628234863, gen p mean: -0.11637212336063385, mean p set: 0.4510650634765625
loss_pred:0.016043301671743393, decouple_loss:0.0012898428831249475
The modified gen p mean: 0.4506591260433197, gen p mean: -0.11528131365776062, mean p set: 0.451235830783844
loss_pred:0.015294530428946018, decouple_loss:0.0010985753033310175
The modified gen p mean: 0.4518508017063141, gen p mean: -0.1141185387969017, mean p set: 0.45242658257484436
loss_pred:0.01683218404650688, decouple_loss:0.0011729896068572998
Iteration: 579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504586160182953, gen p mean: -0.12571801245212555, mean p set: 0.4510363042354584
The modified gen p mean: 0.4547666311264038, gen p mean: -0.12261717021465302, mean p set: 0.4553443193435669
loss_pred:0.016769759356975555, decouple_loss:0.0009012031950987875
loss_pred:0.0166194848716259, decouple_loss:0.00127251329831779
The modified gen p mean: 0.4533442556858063, gen p mean: -0.1185724139213562, mean p set: 0.453921914100647
loss_pred:0.017232531681656837, decouple_loss:0.0011093680514022708
Iteration: 580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45191317796707153, gen p mean: -0.11413712054491043, mean p set: 0.45249199867248535
loss_pred:0.01674829237163067, decouple_loss:0.0013827247312292457
The modified gen p mean: 0.4509345293045044, gen p mean: -0.1155240535736084, mean p set: 0.4515113830566406
loss_pred:0.016435712575912476, decouple_loss:0.0010524361860007048
The modified gen p mean: 0.45194581151008606, gen p mean: -0.1084713265299797, mean p set: 0.45252126455307007
loss_pred:0.015783408656716347, decouple_loss:0.0013126191915944219
2023-05-01 01:10:52 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12552900612354279, mean p set: 0.4502691626548767
loss_pred:0.017711691558361053, decouple_loss:0.0010157132055610418
The modified gen p mean: 0.4495365619659424, gen p mean: -0.11967785656452179, mean p set: 0.4500633478164673
loss_pred:0.0169938113540411, decouple_loss:0.0012472582748159766
The modified gen p mean: 0.4497777223587036, gen p mean: -0.11852046847343445, mean p set: 0.45035696029663086
loss_pred:0.017297131940722466, decouple_loss:0.0012170725967735052
WV_1_PC_1_EH_0_PS_40, loss: 0.017392214387655258, avg_mse: 0.026917533949017525
current test mse: 0.026918
Iteration: 581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45029401779174805, gen p mean: -0.1130867674946785, mean p set: 0.45086991786956787
loss_pred:0.016263587400317192, decouple_loss:0.001119950320571661
The modified gen p mean: 0.45400136709213257, gen p mean: -0.11613719910383224, mean p set: 0.4545804262161255The modified gen p mean: 0.450021892786026, gen p mean: -0.11575766652822495, mean p set: 0.4505993127822876
loss_pred:0.01691773720085621, decouple_loss:0.0012991206021979451
loss_pred:0.016724878922104836, decouple_loss:0.0009864132152870297
Iteration: 582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44984376430511475, gen p mean: -0.12394687533378601, mean p set: 0.4504178762435913
loss_pred:0.016337687149643898, decouple_loss:0.0010812397813424468
The modified gen p mean: 0.4530203640460968, gen p mean: -0.12951381504535675, mean p set: 0.4535963535308838The modified gen p mean: 0.4517669379711151, gen p mean: -0.12121117115020752, mean p set: 0.4523443579673767
loss_pred:0.015778247267007828, decouple_loss:0.001169053022749722
loss_pred:0.016798336058855057, decouple_loss:0.000990229775197804
Iteration: 583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45373615622520447, gen p mean: -0.1170421689748764, mean p set: 0.45431381464004517
loss_pred:0.017265040427446365, decouple_loss:0.0018787244334816933
The modified gen p mean: 0.45032596588134766, gen p mean: -0.11841174960136414, mean p set: 0.4509033262729645
loss_pred:0.01619022898375988, decouple_loss:0.000971976260188967
The modified gen p mean: 0.44967490434646606, gen p mean: -0.11884356290102005, mean p set: 0.45025137066841125
loss_pred:0.016013169661164284, decouple_loss:0.001504059648141265
Iteration: 584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45263388752937317, gen p mean: -0.11069663614034653, mean p set: 0.45321348309516907
loss_pred:0.016494790092110634, decouple_loss:0.0013626952422782779
The modified gen p mean: 0.4517378807067871, gen p mean: -0.10626322031021118, mean p set: 0.45231500267982483
loss_pred:0.01595938205718994, decouple_loss:0.0013176583452150226
The modified gen p mean: 0.4522055387496948, gen p mean: -0.11056419461965561, mean p set: 0.4527818560600281
loss_pred:0.015883494168519974, decouple_loss:0.0012097927974537015
Iteration: 585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45272621512413025, gen p mean: -0.10381761193275452, mean p set: 0.4533047676086426
loss_pred:0.01693449169397354, decouple_loss:0.001247874926775694
The modified gen p mean: 0.45394760370254517, gen p mean: -0.11065543442964554, mean p set: 0.45452532172203064
loss_pred:0.016361543908715248, decouple_loss:0.0014419666258618236
The modified gen p mean: 0.45249122381210327, gen p mean: -0.10678008198738098, mean p set: 0.45306864380836487
loss_pred:0.017558058723807335, decouple_loss:0.0013608323642984033
Iteration: 586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45218801498413086, gen p mean: -0.11630619317293167, mean p set: 0.45276156067848206
loss_pred:0.016828499734401703, decouple_loss:0.0015095819253474474
The modified gen p mean: 0.4502827227115631, gen p mean: -0.10956986993551254, mean p set: 0.45086169242858887
loss_pred:0.017240749672055244, decouple_loss:0.0015374409267678857
The modified gen p mean: 0.45133891701698303, gen p mean: -0.11368915438652039, mean p set: 0.4519164264202118
loss_pred:0.01728399097919464, decouple_loss:0.0015292334137484431
Iteration: 587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45064300298690796, gen p mean: -0.11322665214538574, mean p set: 0.4512208104133606
loss_pred:0.016495291143655777, decouple_loss:0.000930209003854543
The modified gen p mean: 0.4528011083602905, gen p mean: -0.1078595295548439, mean p set: 0.45338064432144165
loss_pred:0.01761612854897976, decouple_loss:0.0009806504240259528
The modified gen p mean: 0.4493008553981781, gen p mean: -0.1150893047451973, mean p set: 0.4498787522315979
loss_pred:0.015587304718792439, decouple_loss:0.0012628664262592793
Iteration: 588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453949511051178, gen p mean: -0.12332507967948914, mean p set: 0.45452621579170227
loss_pred:0.016051243990659714, decouple_loss:0.001418010680936277
The modified gen p mean: 0.45299234986305237, gen p mean: -0.11473928391933441, mean p set: 0.4535713791847229
loss_pred:0.01719438098371029, decouple_loss:0.0015028479974716902
The modified gen p mean: 0.45263421535491943, gen p mean: -0.11589889973402023, mean p set: 0.4532093107700348
loss_pred:0.017234310507774353, decouple_loss:0.0015122646000236273
Iteration: 589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531511068344116, gen p mean: -0.11780260503292084, mean p set: 0.4537295699119568
loss_pred:0.017692508175969124, decouple_loss:0.0010780899319797754
The modified gen p mean: 0.45187199115753174, gen p mean: -0.12063775956630707, mean p set: 0.4524455666542053
loss_pred:0.01699169911444187, decouple_loss:0.0010607577860355377
The modified gen p mean: 0.45107483863830566, gen p mean: -0.11605585366487503, mean p set: 0.4516505002975464
loss_pred:0.016564907506108284, decouple_loss:0.0011303119827061892
Iteration: 590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530113935470581, gen p mean: -0.1379273384809494, mean p set: 0.45358556509017944
loss_pred:0.01707707718014717, decouple_loss:0.0009854378877207637
The modified gen p mean: 0.4504771828651428, gen p mean: -0.1194465309381485, mean p set: 0.45105352997779846
loss_pred:0.018292222172021866, decouple_loss:0.0011617232812568545
The modified gen p mean: 0.4516471326351166, gen p mean: -0.134542316198349, mean p set: 0.45222437381744385
loss_pred:0.017948294058442116, decouple_loss:0.001050941296853125
2023-05-01 01:12:59 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12845513224601746, mean p set: 0.4502691626548767
loss_pred:0.01872234418988228, decouple_loss:0.0010655283695086837
The modified gen p mean: 0.44953596591949463, gen p mean: -0.12261530011892319, mean p set: 0.4500633478164673
loss_pred:0.018255844712257385, decouple_loss:0.0010835232678800821
The modified gen p mean: 0.44978249073028564, gen p mean: -0.12218984961509705, mean p set: 0.45035696029663086
loss_pred:0.01833183877170086, decouple_loss:0.0010456001618877053
WV_1_PC_1_EH_0_PS_40, loss: 0.01848992146551609, avg_mse: 0.028669552877545357
current test mse: 0.02867
Iteration: 591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960787892341614, gen p mean: -0.12273231893777847, mean p set: 0.45018270611763
loss_pred:0.016313964501023293, decouple_loss:0.001313634216785431
The modified gen p mean: 0.45224136114120483, gen p mean: -0.11673829704523087, mean p set: 0.4528190791606903
loss_pred:0.01700795441865921, decouple_loss:0.0009991350816562772
The modified gen p mean: 0.4523136019706726, gen p mean: -0.12211114168167114, mean p set: 0.45288947224617004
loss_pred:0.01708836480975151, decouple_loss:0.0011428289581090212
Iteration: 592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511401951313019, gen p mean: -0.10787782073020935, mean p set: 0.451716810464859
loss_pred:0.016764910891652107, decouple_loss:0.0010383661137893796
The modified gen p mean: 0.45324838161468506, gen p mean: -0.10900447517633438, mean p set: 0.45382463932037354The modified gen p mean: 0.45188936591148376, gen p mean: -0.11851251870393753, mean p set: 0.4524688422679901
loss_pred:0.017160726711153984, decouple_loss:0.0011421245289966464
loss_pred:0.016524558886885643, decouple_loss:0.0009564575739204884
Iteration: 593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503081142902374, gen p mean: -0.11099620163440704, mean p set: 0.45088624954223633
loss_pred:0.01772237755358219, decouple_loss:0.0009701775852590799
The modified gen p mean: 0.4518430531024933, gen p mean: -0.11178658157587051, mean p set: 0.4524182975292206
loss_pred:0.016821181401610374, decouple_loss:0.0008849876467138529
The modified gen p mean: 0.45149487257003784, gen p mean: -0.10843190550804138, mean p set: 0.4520728290081024
loss_pred:0.016847671940922737, decouple_loss:0.0010065214009955525
Iteration: 594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505072236061096, gen p mean: -0.103240467607975, mean p set: 0.45108428597450256
loss_pred:0.017137212678790092, decouple_loss:0.0010065396782010794
The modified gen p mean: 0.45014965534210205, gen p mean: -0.10753031820058823, mean p set: 0.4507260322570801
loss_pred:0.017087431624531746, decouple_loss:0.0009554682183079422
The modified gen p mean: 0.4493691027164459, gen p mean: -0.10781610757112503, mean p set: 0.4499439597129822
loss_pred:0.016329647973179817, decouple_loss:0.0010105165420100093
Iteration: 595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494878053665161, gen p mean: -0.11553103476762772, mean p set: 0.45006391406059265
loss_pred:0.015533757396042347, decouple_loss:0.0008191578672267497
The modified gen p mean: 0.4503280222415924, gen p mean: -0.11638682335615158, mean p set: 0.45090457797050476
loss_pred:0.015840932726860046, decouple_loss:0.0011881290702149272
The modified gen p mean: 0.4524891674518585, gen p mean: -0.10930023342370987, mean p set: 0.453065425157547
loss_pred:0.01691887527704239, decouple_loss:0.0008961884886957705
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44664785265922546, gen p mean: -0.13556210696697235, mean p set: 0.44722431898117065
The modified gen p mean: 0.44686123728752136, gen p mean: -0.1334599256515503, mean p set: 0.44743674993515015loss_pred:0.01680835708975792, decouple_loss:0.001029104576446116
loss_pred:0.016603078693151474, decouple_loss:0.0009576508309692144
The modified gen p mean: 0.4468995928764343, gen p mean: -0.13294489681720734, mean p set: 0.4474724233150482
loss_pred:0.017054477706551552, decouple_loss:0.0009156028390862048
Iteration: 597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465530812740326, gen p mean: -0.1309850662946701, mean p set: 0.4471304714679718
loss_pred:0.017560673877596855, decouple_loss:0.0011350082932040095
The modified gen p mean: 0.4471607506275177, gen p mean: -0.12859584391117096, mean p set: 0.44773682951927185
The modified gen p mean: 0.44652047753334045, gen p mean: -0.12729914486408234, mean p set: 0.44709739089012146
loss_pred:0.016021644696593285, decouple_loss:0.0014317553723230958
loss_pred:0.017451690509915352, decouple_loss:0.0011416419874876738
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466264247894287, gen p mean: -0.12355595827102661, mean p set: 0.4472024440765381
loss_pred:0.01662665605545044, decouple_loss:0.001057133194990456
The modified gen p mean: 0.4471023380756378, gen p mean: -0.12607985734939575, mean p set: 0.44768035411834717
loss_pred:0.01629575528204441, decouple_loss:0.0011352504370734096
The modified gen p mean: 0.4458104372024536, gen p mean: -0.12738996744155884, mean p set: 0.44638508558273315
loss_pred:0.016230423003435135, decouple_loss:0.0011926060542464256
Iteration: 599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473721981048584, gen p mean: -0.12472223490476608, mean p set: 0.4479503035545349
loss_pred:0.015641698613762856, decouple_loss:0.0008116333046928048
The modified gen p mean: 0.44644349813461304, gen p mean: -0.12104812264442444, mean p set: 0.4470199644565582
loss_pred:0.01611766777932644, decouple_loss:0.0009336172952316701
The modified gen p mean: 0.4465925693511963, gen p mean: -0.12295689433813095, mean p set: 0.44716861844062805
loss_pred:0.016249319538474083, decouple_loss:0.0008671807590872049
Iteration: 600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730883836746216, gen p mean: -0.12764312326908112, mean p set: 0.447883665561676
loss_pred:0.01712667942047119, decouple_loss:0.0010112490272149444
The modified gen p mean: 0.44726747274398804, gen p mean: -0.13059431314468384, mean p set: 0.4478432536125183
loss_pred:0.016553768888115883, decouple_loss:0.001181424711830914
The modified gen p mean: 0.44625240564346313, gen p mean: -0.12619775533676147, mean p set: 0.4468272626399994
loss_pred:0.016712652519345284, decouple_loss:0.001998741878196597
2023-05-01 01:15:47 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13007774949073792, mean p set: 0.4502691626548767
loss_pred:0.017905917018651962, decouple_loss:0.001346905017271638
The modified gen p mean: 0.44953081011772156, gen p mean: -0.12496525794267654, mean p set: 0.4500633478164673
loss_pred:0.017144205048680305, decouple_loss:0.0012529899831861258
The modified gen p mean: 0.44978007674217224, gen p mean: -0.1242566779255867, mean p set: 0.45035696029663086
loss_pred:0.017451835796236992, decouple_loss:0.0012048427015542984
WV_1_PC_1_EH_0_PS_40, loss: 0.017564065754413605, avg_mse: 0.02702961303293705
current test mse: 0.02703
Iteration: 601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752225279808044, gen p mean: -0.12100288271903992, mean p set: 0.4480966627597809
loss_pred:0.0161297544836998, decouple_loss:0.0009880694560706615
The modified gen p mean: 0.4461629092693329, gen p mean: -0.1275094747543335, mean p set: 0.4467359483242035
loss_pred:0.016590286046266556, decouple_loss:0.001351907616481185
The modified gen p mean: 0.44687551259994507, gen p mean: -0.12377645075321198, mean p set: 0.44745174050331116
loss_pred:0.01655273139476776, decouple_loss:0.0012547299265861511
Iteration: 602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462108612060547, gen p mean: -0.12913835048675537, mean p set: 0.44678789377212524
loss_pred:0.015668347477912903, decouple_loss:0.0009936501737684011
The modified gen p mean: 0.44657212495803833, gen p mean: -0.13290758430957794, mean p set: 0.44714680314064026The modified gen p mean: 0.44775423407554626, gen p mean: -0.1292124092578888, mean p set: 0.4483300447463989
loss_pred:0.016082750633358955, decouple_loss:0.0010410021059215069
loss_pred:0.016246849671006203, decouple_loss:0.0010222484124824405
Iteration: 603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464060664176941, gen p mean: -0.13177503645420074, mean p set: 0.44698208570480347
loss_pred:0.01709866337478161, decouple_loss:0.0016635899664834142
The modified gen p mean: 0.44687920808792114, gen p mean: -0.13673391938209534, mean p set: 0.44745466113090515The modified gen p mean: 0.4474357068538666, gen p mean: -0.13563719391822815, mean p set: 0.4480128884315491
loss_pred:0.01586379110813141, decouple_loss:0.0015329405432567loss_pred:0.016901163384318352, decouple_loss:0.0012930749217048287
Iteration: 604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642534852027893, gen p mean: -0.1316487193107605, mean p set: 0.4469989240169525
loss_pred:0.01601046696305275, decouple_loss:0.0012867047917097807
The modified gen p mean: 0.446923166513443, gen p mean: -0.1347063034772873, mean p set: 0.44749605655670166
loss_pred:0.016374092549085617, decouple_loss:0.0015085219638422132
The modified gen p mean: 0.4466794729232788, gen p mean: -0.1405622512102127, mean p set: 0.44725584983825684
loss_pred:0.01584339328110218, decouple_loss:0.0011881199898198247
Iteration: 605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668465852737427, gen p mean: -0.13531507551670074, mean p set: 0.44726207852363586
loss_pred:0.015775049105286598, decouple_loss:0.0009235038887709379
The modified gen p mean: 0.4471204876899719, gen p mean: -0.13725726306438446, mean p set: 0.4476989209651947
The modified gen p mean: 0.4468819200992584, gen p mean: -0.1314241737127304, mean p set: 0.44745591282844543
loss_pred:0.016084881499409676, decouple_loss:0.0011274453718215227
loss_pred:0.01592254266142845, decouple_loss:0.0009473940008319914
Iteration: 606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44572073221206665, gen p mean: -0.13107337057590485, mean p set: 0.4462953209877014
loss_pred:0.015235948376357555, decouple_loss:0.0014254130655899644
The modified gen p mean: 0.4462890923023224, gen p mean: -0.12911772727966309, mean p set: 0.4468649923801422
loss_pred:0.015871046110987663, decouple_loss:0.0009819242404773831
The modified gen p mean: 0.4464089274406433, gen p mean: -0.13137474656105042, mean p set: 0.4469858705997467
loss_pred:0.016339395195245743, decouple_loss:0.0011455488856881857
Iteration: 607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44602108001708984, gen p mean: -0.1261654645204544, mean p set: 0.44659891724586487
loss_pred:0.016180183738470078, decouple_loss:0.0011219009757041931
The modified gen p mean: 0.4474150538444519, gen p mean: -0.12377697229385376, mean p set: 0.4479900598526001
The modified gen p mean: 0.44747453927993774, gen p mean: -0.13266411423683167, mean p set: 0.4480500817298889
loss_pred:0.016384435817599297, decouple_loss:0.0008460598182864487
loss_pred:0.01494640577584505, decouple_loss:0.000989467022009194
Iteration: 608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455689489841461, gen p mean: -0.1253361850976944, mean p set: 0.4461430609226227
loss_pred:0.016596414148807526, decouple_loss:0.0011419117217883468
The modified gen p mean: 0.4469907581806183, gen p mean: -0.1280032843351364, mean p set: 0.44756782054901123
loss_pred:0.01535002700984478, decouple_loss:0.000883117550984025
The modified gen p mean: 0.4476204812526703, gen p mean: -0.12473660707473755, mean p set: 0.44819650053977966
loss_pred:0.015424993820488453, decouple_loss:0.0009393314248882234
Iteration: 609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749391078948975, gen p mean: -0.1283561736345291, mean p set: 0.4480704963207245
loss_pred:0.016077633947134018, decouple_loss:0.001039224909618497
The modified gen p mean: 0.44643452763557434, gen p mean: -0.12615153193473816, mean p set: 0.44700896739959717
loss_pred:0.015528988093137741, decouple_loss:0.0011735474690794945
The modified gen p mean: 0.4459810256958008, gen p mean: -0.12435010075569153, mean p set: 0.4465586841106415
loss_pred:0.016181673854589462, decouple_loss:0.0012201279168948531
Iteration: 610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736248254776, gen p mean: -0.12608398497104645, mean p set: 0.4479365348815918
loss_pred:0.016175510361790657, decouple_loss:0.0009269402362406254
The modified gen p mean: 0.4476386606693268, gen p mean: -0.12180012464523315, mean p set: 0.44821488857269287
loss_pred:0.015832431614398956, decouple_loss:0.0008025994757190347
The modified gen p mean: 0.4458906352519989, gen p mean: -0.1287662237882614, mean p set: 0.4464685022830963
loss_pred:0.016409175470471382, decouple_loss:0.0008078065584413707
2023-05-01 01:17:53 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.1309192031621933, mean p set: 0.4502691626548767
loss_pred:0.017846982926130295, decouple_loss:0.0013835883000865579
The modified gen p mean: 0.4495351314544678, gen p mean: -0.12528489530086517, mean p set: 0.4500633478164673
loss_pred:0.016968393698334694, decouple_loss:0.0010094536701217294
The modified gen p mean: 0.44977813959121704, gen p mean: -0.12436892837285995, mean p set: 0.45035696029663086
loss_pred:0.01738492026925087, decouple_loss:0.000988856772892177
WV_1_PC_1_EH_0_PS_40, loss: 0.01745646446943283, avg_mse: 0.02694060280919075
current test mse: 0.026941
Iteration: 611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464896321296692, gen p mean: -0.1294480413198471, mean p set: 0.44706523418426514
loss_pred:0.015735281631350517, decouple_loss:0.0012154487194493413
The modified gen p mean: 0.4461514353752136, gen p mean: -0.12824063003063202, mean p set: 0.44672611355781555The modified gen p mean: 0.44645288586616516, gen p mean: -0.12381527572870255, mean p set: 0.44702792167663574
loss_pred:0.01557165663689375, decouple_loss:0.0009029830107465386loss_pred:0.016248608008027077, decouple_loss:0.0009424047311767936
Iteration: 612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715335965156555, gen p mean: -0.12349642813205719, mean p set: 0.44772863388061523
loss_pred:0.015515466220676899, decouple_loss:0.0009475916740484536
The modified gen p mean: 0.4454970359802246, gen p mean: -0.12343259155750275, mean p set: 0.4460710883140564The modified gen p mean: 0.44613325595855713, gen p mean: -0.12115157395601273, mean p set: 0.446708619594574
loss_pred:0.015321357175707817, decouple_loss:0.0011447659926488996
loss_pred:0.015728874132037163, decouple_loss:0.001190028851851821
Iteration: 613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469611346721649, gen p mean: -0.12202148884534836, mean p set: 0.4475388824939728
The modified gen p mean: 0.4463929235935211, gen p mean: -0.1217222809791565, mean p set: 0.44696730375289917
loss_pred:0.014536438509821892, decouple_loss:0.0011100798146799207
loss_pred:0.015184445306658745, decouple_loss:0.0013119379291310906
The modified gen p mean: 0.4470139741897583, gen p mean: -0.1219325140118599, mean p set: 0.4475901126861572
loss_pred:0.015787092968821526, decouple_loss:0.0012913078535348177
Iteration: 614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750937819480896, gen p mean: -0.11986467987298965, mean p set: 0.4480864405632019
loss_pred:0.015389746055006981, decouple_loss:0.001193856238387525
The modified gen p mean: 0.44714662432670593, gen p mean: -0.12777411937713623, mean p set: 0.4477214217185974
loss_pred:0.01550364401191473, decouple_loss:0.0012679374776780605
The modified gen p mean: 0.4461710751056671, gen p mean: -0.1214531883597374, mean p set: 0.44674646854400635
loss_pred:0.015123086050152779, decouple_loss:0.001132467295974493
Iteration: 615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785642623901367, gen p mean: -0.11752597987651825, mean p set: 0.4484312832355499
loss_pred:0.01559520699083805, decouple_loss:0.0009318088414147496
The modified gen p mean: 0.44564783573150635, gen p mean: -0.11890102922916412, mean p set: 0.44622352719306946
loss_pred:0.01587349735200405, decouple_loss:0.0011412379099056125
The modified gen p mean: 0.44694840908050537, gen p mean: -0.11841373145580292, mean p set: 0.44752398133277893
loss_pred:0.015104218386113644, decouple_loss:0.0008273624698631465
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
NaN value num: 0
Iteration: 616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757968187332153, gen p mean: -0.1165095791220665, mean p set: 0.44815483689308167
loss_pred:0.018341265618801117, decouple_loss:0.0009511001990176737
The modified gen p mean: 0.44697344303131104, gen p mean: -0.11882789433002472, mean p set: 0.4475480318069458
The modified gen p mean: 0.44803979992866516, gen p mean: -0.1115817204117775, mean p set: 0.4486178159713745
loss_pred:0.017589576542377472, decouple_loss:0.0010161710670217872
loss_pred:0.01829836331307888, decouple_loss:0.0010871865088120103
Iteration: 617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44517210125923157, gen p mean: -0.11520792543888092, mean p set: 0.4457470774650574
loss_pred:0.017035065218806267, decouple_loss:0.0008821991505101323
The modified gen p mean: 0.4474850594997406, gen p mean: -0.11077842116355896, mean p set: 0.4480600357055664
loss_pred:0.01838967390358448, decouple_loss:0.00089932611444965
The modified gen p mean: 0.4462883770465851, gen p mean: -0.11499955505132675, mean p set: 0.4468673765659332
loss_pred:0.017273232340812683, decouple_loss:0.0009531024843454361
Iteration: 618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44538769125938416, gen p mean: -0.11603036522865295, mean p set: 0.4459638297557831
loss_pred:0.016906866803765297, decouple_loss:0.0007901828503236175
The modified gen p mean: 0.44783681631088257, gen p mean: -0.1094168946146965, mean p set: 0.44841283559799194
loss_pred:0.01780945621430874, decouple_loss:0.0008856821805238724
The modified gen p mean: 0.44791069626808167, gen p mean: -0.11088213324546814, mean p set: 0.4484868049621582
loss_pred:0.01882275938987732, decouple_loss:0.0009755580686032772
Iteration: 619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44570645689964294, gen p mean: -0.11562362313270569, mean p set: 0.44628193974494934
loss_pred:0.017093956470489502, decouple_loss:0.0009793564677238464
The modified gen p mean: 0.44854292273521423, gen p mean: -0.1180562898516655, mean p set: 0.44912174344062805
loss_pred:0.01745731569826603, decouple_loss:0.0015923886094242334
The modified gen p mean: 0.45029404759407043, gen p mean: -0.11904608458280563, mean p set: 0.450869619846344
loss_pred:0.015988992527127266, decouple_loss:0.0013240152038633823
Iteration: 620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661131501197815, gen p mean: -0.13218477368354797, mean p set: 0.44718730449676514
loss_pred:0.017336325719952583, decouple_loss:0.0008843039395287633
The modified gen p mean: 0.4482201933860779, gen p mean: -0.1244424507021904, mean p set: 0.4487939476966858
loss_pred:0.017176076769828796, decouple_loss:0.0009831752395257354
The modified gen p mean: 0.44570237398147583, gen p mean: -0.12365793436765671, mean p set: 0.4462781846523285
loss_pred:0.018612947314977646, decouple_loss:0.001202747575007379
2023-05-01 01:20:36 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13356022536754608, mean p set: 0.4502691626548767
loss_pred:0.017670344561338425, decouple_loss:0.001165385590866208
The modified gen p mean: 0.44953787326812744, gen p mean: -0.12818790972232819, mean p set: 0.4500633478164673
loss_pred:0.016893655061721802, decouple_loss:0.001244257902726531
The modified gen p mean: 0.44978034496307373, gen p mean: -0.1274721473455429, mean p set: 0.45035696029663086
loss_pred:0.01733277551829815, decouple_loss:0.0012135255383327603
WV_1_PC_1_EH_0_PS_40, loss: 0.017359312623739243, avg_mse: 0.026798130944371223
current test mse: 0.026798
Iteration: 621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460262954235077, gen p mean: -0.13301780819892883, mean p set: 0.44659915566444397
loss_pred:0.017161808907985687, decouple_loss:0.0010172639740630984
The modified gen p mean: 0.4482678472995758, gen p mean: -0.1351780742406845, mean p set: 0.4488413631916046
loss_pred:0.01716408133506775, decouple_loss:0.0009274779004044831
The modified gen p mean: 0.4443954527378082, gen p mean: -0.13193023204803467, mean p set: 0.4449720084667206
loss_pred:0.017923105508089066, decouple_loss:0.0011538465041667223
Iteration: 622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447127103805542, gen p mean: -0.13098406791687012, mean p set: 0.44770243763923645
loss_pred:0.017400261014699936, decouple_loss:0.0007641667034476995
The modified gen p mean: 0.44708770513534546, gen p mean: -0.1364057958126068, mean p set: 0.4476630687713623
The modified gen p mean: 0.44843611121177673, gen p mean: -0.130570188164711, mean p set: 0.4490150213241577
loss_pred:0.017476780340075493, decouple_loss:0.0011086910963058472
loss_pred:0.01886557973921299, decouple_loss:0.0009410612401552498
Iteration: 623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4446544647216797, gen p mean: -0.13265135884284973, mean p set: 0.4452323615550995
loss_pred:0.016738982871174812, decouple_loss:0.0008605931652709842
The modified gen p mean: 0.44646507501602173, gen p mean: -0.12817621231079102, mean p set: 0.4470408260822296The modified gen p mean: 0.44806957244873047, gen p mean: -0.13261860609054565, mean p set: 0.4486467242240906
loss_pred:0.017134280875325203, decouple_loss:0.0008754972368478775
loss_pred:0.017229363322257996, decouple_loss:0.0009844248415902257
Iteration: 624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719913601875305, gen p mean: -0.12368442118167877, mean p set: 0.4477749764919281
loss_pred:0.018424319103360176, decouple_loss:0.0006900817970745265
The modified gen p mean: 0.4491461217403412, gen p mean: -0.12833033502101898, mean p set: 0.4497237801551819
loss_pred:0.017239820212125778, decouple_loss:0.0009070344385690987
The modified gen p mean: 0.44753965735435486, gen p mean: -0.1233150064945221, mean p set: 0.44811511039733887
loss_pred:0.017577892169356346, decouple_loss:0.0010917455656453967
Iteration: 625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44639334082603455, gen p mean: -0.12469258159399033, mean p set: 0.4469718039035797
loss_pred:0.017398569732904434, decouple_loss:0.0009234381723217666
The modified gen p mean: 0.44989946484565735, gen p mean: -0.12399005144834518, mean p set: 0.4504740536212921
loss_pred:0.01586589589715004, decouple_loss:0.0007802618783898652
The modified gen p mean: 0.44917750358581543, gen p mean: -0.12690763175487518, mean p set: 0.449752539396286
loss_pred:0.015920450910925865, decouple_loss:0.0007883289363235235
Iteration: 626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460158348083496, gen p mean: -0.1205727756023407, mean p set: 0.44658976793289185
loss_pred:0.01755756326019764, decouple_loss:0.0008239959715865552
The modified gen p mean: 0.4482060372829437, gen p mean: -0.1273193359375, mean p set: 0.4487829804420471
loss_pred:0.0169999897480011, decouple_loss:0.0009443043381907046
The modified gen p mean: 0.44687148928642273, gen p mean: -0.12297350913286209, mean p set: 0.4474453032016754
loss_pred:0.017512483522295952, decouple_loss:0.0007960319053381681
Iteration: 627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467019736766815, gen p mean: -0.11775898188352585, mean p set: 0.447277694940567
loss_pred:0.01853206753730774, decouple_loss:0.0011178961722180247
The modified gen p mean: 0.4478134214878082, gen p mean: -0.11270950734615326, mean p set: 0.4483906924724579
loss_pred:0.017362995073199272, decouple_loss:0.001009164028801024
The modified gen p mean: 0.4467584788799286, gen p mean: -0.11794809252023697, mean p set: 0.4473304748535156
loss_pred:0.01790241152048111, decouple_loss:0.0010792622342705727
Iteration: 628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44520100951194763, gen p mean: -0.1184171587228775, mean p set: 0.44577544927597046
loss_pred:0.01666843518614769, decouple_loss:0.0009562317281961441
The modified gen p mean: 0.446707159280777, gen p mean: -0.11573469638824463, mean p set: 0.44727998971939087
loss_pred:0.017428558319807053, decouple_loss:0.0007590470486320555
The modified gen p mean: 0.4469279646873474, gen p mean: -0.11937085539102554, mean p set: 0.44750338792800903
loss_pred:0.017444560304284096, decouple_loss:0.001288549043238163
Iteration: 629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852691888809204, gen p mean: -0.1115674301981926, mean p set: 0.4491027295589447
loss_pred:0.017180224880576134, decouple_loss:0.001137595041655004
The modified gen p mean: 0.4472070038318634, gen p mean: -0.1102730929851532, mean p set: 0.4477825164794922
loss_pred:0.01665458269417286, decouple_loss:0.001132471370510757
The modified gen p mean: 0.4465421140193939, gen p mean: -0.11932040005922318, mean p set: 0.44711804389953613
loss_pred:0.01735381968319416, decouple_loss:0.000771981431171298
Iteration: 630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473893642425537, gen p mean: -0.1120070293545723, mean p set: 0.4479677379131317
loss_pred:0.01790986768901348, decouple_loss:0.0007448280230164528
The modified gen p mean: 0.445853590965271, gen p mean: -0.1202162429690361, mean p set: 0.44642698764801025
loss_pred:0.01761379837989807, decouple_loss:0.0008158399723470211
The modified gen p mean: 0.4466201364994049, gen p mean: -0.11314030736684799, mean p set: 0.4471952021121979
loss_pred:0.01670590415596962, decouple_loss:0.000875006546266377
2023-05-01 01:22:41 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12147825211286545, mean p set: 0.4502691626548767
loss_pred:0.017530618235468864, decouple_loss:0.0007608888554386795
The modified gen p mean: 0.44953492283821106, gen p mean: -0.11627551913261414, mean p set: 0.4500633478164673
loss_pred:0.01699870079755783, decouple_loss:0.0008555151289328933
The modified gen p mean: 0.449780136346817, gen p mean: -0.11566797643899918, mean p set: 0.45035696029663086
loss_pred:0.01734006591141224, decouple_loss:0.0007708643097430468
WV_1_PC_1_EH_0_PS_40, loss: 0.017329584807157516, avg_mse: 0.02683587186038494
current test mse: 0.026836
Iteration: 631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496650993824005, gen p mean: -0.11768726259469986, mean p set: 0.4502406716346741
loss_pred:0.016323305666446686, decouple_loss:0.0006770578329451382
The modified gen p mean: 0.4494752287864685, gen p mean: -0.12322239577770233, mean p set: 0.4500530958175659The modified gen p mean: 0.44645556807518005, gen p mean: -0.118759386241436, mean p set: 0.4470330774784088
loss_pred:0.015473066829144955, decouple_loss:0.0006905459449626505
loss_pred:0.016483735293149948, decouple_loss:0.0008202214958146214
Iteration: 632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489958584308624, gen p mean: -0.1252060830593109, mean p set: 0.44957417249679565
loss_pred:0.015998251736164093, decouple_loss:0.000775121443439275
The modified gen p mean: 0.44806969165802, gen p mean: -0.11790761351585388, mean p set: 0.4486483037471771The modified gen p mean: 0.4457789957523346, gen p mean: -0.11940954625606537, mean p set: 0.44635626673698425
loss_pred:0.017605578526854515, decouple_loss:0.000823796377517283
loss_pred:0.017023373395204544, decouple_loss:0.0008505188743583858
Iteration: 633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44504910707473755, gen p mean: -0.1231793686747551, mean p set: 0.4456256330013275
The modified gen p mean: 0.44743573665618896, gen p mean: -0.11964467167854309, mean p set: 0.4480111598968506
loss_pred:0.017525741830468178, decouple_loss:0.0008204766199924052
loss_pred:0.017341848462820053, decouple_loss:0.0006557311280630529
The modified gen p mean: 0.4479252099990845, gen p mean: -0.12021712958812714, mean p set: 0.4485023021697998
loss_pred:0.01855531707406044, decouple_loss:0.0008232444524765015
Iteration: 634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4441021978855133, gen p mean: -0.1224547028541565, mean p set: 0.44467902183532715
The modified gen p mean: 0.4453057050704956, gen p mean: -0.12447542697191238, mean p set: 0.44588083028793335loss_pred:0.01769058033823967, decouple_loss:0.0008328987169079483
loss_pred:0.01670043170452118, decouple_loss:0.000694662390742451
The modified gen p mean: 0.44617146253585815, gen p mean: -0.12325377017259598, mean p set: 0.44674885272979736
loss_pred:0.01702788844704628, decouple_loss:0.0007397241424769163
Iteration: 635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757699966430664, gen p mean: -0.11715514212846756, mean p set: 0.4481523334980011
loss_pred:0.016659677028656006, decouple_loss:0.0010652946075424552
The modified gen p mean: 0.44574034214019775, gen p mean: -0.12131968885660172, mean p set: 0.4463125169277191
loss_pred:0.01745983213186264, decouple_loss:0.0009234158787876368
The modified gen p mean: 0.4475451111793518, gen p mean: -0.12305080890655518, mean p set: 0.4481199383735657
loss_pred:0.017262419685721397, decouple_loss:0.001092312391847372
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
NaN value num: 0
Iteration: 636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505693316459656, gen p mean: -0.10946761816740036, mean p set: 0.45114725828170776
The modified gen p mean: 0.4516313970088959, gen p mean: -0.10905560851097107, mean p set: 0.4522095024585724
loss_pred:0.01698593981564045, decouple_loss:0.0010878123575821519
loss_pred:0.017409633845090866, decouple_loss:0.0010340784210711718
The modified gen p mean: 0.45072048902511597, gen p mean: -0.10402812063694, mean p set: 0.45129746198654175
loss_pred:0.01790613681077957, decouple_loss:0.001121089211665094
Iteration: 637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45000359416007996, gen p mean: -0.10946008563041687, mean p set: 0.4505784809589386
loss_pred:0.01740633137524128, decouple_loss:0.0010223666904494166
The modified gen p mean: 0.451214075088501, gen p mean: -0.10740213096141815, mean p set: 0.4517900347709656
loss_pred:0.015756437554955482, decouple_loss:0.0012621743371710181
The modified gen p mean: 0.4493144452571869, gen p mean: -0.11249849200248718, mean p set: 0.44988977909088135
loss_pred:0.017349855974316597, decouple_loss:0.0009615049348212779
Iteration: 638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505324065685272, gen p mean: -0.10456965863704681, mean p set: 0.45110899209976196
loss_pred:0.01724408008158207, decouple_loss:0.0009149946854449809
The modified gen p mean: 0.45317819714546204, gen p mean: -0.11092015355825424, mean p set: 0.45375579595565796
loss_pred:0.016438394784927368, decouple_loss:0.0010101633379235864
The modified gen p mean: 0.4520930349826813, gen p mean: -0.09799246490001678, mean p set: 0.4526708722114563
loss_pred:0.015944253653287888, decouple_loss:0.0007687272736802697
Iteration: 639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526352882385254, gen p mean: -0.1003262847661972, mean p set: 0.453212171792984
loss_pred:0.017326567322015762, decouple_loss:0.0011220229789614677
The modified gen p mean: 0.4531871974468231, gen p mean: -0.10417366772890091, mean p set: 0.45376312732696533
loss_pred:0.016296351328492165, decouple_loss:0.0009379300172440708
The modified gen p mean: 0.45213842391967773, gen p mean: -0.10371498763561249, mean p set: 0.4527163803577423
loss_pred:0.017058882862329483, decouple_loss:0.0010622016852721572
Iteration: 640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44956174492836, gen p mean: -0.10233762860298157, mean p set: 0.45013684034347534
loss_pred:0.017177443951368332, decouple_loss:0.0012286783894523978
The modified gen p mean: 0.4519193470478058, gen p mean: -0.09907069057226181, mean p set: 0.45249712467193604
loss_pred:0.01640203595161438, decouple_loss:0.0013825969072058797
The modified gen p mean: 0.4535212516784668, gen p mean: -0.10407255589962006, mean p set: 0.45409834384918213
loss_pred:0.016345525160431862, decouple_loss:0.000976793933659792
2023-05-01 01:25:30 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11075621098279953, mean p set: 0.4502691626548767
loss_pred:0.017828552052378654, decouple_loss:0.001176165067590773
The modified gen p mean: 0.4495338797569275, gen p mean: -0.10533911734819412, mean p set: 0.4500633478164673
loss_pred:0.017103055492043495, decouple_loss:0.0011242968030273914
The modified gen p mean: 0.4497803747653961, gen p mean: -0.10443340986967087, mean p set: 0.45035696029663086
loss_pred:0.01746080256998539, decouple_loss:0.0011386704863980412
WV_1_PC_1_EH_0_PS_40, loss: 0.017521455883979797, avg_mse: 0.027196010574698448
current test mse: 0.027196
Iteration: 641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483793079853058, gen p mean: -0.10526034981012344, mean p set: 0.44895628094673157
loss_pred:0.0169374980032444, decouple_loss:0.0016277270624414086
The modified gen p mean: 0.45191508531570435, gen p mean: -0.10133250802755356, mean p set: 0.4524913430213928The modified gen p mean: 0.4533615708351135, gen p mean: -0.09930633753538132, mean p set: 0.4539388418197632
loss_pred:0.0174850020557642, decouple_loss:0.001361055881716311
loss_pred:0.01632077246904373, decouple_loss:0.0013491231948137283
Iteration: 642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45074671506881714, gen p mean: -0.10585664212703705, mean p set: 0.4513225853443146
The modified gen p mean: 0.4490232765674591, gen p mean: -0.10578501224517822, mean p set: 0.4495995044708252
loss_pred:0.016248704865574837, decouple_loss:0.0009710384183563292
loss_pred:0.016939515247941017, decouple_loss:0.0009382250136695802
The modified gen p mean: 0.44992661476135254, gen p mean: -0.10296911746263504, mean p set: 0.4505026042461395
loss_pred:0.01681758463382721, decouple_loss:0.0011404665419831872
Iteration: 643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528256356716156, gen p mean: -0.10347892343997955, mean p set: 0.45340198278427124
loss_pred:0.016499822959303856, decouple_loss:0.001955684507265687
The modified gen p mean: 0.452879399061203, gen p mean: -0.10477297008037567, mean p set: 0.4534553289413452
loss_pred:0.01623442955315113, decouple_loss:0.0014231492532417178
The modified gen p mean: 0.45147475600242615, gen p mean: -0.10503728687763214, mean p set: 0.4520528018474579
loss_pred:0.01703866943717003, decouple_loss:0.0012239963980391622
Iteration: 644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534088671207428, gen p mean: -0.1107848584651947, mean p set: 0.4539874494075775
loss_pred:0.01579645276069641, decouple_loss:0.0014333993894979358
The modified gen p mean: 0.4502284526824951, gen p mean: -0.1032913476228714, mean p set: 0.4508056044578552
loss_pred:0.01704173907637596, decouple_loss:0.0011392658343538642
The modified gen p mean: 0.45223382115364075, gen p mean: -0.10642678290605545, mean p set: 0.4528115391731262
loss_pred:0.016979429870843887, decouple_loss:0.0015852452488616109
Iteration: 645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519244432449341, gen p mean: -0.10648529976606369, mean p set: 0.45250123739242554
loss_pred:0.016291050240397453, decouple_loss:0.0016339307185262442
The modified gen p mean: 0.4523153305053711, gen p mean: -0.10682383924722672, mean p set: 0.4528922438621521
loss_pred:0.016506826505064964, decouple_loss:0.001137068960815668
The modified gen p mean: 0.4515562653541565, gen p mean: -0.10580621659755707, mean p set: 0.4521334171295166
loss_pred:0.016206752508878708, decouple_loss:0.001167427166365087
Iteration: 646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519602060317993, gen p mean: -0.10513458400964737, mean p set: 0.4525359272956848
loss_pred:0.016552064567804337, decouple_loss:0.0015358531381934881
The modified gen p mean: 0.4512750506401062, gen p mean: -0.10431027412414551, mean p set: 0.4518507122993469
loss_pred:0.017086219042539597, decouple_loss:0.0012012911029160023
The modified gen p mean: 0.4507959485054016, gen p mean: -0.10782167315483093, mean p set: 0.4513719379901886
loss_pred:0.016791721805930138, decouple_loss:0.0011767223477363586
Iteration: 647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45146507024765015, gen p mean: -0.10529901087284088, mean p set: 0.4520423710346222
loss_pred:0.015759486705064774, decouple_loss:0.0009683539974503219
The modified gen p mean: 0.45191705226898193, gen p mean: -0.10457471758127213, mean p set: 0.4524938464164734
The modified gen p mean: 0.4516536593437195, gen p mean: -0.10559436678886414, mean p set: 0.4522283971309662
loss_pred:0.016092592850327492, decouple_loss:0.0011855131015181541
loss_pred:0.01660054735839367, decouple_loss:0.0014507415471598506
Iteration: 648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45058831572532654, gen p mean: -0.114054836332798, mean p set: 0.45116573572158813
loss_pred:0.01614225283265114, decouple_loss:0.001585054094903171
The modified gen p mean: 0.45021384954452515, gen p mean: -0.11025993525981903, mean p set: 0.45079126954078674
The modified gen p mean: 0.45044922828674316, gen p mean: -0.11000023037195206, mean p set: 0.45102712512016296
loss_pred:0.016772203147411346, decouple_loss:0.001955692656338215
loss_pred:0.016783449798822403, decouple_loss:0.001553017063997686
Iteration: 649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516203701496124, gen p mean: -0.10727445781230927, mean p set: 0.45219701528549194
loss_pred:0.01681911200284958, decouple_loss:0.001387537457048893
The modified gen p mean: 0.45266371965408325, gen p mean: -0.11061150580644608, mean p set: 0.45323994755744934
The modified gen p mean: 0.45052802562713623, gen p mean: -0.11034208536148071, mean p set: 0.4511038064956665
loss_pred:0.016706367954611778, decouple_loss:0.0010309778153896332
loss_pred:0.016123389825224876, decouple_loss:0.0011200765147805214
Iteration: 650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450437992811203, gen p mean: -0.10902644693851471, mean p set: 0.45101380348205566
loss_pred:0.017164690420031548, decouple_loss:0.001295329537242651
The modified gen p mean: 0.4493553936481476, gen p mean: -0.10700304806232452, mean p set: 0.4499339163303375
loss_pred:0.0172743983566761, decouple_loss:0.0011406263802200556
The modified gen p mean: 0.4532732665538788, gen p mean: -0.11085565388202667, mean p set: 0.4538503587245941
loss_pred:0.0156273040920496, decouple_loss:0.001467921887524426
2023-05-01 01:27:36 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1182933822274208, mean p set: 0.4502691626548767
loss_pred:0.017827849835157394, decouple_loss:0.0010719432029873133
The modified gen p mean: 0.44953304529190063, gen p mean: -0.11220524460077286, mean p set: 0.4500633478164673
loss_pred:0.01718772016465664, decouple_loss:0.0010901581263169646
The modified gen p mean: 0.4497779905796051, gen p mean: -0.1110149621963501, mean p set: 0.45035696029663086
loss_pred:0.017417898401618004, decouple_loss:0.0010990466689690948
WV_1_PC_1_EH_0_PS_40, loss: 0.01753217540681362, avg_mse: 0.0271137785166502
current test mse: 0.027114
Iteration: 651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45015934109687805, gen p mean: -0.11067230999469757, mean p set: 0.4507386088371277
loss_pred:0.016309095546603203, decouple_loss:0.0010837024310603738
The modified gen p mean: 0.4520694613456726, gen p mean: -0.10457548499107361, mean p set: 0.452647864818573
loss_pred:0.01612909883260727, decouple_loss:0.000980338198132813
The modified gen p mean: 0.45028701424598694, gen p mean: -0.11399761587381363, mean p set: 0.4508635997772217
loss_pred:0.01675795577466488, decouple_loss:0.0009250841685570776
Iteration: 652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45050138235092163, gen p mean: -0.10839010775089264, mean p set: 0.45107758045196533
loss_pred:0.01607658341526985, decouple_loss:0.0010674336226657033
The modified gen p mean: 0.45059895515441895, gen p mean: -0.10583583265542984, mean p set: 0.45117518305778503The modified gen p mean: 0.45281872153282166, gen p mean: -0.10495971143245697, mean p set: 0.45339396595954895
loss_pred:0.01560187991708517, decouple_loss:0.0010650476906448603
loss_pred:0.016707563772797585, decouple_loss:0.0009827049216255546
Iteration: 653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518987238407135, gen p mean: -0.10242055356502533, mean p set: 0.45247623324394226
loss_pred:0.016776463016867638, decouple_loss:0.0011605956824496388
The modified gen p mean: 0.45116615295410156, gen p mean: -0.10143786668777466, mean p set: 0.45174357295036316
loss_pred:0.01673513650894165, decouple_loss:0.0014258692972362041
The modified gen p mean: 0.4501439034938812, gen p mean: -0.10174747556447983, mean p set: 0.45072096586227417
loss_pred:0.016909945756196976, decouple_loss:0.0009636614704504609
Iteration: 654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169103145599365, gen p mean: -0.09776999801397324, mean p set: 0.45226943492889404
loss_pred:0.0161814596503973, decouple_loss:0.0010424538049846888
The modified gen p mean: 0.4502350986003876, gen p mean: -0.10504164546728134, mean p set: 0.45081186294555664
loss_pred:0.01671672612428665, decouple_loss:0.0009385450393892825
The modified gen p mean: 0.44943666458129883, gen p mean: -0.09854863584041595, mean p set: 0.4500125050544739
loss_pred:0.01665261574089527, decouple_loss:0.0008755699964240193
Iteration: 655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517394006252289, gen p mean: -0.09609253704547882, mean p set: 0.4523157775402069
loss_pred:0.016900384798645973, decouple_loss:0.0011158796260133386
The modified gen p mean: 0.45030948519706726, gen p mean: -0.09848662465810776, mean p set: 0.450886607170105
loss_pred:0.017114121466875076, decouple_loss:0.0011501783737912774
The modified gen p mean: 0.45203837752342224, gen p mean: -0.09651774168014526, mean p set: 0.452614963054657
loss_pred:0.015912311151623726, decouple_loss:0.0009530575480312109
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
NaN value num: 0
Iteration: 656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495350122451782, gen p mean: -0.09221649169921875, mean p set: 0.45011213421821594
loss_pred:0.01803518831729889, decouple_loss:0.0009389451006427407
The modified gen p mean: 0.4502030909061432, gen p mean: -0.09705708920955658, mean p set: 0.4507790505886078
The modified gen p mean: 0.4466477632522583, gen p mean: -0.09800828248262405, mean p set: 0.44722285866737366
loss_pred:0.01776406355202198, decouple_loss:0.0010210424661636353
loss_pred:0.01691455952823162, decouple_loss:0.001141896704211831
Iteration: 657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44985899329185486, gen p mean: -0.09686198830604553, mean p set: 0.45043426752090454
loss_pred:0.01702391356229782, decouple_loss:0.0012180025223642588
The modified gen p mean: 0.4478498697280884, gen p mean: -0.10426143556833267, mean p set: 0.44842615723609924
The modified gen p mean: 0.45066559314727783, gen p mean: -0.0945403054356575, mean p set: 0.4512411952018738
loss_pred:0.017816005274653435, decouple_loss:0.0017387482803314924
loss_pred:0.016122575849294662, decouple_loss:0.0015623283106833696
Iteration: 658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44923752546310425, gen p mean: -0.09537669271230698, mean p set: 0.4498141407966614
loss_pred:0.017829420045018196, decouple_loss:0.0009390979539602995
The modified gen p mean: 0.448645681142807, gen p mean: -0.1021522805094719, mean p set: 0.4492231011390686
loss_pred:0.017912130802869797, decouple_loss:0.0008365976391360164
The modified gen p mean: 0.4475330412387848, gen p mean: -0.09212756156921387, mean p set: 0.4481086730957031
loss_pred:0.01801595650613308, decouple_loss:0.0008659603190608323
Iteration: 659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481959640979767, gen p mean: -0.09441828727722168, mean p set: 0.448770135641098
loss_pred:0.018047351390123367, decouple_loss:0.0014689728850498796
The modified gen p mean: 0.4506934881210327, gen p mean: -0.09532558917999268, mean p set: 0.4512731432914734
loss_pred:0.01671729050576687, decouple_loss:0.0013579209335148335
The modified gen p mean: 0.44864022731781006, gen p mean: -0.09664261341094971, mean p set: 0.44921740889549255
loss_pred:0.017741085961461067, decouple_loss:0.0014217597199603915
Iteration: 660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506089389324188, gen p mean: -0.09866590052843094, mean p set: 0.4511849880218506
loss_pred:0.01698220521211624, decouple_loss:0.0010315448744222522
The modified gen p mean: 0.4470110237598419, gen p mean: -0.10223036259412766, mean p set: 0.44758492708206177
loss_pred:0.01696719415485859, decouple_loss:0.0011435034684836864
The modified gen p mean: 0.4493940472602844, gen p mean: -0.10223546624183655, mean p set: 0.44997039437294006
loss_pred:0.017082473263144493, decouple_loss:0.0014289969112724066
2023-05-01 01:30:26 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11488006263971329, mean p set: 0.4502691626548767
loss_pred:0.01788063906133175, decouple_loss:0.0011417892528697848
The modified gen p mean: 0.4495365023612976, gen p mean: -0.10915512591600418, mean p set: 0.4500633478164673
loss_pred:0.01709813065826893, decouple_loss:0.0011246392969042063
The modified gen p mean: 0.44978177547454834, gen p mean: -0.10797468572854996, mean p set: 0.45035696029663086
loss_pred:0.017335621640086174, decouple_loss:0.0009376110974699259
WV_1_PC_1_EH_0_PS_40, loss: 0.017491530627012253, avg_mse: 0.02705722115933895
current test mse: 0.027057
Iteration: 661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45076414942741394, gen p mean: -0.10250460356473923, mean p set: 0.45134055614471436
loss_pred:0.018051879480481148, decouple_loss:0.0011796863982453942
The modified gen p mean: 0.451062947511673, gen p mean: -0.1050560399889946, mean p set: 0.45164018869400024
The modified gen p mean: 0.449020653963089, gen p mean: -0.10135392844676971, mean p set: 0.44959574937820435
loss_pred:0.01585373468697071, decouple_loss:0.0011480535613372922
loss_pred:0.017320599406957626, decouple_loss:0.0009196423343382776
Iteration: 662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479426145553589, gen p mean: -0.11156823486089706, mean p set: 0.4485168755054474
The modified gen p mean: 0.4497460424900055, gen p mean: -0.10913148522377014, mean p set: 0.45032137632369995loss_pred:0.01735982671380043, decouple_loss:0.0014889080775901675
loss_pred:0.01729230023920536, decouple_loss:0.001113138860091567
The modified gen p mean: 0.45095664262771606, gen p mean: -0.10866289585828781, mean p set: 0.45153409242630005
loss_pred:0.016407473012804985, decouple_loss:0.0011357871117070317
Iteration: 663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489305317401886, gen p mean: -0.10713379085063934, mean p set: 0.4495069682598114
loss_pred:0.018060926347970963, decouple_loss:0.0009495237027294934
The modified gen p mean: 0.45046478509902954, gen p mean: -0.11035478860139847, mean p set: 0.4510430097579956
loss_pred:0.016326121985912323, decouple_loss:0.0008567504701204598
The modified gen p mean: 0.44929835200309753, gen p mean: -0.10930027812719345, mean p set: 0.4498726725578308
loss_pred:0.017985649406909943, decouple_loss:0.001133848913013935
Iteration: 664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484598934650421, gen p mean: -0.10619083791971207, mean p set: 0.4490378499031067
loss_pred:0.017220133915543556, decouple_loss:0.0008337476756423712
The modified gen p mean: 0.44810089468955994, gen p mean: -0.11126142740249634, mean p set: 0.44867488741874695
loss_pred:0.017244260758161545, decouple_loss:0.0011244366178289056
The modified gen p mean: 0.4488154649734497, gen p mean: -0.10744832456111908, mean p set: 0.44939300417900085
loss_pred:0.017011605203151703, decouple_loss:0.0008886388968676329
Iteration: 665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44664305448532104, gen p mean: -0.10739399492740631, mean p set: 0.44721853733062744
loss_pred:0.016532808542251587, decouple_loss:0.000966403866186738
The modified gen p mean: 0.447769433259964, gen p mean: -0.10817880183458328, mean p set: 0.44834598898887634
loss_pred:0.01696252077817917, decouple_loss:0.001028371276333928
The modified gen p mean: 0.4499359428882599, gen p mean: -0.10442516207695007, mean p set: 0.4505128264427185
loss_pred:0.016510820016264915, decouple_loss:0.0009119894239120185
Iteration: 666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500114321708679, gen p mean: -0.09613025933504105, mean p set: 0.4505882263183594
loss_pred:0.017854902893304825, decouple_loss:0.0008871520403772593
The modified gen p mean: 0.44759735465049744, gen p mean: -0.09794152528047562, mean p set: 0.44817185401916504
loss_pred:0.01783263124525547, decouple_loss:0.0014006979763507843
The modified gen p mean: 0.4493738114833832, gen p mean: -0.09585762023925781, mean p set: 0.44995033740997314
loss_pred:0.017477352172136307, decouple_loss:0.0013667314779013395
Iteration: 667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44902554154396057, gen p mean: -0.09235323220491409, mean p set: 0.44960159063339233
loss_pred:0.016878163442015648, decouple_loss:0.0008356241742148995
The modified gen p mean: 0.4501674771308899, gen p mean: -0.09723561257123947, mean p set: 0.45074358582496643
loss_pred:0.01712205447256565, decouple_loss:0.0014783866936340928
The modified gen p mean: 0.4501531720161438, gen p mean: -0.09682057797908783, mean p set: 0.45073163509368896
loss_pred:0.01783354952931404, decouple_loss:0.001413846854120493
Iteration: 668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479674994945526, gen p mean: -0.10039224475622177, mean p set: 0.4485437870025635
loss_pred:0.017489491030573845, decouple_loss:0.0012149749090895057
The modified gen p mean: 0.4506756663322449, gen p mean: -0.0964043140411377, mean p set: 0.45125463604927063
loss_pred:0.0155189149081707, decouple_loss:0.000946198997553438
The modified gen p mean: 0.44831374287605286, gen p mean: -0.09978511929512024, mean p set: 0.4488905668258667
loss_pred:0.017197901383042336, decouple_loss:0.001300620730035007
Iteration: 669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830116629600525, gen p mean: -0.1098153218626976, mean p set: 0.44887641072273254
loss_pred:0.017435602843761444, decouple_loss:0.0016347897471860051
The modified gen p mean: 0.4506309926509857, gen p mean: -0.10039263963699341, mean p set: 0.4512079358100891
loss_pred:0.01600652188062668, decouple_loss:0.0010175316128879786
The modified gen p mean: 0.45062756538391113, gen p mean: -0.10144206136465073, mean p set: 0.4512060284614563
loss_pred:0.017144029960036278, decouple_loss:0.0014780749334022403
Iteration: 670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763538241386414, gen p mean: -0.11407284438610077, mean p set: 0.4482121169567108
loss_pred:0.017368001863360405, decouple_loss:0.0017800932982936502
The modified gen p mean: 0.4504614472389221, gen p mean: -0.10297471284866333, mean p set: 0.4510376751422882
loss_pred:0.017224866896867752, decouple_loss:0.002022150903940201
The modified gen p mean: 0.44752225279808044, gen p mean: -0.10881102085113525, mean p set: 0.4480978846549988
loss_pred:0.01762651465833187, decouple_loss:0.0014698755694553256
2023-05-01 01:32:32 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12017592787742615, mean p set: 0.4502691626548767
loss_pred:0.017711443826556206, decouple_loss:0.0017030298477038741
The modified gen p mean: 0.44953441619873047, gen p mean: -0.11401085555553436, mean p set: 0.4500633478164673
loss_pred:0.016970330849289894, decouple_loss:0.001308494247496128
The modified gen p mean: 0.4497787654399872, gen p mean: -0.11324311792850494, mean p set: 0.45035696029663086
loss_pred:0.01733335480093956, decouple_loss:0.0012760295066982508
WV_1_PC_1_EH_0_PS_40, loss: 0.017409835010766983, avg_mse: 0.02704741805791855
current test mse: 0.027047
Iteration: 671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953787326812744, gen p mean: -0.11129935830831528, mean p set: 0.4501139223575592
loss_pred:0.016935233026742935, decouple_loss:0.0014371586730703712
The modified gen p mean: 0.44704964756965637, gen p mean: -0.1136457696557045, mean p set: 0.4476247727870941The modified gen p mean: 0.44787588715553284, gen p mean: -0.10702364146709442, mean p set: 0.44845154881477356
loss_pred:0.017979493364691734, decouple_loss:0.0011142428265884519
loss_pred:0.017155306413769722, decouple_loss:0.0015459530986845493
Iteration: 672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516269862651825, gen p mean: -0.1121797114610672, mean p set: 0.4522051215171814
The modified gen p mean: 0.4499387741088867, gen p mean: -0.10765744745731354, mean p set: 0.45051300525665283
loss_pred:0.016491863876581192, decouple_loss:0.0008285841322503984
loss_pred:0.016628144308924675, decouple_loss:0.0008781594806350768
The modified gen p mean: 0.4490482211112976, gen p mean: -0.10539333522319794, mean p set: 0.44962626695632935
loss_pred:0.01765557937324047, decouple_loss:0.0010434632422402501
Iteration: 673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44940119981765747, gen p mean: -0.11048915982246399, mean p set: 0.4499780237674713
loss_pred:0.017515460029244423, decouple_loss:0.0013858332531526685
The modified gen p mean: 0.44849199056625366, gen p mean: -0.10637255758047104, mean p set: 0.4490673840045929
loss_pred:0.017315605655312538, decouple_loss:0.0019474229775369167
The modified gen p mean: 0.45064207911491394, gen p mean: -0.10839802771806717, mean p set: 0.4512166678905487
loss_pred:0.016744395717978477, decouple_loss:0.0018540644086897373
Iteration: 674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489869177341461, gen p mean: -0.10586988180875778, mean p set: 0.4495622515678406
loss_pred:0.017706897109746933, decouple_loss:0.0019915918819606304
The modified gen p mean: 0.4472566843032837, gen p mean: -0.10937221348285675, mean p set: 0.4478309452533722
loss_pred:0.01784244179725647, decouple_loss:0.0018272348679602146
The modified gen p mean: 0.4483196437358856, gen p mean: -0.1028880923986435, mean p set: 0.44889700412750244
loss_pred:0.017643723636865616, decouple_loss:0.0015567542286589742
Iteration: 675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45003095269203186, gen p mean: -0.10900478065013885, mean p set: 0.4506089687347412
loss_pred:0.01700514741241932, decouple_loss:0.0016074489103630185
The modified gen p mean: 0.44854792952537537, gen p mean: -0.10876631736755371, mean p set: 0.449124276638031
loss_pred:0.016573311761021614, decouple_loss:0.0011648016516119242
The modified gen p mean: 0.4496992230415344, gen p mean: -0.10895787924528122, mean p set: 0.4502742886543274
loss_pred:0.017394883558154106, decouple_loss:0.0017244089394807816
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
NaN value num: 0
Iteration: 676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44974470138549805, gen p mean: -0.11391492933034897, mean p set: 0.4503222107887268
The modified gen p mean: 0.4484124779701233, gen p mean: -0.11932069063186646, mean p set: 0.44899022579193115
loss_pred:0.016732951626181602, decouple_loss:0.0008180841687135398
loss_pred:0.017483174800872803, decouple_loss:0.0009902083547785878
The modified gen p mean: 0.44769251346588135, gen p mean: -0.11926926672458649, mean p set: 0.4482679069042206
loss_pred:0.016788948327302933, decouple_loss:0.0009362036944366992
Iteration: 677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501418471336365, gen p mean: -0.1108778566122055, mean p set: 0.45071908831596375
loss_pred:0.017135825008153915, decouple_loss:0.0012052011443302035
The modified gen p mean: 0.4500257968902588, gen p mean: -0.11868878453969955, mean p set: 0.45060229301452637
The modified gen p mean: 0.4496719241142273, gen p mean: -0.1143297627568245, mean p set: 0.4502470791339874
loss_pred:0.01639541983604431, decouple_loss:0.0009260541410185397
loss_pred:0.017340674996376038, decouple_loss:0.0008540971903130412
Iteration: 678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496070146560669, gen p mean: -0.10554050654172897, mean p set: 0.4501826763153076
loss_pred:0.015872672200202942, decouple_loss:0.001503150095231831
The modified gen p mean: 0.44991621375083923, gen p mean: -0.1134694442152977, mean p set: 0.45049184560775757
loss_pred:0.01723421737551689, decouple_loss:0.0010223241988569498
The modified gen p mean: 0.44731244444847107, gen p mean: -0.1120767667889595, mean p set: 0.44788995385169983
loss_pred:0.016476061195135117, decouple_loss:0.001795853953808546
Iteration: 679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849514961242676, gen p mean: -0.09989000856876373, mean p set: 0.44907310605049133
loss_pred:0.01726372167468071, decouple_loss:0.0010004070354625583
The modified gen p mean: 0.44993212819099426, gen p mean: -0.0984458178281784, mean p set: 0.4505079984664917
The modified gen p mean: 0.44902700185775757, gen p mean: -0.10308185964822769, mean p set: 0.4496016502380371
loss_pred:0.016922123730182648, decouple_loss:0.0013839500024914742
loss_pred:0.017245417460799217, decouple_loss:0.0008832006715238094
Iteration: 680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502171277999878, gen p mean: -0.09646421670913696, mean p set: 0.4507937431335449
loss_pred:0.01612297259271145, decouple_loss:0.0010011745616793633
The modified gen p mean: 0.4495904743671417, gen p mean: -0.08961822092533112, mean p set: 0.45016783475875854
loss_pred:0.016104448586702347, decouple_loss:0.0009206344257108867
The modified gen p mean: 0.44704920053482056, gen p mean: -0.09964381903409958, mean p set: 0.4476262331008911
loss_pred:0.01584608666598797, decouple_loss:0.0009531017858535051
2023-05-01 01:35:20 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10274001955986023, mean p set: 0.4502691626548767
loss_pred:0.017743881791830063, decouple_loss:0.001814129762351513
The modified gen p mean: 0.44953787326812744, gen p mean: -0.09654590487480164, mean p set: 0.4500633478164673
loss_pred:0.017089422792196274, decouple_loss:0.0016708647599443793
The modified gen p mean: 0.4497794806957245, gen p mean: -0.09591470658779144, mean p set: 0.45035696029663086
loss_pred:0.017398975789546967, decouple_loss:0.0017528022872284055
WV_1_PC_1_EH_0_PS_40, loss: 0.017498057335615158, avg_mse: 0.027139363810420036
current test mse: 0.027139
Iteration: 681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477403163909912, gen p mean: -0.0914681926369667, mean p set: 0.4483179748058319
loss_pred:0.016756301745772362, decouple_loss:0.001708031864836812
The modified gen p mean: 0.4497879147529602, gen p mean: -0.09091383963823318, mean p set: 0.4503651261329651The modified gen p mean: 0.4477393329143524, gen p mean: -0.08994536101818085, mean p set: 0.4483151137828827
loss_pred:0.016735421493649483, decouple_loss:0.0016471570124849677loss_pred:0.016738498583436012, decouple_loss:0.0010125050321221352
Iteration: 682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493255019187927, gen p mean: -0.09155482053756714, mean p set: 0.44990259408950806
loss_pred:0.016179051250219345, decouple_loss:0.0018385315779596567
The modified gen p mean: 0.4483039677143097, gen p mean: -0.08923853188753128, mean p set: 0.44887787103652954The modified gen p mean: 0.44724735617637634, gen p mean: -0.08898060768842697, mean p set: 0.44782212376594543
loss_pred:0.017257720232009888, decouple_loss:0.0016779060242697597
loss_pred:0.01668825000524521, decouple_loss:0.002009294694289565
Iteration: 683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500137269496918, gen p mean: -0.09536153078079224, mean p set: 0.45058971643447876
loss_pred:0.01606120727956295, decouple_loss:0.0012705100234597921
The modified gen p mean: 0.4499139189720154, gen p mean: -0.08879610896110535, mean p set: 0.4504888951778412
loss_pred:0.016182715073227882, decouple_loss:0.0014455070486292243
The modified gen p mean: 0.4483262002468109, gen p mean: -0.08893086016178131, mean p set: 0.4489021897315979
loss_pred:0.017450235784053802, decouple_loss:0.001325717312283814
Iteration: 684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471701979637146, gen p mean: -0.0983169674873352, mean p set: 0.44774648547172546
loss_pred:0.015736201778054237, decouple_loss:0.0017112480709329247
The modified gen p mean: 0.44975897669792175, gen p mean: -0.09101758897304535, mean p set: 0.45033523440361023
loss_pred:0.01687588542699814, decouple_loss:0.0012978718150407076
The modified gen p mean: 0.44838809967041016, gen p mean: -0.09331794083118439, mean p set: 0.44896015524864197
loss_pred:0.01728174276649952, decouple_loss:0.0009273806936107576
Iteration: 685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472896158695221, gen p mean: -0.09627065807580948, mean p set: 0.4478653073310852
loss_pred:0.017632948234677315, decouple_loss:0.0010536810150370002
The modified gen p mean: 0.4473820626735687, gen p mean: -0.10282692313194275, mean p set: 0.4479601979255676
loss_pred:0.015823762863874435, decouple_loss:0.0018975515849888325
The modified gen p mean: 0.45024216175079346, gen p mean: -0.09443873167037964, mean p set: 0.45081809163093567
loss_pred:0.016441240906715393, decouple_loss:0.0011001715902239084
Iteration: 686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829222559928894, gen p mean: -0.09961943328380585, mean p set: 0.4488682746887207
loss_pred:0.016159703955054283, decouple_loss:0.0013422309421002865
The modified gen p mean: 0.44824105501174927, gen p mean: -0.0981658548116684, mean p set: 0.44881829619407654
loss_pred:0.01687132753431797, decouple_loss:0.0013276970712468028
The modified gen p mean: 0.45057815313339233, gen p mean: -0.10146104544401169, mean p set: 0.45115435123443604
loss_pred:0.016586415469646454, decouple_loss:0.001041228068061173
Iteration: 687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503038227558136, gen p mean: -0.09880077093839645, mean p set: 0.45088252425193787
loss_pred:0.0162802767008543, decouple_loss:0.0010023232316598296
The modified gen p mean: 0.44808536767959595, gen p mean: -0.10142697393894196, mean p set: 0.44866451621055603
The modified gen p mean: 0.4488634467124939, gen p mean: -0.10185958445072174, mean p set: 0.449439138174057
loss_pred:0.016214333474636078, decouple_loss:0.00099721341393888
loss_pred:0.016883039847016335, decouple_loss:0.0009122255723923445
Iteration: 688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485144317150116, gen p mean: -0.1029638722538948, mean p set: 0.4490925371646881
loss_pred:0.017928237095475197, decouple_loss:0.0008629468502476811
The modified gen p mean: 0.44955918192863464, gen p mean: -0.09651865810155869, mean p set: 0.45013487339019775
The modified gen p mean: 0.44734495878219604, gen p mean: -0.09933917969465256, mean p set: 0.4479213356971741
loss_pred:0.016662560403347015, decouple_loss:0.0008062829147092998
loss_pred:0.016109852120280266, decouple_loss:0.0008730528061278164
Iteration: 689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480856657028198, gen p mean: -0.09634987264871597, mean p set: 0.4486616849899292
loss_pred:0.017399106174707413, decouple_loss:0.001199563848786056
The modified gen p mean: 0.4489079415798187, gen p mean: -0.0981661006808281, mean p set: 0.44948336482048035
The modified gen p mean: 0.4484969973564148, gen p mean: -0.1016669049859047, mean p set: 0.4490744471549988
loss_pred:0.01742544211447239, decouple_loss:0.0011520719854161143
loss_pred:0.01697329431772232, decouple_loss:0.0012807180173695087
Iteration: 690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802191853523254, gen p mean: -0.09290739893913269, mean p set: 0.4485982656478882
loss_pred:0.017338929697871208, decouple_loss:0.001064021373167634
The modified gen p mean: 0.45019158720970154, gen p mean: -0.09063462913036346, mean p set: 0.4507671892642975
The modified gen p mean: 0.45018455386161804, gen p mean: -0.09355263411998749, mean p set: 0.4507611393928528
loss_pred:0.01704881340265274, decouple_loss:0.0010407479712739587
loss_pred:0.01703818514943123, decouple_loss:0.0012064626207575202
2023-05-01 01:37:26 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10888661444187164, mean p set: 0.4502691626548767
loss_pred:0.017932798713445663, decouple_loss:0.0009559676400385797
The modified gen p mean: 0.44953322410583496, gen p mean: -0.10254008322954178, mean p set: 0.4500633478164673
loss_pred:0.01706741563975811, decouple_loss:0.0008750199340283871
The modified gen p mean: 0.449780136346817, gen p mean: -0.10142108052968979, mean p set: 0.45035696029663086
loss_pred:0.01736082136631012, decouple_loss:0.0008894120692275465
WV_1_PC_1_EH_0_PS_40, loss: 0.01749902032315731, avg_mse: 0.02710292860865593
current test mse: 0.027103
Iteration: 691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500451683998108, gen p mean: -0.09853267669677734, mean p set: 0.4506188929080963
loss_pred:0.015819625928997993, decouple_loss:0.0010315028484910727
The modified gen p mean: 0.44781801104545593, gen p mean: -0.10002319514751434, mean p set: 0.44839444756507874The modified gen p mean: 0.4506533443927765, gen p mean: -0.0987296774983406, mean p set: 0.4512310028076172
loss_pred:0.01607978716492653, decouple_loss:0.0012618332402780652
loss_pred:0.015755444765090942, decouple_loss:0.0010278287809342146
Iteration: 692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829198718070984, gen p mean: -0.09671873599290848, mean p set: 0.44886893033981323
The modified gen p mean: 0.4480811059474945, gen p mean: -0.09591536223888397, mean p set: 0.44865772128105164
loss_pred:0.01781950518488884, decouple_loss:0.001020734547637403
loss_pred:0.01731024868786335, decouple_loss:0.0010188478045165539
The modified gen p mean: 0.44997507333755493, gen p mean: -0.09624454379081726, mean p set: 0.45055249333381653
loss_pred:0.01604255475103855, decouple_loss:0.0010186752770096064
Iteration: 693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504489302635193, gen p mean: -0.09682749211788177, mean p set: 0.4510261118412018
loss_pred:0.01565621793270111, decouple_loss:0.0008233957923948765
The modified gen p mean: 0.44768601655960083, gen p mean: -0.09479378163814545, mean p set: 0.44826221466064453
loss_pred:0.017098819836974144, decouple_loss:0.0008644228219054639
The modified gen p mean: 0.4474276900291443, gen p mean: -0.09648866206407547, mean p set: 0.44800323247909546
loss_pred:0.016376566141843796, decouple_loss:0.000929869303945452
Iteration: 694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505244195461273, gen p mean: -0.08927877992391586, mean p set: 0.4511011838912964
loss_pred:0.016855254769325256, decouple_loss:0.0009179413318634033
The modified gen p mean: 0.4473739266395569, gen p mean: -0.0937877893447876, mean p set: 0.447950154542923
loss_pred:0.01662403717637062, decouple_loss:0.0008226574282161891
The modified gen p mean: 0.4476463794708252, gen p mean: -0.08903735131025314, mean p set: 0.44822174310684204
loss_pred:0.017562290653586388, decouple_loss:0.0010319678112864494
Iteration: 695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449797660112381, gen p mean: -0.0923742726445198, mean p set: 0.4503746032714844
loss_pred:0.016550926491618156, decouple_loss:0.0008736596792005002
The modified gen p mean: 0.4500814378261566, gen p mean: -0.09401354938745499, mean p set: 0.4506576955318451
loss_pred:0.016433442011475563, decouple_loss:0.0010039894841611385
The modified gen p mean: 0.45053473114967346, gen p mean: -0.08807913213968277, mean p set: 0.45111238956451416
loss_pred:0.017702778801321983, decouple_loss:0.0010863619390875101
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
NaN value num: 0
Iteration: 696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450984388589859, gen p mean: -0.0954979807138443, mean p set: 0.45156213641166687
loss_pred:0.01704157516360283, decouple_loss:0.0012583198258653283
The modified gen p mean: 0.44965922832489014, gen p mean: -0.10384644567966461, mean p set: 0.45023781061172485
The modified gen p mean: 0.45019304752349854, gen p mean: -0.09558997303247452, mean p set: 0.4507688283920288
loss_pred:0.016383813694119453, decouple_loss:0.0010661969427019358
loss_pred:0.016916437074542046, decouple_loss:0.0012249117717146873
Iteration: 697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44995149970054626, gen p mean: -0.09894391149282455, mean p set: 0.4505264163017273
The modified gen p mean: 0.45034849643707275, gen p mean: -0.09853736311197281, mean p set: 0.4509258568286896
loss_pred:0.015838662162423134, decouple_loss:0.0009753156919032335
loss_pred:0.016061944887042046, decouple_loss:0.00097002083202824
The modified gen p mean: 0.451307475566864, gen p mean: -0.0978911891579628, mean p set: 0.4518826901912689
loss_pred:0.016582559794187546, decouple_loss:0.0009656592737883329
Iteration: 698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891414046287537, gen p mean: -0.1114875078201294, mean p set: 0.4494905471801758
loss_pred:0.016276294365525246, decouple_loss:0.0009677765192463994
The modified gen p mean: 0.4523946940898895, gen p mean: -0.10528751462697983, mean p set: 0.45297008752822876
loss_pred:0.01575728878378868, decouple_loss:0.0013273239601403475
The modified gen p mean: 0.4493633508682251, gen p mean: -0.11177226901054382, mean p set: 0.44993945956230164
loss_pred:0.015736699104309082, decouple_loss:0.0011646116618067026
Iteration: 699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45167481899261475, gen p mean: -0.1119857132434845, mean p set: 0.4522479474544525
loss_pred:0.01598997414112091, decouple_loss:0.000861938635352999
The modified gen p mean: 0.44973182678222656, gen p mean: -0.11107591539621353, mean p set: 0.45030689239501953
The modified gen p mean: 0.45218023657798767, gen p mean: -0.1059969887137413, mean p set: 0.45275649428367615
loss_pred:0.016314804553985596, decouple_loss:0.0009152073180302978
loss_pred:0.01571512036025524, decouple_loss:0.0009753023623488843
Iteration: 700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448835164308548, gen p mean: -0.12342724204063416, mean p set: 0.44941338896751404
The modified gen p mean: 0.4498824179172516, gen p mean: -0.11349314451217651, mean p set: 0.45045995712280273
loss_pred:0.01588955894112587, decouple_loss:0.0009366321028210223
loss_pred:0.01632566936314106, decouple_loss:0.0007452766294591129
The modified gen p mean: 0.4490128457546234, gen p mean: -0.11398681998252869, mean p set: 0.44958722591400146
loss_pred:0.016309916973114014, decouple_loss:0.000871624390129
2023-05-01 01:40:15 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12236165255308151, mean p set: 0.4502691626548767
loss_pred:0.017899686470627785, decouple_loss:0.0008483384735882282
The modified gen p mean: 0.4495321810245514, gen p mean: -0.11615453660488129, mean p set: 0.4500633478164673
loss_pred:0.017110558226704597, decouple_loss:0.0009452493977732956
The modified gen p mean: 0.44977933168411255, gen p mean: -0.1152438074350357, mean p set: 0.45035696029663086
loss_pred:0.017284058034420013, decouple_loss:0.0009295534109696746
WV_1_PC_1_EH_0_PS_40, loss: 0.017476819455623627, avg_mse: 0.027082612738013268
current test mse: 0.027083
Iteration: 701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504336714744568, gen p mean: -0.11293326318264008, mean p set: 0.4510088264942169
loss_pred:0.01569773629307747, decouple_loss:0.00093220139387995
The modified gen p mean: 0.4492764174938202, gen p mean: -0.11460570991039276, mean p set: 0.4498515725135803The modified gen p mean: 0.44918686151504517, gen p mean: -0.11365307122468948, mean p set: 0.44976404309272766
loss_pred:0.016433941200375557, decouple_loss:0.0010591269237920642loss_pred:0.015991106629371643, decouple_loss:0.0009403678704984486
Iteration: 702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450364887714386, gen p mean: -0.11257833987474442, mean p set: 0.4509424567222595
loss_pred:0.016036130487918854, decouple_loss:0.0008351065334863961
The modified gen p mean: 0.44778233766555786, gen p mean: -0.11011488735675812, mean p set: 0.4483596682548523The modified gen p mean: 0.4509509801864624, gen p mean: -0.11312992870807648, mean p set: 0.45152729749679565
loss_pred:0.016924159601330757, decouple_loss:0.0008909719181247056
loss_pred:0.0157180093228817, decouple_loss:0.0008432763279415667
Iteration: 703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517228305339813, gen p mean: -0.1086302399635315, mean p set: 0.4522995054721832
loss_pred:0.01572933979332447, decouple_loss:0.0009059339645318687
The modified gen p mean: 0.452070951461792, gen p mean: -0.11108094453811646, mean p set: 0.4526459276676178The modified gen p mean: 0.45122796297073364, gen p mean: -0.11401467025279999, mean p set: 0.4518038034439087
loss_pred:0.015714555978775024, decouple_loss:0.0009858222911134362
loss_pred:0.015170670114457607, decouple_loss:0.0010418611345812678
Iteration: 704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962698221206665, gen p mean: -0.11068210005760193, mean p set: 0.4502033293247223
loss_pred:0.01570802740752697, decouple_loss:0.0008234430570155382
The modified gen p mean: 0.4512762725353241, gen p mean: -0.1109422817826271, mean p set: 0.4518527686595917
loss_pred:0.015377989038825035, decouple_loss:0.0009063020115718246
The modified gen p mean: 0.4520648419857025, gen p mean: -0.10792441666126251, mean p set: 0.45264333486557007
loss_pred:0.015327434986829758, decouple_loss:0.0008411759044975042
Iteration: 705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044684410095215, gen p mean: -0.11338098347187042, mean p set: 0.4510234594345093
loss_pred:0.016698699444532394, decouple_loss:0.0007754830876365304
The modified gen p mean: 0.44993188977241516, gen p mean: -0.10939627140760422, mean p set: 0.4505072236061096
loss_pred:0.015901673585176468, decouple_loss:0.0008427433203905821
The modified gen p mean: 0.4499184489250183, gen p mean: -0.1186123639345169, mean p set: 0.4504929184913635
loss_pred:0.01606997661292553, decouple_loss:0.0008837881614454091
Iteration: 706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448906809091568, gen p mean: -0.11654708534479141, mean p set: 0.4494827091693878
loss_pred:0.016330424696207047, decouple_loss:0.0008885076967999339
The modified gen p mean: 0.44848960638046265, gen p mean: -0.12015318125486374, mean p set: 0.4490666687488556
The modified gen p mean: 0.4500831663608551, gen p mean: -0.11666680872440338, mean p set: 0.45065850019454956
loss_pred:0.01579771377146244, decouple_loss:0.0009259553626179695
loss_pred:0.015755731612443924, decouple_loss:0.0007567332359030843
Iteration: 707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496886730194092, gen p mean: -0.12048672884702682, mean p set: 0.45026248693466187
loss_pred:0.016453120857477188, decouple_loss:0.0008690472459420562
The modified gen p mean: 0.45005860924720764, gen p mean: -0.11499207466840744, mean p set: 0.4506358802318573
loss_pred:0.016674095764756203, decouple_loss:0.0008178533753380179
The modified gen p mean: 0.44752320647239685, gen p mean: -0.12134336680173874, mean p set: 0.44809824228286743
loss_pred:0.015807265415787697, decouple_loss:0.0009198400657624006
Iteration: 708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45020702481269836, gen p mean: -0.11032646149396896, mean p set: 0.4507831633090973
loss_pred:0.016579313203692436, decouple_loss:0.0009113176492974162
The modified gen p mean: 0.4476849138736725, gen p mean: -0.11547897756099701, mean p set: 0.4482645094394684
loss_pred:0.016519466415047646, decouple_loss:0.0010177972726523876
The modified gen p mean: 0.4508271813392639, gen p mean: -0.11368399858474731, mean p set: 0.45140528678894043
loss_pred:0.015380549244582653, decouple_loss:0.0008767183753661811
Iteration: 709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499964118003845, gen p mean: -0.11866101622581482, mean p set: 0.4505738615989685
loss_pred:0.015273147262632847, decouple_loss:0.0009718614164739847
The modified gen p mean: 0.4527384638786316, gen p mean: -0.10596124827861786, mean p set: 0.4533156752586365
The modified gen p mean: 0.45136141777038574, gen p mean: -0.1137048602104187, mean p set: 0.45193883776664734
loss_pred:0.016118694096803665, decouple_loss:0.0009654060704633594
loss_pred:0.015220274217426777, decouple_loss:0.001190560287795961
Iteration: 710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500282108783722, gen p mean: -0.10882685333490372, mean p set: 0.45060494542121887
loss_pred:0.01605496183037758, decouple_loss:0.001074517611414194
The modified gen p mean: 0.45189663767814636, gen p mean: -0.11234273761510849, mean p set: 0.45247551798820496
loss_pred:0.015412048436701298, decouple_loss:0.0008258226444013417
The modified gen p mean: 0.4494044780731201, gen p mean: -0.10518612712621689, mean p set: 0.4499800503253937
loss_pred:0.01664654165506363, decouple_loss:0.0007913839071989059
2023-05-01 01:42:21 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11650203913450241, mean p set: 0.4502691626548767
loss_pred:0.017847737297415733, decouple_loss:0.0009316116338595748
The modified gen p mean: 0.44953620433807373, gen p mean: -0.11062297224998474, mean p set: 0.4500633478164673
loss_pred:0.017179613932967186, decouple_loss:0.0009320948156528175
The modified gen p mean: 0.4497816264629364, gen p mean: -0.10978002101182938, mean p set: 0.45035696029663086
loss_pred:0.017319483682513237, decouple_loss:0.0008465496939606965
WV_1_PC_1_EH_0_PS_40, loss: 0.017494115978479385, avg_mse: 0.027129046618938446
current test mse: 0.027129
Iteration: 711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851019978523254, gen p mean: -0.11550753563642502, mean p set: 0.44908812642097473
loss_pred:0.016020119190216064, decouple_loss:0.0011053472990170121
The modified gen p mean: 0.4513435363769531, gen p mean: -0.109925776720047, mean p set: 0.4519214332103729The modified gen p mean: 0.4489501416683197, gen p mean: -0.11219785362482071, mean p set: 0.44952380657196045
loss_pred:0.014844047836959362, decouple_loss:0.001020593917928636
loss_pred:0.015909049659967422, decouple_loss:0.0012266611447557807
Iteration: 712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488053321838379, gen p mean: -0.10780096799135208, mean p set: 0.449381947517395
loss_pred:0.015742355957627296, decouple_loss:0.0009823932778090239
The modified gen p mean: 0.4513138234615326, gen p mean: -0.1032111793756485, mean p set: 0.4518917500972748The modified gen p mean: 0.45130985975265503, gen p mean: -0.10583813488483429, mean p set: 0.451885849237442
loss_pred:0.015444258227944374, decouple_loss:0.0011232629185542464loss_pred:0.01596456579864025, decouple_loss:0.0011411287123337388
Iteration: 713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44842958450317383, gen p mean: -0.10956422239542007, mean p set: 0.44900739192962646
loss_pred:0.016341514885425568, decouple_loss:0.0009693905594758689
The modified gen p mean: 0.4489332437515259, gen p mean: -0.10748268663883209, mean p set: 0.4495079815387726The modified gen p mean: 0.4484858512878418, gen p mean: -0.10426093637943268, mean p set: 0.4490615427494049
loss_pred:0.016028547659516335, decouple_loss:0.0009268505964428186loss_pred:0.016707230359315872, decouple_loss:0.0008149701752699912
Iteration: 714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906285405158997, gen p mean: -0.0994817242026329, mean p set: 0.44963955879211426
loss_pred:0.016003483906388283, decouple_loss:0.0011058230884373188
The modified gen p mean: 0.4485407769680023, gen p mean: -0.10979407280683517, mean p set: 0.44911783933639526
loss_pred:0.015750423073768616, decouple_loss:0.0014053195482119918
The modified gen p mean: 0.449668824672699, gen p mean: -0.10875282436609268, mean p set: 0.45024624466896057
loss_pred:0.015790019184350967, decouple_loss:0.0014173854142427444
Iteration: 715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492039382457733, gen p mean: -0.10132229328155518, mean p set: 0.4497814178466797
loss_pred:0.016200793907046318, decouple_loss:0.0009995626751333475
The modified gen p mean: 0.4495992660522461, gen p mean: -0.10829655081033707, mean p set: 0.45017367601394653
loss_pred:0.015694988891482353, decouple_loss:0.0013585587730631232
The modified gen p mean: 0.4498216509819031, gen p mean: -0.10298728942871094, mean p set: 0.4504006803035736
loss_pred:0.015808137133717537, decouple_loss:0.0011352070141583681
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472179710865021, gen p mean: -0.12047246098518372, mean p set: 0.4477926790714264
loss_pred:0.016370153054594994, decouple_loss:0.0009380698902532458
The modified gen p mean: 0.44660142064094543, gen p mean: -0.11738237738609314, mean p set: 0.4471730887889862
The modified gen p mean: 0.4474417269229889, gen p mean: -0.11351761221885681, mean p set: 0.4480171501636505
loss_pred:0.016258617863059044, decouple_loss:0.0009144905488938093
loss_pred:0.016379758715629578, decouple_loss:0.0010910482378676534
Iteration: 717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459688365459442, gen p mean: -0.11928887665271759, mean p set: 0.4465450048446655
loss_pred:0.016009259968996048, decouple_loss:0.0008650476229377091
The modified gen p mean: 0.4477667212486267, gen p mean: -0.11378567665815353, mean p set: 0.44834527373313904
loss_pred:0.01653030887246132, decouple_loss:0.0007718248525634408
The modified gen p mean: 0.4473758041858673, gen p mean: -0.11457854509353638, mean p set: 0.4479508101940155
loss_pred:0.016099654138088226, decouple_loss:0.0008385276887565851
Iteration: 718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463295638561249, gen p mean: -0.11599221080541611, mean p set: 0.4469052851200104
loss_pred:0.01587548665702343, decouple_loss:0.0009632089640945196
The modified gen p mean: 0.446748286485672, gen p mean: -0.12146513164043427, mean p set: 0.4473235309123993
loss_pred:0.015702707692980766, decouple_loss:0.0007931159343570471
The modified gen p mean: 0.44653359055519104, gen p mean: -0.1229223757982254, mean p set: 0.4471103250980377
loss_pred:0.016321128234267235, decouple_loss:0.0008673626580275595
Iteration: 719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768306612968445, gen p mean: -0.13217705488204956, mean p set: 0.4482541084289551
loss_pred:0.015874000266194344, decouple_loss:0.0009493528050370514
The modified gen p mean: 0.4482455551624298, gen p mean: -0.12770754098892212, mean p set: 0.4488171935081482
The modified gen p mean: 0.4471884071826935, gen p mean: -0.12114696949720383, mean p set: 0.4477651119232178
loss_pred:0.015580493025481701, decouple_loss:0.0009514231933280826
loss_pred:0.015857109799981117, decouple_loss:0.0009608127875253558
Iteration: 720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482228457927704, gen p mean: -0.1204136535525322, mean p set: 0.4487995207309723
loss_pred:0.016424760222434998, decouple_loss:0.0009924640180543065
The modified gen p mean: 0.4471587538719177, gen p mean: -0.12950007617473602, mean p set: 0.44773492217063904
The modified gen p mean: 0.4478951394557953, gen p mean: -0.1299232542514801, mean p set: 0.4484725892543793
loss_pred:0.015604807063937187, decouple_loss:0.0010244769509881735
loss_pred:0.01512770727276802, decouple_loss:0.0008604098111391068
2023-05-01 01:45:10 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13269031047821045, mean p set: 0.4502691626548767
loss_pred:0.017520874738693237, decouple_loss:0.0013980143703520298
The modified gen p mean: 0.4495338797569275, gen p mean: -0.12689580023288727, mean p set: 0.4500633478164673
loss_pred:0.01686510257422924, decouple_loss:0.0009287535212934017
The modified gen p mean: 0.44978001713752747, gen p mean: -0.12620900571346283, mean p set: 0.45035696029663086
loss_pred:0.017199954017996788, decouple_loss:0.0007868808461353183
WV_1_PC_1_EH_0_PS_40, loss: 0.01724720560014248, avg_mse: 0.026749897748231888
current test mse: 0.02675
Iteration: 721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470732510089874, gen p mean: -0.12389770895242691, mean p set: 0.44764673709869385
loss_pred:0.015916356816887856, decouple_loss:0.000765241333283484
The modified gen p mean: 0.44774457812309265, gen p mean: -0.12492208182811737, mean p set: 0.44832247495651245The modified gen p mean: 0.44609636068344116, gen p mean: -0.13344882428646088, mean p set: 0.44667288661003113
loss_pred:0.016447877511382103, decouple_loss:0.0010559360962361097
loss_pred:0.01553349755704403, decouple_loss:0.0011361732613295317
Iteration: 722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799908995628357, gen p mean: -0.1261114478111267, mean p set: 0.4485742151737213
loss_pred:0.0157451368868351, decouple_loss:0.0008854169282130897
The modified gen p mean: 0.44752824306488037, gen p mean: -0.13221947848796844, mean p set: 0.44810402393341064The modified gen p mean: 0.4475620687007904, gen p mean: -0.12813055515289307, mean p set: 0.4481382668018341
loss_pred:0.015343686565756798, decouple_loss:0.0007775878766551614
loss_pred:0.015426656231284142, decouple_loss:0.0008186740451492369
Iteration: 723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474199712276459, gen p mean: -0.1225157380104065, mean p set: 0.44799429178237915
loss_pred:0.01495377067476511, decouple_loss:0.0014517667004838586
The modified gen p mean: 0.447099506855011, gen p mean: -0.12127391993999481, mean p set: 0.4476746618747711
loss_pred:0.015579672530293465, decouple_loss:0.0013535800389945507
The modified gen p mean: 0.4457615911960602, gen p mean: -0.1287454515695572, mean p set: 0.446336567401886
loss_pred:0.015508688986301422, decouple_loss:0.0007174232741817832
Iteration: 724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475962221622467, gen p mean: -0.12469035387039185, mean p set: 0.44817250967025757
loss_pred:0.01578826643526554, decouple_loss:0.0009705545962788165
The modified gen p mean: 0.4462273120880127, gen p mean: -0.12776842713356018, mean p set: 0.4468037486076355
loss_pred:0.016024289652705193, decouple_loss:0.0008322722860611975
The modified gen p mean: 0.44785937666893005, gen p mean: -0.12562955915927887, mean p set: 0.44843369722366333
loss_pred:0.015397743321955204, decouple_loss:0.0012905332259833813
Iteration: 725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479471445083618, gen p mean: -0.12192223221063614, mean p set: 0.44852498173713684
loss_pred:0.015831898897886276, decouple_loss:0.0008485345751978457
The modified gen p mean: 0.44594109058380127, gen p mean: -0.11993544548749924, mean p set: 0.44651728868484497
loss_pred:0.01566287875175476, decouple_loss:0.000801397196482867
The modified gen p mean: 0.4475148022174835, gen p mean: -0.1178305447101593, mean p set: 0.4480930268764496
loss_pred:0.016020212322473526, decouple_loss:0.0012465373147279024
Iteration: 726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724300503730774, gen p mean: -0.12049856036901474, mean p set: 0.44781988859176636
loss_pred:0.016201812773942947, decouple_loss:0.001190285081975162
The modified gen p mean: 0.4465835988521576, gen p mean: -0.12308943271636963, mean p set: 0.44715774059295654
The modified gen p mean: 0.44807708263397217, gen p mean: -0.12326376885175705, mean p set: 0.4486536979675293
loss_pred:0.015360462479293346, decouple_loss:0.0011185106122866273
loss_pred:0.015145953744649887, decouple_loss:0.0011326480889692903
Iteration: 727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855695962905884, gen p mean: -0.11928363144397736, mean p set: 0.4491317868232727
loss_pred:0.014982732012867928, decouple_loss:0.0008138184202834964
The modified gen p mean: 0.44718292355537415, gen p mean: -0.12221328914165497, mean p set: 0.44775745272636414
loss_pred:0.015691975131630898, decouple_loss:0.0008103467407636344
The modified gen p mean: 0.4472418427467346, gen p mean: -0.12150462716817856, mean p set: 0.44781628251075745
loss_pred:0.016090169548988342, decouple_loss:0.0007288649212568998
Iteration: 728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472332298755646, gen p mean: -0.11940006166696548, mean p set: 0.4478101134300232
loss_pred:0.015541160479187965, decouple_loss:0.0009243920794688165
The modified gen p mean: 0.4466686546802521, gen p mean: -0.1208285242319107, mean p set: 0.447241872549057
The modified gen p mean: 0.446559876203537, gen p mean: -0.11578448116779327, mean p set: 0.44713273644447327
loss_pred:0.015900034457445145, decouple_loss:0.0008984762826003134
loss_pred:0.015692126005887985, decouple_loss:0.0008704945794306695
Iteration: 729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447833776473999, gen p mean: -0.11636915057897568, mean p set: 0.44840726256370544
loss_pred:0.01563478261232376, decouple_loss:0.0008178703137673438
The modified gen p mean: 0.44806328415870667, gen p mean: -0.11794644594192505, mean p set: 0.4486377537250519
The modified gen p mean: 0.4480016529560089, gen p mean: -0.11631526052951813, mean p set: 0.44857946038246155
loss_pred:0.015442291274666786, decouple_loss:0.0008071104530245066
loss_pred:0.015091626904904842, decouple_loss:0.000691506895236671
Iteration: 730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818127155303955, gen p mean: -0.11904565989971161, mean p set: 0.44875964522361755
loss_pred:0.015459663234651089, decouple_loss:0.0008601632434874773
The modified gen p mean: 0.44660186767578125, gen p mean: -0.11075518280267715, mean p set: 0.447177916765213
The modified gen p mean: 0.44617292284965515, gen p mean: -0.11218675971031189, mean p set: 0.4467467665672302
loss_pred:0.015140445902943611, decouple_loss:0.0008215208072215319
loss_pred:0.015489891171455383, decouple_loss:0.0008720227633602917
2023-05-01 01:47:17 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11817217618227005, mean p set: 0.4502691626548767
loss_pred:0.017582224681973457, decouple_loss:0.0009582915809005499
The modified gen p mean: 0.4495371878147125, gen p mean: -0.11241599172353745, mean p set: 0.4500633478164673
loss_pred:0.0169612318277359, decouple_loss:0.0008450978784821928
The modified gen p mean: 0.4497799575328827, gen p mean: -0.11194182187318802, mean p set: 0.45035696029663086
loss_pred:0.017289452254772186, decouple_loss:0.0009165435913018882
WV_1_PC_1_EH_0_PS_40, loss: 0.017322968691587448, avg_mse: 0.026905877515673637
current test mse: 0.026906
Iteration: 731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472472667694092, gen p mean: -0.11536671221256256, mean p set: 0.447822630405426
loss_pred:0.01516314223408699, decouple_loss:0.0007910788408480585
The modified gen p mean: 0.4477250874042511, gen p mean: -0.12070715427398682, mean p set: 0.44830334186553955The modified gen p mean: 0.44853660464286804, gen p mean: -0.11559291183948517, mean p set: 0.449113667011261
loss_pred:0.015689656138420105, decouple_loss:0.000700554926879704loss_pred:0.015263674780726433, decouple_loss:0.0007681236602365971
Iteration: 732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44658952951431274, gen p mean: -0.11404649168252945, mean p set: 0.4471621811389923
loss_pred:0.015416253358125687, decouple_loss:0.0008772645378485322
The modified gen p mean: 0.44810226559638977, gen p mean: -0.11235659569501877, mean p set: 0.4486773908138275The modified gen p mean: 0.44735217094421387, gen p mean: -0.11084362119436264, mean p set: 0.44792816042900085
loss_pred:0.015240863896906376, decouple_loss:0.0008783123921602964
loss_pred:0.015073839575052261, decouple_loss:0.0008362412336282432
Iteration: 733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777047634124756, gen p mean: -0.1121324747800827, mean p set: 0.4483456313610077
loss_pred:0.01550634577870369, decouple_loss:0.0008859426598064601
The modified gen p mean: 0.4477517306804657, gen p mean: -0.11367738991975784, mean p set: 0.44832614064216614The modified gen p mean: 0.4469202756881714, gen p mean: -0.11562313884496689, mean p set: 0.4474954903125763
loss_pred:0.014686618000268936, decouple_loss:0.0007999432273209095
loss_pred:0.015987496823072433, decouple_loss:0.0007747642230242491
Iteration: 734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753900170326233, gen p mean: -0.12384575605392456, mean p set: 0.44811320304870605
loss_pred:0.015203967690467834, decouple_loss:0.0009549383539706469
The modified gen p mean: 0.44763004779815674, gen p mean: -0.1127956435084343, mean p set: 0.44820424914360046
loss_pred:0.015707233920693398, decouple_loss:0.0009228596463799477
The modified gen p mean: 0.44796252250671387, gen p mean: -0.11794809252023697, mean p set: 0.4485393166542053
loss_pred:0.014908254146575928, decouple_loss:0.0007416810258291662
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803300499916077, gen p mean: -0.11987432837486267, mean p set: 0.44860827922821045
loss_pred:0.014974844641983509, decouple_loss:0.0008506333688274026
The modified gen p mean: 0.4480200707912445, gen p mean: -0.11849138885736465, mean p set: 0.4485970735549927
loss_pred:0.01466154120862484, decouple_loss:0.0008744859369471669
The modified gen p mean: 0.4454843997955322, gen p mean: -0.11499743163585663, mean p set: 0.4460587203502655
loss_pred:0.014995788224041462, decouple_loss:0.0012477576965466142
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
NaN value num: 0
Iteration: 736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44615766406059265, gen p mean: -0.12261952459812164, mean p set: 0.44673120975494385
loss_pred:0.01793184131383896, decouple_loss:0.0011043418198823929
The modified gen p mean: 0.446875661611557, gen p mean: -0.11475326120853424, mean p set: 0.44745099544525146
The modified gen p mean: 0.4452851712703705, gen p mean: -0.11677112430334091, mean p set: 0.4458599388599396
loss_pred:0.01847209222614765, decouple_loss:0.0009229194256477058
loss_pred:0.017250709235668182, decouple_loss:0.0010653350036591291
Iteration: 737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480670690536499, gen p mean: -0.11498802900314331, mean p set: 0.44864365458488464
loss_pred:0.017383486032485962, decouple_loss:0.001155310426838696
The modified gen p mean: 0.4477769732475281, gen p mean: -0.11535391211509705, mean p set: 0.4483541250228882
loss_pred:0.017830928787589073, decouple_loss:0.0010382317705079913
The modified gen p mean: 0.44748401641845703, gen p mean: -0.12020345777273178, mean p set: 0.44805923104286194
loss_pred:0.018138976767659187, decouple_loss:0.0008623823523521423
Iteration: 738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486405551433563, gen p mean: -0.11572840809822083, mean p set: 0.44921690225601196
loss_pred:0.017440643161535263, decouple_loss:0.00101673963945359
The modified gen p mean: 0.44787031412124634, gen p mean: -0.11404009908437729, mean p set: 0.4484466016292572
loss_pred:0.01788109354674816, decouple_loss:0.0012500109151005745
The modified gen p mean: 0.44756922125816345, gen p mean: -0.11649993807077408, mean p set: 0.44814398884773254
loss_pred:0.017171721905469894, decouple_loss:0.001000298885628581
Iteration: 739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467538595199585, gen p mean: -0.11477608978748322, mean p set: 0.44732820987701416
loss_pred:0.018711304292082787, decouple_loss:0.0011826083064079285
The modified gen p mean: 0.44731515645980835, gen p mean: -0.11681555211544037, mean p set: 0.44789019227027893
The modified gen p mean: 0.44767382740974426, gen p mean: -0.11716189980506897, mean p set: 0.4482518434524536
loss_pred:0.01748804561793804, decouple_loss:0.0009985285578295588
loss_pred:0.01784895732998848, decouple_loss:0.001120976870879531
Iteration: 740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44540807604789734, gen p mean: -0.11974767595529556, mean p set: 0.4459850490093231
loss_pred:0.0176671352237463, decouple_loss:0.0011802013032138348
The modified gen p mean: 0.445785790681839, gen p mean: -0.1187371239066124, mean p set: 0.44635969400405884
loss_pred:0.017405176535248756, decouple_loss:0.0011222471948713064
The modified gen p mean: 0.4474828541278839, gen p mean: -0.12390337884426117, mean p set: 0.4480588138103485
loss_pred:0.01844431832432747, decouple_loss:0.0010121254017576575
2023-05-01 01:50:04 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1256195306777954, mean p set: 0.4502691626548767
loss_pred:0.01745646260678768, decouple_loss:0.001120358007028699
The modified gen p mean: 0.44953271746635437, gen p mean: -0.12013722956180573, mean p set: 0.4500633478164673
loss_pred:0.016879865899682045, decouple_loss:0.0012946533970534801
The modified gen p mean: 0.44977912306785583, gen p mean: -0.11975535750389099, mean p set: 0.45035696029663086
loss_pred:0.017197048291563988, decouple_loss:0.0013101199874654412
WV_1_PC_1_EH_0_PS_40, loss: 0.017239877954125404, avg_mse: 0.026758860796689987
current test mse: 0.026759
Iteration: 741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470095634460449, gen p mean: -0.11984372138977051, mean p set: 0.4475829601287842
loss_pred:0.01641005463898182, decouple_loss:0.0009231899748556316
The modified gen p mean: 0.44800809025764465, gen p mean: -0.11763055622577667, mean p set: 0.4485847055912018The modified gen p mean: 0.44667327404022217, gen p mean: -0.11419571191072464, mean p set: 0.44724923372268677
loss_pred:0.017715297639369965, decouple_loss:0.0008782969089224935loss_pred:0.017444230616092682, decouple_loss:0.0012028892524540424
Iteration: 742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446736216545105, gen p mean: -0.12319798022508621, mean p set: 0.44731420278549194
loss_pred:0.017992641776800156, decouple_loss:0.0011386903934180737
The modified gen p mean: 0.44684460759162903, gen p mean: -0.12190777063369751, mean p set: 0.4474199414253235The modified gen p mean: 0.44603297114372253, gen p mean: -0.12614673376083374, mean p set: 0.4466082453727722
loss_pred:0.018548868596553802, decouple_loss:0.0008140127756632864
loss_pred:0.01754101924598217, decouple_loss:0.0006923205801285803
Iteration: 743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470948278903961, gen p mean: -0.12536129355430603, mean p set: 0.4476702809333801
loss_pred:0.017131727188825607, decouple_loss:0.0011383900418877602
The modified gen p mean: 0.44532614946365356, gen p mean: -0.12340821325778961, mean p set: 0.44589856266975403
loss_pred:0.017947020009160042, decouple_loss:0.0015106056816875935
The modified gen p mean: 0.4456242620944977, gen p mean: -0.11699671298265457, mean p set: 0.44620171189308167
loss_pred:0.018207821995019913, decouple_loss:0.0010740590514615178
Iteration: 744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44620150327682495, gen p mean: -0.12735609710216522, mean p set: 0.4467763900756836
loss_pred:0.017904220148921013, decouple_loss:0.0012002739822492003
The modified gen p mean: 0.4465857446193695, gen p mean: -0.12352102249860764, mean p set: 0.4471641182899475
loss_pred:0.01759300008416176, decouple_loss:0.0012577198212966323
The modified gen p mean: 0.44651922583580017, gen p mean: -0.11648853123188019, mean p set: 0.4470962882041931
loss_pred:0.01815679483115673, decouple_loss:0.0009777182713150978
Iteration: 745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44606834650039673, gen p mean: -0.1215817853808403, mean p set: 0.4466424882411957
loss_pred:0.01853450946509838, decouple_loss:0.001011708634905517
The modified gen p mean: 0.44653576612472534, gen p mean: -0.12272053956985474, mean p set: 0.4471109211444855
loss_pred:0.018424104899168015, decouple_loss:0.000765056989621371
The modified gen p mean: 0.4462646245956421, gen p mean: -0.12418722361326218, mean p set: 0.4468361735343933
loss_pred:0.018259573727846146, decouple_loss:0.0008627746719866991
Iteration: 746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699132442474365, gen p mean: -0.12217144668102264, mean p set: 0.44756653904914856
loss_pred:0.017302239313721657, decouple_loss:0.0011389597784727812
The modified gen p mean: 0.447790265083313, gen p mean: -0.12153497338294983, mean p set: 0.4483678936958313
The modified gen p mean: 0.4453601539134979, gen p mean: -0.1264251172542572, mean p set: 0.4459342360496521
loss_pred:0.01746154949069023, decouple_loss:0.0015652914298698306
loss_pred:0.017962902784347534, decouple_loss:0.001064887153916061
Iteration: 747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445165753364563, gen p mean: -0.12417671084403992, mean p set: 0.4457412362098694
loss_pred:0.017628014087677002, decouple_loss:0.0007421874906867743
The modified gen p mean: 0.4452987313270569, gen p mean: -0.12061064690351486, mean p set: 0.44587424397468567
The modified gen p mean: 0.4463355541229248, gen p mean: -0.1184421256184578, mean p set: 0.44691455364227295
loss_pred:0.018732164055109024, decouple_loss:0.0010878251632675529
loss_pred:0.017423858866095543, decouple_loss:0.0009204456582665443
Iteration: 748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446471631526947, gen p mean: -0.11146573722362518, mean p set: 0.44704747200012207
loss_pred:0.017167188227176666, decouple_loss:0.0008719238103367388
The modified gen p mean: 0.4477523863315582, gen p mean: -0.11364816874265671, mean p set: 0.44832971692085266
The modified gen p mean: 0.4459855854511261, gen p mean: -0.11391306668519974, mean p set: 0.4465598464012146
loss_pred:0.01828259788453579, decouple_loss:0.0009761403198353946
loss_pred:0.01723218522965908, decouple_loss:0.0008260041358880699
Iteration: 749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479907155036926, gen p mean: -0.10949878394603729, mean p set: 0.4485665559768677
loss_pred:0.01804407685995102, decouple_loss:0.0009788216557353735
The modified gen p mean: 0.44801732897758484, gen p mean: -0.10931345075368881, mean p set: 0.44859373569488525
The modified gen p mean: 0.44734257459640503, gen p mean: -0.11064247786998749, mean p set: 0.4479162395000458
loss_pred:0.017635049298405647, decouple_loss:0.0011983768781647086
loss_pred:0.017740825191140175, decouple_loss:0.0008145211613737047
Iteration: 750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44887059926986694, gen p mean: -0.10634882748126984, mean p set: 0.4494474530220032
loss_pred:0.017934216186404228, decouple_loss:0.0009216977632604539
The modified gen p mean: 0.44691187143325806, gen p mean: -0.10718099027872086, mean p set: 0.4474896788597107
loss_pred:0.017041916027665138, decouple_loss:0.0010835140710696578
The modified gen p mean: 0.44603145122528076, gen p mean: -0.10563986748456955, mean p set: 0.4466065764427185
loss_pred:0.017004339024424553, decouple_loss:0.001028554979711771
2023-05-01 01:52:11 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11192109435796738, mean p set: 0.4502691626548767
loss_pred:0.017470233142375946, decouple_loss:0.0009816050296649337
The modified gen p mean: 0.4495355784893036, gen p mean: -0.1068606749176979, mean p set: 0.4500633478164673
loss_pred:0.01685274764895439, decouple_loss:0.001008354127407074
The modified gen p mean: 0.4497802257537842, gen p mean: -0.10620974004268646, mean p set: 0.45035696029663086
loss_pred:0.017135612666606903, decouple_loss:0.0008428776636719704
WV_1_PC_1_EH_0_PS_40, loss: 0.017200078815221786, avg_mse: 0.026761025190353394
current test mse: 0.026761
Iteration: 751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781580567359924, gen p mean: -0.1070803850889206, mean p set: 0.4483919143676758
loss_pred:0.016823837533593178, decouple_loss:0.0010793351102620363
The modified gen p mean: 0.44773879647254944, gen p mean: -0.107166588306427, mean p set: 0.4483163356781006The modified gen p mean: 0.44707512855529785, gen p mean: -0.1050870269536972, mean p set: 0.4476500451564789
loss_pred:0.01763465255498886, decouple_loss:0.0010753966635093093
loss_pred:0.017689868807792664, decouple_loss:0.0009347253362648189
Iteration: 752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44625383615493774, gen p mean: -0.10810980200767517, mean p set: 0.44682827591896057
The modified gen p mean: 0.4455185532569885, gen p mean: -0.10552272945642471, mean p set: 0.44609498977661133
loss_pred:0.018404124304652214, decouple_loss:0.0009529201779514551
loss_pred:0.017967283725738525, decouple_loss:0.00078359036706388
The modified gen p mean: 0.4457319676876068, gen p mean: -0.10181493312120438, mean p set: 0.4463099241256714
loss_pred:0.017887206748127937, decouple_loss:0.000777359411586076
Iteration: 753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457577168941498, gen p mean: -0.11504976451396942, mean p set: 0.4463336765766144
loss_pred:0.01786879450082779, decouple_loss:0.001125895418226719
The modified gen p mean: 0.44632384181022644, gen p mean: -0.11480554193258286, mean p set: 0.4468995928764343
loss_pred:0.01788119040429592, decouple_loss:0.0008494107169099152
The modified gen p mean: 0.44760778546333313, gen p mean: -0.11714815348386765, mean p set: 0.44818219542503357
loss_pred:0.0175881739705801, decouple_loss:0.0007672474603168666
Iteration: 754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473225772380829, gen p mean: -0.11987390369176865, mean p set: 0.4479012191295624
loss_pred:0.01782454177737236, decouple_loss:0.000814598985016346
The modified gen p mean: 0.4478748142719269, gen p mean: -0.12016086280345917, mean p set: 0.4484492540359497
loss_pred:0.01669754832983017, decouple_loss:0.0009016763651743531
The modified gen p mean: 0.4473593235015869, gen p mean: -0.12056466937065125, mean p set: 0.44793352484703064
loss_pred:0.017226437106728554, decouple_loss:0.0010027580428868532
Iteration: 755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467623829841614, gen p mean: -0.11970465630292892, mean p set: 0.44733667373657227
loss_pred:0.018372615799307823, decouple_loss:0.0007976767956279218
The modified gen p mean: 0.4470348656177521, gen p mean: -0.11888344585895538, mean p set: 0.44761335849761963
loss_pred:0.018296871334314346, decouple_loss:0.0008835425833240151
The modified gen p mean: 0.44725778698921204, gen p mean: -0.11952277272939682, mean p set: 0.4478325843811035
loss_pred:0.018189935013651848, decouple_loss:0.0010570734739303589
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
NaN value num: 0
Iteration: 756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849836826324463, gen p mean: -0.12644167244434357, mean p set: 0.44907721877098083
loss_pred:0.016847094520926476, decouple_loss:0.0008146129548549652
The modified gen p mean: 0.44800376892089844, gen p mean: -0.1260412633419037, mean p set: 0.4485791027545929
The modified gen p mean: 0.4506275951862335, gen p mean: -0.1280248910188675, mean p set: 0.4512050449848175
loss_pred:0.01673075556755066, decouple_loss:0.0007427631644532084
loss_pred:0.01664665900170803, decouple_loss:0.0013441211776807904
Iteration: 757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855669140815735, gen p mean: -0.12110079079866409, mean p set: 0.4491298198699951
loss_pred:0.016659917309880257, decouple_loss:0.0010457054013386369
The modified gen p mean: 0.4501037001609802, gen p mean: -0.11946006119251251, mean p set: 0.4506807327270508
The modified gen p mean: 0.449699342250824, gen p mean: -0.12297600507736206, mean p set: 0.45027294754981995
loss_pred:0.016482729464769363, decouple_loss:0.000914331350941211
loss_pred:0.017332110553979874, decouple_loss:0.0008456697105430067
Iteration: 758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939377903938293, gen p mean: -0.12294173240661621, mean p set: 0.449969619512558
loss_pred:0.01719737984240055, decouple_loss:0.000714473077096045
The modified gen p mean: 0.450997531414032, gen p mean: -0.12374422699213028, mean p set: 0.45157620310783386
The modified gen p mean: 0.4519255757331848, gen p mean: -0.13145886361598969, mean p set: 0.45250096917152405
loss_pred:0.01680414378643036, decouple_loss:0.0007953743333928287
loss_pred:0.017040662467479706, decouple_loss:0.0010013519786298275
Iteration: 759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475501775741577, gen p mean: -0.11837229132652283, mean p set: 0.44812753796577454
loss_pred:0.017321286723017693, decouple_loss:0.0012426177272573113
The modified gen p mean: 0.4489082396030426, gen p mean: -0.11963048577308655, mean p set: 0.4494839310646057
loss_pred:0.01672029122710228, decouple_loss:0.0008090700139291584
The modified gen p mean: 0.4505064785480499, gen p mean: -0.11849471181631088, mean p set: 0.45108291506767273
loss_pred:0.01648692786693573, decouple_loss:0.0007986183045431972
Iteration: 760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509817957878113, gen p mean: -0.11850209534168243, mean p set: 0.45155924558639526
loss_pred:0.016714395955204964, decouple_loss:0.0009364477591589093
The modified gen p mean: 0.44982171058654785, gen p mean: -0.1163775846362114, mean p set: 0.450398713350296
The modified gen p mean: 0.45002302527427673, gen p mean: -0.11409708112478256, mean p set: 0.45059797167778015
loss_pred:0.016843482851982117, decouple_loss:0.0007150903693400323
loss_pred:0.01701992191374302, decouple_loss:0.0007215453661046922
2023-05-01 01:55:00 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12062066048383713, mean p set: 0.4502691626548767
loss_pred:0.0176808163523674, decouple_loss:0.0007953710737638175
The modified gen p mean: 0.4495317339897156, gen p mean: -0.11531951278448105, mean p set: 0.4500633478164673
loss_pred:0.017077894881367683, decouple_loss:0.0007931651780381799
The modified gen p mean: 0.4497796893119812, gen p mean: -0.11493103206157684, mean p set: 0.45035696029663086
loss_pred:0.017289085313677788, decouple_loss:0.0007494778255932033
WV_1_PC_1_EH_0_PS_40, loss: 0.017388232052326202, avg_mse: 0.027085965499281883
current test mse: 0.027086
Iteration: 761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45112550258636475, gen p mean: -0.11352524161338806, mean p set: 0.4517004191875458
loss_pred:0.016623668372631073, decouple_loss:0.0008526111487299204
The modified gen p mean: 0.44818660616874695, gen p mean: -0.1088942363858223, mean p set: 0.4487653374671936The modified gen p mean: 0.45159247517585754, gen p mean: -0.11760962754487991, mean p set: 0.4521687626838684
loss_pred:0.017002137377858162, decouple_loss:0.0008813340100459754
loss_pred:0.01693618670105934, decouple_loss:0.0008412247407250106
Iteration: 762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500614404678345, gen p mean: -0.10895673930644989, mean p set: 0.4506383240222931
loss_pred:0.01650420017540455, decouple_loss:0.0006903392495587468
The modified gen p mean: 0.45107191801071167, gen p mean: -0.11092472076416016, mean p set: 0.4516487121582031The modified gen p mean: 0.4496857523918152, gen p mean: -0.10978559404611588, mean p set: 0.45026326179504395
loss_pred:0.016629062592983246, decouple_loss:0.0006708985893055797
loss_pred:0.016873618587851524, decouple_loss:0.0007251760107465088
Iteration: 763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824501872062683, gen p mean: -0.10890611261129379, mean p set: 0.44882118701934814
loss_pred:0.016629302874207497, decouple_loss:0.0009878375567495823
The modified gen p mean: 0.4477027356624603, gen p mean: -0.11434575170278549, mean p set: 0.4482796788215637
loss_pred:0.01635495014488697, decouple_loss:0.0008826934499666095
The modified gen p mean: 0.4505138397216797, gen p mean: -0.11206036061048508, mean p set: 0.4510902166366577
loss_pred:0.016354018822312355, decouple_loss:0.0007867540116421878
Iteration: 764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499572515487671, gen p mean: -0.11249445378780365, mean p set: 0.4505334198474884
loss_pred:0.016774388030171394, decouple_loss:0.0008378200582228601
The modified gen p mean: 0.45036065578460693, gen p mean: -0.11100125312805176, mean p set: 0.45093685388565063
loss_pred:0.016879165545105934, decouple_loss:0.0007267437176778913
The modified gen p mean: 0.45028385519981384, gen p mean: -0.1128583624958992, mean p set: 0.45085906982421875
loss_pred:0.016555653885006905, decouple_loss:0.0007137049688026309
Iteration: 765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45084500312805176, gen p mean: -0.11599142849445343, mean p set: 0.4514223337173462
loss_pred:0.016853593289852142, decouple_loss:0.0007851026603020728
The modified gen p mean: 0.4482954144477844, gen p mean: -0.11650855094194412, mean p set: 0.44887110590934753
loss_pred:0.017852678894996643, decouple_loss:0.0008651373791508377
The modified gen p mean: 0.4494340717792511, gen p mean: -0.11387620866298676, mean p set: 0.45001283288002014
loss_pred:0.016227373853325844, decouple_loss:0.000848694471642375
Iteration: 766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506224989891052, gen p mean: -0.12281494587659836, mean p set: 0.4511985182762146
loss_pred:0.016464408487081528, decouple_loss:0.0010335907572880387
The modified gen p mean: 0.4484337270259857, gen p mean: -0.11229642480611801, mean p set: 0.44900739192962646
loss_pred:0.017086436972022057, decouple_loss:0.0007601320394314826
The modified gen p mean: 0.45036768913269043, gen p mean: -0.11821050196886063, mean p set: 0.4509415924549103
loss_pred:0.01637266017496586, decouple_loss:0.0007726667681708932
Iteration: 767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516109526157379, gen p mean: -0.12331093847751617, mean p set: 0.4521893560886383
loss_pred:0.0168219693005085, decouple_loss:0.0009284893167205155
The modified gen p mean: 0.4520125985145569, gen p mean: -0.12683004140853882, mean p set: 0.45258763432502747
loss_pred:0.017190858721733093, decouple_loss:0.000880784762557596
The modified gen p mean: 0.4515443444252014, gen p mean: -0.1245652511715889, mean p set: 0.4521230459213257
loss_pred:0.016306577250361443, decouple_loss:0.0009293922339566052
Iteration: 768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450802743434906, gen p mean: -0.13291944563388824, mean p set: 0.45137983560562134
loss_pred:0.016733525320887566, decouple_loss:0.0008347871480509639
The modified gen p mean: 0.4491254389286041, gen p mean: -0.12962646782398224, mean p set: 0.4497029781341553
loss_pred:0.016475128009915352, decouple_loss:0.0008860596572048962
The modified gen p mean: 0.45100292563438416, gen p mean: -0.1273316740989685, mean p set: 0.4515781104564667
loss_pred:0.016851261258125305, decouple_loss:0.0007640581461600959
Iteration: 769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823241233825684, gen p mean: -0.13116566836833954, mean p set: 0.44880905747413635
loss_pred:0.016573285683989525, decouple_loss:0.0008703622152097523
The modified gen p mean: 0.4479884207248688, gen p mean: -0.1332063227891922, mean p set: 0.44856342673301697
The modified gen p mean: 0.4496484398841858, gen p mean: -0.12848332524299622, mean p set: 0.4502235949039459
loss_pred:0.016232717782258987, decouple_loss:0.0008165276376530528
loss_pred:0.01695944182574749, decouple_loss:0.0009628440602682531
Iteration: 770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498695433139801, gen p mean: -0.13052260875701904, mean p set: 0.45044276118278503
loss_pred:0.016745256260037422, decouple_loss:0.000845317670609802
The modified gen p mean: 0.45129528641700745, gen p mean: -0.1314646154642105, mean p set: 0.45187318325042725
loss_pred:0.016607876867055893, decouple_loss:0.0006828366313129663
The modified gen p mean: 0.44871923327445984, gen p mean: -0.1290992796421051, mean p set: 0.44929447770118713
loss_pred:0.016699127852916718, decouple_loss:0.0007560359081253409
2023-05-01 01:57:06 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13261643052101135, mean p set: 0.4502691626548767
loss_pred:0.01771223545074463, decouple_loss:0.0010009347461163998
The modified gen p mean: 0.4495338797569275, gen p mean: -0.12700212001800537, mean p set: 0.4500633478164673
loss_pred:0.01709512248635292, decouple_loss:0.001179112703539431
The modified gen p mean: 0.44977888464927673, gen p mean: -0.12623155117034912, mean p set: 0.45035696029663086
loss_pred:0.017302440479397774, decouple_loss:0.001015748013742268
WV_1_PC_1_EH_0_PS_40, loss: 0.017423197627067566, avg_mse: 0.02703234553337097
current test mse: 0.027032
Iteration: 771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501592218875885, gen p mean: -0.12602192163467407, mean p set: 0.45073628425598145
loss_pred:0.016735443845391273, decouple_loss:0.0012276044581085443
The modified gen p mean: 0.4505981206893921, gen p mean: -0.13147634267807007, mean p set: 0.4511696398258209
loss_pred:0.017345748841762543, decouple_loss:0.0008654989651404321
The modified gen p mean: 0.45076364278793335, gen p mean: -0.1288367509841919, mean p set: 0.4513396918773651
loss_pred:0.015986934304237366, decouple_loss:0.0008974468801170588
Iteration: 772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513120651245117, gen p mean: -0.12261444330215454, mean p set: 0.45188701152801514
The modified gen p mean: 0.44790518283843994, gen p mean: -0.12150115519762039, mean p set: 0.44848257303237915
loss_pred:0.01582733727991581, decouple_loss:0.0008549730991944671
loss_pred:0.016314562410116196, decouple_loss:0.0007203476270660758
The modified gen p mean: 0.45145201683044434, gen p mean: -0.12196768075227737, mean p set: 0.4520282447338104
loss_pred:0.01671713963150978, decouple_loss:0.0006651543662883341
Iteration: 773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783976674079895, gen p mean: -0.12132123857736588, mean p set: 0.44841381907463074
loss_pred:0.016255665570497513, decouple_loss:0.000827443553134799
The modified gen p mean: 0.4485829770565033, gen p mean: -0.11787746846675873, mean p set: 0.4491605758666992
loss_pred:0.01632562279701233, decouple_loss:0.0009865020401775837
The modified gen p mean: 0.44826340675354004, gen p mean: -0.11585885286331177, mean p set: 0.44883993268013
loss_pred:0.01610599271953106, decouple_loss:0.0007490150164812803
Iteration: 774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514789879322052, gen p mean: -0.11524953693151474, mean p set: 0.45205825567245483
loss_pred:0.017306271940469742, decouple_loss:0.000929851783439517
The modified gen p mean: 0.44968554377555847, gen p mean: -0.11616045981645584, mean p set: 0.4502636790275574
loss_pred:0.016264265403151512, decouple_loss:0.000685787876136601
The modified gen p mean: 0.4520501494407654, gen p mean: -0.11841180175542831, mean p set: 0.45262959599494934
loss_pred:0.01563239097595215, decouple_loss:0.0010974528267979622
Iteration: 775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44899702072143555, gen p mean: -0.11267230659723282, mean p set: 0.44957149028778076
loss_pred:0.017421232536435127, decouple_loss:0.000803034461569041
The modified gen p mean: 0.44865310192108154, gen p mean: -0.11538656055927277, mean p set: 0.44922852516174316
loss_pred:0.016347387805581093, decouple_loss:0.0006901843589730561
The modified gen p mean: 0.4517765939235687, gen p mean: -0.11870469897985458, mean p set: 0.45235374569892883
loss_pred:0.01547666173428297, decouple_loss:0.0008412190363742411
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
NaN value num: 0
Iteration: 776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522276520729065, gen p mean: -0.11188095062971115, mean p set: 0.45280560851097107
loss_pred:0.01557773258537054, decouple_loss:0.0008050017640925944
The modified gen p mean: 0.45158910751342773, gen p mean: -0.10317918658256531, mean p set: 0.4521639347076416
The modified gen p mean: 0.4531662166118622, gen p mean: -0.1121717095375061, mean p set: 0.45374393463134766
loss_pred:0.016228826716542244, decouple_loss:0.0009365139994770288
loss_pred:0.01580177992582321, decouple_loss:0.0009344382560811937
Iteration: 777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527541995048523, gen p mean: -0.10167813301086426, mean p set: 0.4533340632915497
loss_pred:0.016393152996897697, decouple_loss:0.0008229815866798162
The modified gen p mean: 0.4495522379875183, gen p mean: -0.10224822163581848, mean p set: 0.4501282274723053
The modified gen p mean: 0.4502218961715698, gen p mean: -0.1049608513712883, mean p set: 0.45080041885375977
loss_pred:0.01690227910876274, decouple_loss:0.0010523388627916574
loss_pred:0.01669919118285179, decouple_loss:0.0011169022182002664
Iteration: 778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518902003765106, gen p mean: -0.10154237598180771, mean p set: 0.45246621966362
loss_pred:0.016123827546834946, decouple_loss:0.001121243112720549
The modified gen p mean: 0.4513295590877533, gen p mean: -0.09618782252073288, mean p set: 0.4519054889678955
loss_pred:0.015732361003756523, decouple_loss:0.001062584575265646
The modified gen p mean: 0.4527032673358917, gen p mean: -0.09936850517988205, mean p set: 0.45328083634376526
loss_pred:0.016331644728779793, decouple_loss:0.0008081656997092068
Iteration: 779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525375962257385, gen p mean: -0.10302373021841049, mean p set: 0.45311427116394043
loss_pred:0.016030587255954742, decouple_loss:0.0017225134652107954
The modified gen p mean: 0.4525165855884552, gen p mean: -0.09693657606840134, mean p set: 0.4530937969684601
The modified gen p mean: 0.45071810483932495, gen p mean: -0.10826876759529114, mean p set: 0.4512959122657776
loss_pred:0.016170531511306763, decouple_loss:0.0007580688106827438
loss_pred:0.015696031972765923, decouple_loss:0.0008831090526655316
Iteration: 780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519711434841156, gen p mean: -0.09698217362165451, mean p set: 0.45254871249198914
loss_pred:0.01687832549214363, decouple_loss:0.0007732253288850188
The modified gen p mean: 0.4510475993156433, gen p mean: -0.09871417284011841, mean p set: 0.4516242742538452
loss_pred:0.016547858715057373, decouple_loss:0.0009061414748430252
The modified gen p mean: 0.4510841965675354, gen p mean: -0.09892481565475464, mean p set: 0.45166051387786865
loss_pred:0.015939489006996155, decouple_loss:0.0008125787717290223
2023-05-01 01:59:50 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10943619161844254, mean p set: 0.4502691626548767
loss_pred:0.01770581118762493, decouple_loss:0.0009594006114639342
The modified gen p mean: 0.4495353400707245, gen p mean: -0.10412432253360748, mean p set: 0.4500633478164673
loss_pred:0.017087312415242195, decouple_loss:0.001003585522994399
The modified gen p mean: 0.449781596660614, gen p mean: -0.10317668318748474, mean p set: 0.45035696029663086
loss_pred:0.017407702282071114, decouple_loss:0.0008494944195263088
WV_1_PC_1_EH_0_PS_40, loss: 0.017447149381041527, avg_mse: 0.027066228911280632
current test mse: 0.027066
Iteration: 781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494030177593231, gen p mean: -0.09953002631664276, mean p set: 0.44997847080230713
loss_pred:0.01653279922902584, decouple_loss:0.0008168952772393823
The modified gen p mean: 0.45249253511428833, gen p mean: -0.0957852303981781, mean p set: 0.4530712962150574
loss_pred:0.015525943599641323, decouple_loss:0.0008508805185556412
The modified gen p mean: 0.45195823907852173, gen p mean: -0.09703101962804794, mean p set: 0.4525352716445923
loss_pred:0.016660459339618683, decouple_loss:0.0008915422949939966
Iteration: 782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519957900047302, gen p mean: -0.09797388315200806, mean p set: 0.45257216691970825
loss_pred:0.015633417293429375, decouple_loss:0.0007677273242734373
The modified gen p mean: 0.454978883266449, gen p mean: -0.10038141906261444, mean p set: 0.4555578827857971The modified gen p mean: 0.4500655233860016, gen p mean: -0.09665025025606155, mean p set: 0.4506414532661438
loss_pred:0.016237400472164154, decouple_loss:0.0007714524399489164
loss_pred:0.016533782705664635, decouple_loss:0.0008065563160926104
Iteration: 783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499092400074005, gen p mean: -0.09978259354829788, mean p set: 0.4504847228527069
loss_pred:0.0175656545907259, decouple_loss:0.0009076648857444525
The modified gen p mean: 0.44944655895233154, gen p mean: -0.09930776804685593, mean p set: 0.4500231444835663The modified gen p mean: 0.4510776698589325, gen p mean: -0.1029810756444931, mean p set: 0.4516550898551941
loss_pred:0.01709800399839878, decouple_loss:0.000961905752774328loss_pred:0.01596514694392681, decouple_loss:0.001041131792590022
Iteration: 784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44966116547584534, gen p mean: -0.10307512432336807, mean p set: 0.45023927092552185
loss_pred:0.01738111861050129, decouple_loss:0.0008842229726724327
The modified gen p mean: 0.4531795084476471, gen p mean: -0.10783729702234268, mean p set: 0.45375576615333557
loss_pred:0.015267428942024708, decouple_loss:0.0009350668406113982
The modified gen p mean: 0.45119330286979675, gen p mean: -0.10544253885746002, mean p set: 0.45177099108695984
loss_pred:0.016325263306498528, decouple_loss:0.0007879533222876489
Iteration: 785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499337375164032, gen p mean: -0.10501640290021896, mean p set: 0.4505091905593872
loss_pred:0.017162425443530083, decouple_loss:0.0006772817578166723
The modified gen p mean: 0.45185595750808716, gen p mean: -0.10048235207796097, mean p set: 0.4524320662021637
loss_pred:0.015797672793269157, decouple_loss:0.0007998310611583292
The modified gen p mean: 0.4511418342590332, gen p mean: -0.10624831169843674, mean p set: 0.4517159163951874
loss_pred:0.016654852777719498, decouple_loss:0.0007651863270439208
Iteration: 786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080551505088806, gen p mean: -0.1040474995970726, mean p set: 0.4513835310935974
loss_pred:0.016479451209306717, decouple_loss:0.0008038683445192873
The modified gen p mean: 0.45087647438049316, gen p mean: -0.10022421926259995, mean p set: 0.4514535665512085
loss_pred:0.016089636832475662, decouple_loss:0.0008486290462315083
The modified gen p mean: 0.45104101300239563, gen p mean: -0.11038284003734589, mean p set: 0.4516180753707886
loss_pred:0.015957074239850044, decouple_loss:0.0010014423169195652
Iteration: 787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523725211620331, gen p mean: -0.10422304272651672, mean p set: 0.45295095443725586
loss_pred:0.01577502302825451, decouple_loss:0.0009937146678566933
The modified gen p mean: 0.4519535005092621, gen p mean: -0.09399870038032532, mean p set: 0.45252999663352966
loss_pred:0.015593479387462139, decouple_loss:0.0006956912693567574
The modified gen p mean: 0.4490164518356323, gen p mean: -0.10182131826877594, mean p set: 0.44959282875061035
loss_pred:0.01680128462612629, decouple_loss:0.0009496244019828737
Iteration: 788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491649270057678, gen p mean: -0.10150925070047379, mean p set: 0.44974127411842346
loss_pred:0.01667879894375801, decouple_loss:0.0008177012205123901
The modified gen p mean: 0.4515964686870575, gen p mean: -0.10293089598417282, mean p set: 0.4521713852882385
loss_pred:0.015535430982708931, decouple_loss:0.0010106366826221347
The modified gen p mean: 0.45165514945983887, gen p mean: -0.09415645152330399, mean p set: 0.4522334337234497
loss_pred:0.01652856171131134, decouple_loss:0.0008579952991567552
Iteration: 789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45203089714050293, gen p mean: -0.10306306928396225, mean p set: 0.45260855555534363
loss_pred:0.015277099795639515, decouple_loss:0.0009400932467542589
The modified gen p mean: 0.45259973406791687, gen p mean: -0.10201238095760345, mean p set: 0.45317476987838745
The modified gen p mean: 0.45090943574905396, gen p mean: -0.09520337730646133, mean p set: 0.45148876309394836
loss_pred:0.01576087437570095, decouple_loss:0.0008373657474294305
loss_pred:0.016186485067009926, decouple_loss:0.0012459757272154093
Iteration: 790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538503587245941, gen p mean: -0.09756455570459366, mean p set: 0.4544260501861572
loss_pred:0.01608263887465, decouple_loss:0.0007896407041698694
The modified gen p mean: 0.4524890184402466, gen p mean: -0.09798766672611237, mean p set: 0.45306602120399475
loss_pred:0.015704134479165077, decouple_loss:0.0015173547435551882
The modified gen p mean: 0.45033106207847595, gen p mean: -0.0971163883805275, mean p set: 0.4509062170982361
loss_pred:0.01659134402871132, decouple_loss:0.0009117252775467932
2023-05-01 02:01:57 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10957042872905731, mean p set: 0.4502691626548767
loss_pred:0.01760702393949032, decouple_loss:0.0008289795368909836
The modified gen p mean: 0.4495341181755066, gen p mean: -0.10393452644348145, mean p set: 0.4500633478164673
loss_pred:0.017123037949204445, decouple_loss:0.0009417054825462401
The modified gen p mean: 0.4497825801372528, gen p mean: -0.10307664424180984, mean p set: 0.45035696029663086
loss_pred:0.01738390140235424, decouple_loss:0.0007964412798173726
WV_1_PC_1_EH_0_PS_40, loss: 0.01741410791873932, avg_mse: 0.027087373659014702
current test mse: 0.027087
Iteration: 791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077621936798096, gen p mean: -0.09910161793231964, mean p set: 0.4513528347015381
loss_pred:0.016708284616470337, decouple_loss:0.0008495553047396243
The modified gen p mean: 0.45108363032341003, gen p mean: -0.09499708563089371, mean p set: 0.45165982842445374The modified gen p mean: 0.4514343738555908, gen p mean: -0.10343900322914124, mean p set: 0.4520109295845032
loss_pred:0.01580033451318741, decouple_loss:0.0009290740708820522loss_pred:0.016054345294833183, decouple_loss:0.0008497272501699626
Iteration: 792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512147605419159, gen p mean: -0.09885203093290329, mean p set: 0.4517918825149536
The modified gen p mean: 0.4524542987346649, gen p mean: -0.10379631817340851, mean p set: 0.4530309736728668
loss_pred:0.015510675497353077, decouple_loss:0.0009310021414421499
loss_pred:0.0158532802015543, decouple_loss:0.0011100543197244406
The modified gen p mean: 0.4506412744522095, gen p mean: -0.10106106847524643, mean p set: 0.4512145519256592
loss_pred:0.016137685626745224, decouple_loss:0.0008741582278162241
Iteration: 793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45157548785209656, gen p mean: -0.10581999272108078, mean p set: 0.4521520435810089
loss_pred:0.016026241704821587, decouple_loss:0.0008458889788016677
The modified gen p mean: 0.4525824785232544, gen p mean: -0.10252173244953156, mean p set: 0.45316070318222046
loss_pred:0.015566844493150711, decouple_loss:0.0007620781543664634
The modified gen p mean: 0.4505109488964081, gen p mean: -0.11087418347597122, mean p set: 0.45108485221862793
loss_pred:0.015732744708657265, decouple_loss:0.0009150442201644182
Iteration: 794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526638090610504, gen p mean: -0.1085556149482727, mean p set: 0.45324212312698364
loss_pred:0.015308931469917297, decouple_loss:0.0009002146543934941
The modified gen p mean: 0.45215868949890137, gen p mean: -0.10806737840175629, mean p set: 0.4527343511581421
loss_pred:0.016376515850424767, decouple_loss:0.0008723345817998052
The modified gen p mean: 0.4534948170185089, gen p mean: -0.10810080915689468, mean p set: 0.4540724456310272
loss_pred:0.015834681689739227, decouple_loss:0.001023107091896236
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465683698654175, gen p mean: -0.11339721083641052, mean p set: 0.4471467435359955
loss_pred:0.015782222151756287, decouple_loss:0.0009625046513974667
The modified gen p mean: 0.44642749428749084, gen p mean: -0.11433330178260803, mean p set: 0.4470020830631256
loss_pred:0.016275597736239433, decouple_loss:0.0010094785830006003
The modified gen p mean: 0.44835221767425537, gen p mean: -0.11660324782133102, mean p set: 0.4489297568798065
loss_pred:0.015366642735898495, decouple_loss:0.0011383747914806008
Iteration: 796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668662548065186, gen p mean: -0.11753115057945251, mean p set: 0.44726231694221497
loss_pred:0.015673784539103508, decouple_loss:0.001027761958539486
The modified gen p mean: 0.44703179597854614, gen p mean: -0.11042655259370804, mean p set: 0.44760966300964355
loss_pred:0.016453316435217857, decouple_loss:0.0009320448734797537
The modified gen p mean: 0.44677501916885376, gen p mean: -0.11564893275499344, mean p set: 0.4473506212234497
loss_pred:0.016225747764110565, decouple_loss:0.0009721039095893502
Iteration: 797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746869802474976, gen p mean: -0.11450692266225815, mean p set: 0.4480440020561218
loss_pred:0.015526722185313702, decouple_loss:0.0008976294193416834
The modified gen p mean: 0.4465292692184448, gen p mean: -0.11215567588806152, mean p set: 0.4471038281917572
loss_pred:0.016116134822368622, decouple_loss:0.0008019402157515287
The modified gen p mean: 0.44688230752944946, gen p mean: -0.11654213070869446, mean p set: 0.4474572241306305
loss_pred:0.015708453953266144, decouple_loss:0.0009768756572157145
Iteration: 798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467420279979706, gen p mean: -0.1172529011964798, mean p set: 0.4473183751106262
loss_pred:0.01611441560089588, decouple_loss:0.0007890340639278293
The modified gen p mean: 0.44696104526519775, gen p mean: -0.11695890873670578, mean p set: 0.4475364685058594
loss_pred:0.015420675277709961, decouple_loss:0.0007812055409885943
The modified gen p mean: 0.4451110064983368, gen p mean: -0.11705183237791061, mean p set: 0.4456845819950104
loss_pred:0.01594066061079502, decouple_loss:0.0010961026418954134
Iteration: 799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767001271247864, gen p mean: -0.11663670092821121, mean p set: 0.4482450783252716
loss_pred:0.01579616218805313, decouple_loss:0.0007921999203972518
The modified gen p mean: 0.4452144503593445, gen p mean: -0.11977123469114304, mean p set: 0.44578808546066284
loss_pred:0.015622420236468315, decouple_loss:0.0009293205803260207
The modified gen p mean: 0.4452800154685974, gen p mean: -0.11898504197597504, mean p set: 0.445857435464859
loss_pred:0.01628633216023445, decouple_loss:0.0009748672018758953
Iteration: 800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725409150123596, gen p mean: -0.12562116980552673, mean p set: 0.44782721996307373
loss_pred:0.015291108749806881, decouple_loss:0.0008928143070079386
The modified gen p mean: 0.44760364294052124, gen p mean: -0.1206534132361412, mean p set: 0.44818106293678284
The modified gen p mean: 0.4468551576137543, gen p mean: -0.11842980980873108, mean p set: 0.4474301338195801
loss_pred:0.015222448855638504, decouple_loss:0.001011822372674942
loss_pred:0.015539128333330154, decouple_loss:0.0011283636558800936
2023-05-01 02:04:46 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12963061034679413, mean p set: 0.4502691626548767
loss_pred:0.01750136911869049, decouple_loss:0.0008568565244786441
The modified gen p mean: 0.44953393936157227, gen p mean: -0.12400151789188385, mean p set: 0.4500633478164673
loss_pred:0.01693076267838478, decouple_loss:0.0009020159486681223
The modified gen p mean: 0.4497826397418976, gen p mean: -0.12301155179738998, mean p set: 0.45035696029663086
loss_pred:0.01718129776418209, decouple_loss:0.0008497080998495221
WV_1_PC_1_EH_0_PS_40, loss: 0.01724795252084732, avg_mse: 0.026790013536810875
current test mse: 0.02679
Iteration: 801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467097818851471, gen p mean: -0.1266903132200241, mean p set: 0.44728413224220276
loss_pred:0.015448885969817638, decouple_loss:0.0008598591084592044
The modified gen p mean: 0.4455741345882416, gen p mean: -0.12639230489730835, mean p set: 0.4461512565612793
loss_pred:0.015459820628166199, decouple_loss:0.0008967283647507429
The modified gen p mean: 0.44602927565574646, gen p mean: -0.12092634290456772, mean p set: 0.4466037154197693
loss_pred:0.016018599271774292, decouple_loss:0.0008486161241307855
Iteration: 802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464219808578491, gen p mean: -0.13104015588760376, mean p set: 0.44699564576148987
The modified gen p mean: 0.4459001123905182, gen p mean: -0.12327020615339279, mean p set: 0.44647684693336487
loss_pred:0.015837782993912697, decouple_loss:0.0010170015739277005
loss_pred:0.016427384689450264, decouple_loss:0.0007885440718382597
The modified gen p mean: 0.44691795110702515, gen p mean: -0.12613697350025177, mean p set: 0.44749704003334045
loss_pred:0.01651938445866108, decouple_loss:0.0008299896726384759
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44601911306381226, gen p mean: -0.1279882937669754, mean p set: 0.44659578800201416
loss_pred:0.015697821974754333, decouple_loss:0.0008641679887659848
The modified gen p mean: 0.44784626364707947, gen p mean: -0.1322321593761444, mean p set: 0.44842633605003357
loss_pred:0.014947688207030296, decouple_loss:0.0011382377706468105
The modified gen p mean: 0.4473119080066681, gen p mean: -0.12374840676784515, mean p set: 0.44788506627082825
loss_pred:0.01550860982388258, decouple_loss:0.0010907684918493032
Iteration: 804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44646894931793213, gen p mean: -0.11965561658143997, mean p set: 0.44704607129096985
loss_pred:0.015112077817320824, decouple_loss:0.0008022050024010241
The modified gen p mean: 0.44670218229293823, gen p mean: -0.12709808349609375, mean p set: 0.44728177785873413
loss_pred:0.015214147977530956, decouple_loss:0.0008647181675769389
The modified gen p mean: 0.4466229975223541, gen p mean: -0.1219065710902214, mean p set: 0.44719746708869934
loss_pred:0.015535674057900906, decouple_loss:0.0007722852169536054
Iteration: 805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469584822654724, gen p mean: -0.12001005560159683, mean p set: 0.44753265380859375
loss_pred:0.01521668303757906, decouple_loss:0.0010182831902056932
The modified gen p mean: 0.4467869699001312, gen p mean: -0.12598028779029846, mean p set: 0.4473608434200287
loss_pred:0.015833495184779167, decouple_loss:0.0013094181194901466
The modified gen p mean: 0.44671830534935, gen p mean: -0.12115372717380524, mean p set: 0.44729331135749817
loss_pred:0.015604657121002674, decouple_loss:0.0010420071193948388
Iteration: 806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469076693058014, gen p mean: -0.12761494517326355, mean p set: 0.44748565554618835
loss_pred:0.015021700412034988, decouple_loss:0.0010622016852721572
The modified gen p mean: 0.4459722638130188, gen p mean: -0.1222120076417923, mean p set: 0.4465474784374237
loss_pred:0.015475028194487095, decouple_loss:0.0010581149253994226
The modified gen p mean: 0.4462454617023468, gen p mean: -0.1246020495891571, mean p set: 0.446819543838501
loss_pred:0.015650251880288124, decouple_loss:0.0009783317800611258
Iteration: 807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44651883840560913, gen p mean: -0.1219862550497055, mean p set: 0.44709545373916626
loss_pred:0.015326234512031078, decouple_loss:0.000780173868406564
The modified gen p mean: 0.44601118564605713, gen p mean: -0.12080445140600204, mean p set: 0.44658660888671875
loss_pred:0.015651505440473557, decouple_loss:0.0010384529596194625
The modified gen p mean: 0.44600173830986023, gen p mean: -0.12221626937389374, mean p set: 0.4465794563293457
loss_pred:0.015605522319674492, decouple_loss:0.0007616742514073849
Iteration: 808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44689106941223145, gen p mean: -0.1198774129152298, mean p set: 0.44746461510658264
loss_pred:0.015274525620043278, decouple_loss:0.0008585094474256039
The modified gen p mean: 0.4464825689792633, gen p mean: -0.118311308324337, mean p set: 0.44706007838249207
loss_pred:0.014775961637496948, decouple_loss:0.0008648447692394257
The modified gen p mean: 0.44670042395591736, gen p mean: -0.11653309315443039, mean p set: 0.44727569818496704
loss_pred:0.015054211020469666, decouple_loss:0.000937216798774898
Iteration: 809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471624791622162, gen p mean: -0.11677654087543488, mean p set: 0.4477333426475525
loss_pred:0.016341226175427437, decouple_loss:0.0009951830143108964
The modified gen p mean: 0.4464256465435028, gen p mean: -0.11943744868040085, mean p set: 0.4469999372959137
loss_pred:0.015465054661035538, decouple_loss:0.0009999744361266494
The modified gen p mean: 0.4462324380874634, gen p mean: -0.12312988936901093, mean p set: 0.44680705666542053
loss_pred:0.01544237695634365, decouple_loss:0.0008694433490745723
Iteration: 810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462447464466095, gen p mean: -0.12045961618423462, mean p set: 0.44682133197784424
loss_pred:0.015347949229180813, decouple_loss:0.0008628127397969365
The modified gen p mean: 0.44669172167778015, gen p mean: -0.12432396411895752, mean p set: 0.4472668468952179
loss_pred:0.01512041687965393, decouple_loss:0.001082704751752317
The modified gen p mean: 0.44507864117622375, gen p mean: -0.12079916149377823, mean p set: 0.44565579295158386
loss_pred:0.015415322966873646, decouple_loss:0.000886476889718324
2023-05-01 02:06:53 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12135013192892075, mean p set: 0.4502691626548767
loss_pred:0.017472054809331894, decouple_loss:0.000891666451934725
The modified gen p mean: 0.4495377242565155, gen p mean: -0.11592026799917221, mean p set: 0.4500633478164673
loss_pred:0.01686681993305683, decouple_loss:0.001308478182181716
The modified gen p mean: 0.4497806131839752, gen p mean: -0.11512790620326996, mean p set: 0.45035696029663086
loss_pred:0.017241330817341805, decouple_loss:0.00099249929189682
WV_1_PC_1_EH_0_PS_40, loss: 0.017246611416339874, avg_mse: 0.026813117787241936
current test mse: 0.026813
Iteration: 811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705691933631897, gen p mean: -0.11478107422590256, mean p set: 0.4476316571235657
loss_pred:0.01574578881263733, decouple_loss:0.00084523024270311
The modified gen p mean: 0.4463396966457367, gen p mean: -0.11864916235208511, mean p set: 0.44691362977027893
loss_pred:0.015473289415240288, decouple_loss:0.0009904876351356506
The modified gen p mean: 0.4474976360797882, gen p mean: -0.1173875629901886, mean p set: 0.44807347655296326
loss_pred:0.015092707239091396, decouple_loss:0.0008430726593360305
Iteration: 812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465935528278351, gen p mean: -0.11247508972883224, mean p set: 0.4471670687198639
loss_pred:0.0150653887540102, decouple_loss:0.0009972593979910016
The modified gen p mean: 0.44715288281440735, gen p mean: -0.11558589339256287, mean p set: 0.4477251172065735The modified gen p mean: 0.447490930557251, gen p mean: -0.11402752995491028, mean p set: 0.44806838035583496
loss_pred:0.01543527003377676, decouple_loss:0.0010447109816595912
loss_pred:0.014839536510407925, decouple_loss:0.0013921767240390182
Iteration: 813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467274248600006, gen p mean: -0.114169642329216, mean p set: 0.44730156660079956
loss_pred:0.015345498919487, decouple_loss:0.0010972395539283752
The modified gen p mean: 0.44661110639572144, gen p mean: -0.11447060853242874, mean p set: 0.447183758020401
loss_pred:0.015370702371001244, decouple_loss:0.000836481514852494
The modified gen p mean: 0.4465758204460144, gen p mean: -0.11494917422533035, mean p set: 0.4471500515937805
loss_pred:0.015802109614014626, decouple_loss:0.0008186429622583091
Iteration: 814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466431140899658, gen p mean: -0.1175704300403595, mean p set: 0.44722166657447815
The modified gen p mean: 0.4459609091281891, gen p mean: -0.11034683883190155, mean p set: 0.44653791189193726
loss_pred:0.01536078006029129, decouple_loss:0.0009781932458281517
loss_pred:0.015405784361064434, decouple_loss:0.001179748447611928
The modified gen p mean: 0.446269154548645, gen p mean: -0.11286323517560959, mean p set: 0.446846604347229
loss_pred:0.015254477970302105, decouple_loss:0.0008417131612077355
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489780366420746, gen p mean: -0.1030726432800293, mean p set: 0.449554443359375
The modified gen p mean: 0.44756460189819336, gen p mean: -0.10871508717536926, mean p set: 0.4481402039527893
loss_pred:0.015076853334903717, decouple_loss:0.0011457077926024795
loss_pred:0.01495247334241867, decouple_loss:0.0009623199002817273
The modified gen p mean: 0.4471742510795593, gen p mean: -0.10972798615694046, mean p set: 0.4477499723434448
loss_pred:0.015071391128003597, decouple_loss:0.0009620742639526725
Iteration: 816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740092754364014, gen p mean: -0.11005529761314392, mean p set: 0.4479774832725525
loss_pred:0.014610309153795242, decouple_loss:0.0008767879335209727
The modified gen p mean: 0.4496578276157379, gen p mean: -0.10292933881282806, mean p set: 0.4502353370189667
loss_pred:0.014621065929532051, decouple_loss:0.0009917767019942403
The modified gen p mean: 0.4472910165786743, gen p mean: -0.10612531751394272, mean p set: 0.44786569476127625
loss_pred:0.015113627538084984, decouple_loss:0.0008669054368510842
Iteration: 817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775620102882385, gen p mean: -0.10946448147296906, mean p set: 0.44833314418792725
loss_pred:0.01542616356164217, decouple_loss:0.0009354247013106942
The modified gen p mean: 0.4465980529785156, gen p mean: -0.11652632802724838, mean p set: 0.447174608707428
loss_pred:0.015726929530501366, decouple_loss:0.0009211466531269252
The modified gen p mean: 0.45009592175483704, gen p mean: -0.10719423741102219, mean p set: 0.45067334175109863
loss_pred:0.01442654337733984, decouple_loss:0.0008821282535791397
Iteration: 818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733017683029175, gen p mean: -0.11534246057271957, mean p set: 0.4479064643383026
loss_pred:0.01501473132520914, decouple_loss:0.0009376549278385937
The modified gen p mean: 0.44994136691093445, gen p mean: -0.10971707105636597, mean p set: 0.4505176842212677
The modified gen p mean: 0.4498612582683563, gen p mean: -0.10942455381155014, mean p set: 0.4504365622997284
loss_pred:0.014101198874413967, decouple_loss:0.0009970078244805336
loss_pred:0.01405281201004982, decouple_loss:0.0007796123973093927
Iteration: 819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473368227481842, gen p mean: -0.11162083595991135, mean p set: 0.4479128420352936
loss_pred:0.014949285425245762, decouple_loss:0.0009293972980231047
The modified gen p mean: 0.4488453269004822, gen p mean: -0.11913593113422394, mean p set: 0.4494233727455139
loss_pred:0.015318157151341438, decouple_loss:0.0009440641733817756
The modified gen p mean: 0.44829830527305603, gen p mean: -0.11484222114086151, mean p set: 0.44887375831604004
loss_pred:0.015798192471265793, decouple_loss:0.0008727505337446928
Iteration: 820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496617913246155, gen p mean: -0.12285264581441879, mean p set: 0.45023879408836365
loss_pred:0.015110159292817116, decouple_loss:0.001019001821987331
The modified gen p mean: 0.44828253984451294, gen p mean: -0.11915089190006256, mean p set: 0.44885799288749695
The modified gen p mean: 0.4487088620662689, gen p mean: -0.11251209676265717, mean p set: 0.4492860734462738
loss_pred:0.014823085628449917, decouple_loss:0.0008859924273565412
loss_pred:0.014731831848621368, decouple_loss:0.0008224978810176253
2023-05-01 02:09:39 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1264362633228302, mean p set: 0.4502691626548767
loss_pred:0.017454449087381363, decouple_loss:0.001024778699502349
The modified gen p mean: 0.4495343267917633, gen p mean: -0.12078902870416641, mean p set: 0.4500633478164673
loss_pred:0.016844462603330612, decouple_loss:0.0011866672430187464
The modified gen p mean: 0.4497799277305603, gen p mean: -0.12030629813671112, mean p set: 0.45035696029663086
loss_pred:0.0171503908932209, decouple_loss:0.0013850778341293335
WV_1_PC_1_EH_0_PS_40, loss: 0.01720970869064331, avg_mse: 0.02673826925456524
current test mse: 0.026738
Iteration: 821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485308527946472, gen p mean: -0.12422358244657516, mean p set: 0.44910797476768494
loss_pred:0.014239714480936527, decouple_loss:0.0014932819176465273
The modified gen p mean: 0.44830700755119324, gen p mean: -0.11862768977880478, mean p set: 0.4488815367221832The modified gen p mean: 0.4474520683288574, gen p mean: -0.11533572524785995, mean p set: 0.4480287730693817
loss_pred:0.016089139506220818, decouple_loss:0.0011449509765952826
loss_pred:0.0156431682407856, decouple_loss:0.0012454251991584897
Iteration: 822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785627722740173, gen p mean: -0.12137187272310257, mean p set: 0.44843384623527527
loss_pred:0.014957702718675137, decouple_loss:0.0010073479497805238
The modified gen p mean: 0.4472521245479584, gen p mean: -0.11687108129262924, mean p set: 0.44782793521881104The modified gen p mean: 0.44891253113746643, gen p mean: -0.12875866889953613, mean p set: 0.4494871497154236
loss_pred:0.015333151444792747, decouple_loss:0.0008176106493920088
loss_pred:0.01347164437174797, decouple_loss:0.0009604923543520272
Iteration: 823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489871561527252, gen p mean: -0.1193544790148735, mean p set: 0.4495624303817749
loss_pred:0.01433627214282751, decouple_loss:0.0010240484261885285
The modified gen p mean: 0.44866296648979187, gen p mean: -0.11849423497915268, mean p set: 0.44923779368400574The modified gen p mean: 0.44863009452819824, gen p mean: -0.12025921046733856, mean p set: 0.44920656085014343
loss_pred:0.01523092482239008, decouple_loss:0.0009806194575503469
loss_pred:0.015170266851782799, decouple_loss:0.0007914903690107167
Iteration: 824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480985701084137, gen p mean: -0.11428181082010269, mean p set: 0.44867458939552307
loss_pred:0.015373739413917065, decouple_loss:0.0009579186444170773
The modified gen p mean: 0.4474596679210663, gen p mean: -0.11364046484231949, mean p set: 0.44803765416145325
loss_pred:0.015023572370409966, decouple_loss:0.0008910624892450869
The modified gen p mean: 0.44880715012550354, gen p mean: -0.11351919919252396, mean p set: 0.4493841528892517
loss_pred:0.014642246998846531, decouple_loss:0.0010033781873062253
Iteration: 825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44883882999420166, gen p mean: -0.1201174184679985, mean p set: 0.4494149386882782
loss_pred:0.014993445947766304, decouple_loss:0.0007776904967613518
The modified gen p mean: 0.44827210903167725, gen p mean: -0.11856122314929962, mean p set: 0.44884639978408813
loss_pred:0.014893227256834507, decouple_loss:0.0009049124782904983
The modified gen p mean: 0.44717204570770264, gen p mean: -0.11091408133506775, mean p set: 0.447748064994812
loss_pred:0.01445517037063837, decouple_loss:0.0006582702044397593
Iteration: 826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45155730843544006, gen p mean: -0.11611369997262955, mean p set: 0.4521370232105255
loss_pred:0.014703866094350815, decouple_loss:0.0009700652444735169
The modified gen p mean: 0.4477587342262268, gen p mean: -0.1147606298327446, mean p set: 0.4483363628387451
loss_pred:0.015086857602000237, decouple_loss:0.0010338512947782874
The modified gen p mean: 0.4496225118637085, gen p mean: -0.12543600797653198, mean p set: 0.45020073652267456
loss_pred:0.014017349109053612, decouple_loss:0.0013285486493259668
Iteration: 827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906318187713623, gen p mean: -0.12461411952972412, mean p set: 0.4496400058269501
loss_pred:0.01447033230215311, decouple_loss:0.0008752723806537688
The modified gen p mean: 0.4490278363227844, gen p mean: -0.13010621070861816, mean p set: 0.4496042728424072
loss_pred:0.013601279817521572, decouple_loss:0.001167087466455996
The modified gen p mean: 0.448466420173645, gen p mean: -0.12064339965581894, mean p set: 0.44904303550720215
loss_pred:0.015531409531831741, decouple_loss:0.0010506556136533618
Iteration: 828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716107845306396, gen p mean: -0.1138182058930397, mean p set: 0.4477371871471405
loss_pred:0.014795901253819466, decouple_loss:0.001013711211271584
The modified gen p mean: 0.44669434428215027, gen p mean: -0.12545819580554962, mean p set: 0.4472704529762268
loss_pred:0.014777698554098606, decouple_loss:0.001176136895082891
The modified gen p mean: 0.44860073924064636, gen p mean: -0.11909157037734985, mean p set: 0.449176549911499
loss_pred:0.0147976353764534, decouple_loss:0.0009897847194224596
Iteration: 829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475651979446411, gen p mean: -0.1168174222111702, mean p set: 0.44814345240592957
loss_pred:0.015429995954036713, decouple_loss:0.0009677685447968543
The modified gen p mean: 0.4506534934043884, gen p mean: -0.11750227957963943, mean p set: 0.45123034715652466
loss_pred:0.014429919421672821, decouple_loss:0.001330837607383728
The modified gen p mean: 0.4479791522026062, gen p mean: -0.11649409681558609, mean p set: 0.4485572874546051
loss_pred:0.014870651997625828, decouple_loss:0.00094759272178635
Iteration: 830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448098748922348, gen p mean: -0.12581592798233032, mean p set: 0.44867387413978577
loss_pred:0.01482947077602148, decouple_loss:0.0008072965429164469
The modified gen p mean: 0.4483207166194916, gen p mean: -0.11668268591165543, mean p set: 0.44889771938323975
The modified gen p mean: 0.4487933814525604, gen p mean: -0.1250000298023224, mean p set: 0.4493709206581116
loss_pred:0.01562021765857935, decouple_loss:0.0008019031374715269
loss_pred:0.014927370473742485, decouple_loss:0.0008774640155024827
2023-05-01 02:11:45 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12182123959064484, mean p set: 0.4502691626548767
loss_pred:0.017533468082547188, decouple_loss:0.001081577967852354
The modified gen p mean: 0.44953563809394836, gen p mean: -0.1167711690068245, mean p set: 0.4500633478164673
loss_pred:0.016784533858299255, decouple_loss:0.0009468358475714922
The modified gen p mean: 0.4497826397418976, gen p mean: -0.11625286191701889, mean p set: 0.45035696029663086
loss_pred:0.017057081684470177, decouple_loss:0.0009633053559809923
WV_1_PC_1_EH_0_PS_40, loss: 0.017174890264868736, avg_mse: 0.02672155573964119
current test mse: 0.026722
Iteration: 831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473205804824829, gen p mean: -0.114092156291008, mean p set: 0.4478965699672699
loss_pred:0.014867767691612244, decouple_loss:0.0010362290777266026
The modified gen p mean: 0.4487467408180237, gen p mean: -0.12189041078090668, mean p set: 0.4493279755115509
loss_pred:0.013645975850522518, decouple_loss:0.001029826351441443
The modified gen p mean: 0.4480196237564087, gen p mean: -0.11407650262117386, mean p set: 0.44859644770622253
loss_pred:0.014743195846676826, decouple_loss:0.0009771313052624464
Iteration: 832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492569863796234, gen p mean: -0.11353451758623123, mean p set: 0.4498351216316223
loss_pred:0.01439913734793663, decouple_loss:0.0009181841742247343
The modified gen p mean: 0.4470202922821045, gen p mean: -0.11983612179756165, mean p set: 0.4475933015346527The modified gen p mean: 0.44970187544822693, gen p mean: -0.1148415356874466, mean p set: 0.4502794146537781
loss_pred:0.01503400132060051, decouple_loss:0.0010727611370384693
loss_pred:0.014724806882441044, decouple_loss:0.000868434552103281
Iteration: 833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810324907302856, gen p mean: -0.11957161873579025, mean p set: 0.44867774844169617
loss_pred:0.014876991510391235, decouple_loss:0.0010492833098396659
The modified gen p mean: 0.4495159685611725, gen p mean: -0.11807490140199661, mean p set: 0.45009157061576843
loss_pred:0.013869351707398891, decouple_loss:0.0009591093403287232
The modified gen p mean: 0.44681817293167114, gen p mean: -0.1103297770023346, mean p set: 0.447394996881485
loss_pred:0.014451680704951286, decouple_loss:0.0008019751403480768
Iteration: 834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448532372713089, gen p mean: -0.1114848405122757, mean p set: 0.44910773634910583
loss_pred:0.014218028634786606, decouple_loss:0.0011006282875314355
The modified gen p mean: 0.44760197401046753, gen p mean: -0.10824622213840485, mean p set: 0.4481779932975769
loss_pred:0.015391766093671322, decouple_loss:0.0008113303920254111
The modified gen p mean: 0.44788724184036255, gen p mean: -0.1151692345738411, mean p set: 0.44846272468566895
loss_pred:0.013605614192783833, decouple_loss:0.0011511610355228186
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
NaN value num: 0
Iteration: 835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504615068435669, gen p mean: -0.10739496350288391, mean p set: 0.4510369300842285
loss_pred:0.018815483897924423, decouple_loss:0.001051884377375245
The modified gen p mean: 0.44794100522994995, gen p mean: -0.11293131858110428, mean p set: 0.4485178589820862
loss_pred:0.017719294875860214, decouple_loss:0.000920930237043649
The modified gen p mean: 0.4485310912132263, gen p mean: -0.11043117195367813, mean p set: 0.44910579919815063
loss_pred:0.018467126414179802, decouple_loss:0.0009149765828624368
Iteration: 836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450342059135437, gen p mean: -0.10818500071763992, mean p set: 0.45092108845710754
loss_pred:0.019233696162700653, decouple_loss:0.0009732407634146512
The modified gen p mean: 0.4494967758655548, gen p mean: -0.10466770082712173, mean p set: 0.45007210969924927
The modified gen p mean: 0.4489389657974243, gen p mean: -0.1111084446310997, mean p set: 0.4495159983634949
loss_pred:0.017337189987301826, decouple_loss:0.0009442927548661828
loss_pred:0.018176842480897903, decouple_loss:0.0008013260667212307
Iteration: 837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488963782787323, gen p mean: -0.10989584773778915, mean p set: 0.4494756758213043
loss_pred:0.0172774326056242, decouple_loss:0.0009635435999371111
The modified gen p mean: 0.44928768277168274, gen p mean: -0.10460633039474487, mean p set: 0.44986405968666077
loss_pred:0.017987700179219246, decouple_loss:0.001063461066223681
The modified gen p mean: 0.448925256729126, gen p mean: -0.10884685069322586, mean p set: 0.4495038390159607
loss_pred:0.017501384019851685, decouple_loss:0.0010242591379210353
Iteration: 838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495067596435547, gen p mean: -0.10076259076595306, mean p set: 0.45008236169815063
loss_pred:0.018857356160879135, decouple_loss:0.0014061846304684877
The modified gen p mean: 0.44854915142059326, gen p mean: -0.10626207292079926, mean p set: 0.44912293553352356
loss_pred:0.018746867775917053, decouple_loss:0.0011792958248406649
The modified gen p mean: 0.4492861032485962, gen p mean: -0.10706339031457901, mean p set: 0.44986429810523987
loss_pred:0.017905939370393753, decouple_loss:0.0012378712417557836
Iteration: 839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44924333691596985, gen p mean: -0.10606541484594345, mean p set: 0.44981908798217773
loss_pred:0.01753387600183487, decouple_loss:0.0011362711666151881
The modified gen p mean: 0.4502778649330139, gen p mean: -0.10570478439331055, mean p set: 0.4508536458015442
loss_pred:0.017217967659235, decouple_loss:0.0009857267141342163
The modified gen p mean: 0.44953808188438416, gen p mean: -0.103836290538311, mean p set: 0.4501130282878876
loss_pred:0.01750222034752369, decouple_loss:0.0010049716802313924
Iteration: 840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491337537765503, gen p mean: -0.11291380971670151, mean p set: 0.4497132897377014
loss_pred:0.017414329573512077, decouple_loss:0.0012569265672937036
The modified gen p mean: 0.4485253393650055, gen p mean: -0.10637879371643066, mean p set: 0.4491018056869507
The modified gen p mean: 0.44888201355934143, gen p mean: -0.1021074503660202, mean p set: 0.449457585811615
loss_pred:0.01822800748050213, decouple_loss:0.0009527190122753382
loss_pred:0.018860328942537308, decouple_loss:0.0010285191237926483
2023-05-01 02:14:34 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12371975183486938, mean p set: 0.4502691626548767
loss_pred:0.017655307427048683, decouple_loss:0.0012873862870037556
The modified gen p mean: 0.44953328371047974, gen p mean: -0.11792945116758347, mean p set: 0.4500633478164673
loss_pred:0.01689867302775383, decouple_loss:0.0011250959942117333
The modified gen p mean: 0.4497827887535095, gen p mean: -0.11734116822481155, mean p set: 0.45035696029663086
loss_pred:0.017182044684886932, decouple_loss:0.0009797712555155158
WV_1_PC_1_EH_0_PS_40, loss: 0.017301879823207855, avg_mse: 0.026810556650161743
current test mse: 0.026811
Iteration: 841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018526911735535, gen p mean: -0.11283748596906662, mean p set: 0.4507644772529602
loss_pred:0.018081869930028915, decouple_loss:0.0010327149648219347
The modified gen p mean: 0.450017511844635, gen p mean: -0.11099053174257278, mean p set: 0.4505922794342041The modified gen p mean: 0.44911935925483704, gen p mean: -0.10590865463018417, mean p set: 0.4496959447860718
loss_pred:0.017239350825548172, decouple_loss:0.0010520423529669642
loss_pred:0.018427932634949684, decouple_loss:0.0009012725204229355
Iteration: 842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44946685433387756, gen p mean: -0.11678421497344971, mean p set: 0.4500441253185272
loss_pred:0.018215687945485115, decouple_loss:0.0010484213707968593
The modified gen p mean: 0.44916650652885437, gen p mean: -0.11266633868217468, mean p set: 0.4497425854206085The modified gen p mean: 0.44948238134384155, gen p mean: -0.11484680324792862, mean p set: 0.4500577449798584
loss_pred:0.017345240339636803, decouple_loss:0.001139568630605936
loss_pred:0.016896184533834457, decouple_loss:0.0009564614156261086
Iteration: 843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45035964250564575, gen p mean: -0.11017327010631561, mean p set: 0.45093461871147156
loss_pred:0.0184094849973917, decouple_loss:0.0011010990710929036
The modified gen p mean: 0.44910067319869995, gen p mean: -0.10772781074047089, mean p set: 0.44967761635780334
loss_pred:0.01822127029299736, decouple_loss:0.0009689711150713265
The modified gen p mean: 0.4494113326072693, gen p mean: -0.1150442436337471, mean p set: 0.4499862790107727
loss_pred:0.017463356256484985, decouple_loss:0.0009208847768604755
Iteration: 844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968628883361816, gen p mean: -0.10686662048101425, mean p set: 0.45026183128356934
loss_pred:0.01813523843884468, decouple_loss:0.0008198642171919346
The modified gen p mean: 0.44864559173583984, gen p mean: -0.111932672560215, mean p set: 0.4492204785346985
loss_pred:0.01757989451289177, decouple_loss:0.0009260675287805498
The modified gen p mean: 0.4502232074737549, gen p mean: -0.10693912953138351, mean p set: 0.4508011043071747
loss_pred:0.018029261380434036, decouple_loss:0.0009719381923787296
Iteration: 845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499357342720032, gen p mean: -0.10924292355775833, mean p set: 0.45051151514053345
loss_pred:0.018275238573551178, decouple_loss:0.0007937781047075987
The modified gen p mean: 0.45008939504623413, gen p mean: -0.11315290629863739, mean p set: 0.4506663978099823
loss_pred:0.017644135281443596, decouple_loss:0.0009575703297741711
The modified gen p mean: 0.45050886273384094, gen p mean: -0.11246909946203232, mean p set: 0.45108816027641296
loss_pred:0.017359554767608643, decouple_loss:0.0007845498621463776
Iteration: 846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44954872131347656, gen p mean: -0.1183183342218399, mean p set: 0.45012786984443665
loss_pred:0.017081812024116516, decouple_loss:0.00083497742889449
The modified gen p mean: 0.4501311182975769, gen p mean: -0.11215309053659439, mean p set: 0.45070680975914
The modified gen p mean: 0.4501766562461853, gen p mean: -0.11008299887180328, mean p set: 0.450754314661026
loss_pred:0.018505148589611053, decouple_loss:0.0009285198757424951
loss_pred:0.01810789853334427, decouple_loss:0.0010536541230976582
Iteration: 847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958415627479553, gen p mean: -0.11432169377803802, mean p set: 0.45016080141067505
loss_pred:0.017239345237612724, decouple_loss:0.0007711974321864545
The modified gen p mean: 0.45163068175315857, gen p mean: -0.11094057559967041, mean p set: 0.45220738649368286
The modified gen p mean: 0.4519790709018707, gen p mean: -0.11174119263887405, mean p set: 0.45255526900291443
loss_pred:0.01797306165099144, decouple_loss:0.000919370970223099
loss_pred:0.018352435901761055, decouple_loss:0.0009296840289607644
Iteration: 848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494898021221161, gen p mean: -0.11598065495491028, mean p set: 0.4500654339790344
loss_pred:0.017579253762960434, decouple_loss:0.0010792029788717628
The modified gen p mean: 0.4496789872646332, gen p mean: -0.1135161742568016, mean p set: 0.4502537250518799
The modified gen p mean: 0.45053866505622864, gen p mean: -0.1157439649105072, mean p set: 0.4511137008666992
loss_pred:0.01718202419579029, decouple_loss:0.0008182983729057014
loss_pred:0.01743689365684986, decouple_loss:0.0007944818353280425
Iteration: 849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497150182723999, gen p mean: -0.11359549313783646, mean p set: 0.4502915143966675
loss_pred:0.01762625388801098, decouple_loss:0.0008171969093382359
The modified gen p mean: 0.44892868399620056, gen p mean: -0.12017176300287247, mean p set: 0.44950413703918457
The modified gen p mean: 0.4493471086025238, gen p mean: -0.11994341015815735, mean p set: 0.44992440938949585
loss_pred:0.018606361001729965, decouple_loss:0.0011005399283021688
loss_pred:0.01747293956577778, decouple_loss:0.0008341430220752954
Iteration: 850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931140542030334, gen p mean: -0.11263300478458405, mean p set: 0.44988563656806946
loss_pred:0.01718428172171116, decouple_loss:0.0007776228012517095
The modified gen p mean: 0.4480106830596924, gen p mean: -0.1178092509508133, mean p set: 0.44858694076538086
The modified gen p mean: 0.4513256251811981, gen p mean: -0.11870023608207703, mean p set: 0.45190247893333435
loss_pred:0.01860937848687172, decouple_loss:0.0009193533333018422
loss_pred:0.018353579565882683, decouple_loss:0.0008831443265080452
2023-05-01 02:16:40 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.12911666929721832, mean p set: 0.4502691626548767
loss_pred:0.017715146765112877, decouple_loss:0.0009351955959573388
The modified gen p mean: 0.44953569769859314, gen p mean: -0.12335896492004395, mean p set: 0.4500633478164673
loss_pred:0.017071949318051338, decouple_loss:0.0010153991170227528
The modified gen p mean: 0.4497798681259155, gen p mean: -0.12283842265605927, mean p set: 0.45035696029663086
loss_pred:0.017207825556397438, decouple_loss:0.0009465835755690932
WV_1_PC_1_EH_0_PS_40, loss: 0.01737992838025093, avg_mse: 0.026917340233922005
current test mse: 0.026917
Iteration: 851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449650377035141, gen p mean: -0.11908785253763199, mean p set: 0.4502260982990265
loss_pred:0.017508940771222115, decouple_loss:0.000751321145799011
The modified gen p mean: 0.4498291015625, gen p mean: -0.11500514298677444, mean p set: 0.45040687918663025The modified gen p mean: 0.4501344561576843, gen p mean: -0.11700659245252609, mean p set: 0.4507102370262146
loss_pred:0.01771184615790844, decouple_loss:0.0009559005848132074
loss_pred:0.01784413494169712, decouple_loss:0.0007802445907145739
Iteration: 852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44967958331108093, gen p mean: -0.11912939697504044, mean p set: 0.45025599002838135
loss_pred:0.01752823404967785, decouple_loss:0.0008937142556533217
The modified gen p mean: 0.44951850175857544, gen p mean: -0.11674954742193222, mean p set: 0.4500959813594818The modified gen p mean: 0.44970619678497314, gen p mean: -0.1221962422132492, mean p set: 0.450285404920578
loss_pred:0.01838715933263302, decouple_loss:0.0009260776569135487
loss_pred:0.01799725741147995, decouple_loss:0.0010166899301111698
Iteration: 853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44867244362831116, gen p mean: -0.12084483355283737, mean p set: 0.4492502808570862
loss_pred:0.017467115074396133, decouple_loss:0.0009727213182486594
The modified gen p mean: 0.44989362359046936, gen p mean: -0.11235776543617249, mean p set: 0.45046865940093994
loss_pred:0.017260689288377762, decouple_loss:0.0008740510675124824
The modified gen p mean: 0.4497453570365906, gen p mean: -0.11246514320373535, mean p set: 0.45032259821891785
loss_pred:0.018614472821354866, decouple_loss:0.0007895672461017966
Iteration: 854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44932806491851807, gen p mean: -0.11780034005641937, mean p set: 0.44990405440330505
loss_pred:0.017400532960891724, decouple_loss:0.0007615655194967985
The modified gen p mean: 0.4488412141799927, gen p mean: -0.11191482096910477, mean p set: 0.4494173526763916
loss_pred:0.01800372265279293, decouple_loss:0.0008457994554191828
The modified gen p mean: 0.44975918531417847, gen p mean: -0.11656545847654343, mean p set: 0.45033276081085205
loss_pred:0.017678754404187202, decouple_loss:0.0008678542217239738
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
NaN value num: 0
Iteration: 855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515684247016907, gen p mean: -0.1079319640994072, mean p set: 0.4521452486515045
loss_pred:0.017820442095398903, decouple_loss:0.0008354855817742646
The modified gen p mean: 0.45087930560112, gen p mean: -0.10758796334266663, mean p set: 0.4514564573764801
loss_pred:0.017792167142033577, decouple_loss:0.0007813128759153187
The modified gen p mean: 0.4497585892677307, gen p mean: -0.10917562991380692, mean p set: 0.450334757566452
loss_pred:0.018323924392461777, decouple_loss:0.0009421845315955579
Iteration: 856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520327150821686, gen p mean: -0.11486037820577621, mean p set: 0.45260950922966003
loss_pred:0.01846536435186863, decouple_loss:0.0009763395646587014
The modified gen p mean: 0.4524262249469757, gen p mean: -0.11635321378707886, mean p set: 0.4530024528503418
loss_pred:0.01729496382176876, decouple_loss:0.0010197358205914497
The modified gen p mean: 0.45182764530181885, gen p mean: -0.12104702740907669, mean p set: 0.45240524411201477
loss_pred:0.017709869891405106, decouple_loss:0.0009435499086976051
Iteration: 857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501919746398926, gen p mean: -0.12386999279260635, mean p set: 0.450769305229187
loss_pred:0.017718831077218056, decouple_loss:0.0008860639063641429
The modified gen p mean: 0.4512436091899872, gen p mean: -0.1157197505235672, mean p set: 0.45182281732559204
The modified gen p mean: 0.4529576301574707, gen p mean: -0.11945125460624695, mean p set: 0.4535359740257263
loss_pred:0.017891939729452133, decouple_loss:0.0008536063251085579
loss_pred:0.018215613439679146, decouple_loss:0.0010153487091884017
Iteration: 858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45272296667099, gen p mean: -0.1234227791428566, mean p set: 0.4533001780509949
loss_pred:0.017600087448954582, decouple_loss:0.0009167258394882083
The modified gen p mean: 0.45184963941574097, gen p mean: -0.11357079446315765, mean p set: 0.4524257183074951
loss_pred:0.018391896039247513, decouple_loss:0.0010341739980503917
The modified gen p mean: 0.4502738416194916, gen p mean: -0.12255483865737915, mean p set: 0.4508522152900696
loss_pred:0.017453841865062714, decouple_loss:0.0010464712977409363
Iteration: 859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522693157196045, gen p mean: -0.11897537112236023, mean p set: 0.45284631848335266
loss_pred:0.017432034015655518, decouple_loss:0.0009833144722506404
The modified gen p mean: 0.45328134298324585, gen p mean: -0.11745888739824295, mean p set: 0.45385733246803284
loss_pred:0.01940472424030304, decouple_loss:0.0009563674102537334
The modified gen p mean: 0.45185917615890503, gen p mean: -0.1177431121468544, mean p set: 0.45243576169013977
loss_pred:0.017730876803398132, decouple_loss:0.0009246382396668196
Iteration: 860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509962797164917, gen p mean: -0.1204371228814125, mean p set: 0.45157456398010254
loss_pred:0.01769224740564823, decouple_loss:0.000743804732337594
The modified gen p mean: 0.44973450899124146, gen p mean: -0.12304918467998505, mean p set: 0.4503115713596344
loss_pred:0.017196107655763626, decouple_loss:0.0008580914000049233
The modified gen p mean: 0.45128825306892395, gen p mean: -0.11446117609739304, mean p set: 0.4518618583679199
loss_pred:0.018088867887854576, decouple_loss:0.000978831434622407
2023-05-01 02:19:29 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12995822727680206, mean p set: 0.4502691626548767
loss_pred:0.017772646620869637, decouple_loss:0.0009861463913694024
The modified gen p mean: 0.44953635334968567, gen p mean: -0.12418904155492783, mean p set: 0.4500633478164673
loss_pred:0.017010372132062912, decouple_loss:0.0010668659815564752
The modified gen p mean: 0.4497808814048767, gen p mean: -0.12334811687469482, mean p set: 0.45035696029663086
loss_pred:0.017367960885167122, decouple_loss:0.0008999164565466344
WV_1_PC_1_EH_0_PS_40, loss: 0.01743287593126297, avg_mse: 0.02700093388557434
current test mse: 0.027001
Iteration: 861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515320062637329, gen p mean: -0.11700373142957687, mean p set: 0.45210960507392883
loss_pred:0.016973000019788742, decouple_loss:0.0010073388693854213
The modified gen p mean: 0.45144134759902954, gen p mean: -0.11526285856962204, mean p set: 0.4520201086997986The modified gen p mean: 0.45159265398979187, gen p mean: -0.11636701971292496, mean p set: 0.4521689713001251
loss_pred:0.01727641187608242, decouple_loss:0.0008920141262933612
loss_pred:0.017698213458061218, decouple_loss:0.0010106490226462483
Iteration: 862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962528347969055, gen p mean: -0.12371961027383804, mean p set: 0.4502023756504059
The modified gen p mean: 0.4520362615585327, gen p mean: -0.11593683063983917, mean p set: 0.45261165499687195
loss_pred:0.017333298921585083, decouple_loss:0.0009006526088342071
loss_pred:0.016731547191739082, decouple_loss:0.0008673544507473707
The modified gen p mean: 0.45101332664489746, gen p mean: -0.12084389477968216, mean p set: 0.45158782601356506
loss_pred:0.018294621258974075, decouple_loss:0.0010332497768104076
Iteration: 863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502457082271576, gen p mean: -0.1170700192451477, mean p set: 0.4508230984210968
loss_pred:0.018868377432227135, decouple_loss:0.0011506738374009728
The modified gen p mean: 0.4500950574874878, gen p mean: -0.11784952133893967, mean p set: 0.45066869258880615The modified gen p mean: 0.4490260183811188, gen p mean: -0.11568307876586914, mean p set: 0.4496026933193207
loss_pred:0.01888847164809704, decouple_loss:0.0007755073020234704loss_pred:0.01859905570745468, decouple_loss:0.0011172026861459017
Iteration: 864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529356360435486, gen p mean: -0.11207042634487152, mean p set: 0.4535127878189087
loss_pred:0.01789390668272972, decouple_loss:0.0009251462761312723
The modified gen p mean: 0.45254722237586975, gen p mean: -0.1127900630235672, mean p set: 0.4531249403953552
loss_pred:0.017986511811614037, decouple_loss:0.001028134603984654
The modified gen p mean: 0.44975051283836365, gen p mean: -0.11322112381458282, mean p set: 0.45032763481140137
loss_pred:0.018041269853711128, decouple_loss:0.0008616378763690591
Iteration: 865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526362717151642, gen p mean: -0.11582818627357483, mean p set: 0.45321333408355713
loss_pred:0.01753680408000946, decouple_loss:0.0008531418861821294
The modified gen p mean: 0.45171216130256653, gen p mean: -0.11679131537675858, mean p set: 0.4522883892059326
loss_pred:0.017367051914334297, decouple_loss:0.0008183167665265501
The modified gen p mean: 0.45296964049339294, gen p mean: -0.1174314022064209, mean p set: 0.4535471498966217
loss_pred:0.017162909731268883, decouple_loss:0.0011264021741226315
Iteration: 866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523088335990906, gen p mean: -0.10919510573148727, mean p set: 0.45288509130477905
loss_pred:0.017295442521572113, decouple_loss:0.001063260599039495
The modified gen p mean: 0.45216378569602966, gen p mean: -0.11401598155498505, mean p set: 0.45274025201797485
The modified gen p mean: 0.4519774615764618, gen p mean: -0.10988440364599228, mean p set: 0.45255225896835327
loss_pred:0.01782066375017166, decouple_loss:0.0008534675580449402
loss_pred:0.016868457198143005, decouple_loss:0.0011834960896521807
Iteration: 867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450974702835083, gen p mean: -0.11826051026582718, mean p set: 0.45155251026153564
loss_pred:0.017925933003425598, decouple_loss:0.0014302447671070695
The modified gen p mean: 0.4510338306427002, gen p mean: -0.11991369724273682, mean p set: 0.4516104459762573
loss_pred:0.017572583630681038, decouple_loss:0.0012350922916084528
The modified gen p mean: 0.4524048864841461, gen p mean: -0.11324964463710785, mean p set: 0.4529826045036316
loss_pred:0.018084699288010597, decouple_loss:0.0010068429401144385
Iteration: 868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452502965927124, gen p mean: -0.12095357477664948, mean p set: 0.45307838916778564
loss_pred:0.017300980165600777, decouple_loss:0.0009175380109809339
The modified gen p mean: 0.45144978165626526, gen p mean: -0.10913495719432831, mean p set: 0.45202744007110596
The modified gen p mean: 0.4505469501018524, gen p mean: -0.11517937481403351, mean p set: 0.45111966133117676
loss_pred:0.018084630370140076, decouple_loss:0.000975887174718082
loss_pred:0.01814715936779976, decouple_loss:0.0008788937120698392
Iteration: 869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521416425704956, gen p mean: -0.11207898706197739, mean p set: 0.45271924138069153
loss_pred:0.01698690466582775, decouple_loss:0.00123918941244483
The modified gen p mean: 0.45227205753326416, gen p mean: -0.11203324049711227, mean p set: 0.45284944772720337
The modified gen p mean: 0.45052868127822876, gen p mean: -0.11159396171569824, mean p set: 0.4511050879955292
loss_pred:0.017703333869576454, decouple_loss:0.0013040740741416812
loss_pred:0.01839582249522209, decouple_loss:0.001021629199385643
Iteration: 870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497409462928772, gen p mean: -0.10884050279855728, mean p set: 0.4503157436847687
loss_pred:0.01762128807604313, decouple_loss:0.0009802366839721799
The modified gen p mean: 0.44982418417930603, gen p mean: -0.10822945833206177, mean p set: 0.45039960741996765
The modified gen p mean: 0.4512141942977905, gen p mean: -0.10634344816207886, mean p set: 0.4517933130264282
loss_pred:0.017791418358683586, decouple_loss:0.0011416382621973753
loss_pred:0.017602087929844856, decouple_loss:0.001047715195454657
2023-05-01 02:21:35 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.118162140250206, mean p set: 0.4502691626548767
loss_pred:0.01763151027262211, decouple_loss:0.0007889902917668223
The modified gen p mean: 0.44953471422195435, gen p mean: -0.11276086419820786, mean p set: 0.4500633478164673
loss_pred:0.016858329996466637, decouple_loss:0.0008410302107222378
The modified gen p mean: 0.4497828483581543, gen p mean: -0.11192914098501205, mean p set: 0.45035696029663086
loss_pred:0.017295127734541893, decouple_loss:0.0007605733117088675
WV_1_PC_1_EH_0_PS_40, loss: 0.017301499843597412, avg_mse: 0.0268465057015419
current test mse: 0.026847
Iteration: 871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523272216320038, gen p mean: -0.10088616609573364, mean p set: 0.4529035687446594
loss_pred:0.017821557819843292, decouple_loss:0.0009053982794284821
The modified gen p mean: 0.45263537764549255, gen p mean: -0.10669524222612381, mean p set: 0.453212171792984The modified gen p mean: 0.45150071382522583, gen p mean: -0.10624724626541138, mean p set: 0.4520774781703949
loss_pred:0.01764962263405323, decouple_loss:0.0010707797482609749loss_pred:0.01756417378783226, decouple_loss:0.0008627038332633674
Iteration: 872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45211535692214966, gen p mean: -0.10190106928348541, mean p set: 0.45269373059272766
loss_pred:0.017511803656816483, decouple_loss:0.0007338550058193505
The modified gen p mean: 0.45060470700263977, gen p mean: -0.1073082834482193, mean p set: 0.4511813521385193The modified gen p mean: 0.45195233821868896, gen p mean: -0.10619315505027771, mean p set: 0.4525289833545685
loss_pred:0.01724322885274887, decouple_loss:0.0011224093614146113
loss_pred:0.017845341935753822, decouple_loss:0.0009935779962688684
Iteration: 873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169597864151, gen p mean: -0.10565102100372314, mean p set: 0.45227110385894775
loss_pred:0.01718985103070736, decouple_loss:0.0010284590534865856
The modified gen p mean: 0.4530201852321625, gen p mean: -0.10075734555721283, mean p set: 0.4535941779613495
loss_pred:0.017763949930667877, decouple_loss:0.0008503070566803217
The modified gen p mean: 0.4511401057243347, gen p mean: -0.10174757987260818, mean p set: 0.45171743631362915
loss_pred:0.017368102446198463, decouple_loss:0.0011619451688602567
Iteration: 874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45177292823791504, gen p mean: -0.10705219954252243, mean p set: 0.45234790444374084
loss_pred:0.01761925034224987, decouple_loss:0.0010093296878039837
The modified gen p mean: 0.4522085189819336, gen p mean: -0.10148616880178452, mean p set: 0.45278608798980713
loss_pred:0.018514202907681465, decouple_loss:0.0009176995372399688
The modified gen p mean: 0.45006975531578064, gen p mean: -0.10506993532180786, mean p set: 0.45064473152160645
loss_pred:0.018324755132198334, decouple_loss:0.0011989590711891651
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448726087808609, gen p mean: -0.10949623584747314, mean p set: 0.44930222630500793The modified gen p mean: 0.44807854294776917, gen p mean: -0.11590981483459473, mean p set: 0.4486553370952606
loss_pred:0.015598702244460583, decouple_loss:0.0008102242136374116
loss_pred:0.016251932829618454, decouple_loss:0.0008148220949806273
The modified gen p mean: 0.4477270543575287, gen p mean: -0.11066566407680511, mean p set: 0.44830384850502014
loss_pred:0.01502090971916914, decouple_loss:0.0008899967069737613
Iteration: 876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496314525604248, gen p mean: -0.11798498034477234, mean p set: 0.450207382440567
loss_pred:0.015352517366409302, decouple_loss:0.0009784192079678178
The modified gen p mean: 0.4475909173488617, gen p mean: -0.10590049624443054, mean p set: 0.4481671154499054
The modified gen p mean: 0.44875213503837585, gen p mean: -0.11321134120225906, mean p set: 0.44932955503463745
loss_pred:0.015547017566859722, decouple_loss:0.0007632794440723956
loss_pred:0.015978191047906876, decouple_loss:0.0008099711267277598
Iteration: 877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858723878860474, gen p mean: -0.11561744660139084, mean p set: 0.44916436076164246
loss_pred:0.015144623816013336, decouple_loss:0.0009174400474876165
The modified gen p mean: 0.44789376854896545, gen p mean: -0.12100772559642792, mean p set: 0.448469340801239
loss_pred:0.01551253255456686, decouple_loss:0.0009425065945833921
The modified gen p mean: 0.4484809339046478, gen p mean: -0.11041492968797684, mean p set: 0.44905519485473633
loss_pred:0.015606055967509747, decouple_loss:0.0008720724144950509
Iteration: 878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831299781799316, gen p mean: -0.12547488510608673, mean p set: 0.4488871097564697
loss_pred:0.015378315933048725, decouple_loss:0.0011701822513714433
The modified gen p mean: 0.4488534927368164, gen p mean: -0.11687987297773361, mean p set: 0.449429988861084
loss_pred:0.016441280022263527, decouple_loss:0.0009451548103243113
The modified gen p mean: 0.44798898696899414, gen p mean: -0.11788482218980789, mean p set: 0.44856372475624084
loss_pred:0.015274460427463055, decouple_loss:0.00090847781393677
Iteration: 879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473816454410553, gen p mean: -0.12192746251821518, mean p set: 0.4479579031467438
loss_pred:0.015597785823047161, decouple_loss:0.0009589206310920417
The modified gen p mean: 0.4491308033466339, gen p mean: -0.1218021810054779, mean p set: 0.4497077465057373
loss_pred:0.015258700586855412, decouple_loss:0.0008624267065897584
The modified gen p mean: 0.4483043849468231, gen p mean: -0.11452429741621017, mean p set: 0.4488828480243683
loss_pred:0.015751929953694344, decouple_loss:0.0010905065573751926
Iteration: 880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484444856643677, gen p mean: -0.11873481422662735, mean p set: 0.4490225911140442
loss_pred:0.015807976946234703, decouple_loss:0.0008640378364361823
The modified gen p mean: 0.4476125240325928, gen p mean: -0.11513268202543259, mean p set: 0.4481886029243469
loss_pred:0.015176181681454182, decouple_loss:0.0007445545634254813
The modified gen p mean: 0.44849324226379395, gen p mean: -0.12085042893886566, mean p set: 0.4490686058998108
loss_pred:0.01608455367386341, decouple_loss:0.0008846988203004003
2023-05-01 02:24:21 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12058746814727783, mean p set: 0.4502691626548767
loss_pred:0.01756502315402031, decouple_loss:0.00089509307872504
The modified gen p mean: 0.44953399896621704, gen p mean: -0.11552183330059052, mean p set: 0.4500633478164673
loss_pred:0.01682651787996292, decouple_loss:0.0009744978742673993
The modified gen p mean: 0.44978222250938416, gen p mean: -0.11485002934932709, mean p set: 0.45035696029663086
loss_pred:0.017204444855451584, decouple_loss:0.0009705335251055658
WV_1_PC_1_EH_0_PS_40, loss: 0.017245998606085777, avg_mse: 0.0267669465392828
current test mse: 0.026767
Iteration: 881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490848779678345, gen p mean: -0.12055269628763199, mean p set: 0.44965940713882446
loss_pred:0.014691994525492191, decouple_loss:0.0008800477371551096
The modified gen p mean: 0.4473492205142975, gen p mean: -0.12039612233638763, mean p set: 0.4479256868362427The modified gen p mean: 0.4482520520687103, gen p mean: -0.1166316568851471, mean p set: 0.4488309919834137
loss_pred:0.016022205352783203, decouple_loss:0.001321436371654272
loss_pred:0.01538706012070179, decouple_loss:0.0009726366261020303
Iteration: 882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935640692710876, gen p mean: -0.11147234588861465, mean p set: 0.44993188977241516
loss_pred:0.01532397884875536, decouple_loss:0.0008575031533837318
The modified gen p mean: 0.4486643970012665, gen p mean: -0.11236352473497391, mean p set: 0.4492400586605072The modified gen p mean: 0.4475153684616089, gen p mean: -0.11011452972888947, mean p set: 0.4480898678302765
loss_pred:0.016086170449852943, decouple_loss:0.001003821729682386
loss_pred:0.01564731076359749, decouple_loss:0.0010929390555247664
Iteration: 883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490429759025574, gen p mean: -0.10598986595869064, mean p set: 0.4496217370033264
loss_pred:0.014625166542828083, decouple_loss:0.0007429750403389335
The modified gen p mean: 0.450099915266037, gen p mean: -0.11162573844194412, mean p set: 0.4506753385066986The modified gen p mean: 0.44784072041511536, gen p mean: -0.10613005608320236, mean p set: 0.44841691851615906
loss_pred:0.014818177558481693, decouple_loss:0.0008096800884231925
loss_pred:0.014673707075417042, decouple_loss:0.0009177130414173007
Iteration: 884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485743045806885, gen p mean: -0.11288511753082275, mean p set: 0.449150025844574
loss_pred:0.015044557861983776, decouple_loss:0.0008196541457436979
The modified gen p mean: 0.44808700680732727, gen p mean: -0.10596057772636414, mean p set: 0.44866296648979187
loss_pred:0.015787826851010323, decouple_loss:0.0011703412747010589
The modified gen p mean: 0.4470615088939667, gen p mean: -0.10856419056653976, mean p set: 0.4476362466812134
loss_pred:0.01629212498664856, decouple_loss:0.0012159424368292093
Iteration: 885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806787371635437, gen p mean: -0.10475106537342072, mean p set: 0.4486420452594757
loss_pred:0.015877943485975266, decouple_loss:0.0009141984046436846
The modified gen p mean: 0.4487246572971344, gen p mean: -0.10669325292110443, mean p set: 0.44930025935173035
loss_pred:0.01486541423946619, decouple_loss:0.000808336422778666
The modified gen p mean: 0.4488615393638611, gen p mean: -0.10574931651353836, mean p set: 0.44943690299987793
loss_pred:0.01496546808630228, decouple_loss:0.0008837781497277319
Iteration: 886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799014925956726, gen p mean: -0.10253391414880753, mean p set: 0.4485659599304199
loss_pred:0.015462272800505161, decouple_loss:0.0008062117849476635
The modified gen p mean: 0.44842594861984253, gen p mean: -0.10962644964456558, mean p set: 0.44900044798851013
loss_pred:0.014950201846659184, decouple_loss:0.0009715187479741871
The modified gen p mean: 0.44907525181770325, gen p mean: -0.11114474385976791, mean p set: 0.4496510326862335
loss_pred:0.01537628285586834, decouple_loss:0.0008468307205475867
Iteration: 887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486824870109558, gen p mean: -0.10496336221694946, mean p set: 0.4492567181587219
The modified gen p mean: 0.4475199580192566, gen p mean: -0.10373178869485855, mean p set: 0.4480970501899719
loss_pred:0.015280994586646557, decouple_loss:0.0009286334970965981
loss_pred:0.014882760122418404, decouple_loss:0.0007822788902558386
The modified gen p mean: 0.44784802198410034, gen p mean: -0.10987569391727448, mean p set: 0.4484257698059082
loss_pred:0.01562608778476715, decouple_loss:0.0011568854097276926
Iteration: 888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487093687057495, gen p mean: -0.10993219912052155, mean p set: 0.4492858350276947
loss_pred:0.014646549709141254, decouple_loss:0.0007538985228165984
The modified gen p mean: 0.4496150612831116, gen p mean: -0.1094573438167572, mean p set: 0.45019209384918213
The modified gen p mean: 0.4478251039981842, gen p mean: -0.10590270161628723, mean p set: 0.44840162992477417
loss_pred:0.0155563959851861, decouple_loss:0.0007889438420534134
loss_pred:0.014517251402139664, decouple_loss:0.0006764904828742146
Iteration: 889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849151372909546, gen p mean: -0.11274684220552444, mean p set: 0.4490663409233093
loss_pred:0.01467957440763712, decouple_loss:0.0009460349101573229
The modified gen p mean: 0.44773635268211365, gen p mean: -0.10782977193593979, mean p set: 0.4483124613761902
loss_pred:0.014638244174420834, decouple_loss:0.00072474405169487
The modified gen p mean: 0.4477483928203583, gen p mean: -0.10704372078180313, mean p set: 0.44832542538642883
loss_pred:0.015405737794935703, decouple_loss:0.0010298314737156034
Iteration: 890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44888249039649963, gen p mean: -0.11540006846189499, mean p set: 0.44945937395095825
loss_pred:0.013833504170179367, decouple_loss:0.001064744428731501
The modified gen p mean: 0.4486177861690521, gen p mean: -0.10559173673391342, mean p set: 0.44919553399086
loss_pred:0.01513269729912281, decouple_loss:0.0011368475388735533
The modified gen p mean: 0.4483162462711334, gen p mean: -0.11201982945203781, mean p set: 0.4488929510116577
loss_pred:0.015279159881174564, decouple_loss:0.0009583234204910696
2023-05-01 02:26:26 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11505399644374847, mean p set: 0.4502691626548767
loss_pred:0.01751096546649933, decouple_loss:0.0007797158905304968
The modified gen p mean: 0.44953200221061707, gen p mean: -0.11023403704166412, mean p set: 0.4500633478164673
loss_pred:0.016883909702301025, decouple_loss:0.0007971111335791647
The modified gen p mean: 0.4497791826725006, gen p mean: -0.10948813706636429, mean p set: 0.45035696029663086
loss_pred:0.017223577946424484, decouple_loss:0.0007489552372135222
WV_1_PC_1_EH_0_PS_40, loss: 0.017244912683963776, avg_mse: 0.02673220820724964
current test mse: 0.026732
Iteration: 891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493432343006134, gen p mean: -0.11034341901540756, mean p set: 0.44992080330848694
loss_pred:0.0160997211933136, decouple_loss:0.000791870173998177
The modified gen p mean: 0.44855380058288574, gen p mean: -0.10820599645376205, mean p set: 0.44913092255592346The modified gen p mean: 0.4483296573162079, gen p mean: -0.11039655655622482, mean p set: 0.4489034116268158
loss_pred:0.015098987147212029, decouple_loss:0.000738076982088387loss_pred:0.015012944117188454, decouple_loss:0.0007415144937112927
Iteration: 892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486784040927887, gen p mean: -0.1102936714887619, mean p set: 0.44925642013549805
loss_pred:0.0154840974137187, decouple_loss:0.0009245143155567348
The modified gen p mean: 0.447773814201355, gen p mean: -0.10992321372032166, mean p set: 0.44834965467453003The modified gen p mean: 0.44987016916275024, gen p mean: -0.11541656404733658, mean p set: 0.4504498541355133
loss_pred:0.015615533106029034, decouple_loss:0.001219423720613122loss_pred:0.014691225253045559, decouple_loss:0.0008154178503900766
Iteration: 893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449349969625473, gen p mean: -0.11299450695514679, mean p set: 0.4499247372150421
loss_pred:0.014250107109546661, decouple_loss:0.0007443770300596952
The modified gen p mean: 0.4472416937351227, gen p mean: -0.10895505547523499, mean p set: 0.4478180706501007
loss_pred:0.015847589820623398, decouple_loss:0.0011538073886185884
The modified gen p mean: 0.4479104280471802, gen p mean: -0.10987184196710587, mean p set: 0.4484882652759552
loss_pred:0.01462319865822792, decouple_loss:0.0007324679754674435
Iteration: 894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44913408160209656, gen p mean: -0.1031188815832138, mean p set: 0.44971105456352234
loss_pred:0.014818075112998486, decouple_loss:0.0007084091193974018
The modified gen p mean: 0.44840139150619507, gen p mean: -0.10963020473718643, mean p set: 0.44897738099098206
loss_pred:0.01432271208614111, decouple_loss:0.0006346674053929746
The modified gen p mean: 0.44826194643974304, gen p mean: -0.11227022856473923, mean p set: 0.44883859157562256
loss_pred:0.014371679164469242, decouple_loss:0.0006404958548955619
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
NaN value num: 0
Iteration: 895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797223806381226, gen p mean: -0.11576836556196213, mean p set: 0.4485483467578888
loss_pred:0.018169548362493515, decouple_loss:0.0011432128958404064
The modified gen p mean: 0.44803208112716675, gen p mean: -0.10519570112228394, mean p set: 0.44860756397247314
loss_pred:0.017022350803017616, decouple_loss:0.0010258452966809273
The modified gen p mean: 0.44821107387542725, gen p mean: -0.10558989644050598, mean p set: 0.44878700375556946
loss_pred:0.018194517120718956, decouple_loss:0.0009567904635332525
Iteration: 896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472130537033081, gen p mean: -0.1067880317568779, mean p set: 0.447790265083313
loss_pred:0.01752486638724804, decouple_loss:0.0010292928200215101
The modified gen p mean: 0.4482540488243103, gen p mean: -0.10948725789785385, mean p set: 0.4488303065299988
loss_pred:0.017666976898908615, decouple_loss:0.0007423500646837056
The modified gen p mean: 0.449124276638031, gen p mean: -0.10322429239749908, mean p set: 0.4497016966342926
loss_pred:0.017272792756557465, decouple_loss:0.0008080351981334388
Iteration: 897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726136326789856, gen p mean: -0.10186123102903366, mean p set: 0.4478370249271393
loss_pred:0.01758194901049137, decouple_loss:0.0007993446197360754
The modified gen p mean: 0.44714128971099854, gen p mean: -0.10098452866077423, mean p set: 0.4477182924747467
loss_pred:0.01786888763308525, decouple_loss:0.001138480962254107
The modified gen p mean: 0.4464147984981537, gen p mean: -0.09987257421016693, mean p set: 0.4469884932041168
loss_pred:0.017872009426355362, decouple_loss:0.0011292945127934217
Iteration: 898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701340794563293, gen p mean: -0.10490861535072327, mean p set: 0.44758954644203186
loss_pred:0.018462959676980972, decouple_loss:0.0012826730962842703
The modified gen p mean: 0.4475075602531433, gen p mean: -0.09959504753351212, mean p set: 0.44808417558670044
loss_pred:0.017727240920066833, decouple_loss:0.0012265831464901567
The modified gen p mean: 0.4464244842529297, gen p mean: -0.10018812119960785, mean p set: 0.44700080156326294
loss_pred:0.017771707847714424, decouple_loss:0.001139849191531539
Iteration: 899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494541585445404, gen p mean: -0.10414480417966843, mean p set: 0.4500318169593811
loss_pred:0.016834385693073273, decouple_loss:0.0008823554962873459
The modified gen p mean: 0.4479988217353821, gen p mean: -0.10275473445653915, mean p set: 0.4485757648944855
The modified gen p mean: 0.4466993510723114, gen p mean: -0.10138049721717834, mean p set: 0.4472734034061432
loss_pred:0.017174314707517624, decouple_loss:0.0008518873946741223
loss_pred:0.018449800089001656, decouple_loss:0.0011178574059158564
Iteration: 900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474411606788635, gen p mean: -0.10566388815641403, mean p set: 0.44801533222198486
loss_pred:0.01741723343729973, decouple_loss:0.0011227570939809084
The modified gen p mean: 0.44767946004867554, gen p mean: -0.10667740553617477, mean p set: 0.44825637340545654
loss_pred:0.017527345567941666, decouple_loss:0.0009726024582050741
The modified gen p mean: 0.4488961696624756, gen p mean: -0.10210976749658585, mean p set: 0.44947269558906555
loss_pred:0.017478764057159424, decouple_loss:0.0013739513233304024
2023-05-01 02:29:10 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.11414699256420135, mean p set: 0.4502691626548767
loss_pred:0.017548559233546257, decouple_loss:0.0012178127653896809
The modified gen p mean: 0.4495348036289215, gen p mean: -0.10875184834003448, mean p set: 0.4500633478164673
loss_pred:0.016856515780091286, decouple_loss:0.0009757578955031931
The modified gen p mean: 0.44978147745132446, gen p mean: -0.10800779610872269, mean p set: 0.45035696029663086
loss_pred:0.017138803377747536, decouple_loss:0.001054581836797297
WV_1_PC_1_EH_0_PS_40, loss: 0.01723542995750904, avg_mse: 0.02669111080467701
current test mse: 0.026691
Iteration: 901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474179148674011, gen p mean: -0.105775386095047, mean p set: 0.4479931592941284
loss_pred:0.01738949865102768, decouple_loss:0.0012230095453560352
The modified gen p mean: 0.4481889605522156, gen p mean: -0.1132059246301651, mean p set: 0.4487628936767578The modified gen p mean: 0.44877851009368896, gen p mean: -0.10357282310724258, mean p set: 0.44935378432273865
loss_pred:0.017787454649806023, decouple_loss:0.001442945678718388
loss_pred:0.01732047088444233, decouple_loss:0.0010273593943566084
Iteration: 902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788143038749695, gen p mean: -0.1107887551188469, mean p set: 0.44845619797706604
loss_pred:0.016545359045267105, decouple_loss:0.0008303089416585863
The modified gen p mean: 0.45028555393218994, gen p mean: -0.11071119457483292, mean p set: 0.4508633017539978
The modified gen p mean: 0.4469521641731262, gen p mean: -0.11136539280414581, mean p set: 0.4475279748439789
loss_pred:0.01651150733232498, decouple_loss:0.0009390401537530124
loss_pred:0.01811971887946129, decouple_loss:0.0008990082424134016
Iteration: 903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44666504859924316, gen p mean: -0.11371999979019165, mean p set: 0.44724079966545105
loss_pred:0.018651576712727547, decouple_loss:0.0008583746966905892
The modified gen p mean: 0.4466036260128021, gen p mean: -0.11315590143203735, mean p set: 0.4471806287765503
loss_pred:0.017450831830501556, decouple_loss:0.0009019963326863945
The modified gen p mean: 0.44747939705848694, gen p mean: -0.11371904611587524, mean p set: 0.44805729389190674
loss_pred:0.01824507862329483, decouple_loss:0.0007887388928793371
Iteration: 904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810885190963745, gen p mean: -0.11152178049087524, mean p set: 0.44868648052215576
loss_pred:0.01701374538242817, decouple_loss:0.0009373265784233809
The modified gen p mean: 0.4460402727127075, gen p mean: -0.10818471014499664, mean p set: 0.4466167390346527
loss_pred:0.01864711008965969, decouple_loss:0.0008573713130317628
The modified gen p mean: 0.4473854899406433, gen p mean: -0.11079072952270508, mean p set: 0.4479617476463318
loss_pred:0.017342546954751015, decouple_loss:0.0009284188854508102
Iteration: 905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450163334608078, gen p mean: -0.11114679276943207, mean p set: 0.4507392346858978
loss_pred:0.016766473650932312, decouple_loss:0.0009525807690806687
The modified gen p mean: 0.4484030306339264, gen p mean: -0.11119416356086731, mean p set: 0.44898083806037903
loss_pred:0.017458632588386536, decouple_loss:0.0008828003774397075
The modified gen p mean: 0.4490002989768982, gen p mean: -0.10785331577062607, mean p set: 0.449575275182724
loss_pred:0.017206082120537758, decouple_loss:0.000731390668079257
Iteration: 906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471239745616913, gen p mean: -0.11027820408344269, mean p set: 0.44770026206970215
loss_pred:0.01830177567899227, decouple_loss:0.0009067056817002594
The modified gen p mean: 0.4460684359073639, gen p mean: -0.10692182928323746, mean p set: 0.4466431736946106
loss_pred:0.017783859744668007, decouple_loss:0.00101865001488477
The modified gen p mean: 0.4482088088989258, gen p mean: -0.11268549412488937, mean p set: 0.4487842321395874
loss_pred:0.017384739592671394, decouple_loss:0.0007358517614193261
Iteration: 907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44928455352783203, gen p mean: -0.11453665792942047, mean p set: 0.44986119866371155
loss_pred:0.01860068552196026, decouple_loss:0.0007902794168330729
The modified gen p mean: 0.44815629720687866, gen p mean: -0.11251708120107651, mean p set: 0.44873231649398804
loss_pred:0.01739387772977352, decouple_loss:0.0006780727417208254
The modified gen p mean: 0.44793009757995605, gen p mean: -0.11104948818683624, mean p set: 0.4485064744949341
loss_pred:0.017290741205215454, decouple_loss:0.0007544541731476784
Iteration: 908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44663000106811523, gen p mean: -0.1125229001045227, mean p set: 0.44720733165740967
loss_pred:0.017230408266186714, decouple_loss:0.0008106817258521914
The modified gen p mean: 0.4476054906845093, gen p mean: -0.11407381296157837, mean p set: 0.4481804668903351
loss_pred:0.01677488349378109, decouple_loss:0.000770503596868366
The modified gen p mean: 0.44787055253982544, gen p mean: -0.11855465173721313, mean p set: 0.4484488368034363
loss_pred:0.017011696472764015, decouple_loss:0.0006918300059624016
Iteration: 909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481737017631531, gen p mean: -0.11924830824136734, mean p set: 0.44874924421310425
loss_pred:0.016825757920742035, decouple_loss:0.0008318909094668925
The modified gen p mean: 0.44791486859321594, gen p mean: -0.11778555810451508, mean p set: 0.44849130511283875
The modified gen p mean: 0.44880345463752747, gen p mean: -0.11762908846139908, mean p set: 0.4493786096572876
loss_pred:0.017020903527736664, decouple_loss:0.0010755214607343078
loss_pred:0.016778450459241867, decouple_loss:0.0012786813313141465
Iteration: 910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461508095264435, gen p mean: -0.11913574486970901, mean p set: 0.44672608375549316
loss_pred:0.018233591690659523, decouple_loss:0.0013688995968550444
The modified gen p mean: 0.44803011417388916, gen p mean: -0.11975505948066711, mean p set: 0.4486088454723358
loss_pred:0.017043527215719223, decouple_loss:0.001064262236468494
The modified gen p mean: 0.44755974411964417, gen p mean: -0.11972568929195404, mean p set: 0.4481366276741028
loss_pred:0.0171713475137949, decouple_loss:0.0010578137589618564
2023-05-01 02:31:17 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1283210813999176, mean p set: 0.4502691626548767
loss_pred:0.01750030368566513, decouple_loss:0.0009262181119993329
The modified gen p mean: 0.4495343863964081, gen p mean: -0.12280178815126419, mean p set: 0.4500633478164673
loss_pred:0.01693873293697834, decouple_loss:0.0010949793504551053
The modified gen p mean: 0.44978204369544983, gen p mean: -0.121859110891819, mean p set: 0.45035696029663086
loss_pred:0.01713382638990879, decouple_loss:0.0008306127274408937
WV_1_PC_1_EH_0_PS_40, loss: 0.01723848469555378, avg_mse: 0.026757197454571724
current test mse: 0.026757
Iteration: 911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480098783969879, gen p mean: -0.12292227149009705, mean p set: 0.4485867917537689
loss_pred:0.017678191885352135, decouple_loss:0.0009232131415046751
The modified gen p mean: 0.4490946829319, gen p mean: -0.12225174158811569, mean p set: 0.44967013597488403
loss_pred:0.016895536333322525, decouple_loss:0.0008412963361479342
The modified gen p mean: 0.4471316635608673, gen p mean: -0.11975808441638947, mean p set: 0.44770923256874084
loss_pred:0.017753642052412033, decouple_loss:0.0009857426630333066
Iteration: 912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457404613494873, gen p mean: -0.1198977455496788, mean p set: 0.44631341099739075The modified gen p mean: 0.44897177815437317, gen p mean: -0.12417493760585785, mean p set: 0.4495477080345154
loss_pred:0.01812826283276081, decouple_loss:0.0011982640717178583
loss_pred:0.017660552635788918, decouple_loss:0.0006814014632254839
The modified gen p mean: 0.4477653503417969, gen p mean: -0.12246425449848175, mean p set: 0.4483422338962555
loss_pred:0.01733514852821827, decouple_loss:0.000705451937392354
Iteration: 913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848668575286865, gen p mean: -0.1228751614689827, mean p set: 0.4490620791912079
loss_pred:0.018144721165299416, decouple_loss:0.0011320754420012236
The modified gen p mean: 0.44787490367889404, gen p mean: -0.1229032501578331, mean p set: 0.4484530985355377
The modified gen p mean: 0.44879499077796936, gen p mean: -0.1156250610947609, mean p set: 0.44937095046043396
loss_pred:0.017020948231220245, decouple_loss:0.0009923330508172512
loss_pred:0.01782824657857418, decouple_loss:0.0011705791112035513
Iteration: 914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475249946117401, gen p mean: -0.11999770998954773, mean p set: 0.4481014907360077
loss_pred:0.017809636890888214, decouple_loss:0.0007538702338933945
The modified gen p mean: 0.4476320147514343, gen p mean: -0.12361427396535873, mean p set: 0.44820740818977356
loss_pred:0.018121296539902687, decouple_loss:0.0009411229402758181
The modified gen p mean: 0.447963148355484, gen p mean: -0.1291505992412567, mean p set: 0.44854092597961426
loss_pred:0.017740678042173386, decouple_loss:0.0007923813536763191
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
NaN value num: 0
Iteration: 915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477105140686035, gen p mean: -0.1321893185377121, mean p set: 0.4482823610305786The modified gen p mean: 0.44781917333602905, gen p mean: -0.123477503657341, mean p set: 0.44839179515838623
loss_pred:0.01816944219172001, decouple_loss:0.0009165205992758274loss_pred:0.017037997022271156, decouple_loss:0.0008977958932518959
The modified gen p mean: 0.44620174169540405, gen p mean: -0.12255790084600449, mean p set: 0.44677734375
loss_pred:0.017218874767422676, decouple_loss:0.0006787943420931697
Iteration: 916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44857463240623474, gen p mean: -0.12720340490341187, mean p set: 0.44915181398391724
loss_pred:0.017175273969769478, decouple_loss:0.0007009385735727847
The modified gen p mean: 0.4458594024181366, gen p mean: -0.13103753328323364, mean p set: 0.4464368224143982
loss_pred:0.01809890940785408, decouple_loss:0.0009758228552527726
The modified gen p mean: 0.44833850860595703, gen p mean: -0.12588588893413544, mean p set: 0.448914498090744
loss_pred:0.016731584444642067, decouple_loss:0.0007967331912368536
Iteration: 917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686058163642883, gen p mean: -0.12273591011762619, mean p set: 0.44743436574935913
loss_pred:0.016749771311879158, decouple_loss:0.0011227185605093837
The modified gen p mean: 0.4465436637401581, gen p mean: -0.12762314081192017, mean p set: 0.44712120294570923
loss_pred:0.018035681918263435, decouple_loss:0.0012214978924021125
The modified gen p mean: 0.447913259267807, gen p mean: -0.11991723626852036, mean p set: 0.44848719239234924
loss_pred:0.016822591423988342, decouple_loss:0.0011196733685210347
Iteration: 918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463268518447876, gen p mean: -0.12174004316329956, mean p set: 0.44690072536468506
loss_pred:0.016746656969189644, decouple_loss:0.0008560908609069884
The modified gen p mean: 0.4472814202308655, gen p mean: -0.1318419873714447, mean p set: 0.4478553533554077
loss_pred:0.018327750265598297, decouple_loss:0.001288241008296609
The modified gen p mean: 0.44627898931503296, gen p mean: -0.13036054372787476, mean p set: 0.446853369474411
loss_pred:0.017962193116545677, decouple_loss:0.0010848722886294127
Iteration: 919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44552141427993774, gen p mean: -0.1242508515715599, mean p set: 0.446098268032074
loss_pred:0.017796188592910767, decouple_loss:0.0011333373840898275
The modified gen p mean: 0.44647249579429626, gen p mean: -0.1220003142952919, mean p set: 0.44704926013946533
The modified gen p mean: 0.44692155718803406, gen p mean: -0.12470796704292297, mean p set: 0.4474962055683136
loss_pred:0.01809082366526127, decouple_loss:0.0008379979990422726
loss_pred:0.017960472032427788, decouple_loss:0.0011366058606654406
Iteration: 920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44555187225341797, gen p mean: -0.12223280221223831, mean p set: 0.4461243748664856
loss_pred:0.016811620444059372, decouple_loss:0.0011133648222312331
The modified gen p mean: 0.44638997316360474, gen p mean: -0.11683055013418198, mean p set: 0.4469677805900574
The modified gen p mean: 0.4460209012031555, gen p mean: -0.12470720708370209, mean p set: 0.4465934634208679
loss_pred:0.017729608342051506, decouple_loss:0.0009989721002057195
loss_pred:0.016701307147741318, decouple_loss:0.0010367289651185274
2023-05-01 02:34:06 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1252739578485489, mean p set: 0.4502691626548767
loss_pred:0.01739474944770336, decouple_loss:0.0009139067260548472
The modified gen p mean: 0.4495364725589752, gen p mean: -0.11965935677289963, mean p set: 0.4500633478164673
loss_pred:0.016825051978230476, decouple_loss:0.0007264345767907798
The modified gen p mean: 0.4497803747653961, gen p mean: -0.11881326884031296, mean p set: 0.45035696029663086
loss_pred:0.017094047740101814, decouple_loss:0.0009075715788640082
WV_1_PC_1_EH_0_PS_40, loss: 0.017147082835435867, avg_mse: 0.026650669053196907
current test mse: 0.026651
At step 920, Best test: 0.026651
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683992862701416, gen p mean: -0.11722619831562042, mean p set: 0.4474189281463623
loss_pred:0.018003620207309723, decouple_loss:0.0008725926163606346
The modified gen p mean: 0.44660335779190063, gen p mean: -0.1191634014248848, mean p set: 0.44717922806739807
loss_pred:0.01736305095255375, decouple_loss:0.0008661120664328337
The modified gen p mean: 0.44700947403907776, gen p mean: -0.12194295227527618, mean p set: 0.4475840926170349
loss_pred:0.016883227974176407, decouple_loss:0.0008438248187303543
Iteration: 922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751274585723877, gen p mean: -0.11831634491682053, mean p set: 0.4480871260166168
loss_pred:0.017140259966254234, decouple_loss:0.0008463824633508921
The modified gen p mean: 0.4463452398777008, gen p mean: -0.11841488629579544, mean p set: 0.4469192922115326
The modified gen p mean: 0.4476076364517212, gen p mean: -0.11868778616189957, mean p set: 0.4481818377971649
loss_pred:0.018928956240415573, decouple_loss:0.001269470900297165
loss_pred:0.017594022676348686, decouple_loss:0.0009918957948684692
Iteration: 923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476279020309448, gen p mean: -0.11918700486421585, mean p set: 0.4482041299343109
loss_pred:0.016444940119981766, decouple_loss:0.0010235384106636047
The modified gen p mean: 0.447030246257782, gen p mean: -0.11575167626142502, mean p set: 0.4476066827774048The modified gen p mean: 0.4467710852622986, gen p mean: -0.12221362441778183, mean p set: 0.4473479390144348
loss_pred:0.017642101272940636, decouple_loss:0.0008516303496435285
loss_pred:0.01764337345957756, decouple_loss:0.001300733769312501
Iteration: 924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728851318359375, gen p mean: -0.12221211194992065, mean p set: 0.4478640854358673
loss_pred:0.01804984174668789, decouple_loss:0.0007189188618212938
The modified gen p mean: 0.44724225997924805, gen p mean: -0.12096547335386276, mean p set: 0.4478198289871216
loss_pred:0.016943268477916718, decouple_loss:0.000753031752537936
The modified gen p mean: 0.447863906621933, gen p mean: -0.11949316412210464, mean p set: 0.4484359920024872
loss_pred:0.01693684607744217, decouple_loss:0.0010219502728432417
Iteration: 925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472127854824066, gen p mean: -0.11862438172101974, mean p set: 0.4477900266647339
loss_pred:0.01723410002887249, decouple_loss:0.0010575801134109497
The modified gen p mean: 0.4467000961303711, gen p mean: -0.12292813509702682, mean p set: 0.44727540016174316
loss_pred:0.01690015196800232, decouple_loss:0.0009670021245256066
The modified gen p mean: 0.4478452205657959, gen p mean: -0.12233328819274902, mean p set: 0.44842231273651123
loss_pred:0.0174041036516428, decouple_loss:0.0009127155062742531
Iteration: 926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466463327407837, gen p mean: -0.12165923416614532, mean p set: 0.44722142815589905
loss_pred:0.018282340839505196, decouple_loss:0.0011982915457338095
The modified gen p mean: 0.4480593800544739, gen p mean: -0.12697084248065948, mean p set: 0.44863349199295044
loss_pred:0.017191892489790916, decouple_loss:0.0010248125763610005
The modified gen p mean: 0.4473186135292053, gen p mean: -0.1248241737484932, mean p set: 0.44789573550224304
loss_pred:0.017129020765423775, decouple_loss:0.0009117127046920359
Iteration: 927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477042555809021, gen p mean: -0.12141871452331543, mean p set: 0.44828227162361145
loss_pred:0.018310250714421272, decouple_loss:0.0009719633380882442
The modified gen p mean: 0.4468807578086853, gen p mean: -0.12153076380491257, mean p set: 0.4474555552005768
loss_pred:0.018261974677443504, decouple_loss:0.0008803120581433177
The modified gen p mean: 0.4467769265174866, gen p mean: -0.12183921784162521, mean p set: 0.44735562801361084
loss_pred:0.01683787629008293, decouple_loss:0.0008448937442153692
Iteration: 928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817131757736206, gen p mean: -0.12650206685066223, mean p set: 0.44874683022499084
loss_pred:0.016867028549313545, decouple_loss:0.0008974391384981573
The modified gen p mean: 0.44800007343292236, gen p mean: -0.12298497557640076, mean p set: 0.44857561588287354
loss_pred:0.01671546697616577, decouple_loss:0.0008031064062379301
The modified gen p mean: 0.4466377794742584, gen p mean: -0.1276031881570816, mean p set: 0.44721341133117676
loss_pred:0.016825972124934196, decouple_loss:0.0009972157422453165
Iteration: 929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475177824497223, gen p mean: -0.12787239253520966, mean p set: 0.4480923116207123
loss_pred:0.01723942719399929, decouple_loss:0.0009676964255049825
The modified gen p mean: 0.44636639952659607, gen p mean: -0.13338282704353333, mean p set: 0.4469445049762726
loss_pred:0.017769917845726013, decouple_loss:0.0011551398783922195
The modified gen p mean: 0.4459872245788574, gen p mean: -0.1306459754705429, mean p set: 0.4465617835521698
loss_pred:0.0168123971670866, decouple_loss:0.000978046446107328
Iteration: 930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716396927833557, gen p mean: -0.1238521859049797, mean p set: 0.4477398097515106
loss_pred:0.01764727011322975, decouple_loss:0.0007717440603300929
The modified gen p mean: 0.4468984603881836, gen p mean: -0.13134853541851044, mean p set: 0.44747358560562134
loss_pred:0.01786443591117859, decouple_loss:0.0008507036254741251
The modified gen p mean: 0.44791749119758606, gen p mean: -0.1249162033200264, mean p set: 0.44849371910095215
loss_pred:0.016821980476379395, decouple_loss:0.0008360571810044348
2023-05-01 02:36:18 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12881764769554138, mean p set: 0.4502691626548767
loss_pred:0.01743597723543644, decouple_loss:0.0008957670070230961
The modified gen p mean: 0.4495342969894409, gen p mean: -0.12371746450662613, mean p set: 0.4500633478164673
loss_pred:0.01678619161248207, decouple_loss:0.00079261080827564
The modified gen p mean: 0.44977816939353943, gen p mean: -0.12259378284215927, mean p set: 0.45035696029663086
loss_pred:0.017088305205106735, decouple_loss:0.0007910642889328301
WV_1_PC_1_EH_0_PS_40, loss: 0.017144815996289253, avg_mse: 0.026637589558959007
current test mse: 0.026638
At step 930, Best test: 0.026638
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463626742362976, gen p mean: -0.12296854704618454, mean p set: 0.4469434916973114
loss_pred:0.017676446586847305, decouple_loss:0.0008972209179773927
The modified gen p mean: 0.4469434320926666, gen p mean: -0.12754793465137482, mean p set: 0.4475182592868805
loss_pred:0.01855750009417534, decouple_loss:0.0010637707309797406
The modified gen p mean: 0.44777265191078186, gen p mean: -0.12588754296302795, mean p set: 0.4483503997325897
loss_pred:0.01702226884663105, decouple_loss:0.0008893824415281415
Iteration: 932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471912086009979, gen p mean: -0.1244368627667427, mean p set: 0.44776445627212524
loss_pred:0.018012501299381256, decouple_loss:0.0007012169808149338
The modified gen p mean: 0.44609519839286804, gen p mean: -0.12256117910146713, mean p set: 0.4466714859008789The modified gen p mean: 0.4460018575191498, gen p mean: -0.12026646733283997, mean p set: 0.4465792179107666
loss_pred:0.017113812267780304, decouple_loss:0.0007650339975953102
loss_pred:0.017482131719589233, decouple_loss:0.0011768403928726912
Iteration: 933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775390625, gen p mean: -0.12242791801691055, mean p set: 0.4483303725719452
loss_pred:0.017036763951182365, decouple_loss:0.0008094079094007611
The modified gen p mean: 0.4468887746334076, gen p mean: -0.13278163969516754, mean p set: 0.44746658205986023The modified gen p mean: 0.4471672773361206, gen p mean: -0.11780543625354767, mean p set: 0.44774138927459717
loss_pred:0.017918448895215988, decouple_loss:0.0011615200201049447
loss_pred:0.0181183610111475, decouple_loss:0.0008775187307037413
Iteration: 934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477178752422333, gen p mean: -0.12477805465459824, mean p set: 0.44829463958740234
loss_pred:0.017786048352718353, decouple_loss:0.0009002081351354718
The modified gen p mean: 0.44761329889297485, gen p mean: -0.1221066489815712, mean p set: 0.44818708300590515
loss_pred:0.01718902215361595, decouple_loss:0.0008463618578389287
The modified gen p mean: 0.4453928768634796, gen p mean: -0.12606841325759888, mean p set: 0.4459685981273651
loss_pred:0.01759735681116581, decouple_loss:0.0007467211107723415
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
NaN value num: 0
Iteration: 935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732049107551575, gen p mean: -0.12148706614971161, mean p set: 0.44789931178092957
loss_pred:0.017315572127699852, decouple_loss:0.0010147136636078358
The modified gen p mean: 0.4481762647628784, gen p mean: -0.11861463636159897, mean p set: 0.44875475764274597
loss_pred:0.016966328024864197, decouple_loss:0.000825609837193042
The modified gen p mean: 0.4484883248806, gen p mean: -0.1269960105419159, mean p set: 0.449065238237381
loss_pred:0.018357962369918823, decouple_loss:0.0010690445778891444
Iteration: 936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465161859989166, gen p mean: -0.11580811440944672, mean p set: 0.4470905661582947
loss_pred:0.017772819846868515, decouple_loss:0.0010577752254903316
The modified gen p mean: 0.4479124844074249, gen p mean: -0.11576014757156372, mean p set: 0.44848722219467163
The modified gen p mean: 0.44677257537841797, gen p mean: -0.11328854411840439, mean p set: 0.4473509192466736
loss_pred:0.01685783453285694, decouple_loss:0.0007282918668352067
loss_pred:0.017888570204377174, decouple_loss:0.0009523946791887283
Iteration: 937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466732442378998, gen p mean: -0.11572922766208649, mean p set: 0.44724392890930176
loss_pred:0.017911020666360855, decouple_loss:0.0006562276976183057
The modified gen p mean: 0.44631052017211914, gen p mean: -0.10945749282836914, mean p set: 0.44688549637794495
The modified gen p mean: 0.4465467631816864, gen p mean: -0.11239965260028839, mean p set: 0.44712138175964355
loss_pred:0.019503947347402573, decouple_loss:0.0007750357035547495
loss_pred:0.018113689497113228, decouple_loss:0.0008648603688925505
Iteration: 938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818034768104553, gen p mean: -0.1081899106502533, mean p set: 0.44875606894493103
loss_pred:0.01736861653625965, decouple_loss:0.0010288641788065434
The modified gen p mean: 0.4472272992134094, gen p mean: -0.11131591349840164, mean p set: 0.44780290126800537
loss_pred:0.017810627818107605, decouple_loss:0.0008679900784045458
The modified gen p mean: 0.4469965398311615, gen p mean: -0.11272209137678146, mean p set: 0.4475730061531067
loss_pred:0.017500514164566994, decouple_loss:0.0009341637487523258
Iteration: 939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457089602947235, gen p mean: -0.10887481272220612, mean p set: 0.44628363847732544
loss_pred:0.017508478835225105, decouple_loss:0.0007703383453190327
The modified gen p mean: 0.44776859879493713, gen p mean: -0.11037055402994156, mean p set: 0.44834578037261963
The modified gen p mean: 0.4480450749397278, gen p mean: -0.11042796820402145, mean p set: 0.4486234486103058
loss_pred:0.016753561794757843, decouple_loss:0.0009849646594375372
loss_pred:0.01749260351061821, decouple_loss:0.0008300480549223721
Iteration: 940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44640424847602844, gen p mean: -0.10954397916793823, mean p set: 0.44698062539100647
loss_pred:0.018368162214756012, decouple_loss:0.0007227843743748963
The modified gen p mean: 0.4462038278579712, gen p mean: -0.11125818639993668, mean p set: 0.4467800557613373
The modified gen p mean: 0.44831258058547974, gen p mean: -0.11568518728017807, mean p set: 0.4488883912563324
loss_pred:0.018580613657832146, decouple_loss:0.0007716148975305259
loss_pred:0.018142368644475937, decouple_loss:0.000770139682572335
2023-05-01 02:39:17 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1229809895157814, mean p set: 0.4502691626548767
loss_pred:0.0175333209335804, decouple_loss:0.0008637461578473449
The modified gen p mean: 0.4495362937450409, gen p mean: -0.11751703172922134, mean p set: 0.4500633478164673
loss_pred:0.016875727102160454, decouple_loss:0.0010573165491223335
The modified gen p mean: 0.4497816562652588, gen p mean: -0.11619624495506287, mean p set: 0.45035696029663086
loss_pred:0.01712898723781109, decouple_loss:0.0009048130596056581
WV_1_PC_1_EH_0_PS_40, loss: 0.017226442694664, avg_mse: 0.02675558067858219
current test mse: 0.026756
Iteration: 941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716131687164307, gen p mean: -0.11758428812026978, mean p set: 0.4477372169494629
loss_pred:0.017770716920495033, decouple_loss:0.000991119653917849
The modified gen p mean: 0.4464177191257477, gen p mean: -0.11533757299184799, mean p set: 0.4469945430755615The modified gen p mean: 0.446993350982666, gen p mean: -0.11628277599811554, mean p set: 0.44756776094436646
loss_pred:0.017539918422698975, decouple_loss:0.0009766441071406007
loss_pred:0.017813581973314285, decouple_loss:0.0011317096650600433
Iteration: 942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795411825180054, gen p mean: -0.11714453995227814, mean p set: 0.4485313296318054
loss_pred:0.017398212105035782, decouple_loss:0.0006211824947968125
The modified gen p mean: 0.4471738934516907, gen p mean: -0.12776966392993927, mean p set: 0.447747141122818The modified gen p mean: 0.4468124210834503, gen p mean: -0.11924029886722565, mean p set: 0.4473875164985657
loss_pred:0.017758211120963097, decouple_loss:0.0007719681016169488
loss_pred:0.01874581165611744, decouple_loss:0.00076135597191751
Iteration: 943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682732224464417, gen p mean: -0.12331654876470566, mean p set: 0.44740378856658936
loss_pred:0.0175212062895298, decouple_loss:0.0008411665330640972
The modified gen p mean: 0.44853606820106506, gen p mean: -0.12618522346019745, mean p set: 0.4491124749183655
loss_pred:0.01744173653423786, decouple_loss:0.000811184523627162
The modified gen p mean: 0.4473108947277069, gen p mean: -0.12031962722539902, mean p set: 0.4478892683982849
loss_pred:0.01744786836206913, decouple_loss:0.0007444596267305315
Iteration: 944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001092553138733, gen p mean: -0.12565474212169647, mean p set: 0.45058512687683105
loss_pred:0.017159242182970047, decouple_loss:0.0009522137115709484
The modified gen p mean: 0.4464104473590851, gen p mean: -0.1268940567970276, mean p set: 0.4469883143901825
loss_pred:0.0172585379332304, decouple_loss:0.0008268515230156481
The modified gen p mean: 0.44786879420280457, gen p mean: -0.12307240068912506, mean p set: 0.44844627380371094
loss_pred:0.01719791069626808, decouple_loss:0.0006335433572530746
Iteration: 945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448336124420166, gen p mean: -0.12928757071495056, mean p set: 0.44890812039375305
loss_pred:0.016575220972299576, decouple_loss:0.000850431271828711
The modified gen p mean: 0.4487525522708893, gen p mean: -0.13345636427402496, mean p set: 0.4493309259414673
loss_pred:0.017828086391091347, decouple_loss:0.0009209924028255045
The modified gen p mean: 0.44908004999160767, gen p mean: -0.13140690326690674, mean p set: 0.4496566355228424
loss_pred:0.01778257265686989, decouple_loss:0.000693455571308732
Iteration: 946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44646894931793213, gen p mean: -0.1307949423789978, mean p set: 0.44704464077949524
loss_pred:0.01692742295563221, decouple_loss:0.0006521197501569986
The modified gen p mean: 0.44747260212898254, gen p mean: -0.12994378805160522, mean p set: 0.4480498135089874
loss_pred:0.017740072682499886, decouple_loss:0.0009431971120648086
The modified gen p mean: 0.4469890296459198, gen p mean: -0.134208083152771, mean p set: 0.44756510853767395
loss_pred:0.016952643170952797, decouple_loss:0.0006943222833797336
Iteration: 947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476983845233917, gen p mean: -0.12880782783031464, mean p set: 0.44827520847320557
loss_pred:0.01791604794561863, decouple_loss:0.0008352193981409073
The modified gen p mean: 0.44847366213798523, gen p mean: -0.12878374755382538, mean p set: 0.44905006885528564
loss_pred:0.01719401404261589, decouple_loss:0.0007921329233795404
The modified gen p mean: 0.4493789076805115, gen p mean: -0.13146723806858063, mean p set: 0.449957937002182
loss_pred:0.016552377492189407, decouple_loss:0.0007343613542616367
Iteration: 948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678953289985657, gen p mean: -0.1268261969089508, mean p set: 0.44736701250076294
loss_pred:0.017885567620396614, decouple_loss:0.0007901472272351384
The modified gen p mean: 0.44747522473335266, gen p mean: -0.12829403579235077, mean p set: 0.4480472505092621
loss_pred:0.017077255994081497, decouple_loss:0.0009903364116325974
The modified gen p mean: 0.44663098454475403, gen p mean: -0.12575002014636993, mean p set: 0.44720491766929626
loss_pred:0.018236219882965088, decouple_loss:0.000806219526566565
Iteration: 949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475725293159485, gen p mean: -0.12115936726331711, mean p set: 0.4481465220451355
loss_pred:0.016999302431941032, decouple_loss:0.0009426424512639642
The modified gen p mean: 0.447470098733902, gen p mean: -0.12325955182313919, mean p set: 0.4480447769165039
loss_pred:0.01709512062370777, decouple_loss:0.0008131073554977775
The modified gen p mean: 0.44732582569122314, gen p mean: -0.12392784655094147, mean p set: 0.4478999078273773
loss_pred:0.018349001184105873, decouple_loss:0.0007400528411380947
Iteration: 950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668877124786377, gen p mean: -0.12016541510820389, mean p set: 0.44726279377937317
loss_pred:0.018537987023591995, decouple_loss:0.0008550533093512058
The modified gen p mean: 0.44600367546081543, gen p mean: -0.11957857757806778, mean p set: 0.446577250957489
loss_pred:0.017359044402837753, decouple_loss:0.0009473246755078435
The modified gen p mean: 0.4467718303203583, gen p mean: -0.12046521157026291, mean p set: 0.44734886288642883
loss_pred:0.017567122355103493, decouple_loss:0.0009342590346932411
2023-05-01 02:41:22 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12848559021949768, mean p set: 0.4502691626548767
loss_pred:0.017439264804124832, decouple_loss:0.0008106563473120332
The modified gen p mean: 0.449535608291626, gen p mean: -0.12287567555904388, mean p set: 0.4500633478164673
loss_pred:0.016836965456604958, decouple_loss:0.0008400254882872105
The modified gen p mean: 0.44977790117263794, gen p mean: -0.12223755568265915, mean p set: 0.45035696029663086
loss_pred:0.017148908227682114, decouple_loss:0.00079467857722193
WV_1_PC_1_EH_0_PS_40, loss: 0.017182469367980957, avg_mse: 0.026769958436489105
current test mse: 0.02677
Iteration: 951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469306766986847, gen p mean: -0.12187667191028595, mean p set: 0.4475059509277344
loss_pred:0.01824338175356388, decouple_loss:0.0006726456922478974
The modified gen p mean: 0.4491095542907715, gen p mean: -0.12400294840335846, mean p set: 0.4496842920780182The modified gen p mean: 0.4456224739551544, gen p mean: -0.11826202273368835, mean p set: 0.4461957514286041
loss_pred:0.016904715448617935, decouple_loss:0.0008154688985086977loss_pred:0.016825079917907715, decouple_loss:0.0008356129401363432
Iteration: 952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766175746917725, gen p mean: -0.12639302015304565, mean p set: 0.4482364058494568
The modified gen p mean: 0.44820332527160645, gen p mean: -0.12417665123939514, mean p set: 0.4487774670124054
loss_pred:0.01788077875971794, decouple_loss:0.000703192432411015
loss_pred:0.016486981883645058, decouple_loss:0.0007119459914974868
The modified gen p mean: 0.44753047823905945, gen p mean: -0.1227279007434845, mean p set: 0.44810381531715393
loss_pred:0.017499085515737534, decouple_loss:0.0007172180921770632
Iteration: 953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643452763557434, gen p mean: -0.1276252269744873, mean p set: 0.44700849056243896
loss_pred:0.017784304916858673, decouple_loss:0.0008738861652091146
The modified gen p mean: 0.4475950002670288, gen p mean: -0.12649956345558167, mean p set: 0.44817039370536804The modified gen p mean: 0.44703900814056396, gen p mean: -0.1266615241765976, mean p set: 0.4476177394390106
loss_pred:0.01672728732228279, decouple_loss:0.000827143550850451
loss_pred:0.017379125580191612, decouple_loss:0.0008943074499256909
Iteration: 954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480248689651489, gen p mean: -0.13620348274707794, mean p set: 0.4485994875431061
loss_pred:0.017717640846967697, decouple_loss:0.0010957682970911264
The modified gen p mean: 0.44708552956581116, gen p mean: -0.12362856417894363, mean p set: 0.4476620852947235
loss_pred:0.017218511551618576, decouple_loss:0.0007114058244042099
The modified gen p mean: 0.4472663700580597, gen p mean: -0.12628504633903503, mean p set: 0.4478435218334198
loss_pred:0.017729518935084343, decouple_loss:0.0007234218064695597
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
NaN value num: 0
Iteration: 955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515470266342163, gen p mean: -0.13163726031780243, mean p set: 0.4521230459213257
loss_pred:0.01566949114203453, decouple_loss:0.0013449299149215221
The modified gen p mean: 0.44986727833747864, gen p mean: -0.12779560685157776, mean p set: 0.45044276118278503
loss_pred:0.016149012371897697, decouple_loss:0.0007161630783230066
The modified gen p mean: 0.45080357789993286, gen p mean: -0.13409700989723206, mean p set: 0.45137983560562134
loss_pred:0.015828344970941544, decouple_loss:0.0012860412243753672
Iteration: 956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501035511493683, gen p mean: -0.12300831824541092, mean p set: 0.4506807327270508
loss_pred:0.015890752896666527, decouple_loss:0.0007428567623719573
The modified gen p mean: 0.4510003924369812, gen p mean: -0.1285821497440338, mean p set: 0.45157620310783386
loss_pred:0.016337240114808083, decouple_loss:0.0007340799202211201
The modified gen p mean: 0.44824355840682983, gen p mean: -0.12384693324565887, mean p set: 0.44882118701934814
loss_pred:0.016298342496156693, decouple_loss:0.0009512975229881704
Iteration: 957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493923485279083, gen p mean: -0.12337124347686768, mean p set: 0.449969619512558
loss_pred:0.01640191674232483, decouple_loss:0.0006709485314786434
The modified gen p mean: 0.45084312558174133, gen p mean: -0.1271073967218399, mean p set: 0.4514223337173462
loss_pred:0.016589004546403885, decouple_loss:0.000872268108651042
The modified gen p mean: 0.4503651261329651, gen p mean: -0.1278200000524521, mean p set: 0.4509415924549103
loss_pred:0.015947671607136726, decouple_loss:0.0007975943735800683
Iteration: 958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519241154193878, gen p mean: -0.12717954814434052, mean p set: 0.45250096917152405
loss_pred:0.016143055632710457, decouple_loss:0.0009292974136769772
The modified gen p mean: 0.45006099343299866, gen p mean: -0.11596294492483139, mean p set: 0.4506383240222931
loss_pred:0.015869488939642906, decouple_loss:0.0008302606293000281
The modified gen p mean: 0.44995370507240295, gen p mean: -0.11767250299453735, mean p set: 0.4505334198474884
loss_pred:0.01598157174885273, decouple_loss:0.000831694167573005
Iteration: 959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482647180557251, gen p mean: -0.11183485388755798, mean p set: 0.44883993268013
loss_pred:0.015351159498095512, decouple_loss:0.0008255593129433692
The modified gen p mean: 0.44823282957077026, gen p mean: -0.11518649756908417, mean p set: 0.44880905747413635
loss_pred:0.015840057283639908, decouple_loss:0.0009690635488368571
The modified gen p mean: 0.4479999840259552, gen p mean: -0.11690185964107513, mean p set: 0.4485791027545929
loss_pred:0.015835879370570183, decouple_loss:0.000835410610307008
Iteration: 960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45028525590896606, gen p mean: -0.11069642752408981, mean p set: 0.45085906982421875
loss_pred:0.015622221864759922, decouple_loss:0.0008634081459604204
The modified gen p mean: 0.4506205916404724, gen p mean: -0.11924978345632553, mean p set: 0.4511985182762146
loss_pred:0.016096914187073708, decouple_loss:0.0010087244445458055
The modified gen p mean: 0.4505053460597992, gen p mean: -0.10997574031352997, mean p set: 0.45108291506767273
loss_pred:0.015810955315828323, decouple_loss:0.0008616375853307545
2023-05-01 02:44:11 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11873023957014084, mean p set: 0.4502691626548767
loss_pred:0.01762770675122738, decouple_loss:0.0011573715601116419
The modified gen p mean: 0.44953638315200806, gen p mean: -0.11298388242721558, mean p set: 0.4500633478164673
loss_pred:0.017006639391183853, decouple_loss:0.001109192380681634
The modified gen p mean: 0.4497813880443573, gen p mean: -0.11190760135650635, mean p set: 0.45035696029663086
loss_pred:0.01719246618449688, decouple_loss:0.0009798973333090544
WV_1_PC_1_EH_0_PS_40, loss: 0.017329713329672813, avg_mse: 0.026956763118505478
current test mse: 0.026957
Iteration: 961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496884047985077, gen p mean: -0.10859967768192291, mean p set: 0.45026326179504395
loss_pred:0.015947209671139717, decouple_loss:0.0010939991334453225
The modified gen p mean: 0.45131009817123413, gen p mean: -0.1122254803776741, mean p set: 0.45188701152801514The modified gen p mean: 0.4496973752975464, gen p mean: -0.1091812252998352, mean p set: 0.45027294754981995
loss_pred:0.01638096198439598, decouple_loss:0.001150658237747848loss_pred:0.015050274319946766, decouple_loss:0.0007176493527367711
Iteration: 962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475509822368622, gen p mean: -0.1099962443113327, mean p set: 0.44812753796577454
loss_pred:0.016328539699316025, decouple_loss:0.000834790465887636
The modified gen p mean: 0.448994517326355, gen p mean: -0.11085028946399689, mean p set: 0.44957149028778076The modified gen p mean: 0.4485012888908386, gen p mean: -0.11455346643924713, mean p set: 0.44907721877098083
loss_pred:0.016528835520148277, decouple_loss:0.000684987404383719loss_pred:0.016064515337347984, decouple_loss:0.0008462106925435364
Iteration: 963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484297037124634, gen p mean: -0.1110338345170021, mean p set: 0.44900739192962646
loss_pred:0.01620241068303585, decouple_loss:0.0007985649281181395
The modified gen p mean: 0.45144838094711304, gen p mean: -0.11563930660486221, mean p set: 0.4520282447338104The modified gen p mean: 0.4477062225341797, gen p mean: -0.1149117723107338, mean p set: 0.4482796788215637
loss_pred:0.01571282371878624, decouple_loss:0.0006507951766252518
loss_pred:0.015497175976634026, decouple_loss:0.0006987268570810556
Iteration: 964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505959153175354, gen p mean: -0.12357491254806519, mean p set: 0.4511696398258209
loss_pred:0.016295157372951508, decouple_loss:0.0009347032173536718
The modified gen p mean: 0.45076489448547363, gen p mean: -0.1220208927989006, mean p set: 0.4513396918773651
loss_pred:0.015294985845685005, decouple_loss:0.0007212970522232354
The modified gen p mean: 0.45002079010009766, gen p mean: -0.11472618579864502, mean p set: 0.45059797167778015
loss_pred:0.01584988459944725, decouple_loss:0.0007255395757965744
Iteration: 965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512968361377716, gen p mean: -0.12371654063463211, mean p set: 0.45187318325042725
loss_pred:0.01590963825583458, decouple_loss:0.0008525892626494169
The modified gen p mean: 0.4496467709541321, gen p mean: -0.12055663764476776, mean p set: 0.4502235949039459
loss_pred:0.015938974916934967, decouple_loss:0.0008308576652780175
The modified gen p mean: 0.4515927731990814, gen p mean: -0.12652423977851868, mean p set: 0.4521687626838684
loss_pred:0.01615818217396736, decouple_loss:0.0008072857744991779
Iteration: 966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968780875205994, gen p mean: -0.12475766241550446, mean p set: 0.4502636790275574
loss_pred:0.015369397588074207, decouple_loss:0.0007417431334033608
The modified gen p mean: 0.4498206675052643, gen p mean: -0.12419047951698303, mean p set: 0.450398713350296
loss_pred:0.01552146952599287, decouple_loss:0.0007956510526128113
The modified gen p mean: 0.4491273760795593, gen p mean: -0.12776543200016022, mean p set: 0.4497029781341553
loss_pred:0.015561387874186039, decouple_loss:0.0007035277085378766
Iteration: 967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479092061519623, gen p mean: -0.1285739243030548, mean p set: 0.44848257303237915
loss_pred:0.01551224198192358, decouple_loss:0.0007277181721292436
The modified gen p mean: 0.4481891989707947, gen p mean: -0.12301722913980484, mean p set: 0.4487653374671936
The modified gen p mean: 0.45036160945892334, gen p mean: -0.12490226328372955, mean p set: 0.45093685388565063
loss_pred:0.016115957871079445, decouple_loss:0.0009966809302568436
loss_pred:0.016011467203497887, decouple_loss:0.0007416910957545042
Iteration: 968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516151249408722, gen p mean: -0.1302609145641327, mean p set: 0.4521893560886383
loss_pred:0.01582266017794609, decouple_loss:0.0009926011553034186
The modified gen p mean: 0.4505144953727722, gen p mean: -0.12659776210784912, mean p set: 0.4510902166366577
The modified gen p mean: 0.45100364089012146, gen p mean: -0.12806086242198944, mean p set: 0.4515781104564667
loss_pred:0.015323310159146786, decouple_loss:0.0009718369110487401
loss_pred:0.015958620235323906, decouple_loss:0.0008624078473076224
Iteration: 969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511241316795349, gen p mean: -0.1249518021941185, mean p set: 0.4517004191875458
loss_pred:0.015284073539078236, decouple_loss:0.0008105036104097962
The modified gen p mean: 0.4520116150379181, gen p mean: -0.1316940039396286, mean p set: 0.45258763432502747
loss_pred:0.01629490777850151, decouple_loss:0.0009904727339744568
The modified gen p mean: 0.44858449697494507, gen p mean: -0.125395730137825, mean p set: 0.4491605758666992
loss_pred:0.015655413269996643, decouple_loss:0.0008376763435080647
Iteration: 970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44865384697914124, gen p mean: -0.124846450984478, mean p set: 0.44922852516174316
loss_pred:0.015558194369077682, decouple_loss:0.0008256642613559961
The modified gen p mean: 0.4482939839363098, gen p mean: -0.1254807710647583, mean p set: 0.44887110590934753
loss_pred:0.01658705808222294, decouple_loss:0.0009194161975756288
The modified gen p mean: 0.45015859603881836, gen p mean: -0.12315687537193298, mean p set: 0.45073628425598145
loss_pred:0.015826722607016563, decouple_loss:0.0008249470265582204
2023-05-01 02:46:17 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12850545346736908, mean p set: 0.4502691626548767
loss_pred:0.017517175525426865, decouple_loss:0.0008864719420671463
The modified gen p mean: 0.44953566789627075, gen p mean: -0.12306276708841324, mean p set: 0.4500633478164673
loss_pred:0.0170725230127573, decouple_loss:0.0009490660158917308
The modified gen p mean: 0.4497841000556946, gen p mean: -0.12185252457857132, mean p set: 0.45035696029663086
loss_pred:0.017120832577347755, decouple_loss:0.0007574581541121006
WV_1_PC_1_EH_0_PS_40, loss: 0.017280060797929764, avg_mse: 0.026876108720898628
current test mse: 0.026876
Iteration: 971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509832262992859, gen p mean: -0.12169574946165085, mean p set: 0.45155924558639526
loss_pred:0.015575176104903221, decouple_loss:0.0008768895640969276
The modified gen p mean: 0.4479876160621643, gen p mean: -0.1229795590043068, mean p set: 0.44856342673301697The modified gen p mean: 0.4494369924068451, gen p mean: -0.11998432874679565, mean p set: 0.45001283288002014
loss_pred:0.015186895616352558, decouple_loss:0.0007771541713736951
loss_pred:0.015377528965473175, decouple_loss:0.0007679908303543925
Iteration: 972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45205190777778625, gen p mean: -0.11906102299690247, mean p set: 0.45262959599494934
loss_pred:0.014871235005557537, decouple_loss:0.0009181535569950938
The modified gen p mean: 0.44871750473976135, gen p mean: -0.117747962474823, mean p set: 0.44929447770118713The modified gen p mean: 0.4517759084701538, gen p mean: -0.12146345525979996, mean p set: 0.45235374569892883
loss_pred:0.01563641056418419, decouple_loss:0.0008487426675856113
loss_pred:0.01474053505808115, decouple_loss:0.001084576011635363
Iteration: 973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478389322757721, gen p mean: -0.11944308131933212, mean p set: 0.44841381907463074
loss_pred:0.015319782309234142, decouple_loss:0.0007576580974273384
The modified gen p mean: 0.4510701298713684, gen p mean: -0.11509901285171509, mean p set: 0.4516487121582031The modified gen p mean: 0.4485539197921753, gen p mean: -0.11367473751306534, mean p set: 0.4491298198699951
loss_pred:0.015720266848802567, decouple_loss:0.0007226367597468197
loss_pred:0.015483472496271133, decouple_loss:0.0008390035363845527
Iteration: 974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489034414291382, gen p mean: -0.11344141513109207, mean p set: 0.4494839310646057
The modified gen p mean: 0.451482892036438, gen p mean: -0.1142200157046318, mean p set: 0.45205825567245483
loss_pred:0.015315516851842403, decouple_loss:0.0008949186885729432
loss_pred:0.01618017628788948, decouple_loss:0.0008493784698657691
The modified gen p mean: 0.4506326913833618, gen p mean: -0.11799558997154236, mean p set: 0.4512050449848175
loss_pred:0.015679718926548958, decouple_loss:0.0008391527808271348
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822055101394653, gen p mean: -0.12018337100744247, mean p set: 0.448797345161438
loss_pred:0.016085278242826462, decouple_loss:0.0009997643064707518
The modified gen p mean: 0.44694003462791443, gen p mean: -0.11505161970853806, mean p set: 0.44751542806625366
loss_pred:0.015327627770602703, decouple_loss:0.000856300350278616
The modified gen p mean: 0.44821038842201233, gen p mean: -0.12251216173171997, mean p set: 0.4487859904766083
loss_pred:0.0159675944596529, decouple_loss:0.001057828776538372
Iteration: 976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467833340167999, gen p mean: -0.119446761906147, mean p set: 0.4473569989204407
loss_pred:0.015271177515387535, decouple_loss:0.000791554746683687
The modified gen p mean: 0.44695016741752625, gen p mean: -0.11595547944307327, mean p set: 0.44752857089042664
loss_pred:0.01559044886380434, decouple_loss:0.0009748443262651563
The modified gen p mean: 0.4474466145038605, gen p mean: -0.11775068193674088, mean p set: 0.44802284240722656
loss_pred:0.015371452085673809, decouple_loss:0.0009493134566582739
Iteration: 977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44638776779174805, gen p mean: -0.11705274134874344, mean p set: 0.4469609558582306
loss_pred:0.015102187171578407, decouple_loss:0.0010007639648392797
The modified gen p mean: 0.44718503952026367, gen p mean: -0.11785431951284409, mean p set: 0.4477604627609253
The modified gen p mean: 0.4476284086704254, gen p mean: -0.11640124022960663, mean p set: 0.44820234179496765
loss_pred:0.015990760177373886, decouple_loss:0.0008571791113354266
loss_pred:0.0161123163998127, decouple_loss:0.0007978291250765324
Iteration: 978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44624581933021545, gen p mean: -0.12138630449771881, mean p set: 0.4468221068382263
loss_pred:0.01570335403084755, decouple_loss:0.0008496391237713397
The modified gen p mean: 0.4489183723926544, gen p mean: -0.1201825812458992, mean p set: 0.4494958221912384
loss_pred:0.015496793203055859, decouple_loss:0.0012218339834362268
The modified gen p mean: 0.4467720091342926, gen p mean: -0.12427303940057755, mean p set: 0.4473494589328766
loss_pred:0.016561787575483322, decouple_loss:0.0008582743466831744
Iteration: 979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462631046772003, gen p mean: -0.12330571562051773, mean p set: 0.4468388855457306
loss_pred:0.015765396878123283, decouple_loss:0.0010521295480430126
The modified gen p mean: 0.4483998417854309, gen p mean: -0.12489117681980133, mean p set: 0.44897395372390747
loss_pred:0.01565801352262497, decouple_loss:0.0011404360411688685
The modified gen p mean: 0.4495122730731964, gen p mean: -0.12029971927404404, mean p set: 0.4500883221626282
loss_pred:0.014998804777860641, decouple_loss:0.0008795039029791951
Iteration: 980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683265686035156, gen p mean: -0.12408289313316345, mean p set: 0.4474082589149475
loss_pred:0.016692444682121277, decouple_loss:0.0010488202096894383
The modified gen p mean: 0.44792184233665466, gen p mean: -0.12548406422138214, mean p set: 0.4484971761703491
The modified gen p mean: 0.44637009501457214, gen p mean: -0.12526839971542358, mean p set: 0.4469473958015442
loss_pred:0.014848403632640839, decouple_loss:0.0012657492188736796
loss_pred:0.0157554280012846, decouple_loss:0.0010121747618541121
2023-05-01 02:49:26 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1256224513053894, mean p set: 0.4502691626548767
loss_pred:0.017413536086678505, decouple_loss:0.0007948726415634155
The modified gen p mean: 0.4495353400707245, gen p mean: -0.12058320641517639, mean p set: 0.4500633478164673
loss_pred:0.016953984275460243, decouple_loss:0.0008539205882698298
The modified gen p mean: 0.4497811198234558, gen p mean: -0.11923576891422272, mean p set: 0.45035696029663086
loss_pred:0.017204774543642998, decouple_loss:0.0008883006521500647
WV_1_PC_1_EH_0_PS_40, loss: 0.017233049497008324, avg_mse: 0.026773938909173012
current test mse: 0.026774
Iteration: 981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485211968421936, gen p mean: -0.11906673014163971, mean p set: 0.449098140001297
The modified gen p mean: 0.44658222794532776, gen p mean: -0.12010609358549118, mean p set: 0.4471592903137207
loss_pred:0.015801746398210526, decouple_loss:0.0008514806977473199
loss_pred:0.015466369688510895, decouple_loss:0.0008636098355054855
The modified gen p mean: 0.4473869502544403, gen p mean: -0.11736775934696198, mean p set: 0.4479648470878601
loss_pred:0.015606502071022987, decouple_loss:0.0008586858748458326
Iteration: 982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815143942832947, gen p mean: -0.12214389443397522, mean p set: 0.4487267732620239
loss_pred:0.015577376820147038, decouple_loss:0.0008862058166414499
The modified gen p mean: 0.44670504331588745, gen p mean: -0.11990447342395782, mean p set: 0.44728177785873413The modified gen p mean: 0.4472559690475464, gen p mean: -0.11380799859762192, mean p set: 0.4478318989276886
loss_pred:0.016235925257205963, decouple_loss:0.000909532536752522loss_pred:0.016144299879670143, decouple_loss:0.0008955315570347011
Iteration: 983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767051935195923, gen p mean: -0.11991790682077408, mean p set: 0.4482457637786865
The modified gen p mean: 0.4468535780906677, gen p mean: -0.11315146833658218, mean p set: 0.4474294185638428loss_pred:0.015183210372924805, decouple_loss:0.0009109628153964877
loss_pred:0.014747611247003078, decouple_loss:0.0007535874610766768
The modified gen p mean: 0.44676223397254944, gen p mean: -0.11376679688692093, mean p set: 0.44733917713165283
loss_pred:0.015440493822097778, decouple_loss:0.0009102849871851504
Iteration: 984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447063684463501, gen p mean: -0.1093742623925209, mean p set: 0.4476413428783417
loss_pred:0.01527968980371952, decouple_loss:0.0007794798584654927
The modified gen p mean: 0.4478833079338074, gen p mean: -0.1139230877161026, mean p set: 0.44846174120903015
loss_pred:0.015471831895411015, decouple_loss:0.0008158080163411796
The modified gen p mean: 0.4467894434928894, gen p mean: -0.11753331124782562, mean p set: 0.44736534357070923
loss_pred:0.016063468530774117, decouple_loss:0.0008537941612303257
Iteration: 985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474567472934723, gen p mean: -0.10781081020832062, mean p set: 0.44803139567375183
The modified gen p mean: 0.4475303888320923, gen p mean: -0.11137919127941132, mean p set: 0.4481060206890106
loss_pred:0.015749182552099228, decouple_loss:0.0008868830045685172
loss_pred:0.015986701473593712, decouple_loss:0.0007454066071659327
The modified gen p mean: 0.4484204947948456, gen p mean: -0.1148485317826271, mean p set: 0.44899824261665344
loss_pred:0.015002059750258923, decouple_loss:0.0009826493915170431
Iteration: 986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465264081954956, gen p mean: -0.11628646403551102, mean p set: 0.4471015930175781
loss_pred:0.016378646716475487, decouple_loss:0.0008853736217133701
The modified gen p mean: 0.44753333926200867, gen p mean: -0.11454419791698456, mean p set: 0.4481104910373688
The modified gen p mean: 0.4476815164089203, gen p mean: -0.11546500772237778, mean p set: 0.4482575058937073
loss_pred:0.015088509768247604, decouple_loss:0.0007899064221419394
loss_pred:0.015522630885243416, decouple_loss:0.0007897603209130466
Iteration: 987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835472106933594, gen p mean: -0.1139131486415863, mean p set: 0.4489316940307617
loss_pred:0.01499292440712452, decouple_loss:0.001172143267467618
The modified gen p mean: 0.4493164122104645, gen p mean: -0.11511175334453583, mean p set: 0.44989389181137085
The modified gen p mean: 0.4483288824558258, gen p mean: -0.12045365571975708, mean p set: 0.44890403747558594
loss_pred:0.014719927683472633, decouple_loss:0.001085713505744934
loss_pred:0.015231321565806866, decouple_loss:0.0010973854223266244
Iteration: 988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642481207847595, gen p mean: -0.11935930699110031, mean p set: 0.44699788093566895
The modified gen p mean: 0.4472849369049072, gen p mean: -0.11409635096788406, mean p set: 0.4478605389595032
loss_pred:0.015663744881749153, decouple_loss:0.0009249805007129908
loss_pred:0.016025105491280556, decouple_loss:0.0009376282687298954
The modified gen p mean: 0.44915080070495605, gen p mean: -0.1155313104391098, mean p set: 0.4497283697128296
loss_pred:0.014888682402670383, decouple_loss:0.0009617169271223247
Iteration: 989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740816950798035, gen p mean: -0.11312999576330185, mean p set: 0.44798544049263
loss_pred:0.01589394547045231, decouple_loss:0.0009955873247236013
The modified gen p mean: 0.44619712233543396, gen p mean: -0.12006139010190964, mean p set: 0.44677209854125977
The modified gen p mean: 0.4479157030582428, gen p mean: -0.11438528448343277, mean p set: 0.4484897553920746
loss_pred:0.015437732450664043, decouple_loss:0.000788936740718782
loss_pred:0.015242847613990307, decouple_loss:0.0008042590925469995
Iteration: 990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468144476413727, gen p mean: -0.11042270064353943, mean p set: 0.44738900661468506
loss_pred:0.014653909020125866, decouple_loss:0.0009805232984945178
The modified gen p mean: 0.4464620351791382, gen p mean: -0.11998169869184494, mean p set: 0.44703981280326843
loss_pred:0.015550324693322182, decouple_loss:0.0011240821331739426
The modified gen p mean: 0.4468243718147278, gen p mean: -0.1140354573726654, mean p set: 0.4473989009857178
loss_pred:0.016231896355748177, decouple_loss:0.0011288007954135537
2023-05-01 02:51:32 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11527444422245026, mean p set: 0.4502691626548767
loss_pred:0.01750018447637558, decouple_loss:0.0012050430523231626
The modified gen p mean: 0.4495365619659424, gen p mean: -0.11027748882770538, mean p set: 0.4500633478164673
loss_pred:0.016868848353624344, decouple_loss:0.000841258792206645
The modified gen p mean: 0.4497785270214081, gen p mean: -0.1091054379940033, mean p set: 0.45035696029663086
loss_pred:0.01705891825258732, decouple_loss:0.000765857461374253
WV_1_PC_1_EH_0_PS_40, loss: 0.017189521342515945, avg_mse: 0.02671869471669197
current test mse: 0.026719
Iteration: 991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468681216239929, gen p mean: -0.11107227951288223, mean p set: 0.44744372367858887
loss_pred:0.015437102876603603, decouple_loss:0.0008294704020954669
The modified gen p mean: 0.44656842947006226, gen p mean: -0.10669005662202835, mean p set: 0.44714486598968506The modified gen p mean: 0.4465744197368622, gen p mean: -0.10712376981973648, mean p set: 0.4471484422683716
loss_pred:0.01440364308655262, decouple_loss:0.0010331731755286455
loss_pred:0.014660617336630821, decouple_loss:0.0009508131188340485
Iteration: 992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749924540519714, gen p mean: -0.1142958253622055, mean p set: 0.44807443022727966
loss_pred:0.014904627576470375, decouple_loss:0.0010730287758633494
The modified gen p mean: 0.44755682349205017, gen p mean: -0.11411048471927643, mean p set: 0.44813334941864014The modified gen p mean: 0.44803839921951294, gen p mean: -0.10646907985210419, mean p set: 0.44861525297164917
loss_pred:0.014928661286830902, decouple_loss:0.0006097574951127172
loss_pred:0.01589549332857132, decouple_loss:0.0008035129285417497
Iteration: 993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475407302379608, gen p mean: -0.11459183692932129, mean p set: 0.4481140077114105
loss_pred:0.014777688309550285, decouple_loss:0.001007879269309342
The modified gen p mean: 0.4469583332538605, gen p mean: -0.11073276400566101, mean p set: 0.44753316044807434
The modified gen p mean: 0.44714194536209106, gen p mean: -0.1105349063873291, mean p set: 0.4477183520793915
loss_pred:0.01617644540965557, decouple_loss:0.0011653437977656722
loss_pred:0.016411352902650833, decouple_loss:0.0011878830846399069
Iteration: 994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44650769233703613, gen p mean: -0.11306660622358322, mean p set: 0.4470820426940918
loss_pred:0.015234614722430706, decouple_loss:0.0011964048026129603
The modified gen p mean: 0.44680270552635193, gen p mean: -0.10739161819219589, mean p set: 0.44737815856933594
loss_pred:0.015148855745792389, decouple_loss:0.001174695324152708
The modified gen p mean: 0.44748738408088684, gen p mean: -0.11321636289358139, mean p set: 0.4480628967285156
loss_pred:0.015229686163365841, decouple_loss:0.0007454457227140665
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
NaN value num: 0
Iteration: 995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45304596424102783, gen p mean: -0.1101580336689949, mean p set: 0.45362117886543274
loss_pred:0.017324982210993767, decouple_loss:0.002232904080301523
The modified gen p mean: 0.45166611671447754, gen p mean: -0.1148148775100708, mean p set: 0.45224204659461975
loss_pred:0.016302062198519707, decouple_loss:0.0013610821915790439
The modified gen p mean: 0.4504172205924988, gen p mean: -0.1092621311545372, mean p set: 0.45099693536758423
loss_pred:0.015846069902181625, decouple_loss:0.0015739325899630785
Iteration: 996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45176419615745544, gen p mean: -0.11122626811265945, mean p set: 0.4523402452468872
loss_pred:0.016721108928322792, decouple_loss:0.001726111164316535
The modified gen p mean: 0.4506818950176239, gen p mean: -0.10401561856269836, mean p set: 0.45125675201416016
The modified gen p mean: 0.4509194493293762, gen p mean: -0.10794439166784286, mean p set: 0.45149585604667664
loss_pred:0.01641218736767769, decouple_loss:0.0012051305966451764
loss_pred:0.01674119010567665, decouple_loss:0.0016154991462826729
Iteration: 997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518684148788452, gen p mean: -0.10752956569194794, mean p set: 0.45244479179382324
loss_pred:0.016172556206583977, decouple_loss:0.0010577935026958585
The modified gen p mean: 0.45086100697517395, gen p mean: -0.10989505052566528, mean p set: 0.4514361619949341
loss_pred:0.016121704131364822, decouple_loss:0.0010728423949331045
The modified gen p mean: 0.4503856599330902, gen p mean: -0.1015479788184166, mean p set: 0.45096179842948914
loss_pred:0.016704261302947998, decouple_loss:0.0010691675124689937
Iteration: 998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493304491043091, gen p mean: -0.10294003784656525, mean p set: 0.4499072730541229
loss_pred:0.015602960251271725, decouple_loss:0.0014022602699697018
The modified gen p mean: 0.4508712589740753, gen p mean: -0.1031235009431839, mean p set: 0.45144835114479065
loss_pred:0.016481127589941025, decouple_loss:0.0017585956957191229
The modified gen p mean: 0.4493776261806488, gen p mean: -0.10048114508390427, mean p set: 0.4499543607234955
loss_pred:0.016202082857489586, decouple_loss:0.0015400320990011096
Iteration: 999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499606192111969, gen p mean: -0.10202162712812424, mean p set: 0.45053830742836
loss_pred:0.015653524547815323, decouple_loss:0.0013920724159106612
The modified gen p mean: 0.45170530676841736, gen p mean: -0.10415568202733994, mean p set: 0.45228278636932373
loss_pred:0.015896981582045555, decouple_loss:0.0015075826086103916
The modified gen p mean: 0.4517868161201477, gen p mean: -0.10102710872888565, mean p set: 0.4523625671863556
loss_pred:0.017239520326256752, decouple_loss:0.001435070880688727
Iteration: 1000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508550465106964, gen p mean: -0.10709839314222336, mean p set: 0.4514320194721222
loss_pred:0.016549641266465187, decouple_loss:0.0009810442570596933
The modified gen p mean: 0.45162567496299744, gen p mean: -0.10664292424917221, mean p set: 0.45220106840133667
loss_pred:0.016373123973608017, decouple_loss:0.0014595469692721963
The modified gen p mean: 0.450465589761734, gen p mean: -0.1030471920967102, mean p set: 0.45104217529296875
loss_pred:0.01649979129433632, decouple_loss:0.001415070379152894
2023-05-01 02:54:22 itr: 1000
training loss: [0.0164461  0.01659869 0.01657055]
2023-05-01 02:54:22 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11885461956262589, mean p set: 0.4502691626548767
loss_pred:0.017516374588012695, decouple_loss:0.0009777526138350368
The modified gen p mean: 0.4495363235473633, gen p mean: -0.11311054229736328, mean p set: 0.4500633478164673
loss_pred:0.016974572092294693, decouple_loss:0.0009777196682989597
The modified gen p mean: 0.44978147745132446, gen p mean: -0.1122613325715065, mean p set: 0.45035696029663086
loss_pred:0.017169833183288574, decouple_loss:0.0009814430959522724
WV_1_PC_1_EH_0_PS_40, loss: 0.017269209027290344, avg_mse: 0.026764055714011192
current test mse: 0.026764
Iteration: 1001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522705078125, gen p mean: -0.1096675917506218, mean p set: 0.45284903049468994
loss_pred:0.016996951773762703, decouple_loss:0.0010000201873481274
The modified gen p mean: 0.4520542025566101, gen p mean: -0.11515720188617706, mean p set: 0.4526314437389374
loss_pred:0.016178922727704048, decouple_loss:0.0012645237147808075
The modified gen p mean: 0.44999825954437256, gen p mean: -0.10972699522972107, mean p set: 0.45057356357574463
loss_pred:0.017246654257178307, decouple_loss:0.0008683332707732916
Iteration: 1002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450576514005661, gen p mean: -0.11270119994878769, mean p set: 0.4511524438858032
loss_pred:0.01625690795481205, decouple_loss:0.0016431063413619995
The modified gen p mean: 0.451297789812088, gen p mean: -0.11380679905414581, mean p set: 0.45187288522720337The modified gen p mean: 0.44962820410728455, gen p mean: -0.11130396276712418, mean p set: 0.4502032399177551
loss_pred:0.017134428024291992, decouple_loss:0.001359760295599699loss_pred:0.016550546512007713, decouple_loss:0.0011032698675990105
Iteration: 1003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45022231340408325, gen p mean: -0.1111006885766983, mean p set: 0.4507984220981598
loss_pred:0.016313254833221436, decouple_loss:0.0009498028666712344
The modified gen p mean: 0.45131075382232666, gen p mean: -0.11403502523899078, mean p set: 0.4518887996673584The modified gen p mean: 0.45317983627319336, gen p mean: -0.11164762079715729, mean p set: 0.45375457406044006
loss_pred:0.015681875869631767, decouple_loss:0.0012519957963377237
loss_pred:0.01729368418455124, decouple_loss:0.001349467085674405
Iteration: 1004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45190632343292236, gen p mean: -0.11308948695659637, mean p set: 0.45248204469680786
loss_pred:0.0158366896212101, decouple_loss:0.0007640380063094199
The modified gen p mean: 0.45044490694999695, gen p mean: -0.11064928770065308, mean p set: 0.4510226845741272
loss_pred:0.016187774017453194, decouple_loss:0.0009863704908639193
The modified gen p mean: 0.44984814524650574, gen p mean: -0.11264830827713013, mean p set: 0.4504260718822479
loss_pred:0.016459375619888306, decouple_loss:0.0008900385582819581
Iteration: 1005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45021364092826843, gen p mean: -0.11296066641807556, mean p set: 0.4507897198200226
loss_pred:0.015815705060958862, decouple_loss:0.0010625110007822514
The modified gen p mean: 0.4508734941482544, gen p mean: -0.11770959943532944, mean p set: 0.4514505863189697
loss_pred:0.015882492065429688, decouple_loss:0.0010973182506859303
The modified gen p mean: 0.4514840841293335, gen p mean: -0.11591795086860657, mean p set: 0.45205995440483093
loss_pred:0.016582241281867027, decouple_loss:0.0010491088032722473
Iteration: 1006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071637630462646, gen p mean: -0.11498333513736725, mean p set: 0.45129311084747314
loss_pred:0.015718555077910423, decouple_loss:0.0008849403820931911
The modified gen p mean: 0.4507359266281128, gen p mean: -0.10903052985668182, mean p set: 0.4513106644153595
loss_pred:0.015716658905148506, decouple_loss:0.001255821785889566
The modified gen p mean: 0.44959521293640137, gen p mean: -0.1134120523929596, mean p set: 0.4501703083515167
loss_pred:0.015508756972849369, decouple_loss:0.0008204549085348845
Iteration: 1007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44898051023483276, gen p mean: -0.11352308094501495, mean p set: 0.449554443359375
loss_pred:0.017290886491537094, decouple_loss:0.0008102826541289687
The modified gen p mean: 0.45160049200057983, gen p mean: -0.11090876162052155, mean p set: 0.45217567682266235
The modified gen p mean: 0.45128515362739563, gen p mean: -0.1105847954750061, mean p set: 0.4518622159957886
loss_pred:0.015841104090213776, decouple_loss:0.0009393085492774844
loss_pred:0.016368497163057327, decouple_loss:0.0008505359292030334
Iteration: 1008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511929154396057, gen p mean: -0.11388840526342392, mean p set: 0.4517684876918793
loss_pred:0.015948202461004257, decouple_loss:0.0010622232221066952
The modified gen p mean: 0.45159804821014404, gen p mean: -0.11428564786911011, mean p set: 0.45217224955558777
The modified gen p mean: 0.450361430644989, gen p mean: -0.115407794713974, mean p set: 0.4509369432926178
loss_pred:0.016329163685441017, decouple_loss:0.0009692393359728158
loss_pred:0.015663454309105873, decouple_loss:0.001479831407777965
Iteration: 1009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507797360420227, gen p mean: -0.11146904528141022, mean p set: 0.45135921239852905
loss_pred:0.01661859266459942, decouple_loss:0.0010641192784532905
The modified gen p mean: 0.45258522033691406, gen p mean: -0.10941910743713379, mean p set: 0.4531586468219757
The modified gen p mean: 0.451310932636261, gen p mean: -0.1096084862947464, mean p set: 0.4518847167491913
loss_pred:0.0159798264503479, decouple_loss:0.0011261898325756192
loss_pred:0.016057943925261497, decouple_loss:0.0010206232545897365
Iteration: 1010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823887944221497, gen p mean: -0.11012423783540726, mean p set: 0.4488172233104706
The modified gen p mean: 0.4504474699497223, gen p mean: -0.10809957981109619, mean p set: 0.4510255753993988
loss_pred:0.016558518633246422, decouple_loss:0.0008980715647339821
loss_pred:0.01602272316813469, decouple_loss:0.0012205415405333042
The modified gen p mean: 0.449317991733551, gen p mean: -0.10682690888643265, mean p set: 0.4498947560787201
loss_pred:0.01649135909974575, decouple_loss:0.0010648248717188835
2023-05-01 02:56:29 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1154981255531311, mean p set: 0.4502691626548767
loss_pred:0.01757870614528656, decouple_loss:0.0011679187882691622
The modified gen p mean: 0.44953468441963196, gen p mean: -0.10947129875421524, mean p set: 0.4500633478164673
loss_pred:0.01699851267039776, decouple_loss:0.001050440245307982
The modified gen p mean: 0.44978058338165283, gen p mean: -0.10884761810302734, mean p set: 0.45035696029663086
loss_pred:0.01718136854469776, decouple_loss:0.0009560756152495742
WV_1_PC_1_EH_0_PS_40, loss: 0.01730576902627945, avg_mse: 0.026872657239437103
current test mse: 0.026873
Iteration: 1011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089253783226013, gen p mean: -0.10697980225086212, mean p set: 0.45147067308425903
loss_pred:0.01571768894791603, decouple_loss:0.0011311274720355868
The modified gen p mean: 0.4502473473548889, gen p mean: -0.10420598089694977, mean p set: 0.4508242905139923
The modified gen p mean: 0.45078033208847046, gen p mean: -0.10558399558067322, mean p set: 0.4513586759567261
loss_pred:0.015691962093114853, decouple_loss:0.0008661653264425695
loss_pred:0.01598965935409069, decouple_loss:0.001308977254666388
Iteration: 1012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491099715232849, gen p mean: -0.10779664665460587, mean p set: 0.4496879279613495
loss_pred:0.017247583717107773, decouple_loss:0.0015340544050559402
The modified gen p mean: 0.45116665959358215, gen p mean: -0.10316676646471024, mean p set: 0.45174074172973633
The modified gen p mean: 0.45001649856567383, gen p mean: -0.10645019263029099, mean p set: 0.4505949914455414
loss_pred:0.015558132901787758, decouple_loss:0.0010736676631495357
loss_pred:0.016765009611845016, decouple_loss:0.0013254628283903003
Iteration: 1013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45050907135009766, gen p mean: -0.10738185048103333, mean p set: 0.4510842561721802
loss_pred:0.015448395162820816, decouple_loss:0.0009924164041876793
The modified gen p mean: 0.4519498348236084, gen p mean: -0.11135929822921753, mean p set: 0.45253023505210876
loss_pred:0.015981554985046387, decouple_loss:0.0014867257559671998
The modified gen p mean: 0.4509030878543854, gen p mean: -0.10801585763692856, mean p set: 0.4514783024787903
loss_pred:0.016991300508379936, decouple_loss:0.001296883332543075
Iteration: 1014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45109280943870544, gen p mean: -0.11713939905166626, mean p set: 0.45167064666748047
loss_pred:0.015918347984552383, decouple_loss:0.0009644218371249735
The modified gen p mean: 0.45013347268104553, gen p mean: -0.1104675903916359, mean p set: 0.45071083307266235
loss_pred:0.015595750883221626, decouple_loss:0.0010572421597316861
The modified gen p mean: 0.44902458786964417, gen p mean: -0.11484924703836441, mean p set: 0.44960182905197144
loss_pred:0.016979318112134933, decouple_loss:0.0009823094587773085
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
NaN value num: 0
Iteration: 1015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497146010398865, gen p mean: -0.11783230304718018, mean p set: 0.4502916932106018
loss_pred:0.01871686615049839, decouple_loss:0.0015799342654645443
The modified gen p mean: 0.44846418499946594, gen p mean: -0.12203694134950638, mean p set: 0.44903984665870667
loss_pred:0.017538711428642273, decouple_loss:0.001156844082288444
The modified gen p mean: 0.44880926609039307, gen p mean: -0.1206296905875206, mean p set: 0.4493838846683502
loss_pred:0.018348073586821556, decouple_loss:0.001318870927207172
Iteration: 1016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45207422971725464, gen p mean: -0.11592534929513931, mean p set: 0.45265257358551025
loss_pred:0.0174885056912899, decouple_loss:0.0013361724559217691
The modified gen p mean: 0.4529476761817932, gen p mean: -0.11770249903202057, mean p set: 0.45352625846862793
loss_pred:0.017412660643458366, decouple_loss:0.0013003639178350568
The modified gen p mean: 0.4496672451496124, gen p mean: -0.12173233181238174, mean p set: 0.4502440094947815
loss_pred:0.018693886697292328, decouple_loss:0.0012105914065614343
Iteration: 1017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510948359966278, gen p mean: -0.1267574429512024, mean p set: 0.4516725242137909
loss_pred:0.01767786033451557, decouple_loss:0.0010251336498185992
The modified gen p mean: 0.44987693428993225, gen p mean: -0.12216149270534515, mean p set: 0.45045459270477295
loss_pred:0.016393722966313362, decouple_loss:0.0009268881985917687
The modified gen p mean: 0.4502151310443878, gen p mean: -0.12399236112833023, mean p set: 0.4507887363433838
loss_pred:0.01640102081000805, decouple_loss:0.0010340592125430703
Iteration: 1018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497584402561188, gen p mean: -0.12598665058612823, mean p set: 0.4503326416015625
loss_pred:0.01838839054107666, decouple_loss:0.0014078639214858413
The modified gen p mean: 0.4486379623413086, gen p mean: -0.12870661914348602, mean p set: 0.44921332597732544
loss_pred:0.017621202394366264, decouple_loss:0.0010197883239015937
The modified gen p mean: 0.449593186378479, gen p mean: -0.12079644203186035, mean p set: 0.4501686692237854
loss_pred:0.01716931164264679, decouple_loss:0.0008731933776289225
Iteration: 1019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012912154197693, gen p mean: -0.12165188044309616, mean p set: 0.4507025480270386
loss_pred:0.01800607144832611, decouple_loss:0.0010840706527233124
The modified gen p mean: 0.45272567868232727, gen p mean: -0.12167171388864517, mean p set: 0.45330190658569336
loss_pred:0.016955701634287834, decouple_loss:0.0018797119846567512
The modified gen p mean: 0.44997915625572205, gen p mean: -0.12372087687253952, mean p set: 0.4505581855773926
loss_pred:0.01707233116030693, decouple_loss:0.0008183735189959407
Iteration: 1020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471678137779236, gen p mean: -0.1301099956035614, mean p set: 0.4477446675300598
loss_pred:0.016552813351154327, decouple_loss:0.0018025236204266548
The modified gen p mean: 0.4526452124118805, gen p mean: -0.11986296623945236, mean p set: 0.4532198905944824
loss_pred:0.017973408102989197, decouple_loss:0.0017040057573467493
The modified gen p mean: 0.4522576928138733, gen p mean: -0.1190333291888237, mean p set: 0.4528343677520752
loss_pred:0.017197977751493454, decouple_loss:0.0017761936178430915
2023-05-01 02:59:15 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13172359764575958, mean p set: 0.4502691626548767
loss_pred:0.017760658636689186, decouple_loss:0.0013797231949865818
The modified gen p mean: 0.44953277707099915, gen p mean: -0.12555402517318726, mean p set: 0.4500633478164673
loss_pred:0.017001645639538765, decouple_loss:0.0012485176557675004
The modified gen p mean: 0.44982728362083435, gen p mean: -0.12520533800125122, mean p set: 0.45035696029663086
loss_pred:0.017160560935735703, decouple_loss:0.0009710000595077872
WV_1_PC_1_EH_0_PS_40, loss: 0.017367608845233917, avg_mse: 0.02680688351392746
current test mse: 0.026807
Iteration: 1021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500335454940796, gen p mean: -0.12595757842063904, mean p set: 0.4506070911884308
The modified gen p mean: 0.44959336519241333, gen p mean: -0.12199214845895767, mean p set: 0.45016786456108093
loss_pred:0.01803653873503208, decouple_loss:0.0011256688740104437
loss_pred:0.017819475382566452, decouple_loss:0.0009793532080948353
The modified gen p mean: 0.44973933696746826, gen p mean: -0.11919732391834259, mean p set: 0.45031604170799255
loss_pred:0.017410732805728912, decouple_loss:0.001103889662772417
Iteration: 1022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496057629585266, gen p mean: -0.12093374133110046, mean p set: 0.45018163323402405
loss_pred:0.01708495058119297, decouple_loss:0.002196463756263256
The modified gen p mean: 0.45011740922927856, gen p mean: -0.1224408745765686, mean p set: 0.450695663690567
The modified gen p mean: 0.4499891698360443, gen p mean: -0.12100229412317276, mean p set: 0.4505661725997925
loss_pred:0.017194537445902824, decouple_loss:0.0014067544834688306
loss_pred:0.016457857564091682, decouple_loss:0.0011152873048558831
Iteration: 1023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497510492801666, gen p mean: -0.11867623031139374, mean p set: 0.45032599568367004
loss_pred:0.01673184521496296, decouple_loss:0.0016295037930831313
The modified gen p mean: 0.44962579011917114, gen p mean: -0.1217646524310112, mean p set: 0.45020267367362976
loss_pred:0.01798289269208908, decouple_loss:0.0013625873252749443
The modified gen p mean: 0.4490863084793091, gen p mean: -0.11996820569038391, mean p set: 0.44966429471969604
loss_pred:0.017623908817768097, decouple_loss:0.0011696083238348365
Iteration: 1024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963157176971436, gen p mean: -0.12545894086360931, mean p set: 0.45020797848701477
loss_pred:0.01748391054570675, decouple_loss:0.0011057379888370633
The modified gen p mean: 0.45145708322525024, gen p mean: -0.1177540272474289, mean p set: 0.4520338773727417
loss_pred:0.017660031095147133, decouple_loss:0.0009655418689362705
The modified gen p mean: 0.4515305757522583, gen p mean: -0.1191423162817955, mean p set: 0.4521060883998871
loss_pred:0.017332827672362328, decouple_loss:0.0009733451879583299
Iteration: 1025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492497146129608, gen p mean: -0.11007094383239746, mean p set: 0.44982537627220154
loss_pred:0.017499644309282303, decouple_loss:0.0011651143431663513
The modified gen p mean: 0.4502975642681122, gen p mean: -0.11040525883436203, mean p set: 0.45087239146232605
loss_pred:0.017325475811958313, decouple_loss:0.0008555204258300364
The modified gen p mean: 0.4526204466819763, gen p mean: -0.10855910927057266, mean p set: 0.4531964957714081
loss_pred:0.017229324206709862, decouple_loss:0.001434706849977374
Iteration: 1026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45307019352912903, gen p mean: -0.10625399649143219, mean p set: 0.45364704728126526
loss_pred:0.01752132549881935, decouple_loss:0.0012300658272579312
The modified gen p mean: 0.44940054416656494, gen p mean: -0.10861370712518692, mean p set: 0.4499790072441101
The modified gen p mean: 0.4529024362564087, gen p mean: -0.10625425726175308, mean p set: 0.4534813165664673
loss_pred:0.017325319349765778, decouple_loss:0.0010989141883328557
loss_pred:0.01802392490208149, decouple_loss:0.0015136959264054894
Iteration: 1027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487452208995819, gen p mean: -0.11240073293447495, mean p set: 0.4493206739425659
loss_pred:0.016568435356020927, decouple_loss:0.0008235818240791559
The modified gen p mean: 0.4511692523956299, gen p mean: -0.10831255465745926, mean p set: 0.4517436623573303
The modified gen p mean: 0.4534837603569031, gen p mean: -0.10803255438804626, mean p set: 0.45406150817871094
loss_pred:0.018028590828180313, decouple_loss:0.0010119572980329394
loss_pred:0.016447149217128754, decouple_loss:0.0012919071596115828
Iteration: 1028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448594868183136, gen p mean: -0.11449068784713745, mean p set: 0.44917213916778564
loss_pred:0.016378413885831833, decouple_loss:0.0008973537478595972
The modified gen p mean: 0.4488275945186615, gen p mean: -0.11527210474014282, mean p set: 0.4494048058986664
loss_pred:0.016321687027812004, decouple_loss:0.0007819801103323698
The modified gen p mean: 0.45288458466529846, gen p mean: -0.10601431876420975, mean p set: 0.4534589648246765
loss_pred:0.017586860805749893, decouple_loss:0.0011351034045219421
Iteration: 1029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500384032726288, gen p mean: -0.10744985938072205, mean p set: 0.45061424374580383
The modified gen p mean: 0.449246883392334, gen p mean: -0.11631431430578232, mean p set: 0.44981902837753296
loss_pred:0.016710994765162468, decouple_loss:0.0008729572291485965
loss_pred:0.017077947035431862, decouple_loss:0.0008125179447233677
The modified gen p mean: 0.45039328932762146, gen p mean: -0.11332505196332932, mean p set: 0.45096808671951294
loss_pred:0.01621362566947937, decouple_loss:0.000855005462653935
Iteration: 1030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943973422050476, gen p mean: -0.10985719412565231, mean p set: 0.4500143229961395
loss_pred:0.017310328781604767, decouple_loss:0.0008028579759411514
The modified gen p mean: 0.44970807433128357, gen p mean: -0.11063871532678604, mean p set: 0.45028528571128845
The modified gen p mean: 0.452469140291214, gen p mean: -0.11041010171175003, mean p set: 0.45304545760154724
loss_pred:0.01652354747056961, decouple_loss:0.0008978371042758226
loss_pred:0.016912195831537247, decouple_loss:0.0011183858150616288
2023-05-01 03:01:21 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12823893129825592, mean p set: 0.4502691626548767
loss_pred:0.017663147300481796, decouple_loss:0.0009653627639636397
The modified gen p mean: 0.4495387375354767, gen p mean: -0.12234587222337723, mean p set: 0.4500633478164673
loss_pred:0.016881190240383148, decouple_loss:0.0009649685816839337
The modified gen p mean: 0.4498275816440582, gen p mean: -0.12159580737352371, mean p set: 0.45035696029663086
loss_pred:0.017093272879719734, decouple_loss:0.0009156668675132096
WV_1_PC_1_EH_0_PS_40, loss: 0.01725997030735016, avg_mse: 0.026772376149892807
current test mse: 0.026772
Iteration: 1031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44907811284065247, gen p mean: -0.11717913299798965, mean p set: 0.4496527314186096
The modified gen p mean: 0.44836586713790894, gen p mean: -0.12446923553943634, mean p set: 0.44894298911094666
loss_pred:0.017478369176387787, decouple_loss:0.0008842991665005684
loss_pred:0.016366807743906975, decouple_loss:0.0010395937133580446
The modified gen p mean: 0.4525547921657562, gen p mean: -0.11480946093797684, mean p set: 0.4531312584877014
loss_pred:0.017910292372107506, decouple_loss:0.0010433393763378263
Iteration: 1032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506062865257263, gen p mean: -0.12054438889026642, mean p set: 0.4511836767196655The modified gen p mean: 0.4513280391693115, gen p mean: -0.1253485381603241, mean p set: 0.451905757188797
loss_pred:0.018863368779420853, decouple_loss:0.0008225642959587276loss_pred:0.016620546579360962, decouple_loss:0.0007719504064880311
The modified gen p mean: 0.4504971206188202, gen p mean: -0.12645481526851654, mean p set: 0.4510722756385803
loss_pred:0.016216067597270012, decouple_loss:0.0009110014652833343
Iteration: 1033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505133628845215, gen p mean: -0.1307017058134079, mean p set: 0.4510878920555115
The modified gen p mean: 0.4486697316169739, gen p mean: -0.13302673399448395, mean p set: 0.44924721121788025
loss_pred:0.01782720722258091, decouple_loss:0.001141117885708809
loss_pred:0.016092656180262566, decouple_loss:0.0008864096598699689
The modified gen p mean: 0.4494427740573883, gen p mean: -0.1245773583650589, mean p set: 0.4500192403793335
loss_pred:0.017147282138466835, decouple_loss:0.0009626942337490618
Iteration: 1034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44914305210113525, gen p mean: -0.13506659865379333, mean p set: 0.4497148096561432
The modified gen p mean: 0.4516196846961975, gen p mean: -0.13035377860069275, mean p set: 0.45219725370407104
loss_pred:0.016867883503437042, decouple_loss:0.000769645266700536
loss_pred:0.01677657663822174, decouple_loss:0.0010285619646310806
The modified gen p mean: 0.4498266577720642, gen p mean: -0.12659049034118652, mean p set: 0.45040273666381836
loss_pred:0.016659585759043694, decouple_loss:0.0008704452775418758
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
NaN value num: 0
Iteration: 1035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504540264606476, gen p mean: -0.13646680116653442, mean p set: 0.4510316848754883The modified gen p mean: 0.452018678188324, gen p mean: -0.13134479522705078, mean p set: 0.45259830355644226
loss_pred:0.016530850902199745, decouple_loss:0.0009691348532214761
loss_pred:0.017118744552135468, decouple_loss:0.0010913211153820157
The modified gen p mean: 0.453405499458313, gen p mean: -0.1370217353105545, mean p set: 0.45397984981536865
loss_pred:0.01549875270575285, decouple_loss:0.0012618121691048145
Iteration: 1036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45135393738746643, gen p mean: -0.1360442191362381, mean p set: 0.4519317150115967
loss_pred:0.018514545634388924, decouple_loss:0.0010871639242395759
The modified gen p mean: 0.4516940116882324, gen p mean: -0.12242478132247925, mean p set: 0.45227164030075073
loss_pred:0.017802773043513298, decouple_loss:0.0008505376172251999
The modified gen p mean: 0.4530628025531769, gen p mean: -0.13398954272270203, mean p set: 0.45363950729370117
loss_pred:0.016747115179896355, decouple_loss:0.0009447491029277444
Iteration: 1037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951218366622925, gen p mean: -0.1303892731666565, mean p set: 0.4500868618488312
loss_pred:0.015623281709849834, decouple_loss:0.0010834927670657635
The modified gen p mean: 0.45310530066490173, gen p mean: -0.1309199184179306, mean p set: 0.4536832273006439
loss_pred:0.016752734780311584, decouple_loss:0.0012835649540647864
The modified gen p mean: 0.4532541036605835, gen p mean: -0.1225847452878952, mean p set: 0.4538283348083496
loss_pred:0.01780906319618225, decouple_loss:0.0008814448956400156
Iteration: 1038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520294666290283, gen p mean: -0.1169680580496788, mean p set: 0.4526059925556183
loss_pred:0.017847435548901558, decouple_loss:0.0011267177760601044
The modified gen p mean: 0.452821284532547, gen p mean: -0.11829371750354767, mean p set: 0.4534010887145996
The modified gen p mean: 0.453087717294693, gen p mean: -0.11274994164705276, mean p set: 0.45366615056991577
loss_pred:0.017144011333584785, decouple_loss:0.0011422013631090522
loss_pred:0.017872393131256104, decouple_loss:0.0009060442098416388
Iteration: 1039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450318843126297, gen p mean: -0.10618539154529572, mean p set: 0.4508957266807556
loss_pred:0.016428526490926743, decouple_loss:0.0008227311191149056
The modified gen p mean: 0.4508996605873108, gen p mean: -0.10817660391330719, mean p set: 0.45147937536239624
loss_pred:0.0163261741399765, decouple_loss:0.000843720743432641
The modified gen p mean: 0.45170533657073975, gen p mean: -0.10307668894529343, mean p set: 0.452282190322876
loss_pred:0.016053590923547745, decouple_loss:0.0011267916997894645
Iteration: 1040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536505341529846, gen p mean: -0.10486648976802826, mean p set: 0.45422741770744324
loss_pred:0.017247257754206657, decouple_loss:0.0011188609059900045
The modified gen p mean: 0.45103779435157776, gen p mean: -0.1019885241985321, mean p set: 0.45161619782447815
loss_pred:0.017420094460248947, decouple_loss:0.0008092634379863739
The modified gen p mean: 0.45051059126853943, gen p mean: -0.1018533706665039, mean p set: 0.4510881304740906
loss_pred:0.016930732876062393, decouple_loss:0.0010469908593222499
2023-05-01 03:04:05 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11750859767198563, mean p set: 0.4502691626548767
loss_pred:0.017712052911520004, decouple_loss:0.0009299042285420001
The modified gen p mean: 0.4495370090007782, gen p mean: -0.11160335689783096, mean p set: 0.4500633478164673
loss_pred:0.017082838341593742, decouple_loss:0.0010531314183026552
The modified gen p mean: 0.4498288631439209, gen p mean: -0.11072636395692825, mean p set: 0.45035696029663086
loss_pred:0.017222346737980843, decouple_loss:0.0010900907218456268
WV_1_PC_1_EH_0_PS_40, loss: 0.01739029958844185, avg_mse: 0.026821544393897057
current test mse: 0.026822
Iteration: 1041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526360332965851, gen p mean: -0.10652850568294525, mean p set: 0.4532114863395691
The modified gen p mean: 0.4524821937084198, gen p mean: -0.10593314468860626, mean p set: 0.4530578553676605
loss_pred:0.016827503219246864, decouple_loss:0.0011787591502070427
loss_pred:0.018483661115169525, decouple_loss:0.0011194550897926092
The modified gen p mean: 0.45075422525405884, gen p mean: -0.10234144330024719, mean p set: 0.4513308107852936
loss_pred:0.01680315099656582, decouple_loss:0.0007630345644429326
Iteration: 1042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518028199672699, gen p mean: -0.1083613708615303, mean p set: 0.4523768723011017
loss_pred:0.015484130941331387, decouple_loss:0.0009889783104881644
The modified gen p mean: 0.4497876465320587, gen p mean: -0.10545288026332855, mean p set: 0.4503626525402069The modified gen p mean: 0.4500451982021332, gen p mean: -0.10760017484426498, mean p set: 0.4506206214427948
loss_pred:0.016541995108127594, decouple_loss:0.0009819809347391129
loss_pred:0.015438166446983814, decouple_loss:0.001031631138175726
Iteration: 1043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45406949520111084, gen p mean: -0.10676887631416321, mean p set: 0.454647958278656
loss_pred:0.01631741411983967, decouple_loss:0.0009064886253327131
The modified gen p mean: 0.45185917615890503, gen p mean: -0.1055390015244484, mean p set: 0.4524341821670532The modified gen p mean: 0.4506208598613739, gen p mean: -0.10210627317428589, mean p set: 0.4511997699737549
loss_pred:0.01624908298254013, decouple_loss:0.0008179438882507384
loss_pred:0.01625383272767067, decouple_loss:0.0009326814906671643
Iteration: 1044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45335131883621216, gen p mean: -0.11346843838691711, mean p set: 0.4539260268211365
loss_pred:0.016353143379092216, decouple_loss:0.0013526770053431392
The modified gen p mean: 0.45477020740509033, gen p mean: -0.1136198416352272, mean p set: 0.45534548163414
loss_pred:0.015955941751599312, decouple_loss:0.0008625981281511486
The modified gen p mean: 0.45297351479530334, gen p mean: -0.11306747049093246, mean p set: 0.4535527229309082
loss_pred:0.018333060666918755, decouple_loss:0.0016357866115868092
Iteration: 1045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528408348560333, gen p mean: -0.10801927745342255, mean p set: 0.4534182846546173
loss_pred:0.017539938911795616, decouple_loss:0.0009786486625671387
The modified gen p mean: 0.4527744948863983, gen p mean: -0.11576707661151886, mean p set: 0.4533534646034241
loss_pred:0.017001062631607056, decouple_loss:0.0007514653261750937
The modified gen p mean: 0.4514411985874176, gen p mean: -0.10804565250873566, mean p set: 0.4520170986652374
loss_pred:0.01762174256145954, decouple_loss:0.0008321856148540974
Iteration: 1046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495408535003662, gen p mean: -0.12688027322292328, mean p set: 0.45011797547340393
loss_pred:0.016304809600114822, decouple_loss:0.0009050338994711637
The modified gen p mean: 0.4529929757118225, gen p mean: -0.12774835526943207, mean p set: 0.4535693824291229
loss_pred:0.016890984028577805, decouple_loss:0.0008318715845234692
The modified gen p mean: 0.45395055413246155, gen p mean: -0.12372113764286041, mean p set: 0.4545283913612366
loss_pred:0.015842102468013763, decouple_loss:0.0009505508351139724
Iteration: 1047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529852271080017, gen p mean: -0.11738665401935577, mean p set: 0.45355919003486633
loss_pred:0.018566671758890152, decouple_loss:0.0011640711454674602
The modified gen p mean: 0.4511827528476715, gen p mean: -0.11624082177877426, mean p set: 0.45175933837890625
loss_pred:0.01570119895040989, decouple_loss:0.0009339411626569927
The modified gen p mean: 0.45015382766723633, gen p mean: -0.11574736982584, mean p set: 0.4507310390472412
loss_pred:0.016852939501404762, decouple_loss:0.0009033398237079382
Iteration: 1048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44950026273727417, gen p mean: -0.10091481357812881, mean p set: 0.4500764310359955
loss_pred:0.017292572185397148, decouple_loss:0.0011250731768086553
The modified gen p mean: 0.45329996943473816, gen p mean: -0.10096079856157303, mean p set: 0.4538773000240326
loss_pred:0.01870213821530342, decouple_loss:0.0009274169569835067
The modified gen p mean: 0.44984170794487, gen p mean: -0.10769276320934296, mean p set: 0.4504196047782898
loss_pred:0.015741195529699326, decouple_loss:0.0010531367734074593
Iteration: 1049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529099464416504, gen p mean: -0.10942313820123672, mean p set: 0.453487753868103
loss_pred:0.017625337466597557, decouple_loss:0.0009199340711347759
The modified gen p mean: 0.4501180946826935, gen p mean: -0.11302457749843597, mean p set: 0.4506944417953491
The modified gen p mean: 0.4503251612186432, gen p mean: -0.11157939583063126, mean p set: 0.45090195536613464
loss_pred:0.018300872296094894, decouple_loss:0.0008614743710495532
loss_pred:0.017151597887277603, decouple_loss:0.0010553643805906177
Iteration: 1050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4548667073249817, gen p mean: -0.1095004677772522, mean p set: 0.45544660091400146
loss_pred:0.016808347776532173, decouple_loss:0.0007578235235996544
The modified gen p mean: 0.4518650472164154, gen p mean: -0.10382086038589478, mean p set: 0.4524429440498352
The modified gen p mean: 0.4520764648914337, gen p mean: -0.10894302278757095, mean p set: 0.452653169631958
loss_pred:0.015772510319948196, decouple_loss:0.0011095006484538317
loss_pred:0.01804007962346077, decouple_loss:0.0010583729017525911
2023-05-01 03:06:11 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11602318286895752, mean p set: 0.4502691626548767
loss_pred:0.018402552232146263, decouple_loss:0.0009850028436630964
The modified gen p mean: 0.4495357275009155, gen p mean: -0.1110738143324852, mean p set: 0.4500633478164673
loss_pred:0.017591414973139763, decouple_loss:0.0009572360431775451
The modified gen p mean: 0.44982942938804626, gen p mean: -0.1099558174610138, mean p set: 0.45035696029663086
loss_pred:0.017761308699846268, decouple_loss:0.0009459163411520422
WV_1_PC_1_EH_0_PS_40, loss: 0.017966561019420624, avg_mse: 0.027854016050696373
current test mse: 0.027854
Iteration: 1051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45319220423698425, gen p mean: -0.10751944035291672, mean p set: 0.4537713825702667
loss_pred:0.0171479694545269, decouple_loss:0.0011034319177269936
The modified gen p mean: 0.45230329036712646, gen p mean: -0.10581592470407486, mean p set: 0.45287883281707764
loss_pred:0.015765605494379997, decouple_loss:0.0009052865789271891
The modified gen p mean: 0.4503076374530792, gen p mean: -0.10753968358039856, mean p set: 0.4508844316005707
loss_pred:0.016235118731856346, decouple_loss:0.0009999214671552181
Iteration: 1052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45135992765426636, gen p mean: -0.11862289905548096, mean p set: 0.451936274766922
loss_pred:0.01776452176272869, decouple_loss:0.000824800634291023
The modified gen p mean: 0.45197126269340515, gen p mean: -0.11655755341053009, mean p set: 0.45254963636398315The modified gen p mean: 0.4507860243320465, gen p mean: -0.11845119297504425, mean p set: 0.45136159658432007
loss_pred:0.018218331038951874, decouple_loss:0.0008762461366131902
loss_pred:0.0168426726013422, decouple_loss:0.0008336578030139208
Iteration: 1053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536624252796173, gen p mean: -0.12217902392148972, mean p set: 0.4542378783226013
loss_pred:0.018123919144272804, decouple_loss:0.0008812571759335697
The modified gen p mean: 0.4518057405948639, gen p mean: -0.12263958156108856, mean p set: 0.45238202810287476The modified gen p mean: 0.45110711455345154, gen p mean: -0.11796307563781738, mean p set: 0.45168498158454895
loss_pred:0.016608523204922676, decouple_loss:0.0009438490960747004loss_pred:0.018359096720814705, decouple_loss:0.0008979324484243989
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
NaN value num: 0
Iteration: 1054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516099691390991, gen p mean: -0.11502189189195633, mean p set: 0.4521867632865906
The modified gen p mean: 0.45447778701782227, gen p mean: -0.11754661798477173, mean p set: 0.4550555646419525loss_pred:0.018612205982208252, decouple_loss:0.0010049989214166999
loss_pred:0.018833914771676064, decouple_loss:0.0010484241647645831
The modified gen p mean: 0.4502907991409302, gen p mean: -0.11570160835981369, mean p set: 0.45086869597435
loss_pred:0.01949375495314598, decouple_loss:0.0009798718383535743
Iteration: 1055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45162850618362427, gen p mean: -0.13290683925151825, mean p set: 0.452201247215271
loss_pred:0.01977577432990074, decouple_loss:0.0012881068978458643
The modified gen p mean: 0.4543866217136383, gen p mean: -0.13592122495174408, mean p set: 0.45496177673339844
loss_pred:0.019610626623034477, decouple_loss:0.0011319275945425034
The modified gen p mean: 0.45229578018188477, gen p mean: -0.13097213208675385, mean p set: 0.4528714418411255
loss_pred:0.018911942839622498, decouple_loss:0.0008612438687123358
Iteration: 1056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45011788606643677, gen p mean: -0.1436532735824585, mean p set: 0.4506944417953491
loss_pred:0.01882632076740265, decouple_loss:0.0009270138689316809
The modified gen p mean: 0.45021507143974304, gen p mean: -0.14118769764900208, mean p set: 0.45079267024993896
loss_pred:0.018293796107172966, decouple_loss:0.0009705336997285485
The modified gen p mean: 0.4509221613407135, gen p mean: -0.13584811985492706, mean p set: 0.45149728655815125
loss_pred:0.020150890573859215, decouple_loss:0.0011781691573560238
Iteration: 1057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503750503063202, gen p mean: -0.12495997548103333, mean p set: 0.45095011591911316
loss_pred:0.018243512138724327, decouple_loss:0.001118175103329122
The modified gen p mean: 0.4516931474208832, gen p mean: -0.13167354464530945, mean p set: 0.452269583940506
loss_pred:0.018464798107743263, decouple_loss:0.0011676752474159002
The modified gen p mean: 0.45071518421173096, gen p mean: -0.13005483150482178, mean p set: 0.45129111409187317
loss_pred:0.018687909469008446, decouple_loss:0.0010875500738620758
Iteration: 1058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45186907052993774, gen p mean: -0.12801958620548248, mean p set: 0.45244714617729187
loss_pred:0.01804371550679207, decouple_loss:0.0011279309401288629
The modified gen p mean: 0.4515151083469391, gen p mean: -0.1296146959066391, mean p set: 0.4520919919013977
loss_pred:0.018439237028360367, decouple_loss:0.001062376773916185
The modified gen p mean: 0.45109453797340393, gen p mean: -0.12484092265367508, mean p set: 0.4516713619232178
loss_pred:0.01857355423271656, decouple_loss:0.0012987214140594006
Iteration: 1059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531024396419525, gen p mean: -0.12906001508235931, mean p set: 0.4536796808242798
loss_pred:0.018818186596035957, decouple_loss:0.0012198318727314472
The modified gen p mean: 0.4513825476169586, gen p mean: -0.12825413048267365, mean p set: 0.4519573748111725
loss_pred:0.017422597855329514, decouple_loss:0.0011700484901666641
The modified gen p mean: 0.451395720243454, gen p mean: -0.12585856020450592, mean p set: 0.45197439193725586
loss_pred:0.018341094255447388, decouple_loss:0.0012026745826005936
Iteration: 1060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507235586643219, gen p mean: -0.1262533962726593, mean p set: 0.4513033628463745
loss_pred:0.01809391751885414, decouple_loss:0.0011822350788861513
The modified gen p mean: 0.45113301277160645, gen p mean: -0.12930181622505188, mean p set: 0.45171278715133667
loss_pred:0.01856435462832451, decouple_loss:0.0012117096921429038
The modified gen p mean: 0.44978466629981995, gen p mean: -0.12348172813653946, mean p set: 0.4503606855869293
loss_pred:0.01936795748770237, decouple_loss:0.0012586925877258182
2023-05-01 03:08:55 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.14041855931282043, mean p set: 0.4502691626548767
loss_pred:0.018636275082826614, decouple_loss:0.0012001183349639177
The modified gen p mean: 0.44953736662864685, gen p mean: -0.13393479585647583, mean p set: 0.4500633478164673
loss_pred:0.01793064922094345, decouple_loss:0.001139714615419507
The modified gen p mean: 0.44982659816741943, gen p mean: -0.13301128149032593, mean p set: 0.45035696029663086
loss_pred:0.018139949068427086, decouple_loss:0.0010775222908705473
WV_1_PC_1_EH_0_PS_40, loss: 0.018292579799890518, avg_mse: 0.027956439182162285
current test mse: 0.027956
Iteration: 1061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45055902004241943, gen p mean: -0.1331685334444046, mean p set: 0.45113492012023926
loss_pred:0.01841670647263527, decouple_loss:0.0011603645980358124
The modified gen p mean: 0.45292308926582336, gen p mean: -0.13010896742343903, mean p set: 0.4534992575645447The modified gen p mean: 0.4512222707271576, gen p mean: -0.12892210483551025, mean p set: 0.4517989158630371
loss_pred:0.017837194725871086, decouple_loss:0.0012772202026098967
loss_pred:0.01780945621430874, decouple_loss:0.0012949701631441712
Iteration: 1062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517275094985962, gen p mean: -0.14246203005313873, mean p set: 0.45230618119239807
loss_pred:0.018382567912340164, decouple_loss:0.001168535673059523
The modified gen p mean: 0.45167312026023865, gen p mean: -0.14293628931045532, mean p set: 0.45224812626838684The modified gen p mean: 0.4499238431453705, gen p mean: -0.14691902697086334, mean p set: 0.45049911737442017
loss_pred:0.016533318907022476, decouple_loss:0.0012043480528518558loss_pred:0.017992695793509483, decouple_loss:0.0011713604908436537
Iteration: 1063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500086009502411, gen p mean: -0.1339992880821228, mean p set: 0.4505843222141266
loss_pred:0.01850624568760395, decouple_loss:0.001239343429915607
The modified gen p mean: 0.45114707946777344, gen p mean: -0.1402272880077362, mean p set: 0.4517273008823395
loss_pred:0.01768050342798233, decouple_loss:0.001297093229368329
The modified gen p mean: 0.4514765739440918, gen p mean: -0.13728967308998108, mean p set: 0.4520516097545624
loss_pred:0.01709875278174877, decouple_loss:0.0014129799092188478
Iteration: 1064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44984346628189087, gen p mean: -0.1206410676240921, mean p set: 0.450419545173645
loss_pred:0.01876964047551155, decouple_loss:0.00125205481890589
The modified gen p mean: 0.4503892958164215, gen p mean: -0.12385939806699753, mean p set: 0.45096486806869507
loss_pred:0.018869569525122643, decouple_loss:0.0013944223755970597
The modified gen p mean: 0.45136559009552, gen p mean: -0.12796171009540558, mean p set: 0.45194417238235474
loss_pred:0.017359288409352303, decouple_loss:0.001321970485150814
Iteration: 1065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121845602989197, gen p mean: -0.12809991836547852, mean p set: 0.45179659128189087
loss_pred:0.017732467502355576, decouple_loss:0.0017085109138861299
The modified gen p mean: 0.4494785964488983, gen p mean: -0.12995123863220215, mean p set: 0.45005589723587036
loss_pred:0.017770564183592796, decouple_loss:0.0010496738832443953
The modified gen p mean: 0.4502708613872528, gen p mean: -0.12344041466712952, mean p set: 0.45084720849990845
loss_pred:0.01766831800341606, decouple_loss:0.0011720790062099695
Iteration: 1066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483336806297302, gen p mean: -0.12620647251605988, mean p set: 0.44890692830085754
loss_pred:0.01804475113749504, decouple_loss:0.0012357697123661637
The modified gen p mean: 0.44998225569725037, gen p mean: -0.1314193606376648, mean p set: 0.4505594074726105
loss_pred:0.01759585179388523, decouple_loss:0.0010084614623337984
The modified gen p mean: 0.4515337347984314, gen p mean: -0.12081901729106903, mean p set: 0.4521104097366333
loss_pred:0.016752326861023903, decouple_loss:0.0010011030826717615
Iteration: 1067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45163828134536743, gen p mean: -0.12374166399240494, mean p set: 0.45221641659736633
loss_pred:0.01725539192557335, decouple_loss:0.0009238714701496065
The modified gen p mean: 0.45170801877975464, gen p mean: -0.11969761550426483, mean p set: 0.4522860050201416
loss_pred:0.017405010759830475, decouple_loss:0.001092544523999095
The modified gen p mean: 0.44951415061950684, gen p mean: -0.1249636635184288, mean p set: 0.4500890374183655
loss_pred:0.017974110320210457, decouple_loss:0.0009400262497365475
Iteration: 1068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499977231025696, gen p mean: -0.12497842311859131, mean p set: 0.450576514005661
loss_pred:0.016396455466747284, decouple_loss:0.0010525089455768466
The modified gen p mean: 0.4527551829814911, gen p mean: -0.12157271057367325, mean p set: 0.45333370566368103
loss_pred:0.017122754827141762, decouple_loss:0.0013969856081530452
The modified gen p mean: 0.44932591915130615, gen p mean: -0.122316375374794, mean p set: 0.44990074634552
loss_pred:0.01743774116039276, decouple_loss:0.0009770552860572934
Iteration: 1069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45208489894866943, gen p mean: -0.12406565994024277, mean p set: 0.45266276597976685
loss_pred:0.016955353319644928, decouple_loss:0.0009560901089571416
The modified gen p mean: 0.4550688862800598, gen p mean: -0.12517671287059784, mean p set: 0.45564278960227966
loss_pred:0.016892896965146065, decouple_loss:0.0011664537014439702
The modified gen p mean: 0.4496087431907654, gen p mean: -0.11906478554010391, mean p set: 0.4501844644546509
loss_pred:0.017417723312973976, decouple_loss:0.001291860593482852
Iteration: 1070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44938185811042786, gen p mean: -0.11699767410755157, mean p set: 0.44996097683906555
loss_pred:0.01694602705538273, decouple_loss:0.001148020732216537
The modified gen p mean: 0.44998857378959656, gen p mean: -0.11008106917142868, mean p set: 0.45056599378585815
loss_pred:0.0183024313300848, decouple_loss:0.0013367461506277323
The modified gen p mean: 0.45338621735572815, gen p mean: -0.11439701169729233, mean p set: 0.4539616107940674
loss_pred:0.017513293772935867, decouple_loss:0.0010580201633274555
2023-05-01 03:11:00 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12858301401138306, mean p set: 0.4502691626548767
loss_pred:0.01829378306865692, decouple_loss:0.0008382691303268075
The modified gen p mean: 0.4495362341403961, gen p mean: -0.12204193323850632, mean p set: 0.4500633478164673
loss_pred:0.017473837360739708, decouple_loss:0.0010477610630914569
The modified gen p mean: 0.4498293399810791, gen p mean: -0.12147318571805954, mean p set: 0.45035696029663086
loss_pred:0.01778806559741497, decouple_loss:0.0010997679783031344
WV_1_PC_1_EH_0_PS_40, loss: 0.01790165901184082, avg_mse: 0.02755885384976864
current test mse: 0.027559
Iteration: 1071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449297696352005, gen p mean: -0.12367372959852219, mean p set: 0.44987502694129944
loss_pred:0.017066674306988716, decouple_loss:0.0009088519727811217
The modified gen p mean: 0.4518752694129944, gen p mean: -0.1182546392083168, mean p set: 0.45245081186294556
The modified gen p mean: 0.4504357576370239, gen p mean: -0.11960377544164658, mean p set: 0.45101335644721985
loss_pred:0.017394015565514565, decouple_loss:0.0009820661507546902
loss_pred:0.017588194459676743, decouple_loss:0.001144070876762271
Iteration: 1072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508832097053528, gen p mean: -0.1186530590057373, mean p set: 0.4514580965042114
loss_pred:0.017166877165436745, decouple_loss:0.0008722679922357202
The modified gen p mean: 0.4524213671684265, gen p mean: -0.1270459145307541, mean p set: 0.45299920439720154The modified gen p mean: 0.45178669691085815, gen p mean: -0.12096380442380905, mean p set: 0.4523661732673645
loss_pred:0.016884727403521538, decouple_loss:0.0010182132245972753
loss_pred:0.017299992963671684, decouple_loss:0.000978492316789925
Iteration: 1073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533845782279968, gen p mean: -0.12404336035251617, mean p set: 0.4539635181427002
loss_pred:0.01729492098093033, decouple_loss:0.0009568702080287039
The modified gen p mean: 0.4483729600906372, gen p mean: -0.12464524060487747, mean p set: 0.4489463269710541
loss_pred:0.016961656510829926, decouple_loss:0.0012124401982873678
The modified gen p mean: 0.451156884431839, gen p mean: -0.12371247261762619, mean p set: 0.45173338055610657
loss_pred:0.016875622794032097, decouple_loss:0.0015105417696759105
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 1074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743096828460693, gen p mean: -0.1271050125360489, mean p set: 0.44800689816474915
loss_pred:0.016771702095866203, decouple_loss:0.0011158649576827884
The modified gen p mean: 0.4477403163909912, gen p mean: -0.13031534850597382, mean p set: 0.44831880927085876
loss_pred:0.01717165857553482, decouple_loss:0.001106651616282761
The modified gen p mean: 0.4472379982471466, gen p mean: -0.12328098714351654, mean p set: 0.44781461358070374
loss_pred:0.01725606992840767, decouple_loss:0.0010076059261336923
Iteration: 1075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772833585739136, gen p mean: -0.11914481222629547, mean p set: 0.4483031630516052
loss_pred:0.01724242977797985, decouple_loss:0.0013926823157817125
The modified gen p mean: 0.44806861877441406, gen p mean: -0.12089115381240845, mean p set: 0.44864311814308167
loss_pred:0.016548186540603638, decouple_loss:0.001250843983143568
The modified gen p mean: 0.44835254549980164, gen p mean: -0.12159242480993271, mean p set: 0.4489271342754364
loss_pred:0.016044756397604942, decouple_loss:0.0013867422239854932
Iteration: 1076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447367787361145, gen p mean: -0.11424573510885239, mean p set: 0.4479440450668335
loss_pred:0.016510218381881714, decouple_loss:0.0016564913094043732
The modified gen p mean: 0.4479149580001831, gen p mean: -0.11781952530145645, mean p set: 0.44848933815956116
loss_pred:0.01597672887146473, decouple_loss:0.0015345081919804215
The modified gen p mean: 0.44713443517684937, gen p mean: -0.12420471012592316, mean p set: 0.447712779045105
loss_pred:0.016541561111807823, decouple_loss:0.0012951178941875696
Iteration: 1077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448697566986084, gen p mean: -0.11534719169139862, mean p set: 0.44927188754081726
loss_pred:0.016041453927755356, decouple_loss:0.0008603609749116004
The modified gen p mean: 0.4488126039505005, gen p mean: -0.11119930446147919, mean p set: 0.44938814640045166
The modified gen p mean: 0.4472077786922455, gen p mean: -0.12002323567867279, mean p set: 0.4477825164794922
loss_pred:0.01676706224679947, decouple_loss:0.0010548357386142015
loss_pred:0.01663883961737156, decouple_loss:0.0010590445017442107
Iteration: 1078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480105936527252, gen p mean: -0.11689242720603943, mean p set: 0.44858577847480774
loss_pred:0.016145942732691765, decouple_loss:0.0012809662148356438
The modified gen p mean: 0.44773417711257935, gen p mean: -0.11054084450006485, mean p set: 0.44831034541130066
The modified gen p mean: 0.44690728187561035, gen p mean: -0.11859219521284103, mean p set: 0.44748347997665405
loss_pred:0.01696377620100975, decouple_loss:0.0011772505240514874
loss_pred:0.01610892079770565, decouple_loss:0.0011784947710111737
Iteration: 1079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771692156791687, gen p mean: -0.11994598060846329, mean p set: 0.4482938349246979
loss_pred:0.016142742708325386, decouple_loss:0.0013366470811888576
The modified gen p mean: 0.4477587938308716, gen p mean: -0.11885694414377213, mean p set: 0.4483374059200287
The modified gen p mean: 0.4480275809764862, gen p mean: -0.11993053555488586, mean p set: 0.448603093624115
loss_pred:0.015905024483799934, decouple_loss:0.0013069880660623312
loss_pred:0.01636052131652832, decouple_loss:0.0013779128203168511
Iteration: 1080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765686988830566, gen p mean: -0.1187250018119812, mean p set: 0.44823122024536133
loss_pred:0.01639454811811447, decouple_loss:0.0012356110382825136
The modified gen p mean: 0.4479253888130188, gen p mean: -0.12158297002315521, mean p set: 0.4485013484954834
The modified gen p mean: 0.4478222131729126, gen p mean: -0.12026400119066238, mean p set: 0.44839873909950256
loss_pred:0.016476908698678017, decouple_loss:0.0013121283845975995
loss_pred:0.016605526208877563, decouple_loss:0.0010700938291847706
2023-05-01 03:13:48 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12836404144763947, mean p set: 0.4502691626548767
loss_pred:0.01776539534330368, decouple_loss:0.0013178287772461772
The modified gen p mean: 0.4495352506637573, gen p mean: -0.1227709949016571, mean p set: 0.4500633478164673
loss_pred:0.017139606177806854, decouple_loss:0.0014946095179766417
The modified gen p mean: 0.4498310387134552, gen p mean: -0.12185367196798325, mean p set: 0.45035696029663086
loss_pred:0.017431071028113365, decouple_loss:0.001657386077567935
WV_1_PC_1_EH_0_PS_40, loss: 0.01751985400915146, avg_mse: 0.026983510702848434
current test mse: 0.026984
Iteration: 1081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479946494102478, gen p mean: -0.12005433440208435, mean p set: 0.44857192039489746
loss_pred:0.016716958954930305, decouple_loss:0.0014051772886887193
The modified gen p mean: 0.44775792956352234, gen p mean: -0.12235888838768005, mean p set: 0.4483359158039093The modified gen p mean: 0.4475257396697998, gen p mean: -0.12656764686107635, mean p set: 0.4481017291545868
loss_pred:0.015722664073109627, decouple_loss:0.0013596079079434276
loss_pred:0.0160153117030859, decouple_loss:0.001262978999875486
Iteration: 1082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475286602973938, gen p mean: -0.12754878401756287, mean p set: 0.44810402393341064
loss_pred:0.015606914646923542, decouple_loss:0.0008469761814922094
The modified gen p mean: 0.44811809062957764, gen p mean: -0.12220774590969086, mean p set: 0.44869464635849The modified gen p mean: 0.4469367563724518, gen p mean: -0.12668365240097046, mean p set: 0.4475124180316925
loss_pred:0.01609843224287033, decouple_loss:0.0009190530981868505
loss_pred:0.01611054688692093, decouple_loss:0.0010487622348591685
Iteration: 1083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44607147574424744, gen p mean: -0.12041173875331879, mean p set: 0.44664737582206726
loss_pred:0.01650644652545452, decouple_loss:0.0010253313230350614
The modified gen p mean: 0.44682711362838745, gen p mean: -0.12224005907773972, mean p set: 0.44740280508995056
loss_pred:0.0159634817391634, decouple_loss:0.0011568772606551647
The modified gen p mean: 0.44731032848358154, gen p mean: -0.11633989214897156, mean p set: 0.4478871822357178
loss_pred:0.0166636910289526, decouple_loss:0.0011954294750466943
Iteration: 1084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486907422542572, gen p mean: -0.12066199630498886, mean p set: 0.4492678940296173
loss_pred:0.015543978661298752, decouple_loss:0.0011311434209346771
The modified gen p mean: 0.4477170407772064, gen p mean: -0.12012569606304169, mean p set: 0.44829073548316956
loss_pred:0.01645708456635475, decouple_loss:0.001082990551367402
The modified gen p mean: 0.4473567605018616, gen p mean: -0.1227775514125824, mean p set: 0.4479339122772217
loss_pred:0.016310302540659904, decouple_loss:0.0011786408722400665
Iteration: 1085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787174463272095, gen p mean: -0.11167237907648087, mean p set: 0.4484493136405945
loss_pred:0.015426941215991974, decouple_loss:0.0007776562124490738
The modified gen p mean: 0.44862499833106995, gen p mean: -0.11587539315223694, mean p set: 0.44920313358306885
loss_pred:0.015948476269841194, decouple_loss:0.0010153285693377256
The modified gen p mean: 0.4480692446231842, gen p mean: -0.11510790884494781, mean p set: 0.44864511489868164
loss_pred:0.015672648325562477, decouple_loss:0.0009229984134435654
Iteration: 1086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476912021636963, gen p mean: -0.11398395895957947, mean p set: 0.4482678174972534
loss_pred:0.015864117071032524, decouple_loss:0.0012535074492916465
The modified gen p mean: 0.4466691017150879, gen p mean: -0.1128707006573677, mean p set: 0.44724538922309875
loss_pred:0.016431273892521858, decouple_loss:0.001112519996240735
The modified gen p mean: 0.4470575749874115, gen p mean: -0.10881000757217407, mean p set: 0.4476318955421448
loss_pred:0.016690893098711967, decouple_loss:0.0010389122180640697
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481433928012848, gen p mean: -0.11617684364318848, mean p set: 0.44871973991394043
loss_pred:0.016112007200717926, decouple_loss:0.0010587506694719195
The modified gen p mean: 0.4481813311576843, gen p mean: -0.1085042804479599, mean p set: 0.4487583637237549
loss_pred:0.01604572683572769, decouple_loss:0.0008122953004203737
The modified gen p mean: 0.4481106400489807, gen p mean: -0.11314726620912552, mean p set: 0.4486865699291229
loss_pred:0.01577332615852356, decouple_loss:0.000918022298719734
Iteration: 1088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478183388710022, gen p mean: -0.11404518783092499, mean p set: 0.4483935534954071
loss_pred:0.015474805608391762, decouple_loss:0.0011380967916920781
The modified gen p mean: 0.4479294717311859, gen p mean: -0.11061368882656097, mean p set: 0.44850432872772217
loss_pred:0.015545275062322617, decouple_loss:0.0009177319006994367
The modified gen p mean: 0.4473160207271576, gen p mean: -0.10622867941856384, mean p set: 0.447892427444458
loss_pred:0.01615956611931324, decouple_loss:0.0010001047048717737
Iteration: 1089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482254087924957, gen p mean: -0.10712958872318268, mean p set: 0.4488029479980469
loss_pred:0.015407754108309746, decouple_loss:0.0009057582356035709
The modified gen p mean: 0.44853872060775757, gen p mean: -0.1069437563419342, mean p set: 0.44911372661590576
The modified gen p mean: 0.44866201281547546, gen p mean: -0.10666561126708984, mean p set: 0.4492388963699341
loss_pred:0.01575521007180214, decouple_loss:0.0010540588991716504
loss_pred:0.015572981908917427, decouple_loss:0.0011281064944341779
Iteration: 1090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44843414425849915, gen p mean: -0.10956720262765884, mean p set: 0.4490111172199249
loss_pred:0.015318099409341812, decouple_loss:0.0007459568441845477
The modified gen p mean: 0.44726163148880005, gen p mean: -0.11310514807701111, mean p set: 0.4478394687175751
loss_pred:0.01610003598034382, decouple_loss:0.0007978875073604286
The modified gen p mean: 0.448215514421463, gen p mean: -0.11042508482933044, mean p set: 0.44878846406936646
loss_pred:0.015238624997437, decouple_loss:0.0008264437201432884
2023-05-01 03:15:55 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11639086157083511, mean p set: 0.4502691626548767
loss_pred:0.01756400614976883, decouple_loss:0.0016477862372994423
The modified gen p mean: 0.44953611493110657, gen p mean: -0.11139559745788574, mean p set: 0.4500633478164673
loss_pred:0.01695866882801056, decouple_loss:0.0014038662193343043
The modified gen p mean: 0.4498286545276642, gen p mean: -0.11075093597173691, mean p set: 0.45035696029663086
loss_pred:0.01723162829875946, decouple_loss:0.0016705140005797148
WV_1_PC_1_EH_0_PS_40, loss: 0.017330138012766838, avg_mse: 0.026801822707057
current test mse: 0.026802
Iteration: 1091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480222463607788, gen p mean: -0.11585791409015656, mean p set: 0.4485968351364136
loss_pred:0.015279337763786316, decouple_loss:0.0013568985741585493
The modified gen p mean: 0.4481493830680847, gen p mean: -0.10972078144550323, mean p set: 0.44872552156448364
loss_pred:0.01611369103193283, decouple_loss:0.0014926648000255227
The modified gen p mean: 0.44878628849983215, gen p mean: -0.11581477522850037, mean p set: 0.44936102628707886
loss_pred:0.015041754581034184, decouple_loss:0.001267243642359972
Iteration: 1092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464736580848694, gen p mean: -0.11525002866983414, mean p set: 0.4470512866973877
loss_pred:0.01590154320001602, decouple_loss:0.0010074620367959142
The modified gen p mean: 0.4462774693965912, gen p mean: -0.11560752242803574, mean p set: 0.44685330986976624The modified gen p mean: 0.4481280446052551, gen p mean: -0.10860806703567505, mean p set: 0.44870471954345703
loss_pred:0.01608581468462944, decouple_loss:0.001036005443893373
loss_pred:0.01602637767791748, decouple_loss:0.001057298039086163
Iteration: 1093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477604627609253, gen p mean: -0.10970158874988556, mean p set: 0.448335200548172
loss_pred:0.01527758501470089, decouple_loss:0.0011415383778512478
The modified gen p mean: 0.44787973165512085, gen p mean: -0.10773804783821106, mean p set: 0.44845762848854065
loss_pred:0.015220706351101398, decouple_loss:0.0009705655393190682
The modified gen p mean: 0.44786134362220764, gen p mean: -0.10880175977945328, mean p set: 0.4484356641769409
loss_pred:0.015829239040613174, decouple_loss:0.0011811599833890796
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 1094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44914475083351135, gen p mean: -0.10249601304531097, mean p set: 0.44971972703933716
loss_pred:0.015642955899238586, decouple_loss:0.000893095915671438
The modified gen p mean: 0.4486983120441437, gen p mean: -0.10189857333898544, mean p set: 0.44927287101745605
loss_pred:0.01629619672894478, decouple_loss:0.0011201055021956563
The modified gen p mean: 0.44939151406288147, gen p mean: -0.10349296778440475, mean p set: 0.44996556639671326
loss_pred:0.01568465307354927, decouple_loss:0.000944928266108036
Iteration: 1095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44944092631340027, gen p mean: -0.10286076366901398, mean p set: 0.4500153958797455
loss_pred:0.015025805681943893, decouple_loss:0.0008576998952776194
The modified gen p mean: 0.44841790199279785, gen p mean: -0.10255397111177444, mean p set: 0.4489958584308624
loss_pred:0.015957731753587723, decouple_loss:0.0009103575721383095
The modified gen p mean: 0.44843143224716187, gen p mean: -0.10967575013637543, mean p set: 0.4490082263946533
loss_pred:0.015587360598146915, decouple_loss:0.00117836007848382
Iteration: 1096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479312598705292, gen p mean: -0.10849549621343613, mean p set: 0.44850850105285645
loss_pred:0.015205474570393562, decouple_loss:0.0010531505104154348
The modified gen p mean: 0.44935548305511475, gen p mean: -0.10712803900241852, mean p set: 0.4499303698539734
loss_pred:0.016626104712486267, decouple_loss:0.000988028827123344
The modified gen p mean: 0.44997021555900574, gen p mean: -0.09743276238441467, mean p set: 0.45054665207862854
loss_pred:0.015615391544997692, decouple_loss:0.001132254023104906
Iteration: 1097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482994079589844, gen p mean: -0.10041956603527069, mean p set: 0.4488753378391266
loss_pred:0.016155894845724106, decouple_loss:0.0015469022328034043
The modified gen p mean: 0.4491868019104004, gen p mean: -0.09935660660266876, mean p set: 0.4497624933719635
loss_pred:0.01583017408847809, decouple_loss:0.001437713741324842
The modified gen p mean: 0.44841888546943665, gen p mean: -0.10463819652795792, mean p set: 0.44899484515190125
loss_pred:0.01702144928276539, decouple_loss:0.0014074266655370593
Iteration: 1098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973090291023254, gen p mean: -0.10583527386188507, mean p set: 0.4503089487552643
loss_pred:0.015138482674956322, decouple_loss:0.0008376507321372628
The modified gen p mean: 0.449005126953125, gen p mean: -0.1076894998550415, mean p set: 0.4495806396007538
loss_pred:0.01493243221193552, decouple_loss:0.0008492093766108155
The modified gen p mean: 0.4505956172943115, gen p mean: -0.09874308109283447, mean p set: 0.451172411441803
loss_pred:0.01576930657029152, decouple_loss:0.0009833351941779256
Iteration: 1099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859573245048523, gen p mean: -0.10603998601436615, mean p set: 0.4491713047027588
loss_pred:0.016135087236762047, decouple_loss:0.0009240228100679815
The modified gen p mean: 0.44906753301620483, gen p mean: -0.10159701853990555, mean p set: 0.44964277744293213
The modified gen p mean: 0.4477684795856476, gen p mean: -0.10811438411474228, mean p set: 0.44834738969802856
loss_pred:0.01588691957294941, decouple_loss:0.0010533255990594625
loss_pred:0.015354025177657604, decouple_loss:0.0009427848854102194
Iteration: 1100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852644205093384, gen p mean: -0.10926154255867004, mean p set: 0.44910159707069397
loss_pred:0.015693943947553635, decouple_loss:0.001173073542304337
The modified gen p mean: 0.44775038957595825, gen p mean: -0.11572300642728806, mean p set: 0.44832560420036316
loss_pred:0.015563654713332653, decouple_loss:0.0011935214279219508
The modified gen p mean: 0.44890663027763367, gen p mean: -0.11383827030658722, mean p set: 0.4494836926460266
loss_pred:0.015607612207531929, decouple_loss:0.0011388409184291959
2023-05-01 03:18:39 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11096276342868805, mean p set: 0.4502691626548767
loss_pred:0.017389103770256042, decouple_loss:0.0009565158979967237
The modified gen p mean: 0.4495350122451782, gen p mean: -0.1059359535574913, mean p set: 0.4500633478164673
loss_pred:0.016797732561826706, decouple_loss:0.0009007980115711689
The modified gen p mean: 0.4498288333415985, gen p mean: -0.10512150824069977, mean p set: 0.45035696029663086
loss_pred:0.017154192551970482, decouple_loss:0.0009011565707623959
WV_1_PC_1_EH_0_PS_40, loss: 0.017159651964902878, avg_mse: 0.026591887697577477
current test mse: 0.026592
At step 1100, Best test: 0.026592
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 1101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44883379340171814, gen p mean: -0.0984223335981369, mean p set: 0.44941237568855286
loss_pred:0.01584744267165661, decouple_loss:0.0009723635157570243
The modified gen p mean: 0.4484409987926483, gen p mean: -0.10040034353733063, mean p set: 0.44901344180107117
loss_pred:0.015737775713205338, decouple_loss:0.0007477743201889098
The modified gen p mean: 0.44946596026420593, gen p mean: -0.10423841327428818, mean p set: 0.45004376769065857
loss_pred:0.014386319555342197, decouple_loss:0.0007225609151646495
Iteration: 1102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44912466406822205, gen p mean: -0.10005402565002441, mean p set: 0.4496983587741852
loss_pred:0.016053754836320877, decouple_loss:0.0009806748712435365
The modified gen p mean: 0.448660671710968, gen p mean: -0.10706249624490738, mean p set: 0.449236124753952The modified gen p mean: 0.4509636461734772, gen p mean: -0.0976540744304657, mean p set: 0.4515393376350403
loss_pred:0.015532925724983215, decouple_loss:0.0008290060213766992loss_pred:0.01559168379753828, decouple_loss:0.0010946736438199878
Iteration: 1103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813597202301025, gen p mean: -0.0995878055691719, mean p set: 0.4487136900424957
loss_pred:0.016130734235048294, decouple_loss:0.0010699982522055507
The modified gen p mean: 0.4478321671485901, gen p mean: -0.09678981453180313, mean p set: 0.4484051764011383The modified gen p mean: 0.44824716448783875, gen p mean: -0.09747307002544403, mean p set: 0.4488248825073242
loss_pred:0.015511518344283104, decouple_loss:0.001033688778989017
loss_pred:0.01570035144686699, decouple_loss:0.0010718231787905097
Iteration: 1104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489111602306366, gen p mean: -0.10036037117242813, mean p set: 0.4494885504245758
loss_pred:0.01638179086148739, decouple_loss:0.0010144903790205717
The modified gen p mean: 0.449521541595459, gen p mean: -0.10466944426298141, mean p set: 0.4500974118709564
loss_pred:0.015187508426606655, decouple_loss:0.0010606406722217798
The modified gen p mean: 0.4485240876674652, gen p mean: -0.09494869410991669, mean p set: 0.44910016655921936
loss_pred:0.01598196104168892, decouple_loss:0.0012096132850274444
Iteration: 1105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44921258091926575, gen p mean: -0.09622302651405334, mean p set: 0.4497894048690796
loss_pred:0.015243379399180412, decouple_loss:0.0009600272751413286
The modified gen p mean: 0.4489748179912567, gen p mean: -0.10222557187080383, mean p set: 0.4495515525341034
loss_pred:0.015387417748570442, decouple_loss:0.000815725652500987
The modified gen p mean: 0.4492844045162201, gen p mean: -0.09400197118520737, mean p set: 0.44986000657081604
loss_pred:0.015412071719765663, decouple_loss:0.0012267599813640118
Iteration: 1106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935300946235657, gen p mean: -0.09870035946369171, mean p set: 0.4499305486679077
loss_pred:0.015060589648783207, decouple_loss:0.0009338819072581828
The modified gen p mean: 0.4481787085533142, gen p mean: -0.10424614697694778, mean p set: 0.4487546384334564
The modified gen p mean: 0.4498283267021179, gen p mean: -0.10098657011985779, mean p set: 0.4504038989543915
loss_pred:0.015999693423509598, decouple_loss:0.0011980222770944238
loss_pred:0.015156743116676807, decouple_loss:0.001144350040704012
Iteration: 1107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44920095801353455, gen p mean: -0.09354881942272186, mean p set: 0.44977647066116333
loss_pred:0.015209325589239597, decouple_loss:0.0011945944279432297
The modified gen p mean: 0.4474639296531677, gen p mean: -0.10391800850629807, mean p set: 0.4480412006378174
The modified gen p mean: 0.44784796237945557, gen p mean: -0.09912432730197906, mean p set: 0.44842392206192017
loss_pred:0.015807384625077248, decouple_loss:0.0008503258577547967
loss_pred:0.015402630902826786, decouple_loss:0.0007375003187917173
Iteration: 1108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481354355812073, gen p mean: -0.09951182454824448, mean p set: 0.44871246814727783
loss_pred:0.015872647985816002, decouple_loss:0.00089515425497666
The modified gen p mean: 0.45001569390296936, gen p mean: -0.10062471777200699, mean p set: 0.45059165358543396
loss_pred:0.015590469352900982, decouple_loss:0.0010156609350815415
The modified gen p mean: 0.4483961760997772, gen p mean: -0.09581615030765533, mean p set: 0.44897210597991943
loss_pred:0.015623181127011776, decouple_loss:0.000840173801407218
Iteration: 1109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497329592704773, gen p mean: -0.09442141652107239, mean p set: 0.450310081243515
loss_pred:0.015408510342240334, decouple_loss:0.0010720891878008842
The modified gen p mean: 0.44933614134788513, gen p mean: -0.10157220810651779, mean p set: 0.44991445541381836
loss_pred:0.015541295520961285, decouple_loss:0.000978452735580504
The modified gen p mean: 0.44771531224250793, gen p mean: -0.10205893218517303, mean p set: 0.44829061627388
loss_pred:0.015513784252107143, decouple_loss:0.0012067139614373446
Iteration: 1110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945964217185974, gen p mean: -0.09974709898233414, mean p set: 0.45003435015678406
loss_pred:0.015163901261985302, decouple_loss:0.001188369351439178
The modified gen p mean: 0.44778209924697876, gen p mean: -0.10445169359445572, mean p set: 0.4483579099178314
loss_pred:0.014563573524355888, decouple_loss:0.0010203570127487183
The modified gen p mean: 0.4487614929676056, gen p mean: -0.10518080741167068, mean p set: 0.44933852553367615
loss_pred:0.015240251086652279, decouple_loss:0.0010942325461655855
2023-05-01 03:20:49 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11143648624420166, mean p set: 0.4502691626548767
loss_pred:0.017402408644557, decouple_loss:0.0008831373997963965
The modified gen p mean: 0.44953596591949463, gen p mean: -0.10647186636924744, mean p set: 0.4500633478164673
loss_pred:0.016750840470194817, decouple_loss:0.001133122481405735
The modified gen p mean: 0.44982829689979553, gen p mean: -0.10558514297008514, mean p set: 0.45035696029663086
loss_pred:0.01706424169242382, decouple_loss:0.0009778814855962992
WV_1_PC_1_EH_0_PS_40, loss: 0.017122400924563408, avg_mse: 0.02658756636083126
current test mse: 0.026588
At step 1110, Best test: 0.026588
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 1111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479129910469055, gen p mean: -0.10673141479492188, mean p set: 0.44848892092704773
loss_pred:0.015849439427256584, decouple_loss:0.0009925825288519263
The modified gen p mean: 0.44799795746803284, gen p mean: -0.10243610292673111, mean p set: 0.4485754370689392
loss_pred:0.015695776790380478, decouple_loss:0.0013915800955146551
The modified gen p mean: 0.4486970007419586, gen p mean: -0.10517960786819458, mean p set: 0.4492739737033844
loss_pred:0.015755893662571907, decouple_loss:0.0010128485737368464
Iteration: 1112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489162266254425, gen p mean: -0.09856029599905014, mean p set: 0.4494929015636444
The modified gen p mean: 0.4488047957420349, gen p mean: -0.10511758178472519, mean p set: 0.4493807256221771loss_pred:0.015513534657657146, decouple_loss:0.0012524697231128812
loss_pred:0.015160638839006424, decouple_loss:0.0014116844395175576
The modified gen p mean: 0.4499446451663971, gen p mean: -0.10430093109607697, mean p set: 0.450520396232605
loss_pred:0.015140640549361706, decouple_loss:0.0011341845383867621
Iteration: 1113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787004590034485, gen p mean: -0.11061512678861618, mean p set: 0.4484458863735199
loss_pred:0.015239300206303596, decouple_loss:0.0007170746685005724
The modified gen p mean: 0.44877949357032776, gen p mean: -0.11217999458312988, mean p set: 0.4493550956249237
loss_pred:0.01517755351960659, decouple_loss:0.0008204779005609453
The modified gen p mean: 0.4489400386810303, gen p mean: -0.10308845341205597, mean p set: 0.4495154023170471
loss_pred:0.014958602376282215, decouple_loss:0.0007284341845661402
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
NaN value num: 0
Iteration: 1114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451499879360199, gen p mean: -0.09761213511228561, mean p set: 0.45207569003105164
loss_pred:0.016476381570100784, decouple_loss:0.0010437672026455402
The modified gen p mean: 0.4502173662185669, gen p mean: -0.09906172007322311, mean p set: 0.4507932960987091
loss_pred:0.016735253855586052, decouple_loss:0.0009482245659455657
The modified gen p mean: 0.449982613325119, gen p mean: -0.10136934369802475, mean p set: 0.45055902004241943
loss_pred:0.01717991940677166, decouple_loss:0.0008890144526958466
Iteration: 1115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508083164691925, gen p mean: -0.09450458735227585, mean p set: 0.4513859152793884
loss_pred:0.016914011910557747, decouple_loss:0.0009446407202631235
The modified gen p mean: 0.4500787854194641, gen p mean: -0.09806361049413681, mean p set: 0.4506555497646332
loss_pred:0.016275595873594284, decouple_loss:0.0009376867674291134
The modified gen p mean: 0.4509880840778351, gen p mean: -0.09772535413503647, mean p set: 0.45156341791152954
loss_pred:0.01635800302028656, decouple_loss:0.0010039531625807285
Iteration: 1116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491089880466461, gen p mean: -0.10074178129434586, mean p set: 0.44968703389167786
loss_pred:0.016752716153860092, decouple_loss:0.0008831272716633976
The modified gen p mean: 0.45260557532310486, gen p mean: -0.09646744281053543, mean p set: 0.45318400859832764
The modified gen p mean: 0.450322687625885, gen p mean: -0.09696775674819946, mean p set: 0.4508971571922302
loss_pred:0.01777702197432518, decouple_loss:0.0011395304463803768
loss_pred:0.01748085953295231, decouple_loss:0.0009398380061611533
Iteration: 1117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452041894197464, gen p mean: -0.10348714143037796, mean p set: 0.45262065529823303
loss_pred:0.01750968024134636, decouple_loss:0.0008371398434974253
The modified gen p mean: 0.4501265585422516, gen p mean: -0.09738659858703613, mean p set: 0.4507034122943878
The modified gen p mean: 0.45315665006637573, gen p mean: -0.09953048080205917, mean p set: 0.4537335932254791
loss_pred:0.01636156253516674, decouple_loss:0.0006965992506593466
loss_pred:0.01700112782418728, decouple_loss:0.0008400889346376061
Iteration: 1118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44942089915275574, gen p mean: -0.09397288411855698, mean p set: 0.44999685883522034
loss_pred:0.016040802001953125, decouple_loss:0.0009096037247218192
The modified gen p mean: 0.44987359642982483, gen p mean: -0.09480664134025574, mean p set: 0.4504503011703491
loss_pred:0.01677863672375679, decouple_loss:0.0008172399830073118
The modified gen p mean: 0.4499070942401886, gen p mean: -0.09641654044389725, mean p set: 0.4504829943180084
loss_pred:0.015561466105282307, decouple_loss:0.000889558345079422
Iteration: 1119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499639868736267, gen p mean: -0.09140177816152573, mean p set: 0.45054012537002563
loss_pred:0.01726999692618847, decouple_loss:0.0009020916186273098
The modified gen p mean: 0.45167118310928345, gen p mean: -0.08686523884534836, mean p set: 0.4522497057914734
The modified gen p mean: 0.45033344626426697, gen p mean: -0.09190605580806732, mean p set: 0.4509105384349823
loss_pred:0.016776826232671738, decouple_loss:0.0011992884101346135
loss_pred:0.0168317724019289, decouple_loss:0.0008590812212787569
Iteration: 1120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45014628767967224, gen p mean: -0.08925752341747284, mean p set: 0.45072323083877563
loss_pred:0.016150441020727158, decouple_loss:0.0008854303741827607
The modified gen p mean: 0.44955649971961975, gen p mean: -0.09473966807126999, mean p set: 0.4501340985298157
loss_pred:0.016753287985920906, decouple_loss:0.0012150593101978302
The modified gen p mean: 0.4503452777862549, gen p mean: -0.09209232032299042, mean p set: 0.4509201943874359
loss_pred:0.016748614609241486, decouple_loss:0.000704775913618505
2023-05-01 03:23:41 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1020660251379013, mean p set: 0.4502691626548767
loss_pred:0.017601944506168365, decouple_loss:0.0012804981088265777
The modified gen p mean: 0.44953539967536926, gen p mean: -0.0961257591843605, mean p set: 0.4500633478164673
loss_pred:0.01696072518825531, decouple_loss:0.0012110368115827441
The modified gen p mean: 0.4498246908187866, gen p mean: -0.09537814557552338, mean p set: 0.45035696029663086
loss_pred:0.017169944941997528, decouple_loss:0.0010868646204471588
WV_1_PC_1_EH_0_PS_40, loss: 0.017303844913840294, avg_mse: 0.026816224679350853
current test mse: 0.026816
Iteration: 1121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048463344573975, gen p mean: -0.08833781629800797, mean p set: 0.4510606527328491
loss_pred:0.016633611172437668, decouple_loss:0.0009342143312096596
The modified gen p mean: 0.45289742946624756, gen p mean: -0.09159768372774124, mean p set: 0.45347464084625244
loss_pred:0.016907522454857826, decouple_loss:0.001034799381159246
The modified gen p mean: 0.44998064637184143, gen p mean: -0.090395487844944, mean p set: 0.4505563974380493
loss_pred:0.01744447648525238, decouple_loss:0.001050845836289227
Iteration: 1122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449307918548584, gen p mean: -0.09164907038211823, mean p set: 0.4498852789402008
The modified gen p mean: 0.45133858919143677, gen p mean: -0.09555944055318832, mean p set: 0.4519140422344208
loss_pred:0.0175603237003088, decouple_loss:0.001005239668302238
loss_pred:0.01712091453373432, decouple_loss:0.0010094837052747607
The modified gen p mean: 0.44925594329833984, gen p mean: -0.08949984610080719, mean p set: 0.44983193278312683
loss_pred:0.017782006412744522, decouple_loss:0.0008881796966306865
Iteration: 1123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525292217731476, gen p mean: -0.0931713730096817, mean p set: 0.4531055688858032
loss_pred:0.017206458374857903, decouple_loss:0.0008535530650988221
The modified gen p mean: 0.45249563455581665, gen p mean: -0.1001766175031662, mean p set: 0.4530709385871887
The modified gen p mean: 0.4528237283229828, gen p mean: -0.09236131608486176, mean p set: 0.45340150594711304
loss_pred:0.016544383019208908, decouple_loss:0.000766223412938416
loss_pred:0.016388872638344765, decouple_loss:0.0008795750909484923
Iteration: 1124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45027533173561096, gen p mean: -0.09302052855491638, mean p set: 0.4508511424064636
loss_pred:0.016324730589985847, decouple_loss:0.00081324961502105
The modified gen p mean: 0.44993147253990173, gen p mean: -0.0869268849492073, mean p set: 0.4505070447921753
loss_pred:0.017384346574544907, decouple_loss:0.0008919829269871116
The modified gen p mean: 0.4504474699497223, gen p mean: -0.09552710503339767, mean p set: 0.4510236978530884
loss_pred:0.01658056490123272, decouple_loss:0.0007893220172263682
Iteration: 1125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496942162513733, gen p mean: -0.08872879296541214, mean p set: 0.4502705931663513
loss_pred:0.0163588784635067, decouple_loss:0.0008537658140994608
The modified gen p mean: 0.451334148645401, gen p mean: -0.09246013313531876, mean p set: 0.45191025733947754
loss_pred:0.01688534766435623, decouple_loss:0.0010150581365451217
The modified gen p mean: 0.4512861371040344, gen p mean: -0.09613547474145889, mean p set: 0.45186319947242737
loss_pred:0.016936805099248886, decouple_loss:0.0012534488923847675
Iteration: 1126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506751298904419, gen p mean: -0.08749214559793472, mean p set: 0.4512505531311035
loss_pred:0.017379242926836014, decouple_loss:0.0007888497202657163
The modified gen p mean: 0.4519707262516022, gen p mean: -0.09464696794748306, mean p set: 0.4525485932826996
loss_pred:0.016720423474907875, decouple_loss:0.0008351165452040732
The modified gen p mean: 0.4506757855415344, gen p mean: -0.09371469169855118, mean p set: 0.45125120878219604
loss_pred:0.016223527491092682, decouple_loss:0.0008037021616473794
Iteration: 1127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059192180633545, gen p mean: -0.10295354574918747, mean p set: 0.4511701166629791
loss_pred:0.01687902770936489, decouple_loss:0.0009622963261790574
The modified gen p mean: 0.4495091438293457, gen p mean: -0.10052359849214554, mean p set: 0.45008277893066406
loss_pred:0.016890088096261024, decouple_loss:0.0009045990300364792
The modified gen p mean: 0.45034027099609375, gen p mean: -0.10599088668823242, mean p set: 0.4509181082248688
loss_pred:0.016203459352254868, decouple_loss:0.0008756120805628598
Iteration: 1128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45182591676712036, gen p mean: -0.09480039030313492, mean p set: 0.4524039626121521
loss_pred:0.01656646840274334, decouple_loss:0.0008734636357985437
The modified gen p mean: 0.4498651921749115, gen p mean: -0.0898803249001503, mean p set: 0.450441837310791
The modified gen p mean: 0.4505253732204437, gen p mean: -0.09331666678190231, mean p set: 0.45110225677490234
loss_pred:0.01639522984623909, decouple_loss:0.0007561338134109974
loss_pred:0.017001694068312645, decouple_loss:0.0007330835214816034
Iteration: 1129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512993395328522, gen p mean: -0.09798730164766312, mean p set: 0.45187634229660034
loss_pred:0.0164115522056818, decouple_loss:0.0007159194792620838
The modified gen p mean: 0.4493611454963684, gen p mean: -0.09766888618469238, mean p set: 0.449937105178833
The modified gen p mean: 0.452541708946228, gen p mean: -0.09709111601114273, mean p set: 0.45311927795410156
loss_pred:0.01564105786383152, decouple_loss:0.0016076529864221811
loss_pred:0.016467014327645302, decouple_loss:0.001160850515589118
Iteration: 1130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531603157520294, gen p mean: -0.09545291215181351, mean p set: 0.4537356197834015
loss_pred:0.01636379025876522, decouple_loss:0.001129665644839406
The modified gen p mean: 0.45009884238243103, gen p mean: -0.09903702884912491, mean p set: 0.45067504048347473
loss_pred:0.01649138517677784, decouple_loss:0.0010023250943049788
The modified gen p mean: 0.4503611922264099, gen p mean: -0.1008259579539299, mean p set: 0.450937420129776
loss_pred:0.016987303271889687, decouple_loss:0.001216285745613277
2023-05-01 03:25:47 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11223676800727844, mean p set: 0.4502691626548767
loss_pred:0.017570551484823227, decouple_loss:0.0009208666160702705
The modified gen p mean: 0.4495350122451782, gen p mean: -0.10620082169771194, mean p set: 0.4500633478164673
loss_pred:0.016942903399467468, decouple_loss:0.00105659116525203
The modified gen p mean: 0.4498298764228821, gen p mean: -0.10500787198543549, mean p set: 0.45035696029663086
loss_pred:0.01724236272275448, decouple_loss:0.0009599594050087035
WV_1_PC_1_EH_0_PS_40, loss: 0.01730089634656906, avg_mse: 0.02680205926299095
current test mse: 0.026802
Iteration: 1131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45122599601745605, gen p mean: -0.10449478030204773, mean p set: 0.4518035352230072
loss_pred:0.016360143199563026, decouple_loss:0.0008480332908220589
The modified gen p mean: 0.4490564465522766, gen p mean: -0.10226207971572876, mean p set: 0.44963446259498596
loss_pred:0.016434915363788605, decouple_loss:0.0015087710926309228
The modified gen p mean: 0.44912189245224, gen p mean: -0.10186851769685745, mean p set: 0.4496982991695404
loss_pred:0.015707533806562424, decouple_loss:0.0013882073108106852
Iteration: 1132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504043757915497, gen p mean: -0.10073626041412354, mean p set: 0.45097947120666504
The modified gen p mean: 0.4525245726108551, gen p mean: -0.10243529826402664, mean p set: 0.45309871435165405
loss_pred:0.017145898193120956, decouple_loss:0.0009401320130564272
loss_pred:0.016661474481225014, decouple_loss:0.0011173718376085162
The modified gen p mean: 0.4501054584980011, gen p mean: -0.10408300906419754, mean p set: 0.45068085193634033
loss_pred:0.015839258208870888, decouple_loss:0.0012774976203218102
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
NaN value num: 0
Iteration: 1133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496036171913147, gen p mean: -0.1088285744190216, mean p set: 0.4501812756061554
loss_pred:0.0187893845140934, decouple_loss:0.001212088973261416
The modified gen p mean: 0.44986146688461304, gen p mean: -0.10937400162220001, mean p set: 0.45043838024139404
The modified gen p mean: 0.4493691325187683, gen p mean: -0.11014869064092636, mean p set: 0.4499465525150299
loss_pred:0.017337361350655556, decouple_loss:0.0013991653686389327
loss_pred:0.01741229183971882, decouple_loss:0.0012088512303307652
Iteration: 1134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781529903411865, gen p mean: -0.10198649764060974, mean p set: 0.4483890235424042
loss_pred:0.0183273758739233, decouple_loss:0.0011171012884005904
The modified gen p mean: 0.4496529996395111, gen p mean: -0.10355307906866074, mean p set: 0.4502294957637787
loss_pred:0.018489258363842964, decouple_loss:0.0011484469287097454
The modified gen p mean: 0.44871628284454346, gen p mean: -0.1021527424454689, mean p set: 0.44929149746894836
loss_pred:0.018923280760645866, decouple_loss:0.0009582129423506558
Iteration: 1135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862955808639526, gen p mean: -0.11601283401250839, mean p set: 0.44920605421066284
loss_pred:0.018329286947846413, decouple_loss:0.0009885331382974982
The modified gen p mean: 0.449552059173584, gen p mean: -0.1125229150056839, mean p set: 0.4501313269138336
loss_pred:0.017629846930503845, decouple_loss:0.000955364084802568
The modified gen p mean: 0.44844678044319153, gen p mean: -0.1108841672539711, mean p set: 0.44902318716049194
loss_pred:0.017728157341480255, decouple_loss:0.001004702178761363
Iteration: 1136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497559368610382, gen p mean: -0.09954209625720978, mean p set: 0.45033130049705505
loss_pred:0.01783980242908001, decouple_loss:0.0013423935743048787
The modified gen p mean: 0.4488486051559448, gen p mean: -0.10534972697496414, mean p set: 0.4494244158267975
The modified gen p mean: 0.4489746689796448, gen p mean: -0.10450195521116257, mean p set: 0.4495510160923004
loss_pred:0.016941800713539124, decouple_loss:0.0013592350296676159
loss_pred:0.019060054793953896, decouple_loss:0.0009844134328886867
Iteration: 1137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44936245679855347, gen p mean: -0.10289686918258667, mean p set: 0.4499370753765106
loss_pred:0.018277764320373535, decouple_loss:0.0010031128767877817
The modified gen p mean: 0.45018652081489563, gen p mean: -0.10843922942876816, mean p set: 0.4507625102996826
The modified gen p mean: 0.44911110401153564, gen p mean: -0.10847415775060654, mean p set: 0.4496876895427704
loss_pred:0.018171118572354317, decouple_loss:0.0014574301894754171
loss_pred:0.018187668174505234, decouple_loss:0.0009454320534132421
Iteration: 1138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496331810951233, gen p mean: -0.11616690456867218, mean p set: 0.45020923018455505
loss_pred:0.017797434702515602, decouple_loss:0.0010309773497283459
The modified gen p mean: 0.44860759377479553, gen p mean: -0.11497434228658676, mean p set: 0.4491855800151825
loss_pred:0.017820507287979126, decouple_loss:0.001171759911812842
The modified gen p mean: 0.44979602098464966, gen p mean: -0.11167199909687042, mean p set: 0.4503738284111023
loss_pred:0.017215589061379433, decouple_loss:0.000805399555247277
Iteration: 1139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947582483291626, gen p mean: -0.11341039836406708, mean p set: 0.4500521421432495
loss_pred:0.016899198293685913, decouple_loss:0.0010786036727949977
The modified gen p mean: 0.4493826925754547, gen p mean: -0.10965127497911453, mean p set: 0.44995957612991333
loss_pred:0.017498211935162544, decouple_loss:0.001033672597259283
The modified gen p mean: 0.4493842124938965, gen p mean: -0.1127316951751709, mean p set: 0.4499610364437103
loss_pred:0.018348732963204384, decouple_loss:0.0009506373316980898
Iteration: 1140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816070795059204, gen p mean: -0.11075164377689362, mean p set: 0.4487350583076477
loss_pred:0.017547516152262688, decouple_loss:0.000922170642297715
The modified gen p mean: 0.44890260696411133, gen p mean: -0.1139153465628624, mean p set: 0.4494764804840088
The modified gen p mean: 0.44989675283432007, gen p mean: -0.10814463347196579, mean p set: 0.4504740536212921
loss_pred:0.01819070614874363, decouple_loss:0.000806450261734426
loss_pred:0.01714562438428402, decouple_loss:0.0010772430105134845
2023-05-01 03:28:36 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12664258480072021, mean p set: 0.4502691626548767
loss_pred:0.017520802095532417, decouple_loss:0.0010787000646814704
The modified gen p mean: 0.4495365619659424, gen p mean: -0.12078849226236343, mean p set: 0.4500633478164673
loss_pred:0.017044194042682648, decouple_loss:0.0010180736426264048
The modified gen p mean: 0.44983020424842834, gen p mean: -0.11959944665431976, mean p set: 0.45035696029663086
loss_pred:0.017168382182717323, decouple_loss:0.0009281066013500094
WV_1_PC_1_EH_0_PS_40, loss: 0.017294874414801598, avg_mse: 0.026820683851838112
current test mse: 0.026821
Iteration: 1141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500790536403656, gen p mean: -0.11699477583169937, mean p set: 0.4506526291370392
loss_pred:0.018230458721518517, decouple_loss:0.0010675807716324925
The modified gen p mean: 0.44817525148391724, gen p mean: -0.11826346069574356, mean p set: 0.44875091314315796
loss_pred:0.017530718818306923, decouple_loss:0.001114108134061098
The modified gen p mean: 0.44854629039764404, gen p mean: -0.12032537162303925, mean p set: 0.4491247832775116
loss_pred:0.01821991801261902, decouple_loss:0.0008219352457672358
Iteration: 1142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494979679584503, gen p mean: -0.11515388637781143, mean p set: 0.4500735104084015
The modified gen p mean: 0.4486762583255768, gen p mean: -0.1075807511806488, mean p set: 0.44925227761268616
loss_pred:0.01764923706650734, decouple_loss:0.0007698397967033088
loss_pred:0.01770593225955963, decouple_loss:0.0010443736100569367
The modified gen p mean: 0.4491305649280548, gen p mean: -0.11078081279993057, mean p set: 0.4497062563896179
loss_pred:0.017669672146439552, decouple_loss:0.0010059865890070796
Iteration: 1143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44908368587493896, gen p mean: -0.10995364189147949, mean p set: 0.44966015219688416
loss_pred:0.017859211191534996, decouple_loss:0.0013227916788309813
The modified gen p mean: 0.4487819969654083, gen p mean: -0.10771219432353973, mean p set: 0.4493584930896759
loss_pred:0.018595699220895767, decouple_loss:0.0007501498912461102
The modified gen p mean: 0.4483560025691986, gen p mean: -0.10698140412569046, mean p set: 0.4489312171936035
loss_pred:0.018212245777249336, decouple_loss:0.0007747778436169028
Iteration: 1144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495703876018524, gen p mean: -0.11120762676000595, mean p set: 0.4501429796218872
loss_pred:0.01735784485936165, decouple_loss:0.0010239583207294345
The modified gen p mean: 0.44839394092559814, gen p mean: -0.11049022525548935, mean p set: 0.44897153973579407
loss_pred:0.01772501692175865, decouple_loss:0.0011943044373765588
The modified gen p mean: 0.44804665446281433, gen p mean: -0.11071828007698059, mean p set: 0.4486234188079834
loss_pred:0.018266908824443817, decouple_loss:0.0013309853384271264
Iteration: 1145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486009478569031, gen p mean: -0.10375760495662689, mean p set: 0.449175626039505
loss_pred:0.017182668671011925, decouple_loss:0.0009403589647263288
The modified gen p mean: 0.449783056974411, gen p mean: -0.11298881471157074, mean p set: 0.45035961270332336
loss_pred:0.018206730484962463, decouple_loss:0.001076467102393508
The modified gen p mean: 0.4502817690372467, gen p mean: -0.10973117500543594, mean p set: 0.45085832476615906
loss_pred:0.017270339652895927, decouple_loss:0.0010359672596678138
Iteration: 1146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496206045150757, gen p mean: -0.1181042343378067, mean p set: 0.45019885897636414
The modified gen p mean: 0.4480702579021454, gen p mean: -0.1231914833188057, mean p set: 0.44864723086357117
loss_pred:0.01796857640147209, decouple_loss:0.0013843188062310219
loss_pred:0.018115591257810593, decouple_loss:0.0013075401075184345
The modified gen p mean: 0.4495235085487366, gen p mean: -0.12010583281517029, mean p set: 0.45009905099868774
loss_pred:0.017578409984707832, decouple_loss:0.0009099686867557466
Iteration: 1147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810083508491516, gen p mean: -0.11864752322435379, mean p set: 0.44867777824401855
loss_pred:0.01853674277663231, decouple_loss:0.0008884493727236986
The modified gen p mean: 0.44867926836013794, gen p mean: -0.12290409207344055, mean p set: 0.44925400614738464
The modified gen p mean: 0.44857099652290344, gen p mean: -0.1264026015996933, mean p set: 0.4491483271121979
loss_pred:0.01744195632636547, decouple_loss:0.0009395219967700541
loss_pred:0.017556123435497284, decouple_loss:0.0008924352587200701
Iteration: 1148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868004322052, gen p mean: -0.11160388588905334, mean p set: 0.44925686717033386
loss_pred:0.01756892167031765, decouple_loss:0.0007937689661048353
The modified gen p mean: 0.45003625750541687, gen p mean: -0.1085682064294815, mean p set: 0.45061272382736206
loss_pred:0.018793724477291107, decouple_loss:0.0010742259910330176
The modified gen p mean: 0.4484330713748932, gen p mean: -0.10702308267354965, mean p set: 0.4490078091621399
loss_pred:0.018034161999821663, decouple_loss:0.001318524475209415
Iteration: 1149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44884467124938965, gen p mean: -0.1111171692609787, mean p set: 0.4494204819202423
loss_pred:0.01854814775288105, decouple_loss:0.0007256487151607871
The modified gen p mean: 0.4495984613895416, gen p mean: -0.11395692825317383, mean p set: 0.45017439126968384
The modified gen p mean: 0.4498089551925659, gen p mean: -0.11368070542812347, mean p set: 0.450385719537735
loss_pred:0.018912846222519875, decouple_loss:0.0012183457147330046
loss_pred:0.017371781170368195, decouple_loss:0.0009222053922712803
Iteration: 1150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909730553627014, gen p mean: -0.10695718973875046, mean p set: 0.44967401027679443
loss_pred:0.017304955050349236, decouple_loss:0.0007273530936799943
The modified gen p mean: 0.44962218403816223, gen p mean: -0.10842972993850708, mean p set: 0.4501986801624298
The modified gen p mean: 0.4492610692977905, gen p mean: -0.11476534605026245, mean p set: 0.44983765482902527
loss_pred:0.017427580431103706, decouple_loss:0.0007275106618180871
loss_pred:0.01675913669168949, decouple_loss:0.0008778609917499125
2023-05-01 03:30:40 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.1116621270775795, mean p set: 0.4502691626548767
loss_pred:0.017429495230317116, decouple_loss:0.0010799752781167626
The modified gen p mean: 0.44953158497810364, gen p mean: -0.10536923259496689, mean p set: 0.4500633478164673
loss_pred:0.01695040613412857, decouple_loss:0.001014989917166531
The modified gen p mean: 0.44982898235321045, gen p mean: -0.1048746258020401, mean p set: 0.45035696029663086
loss_pred:0.017165407538414, decouple_loss:0.0010156475473195314
WV_1_PC_1_EH_0_PS_40, loss: 0.01723361387848854, avg_mse: 0.026717660948634148
current test mse: 0.026718
Iteration: 1151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44964203238487244, gen p mean: -0.10788113623857498, mean p set: 0.4502195417881012
loss_pred:0.017623743042349815, decouple_loss:0.0010570011800155044
The modified gen p mean: 0.44885963201522827, gen p mean: -0.09894997626543045, mean p set: 0.44943687319755554
loss_pred:0.017844289541244507, decouple_loss:0.001067803124897182
The modified gen p mean: 0.44911590218544006, gen p mean: -0.10900484770536423, mean p set: 0.44969442486763
loss_pred:0.01820545829832554, decouple_loss:0.0009761935216374695
Iteration: 1152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489562213420868, gen p mean: -0.11035426706075668, mean p set: 0.4495299160480499
loss_pred:0.018327102065086365, decouple_loss:0.0008448314620181918
The modified gen p mean: 0.44920220971107483, gen p mean: -0.1070115864276886, mean p set: 0.4497784972190857The modified gen p mean: 0.4495369791984558, gen p mean: -0.10976845026016235, mean p set: 0.450113981962204
loss_pred:0.019126813858747482, decouple_loss:0.0007999242516234517
loss_pred:0.018783405423164368, decouple_loss:0.0008535841479897499
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
NaN value num: 0
Iteration: 1153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465548098087311, gen p mean: -0.10617713630199432, mean p set: 0.4471317529678345
loss_pred:0.018028225749731064, decouple_loss:0.0010284811723977327
The modified gen p mean: 0.44640836119651794, gen p mean: -0.10616160929203033, mean p set: 0.4469830095767975
loss_pred:0.017842553555965424, decouple_loss:0.001013191300444305
The modified gen p mean: 0.4444117844104767, gen p mean: -0.10549425333738327, mean p set: 0.4449867010116577
loss_pred:0.01808171346783638, decouple_loss:0.000959502998739481
Iteration: 1154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740110635757446, gen p mean: -0.11152902245521545, mean p set: 0.4479779005050659
loss_pred:0.018001271411776543, decouple_loss:0.0009158557513728738
The modified gen p mean: 0.4475119113922119, gen p mean: -0.11126429587602615, mean p set: 0.4480881989002228
loss_pred:0.01620692014694214, decouple_loss:0.0009866764303296804
The modified gen p mean: 0.44828516244888306, gen p mean: -0.1111268550157547, mean p set: 0.44885969161987305
loss_pred:0.01711776852607727, decouple_loss:0.001203514402732253
Iteration: 1155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470219612121582, gen p mean: -0.1205594465136528, mean p set: 0.4475955367088318
loss_pred:0.015956386923789978, decouple_loss:0.0007051363936625421
The modified gen p mean: 0.44663000106811523, gen p mean: -0.1187916174530983, mean p set: 0.4472050368785858
loss_pred:0.018026059493422508, decouple_loss:0.0010218534152954817
The modified gen p mean: 0.44733938574790955, gen p mean: -0.11927512288093567, mean p set: 0.44791650772094727
loss_pred:0.017476709559559822, decouple_loss:0.0007232032367028296
Iteration: 1156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476095139980316, gen p mean: -0.11693186312913895, mean p set: 0.4481865465641022
loss_pred:0.01636132225394249, decouple_loss:0.0007543351384811103
The modified gen p mean: 0.44734227657318115, gen p mean: -0.12521545588970184, mean p set: 0.44791924953460693
The modified gen p mean: 0.4447093605995178, gen p mean: -0.11877229064702988, mean p set: 0.4452835023403168
loss_pred:0.01744198612868786, decouple_loss:0.0008763469522818923
loss_pred:0.01763918064534664, decouple_loss:0.0007638716488145292
Iteration: 1157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471482038497925, gen p mean: -0.11413643509149551, mean p set: 0.44772669672966003
loss_pred:0.01670916937291622, decouple_loss:0.0007638143724761903
The modified gen p mean: 0.44794991612434387, gen p mean: -0.11636916548013687, mean p set: 0.44852742552757263
The modified gen p mean: 0.44710254669189453, gen p mean: -0.12339375168085098, mean p set: 0.4476792514324188
loss_pred:0.017904197797179222, decouple_loss:0.0009227225091308355
loss_pred:0.01778409816324711, decouple_loss:0.000731837993953377
Iteration: 1158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743016362190247, gen p mean: -0.11332086473703384, mean p set: 0.4480046033859253
loss_pred:0.01681693270802498, decouple_loss:0.0010707525070756674
The modified gen p mean: 0.44758111238479614, gen p mean: -0.11217645555734634, mean p set: 0.4481572210788727
The modified gen p mean: 0.44802552461624146, gen p mean: -0.11141186952590942, mean p set: 0.44860225915908813
loss_pred:0.017339646816253662, decouple_loss:0.0010694361990317702
loss_pred:0.017467662692070007, decouple_loss:0.0010806139325723052
Iteration: 1159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815200567245483, gen p mean: -0.11338827759027481, mean p set: 0.4487268626689911
The modified gen p mean: 0.4467686712741852, gen p mean: -0.11165538430213928, mean p set: 0.44734519720077515
loss_pred:0.017627738416194916, decouple_loss:0.0010233186185359955
loss_pred:0.01771736331284046, decouple_loss:0.0009369978215545416
The modified gen p mean: 0.44708457589149475, gen p mean: -0.11136689782142639, mean p set: 0.44765937328338623
loss_pred:0.016415681689977646, decouple_loss:0.001020757365040481
Iteration: 1160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468713104724884, gen p mean: -0.11230632662773132, mean p set: 0.44744715094566345
loss_pred:0.01783677749335766, decouple_loss:0.0009326566942036152
The modified gen p mean: 0.44801297783851624, gen p mean: -0.11717637628316879, mean p set: 0.44859054684638977
loss_pred:0.017493486404418945, decouple_loss:0.0010049832053482533
The modified gen p mean: 0.44723188877105713, gen p mean: -0.1109461635351181, mean p set: 0.44780823588371277
loss_pred:0.016505436971783638, decouple_loss:0.001480071572586894
2023-05-01 03:33:28 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12006908655166626, mean p set: 0.4502691626548767
loss_pred:0.017538832500576973, decouple_loss:0.0010193705093115568
The modified gen p mean: 0.449534147977829, gen p mean: -0.11403204500675201, mean p set: 0.4500633478164673
loss_pred:0.016830554232001305, decouple_loss:0.0010258996626362205
The modified gen p mean: 0.44982895255088806, gen p mean: -0.11305936425924301, mean p set: 0.45035696029663086
loss_pred:0.017062896862626076, decouple_loss:0.0009945364436134696
WV_1_PC_1_EH_0_PS_40, loss: 0.017194759100675583, avg_mse: 0.026709677651524544
current test mse: 0.02671
Iteration: 1161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474809765815735, gen p mean: -0.11673496663570404, mean p set: 0.44805940985679626
loss_pred:0.017095355316996574, decouple_loss:0.0008156293188221753
The modified gen p mean: 0.44593295454978943, gen p mean: -0.1153985932469368, mean p set: 0.44650891423225403The modified gen p mean: 0.4454469382762909, gen p mean: -0.11520013958215714, mean p set: 0.44602203369140625
loss_pred:0.01711820624768734, decouple_loss:0.0012006601318717003loss_pred:0.01736581139266491, decouple_loss:0.001046160701662302
Iteration: 1162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460877776145935, gen p mean: -0.11425549536943436, mean p set: 0.4466627538204193
loss_pred:0.018058249726891518, decouple_loss:0.0010133525356650352
The modified gen p mean: 0.44733238220214844, gen p mean: -0.11194735765457153, mean p set: 0.44790738821029663The modified gen p mean: 0.4468251168727875, gen p mean: -0.11796633154153824, mean p set: 0.4473983943462372
loss_pred:0.01640998013317585, decouple_loss:0.0007716662948951125
loss_pred:0.016612853854894638, decouple_loss:0.0010117265628650784
Iteration: 1163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720131158828735, gen p mean: -0.11374150216579437, mean p set: 0.44777825474739075
loss_pred:0.01763458363711834, decouple_loss:0.0008019973756745458
The modified gen p mean: 0.4471132159233093, gen p mean: -0.11378877609968185, mean p set: 0.4476911425590515
loss_pred:0.01646583341062069, decouple_loss:0.0007034665322862566
The modified gen p mean: 0.44735458493232727, gen p mean: -0.11534888297319412, mean p set: 0.4479292929172516
loss_pred:0.0170409195125103, decouple_loss:0.0013987383572384715
Iteration: 1164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483907222747803, gen p mean: -0.1171284019947052, mean p set: 0.4489658772945404
loss_pred:0.017552321776747704, decouple_loss:0.0007491097203455865
The modified gen p mean: 0.4481329321861267, gen p mean: -0.1144508346915245, mean p set: 0.44870737195014954
loss_pred:0.01657605916261673, decouple_loss:0.0010092146694660187
The modified gen p mean: 0.4476194977760315, gen p mean: -0.11349272727966309, mean p set: 0.4481930732727051
loss_pred:0.017471380531787872, decouple_loss:0.0008409312576986849
Iteration: 1165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477914571762085, gen p mean: -0.11619262397289276, mean p set: 0.4483644366264343
The modified gen p mean: 0.446765661239624, gen p mean: -0.11831282079219818, mean p set: 0.4473438560962677
loss_pred:0.016373859718441963, decouple_loss:0.0008457064395770431
loss_pred:0.01718926429748535, decouple_loss:0.0007796082645654678
The modified gen p mean: 0.44716882705688477, gen p mean: -0.11835791915655136, mean p set: 0.447741836309433
loss_pred:0.017535803839564323, decouple_loss:0.0008476395159959793
Iteration: 1166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678783416748047, gen p mean: -0.11721834540367126, mean p set: 0.4473651349544525
loss_pred:0.016635898500680923, decouple_loss:0.0009289721492677927
The modified gen p mean: 0.44729945063591003, gen p mean: -0.11214423179626465, mean p set: 0.4478755593299866
loss_pred:0.0164151843637228, decouple_loss:0.0008433687617070973
The modified gen p mean: 0.4466426372528076, gen p mean: -0.11534500867128372, mean p set: 0.4472196698188782
loss_pred:0.017046846449375153, decouple_loss:0.0008848613360896707
Iteration: 1167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795969128608704, gen p mean: -0.1171131506562233, mean p set: 0.44853606820106506
loss_pred:0.017247961834073067, decouple_loss:0.0006995310541242361
The modified gen p mean: 0.4470271170139313, gen p mean: -0.1151171401143074, mean p set: 0.4476010203361511
loss_pred:0.016525397077202797, decouple_loss:0.0007086499244906008
The modified gen p mean: 0.44720178842544556, gen p mean: -0.11833187192678452, mean p set: 0.4477783739566803
loss_pred:0.017854077741503716, decouple_loss:0.0008715111762285233
Iteration: 1168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44437098503112793, gen p mean: -0.11353883892297745, mean p set: 0.4449447691440582
loss_pred:0.017789296805858612, decouple_loss:0.001132251345552504
The modified gen p mean: 0.44791585206985474, gen p mean: -0.11662095040082932, mean p set: 0.44849109649658203
loss_pred:0.016349343582987785, decouple_loss:0.0007113343453966081
The modified gen p mean: 0.4468064606189728, gen p mean: -0.11639637500047684, mean p set: 0.44738152623176575
loss_pred:0.018240539357066154, decouple_loss:0.000848711933940649
Iteration: 1169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790133833885193, gen p mean: -0.11542516946792603, mean p set: 0.44847550988197327
loss_pred:0.01702781952917576, decouple_loss:0.0009095814311876893
The modified gen p mean: 0.44704553484916687, gen p mean: -0.11695083230733871, mean p set: 0.4476243257522583
loss_pred:0.017737703397870064, decouple_loss:0.001024175202473998
The modified gen p mean: 0.44672322273254395, gen p mean: -0.11923523992300034, mean p set: 0.4472973346710205
loss_pred:0.01696689799427986, decouple_loss:0.0011318562319502234
Iteration: 1170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44652897119522095, gen p mean: -0.12180205434560776, mean p set: 0.44710254669189453
loss_pred:0.01778511144220829, decouple_loss:0.0007644561119377613
The modified gen p mean: 0.44789132475852966, gen p mean: -0.12038090825080872, mean p set: 0.44847017526626587
loss_pred:0.01647626981139183, decouple_loss:0.0008497878443449736
The modified gen p mean: 0.44839128851890564, gen p mean: -0.11970716714859009, mean p set: 0.4489684998989105
loss_pred:0.016206569969654083, decouple_loss:0.0008027795702219009
2023-05-01 03:35:34 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1291133314371109, mean p set: 0.4502691626548767
loss_pred:0.01754513941705227, decouple_loss:0.0008376986952498555
The modified gen p mean: 0.4495343267917633, gen p mean: -0.12280140072107315, mean p set: 0.4500633478164673
loss_pred:0.016903985291719437, decouple_loss:0.0009084012126550078
The modified gen p mean: 0.4498300552368164, gen p mean: -0.12199638783931732, mean p set: 0.45035696029663086
loss_pred:0.017078524455428123, decouple_loss:0.0007352568209171295
WV_1_PC_1_EH_0_PS_40, loss: 0.01721723936498165, avg_mse: 0.026751594617962837
current test mse: 0.026752
Iteration: 1171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483064115047455, gen p mean: -0.1282336711883545, mean p set: 0.4488775134086609
loss_pred:0.01733105070888996, decouple_loss:0.000696006987709552
The modified gen p mean: 0.44687968492507935, gen p mean: -0.12332762777805328, mean p set: 0.4474547207355499The modified gen p mean: 0.446720689535141, gen p mean: -0.1250864863395691, mean p set: 0.4472928047180176
loss_pred:0.017165081575512886, decouple_loss:0.0008110416238196194loss_pred:0.017608465626835823, decouple_loss:0.0007649007020518184
Iteration: 1172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44486933946609497, gen p mean: -0.12116262316703796, mean p set: 0.4454438388347626
loss_pred:0.017408357933163643, decouple_loss:0.0011170814977958798
The modified gen p mean: 0.4482581615447998, gen p mean: -0.12891918420791626, mean p set: 0.44883349537849426The modified gen p mean: 0.4481159746646881, gen p mean: -0.12131760269403458, mean p set: 0.448689341545105
loss_pred:0.016829736530780792, decouple_loss:0.000785405864007771
loss_pred:0.016535600647330284, decouple_loss:0.0009372027707286179
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
NaN value num: 0
Iteration: 1173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483596980571747, gen p mean: -0.12332209944725037, mean p set: 0.44893211126327515
loss_pred:0.01718713529407978, decouple_loss:0.0006758025265298784
The modified gen p mean: 0.4497753977775574, gen p mean: -0.11673364788293839, mean p set: 0.4503500759601593
The modified gen p mean: 0.4488108456134796, gen p mean: -0.12207955867052078, mean p set: 0.4493875503540039
loss_pred:0.016754286363720894, decouple_loss:0.0008692494011484087
loss_pred:0.018203426152467728, decouple_loss:0.0008300109184347093
Iteration: 1174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727247953414917, gen p mean: -0.1240738034248352, mean p set: 0.4478487968444824
loss_pred:0.01716107316315174, decouple_loss:0.0007756431587040424
The modified gen p mean: 0.4483201205730438, gen p mean: -0.11696508526802063, mean p set: 0.4488941431045532
loss_pred:0.016763582825660706, decouple_loss:0.0007020450429990888
The modified gen p mean: 0.44986456632614136, gen p mean: -0.11975192278623581, mean p set: 0.4504399299621582
loss_pred:0.016089335083961487, decouple_loss:0.0008561364957131445
Iteration: 1175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496150612831116, gen p mean: -0.11563269048929214, mean p set: 0.4501916468143463
loss_pred:0.018642444163560867, decouple_loss:0.0010553657775744796
The modified gen p mean: 0.4475495219230652, gen p mean: -0.11945337802171707, mean p set: 0.4481256306171417
loss_pred:0.017289824783802032, decouple_loss:0.0009690405568107963
The modified gen p mean: 0.448305606842041, gen p mean: -0.11811709403991699, mean p set: 0.44888144731521606
loss_pred:0.01693069562315941, decouple_loss:0.0008129911730065942
Iteration: 1176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44884318113327026, gen p mean: -0.1184314414858818, mean p set: 0.4494177997112274
loss_pred:0.017450964078307152, decouple_loss:0.0007628993480466306
The modified gen p mean: 0.4486496150493622, gen p mean: -0.11431235074996948, mean p set: 0.4492282271385193
loss_pred:0.017635904252529144, decouple_loss:0.0007796687423251569
The modified gen p mean: 0.449511855840683, gen p mean: -0.11354727298021317, mean p set: 0.4500845670700073
loss_pred:0.01699427142739296, decouple_loss:0.0007463145884685218
Iteration: 1177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786882400512695, gen p mean: -0.12084637582302094, mean p set: 0.44844523072242737
The modified gen p mean: 0.44876816868782043, gen p mean: -0.12092259526252747, mean p set: 0.44934555888175964
loss_pred:0.017382154241204262, decouple_loss:0.0010121228406205773
loss_pred:0.017457719892263412, decouple_loss:0.001079424051567912
The modified gen p mean: 0.4493604898452759, gen p mean: -0.11679314076900482, mean p set: 0.44993606209754944
loss_pred:0.01707286387681961, decouple_loss:0.0008894006023183465
Iteration: 1178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810357689857483, gen p mean: -0.11926707625389099, mean p set: 0.44868043065071106
loss_pred:0.01735086552798748, decouple_loss:0.0007668250473216176
The modified gen p mean: 0.44912612438201904, gen p mean: -0.11554895341396332, mean p set: 0.4497022032737732
loss_pred:0.017724590376019478, decouple_loss:0.0007447869866155088
The modified gen p mean: 0.44935309886932373, gen p mean: -0.11803165078163147, mean p set: 0.4499320983886719
loss_pred:0.017180994153022766, decouple_loss:0.000738778617233038
Iteration: 1179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44979989528656006, gen p mean: -0.12050250917673111, mean p set: 0.4503753185272217
loss_pred:0.016269376501441002, decouple_loss:0.0006629420095123351
The modified gen p mean: 0.4501250982284546, gen p mean: -0.12009019404649734, mean p set: 0.4507031738758087
loss_pred:0.0171896293759346, decouple_loss:0.0006460672593675554
The modified gen p mean: 0.4478995203971863, gen p mean: -0.11880822479724884, mean p set: 0.44847577810287476
loss_pred:0.01733527146279812, decouple_loss:0.0010103577515110373
Iteration: 1180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499306380748749, gen p mean: -0.11820735782384872, mean p set: 0.4505065083503723
loss_pred:0.016643621027469635, decouple_loss:0.0006716098869219422
The modified gen p mean: 0.44886451959609985, gen p mean: -0.11671066284179688, mean p set: 0.44944456219673157
loss_pred:0.01763492450118065, decouple_loss:0.0009128452511504292
The modified gen p mean: 0.4495972990989685, gen p mean: -0.1206025555729866, mean p set: 0.45017367601394653
loss_pred:0.01645960658788681, decouple_loss:0.000707128259819001
2023-05-01 03:38:23 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12396100163459778, mean p set: 0.4502691626548767
loss_pred:0.017425863072276115, decouple_loss:0.0007987061981111765
The modified gen p mean: 0.4495369493961334, gen p mean: -0.11788289994001389, mean p set: 0.4500633478164673
loss_pred:0.01689140871167183, decouple_loss:0.0007664448348805308
The modified gen p mean: 0.44982925057411194, gen p mean: -0.11699691414833069, mean p set: 0.45035696029663086
loss_pred:0.017077689990401268, decouple_loss:0.0011682473123073578
WV_1_PC_1_EH_0_PS_40, loss: 0.017177211120724678, avg_mse: 0.02669103629887104
current test mse: 0.026691
Iteration: 1181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449069082736969, gen p mean: -0.11764586716890335, mean p set: 0.4496472179889679
loss_pred:0.01765652745962143, decouple_loss:0.0010716160759329796
The modified gen p mean: 0.4501255750656128, gen p mean: -0.11696275323629379, mean p set: 0.4507019817829132The modified gen p mean: 0.4496381878852844, gen p mean: -0.11690153926610947, mean p set: 0.45021507143974304
loss_pred:0.016844989731907845, decouple_loss:0.001096055842936039
loss_pred:0.017056936398148537, decouple_loss:0.0010723451850935817
Iteration: 1182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089393854141235, gen p mean: -0.1202172189950943, mean p set: 0.4514707326889038
loss_pred:0.016978247091174126, decouple_loss:0.0006699148216284811
The modified gen p mean: 0.4473870098590851, gen p mean: -0.11888647824525833, mean p set: 0.4479599893093109The modified gen p mean: 0.44948387145996094, gen p mean: -0.11467405408620834, mean p set: 0.450064092874527
loss_pred:0.01757669635117054, decouple_loss:0.0009194613085128367loss_pred:0.0174879040569067, decouple_loss:0.0006155932787805796
Iteration: 1183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44857943058013916, gen p mean: -0.1156153678894043, mean p set: 0.4491589367389679
loss_pred:0.017501745373010635, decouple_loss:0.0012287271674722433
The modified gen p mean: 0.4486958682537079, gen p mean: -0.11474484205245972, mean p set: 0.44927293062210083The modified gen p mean: 0.4486018121242523, gen p mean: -0.1183224618434906, mean p set: 0.4491797089576721
loss_pred:0.01738559640944004, decouple_loss:0.0007576947682537138
loss_pred:0.016993649303913116, decouple_loss:0.0011837430065497756
Iteration: 1184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497251808643341, gen p mean: -0.1149451956152916, mean p set: 0.4502998888492584
loss_pred:0.016262786462903023, decouple_loss:0.0007056888425722718
The modified gen p mean: 0.44852468371391296, gen p mean: -0.11618348211050034, mean p set: 0.44910046458244324
loss_pred:0.01741279475390911, decouple_loss:0.0009944685734808445
The modified gen p mean: 0.44968825578689575, gen p mean: -0.1123582199215889, mean p set: 0.45026645064353943
loss_pred:0.016942201182246208, decouple_loss:0.00082338199717924
Iteration: 1185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503523111343384, gen p mean: -0.11992868781089783, mean p set: 0.4509304463863373
loss_pred:0.0169973187148571, decouple_loss:0.0006793650100007653
The modified gen p mean: 0.4485306739807129, gen p mean: -0.11550114303827286, mean p set: 0.4491029977798462
loss_pred:0.017618808895349503, decouple_loss:0.000811018340755254
The modified gen p mean: 0.44782325625419617, gen p mean: -0.11335620284080505, mean p set: 0.4483988583087921
loss_pred:0.016607394441962242, decouple_loss:0.0007472916040569544
Iteration: 1186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483408033847809, gen p mean: -0.116404227912426, mean p set: 0.4489196836948395
loss_pred:0.017166754230856895, decouple_loss:0.0008530585328117013
The modified gen p mean: 0.4479750394821167, gen p mean: -0.11978515982627869, mean p set: 0.44855284690856934
The modified gen p mean: 0.4489627778530121, gen p mean: -0.11307544261217117, mean p set: 0.44953852891921997
loss_pred:0.01717270538210869, decouple_loss:0.0009039968135766685
loss_pred:0.017983397468924522, decouple_loss:0.0011350983986631036
Iteration: 1187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818025827407837, gen p mean: -0.11364398896694183, mean p set: 0.4487546980381012
loss_pred:0.017112400382757187, decouple_loss:0.0006236157496459782
The modified gen p mean: 0.44805482029914856, gen p mean: -0.11700721830129623, mean p set: 0.44863176345825195
The modified gen p mean: 0.4496859908103943, gen p mean: -0.11434213072061539, mean p set: 0.45026108622550964
loss_pred:0.018045976758003235, decouple_loss:0.0008446643478237092
loss_pred:0.01737639307975769, decouple_loss:0.0008102183346636593
Iteration: 1188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488091468811035, gen p mean: -0.1136990487575531, mean p set: 0.4493860900402069
loss_pred:0.01717364229261875, decouple_loss:0.0008244883501902223
The modified gen p mean: 0.4473975598812103, gen p mean: -0.11605314910411835, mean p set: 0.44797325134277344
The modified gen p mean: 0.4484861195087433, gen p mean: -0.1115948036313057, mean p set: 0.44906121492385864
loss_pred:0.018065214157104492, decouple_loss:0.0008072297787293792
loss_pred:0.017285846173763275, decouple_loss:0.0009255775948986411
Iteration: 1189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448691725730896, gen p mean: -0.11315611004829407, mean p set: 0.4492657780647278
loss_pred:0.0175367072224617, decouple_loss:0.0007403580821119249
The modified gen p mean: 0.45020678639411926, gen p mean: -0.11387542635202408, mean p set: 0.45078352093696594
The modified gen p mean: 0.44920456409454346, gen p mean: -0.11000469326972961, mean p set: 0.4497818946838379
loss_pred:0.01639123447239399, decouple_loss:0.0008507294696755707
loss_pred:0.017779922112822533, decouple_loss:0.000828062416985631
Iteration: 1190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475513994693756, gen p mean: -0.11360325664281845, mean p set: 0.44812440872192383
loss_pred:0.01717289537191391, decouple_loss:0.0006723101832903922
The modified gen p mean: 0.44784197211265564, gen p mean: -0.11914008110761642, mean p set: 0.4484170973300934
loss_pred:0.017589760944247246, decouple_loss:0.0006624335655942559
The modified gen p mean: 0.44953426718711853, gen p mean: -0.11550870537757874, mean p set: 0.4501113295555115
loss_pred:0.01669120416045189, decouple_loss:0.0008812844753265381
2023-05-01 03:40:29 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12242913246154785, mean p set: 0.4502691626548767
loss_pred:0.017438987269997597, decouple_loss:0.0007591515313833952
The modified gen p mean: 0.44953593611717224, gen p mean: -0.11626984179019928, mean p set: 0.4500633478164673
loss_pred:0.01681436039507389, decouple_loss:0.0007709517958573997
The modified gen p mean: 0.44982975721359253, gen p mean: -0.11516246199607849, mean p set: 0.45035696029663086
loss_pred:0.01702193170785904, decouple_loss:0.000867245951667428
WV_1_PC_1_EH_0_PS_40, loss: 0.017131716012954712, avg_mse: 0.02661863900721073
current test mse: 0.026619
Iteration: 1191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023199915885925, gen p mean: -0.11572356522083282, mean p set: 0.45080816745758057
loss_pred:0.017768360674381256, decouple_loss:0.0008826570701785386
The modified gen p mean: 0.4479985237121582, gen p mean: -0.11266302317380905, mean p set: 0.448575496673584
loss_pred:0.01791336014866829, decouple_loss:0.0007931810105219483
The modified gen p mean: 0.44821199774742126, gen p mean: -0.11210393905639648, mean p set: 0.4487886428833008
loss_pred:0.017335355281829834, decouple_loss:0.0010444761719554663
Iteration: 1192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482889473438263, gen p mean: -0.11171969771385193, mean p set: 0.4488662779331207
loss_pred:0.01695989817380905, decouple_loss:0.0007498158374801278
The modified gen p mean: 0.4486006200313568, gen p mean: -0.1183886006474495, mean p set: 0.44917523860931396The modified gen p mean: 0.45025530457496643, gen p mean: -0.11414139717817307, mean p set: 0.45083382725715637
loss_pred:0.017505399882793427, decouple_loss:0.000681556120980531
loss_pred:0.017144693061709404, decouple_loss:0.0008358938503079116
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
NaN value num: 0
Iteration: 1193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45148929953575134, gen p mean: -0.10848629474639893, mean p set: 0.45206621289253235
loss_pred:0.01630442403256893, decouple_loss:0.0012387731112539768
The modified gen p mean: 0.4521200358867645, gen p mean: -0.1110958606004715, mean p set: 0.45269572734832764
The modified gen p mean: 0.4531194269657135, gen p mean: -0.10507716238498688, mean p set: 0.4536963999271393
loss_pred:0.01610221527516842, decouple_loss:0.0011063109850510955
loss_pred:0.016856864094734192, decouple_loss:0.0009185047820210457
Iteration: 1194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44950273633003235, gen p mean: -0.11177465319633484, mean p set: 0.450082391500473
loss_pred:0.016052713617682457, decouple_loss:0.0008338529150933027
The modified gen p mean: 0.4492945671081543, gen p mean: -0.11013033986091614, mean p set: 0.4498707354068756
loss_pred:0.016688402742147446, decouple_loss:0.0008752311114221811
The modified gen p mean: 0.44844838976860046, gen p mean: -0.1132015511393547, mean p set: 0.44902369379997253
loss_pred:0.01621364988386631, decouple_loss:0.0008120699785649776
Iteration: 1195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491575360298157, gen p mean: -0.10563775151968002, mean p set: 0.4497344493865967
loss_pred:0.01658243127167225, decouple_loss:0.0009348344756290317
The modified gen p mean: 0.4497006833553314, gen p mean: -0.11237285286188126, mean p set: 0.4502776563167572
loss_pred:0.01618928648531437, decouple_loss:0.00094255042495206
The modified gen p mean: 0.4530680477619171, gen p mean: -0.10835043340921402, mean p set: 0.4536430835723877
loss_pred:0.01704585552215576, decouple_loss:0.0009993844432756305
Iteration: 1196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450668603181839, gen p mean: -0.10279126465320587, mean p set: 0.45124614238739014
loss_pred:0.016685891896486282, decouple_loss:0.000794689345639199
The modified gen p mean: 0.4511983394622803, gen p mean: -0.10777311027050018, mean p set: 0.45177412033081055
The modified gen p mean: 0.450880229473114, gen p mean: -0.10876112431287766, mean p set: 0.4514558017253876
loss_pred:0.015957899391651154, decouple_loss:0.0008826640550978482
loss_pred:0.016446338966488838, decouple_loss:0.0009966053767129779
Iteration: 1197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45361852645874023, gen p mean: -0.10483765602111816, mean p set: 0.4541929364204407
loss_pred:0.016677480190992355, decouple_loss:0.0008442908874712884
The modified gen p mean: 0.44902053475379944, gen p mean: -0.10233013331890106, mean p set: 0.44959568977355957
The modified gen p mean: 0.4512442648410797, gen p mean: -0.10477118194103241, mean p set: 0.4518203139305115
loss_pred:0.01622585952281952, decouple_loss:0.0007601134129799902
loss_pred:0.016136061400175095, decouple_loss:0.0007300720899365842
Iteration: 1198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525647759437561, gen p mean: -0.10336152464151382, mean p set: 0.45314162969589233
loss_pred:0.016481611877679825, decouple_loss:0.0007606565486639738
The modified gen p mean: 0.45172905921936035, gen p mean: -0.10194240510463715, mean p set: 0.4523043632507324
The modified gen p mean: 0.45226776599884033, gen p mean: -0.10820743441581726, mean p set: 0.45284390449523926
loss_pred:0.015966109931468964, decouple_loss:0.0009325223509222269
loss_pred:0.016274143010377884, decouple_loss:0.0007770069059915841
Iteration: 1199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45163658261299133, gen p mean: -0.10939348489046097, mean p set: 0.45221275091171265
loss_pred:0.016361815854907036, decouple_loss:0.0007275646785274148
The modified gen p mean: 0.45044443011283875, gen p mean: -0.10411237180233002, mean p set: 0.4510199725627899
The modified gen p mean: 0.45042333006858826, gen p mean: -0.10275507718324661, mean p set: 0.45099982619285583
loss_pred:0.01638527773320675, decouple_loss:0.0007989485748112202
loss_pred:0.016550133004784584, decouple_loss:0.0007171545294113457
Iteration: 1200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515148997306824, gen p mean: -0.10370422899723053, mean p set: 0.452089786529541
loss_pred:0.015447353944182396, decouple_loss:0.0008001692476682365
The modified gen p mean: 0.44901421666145325, gen p mean: -0.10188163071870804, mean p set: 0.4495902955532074
loss_pred:0.015837857499718666, decouple_loss:0.0009355936199426651
The modified gen p mean: 0.4495936930179596, gen p mean: -0.10004249215126038, mean p set: 0.4501683712005615
loss_pred:0.016510413959622383, decouple_loss:0.0008990087662823498
2023-05-01 03:43:09 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.12270946055650711, mean p set: 0.4502691626548767
loss_pred:0.017517931759357452, decouple_loss:0.0009357109083794057
The modified gen p mean: 0.44953420758247375, gen p mean: -0.11583834886550903, mean p set: 0.4500633478164673
loss_pred:0.017086904495954514, decouple_loss:0.0009041777811944485
The modified gen p mean: 0.44982972741127014, gen p mean: -0.11482946574687958, mean p set: 0.45035696029663086
loss_pred:0.017353465780615807, decouple_loss:0.0008310482953675091
WV_1_PC_1_EH_0_PS_40, loss: 0.01736394874751568, avg_mse: 0.026830904185771942
current test mse: 0.026831
Iteration: 1201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486079216003418, gen p mean: -0.11138707399368286, mean p set: 0.44918093085289
loss_pred:0.01602821983397007, decouple_loss:0.0008632706594653428
The modified gen p mean: 0.4521588683128357, gen p mean: -0.10742320120334625, mean p set: 0.45273545384407043The modified gen p mean: 0.44914254546165466, gen p mean: -0.10636073350906372, mean p set: 0.44971778988838196
loss_pred:0.01634489744901657, decouple_loss:0.0009587324457243085
loss_pred:0.01618843711912632, decouple_loss:0.0006740494864061475
Iteration: 1202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45050203800201416, gen p mean: -0.1078350841999054, mean p set: 0.45107904076576233
loss_pred:0.015878217294812202, decouple_loss:0.0008758765761740506
The modified gen p mean: 0.45043137669563293, gen p mean: -0.11775774508714676, mean p set: 0.45100730657577515The modified gen p mean: 0.4488545060157776, gen p mean: -0.11392583698034286, mean p set: 0.4494280517101288
loss_pred:0.016550006344914436, decouple_loss:0.0008131260401569307
loss_pred:0.015715595334768295, decouple_loss:0.0008660941384732723
Iteration: 1203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958823919296265, gen p mean: -0.11652330309152603, mean p set: 0.4501636028289795
loss_pred:0.016109256073832512, decouple_loss:0.0007696845568716526
The modified gen p mean: 0.44965124130249023, gen p mean: -0.11601689457893372, mean p set: 0.45022767782211304The modified gen p mean: 0.4513261020183563, gen p mean: -0.10989212989807129, mean p set: 0.4519027769565582
loss_pred:0.016450360417366028, decouple_loss:0.0006972132832743227
loss_pred:0.015580614097416401, decouple_loss:0.0007403476047329605
Iteration: 1204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44878843426704407, gen p mean: -0.10900403559207916, mean p set: 0.4493648409843445
loss_pred:0.016123855486512184, decouple_loss:0.0008661769097670913
The modified gen p mean: 0.4512088894844055, gen p mean: -0.11174710839986801, mean p set: 0.45178547501564026
loss_pred:0.01580881141126156, decouple_loss:0.0008721185149624944
The modified gen p mean: 0.45033755898475647, gen p mean: -0.11541048437356949, mean p set: 0.45091211795806885
loss_pred:0.01638820394873619, decouple_loss:0.0009218259365297854
Iteration: 1205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514494836330414, gen p mean: -0.110750712454319, mean p set: 0.4520263373851776
loss_pred:0.015772370621562004, decouple_loss:0.0008691447437740862
The modified gen p mean: 0.4513993263244629, gen p mean: -0.10447908937931061, mean p set: 0.451975017786026
loss_pred:0.016292430460453033, decouple_loss:0.0009118533926084638
The modified gen p mean: 0.4496808648109436, gen p mean: -0.11088675260543823, mean p set: 0.4502570331096649
loss_pred:0.016662683337926865, decouple_loss:0.0008304325165227056
Iteration: 1206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44995108246803284, gen p mean: -0.11016953736543655, mean p set: 0.45052674412727356
loss_pred:0.015753241255879402, decouple_loss:0.0009942876640707254
The modified gen p mean: 0.4507523775100708, gen p mean: -0.10687959939241409, mean p set: 0.45132896304130554
loss_pred:0.01647968590259552, decouple_loss:0.0009706670534797013
The modified gen p mean: 0.45036017894744873, gen p mean: -0.09854863584041595, mean p set: 0.4509369134902954
loss_pred:0.016853777691721916, decouple_loss:0.0007521894294768572
Iteration: 1207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514620900154114, gen p mean: -0.1056266576051712, mean p set: 0.4520416855812073
loss_pred:0.016195479780435562, decouple_loss:0.0011422986863180995
The modified gen p mean: 0.44931209087371826, gen p mean: -0.1073591560125351, mean p set: 0.4498874545097351
loss_pred:0.015529176220297813, decouple_loss:0.0008608712814748287
The modified gen p mean: 0.4506787061691284, gen p mean: -0.10294246673583984, mean p set: 0.45125362277030945
loss_pred:0.016134941950440407, decouple_loss:0.0009412392391823232
Iteration: 1208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504183232784271, gen p mean: -0.11159057170152664, mean p set: 0.45099470019340515
loss_pred:0.016437284648418427, decouple_loss:0.0008777666371315718
The modified gen p mean: 0.4519803822040558, gen p mean: -0.10410340130329132, mean p set: 0.4525558054447174
loss_pred:0.01603548415005207, decouple_loss:0.0009695474873296916
The modified gen p mean: 0.4507066607475281, gen p mean: -0.10230749845504761, mean p set: 0.45128580927848816
loss_pred:0.015904610976576805, decouple_loss:0.001049665967002511
Iteration: 1209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520399272441864, gen p mean: -0.10300847142934799, mean p set: 0.45261847972869873
loss_pred:0.016209084540605545, decouple_loss:0.0009559373720549047
The modified gen p mean: 0.4498426616191864, gen p mean: -0.11095123738050461, mean p set: 0.4504190683364868
loss_pred:0.016641667112708092, decouple_loss:0.0009113191626966
The modified gen p mean: 0.4526079297065735, gen p mean: -0.10150066018104553, mean p set: 0.45318490266799927
loss_pred:0.016405737027525902, decouple_loss:0.0009924054611474276
Iteration: 1210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45125338435173035, gen p mean: -0.09897457808256149, mean p set: 0.45182791352272034
loss_pred:0.016867419704794884, decouple_loss:0.001017051748931408
The modified gen p mean: 0.4484606981277466, gen p mean: -0.10630184412002563, mean p set: 0.4490357041358948
loss_pred:0.015680452808737755, decouple_loss:0.0009251402807421982
The modified gen p mean: 0.4507603049278259, gen p mean: -0.10070425271987915, mean p set: 0.45133697986602783
loss_pred:0.01619916595518589, decouple_loss:0.0012500786688178778
2023-05-01 03:45:16 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1171918511390686, mean p set: 0.4502691626548767
loss_pred:0.017519310116767883, decouple_loss:0.0011334428563714027
The modified gen p mean: 0.4495346248149872, gen p mean: -0.11009743809700012, mean p set: 0.4500633478164673
loss_pred:0.016888365149497986, decouple_loss:0.0011286938097327948
The modified gen p mean: 0.4498278498649597, gen p mean: -0.10908279567956924, mean p set: 0.45035696029663086
loss_pred:0.01711759902536869, decouple_loss:0.0010406578658148646
WV_1_PC_1_EH_0_PS_40, loss: 0.017230138182640076, avg_mse: 0.02673989161849022
current test mse: 0.02674
Iteration: 1211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520697295665741, gen p mean: -0.10499671846628189, mean p set: 0.4526461362838745
loss_pred:0.015457868576049805, decouple_loss:0.0012947034556418657
The modified gen p mean: 0.45116233825683594, gen p mean: -0.1039782166481018, mean p set: 0.451738178730011
loss_pred:0.015972547233104706, decouple_loss:0.0007820200407877564
The modified gen p mean: 0.4511580765247345, gen p mean: -0.10415398329496384, mean p set: 0.4517350196838379
loss_pred:0.01585768535733223, decouple_loss:0.0010896299500018358
Iteration: 1212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114782452583313, gen p mean: -0.10158881545066833, mean p set: 0.4517255127429962
loss_pred:0.016074908897280693, decouple_loss:0.0009210294228978455
The modified gen p mean: 0.4513954818248749, gen p mean: -0.10018821060657501, mean p set: 0.4519725739955902The modified gen p mean: 0.45262452960014343, gen p mean: -0.10220862179994583, mean p set: 0.45320096611976624
loss_pred:0.016235776245594025, decouple_loss:0.0009160800254903734
loss_pred:0.016692819073796272, decouple_loss:0.0009354804642498493
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
NaN value num: 0
Iteration: 1213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447541207075119, gen p mean: -0.11004872620105743, mean p set: 0.448116660118103
loss_pred:0.018946465104818344, decouple_loss:0.0009670997387729585
The modified gen p mean: 0.4461987614631653, gen p mean: -0.11194311082363129, mean p set: 0.446774959564209
loss_pred:0.017880847677588463, decouple_loss:0.0007560498779639602
The modified gen p mean: 0.44720712304115295, gen p mean: -0.11191630363464355, mean p set: 0.44778236746788025
loss_pred:0.017769891768693924, decouple_loss:0.0008208675426431
Iteration: 1214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477108120918274, gen p mean: -0.11399836093187332, mean p set: 0.4482884109020233
loss_pred:0.01712091825902462, decouple_loss:0.0008108707843348384
The modified gen p mean: 0.44780251383781433, gen p mean: -0.11441859602928162, mean p set: 0.44837686419487
loss_pred:0.018040336668491364, decouple_loss:0.0007540681399405003
The modified gen p mean: 0.4466813802719116, gen p mean: -0.11814166605472565, mean p set: 0.4472576081752777
loss_pred:0.017332445830106735, decouple_loss:0.0007799766608513892
Iteration: 1215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44944116473197937, gen p mean: -0.12056844681501389, mean p set: 0.4500185549259186
loss_pred:0.017383525148034096, decouple_loss:0.0009658071794547141
The modified gen p mean: 0.4473978281021118, gen p mean: -0.11595392972230911, mean p set: 0.4479750096797943
loss_pred:0.018141139298677444, decouple_loss:0.0007118462235666811
The modified gen p mean: 0.4476645886898041, gen p mean: -0.1180500015616417, mean p set: 0.4482417702674866
loss_pred:0.017692800611257553, decouple_loss:0.000836057064589113
Iteration: 1216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783639907836914, gen p mean: -0.1161910891532898, mean p set: 0.44841399788856506
loss_pred:0.018017923459410667, decouple_loss:0.0008318204199895263
The modified gen p mean: 0.4484958052635193, gen p mean: -0.12031076848506927, mean p set: 0.44907209277153015
loss_pred:0.018078627064824104, decouple_loss:0.0008433652692474425
The modified gen p mean: 0.4476833641529083, gen p mean: -0.11888746917247772, mean p set: 0.4482615292072296
loss_pred:0.017600812017917633, decouple_loss:0.000827098498120904
Iteration: 1217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754722714424133, gen p mean: -0.12615588307380676, mean p set: 0.4481232166290283
loss_pred:0.016729028895497322, decouple_loss:0.0006915190606378019
The modified gen p mean: 0.4471313953399658, gen p mean: -0.12361942231655121, mean p set: 0.44770732522010803
loss_pred:0.016840338706970215, decouple_loss:0.0009229626739397645
The modified gen p mean: 0.4462539851665497, gen p mean: -0.12438122183084488, mean p set: 0.44682982563972473
loss_pred:0.01629311591386795, decouple_loss:0.0008006894495338202
Iteration: 1218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474930465221405, gen p mean: -0.11805353313684464, mean p set: 0.4480714499950409
loss_pred:0.016905436292290688, decouple_loss:0.0007374972919933498
The modified gen p mean: 0.4484093189239502, gen p mean: -0.1219271644949913, mean p set: 0.4489823877811432
loss_pred:0.017126677557826042, decouple_loss:0.0009087694925256073
The modified gen p mean: 0.4467487335205078, gen p mean: -0.12413197755813599, mean p set: 0.44732505083084106
loss_pred:0.017257940024137497, decouple_loss:0.0007358624134212732
Iteration: 1219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783347845077515, gen p mean: -0.11666414886713028, mean p set: 0.4484054148197174
The modified gen p mean: 0.44787925481796265, gen p mean: -0.12034053355455399, mean p set: 0.4484540522098541
loss_pred:0.01797376200556755, decouple_loss:0.0007897772011347115
loss_pred:0.01706687919795513, decouple_loss:0.0006745291175320745
The modified gen p mean: 0.44877269864082336, gen p mean: -0.12273189425468445, mean p set: 0.44934606552124023
loss_pred:0.017881890758872032, decouple_loss:0.0008750605047680438
Iteration: 1220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44652876257896423, gen p mean: -0.12323614209890366, mean p set: 0.447104811668396
loss_pred:0.016500676050782204, decouple_loss:0.0007498155464418232
The modified gen p mean: 0.4478013515472412, gen p mean: -0.1177506372332573, mean p set: 0.4483780562877655
loss_pred:0.0169017743319273, decouple_loss:0.0006723740370944142
The modified gen p mean: 0.4464104473590851, gen p mean: -0.11760086566209793, mean p set: 0.4469875395298004
loss_pred:0.01748647913336754, decouple_loss:0.000717599643394351
2023-05-01 03:48:03 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12165127694606781, mean p set: 0.4502691626548767
loss_pred:0.017439281567931175, decouple_loss:0.0009147863020189106
The modified gen p mean: 0.4495354890823364, gen p mean: -0.11481031775474548, mean p set: 0.4500633478164673
loss_pred:0.016859374940395355, decouple_loss:0.0008163924212567508
The modified gen p mean: 0.44982752203941345, gen p mean: -0.11360231786966324, mean p set: 0.45035696029663086
loss_pred:0.01700255647301674, decouple_loss:0.0008330359123647213
WV_1_PC_1_EH_0_PS_40, loss: 0.017143143340945244, avg_mse: 0.026630857959389687
current test mse: 0.026631
Iteration: 1221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793248176574707, gen p mean: -0.11786133795976639, mean p set: 0.4485093653202057
loss_pred:0.018205605447292328, decouple_loss:0.0006988864624872804
The modified gen p mean: 0.44781720638275146, gen p mean: -0.11350246518850327, mean p set: 0.448391854763031
loss_pred:0.0175938680768013, decouple_loss:0.0007812231779098511
The modified gen p mean: 0.4469684958457947, gen p mean: -0.11526573449373245, mean p set: 0.44754326343536377
loss_pred:0.01787770353257656, decouple_loss:0.0008712402195669711
Iteration: 1222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660380482673645, gen p mean: -0.11460555344820023, mean p set: 0.44717806577682495
loss_pred:0.017626559361815453, decouple_loss:0.000661473604850471
The modified gen p mean: 0.446781724691391, gen p mean: -0.11683861166238785, mean p set: 0.4473554790019989The modified gen p mean: 0.44761452078819275, gen p mean: -0.11871353536844254, mean p set: 0.44819125533103943
loss_pred:0.016891388222575188, decouple_loss:0.0005849277949891984
loss_pred:0.015949953347444534, decouple_loss:0.0007042543147690594
Iteration: 1223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747719168663025, gen p mean: -0.11795517057180405, mean p set: 0.44805458188056946
loss_pred:0.01629098504781723, decouple_loss:0.0006704865954816341
The modified gen p mean: 0.44786471128463745, gen p mean: -0.10723777115345001, mean p set: 0.44843971729278564The modified gen p mean: 0.44731783866882324, gen p mean: -0.10957091301679611, mean p set: 0.4478928744792938
loss_pred:0.017032621428370476, decouple_loss:0.0007666719029657543loss_pred:0.018259558826684952, decouple_loss:0.0007475431775674224
Iteration: 1224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478505253791809, gen p mean: -0.11569096148014069, mean p set: 0.4484272003173828
loss_pred:0.017644129693508148, decouple_loss:0.0008336413884535432
The modified gen p mean: 0.44852912425994873, gen p mean: -0.11386097222566605, mean p set: 0.44910722970962524
loss_pred:0.01787467673420906, decouple_loss:0.0007635472575202584
The modified gen p mean: 0.4467827379703522, gen p mean: -0.11703729629516602, mean p set: 0.4473590552806854
loss_pred:0.016846129670739174, decouple_loss:0.0006936337449587882
Iteration: 1225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462221562862396, gen p mean: -0.11417847126722336, mean p set: 0.4467964172363281
loss_pred:0.016746075823903084, decouple_loss:0.000839948479551822
The modified gen p mean: 0.4468129575252533, gen p mean: -0.11219232529401779, mean p set: 0.447386234998703
loss_pred:0.0167562123388052, decouple_loss:0.0007981084054335952
The modified gen p mean: 0.4490026831626892, gen p mean: -0.11459127068519592, mean p set: 0.4495777189731598
loss_pred:0.01735209859907627, decouple_loss:0.000954873685259372
Iteration: 1226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758859276771545, gen p mean: -0.1126633957028389, mean p set: 0.44816598296165466
loss_pred:0.018399043008685112, decouple_loss:0.0007377569563686848
The modified gen p mean: 0.44688379764556885, gen p mean: -0.11613786965608597, mean p set: 0.4474595785140991
loss_pred:0.016390275210142136, decouple_loss:0.0008977394318208098
The modified gen p mean: 0.4479721784591675, gen p mean: -0.11493844538927078, mean p set: 0.4485495090484619
loss_pred:0.017972711473703384, decouple_loss:0.0007315595867112279
Iteration: 1227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44850707054138184, gen p mean: -0.1120992973446846, mean p set: 0.44908249378204346
loss_pred:0.017158688977360725, decouple_loss:0.0008227810612879694
The modified gen p mean: 0.4462314248085022, gen p mean: -0.11683064699172974, mean p set: 0.4468069076538086
The modified gen p mean: 0.4468560516834259, gen p mean: -0.1128750741481781, mean p set: 0.4474305510520935
loss_pred:0.016452491283416748, decouple_loss:0.000700456730555743
loss_pred:0.017771711573004723, decouple_loss:0.00070157740265131
Iteration: 1228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464555084705353, gen p mean: -0.11125663667917252, mean p set: 0.4470323920249939
loss_pred:0.0175166092813015, decouple_loss:0.0006961261387914419
The modified gen p mean: 0.4472864270210266, gen p mean: -0.11318346112966537, mean p set: 0.44786348938941956
loss_pred:0.017046624794602394, decouple_loss:0.0007331778760999441
The modified gen p mean: 0.4467542767524719, gen p mean: -0.10930979996919632, mean p set: 0.4473304748535156
loss_pred:0.017305592074990273, decouple_loss:0.0007824085769243538
Iteration: 1229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736793637275696, gen p mean: -0.11650005728006363, mean p set: 0.4479442238807678
loss_pred:0.0171618964523077, decouple_loss:0.0007995737832970917
The modified gen p mean: 0.446876585483551, gen p mean: -0.112696573138237, mean p set: 0.44745010137557983
The modified gen p mean: 0.4498305916786194, gen p mean: -0.11642996221780777, mean p set: 0.45040658116340637
loss_pred:0.018220214173197746, decouple_loss:0.000703219382558018
loss_pred:0.0169195756316185, decouple_loss:0.0007642092532478273
Iteration: 1230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44689297676086426, gen p mean: -0.10892832279205322, mean p set: 0.4474692642688751
loss_pred:0.01813119649887085, decouple_loss:0.0006436547264456749
The modified gen p mean: 0.44717347621917725, gen p mean: -0.1150626465678215, mean p set: 0.4477509558200836
loss_pred:0.018473338335752487, decouple_loss:0.0007416014559566975
The modified gen p mean: 0.4468584358692169, gen p mean: -0.11381439119577408, mean p set: 0.44743403792381287
loss_pred:0.017994504421949387, decouple_loss:0.0007680836715735495
2023-05-01 03:50:08 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12122682482004166, mean p set: 0.4502691626548767
loss_pred:0.017302928492426872, decouple_loss:0.0011313874274492264
The modified gen p mean: 0.4495348036289215, gen p mean: -0.1147330030798912, mean p set: 0.4500633478164673
loss_pred:0.016880057752132416, decouple_loss:0.0010565387783572078
The modified gen p mean: 0.4498283863067627, gen p mean: -0.11390171945095062, mean p set: 0.45035696029663086
loss_pred:0.01711283251643181, decouple_loss:0.0009735345374792814
WV_1_PC_1_EH_0_PS_40, loss: 0.017151296138763428, avg_mse: 0.026675591245293617
current test mse: 0.026676
Iteration: 1231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465039074420929, gen p mean: -0.11744023114442825, mean p set: 0.4470786452293396
loss_pred:0.017246991395950317, decouple_loss:0.0008416284690611064
The modified gen p mean: 0.4465160667896271, gen p mean: -0.11435580253601074, mean p set: 0.44709256291389465
loss_pred:0.01735081896185875, decouple_loss:0.0010809662053361535
The modified gen p mean: 0.44741982221603394, gen p mean: -0.1200883686542511, mean p set: 0.447992742061615
loss_pred:0.017958642914891243, decouple_loss:0.0009376751841045916
Iteration: 1232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485655725002289, gen p mean: -0.1173965260386467, mean p set: 0.44914042949676514
loss_pred:0.01767498441040516, decouple_loss:0.0006962901097722352
The modified gen p mean: 0.44753801822662354, gen p mean: -0.11212097108364105, mean p set: 0.44811463356018066The modified gen p mean: 0.4491668939590454, gen p mean: -0.11783085018396378, mean p set: 0.44974398612976074
loss_pred:0.01836778037250042, decouple_loss:0.0007686582976020873
loss_pred:0.016532015055418015, decouple_loss:0.0009266895358450711
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
NaN value num: 0
Iteration: 1233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925278425216675, gen p mean: -0.1157127320766449, mean p set: 0.4498288631439209
loss_pred:0.016826683655381203, decouple_loss:0.0011035131756216288
The modified gen p mean: 0.45146089792251587, gen p mean: -0.1141643077135086, mean p set: 0.45203638076782227
The modified gen p mean: 0.4515370726585388, gen p mean: -0.11372573673725128, mean p set: 0.4521169364452362
loss_pred:0.015859505161643028, decouple_loss:0.0012233174638822675
loss_pred:0.015843618661165237, decouple_loss:0.0014158906415104866
Iteration: 1234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509091079235077, gen p mean: -0.11003416776657104, mean p set: 0.45148730278015137
loss_pred:0.016368350014090538, decouple_loss:0.0014206541236490011
The modified gen p mean: 0.45096197724342346, gen p mean: -0.11511411517858505, mean p set: 0.4515382945537567
loss_pred:0.015986047685146332, decouple_loss:0.0013431899715214968
The modified gen p mean: 0.45087724924087524, gen p mean: -0.10722500830888748, mean p set: 0.451455295085907
loss_pred:0.016115594655275345, decouple_loss:0.0012895070249214768
Iteration: 1235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516136944293976, gen p mean: -0.11019337922334671, mean p set: 0.4521912932395935
loss_pred:0.016291016712784767, decouple_loss:0.0010500591015443206
The modified gen p mean: 0.4510810673236847, gen p mean: -0.11042419075965881, mean p set: 0.45165911316871643
loss_pred:0.016535691916942596, decouple_loss:0.0010056764585897326
The modified gen p mean: 0.45061540603637695, gen p mean: -0.10711833089590073, mean p set: 0.45119374990463257
loss_pred:0.016807597130537033, decouple_loss:0.0011007363209500909
Iteration: 1236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517744183540344, gen p mean: -0.1129358559846878, mean p set: 0.45235124230384827
loss_pred:0.016107117757201195, decouple_loss:0.0010527325794100761
The modified gen p mean: 0.4511914551258087, gen p mean: -0.1010802760720253, mean p set: 0.4517684876918793
The modified gen p mean: 0.45076531171798706, gen p mean: -0.10988637804985046, mean p set: 0.4513408839702606
loss_pred:0.01690303534269333, decouple_loss:0.001509305788204074
loss_pred:0.015622872859239578, decouple_loss:0.0009879596764221787
Iteration: 1237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450535386800766, gen p mean: -0.10280721634626389, mean p set: 0.45111262798309326
loss_pred:0.01605229079723358, decouple_loss:0.0015763287665322423
The modified gen p mean: 0.4489930272102356, gen p mean: -0.11096984148025513, mean p set: 0.4495699107646942
The modified gen p mean: 0.45033663511276245, gen p mean: -0.10410624742507935, mean p set: 0.45091530680656433
loss_pred:0.017066756263375282, decouple_loss:0.0010386775247752666
loss_pred:0.016119861975312233, decouple_loss:0.001437047147192061
Iteration: 1238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451043039560318, gen p mean: -0.09327230602502823, mean p set: 0.45161959528923035
The modified gen p mean: 0.44923070073127747, gen p mean: -0.1011432558298111, mean p set: 0.4498084783554077
loss_pred:0.0163863692432642, decouple_loss:0.00128234236035496
loss_pred:0.01672113500535488, decouple_loss:0.0012292047031223774
The modified gen p mean: 0.4516107738018036, gen p mean: -0.1006452888250351, mean p set: 0.4521903395652771
loss_pred:0.01630176603794098, decouple_loss:0.0007978301728144288
Iteration: 1239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508880078792572, gen p mean: -0.09414472430944443, mean p set: 0.4514666199684143
loss_pred:0.01670490764081478, decouple_loss:0.0013504885137081146
The modified gen p mean: 0.4517981708049774, gen p mean: -0.0963812842965126, mean p set: 0.4523736536502838
loss_pred:0.016237420961260796, decouple_loss:0.0009743967093527317
The modified gen p mean: 0.4492637515068054, gen p mean: -0.10151863843202591, mean p set: 0.44983968138694763
loss_pred:0.015624523162841797, decouple_loss:0.0012387237511575222
Iteration: 1240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45088425278663635, gen p mean: -0.0983797088265419, mean p set: 0.45145851373672485
loss_pred:0.01596340909600258, decouple_loss:0.0008507577003911138
The modified gen p mean: 0.4513562321662903, gen p mean: -0.09851058572530746, mean p set: 0.4519319236278534
The modified gen p mean: 0.4481765925884247, gen p mean: -0.10989196598529816, mean p set: 0.4487546980381012
loss_pred:0.01607649400830269, decouple_loss:0.0011537442915141582
loss_pred:0.016496608033776283, decouple_loss:0.0013308991910889745
2023-05-01 03:52:55 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12063264101743698, mean p set: 0.4502691626548767
loss_pred:0.017616789788007736, decouple_loss:0.0015629386762157083
The modified gen p mean: 0.4495352506637573, gen p mean: -0.11427111178636551, mean p set: 0.4500633478164673
loss_pred:0.016961153596639633, decouple_loss:0.0013058508047834039
The modified gen p mean: 0.44982972741127014, gen p mean: -0.11338642239570618, mean p set: 0.45035696029663086
loss_pred:0.017219584435224533, decouple_loss:0.0012466917978599668
WV_1_PC_1_EH_0_PS_40, loss: 0.017334435135126114, avg_mse: 0.026775039732456207
current test mse: 0.026775
Iteration: 1241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937464594841003, gen p mean: -0.11127901077270508, mean p set: 0.449951171875
loss_pred:0.016753746196627617, decouple_loss:0.0012399436673149467
The modified gen p mean: 0.4515381455421448, gen p mean: -0.10161171108484268, mean p set: 0.452114462852478
loss_pred:0.016342278569936752, decouple_loss:0.0009504662593826652
The modified gen p mean: 0.45140424370765686, gen p mean: -0.10718733072280884, mean p set: 0.45198163390159607
loss_pred:0.0165617186576128, decouple_loss:0.0007832920528016984
Iteration: 1242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507613480091095, gen p mean: -0.10315586626529694, mean p set: 0.4513375163078308
loss_pred:0.016957134008407593, decouple_loss:0.0012444588355720043
The modified gen p mean: 0.44887036085128784, gen p mean: -0.11690299957990646, mean p set: 0.44944530725479126The modified gen p mean: 0.45143285393714905, gen p mean: -0.11030944436788559, mean p set: 0.4520106315612793
loss_pred:0.015686387196183205, decouple_loss:0.0009818056132644415
loss_pred:0.015924427658319473, decouple_loss:0.0013204889837652445
Iteration: 1243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449805349111557, gen p mean: -0.11023560911417007, mean p set: 0.45038190484046936
loss_pred:0.01605154760181904, decouple_loss:0.0010831115068867803
The modified gen p mean: 0.45167988538742065, gen p mean: -0.10966125875711441, mean p set: 0.4522576630115509The modified gen p mean: 0.4487018585205078, gen p mean: -0.11449603736400604, mean p set: 0.44927680492401123
loss_pred:0.01571241207420826, decouple_loss:0.0009962688200175762
loss_pred:0.018328890204429626, decouple_loss:0.0008594714454375207
Iteration: 1244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479082226753235, gen p mean: -0.11250696331262589, mean p set: 0.44848471879959106
loss_pred:0.015840495005249977, decouple_loss:0.0008137114928103983
The modified gen p mean: 0.4503922164440155, gen p mean: -0.10216258466243744, mean p set: 0.4509679973125458
loss_pred:0.016917137429118156, decouple_loss:0.0009964080527424812
The modified gen p mean: 0.44797903299331665, gen p mean: -0.11307801306247711, mean p set: 0.44855502247810364
loss_pred:0.015311557799577713, decouple_loss:0.0008742259815335274
Iteration: 1245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45020562410354614, gen p mean: -0.09423817694187164, mean p set: 0.45078280568122864
loss_pred:0.016581857576966286, decouple_loss:0.0010536512127146125
The modified gen p mean: 0.44941869378089905, gen p mean: -0.10606437921524048, mean p set: 0.4499944746494293
loss_pred:0.01598893105983734, decouple_loss:0.0009425986208952963
The modified gen p mean: 0.44914278388023376, gen p mean: -0.10610496252775192, mean p set: 0.4497178792953491
loss_pred:0.01632373407483101, decouple_loss:0.0008802575175650418
Iteration: 1246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510219097137451, gen p mean: -0.0947062075138092, mean p set: 0.4515971541404724
loss_pred:0.015786362811923027, decouple_loss:0.0011460703099146485
The modified gen p mean: 0.45132675766944885, gen p mean: -0.09728185832500458, mean p set: 0.4519042372703552
loss_pred:0.01617310382425785, decouple_loss:0.0009098119335249066
The modified gen p mean: 0.44987359642982483, gen p mean: -0.09886105358600616, mean p set: 0.45044994354248047
loss_pred:0.015424848534166813, decouple_loss:0.0008550926577299833
Iteration: 1247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491618275642395, gen p mean: -0.0947159081697464, mean p set: 0.4497377276420593
loss_pred:0.016259200870990753, decouple_loss:0.0010349465301260352
The modified gen p mean: 0.4494180977344513, gen p mean: -0.09977593272924423, mean p set: 0.44999441504478455
loss_pred:0.016793496906757355, decouple_loss:0.0007534766918979585
The modified gen p mean: 0.45215487480163574, gen p mean: -0.09468915313482285, mean p set: 0.4527328312397003
loss_pred:0.01569732464849949, decouple_loss:0.0009620385826565325
Iteration: 1248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489530026912689, gen p mean: -0.0971524640917778, mean p set: 0.4495277404785156
The modified gen p mean: 0.451886922121048, gen p mean: -0.09474881738424301, mean p set: 0.45246466994285583
loss_pred:0.01606450416147709, decouple_loss:0.0009120440809056163
loss_pred:0.015359816141426563, decouple_loss:0.0006785989971831441
The modified gen p mean: 0.4497038424015045, gen p mean: -0.09501799941062927, mean p set: 0.45028162002563477
loss_pred:0.0170491524040699, decouple_loss:0.0007747546187601984
Iteration: 1249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512724280357361, gen p mean: -0.09621178358793259, mean p set: 0.45184803009033203
loss_pred:0.015696000307798386, decouple_loss:0.0014523416757583618
The modified gen p mean: 0.45160889625549316, gen p mean: -0.0916004329919815, mean p set: 0.45218411087989807
The modified gen p mean: 0.4515025019645691, gen p mean: -0.08894935995340347, mean p set: 0.45207884907722473
loss_pred:0.016096757724881172, decouple_loss:0.0010971856536343694
loss_pred:0.016104847192764282, decouple_loss:0.0009174781735055149
Iteration: 1250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485572874546051, gen p mean: -0.09956520795822144, mean p set: 0.4491320550441742
loss_pred:0.016415642574429512, decouple_loss:0.0009690107544884086
The modified gen p mean: 0.45089593529701233, gen p mean: -0.09554523974657059, mean p set: 0.45147234201431274
The modified gen p mean: 0.45126330852508545, gen p mean: -0.09372366964817047, mean p set: 0.4518391489982605
loss_pred:0.01520632766187191, decouple_loss:0.0006772744236513972
loss_pred:0.01599896140396595, decouple_loss:0.0009448557975701988
2023-05-01 03:54:59 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10700223594903946, mean p set: 0.4502691626548767
loss_pred:0.01762918196618557, decouple_loss:0.00104071747045964
The modified gen p mean: 0.4495360255241394, gen p mean: -0.10080138593912125, mean p set: 0.4500633478164673
loss_pred:0.016956105828285217, decouple_loss:0.0010907761752605438
The modified gen p mean: 0.4498283863067627, gen p mean: -0.09969154745340347, mean p set: 0.45035696029663086
loss_pred:0.017208829522132874, decouple_loss:0.001271670451387763
WV_1_PC_1_EH_0_PS_40, loss: 0.017321426421403885, avg_mse: 0.02676793746650219
current test mse: 0.026768
Iteration: 1251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498855769634247, gen p mean: -0.10164108127355576, mean p set: 0.4504610598087311
loss_pred:0.016404494643211365, decouple_loss:0.0007441200432367623
The modified gen p mean: 0.4515538215637207, gen p mean: -0.09324712306261063, mean p set: 0.4521304666996002
loss_pred:0.01627650298178196, decouple_loss:0.0010087862610816956
The modified gen p mean: 0.449918657541275, gen p mean: -0.10026542842388153, mean p set: 0.4504970610141754
loss_pred:0.015997236594557762, decouple_loss:0.0007156524807214737
Iteration: 1252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479037821292877, gen p mean: -0.10127963125705719, mean p set: 0.44847941398620605
loss_pred:0.015543884597718716, decouple_loss:0.0008446263964287937
The modified gen p mean: 0.45000675320625305, gen p mean: -0.09224510937929153, mean p set: 0.4505823850631714The modified gen p mean: 0.4516078233718872, gen p mean: -0.09242475777864456, mean p set: 0.45218491554260254
loss_pred:0.016412481665611267, decouple_loss:0.0014053307240828872
loss_pred:0.015984993427991867, decouple_loss:0.0018067362252622843
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 1253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934818148612976, gen p mean: -0.10362247377634048, mean p set: 0.4499242305755615
loss_pred:0.015817802399396896, decouple_loss:0.0013840695610269904
The modified gen p mean: 0.4474792182445526, gen p mean: -0.10775552690029144, mean p set: 0.4480571746826172
loss_pred:0.016369137912988663, decouple_loss:0.0015681686345487833
The modified gen p mean: 0.4465351104736328, gen p mean: -0.09881618618965149, mean p set: 0.447110116481781
loss_pred:0.016762256622314453, decouple_loss:0.0016421148320659995
Iteration: 1254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473101794719696, gen p mean: -0.10101380944252014, mean p set: 0.4478845000267029
loss_pred:0.015312367118895054, decouple_loss:0.0008106499444693327
The modified gen p mean: 0.4457865059375763, gen p mean: -0.097857266664505, mean p set: 0.44636374711990356
loss_pred:0.015839949250221252, decouple_loss:0.0011000826489180326
The modified gen p mean: 0.44631776213645935, gen p mean: -0.10199785977602005, mean p set: 0.4468948543071747
loss_pred:0.015724491328001022, decouple_loss:0.0009972387924790382
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484272599220276, gen p mean: -0.09568843245506287, mean p set: 0.44900330901145935
loss_pred:0.015415825881063938, decouple_loss:0.001093057682737708
The modified gen p mean: 0.4465503990650177, gen p mean: -0.10051088780164719, mean p set: 0.4471263289451599
loss_pred:0.015123063698410988, decouple_loss:0.001041668700054288
The modified gen p mean: 0.44753333926200867, gen p mean: -0.09531088918447495, mean p set: 0.4481089115142822
loss_pred:0.01659812591969967, decouple_loss:0.001410827273502946
Iteration: 1256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797569513320923, gen p mean: -0.09579157829284668, mean p set: 0.4485537111759186
loss_pred:0.01696869358420372, decouple_loss:0.0012705139815807343
The modified gen p mean: 0.44789648056030273, gen p mean: -0.09842748194932938, mean p set: 0.448472261428833
loss_pred:0.015409437008202076, decouple_loss:0.0011787801049649715
The modified gen p mean: 0.44882282614707947, gen p mean: -0.0995924323797226, mean p set: 0.44939976930618286
loss_pred:0.015933062881231308, decouple_loss:0.001304871286265552
Iteration: 1257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960570335388184, gen p mean: -0.10338874906301498, mean p set: 0.45018208026885986
loss_pred:0.014577878639101982, decouple_loss:0.0009913899702951312
The modified gen p mean: 0.44774430990219116, gen p mean: -0.09893205761909485, mean p set: 0.44832107424736023
loss_pred:0.016417108476161957, decouple_loss:0.0010167885338887572
The modified gen p mean: 0.446687787771225, gen p mean: -0.09475131332874298, mean p set: 0.44726231694221497
loss_pred:0.01666695438325405, decouple_loss:0.0009164363727904856
Iteration: 1258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744041562080383, gen p mean: -0.09881827980279922, mean p set: 0.4480155408382416
The modified gen p mean: 0.44682198762893677, gen p mean: -0.10381238907575607, mean p set: 0.4473958909511566loss_pred:0.017032289877533913, decouple_loss:0.0010369783267378807
loss_pred:0.015698425471782684, decouple_loss:0.0014326651580631733
The modified gen p mean: 0.4491465389728546, gen p mean: -0.10421387106180191, mean p set: 0.4497232735157013
loss_pred:0.015274717472493649, decouple_loss:0.0010905744275078177
Iteration: 1259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487192630767822, gen p mean: -0.10763908922672272, mean p set: 0.44929543137550354
loss_pred:0.015447444282472134, decouple_loss:0.0009729148587211967
The modified gen p mean: 0.4479408860206604, gen p mean: -0.1048220619559288, mean p set: 0.4485156238079071
loss_pred:0.01507237646728754, decouple_loss:0.001113241771236062
The modified gen p mean: 0.44814333319664, gen p mean: -0.10683100670576096, mean p set: 0.4487214982509613
loss_pred:0.01627342216670513, decouple_loss:0.0009238612838089466
Iteration: 1260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476170241832733, gen p mean: -0.10477283596992493, mean p set: 0.4481905400753021
loss_pred:0.01584979146718979, decouple_loss:0.0008480523829348385
The modified gen p mean: 0.4477440416812897, gen p mean: -0.11117038130760193, mean p set: 0.4483180344104767
loss_pred:0.016201801598072052, decouple_loss:0.0010439652251079679
The modified gen p mean: 0.4482351839542389, gen p mean: -0.10638120770454407, mean p set: 0.4488097131252289
loss_pred:0.01586320996284485, decouple_loss:0.001007324201054871
2023-05-01 03:57:45 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11253801733255386, mean p set: 0.4502691626548767
loss_pred:0.01730714924633503, decouple_loss:0.0013186983997002244
The modified gen p mean: 0.4495352506637573, gen p mean: -0.1064058467745781, mean p set: 0.4500633478164673
loss_pred:0.01675330474972725, decouple_loss:0.001174958306364715
The modified gen p mean: 0.4498293995857239, gen p mean: -0.10529378056526184, mean p set: 0.45035696029663086
loss_pred:0.016989147290587425, decouple_loss:0.001394229824654758
WV_1_PC_1_EH_0_PS_40, loss: 0.017081331461668015, avg_mse: 0.02641615830361843
current test mse: 0.026416
At step 1260, Best test: 0.026416
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 1261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715777039527893, gen p mean: -0.1076289489865303, mean p set: 0.4477330446243286
loss_pred:0.015516558662056923, decouple_loss:0.0009873121744021773
The modified gen p mean: 0.4467608630657196, gen p mean: -0.11206215620040894, mean p set: 0.4473358392715454
loss_pred:0.015468152239918709, decouple_loss:0.0011212793178856373
The modified gen p mean: 0.4460482895374298, gen p mean: -0.1095723956823349, mean p set: 0.4466237425804138
loss_pred:0.015681756660342216, decouple_loss:0.001462806249037385
Iteration: 1262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482671320438385, gen p mean: -0.10917666554450989, mean p set: 0.4488431215286255
loss_pred:0.015155150555074215, decouple_loss:0.0009491483215242624
The modified gen p mean: 0.4473262429237366, gen p mean: -0.1132054328918457, mean p set: 0.4479025602340698
The modified gen p mean: 0.44768863916397095, gen p mean: -0.10780087858438492, mean p set: 0.4482649564743042
loss_pred:0.015194482170045376, decouple_loss:0.0009509220253676176
loss_pred:0.015596605837345123, decouple_loss:0.001116863451898098
Iteration: 1263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450064092874527, gen p mean: -0.11077045649290085, mean p set: 0.4506426155567169
loss_pred:0.015098183415830135, decouple_loss:0.0008977759280242026
The modified gen p mean: 0.4494590759277344, gen p mean: -0.10858645290136337, mean p set: 0.4500364065170288The modified gen p mean: 0.4467325806617737, gen p mean: -0.11190560460090637, mean p set: 0.447309285402298
loss_pred:0.01535644568502903, decouple_loss:0.0008543897420167923
loss_pred:0.015064663253724575, decouple_loss:0.000993179390206933
Iteration: 1264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469318985939026, gen p mean: -0.11328855901956558, mean p set: 0.44750893115997314
The modified gen p mean: 0.44679194688796997, gen p mean: -0.10771597176790237, mean p set: 0.447368323802948loss_pred:0.0153005076572299, decouple_loss:0.0008706703083589673
loss_pred:0.01568998582661152, decouple_loss:0.0013298795092850924
The modified gen p mean: 0.447908878326416, gen p mean: -0.1040002778172493, mean p set: 0.4484834671020508
loss_pred:0.01536298356950283, decouple_loss:0.0007956314948387444
Iteration: 1265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44999417662620544, gen p mean: -0.11197806149721146, mean p set: 0.4505683481693268
loss_pred:0.014840258285403252, decouple_loss:0.000899073260370642
The modified gen p mean: 0.44785577058792114, gen p mean: -0.10959944128990173, mean p set: 0.44843170046806335
loss_pred:0.015120286494493484, decouple_loss:0.000823484209831804
The modified gen p mean: 0.44894516468048096, gen p mean: -0.11281521618366241, mean p set: 0.44952166080474854
loss_pred:0.015299121849238873, decouple_loss:0.0007596825598739088
Iteration: 1266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469085931777954, gen p mean: -0.1174132227897644, mean p set: 0.4474853575229645
loss_pred:0.014950195327401161, decouple_loss:0.0008300062036141753
The modified gen p mean: 0.4476730525493622, gen p mean: -0.11475543677806854, mean p set: 0.4482479691505432
loss_pred:0.01594967395067215, decouple_loss:0.0007963003590703011
The modified gen p mean: 0.4469763934612274, gen p mean: -0.11384858191013336, mean p set: 0.44755110144615173
loss_pred:0.015869129449129105, decouple_loss:0.0007288309279829264
Iteration: 1267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479929506778717, gen p mean: -0.11631549149751663, mean p set: 0.4485693573951721
loss_pred:0.01495874859392643, decouple_loss:0.0012539573945105076
The modified gen p mean: 0.4469609260559082, gen p mean: -0.12008945643901825, mean p set: 0.4475356340408325
loss_pred:0.0151675371453166, decouple_loss:0.000932886847294867
The modified gen p mean: 0.44783881306648254, gen p mean: -0.11218293756246567, mean p set: 0.44841471314430237
loss_pred:0.0156993567943573, decouple_loss:0.000948471250012517
Iteration: 1268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460844397544861, gen p mean: -0.11399026960134506, mean p set: 0.44665804505348206
loss_pred:0.015314891003072262, decouple_loss:0.0009808766189962626
The modified gen p mean: 0.4474969804286957, gen p mean: -0.11852545291185379, mean p set: 0.4480707347393036
loss_pred:0.016521532088518143, decouple_loss:0.0008031112374737859
The modified gen p mean: 0.4481428265571594, gen p mean: -0.11578580737113953, mean p set: 0.44871997833251953
loss_pred:0.01511948648840189, decouple_loss:0.0010926896939054132
Iteration: 1269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811779260635376, gen p mean: -0.11401740461587906, mean p set: 0.44869574904441833
loss_pred:0.01573655568063259, decouple_loss:0.0008520691189914942
The modified gen p mean: 0.4476236402988434, gen p mean: -0.11384253203868866, mean p set: 0.44819900393486023
loss_pred:0.015197333879768848, decouple_loss:0.0008286501979455352
The modified gen p mean: 0.4480302035808563, gen p mean: -0.11299023032188416, mean p set: 0.44860541820526123
loss_pred:0.015640102326869965, decouple_loss:0.0008259131573140621
Iteration: 1270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475792944431305, gen p mean: -0.11234867572784424, mean p set: 0.4481564164161682
loss_pred:0.01519909780472517, decouple_loss:0.0010267491452395916
The modified gen p mean: 0.44812196493148804, gen p mean: -0.11160848289728165, mean p set: 0.4486992359161377
loss_pred:0.01608877256512642, decouple_loss:0.0009563046623952687
The modified gen p mean: 0.4470682442188263, gen p mean: -0.11337635666131973, mean p set: 0.4476448595523834
loss_pred:0.015658752992749214, decouple_loss:0.0011843657121062279
2023-05-01 03:59:56 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11501498520374298, mean p set: 0.4502691626548767
loss_pred:0.017331426963210106, decouple_loss:0.0008158215787261724
The modified gen p mean: 0.4495348036289215, gen p mean: -0.10886697471141815, mean p set: 0.4500633478164673
loss_pred:0.016716644167900085, decouple_loss:0.0009332219487987459
The modified gen p mean: 0.44983023405075073, gen p mean: -0.10814378410577774, mean p set: 0.45035696029663086
loss_pred:0.01696905866265297, decouple_loss:0.0008223176118917763
WV_1_PC_1_EH_0_PS_40, loss: 0.017048567533493042, avg_mse: 0.026401713490486145
current test mse: 0.026402
At step 1270, Best test: 0.026402
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 1271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483000636100769, gen p mean: -0.1098964735865593, mean p set: 0.4488748610019684
loss_pred:0.01611701212823391, decouple_loss:0.0009497999562881887
The modified gen p mean: 0.44833436608314514, gen p mean: -0.10937110334634781, mean p set: 0.4489106833934784
loss_pred:0.015435043722391129, decouple_loss:0.0007769890944473445
The modified gen p mean: 0.448444664478302, gen p mean: -0.11480234563350677, mean p set: 0.4490198791027069
loss_pred:0.015628263354301453, decouple_loss:0.001067370641976595
Iteration: 1272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448151558637619, gen p mean: -0.11269550025463104, mean p set: 0.4487282633781433
loss_pred:0.015444012358784676, decouple_loss:0.0007730291108600795
The modified gen p mean: 0.44908857345581055, gen p mean: -0.11415836215019226, mean p set: 0.449665904045105The modified gen p mean: 0.4470349848270416, gen p mean: -0.11236831545829773, mean p set: 0.4476125240325928
loss_pred:0.014753634110093117, decouple_loss:0.0007861718186177313
loss_pred:0.015559831634163857, decouple_loss:0.0007238824036903679
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 1273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719547033309937, gen p mean: -0.11364533007144928, mean p set: 0.4477703869342804
loss_pred:0.016144726425409317, decouple_loss:0.0011356363538652658
The modified gen p mean: 0.44721415638923645, gen p mean: -0.11275054514408112, mean p set: 0.4477914571762085
The modified gen p mean: 0.4481104910373688, gen p mean: -0.10721296817064285, mean p set: 0.44868743419647217
loss_pred:0.015291779302060604, decouple_loss:0.0013506903778761625
loss_pred:0.015649158507585526, decouple_loss:0.0017382092773914337
Iteration: 1274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44665801525115967, gen p mean: -0.1145997941493988, mean p set: 0.44723477959632874
loss_pred:0.016683898866176605, decouple_loss:0.00087347551016137
The modified gen p mean: 0.4475688934326172, gen p mean: -0.10500836372375488, mean p set: 0.4481446444988251
loss_pred:0.01659182831645012, decouple_loss:0.0009608201798982918
The modified gen p mean: 0.4464346766471863, gen p mean: -0.11457551270723343, mean p set: 0.44701075553894043
loss_pred:0.015864992514252663, decouple_loss:0.0008173305541276932
Iteration: 1275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478493630886078, gen p mean: -0.11231647431850433, mean p set: 0.44842514395713806
loss_pred:0.01580427587032318, decouple_loss:0.0008771444554440677
The modified gen p mean: 0.4474474787712097, gen p mean: -0.11533255875110626, mean p set: 0.44802361726760864
loss_pred:0.015360736288130283, decouple_loss:0.0008369047427549958
The modified gen p mean: 0.44852936267852783, gen p mean: -0.11127431690692902, mean p set: 0.44910916686058044
loss_pred:0.01611017994582653, decouple_loss:0.0007759901345707476
Iteration: 1276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470868706703186, gen p mean: -0.114284947514534, mean p set: 0.4476657211780548
loss_pred:0.015426521189510822, decouple_loss:0.0013271120842546225
The modified gen p mean: 0.44689619541168213, gen p mean: -0.11289387196302414, mean p set: 0.44747352600097656
loss_pred:0.015864131972193718, decouple_loss:0.001130555639974773
The modified gen p mean: 0.44737565517425537, gen p mean: -0.10656315088272095, mean p set: 0.4479510188102722
loss_pred:0.016114363446831703, decouple_loss:0.0010263161966577172
Iteration: 1277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671404361724854, gen p mean: -0.11776712536811829, mean p set: 0.4472888708114624
loss_pred:0.015376342460513115, decouple_loss:0.0007113300380297005
The modified gen p mean: 0.44759801030158997, gen p mean: -0.11643221974372864, mean p set: 0.44817429780960083
The modified gen p mean: 0.44801536202430725, gen p mean: -0.11458244174718857, mean p set: 0.4485948383808136
loss_pred:0.015669086948037148, decouple_loss:0.0008709658868610859
loss_pred:0.015642857179045677, decouple_loss:0.0008302271016873419
Iteration: 1278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470239579677582, gen p mean: -0.11004120111465454, mean p set: 0.4476010799407959
loss_pred:0.015741318464279175, decouple_loss:0.000719253032002598
The modified gen p mean: 0.4481695890426636, gen p mean: -0.11759728938341141, mean p set: 0.4487501382827759
loss_pred:0.015262167900800705, decouple_loss:0.000875887053553015
The modified gen p mean: 0.44726958870887756, gen p mean: -0.1139378696680069, mean p set: 0.4478473961353302
loss_pred:0.01622927375137806, decouple_loss:0.0008182825986295938
Iteration: 1279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467872679233551, gen p mean: -0.11236216127872467, mean p set: 0.44736161828041077
loss_pred:0.015169966034591198, decouple_loss:0.0009167668176814914
The modified gen p mean: 0.4472459852695465, gen p mean: -0.10765648633241653, mean p set: 0.4478200376033783
The modified gen p mean: 0.44714170694351196, gen p mean: -0.10650453716516495, mean p set: 0.44771599769592285
loss_pred:0.01610586978495121, decouple_loss:0.0009202774381265044
loss_pred:0.015373029746115208, decouple_loss:0.0011312642600387335
Iteration: 1280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484577476978302, gen p mean: -0.11791976541280746, mean p set: 0.4490325152873993
loss_pred:0.015077941119670868, decouple_loss:0.0008139422861859202
The modified gen p mean: 0.44830724596977234, gen p mean: -0.11058685183525085, mean p set: 0.4488847255706787
loss_pred:0.015351803973317146, decouple_loss:0.0008511545602232218
The modified gen p mean: 0.44724538922309875, gen p mean: -0.10752558708190918, mean p set: 0.44782111048698425
loss_pred:0.016109628602862358, decouple_loss:0.0007852739654481411
2023-05-01 04:02:49 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11490271240472794, mean p set: 0.4502691626548767
loss_pred:0.01727781444787979, decouple_loss:0.0007650896441191435
The modified gen p mean: 0.449533611536026, gen p mean: -0.1090753972530365, mean p set: 0.4500633478164673
loss_pred:0.016606317833065987, decouple_loss:0.0007557076751254499
The modified gen p mean: 0.44982653856277466, gen p mean: -0.1082506850361824, mean p set: 0.45035696029663086
loss_pred:0.016965201124548912, decouple_loss:0.0008502946584485471
WV_1_PC_1_EH_0_PS_40, loss: 0.016989296302199364, avg_mse: 0.026423655450344086
current test mse: 0.026424
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480486214160919, gen p mean: -0.11075092852115631, mean p set: 0.44862401485443115
loss_pred:0.0161573626101017, decouple_loss:0.000641105929389596
The modified gen p mean: 0.4467187225818634, gen p mean: -0.11539241671562195, mean p set: 0.4472969174385071
loss_pred:0.015120009891688824, decouple_loss:0.000967042928095907
The modified gen p mean: 0.4471982717514038, gen p mean: -0.10914068669080734, mean p set: 0.4477764964103699
loss_pred:0.015489288605749607, decouple_loss:0.0007242864230647683
Iteration: 1282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784989953041077, gen p mean: -0.11323244869709015, mean p set: 0.4484269320964813
loss_pred:0.015222189016640186, decouple_loss:0.0007464561494998634
The modified gen p mean: 0.44773560762405396, gen p mean: -0.11564890295267105, mean p set: 0.4483122229576111The modified gen p mean: 0.44814133644104004, gen p mean: -0.11125017702579498, mean p set: 0.44871804118156433
loss_pred:0.015257390215992928, decouple_loss:0.0006769657484255731loss_pred:0.015483854338526726, decouple_loss:0.0006924399640411139
Iteration: 1283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806668162345886, gen p mean: -0.113130122423172, mean p set: 0.4486437737941742
loss_pred:0.015316435135900974, decouple_loss:0.0008345880196429789
The modified gen p mean: 0.44770801067352295, gen p mean: -0.11795961856842041, mean p set: 0.4482831358909607
loss_pred:0.01542308833450079, decouple_loss:0.0008848783909343183
The modified gen p mean: 0.4482268691062927, gen p mean: -0.11617279052734375, mean p set: 0.44880321621894836
loss_pred:0.015609580092132092, decouple_loss:0.000780400587245822
Iteration: 1284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751811027526855, gen p mean: -0.1147032082080841, mean p set: 0.4480918347835541
loss_pred:0.01618172600865364, decouple_loss:0.0006205109530128539
The modified gen p mean: 0.4473605453968048, gen p mean: -0.11762037128210068, mean p set: 0.44793686270713806
loss_pred:0.015583047643303871, decouple_loss:0.0006033932440914214
The modified gen p mean: 0.4472599923610687, gen p mean: -0.1209513247013092, mean p set: 0.4478357136249542
loss_pred:0.015302473679184914, decouple_loss:0.0007102227536961436
Iteration: 1285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723019003868103, gen p mean: -0.12017806619405746, mean p set: 0.44780635833740234
The modified gen p mean: 0.4465094804763794, gen p mean: -0.11751708388328552, mean p set: 0.4470870792865753
loss_pred:0.015987306833267212, decouple_loss:0.0009998066816478968
loss_pred:0.01621897518634796, decouple_loss:0.0006781778065487742
The modified gen p mean: 0.44872522354125977, gen p mean: -0.1196395754814148, mean p set: 0.44930416345596313
loss_pred:0.015459040179848671, decouple_loss:0.0010305831674486399
Iteration: 1286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678565859794617, gen p mean: -0.11212290823459625, mean p set: 0.44736430048942566
loss_pred:0.015468240715563297, decouple_loss:0.0009936981368809938
The modified gen p mean: 0.44766518473625183, gen p mean: -0.11711087822914124, mean p set: 0.4482421875
loss_pred:0.015211482532322407, decouple_loss:0.0008634881232865155
The modified gen p mean: 0.4465128481388092, gen p mean: -0.11836855858564377, mean p set: 0.44708749651908875
loss_pred:0.015867620706558228, decouple_loss:0.0008805894758552313
Iteration: 1287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473314583301544, gen p mean: -0.11577999591827393, mean p set: 0.4479072690010071
loss_pred:0.015020297840237617, decouple_loss:0.0007720877765677869
The modified gen p mean: 0.44673165678977966, gen p mean: -0.11072157323360443, mean p set: 0.4473079442977905
loss_pred:0.015480652451515198, decouple_loss:0.0006244846736080945
The modified gen p mean: 0.4468443989753723, gen p mean: -0.11443257331848145, mean p set: 0.44742023944854736
loss_pred:0.01551646925508976, decouple_loss:0.0006924610352143645
Iteration: 1288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806110858917236, gen p mean: -0.11341340094804764, mean p set: 0.44864028692245483
loss_pred:0.015813807025551796, decouple_loss:0.0010195357026532292
The modified gen p mean: 0.44921207427978516, gen p mean: -0.1197076216340065, mean p set: 0.4497888684272766
The modified gen p mean: 0.4469960629940033, gen p mean: -0.11395008862018585, mean p set: 0.4475705623626709
loss_pred:0.015092774294316769, decouple_loss:0.0009762055706232786
loss_pred:0.015101365745067596, decouple_loss:0.0008293979917652905
Iteration: 1289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790634512901306, gen p mean: -0.11625415086746216, mean p set: 0.4484843611717224
loss_pred:0.015385409817099571, decouple_loss:0.0009243859676644206
The modified gen p mean: 0.44715484976768494, gen p mean: -0.11610710620880127, mean p set: 0.4477294087409973
The modified gen p mean: 0.4478561282157898, gen p mean: -0.1177469789981842, mean p set: 0.44843074679374695
loss_pred:0.015896422788500786, decouple_loss:0.0008983520092442632
loss_pred:0.015474711544811726, decouple_loss:0.0011803106172010303
Iteration: 1290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476471543312073, gen p mean: -0.11696465313434601, mean p set: 0.44822028279304504
loss_pred:0.015189290046691895, decouple_loss:0.0007650636252947152
The modified gen p mean: 0.4465521574020386, gen p mean: -0.1247222051024437, mean p set: 0.4471310079097748
loss_pred:0.014935201033949852, decouple_loss:0.0006163162179291248
The modified gen p mean: 0.4475661814212799, gen p mean: -0.11406891793012619, mean p set: 0.4481441080570221
loss_pred:0.015301152132451534, decouple_loss:0.0007730988436378539
2023-05-01 04:04:54 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12476011365652084, mean p set: 0.4502691626548767
loss_pred:0.01730082370340824, decouple_loss:0.0008990976493805647
The modified gen p mean: 0.4495339095592499, gen p mean: -0.11892145872116089, mean p set: 0.4500633478164673
loss_pred:0.016640832647681236, decouple_loss:0.0009960889583453536
The modified gen p mean: 0.4498293995857239, gen p mean: -0.11826063692569733, mean p set: 0.45035696029663086
loss_pred:0.01697285659611225, decouple_loss:0.0009939275914803147
WV_1_PC_1_EH_0_PS_40, loss: 0.01701965741813183, avg_mse: 0.026467401534318924
current test mse: 0.026467
Iteration: 1291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44613057374954224, gen p mean: -0.1197739914059639, mean p set: 0.44670602679252625
loss_pred:0.01615247316658497, decouple_loss:0.0008106453460641205
The modified gen p mean: 0.4471803605556488, gen p mean: -0.12172391265630722, mean p set: 0.4477572739124298
loss_pred:0.01610281877219677, decouple_loss:0.0007554678595624864
The modified gen p mean: 0.4473414123058319, gen p mean: -0.11689692735671997, mean p set: 0.4479181170463562
loss_pred:0.015333136543631554, decouple_loss:0.001071370905265212
Iteration: 1292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466744065284729, gen p mean: -0.12572243809700012, mean p set: 0.4472491443157196
The modified gen p mean: 0.44712507724761963, gen p mean: -0.12240129709243774, mean p set: 0.4476999342441559
loss_pred:0.01523512601852417, decouple_loss:0.0006489612860605121
loss_pred:0.015309624373912811, decouple_loss:0.0009568987879902124
The modified gen p mean: 0.44679880142211914, gen p mean: -0.12260828167200089, mean p set: 0.44737330079078674
loss_pred:0.01517044473439455, decouple_loss:0.0007525411201640964
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 1293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44867247343063354, gen p mean: -0.12155293673276901, mean p set: 0.44924822449684143
loss_pred:0.015113134868443012, decouple_loss:0.0007308025378733873
The modified gen p mean: 0.44681429862976074, gen p mean: -0.12655606865882874, mean p set: 0.4473881721496582
loss_pred:0.015615561045706272, decouple_loss:0.0005889563472010195
The modified gen p mean: 0.446943074464798, gen p mean: -0.12273669242858887, mean p set: 0.4475173056125641
loss_pred:0.015610737726092339, decouple_loss:0.0007213981589302421
Iteration: 1294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483996629714966, gen p mean: -0.12074270099401474, mean p set: 0.44897761940956116
loss_pred:0.015393884852528572, decouple_loss:0.00076042499858886
The modified gen p mean: 0.44734498858451843, gen p mean: -0.12290199100971222, mean p set: 0.4479212760925293
loss_pred:0.015275221318006516, decouple_loss:0.0006496690912172198
The modified gen p mean: 0.4483627378940582, gen p mean: -0.12652012705802917, mean p set: 0.448940247297287
loss_pred:0.01548844389617443, decouple_loss:0.0009206118411384523
Iteration: 1295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879457354545593, gen p mean: -0.11807049810886383, mean p set: 0.44937047362327576
loss_pred:0.015838921070098877, decouple_loss:0.0007737143896520138
The modified gen p mean: 0.4475128650665283, gen p mean: -0.11447641998529434, mean p set: 0.4480895698070526
loss_pred:0.01513610314577818, decouple_loss:0.0007397289737127721
The modified gen p mean: 0.44668370485305786, gen p mean: -0.11748845875263214, mean p set: 0.4472596049308777
loss_pred:0.015503687784075737, decouple_loss:0.0006557296146638691
Iteration: 1296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791898131370544, gen p mean: -0.10802718997001648, mean p set: 0.4484962224960327
loss_pred:0.015270771458745003, decouple_loss:0.000655159296002239
The modified gen p mean: 0.44804584980010986, gen p mean: -0.11281745880842209, mean p set: 0.44862261414527893
loss_pred:0.014992188662290573, decouple_loss:0.0006336700753308833
The modified gen p mean: 0.4476426839828491, gen p mean: -0.11386286467313766, mean p set: 0.44821637868881226
loss_pred:0.01556866243481636, decouple_loss:0.0007885558879934251
Iteration: 1297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472269117832184, gen p mean: -0.11128654330968857, mean p set: 0.44780340790748596
loss_pred:0.015351570211350918, decouple_loss:0.0005628010840155184
The modified gen p mean: 0.44780316948890686, gen p mean: -0.1103113442659378, mean p set: 0.4483788311481476
loss_pred:0.015496145002543926, decouple_loss:0.0009738653316162527
The modified gen p mean: 0.44669753313064575, gen p mean: -0.11132082343101501, mean p set: 0.44727250933647156
loss_pred:0.015450900420546532, decouple_loss:0.0005560142453759909
Iteration: 1298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480787217617035, gen p mean: -0.10531656444072723, mean p set: 0.4486541748046875
loss_pred:0.015583128668367863, decouple_loss:0.000763069256208837
The modified gen p mean: 0.44713911414146423, gen p mean: -0.10780978202819824, mean p set: 0.4477144777774811
loss_pred:0.015070749446749687, decouple_loss:0.0006815973320044577
The modified gen p mean: 0.44794464111328125, gen p mean: -0.1112046092748642, mean p set: 0.44852009415626526
loss_pred:0.015061571262776852, decouple_loss:0.0005899176467210054
Iteration: 1299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745659828186035, gen p mean: -0.10701531916856766, mean p set: 0.4480327069759369
loss_pred:0.014890666119754314, decouple_loss:0.0007091253064572811
The modified gen p mean: 0.44760647416114807, gen p mean: -0.10863953828811646, mean p set: 0.4481835961341858
loss_pred:0.015356703661382198, decouple_loss:0.0007774833356961608
The modified gen p mean: 0.4469248056411743, gen p mean: -0.1091187447309494, mean p set: 0.4475003480911255
loss_pred:0.015253099612891674, decouple_loss:0.0007217038073576987
Iteration: 1300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473969042301178, gen p mean: -0.10912682116031647, mean p set: 0.4479711353778839
loss_pred:0.01543069165199995, decouple_loss:0.0010189777240157127
The modified gen p mean: 0.44752931594848633, gen p mean: -0.10883896052837372, mean p set: 0.4481063485145569
loss_pred:0.015723994001746178, decouple_loss:0.0007880022167228162
The modified gen p mean: 0.44734200835227966, gen p mean: -0.10782023519277573, mean p set: 0.44791606068611145
loss_pred:0.015711696818470955, decouple_loss:0.0007212524069473147
2023-05-01 04:07:41 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11574168503284454, mean p set: 0.4502691626548767
loss_pred:0.0172796081751585, decouple_loss:0.0007800889434292912
The modified gen p mean: 0.44953399896621704, gen p mean: -0.1105356514453888, mean p set: 0.4500633478164673
loss_pred:0.016668548807501793, decouple_loss:0.0007855042349547148
The modified gen p mean: 0.4498271644115448, gen p mean: -0.11030365526676178, mean p set: 0.45035696029663086
loss_pred:0.017000889405608177, decouple_loss:0.0007090604631230235
WV_1_PC_1_EH_0_PS_40, loss: 0.017020925879478455, avg_mse: 0.026480425149202347
current test mse: 0.02648
Iteration: 1301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737812876701355, gen p mean: -0.11200463026762009, mean p set: 0.4479547441005707
loss_pred:0.014839773066341877, decouple_loss:0.0008508699247613549
The modified gen p mean: 0.44720950722694397, gen p mean: -0.11300504952669144, mean p set: 0.44778600335121155The modified gen p mean: 0.44733259081840515, gen p mean: -0.10758457332849503, mean p set: 0.4479072690010071
loss_pred:0.015316569246351719, decouple_loss:0.0006832288927398622
loss_pred:0.015488709323108196, decouple_loss:0.000796735635958612
Iteration: 1302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44709062576293945, gen p mean: -0.1178082674741745, mean p set: 0.4476650059223175
loss_pred:0.015586726367473602, decouple_loss:0.0006988332024775445
The modified gen p mean: 0.4471043348312378, gen p mean: -0.11459755152463913, mean p set: 0.4476828873157501The modified gen p mean: 0.4461876153945923, gen p mean: -0.11235731840133667, mean p set: 0.44676437973976135
loss_pred:0.014850691892206669, decouple_loss:0.0008653267868794501
loss_pred:0.01521889865398407, decouple_loss:0.0008428095607087016
Iteration: 1303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859474897384644, gen p mean: -0.11160439252853394, mean p set: 0.44917070865631104
The modified gen p mean: 0.447190523147583, gen p mean: -0.11938438564538956, mean p set: 0.4477669298648834
loss_pred:0.01528694573789835, decouple_loss:0.0007340325973927975
loss_pred:0.01544087566435337, decouple_loss:0.0006820847629569471
The modified gen p mean: 0.44719019532203674, gen p mean: -0.11573687940835953, mean p set: 0.4477671980857849
loss_pred:0.015172326005995274, decouple_loss:0.000677207950502634
Iteration: 1304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677942991256714, gen p mean: -0.11252395808696747, mean p set: 0.4473542869091034
loss_pred:0.014984468929469585, decouple_loss:0.0006198521587066352
The modified gen p mean: 0.44781193137168884, gen p mean: -0.11414512246847153, mean p set: 0.44838836789131165
loss_pred:0.014805163256824017, decouple_loss:0.0006479503936134279
The modified gen p mean: 0.447638601064682, gen p mean: -0.1137266606092453, mean p set: 0.4482133686542511
loss_pred:0.015375757589936256, decouple_loss:0.0007691467180848122
Iteration: 1305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44675734639167786, gen p mean: -0.11969885230064392, mean p set: 0.4473342299461365
loss_pred:0.015278292819857597, decouple_loss:0.0009192288271151483
The modified gen p mean: 0.44772717356681824, gen p mean: -0.115069180727005, mean p set: 0.4483039677143097
loss_pred:0.014779986813664436, decouple_loss:0.0008088613976724446
The modified gen p mean: 0.4473239481449127, gen p mean: -0.11582731455564499, mean p set: 0.44789940118789673
loss_pred:0.01575271598994732, decouple_loss:0.0008811631705611944
Iteration: 1306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478013813495636, gen p mean: -0.11443748325109482, mean p set: 0.44837847352027893
loss_pred:0.015181864611804485, decouple_loss:0.0007270493661053479
The modified gen p mean: 0.4475599229335785, gen p mean: -0.12022288143634796, mean p set: 0.44813501834869385
loss_pred:0.015465197153389454, decouple_loss:0.000791265512816608
The modified gen p mean: 0.4474242627620697, gen p mean: -0.11546985805034637, mean p set: 0.44800058007240295
loss_pred:0.014502963051199913, decouple_loss:0.0008840180234983563
Iteration: 1307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482930898666382, gen p mean: -0.11852113902568817, mean p set: 0.44886934757232666
loss_pred:0.015068264678120613, decouple_loss:0.0011090090265497565
The modified gen p mean: 0.446382075548172, gen p mean: -0.11698728799819946, mean p set: 0.44695839285850525
loss_pred:0.015045621432363987, decouple_loss:0.000905277905985713
The modified gen p mean: 0.44645264744758606, gen p mean: -0.1182260662317276, mean p set: 0.4470282196998596
loss_pred:0.014788893051445484, decouple_loss:0.000905217370018363
Iteration: 1308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455326795578003, gen p mean: -0.11293250322341919, mean p set: 0.4461096227169037
loss_pred:0.01503788959234953, decouple_loss:0.0007348799263127148
The modified gen p mean: 0.4462879002094269, gen p mean: -0.11376645416021347, mean p set: 0.4468632936477661
The modified gen p mean: 0.4485573172569275, gen p mean: -0.11057902872562408, mean p set: 0.44913291931152344
loss_pred:0.015186036936938763, decouple_loss:0.000796484062448144
loss_pred:0.015472723171114922, decouple_loss:0.000937286822590977
Iteration: 1309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476052522659302, gen p mean: -0.11031796783208847, mean p set: 0.4481825828552246
loss_pred:0.014648400247097015, decouple_loss:0.0006074361735954881
The modified gen p mean: 0.44588351249694824, gen p mean: -0.11042468994855881, mean p set: 0.44645851850509644
The modified gen p mean: 0.4476011395454407, gen p mean: -0.11523465812206268, mean p set: 0.44817450642585754
loss_pred:0.014855998568236828, decouple_loss:0.0006219772039912641
loss_pred:0.01533898152410984, decouple_loss:0.0009235445177182555
Iteration: 1310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480253756046295, gen p mean: -0.10849637538194656, mean p set: 0.44860079884529114
loss_pred:0.015108433552086353, decouple_loss:0.001071623875759542
The modified gen p mean: 0.4468648433685303, gen p mean: -0.11585061997175217, mean p set: 0.4474402070045471
The modified gen p mean: 0.44684383273124695, gen p mean: -0.11380816996097565, mean p set: 0.4474206268787384
loss_pred:0.015488105826079845, decouple_loss:0.0009530384559184313
loss_pred:0.015271337702870369, decouple_loss:0.0008610141230747104
2023-05-01 04:09:46 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11559472978115082, mean p set: 0.4502691626548767
loss_pred:0.01725059375166893, decouple_loss:0.0008708383538760245
The modified gen p mean: 0.4495352506637573, gen p mean: -0.11080493777990341, mean p set: 0.4500633478164673
loss_pred:0.01663023978471756, decouple_loss:0.0008520832634530962
The modified gen p mean: 0.4498293399810791, gen p mean: -0.11013965308666229, mean p set: 0.45035696029663086
loss_pred:0.01696186140179634, decouple_loss:0.0008928931783884764
WV_1_PC_1_EH_0_PS_40, loss: 0.016991160809993744, avg_mse: 0.02640603296458721
current test mse: 0.026406
Iteration: 1311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485478103160858, gen p mean: -0.10644077509641647, mean p set: 0.4491216838359833
loss_pred:0.014809226617217064, decouple_loss:0.0009989305399358273
The modified gen p mean: 0.44772765040397644, gen p mean: -0.11242184042930603, mean p set: 0.4483005702495575The modified gen p mean: 0.4485718011856079, gen p mean: -0.11312738806009293, mean p set: 0.4491502642631531
loss_pred:0.015585260465741158, decouple_loss:0.0009747201693244278loss_pred:0.015495848841965199, decouple_loss:0.0008152638911269605
Iteration: 1312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476892650127411, gen p mean: -0.10673681646585464, mean p set: 0.4482652246952057
loss_pred:0.014921290799975395, decouple_loss:0.0006883683963678777
The modified gen p mean: 0.44762134552001953, gen p mean: -0.10842259973287582, mean p set: 0.4481982886791229
The modified gen p mean: 0.44802385568618774, gen p mean: -0.10856150090694427, mean p set: 0.44860121607780457
loss_pred:0.014330504462122917, decouple_loss:0.0006979417521506548
loss_pred:0.014942947775125504, decouple_loss:0.0008919463725760579
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 1313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479007124900818, gen p mean: -0.11475475132465363, mean p set: 0.4484758675098419
loss_pred:0.015282792039215565, decouple_loss:0.0009644716628827155
The modified gen p mean: 0.44866588711738586, gen p mean: -0.09881089627742767, mean p set: 0.44924309849739075
The modified gen p mean: 0.4479505121707916, gen p mean: -0.11250190436840057, mean p set: 0.4485274851322174
loss_pred:0.015376321971416473, decouple_loss:0.001094935112632811
loss_pred:0.015285853296518326, decouple_loss:0.0010598370572552085
Iteration: 1314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474303126335144, gen p mean: -0.10847288370132446, mean p set: 0.44800853729248047
loss_pred:0.01537370029836893, decouple_loss:0.0007170297321863472
The modified gen p mean: 0.4464265704154968, gen p mean: -0.11178500205278397, mean p set: 0.44700247049331665
loss_pred:0.015651682391762733, decouple_loss:0.0007929413113743067
The modified gen p mean: 0.44838637113571167, gen p mean: -0.10764896124601364, mean p set: 0.4489628076553345
loss_pred:0.015024690888822079, decouple_loss:0.0008043200941756368
Iteration: 1315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479908049106598, gen p mean: -0.10305559635162354, mean p set: 0.4485653042793274
loss_pred:0.014385423623025417, decouple_loss:0.000805571093223989
The modified gen p mean: 0.44769611954689026, gen p mean: -0.10929767787456512, mean p set: 0.44827136397361755
loss_pred:0.015076793730258942, decouple_loss:0.0008167788037098944
The modified gen p mean: 0.446419358253479, gen p mean: -0.10345286130905151, mean p set: 0.4469953179359436
loss_pred:0.01511224266141653, decouple_loss:0.0006438895943574607
Iteration: 1316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789639115333557, gen p mean: -0.10480169951915741, mean p set: 0.44847285747528076
The modified gen p mean: 0.446818083524704, gen p mean: -0.10245227813720703, mean p set: 0.44739410281181335
loss_pred:0.014910930767655373, decouple_loss:0.0006944384658709168
loss_pred:0.01643001101911068, decouple_loss:0.0008058603852987289
The modified gen p mean: 0.4482016861438751, gen p mean: -0.10363699495792389, mean p set: 0.44877946376800537
loss_pred:0.014430181123316288, decouple_loss:0.000829884025733918
Iteration: 1317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717347621917725, gen p mean: -0.10754695534706116, mean p set: 0.4477514624595642
loss_pred:0.014835388399660587, decouple_loss:0.0007128342986106873
The modified gen p mean: 0.4477514922618866, gen p mean: -0.10600191354751587, mean p set: 0.44832685589790344
loss_pred:0.015048126690089703, decouple_loss:0.0007160380482673645
The modified gen p mean: 0.4473307430744171, gen p mean: -0.10697509348392487, mean p set: 0.44790735840797424
loss_pred:0.015193996019661427, decouple_loss:0.0007065346580930054
Iteration: 1318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482951760292053, gen p mean: -0.10309967398643494, mean p set: 0.4488696753978729
loss_pred:0.014473403804004192, decouple_loss:0.0007434203871525824
The modified gen p mean: 0.4464559257030487, gen p mean: -0.10522142797708511, mean p set: 0.4470299780368805
loss_pred:0.01577777974307537, decouple_loss:0.0008090107003226876
The modified gen p mean: 0.4472253918647766, gen p mean: -0.11054648458957672, mean p set: 0.4478025436401367
loss_pred:0.015241995453834534, decouple_loss:0.000784100207965821
Iteration: 1319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721680879592896, gen p mean: -0.10627677291631699, mean p set: 0.44779151678085327
loss_pred:0.014884071424603462, decouple_loss:0.000741108669899404
The modified gen p mean: 0.44619137048721313, gen p mean: -0.10505422204732895, mean p set: 0.44676467776298523
The modified gen p mean: 0.44809436798095703, gen p mean: -0.10413369536399841, mean p set: 0.4486709535121918
loss_pred:0.014745228923857212, decouple_loss:0.0009530793759040534
loss_pred:0.014306186698377132, decouple_loss:0.0008664904744364321
Iteration: 1320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480396509170532, gen p mean: -0.11293506622314453, mean p set: 0.4486168920993805
loss_pred:0.014949723146855831, decouple_loss:0.0006533551495522261
The modified gen p mean: 0.44662120938301086, gen p mean: -0.11407238245010376, mean p set: 0.4471994936466217
The modified gen p mean: 0.4486084282398224, gen p mean: -0.10779798775911331, mean p set: 0.449184387922287
loss_pred:0.01548545341938734, decouple_loss:0.0009676952613517642
loss_pred:0.014909805729985237, decouple_loss:0.0006807162426412106
2023-05-01 04:12:33 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11508822441101074, mean p set: 0.4502691626548767
loss_pred:0.017228199169039726, decouple_loss:0.0007568340515717864
The modified gen p mean: 0.4495363235473633, gen p mean: -0.11013174057006836, mean p set: 0.4500633478164673
loss_pred:0.016578277572989464, decouple_loss:0.0009041409357450902
The modified gen p mean: 0.4498269259929657, gen p mean: -0.10984241962432861, mean p set: 0.45035696029663086
loss_pred:0.016913920640945435, decouple_loss:0.0009359624236822128
WV_1_PC_1_EH_0_PS_40, loss: 0.016950082033872604, avg_mse: 0.02633999101817608
current test mse: 0.02634
At step 1320, Best test: 0.02634
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 1321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473704397678375, gen p mean: -0.11313209682703018, mean p set: 0.4479469656944275
loss_pred:0.015333610586822033, decouple_loss:0.0008884897688403726
The modified gen p mean: 0.44765958189964294, gen p mean: -0.1135801300406456, mean p set: 0.4482361972332001
loss_pred:0.014962572604417801, decouple_loss:0.0009109218954108655
The modified gen p mean: 0.4471437633037567, gen p mean: -0.11357567459344864, mean p set: 0.44772061705589294
loss_pred:0.014981715939939022, decouple_loss:0.0006679784273728728
Iteration: 1322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470173418521881, gen p mean: -0.11319126933813095, mean p set: 0.44759422540664673
loss_pred:0.015119335614144802, decouple_loss:0.0006797310197725892
The modified gen p mean: 0.4478044807910919, gen p mean: -0.10677625238895416, mean p set: 0.4483802020549774The modified gen p mean: 0.4465322196483612, gen p mean: -0.10731293261051178, mean p set: 0.447108656167984
loss_pred:0.014687859453260899, decouple_loss:0.000850778422318399
loss_pred:0.014273650012910366, decouple_loss:0.0006306055001914501
Iteration: 1323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446176677942276, gen p mean: -0.10593992471694946, mean p set: 0.44675159454345703
loss_pred:0.015751829370856285, decouple_loss:0.0007479384075850248
The modified gen p mean: 0.4479004144668579, gen p mean: -0.11205973476171494, mean p set: 0.4484791159629822
loss_pred:0.014968874864280224, decouple_loss:0.0007541325176134706
The modified gen p mean: 0.44741103053092957, gen p mean: -0.10658027231693268, mean p set: 0.44798827171325684
loss_pred:0.01459165196865797, decouple_loss:0.0006512070540338755
Iteration: 1324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446746289730072, gen p mean: -0.11438190937042236, mean p set: 0.4473215639591217
loss_pred:0.01542020682245493, decouple_loss:0.0006889752694405615
The modified gen p mean: 0.44668349623680115, gen p mean: -0.11125343292951584, mean p set: 0.44725939631462097
loss_pred:0.015348992310464382, decouple_loss:0.0007556933560408652
The modified gen p mean: 0.44619980454444885, gen p mean: -0.11101997643709183, mean p set: 0.44677630066871643
loss_pred:0.01573563739657402, decouple_loss:0.000999104930087924
Iteration: 1325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475365877151489, gen p mean: -0.101991668343544, mean p set: 0.4481112062931061
loss_pred:0.015781164169311523, decouple_loss:0.0006723996484652162
The modified gen p mean: 0.44682854413986206, gen p mean: -0.10491441190242767, mean p set: 0.4474049210548401
loss_pred:0.015075519680976868, decouple_loss:0.0006699851946905255
The modified gen p mean: 0.44707509875297546, gen p mean: -0.11130354553461075, mean p set: 0.44765228033065796
loss_pred:0.015344950370490551, decouple_loss:0.0008648126968182623
Iteration: 1326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734859466552734, gen p mean: -0.1062399223446846, mean p set: 0.4479270875453949
loss_pred:0.014633121900260448, decouple_loss:0.000754021224565804
The modified gen p mean: 0.4471169710159302, gen p mean: -0.10764419287443161, mean p set: 0.4476914703845978
loss_pred:0.015229268930852413, decouple_loss:0.0007268829504027963
The modified gen p mean: 0.44672200083732605, gen p mean: -0.10900956392288208, mean p set: 0.44729676842689514
loss_pred:0.015017340891063213, decouple_loss:0.0006216001347638667
Iteration: 1327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780316948890686, gen p mean: -0.10468738526105881, mean p set: 0.4483778774738312
loss_pred:0.015009471215307713, decouple_loss:0.0007378436275757849
The modified gen p mean: 0.44660595059394836, gen p mean: -0.10881859809160233, mean p set: 0.4471812844276428
loss_pred:0.015316048637032509, decouple_loss:0.0006689589354209602
The modified gen p mean: 0.44731616973876953, gen p mean: -0.10752461850643158, mean p set: 0.4478895962238312
loss_pred:0.014529854990541935, decouple_loss:0.0006577277090400457
Iteration: 1328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806885719299316, gen p mean: -0.10594972223043442, mean p set: 0.4486429989337921
loss_pred:0.015075298957526684, decouple_loss:0.0008281753398478031
The modified gen p mean: 0.4477873146533966, gen p mean: -0.11476358771324158, mean p set: 0.44836175441741943
loss_pred:0.014963729307055473, decouple_loss:0.0009378230897709727
The modified gen p mean: 0.4473749101161957, gen p mean: -0.11432463675737381, mean p set: 0.44795170426368713
loss_pred:0.015114718116819859, decouple_loss:0.0010069290874525905
Iteration: 1329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469941258430481, gen p mean: -0.11112146079540253, mean p set: 0.44756919145584106
loss_pred:0.01616312749683857, decouple_loss:0.0006611247081309557
The modified gen p mean: 0.44879716634750366, gen p mean: -0.10683071613311768, mean p set: 0.44937291741371155
The modified gen p mean: 0.4469965696334839, gen p mean: -0.11298045516014099, mean p set: 0.4475743770599365
loss_pred:0.014717034064233303, decouple_loss:0.0007540285587310791
loss_pred:0.016111457720398903, decouple_loss:0.0006991808768361807
Iteration: 1330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473611116409302, gen p mean: -0.1175457239151001, mean p set: 0.44793838262557983
loss_pred:0.014873790554702282, decouple_loss:0.0006993093993514776
The modified gen p mean: 0.44695138931274414, gen p mean: -0.11493358761072159, mean p set: 0.4475267231464386
The modified gen p mean: 0.4469935894012451, gen p mean: -0.11860727518796921, mean p set: 0.44756677746772766
loss_pred:0.015078467316925526, decouple_loss:0.000731225882191211
loss_pred:0.015206488780677319, decouple_loss:0.0006901907036080956
2023-05-01 04:14:44 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11980750411748886, mean p set: 0.4502691626548767
loss_pred:0.017217209562659264, decouple_loss:0.0008529885672032833
The modified gen p mean: 0.44953644275665283, gen p mean: -0.11477465182542801, mean p set: 0.4500633478164673
loss_pred:0.016520898789167404, decouple_loss:0.0007919497438706458
The modified gen p mean: 0.4498303234577179, gen p mean: -0.11407921463251114, mean p set: 0.45035696029663086
loss_pred:0.0169000755995512, decouple_loss:0.0007213196367956698
WV_1_PC_1_EH_0_PS_40, loss: 0.016918834298849106, avg_mse: 0.026342056691646576
current test mse: 0.026342
Iteration: 1331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716107845306396, gen p mean: -0.12067393958568573, mean p set: 0.4477385878562927
loss_pred:0.015274002216756344, decouple_loss:0.0008731562411412597
The modified gen p mean: 0.44767287373542786, gen p mean: -0.12080008536577225, mean p set: 0.44824886322021484The modified gen p mean: 0.4484422206878662, gen p mean: -0.11345384269952774, mean p set: 0.4490176737308502
loss_pred:0.014761528000235558, decouple_loss:0.0010385265341028571
loss_pred:0.014716548845171928, decouple_loss:0.0006557094748131931
Iteration: 1332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682633876800537, gen p mean: -0.11500317603349686, mean p set: 0.4474024176597595
loss_pred:0.015018622390925884, decouple_loss:0.0007576463394798338
The modified gen p mean: 0.4488199055194855, gen p mean: -0.11405659466981888, mean p set: 0.4493965804576874The modified gen p mean: 0.44868573546409607, gen p mean: -0.12084406614303589, mean p set: 0.44926023483276367
loss_pred:0.014401955530047417, decouple_loss:0.0007124328403733671
loss_pred:0.01492272224277258, decouple_loss:0.0007487591356039047
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
NaN value num: 0
Iteration: 1333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481104016304016, gen p mean: -0.11647823452949524, mean p set: 0.4486878216266632
loss_pred:0.01769949682056904, decouple_loss:0.0009479218279011548
The modified gen p mean: 0.4481537938117981, gen p mean: -0.11977057158946991, mean p set: 0.4487301707267761
loss_pred:0.018214482814073563, decouple_loss:0.0007491240976378322
The modified gen p mean: 0.4478209316730499, gen p mean: -0.11322174221277237, mean p set: 0.44839733839035034
loss_pred:0.01794060505926609, decouple_loss:0.000920164748094976
Iteration: 1334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702136516571045, gen p mean: -0.11192530393600464, mean p set: 0.44759565591812134
loss_pred:0.017018986865878105, decouple_loss:0.001041128416545689
The modified gen p mean: 0.44933757185935974, gen p mean: -0.11605982482433319, mean p set: 0.4499121904373169
loss_pred:0.017114508897066116, decouple_loss:0.0010113625321537256
The modified gen p mean: 0.44853782653808594, gen p mean: -0.12042251229286194, mean p set: 0.4491157829761505
loss_pred:0.017284251749515533, decouple_loss:0.0010187835432589054
Iteration: 1335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472571313381195, gen p mean: -0.10464202612638474, mean p set: 0.4478336274623871
loss_pred:0.018337473273277283, decouple_loss:0.000856049417052418
The modified gen p mean: 0.4477013647556305, gen p mean: -0.10716179013252258, mean p set: 0.4482775628566742
loss_pred:0.017412889748811722, decouple_loss:0.0008207442006096244
The modified gen p mean: 0.45001310110092163, gen p mean: -0.11381805688142776, mean p set: 0.4505901634693146
loss_pred:0.016592824831604958, decouple_loss:0.0007855736766941845
Iteration: 1336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477435350418091, gen p mean: -0.10764311254024506, mean p set: 0.44831764698028564
loss_pred:0.017026979476213455, decouple_loss:0.0011086560552939773
The modified gen p mean: 0.4472185969352722, gen p mean: -0.1057501807808876, mean p set: 0.44779375195503235
loss_pred:0.017847180366516113, decouple_loss:0.0009414495434612036
The modified gen p mean: 0.4496431052684784, gen p mean: -0.11232146620750427, mean p set: 0.4502195119857788
loss_pred:0.01637302339076996, decouple_loss:0.0009540649480186403
Iteration: 1337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467894732952118, gen p mean: -0.10256864130496979, mean p set: 0.44736447930336
loss_pred:0.017847174778580666, decouple_loss:0.0008048363961279392
The modified gen p mean: 0.4478532671928406, gen p mean: -0.10936231166124344, mean p set: 0.44842690229415894
loss_pred:0.01676458865404129, decouple_loss:0.0008042108966037631
The modified gen p mean: 0.4477415978908539, gen p mean: -0.10849746316671371, mean p set: 0.44831374287605286
loss_pred:0.01692359521985054, decouple_loss:0.0008834265754558146
Iteration: 1338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794347882270813, gen p mean: -0.10814011842012405, mean p set: 0.44851937890052795
loss_pred:0.017926352098584175, decouple_loss:0.000858376151882112
The modified gen p mean: 0.4479149281978607, gen p mean: -0.11201376467943192, mean p set: 0.44849133491516113
The modified gen p mean: 0.44871002435684204, gen p mean: -0.11553940176963806, mean p set: 0.4492875933647156
loss_pred:0.017579298466444016, decouple_loss:0.0008793664164841175
loss_pred:0.017523255199193954, decouple_loss:0.0009022234589792788
Iteration: 1339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795557856559753, gen p mean: -0.1152355968952179, mean p set: 0.4485318660736084
loss_pred:0.0171609278768301, decouple_loss:0.0014287523226812482
The modified gen p mean: 0.4492674767971039, gen p mean: -0.12081065028905869, mean p set: 0.44984182715415955
loss_pred:0.01663796789944172, decouple_loss:0.0012004224117845297
The modified gen p mean: 0.44776901602745056, gen p mean: -0.11706410348415375, mean p set: 0.44834303855895996
loss_pred:0.01681833155453205, decouple_loss:0.0010265589226037264
Iteration: 1340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475148022174835, gen p mean: -0.12057524919509888, mean p set: 0.4480896592140198
loss_pred:0.01779279112815857, decouple_loss:0.0007405919022858143
The modified gen p mean: 0.4480666220188141, gen p mean: -0.12466056644916534, mean p set: 0.448641300201416
loss_pred:0.017045937478542328, decouple_loss:0.0007133741164579988
The modified gen p mean: 0.44902631640434265, gen p mean: -0.12619473040103912, mean p set: 0.4496051073074341
loss_pred:0.017137739807367325, decouple_loss:0.0007817103178240359
2023-05-01 04:17:35 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12946975231170654, mean p set: 0.4502691626548767
loss_pred:0.017324797809123993, decouple_loss:0.0008140485151670873
The modified gen p mean: 0.4495353400707245, gen p mean: -0.12375816702842712, mean p set: 0.4500633478164673
loss_pred:0.016645481809973717, decouple_loss:0.0009201892535202205
The modified gen p mean: 0.44982871413230896, gen p mean: -0.12325973063707352, mean p set: 0.45035696029663086
loss_pred:0.016957521438598633, decouple_loss:0.000937614415306598
WV_1_PC_1_EH_0_PS_40, loss: 0.017020463943481445, avg_mse: 0.02641596645116806
current test mse: 0.026416
Iteration: 1341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477284550666809, gen p mean: -0.1235610842704773, mean p set: 0.44830331206321716
loss_pred:0.017493626102805138, decouple_loss:0.0008771856664679945
The modified gen p mean: 0.44765549898147583, gen p mean: -0.12052066624164581, mean p set: 0.4482342600822449
loss_pred:0.017084568738937378, decouple_loss:0.0010168658336624503
The modified gen p mean: 0.4485227167606354, gen p mean: -0.12027508020401001, mean p set: 0.44909751415252686
loss_pred:0.018453897908329964, decouple_loss:0.0008861215901561081
Iteration: 1342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864118099212646, gen p mean: -0.1250663548707962, mean p set: 0.4492185115814209
The modified gen p mean: 0.44813454151153564, gen p mean: -0.12007980048656464, mean p set: 0.44871172308921814
loss_pred:0.01731974445283413, decouple_loss:0.001066594966687262
loss_pred:0.018602294847369194, decouple_loss:0.0009585332009010017
The modified gen p mean: 0.449171245098114, gen p mean: -0.12399701774120331, mean p set: 0.44974657893180847
loss_pred:0.017653431743383408, decouple_loss:0.0008885443094186485
Iteration: 1343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480818510055542, gen p mean: -0.12371984124183655, mean p set: 0.4486587643623352
loss_pred:0.01722908206284046, decouple_loss:0.0008940487168729305
The modified gen p mean: 0.4482107162475586, gen p mean: -0.125882089138031, mean p set: 0.4487864673137665
loss_pred:0.017170153558254242, decouple_loss:0.0006343083805404603
The modified gen p mean: 0.4494168758392334, gen p mean: -0.1265886127948761, mean p set: 0.4499904215335846
loss_pred:0.016350386664271355, decouple_loss:0.0007847443339414895
Iteration: 1344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475809633731842, gen p mean: -0.12337841838598251, mean p set: 0.44815659523010254
loss_pred:0.017662474885582924, decouple_loss:0.0008549613994546235
The modified gen p mean: 0.4493005573749542, gen p mean: -0.11913665384054184, mean p set: 0.4498783349990845
loss_pred:0.016467219218611717, decouple_loss:0.0007541413069702685
The modified gen p mean: 0.4479605257511139, gen p mean: -0.12063305824995041, mean p set: 0.44853708148002625
loss_pred:0.01769012212753296, decouple_loss:0.001049323589541018
Iteration: 1345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44897547364234924, gen p mean: -0.12212381511926651, mean p set: 0.4495508372783661
The modified gen p mean: 0.44952425360679626, gen p mean: -0.11939966678619385, mean p set: 0.4500986337661743
loss_pred:0.017439192160964012, decouple_loss:0.0011099447729066014
loss_pred:0.016682958230376244, decouple_loss:0.0008948588510975242
The modified gen p mean: 0.44796404242515564, gen p mean: -0.11997010558843613, mean p set: 0.4485383629798889
loss_pred:0.01681683212518692, decouple_loss:0.0008227751823142171
Iteration: 1346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851964712142944, gen p mean: -0.12251462787389755, mean p set: 0.4490949809551239
loss_pred:0.017070090398192406, decouple_loss:0.0006949982489459217
The modified gen p mean: 0.4481101930141449, gen p mean: -0.11852473765611649, mean p set: 0.44868478178977966
loss_pred:0.01748621091246605, decouple_loss:0.0006689138826914132
The modified gen p mean: 0.44793376326560974, gen p mean: -0.11803025752305984, mean p set: 0.44850850105285645
loss_pred:0.017851606011390686, decouple_loss:0.0006519690505228937
Iteration: 1347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479339122772217, gen p mean: -0.11571279913187027, mean p set: 0.4485076069831848
loss_pred:0.017557622864842415, decouple_loss:0.0006422811420634389
The modified gen p mean: 0.4478159248828888, gen p mean: -0.11758218705654144, mean p set: 0.44839203357696533
loss_pred:0.016941465437412262, decouple_loss:0.0005968094919808209
The modified gen p mean: 0.4482565224170685, gen p mean: -0.11738214641809464, mean p set: 0.44883406162261963
loss_pred:0.01743675395846367, decouple_loss:0.0007853396818973124
Iteration: 1348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829970598220825, gen p mean: -0.1149984672665596, mean p set: 0.4488738775253296
loss_pred:0.0162950549274683, decouple_loss:0.0010421775514259934
The modified gen p mean: 0.44939425587654114, gen p mean: -0.12167749553918839, mean p set: 0.4499753415584564
loss_pred:0.01705465093255043, decouple_loss:0.000713491695933044
The modified gen p mean: 0.4484942853450775, gen p mean: -0.11443719267845154, mean p set: 0.4490722715854645
loss_pred:0.01775330677628517, decouple_loss:0.0009265144472010434
Iteration: 1349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474511742591858, gen p mean: -0.11984063684940338, mean p set: 0.44802385568618774
loss_pred:0.017704280093312263, decouple_loss:0.0006882673478685319
The modified gen p mean: 0.44667235016822815, gen p mean: -0.11678515374660492, mean p set: 0.4472479820251465
loss_pred:0.017128391191363335, decouple_loss:0.0007328342762775719
The modified gen p mean: 0.4476643204689026, gen p mean: -0.12060924619436264, mean p set: 0.448240727186203
loss_pred:0.016505669802427292, decouple_loss:0.0008702920749783516
Iteration: 1350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44983068108558655, gen p mean: -0.127142533659935, mean p set: 0.4504074156284332
loss_pred:0.0171327106654644, decouple_loss:0.0012439549900591373
The modified gen p mean: 0.44827932119369507, gen p mean: -0.12387394905090332, mean p set: 0.4488562047481537
loss_pred:0.017732055857777596, decouple_loss:0.0010385951027274132
The modified gen p mean: 0.44874125719070435, gen p mean: -0.12204448878765106, mean p set: 0.44931817054748535
loss_pred:0.017511580139398575, decouple_loss:0.0007933672750368714
2023-05-01 04:19:40 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13253116607666016, mean p set: 0.4502691626548767
loss_pred:0.017364514991641045, decouple_loss:0.0007229450275190175
The modified gen p mean: 0.4495336413383484, gen p mean: -0.12676891684532166, mean p set: 0.4500633478164673
loss_pred:0.016679396852850914, decouple_loss:0.0008071253541857004
The modified gen p mean: 0.44982999563217163, gen p mean: -0.12629155814647675, mean p set: 0.45035696029663086
loss_pred:0.016998695209622383, decouple_loss:0.0007682637660764158
WV_1_PC_1_EH_0_PS_40, loss: 0.017052507027983665, avg_mse: 0.0264747254550457
current test mse: 0.026475
Iteration: 1351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779396057128906, gen p mean: -0.12269753962755203, mean p set: 0.4483693838119507
loss_pred:0.016844233497977257, decouple_loss:0.0007027623360045254
The modified gen p mean: 0.44835564494132996, gen p mean: -0.12788940966129303, mean p set: 0.44892963767051697
loss_pred:0.01788407564163208, decouple_loss:0.0007541704690083861
The modified gen p mean: 0.44792440533638, gen p mean: -0.12870198488235474, mean p set: 0.44850072264671326
loss_pred:0.01754460670053959, decouple_loss:0.000757932080887258
Iteration: 1352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474899172782898, gen p mean: -0.12623342871665955, mean p set: 0.44806647300720215
loss_pred:0.016443468630313873, decouple_loss:0.0006982259801588953
The modified gen p mean: 0.4484100937843323, gen p mean: -0.12503232061862946, mean p set: 0.4489891827106476The modified gen p mean: 0.4478355050086975, gen p mean: -0.12805429100990295, mean p set: 0.44840967655181885
loss_pred:0.017689183354377747, decouple_loss:0.0007399845053441823loss_pred:0.016760041937232018, decouple_loss:0.0008611165103502572
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 1353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481353461742401, gen p mean: -0.12555764615535736, mean p set: 0.44871145486831665
loss_pred:0.016273679211735725, decouple_loss:0.0006452134111896157
The modified gen p mean: 0.4481920897960663, gen p mean: -0.12239456921815872, mean p set: 0.44876912236213684
The modified gen p mean: 0.44711142778396606, gen p mean: -0.12876546382904053, mean p set: 0.447688490152359
loss_pred:0.016122452914714813, decouple_loss:0.0007039185729809105
loss_pred:0.015823833644390106, decouple_loss:0.0007301797741092741
Iteration: 1354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814860820770264, gen p mean: -0.12176840752363205, mean p set: 0.44872695207595825
loss_pred:0.01589367352426052, decouple_loss:0.0006133138085715473
The modified gen p mean: 0.4485650062561035, gen p mean: -0.12602707743644714, mean p set: 0.4491422176361084
loss_pred:0.015843063592910767, decouple_loss:0.000925871660001576
The modified gen p mean: 0.4483182430267334, gen p mean: -0.12662427127361298, mean p set: 0.4488913416862488
loss_pred:0.01670994982123375, decouple_loss:0.0008346287650056183
Iteration: 1355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475356936454773, gen p mean: -0.1277078539133072, mean p set: 0.4481090009212494
loss_pred:0.015779605135321617, decouple_loss:0.0006290681194514036
The modified gen p mean: 0.44985997676849365, gen p mean: -0.12722256779670715, mean p set: 0.45043665170669556
loss_pred:0.016016433015465736, decouple_loss:0.0008535549859516323
The modified gen p mean: 0.44910043478012085, gen p mean: -0.12603040039539337, mean p set: 0.4496730864048004
loss_pred:0.016115907579660416, decouple_loss:0.0006652533775195479
Iteration: 1356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483496844768524, gen p mean: -0.12287663668394089, mean p set: 0.44892382621765137
loss_pred:0.01560545340180397, decouple_loss:0.0007831503753550351
The modified gen p mean: 0.4472846984863281, gen p mean: -0.12069346010684967, mean p set: 0.44785773754119873
loss_pred:0.015724308788776398, decouple_loss:0.0007370912935584784
The modified gen p mean: 0.44842392206192017, gen p mean: -0.12501615285873413, mean p set: 0.4489997327327728
loss_pred:0.015723077580332756, decouple_loss:0.0009569009416736662
Iteration: 1357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486440420150757, gen p mean: -0.11765436828136444, mean p set: 0.44922152161598206
loss_pred:0.01630108617246151, decouple_loss:0.000717316463124007
The modified gen p mean: 0.44718512892723083, gen p mean: -0.12548230588436127, mean p set: 0.4477599561214447
loss_pred:0.015459667891263962, decouple_loss:0.0007298604468815029
The modified gen p mean: 0.4476796090602875, gen p mean: -0.12040015310049057, mean p set: 0.4482552707195282
loss_pred:0.016273366287350655, decouple_loss:0.0009796663653105497
Iteration: 1358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784191250801086, gen p mean: -0.12159042805433273, mean p set: 0.4484177529811859
loss_pred:0.015844909474253654, decouple_loss:0.0006371336057782173
The modified gen p mean: 0.4475097954273224, gen p mean: -0.11923763900995255, mean p set: 0.4480845034122467
loss_pred:0.016270946711301804, decouple_loss:0.0007828787784092128
The modified gen p mean: 0.44772571325302124, gen p mean: -0.11707722395658493, mean p set: 0.4483044445514679
loss_pred:0.01604188233613968, decouple_loss:0.0008334815502166748
Iteration: 1359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483768939971924, gen p mean: -0.120478555560112, mean p set: 0.44895321130752563
loss_pred:0.015172923915088177, decouple_loss:0.0007636204245500267
The modified gen p mean: 0.44775334000587463, gen p mean: -0.12360452860593796, mean p set: 0.44832760095596313
loss_pred:0.015502155758440495, decouple_loss:0.0006701744860038161
The modified gen p mean: 0.4473179578781128, gen p mean: -0.12213469296693802, mean p set: 0.44789400696754456
loss_pred:0.015985485166311264, decouple_loss:0.0006709785084240139
Iteration: 1360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724345207214355, gen p mean: -0.12479673326015472, mean p set: 0.4478192627429962
loss_pred:0.014638755470514297, decouple_loss:0.0007645949372090399
The modified gen p mean: 0.4480697810649872, gen p mean: -0.1205192357301712, mean p set: 0.4486456513404846
The modified gen p mean: 0.44744613766670227, gen p mean: -0.12248213589191437, mean p set: 0.4480244815349579
loss_pred:0.01598171517252922, decouple_loss:0.0009003320010378957
loss_pred:0.01557790208607912, decouple_loss:0.0007991411839611828
2023-05-01 04:22:29 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12399286776781082, mean p set: 0.4502691626548767
loss_pred:0.0172575693577528, decouple_loss:0.0007700054557062685
The modified gen p mean: 0.44953644275665283, gen p mean: -0.11801116913557053, mean p set: 0.4500633478164673
loss_pred:0.016648832708597183, decouple_loss:0.0007713394006714225
The modified gen p mean: 0.44982850551605225, gen p mean: -0.11730972677469254, mean p set: 0.45035696029663086
loss_pred:0.017007576301693916, decouple_loss:0.0007947863778099418
WV_1_PC_1_EH_0_PS_40, loss: 0.017010262235999107, avg_mse: 0.026446670293807983
current test mse: 0.026447
Iteration: 1361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483194649219513, gen p mean: -0.11887556314468384, mean p set: 0.448894202709198
loss_pred:0.01630459725856781, decouple_loss:0.0006882974412292242
The modified gen p mean: 0.44728395342826843, gen p mean: -0.12177743762731552, mean p set: 0.4478580951690674The modified gen p mean: 0.4490925669670105, gen p mean: -0.12279113382101059, mean p set: 0.4496676027774811
loss_pred:0.015303154475986958, decouple_loss:0.0006035605911165476
loss_pred:0.01611257903277874, decouple_loss:0.0008567997138015926
Iteration: 1362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448042094707489, gen p mean: -0.12257267534732819, mean p set: 0.44861847162246704
loss_pred:0.015199625864624977, decouple_loss:0.0006623509107157588
The modified gen p mean: 0.4470137357711792, gen p mean: -0.11847595870494843, mean p set: 0.4475880563259125The modified gen p mean: 0.4480305314064026, gen p mean: -0.123238705098629, mean p set: 0.44860783219337463
loss_pred:0.01593833789229393, decouple_loss:0.0006824207957834005
loss_pred:0.015086043626070023, decouple_loss:0.0007078308262862265
Iteration: 1363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474228024482727, gen p mean: -0.11897097527980804, mean p set: 0.44799840450286865
The modified gen p mean: 0.4476329982280731, gen p mean: -0.12059789896011353, mean p set: 0.44820985198020935loss_pred:0.016247205436229706, decouple_loss:0.0006909662042744458
loss_pred:0.015894083306193352, decouple_loss:0.0006874708342365921
The modified gen p mean: 0.44705259799957275, gen p mean: -0.11710520833730698, mean p set: 0.44762876629829407
loss_pred:0.01693872921168804, decouple_loss:0.0007882877252995968
Iteration: 1364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470081925392151, gen p mean: -0.12141600996255875, mean p set: 0.44758591055870056
loss_pred:0.014845043420791626, decouple_loss:0.0009137935703620315
The modified gen p mean: 0.44818243384361267, gen p mean: -0.1183619350194931, mean p set: 0.4487592875957489
loss_pred:0.016323812305927277, decouple_loss:0.0008416989003308117
The modified gen p mean: 0.44776129722595215, gen p mean: -0.12027905136346817, mean p set: 0.44833654165267944
loss_pred:0.015448477119207382, decouple_loss:0.0008931489428505301
Iteration: 1365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731736183166504, gen p mean: -0.11708533018827438, mean p set: 0.44789284467697144
loss_pred:0.015121557749807835, decouple_loss:0.0007468932308256626
The modified gen p mean: 0.44795748591423035, gen p mean: -0.11548840254545212, mean p set: 0.4485322833061218
loss_pred:0.01514372881501913, decouple_loss:0.0007846798980608582
The modified gen p mean: 0.4479462802410126, gen p mean: -0.1182984784245491, mean p set: 0.44852176308631897
loss_pred:0.015889903530478477, decouple_loss:0.0007992819300852716
Iteration: 1366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44936051964759827, gen p mean: -0.11767566949129105, mean p set: 0.4499371349811554
loss_pred:0.015240542590618134, decouple_loss:0.0007770516094751656
The modified gen p mean: 0.44761961698532104, gen p mean: -0.11715485900640488, mean p set: 0.44819530844688416
The modified gen p mean: 0.44730064272880554, gen p mean: -0.11966566741466522, mean p set: 0.4478755593299866
loss_pred:0.015512697398662567, decouple_loss:0.0011614746181294322
loss_pred:0.01480164099484682, decouple_loss:0.0007611129549331963
Iteration: 1367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799885153770447, gen p mean: -0.11669959127902985, mean p set: 0.44857507944107056
loss_pred:0.015147853642702103, decouple_loss:0.0008639249135740101
The modified gen p mean: 0.4481566250324249, gen p mean: -0.11648625135421753, mean p set: 0.4487335979938507
loss_pred:0.015438621863722801, decouple_loss:0.0012664239620789886
The modified gen p mean: 0.4484924376010895, gen p mean: -0.1173328086733818, mean p set: 0.4490683674812317
loss_pred:0.014926875941455364, decouple_loss:0.0009072559769265354
Iteration: 1368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485127925872803, gen p mean: -0.11416786909103394, mean p set: 0.4490887224674225
loss_pred:0.014714575372636318, decouple_loss:0.001086686970666051
The modified gen p mean: 0.4474124312400818, gen p mean: -0.11830223351716995, mean p set: 0.44798803329467773
loss_pred:0.015046445652842522, decouple_loss:0.0007227252935990691
The modified gen p mean: 0.44811975955963135, gen p mean: -0.11586423963308334, mean p set: 0.44869568943977356
loss_pred:0.01547219604253769, decouple_loss:0.000665167230181396
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475872814655304, gen p mean: -0.11999299377202988, mean p set: 0.44816285371780396
loss_pred:0.01448426116257906, decouple_loss:0.0008776045870035887
The modified gen p mean: 0.4485132396221161, gen p mean: -0.11818664520978928, mean p set: 0.44908908009529114
loss_pred:0.0156857930123806, decouple_loss:0.0007089322898536921
The modified gen p mean: 0.44747138023376465, gen p mean: -0.11741258203983307, mean p set: 0.44804567098617554
loss_pred:0.015010952018201351, decouple_loss:0.0006559382891282439
Iteration: 1370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486079216003418, gen p mean: -0.11465779691934586, mean p set: 0.44918495416641235
loss_pred:0.015193697065114975, decouple_loss:0.0006495050620287657
The modified gen p mean: 0.4496067464351654, gen p mean: -0.11932138353586197, mean p set: 0.4501863420009613
loss_pred:0.015443943440914154, decouple_loss:0.0008175122202374041
The modified gen p mean: 0.45028379559516907, gen p mean: -0.12026812881231308, mean p set: 0.4508599638938904
loss_pred:0.015168901532888412, decouple_loss:0.0008825581171549857
2023-05-01 04:24:35 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11892885714769363, mean p set: 0.4502691626548767
loss_pred:0.017363475635647774, decouple_loss:0.0008239725138992071
The modified gen p mean: 0.44953760504722595, gen p mean: -0.1134367361664772, mean p set: 0.4500633478164673
loss_pred:0.016560690477490425, decouple_loss:0.000830132863484323
The modified gen p mean: 0.44982966780662537, gen p mean: -0.11255046725273132, mean p set: 0.45035696029663086
loss_pred:0.016970742493867874, decouple_loss:0.000876061269082129
WV_1_PC_1_EH_0_PS_40, loss: 0.017007140442728996, avg_mse: 0.026518817991018295
current test mse: 0.026519
Iteration: 1371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793185591697693, gen p mean: -0.11548420041799545, mean p set: 0.4485079050064087
loss_pred:0.014891856350004673, decouple_loss:0.0009808683535084128
The modified gen p mean: 0.44710034132003784, gen p mean: -0.11412186920642853, mean p set: 0.4476771950721741
loss_pred:0.01665821671485901, decouple_loss:0.0009666683617979288
The modified gen p mean: 0.4482341408729553, gen p mean: -0.1160009503364563, mean p set: 0.44880983233451843
loss_pred:0.016332535073161125, decouple_loss:0.0008932200144045055
Iteration: 1372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831815361976624, gen p mean: -0.11618974059820175, mean p set: 0.4488926827907562
The modified gen p mean: 0.4494132697582245, gen p mean: -0.11561862379312515, mean p set: 0.4499906599521637loss_pred:0.015648240223526955, decouple_loss:0.0008065942674875259
loss_pred:0.015311970375478268, decouple_loss:0.0006516294670291245
The modified gen p mean: 0.44768092036247253, gen p mean: -0.11676514148712158, mean p set: 0.44825538992881775
loss_pred:0.015109880827367306, decouple_loss:0.0008250208920799196
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
NaN value num: 0
Iteration: 1373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502677917480469, gen p mean: -0.1081167683005333, mean p set: 0.4508443772792816
loss_pred:0.016716012731194496, decouple_loss:0.000748389633372426
The modified gen p mean: 0.4497080445289612, gen p mean: -0.10719148814678192, mean p set: 0.4502848982810974The modified gen p mean: 0.4507123529911041, gen p mean: -0.11034442484378815, mean p set: 0.4512903094291687
loss_pred:0.01675404980778694, decouple_loss:0.0007176855579018593
loss_pred:0.01670251414179802, decouple_loss:0.0007533516618423164
Iteration: 1374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814610481262207, gen p mean: -0.11074913293123245, mean p set: 0.4487225413322449
loss_pred:0.016212495043873787, decouple_loss:0.0007547870045527816
The modified gen p mean: 0.44879940152168274, gen p mean: -0.11467202007770538, mean p set: 0.44937488436698914
loss_pred:0.016279077157378197, decouple_loss:0.0007823900668881834
The modified gen p mean: 0.4506637454032898, gen p mean: -0.11366076022386551, mean p set: 0.4512398838996887
loss_pred:0.017168644815683365, decouple_loss:0.000913881347514689
Iteration: 1375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45009782910346985, gen p mean: -0.11431218683719635, mean p set: 0.45067667961120605
loss_pred:0.016275348141789436, decouple_loss:0.0008862466784194112
The modified gen p mean: 0.44941624999046326, gen p mean: -0.11311136186122894, mean p set: 0.4499933123588562
loss_pred:0.01623845100402832, decouple_loss:0.000647085253149271
The modified gen p mean: 0.44850704073905945, gen p mean: -0.1104675903916359, mean p set: 0.44908347725868225
loss_pred:0.016174262389540672, decouple_loss:0.0008013297920115292
Iteration: 1376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852086901664734, gen p mean: -0.10769101977348328, mean p set: 0.44909584522247314
loss_pred:0.016070185229182243, decouple_loss:0.0006832829676568508
The modified gen p mean: 0.45108702778816223, gen p mean: -0.10851241648197174, mean p set: 0.4516618549823761
The modified gen p mean: 0.448737770318985, gen p mean: -0.10302252322435379, mean p set: 0.44931429624557495
loss_pred:0.016434798017144203, decouple_loss:0.0007084591197781265
loss_pred:0.01725773699581623, decouple_loss:0.0008587391348555684
Iteration: 1377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492589831352234, gen p mean: -0.10658060014247894, mean p set: 0.44983693957328796
loss_pred:0.016154877841472626, decouple_loss:0.0007242462015710771
The modified gen p mean: 0.44947540760040283, gen p mean: -0.10565131157636642, mean p set: 0.45005032420158386
loss_pred:0.015865471214056015, decouple_loss:0.0007607708103023469
The modified gen p mean: 0.4487956166267395, gen p mean: -0.10862118005752563, mean p set: 0.44937294721603394
loss_pred:0.01584738679230213, decouple_loss:0.0007461200002580881
Iteration: 1378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493037760257721, gen p mean: -0.10986914485692978, mean p set: 0.4498820900917053
loss_pred:0.01587148755788803, decouple_loss:0.000701528275385499
The modified gen p mean: 0.4493635296821594, gen p mean: -0.10882997512817383, mean p set: 0.44993993639945984
loss_pred:0.01718076691031456, decouple_loss:0.0008083261200226843
The modified gen p mean: 0.45093846321105957, gen p mean: -0.10500260442495346, mean p set: 0.45151427388191223
loss_pred:0.01677326299250126, decouple_loss:0.0007239148835651577
Iteration: 1379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501796066761017, gen p mean: -0.09957824647426605, mean p set: 0.4507562518119812
loss_pred:0.0165722519159317, decouple_loss:0.0007666937308385968
The modified gen p mean: 0.4498828649520874, gen p mean: -0.10374479740858078, mean p set: 0.45045775175094604
loss_pred:0.015560897998511791, decouple_loss:0.0007029386470094323
The modified gen p mean: 0.4504034221172333, gen p mean: -0.10822422802448273, mean p set: 0.4509795904159546
loss_pred:0.016282597556710243, decouple_loss:0.0009720786474645138
Iteration: 1380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45074304938316345, gen p mean: -0.10248906910419464, mean p set: 0.4513188898563385
loss_pred:0.016634127125144005, decouple_loss:0.000703498546499759
The modified gen p mean: 0.4500693678855896, gen p mean: -0.10409022867679596, mean p set: 0.45064401626586914
The modified gen p mean: 0.44977006316185, gen p mean: -0.11388061940670013, mean p set: 0.4503445625305176
loss_pred:0.016570275649428368, decouple_loss:0.0007871795096434653
loss_pred:0.01670103706419468, decouple_loss:0.0007466209353879094
2023-05-01 04:27:19 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11909285932779312, mean p set: 0.4502691626548767
loss_pred:0.017391568049788475, decouple_loss:0.0010236128000542521
The modified gen p mean: 0.4495348036289215, gen p mean: -0.11365386843681335, mean p set: 0.4500633478164673
The modified gen p mean: 0.44982901215553284, gen p mean: -0.11286481469869614, mean p set: 0.45035696029663086
loss_pred:0.01667655259370804, decouple_loss:0.001228759647347033
loss_pred:0.01713455282151699, decouple_loss:0.0013087261468172073
WV_1_PC_1_EH_0_PS_40, loss: 0.017126910388469696, avg_mse: 0.026586946099996567
current test mse: 0.026587
Iteration: 1381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498237669467926, gen p mean: -0.10930994153022766, mean p set: 0.45040175318717957
The modified gen p mean: 0.4504133462905884, gen p mean: -0.10842825472354889, mean p set: 0.45099109411239624
loss_pred:0.015978576615452766, decouple_loss:0.0007845931686460972
loss_pred:0.016350138932466507, decouple_loss:0.0008600775618106127
The modified gen p mean: 0.45085155963897705, gen p mean: -0.10122206807136536, mean p set: 0.4514269232749939
loss_pred:0.01729249395430088, decouple_loss:0.000718052324373275
Iteration: 1382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481924772262573, gen p mean: -0.11086030304431915, mean p set: 0.4487698972225189
The modified gen p mean: 0.44974181056022644, gen p mean: -0.11329800635576248, mean p set: 0.45031872391700745loss_pred:0.016130784526467323, decouple_loss:0.0010193524649366736
loss_pred:0.016238059848546982, decouple_loss:0.0008094864315353334
The modified gen p mean: 0.4502410292625427, gen p mean: -0.10634024441242218, mean p set: 0.4508165121078491
loss_pred:0.016089679673314095, decouple_loss:0.0011277677258476615
Iteration: 1383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45007848739624023, gen p mean: -0.11135789006948471, mean p set: 0.4506531357765198
loss_pred:0.016543984413146973, decouple_loss:0.0008160435827448964
The modified gen p mean: 0.45108431577682495, gen p mean: -0.10671921819448471, mean p set: 0.451661616563797
loss_pred:0.016973886638879776, decouple_loss:0.0008862299146130681
The modified gen p mean: 0.44887644052505493, gen p mean: -0.11180708557367325, mean p set: 0.44945380091667175
loss_pred:0.016383487731218338, decouple_loss:0.0007616029470227659
Iteration: 1384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489173889160156, gen p mean: -0.11182696372270584, mean p set: 0.449493408203125
loss_pred:0.016461828723549843, decouple_loss:0.0007073114975355566
The modified gen p mean: 0.44873327016830444, gen p mean: -0.10546903312206268, mean p set: 0.44931018352508545
loss_pred:0.016530942171812057, decouple_loss:0.0008050066535361111
The modified gen p mean: 0.4497813284397125, gen p mean: -0.11586199700832367, mean p set: 0.4503578245639801
loss_pred:0.01712891273200512, decouple_loss:0.0010080295614898205
Iteration: 1385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500178396701813, gen p mean: -0.10199625790119171, mean p set: 0.4505939483642578
loss_pred:0.016787158325314522, decouple_loss:0.0011788401752710342
The modified gen p mean: 0.4500427842140198, gen p mean: -0.1076221615076065, mean p set: 0.45061951875686646
loss_pred:0.015962103381752968, decouple_loss:0.0008835145272314548
The modified gen p mean: 0.4497573673725128, gen p mean: -0.11301226913928986, mean p set: 0.45033547282218933
loss_pred:0.016482189297676086, decouple_loss:0.0009071436943486333
Iteration: 1386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498905837535858, gen p mean: -0.10951633006334305, mean p set: 0.4504653811454773
loss_pred:0.01589692197740078, decouple_loss:0.0008738285396248102
The modified gen p mean: 0.4502146542072296, gen p mean: -0.10912638902664185, mean p set: 0.45079106092453003
loss_pred:0.016015082597732544, decouple_loss:0.0009914255933836102
The modified gen p mean: 0.4487752914428711, gen p mean: -0.11083855479955673, mean p set: 0.4493492543697357
loss_pred:0.016517972573637962, decouple_loss:0.0007370073581114411
Iteration: 1387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45118165016174316, gen p mean: -0.10064515471458435, mean p set: 0.45175716280937195
loss_pred:0.016185812652111053, decouple_loss:0.0007595547940582037
The modified gen p mean: 0.44988828897476196, gen p mean: -0.10545051842927933, mean p set: 0.45046308636665344
loss_pred:0.01626039482653141, decouple_loss:0.0008920760592445731
The modified gen p mean: 0.4481319785118103, gen p mean: -0.1011136993765831, mean p set: 0.44870832562446594
loss_pred:0.01657939702272415, decouple_loss:0.0007468778057955205
Iteration: 1388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012667775154114, gen p mean: -0.11361447721719742, mean p set: 0.4507039785385132
loss_pred:0.016026495024561882, decouple_loss:0.0008080582483671606
The modified gen p mean: 0.4500965476036072, gen p mean: -0.10601791739463806, mean p set: 0.45067429542541504
The modified gen p mean: 0.44850125908851624, gen p mean: -0.11026984453201294, mean p set: 0.4490794241428375
loss_pred:0.01610548608005047, decouple_loss:0.0010164157720282674
loss_pred:0.016127655282616615, decouple_loss:0.0007201926200650632
Iteration: 1389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504663944244385, gen p mean: -0.11245835572481155, mean p set: 0.45104461908340454
loss_pred:0.01635829545557499, decouple_loss:0.0009448144119232893
The modified gen p mean: 0.4502392113208771, gen p mean: -0.10517272353172302, mean p set: 0.45081597566604614
The modified gen p mean: 0.4500049948692322, gen p mean: -0.11109223961830139, mean p set: 0.45058220624923706
loss_pred:0.01681540347635746, decouple_loss:0.0010511359432712197
loss_pred:0.016119081526994705, decouple_loss:0.0008221206371672451
Iteration: 1390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071786642074585, gen p mean: -0.10931612551212311, mean p set: 0.4512932300567627
loss_pred:0.01598861813545227, decouple_loss:0.0008915507351048291
The modified gen p mean: 0.45083171129226685, gen p mean: -0.1008886843919754, mean p set: 0.4514070451259613
loss_pred:0.016678517684340477, decouple_loss:0.0008990007918328047
The modified gen p mean: 0.4500475525856018, gen p mean: -0.10689985752105713, mean p set: 0.4506239891052246
loss_pred:0.01596127822995186, decouple_loss:0.0006800533155910671
2023-05-01 04:29:25 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1156345009803772, mean p set: 0.4502691626548767
loss_pred:0.01729874685406685, decouple_loss:0.0009193914011120796
The modified gen p mean: 0.44953495264053345, gen p mean: -0.10986394435167313, mean p set: 0.4500633478164673
loss_pred:0.01662382297217846, decouple_loss:0.0008897797088138759
The modified gen p mean: 0.4498302936553955, gen p mean: -0.10911061614751816, mean p set: 0.45035696029663086
loss_pred:0.017137719318270683, decouple_loss:0.0008471212349832058
WV_1_PC_1_EH_0_PS_40, loss: 0.017064368352293968, avg_mse: 0.02651899680495262
current test mse: 0.026519
Iteration: 1391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44995370507240295, gen p mean: -0.10600012540817261, mean p set: 0.45053014159202576
loss_pred:0.015577941201627254, decouple_loss:0.0010192906484007835
The modified gen p mean: 0.4494994282722473, gen p mean: -0.10677987337112427, mean p set: 0.4500750005245209
loss_pred:0.016135908663272858, decouple_loss:0.0007757507846690714
The modified gen p mean: 0.45005422830581665, gen p mean: -0.10470352321863174, mean p set: 0.4506286382675171
loss_pred:0.015795350074768066, decouple_loss:0.0006103533087298274
Iteration: 1392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485144317150116, gen p mean: -0.10315324366092682, mean p set: 0.44908758997917175
The modified gen p mean: 0.44842496514320374, gen p mean: -0.1011548712849617, mean p set: 0.4490005075931549
loss_pred:0.016716621816158295, decouple_loss:0.0006633272278122604
loss_pred:0.01608951948583126, decouple_loss:0.001081411843188107
The modified gen p mean: 0.44826140999794006, gen p mean: -0.10346871614456177, mean p set: 0.4488380551338196
loss_pred:0.015775974839925766, decouple_loss:0.0006837872206233442
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
NaN value num: 0
Iteration: 1393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511418640613556, gen p mean: -0.10115930438041687, mean p set: 0.45171812176704407
loss_pred:0.01671910658478737, decouple_loss:0.0007584696868434548
The modified gen p mean: 0.45049431920051575, gen p mean: -0.10276690870523453, mean p set: 0.4510722756385803The modified gen p mean: 0.4489191472530365, gen p mean: -0.10370951890945435, mean p set: 0.4494965374469757
loss_pred:0.01705041714012623, decouple_loss:0.0009268185240216553
loss_pred:0.016491414979100227, decouple_loss:0.0007294032839126885
Iteration: 1394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45362886786460876, gen p mean: -0.09598304331302643, mean p set: 0.45420756936073303
loss_pred:0.015916572883725166, decouple_loss:0.0008165275794453919
The modified gen p mean: 0.45071515440940857, gen p mean: -0.09940271824598312, mean p set: 0.4512914717197418
loss_pred:0.0165235735476017, decouple_loss:0.0007651975029148161
The modified gen p mean: 0.4505630433559418, gen p mean: -0.10336640477180481, mean p set: 0.4511401653289795
loss_pred:0.01662103831768036, decouple_loss:0.0006980447215028107
Iteration: 1395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521636962890625, gen p mean: -0.10258395969867706, mean p set: 0.4527396559715271
loss_pred:0.016526389867067337, decouple_loss:0.0009080962045118213
The modified gen p mean: 0.44999533891677856, gen p mean: -0.10231858491897583, mean p set: 0.4505741000175476
loss_pred:0.016449034214019775, decouple_loss:0.0012157171731814742
The modified gen p mean: 0.4508713185787201, gen p mean: -0.09343843162059784, mean p set: 0.45144933462142944
loss_pred:0.015459536574780941, decouple_loss:0.0010699530830606818
Iteration: 1396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45031121373176575, gen p mean: -0.10497009009122849, mean p set: 0.4508858919143677
loss_pred:0.016267377883195877, decouple_loss:0.0006889466312713921
The modified gen p mean: 0.45144495368003845, gen p mean: -0.097535640001297, mean p set: 0.4520217776298523
The modified gen p mean: 0.44987383484840393, gen p mean: -0.10454582422971725, mean p set: 0.4504498541355133
loss_pred:0.015991192311048508, decouple_loss:0.0007608774467371404
loss_pred:0.016385162249207497, decouple_loss:0.0008618315914645791
Iteration: 1397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509905278682709, gen p mean: -0.10231608152389526, mean p set: 0.451566606760025
loss_pred:0.017116766422986984, decouple_loss:0.0009379101102240384
The modified gen p mean: 0.4503704607486725, gen p mean: -0.10118217021226883, mean p set: 0.4509464502334595
The modified gen p mean: 0.45177987217903137, gen p mean: -0.09953437745571136, mean p set: 0.4523571729660034
loss_pred:0.015889117494225502, decouple_loss:0.0009565461077727377
loss_pred:0.01584636978805065, decouple_loss:0.0009328527958132327
Iteration: 1398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502139389514923, gen p mean: -0.11142129451036453, mean p set: 0.45079126954078674
loss_pred:0.016029993072152138, decouple_loss:0.0006554711726494133
The modified gen p mean: 0.45049068331718445, gen p mean: -0.11104696989059448, mean p set: 0.4510670304298401
The modified gen p mean: 0.4508380591869354, gen p mean: -0.10958139598369598, mean p set: 0.45141491293907166
loss_pred:0.015764610841870308, decouple_loss:0.0007558250217698514
loss_pred:0.016496235504746437, decouple_loss:0.0007637902162969112
Iteration: 1399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504765272140503, gen p mean: -0.11306104063987732, mean p set: 0.45105183124542236
loss_pred:0.016741635277867317, decouple_loss:0.001028859056532383
The modified gen p mean: 0.4507593810558319, gen p mean: -0.1094847097992897, mean p set: 0.45133426785469055
The modified gen p mean: 0.4502832591533661, gen p mean: -0.11244505643844604, mean p set: 0.45086002349853516
loss_pred:0.01637226715683937, decouple_loss:0.0008158498094417155
loss_pred:0.01675468496978283, decouple_loss:0.0011408432619646192
Iteration: 1400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500834047794342, gen p mean: -0.10956734418869019, mean p set: 0.45065951347351074
loss_pred:0.01605282351374626, decouple_loss:0.0007432670681737363
The modified gen p mean: 0.450175017118454, gen p mean: -0.11069481819868088, mean p set: 0.450752317905426
The modified gen p mean: 0.45075565576553345, gen p mean: -0.10730820894241333, mean p set: 0.45133084058761597
loss_pred:0.015471245162189007, decouple_loss:0.0006618393235839903
loss_pred:0.01642485149204731, decouple_loss:0.0007276511169038713
2023-05-01 04:32:15 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1176094263792038, mean p set: 0.4502691626548767
loss_pred:0.017310086637735367, decouple_loss:0.0010003874776884913
The modified gen p mean: 0.4495331645011902, gen p mean: -0.11168945580720901, mean p set: 0.4500633478164673
loss_pred:0.0167130958288908, decouple_loss:0.0010993984760716558
The modified gen p mean: 0.4498288333415985, gen p mean: -0.1106071025133133, mean p set: 0.45035696029663086
loss_pred:0.01720220223069191, decouple_loss:0.0009432596270926297
WV_1_PC_1_EH_0_PS_40, loss: 0.017125844955444336, avg_mse: 0.026547372341156006
current test mse: 0.026547
Iteration: 1401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019078254699707, gen p mean: -0.11074218153953552, mean p set: 0.4507681429386139
loss_pred:0.015713445842266083, decouple_loss:0.0007972058956511319
The modified gen p mean: 0.45227864384651184, gen p mean: -0.10726354271173477, mean p set: 0.4528560936450958
loss_pred:0.016254467889666557, decouple_loss:0.0007869638502597809
The modified gen p mean: 0.44964084029197693, gen p mean: -0.10976321995258331, mean p set: 0.4502184987068176
loss_pred:0.016231611371040344, decouple_loss:0.0008882965776138008
Iteration: 1402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012226700782776, gen p mean: -0.1076008602976799, mean p set: 0.4506986141204834
loss_pred:0.01682906411588192, decouple_loss:0.0009212606237269938
The modified gen p mean: 0.45083099603652954, gen p mean: -0.10729733854532242, mean p set: 0.45140859484672546The modified gen p mean: 0.45049816370010376, gen p mean: -0.11031735688447952, mean p set: 0.45107343792915344
loss_pred:0.01682393252849579, decouple_loss:0.0007537605706602335
loss_pred:0.015889598056674004, decouple_loss:0.0006904828478582203
Iteration: 1403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45020702481269836, gen p mean: -0.10909572243690491, mean p set: 0.45078444480895996
loss_pred:0.016310641542077065, decouple_loss:0.0007292662048712373
The modified gen p mean: 0.4520595371723175, gen p mean: -0.10157456248998642, mean p set: 0.452638179063797The modified gen p mean: 0.4499805271625519, gen p mean: -0.10812799632549286, mean p set: 0.45055627822875977
loss_pred:0.017204584553837776, decouple_loss:0.00066426518606022loss_pred:0.016220493242144585, decouple_loss:0.0007267776527442038
Iteration: 1404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45207396149635315, gen p mean: -0.10584627091884613, mean p set: 0.4526509940624237
loss_pred:0.017281964421272278, decouple_loss:0.0010004930663853884
The modified gen p mean: 0.45106765627861023, gen p mean: -0.10223796218633652, mean p set: 0.4516444504261017
loss_pred:0.016795380041003227, decouple_loss:0.0008946453453972936
The modified gen p mean: 0.4522368013858795, gen p mean: -0.10396631062030792, mean p set: 0.45281288027763367
loss_pred:0.017444342374801636, decouple_loss:0.0009172916761599481
Iteration: 1405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500647783279419, gen p mean: -0.10495144128799438, mean p set: 0.4506409764289856
loss_pred:0.01571408472955227, decouple_loss:0.0007263018051162362
The modified gen p mean: 0.4498733878135681, gen p mean: -0.10526497662067413, mean p set: 0.45045205950737
loss_pred:0.016144469380378723, decouple_loss:0.0007573436596430838
The modified gen p mean: 0.45056748390197754, gen p mean: -0.1077713817358017, mean p set: 0.45114099979400635
loss_pred:0.015827683731913567, decouple_loss:0.0009523617336526513
Iteration: 1406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44987621903419495, gen p mean: -0.1051839143037796, mean p set: 0.4504525363445282
loss_pred:0.01633983664214611, decouple_loss:0.0007907141116447747
The modified gen p mean: 0.4508012533187866, gen p mean: -0.10688374936580658, mean p set: 0.4513775408267975
loss_pred:0.015395968221127987, decouple_loss:0.0008414180483669043
The modified gen p mean: 0.4524357318878174, gen p mean: -0.10503477603197098, mean p set: 0.45301249623298645
loss_pred:0.015858380123972893, decouple_loss:0.0008351641590707004
Iteration: 1407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45258423686027527, gen p mean: -0.09771718829870224, mean p set: 0.4531611502170563
loss_pred:0.016667701303958893, decouple_loss:0.0011583463056012988
The modified gen p mean: 0.4513767957687378, gen p mean: -0.0957556888461113, mean p set: 0.45195385813713074
loss_pred:0.015482314862310886, decouple_loss:0.0014286170480772853
The modified gen p mean: 0.45065513253211975, gen p mean: -0.10266369581222534, mean p set: 0.45123252272605896
loss_pred:0.016354212537407875, decouple_loss:0.0008496434311382473
Iteration: 1408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44986605644226074, gen p mean: -0.10192229598760605, mean p set: 0.45044317841529846
loss_pred:0.016172630712389946, decouple_loss:0.0007564783445559442
The modified gen p mean: 0.4518097937107086, gen p mean: -0.09235735982656479, mean p set: 0.4523874819278717
loss_pred:0.01601332798600197, decouple_loss:0.0008532957872375846
The modified gen p mean: 0.45209431648254395, gen p mean: -0.10157874971628189, mean p set: 0.45267269015312195
loss_pred:0.015636112540960312, decouple_loss:0.000705348327755928
Iteration: 1409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45212653279304504, gen p mean: -0.1004686951637268, mean p set: 0.4527009129524231
loss_pred:0.015381380915641785, decouple_loss:0.0008281306363642216
The modified gen p mean: 0.45091626048088074, gen p mean: -0.09796800464391708, mean p set: 0.45149174332618713
loss_pred:0.015632232651114464, decouple_loss:0.0008556906832382083
The modified gen p mean: 0.4524076581001282, gen p mean: -0.09497407078742981, mean p set: 0.4529861509799957
loss_pred:0.016142036765813828, decouple_loss:0.0008594681858085096
Iteration: 1410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499734044075012, gen p mean: -0.0991404801607132, mean p set: 0.4505482017993927
loss_pred:0.016258958727121353, decouple_loss:0.0010145377600565553
The modified gen p mean: 0.4505871832370758, gen p mean: -0.10165566205978394, mean p set: 0.45116284489631653
loss_pred:0.015929821878671646, decouple_loss:0.0008512611384503543
The modified gen p mean: 0.4500157833099365, gen p mean: -0.10020719468593597, mean p set: 0.4505917727947235
loss_pred:0.015972374007105827, decouple_loss:0.0008262850460596383
2023-05-01 04:34:20 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10934033244848251, mean p set: 0.4502691626548767
loss_pred:0.017397237941622734, decouple_loss:0.0011206893250346184
The modified gen p mean: 0.4495362937450409, gen p mean: -0.10359880328178406, mean p set: 0.4500633478164673
loss_pred:0.01669522188603878, decouple_loss:0.0013113217428326607
The modified gen p mean: 0.4498266577720642, gen p mean: -0.10265952348709106, mean p set: 0.45035696029663086
loss_pred:0.017140047624707222, decouple_loss:0.0011217897990718484
WV_1_PC_1_EH_0_PS_40, loss: 0.01713673397898674, avg_mse: 0.02653638832271099
current test mse: 0.026536
Iteration: 1411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537951648235321, gen p mean: -0.09639107435941696, mean p set: 0.45437467098236084
loss_pred:0.015676265582442284, decouple_loss:0.0009512328542768955
The modified gen p mean: 0.4534222185611725, gen p mean: -0.09871247410774231, mean p set: 0.453996479511261The modified gen p mean: 0.45210978388786316, gen p mean: -0.09639903157949448, mean p set: 0.4526849389076233
loss_pred:0.015619385987520218, decouple_loss:0.0007396620931103826
loss_pred:0.016406139358878136, decouple_loss:0.0008734292932786047
Iteration: 1412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45199012756347656, gen p mean: -0.10156349092721939, mean p set: 0.4525681734085083
loss_pred:0.0161304734647274, decouple_loss:0.0009327467414550483
The modified gen p mean: 0.44988101720809937, gen p mean: -0.1028720960021019, mean p set: 0.450456827878952The modified gen p mean: 0.4494943618774414, gen p mean: -0.09708903729915619, mean p set: 0.4500705301761627
loss_pred:0.01694263517856598, decouple_loss:0.0009691902087070048loss_pred:0.016971465200185776, decouple_loss:0.0011438318761065602
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
NaN value num: 0
Iteration: 1413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475780725479126, gen p mean: -0.10897466540336609, mean p set: 0.448152095079422
loss_pred:0.016452176496386528, decouple_loss:0.0011674402048811316
The modified gen p mean: 0.4471401870250702, gen p mean: -0.10607162117958069, mean p set: 0.4477160573005676The modified gen p mean: 0.44758448004722595, gen p mean: -0.10642711073160172, mean p set: 0.448160856962204
loss_pred:0.01686021126806736, decouple_loss:0.0009351441403850913
loss_pred:0.017784135416150093, decouple_loss:0.000856444938108325
Iteration: 1414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474944770336151, gen p mean: -0.10371200740337372, mean p set: 0.44807007908821106
loss_pred:0.016573531553149223, decouple_loss:0.0009324545389972627
The modified gen p mean: 0.4474828541278839, gen p mean: -0.10542694479227066, mean p set: 0.44805875420570374
loss_pred:0.016641877591609955, decouple_loss:0.0009645068203099072
The modified gen p mean: 0.445486456155777, gen p mean: -0.1093350201845169, mean p set: 0.44606053829193115
loss_pred:0.01683095097541809, decouple_loss:0.0008886090945452452
Iteration: 1415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469696879386902, gen p mean: -0.1008024662733078, mean p set: 0.447546124458313
loss_pred:0.018041519448161125, decouple_loss:0.0012276702327653766
The modified gen p mean: 0.44609442353248596, gen p mean: -0.10914797335863113, mean p set: 0.4466695487499237
loss_pred:0.01705082878470421, decouple_loss:0.0010410870891064405
The modified gen p mean: 0.445586234331131, gen p mean: -0.1115703359246254, mean p set: 0.4461626410484314
loss_pred:0.016345234587788582, decouple_loss:0.0010160504607483745
Iteration: 1416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473227560520172, gen p mean: -0.1080402210354805, mean p set: 0.4478980302810669
loss_pred:0.016813866794109344, decouple_loss:0.000875653640832752
The modified gen p mean: 0.4470405876636505, gen p mean: -0.1151447594165802, mean p set: 0.4476166069507599
loss_pred:0.016794858500361443, decouple_loss:0.001062449300661683
The modified gen p mean: 0.4460631012916565, gen p mean: -0.1083812266588211, mean p set: 0.4466399550437927
loss_pred:0.016899006441235542, decouple_loss:0.0007786726928316057
Iteration: 1417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44629964232444763, gen p mean: -0.11204881221055984, mean p set: 0.4468752145767212
loss_pred:0.016655152663588524, decouple_loss:0.0011186299379915
The modified gen p mean: 0.44720131158828735, gen p mean: -0.11092277616262436, mean p set: 0.44777578115463257
loss_pred:0.016854995861649513, decouple_loss:0.0010031010024249554
The modified gen p mean: 0.44838830828666687, gen p mean: -0.11759747564792633, mean p set: 0.44896718859672546
loss_pred:0.017481816932559013, decouple_loss:0.0009573994320817292
Iteration: 1418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489588439464569, gen p mean: -0.11644183099269867, mean p set: 0.44953420758247375
loss_pred:0.01717892847955227, decouple_loss:0.0011469487799331546
The modified gen p mean: 0.44642403721809387, gen p mean: -0.11146117746829987, mean p set: 0.44699984788894653
loss_pred:0.017078327015042305, decouple_loss:0.001013095024973154
The modified gen p mean: 0.4462580680847168, gen p mean: -0.11259497702121735, mean p set: 0.4468367099761963
loss_pred:0.016988258808851242, decouple_loss:0.0008839548681862652
Iteration: 1419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471858739852905, gen p mean: -0.10931294411420822, mean p set: 0.4477635622024536
loss_pred:0.01645476557314396, decouple_loss:0.0008477981900796294
The modified gen p mean: 0.4470821022987366, gen p mean: -0.11140401661396027, mean p set: 0.44765612483024597
loss_pred:0.016718130558729172, decouple_loss:0.0008428441360592842
The modified gen p mean: 0.44729897379875183, gen p mean: -0.11139169335365295, mean p set: 0.4478749930858612
loss_pred:0.017173176631331444, decouple_loss:0.0010853549465537071
Iteration: 1420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44685474038124084, gen p mean: -0.10049250721931458, mean p set: 0.44742998480796814
loss_pred:0.017871754243969917, decouple_loss:0.0009124937932938337
The modified gen p mean: 0.4470524489879608, gen p mean: -0.10635503381490707, mean p set: 0.44762900471687317
loss_pred:0.01574377529323101, decouple_loss:0.0008417059434577823
The modified gen p mean: 0.44837725162506104, gen p mean: -0.10613825917243958, mean p set: 0.4489504396915436
loss_pred:0.01711813174188137, decouple_loss:0.0007940181531012058
2023-05-01 04:37:14 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11274542659521103, mean p set: 0.4502691626548767
loss_pred:0.017638757824897766, decouple_loss:0.0008184514590539038
The modified gen p mean: 0.4495348632335663, gen p mean: -0.10639258474111557, mean p set: 0.4500633478164673
loss_pred:0.016755012795329094, decouple_loss:0.0009596548043191433
The modified gen p mean: 0.4498257040977478, gen p mean: -0.10548872500658035, mean p set: 0.45035696029663086
loss_pred:0.017121106386184692, decouple_loss:0.0009054709225893021
WV_1_PC_1_EH_0_PS_40, loss: 0.017216352745890617, avg_mse: 0.02663499116897583
current test mse: 0.026635
Iteration: 1421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468443989753723, gen p mean: -0.11414166539907455, mean p set: 0.4474208950996399
loss_pred:0.016684306785464287, decouple_loss:0.0011627214262261987
The modified gen p mean: 0.4474349915981293, gen p mean: -0.10163716971874237, mean p set: 0.4480101466178894
The modified gen p mean: 0.44729840755462646, gen p mean: -0.10777676850557327, mean p set: 0.4478749632835388
loss_pred:0.016187481582164764, decouple_loss:0.0006470293155871332
loss_pred:0.01673898473381996, decouple_loss:0.0007300454308278859
Iteration: 1422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779932498931885, gen p mean: -0.10968048870563507, mean p set: 0.448373407125473
loss_pred:0.016399985179305077, decouple_loss:0.0011187976924702525
The modified gen p mean: 0.44729864597320557, gen p mean: -0.10775367170572281, mean p set: 0.4478742182254791The modified gen p mean: 0.4468997120857239, gen p mean: -0.10769487917423248, mean p set: 0.4474751055240631
loss_pred:0.017161089926958084, decouple_loss:0.0006948058726266026
loss_pred:0.01623595505952835, decouple_loss:0.0006771044572815299
Iteration: 1423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477684199810028, gen p mean: -0.10522715002298355, mean p set: 0.44834375381469727
The modified gen p mean: 0.44751104712486267, gen p mean: -0.1086449921131134, mean p set: 0.44808676838874817loss_pred:0.017691677436232567, decouple_loss:0.0008770055137574673
loss_pred:0.016601644456386566, decouple_loss:0.0008776254253461957
The modified gen p mean: 0.44761592149734497, gen p mean: -0.10129774361848831, mean p set: 0.4481947124004364
loss_pred:0.017311949282884598, decouple_loss:0.0007172145997174084
Iteration: 1424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44651466608047485, gen p mean: -0.11226808279752731, mean p set: 0.44709208607673645
loss_pred:0.01704547181725502, decouple_loss:0.0012021770235151052
The modified gen p mean: 0.4464404582977295, gen p mean: -0.11014764755964279, mean p set: 0.44701457023620605
loss_pred:0.01722494512796402, decouple_loss:0.000816709769424051
The modified gen p mean: 0.44689035415649414, gen p mean: -0.1126553937792778, mean p set: 0.44746798276901245
loss_pred:0.0169815756380558, decouple_loss:0.0007108411518856883
Iteration: 1425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447256475687027, gen p mean: -0.10967519879341125, mean p set: 0.44783106446266174
The modified gen p mean: 0.4466184079647064, gen p mean: -0.1134062185883522, mean p set: 0.44719216227531433
loss_pred:0.01616818830370903, decouple_loss:0.0007376549183391035
loss_pred:0.016859063878655434, decouple_loss:0.001124675152823329
The modified gen p mean: 0.4458589255809784, gen p mean: -0.11114133149385452, mean p set: 0.4464336037635803
loss_pred:0.01648041233420372, decouple_loss:0.001010734005831182
Iteration: 1426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472199082374573, gen p mean: -0.10949999839067459, mean p set: 0.44779494404792786
loss_pred:0.016945837065577507, decouple_loss:0.00067985022906214
The modified gen p mean: 0.4469374120235443, gen p mean: -0.11861328780651093, mean p set: 0.4475148916244507
loss_pred:0.016140177845954895, decouple_loss:0.0006526821525767446
The modified gen p mean: 0.4483109712600708, gen p mean: -0.11622729152441025, mean p set: 0.4488895833492279
loss_pred:0.016481541097164154, decouple_loss:0.0007243262371048331
Iteration: 1427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714343547821045, gen p mean: -0.10847263783216476, mean p set: 0.4477180242538452
loss_pred:0.017136521637439728, decouple_loss:0.000627630390226841
The modified gen p mean: 0.44671744108200073, gen p mean: -0.11797020584344864, mean p set: 0.44729119539260864
The modified gen p mean: 0.4474547803401947, gen p mean: -0.10940869152545929, mean p set: 0.44803011417388916
loss_pred:0.016760723665356636, decouple_loss:0.0010724145686253905
loss_pred:0.01781516894698143, decouple_loss:0.001069433055818081
Iteration: 1428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470423758029938, gen p mean: -0.11436423659324646, mean p set: 0.44762122631073
loss_pred:0.01634269580245018, decouple_loss:0.0007540487567894161
The modified gen p mean: 0.4460623264312744, gen p mean: -0.11523008346557617, mean p set: 0.44663766026496887
The modified gen p mean: 0.4476313591003418, gen p mean: -0.1140395775437355, mean p set: 0.44820722937583923
loss_pred:0.01663125492632389, decouple_loss:0.0008039881358854473
loss_pred:0.017153698951005936, decouple_loss:0.0006689363508485258
Iteration: 1429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461267292499542, gen p mean: -0.11649183183908463, mean p set: 0.44670340418815613
loss_pred:0.016865026205778122, decouple_loss:0.0012256891932338476
The modified gen p mean: 0.44699275493621826, gen p mean: -0.1216440498828888, mean p set: 0.447569340467453
loss_pred:0.01684749685227871, decouple_loss:0.0007989085861481726
The modified gen p mean: 0.4463614821434021, gen p mean: -0.11312690377235413, mean p set: 0.4469371736049652
loss_pred:0.016675563529133797, decouple_loss:0.0006470753578469157
Iteration: 1430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472283124923706, gen p mean: -0.11702919751405716, mean p set: 0.44780099391937256
loss_pred:0.016625866293907166, decouple_loss:0.0006519034504890442
The modified gen p mean: 0.44666096568107605, gen p mean: -0.11717583984136581, mean p set: 0.44723597168922424
loss_pred:0.017545972019433975, decouple_loss:0.0009690324077382684
The modified gen p mean: 0.44716593623161316, gen p mean: -0.11864380538463593, mean p set: 0.4477405250072479
loss_pred:0.016036612913012505, decouple_loss:0.0005934853106737137
2023-05-01 04:39:19 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12046580016613007, mean p set: 0.4502691626548767
loss_pred:0.017422767356038094, decouple_loss:0.0007619987591169775
The modified gen p mean: 0.44953495264053345, gen p mean: -0.11419620364904404, mean p set: 0.4500633478164673
loss_pred:0.016729023307561874, decouple_loss:0.0007492148433811963
The modified gen p mean: 0.44982674717903137, gen p mean: -0.1133711114525795, mean p set: 0.45035696029663086
loss_pred:0.017151150852441788, decouple_loss:0.0006656068726442754
WV_1_PC_1_EH_0_PS_40, loss: 0.017137261107563972, avg_mse: 0.026643751189112663
current test mse: 0.026644
Iteration: 1431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476299285888672, gen p mean: -0.12076330929994583, mean p set: 0.44820359349250793
loss_pred:0.0163288377225399, decouple_loss:0.0006869349745102227
The modified gen p mean: 0.44730883836746216, gen p mean: -0.11791510134935379, mean p set: 0.44788476824760437The modified gen p mean: 0.4471176564693451, gen p mean: -0.11377904564142227, mean p set: 0.44769227504730225
loss_pred:0.016087619587779045, decouple_loss:0.0007104250253178179
loss_pred:0.016448233276605606, decouple_loss:0.000955224153585732
Iteration: 1432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468497335910797, gen p mean: -0.11576740443706512, mean p set: 0.44742920994758606
loss_pred:0.016394775360822678, decouple_loss:0.0008432756876572967
The modified gen p mean: 0.4479531943798065, gen p mean: -0.11066222190856934, mean p set: 0.4485294818878174The modified gen p mean: 0.44933515787124634, gen p mean: -0.12173035740852356, mean p set: 0.44990822672843933
loss_pred:0.017335791140794754, decouple_loss:0.0011076166993007064loss_pred:0.016982145607471466, decouple_loss:0.0009859007550403476
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 1433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475014805793762, gen p mean: -0.11592703312635422, mean p set: 0.44807806611061096
loss_pred:0.016950983554124832, decouple_loss:0.0007663692231290042
The modified gen p mean: 0.4470917582511902, gen p mean: -0.11711370944976807, mean p set: 0.44766902923583984The modified gen p mean: 0.44731399416923523, gen p mean: -0.11593510210514069, mean p set: 0.44788745045661926
loss_pred:0.016444386914372444, decouple_loss:0.0008624813053756952
loss_pred:0.0168130062520504, decouple_loss:0.0009145448566414416
Iteration: 1434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716018438339233, gen p mean: -0.11667247861623764, mean p set: 0.447732150554657
loss_pred:0.01637265644967556, decouple_loss:0.0007374344859272242
The modified gen p mean: 0.44635406136512756, gen p mean: -0.11835192888975143, mean p set: 0.44692856073379517
loss_pred:0.015967795625329018, decouple_loss:0.0006265723495744169
The modified gen p mean: 0.44694191217422485, gen p mean: -0.11943492293357849, mean p set: 0.44751712679862976
loss_pred:0.01674286276102066, decouple_loss:0.0007260901038534939
Iteration: 1435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459242522716522, gen p mean: -0.11853432655334473, mean p set: 0.4465000033378601
loss_pred:0.015904085710644722, decouple_loss:0.0006383265717886388
The modified gen p mean: 0.447416216135025, gen p mean: -0.11751321703195572, mean p set: 0.44799020886421204
loss_pred:0.01579340174794197, decouple_loss:0.0008800931973382831
The modified gen p mean: 0.4473404288291931, gen p mean: -0.11615610122680664, mean p set: 0.447918564081192
loss_pred:0.015698952600359917, decouple_loss:0.0008684779168106616
Iteration: 1436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795697927474976, gen p mean: -0.11722826957702637, mean p set: 0.448532372713089
loss_pred:0.016380736604332924, decouple_loss:0.0006988561945036054
The modified gen p mean: 0.44647517800331116, gen p mean: -0.11657970398664474, mean p set: 0.4470498263835907
loss_pred:0.01529047079384327, decouple_loss:0.0006990569527260959
The modified gen p mean: 0.44755610823631287, gen p mean: -0.11416579782962799, mean p set: 0.44813206791877747
loss_pred:0.01639159768819809, decouple_loss:0.0007193853962235153
Iteration: 1437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768446683883667, gen p mean: -0.11707651615142822, mean p set: 0.4482622444629669
loss_pred:0.016415003687143326, decouple_loss:0.0008543837466277182
The modified gen p mean: 0.4461381733417511, gen p mean: -0.1124076172709465, mean p set: 0.44671353697776794
loss_pred:0.016341201961040497, decouple_loss:0.0008433749317191541
The modified gen p mean: 0.4458296000957489, gen p mean: -0.11243834346532822, mean p set: 0.4464031159877777
loss_pred:0.015944231301546097, decouple_loss:0.0009448423516005278
Iteration: 1438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688165187835693, gen p mean: -0.11522307246923447, mean p set: 0.4474559724330902
loss_pred:0.015941474586725235, decouple_loss:0.00107439118437469
The modified gen p mean: 0.4467364549636841, gen p mean: -0.11606809496879578, mean p set: 0.4473114311695099
The modified gen p mean: 0.44680678844451904, gen p mean: -0.1152246743440628, mean p set: 0.44737792015075684
loss_pred:0.015416592359542847, decouple_loss:0.0010192041518166661
loss_pred:0.016046816483139992, decouple_loss:0.0010397785808891058
Iteration: 1439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461323022842407, gen p mean: -0.11622732877731323, mean p set: 0.4467087388038635
loss_pred:0.016335977241396904, decouple_loss:0.0006918599247001112
The modified gen p mean: 0.4464429020881653, gen p mean: -0.11881375312805176, mean p set: 0.4470173120498657
loss_pred:0.015970081090927124, decouple_loss:0.0006579568143934011
The modified gen p mean: 0.4457378089427948, gen p mean: -0.11552337557077408, mean p set: 0.4463140368461609
loss_pred:0.01619422622025013, decouple_loss:0.0007723239832557738
Iteration: 1440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44635507464408875, gen p mean: -0.11684311181306839, mean p set: 0.4469307065010071
loss_pred:0.017084434628486633, decouple_loss:0.0008877038490027189
The modified gen p mean: 0.44597524404525757, gen p mean: -0.11645140498876572, mean p set: 0.44655176997184753
loss_pred:0.016620323061943054, decouple_loss:0.0009514490375295281
The modified gen p mean: 0.4458285868167877, gen p mean: -0.11827680468559265, mean p set: 0.44640329480171204
loss_pred:0.01635160855948925, decouple_loss:0.0009381837444379926
2023-05-01 04:42:06 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12251894176006317, mean p set: 0.4502691626548767
loss_pred:0.01728884130716324, decouple_loss:0.0009920612210407853
The modified gen p mean: 0.4495348036289215, gen p mean: -0.11646413803100586, mean p set: 0.4500633478164673
loss_pred:0.01663421280682087, decouple_loss:0.0008172860252670944
The modified gen p mean: 0.4498281180858612, gen p mean: -0.11619927734136581, mean p set: 0.45035696029663086
loss_pred:0.01703043282032013, decouple_loss:0.0007673833752050996
WV_1_PC_1_EH_0_PS_40, loss: 0.017027441412210464, avg_mse: 0.026465686038136482
current test mse: 0.026466
Iteration: 1441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461199641227722, gen p mean: -0.11497741937637329, mean p set: 0.44669607281684875
loss_pred:0.015500182285904884, decouple_loss:0.0008744551450945437
The modified gen p mean: 0.44793736934661865, gen p mean: -0.12046962976455688, mean p set: 0.44851207733154297The modified gen p mean: 0.4463767409324646, gen p mean: -0.12126771360635757, mean p set: 0.44695183634757996
loss_pred:0.015845254063606262, decouple_loss:0.0007044327212497592
loss_pred:0.016291368752717972, decouple_loss:0.0009518008446320891
Iteration: 1442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463970363140106, gen p mean: -0.12327975034713745, mean p set: 0.4469722807407379
The modified gen p mean: 0.44643914699554443, gen p mean: -0.11737815290689468, mean p set: 0.4470142424106598
loss_pred:0.01580861210823059, decouple_loss:0.0007862087222747505
loss_pred:0.015714216977357864, decouple_loss:0.0006530118989758193
The modified gen p mean: 0.4464491605758667, gen p mean: -0.11928343027830124, mean p set: 0.44702646136283875
loss_pred:0.015731537714600563, decouple_loss:0.0007777531864121556
Iteration: 1443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445805162191391, gen p mean: -0.12243704497814178, mean p set: 0.4463808834552765
loss_pred:0.016122234985232353, decouple_loss:0.0007693402003496885
The modified gen p mean: 0.4478491246700287, gen p mean: -0.12265004962682724, mean p set: 0.4484235644340515
loss_pred:0.01570144295692444, decouple_loss:0.0008066486334428191
The modified gen p mean: 0.44752249121665955, gen p mean: -0.12365617603063583, mean p set: 0.4480991065502167
loss_pred:0.015938714146614075, decouple_loss:0.0010246186284348369
Iteration: 1444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44636645913124084, gen p mean: -0.11782757192850113, mean p set: 0.4469420909881592
The modified gen p mean: 0.44586101174354553, gen p mean: -0.12038595974445343, mean p set: 0.44643494486808777
loss_pred:0.016341082751750946, decouple_loss:0.000826219969894737
loss_pred:0.01579437591135502, decouple_loss:0.000642965838778764
The modified gen p mean: 0.44653037190437317, gen p mean: -0.11484836786985397, mean p set: 0.447105348110199
loss_pred:0.01608429104089737, decouple_loss:0.0006947960355319083
Iteration: 1445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477454423904419, gen p mean: -0.1137700080871582, mean p set: 0.448323518037796
The modified gen p mean: 0.4466809928417206, gen p mean: -0.11632867157459259, mean p set: 0.44725537300109863
loss_pred:0.016317300498485565, decouple_loss:0.0008433657349087298
loss_pred:0.015896553173661232, decouple_loss:0.00072207156335935
The modified gen p mean: 0.44622087478637695, gen p mean: -0.11670119315385818, mean p set: 0.44679760932922363
loss_pred:0.016555996611714363, decouple_loss:0.0006225341348908842
Iteration: 1446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609856605529785, gen p mean: -0.1135309636592865, mean p set: 0.44667407870292664
loss_pred:0.01653178036212921, decouple_loss:0.0006287033902481198
The modified gen p mean: 0.44574153423309326, gen p mean: -0.1172323003411293, mean p set: 0.44631776213645935
loss_pred:0.015749284997582436, decouple_loss:0.0007075808825902641
The modified gen p mean: 0.44751861691474915, gen p mean: -0.11393000185489655, mean p set: 0.44809842109680176
loss_pred:0.016101570799946785, decouple_loss:0.0006360518164001405
Iteration: 1447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792258739471436, gen p mean: -0.11246561259031296, mean p set: 0.4484979510307312
The modified gen p mean: 0.44550564885139465, gen p mean: -0.11707227677106857, mean p set: 0.4460800588130951
loss_pred:0.016428465023636818, decouple_loss:0.0006257985951378942
loss_pred:0.015603413805365562, decouple_loss:0.000628273410256952
The modified gen p mean: 0.44687336683273315, gen p mean: -0.1089487224817276, mean p set: 0.44744786620140076
loss_pred:0.016168810427188873, decouple_loss:0.0006172384019009769
Iteration: 1448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44596123695373535, gen p mean: -0.11432652175426483, mean p set: 0.44653645157814026
loss_pred:0.015198418870568275, decouple_loss:0.0006398037658073008
The modified gen p mean: 0.44831499457359314, gen p mean: -0.1160808652639389, mean p set: 0.44888943433761597
The modified gen p mean: 0.4471840560436249, gen p mean: -0.11797358095645905, mean p set: 0.44775912165641785
loss_pred:0.015954433009028435, decouple_loss:0.0006251070881262422
loss_pred:0.01667623780667782, decouple_loss:0.0007668221369385719
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466629922389984, gen p mean: -0.11386940628290176, mean p set: 0.4472399353981018
The modified gen p mean: 0.4473000466823578, gen p mean: -0.11514531075954437, mean p set: 0.44787484407424927loss_pred:0.016229892149567604, decouple_loss:0.0008439377998001873
loss_pred:0.015677904710173607, decouple_loss:0.0008659812156111002
The modified gen p mean: 0.44558462500572205, gen p mean: -0.11641021817922592, mean p set: 0.44616246223449707
loss_pred:0.016010457649827003, decouple_loss:0.000755050394218415
Iteration: 1450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44641008973121643, gen p mean: -0.12514108419418335, mean p set: 0.4469846189022064
The modified gen p mean: 0.4465586841106415, gen p mean: -0.12236929684877396, mean p set: 0.44713470339775085
loss_pred:0.016571128740906715, decouple_loss:0.0006400402635335922
loss_pred:0.01637474074959755, decouple_loss:0.0007716643740423024
The modified gen p mean: 0.44647136330604553, gen p mean: -0.12554414570331573, mean p set: 0.44704657793045044
loss_pred:0.016179516911506653, decouple_loss:0.0006283540860749781
2023-05-01 04:44:11 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12874269485473633, mean p set: 0.4502691626548767
loss_pred:0.017334122210741043, decouple_loss:0.0006584080401808023
The modified gen p mean: 0.44953569769859314, gen p mean: -0.1228102371096611, mean p set: 0.4500633478164673
loss_pred:0.0166211798787117, decouple_loss:0.0008141578291542828
The modified gen p mean: 0.44983065128326416, gen p mean: -0.12237440794706345, mean p set: 0.45035696029663086
loss_pred:0.01693863607943058, decouple_loss:0.0007067003753036261
WV_1_PC_1_EH_0_PS_40, loss: 0.017000969499349594, avg_mse: 0.026443589478731155
current test mse: 0.026444
Iteration: 1451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466048777103424, gen p mean: -0.12831030786037445, mean p set: 0.4471801817417145
loss_pred:0.016549155116081238, decouple_loss:0.0006630151765421033
The modified gen p mean: 0.44538742303848267, gen p mean: -0.12899157404899597, mean p set: 0.44596222043037415The modified gen p mean: 0.4456622004508972, gen p mean: -0.12619957327842712, mean p set: 0.4462362825870514
loss_pred:0.015770986676216125, decouple_loss:0.0006190436542965472
loss_pred:0.015455749817192554, decouple_loss:0.0008208125364035368
Iteration: 1452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44519832730293274, gen p mean: -0.126526340842247, mean p set: 0.4457741975784302
loss_pred:0.015512334182858467, decouple_loss:0.0006221931544132531
The modified gen p mean: 0.44661667943000793, gen p mean: -0.1273178607225418, mean p set: 0.4471932351589203The modified gen p mean: 0.44614657759666443, gen p mean: -0.12146894633769989, mean p set: 0.4467202425003052
loss_pred:0.01652047410607338, decouple_loss:0.0006898159626871347
loss_pred:0.01589347794651985, decouple_loss:0.0006537298322655261
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
NaN value num: 0
Iteration: 1453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45086777210235596, gen p mean: -0.11176912486553192, mean p set: 0.4514442980289459
loss_pred:0.016856137663125992, decouple_loss:0.0008511449559591711
The modified gen p mean: 0.4517788589000702, gen p mean: -0.1168150082230568, mean p set: 0.4523555636405945
The modified gen p mean: 0.4501686096191406, gen p mean: -0.1154828816652298, mean p set: 0.45074760913848877
loss_pred:0.016382401809096336, decouple_loss:0.0013115605106577277
loss_pred:0.01767495833337307, decouple_loss:0.0008613799000158906
Iteration: 1454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44932305812835693, gen p mean: -0.1138775572180748, mean p set: 0.449899822473526
loss_pred:0.01705944538116455, decouple_loss:0.0008526596357114613
The modified gen p mean: 0.45143651962280273, gen p mean: -0.11065759509801865, mean p set: 0.45201170444488525
loss_pred:0.016353895887732506, decouple_loss:0.0009321262477897108
The modified gen p mean: 0.4500081539154053, gen p mean: -0.11395486444234848, mean p set: 0.45058155059814453
loss_pred:0.017383303493261337, decouple_loss:0.0006624649977311492
Iteration: 1455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44955703616142273, gen p mean: -0.10840258002281189, mean p set: 0.45013299584388733
loss_pred:0.01701587624847889, decouple_loss:0.0007179522654041648
The modified gen p mean: 0.45199912786483765, gen p mean: -0.10452742129564285, mean p set: 0.45257672667503357
loss_pred:0.01632818952202797, decouple_loss:0.0007020261837169528
The modified gen p mean: 0.449515163898468, gen p mean: -0.11136333644390106, mean p set: 0.4500918984413147
loss_pred:0.017611365765333176, decouple_loss:0.0007847636006772518
Iteration: 1456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449348509311676, gen p mean: -0.10312049835920334, mean p set: 0.44992515444755554
loss_pred:0.017274852842092514, decouple_loss:0.0009390449849888682
The modified gen p mean: 0.4492320716381073, gen p mean: -0.10406418889760971, mean p set: 0.4498090147972107
loss_pred:0.018290909007191658, decouple_loss:0.0010524071985855699
The modified gen p mean: 0.4497300386428833, gen p mean: -0.10646176338195801, mean p set: 0.45030614733695984
loss_pred:0.01761488988995552, decouple_loss:0.0012069771764799953
Iteration: 1457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450230211019516, gen p mean: -0.1033606305718422, mean p set: 0.4508068561553955
loss_pred:0.01763446442782879, decouple_loss:0.000926456181332469
The modified gen p mean: 0.45086222887039185, gen p mean: -0.10119576007127762, mean p set: 0.45143812894821167
loss_pred:0.017670679837465286, decouple_loss:0.000805694900918752
The modified gen p mean: 0.45132067799568176, gen p mean: -0.10024789720773697, mean p set: 0.45189735293388367
loss_pred:0.018588224425911903, decouple_loss:0.0008023098926059902
Iteration: 1458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933849573135376, gen p mean: -0.10657104104757309, mean p set: 0.44991254806518555
loss_pred:0.017336681485176086, decouple_loss:0.000700439908541739
The modified gen p mean: 0.44963711500167847, gen p mean: -0.10733289271593094, mean p set: 0.4502132534980774
The modified gen p mean: 0.4507448971271515, gen p mean: -0.09962148219347, mean p set: 0.451321005821228
loss_pred:0.018177323043346405, decouple_loss:0.0006910354713909328
loss_pred:0.017250768840312958, decouple_loss:0.001050917198881507
Iteration: 1459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507371485233307, gen p mean: -0.10137948393821716, mean p set: 0.45131561160087585
loss_pred:0.016820356249809265, decouple_loss:0.0007703614537604153
The modified gen p mean: 0.45144274830818176, gen p mean: -0.10336610674858093, mean p set: 0.4520154595375061
loss_pred:0.017141306772828102, decouple_loss:0.0007949159480631351
The modified gen p mean: 0.45068827271461487, gen p mean: -0.10860168188810349, mean p set: 0.4512638449668884
loss_pred:0.016581889241933823, decouple_loss:0.0010379820596426725
Iteration: 1460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496000111103058, gen p mean: -0.10478027164936066, mean p set: 0.450173020362854
loss_pred:0.017368262633681297, decouple_loss:0.0007515878533013165
The modified gen p mean: 0.450666218996048, gen p mean: -0.10172617435455322, mean p set: 0.4512418508529663
loss_pred:0.016872137784957886, decouple_loss:0.0008356096805073321
The modified gen p mean: 0.4511200785636902, gen p mean: -0.10586049407720566, mean p set: 0.4516952931880951
loss_pred:0.016828974708914757, decouple_loss:0.0007552584866061807
2023-05-01 04:46:53 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12009359896183014, mean p set: 0.4502691626548767
loss_pred:0.017450720071792603, decouple_loss:0.0008548755431547761
The modified gen p mean: 0.4495346248149872, gen p mean: -0.1137932687997818, mean p set: 0.4500633478164673
loss_pred:0.016668831929564476, decouple_loss:0.001076633925549686
The modified gen p mean: 0.4498271942138672, gen p mean: -0.11313100904226303, mean p set: 0.45035696029663086
loss_pred:0.016974100843071938, decouple_loss:0.0010072760051116347
WV_1_PC_1_EH_0_PS_40, loss: 0.017080198973417282, avg_mse: 0.026573454961180687
current test mse: 0.026573
Iteration: 1461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44994911551475525, gen p mean: -0.11155387759208679, mean p set: 0.45052459836006165
loss_pred:0.016861597076058388, decouple_loss:0.0008826866396702826
The modified gen p mean: 0.4497373104095459, gen p mean: -0.11053887754678726, mean p set: 0.45031243562698364
loss_pred:0.016768597066402435, decouple_loss:0.000862590444739908
The modified gen p mean: 0.45049920678138733, gen p mean: -0.11759199947118759, mean p set: 0.4510760009288788
loss_pred:0.016563881188631058, decouple_loss:0.0006873853271827102
Iteration: 1462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506368637084961, gen p mean: -0.11000189185142517, mean p set: 0.4512137174606323
loss_pred:0.017649557441473007, decouple_loss:0.0008256534929387271
The modified gen p mean: 0.4507262110710144, gen p mean: -0.09926668554544449, mean p set: 0.45130112767219543The modified gen p mean: 0.45054399967193604, gen p mean: -0.11401769518852234, mean p set: 0.4511202275753021
loss_pred:0.017005959525704384, decouple_loss:0.0009285551495850086
loss_pred:0.016955548897385597, decouple_loss:0.0006876817787997425
Iteration: 1463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962558150291443, gen p mean: -0.10419812798500061, mean p set: 0.4502009153366089
loss_pred:0.017451098188757896, decouple_loss:0.0006804299773648381
The modified gen p mean: 0.4500298500061035, gen p mean: -0.10888843238353729, mean p set: 0.45060768723487854The modified gen p mean: 0.4496200680732727, gen p mean: -0.10940874367952347, mean p set: 0.4501960873603821
loss_pred:0.016926633194088936, decouple_loss:0.0006729970336891711
loss_pred:0.017291920259594917, decouple_loss:0.0007126765558496118
Iteration: 1464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996827840805054, gen p mean: -0.11179545521736145, mean p set: 0.4505466818809509
loss_pred:0.017104942351579666, decouple_loss:0.0006996584124863148
The modified gen p mean: 0.4518803358078003, gen p mean: -0.10487301647663116, mean p set: 0.4524562954902649
loss_pred:0.01660481095314026, decouple_loss:0.0008512752247042954
The modified gen p mean: 0.451136976480484, gen p mean: -0.10140473395586014, mean p set: 0.4517151117324829
loss_pred:0.016742702573537827, decouple_loss:0.0006744414567947388
Iteration: 1465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071321725845337, gen p mean: -0.10628218948841095, mean p set: 0.4512876868247986
loss_pred:0.01728471927344799, decouple_loss:0.0008512621861882508
The modified gen p mean: 0.4497695863246918, gen p mean: -0.10477910935878754, mean p set: 0.45034801959991455
loss_pred:0.017209386453032494, decouple_loss:0.0010039536282420158
The modified gen p mean: 0.45224079489707947, gen p mean: -0.10388412326574326, mean p set: 0.45281848311424255
loss_pred:0.016069859266281128, decouple_loss:0.000810997502412647
Iteration: 1466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45000332593917847, gen p mean: -0.1059180423617363, mean p set: 0.45058050751686096
loss_pred:0.017536384984850883, decouple_loss:0.0007314925314858556
The modified gen p mean: 0.45173656940460205, gen p mean: -0.10583855211734772, mean p set: 0.45231279730796814
loss_pred:0.01853647269308567, decouple_loss:0.0007737255073152483
The modified gen p mean: 0.45121029019355774, gen p mean: -0.10119399428367615, mean p set: 0.45178699493408203
loss_pred:0.017566809430718422, decouple_loss:0.0007228582981042564
Iteration: 1467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45259326696395874, gen p mean: -0.10446251183748245, mean p set: 0.45317062735557556
loss_pred:0.01747938245534897, decouple_loss:0.0008858083747327328
The modified gen p mean: 0.45182740688323975, gen p mean: -0.10553044080734253, mean p set: 0.4524042010307312
loss_pred:0.01604771614074707, decouple_loss:0.0007710957434028387
The modified gen p mean: 0.45177963376045227, gen p mean: -0.10424990206956863, mean p set: 0.452357679605484
loss_pred:0.016282768920063972, decouple_loss:0.0007055545574985445
Iteration: 1468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45026612281799316, gen p mean: -0.11341986060142517, mean p set: 0.4508419334888458
loss_pred:0.01747104339301586, decouple_loss:0.000727259845007211
The modified gen p mean: 0.4513942301273346, gen p mean: -0.1060284748673439, mean p set: 0.4519709050655365
loss_pred:0.017695780843496323, decouple_loss:0.0009026349289342761
The modified gen p mean: 0.4511861503124237, gen p mean: -0.10512831807136536, mean p set: 0.4517611861228943
loss_pred:0.01759842224419117, decouple_loss:0.000960044504608959
Iteration: 1469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516541659832001, gen p mean: -0.10618244111537933, mean p set: 0.4522300362586975
loss_pred:0.01778092235326767, decouple_loss:0.0007359691080637276
The modified gen p mean: 0.4513401389122009, gen p mean: -0.10589933395385742, mean p set: 0.4519175887107849
loss_pred:0.01670886017382145, decouple_loss:0.0008630869560874999
The modified gen p mean: 0.4507451057434082, gen p mean: -0.10685577243566513, mean p set: 0.45132210850715637
loss_pred:0.017474019899964333, decouple_loss:0.000707796891219914
Iteration: 1470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524557590484619, gen p mean: -0.11121930927038193, mean p set: 0.45303085446357727
loss_pred:0.016717974096536636, decouple_loss:0.0007494366145692766
The modified gen p mean: 0.45222219824790955, gen p mean: -0.11334875226020813, mean p set: 0.4527982771396637
loss_pred:0.01779845543205738, decouple_loss:0.0008735826122574508
The modified gen p mean: 0.45163124799728394, gen p mean: -0.11064749956130981, mean p set: 0.4522075653076172
loss_pred:0.016861556097865105, decouple_loss:0.000790812773630023
2023-05-01 04:48:58 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.12749387323856354, mean p set: 0.4502691626548767
loss_pred:0.01758556254208088, decouple_loss:0.0008349250419996679
The modified gen p mean: 0.44953417778015137, gen p mean: -0.12111429125070572, mean p set: 0.4500633478164673
loss_pred:0.016791192814707756, decouple_loss:0.0008605765760876238
The modified gen p mean: 0.44983091950416565, gen p mean: -0.12029659748077393, mean p set: 0.45035696029663086
loss_pred:0.016956385225057602, decouple_loss:0.0007845055079087615
WV_1_PC_1_EH_0_PS_40, loss: 0.01715238019824028, avg_mse: 0.026693375781178474
current test mse: 0.026693
Iteration: 1471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502864480018616, gen p mean: -0.1182866245508194, mean p set: 0.45086249709129333
loss_pred:0.016286980360746384, decouple_loss:0.0007968221325427294
The modified gen p mean: 0.4507548213005066, gen p mean: -0.11171566694974899, mean p set: 0.45133206248283386The modified gen p mean: 0.4508706033229828, gen p mean: -0.11673413217067719, mean p set: 0.45144689083099365
loss_pred:0.017413703724741936, decouple_loss:0.0008681148174218833
loss_pred:0.01737554743885994, decouple_loss:0.0007132106693461537
Iteration: 1472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071595907211304, gen p mean: -0.1194792240858078, mean p set: 0.4512922167778015
loss_pred:0.017009828239679337, decouple_loss:0.0007544048130512238
The modified gen p mean: 0.4510551393032074, gen p mean: -0.11419656127691269, mean p set: 0.45163068175315857The modified gen p mean: 0.45201143622398376, gen p mean: -0.11866570264101028, mean p set: 0.45258599519729614
loss_pred:0.016809657216072083, decouple_loss:0.0007141340174712241
loss_pred:0.017529321834445, decouple_loss:0.0007722044829279184
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012000_3_24hr.npz
NaN value num: 0
Iteration: 1473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44970032572746277, gen p mean: -0.12200351804494858, mean p set: 0.45028162002563477
loss_pred:0.016772909089922905, decouple_loss:0.0007756978156976402
The modified gen p mean: 0.44804859161376953, gen p mean: -0.1278783529996872, mean p set: 0.44862014055252075
loss_pred:0.015867827460169792, decouple_loss:0.0007527273264713585
The modified gen p mean: 0.44756585359573364, gen p mean: -0.12740840017795563, mean p set: 0.448142409324646
loss_pred:0.016719263046979904, decouple_loss:0.0006892469828017056
Iteration: 1474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526870846748352, gen p mean: -0.12279674410820007, mean p set: 0.45326003432273865
loss_pred:0.016111819073557854, decouple_loss:0.0007686733733862638
The modified gen p mean: 0.4514060318470001, gen p mean: -0.12167332321405411, mean p set: 0.45198073983192444
loss_pred:0.016305500641465187, decouple_loss:0.0010701216524466872
The modified gen p mean: 0.4518791139125824, gen p mean: -0.11865482479333878, mean p set: 0.4524591267108917
loss_pred:0.01587665267288685, decouple_loss:0.0007602389086969197
Iteration: 1475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489586055278778, gen p mean: -0.12448003888130188, mean p set: 0.44953182339668274
loss_pred:0.016394276171922684, decouple_loss:0.0009002381120808423
The modified gen p mean: 0.44982200860977173, gen p mean: -0.12489213049411774, mean p set: 0.45039960741996765
loss_pred:0.016592269763350487, decouple_loss:0.00078142702113837
The modified gen p mean: 0.4510255455970764, gen p mean: -0.12328081578016281, mean p set: 0.4516025483608246
loss_pred:0.016322702169418335, decouple_loss:0.0006763861747458577
Iteration: 1476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44989651441574097, gen p mean: -0.12016639113426208, mean p set: 0.4504731595516205
loss_pred:0.016333160921931267, decouple_loss:0.0007390970713458955
The modified gen p mean: 0.4513161778450012, gen p mean: -0.12116848677396774, mean p set: 0.4518939256668091
loss_pred:0.016048941761255264, decouple_loss:0.0008170213550329208
The modified gen p mean: 0.4507271349430084, gen p mean: -0.12120363861322403, mean p set: 0.45130327343940735
loss_pred:0.01591341197490692, decouple_loss:0.0009151807753369212
Iteration: 1477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44865283370018005, gen p mean: -0.12229699641466141, mean p set: 0.44922778010368347
loss_pred:0.016452955082058907, decouple_loss:0.0007032360881567001
The modified gen p mean: 0.44925573468208313, gen p mean: -0.1132645457983017, mean p set: 0.4498332440853119
loss_pred:0.016231687739491463, decouple_loss:0.0007862463244237006
The modified gen p mean: 0.4512511193752289, gen p mean: -0.11653760075569153, mean p set: 0.4518289566040039
loss_pred:0.01556125096976757, decouple_loss:0.0006718943477608263
Iteration: 1478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492909610271454, gen p mean: -0.11283297091722488, mean p set: 0.4498688280582428
loss_pred:0.015903744846582413, decouple_loss:0.0013871430419385433
The modified gen p mean: 0.4500623941421509, gen p mean: -0.11334493011236191, mean p set: 0.4506407380104065
loss_pred:0.01613861508667469, decouple_loss:0.001178351347334683
The modified gen p mean: 0.44915854930877686, gen p mean: -0.11163720488548279, mean p set: 0.4497356712818146
loss_pred:0.015778305009007454, decouple_loss:0.0007442291243933141
Iteration: 1479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506581425666809, gen p mean: -0.1083889901638031, mean p set: 0.4512324035167694
loss_pred:0.01631929725408554, decouple_loss:0.0007460746564902365
The modified gen p mean: 0.44882574677467346, gen p mean: -0.11214885115623474, mean p set: 0.44940266013145447
The modified gen p mean: 0.4513971209526062, gen p mean: -0.10651376843452454, mean p set: 0.45197638869285583
loss_pred:0.01583161950111389, decouple_loss:0.0007556958007626235
loss_pred:0.0155090456828475, decouple_loss:0.0007621149416081607
Iteration: 1480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489433169364929, gen p mean: -0.1094893291592598, mean p set: 0.44951876997947693
loss_pred:0.015889042988419533, decouple_loss:0.0009771521436050534
The modified gen p mean: 0.45124566555023193, gen p mean: -0.11125316470861435, mean p set: 0.4518211781978607
loss_pred:0.01646229438483715, decouple_loss:0.0008291687699966133
The modified gen p mean: 0.4501782953739166, gen p mean: -0.10916329175233841, mean p set: 0.45075374841690063
loss_pred:0.016128238290548325, decouple_loss:0.0006079665618017316
2023-05-01 04:51:45 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1181124672293663, mean p set: 0.4502691626548767
loss_pred:0.017510095611214638, decouple_loss:0.0009761516703292727
The modified gen p mean: 0.4495342969894409, gen p mean: -0.11169207096099854, mean p set: 0.4500633478164673
loss_pred:0.016750644892454147, decouple_loss:0.0008981611463241279
The modified gen p mean: 0.44982922077178955, gen p mean: -0.1113734096288681, mean p set: 0.45035696029663086
loss_pred:0.016944177448749542, decouple_loss:0.000863671419210732
WV_1_PC_1_EH_0_PS_40, loss: 0.01711393892765045, avg_mse: 0.02667474001646042
current test mse: 0.026675
Iteration: 1481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977107644081116, gen p mean: -0.11297066509723663, mean p set: 0.4503476321697235
loss_pred:0.015947891399264336, decouple_loss:0.0013973667519167066
The modified gen p mean: 0.450487345457077, gen p mean: -0.11222540587186813, mean p set: 0.4510645270347595
The modified gen p mean: 0.4496486485004425, gen p mean: -0.117803193628788, mean p set: 0.45022377371788025
loss_pred:0.015498867258429527, decouple_loss:0.0008049445459619164
loss_pred:0.016226448118686676, decouple_loss:0.0010193671332672238
Iteration: 1482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45151427388191223, gen p mean: -0.11299560964107513, mean p set: 0.45208731293678284
loss_pred:0.0159948468208313, decouple_loss:0.0008654817938804626
The modified gen p mean: 0.44959813356399536, gen p mean: -0.11108323186635971, mean p set: 0.4501752555370331The modified gen p mean: 0.4515691101551056, gen p mean: -0.11097575724124908, mean p set: 0.4521452486515045
loss_pred:0.01627217046916485, decouple_loss:0.0009035015827976167
loss_pred:0.015829874202609062, decouple_loss:0.0008681176113896072
Iteration: 1483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496455192565918, gen p mean: -0.1152975857257843, mean p set: 0.45022279024124146
loss_pred:0.016146497800946236, decouple_loss:0.0006699257646687329
The modified gen p mean: 0.45106273889541626, gen p mean: -0.11485143005847931, mean p set: 0.4516368806362152
loss_pred:0.01634940691292286, decouple_loss:0.0007336215348914266
The modified gen p mean: 0.45118334889411926, gen p mean: -0.11664131283760071, mean p set: 0.4517599642276764
loss_pred:0.015504132956266403, decouple_loss:0.0006658106576651335
Iteration: 1484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45039382576942444, gen p mean: -0.12261448055505753, mean p set: 0.4509674608707428
loss_pred:0.01551696565002203, decouple_loss:0.0010401774197816849
The modified gen p mean: 0.4502992033958435, gen p mean: -0.11852063238620758, mean p set: 0.45087674260139465
loss_pred:0.016741665080189705, decouple_loss:0.0008266442455351353
The modified gen p mean: 0.45205092430114746, gen p mean: -0.11950289458036423, mean p set: 0.45262959599494934
loss_pred:0.015473619103431702, decouple_loss:0.0010130992159247398
Iteration: 1485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45137742161750793, gen p mean: -0.11726512014865875, mean p set: 0.45195427536964417
loss_pred:0.0154531579464674, decouple_loss:0.0007419830071739852
The modified gen p mean: 0.4511827826499939, gen p mean: -0.11510755121707916, mean p set: 0.45175832509994507
loss_pred:0.01583637110888958, decouple_loss:0.0007161104585975409
The modified gen p mean: 0.4511411786079407, gen p mean: -0.11561891436576843, mean p set: 0.4517160654067993
loss_pred:0.01628553308546543, decouple_loss:0.0006307485164143145
Iteration: 1486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514543116092682, gen p mean: -0.11779792606830597, mean p set: 0.4520314931869507
loss_pred:0.015593024902045727, decouple_loss:0.0008121722494252026
The modified gen p mean: 0.44899553060531616, gen p mean: -0.11850576102733612, mean p set: 0.4495701789855957
loss_pred:0.016428468748927116, decouple_loss:0.0009729833109304309
The modified gen p mean: 0.4508609175682068, gen p mean: -0.11525202542543411, mean p set: 0.4514331519603729
loss_pred:0.015791134908795357, decouple_loss:0.0010297680273652077
Iteration: 1487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510487914085388, gen p mean: -0.11991602182388306, mean p set: 0.45162567496299744
loss_pred:0.01636255905032158, decouple_loss:0.0006595022277906537
The modified gen p mean: 0.451127290725708, gen p mean: -0.11851464211940765, mean p set: 0.4517051577568054
The modified gen p mean: 0.4492975175380707, gen p mean: -0.11910119652748108, mean p set: 0.4498729407787323
loss_pred:0.01594693772494793, decouple_loss:0.0006650288123637438
loss_pred:0.01707637310028076, decouple_loss:0.0007692730287089944
Iteration: 1488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517441987991333, gen p mean: -0.11984675377607346, mean p set: 0.4523191750049591
loss_pred:0.016345061361789703, decouple_loss:0.0008820905350148678
The modified gen p mean: 0.4514086842536926, gen p mean: -0.12158697843551636, mean p set: 0.4519873261451721
loss_pred:0.01641956716775894, decouple_loss:0.0006121754995547235
The modified gen p mean: 0.4527404010295868, gen p mean: -0.12049426883459091, mean p set: 0.4533170461654663
loss_pred:0.015546686947345734, decouple_loss:0.0009140245383605361
Iteration: 1489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527556002140045, gen p mean: -0.12031887471675873, mean p set: 0.45333418250083923
loss_pred:0.015225048176944256, decouple_loss:0.0008436061325483024
The modified gen p mean: 0.44937658309936523, gen p mean: -0.12839950621128082, mean p set: 0.449952095746994
loss_pred:0.01591908000409603, decouple_loss:0.0006409185007214546
The modified gen p mean: 0.4487560987472534, gen p mean: -0.12640480697155, mean p set: 0.4493304491043091
loss_pred:0.016346028074622154, decouple_loss:0.0006903439643792808
Iteration: 1490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45135560631752014, gen p mean: -0.12294119596481323, mean p set: 0.4519321024417877
loss_pred:0.015551557764410973, decouple_loss:0.0008184292819350958
The modified gen p mean: 0.4497174620628357, gen p mean: -0.12417830526828766, mean p set: 0.45029211044311523
loss_pred:0.016036834567785263, decouple_loss:0.000660961726680398
The modified gen p mean: 0.44941121339797974, gen p mean: -0.12526576220989227, mean p set: 0.44998836517333984
loss_pred:0.01618131808936596, decouple_loss:0.000715983915142715
2023-05-01 04:53:50 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13281920552253723, mean p set: 0.4502691626548767
loss_pred:0.017455242574214935, decouple_loss:0.0009745647548697889
The modified gen p mean: 0.4495351314544678, gen p mean: -0.1262839138507843, mean p set: 0.4500633478164673
loss_pred:0.01673843339085579, decouple_loss:0.0009060135344043374
The modified gen p mean: 0.44982850551605225, gen p mean: -0.12534908950328827, mean p set: 0.45035696029663086
loss_pred:0.016951123252511024, decouple_loss:0.0008088545873761177
WV_1_PC_1_EH_0_PS_40, loss: 0.01709309220314026, avg_mse: 0.0266079343855381
current test mse: 0.026608
Iteration: 1491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496936798095703, gen p mean: -0.12421637773513794, mean p set: 0.45026808977127075
loss_pred:0.01610509119927883, decouple_loss:0.0006346405716612935
The modified gen p mean: 0.4498707354068756, gen p mean: -0.13127703964710236, mean p set: 0.4504474103450775
loss_pred:0.015825096517801285, decouple_loss:0.000905497232452035
The modified gen p mean: 0.4527905285358429, gen p mean: -0.12638790905475616, mean p set: 0.4533640444278717
loss_pred:0.015865648165345192, decouple_loss:0.000981106306426227
Iteration: 1492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495929479598999, gen p mean: -0.13271278142929077, mean p set: 0.4501676559448242
The modified gen p mean: 0.45108509063720703, gen p mean: -0.12612582743167877, mean p set: 0.4516620337963104
loss_pred:0.01616308093070984, decouple_loss:0.0006774661596864462
loss_pred:0.015727002173662186, decouple_loss:0.0010054168524220586
The modified gen p mean: 0.44933855533599854, gen p mean: -0.1268695741891861, mean p set: 0.4499163329601288
loss_pred:0.016971632838249207, decouple_loss:0.0007454982260242105
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
NaN value num: 0
Iteration: 1493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44658130407333374, gen p mean: -0.1313088834285736, mean p set: 0.4471576511859894
loss_pred:0.017773956060409546, decouple_loss:0.0008349623531103134
The modified gen p mean: 0.4471786618232727, gen p mean: -0.1304546445608139, mean p set: 0.4477544128894806
The modified gen p mean: 0.4482158124446869, gen p mean: -0.12048450857400894, mean p set: 0.44879260659217834
loss_pred:0.018407432362437248, decouple_loss:0.000727616308722645
loss_pred:0.018221484497189522, decouple_loss:0.0006845802417956293
Iteration: 1494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475095868110657, gen p mean: -0.12872864305973053, mean p set: 0.44808605313301086
The modified gen p mean: 0.44748884439468384, gen p mean: -0.12705077230930328, mean p set: 0.4480665326118469
loss_pred:0.018049295991659164, decouple_loss:0.0008256311411969364
loss_pred:0.017020775005221367, decouple_loss:0.0008842306560836732
The modified gen p mean: 0.44738107919692993, gen p mean: -0.12672704458236694, mean p set: 0.4479564428329468
loss_pred:0.018148861825466156, decouple_loss:0.0007623657584190369
Iteration: 1495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44640302658081055, gen p mean: -0.1306123435497284, mean p set: 0.44697946310043335
loss_pred:0.01843337155878544, decouple_loss:0.000639796897303313
The modified gen p mean: 0.4466606080532074, gen p mean: -0.12857171893119812, mean p set: 0.4472349286079407
loss_pred:0.01799490861594677, decouple_loss:0.0007743183523416519
The modified gen p mean: 0.4473400413990021, gen p mean: -0.12523947656154633, mean p set: 0.44791483879089355
loss_pred:0.018119201064109802, decouple_loss:0.0006735774804838002
Iteration: 1496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483870267868042, gen p mean: -0.12580743432044983, mean p set: 0.448962926864624
loss_pred:0.018211299553513527, decouple_loss:0.0007277228869497776
The modified gen p mean: 0.4464489817619324, gen p mean: -0.12802192568778992, mean p set: 0.447025865316391
The modified gen p mean: 0.4472210109233856, gen p mean: -0.12373434007167816, mean p set: 0.44779476523399353
loss_pred:0.017331236973404884, decouple_loss:0.0007747865747660398
loss_pred:0.016550906002521515, decouple_loss:0.0008149886853061616
Iteration: 1497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467654228210449, gen p mean: -0.12408186495304108, mean p set: 0.4473411440849304
loss_pred:0.017201000824570656, decouple_loss:0.0007805589702911675
The modified gen p mean: 0.4460924565792084, gen p mean: -0.12386707216501236, mean p set: 0.4466691315174103
The modified gen p mean: 0.44828394055366516, gen p mean: -0.12753529846668243, mean p set: 0.4488610029220581
loss_pred:0.018249476328492165, decouple_loss:0.0007695851963944733
loss_pred:0.018575243651866913, decouple_loss:0.0009711635066196322
Iteration: 1498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698861241340637, gen p mean: -0.12045177817344666, mean p set: 0.4475629925727844
loss_pred:0.017855308949947357, decouple_loss:0.0008969667251221836
The modified gen p mean: 0.4491976797580719, gen p mean: -0.11682429909706116, mean p set: 0.44977301359176636
The modified gen p mean: 0.4466111958026886, gen p mean: -0.11922977864742279, mean p set: 0.4471881687641144
loss_pred:0.017416786402463913, decouple_loss:0.0009501728345640004
loss_pred:0.01803409866988659, decouple_loss:0.0006994763389229774
Iteration: 1499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482390284538269, gen p mean: -0.11846587806940079, mean p set: 0.44881540536880493
loss_pred:0.018029887229204178, decouple_loss:0.0007093972526490688
The modified gen p mean: 0.4464002251625061, gen p mean: -0.11748527735471725, mean p set: 0.4469749927520752
The modified gen p mean: 0.4489933252334595, gen p mean: -0.11612020432949066, mean p set: 0.44956785440444946
loss_pred:0.01789810135960579, decouple_loss:0.0007188650197349489
loss_pred:0.017960339784622192, decouple_loss:0.0006499126320704818
Iteration: 1500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471111297607422, gen p mean: -0.11872663348913193, mean p set: 0.4476872384548187
loss_pred:0.01779668591916561, decouple_loss:0.0010993815958499908
The modified gen p mean: 0.4487869143486023, gen p mean: -0.11521106958389282, mean p set: 0.4493623375892639
loss_pred:0.017755303531885147, decouple_loss:0.0007412677514366806
The modified gen p mean: 0.4480587840080261, gen p mean: -0.11625274270772934, mean p set: 0.44863274693489075
loss_pred:0.017521893605589867, decouple_loss:0.0008434691117145121
2023-05-01 04:56:36 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12389243394136429, mean p set: 0.4502691626548767
loss_pred:0.01734587363898754, decouple_loss:0.0008436483331024647
The modified gen p mean: 0.4495353698730469, gen p mean: -0.11743547022342682, mean p set: 0.4500633478164673
loss_pred:0.016714591532945633, decouple_loss:0.0011179645080119371
The modified gen p mean: 0.449828177690506, gen p mean: -0.11640410125255585, mean p set: 0.45035696029663086
loss_pred:0.017031507566571236, decouple_loss:0.0009057497954927385
WV_1_PC_1_EH_0_PS_40, loss: 0.017078448086977005, avg_mse: 0.026583725586533546
current test mse: 0.026584
Iteration: 1501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447073757648468, gen p mean: -0.11676336824893951, mean p set: 0.44764822721481323
loss_pred:0.017955714836716652, decouple_loss:0.0009423392475582659
The modified gen p mean: 0.4480937421321869, gen p mean: -0.11509709060192108, mean p set: 0.44866740703582764
loss_pred:0.0173211470246315, decouple_loss:0.0009062833851203322
The modified gen p mean: 0.4470280706882477, gen p mean: -0.11868360638618469, mean p set: 0.44760507345199585
loss_pred:0.016933266073465347, decouple_loss:0.0008909838506951928
Iteration: 1502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446601539850235, gen p mean: -0.11940452456474304, mean p set: 0.44717782735824585
loss_pred:0.017382323741912842, decouple_loss:0.0006375389057211578
The modified gen p mean: 0.4470844864845276, gen p mean: -0.11463163793087006, mean p set: 0.4476608335971832The modified gen p mean: 0.445482075214386, gen p mean: -0.11395730823278427, mean p set: 0.4460543990135193
loss_pred:0.01643478497862816, decouple_loss:0.0008035408100113273
loss_pred:0.01808672398328781, decouple_loss:0.0008189560612663627
Iteration: 1503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691506028175354, gen p mean: -0.11817868053913116, mean p set: 0.4474906623363495
loss_pred:0.016675522550940514, decouple_loss:0.0008021112298592925
The modified gen p mean: 0.4469917416572571, gen p mean: -0.11644426733255386, mean p set: 0.44756677746772766
loss_pred:0.01791277527809143, decouple_loss:0.0009794007055461407
The modified gen p mean: 0.4482213854789734, gen p mean: -0.1119876354932785, mean p set: 0.448795348405838
loss_pred:0.017090393230319023, decouple_loss:0.000977161224000156
Iteration: 1504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864174723625183, gen p mean: -0.1223938912153244, mean p set: 0.4492153227329254
loss_pred:0.018027471378445625, decouple_loss:0.0009543097112327814
The modified gen p mean: 0.44800007343292236, gen p mean: -0.11788741499185562, mean p set: 0.44857820868492126
loss_pred:0.017531340941786766, decouple_loss:0.000749056285712868
The modified gen p mean: 0.4479692578315735, gen p mean: -0.11769475787878036, mean p set: 0.44854697585105896
loss_pred:0.017779679968953133, decouple_loss:0.0010149828158318996
Iteration: 1505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44578295946121216, gen p mean: -0.12130844593048096, mean p set: 0.44635701179504395
loss_pred:0.01798601821064949, decouple_loss:0.0006761849508620799
The modified gen p mean: 0.44736480712890625, gen p mean: -0.12342672049999237, mean p set: 0.4479401111602783
loss_pred:0.017798149958252907, decouple_loss:0.0007728309719823301
The modified gen p mean: 0.44749394059181213, gen p mean: -0.1260652244091034, mean p set: 0.4480704367160797
loss_pred:0.01762545295059681, decouple_loss:0.0008655453566461802
Iteration: 1506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469795823097229, gen p mean: -0.1263454556465149, mean p set: 0.4475582540035248
loss_pred:0.01867823116481304, decouple_loss:0.00087340286700055
The modified gen p mean: 0.44761592149734497, gen p mean: -0.12232176214456558, mean p set: 0.44819167256355286
loss_pred:0.017454778775572777, decouple_loss:0.000741185387596488
The modified gen p mean: 0.4473474621772766, gen p mean: -0.12346896529197693, mean p set: 0.4479246735572815
loss_pred:0.017521198838949203, decouple_loss:0.0006969407550059259
Iteration: 1507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819796085357666, gen p mean: -0.11441730707883835, mean p set: 0.44877323508262634
loss_pred:0.017609022557735443, decouple_loss:0.0009193833684548736
The modified gen p mean: 0.44713908433914185, gen p mean: -0.12077641487121582, mean p set: 0.44771403074264526
loss_pred:0.017714286223053932, decouple_loss:0.0009659948409534991
The modified gen p mean: 0.44745683670043945, gen p mean: -0.11989512294530869, mean p set: 0.4480341970920563
loss_pred:0.01854827255010605, decouple_loss:0.0011828470742329955
Iteration: 1508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735684990882874, gen p mean: -0.11716434359550476, mean p set: 0.4479345977306366
loss_pred:0.018130501732230186, decouple_loss:0.0008082675631158054
The modified gen p mean: 0.44804295897483826, gen p mean: -0.1172763779759407, mean p set: 0.44862115383148193
loss_pred:0.01803492195904255, decouple_loss:0.0007912346627563238
The modified gen p mean: 0.44757023453712463, gen p mean: -0.11770912259817123, mean p set: 0.4481455683708191
loss_pred:0.017625728622078896, decouple_loss:0.0008136865799315274
Iteration: 1509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469645619392395, gen p mean: -0.11767531931400299, mean p set: 0.4475422501564026
loss_pred:0.01748507283627987, decouple_loss:0.00100941420532763
The modified gen p mean: 0.4460403323173523, gen p mean: -0.11760593950748444, mean p set: 0.44661614298820496
loss_pred:0.01881086640059948, decouple_loss:0.0010004396317526698
The modified gen p mean: 0.44770941138267517, gen p mean: -0.11130037158727646, mean p set: 0.4482869803905487
loss_pred:0.017580553889274597, decouple_loss:0.0011264595668762922
Iteration: 1510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44554439187049866, gen p mean: -0.11410561949014664, mean p set: 0.44612136483192444
loss_pred:0.018594348803162575, decouple_loss:0.0010099149076268077
The modified gen p mean: 0.44688716530799866, gen p mean: -0.11421701312065125, mean p set: 0.4474611282348633
loss_pred:0.0167247224599123, decouple_loss:0.0008707010420039296
The modified gen p mean: 0.44733375310897827, gen p mean: -0.11771611869335175, mean p set: 0.4479101598262787
loss_pred:0.018419954925775528, decouple_loss:0.0007982213282957673
2023-05-01 04:58:43 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12301269173622131, mean p set: 0.4502691626548767
loss_pred:0.017476409673690796, decouple_loss:0.0007230633054859936
The modified gen p mean: 0.4495355188846588, gen p mean: -0.11753740161657333, mean p set: 0.4500633478164673
loss_pred:0.01674063317477703, decouple_loss:0.0007657838868908584
The modified gen p mean: 0.4498269855976105, gen p mean: -0.11686860024929047, mean p set: 0.45035696029663086
loss_pred:0.017038695514202118, decouple_loss:0.000730867322999984
WV_1_PC_1_EH_0_PS_40, loss: 0.017122242599725723, avg_mse: 0.026644308120012283
current test mse: 0.026644
Iteration: 1511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460713267326355, gen p mean: -0.1172681525349617, mean p set: 0.4466463625431061
loss_pred:0.018373848870396614, decouple_loss:0.000721992168109864
The modified gen p mean: 0.4482889771461487, gen p mean: -0.10904884338378906, mean p set: 0.44886404275894165The modified gen p mean: 0.4471450746059418, gen p mean: -0.12070870399475098, mean p set: 0.4477194845676422
loss_pred:0.018035857006907463, decouple_loss:0.0008405965054407716
loss_pred:0.017695846036076546, decouple_loss:0.0007551913149654865
Iteration: 1512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468672275543213, gen p mean: -0.11919249594211578, mean p set: 0.44744452834129333
The modified gen p mean: 0.44641631841659546, gen p mean: -0.11639999598264694, mean p set: 0.4469953775405884loss_pred:0.017358113080263138, decouple_loss:0.0009689176804386079
loss_pred:0.01842670515179634, decouple_loss:0.0008134990930557251
The modified gen p mean: 0.44727835059165955, gen p mean: -0.12140227854251862, mean p set: 0.4478538930416107
loss_pred:0.01768726110458374, decouple_loss:0.0008366740075871348
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
NaN value num: 0
Iteration: 1513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44913652539253235, gen p mean: -0.11434853821992874, mean p set: 0.449710875749588
loss_pred:0.0177536029368639, decouple_loss:0.0011057291412726045
The modified gen p mean: 0.4500991702079773, gen p mean: -0.12209159135818481, mean p set: 0.4506766200065613
The modified gen p mean: 0.44966092705726624, gen p mean: -0.11334426701068878, mean p set: 0.450238436460495
loss_pred:0.017411237582564354, decouple_loss:0.0009853166993707418
loss_pred:0.01602521911263466, decouple_loss:0.000866721267811954
Iteration: 1514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45025816559791565, gen p mean: -0.11443790793418884, mean p set: 0.4508344829082489
loss_pred:0.016674138605594635, decouple_loss:0.0007562069804407656
The modified gen p mean: 0.4474807679653168, gen p mean: -0.11417664587497711, mean p set: 0.4480571150779724
loss_pred:0.016655689105391502, decouple_loss:0.0009502204484306276
The modified gen p mean: 0.4492091238498688, gen p mean: -0.11355028301477432, mean p set: 0.44978588819503784
loss_pred:0.017229989171028137, decouple_loss:0.000621418294031173
Iteration: 1515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450025349855423, gen p mean: -0.11851569265127182, mean p set: 0.45060214400291443
loss_pred:0.01651345193386078, decouple_loss:0.0008237073780037463
The modified gen p mean: 0.44967085123062134, gen p mean: -0.11138468980789185, mean p set: 0.4502485692501068
loss_pred:0.017355531454086304, decouple_loss:0.0007666070014238358
The modified gen p mean: 0.45044565200805664, gen p mean: -0.11767595261335373, mean p set: 0.4510233402252197
loss_pred:0.0172638688236475, decouple_loss:0.0007587365107610822
Iteration: 1516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45069995522499084, gen p mean: -0.11575635522603989, mean p set: 0.4512770175933838
loss_pred:0.016760163009166718, decouple_loss:0.0008687743102200329
The modified gen p mean: 0.45036715269088745, gen p mean: -0.1164124608039856, mean p set: 0.4509435296058655
loss_pred:0.016774725168943405, decouple_loss:0.0006459580617956817
The modified gen p mean: 0.44905373454093933, gen p mean: -0.10999175161123276, mean p set: 0.44962990283966064
loss_pred:0.01764349639415741, decouple_loss:0.0007532184827141464
Iteration: 1517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490111768245697, gen p mean: -0.1124105453491211, mean p set: 0.44958674907684326
loss_pred:0.017494460567831993, decouple_loss:0.0006022384040988982
The modified gen p mean: 0.45054349303245544, gen p mean: -0.11832588911056519, mean p set: 0.45112112164497375
loss_pred:0.01638229377567768, decouple_loss:0.0008622812456451356
The modified gen p mean: 0.44853338599205017, gen p mean: -0.11759835481643677, mean p set: 0.44910821318626404
loss_pred:0.017294688150286674, decouple_loss:0.0008339043124578893
Iteration: 1518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023560523986816, gen p mean: -0.11150579154491425, mean p set: 0.4508116841316223
loss_pred:0.01744762249290943, decouple_loss:0.0007500929059460759
The modified gen p mean: 0.4497852027416229, gen p mean: -0.1121632382273674, mean p set: 0.4503605365753174
The modified gen p mean: 0.4507741332054138, gen p mean: -0.11477923393249512, mean p set: 0.45134806632995605
loss_pred:0.01580132730305195, decouple_loss:0.0007572239846922457
loss_pred:0.017565153539180756, decouple_loss:0.0006037476123310626
Iteration: 1519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508792459964752, gen p mean: -0.11540141701698303, mean p set: 0.4514552056789398
loss_pred:0.017158785834908485, decouple_loss:0.0007885955856181681
The modified gen p mean: 0.45082321763038635, gen p mean: -0.11544007062911987, mean p set: 0.4514020085334778
loss_pred:0.016842087730765343, decouple_loss:0.0007051157299429178
The modified gen p mean: 0.4492744207382202, gen p mean: -0.11345371603965759, mean p set: 0.4498521387577057
loss_pred:0.016781512647867203, decouple_loss:0.0006875249091535807
Iteration: 1520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508327841758728, gen p mean: -0.12481115013360977, mean p set: 0.45140841603279114
loss_pred:0.017064355313777924, decouple_loss:0.0007618000963702798
The modified gen p mean: 0.45063266158103943, gen p mean: -0.12013422697782516, mean p set: 0.451210081577301
loss_pred:0.016623450443148613, decouple_loss:0.000700198404956609
The modified gen p mean: 0.4504256248474121, gen p mean: -0.11858785897493362, mean p set: 0.45100319385528564
loss_pred:0.016553262248635292, decouple_loss:0.0006513895350508392
2023-05-01 05:01:30 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12599852681159973, mean p set: 0.4502691626548767
loss_pred:0.017441406846046448, decouple_loss:0.0007824348867870867
The modified gen p mean: 0.44953468441963196, gen p mean: -0.11984783411026001, mean p set: 0.4500633478164673
The modified gen p mean: 0.4498291611671448, gen p mean: -0.11926544457674026, mean p set: 0.45035696029663086
loss_pred:0.016734054312109947, decouple_loss:0.0007662936695851386
loss_pred:0.016942737624049187, decouple_loss:0.0008205395424738526
WV_1_PC_1_EH_0_PS_40, loss: 0.017078887671232224, avg_mse: 0.026618346571922302
current test mse: 0.026618
Iteration: 1521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497426748275757, gen p mean: -0.12175022810697556, mean p set: 0.4503205716609955
loss_pred:0.017339525744318962, decouple_loss:0.0007947995327413082
The modified gen p mean: 0.44853323698043823, gen p mean: -0.12090796232223511, mean p set: 0.4491093158721924The modified gen p mean: 0.45111367106437683, gen p mean: -0.11663530021905899, mean p set: 0.451691210269928
loss_pred:0.01728629320859909, decouple_loss:0.000739998125936836
loss_pred:0.016409024596214294, decouple_loss:0.0007752653327770531
Iteration: 1522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968071579933167, gen p mean: -0.1194867342710495, mean p set: 0.45025497674942017
loss_pred:0.016398463398218155, decouple_loss:0.0006193690933287144
The modified gen p mean: 0.4486713707447052, gen p mean: -0.12120044976472855, mean p set: 0.44924622774124146The modified gen p mean: 0.45024189352989197, gen p mean: -0.12140364199876785, mean p set: 0.45081907510757446
loss_pred:0.016437234356999397, decouple_loss:0.0006588416872546077
loss_pred:0.016795001924037933, decouple_loss:0.0006729841115884483
Iteration: 1523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45026901364326477, gen p mean: -0.11576554924249649, mean p set: 0.45084407925605774
loss_pred:0.017904406413435936, decouple_loss:0.0007082447409629822
The modified gen p mean: 0.44905897974967957, gen p mean: -0.12051575630903244, mean p set: 0.4496335983276367
loss_pred:0.016552530229091644, decouple_loss:0.0007733856327831745
The modified gen p mean: 0.4489322304725647, gen p mean: -0.11836409568786621, mean p set: 0.4495084881782532
loss_pred:0.017251037061214447, decouple_loss:0.0007583195110782981
Iteration: 1524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852250814437866, gen p mean: -0.12202536314725876, mean p set: 0.4491001069545746
loss_pred:0.01646098867058754, decouple_loss:0.0006884275935590267
The modified gen p mean: 0.4505316913127899, gen p mean: -0.12654730677604675, mean p set: 0.451107382774353
loss_pred:0.016385767608880997, decouple_loss:0.0008043050765991211
The modified gen p mean: 0.4491497576236725, gen p mean: -0.12037375569343567, mean p set: 0.4497242569923401
loss_pred:0.01717652566730976, decouple_loss:0.0006171350833028555
Iteration: 1525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473296105861664, gen p mean: -0.12078890204429626, mean p set: 0.4479064345359802
loss_pred:0.01687690243124962, decouple_loss:0.0007929186103865504
The modified gen p mean: 0.4502032995223999, gen p mean: -0.12379268556833267, mean p set: 0.4507790505886078
loss_pred:0.017622672021389008, decouple_loss:0.0010109271388500929
The modified gen p mean: 0.4507955014705658, gen p mean: -0.12641513347625732, mean p set: 0.45137593150138855
loss_pred:0.0178119745105505, decouple_loss:0.0009707399294711649
Iteration: 1526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497787058353424, gen p mean: -0.12846402823925018, mean p set: 0.45035505294799805
loss_pred:0.016859719529747963, decouple_loss:0.0007593733025714755
The modified gen p mean: 0.4497608244419098, gen p mean: -0.1243881806731224, mean p set: 0.4503363370895386
loss_pred:0.016836857423186302, decouple_loss:0.0006468915962614119
The modified gen p mean: 0.4486943483352661, gen p mean: -0.1252986341714859, mean p set: 0.4492696523666382
loss_pred:0.01630905643105507, decouple_loss:0.0007664892473258078
Iteration: 1527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44922956824302673, gen p mean: -0.12073720246553421, mean p set: 0.4498059153556824
loss_pred:0.017110032960772514, decouple_loss:0.000895754317753017
The modified gen p mean: 0.44852206110954285, gen p mean: -0.12156654894351959, mean p set: 0.44910016655921936
loss_pred:0.016905158758163452, decouple_loss:0.0008499923278577626
The modified gen p mean: 0.45015355944633484, gen p mean: -0.12492136657238007, mean p set: 0.4507302939891815
loss_pred:0.01742536388337612, decouple_loss:0.0009070975356735289
Iteration: 1528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500868618488312, gen p mean: -0.12389582395553589, mean p set: 0.45066148042678833
loss_pred:0.016596777364611626, decouple_loss:0.0009801889536902308
The modified gen p mean: 0.4509738087654114, gen p mean: -0.1216362863779068, mean p set: 0.45154935121536255
loss_pred:0.017799092456698418, decouple_loss:0.0009249017457477748
The modified gen p mean: 0.4513362944126129, gen p mean: -0.12158883363008499, mean p set: 0.45191389322280884
loss_pred:0.016630012542009354, decouple_loss:0.0011229378869757056
Iteration: 1529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501195251941681, gen p mean: -0.12568429112434387, mean p set: 0.45069611072540283
loss_pred:0.01697801612317562, decouple_loss:0.001121390494517982
The modified gen p mean: 0.450033038854599, gen p mean: -0.1156914234161377, mean p set: 0.45060789585113525
loss_pred:0.0179116390645504, decouple_loss:0.000859955558553338
The modified gen p mean: 0.4505125880241394, gen p mean: -0.12317162752151489, mean p set: 0.451090544462204
loss_pred:0.015864849090576172, decouple_loss:0.0008788612904027104
Iteration: 1530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503564238548279, gen p mean: -0.12144972383975983, mean p set: 0.4509302079677582
loss_pred:0.016805484890937805, decouple_loss:0.0009274532203562558
The modified gen p mean: 0.4507427215576172, gen p mean: -0.11877941340208054, mean p set: 0.4513210952281952
The modified gen p mean: 0.45074111223220825, gen p mean: -0.11386238038539886, mean p set: 0.4513164758682251
loss_pred:0.016921821981668472, decouple_loss:0.0009453098173253238
loss_pred:0.016888875514268875, decouple_loss:0.0010803398909047246
2023-05-01 05:03:35 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12203782051801682, mean p set: 0.4502691626548767
loss_pred:0.01761646196246147, decouple_loss:0.000913896830752492
The modified gen p mean: 0.44953465461730957, gen p mean: -0.11578156799077988, mean p set: 0.4500633478164673
loss_pred:0.01682358793914318, decouple_loss:0.001071543782018125
The modified gen p mean: 0.44982805848121643, gen p mean: -0.11514274775981903, mean p set: 0.45035696029663086
loss_pred:0.016974132508039474, decouple_loss:0.0011189371580258012
WV_1_PC_1_EH_0_PS_40, loss: 0.01718980073928833, avg_mse: 0.02670791745185852
current test mse: 0.026708
Iteration: 1531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972002506256104, gen p mean: -0.11532187461853027, mean p set: 0.4502963423728943
The modified gen p mean: 0.4506259262561798, gen p mean: -0.11773369461297989, mean p set: 0.45120275020599365
loss_pred:0.01649434305727482, decouple_loss:0.0009569915127940476
loss_pred:0.01632748916745186, decouple_loss:0.0007712252554483712
The modified gen p mean: 0.4501323699951172, gen p mean: -0.1169486790895462, mean p set: 0.4507073163986206
loss_pred:0.01735795848071575, decouple_loss:0.0007531209848821163
Iteration: 1532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879430532455444, gen p mean: -0.11367654800415039, mean p set: 0.4493708908557892
loss_pred:0.017319966107606888, decouple_loss:0.0006653391756117344
The modified gen p mean: 0.4506140947341919, gen p mean: -0.11807192862033844, mean p set: 0.45119279623031616The modified gen p mean: 0.4505692720413208, gen p mean: -0.11673504114151001, mean p set: 0.4511445164680481
loss_pred:0.0163192767649889, decouple_loss:0.0009527131333015859
loss_pred:0.016999445855617523, decouple_loss:0.0010368021903559566
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 1533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44651177525520325, gen p mean: -0.11706916242837906, mean p set: 0.4470857083797455
loss_pred:0.01638038270175457, decouple_loss:0.000863286608364433
The modified gen p mean: 0.44819265604019165, gen p mean: -0.12101998925209045, mean p set: 0.44876906275749207
The modified gen p mean: 0.44705888628959656, gen p mean: -0.12653478980064392, mean p set: 0.4476391673088074
loss_pred:0.0146797401830554, decouple_loss:0.0006189191481098533
loss_pred:0.015354094095528126, decouple_loss:0.0009422936127521098
Iteration: 1534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687867164611816, gen p mean: -0.1212819367647171, mean p set: 0.4474572539329529
The modified gen p mean: 0.44669410586357117, gen p mean: -0.128334179520607, mean p set: 0.4472673535346985loss_pred:0.015452921390533447, decouple_loss:0.0007749237702228129
loss_pred:0.01610027626156807, decouple_loss:0.0006987473461776972
The modified gen p mean: 0.4472709000110626, gen p mean: -0.12562251091003418, mean p set: 0.4478446841239929
loss_pred:0.015893984586000443, decouple_loss:0.0006893638637848198
Iteration: 1535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788989424705505, gen p mean: -0.1306505799293518, mean p set: 0.44846752285957336
loss_pred:0.015083937905728817, decouple_loss:0.0007144789560697973
The modified gen p mean: 0.44680771231651306, gen p mean: -0.12332284450531006, mean p set: 0.44738268852233887
loss_pred:0.015905393287539482, decouple_loss:0.0006668642163276672
The modified gen p mean: 0.447836697101593, gen p mean: -0.12852738797664642, mean p set: 0.44841110706329346
loss_pred:0.016139652580022812, decouple_loss:0.0007391766994260252
Iteration: 1536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44908374547958374, gen p mean: -0.1292857527732849, mean p set: 0.4496593773365021
loss_pred:0.014439985156059265, decouple_loss:0.0008478880045004189
The modified gen p mean: 0.4476979076862335, gen p mean: -0.12122906744480133, mean p set: 0.44827526807785034
loss_pred:0.01568334549665451, decouple_loss:0.0007081939256750047
The modified gen p mean: 0.4482577443122864, gen p mean: -0.12390831112861633, mean p set: 0.4488346576690674
loss_pred:0.015466301701962948, decouple_loss:0.0007294818060472608
Iteration: 1537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822826981544495, gen p mean: -0.11863159388303757, mean p set: 0.4488039016723633
loss_pred:0.014426249079406261, decouple_loss:0.0006609458359889686
The modified gen p mean: 0.44710543751716614, gen p mean: -0.12290828675031662, mean p set: 0.4476827085018158
loss_pred:0.01515205018222332, decouple_loss:0.0007568505825474858
The modified gen p mean: 0.44852641224861145, gen p mean: -0.12141764909029007, mean p set: 0.4491024613380432
loss_pred:0.014566516503691673, decouple_loss:0.0007027788669802248
Iteration: 1538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925394654273987, gen p mean: -0.11833281069993973, mean p set: 0.4498293101787567
loss_pred:0.015425631776452065, decouple_loss:0.0007427770760841668
The modified gen p mean: 0.4480176568031311, gen p mean: -0.11768746376037598, mean p set: 0.44859424233436584
The modified gen p mean: 0.44753319025039673, gen p mean: -0.1173621118068695, mean p set: 0.44810861349105835
loss_pred:0.01577061414718628, decouple_loss:0.0008800208452157676
loss_pred:0.015010340139269829, decouple_loss:0.0010708129266276956
Iteration: 1539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471711814403534, gen p mean: -0.11521304398775101, mean p set: 0.447747141122818
loss_pred:0.015443572774529457, decouple_loss:0.0006224910612218082
The modified gen p mean: 0.44765976071357727, gen p mean: -0.12010270357131958, mean p set: 0.4482366442680359
loss_pred:0.01483828853815794, decouple_loss:0.0007973595056682825
The modified gen p mean: 0.44968292117118835, gen p mean: -0.11786399781703949, mean p set: 0.45025789737701416
loss_pred:0.014575369656085968, decouple_loss:0.0007500039646402001
Iteration: 1540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772616028785706, gen p mean: -0.11565697193145752, mean p set: 0.44829997420310974
The modified gen p mean: 0.44780755043029785, gen p mean: -0.11420750617980957, mean p set: 0.4483831226825714
loss_pred:0.015560553409159184, decouple_loss:0.0006767931045033038
loss_pred:0.014855100773274899, decouple_loss:0.0006426101899705827
The modified gen p mean: 0.44681936502456665, gen p mean: -0.11860716342926025, mean p set: 0.4473954439163208
loss_pred:0.01583818346261978, decouple_loss:0.0006872702506370842
2023-05-01 05:06:32 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1195533275604248, mean p set: 0.4502691626548767
loss_pred:0.01754295453429222, decouple_loss:0.0007582916878163815
The modified gen p mean: 0.4495323598384857, gen p mean: -0.11366081982851028, mean p set: 0.4500633478164673
loss_pred:0.01668423041701317, decouple_loss:0.0008101401035673916
The modified gen p mean: 0.44982773065567017, gen p mean: -0.11319603770971298, mean p set: 0.45035696029663086
loss_pred:0.01699816808104515, decouple_loss:0.0008526715100742877
WV_1_PC_1_EH_0_PS_40, loss: 0.01711547002196312, avg_mse: 0.026567969471216202
current test mse: 0.026568
Iteration: 1541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460741877555847, gen p mean: -0.11199352890253067, mean p set: 0.44665467739105225
loss_pred:0.01640712469816208, decouple_loss:0.0006421756115742028
The modified gen p mean: 0.446829617023468, gen p mean: -0.11350832134485245, mean p set: 0.44740498065948486The modified gen p mean: 0.4484774172306061, gen p mean: -0.12330090254545212, mean p set: 0.44905540347099304
loss_pred:0.015212793834507465, decouple_loss:0.0008083334541879594loss_pred:0.015412203967571259, decouple_loss:0.000888448441401124
Iteration: 1542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787752628326416, gen p mean: -0.11364065855741501, mean p set: 0.4484524726867676
loss_pred:0.015346827916800976, decouple_loss:0.0007834412972442806
The modified gen p mean: 0.4473392963409424, gen p mean: -0.11835940182209015, mean p set: 0.44791606068611145The modified gen p mean: 0.4475836455821991, gen p mean: -0.11979878693819046, mean p set: 0.44815701246261597
loss_pred:0.015103058889508247, decouple_loss:0.0006952752592042089
loss_pred:0.015244155190885067, decouple_loss:0.0007150399615056813
Iteration: 1543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717586040496826, gen p mean: -0.11406569182872772, mean p set: 0.4477500915527344
loss_pred:0.015087790787220001, decouple_loss:0.0006589002441614866
The modified gen p mean: 0.44829896092414856, gen p mean: -0.11687736213207245, mean p set: 0.448875367641449
loss_pred:0.015246893279254436, decouple_loss:0.0007400634349323809
The modified gen p mean: 0.44782108068466187, gen p mean: -0.1186537891626358, mean p set: 0.4483965039253235
loss_pred:0.01497685071080923, decouple_loss:0.0006268697325140238
Iteration: 1544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784995913505554, gen p mean: -0.11853628605604172, mean p set: 0.4484281837940216
loss_pred:0.016041550785303116, decouple_loss:0.0007999365334399045
The modified gen p mean: 0.44728851318359375, gen p mean: -0.11548516899347305, mean p set: 0.4478660821914673
loss_pred:0.014997106976807117, decouple_loss:0.0008063598070293665
The modified gen p mean: 0.4480085074901581, gen p mean: -0.11394911259412766, mean p set: 0.4485850930213928
loss_pred:0.01458766870200634, decouple_loss:0.0006973842973820865
Iteration: 1545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793233275413513, gen p mean: -0.10981407016515732, mean p set: 0.44850608706474304
loss_pred:0.014179831370711327, decouple_loss:0.0007468219264410436
The modified gen p mean: 0.4484174847602844, gen p mean: -0.1137758269906044, mean p set: 0.4489942789077759
loss_pred:0.014570482075214386, decouple_loss:0.000724958663340658
The modified gen p mean: 0.44765564799308777, gen p mean: -0.10726020485162735, mean p set: 0.4482302665710449
loss_pred:0.014774276874959469, decouple_loss:0.0007629325846210122
Iteration: 1546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806206226348877, gen p mean: -0.1113237664103508, mean p set: 0.4486396908760071
loss_pred:0.015184580348432064, decouple_loss:0.000746514939237386
The modified gen p mean: 0.4463423490524292, gen p mean: -0.11766432225704193, mean p set: 0.44691917300224304
loss_pred:0.015539931133389473, decouple_loss:0.000673456524964422
The modified gen p mean: 0.4481141269207001, gen p mean: -0.11016189306974411, mean p set: 0.4486897885799408
loss_pred:0.014821629971265793, decouple_loss:0.0006225944380275905
Iteration: 1547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475247263908386, gen p mean: -0.11874865740537643, mean p set: 0.4481002688407898
loss_pred:0.015338396653532982, decouple_loss:0.0007488566334359348
The modified gen p mean: 0.44938555359840393, gen p mean: -0.11002343147993088, mean p set: 0.4499613046646118
loss_pred:0.014613378793001175, decouple_loss:0.0009336559451185167
The modified gen p mean: 0.4474814236164093, gen p mean: -0.10825429856777191, mean p set: 0.4480552673339844
loss_pred:0.014692931436002254, decouple_loss:0.0008875888888724148
Iteration: 1548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741982221603394, gen p mean: -0.11199097335338593, mean p set: 0.4479939937591553
loss_pred:0.014902838505804539, decouple_loss:0.0007138922810554504
The modified gen p mean: 0.44677168130874634, gen p mean: -0.11829129606485367, mean p set: 0.4473487436771393
loss_pred:0.01524275541305542, decouple_loss:0.00073762092506513
The modified gen p mean: 0.44756174087524414, gen p mean: -0.10652635246515274, mean p set: 0.44813862442970276
loss_pred:0.015483115799725056, decouple_loss:0.0006476999260485172
Iteration: 1549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44636106491088867, gen p mean: -0.11267456412315369, mean p set: 0.44693389534950256
loss_pred:0.015137521550059319, decouple_loss:0.0007288208580575883
The modified gen p mean: 0.4479493200778961, gen p mean: -0.10706160962581635, mean p set: 0.4485248327255249
The modified gen p mean: 0.4470333456993103, gen p mean: -0.11401981860399246, mean p set: 0.44761136174201965
loss_pred:0.014873489737510681, decouple_loss:0.000672008260153234
loss_pred:0.015130951069295406, decouple_loss:0.0006428587948903441
Iteration: 1550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476865231990814, gen p mean: -0.11318275332450867, mean p set: 0.44826218485832214
loss_pred:0.014738433063030243, decouple_loss:0.0008590944926254451
The modified gen p mean: 0.4467781186103821, gen p mean: -0.11908438801765442, mean p set: 0.44735386967658997
loss_pred:0.015356413088738918, decouple_loss:0.0007568207802250981
The modified gen p mean: 0.4481653571128845, gen p mean: -0.1070699542760849, mean p set: 0.44874149560928345
loss_pred:0.014380605891346931, decouple_loss:0.0007977245841175318
2023-05-01 05:08:37 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11869889497756958, mean p set: 0.4502691626548767
loss_pred:0.017525171861052513, decouple_loss:0.0008151365327648818
The modified gen p mean: 0.44953620433807373, gen p mean: -0.11240732669830322, mean p set: 0.4500633478164673
loss_pred:0.016611624509096146, decouple_loss:0.0009224799578078091
The modified gen p mean: 0.44983139634132385, gen p mean: -0.11165011674165726, mean p set: 0.45035696029663086
loss_pred:0.017028842121362686, decouple_loss:0.0007800073362886906
WV_1_PC_1_EH_0_PS_40, loss: 0.017097173258662224, avg_mse: 0.0265266764909029
current test mse: 0.026527
Iteration: 1551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478830397129059, gen p mean: -0.10790231823921204, mean p set: 0.44846025109291077
The modified gen p mean: 0.448378324508667, gen p mean: -0.11158756166696548, mean p set: 0.44895458221435547
loss_pred:0.014653721824288368, decouple_loss:0.0006421930738724768
loss_pred:0.01443061325699091, decouple_loss:0.000762817682698369
The modified gen p mean: 0.446587473154068, gen p mean: -0.11429614573717117, mean p set: 0.44716405868530273
loss_pred:0.014871026389300823, decouple_loss:0.0007232351927086711
Iteration: 1552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889235496520996, gen p mean: -0.11093900352716446, mean p set: 0.4494676887989044
loss_pred:0.014767683111131191, decouple_loss:0.0006533644045703113
The modified gen p mean: 0.44833850860595703, gen p mean: -0.1115696132183075, mean p set: 0.4489155113697052The modified gen p mean: 0.4489087164402008, gen p mean: -0.11174674332141876, mean p set: 0.449484258890152
loss_pred:0.014727842062711716, decouple_loss:0.0006084942724555731
loss_pred:0.01479901373386383, decouple_loss:0.0006161372293718159
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 1553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44914939999580383, gen p mean: -0.11308625340461731, mean p set: 0.44972550868988037
loss_pred:0.015967583283782005, decouple_loss:0.0006655100150965154
The modified gen p mean: 0.44885188341140747, gen p mean: -0.11867132037878036, mean p set: 0.44942986965179443
The modified gen p mean: 0.44905710220336914, gen p mean: -0.11366545408964157, mean p set: 0.4496358335018158
loss_pred:0.01595471240580082, decouple_loss:0.0006833594525232911
loss_pred:0.016263151541352272, decouple_loss:0.0008321966743096709
Iteration: 1554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448792040348053, gen p mean: -0.11119993031024933, mean p set: 0.4493670165538788
The modified gen p mean: 0.4483640491962433, gen p mean: -0.11160717159509659, mean p set: 0.4489397704601288
loss_pred:0.01565365120768547, decouple_loss:0.0007225965964607894
loss_pred:0.015623782761394978, decouple_loss:0.0007811028626747429
The modified gen p mean: 0.44901663064956665, gen p mean: -0.11359338462352753, mean p set: 0.4495936930179596
loss_pred:0.015745535492897034, decouple_loss:0.0008922728593461215
Iteration: 1555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484443962574005, gen p mean: -0.11011005938053131, mean p set: 0.44901883602142334
loss_pred:0.015229348093271255, decouple_loss:0.0007182196131907403
The modified gen p mean: 0.4488765001296997, gen p mean: -0.11185501515865326, mean p set: 0.4494534134864807
loss_pred:0.015376972034573555, decouple_loss:0.0007063012453727424
The modified gen p mean: 0.448723703622818, gen p mean: -0.11518297344446182, mean p set: 0.4493010640144348
loss_pred:0.01596265286207199, decouple_loss:0.0006785269943065941
Iteration: 1556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492835998535156, gen p mean: -0.11529404670000076, mean p set: 0.4498598277568817
loss_pred:0.01584891602396965, decouple_loss:0.0007429565885104239
The modified gen p mean: 0.4478473961353302, gen p mean: -0.10579283535480499, mean p set: 0.4484219551086426
loss_pred:0.01570800691843033, decouple_loss:0.0008022421970963478
The modified gen p mean: 0.44947898387908936, gen p mean: -0.11382169276475906, mean p set: 0.45005539059638977
loss_pred:0.015552639029920101, decouple_loss:0.0007722593727521598
Iteration: 1557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480349123477936, gen p mean: -0.10851605981588364, mean p set: 0.4486114978790283
loss_pred:0.01659027859568596, decouple_loss:0.000793476530816406
The modified gen p mean: 0.4480644464492798, gen p mean: -0.10629704594612122, mean p set: 0.4486406445503235
loss_pred:0.01644248515367508, decouple_loss:0.0006824693409726024
The modified gen p mean: 0.448944091796875, gen p mean: -0.11532441526651382, mean p set: 0.44951972365379333
loss_pred:0.015584535896778107, decouple_loss:0.0006570547120645642
Iteration: 1558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486871063709259, gen p mean: -0.1163322925567627, mean p set: 0.4492647647857666
loss_pred:0.015518615953624249, decouple_loss:0.0009213110315613449
The modified gen p mean: 0.44810083508491516, gen p mean: -0.11713259667158127, mean p set: 0.4486761689186096
The modified gen p mean: 0.4489871859550476, gen p mean: -0.1184474527835846, mean p set: 0.44956550002098083
loss_pred:0.016013802960515022, decouple_loss:0.000801079033408314
loss_pred:0.016115212813019753, decouple_loss:0.0007242010906338692
Iteration: 1559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876527786254883, gen p mean: -0.11726436018943787, mean p set: 0.44934189319610596
loss_pred:0.015881238505244255, decouple_loss:0.0008922186680138111
The modified gen p mean: 0.44846805930137634, gen p mean: -0.12220849841833115, mean p set: 0.4490435719490051
loss_pred:0.01555076614022255, decouple_loss:0.000695135211572051
The modified gen p mean: 0.4481835961341858, gen p mean: -0.11418787389993668, mean p set: 0.4487597644329071
loss_pred:0.015832608565688133, decouple_loss:0.0006676375633105636
Iteration: 1560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472339451313019, gen p mean: -0.11609651148319244, mean p set: 0.4478098452091217
loss_pred:0.01664317026734352, decouple_loss:0.0007780784508213401
The modified gen p mean: 0.44886288046836853, gen p mean: -0.11523531377315521, mean p set: 0.4494384229183197
loss_pred:0.015204298309981823, decouple_loss:0.0007626774604432285
The modified gen p mean: 0.4486751854419708, gen p mean: -0.11738087236881256, mean p set: 0.44925159215927124
loss_pred:0.0158472191542387, decouple_loss:0.0006953765987418592
2023-05-01 05:11:27 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12133032083511353, mean p set: 0.4502691626548767
loss_pred:0.017349034547805786, decouple_loss:0.0007484583766199648
The modified gen p mean: 0.4495372176170349, gen p mean: -0.11486580967903137, mean p set: 0.4500633478164673
loss_pred:0.016600215807557106, decouple_loss:0.0006975929136388004
The modified gen p mean: 0.4498274624347687, gen p mean: -0.1138138622045517, mean p set: 0.45035696029663086
loss_pred:0.016859138384461403, decouple_loss:0.0008663792978040874
WV_1_PC_1_EH_0_PS_40, loss: 0.016974670812487602, avg_mse: 0.026401380077004433
current test mse: 0.026401
Iteration: 1561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44885918498039246, gen p mean: -0.12088088691234589, mean p set: 0.4494372606277466
loss_pred:0.015662390738725662, decouple_loss:0.0006291178870014846
The modified gen p mean: 0.44854438304901123, gen p mean: -0.1146717518568039, mean p set: 0.44911903142929077The modified gen p mean: 0.449063241481781, gen p mean: -0.1162332147359848, mean p set: 0.4496401250362396
loss_pred:0.015722282230854034, decouple_loss:0.0008559030829928815
loss_pred:0.016199946403503418, decouple_loss:0.0007802795735187829
Iteration: 1562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493548274040222, gen p mean: -0.11888621002435684, mean p set: 0.449928879737854
loss_pred:0.01573016494512558, decouple_loss:0.0007986474665813148
The modified gen p mean: 0.44852474331855774, gen p mean: -0.11703959852457047, mean p set: 0.4491029977798462The modified gen p mean: 0.44788089394569397, gen p mean: -0.11594880372285843, mean p set: 0.44845834374427795
loss_pred:0.016061073169112206, decouple_loss:0.000719666772056371
loss_pred:0.015391326509416103, decouple_loss:0.0006971582770347595
Iteration: 1563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489608108997345, gen p mean: -0.11796136945486069, mean p set: 0.4495360851287842
loss_pred:0.016053074970841408, decouple_loss:0.0007558746729046106
The modified gen p mean: 0.4484259784221649, gen p mean: -0.11167796701192856, mean p set: 0.4490050673484802
loss_pred:0.01617645099759102, decouple_loss:0.0008315446320921183
The modified gen p mean: 0.4474479854106903, gen p mean: -0.11862865090370178, mean p set: 0.4480241537094116
loss_pred:0.016361890360713005, decouple_loss:0.0006694240146316588
Iteration: 1564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44938942790031433, gen p mean: -0.11772510409355164, mean p set: 0.4499637186527252
loss_pred:0.015445906668901443, decouple_loss:0.0008001216338016093
The modified gen p mean: 0.4480362832546234, gen p mean: -0.11797356605529785, mean p set: 0.44861117005348206
loss_pred:0.01593821495771408, decouple_loss:0.0008170558721758425
The modified gen p mean: 0.44779494404792786, gen p mean: -0.11321520060300827, mean p set: 0.44836896657943726
loss_pred:0.01633407175540924, decouple_loss:0.0009020710713230073
Iteration: 1565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494296908378601, gen p mean: -0.1254459172487259, mean p set: 0.4500062167644501
loss_pred:0.015569165349006653, decouple_loss:0.0005968511686660349
The modified gen p mean: 0.4488348960876465, gen p mean: -0.11957602202892303, mean p set: 0.4494089186191559
loss_pred:0.015681663528084755, decouple_loss:0.0005882245604880154
The modified gen p mean: 0.44769757986068726, gen p mean: -0.11518635600805283, mean p set: 0.4482733905315399
loss_pred:0.01603480987250805, decouple_loss:0.0005991312791593373
Iteration: 1566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906285405158997, gen p mean: -0.12284192442893982, mean p set: 0.4496367573738098
loss_pred:0.015571135096251965, decouple_loss:0.000749305821955204
The modified gen p mean: 0.4481048583984375, gen p mean: -0.1157555878162384, mean p set: 0.4486786425113678
loss_pred:0.01640927419066429, decouple_loss:0.0009520940366201103
The modified gen p mean: 0.4482989013195038, gen p mean: -0.11970624327659607, mean p set: 0.4488733410835266
loss_pred:0.015746863558888435, decouple_loss:0.000775892985984683
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937941431999207, gen p mean: -0.11591082811355591, mean p set: 0.4499538242816925
loss_pred:0.015630807727575302, decouple_loss:0.0010246592573821545
The modified gen p mean: 0.44860175251960754, gen p mean: -0.1180008053779602, mean p set: 0.44917774200439453
The modified gen p mean: 0.4474257230758667, gen p mean: -0.11970314383506775, mean p set: 0.4480001628398895
loss_pred:0.01599760539829731, decouple_loss:0.0006864027818664908
loss_pred:0.016215486451983452, decouple_loss:0.0006413278169929981
Iteration: 1568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483204483985901, gen p mean: -0.12032707035541534, mean p set: 0.4488937258720398
loss_pred:0.01629500649869442, decouple_loss:0.0006435062969103456
The modified gen p mean: 0.44772768020629883, gen p mean: -0.1104014441370964, mean p set: 0.44830653071403503
loss_pred:0.01529957540333271, decouple_loss:0.0007324282196350396
The modified gen p mean: 0.44859471917152405, gen p mean: -0.1122717410326004, mean p set: 0.4491669833660126
loss_pred:0.0156429223716259, decouple_loss:0.0008850458543747663
Iteration: 1569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479186534881592, gen p mean: -0.11140647530555725, mean p set: 0.448492169380188
loss_pred:0.01598220132291317, decouple_loss:0.0006338015664368868
The modified gen p mean: 0.4477222263813019, gen p mean: -0.11594024300575256, mean p set: 0.4483001232147217
loss_pred:0.015851572155952454, decouple_loss:0.0005687054363079369
The modified gen p mean: 0.44800180196762085, gen p mean: -0.11871422082185745, mean p set: 0.448577344417572
loss_pred:0.015837782993912697, decouple_loss:0.0006109753157943487
Iteration: 1570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478762149810791, gen p mean: -0.11471157521009445, mean p set: 0.4484536051750183
loss_pred:0.01604202203452587, decouple_loss:0.0007298033451661468
The modified gen p mean: 0.44894251227378845, gen p mean: -0.11396952718496323, mean p set: 0.44951876997947693
loss_pred:0.015655960887670517, decouple_loss:0.0008030676981434226
The modified gen p mean: 0.4482901692390442, gen p mean: -0.12094207108020782, mean p set: 0.4488653242588043
loss_pred:0.015918871387839317, decouple_loss:0.0008447769796475768
2023-05-01 05:13:33 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12280723452568054, mean p set: 0.4502691626548767
loss_pred:0.017343400046229362, decouple_loss:0.0006867601769044995
The modified gen p mean: 0.44953519105911255, gen p mean: -0.11646072566509247, mean p set: 0.4500633478164673
loss_pred:0.016512928530573845, decouple_loss:0.0007736302213743329
The modified gen p mean: 0.44982877373695374, gen p mean: -0.1153293251991272, mean p set: 0.45035696029663086
loss_pred:0.016859140247106552, decouple_loss:0.0008281583432108164
WV_1_PC_1_EH_0_PS_40, loss: 0.016943300142884254, avg_mse: 0.026353895664215088
current test mse: 0.026354
Iteration: 1571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488983154296875, gen p mean: -0.12052104622125626, mean p set: 0.4494735598564148
loss_pred:0.015474784187972546, decouple_loss:0.0006643843953497708
The modified gen p mean: 0.44932249188423157, gen p mean: -0.12171946465969086, mean p set: 0.4498986005783081The modified gen p mean: 0.4492911994457245, gen p mean: -0.12321590632200241, mean p set: 0.4498666524887085
loss_pred:0.01591559313237667, decouple_loss:0.0006190132116898894loss_pred:0.015853209421038628, decouple_loss:0.0006270952872000635
Iteration: 1572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488967955112457, gen p mean: -0.1164870634675026, mean p set: 0.44947290420532227
The modified gen p mean: 0.4491989314556122, gen p mean: -0.11709464341402054, mean p set: 0.4497752785682678
loss_pred:0.015303830616176128, decouple_loss:0.0006263113464228809The modified gen p mean: 0.4474559426307678, gen p mean: -0.11000484973192215, mean p set: 0.4480302929878235
loss_pred:0.014982755295932293, decouple_loss:0.0008258691523224115
loss_pred:0.01577184349298477, decouple_loss:0.0006459652213379741
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
NaN value num: 0
Iteration: 1573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501178562641144, gen p mean: -0.111977718770504, mean p set: 0.45069149136543274
loss_pred:0.01641128771007061, decouple_loss:0.0012563177151605487
The modified gen p mean: 0.44758424162864685, gen p mean: -0.11054932326078415, mean p set: 0.44815847277641296
loss_pred:0.015954328700900078, decouple_loss:0.0011905315332114697
The modified gen p mean: 0.4478064477443695, gen p mean: -0.10847180336713791, mean p set: 0.448382169008255
loss_pred:0.01630658097565174, decouple_loss:0.0012010147329419851
Iteration: 1574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827163219451904, gen p mean: -0.10763990879058838, mean p set: 0.44884851574897766
loss_pred:0.01624421589076519, decouple_loss:0.0008479822427034378
The modified gen p mean: 0.45028650760650635, gen p mean: -0.10602565854787827, mean p set: 0.45086413621902466
loss_pred:0.015670206397771835, decouple_loss:0.0007571118767373264
The modified gen p mean: 0.4500875174999237, gen p mean: -0.10868881642818451, mean p set: 0.4506619870662689
loss_pred:0.016385171562433243, decouple_loss:0.0010229110484942794
Iteration: 1575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45113393664360046, gen p mean: -0.10739745199680328, mean p set: 0.4517087936401367
The modified gen p mean: 0.4499712288379669, gen p mean: -0.09914284944534302, mean p set: 0.45054522156715393
loss_pred:0.016712812706828117, decouple_loss:0.0009706647833809257
loss_pred:0.01692838966846466, decouple_loss:0.0010660926345735788
The modified gen p mean: 0.44853904843330383, gen p mean: -0.10357047617435455, mean p set: 0.44911646842956543
loss_pred:0.01634233631193638, decouple_loss:0.0011214968981221318
Iteration: 1576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491242468357086, gen p mean: -0.09921205788850784, mean p set: 0.4497006833553314
loss_pred:0.01700018346309662, decouple_loss:0.0008535978267900646
The modified gen p mean: 0.4500861167907715, gen p mean: -0.09835303574800491, mean p set: 0.45066389441490173
The modified gen p mean: 0.44747456908226013, gen p mean: -0.10182607918977737, mean p set: 0.4480490982532501
loss_pred:0.01625407487154007, decouple_loss:0.0007519882055930793
loss_pred:0.01606748253107071, decouple_loss:0.001166467904113233
Iteration: 1577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080745220184326, gen p mean: -0.09576649218797684, mean p set: 0.4513837993144989
loss_pred:0.015514157712459564, decouple_loss:0.0007628313032910228
The modified gen p mean: 0.4496006667613983, gen p mean: -0.09614912420511246, mean p set: 0.45017489790916443
loss_pred:0.015934845432639122, decouple_loss:0.0006981269107200205
The modified gen p mean: 0.4479232430458069, gen p mean: -0.09404805302619934, mean p set: 0.4484984576702118
loss_pred:0.01573004573583603, decouple_loss:0.0007411872502416372
Iteration: 1578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447737455368042, gen p mean: -0.09752493351697922, mean p set: 0.44831526279449463
loss_pred:0.016260778531432152, decouple_loss:0.0007349015213549137
The modified gen p mean: 0.4472275674343109, gen p mean: -0.10264085233211517, mean p set: 0.44780364632606506
The modified gen p mean: 0.44811496138572693, gen p mean: -0.103329136967659, mean p set: 0.4486904740333557
loss_pred:0.016252774745225906, decouple_loss:0.0008200184674933553
loss_pred:0.015152915380895138, decouple_loss:0.00066564348526299
Iteration: 1579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495120942592621, gen p mean: -0.10608593374490738, mean p set: 0.45008742809295654
loss_pred:0.016001813113689423, decouple_loss:0.0008641495369374752
The modified gen p mean: 0.4487079083919525, gen p mean: -0.10408689081668854, mean p set: 0.4492831230163574
The modified gen p mean: 0.44953829050064087, gen p mean: -0.10402372479438782, mean p set: 0.45011407136917114
loss_pred:0.015881432220339775, decouple_loss:0.0009704483672976494
loss_pred:0.01624450460076332, decouple_loss:0.0012326124124228954
Iteration: 1580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749361276626587, gen p mean: -0.11092352867126465, mean p set: 0.4480723738670349
loss_pred:0.015813220292329788, decouple_loss:0.0009117143345065415
The modified gen p mean: 0.44798892736434937, gen p mean: -0.10691561549901962, mean p set: 0.4485662281513214
loss_pred:0.015677016228437424, decouple_loss:0.0007944602402858436
The modified gen p mean: 0.45044422149658203, gen p mean: -0.10322195291519165, mean p set: 0.451019287109375
loss_pred:0.015353119000792503, decouple_loss:0.0009526013163849711
2023-05-01 05:16:19 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11438333988189697, mean p set: 0.4502691626548767
loss_pred:0.017403312027454376, decouple_loss:0.0016056132735684514
The modified gen p mean: 0.4495340883731842, gen p mean: -0.10873521119356155, mean p set: 0.4500633478164673
loss_pred:0.016636407002806664, decouple_loss:0.0013613280607387424
The modified gen p mean: 0.4498279392719269, gen p mean: -0.1082918643951416, mean p set: 0.45035696029663086
loss_pred:0.017136922106146812, decouple_loss:0.0011801342479884624
WV_1_PC_1_EH_0_PS_40, loss: 0.017127998173236847, avg_mse: 0.026515450328588486
current test mse: 0.026515
Iteration: 1581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44928738474845886, gen p mean: -0.10540438443422318, mean p set: 0.4498618245124817
loss_pred:0.015834340825676918, decouple_loss:0.001053509535267949
The modified gen p mean: 0.4501921236515045, gen p mean: -0.10815989226102829, mean p set: 0.4507685601711273The modified gen p mean: 0.4500270485877991, gen p mean: -0.10612906515598297, mean p set: 0.4506039321422577
loss_pred:0.015667367726564407, decouple_loss:0.0013983834069222212
loss_pred:0.016066741198301315, decouple_loss:0.0010388969676569104
Iteration: 1582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814062118530273, gen p mean: -0.10737533122301102, mean p set: 0.44871723651885986
loss_pred:0.015720820054411888, decouple_loss:0.0008178961579687893
The modified gen p mean: 0.4501401484012604, gen p mean: -0.11011645942926407, mean p set: 0.4507170021533966The modified gen p mean: 0.44741496443748474, gen p mean: -0.1041184663772583, mean p set: 0.4479900598526001
loss_pred:0.015960991382598877, decouple_loss:0.0008560001151636243loss_pred:0.016916915774345398, decouple_loss:0.0008199833682738245
Iteration: 1583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475916624069214, gen p mean: -0.10511720925569534, mean p set: 0.44816699624061584
loss_pred:0.015774676576256752, decouple_loss:0.0007632732740603387
The modified gen p mean: 0.4502493441104889, gen p mean: -0.10797436535358429, mean p set: 0.4508250057697296
loss_pred:0.016091972589492798, decouple_loss:0.0008888109005056322
The modified gen p mean: 0.44769608974456787, gen p mean: -0.10579859465360641, mean p set: 0.44827190041542053
loss_pred:0.015179193578660488, decouple_loss:0.0006907309289090335
Iteration: 1584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44991645216941833, gen p mean: -0.10874256491661072, mean p set: 0.45049232244491577
loss_pred:0.015469776466488838, decouple_loss:0.0007050014683045447
The modified gen p mean: 0.44906502962112427, gen p mean: -0.10718290507793427, mean p set: 0.4496413767337799
loss_pred:0.015777340158820152, decouple_loss:0.0007689882186241448
The modified gen p mean: 0.4474233388900757, gen p mean: -0.11033660173416138, mean p set: 0.44799768924713135
loss_pred:0.016329456120729446, decouple_loss:0.000685274600982666
Iteration: 1585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786959886550903, gen p mean: -0.10732712596654892, mean p set: 0.4484463632106781
loss_pred:0.015298379585146904, decouple_loss:0.00117224280256778
The modified gen p mean: 0.4472375512123108, gen p mean: -0.10273367166519165, mean p set: 0.44781580567359924
loss_pred:0.015976056456565857, decouple_loss:0.0014505296712741256
The modified gen p mean: 0.4474193751811981, gen p mean: -0.10471595078706741, mean p set: 0.44799432158470154
loss_pred:0.01548834703862667, decouple_loss:0.0012572427513077855
Iteration: 1586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44959476590156555, gen p mean: -0.10473014414310455, mean p set: 0.4501708745956421
loss_pred:0.015740567818284035, decouple_loss:0.0011393546592444181
The modified gen p mean: 0.4479694068431854, gen p mean: -0.10656758397817612, mean p set: 0.4485446512699127
loss_pred:0.015462592244148254, decouple_loss:0.000851924589369446
The modified gen p mean: 0.44810810685157776, gen p mean: -0.10994937270879745, mean p set: 0.44868484139442444
loss_pred:0.015219704248011112, decouple_loss:0.000893076357897371
Iteration: 1587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501210153102875, gen p mean: -0.10695630311965942, mean p set: 0.45069950819015503
loss_pred:0.015505531802773476, decouple_loss:0.0010687639005482197
The modified gen p mean: 0.45043954253196716, gen p mean: -0.1067517027258873, mean p set: 0.45101693272590637
loss_pred:0.01573089137673378, decouple_loss:0.0008125677704811096
The modified gen p mean: 0.4491957426071167, gen p mean: -0.10556695610284805, mean p set: 0.4497711658477783
loss_pred:0.01654539629817009, decouple_loss:0.0008920339168980718
Iteration: 1588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447324275970459, gen p mean: -0.11151904612779617, mean p set: 0.44790026545524597
loss_pred:0.016735615208745003, decouple_loss:0.0010573799954727292
The modified gen p mean: 0.4504249393939972, gen p mean: -0.1093909740447998, mean p set: 0.45100489258766174
loss_pred:0.015406693331897259, decouple_loss:0.000966685707680881
The modified gen p mean: 0.44964492321014404, gen p mean: -0.10277339071035385, mean p set: 0.4502197206020355
loss_pred:0.016638251021504402, decouple_loss:0.0007005191873759031
Iteration: 1589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501366913318634, gen p mean: -0.10608325898647308, mean p set: 0.450714111328125
loss_pred:0.015350865200161934, decouple_loss:0.0008780708885751665
The modified gen p mean: 0.4489809572696686, gen p mean: -0.10815394669771194, mean p set: 0.4495590925216675
loss_pred:0.016222598031163216, decouple_loss:0.0006619576597586274
The modified gen p mean: 0.4496404826641083, gen p mean: -0.11066045612096786, mean p set: 0.45021358132362366
loss_pred:0.015237105078995228, decouple_loss:0.0013129847357049584
Iteration: 1590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024240016937256, gen p mean: -0.11402366310358047, mean p set: 0.450818806886673
loss_pred:0.016408439725637436, decouple_loss:0.0009425129392184317
The modified gen p mean: 0.4487314522266388, gen p mean: -0.1079261302947998, mean p set: 0.44930723309516907
loss_pred:0.015942968428134918, decouple_loss:0.0008309982367791235
The modified gen p mean: 0.4478399157524109, gen p mean: -0.10830144584178925, mean p set: 0.4484158456325531
loss_pred:0.015636954456567764, decouple_loss:0.0010427666129544377
2023-05-01 05:18:24 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11685862392187119, mean p set: 0.4502691626548767
loss_pred:0.017440926283597946, decouple_loss:0.001138791092671454
The modified gen p mean: 0.4495341181755066, gen p mean: -0.11056224256753922, mean p set: 0.4500633478164673
loss_pred:0.01669362187385559, decouple_loss:0.0010553395841270685
The modified gen p mean: 0.44983020424842834, gen p mean: -0.10962317138910294, mean p set: 0.45035696029663086
loss_pred:0.017065778374671936, decouple_loss:0.0009651877335272729
WV_1_PC_1_EH_0_PS_40, loss: 0.017119430005550385, avg_mse: 0.026588384062051773
current test mse: 0.026588
Iteration: 1591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447556734085083, gen p mean: -0.11240524798631668, mean p set: 0.4481312930583954
The modified gen p mean: 0.45091092586517334, gen p mean: -0.10898063331842422, mean p set: 0.45148739218711853
loss_pred:0.01561850868165493, decouple_loss:0.0008655675337649882
loss_pred:0.016408327966928482, decouple_loss:0.0011267607333138585
The modified gen p mean: 0.449830561876297, gen p mean: -0.10961014032363892, mean p set: 0.4504070580005646
loss_pred:0.01602831669151783, decouple_loss:0.0011698907474055886
Iteration: 1592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494761526584625, gen p mean: -0.10550199449062347, mean p set: 0.4500511884689331
loss_pred:0.015824440866708755, decouple_loss:0.0012270823353901505
The modified gen p mean: 0.4496505856513977, gen p mean: -0.10563745349645615, mean p set: 0.4502274990081787The modified gen p mean: 0.4502295255661011, gen p mean: -0.10608123242855072, mean p set: 0.45080679655075073
loss_pred:0.01502807904034853, decouple_loss:0.0008570727659389377
loss_pred:0.016075728461146355, decouple_loss:0.0008873056503944099
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
NaN value num: 0
Iteration: 1593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990578293800354, gen p mean: -0.09966153651475906, mean p set: 0.45048198103904724
loss_pred:0.015781918540596962, decouple_loss:0.0009423515293747187
The modified gen p mean: 0.45026251673698425, gen p mean: -0.10156363993883133, mean p set: 0.45084071159362793
loss_pred:0.015633516013622284, decouple_loss:0.0010686801979318261
The modified gen p mean: 0.4494234323501587, gen p mean: -0.09938347339630127, mean p set: 0.45000073313713074
loss_pred:0.016423678025603294, decouple_loss:0.0009478020947426558
Iteration: 1594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947490096092224, gen p mean: -0.093582883477211, mean p set: 0.45005226135253906
The modified gen p mean: 0.4487246572971344, gen p mean: -0.10616622865200043, mean p set: 0.44930049777030945
loss_pred:0.016870805993676186, decouple_loss:0.0009916521375998855
loss_pred:0.016323663294315338, decouple_loss:0.0011201446177437901
The modified gen p mean: 0.4505630433559418, gen p mean: -0.09646258503198624, mean p set: 0.45113739371299744
loss_pred:0.01602010428905487, decouple_loss:0.0009296610369347036
Iteration: 1595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948872923851013, gen p mean: -0.09647467732429504, mean p set: 0.45006507635116577
loss_pred:0.017297424376010895, decouple_loss:0.0008332451106980443
The modified gen p mean: 0.45047512650489807, gen p mean: -0.09205412864685059, mean p set: 0.45105084776878357
loss_pred:0.016665330156683922, decouple_loss:0.0013709631748497486
The modified gen p mean: 0.44962915778160095, gen p mean: -0.0939214676618576, mean p set: 0.4502054452896118
loss_pred:0.016816310584545135, decouple_loss:0.001023987540975213
Iteration: 1596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873738288879395, gen p mean: -0.09365509450435638, mean p set: 0.44931453466415405
loss_pred:0.016740038990974426, decouple_loss:0.0010764097096398473
The modified gen p mean: 0.4484559893608093, gen p mean: -0.10014579445123672, mean p set: 0.44903138279914856
loss_pred:0.016257883980870247, decouple_loss:0.0009600860648788512
The modified gen p mean: 0.4480656683444977, gen p mean: -0.09230510890483856, mean p set: 0.448642760515213
loss_pred:0.017151566222310066, decouple_loss:0.001067143166437745
Iteration: 1597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500278830528259, gen p mean: -0.0964832454919815, mean p set: 0.4506036043167114
loss_pred:0.016493942588567734, decouple_loss:0.0009074241970665753
The modified gen p mean: 0.4497537910938263, gen p mean: -0.0950092002749443, mean p set: 0.4503287672996521
loss_pred:0.01643994264304638, decouple_loss:0.0006490839296020567
The modified gen p mean: 0.44878819584846497, gen p mean: -0.09395665675401688, mean p set: 0.4493641257286072
loss_pred:0.01556609570980072, decouple_loss:0.0011565831955522299
Iteration: 1598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503440260887146, gen p mean: -0.09677233546972275, mean p set: 0.4509223401546478
loss_pred:0.016454799100756645, decouple_loss:0.0007798016886226833
The modified gen p mean: 0.451151967048645, gen p mean: -0.1003723219037056, mean p set: 0.4517301619052887
The modified gen p mean: 0.44836023449897766, gen p mean: -0.10820510983467102, mean p set: 0.4489381015300751
loss_pred:0.016502615064382553, decouple_loss:0.0007869174005463719
loss_pred:0.01701235957443714, decouple_loss:0.0009519851300865412
Iteration: 1599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495012164115906, gen p mean: -0.10424371063709259, mean p set: 0.45007678866386414
loss_pred:0.01709500327706337, decouple_loss:0.0009399066329933703
The modified gen p mean: 0.44842028617858887, gen p mean: -0.10844993591308594, mean p set: 0.4489981234073639
loss_pred:0.01582229882478714, decouple_loss:0.000832315650768578
The modified gen p mean: 0.4470352530479431, gen p mean: -0.11082711070775986, mean p set: 0.4476113021373749
loss_pred:0.01671297289431095, decouple_loss:0.0008454021881334484
Iteration: 1600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496837258338928, gen p mean: -0.10739102214574814, mean p set: 0.45025986433029175
loss_pred:0.015725091099739075, decouple_loss:0.0006774573121219873
The modified gen p mean: 0.4491482973098755, gen p mean: -0.10312771052122116, mean p set: 0.4497230648994446
loss_pred:0.01664004474878311, decouple_loss:0.0006434150272980332
The modified gen p mean: 0.44808459281921387, gen p mean: -0.10476665198802948, mean p set: 0.44865939021110535
loss_pred:0.016001656651496887, decouple_loss:0.0006868846830911934
2023-05-01 05:21:10 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11672273278236389, mean p set: 0.4502691626548767
loss_pred:0.01750539056956768, decouple_loss:0.0012685073306784034
The modified gen p mean: 0.44953373074531555, gen p mean: -0.1105375736951828, mean p set: 0.4500633478164673
loss_pred:0.016666363924741745, decouple_loss:0.0013362246099859476
The modified gen p mean: 0.44982922077178955, gen p mean: -0.10943665355443954, mean p set: 0.45035696029663086
loss_pred:0.017178839072585106, decouple_loss:0.0013910634443163872
WV_1_PC_1_EH_0_PS_40, loss: 0.017183460295200348, avg_mse: 0.026530129835009575
current test mse: 0.02653
Iteration: 1601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972848892211914, gen p mean: -0.10252809524536133, mean p set: 0.4503055810928345
loss_pred:0.01625824347138405, decouple_loss:0.0006696814671158791
The modified gen p mean: 0.44936999678611755, gen p mean: -0.11338285356760025, mean p set: 0.4499492049217224
loss_pred:0.015570075251162052, decouple_loss:0.0009365685982629657
The modified gen p mean: 0.44978007674217224, gen p mean: -0.11060583591461182, mean p set: 0.4503563344478607
loss_pred:0.015518002212047577, decouple_loss:0.000772078288719058
Iteration: 1602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487832486629486, gen p mean: -0.1024000346660614, mean p set: 0.44936051964759827
loss_pred:0.015856003388762474, decouple_loss:0.0007812771946191788
The modified gen p mean: 0.45018380880355835, gen p mean: -0.10622323304414749, mean p set: 0.45076125860214233The modified gen p mean: 0.44876882433891296, gen p mean: -0.1023828387260437, mean p set: 0.44934722781181335
loss_pred:0.015468461439013481, decouple_loss:0.0006731930770911276
loss_pred:0.016380595043301582, decouple_loss:0.0006838314002379775
Iteration: 1603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45004022121429443, gen p mean: -0.10520599037408829, mean p set: 0.45061561465263367
loss_pred:0.015396426431834698, decouple_loss:0.0005968119949102402
The modified gen p mean: 0.4478392004966736, gen p mean: -0.10442369431257248, mean p set: 0.44841670989990234
loss_pred:0.016141900792717934, decouple_loss:0.0007554026087746024
The modified gen p mean: 0.4502682685852051, gen p mean: -0.09729169309139252, mean p set: 0.4508446753025055
loss_pred:0.016257038339972496, decouple_loss:0.001293394947424531
Iteration: 1604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480549097061157, gen p mean: -0.10278063267469406, mean p set: 0.448630690574646
loss_pred:0.01516889501363039, decouple_loss:0.000816941843368113
The modified gen p mean: 0.44769787788391113, gen p mean: -0.1099495068192482, mean p set: 0.44827285408973694
loss_pred:0.01621801033616066, decouple_loss:0.0006447632913477719
The modified gen p mean: 0.44987303018569946, gen p mean: -0.0992436483502388, mean p set: 0.45045000314712524
loss_pred:0.01641734316945076, decouple_loss:0.0009065748890861869
Iteration: 1605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478151500225067, gen p mean: -0.10299591720104218, mean p set: 0.4483916759490967
loss_pred:0.016724059358239174, decouple_loss:0.000816991669125855
The modified gen p mean: 0.44950732588768005, gen p mean: -0.10616806149482727, mean p set: 0.4500850439071655
loss_pred:0.016190141439437866, decouple_loss:0.0008759074262343347
The modified gen p mean: 0.44880518317222595, gen p mean: -0.10107952356338501, mean p set: 0.44938188791275024
loss_pred:0.015687953680753708, decouple_loss:0.0006270894082263112
Iteration: 1606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495074152946472, gen p mean: -0.10929256677627563, mean p set: 0.450085312128067
The modified gen p mean: 0.45017489790916443, gen p mean: -0.10265828669071198, mean p set: 0.4507491886615753
loss_pred:0.01620578020811081, decouple_loss:0.001185020199045539
loss_pred:0.01631326414644718, decouple_loss:0.0014016726054251194
The modified gen p mean: 0.4480278193950653, gen p mean: -0.10695743560791016, mean p set: 0.44860365986824036
loss_pred:0.01611221581697464, decouple_loss:0.0008547028410248458
Iteration: 1607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447643905878067, gen p mean: -0.11298999935388565, mean p set: 0.4482189118862152
loss_pred:0.016862059012055397, decouple_loss:0.0008449070155620575
The modified gen p mean: 0.4488203227519989, gen p mean: -0.11714305728673935, mean p set: 0.44939908385276794
loss_pred:0.015338893048465252, decouple_loss:0.0007673755171708763
The modified gen p mean: 0.45032089948654175, gen p mean: -0.1067323237657547, mean p set: 0.45089852809906006
loss_pred:0.016634244471788406, decouple_loss:0.0009658783092163503
Iteration: 1608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806748628616333, gen p mean: -0.11212970316410065, mean p set: 0.4486430585384369
loss_pred:0.01569371484220028, decouple_loss:0.0013646590523421764
The modified gen p mean: 0.45008283853530884, gen p mean: -0.10945893824100494, mean p set: 0.4506600499153137
The modified gen p mean: 0.45045942068099976, gen p mean: -0.11115027219057083, mean p set: 0.4510374367237091
loss_pred:0.016159538179636, decouple_loss:0.0012117300648242235
loss_pred:0.015986481681466103, decouple_loss:0.0012105992063879967
Iteration: 1609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503563344478607, gen p mean: -0.10977121442556381, mean p set: 0.4509299099445343
loss_pred:0.016362613067030907, decouple_loss:0.0009508301736786962
The modified gen p mean: 0.4518224895000458, gen p mean: -0.11286517232656479, mean p set: 0.4524003565311432
loss_pred:0.016696153208613396, decouple_loss:0.0014357173349708319
The modified gen p mean: 0.44987913966178894, gen p mean: -0.11362156271934509, mean p set: 0.45045650005340576
loss_pred:0.015390211716294289, decouple_loss:0.0008789571584202349
Iteration: 1610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862040877342224, gen p mean: -0.10457294434309006, mean p set: 0.44919705390930176
loss_pred:0.015987267717719078, decouple_loss:0.0008478281670249999
The modified gen p mean: 0.4500596225261688, gen p mean: -0.10410972684621811, mean p set: 0.45063650608062744
The modified gen p mean: 0.4478317201137543, gen p mean: -0.10786528140306473, mean p set: 0.44840651750564575
loss_pred:0.016391923651099205, decouple_loss:0.0008999802521429956
loss_pred:0.016710586845874786, decouple_loss:0.0008273591520264745
2023-05-01 05:23:16 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11553934216499329, mean p set: 0.4502691626548767
loss_pred:0.017489181831479073, decouple_loss:0.001051155966706574
The modified gen p mean: 0.4495347738265991, gen p mean: -0.1092703640460968, mean p set: 0.4500633478164673
loss_pred:0.01665923371911049, decouple_loss:0.0011952174827456474
The modified gen p mean: 0.44982796907424927, gen p mean: -0.10827929526567459, mean p set: 0.45035696029663086
loss_pred:0.017133941873908043, decouple_loss:0.001329098711721599
WV_1_PC_1_EH_0_PS_40, loss: 0.01715371198952198, avg_mse: 0.026569683104753494
current test mse: 0.02657
Iteration: 1611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44920966029167175, gen p mean: -0.10369428992271423, mean p set: 0.4497860372066498
loss_pred:0.015993868932127953, decouple_loss:0.0011330326087772846
The modified gen p mean: 0.44754254817962646, gen p mean: -0.1103506088256836, mean p set: 0.44811883568763733
loss_pred:0.016162320971488953, decouple_loss:0.0011980585986748338
The modified gen p mean: 0.45223331451416016, gen p mean: -0.10593889653682709, mean p set: 0.4528099000453949
loss_pred:0.015681816264986992, decouple_loss:0.0008784857345744967
Iteration: 1612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489746689796448, gen p mean: -0.10447452962398529, mean p set: 0.44955018162727356
loss_pred:0.016342056915163994, decouple_loss:0.0006144063081592321
The modified gen p mean: 0.4505331516265869, gen p mean: -0.10090198367834091, mean p set: 0.4511106312274933The modified gen p mean: 0.4508782625198364, gen p mean: -0.10144740343093872, mean p set: 0.451458215713501
loss_pred:0.01691051572561264, decouple_loss:0.0013062508078292012
loss_pred:0.016032684594392776, decouple_loss:0.0007162413094192743
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 1613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491766393184662, gen p mean: -0.10624881833791733, mean p set: 0.44975459575653076
loss_pred:0.015504305250942707, decouple_loss:0.0010260421549901366
The modified gen p mean: 0.4477708041667938, gen p mean: -0.10617136210203171, mean p set: 0.4483490288257599
loss_pred:0.015565825626254082, decouple_loss:0.0009690769948065281
The modified gen p mean: 0.4485618472099304, gen p mean: -0.11008065193891525, mean p set: 0.449137419462204
loss_pred:0.01593482494354248, decouple_loss:0.0010147177381440997
Iteration: 1614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903621077537537, gen p mean: -0.1134224608540535, mean p set: 0.4496126174926758
loss_pred:0.015307308174669743, decouple_loss:0.0009080225136131048
The modified gen p mean: 0.44929423928260803, gen p mean: -0.10976284742355347, mean p set: 0.4498685300350189
loss_pred:0.016278425231575966, decouple_loss:0.0006934823468327522
The modified gen p mean: 0.44860461354255676, gen p mean: -0.11384011805057526, mean p set: 0.44917967915534973
loss_pred:0.0157572440803051, decouple_loss:0.0006813406944274902
Iteration: 1615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484527111053467, gen p mean: -0.11776167154312134, mean p set: 0.44902855157852173
loss_pred:0.015994783490896225, decouple_loss:0.0010239838156849146
The modified gen p mean: 0.44965028762817383, gen p mean: -0.11486471444368362, mean p set: 0.45022737979888916
loss_pred:0.016038937494158745, decouple_loss:0.0007984910625964403
The modified gen p mean: 0.44836798310279846, gen p mean: -0.11383557319641113, mean p set: 0.448943167924881
loss_pred:0.015607628971338272, decouple_loss:0.0010403941851109266
Iteration: 1616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010459423065186, gen p mean: -0.11894567310810089, mean p set: 0.450682133436203
The modified gen p mean: 0.4498080909252167, gen p mean: -0.11902787536382675, mean p set: 0.4503842294216156
loss_pred:0.015562715008854866, decouple_loss:0.0006836675456725061
loss_pred:0.015776757150888443, decouple_loss:0.0006731994217261672
The modified gen p mean: 0.44828927516937256, gen p mean: -0.12375111132860184, mean p set: 0.4488680362701416
loss_pred:0.015084553509950638, decouple_loss:0.0007275440730154514
Iteration: 1617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44878020882606506, gen p mean: -0.12313084304332733, mean p set: 0.44936034083366394
loss_pred:0.015427879057824612, decouple_loss:0.0009437781991437078
The modified gen p mean: 0.4474808871746063, gen p mean: -0.11932654678821564, mean p set: 0.448056697845459
The modified gen p mean: 0.4484664797782898, gen p mean: -0.12616917490959167, mean p set: 0.44904085993766785
loss_pred:0.015033737756311893, decouple_loss:0.0007014856673777103
loss_pred:0.015250641852617264, decouple_loss:0.0008005566196516156
Iteration: 1618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492642879486084, gen p mean: -0.11799495667219162, mean p set: 0.4498407244682312
loss_pred:0.01587870344519615, decouple_loss:0.0006740554235875607
The modified gen p mean: 0.4471507668495178, gen p mean: -0.11787519603967667, mean p set: 0.4477255642414093
The modified gen p mean: 0.446393758058548, gen p mean: -0.12283133715391159, mean p set: 0.4469698667526245
loss_pred:0.015071683563292027, decouple_loss:0.000604596920311451
loss_pred:0.015337933786213398, decouple_loss:0.0009071333915926516
Iteration: 1619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729092717170715, gen p mean: -0.12072437256574631, mean p set: 0.4478663504123688
loss_pred:0.015334001742303371, decouple_loss:0.0008065818110480905
The modified gen p mean: 0.4480012357234955, gen p mean: -0.11577489972114563, mean p set: 0.4485769271850586
The modified gen p mean: 0.4490134119987488, gen p mean: -0.11569105833768845, mean p set: 0.44958946108818054
loss_pred:0.015206722542643547, decouple_loss:0.0007624679710716009
loss_pred:0.015433603897690773, decouple_loss:0.0007667722529731691
Iteration: 1620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476328194141388, gen p mean: -0.11327757686376572, mean p set: 0.44820865988731384
loss_pred:0.015387238003313541, decouple_loss:0.0010626758448779583
The modified gen p mean: 0.44843369722366333, gen p mean: -0.111566923558712, mean p set: 0.44900989532470703
The modified gen p mean: 0.4487469792366028, gen p mean: -0.11150192469358444, mean p set: 0.44932347536087036
loss_pred:0.015487512573599815, decouple_loss:0.0011460846289992332
loss_pred:0.015112129040062428, decouple_loss:0.0009471443481743336
2023-05-01 05:26:02 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11461705714464188, mean p set: 0.4502691626548767
loss_pred:0.01734057627618313, decouple_loss:0.0008243863703683019
The modified gen p mean: 0.44953620433807373, gen p mean: -0.10874011367559433, mean p set: 0.4500633478164673
loss_pred:0.01650104485452175, decouple_loss:0.0008460654644295573
The modified gen p mean: 0.44982901215553284, gen p mean: -0.10779451578855515, mean p set: 0.45035696029663086
loss_pred:0.016996366903185844, decouple_loss:0.0008245067438110709
WV_1_PC_1_EH_0_PS_40, loss: 0.016987578943371773, avg_mse: 0.02634590119123459
current test mse: 0.026346
Iteration: 1621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480399191379547, gen p mean: -0.10793327540159225, mean p set: 0.44861605763435364
loss_pred:0.015213257633149624, decouple_loss:0.0006592868594452739
The modified gen p mean: 0.44988492131233215, gen p mean: -0.10682033002376556, mean p set: 0.45046207308769226The modified gen p mean: 0.44787004590034485, gen p mean: -0.103806272149086, mean p set: 0.44844722747802734
loss_pred:0.015145755372941494, decouple_loss:0.0010827574878931046
loss_pred:0.015531894750893116, decouple_loss:0.0006472172681242228
Iteration: 1622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972100853919983, gen p mean: -0.1053326353430748, mean p set: 0.45029905438423157
loss_pred:0.01563483104109764, decouple_loss:0.000950152229052037
The modified gen p mean: 0.4491107761859894, gen p mean: -0.10769072920084, mean p set: 0.449687123298645The modified gen p mean: 0.44930145144462585, gen p mean: -0.10969614237546921, mean p set: 0.44987955689430237
loss_pred:0.01629149168729782, decouple_loss:0.001118224230594933
loss_pred:0.015458483248949051, decouple_loss:0.001050962833687663
Iteration: 1623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45005467534065247, gen p mean: -0.10429929196834564, mean p set: 0.45063140988349915
The modified gen p mean: 0.4490216076374054, gen p mean: -0.1099715307354927, mean p set: 0.4495994448661804
loss_pred:0.015318745747208595, decouple_loss:0.0008863508701324463
loss_pred:0.01569267176091671, decouple_loss:0.0009871898218989372
The modified gen p mean: 0.4487689733505249, gen p mean: -0.10932677239179611, mean p set: 0.4493459463119507
loss_pred:0.016121892258524895, decouple_loss:0.0012085774214938283
Iteration: 1624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483867883682251, gen p mean: -0.11260226368904114, mean p set: 0.44896194338798523
loss_pred:0.015770232304930687, decouple_loss:0.0007499908097088337
The modified gen p mean: 0.4490668773651123, gen p mean: -0.1064024418592453, mean p set: 0.44964301586151123
loss_pred:0.015891477465629578, decouple_loss:0.0008236262947320938
The modified gen p mean: 0.44934573769569397, gen p mean: -0.10089962929487228, mean p set: 0.4499235153198242
loss_pred:0.01593182422220707, decouple_loss:0.000838973734062165
Iteration: 1625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486521780490875, gen p mean: -0.11284229904413223, mean p set: 0.4492279887199402
loss_pred:0.015036206692457199, decouple_loss:0.0007138245855458081
The modified gen p mean: 0.44840845465660095, gen p mean: -0.11239200830459595, mean p set: 0.44898566603660583
loss_pred:0.015278980135917664, decouple_loss:0.0009516616119071841
The modified gen p mean: 0.4476311504840851, gen p mean: -0.11236071586608887, mean p set: 0.44820713996887207
loss_pred:0.01586982049047947, decouple_loss:0.0010159739758819342
Iteration: 1626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45005545020103455, gen p mean: -0.1064324676990509, mean p set: 0.4506332576274872
loss_pred:0.01464683748781681, decouple_loss:0.0014273509150370955
The modified gen p mean: 0.44873014092445374, gen p mean: -0.11476864665746689, mean p set: 0.44930922985076904
The modified gen p mean: 0.4493763744831085, gen p mean: -0.10796614736318588, mean p set: 0.4499533474445343
loss_pred:0.015008117072284222, decouple_loss:0.0007589586894027889
loss_pred:0.015149428509175777, decouple_loss:0.0010607335716485977
Iteration: 1627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779714941978455, gen p mean: -0.10312232375144958, mean p set: 0.44837456941604614
loss_pred:0.015305634588003159, decouple_loss:0.0007036982569843531
The modified gen p mean: 0.4480137526988983, gen p mean: -0.099681057035923, mean p set: 0.4485895335674286
The modified gen p mean: 0.44942566752433777, gen p mean: -0.11225296556949615, mean p set: 0.4500042200088501
loss_pred:0.014764421619474888, decouple_loss:0.0007294014212675393
loss_pred:0.015441227704286575, decouple_loss:0.0008835978806018829
Iteration: 1628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449262797832489, gen p mean: -0.11381150037050247, mean p set: 0.44983842968940735
loss_pred:0.015821371227502823, decouple_loss:0.0008942479616962373
The modified gen p mean: 0.44805818796157837, gen p mean: -0.10832465440034866, mean p set: 0.448634535074234
The modified gen p mean: 0.4465264081954956, gen p mean: -0.11302059888839722, mean p set: 0.44710251688957214
loss_pred:0.015342256054282188, decouple_loss:0.0007284748135134578
loss_pred:0.015232771635055542, decouple_loss:0.0008157133124768734
Iteration: 1629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488828182220459, gen p mean: -0.11062990874052048, mean p set: 0.44945788383483887
The modified gen p mean: 0.44969531893730164, gen p mean: -0.11130083352327347, mean p set: 0.4502703547477722
loss_pred:0.01472657360136509, decouple_loss:0.0008367175469174981
loss_pred:0.015412162989377975, decouple_loss:0.0007417782908305526
The modified gen p mean: 0.4486595094203949, gen p mean: -0.1033172458410263, mean p set: 0.4492368996143341
loss_pred:0.015175718814134598, decouple_loss:0.000911154318600893
Iteration: 1630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477899372577667, gen p mean: -0.10993245244026184, mean p set: 0.4483669102191925
loss_pred:0.015201685018837452, decouple_loss:0.0007015145383775234
The modified gen p mean: 0.44830507040023804, gen p mean: -0.1047707051038742, mean p set: 0.44888070225715637
The modified gen p mean: 0.4480156898498535, gen p mean: -0.10944224894046783, mean p set: 0.4485909342765808
loss_pred:0.014704722911119461, decouple_loss:0.0008858304936438799
loss_pred:0.015721280127763748, decouple_loss:0.0007038877229206264
2023-05-01 05:28:07 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11952146142721176, mean p set: 0.4502691626548767
loss_pred:0.017367206513881683, decouple_loss:0.0007559377700090408
The modified gen p mean: 0.4495334327220917, gen p mean: -0.11410277336835861, mean p set: 0.4500633478164673
loss_pred:0.016564954072237015, decouple_loss:0.0007228483445942402
The modified gen p mean: 0.44982731342315674, gen p mean: -0.11362755298614502, mean p set: 0.45035696029663086
loss_pred:0.016969062387943268, decouple_loss:0.0007099950453266501
WV_1_PC_1_EH_0_PS_40, loss: 0.017003554850816727, avg_mse: 0.026388240978121758
current test mse: 0.026388
Iteration: 1631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44871044158935547, gen p mean: -0.11525311321020126, mean p set: 0.449288934469223
loss_pred:0.015404856763780117, decouple_loss:0.000574890524148941
The modified gen p mean: 0.44898101687431335, gen p mean: -0.11652588844299316, mean p set: 0.4495595097541809The modified gen p mean: 0.4494861662387848, gen p mean: -0.11741957068443298, mean p set: 0.4500616788864136
loss_pred:0.015354372560977936, decouple_loss:0.000686745042912662loss_pred:0.015366393141448498, decouple_loss:0.0006466626655310392
Iteration: 1632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45031169056892395, gen p mean: -0.11039536446332932, mean p set: 0.4508882462978363
loss_pred:0.014945567585527897, decouple_loss:0.0008127232431434095
The modified gen p mean: 0.44754549860954285, gen p mean: -0.11681506782770157, mean p set: 0.4481198489665985
The modified gen p mean: 0.44892486929893494, gen p mean: -0.11483877897262573, mean p set: 0.44949984550476074
loss_pred:0.01493575144559145, decouple_loss:0.0006252136081457138
loss_pred:0.015310585498809814, decouple_loss:0.0008368813432753086
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
NaN value num: 0
Iteration: 1633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45294761657714844, gen p mean: -0.10693830996751785, mean p set: 0.45352625846862793
loss_pred:0.017061959952116013, decouple_loss:0.0008019689121283591
The modified gen p mean: 0.44943806529045105, gen p mean: -0.10576414316892624, mean p set: 0.4500143229961395
The modified gen p mean: 0.4534834921360016, gen p mean: -0.10749514400959015, mean p set: 0.45406150817871094
loss_pred:0.016729917377233505, decouple_loss:0.0007272748625837266
loss_pred:0.01649468019604683, decouple_loss:0.0008208607323467731
Iteration: 1634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449750691652298, gen p mean: -0.10529330372810364, mean p set: 0.45032599568367004
loss_pred:0.01643405109643936, decouple_loss:0.0006687484565190971
The modified gen p mean: 0.448638379573822, gen p mean: -0.11089331656694412, mean p set: 0.44921332597732544
loss_pred:0.016922645270824432, decouple_loss:0.0008506940794177353
The modified gen p mean: 0.4486715793609619, gen p mean: -0.10987535864114761, mean p set: 0.44924721121788025
loss_pred:0.01567746512591839, decouple_loss:0.0008419342921115458
Iteration: 1635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45246854424476624, gen p mean: -0.10386722534894943, mean p set: 0.45304545760154724
loss_pred:0.016537591814994812, decouple_loss:0.0008273344719782472
The modified gen p mean: 0.44973987340927124, gen p mean: -0.10402682423591614, mean p set: 0.45031604170799255
loss_pred:0.01644832454621792, decouple_loss:0.0008375364122912288
The modified gen p mean: 0.4514545798301697, gen p mean: -0.10423633456230164, mean p set: 0.4520338773727417
loss_pred:0.016723543405532837, decouple_loss:0.0008818100905045867
Iteration: 1636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45225703716278076, gen p mean: -0.10138046741485596, mean p set: 0.4528343677520752
loss_pred:0.01634056493639946, decouple_loss:0.0009225213434547186
The modified gen p mean: 0.45272746682167053, gen p mean: -0.10103975981473923, mean p set: 0.45330190658569336
The modified gen p mean: 0.4515306353569031, gen p mean: -0.10612189024686813, mean p set: 0.4521060883998871
loss_pred:0.01621481589972973, decouple_loss:0.0008752526482567191
loss_pred:0.016491470858454704, decouple_loss:0.00091617985162884
Iteration: 1637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494417607784271, gen p mean: -0.09748440980911255, mean p set: 0.4500192403793335
loss_pred:0.016582779586315155, decouple_loss:0.000714217487256974
The modified gen p mean: 0.44880953431129456, gen p mean: -0.1086537316441536, mean p set: 0.4493838846683502
The modified gen p mean: 0.4525551199913025, gen p mean: -0.10080927610397339, mean p set: 0.4531312584877014
loss_pred:0.016966627910733223, decouple_loss:0.000691303052008152
loss_pred:0.016794055700302124, decouple_loss:0.0008765654638409615
Iteration: 1638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484630525112152, gen p mean: -0.10825279355049133, mean p set: 0.44903984665870667
loss_pred:0.016610093414783478, decouple_loss:0.0008136109681800008
The modified gen p mean: 0.4500322639942169, gen p mean: -0.108284592628479, mean p set: 0.4506070911884308
The modified gen p mean: 0.4503921866416931, gen p mean: -0.10446667671203613, mean p set: 0.45096808671951294
loss_pred:0.017057666555047035, decouple_loss:0.0008471949258819222
loss_pred:0.015736209228634834, decouple_loss:0.0006218635244295001
Iteration: 1639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44959238171577454, gen p mean: -0.09750369191169739, mean p set: 0.4501686692237854
loss_pred:0.016436701640486717, decouple_loss:0.0007931148866191506
The modified gen p mean: 0.4471689760684967, gen p mean: -0.11161455512046814, mean p set: 0.4477446675300598
The modified gen p mean: 0.4501272141933441, gen p mean: -0.0999680757522583, mean p set: 0.4507025480270386
loss_pred:0.015835005789995193, decouple_loss:0.0006789517356082797
loss_pred:0.01706254482269287, decouple_loss:0.0008630937081761658
Iteration: 1640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496680498123169, gen p mean: -0.11044568568468094, mean p set: 0.4502440094947815
loss_pred:0.017522482201457024, decouple_loss:0.001111458521336317
The modified gen p mean: 0.44960451126098633, gen p mean: -0.10591280460357666, mean p set: 0.45018163323402405
loss_pred:0.01653345860540867, decouple_loss:0.0007683293661102653
The modified gen p mean: 0.45109662413597107, gen p mean: -0.10905079543590546, mean p set: 0.4516725242137909
loss_pred:0.016873329877853394, decouple_loss:0.0009324968559667468
2023-05-01 05:30:55 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12013961374759674, mean p set: 0.4502691626548767
loss_pred:0.01757308654487133, decouple_loss:0.0008856818894855678
The modified gen p mean: 0.44953352212905884, gen p mean: -0.11453660577535629, mean p set: 0.4500633478164673
loss_pred:0.016693852841854095, decouple_loss:0.0008622081368230283
The modified gen p mean: 0.4498271942138672, gen p mean: -0.11371691524982452, mean p set: 0.45035696029663086
loss_pred:0.016968902200460434, decouple_loss:0.000795195228420198
WV_1_PC_1_EH_0_PS_40, loss: 0.017121000215411186, avg_mse: 0.02654726803302765
current test mse: 0.026547
Iteration: 1641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971293210983276, gen p mean: -0.11253345757722855, mean p set: 0.4502916932106018
loss_pred:0.017059218138456345, decouple_loss:0.0006789916660636663
The modified gen p mean: 0.4496307075023651, gen p mean: -0.11735793948173523, mean p set: 0.45020797848701477The modified gen p mean: 0.45060721039772034, gen p mean: -0.10775473713874817, mean p set: 0.4511836767196655
loss_pred:0.016729196533560753, decouple_loss:0.0007967563578858972
loss_pred:0.017699109390378, decouple_loss:0.0007309704087674618
Iteration: 1642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504934251308441, gen p mean: -0.11485189944505692, mean p set: 0.4510722756385803
loss_pred:0.015640176832675934, decouple_loss:0.0008537951507605612
The modified gen p mean: 0.45003679394721985, gen p mean: -0.10757862031459808, mean p set: 0.45061424374580383The modified gen p mean: 0.45011886954307556, gen p mean: -0.11131004244089127, mean p set: 0.450695663690567
loss_pred:0.016164997592568398, decouple_loss:0.0009616451570764184loss_pred:0.01634128950536251, decouple_loss:0.000982665573246777
Iteration: 1643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485943019390106, gen p mean: -0.11470095068216324, mean p set: 0.44917213916778564
The modified gen p mean: 0.4494034945964813, gen p mean: -0.11062140762805939, mean p set: 0.4499790072441101
loss_pred:0.0156361423432827, decouple_loss:0.0008989204652607441
loss_pred:0.01663488894701004, decouple_loss:0.000777427398134023
The modified gen p mean: 0.44998905062675476, gen p mean: -0.11099069565534592, mean p set: 0.4505661725997925
loss_pred:0.01553941611200571, decouple_loss:0.0007059014169499278
Iteration: 1644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44970574975013733, gen p mean: -0.1082601398229599, mean p set: 0.45028528571128845
loss_pred:0.015829823911190033, decouple_loss:0.0010613099439069629
The modified gen p mean: 0.4529016613960266, gen p mean: -0.10830829292535782, mean p set: 0.4534813165664673
loss_pred:0.016870269551873207, decouple_loss:0.0014608341734856367
The modified gen p mean: 0.452642023563385, gen p mean: -0.10957427322864532, mean p set: 0.4532198905944824
loss_pred:0.0167935099452734, decouple_loss:0.0012074507540091872
Iteration: 1645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44914180040359497, gen p mean: -0.1100577637553215, mean p set: 0.4497148096561432
loss_pred:0.015963105484843254, decouple_loss:0.0008334921440109611
The modified gen p mean: 0.44924089312553406, gen p mean: -0.11601277440786362, mean p set: 0.44981902837753296
loss_pred:0.016233012080192566, decouple_loss:0.0010276236571371555
The modified gen p mean: 0.4526218771934509, gen p mean: -0.10640730708837509, mean p set: 0.4531964957714081
loss_pred:0.016268251463770866, decouple_loss:0.0009411444771103561
Iteration: 1646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45021355152130127, gen p mean: -0.10858486592769623, mean p set: 0.4507887363433838
loss_pred:0.015380860306322575, decouple_loss:0.0007706201868131757
The modified gen p mean: 0.44836634397506714, gen p mean: -0.1176365315914154, mean p set: 0.44894298911094666
The modified gen p mean: 0.449248731136322, gen p mean: -0.10579068213701248, mean p set: 0.44982537627220154
loss_pred:0.015686428174376488, decouple_loss:0.0008796064648777246
loss_pred:0.01688878983259201, decouple_loss:0.0006780608091503382
Iteration: 1647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44908955693244934, gen p mean: -0.10613277554512024, mean p set: 0.44966429471969604
loss_pred:0.016773374751210213, decouple_loss:0.0013197511434555054
The modified gen p mean: 0.452073335647583, gen p mean: -0.10251736640930176, mean p set: 0.45265257358551025
The modified gen p mean: 0.45029503107070923, gen p mean: -0.10311964154243469, mean p set: 0.45087239146232605
loss_pred:0.01646829955279827, decouple_loss:0.0010985871776938438
loss_pred:0.01658014953136444, decouple_loss:0.0008910481701605022
Iteration: 1648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44959044456481934, gen p mean: -0.10749024152755737, mean p set: 0.45016786456108093
loss_pred:0.0168716162443161, decouple_loss:0.0010178012307733297
The modified gen p mean: 0.4496265649795532, gen p mean: -0.10620256513357162, mean p set: 0.45020267367362976
loss_pred:0.016981830820441246, decouple_loss:0.0011970264604315162
The modified gen p mean: 0.451166570186615, gen p mean: -0.10638702660799026, mean p set: 0.4517436623573303
loss_pred:0.016893645748496056, decouple_loss:0.0009413770167157054
Iteration: 1649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449076384305954, gen p mean: -0.10603850334882736, mean p set: 0.4496527314186096
loss_pred:0.016547909006476402, decouple_loss:0.0009206006652675569
The modified gen p mean: 0.4505085349082947, gen p mean: -0.10583844035863876, mean p set: 0.4510878920555115
loss_pred:0.017080146819353104, decouple_loss:0.0008913655765354633
The modified gen p mean: 0.44998085498809814, gen p mean: -0.10399121046066284, mean p set: 0.4505581855773926
loss_pred:0.01645338162779808, decouple_loss:0.0007872990099713206
Iteration: 1650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497547745704651, gen p mean: -0.10811691731214523, mean p set: 0.4503326416015625
loss_pred:0.01724386028945446, decouple_loss:0.0010270415805280209
The modified gen p mean: 0.4498782753944397, gen p mean: -0.10398770868778229, mean p set: 0.45045459270477295
loss_pred:0.015511143952608109, decouple_loss:0.0008458233205601573
The modified gen p mean: 0.4528844356536865, gen p mean: -0.1037689670920372, mean p set: 0.4534589648246765
loss_pred:0.016446968540549278, decouple_loss:0.001249730121344328
2023-05-01 05:33:00 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11544180661439896, mean p set: 0.4502691626548767
loss_pred:0.017591383308172226, decouple_loss:0.0013813091209158301
The modified gen p mean: 0.4495351016521454, gen p mean: -0.11004967987537384, mean p set: 0.4500633478164673
loss_pred:0.016758296638727188, decouple_loss:0.001077448483556509
The modified gen p mean: 0.44982850551605225, gen p mean: -0.10905420035123825, mean p set: 0.45035696029663086
loss_pred:0.01705731451511383, decouple_loss:0.0010944323148578405
WV_1_PC_1_EH_0_PS_40, loss: 0.01719488576054573, avg_mse: 0.026592057198286057
current test mse: 0.026592
Iteration: 1651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488303065299988, gen p mean: -0.1100945845246315, mean p set: 0.4494048058986664
loss_pred:0.015355427749454975, decouple_loss:0.0009497221326455474
The modified gen p mean: 0.4498269855976105, gen p mean: -0.09812434017658234, mean p set: 0.45040273666381836
loss_pred:0.016237670555710793, decouple_loss:0.0010625466238707304
The modified gen p mean: 0.45162105560302734, gen p mean: -0.10136223584413528, mean p set: 0.45219725370407104
loss_pred:0.015871698036789894, decouple_loss:0.001254313625395298
Iteration: 1652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45133036375045776, gen p mean: -0.1096457988023758, mean p set: 0.451905757188797
loss_pred:0.01578059047460556, decouple_loss:0.0008034452912397683
The modified gen p mean: 0.4530662000179291, gen p mean: -0.10497730225324631, mean p set: 0.45364704728126526The modified gen p mean: 0.44874459505081177, gen p mean: -0.11026846617460251, mean p set: 0.4493206739425659
loss_pred:0.016136350110173225, decouple_loss:0.0008134801755659282
loss_pred:0.0158427394926548, decouple_loss:0.0007890802808105946
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
NaN value num: 0
Iteration: 1653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499237835407257, gen p mean: -0.11708057671785355, mean p set: 0.45049992203712463
loss_pred:0.016813600435853004, decouple_loss:0.0009260405786335468
The modified gen p mean: 0.45086511969566345, gen p mean: -0.11815902590751648, mean p set: 0.4514424204826355
loss_pred:0.015714365988969803, decouple_loss:0.0011482906993478537
The modified gen p mean: 0.4498498737812042, gen p mean: -0.11292029172182083, mean p set: 0.45042750239372253
loss_pred:0.01715669222176075, decouple_loss:0.0012570925755426288
Iteration: 1654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498232901096344, gen p mean: -0.12758967280387878, mean p set: 0.450395792722702
loss_pred:0.01753547601401806, decouple_loss:0.0009870112407952547
The modified gen p mean: 0.44813838601112366, gen p mean: -0.1245674267411232, mean p set: 0.4487132728099823
loss_pred:0.01735169254243374, decouple_loss:0.0012823619181290269
The modified gen p mean: 0.44871824979782104, gen p mean: -0.12323273718357086, mean p set: 0.4492945969104767
loss_pred:0.01693960279226303, decouple_loss:0.0009142524795606732
Iteration: 1655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45076555013656616, gen p mean: -0.11234680563211441, mean p set: 0.4513426423072815
loss_pred:0.01819593273103237, decouple_loss:0.0009769328171387315
The modified gen p mean: 0.44923514127731323, gen p mean: -0.11411593109369278, mean p set: 0.44980788230895996
loss_pred:0.018134279176592827, decouple_loss:0.0009547218214720488
The modified gen p mean: 0.45072636008262634, gen p mean: -0.11679274588823318, mean p set: 0.4513028562068939
loss_pred:0.018314946442842484, decouple_loss:0.00094400200759992
Iteration: 1656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44965529441833496, gen p mean: -0.08354636281728745, mean p set: 0.4502323865890503
loss_pred:0.02064010128378868, decouple_loss:0.0009857842233031988
The modified gen p mean: 0.45073530077934265, gen p mean: -0.08068273961544037, mean p set: 0.4513128101825714
loss_pred:0.020658940076828003, decouple_loss:0.0010090917348861694
The modified gen p mean: 0.44903630018234253, gen p mean: -0.0820690467953682, mean p set: 0.4496149718761444
loss_pred:0.020553015172481537, decouple_loss:0.0008853257750160992
Iteration: 1657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511452317237854, gen p mean: -0.13303866982460022, mean p set: 0.4517212510108948
loss_pred:0.020486969500780106, decouple_loss:0.0010664805304259062
The modified gen p mean: 0.4506264925003052, gen p mean: -0.12753671407699585, mean p set: 0.45120492577552795
loss_pred:0.021422769874334335, decouple_loss:0.0010523316450417042
The modified gen p mean: 0.4494786560535431, gen p mean: -0.13585704565048218, mean p set: 0.45005232095718384
loss_pred:0.02114311419427395, decouple_loss:0.001308424980379641
Iteration: 1658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971156120300293, gen p mean: -0.142362579703331, mean p set: 0.45028993487358093
loss_pred:0.02194782719016075, decouple_loss:0.0012982459738850594
The modified gen p mean: 0.4492255449295044, gen p mean: -0.13871829211711884, mean p set: 0.44980117678642273
loss_pred:0.022182775661349297, decouple_loss:0.0011634466936811805
The modified gen p mean: 0.4497238099575043, gen p mean: -0.14022524654865265, mean p set: 0.4503003656864166
loss_pred:0.0219033844769001, decouple_loss:0.00110437732655555
Iteration: 1659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45032820105552673, gen p mean: -0.15563587844371796, mean p set: 0.45090827345848083
loss_pred:0.02330106683075428, decouple_loss:0.0012837827671319246
The modified gen p mean: 0.44907310605049133, gen p mean: -0.15673282742500305, mean p set: 0.4496467411518097
loss_pred:0.02375364676117897, decouple_loss:0.0013593729818239808
The modified gen p mean: 0.4507010579109192, gen p mean: -0.1590697318315506, mean p set: 0.45127591490745544
loss_pred:0.022648507729172707, decouple_loss:0.0013499287888407707
Iteration: 1660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45066171884536743, gen p mean: -0.15130922198295593, mean p set: 0.4512394070625305
The modified gen p mean: 0.45032310485839844, gen p mean: -0.1471015363931656, mean p set: 0.4508983790874481
loss_pred:0.0244099423289299, decouple_loss:0.0018539882730692625
loss_pred:0.022565389052033424, decouple_loss:0.0016072451835498214
The modified gen p mean: 0.44991225004196167, gen p mean: -0.14987914264202118, mean p set: 0.4504863917827606
loss_pred:0.022943228483200073, decouple_loss:0.0016389942029491067
2023-05-01 05:35:51 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.15337254106998444, mean p set: 0.4502691626548767
loss_pred:0.022092800587415695, decouple_loss:0.001389962388202548
The modified gen p mean: 0.44953256845474243, gen p mean: -0.14676930010318756, mean p set: 0.4500633478164673
loss_pred:0.021489692851901054, decouple_loss:0.0014968079049140215
The modified gen p mean: 0.4498272240161896, gen p mean: -0.14578740298748016, mean p set: 0.45035696029663086
loss_pred:0.02174202725291252, decouple_loss:0.0013475524028763175
WV_1_PC_1_EH_0_PS_40, loss: 0.021845413371920586, avg_mse: 0.03126057609915733
current test mse: 0.031261
Iteration: 1661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45171990990638733, gen p mean: -0.1333298236131668, mean p set: 0.45230039954185486
loss_pred:0.021376272663474083, decouple_loss:0.001366621581837535
The modified gen p mean: 0.44921258091926575, gen p mean: -0.131212517619133, mean p set: 0.4497903883457184
loss_pred:0.02104492299258709, decouple_loss:0.001394348801113665
The modified gen p mean: 0.45045655965805054, gen p mean: -0.13222968578338623, mean p set: 0.4510340988636017
loss_pred:0.02152956835925579, decouple_loss:0.0014150033239275217
Iteration: 1662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492921531200409, gen p mean: -0.12957119941711426, mean p set: 0.44986993074417114
loss_pred:0.020904725417494774, decouple_loss:0.001610182924196124
The modified gen p mean: 0.450234979391098, gen p mean: -0.12781678140163422, mean p set: 0.45081210136413574The modified gen p mean: 0.4487288296222687, gen p mean: -0.12926270067691803, mean p set: 0.44930416345596313
loss_pred:0.020584501326084137, decouple_loss:0.0015223539667204022
loss_pred:0.019800661131739616, decouple_loss:0.0015982163604348898
Iteration: 1663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489707052707672, gen p mean: -0.13572026789188385, mean p set: 0.4495491087436676
loss_pred:0.020657772198319435, decouple_loss:0.0013748747296631336
The modified gen p mean: 0.4489762485027313, gen p mean: -0.1336054503917694, mean p set: 0.4495503306388855
loss_pred:0.020281998440623283, decouple_loss:0.0015567559748888016
The modified gen p mean: 0.44902750849723816, gen p mean: -0.1362803727388382, mean p set: 0.44960469007492065
loss_pred:0.021009568125009537, decouple_loss:0.0015926221385598183
Iteration: 1664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505208432674408, gen p mean: -0.13538974523544312, mean p set: 0.4510977864265442
loss_pred:0.019180478528141975, decouple_loss:0.0014899007510393858
The modified gen p mean: 0.4497743546962738, gen p mean: -0.12921632826328278, mean p set: 0.450351357460022
loss_pred:0.019834298640489578, decouple_loss:0.0016748079797253013
The modified gen p mean: 0.45088186860084534, gen p mean: -0.13189797103405, mean p set: 0.45145899057388306
loss_pred:0.020184718072414398, decouple_loss:0.0014655336271971464
Iteration: 1665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501027464866638, gen p mean: -0.11404722929000854, mean p set: 0.4506819546222687
loss_pred:0.018108608201146126, decouple_loss:0.0016682158457115293
The modified gen p mean: 0.45044371485710144, gen p mean: -0.11477818340063095, mean p set: 0.45102033019065857
loss_pred:0.01879984885454178, decouple_loss:0.0013016696320846677
The modified gen p mean: 0.45028215646743774, gen p mean: -0.11104249954223633, mean p set: 0.4508568048477173
loss_pred:0.01918482594192028, decouple_loss:0.0016797588905319571
Iteration: 1666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45003995299339294, gen p mean: -0.10704256594181061, mean p set: 0.45061591267585754
loss_pred:0.01829214207828045, decouple_loss:0.0013875896111130714
The modified gen p mean: 0.45046600699424744, gen p mean: -0.10839922726154327, mean p set: 0.4510418474674225
loss_pred:0.018320782110095024, decouple_loss:0.001471937634050846
The modified gen p mean: 0.45066776871681213, gen p mean: -0.11147069931030273, mean p set: 0.4512425363063812
loss_pred:0.018926136195659637, decouple_loss:0.0015288552967831492
Iteration: 1667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449637770652771, gen p mean: -0.10258066654205322, mean p set: 0.4502144455909729
loss_pred:0.018277211114764214, decouple_loss:0.0014661670429632068
The modified gen p mean: 0.45060884952545166, gen p mean: -0.11011700332164764, mean p set: 0.4511845111846924
The modified gen p mean: 0.45032450556755066, gen p mean: -0.10232364386320114, mean p set: 0.45090147852897644
loss_pred:0.017853552475571632, decouple_loss:0.001674999832175672
loss_pred:0.01917530596256256, decouple_loss:0.0014457450015470386
Iteration: 1668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507930874824524, gen p mean: -0.11381211876869202, mean p set: 0.45136934518814087
loss_pred:0.01790252886712551, decouple_loss:0.0014540759148076177
The modified gen p mean: 0.44980135560035706, gen p mean: -0.1021016389131546, mean p set: 0.45037728548049927
loss_pred:0.018565749749541283, decouple_loss:0.0013156591448932886
The modified gen p mean: 0.4505608081817627, gen p mean: -0.11339134722948074, mean p set: 0.45113804936408997
loss_pred:0.01802234910428524, decouple_loss:0.0013828621013090014
Iteration: 1669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45072194933891296, gen p mean: -0.11385219544172287, mean p set: 0.45129671692848206
loss_pred:0.017577866092324257, decouple_loss:0.0014677703147754073
The modified gen p mean: 0.4499795436859131, gen p mean: -0.11418095976114273, mean p set: 0.4505578577518463
loss_pred:0.018017452210187912, decouple_loss:0.0015076338313519955
The modified gen p mean: 0.449695348739624, gen p mean: -0.11531807482242584, mean p set: 0.4502711296081543
loss_pred:0.01727391965687275, decouple_loss:0.0015676211332902312
Iteration: 1670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977903366088867, gen p mean: -0.11911901086568832, mean p set: 0.4503557085990906
loss_pred:0.018153047189116478, decouple_loss:0.0012839033734053373
The modified gen p mean: 0.4499746859073639, gen p mean: -0.12261048704385757, mean p set: 0.4505513310432434
The modified gen p mean: 0.4502325654029846, gen p mean: -0.12228671461343765, mean p set: 0.45080649852752686
loss_pred:0.017114033922553062, decouple_loss:0.0012430265778675675
loss_pred:0.01773814857006073, decouple_loss:0.0015364076243713498
2023-05-01 05:37:57 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1339510977268219, mean p set: 0.4502691626548767
loss_pred:0.018996698781847954, decouple_loss:0.0014788988046348095
The modified gen p mean: 0.4495333433151245, gen p mean: -0.1272996962070465, mean p set: 0.4500633478164673
loss_pred:0.018362199887633324, decouple_loss:0.0012846057070419192
The modified gen p mean: 0.44982707500457764, gen p mean: -0.12509950995445251, mean p set: 0.45035696029663086
loss_pred:0.018658114597201347, decouple_loss:0.0017015042249113321
WV_1_PC_1_EH_0_PS_40, loss: 0.0187467560172081, avg_mse: 0.02826484851539135
current test mse: 0.028265
Iteration: 1671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45041948556900024, gen p mean: -0.12121281027793884, mean p set: 0.4509945213794708
loss_pred:0.017542202025651932, decouple_loss:0.0012645835522562265
The modified gen p mean: 0.44976845383644104, gen p mean: -0.11982066929340363, mean p set: 0.45034709572792053
loss_pred:0.018637506291270256, decouple_loss:0.0015695553738623857
The modified gen p mean: 0.45055335760116577, gen p mean: -0.12067057937383652, mean p set: 0.4511294364929199
loss_pred:0.018113024532794952, decouple_loss:0.0014798843767493963
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 1672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785553216934204, gen p mean: -0.13282912969589233, mean p set: 0.44843214750289917
loss_pred:0.017277134582400322, decouple_loss:0.0018413239158689976
The modified gen p mean: 0.4474077522754669, gen p mean: -0.12260956317186356, mean p set: 0.44798383116722107The modified gen p mean: 0.4472028613090515, gen p mean: -0.12323541194200516, mean p set: 0.44777724146842957
loss_pred:0.018239503726363182, decouple_loss:0.0012691689189523458
loss_pred:0.01809099316596985, decouple_loss:0.0012448704801499844
Iteration: 1673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471602737903595, gen p mean: -0.10379768908023834, mean p set: 0.44773516058921814
loss_pred:0.018186792731285095, decouple_loss:0.0013237650273367763
The modified gen p mean: 0.44808125495910645, gen p mean: -0.10603764653205872, mean p set: 0.44865697622299194
loss_pred:0.017324723303318024, decouple_loss:0.0016238647513091564
The modified gen p mean: 0.44868189096450806, gen p mean: -0.1064048781991005, mean p set: 0.4492571949958801
loss_pred:0.016726244240999222, decouple_loss:0.0012057751882821321
Iteration: 1674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701865315437317, gen p mean: -0.09302175790071487, mean p set: 0.44759488105773926
loss_pred:0.018825190141797066, decouple_loss:0.001228243694640696
The modified gen p mean: 0.4472682476043701, gen p mean: -0.09425608068704605, mean p set: 0.44784268736839294
loss_pred:0.019184311851859093, decouple_loss:0.0012130034156143665
The modified gen p mean: 0.4483336806297302, gen p mean: -0.09749063104391098, mean p set: 0.4489099383354187
loss_pred:0.017461344599723816, decouple_loss:0.0014371752040460706
Iteration: 1675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763585925102234, gen p mean: -0.11601906269788742, mean p set: 0.4482114315032959
loss_pred:0.018016524612903595, decouple_loss:0.0011443300172686577
The modified gen p mean: 0.44840386509895325, gen p mean: -0.11983901262283325, mean p set: 0.4489799737930298
loss_pred:0.018882377073168755, decouple_loss:0.001135988044552505
The modified gen p mean: 0.447984904050827, gen p mean: -0.11023057252168655, mean p set: 0.44856035709381104
loss_pred:0.017769360914826393, decouple_loss:0.0011488208547234535
Iteration: 1676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489293694496155, gen p mean: -0.12342791259288788, mean p set: 0.4495067000389099
loss_pred:0.016195140779018402, decouple_loss:0.0012175709707662463
The modified gen p mean: 0.44726401567459106, gen p mean: -0.12030840665102005, mean p set: 0.44784215092658997
The modified gen p mean: 0.4469941556453705, gen p mean: -0.129865825176239, mean p set: 0.4475710391998291
loss_pred:0.017380958423018456, decouple_loss:0.0013554883189499378
loss_pred:0.017208542674779892, decouple_loss:0.001204120577313006
Iteration: 1677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714221358299255, gen p mean: -0.11804176867008209, mean p set: 0.44771671295166016
loss_pred:0.018105052411556244, decouple_loss:0.0013910256093367934
The modified gen p mean: 0.4484041929244995, gen p mean: -0.12373454868793488, mean p set: 0.4489794969558716
The modified gen p mean: 0.44822582602500916, gen p mean: -0.1254192441701889, mean p set: 0.4488038718700409
loss_pred:0.017497628927230835, decouple_loss:0.0016370693920180202
loss_pred:0.016869788989424706, decouple_loss:0.0013056382304057479
Iteration: 1678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44805219769477844, gen p mean: -0.11788582801818848, mean p set: 0.4486263692378998
loss_pred:0.017679516226053238, decouple_loss:0.0009991804836317897
The modified gen p mean: 0.44922205805778503, gen p mean: -0.11569970101118088, mean p set: 0.4497953951358795
The modified gen p mean: 0.4473586082458496, gen p mean: -0.11435754597187042, mean p set: 0.44793590903282166
loss_pred:0.016986627131700516, decouple_loss:0.0010918467305600643
loss_pred:0.017266128212213516, decouple_loss:0.0010314962128177285
Iteration: 1679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480282664299011, gen p mean: -0.11677148938179016, mean p set: 0.44860297441482544
loss_pred:0.01638515293598175, decouple_loss:0.0011601106962189078
The modified gen p mean: 0.4473567605018616, gen p mean: -0.11361095309257507, mean p set: 0.4479329288005829
loss_pred:0.016265906393527985, decouple_loss:0.0012063448084518313
The modified gen p mean: 0.4472160041332245, gen p mean: -0.106313556432724, mean p set: 0.4477945566177368
loss_pred:0.016935214400291443, decouple_loss:0.0012927480274811387
Iteration: 1680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812920689582825, gen p mean: -0.10778280347585678, mean p set: 0.4487045109272003
loss_pred:0.0164573322981596, decouple_loss:0.0011791882570832968
The modified gen p mean: 0.4472040832042694, gen p mean: -0.10489091277122498, mean p set: 0.4477807283401489
The modified gen p mean: 0.44793105125427246, gen p mean: -0.11028964817523956, mean p set: 0.4485073983669281
loss_pred:0.017099415883421898, decouple_loss:0.0011183524038642645
loss_pred:0.016350578516721725, decouple_loss:0.0012163885403424501
2023-05-01 05:40:44 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10419855266809464, mean p set: 0.4502691626548767
loss_pred:0.018770938739180565, decouple_loss:0.001115412567742169
The modified gen p mean: 0.44953498244285583, gen p mean: -0.0983126163482666, mean p set: 0.4500633478164673
loss_pred:0.01819397509098053, decouple_loss:0.001119922730140388
The modified gen p mean: 0.4498305022716522, gen p mean: -0.0971430316567421, mean p set: 0.45035696029663086
loss_pred:0.01845235377550125, decouple_loss:0.0011540099512785673
WV_1_PC_1_EH_0_PS_40, loss: 0.01852891407907009, avg_mse: 0.028032777830958366
current test mse: 0.028033
Iteration: 1681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44651633501052856, gen p mean: -0.10407572984695435, mean p set: 0.4470933675765991
loss_pred:0.0167289637029171, decouple_loss:0.0011166570475324988
The modified gen p mean: 0.44742193818092346, gen p mean: -0.09967231750488281, mean p set: 0.4479990005493164
loss_pred:0.01622892916202545, decouple_loss:0.001082988572306931
The modified gen p mean: 0.4486348032951355, gen p mean: -0.10147953033447266, mean p set: 0.44921019673347473
loss_pred:0.016574149951338768, decouple_loss:0.0011301632039248943
Iteration: 1682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485582709312439, gen p mean: -0.10245107114315033, mean p set: 0.449133038520813
loss_pred:0.0165757704526186, decouple_loss:0.0012379082618281245
The modified gen p mean: 0.4475541114807129, gen p mean: -0.10025665163993835, mean p set: 0.44812890887260437The modified gen p mean: 0.44786208868026733, gen p mean: -0.09836532175540924, mean p set: 0.4484385848045349
loss_pred:0.016488008201122284, decouple_loss:0.0016737442929297686
loss_pred:0.015906676650047302, decouple_loss:0.0015583268832415342
Iteration: 1683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483634829521179, gen p mean: -0.11043914407491684, mean p set: 0.44894084334373474
loss_pred:0.01606178656220436, decouple_loss:0.0011159204877912998
The modified gen p mean: 0.4480594992637634, gen p mean: -0.1058032214641571, mean p set: 0.4486351013183594
loss_pred:0.01574883610010147, decouple_loss:0.0009835645323619246
The modified gen p mean: 0.44737449288368225, gen p mean: -0.1033160611987114, mean p set: 0.4479498863220215
loss_pred:0.015741972252726555, decouple_loss:0.0010759788565337658
Iteration: 1684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482521116733551, gen p mean: -0.10710133612155914, mean p set: 0.4488280117511749
loss_pred:0.01621934585273266, decouple_loss:0.0009579239995218813
The modified gen p mean: 0.4484761655330658, gen p mean: -0.10475580394268036, mean p set: 0.44905373454093933
loss_pred:0.01645134948194027, decouple_loss:0.001136653358116746
The modified gen p mean: 0.4471757709980011, gen p mean: -0.10002495348453522, mean p set: 0.4477514326572418
loss_pred:0.01682179607450962, decouple_loss:0.0010400541359558702
Iteration: 1685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752487540245056, gen p mean: -0.10968330502510071, mean p set: 0.4481014907360077
loss_pred:0.015815183520317078, decouple_loss:0.0010087572736665606
The modified gen p mean: 0.4489649832248688, gen p mean: -0.10920015722513199, mean p set: 0.4495420455932617
loss_pred:0.015348020941019058, decouple_loss:0.0010917343897745013
The modified gen p mean: 0.4482822120189667, gen p mean: -0.1044171154499054, mean p set: 0.4488582909107208
loss_pred:0.01625574193894863, decouple_loss:0.0010285034077242017
Iteration: 1686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44850146770477295, gen p mean: -0.10525236278772354, mean p set: 0.4490780532360077
loss_pred:0.01559156272560358, decouple_loss:0.0011586095206439495
The modified gen p mean: 0.44928988814353943, gen p mean: -0.10643289238214493, mean p set: 0.4498658776283264
The modified gen p mean: 0.44767695665359497, gen p mean: -0.10742368549108505, mean p set: 0.4482528567314148
loss_pred:0.01581881195306778, decouple_loss:0.0010448048124089837
loss_pred:0.015303037129342556, decouple_loss:0.0012527845101431012
Iteration: 1687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474602937698364, gen p mean: -0.10278642922639847, mean p set: 0.44803711771965027
loss_pred:0.016580669209361076, decouple_loss:0.0009315956849604845
The modified gen p mean: 0.4480281472206116, gen p mean: -0.10106915980577469, mean p set: 0.4486044645309448
The modified gen p mean: 0.44829219579696655, gen p mean: -0.11484626680612564, mean p set: 0.4488692879676819
loss_pred:0.015216181986033916, decouple_loss:0.000961493409704417
loss_pred:0.016058653593063354, decouple_loss:0.0011205854825675488
Iteration: 1688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475851058959961, gen p mean: -0.09840995073318481, mean p set: 0.44816192984580994
The modified gen p mean: 0.4475424587726593, gen p mean: -0.10209868848323822, mean p set: 0.44811877608299255
loss_pred:0.015159106813371181, decouple_loss:0.0009451905498281121
loss_pred:0.015312162227928638, decouple_loss:0.0009529806557111442
The modified gen p mean: 0.44828328490257263, gen p mean: -0.09725574404001236, mean p set: 0.4488586187362671
loss_pred:0.015458264388144016, decouple_loss:0.000883882341440767
Iteration: 1689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793084263801575, gen p mean: -0.09846669435501099, mean p set: 0.4485081434249878
The modified gen p mean: 0.4470575749874115, gen p mean: -0.09648413956165314, mean p set: 0.44763508439064026
loss_pred:0.015921268612146378, decouple_loss:0.0010178119409829378
loss_pred:0.015217006206512451, decouple_loss:0.0009410669445060194
The modified gen p mean: 0.4476829767227173, gen p mean: -0.09652497619390488, mean p set: 0.44825834035873413
loss_pred:0.015601761639118195, decouple_loss:0.0010196077637374401
Iteration: 1690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683724641799927, gen p mean: -0.08518227934837341, mean p set: 0.4474125802516937
loss_pred:0.015247618779540062, decouple_loss:0.0009129908867180347
The modified gen p mean: 0.44719263911247253, gen p mean: -0.09118077158927917, mean p set: 0.44776979088783264
The modified gen p mean: 0.44841963052749634, gen p mean: -0.08460173010826111, mean p set: 0.4489966928958893
loss_pred:0.015098619274795055, decouple_loss:0.0008194170659407973
loss_pred:0.015650710090994835, decouple_loss:0.0010162537219002843
2023-05-01 05:42:49 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.0935712605714798, mean p set: 0.4502691626548767
loss_pred:0.01785702258348465, decouple_loss:0.0009191034478135407
The modified gen p mean: 0.4495362341403961, gen p mean: -0.08798494189977646, mean p set: 0.4500633478164673
The modified gen p mean: 0.44982782006263733, gen p mean: -0.08693432807922363, mean p set: 0.45035696029663086
loss_pred:0.017275860533118248, decouple_loss:0.0009766087168827653
loss_pred:0.017568986862897873, decouple_loss:0.0009828361216932535
WV_1_PC_1_EH_0_PS_40, loss: 0.017615266144275665, avg_mse: 0.02711772918701172
current test mse: 0.027118
Iteration: 1691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801148772239685, gen p mean: -0.09304838627576828, mean p set: 0.4485870599746704
loss_pred:0.01492775697261095, decouple_loss:0.0009974902495741844
The modified gen p mean: 0.4482792615890503, gen p mean: -0.08632012456655502, mean p set: 0.4488556683063507The modified gen p mean: 0.44786497950553894, gen p mean: -0.09756417572498322, mean p set: 0.44844159483909607
loss_pred:0.01588999480009079, decouple_loss:0.0009956419235095382loss_pred:0.014872428961098194, decouple_loss:0.0009429994970560074
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 1692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701895117759705, gen p mean: -0.09641169011592865, mean p set: 0.44759440422058105
loss_pred:0.015373921021819115, decouple_loss:0.001101909321732819
The modified gen p mean: 0.4485732913017273, gen p mean: -0.09524408727884293, mean p set: 0.4491487443447113The modified gen p mean: 0.4484778940677643, gen p mean: -0.09560632705688477, mean p set: 0.4490576982498169
loss_pred:0.015239854343235493, decouple_loss:0.0010337458224967122
loss_pred:0.014793101698160172, decouple_loss:0.0011063945712521672
Iteration: 1693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447944313287735, gen p mean: -0.09845425188541412, mean p set: 0.4485197067260742
loss_pred:0.015282908454537392, decouple_loss:0.001013360801152885
The modified gen p mean: 0.44680482149124146, gen p mean: -0.09772607684135437, mean p set: 0.4473787844181061
loss_pred:0.015660645440220833, decouple_loss:0.0009882390731945634
The modified gen p mean: 0.44799068570137024, gen p mean: -0.1008547991514206, mean p set: 0.4485662877559662
loss_pred:0.015455175191164017, decouple_loss:0.0012248955899849534
Iteration: 1694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470502734184265, gen p mean: -0.1061643734574318, mean p set: 0.44762441515922546
loss_pred:0.015461739152669907, decouple_loss:0.0009969323873519897
The modified gen p mean: 0.4481674134731293, gen p mean: -0.11134493350982666, mean p set: 0.4487426280975342
loss_pred:0.015827232971787453, decouple_loss:0.001171999261714518
The modified gen p mean: 0.44742175936698914, gen p mean: -0.1068326011300087, mean p set: 0.4479982852935791
loss_pred:0.014985746704041958, decouple_loss:0.0011341533390805125
Iteration: 1695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839245080947876, gen p mean: -0.09580571204423904, mean p set: 0.44896969199180603
loss_pred:0.015544755384325981, decouple_loss:0.000993498950265348
The modified gen p mean: 0.447262704372406, gen p mean: -0.09684982150793076, mean p set: 0.4478378891944885
loss_pred:0.015165401622653008, decouple_loss:0.0010073172161355615
The modified gen p mean: 0.44803372025489807, gen p mean: -0.09648993611335754, mean p set: 0.44860947132110596
loss_pred:0.01532337162643671, decouple_loss:0.0009978089947253466
Iteration: 1696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483073651790619, gen p mean: -0.09250660985708237, mean p set: 0.44888588786125183
loss_pred:0.01516801118850708, decouple_loss:0.0009552945266477764
The modified gen p mean: 0.44718149304389954, gen p mean: -0.09367209672927856, mean p set: 0.4477570950984955
loss_pred:0.015551958233118057, decouple_loss:0.0008890168974176049
The modified gen p mean: 0.4480293095111847, gen p mean: -0.09752919524908066, mean p set: 0.4486024081707001
loss_pred:0.015788547694683075, decouple_loss:0.0008799171773716807
Iteration: 1697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447124719619751, gen p mean: -0.10631208121776581, mean p set: 0.4477013349533081
loss_pred:0.01590103469789028, decouple_loss:0.000860254920553416
The modified gen p mean: 0.44706135988235474, gen p mean: -0.1002684012055397, mean p set: 0.4476398825645447
The modified gen p mean: 0.44684505462646484, gen p mean: -0.09646548330783844, mean p set: 0.447422593832016
loss_pred:0.015619608573615551, decouple_loss:0.0010469600092619658
loss_pred:0.015425155870616436, decouple_loss:0.0010600844398140907
Iteration: 1698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476143717765808, gen p mean: -0.11114666610956192, mean p set: 0.4481918513774872
loss_pred:0.015225722454488277, decouple_loss:0.0008989211055450141
The modified gen p mean: 0.4476601481437683, gen p mean: -0.11530914157629013, mean p set: 0.4482389986515045
loss_pred:0.01533032301813364, decouple_loss:0.0008534775115549564
The modified gen p mean: 0.44708555936813354, gen p mean: -0.1096842810511589, mean p set: 0.4476620554924011
loss_pred:0.0158216655254364, decouple_loss:0.0008539712289348245
Iteration: 1699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483342170715332, gen p mean: -0.10618989914655685, mean p set: 0.448910653591156
loss_pred:0.014787350781261921, decouple_loss:0.0009403881849721074
The modified gen p mean: 0.4481143355369568, gen p mean: -0.1040075346827507, mean p set: 0.44869139790534973
The modified gen p mean: 0.4475041329860687, gen p mean: -0.10548719763755798, mean p set: 0.448081910610199
loss_pred:0.015097316354513168, decouple_loss:0.0010312574449926615
loss_pred:0.016064070165157318, decouple_loss:0.0008954446529969573
Iteration: 1700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490835666656494, gen p mean: -0.09747679531574249, mean p set: 0.44966015219688416
loss_pred:0.014557478949427605, decouple_loss:0.0009461659356020391
The modified gen p mean: 0.4486759603023529, gen p mean: -0.10090156644582748, mean p set: 0.44924864172935486
loss_pred:0.01470533199608326, decouple_loss:0.0009213867015205324
The modified gen p mean: 0.44676145911216736, gen p mean: -0.10323795676231384, mean p set: 0.4473388195037842
loss_pred:0.015316463075578213, decouple_loss:0.0009749289602041245
2023-05-01 05:45:36 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10263017565011978, mean p set: 0.4502691626548767
loss_pred:0.01765994355082512, decouple_loss:0.0009918648283928633
The modified gen p mean: 0.44953709840774536, gen p mean: -0.09712006151676178, mean p set: 0.4500633478164673
loss_pred:0.017173826694488525, decouple_loss:0.0009738216176629066
The modified gen p mean: 0.44982582330703735, gen p mean: -0.09618927538394928, mean p set: 0.45035696029663086
loss_pred:0.01756381429731846, decouple_loss:0.0008423473918810487
WV_1_PC_1_EH_0_PS_40, loss: 0.017512662336230278, avg_mse: 0.027017271146178246
current test mse: 0.027017
Iteration: 1701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473731517791748, gen p mean: -0.09837742894887924, mean p set: 0.44794946908950806
loss_pred:0.015120320953428745, decouple_loss:0.0009195277816615999
The modified gen p mean: 0.4473158121109009, gen p mean: -0.1021861582994461, mean p set: 0.44789108633995056The modified gen p mean: 0.44754138588905334, gen p mean: -0.10163454711437225, mean p set: 0.4481172263622284
loss_pred:0.01594078540802002, decouple_loss:0.0008301698253490031
loss_pred:0.01572500355541706, decouple_loss:0.0010639620013535023
Iteration: 1702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480303227901459, gen p mean: -0.0954478532075882, mean p set: 0.4486064314842224
loss_pred:0.014892715960741043, decouple_loss:0.0009649887797422707
The modified gen p mean: 0.4470125436782837, gen p mean: -0.10301212966442108, mean p set: 0.44758692383766174The modified gen p mean: 0.446475625038147, gen p mean: -0.0920131728053093, mean p set: 0.4470519721508026
loss_pred:0.01623375527560711, decouple_loss:0.0008369260467588902
loss_pred:0.015437990427017212, decouple_loss:0.0008007878204807639
Iteration: 1703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474264979362488, gen p mean: -0.08378854393959045, mean p set: 0.44800183176994324
The modified gen p mean: 0.4478681683540344, gen p mean: -0.08359170705080032, mean p set: 0.448443204164505
The modified gen p mean: 0.44635647535324097, gen p mean: -0.0863896906375885, mean p set: 0.4469318985939026loss_pred:0.015422803349792957, decouple_loss:0.0008899508975446224
loss_pred:0.016361959278583527, decouple_loss:0.0008546215249225497loss_pred:0.015036482363939285, decouple_loss:0.0013754040701314807
Iteration: 1704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479103684425354, gen p mean: -0.08655695617198944, mean p set: 0.448486864566803
loss_pred:0.015219135209918022, decouple_loss:0.0008096066885627806
The modified gen p mean: 0.44875016808509827, gen p mean: -0.08830576390028, mean p set: 0.449325829744339
loss_pred:0.014206966385245323, decouple_loss:0.0010069943964481354
The modified gen p mean: 0.4468028247356415, gen p mean: -0.09172997623682022, mean p set: 0.44737890362739563
loss_pred:0.015471936203539371, decouple_loss:0.0009031250956468284
Iteration: 1705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795453548431396, gen p mean: -0.10456913709640503, mean p set: 0.44853144884109497
The modified gen p mean: 0.44808459281921387, gen p mean: -0.0967903807759285, mean p set: 0.44866064190864563
loss_pred:0.01523121539503336, decouple_loss:0.000858421204611659
loss_pred:0.015267482958734035, decouple_loss:0.0009183110669255257
The modified gen p mean: 0.4477267265319824, gen p mean: -0.09706194698810577, mean p set: 0.44830334186553955
loss_pred:0.015597489662468433, decouple_loss:0.0008617645362392068
Iteration: 1706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690102338790894, gen p mean: -0.09950622171163559, mean p set: 0.4474763870239258
loss_pred:0.0154869444668293, decouple_loss:0.0013361943420022726
The modified gen p mean: 0.44712719321250916, gen p mean: -0.10274641215801239, mean p set: 0.44770386815071106
loss_pred:0.015403389930725098, decouple_loss:0.0010885765077546239
The modified gen p mean: 0.44742658734321594, gen p mean: -0.10540278255939484, mean p set: 0.44800394773483276
loss_pred:0.015315674245357513, decouple_loss:0.0011409715516492724
Iteration: 1707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471280574798584, gen p mean: -0.10411036759614944, mean p set: 0.4477039873600006
The modified gen p mean: 0.4488362967967987, gen p mean: -0.09920083731412888, mean p set: 0.44941452145576477
loss_pred:0.014584390446543694, decouple_loss:0.0007583596743643284
loss_pred:0.01500503160059452, decouple_loss:0.0007850322872400284
The modified gen p mean: 0.44725555181503296, gen p mean: -0.10446047782897949, mean p set: 0.44783034920692444
loss_pred:0.015171927399933338, decouple_loss:0.0007591879111714661
Iteration: 1708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477289617061615, gen p mean: -0.10406568646430969, mean p set: 0.448304146528244
loss_pred:0.015111993066966534, decouple_loss:0.0009982561459764838
The modified gen p mean: 0.44713136553764343, gen p mean: -0.10136650502681732, mean p set: 0.4477090537548065
The modified gen p mean: 0.4477280378341675, gen p mean: -0.09954825788736343, mean p set: 0.44830429553985596
loss_pred:0.01482649240642786, decouple_loss:0.0009048695210367441
loss_pred:0.01475160289555788, decouple_loss:0.000786657736171037
Iteration: 1709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448395311832428, gen p mean: -0.09917555004358292, mean p set: 0.44897186756134033
loss_pred:0.014780879952013493, decouple_loss:0.001134431455284357
The modified gen p mean: 0.4465523362159729, gen p mean: -0.10814720392227173, mean p set: 0.4471273422241211
The modified gen p mean: 0.4478132128715515, gen p mean: -0.10588496178388596, mean p set: 0.4483886957168579
loss_pred:0.01570509932935238, decouple_loss:0.0007196670048870146
loss_pred:0.015085387043654919, decouple_loss:0.0009385787998326123
Iteration: 1710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710850715637207, gen p mean: -0.09772414714097977, mean p set: 0.44768473505973816
loss_pred:0.015247488394379616, decouple_loss:0.0008052962366491556
The modified gen p mean: 0.4470743238925934, gen p mean: -0.10307219624519348, mean p set: 0.4476523995399475
loss_pred:0.01534485723823309, decouple_loss:0.000999382697045803
The modified gen p mean: 0.4466363191604614, gen p mean: -0.09806005656719208, mean p set: 0.4472118318080902
loss_pred:0.014882015995681286, decouple_loss:0.0007264785235747695
2023-05-01 05:47:41 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10033494234085083, mean p set: 0.4502691626548767
loss_pred:0.017523905262351036, decouple_loss:0.0010608533630147576
The modified gen p mean: 0.449535071849823, gen p mean: -0.09425769001245499, mean p set: 0.4500633478164673
loss_pred:0.01686200499534607, decouple_loss:0.0011487139854580164
The modified gen p mean: 0.4498283267021179, gen p mean: -0.0938812717795372, mean p set: 0.45035696029663086
loss_pred:0.017207851633429527, decouple_loss:0.0009197884355671704
WV_1_PC_1_EH_0_PS_40, loss: 0.017250075936317444, avg_mse: 0.026684317737817764
current test mse: 0.026684
Iteration: 1711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476815164089203, gen p mean: -0.09475038200616837, mean p set: 0.4482576549053192
loss_pred:0.015223468653857708, decouple_loss:0.001009250758215785
The modified gen p mean: 0.44822999835014343, gen p mean: -0.101061150431633, mean p set: 0.44880568981170654The modified gen p mean: 0.44657430052757263, gen p mean: -0.09291968494653702, mean p set: 0.4471501410007477
loss_pred:0.015067266300320625, decouple_loss:0.0009153155260719359
loss_pred:0.015410050749778748, decouple_loss:0.0009208874544128776
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 1712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483747184276581, gen p mean: -0.0934552401304245, mean p set: 0.4489506781101227
loss_pred:0.016461975872516632, decouple_loss:0.0007883054786361754
The modified gen p mean: 0.4455733001232147, gen p mean: -0.09681735932826996, mean p set: 0.4461473524570465The modified gen p mean: 0.4473743438720703, gen p mean: -0.09000422060489655, mean p set: 0.4479483664035797
loss_pred:0.01672842912375927, decouple_loss:0.0008603549795225263loss_pred:0.015786753967404366, decouple_loss:0.0007525777909904718
Iteration: 1713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808730483055115, gen p mean: -0.09445272386074066, mean p set: 0.4486646354198456
loss_pred:0.015935126692056656, decouple_loss:0.0007284229504875839
The modified gen p mean: 0.44760480523109436, gen p mean: -0.09507710486650467, mean p set: 0.448184072971344The modified gen p mean: 0.44848012924194336, gen p mean: -0.09460996836423874, mean p set: 0.4490565061569214
loss_pred:0.01639256626367569, decouple_loss:0.0008336125174537301loss_pred:0.01588963344693184, decouple_loss:0.0008494297508150339
Iteration: 1714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470059275627136, gen p mean: -0.09295608103275299, mean p set: 0.4475817382335663
loss_pred:0.016334470361471176, decouple_loss:0.0005879891687072814
The modified gen p mean: 0.44829368591308594, gen p mean: -0.09124605357646942, mean p set: 0.4488692581653595
loss_pred:0.016087299212813377, decouple_loss:0.0006859837449155748
The modified gen p mean: 0.44714847207069397, gen p mean: -0.0934312492609024, mean p set: 0.4477252662181854
loss_pred:0.016593925654888153, decouple_loss:0.0008024010458029807
Iteration: 1715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470891058444977, gen p mean: -0.09554757177829742, mean p set: 0.4476655125617981
loss_pred:0.015197748318314552, decouple_loss:0.0008245165226981044
The modified gen p mean: 0.44886088371276855, gen p mean: -0.0959121361374855, mean p set: 0.4494354724884033
loss_pred:0.015852630138397217, decouple_loss:0.000605691981036216
The modified gen p mean: 0.44587668776512146, gen p mean: -0.1037721112370491, mean p set: 0.44645223021507263
loss_pred:0.016205213963985443, decouple_loss:0.0010951687581837177
Iteration: 1716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473174512386322, gen p mean: -0.10048940777778625, mean p set: 0.4478928744792938
loss_pred:0.015495271421968937, decouple_loss:0.0007637745002284646
The modified gen p mean: 0.44845929741859436, gen p mean: -0.09730538725852966, mean p set: 0.4490351974964142
loss_pred:0.015462024137377739, decouple_loss:0.0006826174794696271
The modified gen p mean: 0.4478928744792938, gen p mean: -0.09921366721391678, mean p set: 0.448468953371048
loss_pred:0.016245484352111816, decouple_loss:0.0008095772354863584
Iteration: 1717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742530584335327, gen p mean: -0.09786360710859299, mean p set: 0.4480014741420746
loss_pred:0.015706179663538933, decouple_loss:0.0006519409944303334
The modified gen p mean: 0.4487309753894806, gen p mean: -0.09162222594022751, mean p set: 0.44930681586265564
loss_pred:0.016292165964841843, decouple_loss:0.0008072496275417507
The modified gen p mean: 0.4482623040676117, gen p mean: -0.09643491357564926, mean p set: 0.4488369822502136
loss_pred:0.015905052423477173, decouple_loss:0.0006252824096009135
Iteration: 1718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478659927845001, gen p mean: -0.09544507414102554, mean p set: 0.44844329357147217
loss_pred:0.0166043508797884, decouple_loss:0.0008078595856204629
The modified gen p mean: 0.4485112130641937, gen p mean: -0.0949225127696991, mean p set: 0.44908660650253296
The modified gen p mean: 0.4481094479560852, gen p mean: -0.09228847175836563, mean p set: 0.4486868679523468
loss_pred:0.016084419563412666, decouple_loss:0.001000518910586834
loss_pred:0.015585190616548061, decouple_loss:0.0008588173077441752
Iteration: 1719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462640881538391, gen p mean: -0.08979694545269012, mean p set: 0.4468391239643097
The modified gen p mean: 0.44586387276649475, gen p mean: -0.09126650542020798, mean p set: 0.4464397132396698
loss_pred:0.01613180711865425, decouple_loss:0.0007621980039402843
loss_pred:0.016230612993240356, decouple_loss:0.0007518613710999489
The modified gen p mean: 0.4463176429271698, gen p mean: -0.09419747442007065, mean p set: 0.44689464569091797
loss_pred:0.016207300126552582, decouple_loss:0.0008717508753761649
Iteration: 1720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892796874046326, gen p mean: -0.08584511280059814, mean p set: 0.4495036005973816
loss_pred:0.016270050778985023, decouple_loss:0.0007412932463921607
The modified gen p mean: 0.44864046573638916, gen p mean: -0.08611788600683212, mean p set: 0.4492167532444
loss_pred:0.01641005650162697, decouple_loss:0.000706273945979774
The modified gen p mean: 0.44909828901290894, gen p mean: -0.08464280515909195, mean p set: 0.44967639446258545
loss_pred:0.015604523941874504, decouple_loss:0.0008277652086690068
2023-05-01 05:50:28 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.09766077995300293, mean p set: 0.4502691626548767
loss_pred:0.017495080828666687, decouple_loss:0.0006704255938529968
The modified gen p mean: 0.44953393936157227, gen p mean: -0.09213871508836746, mean p set: 0.4500633478164673
loss_pred:0.01672508753836155, decouple_loss:0.000730685715097934
The modified gen p mean: 0.449828565120697, gen p mean: -0.09197269380092621, mean p set: 0.45035696029663086
loss_pred:0.017101142555475235, decouple_loss:0.000677949923556298
WV_1_PC_1_EH_0_PS_40, loss: 0.017141755670309067, avg_mse: 0.026562625542283058
current test mse: 0.026563
Iteration: 1721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481624960899353, gen p mean: -0.08396048098802567, mean p set: 0.4487389624118805
loss_pred:0.0160877276211977, decouple_loss:0.000695380091201514
The modified gen p mean: 0.4475260078907013, gen p mean: -0.09250004589557648, mean p set: 0.4481014013290405The modified gen p mean: 0.44706717133522034, gen p mean: -0.09138361364603043, mean p set: 0.44764459133148193
loss_pred:0.016521183773875237, decouple_loss:0.0009122809278778732loss_pred:0.015403995290398598, decouple_loss:0.0007558860816061497
Iteration: 1722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476560652256012, gen p mean: -0.09662901610136032, mean p set: 0.4482314884662628
loss_pred:0.015820465981960297, decouple_loss:0.0007067369297146797
The modified gen p mean: 0.4470682442188263, gen p mean: -0.09034520387649536, mean p set: 0.44764280319213867The modified gen p mean: 0.4476964473724365, gen p mean: -0.09176541119813919, mean p set: 0.44827160239219666
loss_pred:0.015934716910123825, decouple_loss:0.0008193504763767123loss_pred:0.01659027859568596, decouple_loss:0.0006937536527402699
Iteration: 1723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470560550689697, gen p mean: -0.09676171094179153, mean p set: 0.4476326107978821
loss_pred:0.015514886006712914, decouple_loss:0.0007254468509927392
The modified gen p mean: 0.44719618558883667, gen p mean: -0.09844376891851425, mean p set: 0.44777119159698486
loss_pred:0.016193408519029617, decouple_loss:0.0007212531054392457
The modified gen p mean: 0.4458785057067871, gen p mean: -0.09808236360549927, mean p set: 0.44645413756370544
loss_pred:0.015564552508294582, decouple_loss:0.0008273478015325963
Iteration: 1724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736358523368835, gen p mean: -0.09730309993028641, mean p set: 0.4479406476020813
loss_pred:0.015630552545189857, decouple_loss:0.0006751613109372556
The modified gen p mean: 0.4483434855937958, gen p mean: -0.09767041355371475, mean p set: 0.448919415473938
loss_pred:0.016005121171474457, decouple_loss:0.000686244573444128
The modified gen p mean: 0.44812309741973877, gen p mean: -0.10055536776781082, mean p set: 0.44869908690452576
loss_pred:0.015769990161061287, decouple_loss:0.000979535630904138
Iteration: 1725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836655259132385, gen p mean: -0.09902969747781754, mean p set: 0.4489421248435974
loss_pred:0.01555655337870121, decouple_loss:0.0006727210129611194
The modified gen p mean: 0.4476925730705261, gen p mean: -0.10049515217542648, mean p set: 0.44826918840408325
loss_pred:0.01572640798985958, decouple_loss:0.0006227633566595614
The modified gen p mean: 0.4481823444366455, gen p mean: -0.0953899547457695, mean p set: 0.4487598240375519
loss_pred:0.015880122780799866, decouple_loss:0.000695448718033731
Iteration: 1726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44621166586875916, gen p mean: -0.10033708810806274, mean p set: 0.4467865526676178
loss_pred:0.016255471855401993, decouple_loss:0.0007737973937764764
The modified gen p mean: 0.44737160205841064, gen p mean: -0.09745407104492188, mean p set: 0.44794782996177673
loss_pred:0.01635962538421154, decouple_loss:0.0007900592172518373
The modified gen p mean: 0.44526588916778564, gen p mean: -0.1014532819390297, mean p set: 0.44584187865257263
loss_pred:0.016154902055859566, decouple_loss:0.0006023041787557304
Iteration: 1727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746479392051697, gen p mean: -0.09026629477739334, mean p set: 0.4480399191379547
loss_pred:0.015127886086702347, decouple_loss:0.0008072291384451091
The modified gen p mean: 0.4468010663986206, gen p mean: -0.09458500146865845, mean p set: 0.4473777115345001
loss_pred:0.016608834266662598, decouple_loss:0.0006995876901783049
The modified gen p mean: 0.44894224405288696, gen p mean: -0.09569427371025085, mean p set: 0.44951605796813965
loss_pred:0.01542892400175333, decouple_loss:0.0008350578718818724
Iteration: 1728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483208656311035, gen p mean: -0.09584379941225052, mean p set: 0.44889581203460693
loss_pred:0.01607242226600647, decouple_loss:0.0009380605770274997
The modified gen p mean: 0.44793620705604553, gen p mean: -0.09210414439439774, mean p set: 0.4485113322734833
loss_pred:0.015122497454285622, decouple_loss:0.0008022661786526442
The modified gen p mean: 0.4472271502017975, gen p mean: -0.09114518761634827, mean p set: 0.44780370593070984
loss_pred:0.01629205234348774, decouple_loss:0.0006441327277570963
Iteration: 1729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809025526046753, gen p mean: -0.09502258151769638, mean p set: 0.4486686885356903
loss_pred:0.016177529469132423, decouple_loss:0.0007543902611359954
The modified gen p mean: 0.4479324519634247, gen p mean: -0.0934666320681572, mean p set: 0.44850867986679077
loss_pred:0.015510507859289646, decouple_loss:0.0007732570520602167
The modified gen p mean: 0.4474681615829468, gen p mean: -0.09596149623394012, mean p set: 0.4480428397655487
loss_pred:0.014832057058811188, decouple_loss:0.0007195567595772445
Iteration: 1730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471038281917572, gen p mean: -0.09894685447216034, mean p set: 0.44767823815345764
loss_pred:0.015676848590373993, decouple_loss:0.0007840491598471999
The modified gen p mean: 0.4488654136657715, gen p mean: -0.089303158223629, mean p set: 0.44944167137145996
loss_pred:0.01555682998150587, decouple_loss:0.00105880422051996
The modified gen p mean: 0.4475450813770294, gen p mean: -0.09886812418699265, mean p set: 0.44812238216400146
loss_pred:0.015998322516679764, decouple_loss:0.0008335557067766786
2023-05-01 05:52:35 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1035756841301918, mean p set: 0.4502691626548767
loss_pred:0.017431272193789482, decouple_loss:0.0006869560456834733
The modified gen p mean: 0.44953471422195435, gen p mean: -0.09817774593830109, mean p set: 0.4500633478164673
loss_pred:0.01671254076063633, decouple_loss:0.0007656127563677728
The modified gen p mean: 0.44982877373695374, gen p mean: -0.09799590706825256, mean p set: 0.45035696029663086
loss_pred:0.01707463711500168, decouple_loss:0.0007284489693120122
WV_1_PC_1_EH_0_PS_40, loss: 0.017109166830778122, avg_mse: 0.026544835418462753
current test mse: 0.026545
Iteration: 1731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44927430152893066, gen p mean: -0.09721529483795166, mean p set: 0.44985130429267883
loss_pred:0.015507182106375694, decouple_loss:0.0006203391239978373
The modified gen p mean: 0.44784125685691833, gen p mean: -0.09721361100673676, mean p set: 0.44841864705085754The modified gen p mean: 0.4478945732116699, gen p mean: -0.09164846688508987, mean p set: 0.44847002625465393
loss_pred:0.015577657148241997, decouple_loss:0.0008034235215745866
loss_pred:0.015881413593888283, decouple_loss:0.0007926555117592216
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
NaN value num: 0
Iteration: 1732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45449769496917725, gen p mean: -0.08976247906684875, mean p set: 0.45507341623306274
loss_pred:0.016411831602454185, decouple_loss:0.0007104911492206156
The modified gen p mean: 0.45332440733909607, gen p mean: -0.09407960623502731, mean p set: 0.4538998007774353The modified gen p mean: 0.45380041003227234, gen p mean: -0.10101073235273361, mean p set: 0.4543784260749817
loss_pred:0.016197046265006065, decouple_loss:0.0009435926331207156loss_pred:0.017799869179725647, decouple_loss:0.0009194556623697281
Iteration: 1733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538264274597168, gen p mean: -0.0882372111082077, mean p set: 0.4544040560722351
loss_pred:0.017306813970208168, decouple_loss:0.0009675841429270804
The modified gen p mean: 0.45179545879364014, gen p mean: -0.09063857048749924, mean p set: 0.45237207412719727
The modified gen p mean: 0.45420902967453003, gen p mean: -0.09545771032571793, mean p set: 0.4547848105430603
loss_pred:0.016798127442598343, decouple_loss:0.0008159737917594612
loss_pred:0.01676243543624878, decouple_loss:0.0009658751077950001
Iteration: 1734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45228323340415955, gen p mean: -0.08725845813751221, mean p set: 0.4528588652610779
loss_pred:0.017068127170205116, decouple_loss:0.000896352983545512
The modified gen p mean: 0.4540294408798218, gen p mean: -0.0906287431716919, mean p set: 0.45460760593414307
loss_pred:0.016620397567749023, decouple_loss:0.0009018167620524764
The modified gen p mean: 0.45338916778564453, gen p mean: -0.09578850865364075, mean p set: 0.45396625995635986
loss_pred:0.017903270199894905, decouple_loss:0.0010176600189879537
Iteration: 1735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526768624782562, gen p mean: -0.08821013569831848, mean p set: 0.45325344800949097
loss_pred:0.016200486570596695, decouple_loss:0.0011092665372416377
The modified gen p mean: 0.45342832803726196, gen p mean: -0.08470135927200317, mean p set: 0.4540044963359833
loss_pred:0.017534278333187103, decouple_loss:0.0010402387706562877
The modified gen p mean: 0.4528747797012329, gen p mean: -0.09235907346010208, mean p set: 0.45345136523246765
loss_pred:0.017115114256739616, decouple_loss:0.0008045736467465758
Iteration: 1736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45304206013679504, gen p mean: -0.0960649624466896, mean p set: 0.45361828804016113
loss_pred:0.016251008957624435, decouple_loss:0.0008350404677912593
The modified gen p mean: 0.4532510042190552, gen p mean: -0.09609618782997131, mean p set: 0.4538280665874481
loss_pred:0.017337603494524956, decouple_loss:0.0009124210337176919
The modified gen p mean: 0.4529534578323364, gen p mean: -0.0950145423412323, mean p set: 0.453529417514801
loss_pred:0.016182761639356613, decouple_loss:0.0007616037037223577
Iteration: 1737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534130394458771, gen p mean: -0.08772443979978561, mean p set: 0.453988641500473
loss_pred:0.017476145178079605, decouple_loss:0.001051897881552577
The modified gen p mean: 0.4533507525920868, gen p mean: -0.0969906747341156, mean p set: 0.45392709970474243
The modified gen p mean: 0.4523531496524811, gen p mean: -0.0948868915438652, mean p set: 0.45293015241622925
loss_pred:0.017100701108574867, decouple_loss:0.000802266295067966
loss_pred:0.015336139127612114, decouple_loss:0.0009179069311358035
Iteration: 1738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539179503917694, gen p mean: -0.09997992217540741, mean p set: 0.4544958472251892
loss_pred:0.016646139323711395, decouple_loss:0.0008933573844842613
The modified gen p mean: 0.45365026593208313, gen p mean: -0.10363417863845825, mean p set: 0.4542261064052582
loss_pred:0.016815543174743652, decouple_loss:0.0012273065512999892
The modified gen p mean: 0.4522615671157837, gen p mean: -0.09400590509176254, mean p set: 0.4528396725654602
loss_pred:0.016866620630025864, decouple_loss:0.0008718864410184324
Iteration: 1739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536750614643097, gen p mean: -0.10459212958812714, mean p set: 0.45425495505332947
loss_pred:0.01707003079354763, decouple_loss:0.0008049645693972707
The modified gen p mean: 0.4531945288181305, gen p mean: -0.09452924877405167, mean p set: 0.4537711441516876
loss_pred:0.016689617186784744, decouple_loss:0.0010274213273078203
The modified gen p mean: 0.452452689409256, gen p mean: -0.09992325305938721, mean p set: 0.4530305862426758
loss_pred:0.016789592802524567, decouple_loss:0.0008859685622155666
Iteration: 1740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527662992477417, gen p mean: -0.09721655398607254, mean p set: 0.4533441960811615
loss_pred:0.01672281324863434, decouple_loss:0.0010619937675073743
The modified gen p mean: 0.45237433910369873, gen p mean: -0.09364578127861023, mean p set: 0.45295077562332153
loss_pred:0.015811393037438393, decouple_loss:0.001239433535374701
The modified gen p mean: 0.4528646469116211, gen p mean: -0.0953327938914299, mean p set: 0.4534422755241394
loss_pred:0.016462231054902077, decouple_loss:0.0008534805383533239
2023-05-01 05:55:21 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10462232679128647, mean p set: 0.4502691626548767
loss_pred:0.01751657947897911, decouple_loss:0.0012061710003763437
The modified gen p mean: 0.4495352506637573, gen p mean: -0.09836630523204803, mean p set: 0.4500633478164673
loss_pred:0.01681993156671524, decouple_loss:0.0009590546251274645
The modified gen p mean: 0.4498279094696045, gen p mean: -0.09822738915681839, mean p set: 0.45035696029663086
loss_pred:0.01713499054312706, decouple_loss:0.001083733863197267
WV_1_PC_1_EH_0_PS_40, loss: 0.017211316153407097, avg_mse: 0.026632102206349373
current test mse: 0.026632
Iteration: 1741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45293498039245605, gen p mean: -0.09259908646345139, mean p set: 0.45351284742355347
loss_pred:0.016720879822969437, decouple_loss:0.00106307421810925
The modified gen p mean: 0.4532630741596222, gen p mean: -0.08856482058763504, mean p set: 0.45383745431900024The modified gen p mean: 0.4505941569805145, gen p mean: -0.09099717438220978, mean p set: 0.451170951128006
loss_pred:0.016484560444951057, decouple_loss:0.0009281217935495079
loss_pred:0.016107242554426193, decouple_loss:0.0008119737613014877
Iteration: 1742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45229437947273254, gen p mean: -0.09015925228595734, mean p set: 0.4528715908527374
loss_pred:0.01557809580117464, decouple_loss:0.0009933238616213202
The modified gen p mean: 0.4528670907020569, gen p mean: -0.09350402653217316, mean p set: 0.4534461498260498The modified gen p mean: 0.45311564207077026, gen p mean: -0.08453400433063507, mean p set: 0.45369112491607666
loss_pred:0.017056556418538094, decouple_loss:0.001229121582582593
loss_pred:0.01735544763505459, decouple_loss:0.0009257757337763906
Iteration: 1743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533363878726959, gen p mean: -0.10158070921897888, mean p set: 0.4539128243923187
loss_pred:0.016397081315517426, decouple_loss:0.0011606584303081036
The modified gen p mean: 0.4501762092113495, gen p mean: -0.09528356790542603, mean p set: 0.4507507383823395
loss_pred:0.016098860651254654, decouple_loss:0.0010509260464459658
The modified gen p mean: 0.45292916893959045, gen p mean: -0.09681756049394608, mean p set: 0.4535074532032013
loss_pred:0.015750527381896973, decouple_loss:0.0009762455592863262
Iteration: 1744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529052972793579, gen p mean: -0.09852719306945801, mean p set: 0.453481525182724
loss_pred:0.01684044674038887, decouple_loss:0.0010406102519482374
The modified gen p mean: 0.452332079410553, gen p mean: -0.09923907369375229, mean p set: 0.4529087543487549
loss_pred:0.017002590000629425, decouple_loss:0.0010246527381241322
The modified gen p mean: 0.4534647762775421, gen p mean: -0.09869445115327835, mean p set: 0.4540416896343231
loss_pred:0.016130752861499786, decouple_loss:0.0010889313416555524
Iteration: 1745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524177312850952, gen p mean: -0.10055316239595413, mean p set: 0.45299461483955383
loss_pred:0.016912780702114105, decouple_loss:0.0008596153929829597
The modified gen p mean: 0.45366838574409485, gen p mean: -0.09912404417991638, mean p set: 0.4542456865310669
loss_pred:0.017065664753317833, decouple_loss:0.0011761804344132543
The modified gen p mean: 0.45209553837776184, gen p mean: -0.09951026737689972, mean p set: 0.4526754915714264
loss_pred:0.016935767605900764, decouple_loss:0.0009236536570824683
Iteration: 1746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45265722274780273, gen p mean: -0.09671574831008911, mean p set: 0.45323580503463745
loss_pred:0.01648077182471752, decouple_loss:0.0010608854936435819
The modified gen p mean: 0.4527744650840759, gen p mean: -0.09868138283491135, mean p set: 0.4533534049987793
The modified gen p mean: 0.4501665532588959, gen p mean: -0.09554729610681534, mean p set: 0.45074325799942017
loss_pred:0.016707323491573334, decouple_loss:0.0008509326726198196
loss_pred:0.016295572742819786, decouple_loss:0.0010834381682798266
Iteration: 1747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529266655445099, gen p mean: -0.09685884416103363, mean p set: 0.4535035192966461
loss_pred:0.016340868547558784, decouple_loss:0.0006709632580168545
The modified gen p mean: 0.45206281542778015, gen p mean: -0.09757749736309052, mean p set: 0.45264074206352234
loss_pred:0.016837313771247864, decouple_loss:0.0008049954194575548
The modified gen p mean: 0.4523169696331024, gen p mean: -0.09966537356376648, mean p set: 0.4528941214084625
loss_pred:0.016277112066745758, decouple_loss:0.0008280937909148633
Iteration: 1748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529939293861389, gen p mean: -0.10539855808019638, mean p set: 0.4535713493824005
loss_pred:0.016353188082575798, decouple_loss:0.0008433957118541002
The modified gen p mean: 0.4531249403953552, gen p mean: -0.09944850206375122, mean p set: 0.4536985456943512
loss_pred:0.016560252755880356, decouple_loss:0.0007961610681377351
The modified gen p mean: 0.4517306983470917, gen p mean: -0.10098018497228622, mean p set: 0.45230671763420105
loss_pred:0.016753312200307846, decouple_loss:0.0009444102179259062
Iteration: 1749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45246991515159607, gen p mean: -0.10433834046125412, mean p set: 0.453046590089798
loss_pred:0.016722112894058228, decouple_loss:0.0007783223409205675
The modified gen p mean: 0.4542664587497711, gen p mean: -0.09802205115556717, mean p set: 0.45484453439712524
loss_pred:0.015889381989836693, decouple_loss:0.0008739082841202617
The modified gen p mean: 0.4535227119922638, gen p mean: -0.10145314782857895, mean p set: 0.4541010856628418
loss_pred:0.01596219837665558, decouple_loss:0.0007505950634367764
Iteration: 1750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45278650522232056, gen p mean: -0.10074571520090103, mean p set: 0.45336446166038513
loss_pred:0.016444245353341103, decouple_loss:0.000677425938192755
The modified gen p mean: 0.4537787437438965, gen p mean: -0.09701653569936752, mean p set: 0.45435431599617004
loss_pred:0.016435308381915092, decouple_loss:0.0007655766094103456
The modified gen p mean: 0.4543399512767792, gen p mean: -0.09987063705921173, mean p set: 0.45491892099380493
loss_pred:0.01639673113822937, decouple_loss:0.0006765704602003098
2023-05-01 05:57:27 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.11296965926885605, mean p set: 0.4502691626548767
loss_pred:0.017651529982686043, decouple_loss:0.0008968742331489921
The modified gen p mean: 0.4495355486869812, gen p mean: -0.1061989963054657, mean p set: 0.4500633478164673
loss_pred:0.01696110889315605, decouple_loss:0.0008444844279438257
The modified gen p mean: 0.44982823729515076, gen p mean: -0.10611959546804428, mean p set: 0.45035696029663086
loss_pred:0.01716277189552784, decouple_loss:0.0008730807458050549
WV_1_PC_1_EH_0_PS_40, loss: 0.017302043735980988, avg_mse: 0.026654977351427078
current test mse: 0.026655
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
NaN value num: 0
Iteration: 1751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518081843852997, gen p mean: -0.10059784352779388, mean p set: 0.45238441228866577
loss_pred:0.015715811401605606, decouple_loss:0.000790146819781512
The modified gen p mean: 0.45185622572898865, gen p mean: -0.09930624812841415, mean p set: 0.4524330198764801
loss_pred:0.015659350901842117, decouple_loss:0.0008074984070844948
The modified gen p mean: 0.4515875577926636, gen p mean: -0.10370153933763504, mean p set: 0.4521646797657013
loss_pred:0.016356335952878, decouple_loss:0.0009072740795090795
Iteration: 1752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515198767185211, gen p mean: -0.10641755908727646, mean p set: 0.4520983099937439
loss_pred:0.01705086976289749, decouple_loss:0.0011297798482701182
The modified gen p mean: 0.45281311869621277, gen p mean: -0.1046290472149849, mean p set: 0.45338940620422363The modified gen p mean: 0.4529191851615906, gen p mean: -0.10239136964082718, mean p set: 0.45349109172821045
loss_pred:0.01649821363389492, decouple_loss:0.0012449811911210418
loss_pred:0.01631881482899189, decouple_loss:0.0009558210149407387
Iteration: 1753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451693058013916, gen p mean: -0.10015590488910675, mean p set: 0.45227310061454773
loss_pred:0.01790245622396469, decouple_loss:0.0008181208977475762
The modified gen p mean: 0.45264744758605957, gen p mean: -0.09843822568655014, mean p set: 0.45322301983833313
loss_pred:0.015111450105905533, decouple_loss:0.0010296327527612448
The modified gen p mean: 0.45261886715888977, gen p mean: -0.09365295618772507, mean p set: 0.4531950354576111
loss_pred:0.017036505043506622, decouple_loss:0.0007319966680370271
Iteration: 1754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524143934249878, gen p mean: -0.08938529342412949, mean p set: 0.4529918134212494
loss_pred:0.01690809801220894, decouple_loss:0.0010044152149930596
The modified gen p mean: 0.4519897997379303, gen p mean: -0.1017078310251236, mean p set: 0.4525669813156128
loss_pred:0.016781259328126907, decouple_loss:0.000971060071606189
The modified gen p mean: 0.45315316319465637, gen p mean: -0.10135486721992493, mean p set: 0.45373082160949707
loss_pred:0.015041629783809185, decouple_loss:0.0013133144238963723
Iteration: 1755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525880515575409, gen p mean: -0.08825825154781342, mean p set: 0.4531652331352234
loss_pred:0.016555683687329292, decouple_loss:0.0007107655401341617
The modified gen p mean: 0.4531058967113495, gen p mean: -0.09443578124046326, mean p set: 0.45368245244026184
loss_pred:0.016144748777151108, decouple_loss:0.0009209202835336328
The modified gen p mean: 0.4519050717353821, gen p mean: -0.09309819340705872, mean p set: 0.4524819552898407
loss_pred:0.017028653994202614, decouple_loss:0.0009092249092645943
Iteration: 1756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4540691673755646, gen p mean: -0.0855022594332695, mean p set: 0.45464417338371277
loss_pred:0.017204564064741135, decouple_loss:0.0007308358908630908
The modified gen p mean: 0.45111334323883057, gen p mean: -0.09251982718706131, mean p set: 0.45169031620025635
loss_pred:0.015691496431827545, decouple_loss:0.000802415597718209
The modified gen p mean: 0.4523540735244751, gen p mean: -0.08885331451892853, mean p set: 0.4529314935207367
loss_pred:0.015241448767483234, decouple_loss:0.0009996931767091155
Iteration: 1757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536823630332947, gen p mean: -0.09061095863580704, mean p set: 0.45425835251808167
loss_pred:0.016768552362918854, decouple_loss:0.000772263330873102
The modified gen p mean: 0.4517064094543457, gen p mean: -0.09265022724866867, mean p set: 0.4522823691368103
The modified gen p mean: 0.45353904366493225, gen p mean: -0.102272629737854, mean p set: 0.45411795377731323
loss_pred:0.015452863648533821, decouple_loss:0.0007901828503236175
loss_pred:0.015009219758212566, decouple_loss:0.0007307344349101186
Iteration: 1758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4541952610015869, gen p mean: -0.09486973285675049, mean p set: 0.4547733962535858
loss_pred:0.01630302518606186, decouple_loss:0.0010066862450912595
The modified gen p mean: 0.45240864157676697, gen p mean: -0.0995846688747406, mean p set: 0.4529862403869629
The modified gen p mean: 0.4521341621875763, gen p mean: -0.09717419743537903, mean p set: 0.4527120590209961
loss_pred:0.014982935041189194, decouple_loss:0.000761538976803422
loss_pred:0.016441212967038155, decouple_loss:0.00111668580211699
Iteration: 1759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4540065824985504, gen p mean: -0.10559100657701492, mean p set: 0.45458728075027466
loss_pred:0.016267899423837662, decouple_loss:0.0007561384700238705
The modified gen p mean: 0.4529583752155304, gen p mean: -0.10148405283689499, mean p set: 0.45353299379348755
The modified gen p mean: 0.45231080055236816, gen p mean: -0.10646937787532806, mean p set: 0.4528862237930298
loss_pred:0.016685837879776955, decouple_loss:0.0010648908792063594
loss_pred:0.015998421236872673, decouple_loss:0.0006305361748673022
Iteration: 1760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531079828739166, gen p mean: -0.10499292612075806, mean p set: 0.4536839425563812
loss_pred:0.01698175072669983, decouple_loss:0.0008640331798233092
The modified gen p mean: 0.4522175192832947, gen p mean: -0.10489596426486969, mean p set: 0.45279404520988464
The modified gen p mean: 0.45120856165885925, gen p mean: -0.10322114080190659, mean p set: 0.4517868459224701
loss_pred:0.01677732542157173, decouple_loss:0.0009933849796652794
loss_pred:0.015766724944114685, decouple_loss:0.0015870368806645274
2023-05-01 06:00:09 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11925642937421799, mean p set: 0.4502691626548767
loss_pred:0.0175166092813015, decouple_loss:0.001283243065699935
The modified gen p mean: 0.449534147977829, gen p mean: -0.11266183853149414, mean p set: 0.4500633478164673
loss_pred:0.017067523673176765, decouple_loss:0.0011486595030874014
The modified gen p mean: 0.44982966780662537, gen p mean: -0.11239663511514664, mean p set: 0.45035696029663086
loss_pred:0.01720028929412365, decouple_loss:0.0015719017246738076
WV_1_PC_1_EH_0_PS_40, loss: 0.017328206449747086, avg_mse: 0.026793476194143295
current test mse: 0.026793
Iteration: 1761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524244964122772, gen p mean: -0.10623946785926819, mean p set: 0.4530031979084015
loss_pred:0.016818957403302193, decouple_loss:0.0010136569617316127
The modified gen p mean: 0.45233264565467834, gen p mean: -0.10215716063976288, mean p set: 0.4529101252555847
loss_pred:0.015426537953317165, decouple_loss:0.0010937482584267855
The modified gen p mean: 0.4532235860824585, gen p mean: -0.1142309233546257, mean p set: 0.4538002610206604
loss_pred:0.01597905345261097, decouple_loss:0.0009872392984107137
Iteration: 1762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45204830169677734, gen p mean: -0.10858088731765747, mean p set: 0.45262637734413147
loss_pred:0.016471337527036667, decouple_loss:0.000856179220136255
The modified gen p mean: 0.4522780179977417, gen p mean: -0.1073383316397667, mean p set: 0.45285579562187195The modified gen p mean: 0.4530222415924072, gen p mean: -0.10760774463415146, mean p set: 0.4535960853099823
loss_pred:0.017212092876434326, decouple_loss:0.0008692503324709833
loss_pred:0.017597444355487823, decouple_loss:0.0008197451825253665
Iteration: 1763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514956474304199, gen p mean: -0.10603559762239456, mean p set: 0.4520712196826935
loss_pred:0.01603623665869236, decouple_loss:0.0007709857309237123
The modified gen p mean: 0.45214590430259705, gen p mean: -0.11270496249198914, mean p set: 0.4527222514152527The modified gen p mean: 0.4526284635066986, gen p mean: -0.11187414079904556, mean p set: 0.45320409536361694
loss_pred:0.016213413327932358, decouple_loss:0.0010311184450984001
loss_pred:0.016683679074048996, decouple_loss:0.0010380159365013242
Iteration: 1764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518366754055023, gen p mean: -0.11411785334348679, mean p set: 0.4524134397506714
loss_pred:0.01528627797961235, decouple_loss:0.001165502704679966
The modified gen p mean: 0.45263057947158813, gen p mean: -0.11655519902706146, mean p set: 0.453206866979599
loss_pred:0.014506467618048191, decouple_loss:0.0010625255526974797
The modified gen p mean: 0.4524904191493988, gen p mean: -0.11006518453359604, mean p set: 0.45306530594825745
loss_pred:0.015165279619395733, decouple_loss:0.0010448507964611053
Iteration: 1765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530356228351593, gen p mean: -0.11181530356407166, mean p set: 0.45361486077308655
The modified gen p mean: 0.4547472596168518, gen p mean: -0.10148590803146362, mean p set: 0.4553252160549164
loss_pred:0.015004193410277367, decouple_loss:0.0009936353890225291
loss_pred:0.016253113746643066, decouple_loss:0.0008323122747242451
The modified gen p mean: 0.45329615473747253, gen p mean: -0.10420062392950058, mean p set: 0.4538719952106476
loss_pred:0.01661882922053337, decouple_loss:0.0008327166433446109
Iteration: 1766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45288708806037903, gen p mean: -0.1033465564250946, mean p set: 0.4534636437892914
The modified gen p mean: 0.4520071744918823, gen p mean: -0.09926639497280121, mean p set: 0.45258474349975586
loss_pred:0.01667439378798008, decouple_loss:0.000780259259045124
loss_pred:0.016570592299103737, decouple_loss:0.001076046610251069
The modified gen p mean: 0.4526844620704651, gen p mean: -0.09983380138874054, mean p set: 0.4532618522644043
loss_pred:0.017087677493691444, decouple_loss:0.0009830431081354618
Iteration: 1767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524427056312561, gen p mean: -0.10013975948095322, mean p set: 0.4530191123485565
loss_pred:0.016543736681342125, decouple_loss:0.0009476765408180654
The modified gen p mean: 0.4526742696762085, gen p mean: -0.10152994841337204, mean p set: 0.4532524347305298
The modified gen p mean: 0.452488511800766, gen p mean: -0.09755158424377441, mean p set: 0.4530657231807709
loss_pred:0.01575540006160736, decouple_loss:0.0014007114805281162
loss_pred:0.01539625320583582, decouple_loss:0.0010079317726194859
Iteration: 1768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45125240087509155, gen p mean: -0.10230725258588791, mean p set: 0.4518284201622009
loss_pred:0.01576882228255272, decouple_loss:0.0008455816423520446
The modified gen p mean: 0.45179468393325806, gen p mean: -0.10112832486629486, mean p set: 0.4523705840110779
loss_pred:0.015982333570718765, decouple_loss:0.0009490101947449148
The modified gen p mean: 0.4530160129070282, gen p mean: -0.11188073456287384, mean p set: 0.4535945653915405
loss_pred:0.014713323675096035, decouple_loss:0.0009665669058449566
Iteration: 1769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512454569339752, gen p mean: -0.09874743223190308, mean p set: 0.4518222510814667
loss_pred:0.016338493674993515, decouple_loss:0.00094372290186584
The modified gen p mean: 0.4534543454647064, gen p mean: -0.10721208155155182, mean p set: 0.4540300667285919
The modified gen p mean: 0.45245978236198425, gen p mean: -0.10401656478643417, mean p set: 0.4530394971370697
loss_pred:0.01648217998445034, decouple_loss:0.000801609072368592
loss_pred:0.016357870772480965, decouple_loss:0.0007820194005034864
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
NaN value num: 0
Iteration: 1770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475831687450409, gen p mean: -0.11326254159212112, mean p set: 0.44815871119499207
The modified gen p mean: 0.4483739733695984, gen p mean: -0.11196428537368774, mean p set: 0.44895002245903015
loss_pred:0.017435569316148758, decouple_loss:0.0014723431086167693
loss_pred:0.017931168898940086, decouple_loss:0.001022116863168776
The modified gen p mean: 0.44813770055770874, gen p mean: -0.10848399996757507, mean p set: 0.44871240854263306
loss_pred:0.018577272072434425, decouple_loss:0.0011321338824927807
2023-05-01 06:02:52 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1175171360373497, mean p set: 0.4502691626548767
loss_pred:0.017527498304843903, decouple_loss:0.0006887182244099677
The modified gen p mean: 0.44953617453575134, gen p mean: -0.11060351878404617, mean p set: 0.4500633478164673
loss_pred:0.01692645251750946, decouple_loss:0.0009060912998393178
The modified gen p mean: 0.449828565120697, gen p mean: -0.110171377658844, mean p set: 0.45035696029663086
loss_pred:0.017162112519145012, decouple_loss:0.0006772385677322745
WV_1_PC_1_EH_0_PS_40, loss: 0.017243221402168274, avg_mse: 0.026760784909129143
current test mse: 0.026761
Iteration: 1771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727960228919983, gen p mean: -0.1155843511223793, mean p set: 0.44785749912261963
loss_pred:0.01810695044696331, decouple_loss:0.000695702328812331
The modified gen p mean: 0.4485633969306946, gen p mean: -0.10862775146961212, mean p set: 0.4491376578807831
loss_pred:0.018571851775050163, decouple_loss:0.00072389846900478
The modified gen p mean: 0.44715744256973267, gen p mean: -0.1083812564611435, mean p set: 0.4477321207523346
loss_pred:0.018840894103050232, decouple_loss:0.0006391561473719776
Iteration: 1772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886690378189087, gen p mean: -0.10810936987400055, mean p set: 0.4494416415691376
loss_pred:0.017617305740714073, decouple_loss:0.0007892896537669003
The modified gen p mean: 0.4489123821258545, gen p mean: -0.11477556079626083, mean p set: 0.44949179887771606
The modified gen p mean: 0.4480995535850525, gen p mean: -0.10506360977888107, mean p set: 0.44867268204689026
loss_pred:0.017524220049381256, decouple_loss:0.0007632130291312933
loss_pred:0.01793886534869671, decouple_loss:0.0008262234041467309
Iteration: 1773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483674168586731, gen p mean: -0.10874968767166138, mean p set: 0.44894295930862427
loss_pred:0.017501981928944588, decouple_loss:0.0009576223092153668
The modified gen p mean: 0.4482967257499695, gen p mean: -0.1087241843342781, mean p set: 0.44887417554855347The modified gen p mean: 0.44815438985824585, gen p mean: -0.1038120910525322, mean p set: 0.4487318992614746
loss_pred:0.017066514119505882, decouple_loss:0.0008001847309060395loss_pred:0.017822444438934326, decouple_loss:0.000980755197815597
Iteration: 1774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482910633087158, gen p mean: -0.1018705815076828, mean p set: 0.44886863231658936
loss_pred:0.017524998635053635, decouple_loss:0.0006832023500464857
The modified gen p mean: 0.4472430944442749, gen p mean: -0.10445301234722137, mean p set: 0.4478190541267395
loss_pred:0.01825670339167118, decouple_loss:0.0007929977145977318
The modified gen p mean: 0.4474194347858429, gen p mean: -0.10798600316047668, mean p set: 0.447996586561203
loss_pred:0.01792215183377266, decouple_loss:0.0008810487342998385
Iteration: 1775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796305894851685, gen p mean: -0.10799965262413025, mean p set: 0.44853898882865906
loss_pred:0.01749568060040474, decouple_loss:0.0007197575177997351
The modified gen p mean: 0.4478691518306732, gen p mean: -0.10877745598554611, mean p set: 0.4484483003616333
The modified gen p mean: 0.4479748010635376, gen p mean: -0.11109589040279388, mean p set: 0.44855156540870667
loss_pred:0.017639359459280968, decouple_loss:0.0007218187092803419
loss_pred:0.016665175557136536, decouple_loss:0.0006440132856369019
Iteration: 1776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484168589115143, gen p mean: -0.11203262209892273, mean p set: 0.4489932656288147
loss_pred:0.01760229468345642, decouple_loss:0.0008293155115097761
The modified gen p mean: 0.4473475515842438, gen p mean: -0.10261733829975128, mean p set: 0.44792336225509644
loss_pred:0.017746681347489357, decouple_loss:0.0012923605972900987
The modified gen p mean: 0.4474388659000397, gen p mean: -0.10138789564371109, mean p set: 0.4480125904083252
loss_pred:0.017855707556009293, decouple_loss:0.0009898998541757464
Iteration: 1777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474583864212036, gen p mean: -0.11298136413097382, mean p set: 0.44803571701049805
loss_pred:0.01720867119729519, decouple_loss:0.0007760507287457585
The modified gen p mean: 0.4469018578529358, gen p mean: -0.10602416843175888, mean p set: 0.4474784731864929
The modified gen p mean: 0.44756174087524414, gen p mean: -0.11128504574298859, mean p set: 0.4481373429298401
loss_pred:0.01751950941979885, decouple_loss:0.0007857365999370813
loss_pred:0.015965867787599564, decouple_loss:0.0008163537713699043
Iteration: 1778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787493348121643, gen p mean: -0.1052863821387291, mean p set: 0.44845062494277954
loss_pred:0.017407413572072983, decouple_loss:0.0007615259382873774
The modified gen p mean: 0.44784459471702576, gen p mean: -0.11051653325557709, mean p set: 0.44842007756233215
loss_pred:0.017266463488340378, decouple_loss:0.0008391799638047814
The modified gen p mean: 0.4473324716091156, gen p mean: -0.10126300156116486, mean p set: 0.4479075074195862
loss_pred:0.017494753003120422, decouple_loss:0.0007878284086473286
Iteration: 1779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475826621055603, gen p mean: -0.10498522222042084, mean p set: 0.44815748929977417
loss_pred:0.0180521123111248, decouple_loss:0.0006871988880448043
The modified gen p mean: 0.44723159074783325, gen p mean: -0.10755079984664917, mean p set: 0.4478082060813904
The modified gen p mean: 0.4469183087348938, gen p mean: -0.10250163078308105, mean p set: 0.4474940896034241
loss_pred:0.018143247812986374, decouple_loss:0.0010475983144715428
loss_pred:0.017657896503806114, decouple_loss:0.0007869757828302681
Iteration: 1780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482727646827698, gen p mean: -0.1042356938123703, mean p set: 0.4488488733768463
loss_pred:0.017520559951663017, decouple_loss:0.001101104193367064
The modified gen p mean: 0.4476720690727234, gen p mean: -0.10682832449674606, mean p set: 0.4482477605342865
loss_pred:0.017326928675174713, decouple_loss:0.0008494367939420044
The modified gen p mean: 0.4479145109653473, gen p mean: -0.10836876183748245, mean p set: 0.44848933815956116
loss_pred:0.017151610925793648, decouple_loss:0.0010595015482977033
2023-05-01 06:04:58 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11569278687238693, mean p set: 0.4502691626548767
loss_pred:0.017383886501193047, decouple_loss:0.0007277510594576597
The modified gen p mean: 0.4495358467102051, gen p mean: -0.10897982865571976, mean p set: 0.4500633478164673
loss_pred:0.01680011861026287, decouple_loss:0.0008499953546561301
The modified gen p mean: 0.4498275816440582, gen p mean: -0.10851608216762543, mean p set: 0.45035696029663086
loss_pred:0.017060332000255585, decouple_loss:0.0007469081319868565
WV_1_PC_1_EH_0_PS_40, loss: 0.01712018996477127, avg_mse: 0.026560280472040176
current test mse: 0.02656
Iteration: 1781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474060535430908, gen p mean: -0.10530539602041245, mean p set: 0.4479822516441345
loss_pred:0.018146196380257607, decouple_loss:0.0007816567667759955
The modified gen p mean: 0.4479270577430725, gen p mean: -0.11093532294034958, mean p set: 0.4485030770301819
loss_pred:0.017221610993146896, decouple_loss:0.0008397860801778734
The modified gen p mean: 0.4476953446865082, gen p mean: -0.1070714145898819, mean p set: 0.4482739567756653
loss_pred:0.017536500468850136, decouple_loss:0.0007619656389579177
Iteration: 1782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474709630012512, gen p mean: -0.1127166897058487, mean p set: 0.44804492592811584
loss_pred:0.01745501719415188, decouple_loss:0.0008027464500628412
The modified gen p mean: 0.44720327854156494, gen p mean: -0.11487291753292084, mean p set: 0.44777801632881165The modified gen p mean: 0.4476550817489624, gen p mean: -0.1177988201379776, mean p set: 0.4482278525829315
loss_pred:0.01742766611278057, decouple_loss:0.0006393645307980478
loss_pred:0.016955852508544922, decouple_loss:0.0005924252327531576
Iteration: 1783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876807928085327, gen p mean: -0.11901884526014328, mean p set: 0.4493470788002014
loss_pred:0.017858058214187622, decouple_loss:0.0007591474568471313
The modified gen p mean: 0.4478593170642853, gen p mean: -0.12256929278373718, mean p set: 0.44843775033950806
loss_pred:0.017647702246904373, decouple_loss:0.0008613206446170807
The modified gen p mean: 0.44836920499801636, gen p mean: -0.11796854436397552, mean p set: 0.44894248247146606
loss_pred:0.017899518832564354, decouple_loss:0.0010469446424394846
Iteration: 1784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716987013816833, gen p mean: -0.11976251006126404, mean p set: 0.44774329662323
loss_pred:0.01724248006939888, decouple_loss:0.0007671298226341605
The modified gen p mean: 0.4478433430194855, gen p mean: -0.1279163509607315, mean p set: 0.44841820001602173
loss_pred:0.01654171012341976, decouple_loss:0.0006288845324888825
The modified gen p mean: 0.4482651352882385, gen p mean: -0.12220315635204315, mean p set: 0.4488413631916046
loss_pred:0.017867183312773705, decouple_loss:0.0008002921822480857
Iteration: 1785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477998614311218, gen p mean: -0.12697450816631317, mean p set: 0.4483753740787506
loss_pred:0.01607605069875717, decouple_loss:0.0007704009185545146
The modified gen p mean: 0.4484141170978546, gen p mean: -0.11978044360876083, mean p set: 0.44898611307144165
loss_pred:0.017603637650609016, decouple_loss:0.0006315128412097692
The modified gen p mean: 0.4483756124973297, gen p mean: -0.11925987899303436, mean p set: 0.44894954562187195
loss_pred:0.01676134206354618, decouple_loss:0.0007238382822833955
Iteration: 1786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840314984321594, gen p mean: -0.11151667684316635, mean p set: 0.44897785782814026
loss_pred:0.017442302778363228, decouple_loss:0.000600881059654057
The modified gen p mean: 0.44825348258018494, gen p mean: -0.11476001888513565, mean p set: 0.44883155822753906
The modified gen p mean: 0.4477410316467285, gen p mean: -0.11527369171380997, mean p set: 0.4483153223991394
loss_pred:0.01757063902914524, decouple_loss:0.0008720780024304986
loss_pred:0.01738416776061058, decouple_loss:0.0007433878490701318
Iteration: 1787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447697252035141, gen p mean: -0.11129852384328842, mean p set: 0.4482729434967041
loss_pred:0.017350470647215843, decouple_loss:0.001138417050242424
The modified gen p mean: 0.4475606679916382, gen p mean: -0.11143867671489716, mean p set: 0.4481372833251953
loss_pred:0.01803736388683319, decouple_loss:0.000734702218323946
The modified gen p mean: 0.44813817739486694, gen p mean: -0.10690072923898697, mean p set: 0.4487142562866211
loss_pred:0.018235275521874428, decouple_loss:0.0007373253465630114
Iteration: 1788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757577776908875, gen p mean: -0.11592694371938705, mean p set: 0.4481523036956787
loss_pred:0.017227154225111008, decouple_loss:0.0007707431213930249
The modified gen p mean: 0.44877368211746216, gen p mean: -0.11433086544275284, mean p set: 0.449349969625473
The modified gen p mean: 0.4488184452056885, gen p mean: -0.11192651838064194, mean p set: 0.4493922293186188
loss_pred:0.01637415587902069, decouple_loss:0.0005694523570127785
loss_pred:0.017328662797808647, decouple_loss:0.0007303688325919211
Iteration: 1789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473349452018738, gen p mean: -0.10643858462572098, mean p set: 0.4479096829891205
loss_pred:0.017764905467629433, decouple_loss:0.0006264889379963279
The modified gen p mean: 0.44751298427581787, gen p mean: -0.11898073554039001, mean p set: 0.44808903336524963
The modified gen p mean: 0.4480654299259186, gen p mean: -0.11402927339076996, mean p set: 0.44863903522491455
loss_pred:0.017561914399266243, decouple_loss:0.0008539275149814785
loss_pred:0.017622938379645348, decouple_loss:0.0008155580144375563
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 1790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698596000671387, gen p mean: -0.11948095262050629, mean p set: 0.447562575340271
loss_pred:0.016200687736272812, decouple_loss:0.0006171012646518648
The modified gen p mean: 0.4453918933868408, gen p mean: -0.11873557418584824, mean p set: 0.445966511964798
The modified gen p mean: 0.447699636220932, gen p mean: -0.11031976342201233, mean p set: 0.44827497005462646
loss_pred:0.016308849677443504, decouple_loss:0.0006423244485631585
loss_pred:0.015480204485356808, decouple_loss:0.0006226390833035111
2023-05-01 06:07:55 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.12242407351732254, mean p set: 0.4502691626548767
loss_pred:0.017314866185188293, decouple_loss:0.0005912649794481695
The modified gen p mean: 0.44953420758247375, gen p mean: -0.1159079521894455, mean p set: 0.4500633478164673
loss_pred:0.016711417585611343, decouple_loss:0.0008134308736771345
The modified gen p mean: 0.4498293995857239, gen p mean: -0.11529335379600525, mean p set: 0.45035696029663086
loss_pred:0.016977451741695404, decouple_loss:0.0010650464100763202
WV_1_PC_1_EH_0_PS_40, loss: 0.017042409628629684, avg_mse: 0.026520146057009697
current test mse: 0.02652
Iteration: 1791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448424369096756, gen p mean: -0.11789996176958084, mean p set: 0.44900041818618774
loss_pred:0.015422292985022068, decouple_loss:0.000685260456521064
The modified gen p mean: 0.4470462501049042, gen p mean: -0.12282776087522507, mean p set: 0.44761988520622253
loss_pred:0.01620633900165558, decouple_loss:0.001158366329036653
The modified gen p mean: 0.4468330144882202, gen p mean: -0.12272275239229202, mean p set: 0.44740915298461914
loss_pred:0.016447827219963074, decouple_loss:0.0006523712072521448
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722577929496765, gen p mean: -0.11877936124801636, mean p set: 0.44780421257019043
loss_pred:0.01565689779818058, decouple_loss:0.0006252474850043654
The modified gen p mean: 0.4475788176059723, gen p mean: -0.12276262789964676, mean p set: 0.4481530487537384The modified gen p mean: 0.448519766330719, gen p mean: -0.11864315718412399, mean p set: 0.44909462332725525
loss_pred:0.015688849613070488, decouple_loss:0.000562636589165777
loss_pred:0.015520143322646618, decouple_loss:0.0007495422614738345
Iteration: 1793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44842109084129333, gen p mean: -0.12490317970514297, mean p set: 0.4489942789077759
loss_pred:0.01585175283253193, decouple_loss:0.0006048043724149466
The modified gen p mean: 0.44793441891670227, gen p mean: -0.12019714713096619, mean p set: 0.4485120475292206
loss_pred:0.01689833216369152, decouple_loss:0.0005934904329478741
The modified gen p mean: 0.4475213885307312, gen p mean: -0.12595872581005096, mean p set: 0.4480946362018585
loss_pred:0.016102464869618416, decouple_loss:0.0006330916075967252
Iteration: 1794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471947252750397, gen p mean: -0.121717669069767, mean p set: 0.4477689266204834
loss_pred:0.016451995819807053, decouple_loss:0.0006814240477979183
The modified gen p mean: 0.44811245799064636, gen p mean: -0.126863032579422, mean p set: 0.44869065284729004
loss_pred:0.015659242868423462, decouple_loss:0.0005967235192656517
The modified gen p mean: 0.447441965341568, gen p mean: -0.11861968040466309, mean p set: 0.44801437854766846
loss_pred:0.015735777094960213, decouple_loss:0.0009347168379463255
Iteration: 1795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473186135292053, gen p mean: -0.12153228372335434, mean p set: 0.44789430499076843
loss_pred:0.01571551337838173, decouple_loss:0.0006406580214388669
The modified gen p mean: 0.44718366861343384, gen p mean: -0.12502959370613098, mean p set: 0.44775715470314026
loss_pred:0.016055958345532417, decouple_loss:0.0008057255763560534
The modified gen p mean: 0.4476412832736969, gen p mean: -0.1237257719039917, mean p set: 0.44821611046791077
loss_pred:0.0161563940346241, decouple_loss:0.0006867630290798843
Iteration: 1796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472992420196533, gen p mean: -0.12289844453334808, mean p set: 0.4478735327720642
loss_pred:0.016079626977443695, decouple_loss:0.0005984976887702942
The modified gen p mean: 0.4493396282196045, gen p mean: -0.11788250505924225, mean p set: 0.4499136209487915
loss_pred:0.01589907333254814, decouple_loss:0.0006972207338549197
The modified gen p mean: 0.44549235701560974, gen p mean: -0.12313725054264069, mean p set: 0.44606801867485046
loss_pred:0.016237400472164154, decouple_loss:0.0007943593082018197
Iteration: 1797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482225775718689, gen p mean: -0.11583248525857925, mean p set: 0.4488007128238678
loss_pred:0.015485194511711597, decouple_loss:0.000604829634539783
The modified gen p mean: 0.44652462005615234, gen p mean: -0.12083564698696136, mean p set: 0.44709834456443787
loss_pred:0.01589827612042427, decouple_loss:0.0006478841532953084
The modified gen p mean: 0.4459948241710663, gen p mean: -0.11833888292312622, mean p set: 0.44656795263290405
loss_pred:0.016059648245573044, decouple_loss:0.0005916149821132421
Iteration: 1798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461393654346466, gen p mean: -0.11606016010046005, mean p set: 0.44671642780303955
The modified gen p mean: 0.4460609257221222, gen p mean: -0.1165325790643692, mean p set: 0.4466356933116913loss_pred:0.01610981486737728, decouple_loss:0.0008811815641820431
loss_pred:0.01573534496128559, decouple_loss:0.0006960033206269145
The modified gen p mean: 0.4460601508617401, gen p mean: -0.11843893676996231, mean p set: 0.4466353952884674
loss_pred:0.015572711825370789, decouple_loss:0.0006247357814572752
Iteration: 1799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479382336139679, gen p mean: -0.10759513825178146, mean p set: 0.44851356744766235
loss_pred:0.015896053984761238, decouple_loss:0.0006413355586118996
The modified gen p mean: 0.4467909038066864, gen p mean: -0.10936229676008224, mean p set: 0.44736772775650024
loss_pred:0.015602962113916874, decouple_loss:0.0007246280438266695
The modified gen p mean: 0.4470311403274536, gen p mean: -0.11255001276731491, mean p set: 0.4476076066493988
loss_pred:0.015541093423962593, decouple_loss:0.000720380456186831
Iteration: 1800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44605326652526855, gen p mean: -0.11342776566743851, mean p set: 0.4466274678707123
loss_pred:0.016032759100198746, decouple_loss:0.000778663030359894
The modified gen p mean: 0.4471031427383423, gen p mean: -0.11170610785484314, mean p set: 0.44767752289772034
loss_pred:0.015577991493046284, decouple_loss:0.0006114054704084992
The modified gen p mean: 0.44772017002105713, gen p mean: -0.11044710129499435, mean p set: 0.4482978880405426
loss_pred:0.015813449397683144, decouple_loss:0.0007179937092587352
2023-05-01 06:10:01 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11349382251501083, mean p set: 0.4502691626548767
loss_pred:0.01731022633612156, decouple_loss:0.0006736583891324699
The modified gen p mean: 0.44953715801239014, gen p mean: -0.10750094801187515, mean p set: 0.4500633478164673
loss_pred:0.016663046553730965, decouple_loss:0.0008058493840508163
The modified gen p mean: 0.44982773065567017, gen p mean: -0.10703320056200027, mean p set: 0.45035696029663086
loss_pred:0.016989095136523247, decouple_loss:0.0006648075068369508
WV_1_PC_1_EH_0_PS_40, loss: 0.017023194581270218, avg_mse: 0.026461495086550713
current test mse: 0.026461
Iteration: 1801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688478112220764, gen p mean: -0.11137949675321579, mean p set: 0.44745954871177673
loss_pred:0.016019240021705627, decouple_loss:0.000643573293928057
The modified gen p mean: 0.4484512209892273, gen p mean: -0.10422183573246002, mean p set: 0.44902777671813965The modified gen p mean: 0.4482966661453247, gen p mean: -0.10930982232093811, mean p set: 0.44887441396713257
loss_pred:0.01566256210207939, decouple_loss:0.0006878589047119021
loss_pred:0.015589163638651371, decouple_loss:0.0007358998409472406
Iteration: 1802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448699951171875, gen p mean: -0.10479995608329773, mean p set: 0.4492754638195038
The modified gen p mean: 0.4467112421989441, gen p mean: -0.11144900321960449, mean p set: 0.4472885727882385
loss_pred:0.015674114227294922, decouple_loss:0.000880050181876868
loss_pred:0.016716517508029938, decouple_loss:0.0008778320043347776
The modified gen p mean: 0.4475109577178955, gen p mean: -0.11058494448661804, mean p set: 0.448087215423584
loss_pred:0.015486427582800388, decouple_loss:0.0009048748179338872
Iteration: 1803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479216933250427, gen p mean: -0.11061639338731766, mean p set: 0.4484986364841461
loss_pred:0.01564633846282959, decouple_loss:0.0007446439703926444
The modified gen p mean: 0.44743579626083374, gen p mean: -0.11296742409467697, mean p set: 0.44801008701324463The modified gen p mean: 0.4475071430206299, gen p mean: -0.11044620722532272, mean p set: 0.44808489084243774
loss_pred:0.015442571602761745, decouple_loss:0.000769003585446626
loss_pred:0.015555541962385178, decouple_loss:0.00066395103931427
Iteration: 1804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492095708847046, gen p mean: -0.1086026132106781, mean p set: 0.449787974357605
loss_pred:0.015483921393752098, decouple_loss:0.000749124214053154
The modified gen p mean: 0.44706979393959045, gen p mean: -0.1104772612452507, mean p set: 0.447646826505661
loss_pred:0.015757612884044647, decouple_loss:0.000707191473338753
The modified gen p mean: 0.4476865231990814, gen p mean: -0.11100871860980988, mean p set: 0.44826194643974304
loss_pred:0.01591671258211136, decouple_loss:0.0006950224633328617
Iteration: 1805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688716530799866, gen p mean: -0.11030338704586029, mean p set: 0.4474617540836334
loss_pred:0.015819158405065536, decouple_loss:0.0007447588141076267
The modified gen p mean: 0.4477510452270508, gen p mean: -0.10905075073242188, mean p set: 0.44832706451416016
loss_pred:0.015755917876958847, decouple_loss:0.0007315828115679324
The modified gen p mean: 0.44821515679359436, gen p mean: -0.10716119408607483, mean p set: 0.4487912356853485
loss_pred:0.015787895768880844, decouple_loss:0.0009046881459653378
Iteration: 1806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497316777706146, gen p mean: -0.10978871583938599, mean p set: 0.45031026005744934
loss_pred:0.01571238413453102, decouple_loss:0.0006545270443893969
The modified gen p mean: 0.4463307857513428, gen p mean: -0.11680912971496582, mean p set: 0.4469049572944641
loss_pred:0.015867894515395164, decouple_loss:0.0009571731789037585
The modified gen p mean: 0.44900235533714294, gen p mean: -0.11667510122060776, mean p set: 0.44957879185676575
loss_pred:0.015141122974455357, decouple_loss:0.0007739906432107091
Iteration: 1807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471833407878876, gen p mean: -0.11969687044620514, mean p set: 0.44775891304016113
loss_pred:0.015963714569807053, decouple_loss:0.0008905192953534424
The modified gen p mean: 0.4467034637928009, gen p mean: -0.11895439773797989, mean p set: 0.44727712869644165
loss_pred:0.015147916972637177, decouple_loss:0.0006086747744120657
The modified gen p mean: 0.4486079216003418, gen p mean: -0.11637575924396515, mean p set: 0.449184387922287
loss_pred:0.015306730754673481, decouple_loss:0.0007376754656434059
Iteration: 1808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448269248008728, gen p mean: -0.11810587346553802, mean p set: 0.4488462209701538
loss_pred:0.015491245314478874, decouple_loss:0.0008045705617405474
The modified gen p mean: 0.4473983943462372, gen p mean: -0.11436765640974045, mean p set: 0.4479758143424988
loss_pred:0.014947893097996712, decouple_loss:0.0006110445247031748
The modified gen p mean: 0.4473384618759155, gen p mean: -0.1132485643029213, mean p set: 0.4479130506515503
loss_pred:0.015242442488670349, decouple_loss:0.0006036995910108089
Iteration: 1809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774726033210754, gen p mean: -0.10976265370845795, mean p set: 0.4483223557472229
loss_pred:0.015106619335711002, decouple_loss:0.0008970896014943719
The modified gen p mean: 0.44726672768592834, gen p mean: -0.11834698915481567, mean p set: 0.44784191250801086
loss_pred:0.015537328086793423, decouple_loss:0.0007935410249046981
The modified gen p mean: 0.44929033517837524, gen p mean: -0.11202430725097656, mean p set: 0.449869304895401
loss_pred:0.01563228666782379, decouple_loss:0.0007940432988107204
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
NaN value num: 0
Iteration: 1810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492079019546509, gen p mean: -0.11100247502326965, mean p set: 0.4497845768928528
The modified gen p mean: 0.45048874616622925, gen p mean: -0.1167217493057251, mean p set: 0.45106494426727295
loss_pred:0.017814066261053085, decouple_loss:0.000811866600997746
loss_pred:0.016575725749135017, decouple_loss:0.0008815561304800212
The modified gen p mean: 0.44985446333885193, gen p mean: -0.11044502258300781, mean p set: 0.45042943954467773
loss_pred:0.017322804778814316, decouple_loss:0.0010722497245296836
2023-05-01 06:12:50 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11477446556091309, mean p set: 0.4502691626548767
loss_pred:0.017238574102520943, decouple_loss:0.0009225280955433846
The modified gen p mean: 0.44953444600105286, gen p mean: -0.10884548723697662, mean p set: 0.4500633478164673
loss_pred:0.016602322459220886, decouple_loss:0.0009088069782592356
The modified gen p mean: 0.4498300552368164, gen p mean: -0.10818981379270554, mean p set: 0.45035696029663086
loss_pred:0.016849404200911522, decouple_loss:0.0008840041700750589
WV_1_PC_1_EH_0_PS_40, loss: 0.01694202423095703, avg_mse: 0.026290640234947205
current test mse: 0.026291
At step 1810, Best test: 0.026291
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 1811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45113009214401245, gen p mean: -0.10008738934993744, mean p set: 0.4517059326171875
loss_pred:0.018723778426647186, decouple_loss:0.0010557277128100395
The modified gen p mean: 0.4509773254394531, gen p mean: -0.09202875941991806, mean p set: 0.4515543580055237
loss_pred:0.017592936754226685, decouple_loss:0.0009399232221767306
The modified gen p mean: 0.45279011130332947, gen p mean: -0.10232245177030563, mean p set: 0.4533670246601105
loss_pred:0.017632605507969856, decouple_loss:0.001105124014429748
Iteration: 1812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910356402397156, gen p mean: -0.09811272472143173, mean p set: 0.4496786296367645
loss_pred:0.016443002969026566, decouple_loss:0.0007975667249411345
The modified gen p mean: 0.44832682609558105, gen p mean: -0.10049304366111755, mean p set: 0.4489029347896576The modified gen p mean: 0.44899576902389526, gen p mean: -0.09775011241436005, mean p set: 0.4495715796947479
loss_pred:0.016069510951638222, decouple_loss:0.0006579146720468998loss_pred:0.016194868832826614, decouple_loss:0.0009462015004828572
Iteration: 1813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947171211242676, gen p mean: -0.08688105642795563, mean p set: 0.45004913210868835
loss_pred:0.01724913902580738, decouple_loss:0.0007232244242914021
The modified gen p mean: 0.4506789445877075, gen p mean: -0.08855843544006348, mean p set: 0.45125457644462585
loss_pred:0.016955098137259483, decouple_loss:0.0008830288425087929
The modified gen p mean: 0.4491640627384186, gen p mean: -0.09616012126207352, mean p set: 0.4497406780719757
loss_pred:0.015965458005666733, decouple_loss:0.0007783356704749167
Iteration: 1814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45069995522499084, gen p mean: -0.08947496116161346, mean p set: 0.45127683877944946
loss_pred:0.016329705715179443, decouple_loss:0.0008036337676458061
The modified gen p mean: 0.45136523246765137, gen p mean: -0.07584593445062637, mean p set: 0.45194050669670105
loss_pred:0.01709837280213833, decouple_loss:0.001085072522982955
The modified gen p mean: 0.45316120982170105, gen p mean: -0.08370295912027359, mean p set: 0.45373791456222534
loss_pred:0.017773913219571114, decouple_loss:0.0008854895713739097
Iteration: 1815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491325318813324, gen p mean: -0.08837374299764633, mean p set: 0.4497094452381134
loss_pred:0.016734730452299118, decouple_loss:0.0008534712833352387
The modified gen p mean: 0.4496880769729614, gen p mean: -0.08755771815776825, mean p set: 0.45026499032974243
loss_pred:0.016024241223931313, decouple_loss:0.0007195831276476383
The modified gen p mean: 0.449761301279068, gen p mean: -0.09200986474752426, mean p set: 0.4503369629383087
loss_pred:0.016826745122671127, decouple_loss:0.0008690180256962776
Iteration: 1816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527280628681183, gen p mean: -0.07876232266426086, mean p set: 0.45330584049224854
loss_pred:0.017361152917146683, decouple_loss:0.0010078634368255734
The modified gen p mean: 0.44851261377334595, gen p mean: -0.07973381876945496, mean p set: 0.4490891993045807
loss_pred:0.017425360158085823, decouple_loss:0.0008137610857374966
The modified gen p mean: 0.4496888220310211, gen p mean: -0.09083058685064316, mean p set: 0.4502660930156708
loss_pred:0.016715455800294876, decouple_loss:0.00098642788361758
Iteration: 1817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45079711079597473, gen p mean: -0.08998452872037888, mean p set: 0.4513741731643677
The modified gen p mean: 0.4500965476036072, gen p mean: -0.09896421432495117, mean p set: 0.45067140460014343
loss_pred:0.015948688611388206, decouple_loss:0.0008908908348530531
loss_pred:0.016577111557126045, decouple_loss:0.0008752051508054137
The modified gen p mean: 0.45014333724975586, gen p mean: -0.09461580216884613, mean p set: 0.4507175385951996
loss_pred:0.016171814873814583, decouple_loss:0.001063294941559434
Iteration: 1818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836336374282837, gen p mean: -0.09747972339391708, mean p set: 0.4489399194717407
loss_pred:0.01637805812060833, decouple_loss:0.0009638224728405476
The modified gen p mean: 0.4495021104812622, gen p mean: -0.09740403294563293, mean p set: 0.4500787556171417
The modified gen p mean: 0.4490009546279907, gen p mean: -0.09686228632926941, mean p set: 0.4495759904384613
loss_pred:0.01711944118142128, decouple_loss:0.0009627583785913885
loss_pred:0.01771652139723301, decouple_loss:0.001164162065833807
Iteration: 1819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451905220746994, gen p mean: -0.0987386554479599, mean p set: 0.4524822235107422
loss_pred:0.01743571273982525, decouple_loss:0.0010182250989601016
The modified gen p mean: 0.4490240216255188, gen p mean: -0.10217244178056717, mean p set: 0.4496016502380371
loss_pred:0.016731053590774536, decouple_loss:0.0010715965181589127
The modified gen p mean: 0.4510464370250702, gen p mean: -0.09749235957860947, mean p set: 0.45162320137023926
loss_pred:0.01730910688638687, decouple_loss:0.0012451095972210169
Iteration: 1820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45091667771339417, gen p mean: -0.0979849323630333, mean p set: 0.45149263739585876
loss_pred:0.016376418992877007, decouple_loss:0.0009830232011154294
The modified gen p mean: 0.44972798228263855, gen p mean: -0.10553596168756485, mean p set: 0.45030519366264343
The modified gen p mean: 0.44880926609039307, gen p mean: -0.10222411155700684, mean p set: 0.44938743114471436
loss_pred:0.015803635120391846, decouple_loss:0.001023590681143105
loss_pred:0.016053641214966774, decouple_loss:0.0009829191258177161
2023-05-01 06:15:00 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11270473897457123, mean p set: 0.4502691626548767
loss_pred:0.01740959845483303, decouple_loss:0.0010408610105514526
The modified gen p mean: 0.44982844591140747, gen p mean: -0.1061234325170517, mean p set: 0.45035696029663086
The modified gen p mean: 0.44953644275665283, gen p mean: -0.10707025974988937, mean p set: 0.4500633478164673
loss_pred:0.016976142302155495, decouple_loss:0.00100170006044209
loss_pred:0.016837013885378838, decouple_loss:0.0011210334487259388
WV_1_PC_1_EH_0_PS_40, loss: 0.01712697744369507, avg_mse: 0.026504797860980034
current test mse: 0.026505
Iteration: 1821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496464431285858, gen p mean: -0.10248460620641708, mean p set: 0.450222373008728
loss_pred:0.0163970235735178, decouple_loss:0.0010645583970472217
The modified gen p mean: 0.45164722204208374, gen p mean: -0.09656283259391785, mean p set: 0.45222410559654236
loss_pred:0.01723945327103138, decouple_loss:0.0009936847491189837
The modified gen p mean: 0.4523942172527313, gen p mean: -0.10039383918046951, mean p set: 0.4529705345630646
loss_pred:0.016604213044047356, decouple_loss:0.0010770426597446203
Iteration: 1822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817331433296204, gen p mean: -0.10283993184566498, mean p set: 0.4487481415271759
loss_pred:0.016504472121596336, decouple_loss:0.0007034847512841225
The modified gen p mean: 0.44903337955474854, gen p mean: -0.09587840735912323, mean p set: 0.4496089518070221The modified gen p mean: 0.4485694169998169, gen p mean: -0.09427997469902039, mean p set: 0.44914600253105164
loss_pred:0.017785517498850822, decouple_loss:0.0007994431653060019loss_pred:0.01650441437959671, decouple_loss:0.0008205591002479196
Iteration: 1823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44871923327445984, gen p mean: -0.09305256605148315, mean p set: 0.44929495453834534
loss_pred:0.01666426844894886, decouple_loss:0.0007570752059109509
The modified gen p mean: 0.4485568702220917, gen p mean: -0.09894144535064697, mean p set: 0.4491318166255951
loss_pred:0.016477426514029503, decouple_loss:0.0008978491532616317
The modified gen p mean: 0.44903674721717834, gen p mean: -0.09572812169790268, mean p set: 0.44961294531822205
loss_pred:0.016947615891695023, decouple_loss:0.000905750086531043
Iteration: 1824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501548409461975, gen p mean: -0.09124733507633209, mean p set: 0.4507306218147278
The modified gen p mean: 0.4516300559043884, gen p mean: -0.0830969512462616, mean p set: 0.45220720767974854
loss_pred:0.016304440796375275, decouple_loss:0.0007744184113107622
loss_pred:0.017041075974702835, decouple_loss:0.0010605993447825313
The modified gen p mean: 0.4504030644893646, gen p mean: -0.08749151974916458, mean p set: 0.45097923278808594
loss_pred:0.016192110255360603, decouple_loss:0.0009366311714984477
Iteration: 1825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500124156475067, gen p mean: -0.08296455442905426, mean p set: 0.4505888819694519
loss_pred:0.017084060236811638, decouple_loss:0.0008525457233190536
The modified gen p mean: 0.44961532950401306, gen p mean: -0.08902093023061752, mean p set: 0.4501922130584717
loss_pred:0.01654641702771187, decouple_loss:0.0008550929487682879
The modified gen p mean: 0.4508941173553467, gen p mean: -0.07537849247455597, mean p set: 0.45147207379341125
loss_pred:0.0170268751680851, decouple_loss:0.0009491168893873692
Iteration: 1826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489317834377289, gen p mean: -0.09136539697647095, mean p set: 0.4495096802711487
loss_pred:0.016620639711618423, decouple_loss:0.0008270171238109469
The modified gen p mean: 0.44947901368141174, gen p mean: -0.09336625784635544, mean p set: 0.45005717873573303
loss_pred:0.016668403521180153, decouple_loss:0.0007727221818640828
The modified gen p mean: 0.4487960636615753, gen p mean: -0.08592849969863892, mean p set: 0.4493706524372101
loss_pred:0.016255784779787064, decouple_loss:0.000831460056360811
Iteration: 1827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503873884677887, gen p mean: -0.08327498286962509, mean p set: 0.450965940952301
The modified gen p mean: 0.44941380620002747, gen p mean: -0.09126358479261398, mean p set: 0.44999220967292786
loss_pred:0.016729863360524178, decouple_loss:0.0007553304312750697
loss_pred:0.01612328737974167, decouple_loss:0.000697301235049963
The modified gen p mean: 0.4503977298736572, gen p mean: -0.08935842663049698, mean p set: 0.45097601413726807
loss_pred:0.01748794876039028, decouple_loss:0.0007064829696901143
Iteration: 1828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504351019859314, gen p mean: -0.09434264153242111, mean p set: 0.45101216435432434
loss_pred:0.01689288765192032, decouple_loss:0.0008647755603305995
The modified gen p mean: 0.448345422744751, gen p mean: -0.09878081828355789, mean p set: 0.44892165064811707
loss_pred:0.016344014555215836, decouple_loss:0.0009873068192973733
The modified gen p mean: 0.45102229714393616, gen p mean: -0.09003522992134094, mean p set: 0.4515989124774933
loss_pred:0.017401257529854774, decouple_loss:0.0008930809563025832
Iteration: 1829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450908899307251, gen p mean: -0.09652408212423325, mean p set: 0.45148617029190063
loss_pred:0.017458507791161537, decouple_loss:0.0010135687189176679
The modified gen p mean: 0.4488871693611145, gen p mean: -0.09974527359008789, mean p set: 0.4494609236717224
loss_pred:0.01679425872862339, decouple_loss:0.0007659591501578689
The modified gen p mean: 0.4482309818267822, gen p mean: -0.10346701741218567, mean p set: 0.44880592823028564
loss_pred:0.0167691633105278, decouple_loss:0.000740008894354105
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 1830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484933614730835, gen p mean: -0.11656633019447327, mean p set: 0.4490697383880615
loss_pred:0.01615254208445549, decouple_loss:0.0011088722385466099
The modified gen p mean: 0.446924090385437, gen p mean: -0.10798417776823044, mean p set: 0.44749921560287476
loss_pred:0.01683724857866764, decouple_loss:0.000758817361202091
The modified gen p mean: 0.4471052289009094, gen p mean: -0.11323969066143036, mean p set: 0.44768041372299194
loss_pred:0.015921270474791527, decouple_loss:0.000995798734948039
2023-05-01 06:17:46 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11611060798168182, mean p set: 0.4502691626548767
loss_pred:0.01750749722123146, decouple_loss:0.0009169852710328996
The modified gen p mean: 0.449537068605423, gen p mean: -0.11012128740549088, mean p set: 0.4500633478164673
loss_pred:0.016853053122758865, decouple_loss:0.0008608083589933813
The modified gen p mean: 0.4498261511325836, gen p mean: -0.10969050973653793, mean p set: 0.45035696029663086
loss_pred:0.017120953649282455, decouple_loss:0.000815582403447479
WV_1_PC_1_EH_0_PS_40, loss: 0.01720372401177883, avg_mse: 0.026570085436105728
current test mse: 0.02657
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44748514890670776, gen p mean: -0.1147821843624115, mean p set: 0.4480603337287903
loss_pred:0.016462795436382294, decouple_loss:0.0009674181346781552
The modified gen p mean: 0.44743064045906067, gen p mean: -0.11587608605623245, mean p set: 0.44800713658332825The modified gen p mean: 0.44756805896759033, gen p mean: -0.1107255145907402, mean p set: 0.4481445848941803
loss_pred:0.016191862523555756, decouple_loss:0.0008152870577760041
loss_pred:0.01594117283821106, decouple_loss:0.0006950598326511681
Iteration: 1832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462105333805084, gen p mean: -0.11422913521528244, mean p set: 0.44678664207458496
loss_pred:0.016026580706238747, decouple_loss:0.0009613821748644114
The modified gen p mean: 0.4484904706478119, gen p mean: -0.1193188950419426, mean p set: 0.4490669369697571The modified gen p mean: 0.44705691933631897, gen p mean: -0.11166217923164368, mean p set: 0.44763314723968506
loss_pred:0.016128171235322952, decouple_loss:0.0007979082292877138
loss_pred:0.016803938895463943, decouple_loss:0.0009731239406391978
Iteration: 1833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459187090396881, gen p mean: -0.11631863564252853, mean p set: 0.44649389386177063
loss_pred:0.015597272664308548, decouple_loss:0.0007027661777101457
The modified gen p mean: 0.44756895303726196, gen p mean: -0.11742936074733734, mean p set: 0.4481448233127594
loss_pred:0.016310332342982292, decouple_loss:0.0008302590576931834
The modified gen p mean: 0.44769397377967834, gen p mean: -0.1190771535038948, mean p set: 0.4482708275318146
loss_pred:0.01724177598953247, decouple_loss:0.0006843362934887409
Iteration: 1834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688868522644043, gen p mean: -0.11319123208522797, mean p set: 0.4474641680717468
loss_pred:0.017485611140727997, decouple_loss:0.00114735821262002
The modified gen p mean: 0.4480334520339966, gen p mean: -0.11619852483272552, mean p set: 0.4486115872859955
loss_pred:0.0164569690823555, decouple_loss:0.0010848931269720197
The modified gen p mean: 0.4482334554195404, gen p mean: -0.11827431619167328, mean p set: 0.4488099217414856
loss_pred:0.01705503836274147, decouple_loss:0.0008909299504011869
Iteration: 1835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472019672393799, gen p mean: -0.11736045777797699, mean p set: 0.4477778375148773
loss_pred:0.015652338042855263, decouple_loss:0.0010221635457128286
The modified gen p mean: 0.4470950961112976, gen p mean: -0.12167682498693466, mean p set: 0.44767072796821594
loss_pred:0.01661233976483345, decouple_loss:0.0011237465078011155
The modified gen p mean: 0.447201132774353, gen p mean: -0.11476919054985046, mean p set: 0.44777771830558777
loss_pred:0.016711752861738205, decouple_loss:0.0009331833571195602
Iteration: 1836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667530059814453, gen p mean: -0.11380726844072342, mean p set: 0.44725102186203003
loss_pred:0.015680573880672455, decouple_loss:0.0006355493678711355
The modified gen p mean: 0.44752368330955505, gen p mean: -0.11395680159330368, mean p set: 0.4481000304222107
loss_pred:0.01639849692583084, decouple_loss:0.0007989010191522539
The modified gen p mean: 0.4475114941596985, gen p mean: -0.11329805850982666, mean p set: 0.4480897784233093
loss_pred:0.016214799135923386, decouple_loss:0.0008602396701462567
Iteration: 1837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480455219745636, gen p mean: -0.11729397624731064, mean p set: 0.4486217796802521
loss_pred:0.01577778533101082, decouple_loss:0.000833346915896982
The modified gen p mean: 0.4467177391052246, gen p mean: -0.11451014876365662, mean p set: 0.44729599356651306
The modified gen p mean: 0.44794049859046936, gen p mean: -0.11728905141353607, mean p set: 0.4485156238079071
loss_pred:0.015528582036495209, decouple_loss:0.0009480991866439581
loss_pred:0.015458119101822376, decouple_loss:0.0007302735466510057
Iteration: 1838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477202594280243, gen p mean: -0.11774606257677078, mean p set: 0.4482952058315277
loss_pred:0.015864046290516853, decouple_loss:0.0008907077717594802
The modified gen p mean: 0.4473901093006134, gen p mean: -0.10710685700178146, mean p set: 0.4479668438434601
loss_pred:0.017085183411836624, decouple_loss:0.0010827953228726983
The modified gen p mean: 0.44708630442619324, gen p mean: -0.11183711886405945, mean p set: 0.4476606547832489
loss_pred:0.016570404171943665, decouple_loss:0.000884016917552799
Iteration: 1839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44709715247154236, gen p mean: -0.10880608856678009, mean p set: 0.44767072796821594
loss_pred:0.01665659435093403, decouple_loss:0.0008312587160617113
The modified gen p mean: 0.4476679563522339, gen p mean: -0.1129811629652977, mean p set: 0.4482428729534149
The modified gen p mean: 0.4478130042552948, gen p mean: -0.10857298970222473, mean p set: 0.4483889639377594
loss_pred:0.016063878312706947, decouple_loss:0.0009332440095022321
loss_pred:0.015923060476779938, decouple_loss:0.0007314386893995106
Iteration: 1840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468201696872711, gen p mean: -0.1120651364326477, mean p set: 0.44739648699760437
loss_pred:0.01666300557553768, decouple_loss:0.0008346783579327166
The modified gen p mean: 0.44766902923583984, gen p mean: -0.11118759959936142, mean p set: 0.44824355840682983
The modified gen p mean: 0.4471706449985504, gen p mean: -0.11227981746196747, mean p set: 0.44774720072746277
loss_pred:0.01648283563554287, decouple_loss:0.0010396877769380808
loss_pred:0.01554393395781517, decouple_loss:0.0008629477233625948
2023-05-01 06:19:51 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11426785588264465, mean p set: 0.4502691626548767
loss_pred:0.01732938177883625, decouple_loss:0.0007756509003229439
The modified gen p mean: 0.44953426718711853, gen p mean: -0.10840455442667007, mean p set: 0.4500633478164673
loss_pred:0.016775574535131454, decouple_loss:0.0008012285688892007
The modified gen p mean: 0.44982782006263733, gen p mean: -0.107627734541893, mean p set: 0.45035696029663086
loss_pred:0.017115522176027298, decouple_loss:0.0007329489453695714
WV_1_PC_1_EH_0_PS_40, loss: 0.017111990600824356, avg_mse: 0.026548149064183235
current test mse: 0.026548
Iteration: 1841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477587342262268, gen p mean: -0.10998421162366867, mean p set: 0.44833505153656006
loss_pred:0.01623794063925743, decouple_loss:0.0009743085829541087
The modified gen p mean: 0.4461812376976013, gen p mean: -0.10889963805675507, mean p set: 0.4467572569847107The modified gen p mean: 0.4475364685058594, gen p mean: -0.11089392751455307, mean p set: 0.4481123387813568
loss_pred:0.015154058113694191, decouple_loss:0.0007032682187855244
loss_pred:0.015385005623102188, decouple_loss:0.0006995635339990258
Iteration: 1842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743019342422485, gen p mean: -0.11397237330675125, mean p set: 0.4480067491531372
loss_pred:0.016179149970412254, decouple_loss:0.0007106639095582068
The modified gen p mean: 0.447260320186615, gen p mean: -0.10976452380418777, mean p set: 0.44783589243888855The modified gen p mean: 0.446981817483902, gen p mean: -0.1045321673154831, mean p set: 0.44755926728248596
loss_pred:0.015359047800302505, decouple_loss:0.0006302359397523105loss_pred:0.016859758645296097, decouple_loss:0.000829544267617166
Iteration: 1843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764718413352966, gen p mean: -0.10546960681676865, mean p set: 0.4482216238975525
loss_pred:0.01671280525624752, decouple_loss:0.0008449119632132351
The modified gen p mean: 0.44722944498062134, gen p mean: -0.10729590803384781, mean p set: 0.4478038251399994The modified gen p mean: 0.4473964273929596, gen p mean: -0.10712073743343353, mean p set: 0.4479702413082123
loss_pred:0.016015786677598953, decouple_loss:0.000879970844835043
loss_pred:0.015925072133541107, decouple_loss:0.0010261534480378032
Iteration: 1844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713321328163147, gen p mean: -0.10689657926559448, mean p set: 0.44771143794059753
The modified gen p mean: 0.4474276006221771, gen p mean: -0.1102166622877121, mean p set: 0.4480043649673462
loss_pred:0.01664835214614868, decouple_loss:0.0009474606486037374
loss_pred:0.0163436122238636, decouple_loss:0.0007708061602897942
The modified gen p mean: 0.4474605619907379, gen p mean: -0.10568691790103912, mean p set: 0.4480361342430115
loss_pred:0.015967957675457, decouple_loss:0.0007334398687817156
Iteration: 1845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708719849586487, gen p mean: -0.10662488639354706, mean p set: 0.4476645588874817
The modified gen p mean: 0.44702327251434326, gen p mean: -0.10416106879711151, mean p set: 0.4475988745689392
loss_pred:0.01554543524980545, decouple_loss:0.0008526784949935973
loss_pred:0.01616489142179489, decouple_loss:0.001216926029883325
The modified gen p mean: 0.4474412500858307, gen p mean: -0.10571929067373276, mean p set: 0.4480176270008087
loss_pred:0.016262950375676155, decouple_loss:0.000907129084225744
Iteration: 1846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470045566558838, gen p mean: -0.11488331109285355, mean p set: 0.44758090376853943
loss_pred:0.015786107629537582, decouple_loss:0.0008056375663727522
The modified gen p mean: 0.4476967453956604, gen p mean: -0.10705556720495224, mean p set: 0.4482730031013489
loss_pred:0.015556680038571358, decouple_loss:0.0007694813539274037
The modified gen p mean: 0.4472428858280182, gen p mean: -0.1053442507982254, mean p set: 0.44781771302223206
loss_pred:0.01653733104467392, decouple_loss:0.0009710666490718722
Iteration: 1847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473504424095154, gen p mean: -0.11223075538873672, mean p set: 0.44792598485946655
loss_pred:0.016079651191830635, decouple_loss:0.0007990582380443811
The modified gen p mean: 0.44736260175704956, gen p mean: -0.10976795107126236, mean p set: 0.44793930649757385
loss_pred:0.016683164983987808, decouple_loss:0.0009479410364292562
The modified gen p mean: 0.44686707854270935, gen p mean: -0.10911459475755692, mean p set: 0.447443425655365
loss_pred:0.015795936807990074, decouple_loss:0.0009409099584445357
Iteration: 1848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475013315677643, gen p mean: -0.11091991513967514, mean p set: 0.44807714223861694
loss_pred:0.01609560288488865, decouple_loss:0.0008069073664955795
The modified gen p mean: 0.4474931061267853, gen p mean: -0.11104106903076172, mean p set: 0.44806763529777527
The modified gen p mean: 0.4479122757911682, gen p mean: -0.11477899551391602, mean p set: 0.44848695397377014
loss_pred:0.015720359981060028, decouple_loss:0.00099648954346776
loss_pred:0.015661168843507767, decouple_loss:0.0006854275707155466
Iteration: 1849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464491605758667, gen p mean: -0.11099439859390259, mean p set: 0.44702383875846863
The modified gen p mean: 0.44762682914733887, gen p mean: -0.11175999045372009, mean p set: 0.44820162653923035
loss_pred:0.015577907674014568, decouple_loss:0.0007244768203236163
loss_pred:0.016289951279759407, decouple_loss:0.0007575085619464517
The modified gen p mean: 0.447296142578125, gen p mean: -0.10740525275468826, mean p set: 0.4478713572025299
loss_pred:0.016329679638147354, decouple_loss:0.000783694616984576
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 1850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786161184310913, gen p mean: -0.1175571084022522, mean p set: 0.44843539595603943The modified gen p mean: 0.4489162266254425, gen p mean: -0.11829240620136261, mean p set: 0.44949212670326233
loss_pred:0.015086118131875992, decouple_loss:0.0008573635132052004
loss_pred:0.015235776081681252, decouple_loss:0.0008017596555873752
The modified gen p mean: 0.44713786244392395, gen p mean: -0.11476730555295944, mean p set: 0.4477138817310333
loss_pred:0.015460344962775707, decouple_loss:0.0007364031625911593
2023-05-01 06:22:38 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.11668901145458221, mean p set: 0.4502691626548767
loss_pred:0.017297884449362755, decouple_loss:0.0007495127501897514
The modified gen p mean: 0.4495355486869812, gen p mean: -0.11071065813302994, mean p set: 0.4500633478164673
loss_pred:0.016560358926653862, decouple_loss:0.0008509931503795087
The modified gen p mean: 0.44982805848121643, gen p mean: -0.11042501032352448, mean p set: 0.45035696029663086
loss_pred:0.01689809001982212, decouple_loss:0.0007091168081387877
WV_1_PC_1_EH_0_PS_40, loss: 0.016957273706793785, avg_mse: 0.02634415030479431
current test mse: 0.026344
Iteration: 1851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734179973602295, gen p mean: -0.11097707599401474, mean p set: 0.4479168951511383
loss_pred:0.015006800182163715, decouple_loss:0.0006036064005456865
The modified gen p mean: 0.44856229424476624, gen p mean: -0.11884421855211258, mean p set: 0.44913914799690247
The modified gen p mean: 0.4482566714286804, gen p mean: -0.11230730265378952, mean p set: 0.4488321542739868
loss_pred:0.015855638310313225, decouple_loss:0.0007390863029286265
loss_pred:0.01519849244505167, decouple_loss:0.0006888287607580423
Iteration: 1852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469251334667206, gen p mean: -0.1147913932800293, mean p set: 0.4475022256374359
The modified gen p mean: 0.44816863536834717, gen p mean: -0.11356619000434875, mean p set: 0.4487445652484894
loss_pred:0.015474359504878521, decouple_loss:0.0007399338646791875
loss_pred:0.015479289926588535, decouple_loss:0.0006758275558240712
The modified gen p mean: 0.4469897747039795, gen p mean: -0.11461000889539719, mean p set: 0.4475656747817993
loss_pred:0.015479011461138725, decouple_loss:0.000674382143188268
Iteration: 1853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479474723339081, gen p mean: -0.11417341977357864, mean p set: 0.4485243558883667
loss_pred:0.014905037358403206, decouple_loss:0.0007929441635496914
The modified gen p mean: 0.44714733958244324, gen p mean: -0.11411435157060623, mean p set: 0.44772249460220337
loss_pred:0.015667220577597618, decouple_loss:0.0008842418319545686
The modified gen p mean: 0.4468499422073364, gen p mean: -0.11550440639257431, mean p set: 0.44742488861083984
loss_pred:0.016402453184127808, decouple_loss:0.0007239227998070419
Iteration: 1854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44514039158821106, gen p mean: -0.11708677560091019, mean p set: 0.44571492075920105
loss_pred:0.015172524377703667, decouple_loss:0.0008280111942440271
The modified gen p mean: 0.44721120595932007, gen p mean: -0.11301401257514954, mean p set: 0.44778627157211304
loss_pred:0.015424611046910286, decouple_loss:0.0009467820054851472
The modified gen p mean: 0.4469962418079376, gen p mean: -0.11278615891933441, mean p set: 0.44757208228111267
loss_pred:0.01501627266407013, decouple_loss:0.0008029384189285338
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476597011089325, gen p mean: -0.11955912411212921, mean p set: 0.44823282957077026
loss_pred:0.015880106016993523, decouple_loss:0.0008175306138582528
The modified gen p mean: 0.44772985577583313, gen p mean: -0.11102701723575592, mean p set: 0.4483067989349365
loss_pred:0.015877386555075645, decouple_loss:0.0006336159422062337
The modified gen p mean: 0.4465937614440918, gen p mean: -0.11573754251003265, mean p set: 0.44717034697532654
loss_pred:0.01625104993581772, decouple_loss:0.0008469359017908573
Iteration: 1856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44833889603614807, gen p mean: -0.11805985122919083, mean p set: 0.4489142596721649
The modified gen p mean: 0.44656649231910706, gen p mean: -0.11502249538898468, mean p set: 0.44714486598968506
loss_pred:0.015269188210368156, decouple_loss:0.0008143725572153926
loss_pred:0.015649763867259026, decouple_loss:0.0009000931750051677
The modified gen p mean: 0.4476102590560913, gen p mean: -0.11796494573354721, mean p set: 0.44818755984306335
loss_pred:0.015674233436584473, decouple_loss:0.001000382355414331
Iteration: 1857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485163986682892, gen p mean: -0.12215407937765121, mean p set: 0.449090838432312
loss_pred:0.015200603753328323, decouple_loss:0.0006776801310479641
The modified gen p mean: 0.44719597697257996, gen p mean: -0.11229516565799713, mean p set: 0.44777190685272217
loss_pred:0.014639490284025669, decouple_loss:0.0006797367241233587
The modified gen p mean: 0.44653812050819397, gen p mean: -0.1126408651471138, mean p set: 0.4471120834350586
loss_pred:0.015645045787096024, decouple_loss:0.0007783175096847117
Iteration: 1858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44564905762672424, gen p mean: -0.11868036538362503, mean p set: 0.4462227523326874
loss_pred:0.014889112673699856, decouple_loss:0.00078103895066306
The modified gen p mean: 0.4464404582977295, gen p mean: -0.11453231424093246, mean p set: 0.44701406359672546
loss_pred:0.016240403056144714, decouple_loss:0.0010638225357979536
The modified gen p mean: 0.4487220346927643, gen p mean: -0.11638625711202621, mean p set: 0.44929662346839905
loss_pred:0.015100674703717232, decouple_loss:0.0008635891717858613
Iteration: 1859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807687401771545, gen p mean: -0.11380848288536072, mean p set: 0.4486530125141144
loss_pred:0.016102034598588943, decouple_loss:0.0009315175120718777
The modified gen p mean: 0.44805535674095154, gen p mean: -0.11516308039426804, mean p set: 0.4486321210861206
The modified gen p mean: 0.4465250074863434, gen p mean: -0.11787757277488708, mean p set: 0.44710099697113037
loss_pred:0.014930051751434803, decouple_loss:0.0006982572958804667
loss_pred:0.015009162947535515, decouple_loss:0.0007770538213662803
Iteration: 1860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869929552078247, gen p mean: -0.11939768493175507, mean p set: 0.44927650690078735
loss_pred:0.014801394194364548, decouple_loss:0.0007175484206527472
The modified gen p mean: 0.44777122139930725, gen p mean: -0.11472711712121964, mean p set: 0.4483468234539032
loss_pred:0.01483293529599905, decouple_loss:0.0005955496453680098
The modified gen p mean: 0.44790345430374146, gen p mean: -0.11570713669061661, mean p set: 0.44847849011421204
loss_pred:0.015117350034415722, decouple_loss:0.0006294231861829758
2023-05-01 06:24:43 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1148558259010315, mean p set: 0.4502691626548767
loss_pred:0.017202643677592278, decouple_loss:0.0006238588830456138
The modified gen p mean: 0.4495367109775543, gen p mean: -0.10953225195407867, mean p set: 0.4500633478164673
loss_pred:0.016577327623963356, decouple_loss:0.000825757859274745
The modified gen p mean: 0.449828565120697, gen p mean: -0.10915788263082504, mean p set: 0.45035696029663086
loss_pred:0.01684447191655636, decouple_loss:0.0007250320049934089
WV_1_PC_1_EH_0_PS_40, loss: 0.016911059617996216, avg_mse: 0.02627556584775448
current test mse: 0.026276
At step 1860, Best test: 0.026276
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 1861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756773114204407, gen p mean: -0.11398813128471375, mean p set: 0.4481431543827057
loss_pred:0.01498333364725113, decouple_loss:0.0006680009537376463
The modified gen p mean: 0.44666585326194763, gen p mean: -0.10962700098752975, mean p set: 0.4472406804561615
loss_pred:0.01524879690259695, decouple_loss:0.000697547453455627
The modified gen p mean: 0.4480575919151306, gen p mean: -0.11716707050800323, mean p set: 0.4486336410045624
loss_pred:0.015489447861909866, decouple_loss:0.0006948743248358369
Iteration: 1862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461335241794586, gen p mean: -0.11242219060659409, mean p set: 0.4467092752456665
loss_pred:0.0160618145018816, decouple_loss:0.0006519683520309627
The modified gen p mean: 0.4478093981742859, gen p mean: -0.11491504311561584, mean p set: 0.4483872950077057The modified gen p mean: 0.4469722509384155, gen p mean: -0.11193092167377472, mean p set: 0.44754740595817566
loss_pred:0.015353088267147541, decouple_loss:0.0005916905356571078
loss_pred:0.015796663239598274, decouple_loss:0.000770251324865967
Iteration: 1863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677799940109253, gen p mean: -0.10992321372032166, mean p set: 0.4473552703857422
loss_pred:0.015291188843548298, decouple_loss:0.0006126133957877755
The modified gen p mean: 0.447198748588562, gen p mean: -0.10641980171203613, mean p set: 0.4477720260620117The modified gen p mean: 0.44815632700920105, gen p mean: -0.11029250919818878, mean p set: 0.44873204827308655
loss_pred:0.01528483722358942, decouple_loss:0.000725210877135396
loss_pred:0.014683008193969727, decouple_loss:0.0006350214243866503
Iteration: 1864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690003991127014, gen p mean: -0.10890549421310425, mean p set: 0.44747447967529297
The modified gen p mean: 0.44591739773750305, gen p mean: -0.1044134572148323, mean p set: 0.44649171829223633
loss_pred:0.015063563361763954, decouple_loss:0.0006669859285466373
loss_pred:0.015663087368011475, decouple_loss:0.0008841389790177345
The modified gen p mean: 0.44587618112564087, gen p mean: -0.11150587350130081, mean p set: 0.4464513063430786
loss_pred:0.015959111973643303, decouple_loss:0.000678699929267168
Iteration: 1865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801899790763855, gen p mean: -0.10528039932250977, mean p set: 0.44859448075294495
The modified gen p mean: 0.44746100902557373, gen p mean: -0.10840285569429398, mean p set: 0.44803762435913086
loss_pred:0.015758587047457695, decouple_loss:0.0006261693779379129
loss_pred:0.015334811061620712, decouple_loss:0.0005348213599063456
The modified gen p mean: 0.44593918323516846, gen p mean: -0.11230417340993881, mean p set: 0.44651445746421814
loss_pred:0.014701242558658123, decouple_loss:0.0006232150481082499
Iteration: 1866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462965428829193, gen p mean: -0.11097114533185959, mean p set: 0.44687098264694214
loss_pred:0.014617021195590496, decouple_loss:0.0006350507028400898
The modified gen p mean: 0.44629737734794617, gen p mean: -0.1122257336974144, mean p set: 0.44687342643737793
loss_pred:0.01621963456273079, decouple_loss:0.0009440712747164071
The modified gen p mean: 0.44713178277015686, gen p mean: -0.11003806442022324, mean p set: 0.4477066397666931
loss_pred:0.015246733091771603, decouple_loss:0.0005384546821005642
Iteration: 1867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445482075214386, gen p mean: -0.1139911562204361, mean p set: 0.4460570514202118
loss_pred:0.01461256854236126, decouple_loss:0.0008490553009323776
The modified gen p mean: 0.44605812430381775, gen p mean: -0.11066289991140366, mean p set: 0.4466347098350525
loss_pred:0.01486242190003395, decouple_loss:0.0005672283587045968
The modified gen p mean: 0.44740569591522217, gen p mean: -0.11128916591405869, mean p set: 0.4479806125164032
loss_pred:0.014843125827610493, decouple_loss:0.0005497352103702724
Iteration: 1868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464959502220154, gen p mean: -0.11251594126224518, mean p set: 0.4470709264278412
loss_pred:0.01619412936270237, decouple_loss:0.0007427615346387029
The modified gen p mean: 0.4463832378387451, gen p mean: -0.11075717210769653, mean p set: 0.44696107506752014
loss_pred:0.015366722829639912, decouple_loss:0.0006649007555097342
The modified gen p mean: 0.44793984293937683, gen p mean: -0.10924166440963745, mean p set: 0.4485151767730713
loss_pred:0.014863071031868458, decouple_loss:0.0005995217943564057
Iteration: 1869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487098455429077, gen p mean: -0.11179473996162415, mean p set: 0.44928810000419617
loss_pred:0.015392489731311798, decouple_loss:0.0009028213680721819
The modified gen p mean: 0.4471060335636139, gen p mean: -0.1097412183880806, mean p set: 0.44768208265304565
loss_pred:0.014560692012310028, decouple_loss:0.0008991382783278823
The modified gen p mean: 0.44634711742401123, gen p mean: -0.11009430140256882, mean p set: 0.4469250440597534
loss_pred:0.016330592334270477, decouple_loss:0.0006812777137383819
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
NaN value num: 0
Iteration: 1870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45188653469085693, gen p mean: -0.09877169877290726, mean p set: 0.4524637460708618
The modified gen p mean: 0.4501665532588959, gen p mean: -0.10477986186742783, mean p set: 0.45074281096458435
loss_pred:0.017688944935798645, decouple_loss:0.0007592273177579045
loss_pred:0.01678132452070713, decouple_loss:0.0007108031422831118
The modified gen p mean: 0.4497864246368408, gen p mean: -0.0965602695941925, mean p set: 0.45036324858665466
loss_pred:0.016581011936068535, decouple_loss:0.000774615618865937
2023-05-01 06:27:33 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11097933351993561, mean p set: 0.4502691626548767
loss_pred:0.017254086211323738, decouple_loss:0.0006705197156406939
The modified gen p mean: 0.4495336711406708, gen p mean: -0.10534246265888214, mean p set: 0.4500633478164673
loss_pred:0.016557328402996063, decouple_loss:0.0007318731513805687
The modified gen p mean: 0.44982877373695374, gen p mean: -0.10469407588243484, mean p set: 0.45035696029663086
loss_pred:0.016875242814421654, decouple_loss:0.0007067902479320765
WV_1_PC_1_EH_0_PS_40, loss: 0.016930706799030304, avg_mse: 0.02627161331474781
current test mse: 0.026272
At step 1870, Best test: 0.026272
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 1871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503355324268341, gen p mean: -0.10181604325771332, mean p set: 0.4509148597717285
loss_pred:0.015943143516778946, decouple_loss:0.0008135942625813186
The modified gen p mean: 0.4522109031677246, gen p mean: -0.09952615946531296, mean p set: 0.4527881443500519
loss_pred:0.01717708259820938, decouple_loss:0.0006886103074066341
The modified gen p mean: 0.45193353295326233, gen p mean: -0.10061272978782654, mean p set: 0.4525114893913269
loss_pred:0.01737980917096138, decouple_loss:0.0009560438338667154
Iteration: 1872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519387483596802, gen p mean: -0.10004681348800659, mean p set: 0.452515572309494
loss_pred:0.016845915466547012, decouple_loss:0.000912178831640631
The modified gen p mean: 0.4491408169269562, gen p mean: -0.1023545041680336, mean p set: 0.4497171640396118The modified gen p mean: 0.4516049921512604, gen p mean: -0.09897547960281372, mean p set: 0.45218008756637573
loss_pred:0.015885792672634125, decouple_loss:0.0008116416283883154
loss_pred:0.01711224392056465, decouple_loss:0.0008068305323831737
Iteration: 1873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490106403827667, gen p mean: -0.10256535559892654, mean p set: 0.4495861530303955
loss_pred:0.017216244712471962, decouple_loss:0.0008613284444436431
The modified gen p mean: 0.45154568552970886, gen p mean: -0.09655704349279404, mean p set: 0.4521242678165436
loss_pred:0.017163600772619247, decouple_loss:0.0010450114496052265
The modified gen p mean: 0.4518563747406006, gen p mean: -0.1000547707080841, mean p set: 0.4524324834346771
loss_pred:0.016485586762428284, decouple_loss:0.0008123500738292933
Iteration: 1874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493946433067322, gen p mean: -0.10456697642803192, mean p set: 0.44997072219848633
loss_pred:0.016926327720284462, decouple_loss:0.0006161488709039986
The modified gen p mean: 0.4502068758010864, gen p mean: -0.09480369836091995, mean p set: 0.4507834315299988
loss_pred:0.01600068062543869, decouple_loss:0.0007512352894991636
The modified gen p mean: 0.4487142264842987, gen p mean: -0.10269555449485779, mean p set: 0.44929152727127075
loss_pred:0.01706773415207863, decouple_loss:0.0010332741076126695
Iteration: 1875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44983839988708496, gen p mean: -0.10133969038724899, mean p set: 0.4504155218601227
loss_pred:0.018021171912550926, decouple_loss:0.0007895648595876992
The modified gen p mean: 0.4516150951385498, gen p mean: -0.10063096880912781, mean p set: 0.4521923363208771
loss_pred:0.016826579347252846, decouple_loss:0.0008585671312175691
The modified gen p mean: 0.4513844847679138, gen p mean: -0.09946015477180481, mean p set: 0.45195919275283813
loss_pred:0.016583537682890892, decouple_loss:0.0012286098208278418
Iteration: 1876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45130500197410583, gen p mean: -0.09871970862150192, mean p set: 0.45188307762145996
loss_pred:0.017003843560814857, decouple_loss:0.0009851205395534635
The modified gen p mean: 0.44974496960639954, gen p mean: -0.10414156317710876, mean p set: 0.4503243863582611
The modified gen p mean: 0.4521695673465729, gen p mean: -0.0960654690861702, mean p set: 0.45274588465690613
loss_pred:0.015975402668118477, decouple_loss:0.0008793618762865663
loss_pred:0.016123218461871147, decouple_loss:0.0010850448161363602
Iteration: 1877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523112177848816, gen p mean: -0.1023561954498291, mean p set: 0.45288676023483276
loss_pred:0.017095886170864105, decouple_loss:0.0006139747565612197
The modified gen p mean: 0.4522400200366974, gen p mean: -0.10530112683773041, mean p set: 0.45281848311424255
The modified gen p mean: 0.452015221118927, gen p mean: -0.10608093440532684, mean p set: 0.4525927007198334
loss_pred:0.01686440035700798, decouple_loss:0.0008541112183593214
loss_pred:0.01586681418120861, decouple_loss:0.0007670332561247051
Iteration: 1878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45219793915748596, gen p mean: -0.10310705006122589, mean p set: 0.4527750313282013
loss_pred:0.016405221074819565, decouple_loss:0.0009627934196032584
The modified gen p mean: 0.44932493567466736, gen p mean: -0.10690914839506149, mean p set: 0.4499017596244812
The modified gen p mean: 0.448787659406662, gen p mean: -0.10545075684785843, mean p set: 0.4493626356124878
loss_pred:0.018052132800221443, decouple_loss:0.0010148128494620323
loss_pred:0.016565565019845963, decouple_loss:0.000913265801500529
Iteration: 1879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45194798707962036, gen p mean: -0.10405062139034271, mean p set: 0.4525245130062103
loss_pred:0.015579376369714737, decouple_loss:0.0008523412980139256
The modified gen p mean: 0.45166677236557007, gen p mean: -0.1026591807603836, mean p set: 0.4522422254085541
loss_pred:0.016719000414013863, decouple_loss:0.00091213034465909
The modified gen p mean: 0.4496705234050751, gen p mean: -0.10569699108600616, mean p set: 0.4502466022968292
loss_pred:0.016835598275065422, decouple_loss:0.0009109132806770504
Iteration: 1880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45217305421829224, gen p mean: -0.09983818233013153, mean p set: 0.45275044441223145
loss_pred:0.016477659344673157, decouple_loss:0.0009916021954268217
The modified gen p mean: 0.4493715763092041, gen p mean: -0.10642451792955399, mean p set: 0.449949711561203
The modified gen p mean: 0.4501829147338867, gen p mean: -0.10758272558450699, mean p set: 0.4507574439048767
loss_pred:0.015957990661263466, decouple_loss:0.0008140648133121431
loss_pred:0.017180878669023514, decouple_loss:0.0007290827925316989
2023-05-01 06:29:43 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11309238523244858, mean p set: 0.4502691626548767
loss_pred:0.017283683642745018, decouple_loss:0.0008703407947905362
The modified gen p mean: 0.4495336711406708, gen p mean: -0.1070893257856369, mean p set: 0.4500633478164673
loss_pred:0.016631336882710457, decouple_loss:0.0009001224534586072
The modified gen p mean: 0.4498293101787567, gen p mean: -0.1066293716430664, mean p set: 0.45035696029663086
loss_pred:0.016897786408662796, decouple_loss:0.0009001244325190783
WV_1_PC_1_EH_0_PS_40, loss: 0.01698211394250393, avg_mse: 0.026436548680067062
current test mse: 0.026437
Iteration: 1881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44923657178878784, gen p mean: -0.10489065945148468, mean p set: 0.4498138427734375
The modified gen p mean: 0.44980868697166443, gen p mean: -0.10345196723937988, mean p set: 0.4503864049911499
loss_pred:0.016311105340719223, decouple_loss:0.000770347542129457
loss_pred:0.01748860813677311, decouple_loss:0.0007742002489976585
The modified gen p mean: 0.44974514842033386, gen p mean: -0.10306059569120407, mean p set: 0.4503213167190552
loss_pred:0.016097551211714745, decouple_loss:0.0008207838400267065
Iteration: 1882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114076137542725, gen p mean: -0.10168132930994034, mean p set: 0.45171716809272766
loss_pred:0.016955314204096794, decouple_loss:0.0005382638773880899
The modified gen p mean: 0.45159125328063965, gen p mean: -0.10695957392454147, mean p set: 0.4521697759628296The modified gen p mean: 0.45212626457214355, gen p mean: -0.10370978713035583, mean p set: 0.45270055532455444
loss_pred:0.01658325269818306, decouple_loss:0.0008972944924607873
loss_pred:0.01656920090317726, decouple_loss:0.0007355296984314919
Iteration: 1883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497642517089844, gen p mean: -0.11019552499055862, mean p set: 0.45034095644950867
loss_pred:0.016817089170217514, decouple_loss:0.0008761055069044232
The modified gen p mean: 0.44987812638282776, gen p mean: -0.11189243197441101, mean p set: 0.4504547715187073The modified gen p mean: 0.4496360421180725, gen p mean: -0.10995444655418396, mean p set: 0.45021387934684753
loss_pred:0.01791943982243538, decouple_loss:0.0010446941014379263loss_pred:0.016437767073512077, decouple_loss:0.0009395265951752663
Iteration: 1884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450121134519577, gen p mean: -0.11073014885187149, mean p set: 0.4506973326206207
loss_pred:0.016887634992599487, decouple_loss:0.0007402820629067719
The modified gen p mean: 0.4493538439273834, gen p mean: -0.11302220076322556, mean p set: 0.44993001222610474
loss_pred:0.016262367367744446, decouple_loss:0.0008028263691812754
The modified gen p mean: 0.45016083121299744, gen p mean: -0.11275152117013931, mean p set: 0.450737327337265
loss_pred:0.016235413029789925, decouple_loss:0.0008102257270365953
Iteration: 1885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518228769302368, gen p mean: -0.10572726279497147, mean p set: 0.4524017870426178
loss_pred:0.01616424135863781, decouple_loss:0.0007217305828817189
The modified gen p mean: 0.4527801275253296, gen p mean: -0.1104104295372963, mean p set: 0.45335903763771057
loss_pred:0.016177184879779816, decouple_loss:0.0008718477329239249
The modified gen p mean: 0.4516110122203827, gen p mean: -0.1130131334066391, mean p set: 0.45219019055366516
loss_pred:0.01623019017279148, decouple_loss:0.0008284802315756679
Iteration: 1886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521683156490326, gen p mean: -0.11158479005098343, mean p set: 0.452744722366333
loss_pred:0.01591544970870018, decouple_loss:0.000883563538081944
The modified gen p mean: 0.4499156177043915, gen p mean: -0.11370018124580383, mean p set: 0.4504959285259247
The modified gen p mean: 0.45132511854171753, gen p mean: -0.11602724343538284, mean p set: 0.4519013464450836
loss_pred:0.016579806804656982, decouple_loss:0.0006360839470289648
loss_pred:0.01637795940041542, decouple_loss:0.000790246413089335
Iteration: 1887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485710561275482, gen p mean: -0.11553382873535156, mean p set: 0.44915124773979187
loss_pred:0.016545874997973442, decouple_loss:0.0008625807240605354
The modified gen p mean: 0.44889727234840393, gen p mean: -0.12221027910709381, mean p set: 0.4494739770889282
loss_pred:0.017287474125623703, decouple_loss:0.000989309512078762
The modified gen p mean: 0.45177027583122253, gen p mean: -0.11450757086277008, mean p set: 0.4523504674434662
loss_pred:0.01686692237854004, decouple_loss:0.0010501599172130227
Iteration: 1888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077115297317505, gen p mean: -0.11549419909715652, mean p set: 0.4513484537601471
The modified gen p mean: 0.4486544728279114, gen p mean: -0.1196122094988823, mean p set: 0.4492310881614685
loss_pred:0.01585298776626587, decouple_loss:0.0007976629422046244
loss_pred:0.01683596894145012, decouple_loss:0.0007197866216301918
The modified gen p mean: 0.45003455877304077, gen p mean: -0.11601550877094269, mean p set: 0.4506123960018158
loss_pred:0.01640213467180729, decouple_loss:0.0007646150188520551
Iteration: 1889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513346552848816, gen p mean: -0.11320997774600983, mean p set: 0.45191019773483276
loss_pred:0.01675751619040966, decouple_loss:0.0009080207673832774
The modified gen p mean: 0.44931936264038086, gen p mean: -0.11320553719997406, mean p set: 0.44989094138145447
loss_pred:0.016382161527872086, decouple_loss:0.0006157661555334926
The modified gen p mean: 0.44889768958091736, gen p mean: -0.11427086591720581, mean p set: 0.4494730830192566
loss_pred:0.016711069270968437, decouple_loss:0.0007394011481665075
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
NaN value num: 0
Iteration: 1890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517184793949127, gen p mean: -0.11562705039978027, mean p set: 0.4522954225540161
loss_pred:0.015845227986574173, decouple_loss:0.0007077326299622655
The modified gen p mean: 0.45169439911842346, gen p mean: -0.10837716609239578, mean p set: 0.4522706866264343
The modified gen p mean: 0.4509858191013336, gen p mean: -0.11082102358341217, mean p set: 0.4515630006790161
loss_pred:0.01682281866669655, decouple_loss:0.0007265611784532666
loss_pred:0.01587974652647972, decouple_loss:0.0010079755447804928
2023-05-01 06:32:29 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11738511919975281, mean p set: 0.4502691626548767
loss_pred:0.017422758042812347, decouple_loss:0.0006725811399519444
The modified gen p mean: 0.44953569769859314, gen p mean: -0.11136352270841599, mean p set: 0.4500633478164673
loss_pred:0.016662590205669403, decouple_loss:0.0007750334916636348
The modified gen p mean: 0.44982844591140747, gen p mean: -0.11092317849397659, mean p set: 0.45035696029663086
loss_pred:0.016979554668068886, decouple_loss:0.0008678419981151819
WV_1_PC_1_EH_0_PS_40, loss: 0.01706022582948208, avg_mse: 0.02651309035718441
current test mse: 0.026513
Iteration: 1891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498589038848877, gen p mean: -0.11060994118452072, mean p set: 0.4504365921020508
loss_pred:0.015520934946835041, decouple_loss:0.0007672705105505884
The modified gen p mean: 0.44978249073028564, gen p mean: -0.10929819196462631, mean p set: 0.4503602981567383The modified gen p mean: 0.45269739627838135, gen p mean: -0.11146664619445801, mean p set: 0.4532740116119385
loss_pred:0.01615947298705578, decouple_loss:0.0006901321467012167
loss_pred:0.01581660844385624, decouple_loss:0.0006716556963510811
Iteration: 1892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996610283851624, gen p mean: -0.10736773908138275, mean p set: 0.45054367184638977
loss_pred:0.015548903495073318, decouple_loss:0.0007160272216424346
The modified gen p mean: 0.4498365521430969, gen p mean: -0.1061398983001709, mean p set: 0.4504096210002899The modified gen p mean: 0.45077210664749146, gen p mean: -0.1066170334815979, mean p set: 0.4513498842716217
loss_pred:0.016759710386395454, decouple_loss:0.0008368486887775362
loss_pred:0.01582030951976776, decouple_loss:0.0008755024173296988
Iteration: 1893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024359226226807, gen p mean: -0.10831278562545776, mean p set: 0.45082080364227295
loss_pred:0.01591605693101883, decouple_loss:0.0008763662190176547
The modified gen p mean: 0.4494999349117279, gen p mean: -0.10744249820709229, mean p set: 0.45007672905921936The modified gen p mean: 0.45132869482040405, gen p mean: -0.10748069733381271, mean p set: 0.451905757188797
loss_pred:0.016470903530716896, decouple_loss:0.000615486002061516
loss_pred:0.016443824395537376, decouple_loss:0.0007399540045298636
Iteration: 1894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121389627456665, gen p mean: -0.10415628552436829, mean p set: 0.4517904818058014
loss_pred:0.01667391136288643, decouple_loss:0.0007410938269458711
The modified gen p mean: 0.45074182748794556, gen p mean: -0.10552886873483658, mean p set: 0.4513210654258728
loss_pred:0.016322314739227295, decouple_loss:0.0007215913501568139
The modified gen p mean: 0.44971612095832825, gen p mean: -0.10979373008012772, mean p set: 0.4502951502799988
loss_pred:0.01604590006172657, decouple_loss:0.0006733922637067735
Iteration: 1895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449260413646698, gen p mean: -0.1091170459985733, mean p set: 0.4498387575149536
loss_pred:0.016786660999059677, decouple_loss:0.0006573357386514544
The modified gen p mean: 0.4509749412536621, gen p mean: -0.1071506142616272, mean p set: 0.4515514075756073
The modified gen p mean: 0.4515658915042877, gen p mean: -0.11179588735103607, mean p set: 0.4521428644657135
loss_pred:0.016646049916744232, decouple_loss:0.0008890226599760354
loss_pred:0.01530669629573822, decouple_loss:0.0006806955789215863
Iteration: 1896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530380964279175, gen p mean: -0.10961192101240158, mean p set: 0.45361581444740295
loss_pred:0.016047988086938858, decouple_loss:0.001153828576207161
The modified gen p mean: 0.4536072611808777, gen p mean: -0.10441458225250244, mean p set: 0.45418456196784973
The modified gen p mean: 0.4524126648902893, gen p mean: -0.10808386653661728, mean p set: 0.4529906213283539
loss_pred:0.016172021627426147, decouple_loss:0.0008157602278515697
loss_pred:0.01593882031738758, decouple_loss:0.0010791192762553692
Iteration: 1897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45109009742736816, gen p mean: -0.10584796220064163, mean p set: 0.45166799426078796
loss_pred:0.016348447650671005, decouple_loss:0.0007044875528663397
The modified gen p mean: 0.451086163520813, gen p mean: -0.10858704894781113, mean p set: 0.4516623318195343
The modified gen p mean: 0.4515731930732727, gen p mean: -0.11255798488855362, mean p set: 0.4521483778953552
loss_pred:0.015517964027822018, decouple_loss:0.0009409601916559041
loss_pred:0.016735024750232697, decouple_loss:0.0008275580476038158
Iteration: 1898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953078031539917, gen p mean: -0.10729928314685822, mean p set: 0.45010536909103394
loss_pred:0.015878602862358093, decouple_loss:0.0006770584732294083
The modified gen p mean: 0.45166757702827454, gen p mean: -0.10741588473320007, mean p set: 0.4522424042224884
loss_pred:0.01619088090956211, decouple_loss:0.0008682701154612005
The modified gen p mean: 0.45201194286346436, gen p mean: -0.10860078781843185, mean p set: 0.4525899887084961
loss_pred:0.015956830233335495, decouple_loss:0.0007678064866922796
Iteration: 1899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939717650413513, gen p mean: -0.1062348335981369, mean p set: 0.449973464012146
loss_pred:0.01664607785642147, decouple_loss:0.0009857123950496316
The modified gen p mean: 0.4504074156284332, gen p mean: -0.10639186948537827, mean p set: 0.4509831368923187
The modified gen p mean: 0.44930779933929443, gen p mean: -0.10506046563386917, mean p set: 0.4498836398124695
loss_pred:0.016919301822781563, decouple_loss:0.0007612132467329502
loss_pred:0.016240568831562996, decouple_loss:0.0007771234377287328
Iteration: 1900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511456787586212, gen p mean: -0.11143526434898376, mean p set: 0.45172062516212463
loss_pred:0.016998108476400375, decouple_loss:0.0008481156546622515
The modified gen p mean: 0.45237141847610474, gen p mean: -0.10569578409194946, mean p set: 0.45294854044914246
The modified gen p mean: 0.4493621289730072, gen p mean: -0.10706764459609985, mean p set: 0.44993916153907776
loss_pred:0.015432803891599178, decouple_loss:0.0006207128753885627
loss_pred:0.016008105129003525, decouple_loss:0.0006347040180116892
2023-05-01 06:34:34 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11480969935655594, mean p set: 0.4502691626548767
loss_pred:0.01735552027821541, decouple_loss:0.0006975366268306971
The modified gen p mean: 0.4495362639427185, gen p mean: -0.10861246287822723, mean p set: 0.4500633478164673
loss_pred:0.01669599674642086, decouple_loss:0.0008656707359477878
The modified gen p mean: 0.44982999563217163, gen p mean: -0.10826950520277023, mean p set: 0.45035696029663086
loss_pred:0.016992181539535522, decouple_loss:0.0007843332132324576
WV_1_PC_1_EH_0_PS_40, loss: 0.017053691670298576, avg_mse: 0.026542380452156067
current test mse: 0.026542
Iteration: 1901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45184066891670227, gen p mean: -0.10476946085691452, mean p set: 0.45241761207580566
loss_pred:0.016063544899225235, decouple_loss:0.000777381588704884
The modified gen p mean: 0.4516248106956482, gen p mean: -0.10387765616178513, mean p set: 0.452203631401062The modified gen p mean: 0.4491901695728302, gen p mean: -0.10656309127807617, mean p set: 0.4497682452201843
loss_pred:0.016236187890172005, decouple_loss:0.0008337981998920441
loss_pred:0.016541192308068275, decouple_loss:0.0007198085659183562
Iteration: 1902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45141738653182983, gen p mean: -0.10989793390035629, mean p set: 0.45199474692344666The modified gen p mean: 0.451081246137619, gen p mean: -0.1108301505446434, mean p set: 0.4516597390174866
loss_pred:0.015559321269392967, decouple_loss:0.0006956773577257991
loss_pred:0.01567736081779003, decouple_loss:0.0006237418274395168
The modified gen p mean: 0.4516248106956482, gen p mean: -0.10432813316583633, mean p set: 0.45220157504081726
loss_pred:0.01542598195374012, decouple_loss:0.0005486949812620878
Iteration: 1903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492989182472229, gen p mean: -0.11151876300573349, mean p set: 0.44987794756889343
loss_pred:0.01672970876097679, decouple_loss:0.0006962842307984829
The modified gen p mean: 0.4519405961036682, gen p mean: -0.11154567450284958, mean p set: 0.45251601934432983
loss_pred:0.01649435982108116, decouple_loss:0.0006760456599295139
The modified gen p mean: 0.4501964747905731, gen p mean: -0.10711278021335602, mean p set: 0.4507746696472168
loss_pred:0.01690489426255226, decouple_loss:0.0006819206173531711
Iteration: 1904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509948194026947, gen p mean: -0.11576645076274872, mean p set: 0.4515727162361145
loss_pred:0.01549515686929226, decouple_loss:0.0006603016518056393
The modified gen p mean: 0.45171013474464417, gen p mean: -0.11462268978357315, mean p set: 0.45228299498558044
loss_pred:0.01614999957382679, decouple_loss:0.0006013463134877384
The modified gen p mean: 0.45077425241470337, gen p mean: -0.12142336368560791, mean p set: 0.45135000348091125
loss_pred:0.016347771510481834, decouple_loss:0.0006290921592153609
Iteration: 1905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532923996448517, gen p mean: -0.11842256784439087, mean p set: 0.453868567943573
The modified gen p mean: 0.4504072070121765, gen p mean: -0.11575161665678024, mean p set: 0.4509834945201874
loss_pred:0.015637991949915886, decouple_loss:0.0006585890077985823
loss_pred:0.01615162380039692, decouple_loss:0.0006337898666970432
The modified gen p mean: 0.4497109055519104, gen p mean: -0.11552132666110992, mean p set: 0.45029133558273315
loss_pred:0.017009248957037926, decouple_loss:0.0006239574868232012
Iteration: 1906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958335161209106, gen p mean: -0.11578915268182755, mean p set: 0.4501630365848541
loss_pred:0.015347477048635483, decouple_loss:0.0007520028739236295
The modified gen p mean: 0.45195093750953674, gen p mean: -0.11388516426086426, mean p set: 0.4525294005870819
The modified gen p mean: 0.45168647170066833, gen p mean: -0.11863412708044052, mean p set: 0.452263742685318
loss_pred:0.016085127368569374, decouple_loss:0.0007248959736898541
loss_pred:0.015745915472507477, decouple_loss:0.0007390885148197412
Iteration: 1907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503406584262848, gen p mean: -0.11644963920116425, mean p set: 0.4509196877479553
loss_pred:0.016462724655866623, decouple_loss:0.0006885766633786261
The modified gen p mean: 0.450221985578537, gen p mean: -0.1137179508805275, mean p set: 0.45079872012138367
loss_pred:0.01696881465613842, decouple_loss:0.0006867122137919068
The modified gen p mean: 0.450751930475235, gen p mean: -0.11741705983877182, mean p set: 0.4513280689716339
loss_pred:0.015912875533103943, decouple_loss:0.0005853071343153715
Iteration: 1908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45144444704055786, gen p mean: -0.11278273165225983, mean p set: 0.4520223140716553
loss_pred:0.016193633899092674, decouple_loss:0.0008073678473010659The modified gen p mean: 0.45043128728866577, gen p mean: -0.11212137341499329, mean p set: 0.45101073384284973
loss_pred:0.016799092292785645, decouple_loss:0.0005410361336544156
The modified gen p mean: 0.45020219683647156, gen p mean: -0.10934309661388397, mean p set: 0.450778603553772
loss_pred:0.016989685595035553, decouple_loss:0.0009316299110651016
Iteration: 1909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496793746948242, gen p mean: -0.11521464586257935, mean p set: 0.4502543807029724
The modified gen p mean: 0.45089295506477356, gen p mean: -0.11594576388597488, mean p set: 0.45147088170051575
loss_pred:0.016893059015274048, decouple_loss:0.0007582793477922678
loss_pred:0.016144920140504837, decouple_loss:0.0007557014469057322
The modified gen p mean: 0.4513227343559265, gen p mean: -0.12018830329179764, mean p set: 0.45190224051475525
loss_pred:0.01685250550508499, decouple_loss:0.000754048814997077
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
NaN value num: 0
Iteration: 1910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464156925678253, gen p mean: -0.11694318056106567, mean p set: 0.4469919800758362
The modified gen p mean: 0.4483147859573364, gen p mean: -0.12307095527648926, mean p set: 0.4488913118839264loss_pred:0.01822775788605213, decouple_loss:0.0007164902635850012
loss_pred:0.017164872959256172, decouple_loss:0.0006402056314982474
The modified gen p mean: 0.44766488671302795, gen p mean: -0.12240199744701385, mean p set: 0.44823703169822693
loss_pred:0.018487056717276573, decouple_loss:0.0006819252157583833
2023-05-01 06:37:22 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12476354837417603, mean p set: 0.4502691626548767
loss_pred:0.01735483668744564, decouple_loss:0.0007299415301531553
The modified gen p mean: 0.44953662157058716, gen p mean: -0.1186574324965477, mean p set: 0.4500633478164673
loss_pred:0.016689153388142586, decouple_loss:0.0007095010369084775
The modified gen p mean: 0.4498283863067627, gen p mean: -0.1178913488984108, mean p set: 0.45035696029663086
loss_pred:0.017028337344527245, decouple_loss:0.0006970540853217244
WV_1_PC_1_EH_0_PS_40, loss: 0.017059719190001488, avg_mse: 0.026523321866989136
current test mse: 0.026523
Iteration: 1911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480706751346588, gen p mean: -0.11839582026004791, mean p set: 0.4486467242240906
loss_pred:0.017339391633868217, decouple_loss:0.000634636846370995
The modified gen p mean: 0.4470110237598419, gen p mean: -0.11997992545366287, mean p set: 0.44758832454681396
loss_pred:0.018407505005598068, decouple_loss:0.0006083662156015635
The modified gen p mean: 0.4477854371070862, gen p mean: -0.1223214715719223, mean p set: 0.4483628571033478
loss_pred:0.018443455919623375, decouple_loss:0.0006130454712547362
Iteration: 1912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477700889110565, gen p mean: -0.11715677380561829, mean p set: 0.44834744930267334
loss_pred:0.017675267532467842, decouple_loss:0.0007630725158378482
The modified gen p mean: 0.44838932156562805, gen p mean: -0.12347009778022766, mean p set: 0.4489644169807434The modified gen p mean: 0.4475078880786896, gen p mean: -0.12295620143413544, mean p set: 0.4480820298194885
loss_pred:0.0164170004427433, decouple_loss:0.000701539043802768loss_pred:0.016834806650877, decouple_loss:0.000608677277341485
Iteration: 1913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478886127471924, gen p mean: -0.12298337370157242, mean p set: 0.44846805930137634
loss_pred:0.01770419254899025, decouple_loss:0.0007900224300101399
The modified gen p mean: 0.447867214679718, gen p mean: -0.11723465472459793, mean p set: 0.44844383001327515
loss_pred:0.016464315354824066, decouple_loss:0.0008339759660884738
The modified gen p mean: 0.4481743574142456, gen p mean: -0.12143654376268387, mean p set: 0.4487498700618744
loss_pred:0.01638074778020382, decouple_loss:0.0006275293417274952
Iteration: 1914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467894434928894, gen p mean: -0.12083499878644943, mean p set: 0.4473629891872406
loss_pred:0.017167845740914345, decouple_loss:0.0006369665497913957
The modified gen p mean: 0.44830322265625, gen p mean: -0.12006797641515732, mean p set: 0.448879599571228
loss_pred:0.01698717474937439, decouple_loss:0.0008632556418888271
The modified gen p mean: 0.44742634892463684, gen p mean: -0.12314068526029587, mean p set: 0.44800424575805664
loss_pred:0.016373002901673317, decouple_loss:0.0006008973577991128
Iteration: 1915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937315583229065, gen p mean: -0.12063967436552048, mean p set: 0.44994887709617615
loss_pred:0.016866497695446014, decouple_loss:0.0008367538102902472
The modified gen p mean: 0.4475348889827728, gen p mean: -0.12058745324611664, mean p set: 0.44811269640922546
loss_pred:0.017372876405715942, decouple_loss:0.0007564116385765374
The modified gen p mean: 0.4495066702365875, gen p mean: -0.12039591372013092, mean p set: 0.45008379220962524
loss_pred:0.016504831612110138, decouple_loss:0.0008807462872937322
Iteration: 1916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471917450428009, gen p mean: -0.11782610416412354, mean p set: 0.44776758551597595
loss_pred:0.017346004024147987, decouple_loss:0.0008706912049092352
The modified gen p mean: 0.4467499256134033, gen p mean: -0.1212238296866417, mean p set: 0.4473235011100769
loss_pred:0.018399139866232872, decouple_loss:0.0006979930913075805
The modified gen p mean: 0.44779375195503235, gen p mean: -0.11538539826869965, mean p set: 0.44836878776550293
loss_pred:0.017152046784758568, decouple_loss:0.0006897776038385928
Iteration: 1917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44833654165267944, gen p mean: -0.11967159807682037, mean p set: 0.44891470670700073
loss_pred:0.016204651445150375, decouple_loss:0.0006170613341964781
The modified gen p mean: 0.4474819004535675, gen p mean: -0.12408465147018433, mean p set: 0.4480586349964142
loss_pred:0.017199799418449402, decouple_loss:0.0006612445577047765
The modified gen p mean: 0.44872432947158813, gen p mean: -0.11734088510274887, mean p set: 0.4492984712123871
loss_pred:0.01618173159658909, decouple_loss:0.0006484482437372208
Iteration: 1918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474646747112274, gen p mean: -0.1182422786951065, mean p set: 0.44804099202156067
loss_pred:0.01692521944642067, decouple_loss:0.0007385917124338448
The modified gen p mean: 0.44690293073654175, gen p mean: -0.12051192671060562, mean p set: 0.44747960567474365
loss_pred:0.01648729294538498, decouple_loss:0.0007671288913115859
The modified gen p mean: 0.44753047823905945, gen p mean: -0.11429376155138016, mean p set: 0.4481058716773987
loss_pred:0.01681198552250862, decouple_loss:0.0009120618342421949
Iteration: 1919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691070914268494, gen p mean: -0.11900793761014938, mean p set: 0.44748660922050476
loss_pred:0.01694275252521038, decouple_loss:0.000741302443202585
The modified gen p mean: 0.44570472836494446, gen p mean: -0.11876765638589859, mean p set: 0.44628140330314636
loss_pred:0.017551153898239136, decouple_loss:0.0009721611859276891
The modified gen p mean: 0.4474654495716095, gen p mean: -0.11892490833997726, mean p set: 0.4480408728122711
loss_pred:0.017499983310699463, decouple_loss:0.0007905011880211532
Iteration: 1920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781723618507385, gen p mean: -0.1200946792960167, mean p set: 0.44839391112327576
loss_pred:0.01687793619930744, decouple_loss:0.0007123695104382932
The modified gen p mean: 0.44783180952072144, gen p mean: -0.11108910292387009, mean p set: 0.4484068751335144
loss_pred:0.016731873154640198, decouple_loss:0.0007361537427641451
The modified gen p mean: 0.4474579095840454, gen p mean: -0.11721448600292206, mean p set: 0.4480300843715668
loss_pred:0.016414405778050423, decouple_loss:0.0007506703841499984
2023-05-01 06:39:27 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12058382481336594, mean p set: 0.4502691626548767
loss_pred:0.01733197085559368, decouple_loss:0.0008820788934826851
The modified gen p mean: 0.44953522086143494, gen p mean: -0.11407528072595596, mean p set: 0.4500633478164673
loss_pred:0.01671200431883335, decouple_loss:0.000692947069182992
The modified gen p mean: 0.4498271048069, gen p mean: -0.11313065886497498, mean p set: 0.45035696029663086
loss_pred:0.016982348635792732, decouple_loss:0.0007311198860406876
WV_1_PC_1_EH_0_PS_40, loss: 0.017047211527824402, avg_mse: 0.02649499475955963
current test mse: 0.026495
Iteration: 1921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480675458908081, gen p mean: -0.1164422407746315, mean p set: 0.4486440122127533
loss_pred:0.018110262230038643, decouple_loss:0.0007652253261767328
The modified gen p mean: 0.44831037521362305, gen p mean: -0.1168816015124321, mean p set: 0.4488873779773712
loss_pred:0.01758354716002941, decouple_loss:0.0007478395709767938
The modified gen p mean: 0.44765859842300415, gen p mean: -0.11186401546001434, mean p set: 0.4482339918613434
loss_pred:0.01702679879963398, decouple_loss:0.0008579626446589828
Iteration: 1922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473980665206909, gen p mean: -0.12147293984889984, mean p set: 0.44797322154045105
loss_pred:0.017601020634174347, decouple_loss:0.0007372240070253611
The modified gen p mean: 0.4468710422515869, gen p mean: -0.11898411810398102, mean p set: 0.44744521379470825The modified gen p mean: 0.4482569396495819, gen p mean: -0.1168883889913559, mean p set: 0.44883236289024353
loss_pred:0.01718258298933506, decouple_loss:0.0010556606575846672loss_pred:0.017455697059631348, decouple_loss:0.000838192121591419
Iteration: 1923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818925857543945, gen p mean: -0.11790383607149124, mean p set: 0.44876575469970703
loss_pred:0.016999028623104095, decouple_loss:0.0007326268241740763
The modified gen p mean: 0.4460113048553467, gen p mean: -0.11825250834226608, mean p set: 0.4465877413749695The modified gen p mean: 0.44793105125427246, gen p mean: -0.11256951093673706, mean p set: 0.4485074579715729
loss_pred:0.017379526048898697, decouple_loss:0.0007462655776180327
loss_pred:0.016517924144864082, decouple_loss:0.0008945175213739276
Iteration: 1924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473777115345001, gen p mean: -0.12190690636634827, mean p set: 0.44795146584510803
loss_pred:0.017037026584148407, decouple_loss:0.0010009721154347062
The modified gen p mean: 0.44692426919937134, gen p mean: -0.12026652693748474, mean p set: 0.4474983811378479
loss_pred:0.01700275018811226, decouple_loss:0.0008552546496503055
The modified gen p mean: 0.44633838534355164, gen p mean: -0.1162872388958931, mean p set: 0.4469138979911804
loss_pred:0.01816851831972599, decouple_loss:0.0009618226904422045
Iteration: 1925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777244329452515, gen p mean: -0.12216544151306152, mean p set: 0.44834810495376587
loss_pred:0.017001846805214882, decouple_loss:0.0007746338378638029
The modified gen p mean: 0.44715213775634766, gen p mean: -0.12155673652887344, mean p set: 0.4477272629737854
loss_pred:0.017153572291135788, decouple_loss:0.0006938209407962859
The modified gen p mean: 0.4470052719116211, gen p mean: -0.1161985993385315, mean p set: 0.4475806653499603
loss_pred:0.016861332580447197, decouple_loss:0.0006283448310568929
Iteration: 1926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892340898513794, gen p mean: -0.11936014145612717, mean p set: 0.4494989514350891
loss_pred:0.01695016212761402, decouple_loss:0.0006587690440937877
The modified gen p mean: 0.44736871123313904, gen p mean: -0.12270354479551315, mean p set: 0.4479452073574066
The modified gen p mean: 0.447486013174057, gen p mean: -0.12151101231575012, mean p set: 0.4480629861354828
loss_pred:0.016196582466363907, decouple_loss:0.0007183662382885814
loss_pred:0.01676288992166519, decouple_loss:0.0006487593636848032
Iteration: 1927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489562213420868, gen p mean: -0.11902786791324615, mean p set: 0.4495314955711365
loss_pred:0.017477327957749367, decouple_loss:0.0008077764650806785
The modified gen p mean: 0.4483700394630432, gen p mean: -0.1145552545785904, mean p set: 0.44894686341285706
loss_pred:0.01708248257637024, decouple_loss:0.0007207702728919685
The modified gen p mean: 0.44543251395225525, gen p mean: -0.1180260181427002, mean p set: 0.4460088610649109
loss_pred:0.017490455880761147, decouple_loss:0.0010147420689463615
Iteration: 1928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474344253540039, gen p mean: -0.12599459290504456, mean p set: 0.4480130672454834
loss_pred:0.01687227375805378, decouple_loss:0.0007682931609451771
The modified gen p mean: 0.4477999210357666, gen p mean: -0.11606733500957489, mean p set: 0.4483754336833954
The modified gen p mean: 0.44759777188301086, gen p mean: -0.12536141276359558, mean p set: 0.44817492365837097
loss_pred:0.01692783646285534, decouple_loss:0.0009068236104212701
loss_pred:0.01625158078968525, decouple_loss:0.000893495453055948
Iteration: 1929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467805027961731, gen p mean: -0.11969222873449326, mean p set: 0.44735774397850037
loss_pred:0.016961272805929184, decouple_loss:0.00061232247389853
The modified gen p mean: 0.4474436342716217, gen p mean: -0.12222301959991455, mean p set: 0.448015421628952
The modified gen p mean: 0.44681316614151, gen p mean: -0.1175682321190834, mean p set: 0.4473893940448761
loss_pred:0.016281234100461006, decouple_loss:0.0007296167896129191
loss_pred:0.01727883517742157, decouple_loss:0.0006474929978139699
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
NaN value num: 0
Iteration: 1930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080310106277466, gen p mean: -0.11281860619783401, mean p set: 0.4513806104660034
loss_pred:0.016117600724101067, decouple_loss:0.0011716822627931833
The modified gen p mean: 0.4486566483974457, gen p mean: -0.11071541905403137, mean p set: 0.4492347836494446
The modified gen p mean: 0.4522547423839569, gen p mean: -0.10952384769916534, mean p set: 0.4528312385082245
loss_pred:0.016886411234736443, decouple_loss:0.0011310268891975284
loss_pred:0.01656886748969555, decouple_loss:0.0008614917169325054
2023-05-01 06:42:15 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12157873809337616, mean p set: 0.4502691626548767
loss_pred:0.017347104847431183, decouple_loss:0.0007979802903719246
The modified gen p mean: 0.44953441619873047, gen p mean: -0.11592601984739304, mean p set: 0.4500633478164673
loss_pred:0.016611304134130478, decouple_loss:0.0008783405064605176
The modified gen p mean: 0.4498295783996582, gen p mean: -0.11510076373815536, mean p set: 0.45035696029663086
loss_pred:0.01697363331913948, decouple_loss:0.0006916874554008245
WV_1_PC_1_EH_0_PS_40, loss: 0.017016815021634102, avg_mse: 0.026457905769348145
current test mse: 0.026458
Iteration: 1931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44888418912887573, gen p mean: -0.11174370348453522, mean p set: 0.4494612514972687
loss_pred:0.017143255099654198, decouple_loss:0.0006005357718095183
The modified gen p mean: 0.44893109798431396, gen p mean: -0.10862533003091812, mean p set: 0.4495048522949219
loss_pred:0.01713375560939312, decouple_loss:0.0008227444486692548
The modified gen p mean: 0.45017683506011963, gen p mean: -0.11260311305522919, mean p set: 0.4507533609867096
loss_pred:0.016491184011101723, decouple_loss:0.0008030569297261536
Iteration: 1932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804847240448, gen p mean: -0.1133178323507309, mean p set: 0.44862303137779236
loss_pred:0.016099993139505386, decouple_loss:0.000726126367226243
The modified gen p mean: 0.4495421051979065, gen p mean: -0.11124606430530548, mean p set: 0.45011773705482483The modified gen p mean: 0.4499346613883972, gen p mean: -0.11251644790172577, mean p set: 0.450508713722229
loss_pred:0.017272301018238068, decouple_loss:0.0007276758551597595
loss_pred:0.015341774560511112, decouple_loss:0.0005579764256253839
Iteration: 1933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496798813343048, gen p mean: -0.1156282052397728, mean p set: 0.4502566158771515
loss_pred:0.01779315248131752, decouple_loss:0.0009482201421633363
The modified gen p mean: 0.4489152431488037, gen p mean: -0.11140713095664978, mean p set: 0.4494934380054474
loss_pred:0.016084957867860794, decouple_loss:0.0009265543194487691
The modified gen p mean: 0.4482877850532532, gen p mean: -0.1124102994799614, mean p set: 0.44886186718940735
loss_pred:0.01714804768562317, decouple_loss:0.0009131187107414007
Iteration: 1934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488738477230072, gen p mean: -0.1120075061917305, mean p set: 0.4494513273239136
loss_pred:0.016942335292696953, decouple_loss:0.0007965011172927916
The modified gen p mean: 0.44839516282081604, gen p mean: -0.11602563410997391, mean p set: 0.4489700198173523
loss_pred:0.0166049525141716, decouple_loss:0.0008715849835425615
The modified gen p mean: 0.45060160756111145, gen p mean: -0.11086887866258621, mean p set: 0.45117899775505066
loss_pred:0.015899820253252983, decouple_loss:0.0008929457399062812
Iteration: 1935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44898977875709534, gen p mean: -0.11246412247419357, mean p set: 0.449567049741745
loss_pred:0.016957812011241913, decouple_loss:0.0007799049490131438
The modified gen p mean: 0.4477970004081726, gen p mean: -0.11912108212709427, mean p set: 0.44837433099746704
loss_pred:0.016468539834022522, decouple_loss:0.0008680321043357253
The modified gen p mean: 0.4488772749900818, gen p mean: -0.1115211695432663, mean p set: 0.4494549334049225
loss_pred:0.016972655430436134, decouple_loss:0.0009284907137043774
Iteration: 1936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492281973361969, gen p mean: -0.1157812625169754, mean p set: 0.4498039484024048
loss_pred:0.016647957265377045, decouple_loss:0.0010615269420668483
The modified gen p mean: 0.4498055577278137, gen p mean: -0.11283125728368759, mean p set: 0.45038262009620667
loss_pred:0.016775494441390038, decouple_loss:0.0008118196856230497
The modified gen p mean: 0.44933077692985535, gen p mean: -0.11165113002061844, mean p set: 0.4499092102050781
loss_pred:0.016126329079270363, decouple_loss:0.0009988853707909584
Iteration: 1937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496373236179352, gen p mean: -0.11912332475185394, mean p set: 0.4502134323120117
loss_pred:0.016041919589042664, decouple_loss:0.0007558106444776058
The modified gen p mean: 0.4523744583129883, gen p mean: -0.1122768223285675, mean p set: 0.4529503583908081
loss_pred:0.01669849269092083, decouple_loss:0.0007806129287928343
The modified gen p mean: 0.45092034339904785, gen p mean: -0.11011062562465668, mean p set: 0.45149844884872437
loss_pred:0.016302041709423065, decouple_loss:0.000744635472074151
Iteration: 1938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45008960366249084, gen p mean: -0.11470150202512741, mean p set: 0.450663685798645
loss_pred:0.016018357127904892, decouple_loss:0.0008140351856127381
The modified gen p mean: 0.4481763243675232, gen p mean: -0.11230093985795975, mean p set: 0.4487510621547699
loss_pred:0.017113907262682915, decouple_loss:0.0006972554256208241
The modified gen p mean: 0.4489346742630005, gen p mean: -0.11476798355579376, mean p set: 0.4495103359222412
loss_pred:0.016977597028017044, decouple_loss:0.0010415767319500446
Iteration: 1939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505338668823242, gen p mean: -0.11424317210912704, mean p set: 0.4511091411113739
loss_pred:0.016588371247053146, decouple_loss:0.00075988017488271
The modified gen p mean: 0.4521503746509552, gen p mean: -0.11806128174066544, mean p set: 0.4527266025543213
loss_pred:0.01680178754031658, decouple_loss:0.000798549794126302
The modified gen p mean: 0.4494583308696747, gen p mean: -0.11218315362930298, mean p set: 0.4500344693660736
loss_pred:0.01724245585501194, decouple_loss:0.0007779625593684614
Iteration: 1940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44924110174179077, gen p mean: -0.11382369697093964, mean p set: 0.44981491565704346
loss_pred:0.017639214172959328, decouple_loss:0.0007033904548734426
The modified gen p mean: 0.44956865906715393, gen p mean: -0.11527600884437561, mean p set: 0.45014408230781555
loss_pred:0.0167189110070467, decouple_loss:0.0008923387504182756
The modified gen p mean: 0.44824519753456116, gen p mean: -0.11164989322423935, mean p set: 0.4488198161125183
loss_pred:0.017415696755051613, decouple_loss:0.0005654185079038143
2023-05-01 06:44:21 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12645426392555237, mean p set: 0.4502691626548767
loss_pred:0.0173749141395092, decouple_loss:0.0010639657266438007
The modified gen p mean: 0.44953545928001404, gen p mean: -0.1209382638335228, mean p set: 0.4500633478164673
loss_pred:0.01655789650976658, decouple_loss:0.0009230419527739286
The modified gen p mean: 0.4498269259929657, gen p mean: -0.11993452161550522, mean p set: 0.45035696029663086
loss_pred:0.0169917531311512, decouple_loss:0.0006793054053559899
WV_1_PC_1_EH_0_PS_40, loss: 0.01701929420232773, avg_mse: 0.02648353949189186
current test mse: 0.026484
Iteration: 1941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486595690250397, gen p mean: -0.11285412311553955, mean p set: 0.44923514127731323
loss_pred:0.01686149090528488, decouple_loss:0.0008537150570191443
The modified gen p mean: 0.44935300946235657, gen p mean: -0.11922251433134079, mean p set: 0.4499289393424988The modified gen p mean: 0.4493054747581482, gen p mean: -0.11572228372097015, mean p set: 0.4498836100101471
loss_pred:0.016355862841010094, decouple_loss:0.0007188230520114303
loss_pred:0.016950419172644615, decouple_loss:0.0007237823447212577
Iteration: 1942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835150241851807, gen p mean: -0.11683599650859833, mean p set: 0.4489240050315857
loss_pred:0.016691699624061584, decouple_loss:0.001193174161016941
The modified gen p mean: 0.44936901330947876, gen p mean: -0.11555866152048111, mean p set: 0.4499458968639374
The modified gen p mean: 0.4517531991004944, gen p mean: -0.11484791338443756, mean p set: 0.4523291289806366
loss_pred:0.016670919954776764, decouple_loss:0.0005840918747708201
loss_pred:0.016391009092330933, decouple_loss:0.0009786151349544525
Iteration: 1943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512045085430145, gen p mean: -0.11025971919298172, mean p set: 0.4517812132835388
loss_pred:0.01646297238767147, decouple_loss:0.0006888586794957519
The modified gen p mean: 0.4486587345600128, gen p mean: -0.11413468420505524, mean p set: 0.4492340683937073The modified gen p mean: 0.44880926609039307, gen p mean: -0.11229783296585083, mean p set: 0.4493871033191681
loss_pred:0.017105406150221825, decouple_loss:0.0005844591651111841
loss_pred:0.015660693868994713, decouple_loss:0.0006819441914558411
Iteration: 1944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516642987728119, gen p mean: -0.11033126711845398, mean p set: 0.45223987102508545
loss_pred:0.01620040275156498, decouple_loss:0.0009883736493065953
The modified gen p mean: 0.4504179060459137, gen p mean: -0.11302514374256134, mean p set: 0.45099538564682007
loss_pred:0.016307657584547997, decouple_loss:0.0009691956802271307
The modified gen p mean: 0.4507725238800049, gen p mean: -0.10571741312742233, mean p set: 0.4513488709926605
loss_pred:0.01658518984913826, decouple_loss:0.0007072145817801356
Iteration: 1945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481554627418518, gen p mean: -0.11085067689418793, mean p set: 0.44873207807540894
loss_pred:0.01679244264960289, decouple_loss:0.0007285794126801193
The modified gen p mean: 0.4489998519420624, gen p mean: -0.11141402274370193, mean p set: 0.4495765268802643
loss_pred:0.016478119418025017, decouple_loss:0.0009205276728607714
The modified gen p mean: 0.44960087537765503, gen p mean: -0.11195565015077591, mean p set: 0.45017653703689575
loss_pred:0.017450153827667236, decouple_loss:0.0010023134527727962
Iteration: 1946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45002105832099915, gen p mean: -0.1087718978524208, mean p set: 0.45059719681739807
loss_pred:0.016085108742117882, decouple_loss:0.0006753086927346885
The modified gen p mean: 0.4513941705226898, gen p mean: -0.10759337991476059, mean p set: 0.45197123289108276
The modified gen p mean: 0.44890671968460083, gen p mean: -0.10716895759105682, mean p set: 0.44948065280914307
loss_pred:0.017421841621398926, decouple_loss:0.0007018256583251059
loss_pred:0.016342421993613243, decouple_loss:0.0006100642494857311
Iteration: 1947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802767038345337, gen p mean: -0.11320096254348755, mean p set: 0.44860586524009705
loss_pred:0.016865262761712074, decouple_loss:0.0006438560667447746
The modified gen p mean: 0.45177173614501953, gen p mean: -0.10781311243772507, mean p set: 0.45234742760658264
loss_pred:0.016192324459552765, decouple_loss:0.0008357102633453906
The modified gen p mean: 0.4485984444618225, gen p mean: -0.10177164524793625, mean p set: 0.4491738975048065
loss_pred:0.0173580851405859, decouple_loss:0.0005632318207062781
Iteration: 1948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44896596670150757, gen p mean: -0.1066155731678009, mean p set: 0.44954103231430054
loss_pred:0.016982289031147957, decouple_loss:0.0009376953821629286
The modified gen p mean: 0.44971469044685364, gen p mean: -0.11015114188194275, mean p set: 0.4502924084663391
loss_pred:0.01603204756975174, decouple_loss:0.0005628142971545458
The modified gen p mean: 0.4501354694366455, gen p mean: -0.10908475518226624, mean p set: 0.45071372389793396
loss_pred:0.01597396656870842, decouple_loss:0.000849252101033926
Iteration: 1949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071887969970703, gen p mean: -0.10582714527845383, mean p set: 0.45129647850990295
loss_pred:0.016576435416936874, decouple_loss:0.0005855195340700448
The modified gen p mean: 0.4500942528247833, gen p mean: -0.1107502281665802, mean p set: 0.45067182183265686
loss_pred:0.016130849719047546, decouple_loss:0.0006150609697215259
The modified gen p mean: 0.4475187361240387, gen p mean: -0.11478769779205322, mean p set: 0.44809725880622864
loss_pred:0.016164742410182953, decouple_loss:0.0008722018101252615
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
NaN value num: 0
Iteration: 1950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529847800731659, gen p mean: -0.1071636974811554, mean p set: 0.4535618722438812
loss_pred:0.01597200334072113, decouple_loss:0.0007520809303969145
The modified gen p mean: 0.4525283873081207, gen p mean: -0.10630305856466293, mean p set: 0.4531055986881256
The modified gen p mean: 0.45170706510543823, gen p mean: -0.11039484292268753, mean p set: 0.45228198170661926
loss_pred:0.01659075729548931, decouple_loss:0.0006120462785474956
loss_pred:0.016856055706739426, decouple_loss:0.001103041460737586
2023-05-01 06:47:06 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12131817638874054, mean p set: 0.4502691626548767
loss_pred:0.01734652929008007, decouple_loss:0.0007596316281706095
The modified gen p mean: 0.4495335519313812, gen p mean: -0.11527779698371887, mean p set: 0.4500633478164673
loss_pred:0.01667594350874424, decouple_loss:0.0007478500483557582
The modified gen p mean: 0.4498278498649597, gen p mean: -0.11421108990907669, mean p set: 0.45035696029663086
loss_pred:0.01707649976015091, decouple_loss:0.0008255434222519398
WV_1_PC_1_EH_0_PS_40, loss: 0.017071876674890518, avg_mse: 0.026612482964992523
current test mse: 0.026612
Iteration: 1951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45228567719459534, gen p mean: -0.11402478814125061, mean p set: 0.452862411737442
loss_pred:0.017031725496053696, decouple_loss:0.0007825586944818497
The modified gen p mean: 0.4506722092628479, gen p mean: -0.10815037041902542, mean p set: 0.45124828815460205
loss_pred:0.015875598415732384, decouple_loss:0.0008000149973668158
The modified gen p mean: 0.4509229362010956, gen p mean: -0.11129357665777206, mean p set: 0.4514986276626587
loss_pred:0.01720895618200302, decouple_loss:0.0006881636800244451
Iteration: 1952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520060122013092, gen p mean: -0.10511087626218796, mean p set: 0.45258164405822754
loss_pred:0.016569683328270912, decouple_loss:0.0009315519127994776
The modified gen p mean: 0.4532569348812103, gen p mean: -0.10849623382091522, mean p set: 0.45383426547050476The modified gen p mean: 0.45179909467697144, gen p mean: -0.10710398107767105, mean p set: 0.45237478613853455
loss_pred:0.017085373401641846, decouple_loss:0.0008629376534372568
loss_pred:0.016915414482355118, decouple_loss:0.0007323417230509222
Iteration: 1953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512413442134857, gen p mean: -0.10489830374717712, mean p set: 0.45181846618652344
loss_pred:0.016082730144262314, decouple_loss:0.000998348230496049
The modified gen p mean: 0.4526967704296112, gen p mean: -0.0988565981388092, mean p set: 0.4532724618911743
loss_pred:0.016447102651000023, decouple_loss:0.0010056548053398728
The modified gen p mean: 0.45115065574645996, gen p mean: -0.0958971455693245, mean p set: 0.45172739028930664
loss_pred:0.016418226063251495, decouple_loss:0.0007821678882464767
Iteration: 1954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45231592655181885, gen p mean: -0.10613066703081131, mean p set: 0.4528955817222595
The modified gen p mean: 0.45085814595222473, gen p mean: -0.10450195521116257, mean p set: 0.45143428444862366
loss_pred:0.01671985536813736, decouple_loss:0.0007368232472799718
loss_pred:0.015503043308854103, decouple_loss:0.0006472985842265189
The modified gen p mean: 0.4513438045978546, gen p mean: -0.11024479568004608, mean p set: 0.45191919803619385
loss_pred:0.015911618247628212, decouple_loss:0.0006085228524170816
Iteration: 1955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45138290524482727, gen p mean: -0.1089901551604271, mean p set: 0.4519580900669098
loss_pred:0.016725173220038414, decouple_loss:0.0009794665966182947
The modified gen p mean: 0.45129385590553284, gen p mean: -0.10566787421703339, mean p set: 0.4518677592277527
loss_pred:0.016063056886196136, decouple_loss:0.000830535835120827
The modified gen p mean: 0.4525778293609619, gen p mean: -0.09737855195999146, mean p set: 0.45315417647361755
loss_pred:0.016074705868959427, decouple_loss:0.00076832011109218
Iteration: 1956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45310965180397034, gen p mean: -0.10448770970106125, mean p set: 0.4536888301372528
loss_pred:0.017011504620313644, decouple_loss:0.0010300969006493688
The modified gen p mean: 0.45302823185920715, gen p mean: -0.09903964400291443, mean p set: 0.45360562205314636
loss_pred:0.01636766456067562, decouple_loss:0.0006972004193812609
The modified gen p mean: 0.4510577619075775, gen p mean: -0.09775185585021973, mean p set: 0.4516338109970093
loss_pred:0.016223926097154617, decouple_loss:0.0006776651716791093
Iteration: 1957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45323413610458374, gen p mean: -0.09959535300731659, mean p set: 0.45381149649620056
loss_pred:0.016563953831791878, decouple_loss:0.0007065529352985322
The modified gen p mean: 0.4501388669013977, gen p mean: -0.10419099777936935, mean p set: 0.4507158100605011
loss_pred:0.015711504966020584, decouple_loss:0.0007652209606021643
The modified gen p mean: 0.45051461458206177, gen p mean: -0.10257729887962341, mean p set: 0.4510918855667114
loss_pred:0.016002440825104713, decouple_loss:0.0007439321489073336
Iteration: 1958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519926905632019, gen p mean: -0.09980912506580353, mean p set: 0.4525703489780426
loss_pred:0.015951959416270256, decouple_loss:0.0008173792157322168
The modified gen p mean: 0.45200371742248535, gen p mean: -0.09798538684844971, mean p set: 0.4525795578956604
loss_pred:0.016488928347826004, decouple_loss:0.0007499342318624258
The modified gen p mean: 0.4512960910797119, gen p mean: -0.09975919127464294, mean p set: 0.4518711566925049
loss_pred:0.016688847914338112, decouple_loss:0.0007338569848798215
Iteration: 1959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45113083720207214, gen p mean: -0.10010068863630295, mean p set: 0.45170727372169495
loss_pred:0.01592872105538845, decouple_loss:0.0005419892841018736
The modified gen p mean: 0.4516565799713135, gen p mean: -0.10313474386930466, mean p set: 0.4522334337234497
loss_pred:0.01617964543402195, decouple_loss:0.0007268955232575536
The modified gen p mean: 0.4523540735244751, gen p mean: -0.09907741099596024, mean p set: 0.4529340863227844
loss_pred:0.01665293239057064, decouple_loss:0.000708274426870048
Iteration: 1960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45180121064186096, gen p mean: -0.09727999567985535, mean p set: 0.4523775279521942
loss_pred:0.016037771478295326, decouple_loss:0.0008133723167702556
The modified gen p mean: 0.45021992921829224, gen p mean: -0.10166564583778381, mean p set: 0.4507977068424225
loss_pred:0.01637924090027809, decouple_loss:0.0010580531088635325
The modified gen p mean: 0.4528653919696808, gen p mean: -0.09292828291654587, mean p set: 0.45344221591949463
loss_pred:0.016627315431833267, decouple_loss:0.0008952132193371654
2023-05-01 06:49:11 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10810337215662003, mean p set: 0.4502691626548767
loss_pred:0.017338775098323822, decouple_loss:0.0007345615886151791
The modified gen p mean: 0.4495350122451782, gen p mean: -0.10196423530578613, mean p set: 0.4500633478164673
loss_pred:0.016699139028787613, decouple_loss:0.0007315322291105986
The modified gen p mean: 0.44982725381851196, gen p mean: -0.10083106905221939, mean p set: 0.45035696029663086
loss_pred:0.017037102952599525, decouple_loss:0.0006964849308133125
WV_1_PC_1_EH_0_PS_40, loss: 0.017061050981283188, avg_mse: 0.026565875858068466
current test mse: 0.026566
Iteration: 1961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508517384529114, gen p mean: -0.09256871789693832, mean p set: 0.45142796635627747
loss_pred:0.015375342220067978, decouple_loss:0.000694633403327316
The modified gen p mean: 0.45196571946144104, gen p mean: -0.09466270357370377, mean p set: 0.45254209637641907
loss_pred:0.016335206106305122, decouple_loss:0.0006075130659155548
The modified gen p mean: 0.4530908167362213, gen p mean: -0.09197338670492172, mean p set: 0.4536671042442322
loss_pred:0.015799690037965775, decouple_loss:0.0008230472449213266
Iteration: 1962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45354241132736206, gen p mean: -0.09040196239948273, mean p set: 0.45412078499794006
loss_pred:0.015742609277367592, decouple_loss:0.000929258472751826
The modified gen p mean: 0.45098602771759033, gen p mean: -0.08655207604169846, mean p set: 0.4515622556209564The modified gen p mean: 0.4513133764266968, gen p mean: -0.09765218943357468, mean p set: 0.45189008116722107
loss_pred:0.016655655577778816, decouple_loss:0.0007599607924930751loss_pred:0.016582397744059563, decouple_loss:0.0009141157497651875
Iteration: 1963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521791934967041, gen p mean: -0.10094594955444336, mean p set: 0.4527551829814911
loss_pred:0.016635656356811523, decouple_loss:0.000839810527395457
The modified gen p mean: 0.45241761207580566, gen p mean: -0.09475710988044739, mean p set: 0.45299410820007324
The modified gen p mean: 0.45310965180397034, gen p mean: -0.10259181261062622, mean p set: 0.45368802547454834
loss_pred:0.01609182357788086, decouple_loss:0.0007404734496958554
loss_pred:0.01723281666636467, decouple_loss:0.0007528471178375185
Iteration: 1964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507233500480652, gen p mean: -0.10278919339179993, mean p set: 0.4513013958930969
loss_pred:0.016004517674446106, decouple_loss:0.0007286236505024135
The modified gen p mean: 0.450663685798645, gen p mean: -0.10369400680065155, mean p set: 0.45124077796936035
loss_pred:0.015217657200992107, decouple_loss:0.0006274731131270528
The modified gen p mean: 0.45031455159187317, gen p mean: -0.09854550659656525, mean p set: 0.45089107751846313
loss_pred:0.016296181827783585, decouple_loss:0.0006100706523284316
Iteration: 1965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121505856513977, gen p mean: -0.10949017852544785, mean p set: 0.4517892897129059
loss_pred:0.015961073338985443, decouple_loss:0.0008061236003413796
The modified gen p mean: 0.4520241618156433, gen p mean: -0.11424197256565094, mean p set: 0.4526018798351288
loss_pred:0.016542615368962288, decouple_loss:0.0006857526022940874
The modified gen p mean: 0.45242440700531006, gen p mean: -0.10444877296686172, mean p set: 0.45300236344337463
loss_pred:0.016237111762166023, decouple_loss:0.0006519306334666908
Iteration: 1966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520721733570099, gen p mean: -0.11088922619819641, mean p set: 0.4526480436325073
loss_pred:0.015883713960647583, decouple_loss:0.0007949495920911431
The modified gen p mean: 0.4514782130718231, gen p mean: -0.10906978696584702, mean p set: 0.4520549178123474
loss_pred:0.017033495008945465, decouple_loss:0.0008744032820686698
The modified gen p mean: 0.45264291763305664, gen p mean: -0.1151437908411026, mean p set: 0.45321789383888245
loss_pred:0.016469601541757584, decouple_loss:0.0006976755103096366
Iteration: 1967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528796672821045, gen p mean: -0.10960379987955093, mean p set: 0.4534555673599243
loss_pred:0.01593005284667015, decouple_loss:0.0005506805027835071
The modified gen p mean: 0.45227542519569397, gen p mean: -0.11035557836294174, mean p set: 0.45285117626190186
The modified gen p mean: 0.4509401321411133, gen p mean: -0.10855957120656967, mean p set: 0.45151615142822266
loss_pred:0.01637532189488411, decouple_loss:0.0005864472477696836
loss_pred:0.016092853620648384, decouple_loss:0.0007600095123052597
Iteration: 1968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45251789689064026, gen p mean: -0.10211299359798431, mean p set: 0.45309609174728394
loss_pred:0.016494307667016983, decouple_loss:0.0007435189327225089
The modified gen p mean: 0.4506373405456543, gen p mean: -0.10598960518836975, mean p set: 0.45121341943740845
The modified gen p mean: 0.4524649679660797, gen p mean: -0.11096362769603729, mean p set: 0.4530409872531891
loss_pred:0.015474502928555012, decouple_loss:0.0006682121893391013
loss_pred:0.016255643218755722, decouple_loss:0.0006225414690561593
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 1969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794872403144836, gen p mean: -0.11524534970521927, mean p set: 0.4485251009464264The modified gen p mean: 0.44746750593185425, gen p mean: -0.11156688630580902, mean p set: 0.44804278016090393
loss_pred:0.016347551718354225, decouple_loss:0.000804160488769412
loss_pred:0.01643293909728527, decouple_loss:0.0006323778652586043
The modified gen p mean: 0.44852888584136963, gen p mean: -0.1127251610159874, mean p set: 0.44910410046577454
loss_pred:0.016116132959723473, decouple_loss:0.0005824021063745022
Iteration: 1970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775769114494324, gen p mean: -0.10781440138816833, mean p set: 0.4483354985713959
loss_pred:0.015852415934205055, decouple_loss:0.0006724569830112159
The modified gen p mean: 0.4481009244918823, gen p mean: -0.11008191108703613, mean p set: 0.4486764669418335
loss_pred:0.01551270391792059, decouple_loss:0.0005626179045066237
The modified gen p mean: 0.4485379755496979, gen p mean: -0.11197502911090851, mean p set: 0.4491156041622162
loss_pred:0.016031131148338318, decouple_loss:0.0008131237118504941
2023-05-01 06:51:59 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11273866891860962, mean p set: 0.4502691626548767
loss_pred:0.01735151931643486, decouple_loss:0.0007420447655022144
The modified gen p mean: 0.4495338499546051, gen p mean: -0.10658508539199829, mean p set: 0.4500633478164673
loss_pred:0.016551006585359573, decouple_loss:0.0006465217447839677
The modified gen p mean: 0.4498277008533478, gen p mean: -0.10548418015241623, mean p set: 0.45035696029663086
loss_pred:0.017042091116309166, decouple_loss:0.0006564473151229322
WV_1_PC_1_EH_0_PS_40, loss: 0.017015621066093445, avg_mse: 0.026456721127033234
current test mse: 0.026457
Iteration: 1971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763004779815674, gen p mean: -0.10121256858110428, mean p set: 0.4482038617134094
loss_pred:0.015840809792280197, decouple_loss:0.0008553186780773103
The modified gen p mean: 0.44945257902145386, gen p mean: -0.11110847443342209, mean p set: 0.450029194355011
loss_pred:0.015982985496520996, decouple_loss:0.0006353298085741699
The modified gen p mean: 0.4490509033203125, gen p mean: -0.11200002580881119, mean p set: 0.4496248662471771
loss_pred:0.01584045961499214, decouple_loss:0.0006321666296571493
Iteration: 1972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482022523880005, gen p mean: -0.11134558171033859, mean p set: 0.4487766921520233
loss_pred:0.015655068680644035, decouple_loss:0.0008454152848571539
The modified gen p mean: 0.4486311972141266, gen p mean: -0.10749265551567078, mean p set: 0.4492073655128479The modified gen p mean: 0.44837886095046997, gen p mean: -0.11210600286722183, mean p set: 0.44895440340042114
loss_pred:0.015313109382987022, decouple_loss:0.000748298829421401loss_pred:0.01539232861250639, decouple_loss:0.0008017679792828858
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486231505870819, gen p mean: -0.10967250168323517, mean p set: 0.4492001235485077
loss_pred:0.015381340868771076, decouple_loss:0.0006132214330136776
The modified gen p mean: 0.4487927258014679, gen p mean: -0.11234480887651443, mean p set: 0.44937053322792053The modified gen p mean: 0.4477841854095459, gen p mean: -0.10750026255846024, mean p set: 0.4483604431152344
loss_pred:0.0159883052110672, decouple_loss:0.0007242957362905145loss_pred:0.015884317457675934, decouple_loss:0.0006758993840776384
Iteration: 1974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859519600868225, gen p mean: -0.11438038945198059, mean p set: 0.44916975498199463
The modified gen p mean: 0.4481356739997864, gen p mean: -0.1109084039926529, mean p set: 0.44871124625205994
loss_pred:0.01599135808646679, decouple_loss:0.0006036545964889228
loss_pred:0.01549683790653944, decouple_loss:0.0008296791929751635
The modified gen p mean: 0.44823944568634033, gen p mean: -0.11001553386449814, mean p set: 0.4488137364387512
loss_pred:0.01588369347155094, decouple_loss:0.0006095882272347808
Iteration: 1975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484960436820984, gen p mean: -0.11733989417552948, mean p set: 0.44906941056251526
loss_pred:0.01539963111281395, decouple_loss:0.000858436047565192
The modified gen p mean: 0.44742581248283386, gen p mean: -0.1129821240901947, mean p set: 0.4479973018169403
loss_pred:0.015610833652317524, decouple_loss:0.0006423922604881227
The modified gen p mean: 0.44854193925857544, gen p mean: -0.11413093656301498, mean p set: 0.44911760091781616
loss_pred:0.01571563631296158, decouple_loss:0.000694164598826319
Iteration: 1976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841402769088745, gen p mean: -0.11816994100809097, mean p set: 0.44898921251296997
loss_pred:0.015049466863274574, decouple_loss:0.000604368164204061
The modified gen p mean: 0.4486001133918762, gen p mean: -0.11378820240497589, mean p set: 0.44917428493499756
The modified gen p mean: 0.4472971260547638, gen p mean: -0.10671308636665344, mean p set: 0.447873055934906
loss_pred:0.015174969099462032, decouple_loss:0.0005490735056810081
loss_pred:0.01543740089982748, decouple_loss:0.00067850761115551
Iteration: 1977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485350251197815, gen p mean: -0.11573849618434906, mean p set: 0.44910916686058044
loss_pred:0.015730315819382668, decouple_loss:0.0006155932787805796
The modified gen p mean: 0.4494638442993164, gen p mean: -0.11773405224084854, mean p set: 0.45003825426101685
The modified gen p mean: 0.4486776292324066, gen p mean: -0.11320365220308304, mean p set: 0.4492553174495697
loss_pred:0.01531196665018797, decouple_loss:0.0006219434435479343
loss_pred:0.015293186530470848, decouple_loss:0.000695263734087348
Iteration: 1978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491133391857147, gen p mean: -0.11372628062963486, mean p set: 0.449685275554657
loss_pred:0.0156134944409132, decouple_loss:0.0005960923153907061
The modified gen p mean: 0.44710010290145874, gen p mean: -0.11030376702547073, mean p set: 0.4476754069328308
loss_pred:0.01538973581045866, decouple_loss:0.0005716652958653867
The modified gen p mean: 0.4479843080043793, gen p mean: -0.1129898801445961, mean p set: 0.44855865836143494
loss_pred:0.015610907226800919, decouple_loss:0.000563308538403362
Iteration: 1979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488503634929657, gen p mean: -0.10662265121936798, mean p set: 0.4494262933731079
loss_pred:0.015780141577124596, decouple_loss:0.0006507638026960194
The modified gen p mean: 0.4479595720767975, gen p mean: -0.11033014953136444, mean p set: 0.44853806495666504
loss_pred:0.014886267483234406, decouple_loss:0.0005774961318820715
The modified gen p mean: 0.4473346471786499, gen p mean: -0.11132561415433884, mean p set: 0.4479115903377533
loss_pred:0.015559195540845394, decouple_loss:0.0006354894721880555
Iteration: 1980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483073353767395, gen p mean: -0.11411304026842117, mean p set: 0.4488835632801056
loss_pred:0.014656567946076393, decouple_loss:0.0005975362146273255
The modified gen p mean: 0.4493753910064697, gen p mean: -0.10982494056224823, mean p set: 0.44995051622390747
loss_pred:0.015325461514294147, decouple_loss:0.0007902130018919706
The modified gen p mean: 0.4474877417087555, gen p mean: -0.10731493681669235, mean p set: 0.4480650722980499
loss_pred:0.015270421281456947, decouple_loss:0.0005401103408075869
2023-05-01 06:54:04 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11536093801259995, mean p set: 0.4502691626548767
loss_pred:0.017264457419514656, decouple_loss:0.0006461192388087511
The modified gen p mean: 0.4495380222797394, gen p mean: -0.10937894135713577, mean p set: 0.4500633478164673
loss_pred:0.01649440824985504, decouple_loss:0.0006682833191007376
The modified gen p mean: 0.4498290717601776, gen p mean: -0.1082439199090004, mean p set: 0.45035696029663086
loss_pred:0.01696034148335457, decouple_loss:0.0007797834696248174
WV_1_PC_1_EH_0_PS_40, loss: 0.016941307112574577, avg_mse: 0.02635478600859642
current test mse: 0.026355
Iteration: 1981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785773754119873, gen p mean: -0.11324358731508255, mean p set: 0.4484313726425171
loss_pred:0.01563393324613571, decouple_loss:0.000713948393240571
The modified gen p mean: 0.44656604528427124, gen p mean: -0.11312682926654816, mean p set: 0.44714176654815674The modified gen p mean: 0.4462571144104004, gen p mean: -0.11198063939809799, mean p set: 0.44683340191841125
loss_pred:0.01560970302671194, decouple_loss:0.0006149488617666066loss_pred:0.01584606058895588, decouple_loss:0.0005683776689693332
Iteration: 1982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486899971961975, gen p mean: -0.11312387138605118, mean p set: 0.44926580786705017
loss_pred:0.015051926486194134, decouple_loss:0.0008166709449142218
The modified gen p mean: 0.44864895939826965, gen p mean: -0.11234144866466522, mean p set: 0.4492258131504059The modified gen p mean: 0.44811224937438965, gen p mean: -0.11191511154174805, mean p set: 0.4486883282661438
loss_pred:0.015191701240837574, decouple_loss:0.0008025660645216703loss_pred:0.015473480336368084, decouple_loss:0.0007655764347873628
Iteration: 1983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872939586639404, gen p mean: -0.11650540679693222, mean p set: 0.44930675625801086
loss_pred:0.015488713048398495, decouple_loss:0.000734115659724921
The modified gen p mean: 0.44716158509254456, gen p mean: -0.11319351196289062, mean p set: 0.4477364122867584The modified gen p mean: 0.44765400886535645, gen p mean: -0.10929914563894272, mean p set: 0.4482291042804718
loss_pred:0.01546541228890419, decouple_loss:0.0006091351388022304
loss_pred:0.015381017699837685, decouple_loss:0.0007355361012741923
Iteration: 1984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480426013469696, gen p mean: -0.11126028746366501, mean p set: 0.44861912727355957
loss_pred:0.015586242079734802, decouple_loss:0.000660187506582588
The modified gen p mean: 0.4484781324863434, gen p mean: -0.11165017634630203, mean p set: 0.4490547776222229
loss_pred:0.015151802450418472, decouple_loss:0.0007456394378095865
The modified gen p mean: 0.4486715495586395, gen p mean: -0.11268378049135208, mean p set: 0.44924765825271606
loss_pred:0.015046697109937668, decouple_loss:0.0006045469199307263
Iteration: 1985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484645128250122, gen p mean: -0.11142833530902863, mean p set: 0.4490397274494171
loss_pred:0.015560462139546871, decouple_loss:0.0007235987577587366
The modified gen p mean: 0.4488842785358429, gen p mean: -0.11036533862352371, mean p set: 0.4494645595550537
loss_pred:0.01550739910453558, decouple_loss:0.0006202166550792754
The modified gen p mean: 0.44791412353515625, gen p mean: -0.1118769720196724, mean p set: 0.4484924077987671
loss_pred:0.015499850735068321, decouple_loss:0.0006535943830385804
Iteration: 1986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482961595058441, gen p mean: -0.1132408082485199, mean p set: 0.44887199997901917
loss_pred:0.0153092872351408, decouple_loss:0.0006495885318145156
The modified gen p mean: 0.44766902923583984, gen p mean: -0.10742950439453125, mean p set: 0.4482443630695343
loss_pred:0.015675654634833336, decouple_loss:0.0005671824910677969
The modified gen p mean: 0.4486096501350403, gen p mean: -0.11044743657112122, mean p set: 0.4491857588291168
loss_pred:0.015341006219387054, decouple_loss:0.000650310015771538
Iteration: 1987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481167197227478, gen p mean: -0.10702753812074661, mean p set: 0.4486922323703766
loss_pred:0.015585582703351974, decouple_loss:0.0009030801011249423
The modified gen p mean: 0.4492400586605072, gen p mean: -0.10661566257476807, mean p set: 0.44981372356414795
loss_pred:0.0149016622453928, decouple_loss:0.0007333872490562499
The modified gen p mean: 0.4486744999885559, gen p mean: -0.10816818475723267, mean p set: 0.44925105571746826
loss_pred:0.015370750799775124, decouple_loss:0.0006671154405921698
Iteration: 1988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472763240337372, gen p mean: -0.108985535800457, mean p set: 0.44785305857658386
loss_pred:0.015246204100549221, decouple_loss:0.0006950360257178545
The modified gen p mean: 0.44790035486221313, gen p mean: -0.10782419890165329, mean p set: 0.4484765827655792
The modified gen p mean: 0.44799062609672546, gen p mean: -0.1076764240860939, mean p set: 0.44856706261634827
loss_pred:0.015167027711868286, decouple_loss:0.0005717448075301945
loss_pred:0.015335477888584137, decouple_loss:0.0006482075550593436
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 1989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719982147216797, gen p mean: -0.10429999977350235, mean p set: 0.4477759599685669
The modified gen p mean: 0.44756871461868286, gen p mean: -0.10249784588813782, mean p set: 0.44814640283584595
loss_pred:0.01585816964507103, decouple_loss:0.0006561163463629782
loss_pred:0.01572355069220066, decouple_loss:0.0008783433586359024
The modified gen p mean: 0.446048766374588, gen p mean: -0.11192785948514938, mean p set: 0.44662564992904663
loss_pred:0.015916038304567337, decouple_loss:0.000632192415650934
Iteration: 1990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830837845802307, gen p mean: -0.10390190780162811, mean p set: 0.44888240098953247
loss_pred:0.014928331598639488, decouple_loss:0.0006320321117527783
The modified gen p mean: 0.44711044430732727, gen p mean: -0.10286806523799896, mean p set: 0.44768741726875305
loss_pred:0.014814830385148525, decouple_loss:0.0006669699214398861
The modified gen p mean: 0.44794318079948425, gen p mean: -0.10892871767282486, mean p set: 0.4485190510749817
loss_pred:0.01581721194088459, decouple_loss:0.000689282373059541
2023-05-01 06:56:51 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11773055046796799, mean p set: 0.4502691626548767
loss_pred:0.017187761142849922, decouple_loss:0.0006304550333879888
The modified gen p mean: 0.44953596591949463, gen p mean: -0.11169198900461197, mean p set: 0.4500633478164673
loss_pred:0.01642787642776966, decouple_loss:0.0006270064623095095
The modified gen p mean: 0.4498293995857239, gen p mean: -0.11087960749864578, mean p set: 0.45035696029663086
loss_pred:0.016894111409783363, decouple_loss:0.0008406431297771633
WV_1_PC_1_EH_0_PS_40, loss: 0.016871552914381027, avg_mse: 0.026267632842063904
current test mse: 0.026268
At step 1990, Best test: 0.026268
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 1991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477108120918274, gen p mean: -0.11530127376317978, mean p set: 0.4482881724834442
loss_pred:0.015424143522977829, decouple_loss:0.0005093523650430143
The modified gen p mean: 0.4480852782726288, gen p mean: -0.1146329790353775, mean p set: 0.4486611485481262
loss_pred:0.015545506030321121, decouple_loss:0.0005781984655186534
The modified gen p mean: 0.44659751653671265, gen p mean: -0.11391483247280121, mean p set: 0.44717565178871155
loss_pred:0.015751469880342484, decouple_loss:0.0006093350239098072
Iteration: 1992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44658201932907104, gen p mean: -0.11626187711954117, mean p set: 0.44715800881385803
loss_pred:0.014282667078077793, decouple_loss:0.0008572682272642851
The modified gen p mean: 0.44652870297431946, gen p mean: -0.11528114229440689, mean p set: 0.4471038579940796The modified gen p mean: 0.44683733582496643, gen p mean: -0.11560642719268799, mean p set: 0.447416752576828
loss_pred:0.016298048198223114, decouple_loss:0.0006333982455544174
loss_pred:0.01467377133667469, decouple_loss:0.0006900925072841346
Iteration: 1993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44674649834632874, gen p mean: -0.12140662968158722, mean p set: 0.44732168316841125
loss_pred:0.014610124751925468, decouple_loss:0.0007515103789046407
The modified gen p mean: 0.4465363621711731, gen p mean: -0.1288527101278305, mean p set: 0.4471111297607422The modified gen p mean: 0.4467959702014923, gen p mean: -0.12644745409488678, mean p set: 0.4473738372325897
loss_pred:0.014974909834563732, decouple_loss:0.0006404640735127032
loss_pred:0.014498534612357616, decouple_loss:0.000586108595598489
Iteration: 1994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737595319747925, gen p mean: -0.12352653592824936, mean p set: 0.4479525089263916
loss_pred:0.015103240497410297, decouple_loss:0.0007467042305506766
The modified gen p mean: 0.4480501413345337, gen p mean: -0.1161988377571106, mean p set: 0.44862768054008484
loss_pred:0.014720221981406212, decouple_loss:0.0005369833670556545
The modified gen p mean: 0.4481530487537384, gen p mean: -0.11713701486587524, mean p set: 0.44872787594795227
loss_pred:0.01437150128185749, decouple_loss:0.0005654168780893087
Iteration: 1995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470974802970886, gen p mean: -0.11298764497041702, mean p set: 0.4476739168167114
loss_pred:0.015444996766746044, decouple_loss:0.0005787053960375488
The modified gen p mean: 0.4472121298313141, gen p mean: -0.11913449317216873, mean p set: 0.4477875828742981
loss_pred:0.015546557493507862, decouple_loss:0.0005857989308424294
The modified gen p mean: 0.4465075135231018, gen p mean: -0.11852943897247314, mean p set: 0.44708362221717834
loss_pred:0.014908071607351303, decouple_loss:0.0006258374778553843
Iteration: 1996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802582263946533, gen p mean: -0.11198104172945023, mean p set: 0.44860100746154785
loss_pred:0.01467633992433548, decouple_loss:0.0005082871648482978
The modified gen p mean: 0.44693124294281006, gen p mean: -0.1152988150715828, mean p set: 0.4475066065788269
The modified gen p mean: 0.4473010301589966, gen p mean: -0.11856761574745178, mean p set: 0.4478755593299866
loss_pred:0.014140527695417404, decouple_loss:0.000582341686822474
loss_pred:0.015677331015467644, decouple_loss:0.0009364124853163958
Iteration: 1997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728368520736694, gen p mean: -0.11129463464021683, mean p set: 0.44785767793655396
loss_pred:0.015627257525920868, decouple_loss:0.0005992119549773633
The modified gen p mean: 0.44760385155677795, gen p mean: -0.10840606689453125, mean p set: 0.44817930459976196
The modified gen p mean: 0.4481167197227478, gen p mean: -0.10332784056663513, mean p set: 0.4486927390098572
loss_pred:0.015046429820358753, decouple_loss:0.0006212784792296588
loss_pred:0.014558524824678898, decouple_loss:0.0008102133870124817
Iteration: 1998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469408392906189, gen p mean: -0.1077146977186203, mean p set: 0.44751641154289246
The modified gen p mean: 0.44729405641555786, gen p mean: -0.10059388726949692, mean p set: 0.44786933064460754
loss_pred:0.014984174631536007, decouple_loss:0.0007386311772279441
loss_pred:0.015159718692302704, decouple_loss:0.0006241233204491436
The modified gen p mean: 0.44708025455474854, gen p mean: -0.1088232472538948, mean p set: 0.44765499234199524
loss_pred:0.015185096301138401, decouple_loss:0.0006050114170648158
Iteration: 1999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477509558200836, gen p mean: -0.1046779677271843, mean p set: 0.44832831621170044
loss_pred:0.015405275858938694, decouple_loss:0.0006856373511254787
The modified gen p mean: 0.44669708609580994, gen p mean: -0.1085747703909874, mean p set: 0.4472716748714447
loss_pred:0.015911852940917015, decouple_loss:0.0006936033023521304
The modified gen p mean: 0.44805118441581726, gen p mean: -0.10797978937625885, mean p set: 0.4486280083656311
loss_pred:0.014471878297626972, decouple_loss:0.0008097360259853303
Iteration: 2000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44630974531173706, gen p mean: -0.10255816578865051, mean p set: 0.44688504934310913
loss_pred:0.014591126702725887, decouple_loss:0.0007656161906197667
The modified gen p mean: 0.4462795555591583, gen p mean: -0.1142934262752533, mean p set: 0.4468553960323334
loss_pred:0.015172342769801617, decouple_loss:0.000623942818492651
The modified gen p mean: 0.4470645487308502, gen p mean: -0.10619302093982697, mean p set: 0.44764021039009094
loss_pred:0.015668177977204323, decouple_loss:0.0007568543660454452
2023-05-01 06:59:02 itr: 2000
training loss: [0.01520354 0.01462941 0.01570602]
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_2000.ckpt
2023-05-01 06:59:08 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11074528098106384, mean p set: 0.4502691626548767
loss_pred:0.017162809148430824, decouple_loss:0.000855795165989548
The modified gen p mean: 0.4495345950126648, gen p mean: -0.10493054986000061, mean p set: 0.4500633478164673
loss_pred:0.01654454693198204, decouple_loss:0.000893268792424351
The modified gen p mean: 0.44982925057411194, gen p mean: -0.1044774204492569, mean p set: 0.45035696029663086
loss_pred:0.016916248947381973, decouple_loss:0.000763370597269386
WV_1_PC_1_EH_0_PS_40, loss: 0.016916409134864807, avg_mse: 0.026351895183324814
current test mse: 0.026352
Iteration: 2001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44709840416908264, gen p mean: -0.10354631394147873, mean p set: 0.4476735293865204
loss_pred:0.01486401166766882, decouple_loss:0.0007621964323334396
The modified gen p mean: 0.4459751844406128, gen p mean: -0.10758813470602036, mean p set: 0.4465501010417938
loss_pred:0.015250710770487785, decouple_loss:0.0007565865525975823
The modified gen p mean: 0.44675812125205994, gen p mean: -0.10839792340993881, mean p set: 0.4473371207714081
loss_pred:0.014179795049130917, decouple_loss:0.0009226070833392441
Iteration: 2002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468206763267517, gen p mean: -0.1077045425772667, mean p set: 0.44739529490470886
loss_pred:0.01466185599565506, decouple_loss:0.000706512073520571
The modified gen p mean: 0.44643622636795044, gen p mean: -0.10581424087285995, mean p set: 0.4470112919807434The modified gen p mean: 0.4473586678504944, gen p mean: -0.11015106737613678, mean p set: 0.447934627532959
loss_pred:0.0140225226059556, decouple_loss:0.0007209635223262012
loss_pred:0.015517786145210266, decouple_loss:0.0006157095776870847
Iteration: 2003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719916582107544, gen p mean: -0.10618960112333298, mean p set: 0.4477759003639221
loss_pred:0.014736955054104328, decouple_loss:0.0007998662767931819
The modified gen p mean: 0.4468633234500885, gen p mean: -0.11080235242843628, mean p set: 0.44743743538856506The modified gen p mean: 0.4468564987182617, gen p mean: -0.10937119275331497, mean p set: 0.4474334716796875
loss_pred:0.015193900093436241, decouple_loss:0.0007042083889245987
loss_pred:0.015268427319824696, decouple_loss:0.0007652408094145358
Iteration: 2004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44655659794807434, gen p mean: -0.10883750766515732, mean p set: 0.44713205099105835
loss_pred:0.01476326584815979, decouple_loss:0.0009070017840713263
The modified gen p mean: 0.44642820954322815, gen p mean: -0.10667089372873306, mean p set: 0.4470026195049286
loss_pred:0.015114198438823223, decouple_loss:0.0008328427793458104
The modified gen p mean: 0.4466131627559662, gen p mean: -0.11093252152204514, mean p set: 0.4471876323223114
loss_pred:0.015250823460519314, decouple_loss:0.0007803195621818304
Iteration: 2005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447070449590683, gen p mean: -0.1062677651643753, mean p set: 0.4476470947265625
The modified gen p mean: 0.4472205936908722, gen p mean: -0.10593634098768234, mean p set: 0.4477977156639099
loss_pred:0.01462904829531908, decouple_loss:0.0005586230545304716
loss_pred:0.014584551565349102, decouple_loss:0.000578486651647836
The modified gen p mean: 0.44653090834617615, gen p mean: -0.10445286333560944, mean p set: 0.4471050798892975
loss_pred:0.014229601249098778, decouple_loss:0.0006602649809792638
Iteration: 2006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478546977043152, gen p mean: -0.10837896168231964, mean p set: 0.44842812418937683
loss_pred:0.014950321987271309, decouple_loss:0.000622267194557935
The modified gen p mean: 0.44743940234184265, gen p mean: -0.11001686006784439, mean p set: 0.44801655411720276
loss_pred:0.013801890425384045, decouple_loss:0.0006209379644133151
The modified gen p mean: 0.4471079707145691, gen p mean: -0.1109907329082489, mean p set: 0.4476839005947113
loss_pred:0.013684633187949657, decouple_loss:0.0008616120903752744
Iteration: 2007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471810758113861, gen p mean: -0.10846015810966492, mean p set: 0.4477570950984955
loss_pred:0.014654712751507759, decouple_loss:0.0006906686467118561
The modified gen p mean: 0.44866257905960083, gen p mean: -0.11339256912469864, mean p set: 0.44923636317253113
loss_pred:0.014335802756249905, decouple_loss:0.0006301135872490704
The modified gen p mean: 0.44600173830986023, gen p mean: -0.11097364127635956, mean p set: 0.4465774595737457
loss_pred:0.015704821795225143, decouple_loss:0.0007408873061649501
Iteration: 2008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706860184669495, gen p mean: -0.10788985341787338, mean p set: 0.44764676690101624
loss_pred:0.01544279046356678, decouple_loss:0.0006670972215943038
The modified gen p mean: 0.44745784997940063, gen p mean: -0.11651326715946198, mean p set: 0.4480327367782593
loss_pred:0.01481748279184103, decouple_loss:0.0005599865107797086
The modified gen p mean: 0.44811704754829407, gen p mean: -0.10856858640909195, mean p set: 0.44869264960289
loss_pred:0.01454430166631937, decouple_loss:0.0006157482275739312
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
NaN value num: 0
Iteration: 2009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518366754055023, gen p mean: -0.1066151112318039, mean p set: 0.45241379737854004
loss_pred:0.016095302999019623, decouple_loss:0.0008344719535671175
The modified gen p mean: 0.4492082893848419, gen p mean: -0.10868507623672485, mean p set: 0.4497842490673065
loss_pred:0.015675798058509827, decouple_loss:0.0009220551582984626
The modified gen p mean: 0.44987383484840393, gen p mean: -0.10665871202945709, mean p set: 0.45045042037963867
loss_pred:0.01614200882613659, decouple_loss:0.0008100186241790652
Iteration: 2010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892215728759766, gen p mean: -0.10739703476428986, mean p set: 0.4494975507259369
loss_pred:0.01555800624191761, decouple_loss:0.0009717245120555162
The modified gen p mean: 0.4512164294719696, gen p mean: -0.10264143347740173, mean p set: 0.45179483294487
loss_pred:0.015759501606225967, decouple_loss:0.0007100265356712043
The modified gen p mean: 0.44994106888771057, gen p mean: -0.10464901477098465, mean p set: 0.45051753520965576
loss_pred:0.016090333461761475, decouple_loss:0.0007093667518347502
2023-05-01 07:01:53 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11039849370718002, mean p set: 0.4502691626548767
loss_pred:0.017112839967012405, decouple_loss:0.0007906019454821944
The modified gen p mean: 0.44953206181526184, gen p mean: -0.10435817390680313, mean p set: 0.4500633478164673
loss_pred:0.01652701385319233, decouple_loss:0.0007317312993109226
The modified gen p mean: 0.44982895255088806, gen p mean: -0.10411666333675385, mean p set: 0.45035696029663086
loss_pred:0.016849927604198456, decouple_loss:0.0006354771903716028
WV_1_PC_1_EH_0_PS_40, loss: 0.016865892335772514, avg_mse: 0.026223234832286835
current test mse: 0.026223
At step 2010, Best test: 0.026223
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 2011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45173379778862, gen p mean: -0.09888958930969238, mean p set: 0.4523118734359741
loss_pred:0.016279196366667747, decouple_loss:0.0007398381130769849
The modified gen p mean: 0.44942957162857056, gen p mean: -0.09791896492242813, mean p set: 0.4500047266483307
loss_pred:0.01563498005270958, decouple_loss:0.0006076544523239136
The modified gen p mean: 0.450585275888443, gen p mean: -0.09936714917421341, mean p set: 0.45116233825683594
loss_pred:0.01579856686294079, decouple_loss:0.0006793499342165887
Iteration: 2012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931700825691223, gen p mean: -0.09928839653730392, mean p set: 0.4498935639858246
loss_pred:0.0160811934620142, decouple_loss:0.0006496339337900281
The modified gen p mean: 0.44964393973350525, gen p mean: -0.09916906803846359, mean p set: 0.4502204656600952
The modified gen p mean: 0.4501752555370331, gen p mean: -0.09637940675020218, mean p set: 0.45075175166130066
loss_pred:0.015244759619235992, decouple_loss:0.0007224896107800305
loss_pred:0.01686396263539791, decouple_loss:0.0007986532291397452
Iteration: 2013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44957447052001953, gen p mean: -0.0943332090973854, mean p set: 0.4501529335975647
loss_pred:0.015583697706460953, decouple_loss:0.0005967456963844597
The modified gen p mean: 0.44991785287857056, gen p mean: -0.09144540131092072, mean p set: 0.4504949152469635
loss_pred:0.015437239781022072, decouple_loss:0.0006098854937590659
The modified gen p mean: 0.44909730553627014, gen p mean: -0.09141078591346741, mean p set: 0.4496713876724243
loss_pred:0.015650542452931404, decouple_loss:0.0005878319498151541
Iteration: 2014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971778988838196, gen p mean: -0.08919744193553925, mean p set: 0.45029497146606445
loss_pred:0.016009636223316193, decouple_loss:0.0006446458282880485
The modified gen p mean: 0.449989914894104, gen p mean: -0.09054538607597351, mean p set: 0.4505685865879059
loss_pred:0.01697356440126896, decouple_loss:0.000700342352502048
The modified gen p mean: 0.4491446316242218, gen p mean: -0.09422634541988373, mean p set: 0.4497208595275879
loss_pred:0.016083121299743652, decouple_loss:0.0007196352235041559
Iteration: 2015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514963626861572, gen p mean: -0.09169553965330124, mean p set: 0.45207199454307556
loss_pred:0.016103189438581467, decouple_loss:0.0006582047208212316
The modified gen p mean: 0.44899070262908936, gen p mean: -0.10135328024625778, mean p set: 0.44956985116004944
loss_pred:0.015544659458100796, decouple_loss:0.0006955786375328898
The modified gen p mean: 0.4482850432395935, gen p mean: -0.09222672879695892, mean p set: 0.44886115193367004
loss_pred:0.015268037095665932, decouple_loss:0.0009626405080780387
Iteration: 2016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501122534275055, gen p mean: -0.09749216586351395, mean p set: 0.4506879150867462
loss_pred:0.015668056905269623, decouple_loss:0.0005898113595321774
The modified gen p mean: 0.450122594833374, gen p mean: -0.0922209843993187, mean p set: 0.4506988525390625
The modified gen p mean: 0.4491681456565857, gen p mean: -0.09757105261087418, mean p set: 0.4497469365596771
loss_pred:0.015597963705658913, decouple_loss:0.0005479598767124116
loss_pred:0.015376065857708454, decouple_loss:0.0008736291201785207
Iteration: 2017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44970351457595825, gen p mean: -0.10277344286441803, mean p set: 0.45027947425842285
loss_pred:0.015527556650340557, decouple_loss:0.0007146362913772464
The modified gen p mean: 0.4501097500324249, gen p mean: -0.10344430804252625, mean p set: 0.45068684220314026
The modified gen p mean: 0.44983741641044617, gen p mean: -0.10065452009439468, mean p set: 0.4504128098487854
loss_pred:0.016016583889722824, decouple_loss:0.0006458328571170568
loss_pred:0.015773974359035492, decouple_loss:0.0009824284352362156
Iteration: 2018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010146498680115, gen p mean: -0.09480920433998108, mean p set: 0.4506790041923523
loss_pred:0.01604471541941166, decouple_loss:0.0007500483188778162
The modified gen p mean: 0.4502323269844055, gen p mean: -0.10615574568510056, mean p set: 0.45081138610839844
loss_pred:0.015970146283507347, decouple_loss:0.0007657981477677822
The modified gen p mean: 0.45039305090904236, gen p mean: -0.10010930895805359, mean p set: 0.4509684145450592
loss_pred:0.015881333500146866, decouple_loss:0.0007612479967065156
Iteration: 2019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900572299957275, gen p mean: -0.09902442246675491, mean p set: 0.4495818316936493
loss_pred:0.015880761668086052, decouple_loss:0.0007510075811296701
The modified gen p mean: 0.4505777359008789, gen p mean: -0.10571750998497009, mean p set: 0.45115405321121216
The modified gen p mean: 0.45093685388565063, gen p mean: -0.10485366731882095, mean p set: 0.45151498913764954
loss_pred:0.015822144225239754, decouple_loss:0.0007522378582507372
loss_pred:0.016840582713484764, decouple_loss:0.0009102375479415059
Iteration: 2020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44885262846946716, gen p mean: -0.09647434949874878, mean p set: 0.44943130016326904
loss_pred:0.015829579904675484, decouple_loss:0.0008223836193792522
The modified gen p mean: 0.45205190777778625, gen p mean: -0.09831281006336212, mean p set: 0.45262953639030457
loss_pred:0.015998639166355133, decouple_loss:0.0006955452263355255
The modified gen p mean: 0.44977861642837524, gen p mean: -0.10100550204515457, mean p set: 0.4503568708896637
loss_pred:0.015150846913456917, decouple_loss:0.0006206448888406157
2023-05-01 07:04:04 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1072310283780098, mean p set: 0.4502691626548767
loss_pred:0.017279094085097313, decouple_loss:0.00087786401854828
The modified gen p mean: 0.4495357275009155, gen p mean: -0.10140981525182724, mean p set: 0.4500633478164673
loss_pred:0.0166035033762455, decouple_loss:0.0009252012823708355
The modified gen p mean: 0.44983065128326416, gen p mean: -0.1011718362569809, mean p set: 0.45035696029663086
loss_pred:0.016947900876402855, decouple_loss:0.0008234750712290406
WV_1_PC_1_EH_0_PS_40, loss: 0.016987275332212448, avg_mse: 0.026332780718803406
current test mse: 0.026333
Iteration: 2021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45052504539489746, gen p mean: -0.0969960168004036, mean p set: 0.45110228657722473
loss_pred:0.01644185371696949, decouple_loss:0.0009708387078717351
The modified gen p mean: 0.4506342113018036, gen p mean: -0.09725667536258698, mean p set: 0.4512108564376831The modified gen p mean: 0.4500683546066284, gen p mean: -0.09058139473199844, mean p set: 0.4506444036960602
loss_pred:0.015278092585504055, decouple_loss:0.0009392459760420024loss_pred:0.015844162553548813, decouple_loss:0.0008815897745080292
Iteration: 2022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45102664828300476, gen p mean: -0.09827735275030136, mean p set: 0.4516029953956604
loss_pred:0.01582368277013302, decouple_loss:0.0008076003286987543
The modified gen p mean: 0.4509696066379547, gen p mean: -0.0973348319530487, mean p set: 0.4515463411808014The modified gen p mean: 0.4502338469028473, gen p mean: -0.09600256383419037, mean p set: 0.45081067085266113
loss_pred:0.0154222147539258, decouple_loss:0.0007705248426645994
loss_pred:0.015795454382896423, decouple_loss:0.0007899553165771067
Iteration: 2023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490165114402771, gen p mean: -0.10416216403245926, mean p set: 0.449592649936676
loss_pred:0.015167918987572193, decouple_loss:0.000700793054420501
The modified gen p mean: 0.4488661289215088, gen p mean: -0.09965404123067856, mean p set: 0.44944292306900024
loss_pred:0.015090790577232838, decouple_loss:0.0010218472452834249
The modified gen p mean: 0.44892618060112, gen p mean: -0.09729728102684021, mean p set: 0.4495031237602234
loss_pred:0.014656174927949905, decouple_loss:0.0009502392495051026
Iteration: 2024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45017388463020325, gen p mean: -0.09323371201753616, mean p set: 0.45075103640556335
loss_pred:0.015896789729595184, decouple_loss:0.0007452720310539007
The modified gen p mean: 0.44828885793685913, gen p mean: -0.09646208584308624, mean p set: 0.4488658010959625
loss_pred:0.015315407887101173, decouple_loss:0.0007925273384898901
The modified gen p mean: 0.4512560963630676, gen p mean: -0.10160105675458908, mean p set: 0.45183131098747253
loss_pred:0.01476704515516758, decouple_loss:0.0008926271693781018
Iteration: 2025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494527578353882, gen p mean: -0.09507150202989578, mean p set: 0.4500291645526886
loss_pred:0.0152324503287673, decouple_loss:0.0006009260541759431
The modified gen p mean: 0.44979196786880493, gen p mean: -0.09842102229595184, mean p set: 0.45036759972572327
loss_pred:0.01569894514977932, decouple_loss:0.0006011408404447138
The modified gen p mean: 0.4502754509449005, gen p mean: -0.09447801858186722, mean p set: 0.4508519768714905
loss_pred:0.015506564639508724, decouple_loss:0.0006917350110597908
Iteration: 2026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517594873905182, gen p mean: -0.09501811116933823, mean p set: 0.4523356258869171
loss_pred:0.01529381237924099, decouple_loss:0.0007549143629148602
The modified gen p mean: 0.45085564255714417, gen p mean: -0.09543461352586746, mean p set: 0.4514326751232147
loss_pred:0.015060360543429852, decouple_loss:0.0007983868126757443
The modified gen p mean: 0.44982975721359253, gen p mean: -0.08896158635616302, mean p set: 0.4504052996635437
loss_pred:0.015991250053048134, decouple_loss:0.0007908729021437466
Iteration: 2027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497240483760834, gen p mean: -0.09920584410429001, mean p set: 0.45029953122138977
loss_pred:0.015644842758774757, decouple_loss:0.0007892054854892194
The modified gen p mean: 0.4499935209751129, gen p mean: -0.09183413535356522, mean p set: 0.4505689740180969
loss_pred:0.015801504254341125, decouple_loss:0.0007908211555331945
The modified gen p mean: 0.4498053193092346, gen p mean: -0.08556807786226273, mean p set: 0.45038288831710815
loss_pred:0.01629403792321682, decouple_loss:0.000929527566768229
Iteration: 2028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45041975378990173, gen p mean: -0.0873650461435318, mean p set: 0.450996994972229
loss_pred:0.01596113108098507, decouple_loss:0.0009424196323379874
The modified gen p mean: 0.4506607949733734, gen p mean: -0.08855225145816803, mean p set: 0.45123711228370667
loss_pred:0.016765296459197998, decouple_loss:0.0007425516378134489
The modified gen p mean: 0.45040473341941833, gen p mean: -0.08695708960294724, mean p set: 0.45098140835762024
loss_pred:0.01623615063726902, decouple_loss:0.0010202585253864527
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
NaN value num: 0
Iteration: 2029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512432813644409, gen p mean: -0.09008245915174484, mean p set: 0.4518211781978607
The modified gen p mean: 0.4480421841144562, gen p mean: -0.09343928843736649, mean p set: 0.44862014055252075
loss_pred:0.01628962904214859, decouple_loss:0.0007678199326619506
loss_pred:0.01556686032563448, decouple_loss:0.0007101549417711794
The modified gen p mean: 0.45039132237434387, gen p mean: -0.09299449622631073, mean p set: 0.4509674608707428
loss_pred:0.015428965911269188, decouple_loss:0.0007559484802186489
Iteration: 2030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45188117027282715, gen p mean: -0.08797498047351837, mean p set: 0.4524591267108917
loss_pred:0.01523873582482338, decouple_loss:0.0006344845169223845
The modified gen p mean: 0.4475667178630829, gen p mean: -0.09535325318574905, mean p set: 0.448142409324646
loss_pred:0.016250547021627426, decouple_loss:0.0006199661293067038
The modified gen p mean: 0.4496472179889679, gen p mean: -0.0902210995554924, mean p set: 0.45022279024124146
loss_pred:0.015667008236050606, decouple_loss:0.0008423218969255686
2023-05-01 07:06:59 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10194893926382065, mean p set: 0.4502691626548767
loss_pred:0.017228858545422554, decouple_loss:0.0006356292869895697
The modified gen p mean: 0.44953641295433044, gen p mean: -0.09612364321947098, mean p set: 0.4500633478164673
loss_pred:0.016628630459308624, decouple_loss:0.000758527428843081
The modified gen p mean: 0.44982805848121643, gen p mean: -0.09581698477268219, mean p set: 0.45035696029663086
loss_pred:0.016920175403356552, decouple_loss:0.0007967224228195846
WV_1_PC_1_EH_0_PS_40, loss: 0.016962403431534767, avg_mse: 0.026321742683649063
current test mse: 0.026322
Iteration: 2031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493744373321533, gen p mean: -0.10128019750118256, mean p set: 0.449952095746994
loss_pred:0.015714995563030243, decouple_loss:0.0006418260163627565
The modified gen p mean: 0.4498247504234314, gen p mean: -0.09837964177131653, mean p set: 0.45039960741996765The modified gen p mean: 0.4527859091758728, gen p mean: -0.09708477556705475, mean p set: 0.4533640444278717
loss_pred:0.016081074252724648, decouple_loss:0.0006953818374313414
loss_pred:0.015493362210690975, decouple_loss:0.0007316655246540904
Iteration: 2032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527401924133301, gen p mean: -0.10037194937467575, mean p set: 0.4533170461654663
loss_pred:0.0151749849319458, decouple_loss:0.0007432145648635924
The modified gen p mean: 0.4515698254108429, gen p mean: -0.09840840101242065, mean p set: 0.4521452486515045The modified gen p mean: 0.4497702419757843, gen p mean: -0.1014028787612915, mean p set: 0.4503476321697235
loss_pred:0.015467297285795212, decouple_loss:0.000766392273362726
loss_pred:0.015386305749416351, decouple_loss:0.0006571457488462329
Iteration: 2033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491579532623291, gen p mean: -0.10046056658029556, mean p set: 0.4497356712818146
loss_pred:0.01512661762535572, decouple_loss:0.0006816458189859986
The modified gen p mean: 0.4489576816558838, gen p mean: -0.1067117303609848, mean p set: 0.44953182339668274
loss_pred:0.015451980754733086, decouple_loss:0.0006882933084852993
The modified gen p mean: 0.4513202905654907, gen p mean: -0.10459179431200027, mean p set: 0.4518939256668091
loss_pred:0.015436612069606781, decouple_loss:0.0007889823173172772
Iteration: 2034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498712122440338, gen p mean: -0.11237753182649612, mean p set: 0.4504474103450775
loss_pred:0.015742087736725807, decouple_loss:0.0007234161021187901
The modified gen p mean: 0.4500664174556732, gen p mean: -0.10436081141233444, mean p set: 0.4506407380104065
loss_pred:0.015528080984950066, decouple_loss:0.000780605711042881
The modified gen p mean: 0.4489922821521759, gen p mean: -0.10537474602460861, mean p set: 0.4495701789855957
loss_pred:0.015964088961482048, decouple_loss:0.0006877295672893524
Iteration: 2035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514544904232025, gen p mean: -0.10894215852022171, mean p set: 0.4520314931869507
loss_pred:0.015117913484573364, decouple_loss:0.0010765413753688335
The modified gen p mean: 0.4492924213409424, gen p mean: -0.10747139900922775, mean p set: 0.4498688280582428
loss_pred:0.01535598561167717, decouple_loss:0.0007304374012164772
The modified gen p mean: 0.4510606825351715, gen p mean: -0.10829491913318634, mean p set: 0.4516368806362152
loss_pred:0.015722235664725304, decouple_loss:0.0008068499737419188
Iteration: 2036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487510025501251, gen p mean: -0.11795340478420258, mean p set: 0.4493304491043091
loss_pred:0.015612618997693062, decouple_loss:0.0006614364683628082
The modified gen p mean: 0.45151159167289734, gen p mean: -0.1133284717798233, mean p set: 0.45208731293678284
The modified gen p mean: 0.4494130313396454, gen p mean: -0.11498547345399857, mean p set: 0.44998836517333984
loss_pred:0.015192925930023193, decouple_loss:0.000862460641656071
loss_pred:0.015475341118872166, decouple_loss:0.0006807824247516692
Iteration: 2037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969111680984497, gen p mean: -0.11600124835968018, mean p set: 0.45026808977127075
loss_pred:0.015811249613761902, decouple_loss:0.0006796148954890668
The modified gen p mean: 0.452053427696228, gen p mean: -0.11586754024028778, mean p set: 0.45262959599494934
loss_pred:0.014646782539784908, decouple_loss:0.0007847044616937637
The modified gen p mean: 0.4507308602333069, gen p mean: -0.11651519685983658, mean p set: 0.45130327343940735
loss_pred:0.015114937908947468, decouple_loss:0.0008429852896369994
Iteration: 2038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511285722255707, gen p mean: -0.11603469401597977, mean p set: 0.4517051577568054
loss_pred:0.015495987609028816, decouple_loss:0.000671127054374665
The modified gen p mean: 0.4526790976524353, gen p mean: -0.11838681995868683, mean p set: 0.45326003432273865
loss_pred:0.015054953284561634, decouple_loss:0.0007171271718107164
The modified gen p mean: 0.45118382573127747, gen p mean: -0.1175401359796524, mean p set: 0.4517599642276764
loss_pred:0.014859160408377647, decouple_loss:0.0006924471235834062
Iteration: 2039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45125049352645874, gen p mean: -0.11716587841510773, mean p set: 0.4518289566040039
loss_pred:0.014643769711256027, decouple_loss:0.0006670544389635324
The modified gen p mean: 0.4510853886604309, gen p mean: -0.11578000336885452, mean p set: 0.4516620337963104
loss_pred:0.015294973738491535, decouple_loss:0.0006928970688022673
The modified gen p mean: 0.4513770043849945, gen p mean: -0.11623314023017883, mean p set: 0.45195427536964417
loss_pred:0.014740439131855965, decouple_loss:0.0006338676321320236
Iteration: 2040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510282576084137, gen p mean: -0.11887954920530319, mean p set: 0.4516025483608246
loss_pred:0.015624330379068851, decouple_loss:0.0007935318863019347
The modified gen p mean: 0.45174145698547363, gen p mean: -0.11640524119138718, mean p set: 0.4523191750049591
loss_pred:0.015683989971876144, decouple_loss:0.0007027655374258757
The modified gen p mean: 0.45104923844337463, gen p mean: -0.11762362718582153, mean p set: 0.45162567496299744
loss_pred:0.015733612701296806, decouple_loss:0.0007097047055140138
2023-05-01 07:09:03 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12074930965900421, mean p set: 0.4502691626548767
loss_pred:0.017264991998672485, decouple_loss:0.0006353585631586611
The modified gen p mean: 0.4495338797569275, gen p mean: -0.11509714275598526, mean p set: 0.4500633478164673
loss_pred:0.01658649556338787, decouple_loss:0.0007460606866516173
The modified gen p mean: 0.4498303234577179, gen p mean: -0.1146620437502861, mean p set: 0.45035696029663086
loss_pred:0.016868403181433678, decouple_loss:0.0008049145108088851
WV_1_PC_1_EH_0_PS_40, loss: 0.01694306917488575, avg_mse: 0.02639611065387726
current test mse: 0.026396
Iteration: 2041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449898362159729, gen p mean: -0.1135873794555664, mean p set: 0.4504731595516205
loss_pred:0.01540171355009079, decouple_loss:0.0007020108168944716
The modified gen p mean: 0.4488275349140167, gen p mean: -0.11362671107053757, mean p set: 0.44940266013145447The modified gen p mean: 0.4492969214916229, gen p mean: -0.11255624890327454, mean p set: 0.4498729407787323
loss_pred:0.015139969997107983, decouple_loss:0.0008114217198453844
loss_pred:0.016355816274881363, decouple_loss:0.0006364784203469753
Iteration: 2042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506574869155884, gen p mean: -0.10751792788505554, mean p set: 0.4512324035167694
loss_pred:0.015562942251563072, decouple_loss:0.0006794436485506594
The modified gen p mean: 0.44865405559539795, gen p mean: -0.11714664846658707, mean p set: 0.44922778010368347The modified gen p mean: 0.45085644721984863, gen p mean: -0.10797518491744995, mean p set: 0.4514331519603729
loss_pred:0.01542691420763731, decouple_loss:0.0006738025695085526
loss_pred:0.015090130269527435, decouple_loss:0.0007335830596275628
Iteration: 2043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513567388057709, gen p mean: -0.11259801685810089, mean p set: 0.4519321024417877
The modified gen p mean: 0.4514094293117523, gen p mean: -0.11399530619382858, mean p set: 0.4519873261451721
loss_pred:0.014943258836865425, decouple_loss:0.0007868870161473751
loss_pred:0.01573648676276207, decouple_loss:0.0006203217781148851
The modified gen p mean: 0.4496464729309082, gen p mean: -0.12096535414457321, mean p set: 0.45022377371788025
loss_pred:0.015418700873851776, decouple_loss:0.0008591431542299688
Iteration: 2044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514067471027374, gen p mean: -0.11579245328903198, mean p set: 0.45198073983192444
The modified gen p mean: 0.45275554060935974, gen p mean: -0.11461585015058517, mean p set: 0.45333418250083923
loss_pred:0.015281776897609234, decouple_loss:0.0008527106838300824
loss_pred:0.014552611857652664, decouple_loss:0.0007644235156476498
The modified gen p mean: 0.4503006935119629, gen p mean: -0.11603435128927231, mean p set: 0.45087674260139465
loss_pred:0.016057206317782402, decouple_loss:0.0007260555867105722
Iteration: 2045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495964050292969, gen p mean: -0.11675192415714264, mean p set: 0.4501752555370331
loss_pred:0.015269323252141476, decouple_loss:0.0008172509842552245
The modified gen p mean: 0.44925549626350403, gen p mean: -0.11343339830636978, mean p set: 0.4498332440853119
loss_pred:0.015408739447593689, decouple_loss:0.0007951841107569635
The modified gen p mean: 0.4489419162273407, gen p mean: -0.1173148900270462, mean p set: 0.44951876997947693
loss_pred:0.015245291404426098, decouple_loss:0.0006812557112425566
Iteration: 2046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45117899775505066, gen p mean: -0.11549586802721024, mean p set: 0.45175832509994507
loss_pred:0.015070101246237755, decouple_loss:0.000718876370228827
The modified gen p mean: 0.4504881501197815, gen p mean: -0.12234573066234589, mean p set: 0.4510645270347595
The modified gen p mean: 0.451142281293869, gen p mean: -0.11556415259838104, mean p set: 0.4517160654067993
loss_pred:0.014931349083781242, decouple_loss:0.0007032352150417864
loss_pred:0.01539479661732912, decouple_loss:0.0007136745844036341
Iteration: 2047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971397519111633, gen p mean: -0.12000463157892227, mean p set: 0.45029211044311523
loss_pred:0.01529141515493393, decouple_loss:0.000691331981215626
The modified gen p mean: 0.4501769542694092, gen p mean: -0.11852441728115082, mean p set: 0.45075374841690063
The modified gen p mean: 0.44933968782424927, gen p mean: -0.11815796047449112, mean p set: 0.4499163329601288
loss_pred:0.015489145182073116, decouple_loss:0.0006570525001734495
loss_pred:0.016339866444468498, decouple_loss:0.0006358830141834915
Iteration: 2048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495891034603119, gen p mean: -0.12529639899730682, mean p set: 0.4501676559448242
loss_pred:0.015413157641887665, decouple_loss:0.0008557743858546019
The modified gen p mean: 0.44970980286598206, gen p mean: -0.11700421571731567, mean p set: 0.45028162002563477
The modified gen p mean: 0.451398640871048, gen p mean: -0.1128835454583168, mean p set: 0.45197638869285583
loss_pred:0.01590699888765812, decouple_loss:0.0008102982537820935
loss_pred:0.014696355909109116, decouple_loss:0.0006561221089214087
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 2049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714364409446716, gen p mean: -0.11854156851768494, mean p set: 0.4477207064628601
The modified gen p mean: 0.4494677782058716, gen p mean: -0.11826518923044205, mean p set: 0.4500423073768616
loss_pred:0.015123274177312851, decouple_loss:0.0007406469667330384
loss_pred:0.015614110045135021, decouple_loss:0.000859334715642035
The modified gen p mean: 0.448271781206131, gen p mean: -0.12340296804904938, mean p set: 0.44884857535362244
loss_pred:0.015312445349991322, decouple_loss:0.0006566707161255181
Iteration: 2050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493447244167328, gen p mean: -0.12275209277868271, mean p set: 0.4499218463897705
loss_pred:0.015222307294607162, decouple_loss:0.0007178514497354627
The modified gen p mean: 0.44934916496276855, gen p mean: -0.12004301697015762, mean p set: 0.4499257802963257
loss_pred:0.015369491651654243, decouple_loss:0.0006907558417879045
The modified gen p mean: 0.44821441173553467, gen p mean: -0.11497613042593002, mean p set: 0.4487907588481903
loss_pred:0.015386122278869152, decouple_loss:0.0008534430526196957
2023-05-01 07:11:46 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1223190426826477, mean p set: 0.4502691626548767
loss_pred:0.017250293865799904, decouple_loss:0.0006140907062217593
The modified gen p mean: 0.44953832030296326, gen p mean: -0.11609325557947159, mean p set: 0.4500633478164673
loss_pred:0.01652420498430729, decouple_loss:0.000684996834024787
The modified gen p mean: 0.4498273432254791, gen p mean: -0.11580414324998856, mean p set: 0.45035696029663086
loss_pred:0.016883572563529015, decouple_loss:0.0007261318969540298
WV_1_PC_1_EH_0_PS_40, loss: 0.016919776797294617, avg_mse: 0.026327941566705704
current test mse: 0.026328
Iteration: 2051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481560289859772, gen p mean: -0.11936957389116287, mean p set: 0.44873154163360596
loss_pred:0.014777240343391895, decouple_loss:0.0007127918070182204
The modified gen p mean: 0.4471089541912079, gen p mean: -0.11696775257587433, mean p set: 0.4476839303970337The modified gen p mean: 0.45048436522483826, gen p mean: -0.11440364271402359, mean p set: 0.45106109976768494
loss_pred:0.014912941493093967, decouple_loss:0.0007965920376591384
loss_pred:0.014079318381845951, decouple_loss:0.0006874731625430286
Iteration: 2052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44991570711135864, gen p mean: -0.1139785423874855, mean p set: 0.4504936933517456
loss_pred:0.014186459593474865, decouple_loss:0.0006776274531148374
The modified gen p mean: 0.4503236711025238, gen p mean: -0.11660036444664001, mean p set: 0.4508989155292511The modified gen p mean: 0.4488355815410614, gen p mean: -0.11459644138813019, mean p set: 0.4494141638278961
loss_pred:0.014311722479760647, decouple_loss:0.000810922821983695
loss_pred:0.015458677895367146, decouple_loss:0.0005981372087262571
Iteration: 2053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474339485168457, gen p mean: -0.11027617752552032, mean p set: 0.448009192943573
The modified gen p mean: 0.44890978932380676, gen p mean: -0.1208416000008583, mean p set: 0.4494844079017639
loss_pred:0.014558420516550541, decouple_loss:0.0007617560331709683
loss_pred:0.015323840081691742, decouple_loss:0.0007525813998654485
The modified gen p mean: 0.4498341977596283, gen p mean: -0.11279428750276566, mean p set: 0.450408935546875
loss_pred:0.014548941515386105, decouple_loss:0.0005995015380904078
Iteration: 2054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487748146057129, gen p mean: -0.11320819705724716, mean p set: 0.4493516683578491
The modified gen p mean: 0.4493246078491211, gen p mean: -0.11136403679847717, mean p set: 0.4499005675315857loss_pred:0.01606970652937889, decouple_loss:0.0007832568371668458
loss_pred:0.014840636402368546, decouple_loss:0.000604900240432471
The modified gen p mean: 0.4490084648132324, gen p mean: -0.11389582604169846, mean p set: 0.44958579540252686
loss_pred:0.015244574286043644, decouple_loss:0.0007022868958301842
Iteration: 2055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494163990020752, gen p mean: -0.1082955002784729, mean p set: 0.4499913156032562
loss_pred:0.014460123144090176, decouple_loss:0.0008291626581922174
The modified gen p mean: 0.45012331008911133, gen p mean: -0.11238444596529007, mean p set: 0.4507005214691162
loss_pred:0.014045234769582748, decouple_loss:0.0007258439436554909
The modified gen p mean: 0.4493091404438019, gen p mean: -0.11507632583379745, mean p set: 0.4498860538005829
loss_pred:0.01538534089922905, decouple_loss:0.0007134857005439699
Iteration: 2056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45002004504203796, gen p mean: -0.11299712210893631, mean p set: 0.4505973160266876
loss_pred:0.014915570616722107, decouple_loss:0.0007100747316144407
The modified gen p mean: 0.45010918378829956, gen p mean: -0.11236909031867981, mean p set: 0.4506858289241791
loss_pred:0.014588627964258194, decouple_loss:0.0007167842122726142
The modified gen p mean: 0.4492219388484955, gen p mean: -0.11504138261079788, mean p set: 0.4497992694377899
loss_pred:0.014869371429085732, decouple_loss:0.0007701902650296688
Iteration: 2057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504464864730835, gen p mean: -0.11193060874938965, mean p set: 0.4510194957256317
loss_pred:0.014344215393066406, decouple_loss:0.0006586791132576764
The modified gen p mean: 0.45018479228019714, gen p mean: -0.11743922531604767, mean p set: 0.45076262950897217
loss_pred:0.014054618775844574, decouple_loss:0.0006281723617576063
The modified gen p mean: 0.4499741494655609, gen p mean: -0.11279863864183426, mean p set: 0.4505492150783539
loss_pred:0.014306548051536083, decouple_loss:0.0007565398700535297
Iteration: 2058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501466155052185, gen p mean: -0.11168669164180756, mean p set: 0.4507233798503876
loss_pred:0.014850174076855183, decouple_loss:0.0009812931530177593
The modified gen p mean: 0.44905421137809753, gen p mean: -0.12127991765737534, mean p set: 0.4496326744556427
loss_pred:0.01481296494603157, decouple_loss:0.0009202655055560172
The modified gen p mean: 0.44882771372795105, gen p mean: -0.11509744077920914, mean p set: 0.4494022727012634
loss_pred:0.015548639930784702, decouple_loss:0.0008230354869738221
Iteration: 2059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45006731152534485, gen p mean: -0.11890909075737, mean p set: 0.45064398646354675
loss_pred:0.013602444902062416, decouple_loss:0.000681589066516608
The modified gen p mean: 0.44778361916542053, gen p mean: -0.11434957385063171, mean p set: 0.44835996627807617
The modified gen p mean: 0.4496014416217804, gen p mean: -0.11414851248264313, mean p set: 0.4501778185367584
loss_pred:0.015857785940170288, decouple_loss:0.0007518756319768727
loss_pred:0.014831646345555782, decouple_loss:0.0009803414577618241
Iteration: 2060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478610157966614, gen p mean: -0.12207888066768646, mean p set: 0.44843724370002747
loss_pred:0.014681286178529263, decouple_loss:0.0007054469315335155
The modified gen p mean: 0.4486563503742218, gen p mean: -0.11360001564025879, mean p set: 0.4492337107658386
loss_pred:0.014423063024878502, decouple_loss:0.0006926854257471859
The modified gen p mean: 0.4501895010471344, gen p mean: -0.11454831063747406, mean p set: 0.4507656991481781
loss_pred:0.014538969844579697, decouple_loss:0.0007562743849121034
2023-05-01 07:13:50 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12070723623037338, mean p set: 0.4502691626548767
loss_pred:0.017169279977679253, decouple_loss:0.0008334960439242423
The modified gen p mean: 0.44953328371047974, gen p mean: -0.11470198631286621, mean p set: 0.4500633478164673
loss_pred:0.016514495015144348, decouple_loss:0.000825754483230412
The modified gen p mean: 0.4498296082019806, gen p mean: -0.11467241495847702, mean p set: 0.45035696029663086
loss_pred:0.01695214956998825, decouple_loss:0.0008634027908556163
WV_1_PC_1_EH_0_PS_40, loss: 0.01692068576812744, avg_mse: 0.026336830109357834
current test mse: 0.026337
Iteration: 2061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024511218070984, gen p mean: -0.11500085145235062, mean p set: 0.4508228898048401
loss_pred:0.014214922674000263, decouple_loss:0.0007762520108371973
The modified gen p mean: 0.45067718625068665, gen p mean: -0.11201975494623184, mean p set: 0.4512515664100647
loss_pred:0.014704364351928234, decouple_loss:0.0010185512946918607
The modified gen p mean: 0.4504975378513336, gen p mean: -0.11677706241607666, mean p set: 0.4510750472545624
loss_pred:0.014926436357200146, decouple_loss:0.0007647759048268199
Iteration: 2062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44895851612091064, gen p mean: -0.10989969223737717, mean p set: 0.44953563809394836
loss_pred:0.014656764455139637, decouple_loss:0.0006036782287992537
The modified gen p mean: 0.44764283299446106, gen p mean: -0.11096273362636566, mean p set: 0.4482172131538391The modified gen p mean: 0.4498150050640106, gen p mean: -0.11221092939376831, mean p set: 0.4503912329673767
loss_pred:0.014591706916689873, decouple_loss:0.0005793083691969514
loss_pred:0.013570928946137428, decouple_loss:0.0008025862043723464
Iteration: 2063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891688227653503, gen p mean: -0.10991499572992325, mean p set: 0.44949066638946533
loss_pred:0.015015103854238987, decouple_loss:0.0006721402169205248
The modified gen p mean: 0.44949525594711304, gen p mean: -0.11049721390008926, mean p set: 0.45007139444351196The modified gen p mean: 0.4495571255683899, gen p mean: -0.11484058201313019, mean p set: 0.4501335322856903
loss_pred:0.015287593007087708, decouple_loss:0.0008221385651268065loss_pred:0.014309137128293514, decouple_loss:0.0005373564781621099
Iteration: 2064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831517338752747, gen p mean: -0.10836542397737503, mean p set: 0.44889214634895325
loss_pred:0.01479388028383255, decouple_loss:0.0008809491991996765
The modified gen p mean: 0.44867727160453796, gen p mean: -0.10732188820838928, mean p set: 0.4492511451244354
loss_pred:0.015845386311411858, decouple_loss:0.0008376891491934657
The modified gen p mean: 0.45034369826316833, gen p mean: -0.10926419496536255, mean p set: 0.4509190618991852
loss_pred:0.015042271465063095, decouple_loss:0.0010251820785924792
Iteration: 2065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890540838241577, gen p mean: -0.11932732164859772, mean p set: 0.4494830369949341
loss_pred:0.01441261637955904, decouple_loss:0.0006594419246539474
The modified gen p mean: 0.4492357671260834, gen p mean: -0.11693289875984192, mean p set: 0.4498126208782196
loss_pred:0.014451451599597931, decouple_loss:0.0006724640261381865
The modified gen p mean: 0.44932112097740173, gen p mean: -0.11685705929994583, mean p set: 0.4498968720436096
loss_pred:0.014056439511477947, decouple_loss:0.0005967780016362667
Iteration: 2066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474232494831085, gen p mean: -0.11142605543136597, mean p set: 0.4479977786540985
loss_pred:0.014605564996600151, decouple_loss:0.0006109245005063713
The modified gen p mean: 0.4503496289253235, gen p mean: -0.11479339748620987, mean p set: 0.45092666149139404
loss_pred:0.014600472524762154, decouple_loss:0.0006936458521522582
The modified gen p mean: 0.4496012330055237, gen p mean: -0.11498813331127167, mean p set: 0.45017769932746887
loss_pred:0.014245469123125076, decouple_loss:0.0005696269799955189
Iteration: 2067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491313695907593, gen p mean: -0.11429040879011154, mean p set: 0.449707955121994
loss_pred:0.015283938497304916, decouple_loss:0.0009114483837038279
The modified gen p mean: 0.4488155245780945, gen p mean: -0.1148332804441452, mean p set: 0.44939103722572327
loss_pred:0.01524968259036541, decouple_loss:0.0007588232983835042
The modified gen p mean: 0.448356032371521, gen p mean: -0.11033790558576584, mean p set: 0.4489321708679199
loss_pred:0.014540890231728554, decouple_loss:0.0007102915551513433
Iteration: 2068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852736592292786, gen p mean: -0.10841570049524307, mean p set: 0.4491027593612671
loss_pred:0.014767034910619259, decouple_loss:0.000929378264117986
The modified gen p mean: 0.44975635409355164, gen p mean: -0.1103290393948555, mean p set: 0.4503350555896759
loss_pred:0.014609640464186668, decouple_loss:0.000817842606920749
The modified gen p mean: 0.44898298382759094, gen p mean: -0.11499681323766708, mean p set: 0.4495563805103302
loss_pred:0.015031527727842331, decouple_loss:0.0006719242664985359
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
NaN value num: 0
Iteration: 2069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533419609069824, gen p mean: -0.10690159350633621, mean p set: 0.4539199471473694
loss_pred:0.016771212220191956, decouple_loss:0.000718632887583226
The modified gen p mean: 0.451516330242157, gen p mean: -0.10290153324604034, mean p set: 0.45209240913391113
loss_pred:0.01703643798828125, decouple_loss:0.0007077050395309925
The modified gen p mean: 0.45041003823280334, gen p mean: -0.10393032431602478, mean p set: 0.45098650455474854
loss_pred:0.01644158363342285, decouple_loss:0.0009219737839885056
Iteration: 2070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169106125831604, gen p mean: -0.10322022438049316, mean p set: 0.45226770639419556
loss_pred:0.01611938513815403, decouple_loss:0.0006275111809372902
The modified gen p mean: 0.4521719515323639, gen p mean: -0.10206899791955948, mean p set: 0.4527485966682434
loss_pred:0.01662948913872242, decouple_loss:0.000658986740745604
The modified gen p mean: 0.4519191384315491, gen p mean: -0.09637017548084259, mean p set: 0.4524966776371002
loss_pred:0.018142422661185265, decouple_loss:0.000912533316295594
2023-05-01 07:16:36 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11207402497529984, mean p set: 0.4502691626548767
loss_pred:0.01713998056948185, decouple_loss:0.0008447894360870123
The modified gen p mean: 0.4495355784893036, gen p mean: -0.10627515614032745, mean p set: 0.4500633478164673
loss_pred:0.016553157940506935, decouple_loss:0.0009223072556778789
The modified gen p mean: 0.44982922077178955, gen p mean: -0.1065768226981163, mean p set: 0.45035696029663086
loss_pred:0.016829654574394226, decouple_loss:0.0009020270081236959
WV_1_PC_1_EH_0_PS_40, loss: 0.016885418444871902, avg_mse: 0.026256084442138672
current test mse: 0.026256
Iteration: 2071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531790316104889, gen p mean: -0.10483067482709885, mean p set: 0.4537568688392639
loss_pred:0.016345683485269547, decouple_loss:0.0007480569765903056
The modified gen p mean: 0.45061081647872925, gen p mean: -0.10452064126729965, mean p set: 0.45118778944015503The modified gen p mean: 0.4513240158557892, gen p mean: -0.09470898658037186, mean p set: 0.4518997073173523
loss_pred:0.016572099179029465, decouple_loss:0.0007760247099213302
loss_pred:0.017712736502289772, decouple_loss:0.0010052666766569018
Iteration: 2072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45046916604042053, gen p mean: -0.10413695871829987, mean p set: 0.4510461390018463
loss_pred:0.018275177106261253, decouple_loss:0.0007944931858219206
The modified gen p mean: 0.45106038451194763, gen p mean: -0.09822695702314377, mean p set: 0.4516381621360779The modified gen p mean: 0.4515061676502228, gen p mean: -0.10289768874645233, mean p set: 0.4520838260650635
loss_pred:0.01710020937025547, decouple_loss:0.0006478926516138017
loss_pred:0.018137291073799133, decouple_loss:0.0006490470259450376
Iteration: 2073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506356716156006, gen p mean: -0.09072872996330261, mean p set: 0.45121118426322937
loss_pred:0.018065782263875008, decouple_loss:0.0007851521368138492
The modified gen p mean: 0.45137307047843933, gen p mean: -0.10192819684743881, mean p set: 0.45195040106773376
loss_pred:0.016494708135724068, decouple_loss:0.0007111522136256099
The modified gen p mean: 0.4505554139614105, gen p mean: -0.09905225038528442, mean p set: 0.4511306881904602
loss_pred:0.01648380607366562, decouple_loss:0.0006134613649919629
Iteration: 2074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45194950699806213, gen p mean: -0.10132525861263275, mean p set: 0.4525245428085327
loss_pred:0.01624225080013275, decouple_loss:0.0007286465261131525
The modified gen p mean: 0.45144596695899963, gen p mean: -0.09753075987100601, mean p set: 0.45202142000198364
loss_pred:0.01709536649286747, decouple_loss:0.0007226170273497701
The modified gen p mean: 0.45216935873031616, gen p mean: -0.0989660769701004, mean p set: 0.45274418592453003
loss_pred:0.016193849965929985, decouple_loss:0.0007098627393133938
Iteration: 2075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45243915915489197, gen p mean: -0.09960167855024338, mean p set: 0.45301714539527893
loss_pred:0.017346400767564774, decouple_loss:0.0008470209431834519
The modified gen p mean: 0.45101889967918396, gen p mean: -0.1012011244893074, mean p set: 0.45159485936164856
loss_pred:0.01642744243144989, decouple_loss:0.0007647710153833032
The modified gen p mean: 0.4512835741043091, gen p mean: -0.09560076147317886, mean p set: 0.4518592655658722
loss_pred:0.01738293282687664, decouple_loss:0.0007554445182904601
Iteration: 2076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45166122913360596, gen p mean: -0.10416729748249054, mean p set: 0.45223820209503174
loss_pred:0.01683099940419197, decouple_loss:0.0005733143771067262
The modified gen p mean: 0.4505527913570404, gen p mean: -0.09391746670007706, mean p set: 0.4511275291442871
loss_pred:0.017211072146892548, decouple_loss:0.0007623700657859445
The modified gen p mean: 0.45104700326919556, gen p mean: -0.10289117693901062, mean p set: 0.45162433385849
loss_pred:0.018192093819379807, decouple_loss:0.000817301101051271
Iteration: 2077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523453116416931, gen p mean: -0.09590980410575867, mean p set: 0.45292118191719055
loss_pred:0.01725548505783081, decouple_loss:0.0009555608849041164
The modified gen p mean: 0.4538753926753998, gen p mean: -0.10140205919742584, mean p set: 0.45445236563682556
loss_pred:0.016778448596596718, decouple_loss:0.000734057161025703
The modified gen p mean: 0.450620174407959, gen p mean: -0.09006781131029129, mean p set: 0.45119786262512207
loss_pred:0.017387861385941505, decouple_loss:0.000834279228001833
Iteration: 2078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505785405635834, gen p mean: -0.09884221851825714, mean p set: 0.4511549472808838
loss_pred:0.017135554924607277, decouple_loss:0.0007040680502541363
The modified gen p mean: 0.45214930176734924, gen p mean: -0.09754116833209991, mean p set: 0.4527277946472168
loss_pred:0.01697922684252262, decouple_loss:0.0011413764441385865
The modified gen p mean: 0.4524584114551544, gen p mean: -0.10624507814645767, mean p set: 0.4530346095561981
loss_pred:0.01680854521691799, decouple_loss:0.0008473957423120737
Iteration: 2079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45150333642959595, gen p mean: -0.09774522483348846, mean p set: 0.45208099484443665
loss_pred:0.01691601239144802, decouple_loss:0.0007762092282064259
The modified gen p mean: 0.45196953415870667, gen p mean: -0.09718124568462372, mean p set: 0.45254722237586975
loss_pred:0.016155732795596123, decouple_loss:0.0005679936148226261
The modified gen p mean: 0.45187532901763916, gen p mean: -0.09680763632059097, mean p set: 0.4524519443511963
loss_pred:0.016805384308099747, decouple_loss:0.0008560409187339246
Iteration: 2080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516940414905548, gen p mean: -0.10230687260627747, mean p set: 0.45226994156837463
loss_pred:0.016346821561455727, decouple_loss:0.0008628915529698133
The modified gen p mean: 0.45134052634239197, gen p mean: -0.10690507292747498, mean p set: 0.451918363571167
loss_pred:0.01674475334584713, decouple_loss:0.0009463774040341377
The modified gen p mean: 0.4522955119609833, gen p mean: -0.10186826437711716, mean p set: 0.45287254452705383
loss_pred:0.017311420291662216, decouple_loss:0.0009371571941301227
2023-05-01 07:18:41 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11469929665327072, mean p set: 0.4502691626548767
loss_pred:0.017292585223913193, decouple_loss:0.0009730175952427089
The modified gen p mean: 0.449534147977829, gen p mean: -0.10957881063222885, mean p set: 0.4500633478164673
loss_pred:0.016687164083123207, decouple_loss:0.001265010330826044
The modified gen p mean: 0.449826717376709, gen p mean: -0.10976046323776245, mean p set: 0.45035696029663086
loss_pred:0.0168764665722847, decouple_loss:0.0012097563594579697
WV_1_PC_1_EH_0_PS_40, loss: 0.017009535804390907, avg_mse: 0.026408560574054718
current test mse: 0.026409
Iteration: 2081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45164892077445984, gen p mean: -0.10350259393453598, mean p set: 0.45222529768943787
loss_pred:0.017122909426689148, decouple_loss:0.0011588400229811668
The modified gen p mean: 0.4510827958583832, gen p mean: -0.10790155827999115, mean p set: 0.4516591429710388The modified gen p mean: 0.4514677822589874, gen p mean: -0.10780475288629532, mean p set: 0.45204612612724304
loss_pred:0.01650312729179859, decouple_loss:0.0010020522167906165
loss_pred:0.01599179022014141, decouple_loss:0.0008929178002290428
Iteration: 2082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497978389263153, gen p mean: -0.10726960003376007, mean p set: 0.45037490129470825
loss_pred:0.017044726759195328, decouple_loss:0.0009916218696162105
The modified gen p mean: 0.4521673917770386, gen p mean: -0.10571688413619995, mean p set: 0.45274466276168823The modified gen p mean: 0.45112836360931396, gen p mean: -0.10783061385154724, mean p set: 0.4517037868499756
loss_pred:0.01734091155230999, decouple_loss:0.0009043421014212072
loss_pred:0.017200548201799393, decouple_loss:0.0009974444983527064
Iteration: 2083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511466324329376, gen p mean: -0.11412464827299118, mean p set: 0.4517228305339813
loss_pred:0.01701480522751808, decouple_loss:0.000797418353613466
The modified gen p mean: 0.4509829878807068, gen p mean: -0.11041628569364548, mean p set: 0.4515587389469147
loss_pred:0.017114538699388504, decouple_loss:0.0007576055941171944
The modified gen p mean: 0.4500654339790344, gen p mean: -0.10771603882312775, mean p set: 0.45064112544059753
loss_pred:0.017214609310030937, decouple_loss:0.0008267817320302129
Iteration: 2084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45122116804122925, gen p mean: -0.10885912925004959, mean p set: 0.4517951011657715
loss_pred:0.016934899613261223, decouple_loss:0.0010354919359087944
The modified gen p mean: 0.4513436257839203, gen p mean: -0.1090027391910553, mean p set: 0.4519197940826416
loss_pred:0.017161132767796516, decouple_loss:0.000983860925771296
The modified gen p mean: 0.4537629783153534, gen p mean: -0.10988999903202057, mean p set: 0.4543396830558777
loss_pred:0.016429973766207695, decouple_loss:0.0009529347880743444
Iteration: 2085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506966471672058, gen p mean: -0.10591772198677063, mean p set: 0.45127376914024353
loss_pred:0.017969347536563873, decouple_loss:0.0008153170347213745
The modified gen p mean: 0.4515054523944855, gen p mean: -0.10649556666612625, mean p set: 0.4520830810070038
loss_pred:0.016842063516378403, decouple_loss:0.0008954060031101108
The modified gen p mean: 0.4513610005378723, gen p mean: -0.11000435054302216, mean p set: 0.45193958282470703
loss_pred:0.016661711037158966, decouple_loss:0.0011119999689981341
Iteration: 2086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531959295272827, gen p mean: -0.12106073647737503, mean p set: 0.4537709653377533
loss_pred:0.016728710383176804, decouple_loss:0.0007425877847708762
The modified gen p mean: 0.45102760195732117, gen p mean: -0.1189149022102356, mean p set: 0.45160651206970215
loss_pred:0.017258021980524063, decouple_loss:0.0008081336272880435
The modified gen p mean: 0.45260876417160034, gen p mean: -0.12000048905611038, mean p set: 0.45318475365638733
loss_pred:0.01614372991025448, decouple_loss:0.0011327540269121528
Iteration: 2087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012399554252625, gen p mean: -0.12588991224765778, mean p set: 0.45069798827171326
loss_pred:0.01583876833319664, decouple_loss:0.0008487526793032885
The modified gen p mean: 0.45107606053352356, gen p mean: -0.1277773231267929, mean p set: 0.45165136456489563
loss_pred:0.01688251830637455, decouple_loss:0.0008562046568840742
The modified gen p mean: 0.450697124004364, gen p mean: -0.1291816085577011, mean p set: 0.45127442479133606
loss_pred:0.016921967267990112, decouple_loss:0.0008530302438884974
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
NaN value num: 0
Iteration: 2088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45201238989830017, gen p mean: -0.1247057393193245, mean p set: 0.4525914490222931
loss_pred:0.01657702960073948, decouple_loss:0.0010327089112251997
The modified gen p mean: 0.4522876441478729, gen p mean: -0.1267886906862259, mean p set: 0.45286887884140015
The modified gen p mean: 0.4516972601413727, gen p mean: -0.12898755073547363, mean p set: 0.45227181911468506
loss_pred:0.016000011935830116, decouple_loss:0.0008833414176478982
loss_pred:0.016867700964212418, decouple_loss:0.0009715273045003414
Iteration: 2089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513794183731079, gen p mean: -0.10654593259096146, mean p set: 0.4519574046134949
loss_pred:0.01635582558810711, decouple_loss:0.0007628482999280095
The modified gen p mean: 0.44980698823928833, gen p mean: -0.11695435643196106, mean p set: 0.4503830373287201
loss_pred:0.015795299783349037, decouple_loss:0.0007485197274945676
The modified gen p mean: 0.45174723863601685, gen p mean: -0.10575317591428757, mean p set: 0.45232194662094116
loss_pred:0.01647048629820347, decouple_loss:0.0007362200412899256
Iteration: 2090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495125114917755, gen p mean: -0.09388419985771179, mean p set: 0.4500887989997864
loss_pred:0.016296977177262306, decouple_loss:0.0009300135425291955
The modified gen p mean: 0.44956135749816895, gen p mean: -0.09330113977193832, mean p set: 0.45013532042503357
loss_pred:0.017430277541279793, decouple_loss:0.0009488153737038374
The modified gen p mean: 0.4491270184516907, gen p mean: -0.10215979814529419, mean p set: 0.4497041702270508
loss_pred:0.01577158086001873, decouple_loss:0.000983236008323729
2023-05-01 07:21:27 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10171333700418472, mean p set: 0.4502691626548767
loss_pred:0.017459621652960777, decouple_loss:0.000997263239696622
The modified gen p mean: 0.44953465461730957, gen p mean: -0.09647109359502792, mean p set: 0.4500633478164673
loss_pred:0.016928087919950485, decouple_loss:0.0010593943297863007
The modified gen p mean: 0.44983071088790894, gen p mean: -0.09659506380558014, mean p set: 0.45035696029663086
loss_pred:0.017082614824175835, decouple_loss:0.0009227183763869107
WV_1_PC_1_EH_0_PS_40, loss: 0.017206430435180664, avg_mse: 0.026582440361380577
current test mse: 0.026582
Iteration: 2091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450271874666214, gen p mean: -0.09474760293960571, mean p set: 0.45084765553474426
loss_pred:0.015709582716226578, decouple_loss:0.0007207677117548883
The modified gen p mean: 0.45132002234458923, gen p mean: -0.0881575271487236, mean p set: 0.45189690589904785The modified gen p mean: 0.448928564786911, gen p mean: -0.09460862725973129, mean p set: 0.4495048522949219
loss_pred:0.015737490728497505, decouple_loss:0.000782748160418123
loss_pred:0.016426319256424904, decouple_loss:0.0008667954243719578
Iteration: 2092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45031386613845825, gen p mean: -0.09437651932239532, mean p set: 0.4508911669254303
loss_pred:0.016462882980704308, decouple_loss:0.0009186047245748341
The modified gen p mean: 0.4493113160133362, gen p mean: -0.0995243564248085, mean p set: 0.44988757371902466The modified gen p mean: 0.4504943788051605, gen p mean: -0.09025131911039352, mean p set: 0.45107173919677734
loss_pred:0.015869231894612312, decouple_loss:0.0009800054831430316
loss_pred:0.016581151634454727, decouple_loss:0.0007691163336858153
Iteration: 2093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44950687885284424, gen p mean: -0.1031264215707779, mean p set: 0.45008331537246704
loss_pred:0.016419129446148872, decouple_loss:0.0009532415424473584
The modified gen p mean: 0.4489271640777588, gen p mean: -0.10419894754886627, mean p set: 0.4495026767253876
loss_pred:0.015699349343776703, decouple_loss:0.0008782482473179698
The modified gen p mean: 0.4494932293891907, gen p mean: -0.10742354393005371, mean p set: 0.45006799697875977
loss_pred:0.01618722639977932, decouple_loss:0.0008362714434042573
Iteration: 2094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529075622558594, gen p mean: -0.0922846794128418, mean p set: 0.45348381996154785
loss_pred:0.01674269512295723, decouple_loss:0.0007377612055279315
The modified gen p mean: 0.4501090943813324, gen p mean: -0.09374857693910599, mean p set: 0.45068594813346863
loss_pred:0.015707742422819138, decouple_loss:0.0006661943043582141
The modified gen p mean: 0.4499325752258301, gen p mean: -0.1029856950044632, mean p set: 0.4505097270011902
loss_pred:0.015819573774933815, decouple_loss:0.0006997453747317195
Iteration: 2095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846969842910767, gen p mean: -0.10866275429725647, mean p set: 0.44904735684394836
loss_pred:0.015649178996682167, decouple_loss:0.0007432624697685242
The modified gen p mean: 0.4517097771167755, gen p mean: -0.10931701213121414, mean p set: 0.45228907465934753
loss_pred:0.01729733869433403, decouple_loss:0.0008244228665716946
The modified gen p mean: 0.45170262455940247, gen p mean: -0.10547907650470734, mean p set: 0.45227932929992676
loss_pred:0.018023662269115448, decouple_loss:0.0006473360117524862
Iteration: 2096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494263231754303, gen p mean: -0.12158884853124619, mean p set: 0.4500034749507904
loss_pred:0.01822286657989025, decouple_loss:0.0008663050830364227
The modified gen p mean: 0.4488738477230072, gen p mean: -0.11725587397813797, mean p set: 0.4494488537311554
loss_pred:0.01609857752919197, decouple_loss:0.0007986249984242022
The modified gen p mean: 0.44969719648361206, gen p mean: -0.11359521001577377, mean p set: 0.45027193427085876
loss_pred:0.017071513459086418, decouple_loss:0.0010696416720747948
Iteration: 2097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498460590839386, gen p mean: -0.10906044393777847, mean p set: 0.4504234194755554
loss_pred:0.017716078087687492, decouple_loss:0.0006860007997602224
The modified gen p mean: 0.45180752873420715, gen p mean: -0.11834665387868881, mean p set: 0.4523826837539673
loss_pred:0.017091190442442894, decouple_loss:0.0007401921902783215
The modified gen p mean: 0.45143020153045654, gen p mean: -0.11458984762430191, mean p set: 0.45200514793395996
loss_pred:0.01667824015021324, decouple_loss:0.0006847731419838965
Iteration: 2098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44965606927871704, gen p mean: -0.1199859231710434, mean p set: 0.45023199915885925
loss_pred:0.015955569222569466, decouple_loss:0.0006731501780450344
The modified gen p mean: 0.4485280215740204, gen p mean: -0.11846095323562622, mean p set: 0.44910362362861633
loss_pred:0.01615738868713379, decouple_loss:0.0006180537748150527
The modified gen p mean: 0.44931015372276306, gen p mean: -0.11975454539060593, mean p set: 0.44988515973091125
loss_pred:0.016684280708432198, decouple_loss:0.0006892523961141706
Iteration: 2099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487707018852234, gen p mean: -0.11771196871995926, mean p set: 0.4493463933467865
loss_pred:0.01739949733018875, decouple_loss:0.0007985983975231647
The modified gen p mean: 0.45041123032569885, gen p mean: -0.12711891531944275, mean p set: 0.4509873688220978
loss_pred:0.01608658768236637, decouple_loss:0.0006505711353383958
The modified gen p mean: 0.4492727220058441, gen p mean: -0.12306436896324158, mean p set: 0.4498482048511505
loss_pred:0.016885006800293922, decouple_loss:0.000712583598215133
Iteration: 2100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493046998977661, gen p mean: -0.1129719689488411, mean p set: 0.44988009333610535
loss_pred:0.015277205035090446, decouple_loss:0.0006324862479232252
The modified gen p mean: 0.4508916139602661, gen p mean: -0.10441716760396957, mean p set: 0.4514676034450531
loss_pred:0.016549155116081238, decouple_loss:0.000623702653683722
The modified gen p mean: 0.4498790502548218, gen p mean: -0.11434656381607056, mean p set: 0.4504542350769043
loss_pred:0.016331562772393227, decouple_loss:0.0005719996406696737
2023-05-01 07:23:32 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11182064563035965, mean p set: 0.4502691626548767
loss_pred:0.017663216218352318, decouple_loss:0.0007807808578945696
The modified gen p mean: 0.4495335519313812, gen p mean: -0.1060711070895195, mean p set: 0.4500633478164673
loss_pred:0.01700461469590664, decouple_loss:0.0007689417689107358
The modified gen p mean: 0.4498273730278015, gen p mean: -0.10605526715517044, mean p set: 0.45035696029663086
loss_pred:0.017307665199041367, decouple_loss:0.0008079624967649579
WV_1_PC_1_EH_0_PS_40, loss: 0.017364460974931717, avg_mse: 0.026787295937538147
current test mse: 0.026787
Iteration: 2101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45191842317581177, gen p mean: -0.10251200199127197, mean p set: 0.4524949789047241
loss_pred:0.016151264309883118, decouple_loss:0.0007294822717085481
The modified gen p mean: 0.4503021836280823, gen p mean: -0.09694060683250427, mean p set: 0.4508790671825409
loss_pred:0.01656333915889263, decouple_loss:0.0007376153953373432
The modified gen p mean: 0.45040765404701233, gen p mean: -0.10427900403738022, mean p set: 0.450985848903656
loss_pred:0.01608830876648426, decouple_loss:0.0005968315526843071
Iteration: 2102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45224758982658386, gen p mean: -0.0894460529088974, mean p set: 0.45282456278800964
loss_pred:0.016329778358340263, decouple_loss:0.0010460305493324995
The modified gen p mean: 0.4487735629081726, gen p mean: -0.0950113832950592, mean p set: 0.44935014843940735The modified gen p mean: 0.4485029876232147, gen p mean: -0.09471305459737778, mean p set: 0.44908010959625244
loss_pred:0.015117797069251537, decouple_loss:0.0005437335930764675loss_pred:0.016522439196705818, decouple_loss:0.0005909471656195819
Iteration: 2103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915148615837097, gen p mean: -0.09526146948337555, mean p set: 0.4497282803058624
loss_pred:0.01611252687871456, decouple_loss:0.000884664012119174
The modified gen p mean: 0.4495340585708618, gen p mean: -0.0915028527379036, mean p set: 0.45011085271835327The modified gen p mean: 0.4494708776473999, gen p mean: -0.0895000621676445, mean p set: 0.4500472843647003
loss_pred:0.017280763015151024, decouple_loss:0.000850729935336858
loss_pred:0.017089297994971275, decouple_loss:0.0007760303560644388
Iteration: 2104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511333703994751, gen p mean: -0.09477050602436066, mean p set: 0.45171138644218445
loss_pred:0.016566257923841476, decouple_loss:0.0009347397717647254
The modified gen p mean: 0.4503142237663269, gen p mean: -0.09284037351608276, mean p set: 0.45089030265808105
loss_pred:0.01671750284731388, decouple_loss:0.0007600116077810526
The modified gen p mean: 0.45259737968444824, gen p mean: -0.09687570482492447, mean p set: 0.4531742036342621
loss_pred:0.01717912033200264, decouple_loss:0.0008236714638769627
Iteration: 2105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448964923620224, gen p mean: -0.10091046988964081, mean p set: 0.44954198598861694
loss_pred:0.016479359939694405, decouple_loss:0.0007017432362772524
The modified gen p mean: 0.4500686228275299, gen p mean: -0.09986777603626251, mean p set: 0.450647234916687
loss_pred:0.016289668157696724, decouple_loss:0.000832584744784981
The modified gen p mean: 0.45136797428131104, gen p mean: -0.09794095903635025, mean p set: 0.45194414258003235
loss_pred:0.015840472653508186, decouple_loss:0.0007468140684068203
Iteration: 2106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45195430517196655, gen p mean: -0.09187875688076019, mean p set: 0.45253291726112366
loss_pred:0.01623658649623394, decouple_loss:0.000828296469990164
The modified gen p mean: 0.4521412253379822, gen p mean: -0.09477770328521729, mean p set: 0.4527186155319214
loss_pred:0.015863418579101562, decouple_loss:0.0008489434840157628
The modified gen p mean: 0.45098552107810974, gen p mean: -0.09159291535615921, mean p set: 0.45156344771385193
loss_pred:0.016290653496980667, decouple_loss:0.0010033005382865667
Iteration: 2107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509452283382416, gen p mean: -0.08660532534122467, mean p set: 0.4515224099159241
loss_pred:0.01706070825457573, decouple_loss:0.0010290072532370687
The modified gen p mean: 0.4503643214702606, gen p mean: -0.09950537979602814, mean p set: 0.45094096660614014
loss_pred:0.016064975410699844, decouple_loss:0.0010229304898530245
The modified gen p mean: 0.44865289330482483, gen p mean: -0.09169307351112366, mean p set: 0.44922736287117004
loss_pred:0.016479915007948875, decouple_loss:0.0010388526134192944
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
NaN value num: 0
Iteration: 2108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45074743032455444, gen p mean: -0.08589619398117065, mean p set: 0.4513244330883026
The modified gen p mean: 0.45260941982269287, gen p mean: -0.08708323538303375, mean p set: 0.45318663120269775
loss_pred:0.016974298283457756, decouple_loss:0.0010414290009066463loss_pred:0.016955150291323662, decouple_loss:0.0011584078893065453
The modified gen p mean: 0.45388495922088623, gen p mean: -0.08640265464782715, mean p set: 0.45446059107780457
loss_pred:0.01546844094991684, decouple_loss:0.000919138255994767
Iteration: 2109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526240825653076, gen p mean: -0.08764263987541199, mean p set: 0.4531993865966797
loss_pred:0.01667303964495659, decouple_loss:0.0012430327478796244
The modified gen p mean: 0.4521668553352356, gen p mean: -0.0867748111486435, mean p set: 0.4527444541454315
loss_pred:0.015993842855095863, decouple_loss:0.0009821949061006308
The modified gen p mean: 0.45092859864234924, gen p mean: -0.08764883875846863, mean p set: 0.4515043795108795
loss_pred:0.017423145473003387, decouple_loss:0.001013437518849969
Iteration: 2110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519139230251312, gen p mean: -0.09516159445047379, mean p set: 0.4524921178817749
loss_pred:0.015748662874102592, decouple_loss:0.0009542944026179612
The modified gen p mean: 0.451058954000473, gen p mean: -0.0909869596362114, mean p set: 0.4516349136829376
loss_pred:0.017310582101345062, decouple_loss:0.000816810701508075
The modified gen p mean: 0.45272713899612427, gen p mean: -0.09075073897838593, mean p set: 0.4533042907714844
loss_pred:0.01597457192838192, decouple_loss:0.0010626352159306407
2023-05-01 07:26:20 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1074138805270195, mean p set: 0.4502691626548767
loss_pred:0.01752692088484764, decouple_loss:0.0008024215348996222
The modified gen p mean: 0.4495372474193573, gen p mean: -0.10127817839384079, mean p set: 0.4500633478164673
The modified gen p mean: 0.4498266875743866, gen p mean: -0.10136998444795609, mean p set: 0.45035696029663086
loss_pred:0.01678178831934929, decouple_loss:0.0007490318384952843
loss_pred:0.017069268971681595, decouple_loss:0.000812725571449846
WV_1_PC_1_EH_0_PS_40, loss: 0.017165396362543106, avg_mse: 0.026578707620501518
current test mse: 0.026579
Iteration: 2111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45262202620506287, gen p mean: -0.09419812262058258, mean p set: 0.45320072770118713
loss_pred:0.015991276130080223, decouple_loss:0.0007006963132880628
The modified gen p mean: 0.4526149332523346, gen p mean: -0.09415128082036972, mean p set: 0.45319366455078125The modified gen p mean: 0.45058685541152954, gen p mean: -0.09450740367174149, mean p set: 0.4511641561985016
loss_pred:0.014992930926382542, decouple_loss:0.0009685470722615719
loss_pred:0.015772050246596336, decouple_loss:0.0012546539073809981
Iteration: 2112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45141687989234924, gen p mean: -0.09424926340579987, mean p set: 0.4519941210746765
loss_pred:0.016529753804206848, decouple_loss:0.0010237768292427063
The modified gen p mean: 0.45077306032180786, gen p mean: -0.09298849105834961, mean p set: 0.4513503611087799The modified gen p mean: 0.45065128803253174, gen p mean: -0.0885792225599289, mean p set: 0.4512292742729187
loss_pred:0.01659218780696392, decouple_loss:0.0010117769706994295
loss_pred:0.017868198454380035, decouple_loss:0.0012289669830352068
Iteration: 2113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45207300782203674, gen p mean: -0.09661035239696503, mean p set: 0.45264923572540283
loss_pred:0.01667635142803192, decouple_loss:0.0013416471192613244
The modified gen p mean: 0.45098671317100525, gen p mean: -0.09595330059528351, mean p set: 0.4515630006790161
loss_pred:0.017711469903588295, decouple_loss:0.0013274475932121277
The modified gen p mean: 0.4508686363697052, gen p mean: -0.09502939879894257, mean p set: 0.4514450132846832
loss_pred:0.016683215275406837, decouple_loss:0.0012395704397931695
Iteration: 2114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45072486996650696, gen p mean: -0.09373797476291656, mean p set: 0.45130228996276855
loss_pred:0.015821782872080803, decouple_loss:0.0006504292250610888
The modified gen p mean: 0.4521331787109375, gen p mean: -0.09521034359931946, mean p set: 0.45270848274230957
loss_pred:0.016528988257050514, decouple_loss:0.0006916685379110277
The modified gen p mean: 0.4512788653373718, gen p mean: -0.09329352527856827, mean p set: 0.4518548846244812
loss_pred:0.017049511894583702, decouple_loss:0.0012554508866742253
Iteration: 2115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45239824056625366, gen p mean: -0.09071878343820572, mean p set: 0.45297735929489136
loss_pred:0.01563877798616886, decouple_loss:0.0011280474718660116
The modified gen p mean: 0.45223307609558105, gen p mean: -0.09386029839515686, mean p set: 0.45281070470809937
loss_pred:0.016214504837989807, decouple_loss:0.0008470038301311433
The modified gen p mean: 0.45121240615844727, gen p mean: -0.08892102539539337, mean p set: 0.4517904222011566
loss_pred:0.016802359372377396, decouple_loss:0.0011168750934302807
Iteration: 2116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45338141918182373, gen p mean: -0.09470478445291519, mean p set: 0.45395946502685547
loss_pred:0.015742048621177673, decouple_loss:0.0010545363184064627
The modified gen p mean: 0.45355597138404846, gen p mean: -0.0930996835231781, mean p set: 0.4541351795196533
loss_pred:0.015506151132285595, decouple_loss:0.0010750644141808152
The modified gen p mean: 0.4523112177848816, gen p mean: -0.09848891943693161, mean p set: 0.4528883397579193
loss_pred:0.015769246965646744, decouple_loss:0.001060471055097878
Iteration: 2117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45126283168792725, gen p mean: -0.09982990473508835, mean p set: 0.4518386423587799
loss_pred:0.016654687002301216, decouple_loss:0.0007507337140850723
The modified gen p mean: 0.4521080255508423, gen p mean: -0.09946144372224808, mean p set: 0.45268580317497253
loss_pred:0.016251597553491592, decouple_loss:0.0007907566614449024
The modified gen p mean: 0.45125439763069153, gen p mean: -0.08832396566867828, mean p set: 0.45182904601097107
loss_pred:0.0172417052090168, decouple_loss:0.0007765083573758602
Iteration: 2118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45132240653038025, gen p mean: -0.09900195896625519, mean p set: 0.4519002437591553
loss_pred:0.015237853862345219, decouple_loss:0.0009347005398012698
The modified gen p mean: 0.45217403769493103, gen p mean: -0.10023611783981323, mean p set: 0.45275095105171204
loss_pred:0.015395048074424267, decouple_loss:0.0008740691118873656
The modified gen p mean: 0.4504399001598358, gen p mean: -0.09950119256973267, mean p set: 0.4510186016559601
loss_pred:0.01684785634279251, decouple_loss:0.0011676647700369358
Iteration: 2119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45038342475891113, gen p mean: -0.10504110157489777, mean p set: 0.45096346735954285
loss_pred:0.01714310795068741, decouple_loss:0.0007526089902967215
The modified gen p mean: 0.4508844017982483, gen p mean: -0.10062888264656067, mean p set: 0.45146000385284424
loss_pred:0.01584884338080883, decouple_loss:0.0007280280697159469
The modified gen p mean: 0.4528459310531616, gen p mean: -0.10054203122854233, mean p set: 0.4534226953983307
loss_pred:0.015377898700535297, decouple_loss:0.0006556251319125295
Iteration: 2120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516017436981201, gen p mean: -0.09780258685350418, mean p set: 0.4521775543689728
loss_pred:0.01686900481581688, decouple_loss:0.0008807129925116897
The modified gen p mean: 0.45211243629455566, gen p mean: -0.10162024199962616, mean p set: 0.4526892900466919
The modified gen p mean: 0.45072081685066223, gen p mean: -0.10096513479948044, mean p set: 0.4512959122657776
loss_pred:0.01645802892744541, decouple_loss:0.0008502287091687322
loss_pred:0.015366137027740479, decouple_loss:0.0009716653730720282
2023-05-01 07:28:25 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11339856684207916, mean p set: 0.4502691626548767
loss_pred:0.017472196370363235, decouple_loss:0.0007561272359453142
The modified gen p mean: 0.4495334029197693, gen p mean: -0.10733763128519058, mean p set: 0.4500633478164673
loss_pred:0.0167723186314106, decouple_loss:0.0007557086646556854
The modified gen p mean: 0.4498283863067627, gen p mean: -0.10726936161518097, mean p set: 0.45035696029663086
loss_pred:0.01703905500471592, decouple_loss:0.000762845971621573
WV_1_PC_1_EH_0_PS_40, loss: 0.017132434993982315, avg_mse: 0.026563575491309166
current test mse: 0.026564
Iteration: 2121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45273905992507935, gen p mean: -0.10515047609806061, mean p set: 0.4533170461654663
loss_pred:0.01578921265900135, decouple_loss:0.0006744322599843144
The modified gen p mean: 0.4526655673980713, gen p mean: -0.10062936693429947, mean p set: 0.45324259996414185The modified gen p mean: 0.45094457268714905, gen p mean: -0.10277202725410461, mean p set: 0.45152196288108826
loss_pred:0.015634922310709953, decouple_loss:0.000784439907874912
loss_pred:0.016501063480973244, decouple_loss:0.0008501117117702961
Iteration: 2122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521232843399048, gen p mean: -0.10189089924097061, mean p set: 0.45269855856895447The modified gen p mean: 0.4508746862411499, gen p mean: -0.1006469577550888, mean p set: 0.451452374458313
loss_pred:0.01567419432103634, decouple_loss:0.0008737771422602236
loss_pred:0.01635408215224743, decouple_loss:0.000830108649097383
The modified gen p mean: 0.45159944891929626, gen p mean: -0.09786467254161835, mean p set: 0.4521760940551758
loss_pred:0.016451165080070496, decouple_loss:0.0007491011638194323
Iteration: 2123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45296066999435425, gen p mean: -0.10273278504610062, mean p set: 0.4535389542579651
The modified gen p mean: 0.4526176154613495, gen p mean: -0.10225798934698105, mean p set: 0.4531942903995514
loss_pred:0.016254056245088577, decouple_loss:0.0012088859220966697
loss_pred:0.016226112842559814, decouple_loss:0.0011407897109165788
The modified gen p mean: 0.4517136812210083, gen p mean: -0.10251576453447342, mean p set: 0.45229020714759827
loss_pred:0.016120756044983864, decouple_loss:0.0007884914521127939
Iteration: 2124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452054500579834, gen p mean: -0.10420136153697968, mean p set: 0.4526309072971344
loss_pred:0.015607221983373165, decouple_loss:0.0010402020998299122
The modified gen p mean: 0.452144980430603, gen p mean: -0.10946270078420639, mean p set: 0.4527256488800049
loss_pred:0.01580110937356949, decouple_loss:0.0007546176784671843
The modified gen p mean: 0.4542369544506073, gen p mean: -0.10293588042259216, mean p set: 0.4548146724700928
loss_pred:0.015719635412096977, decouple_loss:0.001356573193334043
Iteration: 2125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45122775435447693, gen p mean: -0.10912613570690155, mean p set: 0.45180612802505493
loss_pred:0.0165401604026556, decouple_loss:0.0011954976944252849
The modified gen p mean: 0.4504747986793518, gen p mean: -0.09746206551790237, mean p set: 0.4510493874549866
loss_pred:0.01777956448495388, decouple_loss:0.000880490115378052
The modified gen p mean: 0.4520164132118225, gen p mean: -0.11020781099796295, mean p set: 0.4525940418243408
loss_pred:0.01579221338033676, decouple_loss:0.0007136990316212177
Iteration: 2126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538175165653229, gen p mean: -0.10893592238426208, mean p set: 0.45439326763153076
loss_pred:0.015861980617046356, decouple_loss:0.000829707074444741
The modified gen p mean: 0.449759840965271, gen p mean: -0.11081168800592422, mean p set: 0.4503368139266968
loss_pred:0.01648523099720478, decouple_loss:0.0013473257422447205
The modified gen p mean: 0.45237118005752563, gen p mean: -0.11385314911603928, mean p set: 0.45294755697250366
loss_pred:0.015203678980469704, decouple_loss:0.0009204658563248813
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 2127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877752661705017, gen p mean: -0.11921543627977371, mean p set: 0.44935348629951477
loss_pred:0.0157266054302454, decouple_loss:0.0007606888539157808
The modified gen p mean: 0.44835740327835083, gen p mean: -0.12250309437513351, mean p set: 0.4489334523677826
The modified gen p mean: 0.44814610481262207, gen p mean: -0.116659015417099, mean p set: 0.44872117042541504
loss_pred:0.015197508968412876, decouple_loss:0.0009122003684751689
loss_pred:0.015713665634393692, decouple_loss:0.0009488490759395063
Iteration: 2128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44834035634994507, gen p mean: -0.12221227586269379, mean p set: 0.44891637563705444
loss_pred:0.015292953699827194, decouple_loss:0.0011463436530902982
The modified gen p mean: 0.4480701684951782, gen p mean: -0.12028153240680695, mean p set: 0.4486437141895294
The modified gen p mean: 0.44831717014312744, gen p mean: -0.12265501916408539, mean p set: 0.44889357686042786
loss_pred:0.01526607759296894, decouple_loss:0.0012508956715464592
loss_pred:0.015309988521039486, decouple_loss:0.0010729727800935507
Iteration: 2129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733113050460815, gen p mean: -0.1105552613735199, mean p set: 0.4479077458381653
loss_pred:0.015094200149178505, decouple_loss:0.0008127795881591737
The modified gen p mean: 0.4468066394329071, gen p mean: -0.11512137204408646, mean p set: 0.44738414883613586
loss_pred:0.016040630638599396, decouple_loss:0.0008157138945534825
The modified gen p mean: 0.44853925704956055, gen p mean: -0.12089153379201889, mean p set: 0.4491152763366699
loss_pred:0.01501700934022665, decouple_loss:0.0008434818009845912
Iteration: 2130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467256963253021, gen p mean: -0.1135999858379364, mean p set: 0.44730088114738464
loss_pred:0.015296384692192078, decouple_loss:0.0008665731293149292
The modified gen p mean: 0.44851934909820557, gen p mean: -0.10752198845148087, mean p set: 0.44909510016441345
loss_pred:0.015291992574930191, decouple_loss:0.0009116831352002919
The modified gen p mean: 0.44927117228507996, gen p mean: -0.11478681117296219, mean p set: 0.44984567165374756
loss_pred:0.015349996276199818, decouple_loss:0.0009355206275358796
2023-05-01 07:31:08 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12076861411333084, mean p set: 0.4502691626548767
loss_pred:0.017423303797841072, decouple_loss:0.0008679989259690046
The modified gen p mean: 0.449535071849823, gen p mean: -0.11490168422460556, mean p set: 0.4500633478164673
loss_pred:0.016631649807095528, decouple_loss:0.0008039610693231225
The modified gen p mean: 0.4498293995857239, gen p mean: -0.11466590315103531, mean p set: 0.45035696029663086
loss_pred:0.016919223591685295, decouple_loss:0.000678398588206619
WV_1_PC_1_EH_0_PS_40, loss: 0.017030566930770874, avg_mse: 0.026447217911481857
current test mse: 0.026447
Iteration: 2131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481222629547119, gen p mean: -0.11955997347831726, mean p set: 0.4486970603466034
loss_pred:0.015442132949829102, decouple_loss:0.0008024214766919613
The modified gen p mean: 0.4489556849002838, gen p mean: -0.11198872327804565, mean p set: 0.449531614780426
loss_pred:0.015315676108002663, decouple_loss:0.0009074137778952718
The modified gen p mean: 0.44670024514198303, gen p mean: -0.11298581212759018, mean p set: 0.44727620482444763
loss_pred:0.015424325130879879, decouple_loss:0.0007368916994892061
Iteration: 2132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479296803474426, gen p mean: -0.11759540438652039, mean p set: 0.448505699634552
loss_pred:0.01523346547037363, decouple_loss:0.0006509025697596371
The modified gen p mean: 0.44765064120292664, gen p mean: -0.1102481335401535, mean p set: 0.448231041431427The modified gen p mean: 0.44834983348846436, gen p mean: -0.11259317398071289, mean p set: 0.44892609119415283
loss_pred:0.015339468605816364, decouple_loss:0.0006572454003617167
loss_pred:0.014882001094520092, decouple_loss:0.000772168452385813
Iteration: 2133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483717978000641, gen p mean: -0.10786065459251404, mean p set: 0.44894805550575256
loss_pred:0.015409284271299839, decouple_loss:0.0009030255605466664
The modified gen p mean: 0.44715389609336853, gen p mean: -0.11289661377668381, mean p set: 0.4477311074733734
loss_pred:0.01528940163552761, decouple_loss:0.0007983397808857262
The modified gen p mean: 0.4475199580192566, gen p mean: -0.11248990148305893, mean p set: 0.4480955898761749
loss_pred:0.015411684289574623, decouple_loss:0.0009219763451255858
Iteration: 2134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488469064235687, gen p mean: -0.11092200130224228, mean p set: 0.4494239091873169
loss_pred:0.014227606356143951, decouple_loss:0.0007586543215438724
The modified gen p mean: 0.4469357430934906, gen p mean: -0.11593538522720337, mean p set: 0.4475100636482239
loss_pred:0.014863681979477406, decouple_loss:0.0006243127281777561
The modified gen p mean: 0.4487971365451813, gen p mean: -0.12034627795219421, mean p set: 0.44937342405319214
loss_pred:0.014809701591730118, decouple_loss:0.0008029822492972016
Iteration: 2135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481462240219116, gen p mean: -0.11742589622735977, mean p set: 0.44871968030929565
loss_pred:0.014603359624743462, decouple_loss:0.0006297914660535753
The modified gen p mean: 0.4492911696434021, gen p mean: -0.11839435994625092, mean p set: 0.4498688280582428
loss_pred:0.01482461392879486, decouple_loss:0.0006256492924876511
The modified gen p mean: 0.44828012585639954, gen p mean: -0.11921284347772598, mean p set: 0.4488562345504761
loss_pred:0.015185975469648838, decouple_loss:0.0008058538078330457
Iteration: 2136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479668438434601, gen p mean: -0.10919670760631561, mean p set: 0.4485420286655426
loss_pred:0.015224969945847988, decouple_loss:0.0008063522400334477
The modified gen p mean: 0.44824346899986267, gen p mean: -0.11053241044282913, mean p set: 0.44881969690322876
loss_pred:0.015543491579592228, decouple_loss:0.0008353548473678529
The modified gen p mean: 0.4478619396686554, gen p mean: -0.11353044211864471, mean p set: 0.44843941926956177
loss_pred:0.014747881330549717, decouple_loss:0.0006723407423123717
Iteration: 2137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447572261095047, gen p mean: -0.11651409417390823, mean p set: 0.4481446146965027
loss_pred:0.015972735360264778, decouple_loss:0.0007521851221099496
The modified gen p mean: 0.44765469431877136, gen p mean: -0.10947411507368088, mean p set: 0.44823071360588074
The modified gen p mean: 0.4504772126674652, gen p mean: -0.11692626029253006, mean p set: 0.4510541558265686
loss_pred:0.014824872836470604, decouple_loss:0.0005999391432851553
loss_pred:0.014904513955116272, decouple_loss:0.0007540941587649286
Iteration: 2138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487083852291107, gen p mean: -0.11838370561599731, mean p set: 0.4492855668067932
loss_pred:0.014811326749622822, decouple_loss:0.0006301149842329323
The modified gen p mean: 0.44805970788002014, gen p mean: -0.11495562642812729, mean p set: 0.44863688945770264
loss_pred:0.01463315263390541, decouple_loss:0.0007279253331944346
The modified gen p mean: 0.44844111800193787, gen p mean: -0.10593432188034058, mean p set: 0.44901901483535767
loss_pred:0.015547510236501694, decouple_loss:0.0008054330246523023
Iteration: 2139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731974601745605, gen p mean: -0.11095045506954193, mean p set: 0.4478953182697296
loss_pred:0.014874255284667015, decouple_loss:0.0005369787686504424
The modified gen p mean: 0.44716113805770874, gen p mean: -0.11346492916345596, mean p set: 0.4477364122867584
loss_pred:0.014966171234846115, decouple_loss:0.0007767629576846957
The modified gen p mean: 0.4492625594139099, gen p mean: -0.1088850125670433, mean p set: 0.44984006881713867
loss_pred:0.015331929549574852, decouple_loss:0.0006488520302809775
Iteration: 2140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806450605392456, gen p mean: -0.10086770355701447, mean p set: 0.44864022731781006
loss_pred:0.015158100984990597, decouple_loss:0.0008300002082251012
The modified gen p mean: 0.44844406843185425, gen p mean: -0.10087171196937561, mean p set: 0.44902175664901733
The modified gen p mean: 0.4489278197288513, gen p mean: -0.10540842264890671, mean p set: 0.4495035707950592
loss_pred:0.015248224139213562, decouple_loss:0.0010612236801534891
loss_pred:0.014562835916876793, decouple_loss:0.0007909951964393258
2023-05-01 07:33:13 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.11369262635707855, mean p set: 0.4502691626548767
loss_pred:0.01732938550412655, decouple_loss:0.0008186150225810707
The modified gen p mean: 0.44953516125679016, gen p mean: -0.1078537106513977, mean p set: 0.4500633478164673
loss_pred:0.01648770086467266, decouple_loss:0.0010070274583995342
The modified gen p mean: 0.4498291611671448, gen p mean: -0.10786060988903046, mean p set: 0.45035696029663086
loss_pred:0.016926627606153488, decouple_loss:0.0008072693599388003
WV_1_PC_1_EH_0_PS_40, loss: 0.01695845276117325, avg_mse: 0.02634638547897339
current test mse: 0.026346
Iteration: 2141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750699400901794, gen p mean: -0.10888296365737915, mean p set: 0.4480842351913452
loss_pred:0.014777196571230888, decouple_loss:0.0009038401185534894
The modified gen p mean: 0.4483698308467865, gen p mean: -0.11024467647075653, mean p set: 0.4489465653896332The modified gen p mean: 0.45040377974510193, gen p mean: -0.11452000588178635, mean p set: 0.45098060369491577
loss_pred:0.014863886870443821, decouple_loss:0.0007777679711580276loss_pred:0.014794091694056988, decouple_loss:0.0006855768733657897
Iteration: 2142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480465352535248, gen p mean: -0.10651270300149918, mean p set: 0.448621928691864
The modified gen p mean: 0.44735485315322876, gen p mean: -0.10867080837488174, mean p set: 0.4479316174983978
loss_pred:0.015208757482469082, decouple_loss:0.0006816198583692312
loss_pred:0.015390612185001373, decouple_loss:0.0006538015441037714
The modified gen p mean: 0.44964778423309326, gen p mean: -0.10706005245447159, mean p set: 0.4502216577529907
loss_pred:0.01513082254678011, decouple_loss:0.0005374975735321641
Iteration: 2143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448837548494339, gen p mean: -0.11603154242038727, mean p set: 0.4494134187698364
loss_pred:0.014470144174993038, decouple_loss:0.0007118175271898508
The modified gen p mean: 0.44764021039009094, gen p mean: -0.10834389179944992, mean p set: 0.4482152760028839
loss_pred:0.014933422207832336, decouple_loss:0.0007068015402182937
The modified gen p mean: 0.44777360558509827, gen p mean: -0.11372202634811401, mean p set: 0.4483504593372345
loss_pred:0.014708890579640865, decouple_loss:0.0006863377639092505
Iteration: 2144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823089241981506, gen p mean: -0.1099235787987709, mean p set: 0.44880932569503784
loss_pred:0.015135482884943485, decouple_loss:0.0006535910069942474
The modified gen p mean: 0.4481189250946045, gen p mean: -0.11455957591533661, mean p set: 0.44869375228881836
loss_pred:0.014874465763568878, decouple_loss:0.0007532127783633769
The modified gen p mean: 0.448751300573349, gen p mean: -0.11883186548948288, mean p set: 0.44932815432548523
loss_pred:0.014608236961066723, decouple_loss:0.0009418581612408161
Iteration: 2145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488902688026428, gen p mean: -0.11054937541484833, mean p set: 0.4494667053222656
loss_pred:0.014203907921910286, decouple_loss:0.0006702645914629102
The modified gen p mean: 0.4479196071624756, gen p mean: -0.11536705493927002, mean p set: 0.4484964609146118
loss_pred:0.0145481051877141, decouple_loss:0.000711816712282598
The modified gen p mean: 0.4490694999694824, gen p mean: -0.11338214576244354, mean p set: 0.4496456980705261
loss_pred:0.014203084632754326, decouple_loss:0.000617466343101114
Iteration: 2146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448072612285614, gen p mean: -0.1120055541396141, mean p set: 0.448650062084198
loss_pred:0.014880357310175896, decouple_loss:0.0009350635227747262
The modified gen p mean: 0.44754737615585327, gen p mean: -0.11094573140144348, mean p set: 0.4481230676174164
The modified gen p mean: 0.44862860441207886, gen p mean: -0.1158834919333458, mean p set: 0.4492042660713196
loss_pred:0.014924787916243076, decouple_loss:0.001000695861876011
loss_pred:0.014174500480294228, decouple_loss:0.0009362983983010054
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468647539615631, gen p mean: -0.11275399476289749, mean p set: 0.44744303822517395The modified gen p mean: 0.4464344084262848, gen p mean: -0.11491551995277405, mean p set: 0.4470106363296509
loss_pred:0.016231944784522057, decouple_loss:0.0007060900097712874
loss_pred:0.01629774458706379, decouple_loss:0.0007410524995066226
The modified gen p mean: 0.44706085324287415, gen p mean: -0.10822650045156479, mean p set: 0.44763532280921936
loss_pred:0.016486024484038353, decouple_loss:0.0006927390932105482
Iteration: 2148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44507652521133423, gen p mean: -0.11655976623296738, mean p set: 0.4456527829170227
loss_pred:0.015760071575641632, decouple_loss:0.0006421399884857237
The modified gen p mean: 0.44586387276649475, gen p mean: -0.11580551415681839, mean p set: 0.4464392364025116
The modified gen p mean: 0.4463769197463989, gen p mean: -0.11230001598596573, mean p set: 0.44695156812667847
loss_pred:0.016021493822336197, decouple_loss:0.0006076607969589531
loss_pred:0.015828469768166542, decouple_loss:0.0006616127211600542
Iteration: 2149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786563515663147, gen p mean: -0.1067783311009407, mean p set: 0.4484444558620453
loss_pred:0.01668417826294899, decouple_loss:0.0008292355923913419
The modified gen p mean: 0.44671905040740967, gen p mean: -0.11245936900377274, mean p set: 0.44729533791542053
loss_pred:0.015625473111867905, decouple_loss:0.0005872968467883766
The modified gen p mean: 0.4455420970916748, gen p mean: -0.1100611537694931, mean p set: 0.44611749053001404
loss_pred:0.01575591415166855, decouple_loss:0.0006442960584536195
Iteration: 2150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469713866710663, gen p mean: -0.10588323324918747, mean p set: 0.4475449025630951
loss_pred:0.016252342611551285, decouple_loss:0.0009002652950584888
The modified gen p mean: 0.44656288623809814, gen p mean: -0.111164890229702, mean p set: 0.44714006781578064
The modified gen p mean: 0.4462047517299652, gen p mean: -0.11105655878782272, mean p set: 0.44678211212158203
loss_pred:0.016423994675278664, decouple_loss:0.0007236916571855545
loss_pred:0.015640627592802048, decouple_loss:0.0006095155840739608
2023-05-01 07:36:08 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11171725392341614, mean p set: 0.4502691626548767
loss_pred:0.017264259979128838, decouple_loss:0.0006572317215614021
The modified gen p mean: 0.4495358467102051, gen p mean: -0.10567042976617813, mean p set: 0.4500633478164673
loss_pred:0.016459297388792038, decouple_loss:0.0007166618015617132
The modified gen p mean: 0.4498273730278015, gen p mean: -0.10576304793357849, mean p set: 0.45035696029663086
loss_pred:0.016819514334201813, decouple_loss:0.0006827004835940897
WV_1_PC_1_EH_0_PS_40, loss: 0.016881968826055527, avg_mse: 0.026255225762724876
current test mse: 0.026255
Iteration: 2151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462737739086151, gen p mean: -0.11082367599010468, mean p set: 0.4468485414981842
loss_pred:0.01584324985742569, decouple_loss:0.0005410825251601636
The modified gen p mean: 0.4462302327156067, gen p mean: -0.10639163106679916, mean p set: 0.4468083381652832
The modified gen p mean: 0.4469740092754364, gen p mean: -0.10844513028860092, mean p set: 0.44754984974861145
loss_pred:0.016001353040337563, decouple_loss:0.0005550025962293148
loss_pred:0.01586534082889557, decouple_loss:0.0005938627873547375
Iteration: 2152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44645991921424866, gen p mean: -0.11063975095748901, mean p set: 0.4470359981060028
loss_pred:0.01549918670207262, decouple_loss:0.0006721756653860211
The modified gen p mean: 0.4469572901725769, gen p mean: -0.11201867461204529, mean p set: 0.4475320279598236The modified gen p mean: 0.4470648467540741, gen p mean: -0.11042856425046921, mean p set: 0.4476405084133148
loss_pred:0.01529289223253727, decouple_loss:0.0007252036593854427
loss_pred:0.01600436307489872, decouple_loss:0.0005485229194164276
Iteration: 2153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460814893245697, gen p mean: -0.10546794533729553, mean p set: 0.4466569721698761
loss_pred:0.015855159610509872, decouple_loss:0.0008787706028670073
The modified gen p mean: 0.44640663266181946, gen p mean: -0.10959885269403458, mean p set: 0.446982741355896
loss_pred:0.015751490369439125, decouple_loss:0.0007151479367166758
The modified gen p mean: 0.44548776745796204, gen p mean: -0.11054784059524536, mean p set: 0.44606199860572815
loss_pred:0.01583750918507576, decouple_loss:0.0006728902808390558
Iteration: 2154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458180069923401, gen p mean: -0.1115710660815239, mean p set: 0.44639402627944946
loss_pred:0.015576869249343872, decouple_loss:0.0005863272817805409
The modified gen p mean: 0.44656455516815186, gen p mean: -0.11582762748003006, mean p set: 0.44713932275772095
loss_pred:0.015707174316048622, decouple_loss:0.0008780345669947565
The modified gen p mean: 0.44537991285324097, gen p mean: -0.11229370534420013, mean p set: 0.44595643877983093
loss_pred:0.015725325793027878, decouple_loss:0.0005909919855184853
Iteration: 2155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470565915107727, gen p mean: -0.1122405156493187, mean p set: 0.4476345181465149
loss_pred:0.015630260109901428, decouple_loss:0.0007403646595776081
The modified gen p mean: 0.44589823484420776, gen p mean: -0.10828936100006104, mean p set: 0.44647544622421265
loss_pred:0.016506405547261238, decouple_loss:0.0008071629563346505
The modified gen p mean: 0.445783793926239, gen p mean: -0.11346440017223358, mean p set: 0.4463599622249603
loss_pred:0.01593848690390587, decouple_loss:0.0006421279394999146
Iteration: 2156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457370936870575, gen p mean: -0.112516388297081, mean p set: 0.44631072878837585
loss_pred:0.015599832870066166, decouple_loss:0.0008404066902585328
The modified gen p mean: 0.4453738331794739, gen p mean: -0.11032433062791824, mean p set: 0.4459480941295624
The modified gen p mean: 0.4475536048412323, gen p mean: -0.10854265093803406, mean p set: 0.44812965393066406
loss_pred:0.015803396701812744, decouple_loss:0.0006823783041909337
loss_pred:0.016062771901488304, decouple_loss:0.0006994662107899785
Iteration: 2157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472897946834564, gen p mean: -0.11207865178585052, mean p set: 0.4478660225868225
loss_pred:0.016473479568958282, decouple_loss:0.0006715623312629759
The modified gen p mean: 0.44634774327278137, gen p mean: -0.11203615367412567, mean p set: 0.4469238221645355
loss_pred:0.016171365976333618, decouple_loss:0.0005676587461493909
The modified gen p mean: 0.4464278221130371, gen p mean: -0.11146185547113419, mean p set: 0.447003036737442
loss_pred:0.015913590788841248, decouple_loss:0.0005489863688126206
Iteration: 2158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694700837135315, gen p mean: -0.11370401829481125, mean p set: 0.44752374291419983
loss_pred:0.016382800415158272, decouple_loss:0.000767921912483871
The modified gen p mean: 0.44661661982536316, gen p mean: -0.11748044937849045, mean p set: 0.44719311594963074
loss_pred:0.01572161167860031, decouple_loss:0.0005837063072249293
The modified gen p mean: 0.44692039489746094, gen p mean: -0.11929036676883698, mean p set: 0.44749611616134644
loss_pred:0.015567190013825893, decouple_loss:0.0005992628866806626
Iteration: 2159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44600680470466614, gen p mean: -0.11384948343038559, mean p set: 0.4465799629688263
loss_pred:0.015300435945391655, decouple_loss:0.0007761688902974129
The modified gen p mean: 0.4475310444831848, gen p mean: -0.11439836770296097, mean p set: 0.4481041729450226
loss_pred:0.016406811773777008, decouple_loss:0.0005399971269071102
The modified gen p mean: 0.4465050995349884, gen p mean: -0.11590128391981125, mean p set: 0.4470827281475067
loss_pred:0.015445198863744736, decouple_loss:0.0005178143037483096
Iteration: 2160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716310501098633, gen p mean: -0.11755085736513138, mean p set: 0.44773659110069275
loss_pred:0.01540551707148552, decouple_loss:0.000529423588886857
The modified gen p mean: 0.4440935552120209, gen p mean: -0.11250612139701843, mean p set: 0.44466984272003174
loss_pred:0.01615310274064541, decouple_loss:0.000854071753565222
The modified gen p mean: 0.4465014934539795, gen p mean: -0.11886909604072571, mean p set: 0.44707778096199036
loss_pred:0.015589645132422447, decouple_loss:0.0007952552405185997
2023-05-01 07:38:13 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11914972960948944, mean p set: 0.4502691626548767
loss_pred:0.017338812351226807, decouple_loss:0.0006673323223367333
The modified gen p mean: 0.4495353698730469, gen p mean: -0.1129276379942894, mean p set: 0.4500633478164673
loss_pred:0.016537217423319817, decouple_loss:0.0007692453800700605
The modified gen p mean: 0.4498283863067627, gen p mean: -0.11267662048339844, mean p set: 0.45035696029663086
loss_pred:0.016818653792142868, decouple_loss:0.0006766526494175196
WV_1_PC_1_EH_0_PS_40, loss: 0.016933448612689972, avg_mse: 0.02635779045522213
current test mse: 0.026358
Iteration: 2161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44482421875, gen p mean: -0.11281590163707733, mean p set: 0.4453986883163452
loss_pred:0.01643141359090805, decouple_loss:0.0005941789713688195
The modified gen p mean: 0.44713225960731506, gen p mean: -0.1185048371553421, mean p set: 0.44770827889442444The modified gen p mean: 0.4457014501094818, gen p mean: -0.1120656430721283, mean p set: 0.446274995803833
loss_pred:0.016046568751335144, decouple_loss:0.0006540736649185419
loss_pred:0.015899796038866043, decouple_loss:0.0005841965321451426
Iteration: 2162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44638195633888245, gen p mean: -0.11937973648309708, mean p set: 0.44695594906806946
loss_pred:0.015016058459877968, decouple_loss:0.0007066629477776587
The modified gen p mean: 0.44632232189178467, gen p mean: -0.11684218794107437, mean p set: 0.4468989372253418The modified gen p mean: 0.4469563663005829, gen p mean: -0.11325817555189133, mean p set: 0.4475346803665161
loss_pred:0.015442096628248692, decouple_loss:0.0009560649050399661
loss_pred:0.01645217463374138, decouple_loss:0.0006376297678798437
Iteration: 2163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44560015201568604, gen p mean: -0.1226036474108696, mean p set: 0.446174293756485
loss_pred:0.01560140959918499, decouple_loss:0.0005523302243091166
The modified gen p mean: 0.4458310604095459, gen p mean: -0.12172122299671173, mean p set: 0.44640541076660156
loss_pred:0.01572798565030098, decouple_loss:0.000578144274186343
The modified gen p mean: 0.4467398524284363, gen p mean: -0.11969009786844254, mean p set: 0.44731536507606506
loss_pred:0.015808096155524254, decouple_loss:0.0006247407873161137
Iteration: 2164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464663863182068, gen p mean: -0.12594138085842133, mean p set: 0.4470418095588684
loss_pred:0.015458917245268822, decouple_loss:0.0006121117621660233
The modified gen p mean: 0.44705015420913696, gen p mean: -0.12277485430240631, mean p set: 0.4476243555545807
loss_pred:0.015414310619235039, decouple_loss:0.0007341555901803076
The modified gen p mean: 0.44555675983428955, gen p mean: -0.1211443617939949, mean p set: 0.44613370299339294
loss_pred:0.015473357401788235, decouple_loss:0.000715432281140238
Iteration: 2165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468276798725128, gen p mean: -0.12331971526145935, mean p set: 0.447405070066452
loss_pred:0.015377611853182316, decouple_loss:0.0006656047189608216
The modified gen p mean: 0.44708552956581116, gen p mean: -0.12470419704914093, mean p set: 0.44765836000442505
loss_pred:0.015371716581285, decouple_loss:0.0005518283578567207
The modified gen p mean: 0.4454696774482727, gen p mean: -0.1251300424337387, mean p set: 0.44604605436325073
loss_pred:0.015248307958245277, decouple_loss:0.000597506295889616
Iteration: 2166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457674026489258, gen p mean: -0.1235542893409729, mean p set: 0.4463409185409546
loss_pred:0.015364534221589565, decouple_loss:0.0006746025756001472
The modified gen p mean: 0.44666042923927307, gen p mean: -0.11775359511375427, mean p set: 0.44723621010780334
loss_pred:0.01532764546573162, decouple_loss:0.0007536037010140717
The modified gen p mean: 0.4460843503475189, gen p mean: -0.11590773612260818, mean p set: 0.44666188955307007
loss_pred:0.01568938046693802, decouple_loss:0.0006251824088394642
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 2167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702038168907166, gen p mean: -0.11843889951705933, mean p set: 0.44759562611579895
loss_pred:0.015140767209231853, decouple_loss:0.0005711218691430986
The modified gen p mean: 0.4482698440551758, gen p mean: -0.1172899380326271, mean p set: 0.44884711503982544
The modified gen p mean: 0.44788995385169983, gen p mean: -0.11706666648387909, mean p set: 0.4484681785106659
loss_pred:0.015961598604917526, decouple_loss:0.0006363565917126834
loss_pred:0.015837613493204117, decouple_loss:0.0007067355909384787
Iteration: 2168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465068578720093, gen p mean: -0.1159738227725029, mean p set: 0.4470813572406769
loss_pred:0.015293407253921032, decouple_loss:0.0007577002979815006
The modified gen p mean: 0.4465236961841583, gen p mean: -0.11473508179187775, mean p set: 0.44709837436676025
The modified gen p mean: 0.4471597671508789, gen p mean: -0.11217660456895828, mean p set: 0.4477352201938629
loss_pred:0.016385257244110107, decouple_loss:0.0007238929974846542
loss_pred:0.01618078164756298, decouple_loss:0.0006619066698476672
Iteration: 2169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44712719321250916, gen p mean: -0.10971159487962723, mean p set: 0.4477040469646454
loss_pred:0.015332399867475033, decouple_loss:0.000709892192389816
The modified gen p mean: 0.447214275598526, gen p mean: -0.11206921935081482, mean p set: 0.44779056310653687
loss_pred:0.015012248419225216, decouple_loss:0.0006106991786509752
The modified gen p mean: 0.4479978680610657, gen p mean: -0.10838169604539871, mean p set: 0.4485728442668915
loss_pred:0.015486111864447594, decouple_loss:0.0005886518629267812
Iteration: 2170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784441590309143, gen p mean: -0.10851426422595978, mean p set: 0.44841933250427246
loss_pred:0.01612766645848751, decouple_loss:0.0007216273806989193
The modified gen p mean: 0.4479758143424988, gen p mean: -0.11269806325435638, mean p set: 0.4485515058040619
loss_pred:0.016080385074019432, decouple_loss:0.0005332475993782282
The modified gen p mean: 0.44581103324890137, gen p mean: -0.1119917780160904, mean p set: 0.44638389348983765
loss_pred:0.01473142672330141, decouple_loss:0.0005774178425781429
2023-05-01 07:40:54 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11132487654685974, mean p set: 0.4502691626548767
loss_pred:0.01716381125152111, decouple_loss:0.0009787211893126369
The modified gen p mean: 0.4495340585708618, gen p mean: -0.10541403293609619, mean p set: 0.4500633478164673
loss_pred:0.016384249553084373, decouple_loss:0.0009973365813493729
The modified gen p mean: 0.44983047246932983, gen p mean: -0.10534660518169403, mean p set: 0.45035696029663086
loss_pred:0.016827629879117012, decouple_loss:0.0007857027230784297
WV_1_PC_1_EH_0_PS_40, loss: 0.01683792844414711, avg_mse: 0.026167720556259155
current test mse: 0.026168
At step 2170, Best test: 0.026168
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 2171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848886132240295, gen p mean: -0.10746631026268005, mean p set: 0.4490656852722168
loss_pred:0.01533412653952837, decouple_loss:0.001163126085884869
The modified gen p mean: 0.44723644852638245, gen p mean: -0.10945115983486176, mean p set: 0.4478125274181366
loss_pred:0.015041636303067207, decouple_loss:0.0008992850780487061
The modified gen p mean: 0.44625213742256165, gen p mean: -0.1091315746307373, mean p set: 0.4468306601047516
loss_pred:0.014560931362211704, decouple_loss:0.0006081497995182872
Iteration: 2172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752323627471924, gen p mean: -0.1021825298666954, mean p set: 0.44809815287590027
loss_pred:0.014767192304134369, decouple_loss:0.0008974181837402284
The modified gen p mean: 0.4476286470890045, gen p mean: -0.11082521826028824, mean p set: 0.44820475578308105The modified gen p mean: 0.44739770889282227, gen p mean: -0.11031968146562576, mean p set: 0.44797375798225403
loss_pred:0.016008099541068077, decouple_loss:0.0007991577149368823
loss_pred:0.01653609238564968, decouple_loss:0.0007764488109387457
Iteration: 2173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477035105228424, gen p mean: -0.10279501974582672, mean p set: 0.4482816159725189
loss_pred:0.015512509271502495, decouple_loss:0.0007318881689570844
The modified gen p mean: 0.44604381918907166, gen p mean: -0.10966040194034576, mean p set: 0.44661951065063477The modified gen p mean: 0.44763538241386414, gen p mean: -0.10707326233386993, mean p set: 0.4482135772705078
loss_pred:0.01570640131831169, decouple_loss:0.0006583898211829364
loss_pred:0.015279741026461124, decouple_loss:0.0006825646269135177
Iteration: 2174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459518790245056, gen p mean: -0.10619447380304337, mean p set: 0.4465283155441284
loss_pred:0.0159982368350029, decouple_loss:0.0010988018475472927
The modified gen p mean: 0.4472306966781616, gen p mean: -0.11019611358642578, mean p set: 0.4478060305118561
loss_pred:0.015303129330277443, decouple_loss:0.0010377049911767244
The modified gen p mean: 0.44758883118629456, gen p mean: -0.10628720372915268, mean p set: 0.4481656849384308
loss_pred:0.015498335473239422, decouple_loss:0.0010730450740084052
Iteration: 2175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466802179813385, gen p mean: -0.10758621990680695, mean p set: 0.44725507497787476
loss_pred:0.015171964652836323, decouple_loss:0.0007080388604663312
The modified gen p mean: 0.4474288821220398, gen p mean: -0.10803133994340897, mean p set: 0.4480046033859253
loss_pred:0.014997106976807117, decouple_loss:0.0008961313869804144
The modified gen p mean: 0.44779470562934875, gen p mean: -0.1021229550242424, mean p set: 0.44837021827697754
loss_pred:0.01541218627244234, decouple_loss:0.0009112844709306955
Iteration: 2176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466184973716736, gen p mean: -0.10419130325317383, mean p set: 0.44719401001930237
loss_pred:0.01614491641521454, decouple_loss:0.0005702725029550493
The modified gen p mean: 0.44715026021003723, gen p mean: -0.10181102156639099, mean p set: 0.4477280378341675
loss_pred:0.015430135652422905, decouple_loss:0.0005322948563843966
The modified gen p mean: 0.44784295558929443, gen p mean: -0.10459888726472855, mean p set: 0.4484192430973053
loss_pred:0.015944119542837143, decouple_loss:0.0005728724063374102
Iteration: 2177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472872018814087, gen p mean: -0.09954899549484253, mean p set: 0.4478640854358673
loss_pred:0.014644314534962177, decouple_loss:0.0007186251459643245
The modified gen p mean: 0.44688957929611206, gen p mean: -0.10795433819293976, mean p set: 0.44746458530426025
loss_pred:0.015404627658426762, decouple_loss:0.00086104596266523
The modified gen p mean: 0.4483110308647156, gen p mean: -0.10486743599176407, mean p set: 0.44888749718666077
loss_pred:0.014768865890800953, decouple_loss:0.0008531589992344379
Iteration: 2178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447998970746994, gen p mean: -0.10755518078804016, mean p set: 0.4485739767551422
loss_pred:0.014993495307862759, decouple_loss:0.0006995798321440816
The modified gen p mean: 0.44806382060050964, gen p mean: -0.10681486874818802, mean p set: 0.4486413896083832
loss_pred:0.014790825545787811, decouple_loss:0.0007256728713400662
The modified gen p mean: 0.44837766885757446, gen p mean: -0.1043144017457962, mean p set: 0.448952317237854
loss_pred:0.015012189745903015, decouple_loss:0.0009860042482614517
Iteration: 2179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770127534866333, gen p mean: -0.11062386631965637, mean p set: 0.44827502965927124
loss_pred:0.015357209369540215, decouple_loss:0.001039179740473628
The modified gen p mean: 0.44727030396461487, gen p mean: -0.10578519105911255, mean p set: 0.44784313440322876
The modified gen p mean: 0.4475170075893402, gen p mean: -0.10745178908109665, mean p set: 0.44809025526046753
loss_pred:0.01585402898490429, decouple_loss:0.0007133184117265046
loss_pred:0.015183551236987114, decouple_loss:0.0008396916673518717
Iteration: 2180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44617563486099243, gen p mean: -0.10997021943330765, mean p set: 0.4467509686946869
loss_pred:0.015589539892971516, decouple_loss:0.0007445860537700355
The modified gen p mean: 0.44780752062797546, gen p mean: -0.10838232189416885, mean p set: 0.44838324189186096
The modified gen p mean: 0.44813627004623413, gen p mean: -0.10613717138767242, mean p set: 0.4487118422985077
loss_pred:0.015458798035979271, decouple_loss:0.0009408304467797279
loss_pred:0.014865817502140999, decouple_loss:0.000946965126786381
2023-05-01 07:43:06 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10975039750337601, mean p set: 0.4502691626548767
loss_pred:0.017223600298166275, decouple_loss:0.0006569782854057848
The modified gen p mean: 0.4495348036289215, gen p mean: -0.10420741140842438, mean p set: 0.4500633478164673
loss_pred:0.016453899443149567, decouple_loss:0.0009444127208553255
The modified gen p mean: 0.4498291611671448, gen p mean: -0.10413913428783417, mean p set: 0.45035696029663086
loss_pred:0.016904640942811966, decouple_loss:0.0008766035898588598
WV_1_PC_1_EH_0_PS_40, loss: 0.01690201461315155, avg_mse: 0.026291480287909508
current test mse: 0.026291
Iteration: 2181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715237617492676, gen p mean: -0.10878987610340118, mean p set: 0.447729229927063
loss_pred:0.015358986333012581, decouple_loss:0.0007723952294327319
The modified gen p mean: 0.4476187825202942, gen p mean: -0.10446813702583313, mean p set: 0.4481956660747528
loss_pred:0.015253976918756962, decouple_loss:0.0006848547491244972
The modified gen p mean: 0.4475478231906891, gen p mean: -0.110162653028965, mean p set: 0.44812464714050293
loss_pred:0.015339496545493603, decouple_loss:0.001020976691506803
Iteration: 2182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474456310272217, gen p mean: -0.10572686046361923, mean p set: 0.44802215695381165
loss_pred:0.014879819005727768, decouple_loss:0.0007534260512329638
The modified gen p mean: 0.447372704744339, gen p mean: -0.10571348667144775, mean p set: 0.4479471743106842The modified gen p mean: 0.44585418701171875, gen p mean: -0.10950981825590134, mean p set: 0.44642776250839233
loss_pred:0.015663467347621918, decouple_loss:0.0007609176100231707
loss_pred:0.015222630463540554, decouple_loss:0.0009337600786238909
Iteration: 2183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463396370410919, gen p mean: -0.10664823651313782, mean p set: 0.44691428542137146
loss_pred:0.015426783822476864, decouple_loss:0.0010060484055429697
The modified gen p mean: 0.4467383921146393, gen p mean: -0.1068815365433693, mean p set: 0.4473138451576233
loss_pred:0.015424511395394802, decouple_loss:0.0009284556726925075
The modified gen p mean: 0.4472077786922455, gen p mean: -0.10738690942525864, mean p set: 0.4477818012237549
loss_pred:0.01509450189769268, decouple_loss:0.0007097009220160544
Iteration: 2184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474025368690491, gen p mean: -0.10133028775453568, mean p set: 0.44797828793525696
loss_pred:0.015870317816734314, decouple_loss:0.0006095305434428155
The modified gen p mean: 0.44828829169273376, gen p mean: -0.10516100376844406, mean p set: 0.4488631784915924
loss_pred:0.015154044143855572, decouple_loss:0.0006845130119472742
The modified gen p mean: 0.44809767603874207, gen p mean: -0.10527608543634415, mean p set: 0.4486749470233917
loss_pred:0.01557732094079256, decouple_loss:0.0005833315663039684
Iteration: 2185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460432827472687, gen p mean: -0.10621964186429977, mean p set: 0.4466179311275482
loss_pred:0.01521181222051382, decouple_loss:0.0007163911359384656
The modified gen p mean: 0.44745659828186035, gen p mean: -0.09913107007741928, mean p set: 0.44803258776664734
loss_pred:0.015075011178851128, decouple_loss:0.0007053312147036195
The modified gen p mean: 0.44643232226371765, gen p mean: -0.10701935738325119, mean p set: 0.4470071494579315
loss_pred:0.015037529170513153, decouple_loss:0.0006639896892011166
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759130477905273, gen p mean: -0.1054941788315773, mean p set: 0.44816744327545166
loss_pred:0.01559437531977892, decouple_loss:0.0005925056175328791
The modified gen p mean: 0.4469900131225586, gen p mean: -0.11059180647134781, mean p set: 0.44756636023521423
loss_pred:0.01513191219419241, decouple_loss:0.0008976628305390477
The modified gen p mean: 0.4470842182636261, gen p mean: -0.10526327043771744, mean p set: 0.44765913486480713
loss_pred:0.015211740508675575, decouple_loss:0.0007714825333096087
Traceback (most recent call last):
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 338, in <module>
    train_wrapper(model)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 259, in train_wrapper
    train_input_handle = datasets_factory.data_provider(
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/datasets_factory.py", line 48, in data_provider
    train_input_handle = datasets_map[dataset_name].InputHandle(train_input_param)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/mnist_new.py", line 26, in __init__
    self.load()
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/mnist_new.py", line 31, in load
    self.data['clips'] = dat_1['clips']
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/numpy/lib/npyio.py", line 260, in __getitem__
    raise KeyError("%s is not a file in the archive" % key)
KeyError: 'clips is not a file in the archive'
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz